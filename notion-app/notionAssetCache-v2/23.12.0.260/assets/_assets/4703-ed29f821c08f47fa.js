"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[4703],{62967:(e,t,o)=>{o.d(t,{$J:()=>A,CJ:()=>E,MV:()=>D,RE:()=>k,cN:()=>T,cs:()=>C,fi:()=>F,kv:()=>B,wL:()=>R,zz:()=>x});o(67294);var n=o(41432),r=o(8848),i=o(97880),a=o(5366),s=o(96802),l=o(39699),c=o(93405),d=o(48019),p=o(52275),u=o(78140),m=o(40721),g=o(86825),h=o(26388),f=o(42782),y=o(19037),v=o(93959),b=o(33929),S=o(87279),_=o(98742),w=o(85893);const k=(0,a.defineMessages)({deleteName:{id:"action.delete.name",defaultMessage:"Delete"},undoName:{id:"action.undo.name",defaultMessage:"Undo"},redoName:{id:"action.redo.name",defaultMessage:"Redo"},duplicateName:{id:"action.duplicate.name",defaultMessage:"Duplicate"},duplicateToPrivateName:{id:"action.duplicateToPrivate.name",defaultMessage:"Duplicate to Private"},turnIntoName:{id:"action.turnInto.name",defaultMessage:"Turn into"},copyLinkName:{id:"action.copyLink.name",defaultMessage:"Copy link to block"},copyLinkNavigableTypeName:{id:"action.copyLinkNavigableType.name",defaultMessage:"Copy link"},showCodePreviewFormat:{id:"action.showCodePreviewFormat.name",defaultMessage:"Preview"},showOnlyCodeFormat:{id:"action.showOnlyCodeFormat.name",defaultMessage:"Code"},showSplitViewFormat:{id:"action.showSplitViewFormat.name",defaultMessage:"Split"},searchPlaceholder:{defaultMessage:"Search for a languageâ€¦",id:"codeBlock.searchPrompt"},backgroundColorDefaultKeywords:{id:"action.backgroundColor.default.fuzzySearchKeyword",defaultMessage:"Default Black White"},foregroundColorGrayKeywords:{id:"action.foregroundColor.gray.fuzzySearchKeyword",defaultMessage:"Grey Gray"},backgroundColorGrayKeywords:{id:"action.backgroundColor.gray.fuzzySearchKeyword",defaultMessage:"Grey Gray background Greybackground Graybackground"},foregroundColorBrownKeywords:{id:"action.foregroundColor.brown.fuzzySearchKeyword",defaultMessage:"Brown"},backgroundColorBrownKeywords:{id:"action.backgroundColor.brown.fuzzySearchKeyword",defaultMessage:"Brown background Brownbackground"},foregroundColorOrangeKeywords:{id:"action.foregroundColor.orange.fuzzySearchKeyword",defaultMessage:"Orange"},backgroundColorOrangeKeywords:{id:"action.backgroundColor.orange.fuzzySearchKeyword",defaultMessage:"Orange background Orangebackground"},foregroundColorYellowKeywords:{id:"action.foregroundColor.yellow.fuzzySearchKeyword",defaultMessage:"Yellow"},backgroundColorYellowKeywords:{id:"action.backgroundColor.yellow.fuzzySearchKeyword",defaultMessage:"Yellow background Yellowbackground"},foregroundColorTealKeywords:{id:"action.foregroundColor.teal.fuzzySearchKeyword",defaultMessage:"Teal green"},backgroundColorTealKeywords:{id:"action.backgroundColor.teal.fuzzySearchKeyword",defaultMessage:"Teal green background Tealbackground Greenbackground"},foregroundColorBlueKeywords:{id:"action.foregroundColor.blue.fuzzySearchKeyword",defaultMessage:"Blue"},backgroundColorBlueKeywords:{id:"action.backgroundColor.blue.fuzzySearchKeyword",defaultMessage:"Blue background Bluebackground"},foregroundColorPurpleKeywords:{id:"action.foregroundColor.purple.fuzzySearchKeyword",defaultMessage:"Purple"},backgroundColorPurpleKeywords:{id:"action.backgroundColor.purple.fuzzySearchKeyword",defaultMessage:"Purple background Purplebackground"},foregroundColorPinkKeywords:{id:"action.foregroundColor.pink.fuzzySearchKeyword",defaultMessage:"Pink"},backgroundColorPinkKeywords:{id:"action.backgroundColor.pink.fuzzySearchKeyword",defaultMessage:"Pink background Pinkbackground"},foregroundColorRedKeywords:{id:"action.foregroundColor.red.fuzzySearchKeyword",defaultMessage:"Red"},backgroundColorRedKeywords:{id:"action.backgroundColor.red.fuzzySearchKeyword",defaultMessage:"Red background Redbackground"},backgroundSectionKeywords:{id:"action.section.background.fuzzySearchKeywords",defaultMessage:"Color Background"},backgroundSection:{id:"action.section.background",defaultMessage:"Background"},colorSection:{id:"action.section.color",defaultMessage:"Color"},colorName:{id:"action.color.name",defaultMessage:"Color"},duplicateCollectionSchemaOnlyName:{id:"action.duplicateSchemaOnly.name",defaultMessage:"Duplicate without content"},duplicateCollectionWithDataName:{id:"action.duplicateWithData.name",defaultMessage:"Duplicate with content"}}),x=e=>{let{title:t}=e;return t},I={maxWidth:400,whiteSpace:"pre-wrap"};function C(e){const{key:t,displayName:o,displayNameInterpolatedValues:n,contextualDisplayName:r,analyticsName:i,analyticsActionType:a,fuzzySearchKeywords:s,svg:l,validators:c,shortcuts:d,sortScoreMultiplier:p,closeParentMenu:u,action:m,subActions:g,collapseSubActionsIntoParent:h,nativeRender:f,alwaysShowInSearch:y,right:v,renderTooltip:b,userProvidedSearchName:S}=e,{formattedDisplayName:_,searchName:w}=M({displayName:o,displayNameInterpolatedValues:n,userProvidedSearchName:S,fuzzySearchKeywords:s});return{key:`action ${t}`,displayName:_,analyticsName:i,analyticsActionType:a,searchName:w,validators:c,shortcuts:d,sortScoreMultiplier:p,action:m,subActions:g,collapseSubActionsIntoParent:h,closeParentMenu:u,render:e.render??P({svg:l,formattedDisplayName:_,right:v,contextualDisplayName:r,shortcut:d[0],renderTooltip:b}),nativeRender:f,alwaysShowInSearch:y}}function T(e){const{key:t,displayName:o,displayNameInterpolatedValues:n,contextualDisplayName:r,analyticsName:i,analyticsActionType:a,fuzzySearchKeywords:s,svg:l,validators:c,sortScoreMultiplier:d,closeParentMenu:p,action:u,subActions:m,collapseSubActionsIntoParent:g,nativeRender:h,alwaysShowInSearch:f,right:y,renderTooltip:v,userProvidedSearchName:b}=e,{formattedDisplayName:S,searchName:_}=M({displayName:o,displayNameInterpolatedValues:n,userProvidedSearchName:b,fuzzySearchKeywords:s});return{key:`action ${t}`,displayName:S,analyticsName:i,analyticsActionType:a,searchName:_,validators:c,sortScoreMultiplier:d,action:u,subActions:m,collapseSubActionsIntoParent:g,closeParentMenu:p,render:e.render??P({svg:l,formattedDisplayName:S,right:y,contextualDisplayName:r,renderTooltip:v}),nativeRender:h,alwaysShowInSearch:f}}function M(e){const{displayName:t,displayNameInterpolatedValues:o,fuzzySearchKeywords:n,userProvidedSearchName:r}=e,i=t?b.default.formatMessage(t,o):void 0,a=n||t,s=n?b.default.formatMessage(n):i;let l=r;return l||(l=a?s===a.defaultMessage?s:`${s} ${a.defaultMessage}`:void 0),{formattedDisplayName:i,searchName:l}}function P(e){const{formattedDisplayName:t,svg:o,shortcut:n,right:r,renderTooltip:i}=e;return(a,s,l)=>{const d=(e.contextualDisplayName?e.contextualDisplayName(s):void 0)||t;return(0,w.jsx)(h.Z,{render:e=>(0,w.jsx)(c.Z,{...(0,_.Z)(a,e),title:d,svg:o,shortcut:n,right:"function"==typeof r?r(a,s,l):r}),renderTooltip:()=>(0,w.jsx)("div",{style:I,children:null==i?void 0:i({title:d})}),disableTooltip:!i,placement:h.Z.Placement.Right})}}function A(e){const{key:t,title:o,overrideSearchTitle:n,render:r,actions:i}=e,a=o?b.default.formatMessage(o):void 0,s=n||o,l=s&&b.default.formatMessage(s);return{key:t,title:a,searchTitle:s?l===s.defaultMessage?l:`${l} ${s.defaultMessage}`:void 0,render:r,actions:i}}function D(e){const{key:t,displayName:o,displayNameInterpolatedValues:n,analyticsName:r,validators:i,subActions:a,collapseSubActionsIntoParent:s,svg:l,icon:g,right:h,width:y,initialFocus:v}=e,b=T({key:`extension ${t}`,displayName:o,displayNameInterpolatedValues:n,analyticsName:r,validators:i,subActions:a,collapseSubActionsIntoParent:s,closeParentMenu:!0,action:()=>{},render:(e,t,o)=>(0,w.jsx)(f.Z,{...e,renderOrigin:(e,t)=>l?(0,w.jsx)(c.Z,{...e,title:b.displayName,svg:l,right:h,ref:t}):(0,w.jsx)(p.Z,{...e,title:b.displayName,icon:g,right:h,ref:t}),onFocus:o.onFocus,renderExtension:(e,n)=>{let r;return r=t.environment.device.isPhone?{menuType:S.og.Modal,right:(0,w.jsx)(m.DoneMenuText,{}),onClickRight:n.close,...e}:{menuType:S.og.Popup,width:y??220,...e},(0,w.jsx)(u.Z,{...r,children:(0,w.jsx)(d.Z,{initialFocus:v??0,context:t,sections:a(t),onAccept:o.onAccept})})}})});return b}const B=[y.ff(y.P9(n.Ti.externalObjectInstancePage)),y.ff(y.K5),y.or([y.QL("collection_typed_db_duplication"),y.ff(y.Rg),y.f7]),y.J5,y.ff((e=>e.blocks.some((e=>e.isDefined()&&(0,v.h7)(e))))),y.vd];function R(e){return T({key:`format ${e.key}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:e.validators,render:(t,o,n)=>{let{blocks:r,environment:i}=o;const a=r[0].getFormat(),s=Boolean(a[e.property]),{isMobile:l}=i.device;return(0,w.jsx)(g.Z,{...t,title:e.label,icon:e.svg?(0,w.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.svg({width:l?20:17,height:l?20:17})}):void 0,on:s})},closeParentMenu:!1,action:t=>{let{environment:o,blocks:n}=t;l.createAndCommit({userAction:"actionRegistry.createFormatAction",environment:o,perform:t=>{const r=n[0],i=r.getFormat(),a=!Boolean(i[e.property]);s.FH({stores:[r],update:{[e.property]:a},transaction:t}),e.afterAction(a,o)}})}})}function E(e){switch(e){case"default":return k.backgroundColorDefaultKeywords;case"gray":return k.foregroundColorGrayKeywords;case"gray_background":return k.backgroundColorGrayKeywords;case"brown":return k.foregroundColorBrownKeywords;case"brown_background":return k.backgroundColorBrownKeywords;case"orange":return k.foregroundColorOrangeKeywords;case"orange_background":return k.backgroundColorOrangeKeywords;case"yellow":return k.foregroundColorYellowKeywords;case"yellow_background":return k.backgroundColorYellowKeywords;case"teal":return k.foregroundColorTealKeywords;case"teal_background":return k.backgroundColorTealKeywords;case"blue":return k.foregroundColorBlueKeywords;case"blue_background":return k.backgroundColorBlueKeywords;case"purple":return k.foregroundColorPurpleKeywords;case"purple_background":return k.backgroundColorPurpleKeywords;case"pink":return k.foregroundColorPinkKeywords;case"pink_background":return k.backgroundColorPinkKeywords;case"red":return k.foregroundColorRedKeywords;case"red_background":return k.backgroundColorRedKeywords;default:return(0,i.t1)(e)}}function F(e,t,o){const n=e.device.isAndroid?(0,r.gh)({theme:"light"}):(0,r.gh)({theme:e.ThemeStore.state.mode}),i=(0,r.fi)(t,n);let a,s,l;const c="default"!==t;t.includes("background")||null!=o&&o.includes("background")?(a="background",s=c?"square.fill":"square",l="textBackgroundColor"):(a="color",s="character",l="textColor");const d=a in i?i[a]:void 0,p=d&&(0,r.J1)(d);return{sfProGlyphName:s,localImageIdentifier:l,imageTintColor:c?p:void 0}}},52229:(e,t,o)=>{o.d(t,{k:()=>u});o(21703);var n=o(15145),r=o(41432),i=o(4615),a=o(21202),s=o(70279),l=o(95477),c=o(98165),d=o(35661),p=o(9953);function u(e){const{environment:t,parentBlock:o,targetStore:u,transaction:m}=e;if(!u.isDefined())throw new Error("Target store was not defined.");if(!o.isDefined())throw new Error("Parent block store was not defined.");const g=(0,i.ZP)(),h=u instanceof d.G;let f;if(!h){if(c.Dg(u)&&u.isDefined()){const e=u.getParentStore(),t=null==e?void 0:e.getParentStore();var y;if(null!=e&&e.isDefined())f=null==t||null===(y=t.getModel())||void 0===y?void 0:y.getRenderUrl({getRecordModel:u.getRecordModel,baseUrl:l.default.domainBaseUrl,discussionId:e.id,pageVisitSource:n.tY.LinkInPage})}}const v={id:g,type:r.Ti.alias,format:{alias_pointer:{table:h?a.iU:s.x_,id:u.id,spaceId:u.getSpaceId()},comment_alias_url:f},parent_id:o.id,parent_table:"block",alive:!0,space_id:o.getSpaceId()};return p.ae({environment:t,table:"block",value:v,inMemoryRecordCache:o.inMemoryRecordCache,transaction:m}),d.G.createChildStore(o.getContentStore(),{table:a.iU,id:g,spaceId:o.getSpaceId()})}},50906:(e,t,o)=>{o.d(t,{$1W:()=>Wl,$24:()=>Ii,$5Z:()=>es,$B1:()=>ap,$CH:()=>Io,$DM:()=>be,$KP:()=>ga,$Xl:()=>dr,$aC:()=>Ql,$eA:()=>Pc,$fF:()=>ld,$kb:()=>To,$lT:()=>xe,$qu:()=>kn,$zQ:()=>ra,A01:()=>Wi,A6G:()=>dn,ADR:()=>Le,AMz:()=>le,AQD:()=>Vi,ASv:()=>sl,Af_:()=>Nr,Al4:()=>Zn,An9:()=>Ca,AqV:()=>Nt,Ar6:()=>Ma,B3N:()=>ul,BI8:()=>Os,BLZ:()=>fe,BPl:()=>gr,BR:()=>Ps,BWF:()=>ec,Bb7:()=>K,Bdq:()=>Ol,BgI:()=>Ft,Bp3:()=>Fs,BpO:()=>Vc,Byg:()=>la,C$e:()=>Me,CBn:()=>Vn,CDl:()=>ka,CNn:()=>vp,Cdl:()=>yt,Cez:()=>_c,CgF:()=>jp,CgP:()=>Ua,Cis:()=>qd,Cm3:()=>qs,Cug:()=>Nd,D6i:()=>de,D6j:()=>dt,DB2:()=>ta,DCH:()=>As,DRv:()=>nn,DUp:()=>Zs,DWr:()=>Js,Dah:()=>rl,DcE:()=>Tt,DnI:()=>zd,DoK:()=>yc,E0y:()=>Ci,E50:()=>Mi,EDS:()=>qo,EH8:()=>xs,EJs:()=>Us,EKj:()=>He,EUb:()=>ft,EUq:()=>fl,EVQ:()=>Ns,Ebd:()=>Ts,EfR:()=>Gd,Eml:()=>ms,Esd:()=>re,F4S:()=>Ml,FBk:()=>Ws,FGU:()=>Ba,FIS:()=>nt,FNU:()=>dc,FRI:()=>Mt,FRk:()=>ja,FT:()=>Rr,FjP:()=>sa,Fn4:()=>Lo,Fo$:()=>ea,Fsx:()=>Aa,G14:()=>on,G7$:()=>fc,G7t:()=>at,Gbs:()=>wl,GkL:()=>me,GlI:()=>Xo,Glf:()=>it,Gpy:()=>Kl,H6t:()=>Un,HCf:()=>Uc,HH5:()=>Wd,HNg:()=>jl,HU0:()=>Ko,HYP:()=>wa,Hcc:()=>Lr,Her:()=>Oi,ICF:()=>Ic,IEe:()=>we,IMD:()=>Pr,IMV:()=>We,IN8:()=>Ys,IR:()=>gp,IVn:()=>zs,IWJ:()=>Yl,Ib5:()=>ee,If_:()=>vi,Iow:()=>Ep,IvM:()=>ll,IwD:()=>Jc,J7i:()=>ye,JX1:()=>rp,Jed:()=>Qa,Jgl:()=>Jo,Jin:()=>En,JkE:()=>_p,JoV:()=>op,JpJ:()=>Si,JrP:()=>jo,JvT:()=>Tc,Jw_:()=>Rd,K1b:()=>Qn,KCu:()=>Qc,KFD:()=>tp,KIh:()=>gi,KZ:()=>Dp,Kf$:()=>ai,Kge:()=>hd,Khd:()=>Ld,KkZ:()=>Cs,L3B:()=>tt,LAz:()=>kl,LBE:()=>gc,LC7:()=>xd,LDb:()=>rn,LEn:()=>Wn,LMg:()=>Bi,LOF:()=>np,LSY:()=>Ac,LYj:()=>jt,LbR:()=>ed,Lc3:()=>Ct,Le6:()=>Sp,Lfx:()=>Bc,Ls9:()=>qt,MEX:()=>ba,MRb:()=>fa,MU3:()=>Tn,McA:()=>Id,Md8:()=>da,MdY:()=>Va,Mp:()=>pl,Mqg:()=>na,Mzl:()=>fn,NF$:()=>Rc,NFM:()=>Qd,NGq:()=>ge,NIS:()=>po,NLO:()=>qr,NMx:()=>G,NOz:()=>Vl,NgT:()=>Mo,Ngp:()=>Ls,O$H:()=>Li,O8I:()=>Pi,O8v:()=>oi,OFH:()=>fo,OK8:()=>to,ORE:()=>tc,OSl:()=>Pd,OXe:()=>Kt,Ogr:()=>Qt,Omp:()=>Rp,Opj:()=>Xi,Otz:()=>Ta,P$y:()=>ir,P0l:()=>wp,P1A:()=>$d,P9p:()=>Fi,PBo:()=>oe,PEc:()=>tn,PHO:()=>Di,PL3:()=>Oe,PL5:()=>Er,PNo:()=>Dt,PR:()=>Vs,P_7:()=>ys,PdU:()=>Jr,Pgp:()=>io,Phj:()=>pc,Prc:()=>ql,Pu8:()=>ne,PyM:()=>Zo,Q4L:()=>ce,QFO:()=>Cc,QIc:()=>Ho,QOK:()=>Ht,QUd:()=>en,QZR:()=>te,QdK:()=>Ri,QkQ:()=>oc,Qqh:()=>Tr,R9m:()=>vs,RJe:()=>qa,RLv:()=>Nc,ROv:()=>hr,Rb9:()=>oa,Rbv:()=>Xr,RcY:()=>Bn,Rm2:()=>fd,RnH:()=>Ja,S4I:()=>Pp,SCe:()=>ml,SJp:()=>sc,SK1:()=>Ir,SLv:()=>Al,SMF:()=>hi,SMS:()=>$t,SOV:()=>lt,SUR:()=>ds,SUq:()=>Ni,SYd:()=>De,Se:()=>va,Sh9:()=>vt,Snv:()=>ze,SwX:()=>ti,Syn:()=>et,T2x:()=>X,T3Y:()=>Ee,T4J:()=>Hd,TCs:()=>ki,TIz:()=>Sr,TJ1:()=>Mp,TJp:()=>mi,TLh:()=>Re,TPH:()=>ao,Ti_:()=>hp,Tlp:()=>Lc,UD4:()=>Q,UD9:()=>Gl,UJm:()=>Dr,UJr:()=>gn,UWw:()=>_i,UZT:()=>An,Uk:()=>Wo,Uut:()=>Cd,UwD:()=>ps,V0c:()=>Ei,V5j:()=>Bs,VJs:()=>Ga,VN$:()=>Cr,VQs:()=>Bt,VSH:()=>ya,VTb:()=>pr,VUL:()=>je,VZZ:()=>Ze,V_i:()=>zo,VaH:()=>Ji,Vaw:()=>Pa,VfZ:()=>ot,ViF:()=>Cp,VoR:()=>Fc,Vry:()=>yp,W2j:()=>_o,WCB:()=>ws,WFT:()=>er,WP:()=>Wc,Wbl:()=>qi,Wg6:()=>se,Wlu:()=>Uo,Wr9:()=>oo,X0y:()=>Yo,XCt:()=>Td,XI1:()=>ji,XQ5:()=>Eo,XTk:()=>uc,XWf:()=>H,XXm:()=>rr,XbW:()=>ri,XwB:()=>Zc,XyT:()=>Go,Y35:()=>Yi,Y4z:()=>Od,Y7v:()=>Ap,Y8X:()=>pn,YFJ:()=>Ki,YMV:()=>fr,YO0:()=>so,YOV:()=>Da,YP3:()=>ic,YTO:()=>St,YU0:()=>_n,YVI:()=>ke,YY6:()=>Y,YYl:()=>Hs,Y_F:()=>El,YcY:()=>bc,YdN:()=>fp,Yg1:()=>ua,YnN:()=>Dd,Yo0:()=>xr,Yz2:()=>os,Z0d:()=>_r,Z36:()=>rt,Z41:()=>Ss,Z9y:()=>$s,ZAW:()=>Ip,ZEy:()=>Ad,ZW8:()=>Ya,ZZ8:()=>jn,ZaS:()=>od,Zbu:()=>zt,ZfC:()=>Is,Zh2:()=>Za,Zm$:()=>Xd,Zmw:()=>nl,Zq6:()=>el,Zrf:()=>ar,Zvm:()=>Bp,ZyU:()=>_d,ZzP:()=>bs,_0h:()=>he,_6M:()=>pp,_Hi:()=>wn,_T2:()=>sn,_Wj:()=>ie,_eA:()=>Oc,_fo:()=>Es,_g0:()=>J,_jH:()=>Ut,_mq:()=>sp,_qN:()=>Ot,_xm:()=>dl,a1y:()=>Je,a5A:()=>vo,a6v:()=>un,a7O:()=>Ve,aOs:()=>vc,aT6:()=>up,air:()=>Sa,amv:()=>Yd,apd:()=>Dl,ax_:()=>Ie,ays:()=>Qe,azK:()=>wc,b0I:()=>kt,b9E:()=>eo,bOx:()=>ut,bRT:()=>Ed,bRx:()=>Wr,bRy:()=>rs,bd0:()=>Gc,bfr:()=>bt,bmu:()=>bl,bwR:()=>ei,c7L:()=>Rs,cOL:()=>bi,cV4:()=>pt,cXp:()=>Hl,cYL:()=>Et,cir:()=>Ti,coX:()=>hc,ctm:()=>No,d2c:()=>as,dE3:()=>Yr,dSV:()=>Hr,dUJ:()=>fi,dZq:()=>Ro,d_o:()=>Yt,dan:()=>li,dhV:()=>Vo,duO:()=>Or,dw6:()=>Xn,dwr:()=>lp,dyr:()=>$,e2:()=>rd,e7E:()=>Ce,eO1:()=>xc,eRW:()=>il,eT_:()=>an,ebp:()=>Fe,efr:()=>Kc,elP:()=>$o,enX:()=>Bo,enk:()=>lr,eoz:()=>Hi,ers:()=>Xl,esN:()=>ae,ewV:()=>br,f73:()=>ca,fAb:()=>$a,fMl:()=>cr,fNH:()=>Lp,fP8:()=>Ae,fW6:()=>Mc,fZH:()=>At,fco:()=>Ks,fho:()=>Ms,g0v:()=>ci,g3X:()=>Wt,g9P:()=>Ai,gEE:()=>Xc,gL0:()=>dd,gMH:()=>La,gP4:()=>or,gRe:()=>Qr,g_f:()=>qc,g_k:()=>Fr,gl7:()=>ui,gw_:()=>qn,h$X:()=>$c,h23:()=>Rl,hEo:()=>wi,hJ5:()=>cs,hYM:()=>Kr,hov:()=>ue,hym:()=>yn,iA$:()=>Mr,iBN:()=>Il,iDe:()=>kd,iHH:()=>wr,iIY:()=>Be,iIv:()=>Qs,iL9:()=>Rt,iRP:()=>On,iSD:()=>lo,ieV:()=>W,ikP:()=>Rn,iwE:()=>Kn,ixp:()=>zl,j1w:()=>yr,j72:()=>ip,jBu:()=>Ur,jDo:()=>Ra,jMN:()=>id,jPN:()=>Ye,jRT:()=>Oo,jWY:()=>Po,jXQ:()=>ns,j_p:()=>ud,jdc:()=>pd,jhO:()=>Zt,jkE:()=>Np,jw0:()=>ho,k$J:()=>ss,k1K:()=>It,k6o:()=>Lt,kLN:()=>Wa,kVp:()=>Ds,kY8:()=>Cl,kjl:()=>ur,kmb:()=>tr,kq7:()=>ia,krX:()=>Ul,kyK:()=>td,kz9:()=>Ka,l0P:()=>Kd,l7z:()=>pi,lLZ:()=>ts,lLm:()=>cl,lO:()=>bp,lfq:()=>Hn,lgT:()=>Pn,ljn:()=>mo,llH:()=>js,m0A:()=>Yc,mCV:()=>Qo,mFL:()=>$l,mcx:()=>Fl,meY:()=>jd,mfs:()=>ln,mgu:()=>yd,miu:()=>Jl,mt_:()=>hn,n1D:()=>Ao,n4j:()=>di,n8f:()=>ro,nBz:()=>Ea,nCD:()=>yi,nKJ:()=>ad,nLf:()=>ks,ndA:()=>_t,neX:()=>zn,nlj:()=>go,nnP:()=>Bd,o0U:()=>Gr,o7O:()=>_e,o8J:()=>Op,oIe:()=>Xt,oQL:()=>gl,oSR:()=>mt,o_A:()=>Zl,ovL:()=>zc,p5p:()=>Pe,pCf:()=>mp,pPS:()=>us,pRQ:()=>Tp,pZG:()=>gt,phe:()=>ol,piC:()=>Nl,piO:()=>kr,ppr:()=>hl,psf:()=>Zi,q5U:()=>$e,q7Y:()=>wt,qA6:()=>gd,qBg:()=>bo,qDg:()=>fs,qG2:()=>jc,qJZ:()=>st,qJp:()=>ve,qPY:()=>Ui,qTS:()=>ni,qYb:()=>Ia,q_n:()=>xi,qyQ:()=>Xe,qzU:()=>Pt,r5L:()=>Dn,rFP:()=>cc,rNQ:()=>Co,rOZ:()=>ht,rTg:()=>Ec,rYq:()=>cn,rZ2:()=>Sd,rZG:()=>ep,rit:()=>Vd,rvR:()=>dp,rvl:()=>Sn,rx3:()=>Ue,rxu:()=>Gt,s$$:()=>vd,s4j:()=>kc,s8J:()=>Vr,sA6:()=>co,sGw:()=>bn,sIE:()=>Pl,sS1:()=>Sl,sSR:()=>aa,sYL:()=>Fo,sdb:()=>vn,sos:()=>_a,sxo:()=>wo,t8_:()=>ha,tBP:()=>Fp,tMA:()=>Nn,tPt:()=>ma,tXe:()=>xp,tZo:()=>Qi,tfS:()=>Xs,tir:()=>Sc,tmQ:()=>Oa,tn$:()=>jr,txh:()=>Zr,uAt:()=>mc,uCY:()=>Gn,uDZ:()=>Yn,uSc:()=>nd,ubm:()=>za,udZ:()=>nr,uul:()=>ct,ux6:()=>pe,uyp:()=>Gs,v$O:()=>tl,v2V:()=>Ll,v2k:()=>Mn,vCG:()=>cp,vN5:()=>cd,vVs:()=>yo,vcz:()=>xo,vd1:()=>Te,vkP:()=>_l,vqh:()=>$i,vtR:()=>xl,vwI:()=>Jt,w3M:()=>Na,w6U:()=>mn,wFN:()=>_s,wVl:()=>Jd,wWx:()=>wd,wds:()=>Cn,wi:()=>al,wjW:()=>no,wkd:()=>Dc,wlq:()=>Vt,wql:()=>qe,wrY:()=>zi,wtf:()=>md,wy9:()=>Ar,wz6:()=>bd,x6y:()=>is,x8E:()=>kp,x91:()=>Ge,xGP:()=>Gi,xYN:()=>vl,xbC:()=>In,xh4:()=>Br,xim:()=>Md,xtf:()=>si,xti:()=>xa,xud:()=>Ha,xx2:()=>Fa,y$F:()=>xt,y2U:()=>$n,y4:()=>pa,y6P:()=>Se,y9R:()=>Tl,y9e:()=>xn,yEH:()=>zr,yT1:()=>Jn,ya1:()=>gs,yaj:()=>Zd,ybK:()=>Ke,ye:()=>Do,yeF:()=>Ud,yef:()=>sd,yjq:()=>sr,yrm:()=>Xa,yvO:()=>Ne,z01:()=>mr,z2b:()=>uo,z7J:()=>vr,zIF:()=>Ln,zP:()=>ko,zQ6:()=>Bl,zUE:()=>ii,zah:()=>nc,zdn:()=>ls,zes:()=>Fn,zim:()=>Hc});o(57658);var n=o(1302),r=o(79946),i=o(15145),a=o(45433),s=o(33728),l=o(30845),c=o(72126),d=o(27006),p=o(29477),u=o(4615),m=o(99405),g=o(19889),h=o(9852),f=o(2438),y=o(49902),v=o(97880),b=o(64002),S=o(63143),_=o(54642),w=o(47839),k=o(95477),x=o(24215),I=o(28020),C=o(15010),T=o(75079),M=o(12955),P=o(71776),A=o(45101),D=o(14654),B=o(68418),R=o(55838),E=o(80444),F=o(77080),N=o(29677),j=o(35661),O=o(87956),L=o(27724),U=o(78291),Z=o(88893),V=o(35057),q=o(39699),z=o(37181);function W(e,t){x.$A({environment:e,userId:(0,u.F9)(t.user_id),traits:{...t,...t.tags?{original_tags:t.tags}:void 0,user_id:(0,u.F9)(t.user_id)}})}function H(e,t){x.$A({environment:e,userId:(0,u.F9)(t.user_id),traits:{...t,user_id:(0,u.F9)(t.user_id)}})}async function G(){await x.NM()}async function K(e){const{environment:t,experiment_id:o,experiment_group:n,experiment_version:r,logging_source:i}=e,a=(0,h.getSessionExperimentExposure)(o),s=await(0,M.getExperimentDeviceId)(t);Boolean(a)&&a===(0,h.getCombinedExperimentValue)(r,n)||(x.j(t,"experiment_exposure",{experiment_id:o,experiment_group:n,experiment_version:r,experiment_device_id:s,logging_source:i}),(0,h.setSessionExperimentExposure)(o,n,r))}function $(e,t){x.j(e,"download_desktop_app",t)}function Y(e,t){x.j(e,"download_mobile_app",t)}function Q(e,t){x.j(e,"getCompletion.emptyResponse",t),F.default.logEvent("getCompletion.emptyResponse",1,{promptKey:t.promptKey})}function J(e,t){const{name:o,...n}=t;x.j(e,"click_link",{...n,click_name:o})}function X(e){x.j(e,"browse_more_templates_click"),F.default.logEvent("browse_more_templates_click",1)}function ee(e){x.j(e,"in_app_template_gallery_brand_click")}function te(e,t){x.j(e,"scroll",t)}function oe(e,t){const{page_id:o,query:n,team_id:r,page_visit_id:a,previous_page_visit_id:s,...l}=t,c=b.Ph(n,i.$X),d=parseInt(c),p="push"===e.RouterStore.getState().action,u=(0,i.bh)(d)&&p?i.tY.LinkInPage:(0,i.xt)(d),m=b.Ph(n,i.Qs),g=(0,D.t3)({blockOrCollectionId:o});x.j(e,"page_visit",{...l,page_visit_source:u,notificationId:m,page_visit_id:a,previous_page_visit_id:s,entered_at:Date.now(),home_page_type:g},{forceOverrideAutomaticEventData:{team_id:r}})}function ne(e,t){F.default.checkGate("log_page_exit_events_to_analytics")&&x.j(e,"page_exit",{exited_at:Date.now(),page_visit_id:t.pageVisitId},{forceOverrideAutomaticEventData:t})}function re(e){const t=[{name:"initial_partner_stack_key",value:e.partner_stack_key,operation:"setOnce"},{name:"partner_stack_key",value:e.partner_stack_key,operation:"set"}];x.fK(t)}function ie(e,t){const o=b.nx(t,(0,h.getUrlAnalyticsFromSessionStorage)());if(o){const{fbclid:e,gclid:t}=o;e&&r.xx({type:"facebook",id:e}),t&&r.xx({type:"google",id:t}),(0,h.saveUrlAnalyticsInSessionStorage)(o)}x.j(e,"visit",{})}function ae(e,t){x.j(e,"database_visit",t)}function se(e,t){x.lu(e,"type_aggregated_database_visit",`type_aggregated_database_visit-${t.databaseType}`,60,t)}function le(e,t){x.j(e,"page_error",t)}function ce(e,t){x.j(e,"reorder_workspaces",t)}function de(e,t){x.j(e,"multi_account_add_or_create_account_clicked",t)}function pe(e){x.j(e,"content_classification_proceed")}function ue(e,t){x.j(e,"onboarding_dialog_error",t),_e(e,"onboarding_dialog_error",t)}function me(e,t){x.j(e,"onboarding_error",t),_e(e,"onboarding_error",t)}function ge(e,t){if(x.j(e,"onboarding_show",t),F.default.logEvent("onboarding_show",1,{...t}),t.is_new_onboarding){var o;const{currentUserSettingsStore:e}=E.default.getState();F.default.logEvent("sign_up_by_domain_type",null==e||null===(o=e.getSettings())||void 0===o?void 0:o.domain_type,{})}}function he(e,t){x.j(e,"onboarding_invite_copy",t),_e(e,"onboarding_invite_copy",t)}function fe(e,t){x.j(e,"onboarding_close",t),_e(e,"onboarding_close",t)}function ye(e,t){x.j(e,"onboarding_skip",t),_e(e,"onboarding_skip",t)}function ve(e,t){x.j(e,"onboarding_invite_send",t),_e(e,"onboarding_invite_send",t)}function be(e,t){x.j(e,"onboarding_space_icon_upload",t),_e(e,"onboarding_space_icon_upload",t)}function Se(e,t){x.j(e,"onboarding_stage",t),F.default.logEvent("onboarding_stage",1,{stage:t.stage,workspace_type:t.initial_workspace_type,is_new_onboarding:t.is_new_onboarding,device_type:e.device.deviceType}),F.default.logEvent("onboarding_stage_by_stage",t.stage,{}),F.default.logEvent("onboarding_stage_by_is_new_user_onboarding",t.is_new_onboarding.toString(),{}),F.default.logEvent("onboarding_stage_by_device_type",e.device.deviceType,{})}function _e(e,t,o){x.j(e,"onboarding_serverside",{...o,phase:t},{dontWait:!0})}function we(e,t){x.j(e,"onboarding_join_space_click",t),F.default.logEvent("onboarding_join_space_click",t.joined_space_index,{...t})}function ke(e,t){x.j(e,"onboarding_invite_click",t);const{invited_emails:o,...n}=t;F.default.logEvent("onboarding_invite_click",o.length,{...n})}function xe(e,t){x.j(e,"onboarding_invite_attempt",t)}function Ie(e,t){x.j(e,"onboarding_upload_profile_photo",t)}function Ce(e,t){x.j(e,"onboarding_join_space",t)}function Te(e,t){x.j(e,"onboarding_create_space",t)}function Me(e,t){x.j(e,"onboarding_plan_type_select",t),F.default.logEvent("onboarding_plan_type_select",t.planType,{...t})}function Pe(e,t){x.j(e,"onboarding_persona_select",t),F.default.logEvent("onboarding_persona_select","persona",{...t})}function Ae(e,t){x.j(e,"onboarding_persona_select",t),F.default.logEvent("onboarding_persona_select","role",{...t})}function De(e,t){x.j(e,"onboarding_persona_select",t),F.default.logEvent("onboarding_persona_select","useCases",{...t})}function Be(e,t){x.j(e,"onboarding_persona_select",t),F.default.logEvent("onboarding_persona_select","companySize",{...t})}function Re(e,t){x.j(e,"onboarding_persona_survey_action",{...t,action:t.action}),F.default.logEvent("onboarding_persona_survey_action",t.action,{}),F.default.logEvent(`onboarding_persona_survey_action_${t.action}`,t.plan_selection,{})}function Ee(e,t){x.j(e,"notion_topbar_click",t,{dontWait:!0}),F.default.logEvent("notion_topbar_click",t.variant)}function Fe(e,t){x.j(e,"template_gallery_public_page_topbar_click",t,{dontWait:!0}),F.default.logEvent("template_gallery_public_page_topbar_click",t.target)}function Ne(e,t){x.j(e,"getting_started_page_create",t)}function je(e,t){x.j(e,"debug_getting_started_page_error",t)}function Oe(e,t){var o,n;const{currentUserSettingsStore:i,currentUserRootStore:a}=E.default.state,s=F.default.getExperimentsMap();x.Zf(e,{onboarding_complete:!0,onboarding_emails_experiment:s["onboarding-emails"]}),x.j(e,"onboarding_complete",t),r.PL(),F.default.logEvent("onboarding_complete",1,{domain_type:null==i||null===(o=i.getSettings())||void 0===o?void 0:o.domain_type,device_type:e.device.deviceType,is_new_onboarding:t.is_new_onboarding,is_professional_team_user:(0,C.QZ)(),user_persona:t.user_persona,plan_type:t.plan_type,create_or_join:t.initial_workspace_type}),F.default.logEvent("onboarding_complete_by_plan_type",t.plan_type,{}),F.default.logEvent("onboarding_complete_by_device_type",e.device.deviceType,{}),F.default.logEvent("onboarding_complete_by_user_persona",t.user_persona,{}),F.default.logEvent("onboarding_complete_by_user_team_role",t.user_team_role,{}),t.user_use_cases&&t.user_use_cases.forEach((e=>{F.default.logEvent("onboarding_complete_by_user_use_case",e,{})})),F.default.logEvent("onboarding_complete_by_domain_type",null==i||null===(n=i.getSettings())||void 0===n?void 0:n.domain_type,{}),F.default.logEvent("onboarding_complete_by_create_or_join_space",t.initial_workspace_type,{}),F.default.logEvent("onboarding_complete_by_is_new_user_onboarding",t.is_new_onboarding.toString(),{}),F.default.logEvent("onboarding_complete_by_workspaces_count",(null==a?void 0:a.getSpaceViewStores().length)||0,{}),(0,C.QZ)()&&F.default.logEvent("pro_team_onboarding_complete",1,{})}function Le(e,t){x.j(e,"proj_management_onboarding_tooltip_show",t),F.default.logEvent("proj_management_tooltip_show")}function Ue(e,t){x.j(e,"proj_management_onboarding_tooltip_dismiss",t),F.default.logEvent("proj_management_tooltip_dismiss")}function Ze(e,t){x.j(e,"onboarding_team_invite_email_entered",t)}function Ve(e,t){x.j(e,"onboarding_team_invite_add_more_clicked",t)}function qe(e,t){x.j(e,"onboarding_bulk_invites_rendered",t)}function ze(e,t){x.j(e,"landing_page_visit",{routerName:t}),(0,p.Vs)(4e3).then((o=>{F.default.logEvent(`${t}_page_visit`,e.device.deviceType,{})}))}function We(e,t){x.j(e,"customer_io_in_app_callout_show",t)}function He(e,t){x.j(e,"customer_io_in_app_callout_suppress",t)}function Ge(e,t){x.j(e,"customer_io_in_app_callout_dismiss",t)}function Ke(e,t){x.j(e,"customer_io_in_app_callout_error",t)}function $e(e,t){x.j(e,"persona_form_step",{event:t.event})}function Ye(e,t){x.j(e,"persona_form_action",{event:t.event})}function Qe(e,t){x.j(e,"import_button_click",t)}function Je(e,t){x.j(e,"import_source_auth",t)}function Xe(e,t){x.j(e,"import_source_input",t)}function et(e,t){x.j(e,"open_import_modal",t)}function tt(e,t){x.j(e,"auth_integration",t)}function ot(e,t){x.j(e,"integration_select_all",t)}function nt(e,t){x.j(e,"integration_deselect_all",t)}function rt(e,t){x.j(e,"integration_select_item",t)}function it(e,t){x.j(e,"integration_deselect_item",t)}function at(e,t){x.j(e,"import_integration",t)}function st(e,t){x.j(e,"remove_integration",t)}function lt(e,t){x.j(e,"integration_prompt_auth",t)}function ct(e){x.j(e,"open_google_drive_file_picker")}function dt(e,t){x.j(e,"google_drive_pick_file",t)}function pt(e,t){x.j(e,"google_drive_embed_file",t)}function ut(e,t){const{pastedText:o}=t;let n;if(l.B(o,"url")){const e=b.Qc(o);e.host&&(n=e.host)}if(n){const{pastedText:o,...r}={...t,url_domain:n};x.j(e,"paste_url",r)}}function mt(e,t){const o=t.url?(0,b.gy)(t.url):void 0;x.j(e,"edit_link",{type:t.type,url_domain:null==o?void 0:o.hostname})}function gt(e){x.j(e,"edit_link_title")}function ht(e,t){x.j(e,"pricing_grid_button_click",t),F.default.logEvent("pricing_grid_button_click",void 0,t),po(e,{location:"plans_page",cta_item:t.plan,currency_code:t.currency_code,page_section:"all_plans_grid",button_text:t.button_text})}function ft(e){x.j(e,"pricing_grid_contact_sales_click")}function yt(e){x.j(e,"add_on_discount_popup_seen")}function vt(e){x.j(e,"add_on_discount_popup_dismissed")}function bt(e,t){x.j(e,"member_requested_ai_addon",t),F.default.logEvent("member_requested_ai_addon",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function St(e,t){x.j(e,"subscription_update_modal_open",t),F.default.logEvent("subscription_update_modal_open",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function _t(e,t){x.j(e,"subscription_update_modal_confirmation_click",{...c.CE(t.state,"modalId"),modal_id:t.state.modalId}),F.default.logEvent("subscription_update_modal_confirmation_click",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function wt(e,t){x.j(e,"subscription_update_modal_exit",{...c.CE(t.state,"modalId"),modal_id:t.state.modalId}),F.default.logEvent("subscription_update_modal_exit",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function kt(e,t){x.j(e,"subscription_update_modal_billing_interval_updated",t),F.default.logEvent("subscription_update_modal_billing_interval_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function xt(e,t){x.j(e,"subscription_update_modal_expand_billing_summary",{...c.CE(t.state,"modalId"),modal_id:t.state.modalId}),F.default.logEvent("subscription_update_modal_expand_billing_summary",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function It(e,t){x.j(e,"subscription_update_modal_hide_billing_summary",{...c.CE(t.state,"modalId"),modal_id:t.state.modalId}),F.default.logEvent("subscription_update_modal_hide_billing_summary",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Ct(e,t){x.j(e,"subscription_upgrade_modal_open",t),F.default.logEvent("subscription_upgrade_modal_open",void 0,t)}function Tt(e,t){const{event:o,modal_id:n}=t,r={...(0,S.by)(o),modal_id:n};x.j(e,"subscription_upgrade_modal_payment_element_changed",r),F.default.logEvent("subscription_upgrade_modal_payment_element_changed",void 0,{...r,device_os:e.device.os,platform:e.device.platform})}function Mt(e,t){x.j(e,"subscription_upgrade_modal_billing_interval_updated",t),F.default.logEvent("subscription_upgrade_modal_billing_interval_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Pt(e,t){x.j(e,"subscription_upgrade_modal_add_on_features_updated",t),F.default.logEvent("subscription_upgrade_modal_add_on_features_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function At(e,t){x.j(e,"subscription_upgrade_modal_upgrade_accepted",t),F.default.logEvent("subscription_upgrade_modal_upgrade_accepted",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Dt(e,t){x.j(e,"subscription_upgrade_modal_upgrade_click",t),F.default.logEvent("subscription_upgrade_modal_upgrade_click",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Bt(e,t){x.j(e,"subscription_upgrade_modal_upgrade_failed_validation",t),F.default.logEvent("subscription_upgrade_modal_upgrade_failed_validation",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Rt(e,t){x.j(e,"subscription_upgrade_onboarding_failed_validation",t)}function Et(e,t){x.j(e,"subscription_upgrade_modal_upgrade_failed_payment",t),F.default.logEvent("subscription_upgrade_modal_upgrade_failed_payment",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Ft(e){x.j(e,"subscription_upgrade_onboarding_failed_payment")}function Nt(e,t){x.j(e,"subscription_upgrade_modal_upgrade_failed_payment_recovery_initiated",t),F.default.logEvent("subscription_upgrade_modal_upgrade_failed_payment_recovery_initiated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function jt(e,t){x.j(e,"subscription_upgrade_modal_exit",t),F.default.logEvent("subscription_upgrade_modal_exit",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Ot(e,t){x.j(e,"subscription_upgrade_modal_stripe_error",t),F.default.logEvent("subscription_upgrade_modal_stripe_error",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Lt(e,t){x.j(e,"create_subscription",t),F.default.logEvent("create_subscription",t.plan,t)}async function Ut(e,t){var o,n;const i=(0,C.JF)(),a=(0,Z.qX)();x.j(e,"update_subscription_tier",{from:t.from,action:t.action,old_subscription_tier:t.oldSubscriptionTier,new_subscription_tier:t.newSubscriptionTier,old_price_id:t.oldPriceId,new_price_id:t.newPriceId,old_currency:t.oldCurrency,new_currency:t.newCurrency,old_add_ons:t.oldAddOns,new_add_ons:t.newAddOns,old_billing_interval:t.oldBillingInterval,new_billing_interval:t.newBillingInterval,is_cancel_subscription:t.isCancelSubscription,is_professional_team:t.isProfessionalTeamUser,domain_type:i,space_visible_members:a,is_trial:t.isTrial}),F.default.logEvent("update_subscription_tier",void 0,{from:t.from,action:t.action,old_subscription_tier:t.oldSubscriptionTier,new_subscription_tier:t.newSubscriptionTier,old_price_id:t.oldPriceId,new_price_id:t.newPriceId,old_currency:t.oldCurrency,new_currency:t.newCurrency,old_add_ons:t.oldAddOns,new_add_ons:t.newAddOns,old_billing_interval:t.oldBillingInterval,new_billing_interval:t.newBillingInterval,is_cancel_subscription:t.isCancelSubscription,space_visible_members:a,is_trial:t.isTrial,device_os:e.device.os,platform:e.device.platform});const s=null===(o=t.oldAddOns)||void 0===o?void 0:o.includes("ai"),l=null===(n=t.newAddOns)||void 0===n?void 0:n.includes("ai");if(!s&&l&&(x.j(e,"ai_addon_purchased",t),r.dG({eventType:"ai_addon_purchased",source:"client"})),!t.oldSubscriptionTier||!t.newSubscriptionTier)return;const{device:c}=e;if(!(0,f.nR)(t.oldSubscriptionTier)&&(0,f.nR)(t.newSubscriptionTier)&&"personal"!==t.newSubscriptionTier){const o={country:t.addressCountry,productName:t.newPriceId,price:t.creditAmount||0,spaceId:(0,u.cj)(t.spaceId),deviceType:c.isTablet?"tablet":c.isMobile?"mobile":"desktop",subscriptionTier:t.newSubscriptionTier};if("professional"===i&&x.j(e,"professional_workspace_upgraded",t),x.j(e,"workspace_upgraded",t),r.dG({eventType:"workspace_upgraded",source:"client",eventData:{...o,domainType:i}}),"professional"===i&&r.dG({eventType:"professional_workspace_upgraded",source:"client"}),"team"===t.planType&&(x.j(e,"team_workspace_upgraded",t),r.dG({eventType:"team_workspace_upgraded",source:"client"})),e.device.isElectron){const n=(0,m.fo)(k.default.domainBaseUrl,{deviceId:await x.cG(e),oldSubscriptionTier:t.oldSubscriptionTier,newSubscriptionTier:t.newSubscriptionTier,isProfessionalTeamUser:t.isProfessionalTeamUser,deviceType:e.device.deviceType,domainType:i,eventData:o});return void w.openExternalUrl(n)}}}function Zt(e,t){x.j(e,"subscription_update_plan",t),F.default.logEvent("subscription_update_plan",void 0,t)}function Vt(e,t){x.j(e,"subscription_update_billing",t),F.default.logEvent("subscription_update_billing",void 0,t)}function qt(e,t){const{step:o,name:n,email:r,...i}=t;x.j(e,"enterprise_sales_contact",{...i,enterprise_name:n,enterprise_email:r}),F.default.logEvent("enterprise_sales_contact")}function zt(e){x.j(e,"enterprise_sales_contact_opened")}function Wt(e){x.j(e,"enterprise_sales_contact_dismissed")}function Ht(e,t){x.j(e,"enterprise_sales_contact_updated",t)}function Gt(e,t){x.j(e,"cancel_subscription",t),F.default.logEvent("cancel_subscription",void 0,t)}function Kt(e,t,o){x.j(e,"churn_survey",{...t,churnType:o})}function $t(e,t,o){x.j(e,"churn_survey_close",{...t,churnType:o})}function Yt(e,t,o){x.j(e,"churn_survey_nudge",{...t,churnType:o})}function Qt(e,t,o){x.j(e,"churn_survey_submitted",{...t,churnType:o})}function Jt(e){const{environment:t,userContractionData:o}=e;x.j(t,"contraction_contextual_confirmation_cancelled",{userContractionData:o})}function Xt(e){const{environment:t,userContractionData:o}=e;x.j(t,"contraction_contextual_confirmation_confirmed",{userContractionData:o})}function eo(e){const{environment:t,userContractionData:o}=e;x.j(t,"contraction_contextual_confirmation_shown",{userContractionData:o})}function to(e){const{environment:t,contractionSurveyId:o,reasons:n,reasonIndexes:r,reasonOther:i}=e;x.j(t,"contraction_survey_completed",{contraction_survey_id:o,reasons:n,reason_indexes:r,reason_other:i})}function oo(e){const{environment:t,contractionSurveyId:o}=e;x.j(t,"contraction_survey_dismissed",{contractionSurveyId:o})}function no(e){const{environment:t,contractionSurveyId:o}=e;x.j(t,"contraction_survey_opened",{contractionSurveyId:o})}function ro(e,t){x.j(e,"currency_select_changed",t)}function io(e,t){x.j(e,"currency_select_dismissed",t)}function ao(e,t){x.j(e,"currency_select_opened",t)}function so(e){x.j(e,"delete_workspace_click"),F.default.logEvent("delete_workspace_click")}function lo(e){x.j(e,"quick_workspace_creation_click"),F.default.logEvent("quick_workspace_creation_click")}function co(e,t){x.j(e,"click_upgrade_button",t),F.default.logEvent("click_upgrade_button",void 0,t)}function po(e,t){x.j(e,"plan_cta_click",t),F.default.logEvent("plan_cta_click",void 0,t)}function uo(e){x.lu(e,"approaching_block_limit","approaching_block_limit",60)}function mo(e){const t=x.lu(e,"reach_block_limit","reach_block_limit",60);F.default.logEvent("reach_block_limit",1),t&&x.Zf(e,{reach_block_limit:!0,reach_block_limit_time:Date.now(),subscription_tier:(0,V.zt)()})}function go(e){x.j(e,"workspace_invite_copy_link")}function ho(e){x.j(e,"currently_subscribed")}function fo(e){x.j(e,"sidebar_promo_click")}function yo(e){x.j(e,"student_plan_prompt_click")}function vo(e){x.j(e,"student_plan_prompt_close_click")}function bo(e,t){x.j(e,"onboarding_desktop_app_download_click",t),F.default.logEvent("onboarding_desktop_app_download_click",1)}const So=c.P2((e=>{x.Zf(e,{created_page:!0})}),864e5,{trailing:!1});function _o(e,t){const{teamStore:o,new_page_id:n,transaction:r,...i}=t;ac(e,"create_block",`create_block-${t.type}-${t.from}`,60,{store:o,...i}),"page"===t.type&&(ic(e,"create_page",{store:o,...i,new_page_id:n}),So(e))}function wo(e,t){x.j(e,"open_peek_as_page",t)}function ko(e,t){x.j(e,"peek_arrow_navigation",t)}function xo(e,t){x.j(e,"close_side_peek",t)}function Io(e,t){x.j(e,"close_peek",t)}function Co(e,t){x.j(e,"select_template",t)}function To(e,t){x.j(e,"desktop_app_signup_browser_visit",{desktop_app_reroute_email:t.desktopAppRerouteEmail,desktop_app_device_id:t.desktopAppDeviceId})}function Mo(e,t){x.j(e,"template_modal_persona_select",t)}function Po(e,t){x.j(e,"template_modal_open",t),F.default.logEvent("template_modal_open",1)}function Ao(e,t){x.j(e,"template_modal_item_click",t),F.default.logEvent("template_modal_item_click",1)}function Do(e,t){x.j(e,"template_modal_get_template_click",t),F.default.logEvent("template_modal_get_template_click",1)}function Bo(e,t){const{team_id:o,...n}=t;x.j(e,"template_modal_accept",n,{forceOverrideAutomaticEventData:{team_id:o}}),F.default.logEvent("template_modal_accept",1)}function Ro(e,t){x.j(e,"create_collection_template",t),F.default.logEvent("create_collection_template",1)}function Eo(e,t){x.j(e,"activate_collection_template",t),F.default.logEvent("activate_collection_template",1)}function Fo(e,t){x.j(e,"collection_template_action",t)}function No(e,t){x.lu(e,"edit_block_text_60",`edit_block_text_60-${t.user_action}`,60,t)}function jo(e,t){x.j(e,"todo_block_check",t)}function Oo(e,t){x.j(e,"toggle_block_toggle")}function Lo(e,t){x.j(e,"embed_block_action",t)}function Uo(e,t){x.j(e,"embed_block_resize",t)}function Zo(e,t){x.j(e,"equation_block_edit",t)}function Vo(e,t){n.default.afterNextFlush((()=>{let o;const n=L.default.state.stores[0];n&&(o=n.getType());const{parentTeamStore:r,...i}=t;ac(e,"block_action",`block_action-${t.analyticsName}-${t.from}-${t.block_id}`,60,{store:r,...i,final_block_type:o})}))}function qo(e,t){const{optionalAnalyticsProperties:o,...n}=t,{teamStore:r,collectionContextStore:i,...a}=t.optionalAnalyticsProperties||{};ic(e,"open_block_menu",{store:r,...(0,T.Pn)(i)||{},...n,...a})}function zo(e){x.j(e,"open_slash_menu")}function Wo(e,t){x.j(e,"download_file",t)}function Ho(e,t){x.j(e,"file_open_attempt",t)}function Go(e,t){x.j(e,"duplicate_template",{...t,is_paid:!1})}function Ko(e,t){x.j(e,"duplicate_template_attempt",t)}function $o(e,t){const o=(0,b.gy)(t.url);x.j(e,"open_embed_menu",{url_domain:null==o?void 0:o.hostname})}function Yo(e,t){var o;x.j(e,"click_embed_menu",{url_domain:t.url?null===(o=(0,b.gy)(t.url))||void 0===o?void 0:o.hostname:void 0,type:t.type})}function Qo(e,t){x.j(e,"url_turned_bookmark",t)}function Jo(e,t){x.j(e,"embed_type",t)}function Xo(e,t){x.j(e,"embed_render",t)}function en(e,t){x.j(e,"embed_client_error",t)}function tn(e,t){x.j(e,"configure_template_button",t)}function on(e,t){x.j(e,"change_font_type",t)}function nn(e,t){x.j(e,"change_font_size",t)}function rn(e,t){x.j(e,"change_page_width",t)}function an(e){x.j(e,"click_add_menu")}function sn(e,t){x.j(e,"move_to",t)}function ln(e,t){x.j(e,"move_to_value_selected",t)}function cn(e,t){x.j(e,"move_to_menu_open",t)}function dn(e,t){x.j(e,"move_to_menu_cancel",t)}function pn(e,t){x.j(e,"add_editor_permission_to_ensure_undo",t)}function un(e,t){x.j(e,"move_to_autocomplete_query_change",t)}function mn(e,t){x.j(e,"move_to_toggle_click",t)}function gn(e,t){x.j(e,"edit_lock_toggle",t)}function hn(e,t){x.j(e,"rich_text_menu_click",t)}function fn(e,t){x.j(e,"update_page_section_visibility",t)}function yn(e,t){x.j(e,"expand_block",t)}function vn(e,t,o){x.j(e,t,o)}function bn(e,t){x.j(e,"board_item_delete_newly_created",t)}function Sn(e,t,o){if(!0===o)x.j(e,"edit_block_property_60",t);else{const o=(0,I.zj)(),{property_type:n,collection_id:r,collection_view_id:i}=t;x.lu(e,"edit_block_property_60",`edit_block_property_60-${o||""}-${n||""}-${r||""}-${i||""}`,60,t)}}function _n(e,t){x.j(e,"click_block_property_url",t)}function wn(e,t){x.j(e,"create_property",t)}function kn(e,t){x.j(e,"configure_property",t)}function xn(e,t){x.j(e,"delete_property",t)}function In(e,t){x.j(e,"create_view",t)}function Cn(e,t){x.j(e,"configure_view",t)}function Tn(e,t){x.j(e,"open_peek_mode_picker",t)}function Mn(e,t){x.j(e,"open_peek_mode_picker",t)}function Pn(e,t){x.j(e,"update_peek_mode_format",t)}function An(e,t){x.j(e,"update_peek_mode_format",t)}function Dn(e,t){x.j(e,"view_settings",t)}function Bn(e,t){x.j(e,"delete_view",t)}function Rn(e,t){x.j(e,"collection_search",t)}function En(e,t){x.j(e,"open_collection_as_page",t)}function Fn(e){x.j(e,"collection_no_date_menu_add")}function Nn(e){x.j(e,"collection_no_date_menu_view")}function jn(e,t){x.j(e,"relation_database_click",t)}function On(e,t){x.lu(e,"timeline_view","timeline_view",5,t)}function Ln(e,t){x.j(e,"timeline_zoom_level_update",t)}function Un(e,t){x.j(e,"timeline_today_click",t)}function Zn(e,t){x.j(e,"timeline_shift_time_click",t)}function Vn(e,t){x.j(e,"timeline_toggle_table_click",t)}function qn(e,t){x.j(e,"timeline_item_scroll_arrow_click",t)}function zn(e,t){x.j(e,"timeline_item_resize",t)}function Wn(e,t){x.j(e,"timeline_dependency_arrow_add",t)}function Hn(e,t){x.j(e,"timeline_dependency_arrow_delete",t)}function Gn(e,t){x.j(e,"subitem_toggle_block_open",t)}function Kn(e,t){x.j(e,"subitem_toggle_block_close",t)}function $n(e){x.j(e,"table_new_subitem_create")}function Yn(e){x.j(e,"inline_collection_load_more_click")}function Qn(e,t){x.j(e,"relation_show_as",t)}function Jn(e,t){x.j(e,"relation_reorder",t)}function Xn(e,t){x.j(e,"relation_add_block",t)}function er(e,t){x.j(e,"relation_remove_block",t)}function tr(e,t){x.j(e,"relation_create_block",t)}function or(e,t){x.j(e,"relation_customize_displayed_properties",t)}function nr(e,t){x.j(e,"relation_section_link_pages",t)}function rr(e,t){x.j(e,"relation_navigate_block",t)}function ir(e,t){x.j(e,"relation_update_property_visibility",t)}function ar(e,t){x.j(e,"configure_rollup_relation",t)}function sr(e,t){x.j(e,"configure_rollup_target_property",t)}function lr(e,t){x.j(e,"configure_rollup_aggregation",t)}function cr(e,t){x.j(e,"collection_table_drag_and_fill",t)}function dr(e,t){x.j(e,"complete_sprint_action",t)}function pr(e,t){x.j(e,"create_space",t);const o=(0,V.zt)();if("professional"===t.domain_type&&(x.j(e,"professional_workspace_created",t),r.L1({subscriptionTier:o,planType:t.planType})),"team"===t.planType&&(x.j(e,"team_workspace_created",t),r.tO({subscriptionTier:o,planType:t.planType})),r.VT({subscriptionTier:o,domainType:t.domain_type}),"team"===t.planType){const t=r.Q3(),o=r.SY();_.trackConversionEvent(e,{eventName:"create_team_space",fbp:t,clickIds:o})}}function ur(e,t){x.j(e,"join_space",t)}function mr(e){x.j(e,"leave_space")}function gr(e){x.j(e,"delete_space"),F.default.logEvent("delete_space")}function hr(e,t){const{collectionContextStore:o}=t.optionalAnalyticsProperties||{},n=(0,T.Pn)(o)||{},r={from:t.from,block_types:t.draggedTypes,block_count:t.draggedTypes.length,as_copy:t.asCopy||!1,draggable:t.draggableProps,dropzone:t.dropzoneProps,...n};x.j(e,"drag",r),t.asCopy&&x.j(e,"drag_as_copy",r),"selection_menu"===t.from&&x.j(e,"drag_selection_menu",r)}function fr(e,t){x.j(e,"click_selection_menu",{block_type:t.blockType})}function yr(e,t){const{analyticsFrom:o,flowId:n}=t;x.j(e,"open_mention_menu",{analyticsFrom:o,flowId:n})}function vr(e,t){const{clickIndexGlobal:o,clickIndexLocal:n,sectionIndex:r,timeToClickInMs:i,analyticsFrom:a,queryLength:s,mentionType:l}=t,c={clickIndexGlobal:o,clickIndexLocal:n,sectionIndex:r,timeToClickInMs:i,analyticsFrom:a,queryLength:s,mentionType:l};x.j(e,"insert_mention_from_mention_menu",c),F.default.logEvent("insert_mention_from_mention_menu",void 0,c)}function br(e,t){const{timeToAbandonInMs:o,analyticsFrom:n,queryLength:r,flowId:i}=t,a={timeToAbandonInMs:o,analyticsFrom:n,queryLength:r,flowId:i};x.j(e,"mention_menu_abandon",a),F.default.logEvent("mention_menu_abandon",void 0,a)}function Sr(e,t){x.j(e,"mention_user",{mentioned_user_id:(0,u.F9)(t.user_id),from:t.from,block_type:t.block_type})}function _r(e,t){x.j(e,"mention_group",{mentioned_group_id:(0,u.F9)(t.group_id),from:t.from,block_type:t.block_type})}function wr(e,t){x.j(e,"hover_mention_group",{group_id:(0,u.F9)(t.group_id)})}function kr(e,t){x.j(e,"hover_page_mention_start",{hover_session_id:t.hover_session_id,hover_content_type:t.hover_content_type,mentioned_page_id:t.mentioned_page_id,page_visit_id:t.page_visit_id})}function xr(e,t){x.j(e,"hover_page_mention_end",{hover_session_id:t.hover_session_id,hover_content_type:t.hover_content_type,mentioned_page_id:t.mentioned_page_id,page_visit_id:t.page_visit_id})}function Ir(e,t){x.j(e,"page_mention_click",{page_visit_id:t.page_visit_id,mentioned_page_id:t.mentioned_page_id,source_type:t.source_type,hover_preview_enabled:t.hover_preview_enabled,is_navigable_block:t.is_navigable_block})}function Cr(e,t){x.j(e,"mention_date",{date:t.date,from:t.from,block_type:t.block_type})}function Tr(e,t){x.j(e,"mention_page",{mentioned_page_id:(0,u.F9)(t.page_id),from:t.from,block_type:t.block_type})}function Mr(e,t){x.j(e,"inline_equation_edit",t)}function Pr(e,t){x.j(e,"set_reminder",{date:t.date,reminder:t.reminder})}function Ar(e){x.j(e,"resize_column")}function Dr(e){x.j(e,"reset_column_sizes")}function Br(e){x.j(e,"create_column_list")}function Rr(e,t){x.j(e,"insert_column",t)}function Er(e,t){x.j(e,"drag_near_edge_scroll",t)}function Fr(e,t){x.j(e,"transform_text_block_filter",t)}function Nr(e,t){x.j(e,"unicode_filter",t)}function jr(e,t){x.j(e,"annotation_filter",t)}function Or(e,t){x.j(e,"keyboard_annotation",t)}function Lr(e,t){x.j(e,"link_filter",t)}function Ur(e,t){const o=t.invite_targets.filter(N.cl),n=t.invite_targets.filter(N.fZ).map((e=>(0,A.fR)(e))),i=o.length+n.filter((e=>"not_in_space"===e||"page_contextual_invite"===t.invite_origin&&"none"===e||"convert_to_member"===t.invite_origin&&"none"===e||"person_property_invite"===t.invite_origin||"membership_request"===t.invite_origin)).length,a=c.oA(t.permission_items.map((e=>{if("user_permission"===e.type)return e.user_id&&(0,u.cj)(e.user_id)}))),l=(0,V.zt)(),d={role:t.role,user_count:n.length+o.length,new_user_count:o.length,new_workspace_member_count:t.is_space?i:0,is_onboarding:t.is_onboarding,invite_flow_id:t.invite_flow_id,invite_origin:t.invite_origin,invitee_ids:a,invite_message_length:t.invite_message_length,subscription_tier:l,domain_type:t.domainType,...!t.is_space&&{share_menu_session_id:t.share_menu_session_id}};x.j(e,"invite",{...d,is_space:t.is_space}),U.default.waitUntilLoaded().then((()=>{const{data:o}=U.default.state,n=o?Z.Ln(e,o):void 0,r=o?Z.Lz(e,o):void 0;x.j(e,"invite_debug_with_block_usage",{...d,is_space:t.is_space,is_over_block_limit:n,block_usage:r}),t.is_space||(!function(e,t){const{currentSpaceStore:o,currentUserStore:n}=E.default.state,r=o&&o.canEditMembership(),i=(0,C.JF)(),a=null==n?void 0:n.getEmail();if(!r||!i||!a)return;if("professional"!==i)return;const l=(0,s.Gd)(a),c=(0,Z.A7)().slice(0,50).map((e=>j.U6.createChildStore(o,{table:g.KJ,id:e.userId}).getEmail())).filter((e=>e&&(0,s.Gd)(e)===l)).length;x.j(e,"page_invite_guest_summary",{...t,guest_with_same_domain_count:c})}(e,d),Lp(e,{inviteTargets:t.invite_targets,origin:t.invite_origin}))})),t.is_space?(x.j(e,"space_invite",d),x.Zf(e,{space_invited:!0}),F.default.logEvent("space_invite",t.invite_origin,d),_p(e,{invite_origin:t.invite_origin,domainType:t.domainType,new_workspace_member_count:d.new_workspace_member_count}),function(e,t){const o=(0,V.zt)();t.visibleMembersCount<=1&&(x.j(e,"workspace_first_invite_sent"),r.kd(o,t.domainType),"professional"===t.domainType&&(x.j(e,"professional_workspace_first_invite_sent",{visible_members_count:t.visibleMembersCount,is_professional_team_user:t.isProfessionalTeamUser,domain_type:t.domainType}),r.Dq()))}(e,{visibleMembersCount:Z.qX(),isProfessionalTeamUser:t.isProfessionalTeamUser,domainType:t.domainType})):(x.j(e,"page_invite",d),F.default.logEvent("page_invite",l,d),function(e,t){const{currentUserSettingsStore:o}=E.default.state;if(!o)return;const n=o.getKeyStore("settings").getKeyStore("signup_time").getValue(),r=o.getKeyStore("settings").getKeyStore("first_page_invite_at").getValue();if(!Boolean(r)){const r=Date.now(),i={...t,...n?{signup_time_ready:!0,time_from_signup_to_first_page_invite:n-r}:{signup_time_ready:!1}};x.j(e,"page_invite_time",i),F.default.logEvent("page_invite_time",t.subscription_tier,i),q.createAndCommit({userAction:"firstPageInvite",environment:e,userId:o.id,perform:e=>{z.d2({userSettingsStore:o,data:{first_page_invite_at:r},transaction:e})}})}}(e,d))}function Zr(e,t){x.j(e,"change_email",t)}function Vr(e,t){x.j(e,"update_page_permission","user_id"in t||"page_id"in t?$r(t):t)}function qr(e,t){x.j(e,"set_permission_item",t)}function zr(e,t){x.j(e,"invite_modal_input_focus",t)}function Wr(e,t){x.j(e,"invite_users_to_page",t)}function Hr(e,t){if("team"===t.type){const{team_id:o,...n}=t;x.j(e,"expand_permission",{...n},{forceOverrideAutomaticEventData:{team_id:o}})}else x.j(e,"expand_permission",t)}function Gr(e,t){x.j(e,"page_share_permissions_summary",t)}function Kr(e,t){x.j(e,"page_share_user_access_role",t)}function $r(e){const{user_id:t,page_id:o,...n}=e;return n}function Yr(e,t,o){x.j(e,"update_space_permission",{...(0,d.jg)(t)&&{updated_user_id:(0,u.cj)(t.user_id)},...(0,d.FB)(t)&&{updated_bot_id:(0,u.cj)(t.bot_id)},..."user_id"in t||"page_id"in t?$r(t):t,...o})}function Qr(e,t){var o;let{item:n,teamStore:r}=t;const i=null===(o=r.getPermissionItems())||void 0===o?void 0:o.find((e=>e.type===n.type));(null==i?void 0:i.role)!==n.role&&ic(e,"update_team_permission",{store:r,..."user_id"in n||"page_id"in n?$r(n):n,..."user_id"in n&&{permission_user_id:(0,u.cj)(n.user_id)},old_role:null==i?void 0:i.role,is_team_role_change:!1,is_permission_change:!0})}function Jr(e,t){let{permission_user_id:o,store:n,team_role:r}=t;ic(e,"update_team_permission",{store:n,permission_user_id:o,team_role:r,is_team_role_change:!0,is_permission_change:!1})}function Xr(e,t){x.j(e,"convert_guest_to_member",t),F.default.logEvent("convert_guest_to_member",t.convert_to,{origin:t.origin})}function ei(e){x.j(e,"remove_guest")}function ti(e,t){F.default.logEvent("remove_member",t.member_user_id,t),_p(e,{invite_origin:t.invite_origin,domainType:t.domainType,new_workspace_member_count:t.new_workspace_member_count}),x.j(e,"remove_member",{member_user_id:t.member_user_id,member_role:t.member_role,contraction_survey_id:t.contraction_survey_id})}function oi(e){x.j(e,"permission_group_create")}function ni(e,t){x.j(e,"permissions_settings_tab_click",t)}function ri(e){x.j(e,"permission_group_rename")}function ii(e,t){x.j(e,"permission_group_set_icon",t)}function ai(e,t){x.j(e,"permission_group_add_members",t)}function si(e){x.j(e,"permission_group_remove_member")}function li(e){x.j(e,"permission_group_delete")}function ci(e,t){x.j(e,"toggle_allow_search_engine_indexing",t)}function di(e,t){x.j(e,"set_expiration_time_on_public_page",t)}function pi(e,t){x.j(e,"toggle_allow_duplicate",t)}function ui(e,t){x.j(e,"restrict_permissions",t)}function mi(e,t){x.j(e,"restore_permissions",t)}function gi(e,t){x.j(e,"set_database_sync_permissions",t)}function hi(e){x.j(e,"widen_permissions")}function fi(e){x.j(e,"request_access")}function yi(e,t){x.j(e,"grant_access",t)}function vi(e,t){x.j(e,"grant_access_update_access_level",t)}function bi(e,t){x.j(e,"ignore_access_request",t)}function Si(e,t){x.j(e,"toggle_request_access_security_setting",t)}function _i(e,t){x.j(e,"invite_typed",t),F.default.logEvent("invite_typed",t.subscription_tier,{...t})}function wi(e,t){x.j(e,"invite_select_target",t),F.default.logEvent("invite_select_target",t.subscription_tier,{selected_user_token_rank:t.selected_user_token_rank,from:t.from,type:t.type??"permission_invite"})}function ki(e,t){x.j(e,"invite_change_role",t),F.default.logEvent("invite_change_role",t.subscription_tier,{...t})}function xi(e,t){x.j(e,"abandon_permissions_invite",t),F.default.logEvent("abandon_permissions_invite",t.subscription_tier,{...t})}function Ii(e,t){x.j(e,"open_share_workspace_invite",t),F.default.logEvent("open_share_workspace_invite",t.subscription_tier,{...t})}function Ci(e,t){x.j(e,"send_share_workspace",t),F.default.logEvent("send_share_workspace",t.subscription_tier,{...t})}function Ti(e,t){x.j(e,"send_membership_request",t),F.default.logEvent("send_membership_request",t.subscription_tier,{...t})}function Mi(e,t){x.j(e,"view_all_requests_from_membership_request_notification",t),F.default.logEvent("view_all_requests_from_membership_request_notification","notification",t)}function Pi(e,t){x.j(e,"resolve_membership_request",t),F.default.logEvent("resolve_membership_request",t.status,t)}function Ai(e){x.j(e,"open_guest_membership_request_modal"),F.default.logEvent("open_guest_membership_request_modal")}function Di(e){x.j(e,"render_guest_membership_request_entry_point"),F.default.logEvent("render_guest_membership_request_entry_point")}function Bi(e){x.j(e,"sidebar_expand")}function Ri(e){x.j(e,"sidebar_unexpand")}function Ei(e,t){x.j(e,"bookmark",t)}function Fi(e,t){x.j(e,"unbookmark",t)}function Ni(e,t){x.j(e,"open_settings",t)}function ji(e,t){x.j(e,"toggle_settings_tab",t)}function Oi(e){x.j(e,"upload_profile_photo")}function Li(e,t){x.j(e,"name_changed",t)}function Ui(e){x.j(e,"delete_account_clicked")}function Zi(e){x.j(e,"delete_account_confirmed")}function Vi(e){x.j(e,"log_out_from_active_sessions_clicked")}function qi(e){x.j(e,"change_password_clicked")}function zi(e){x.j(e,"remove_password_clicked")}function Wi(e,t){x.j(e,"locale_changed",t)}function Hi(e,t){x.j(e,"invite_link_updated",t)}function Gi(e,t){x.j(e,"allowed_email_domains_updated",t)}function Ki(e){x.j(e,"open_trash")}function $i(e,t){x.j(e,"toggle_trash_tab",t)}function Yi(e){x.j(e,"restore_trash_page")}function Qi(e){x.j(e,"delete_trash_page")}function Ji(e){x.j(e,"open_breadcrumb_current_page_menu")}function Xi(e){x.j(e,"click_breadcrumb_current_page_scroll_to_top")}function ea(e){x.j(e,"click_breadcrumb_move_to")}function ta(e,t){x.j(e,"open_page_share",t),F.default.logEvent("open_page_share")}function oa(e,t){x.j(e,"close_page_share",t)}function na(e,t){x.j(e,"open_page_share_invite",t),F.default.logEvent("open_page_share_invite",t.subscription_tier,{...t})}function ra(e){x.j(e,"open_space_invite")}function ia(e){x.j(e,"open_more_menu")}function aa(e){x.j(e,"open_more_connections_menu")}function sa(e){x.j(e,"open_public_more_menu")}function la(e){x.j(e,"confirm_app_update")}function ca(e,t){x.j(e,"show_page_reload_confirmation_dialog",t)}function da(e,t){x.j(e,"export",t)}function pa(e,t){x.j(e,"export_failed",t)}function ua(e,t){const{teamStore:o,...n}=t;ic(e,"click_outliner_item",{store:o,...n})}function ma(e,t){"onboarding"===t.from?function(e,t){const{teamStore:o,...n}=t;ic(e,"create_onboarding_page",{store:o,...n})}(e,{from:t.from,teamStore:t.teamStore,forkedTemplateId:t.pageId}):_o(e,{type:"page",from:t.from,teamStore:t.teamStore,new_page_id:t.pageId,transaction:t.transaction})}function ga(e,t){x.j(e,"click_outliner_team_new_page",t)}function ha(e,t){const{teamStore:o,...n}=t;ic(e,"outliner_item_toggle",{store:o,...n})}function fa(e,t){ic(e,"outliner_team_toggle",t)}function ya(e,t){x.j(e,"outliner_section_toggle",t)}function va(e){x.j(e,"click_nested_child_page")}function ba(e,t){x.j(e,"click_desktop_navigator",t)}function Sa(e){x.j(e,"open_space_switcher")}function _a(e){x.j(e,"space_switcher_select_space")}function wa(e){x.j(e,"space_switcher_logout_click")}function ka(e,t){x.j(e,"toggle_dark_mode",t)}function xa(e){x.j(e,"delete_user")}function Ia(e,t){x.j(e,"pin_page",t)}function Ca(e,t){x.j(e,"unpin_page",t)}function Ta(e,t){x.j(e,"open_support_chat",t)}function Ma(e){x.j(e,"click_help"),F.default.logEvent("click_help")}function Pa(e,t){x.j(e,"click_help_item",t),"sales_chat"===t.item&&F.default.logEvent("click_help_item")}function Aa(e,t){x.j(e,"global_click_learn",t)}function Da(e,t){x.j(e,"tap_mobile_action_bar_item",{item_name:t.itemName,from:t.from})}function Ba(e){x.j(e,"scroll_mobile_action_bar")}function Ra(e){x.j(e,"open_mobile_sidebar")}function Ea(e,t){x.j(e,"tap_mobile_bottom_bar_item",{...t})}function Fa(e){x.j(e,"mobile_add_to_menu_accept")}function Na(e,t){x.j(e,"navigation",{...t})}function ja(e){x.j(e,"open_notification_settings_from_all_updates")}function Oa(e,t){F.default.logEvent("open_sidebar_updates",t.tab,t),x.j(e,"open_sidebar_updates",t)}function La(e){x.j(e,"open_page_updates")}function Ua(e,t){x.j(e,"click_update",t)}function Za(e,t){const{target:o,...n}=t;let r;"notify_mobile"===o?r="set_mobile_notification":"notify_desktop"===o?r="set_desktop_notification":"notify_email"===o?r="set_email_notification":"notify_email_always"===o?r="set_email_always_notification":"notify_email_digest"===o?r="set_email_digest_notification":(0,v.t1)(o),x.j(e,r,n)}function Va(e){x.j(e,"set_marketing_emails_preferences")}function qa(e,t){x.j(e,"follow_page",t)}function za(e,t){x.j(e,"unfollow_page",t)}function Wa(e,t){x.j(e,"update_page_follow_settings",t)}function Ha(e){x.j(e,"open_emoji_menu")}function Ga(e,t){x.j(e,"emoji_no_results",t)}function Ka(e,t,o){x.j(e,t,o)}function $a(e,t,o){x.j(e,t,o),F.default.logEvent(t,o.icon)}function Ya(e,t){x.j(e,"open_block_discussion_menu",t)}function Qa(e){let{environment:t,from:o,notificationId:n,activityId:r}=e;x.j(t,"open_reply_discussion_menu",{from:o,notificationId:n,activityId:r})}function Ja(e){let{environment:t,from:o,notificationId:n,activityId:r}=e;x.j(t,"close_reply_discussion_menu",{from:o,notificationId:n,activityId:r})}function Xa(e){x.j(e,"open_new_block_discussion")}function es(e){x.j(e,"open_new_inline_discussion")}function ts(e){x.j(e,"discard_new_discussion_dialog_show")}function os(e){x.j(e,"discard_new_discussion_dialog_confirm")}function ns(e){x.j(e,"discard_new_discussion_dialog_cancel")}function rs(e,t){x.j(e,"create_block_discussion",t),F.default.logEvent("create_block_discussion")}function is(e,t){x.j(e,"create_inline_discussion",t),F.default.logEvent("create_inline_discussion")}function as(e,t){x.j(e,"add_comment",t),F.default.logEvent("add_comment",t.from)}function ss(e,t){x.j(e,"delete_comment",t)}function ls(e,t){x.j(e,"edit_comment",t)}function cs(e,t){x.j(e,"resolve_discussion",t),F.default.logEvent("resolve_discussion",t.from)}function ds(e,t){x.j(e,"reopen_discussion",t)}function ps(e,t){x.j(e,"click_discussion",t)}function us(e){const{environment:t,...o}=e;x.j(t,"add_reaction",o),F.default.logEvent("add_reaction",o.reaction_value)}function ms(e){const{environment:t,...o}=e;x.j(t,"remove_reaction",o)}function gs(e,t){x.j(e,"open_history",{from:t})}function hs(e){return Date.now()-parseInt(e.timestamp)}function fs(e,t){x.j(e,"select_snapshot",{ageMs:hs(t)})}function ys(e,t){x.j(e,"history_copy",{ageMs:hs(t)})}function vs(e,t){x.j(e,"restore_snapshot",{ageMs:hs(t)})}function bs(e,t){var o;x.j(e,"fork_page",{blockId:t},{dontWait:!0}),F.default.logEvent("fork_page",null===(o=document.location)||void 0===o||null===(o=o.host)||void 0===o||null===(o=o.split(".notion."))||void 0===o?void 0:o[1])}function Ss(e,t){const{type:o,bytes:n,data:r}=t;x.j(e,o,{bytes:n,...r})}function _s(e,t){x.j(e,"open_search",t)}function ws(e,t){x.j(e,"space_invitation_email_clicked",t)}function ks(e,t){x.j(e,"select_search_item",t);const{numKeystrokes:o,timeToSelectMs:n,selectedItemIndex:r,originalPosition:i,context:a,numLocalResults:s,searchSessionId:l,searchSessionFlowNumber:c,numVisibleMembers:d,localSources:p,isMobile:u}=t,m=Boolean(!!p&&p.length>0),g=d>1;F.default.logEvent("select_search_item",r,{numKeystrokes:o,timeToSelectMs:n,selectedItemIndex:r,numLocalResults:s,originalItemIndex:i,searchSessionFlowNumber:c,searchSessionId:l,context:a,isMultiplayer:g,isLocalResult:m,isMobile:u});const h=1/(r+1);x.j(e,"quick_find_reciprocal_rank",{reciprocalRank:h,context:a,searchSessionId:l,numLocalResults:s,isMultiplayer:g}),F.default.logEvent("quick_find_reciprocal_rank",h,{context:a,searchSessionId:l,numLocalResults:s,isMultiplayer:g,isLocalResult:m,isMobile:u})}function xs(e,t){x.j(e,"abandoned_search",t);const{numKeystrokes:o,timeToAbandonMs:n,numLocalResults:r,numVisibleMembers:i,isMobile:a}=t,s=i>1;F.default.logEvent("abandoned_search",o,{numKeystrokes:o,timeToAbandonMs:n,numLocalResults:r,searchSessionId:t.searchSessionId,isMultiplayer:s,isMobile:a}),x.j(e,"quick_find_reciprocal_rank",{reciprocalRank:0,searchSessionId:t.searchSessionId,numLocalResults:r,isMultiplayer:s}),F.default.logEvent("quick_find_reciprocal_rank",0,{searchSessionId:t.searchSessionId,numLocalResults:r,isMultiplayer:s,isMobile:a})}function Is(e,t){x.j(e,"search_client_results",t)}function Cs(e,t){x.j(e,"search_post_click_page_interaction",t)}function Ts(e,t){var o;x.j(e,"search_post_click_page_exit",{dwellTime:(new Date).getTime()-t.timeEntered.getTime()},{forceOverrideAutomaticEventData:{queryId:null===(o=O.Z.state)||void 0===o?void 0:o.queryId}})}function Ms(e,t){const{currentSearchSessionId:o,currentWorkspaceId:n,newWorkspaceId:r}=t;x.j(e,"search_quick_search_switch_workspace",{current_search_session_id:o,current_workspace_id:n,new_workspace_id:r})}function Ps(e,t,o){const n=e=>"peekViewBlockId"in e&&e.peekViewBlockId?e.peekViewBlockId:"blockId"in e?e.blockId:void 0,r=n(t),a=n(o),s="pageVisitSource"in o&&o.pageVisitSource?(0,i.xt)(parseInt(o.pageVisitSource)):void 0;x.j(e,"click_in_page_navigation",{current_route_name:t.name,next_route_name:o.name,page_visit_source:s,current_page_id:r,next_page_id:a},{forceOverrideAutomaticEventData:{page_id:r}})}function As(e,t){x.j(e,"offline_access_failure",t)}function Ds(e,t){x.j(e,"open_view_all_popover",t)}function Bs(e){x.j(e,"copy_link_from_permissions_setting")}function Rs(e){x.j(e,"copy_web_link")}function Es(e,t){x.j(e,"select_page_from_view_all_popover",t)}function Fs(e){x.j(e,"dismiss_new_page_suggested_templates")}function Ns(e){x.j(e,"transclusion_container_copy_button")}function js(e,t){x.j(e,"transclusion_container_open_backlinks",t)}function Os(e){x.j(e,"developer_integrations_list_visit")}function Ls(e){x.j(e,"developer_integrations_new_click")}function Us(e,t){x.j(e,"developer_integrations_filter_click",t)}function Zs(e,t){const o=P.OS[t.table];x.j(e,"developer_integrations_view_visit",{type:o})}function Vs(e,t){const o=P.OS[t.table];x.j(e,"developer_integrations_create",{type:o})}function qs(e,t){const o=P.OS[t.table];x.j(e,"developer_integrations_view_secret",{type:o})}function zs(e,t){const o=P.OS[t.table];x.j(e,"developer_integrations_copy_secret",{type:o})}function Ws(e,t){const o=P.OS[t.table],{table:n,...r}=t;x.j(e,"developer_integrations_update",{type:o,...r})}function Hs(e,t){x.j(e,"developer_integrations_my_integrations_click",t)}function Gs(e,t){x.j(e,"developer_integrations_all_integrations_click",t)}function Ks(e,t){x.j(e,"developer_integrations_visit_developer_website_click",t)}function $s(e,t){x.j(e,"developer_integrations_contact_developer_click",t)}function Ys(e,t){x.j(e,"developer_integrations_disconnect_click",t)}function Qs(e,t){x.j(e,"developer_integrations_open_card_dropdown_click",t)}function Js(e,t){x.j(e,"developer_integrations_delete_click",t)}function Xs(e,t){x.j(e,"developer_integrations_confirm_delete_click",t)}function el(e,t){x.j(e,"comment_upload_attachments",t)}function tl(e,t){x.j(e,"open_comments_sidebar",t)}function ol(e,t){x.j(e,"open_updates_sidebar",t)}function nl(e,t){x.j(e,"updates_sidebar_tab_click",t)}function rl(e,t){x.j(e,"install_public_integration_oauth",t)}function il(e,t){x.j(e,"security_and_compliance_integration_install",t)}function al(e,t){x.j(e,"security_and_compliance_integration_uninstall",t)}function sl(e,t){x.j(e,"security_and_compliance_integration_update",t)}function ll(e,t){x.j(e,"connect_external_integration",t),F.default.logEvent("connect_external_integration",void 0,t)}function cl(e,t){x.j(e,"disconnect_external_integration",t)}function dl(e,t){x.j(e,"activate_link_preview_menu",t)}function pl(e,t){x.j(e,"save_link_preview",t)}function ul(e,t){x.j(e,"update_link_preview",t)}function ml(e,t){x.j(e,"open_link_preview_help_guide",t)}function gl(e,t){x.j(e,"remove_link_preview_with_error",t)}function hl(e,t){x.j(e,"link_preview_url_miss",t)}function fl(e,t){x.j(e,"show_all_discoverable_connected_apps",t)}const yl={tracked:!1};function vl(e){let{environment:t,type:o,onboardingState:n}=e;if(yl.tracked)return;const r={type:o,onboardingStage:null==n?void 0:n.stage};x.j(t,"cookie_banner_shown",r),yl.tracked=!0}function bl(e){x.j(e,"cookie_modal_shown")}function Sl(e,t){x.j(e,"coupon_typeform_clicked",t)}function _l(e,t){x.lu(e,"legacy_transclusion_show",`legacy_transclusion_show_${t.block_type}`,3600,t)}function wl(e,t){x.j(e,"legacy_transclusion_autofix",t)}function kl(e,t){x.j(e,"transaction_timestamp_collision",t)}function xl(e,t){x.j(e,"transaction_timestamp_regression",t)}function Il(e,t){x.j(e,"transaction_race_hazard",t)}function Cl(e,t){x.j(e,"transaction_async_data_loss",t)}function Tl(e,t){x.j(e,"transaction_deadlock_warning",t)}function Ml(e,t){x.j(e,"transaction_too_large",t)}function Pl(e,t){x.j(e,"transaction_queue_error_show",t)}function Al(e){x.j(e,"connection_error_show",{})}function Dl(e,t){x.j(e,"connection_error_indicator_details_show",t)}function Bl(e,t){x.j(e,"low_storage_error_show",t)}function Rl(e,t){x.j(e,"transaction_queue_healthcheck",t)}function El(e,t){x.j(e,"save_edits_error_modal_show",t)}function Fl(e,t){x.j(e,"unsaved_transaction_error",t)}function Nl(e,t){x.j(e,"open_team_browser",t)}function jl(e,t){x.j(e,"close_team_browser",{...t,num_of_total_teams:t.num_of_joined_teams+t.num_of_unjoined_teams})}function Ol(e,t){x.j(e,"team_browser_search_cleared",t)}function Ll(e,t){const{teamStore:o,outliner_type:n}=t;ic(e,"team_browser_member_list_hover",{store:o,outliner_type:n})}function Ul(e,t){x.j(e,"create_team_start",{from:t.from,flow_id:t.flowId}),F.default.logEvent("create_team_start",1,t)}async function Zl(e,t){const{store:o}=t;await o.load(),ic(e,"create_team_complete",t),rc("create_team_complete",t)}async function Vl(e,t){const{store:o}=t;await o.load(),ic(e,"enable_teams",t)}function ql(e,t){const{screen:o,...n}=t;if(o===B.F.Team){const t={screen:"team",...n};return ic(e,"close_create_team_modal",t),void rc("close_create_team_modal",t)}const r={screen:"members",flow_id:t.flow_id,from:t.from,team_id:t.team_id,store:t.store};ic(e,"close_create_team_modal",r),rc("close_create_team_modal",r)}function zl(e,t){ic(e,"invite_team_members",t),rc("invite_team_members",t)}function Wl(e,t){ic(e,"invite_team_groups",t),rc("invite_team_groups",t)}function Hl(e,t){ic(e,"set_default_team",t)}function Gl(e,t){ic(e,"join_team",t),rc("join_team",t)}function Kl(e,t){ic(e,"archive_team",t)}function $l(e,t){ic(e,"transition_to_zero_teams",t)}function Yl(e,t){ic(e,"restore_team",t)}function Ql(e,t){ic(e,"remove_team_members",t)}function Jl(e,t){ic(e,"remove_team_groups",t)}function Xl(e,t){ic(e,"change_teams_order",t)}function ec(e,t){ic(e,"change_team_access_level",t)}function tc(e,t){ic(e,"update_team_settings",t)}function oc(e,t){ic(e,"open_outliner_team_overflow",t)}function nc(e,t){ic(e,"click_outliner_team_overflow_option",t),rc("click_outliner_team_overflow_option",t)}function rc(e,t){const{store:o,...n}=t;o?F.default.logEvent(e,1,{...(0,x.nB)(o),...n}):F.default.logEvent(e,1,t)}async function ic(e,t,o){const{store:n,...r}=o;if(!n)return void(await x.j(e,t,{...r}));const i=(0,x.nB)(n),a=c.CE(i,"team_id");await x.j(e,t,{...a,...r},{forceOverrideAutomaticEventData:{team_id:i.team_id}})}function ac(e,t,o,n,r){const{store:i,...a}=r;if(!i)return void x.lu(e,t,o,n,{...a});const s=(0,x.nB)(i),l=c.CE(s,"team_id");x.lu(e,t,o,n,{...l,...a},{forceOverrideAutomaticEventData:{team_id:s.team_id}})}function sc(e,t){ic(e,"open_team_home",t)}function lc(e){switch(e){case R.a.General:return"general";case R.a.Members:return"members";case R.a.Security:return"security";default:(0,v.t1)(e)}}function cc(e,t){ic(e,"click_team_settings_tab",{store:t.store,tab_old_value:lc(t.tab_old_value),tab_new_value:lc(t.tab_new_value)})}function dc(e,t){ic(e,"restore_team_permissions",t)}function pc(e,t){ic(e,"team_invite_link_confirmation_selection",t)}function uc(e,t){ic(e,"copy_team_invite_link",t),rc("copy_team_invite_link",t)}function mc(e,t){ic(e,"click_team_invite_link",t)}function gc(e,t){ic(e,"request_access_to_team",t)}function hc(e,t){ic(e,"resolve_team_access_request",t)}function fc(e,t){x.j(e,"domain_verification_domain_added",t)}function yc(e,t){x.j(e,"domain_verification_verification_attempted",t)}function vc(e,t){x.j(e,"domain_verification_domain_verified",t)}function bc(e,t){x.j(e,"workspace_creation_ability",t)}function Sc(e,t){x.j(e,"workspace_creation_setting_updated",t)}function _c(e,t){x.j(e,"claimable_spaces_viewed",t)}function wc(e,t){x.j(e,"space_transfer_requested",t)}function kc(e,t){x.j(e,"space_transfer_completed",t)}function xc(e,t){x.j(e,"space_claim_upgrade_requested",t)}function Ic(e,t){x.j(e,"space_claim_upgrade_completed",t)}function Cc(e,t){x.j(e,"space_claim_deletion_started",t)}function Tc(e,t){x.j(e,"space_claim_deletion_canceled",t)}function Mc(e,t){x.j(e,"move_to_error",t)}function Pc(e,t){x.j(e,"show_user_validation_response",t)}function Ac(e){x.j(e,"zendesk_metadata_open_messenger")}function Dc(e){x.j(e,"zendesk_metadata_signup")}function Bc(e,t){x.j(e,"full_screen_action",t)}function Rc(e,t){x.j(e,"ai_action",t)}function Ec(e,t,o){const n={site:"client",...o};x.j(e,t,n)}function Fc(e,t){x.j(e,"ai_favorite_action",t)}function Nc(e,t){x.j(e,"ai_block_action",t)}function jc(e,t){x.j(e,"ai_autofill_action",t),F.default.logEvent("ai_autofill_action",1,{action_type:t.type})}function Oc(e,t){x.j(e,"ai_autofill_settings_action",t)}function Lc(e,t){x.j(e,"ai_completion_popup_open",t)}function Uc(e,t){x.j(e,"ai_completion_popup_close",t),F.default.logEvent("ai_completion_popup_close",1,{exit_type:t.exit_type})}function Zc(e,t){x.j(e,"ai_completion_popup_retry",t)}function Vc(e,t){x.j(e,"ai_completion_popup_history_navigation",t)}function qc(e,t){x.j(e,"ai_completion_popup_preview_start",t),F.default.logEvent("ai_completion_popup_preview_start",1,{from:t.from,prompt_key:t.prompt_key})}function zc(e,t){x.j(e,"ai_completion_popup_update_prompt_text",t)}function Wc(e,t){x.j(e,"ai_completion_popup_preview_end",t),F.default.logEvent("ai_completion_popup_preview_end",1,{preview_time:t.preview_time})}function Hc(e,t){x.j(e,"ai_completion_popup_preview_stopped_by_user",t)}function Gc(e,t){x.j(e,"ai_user_data_sharing_opt_in_submit",t)}function Kc(e,t){x.j(e,"recurrence_menu_open",t)}function $c(e,t){x.j(e,"recurrence_saved",t)}function Yc(e,t){x.j(e,"overview_analytics_filter_change",t)}function Qc(e,t){x.j(e,"user_analytics_engagement_timerange_filter_change",t)}function Jc(e,t){x.j(e,"user_analytics_table_filter_change",t)}function Xc(e,t){x.j(e,"user_analytics_table_sort_change",t)}function ed(e,t){x.j(e,"user_analytics_export_requested",t)}function td(e,t){x.j(e,"content_analytics_engagement_timerange_filter_change",t)}function od(e,t){x.j(e,"content_analytics_export_requested",t)}function nd(e,t){x.j(e,"content_analytics_table_filter_change",t)}function rd(e,t){x.j(e,"content_analytics_table_timerange_filter_change",t)}function id(e,t){x.j(e,"content_analytics_table_sort_change",t)}function ad(e,t){x.j(e,"workspace_analytics_tab_click",t)}function sd(e,t){x.j(e,"search_analytics_table_timerange_filter_change",t)}function ld(e,t){x.j(e,"search_analytics_table_sort_change",t)}function cd(e){x.j(e,"admin_content_search_analytics_acknowledge_confirm")}function dd(e,t){x.j(e,"admin_content_search_analytics_filter_change",t)}function pd(e,t){x.j(e,"admin_content_search_analytics_queried",t)}function ud(e,t){x.j(e,"admin_content_search_analytics_export_requested",t)}function md(e,t){x.j(e,"wiki_convert",t),F.default.logEvent("wiki_convert",void 0,t)}function gd(e,t){x.j(e,"wiki_undo_conversion",t),F.default.logEvent("wiki_undo_conversion",void 0,t),y.j({name:"wiki_undo_conversion",args:t})}function hd(e,t){x.j(e,"wiki_promo_show",t),F.default.logEvent("wiki_promo_show",void 0,t)}function fd(e){x.j(e,"wiki_promo_click_learn_more")}function yd(e){x.j(e,"wiki_promo_dismiss")}function vd(e,t){x.j(e,"verification_update",t),F.default.logEvent("verification_update",t.action)}function bd(e,t){x.j(e,"toggle_open_in_desktop_app",t)}function Sd(e){x.j(e,"configure_open_in_desktop_app")}function _d(e){x.j(e,"open_in_desktop_app_popup_dismiss")}function wd(e){x.j(e,"open_in_desktop_app_popup_display")}function kd(e){x.j(e,"open_in_desktop_app_popup_download")}function xd(e,t){x.j(e,"open_in_desktop_app_popup_open_in_app",t)}function Id(e){x.j(e,"add_slack_integration")}function Cd(e){x.j(e,"remove_slack_integration")}function Td(e,t){x.j(e,"slack_notification_create",t)}function Md(e,t){x.j(e,"slack_notification_delete",t)}function Pd(e,t){x.j(e,"slack_notification_update",t)}function Ad(e,t){x.j(e,"click_team_new_page_option",t)}function Dd(e,t){x.j(e,"show_team_duplicate_template_confirmation",t)}function Bd(e,t){x.j(e,"click_team_duplicate_template_confirmation_option",t)}function Rd(e,t){let{from:o,wiki_block_id:n,destination_team_id:r,wiki_template_id:i}=t;Fd(e,{from:o,preset_uri:"notion://wiki/wiki_preset",created_page_ids:[n],database_types:[a.GZ],destination_team_id:r,wiki_template_id:i})}function Ed(e,t){let{from:o,preset_uri:n,created_block_stores:r,destination_team_id:i}=t;const a=[],s=[];for(const d of r){var l;const e=null===(l=d.getCollectionStore())||void 0===l?void 0:l.getDatabaseType();e&&(s.push(d.id),a.push(e))}const c=r.map((e=>{var t;return null===(t=e.getFormat())||void 0===t?void 0:t.app_id})).filter(v.$K);Fd(e,{from:o,preset_uri:n,created_page_ids:s,database_types:a,destination_team_id:i,app_ids:[...new Set(c)]})}function Fd(e,t){x.j(e,"create_app_template",t)}function Nd(e,t){x.j(e,"delete_app_template",t)}function jd(e,t){x.j(e,"create_typed_dbs_in_team_latency",t)}function Od(e,t){x.j(e,"apply_preset_features",t)}function Ld(e,t){const{from:o}=t;x.j(e,"show_tooltip",{from:o,time:Date.now()})}function Ud(e,t){const{from:o}=t;x.j(e,"dismiss_tooltip",{from:o,time:Date.now()})}function Zd(e,t){x.j(e,"payment_status_banner_displayed",t)}function Vd(e,t){x.j(e,"payment_status_banner_action",t)}function qd(e){x.j(e,"managed_user_reactivate_button_clicked")}function zd(e,t){x.j(e,"managed_user_support_access_toggled",t)}function Wd(e,t){x.j(e,"managed_users_dashboard_search",t)}function Hd(e,t){x.j(e,"managed_users_external_space_access_set",t)}function Gd(e,t){x.j(e,"managed_users_prevent_support_access_toggled",t)}function Kd(e,t){x.j(e,"managed_users_session_duration_modal_confirmed",t)}function $d(e,t){x.j(e,"managed_user_delete_button_clicked",t)}function Yd(e,t){x.j(e,"managed_user_edit_modal_submitted",t)}function Qd(e){x.j(e,"managed_user_log_out_button_clicked")}function Jd(e,t){x.j(e,"managed_user_remove_from_external_workspace_button_clicked",t)}function Xd(e){x.j(e,"managed_user_reset_password_button_clicked")}function ep(e){x.j(e,"managed_user_suspend_button_clicked")}function tp(e,t){x.j(e,"managed_users_log_out_all_button_clicked",t)}function op(e,t){x.j(e,"managed_users_reset_passwords_all_button_clicked",t)}function np(e,t){x.j(e,"managed_users_session_duration_selected",t)}function rp(e,t){x.j(e,"managed_user_edit_profile_modal_open",t)}function ip(e,t){x.j(e,"managed_user_delete_modal_confirmed",t)}function ap(e,t){x.j(e,"managed_user_edit_modal_confirmed",t)}function sp(e){x.j(e,"managed_user_log_out_modal_confirmed")}function lp(e,t){x.j(e,"managed_user_remove_from_external_workspace_modal_confirmed",t)}function cp(e){x.j(e,"managed_user_reset_password_modal_confirmed")}function dp(e){x.j(e,"managed_user_suspend_modal_confirmed")}function pp(e,t){x.j(e,"managed_users_log_out_all_modal_confirmed",t)}function up(e,t){x.j(e,"managed_users_reset_passwords_all_modal_confirmed",t)}function mp(e){x.j(e,"managed_users_dashboard_button_clicked")}function gp(e,t){const{configurationState:o,runtimeState:n,hasQuery:r,searchSessionId:i,from:a}=t;o&&(x.j(e,"qna_open",{qna_session_id:o.sessionId,has_query:r,search_session_id:i,from:a}),y.j({name:"qna_open",args:{qna_session_id:o.sessionId,from:a,duration:Date.now()-o.startTimestamp,questions_asked_in_session:(null==n?void 0:n.evaluator.getTranscript().filter((e=>"human"===e.type)).length)??0}}))}function hp(e,t,o,n){t&&(x.j(e,"qna_close",{qna_session_id:t.sessionId,qna_session_length:Date.now()-t.startTimestamp,from:n}),y.j({name:"qna_close",args:{qna_session_id:t.sessionId,from:n,duration:Date.now()-t.startTimestamp,questions_asked_in_session:(null==o?void 0:o.evaluator.getTranscript().filter((e=>"human"===e.type)).length)??0}}))}function fp(e,t,o,n){t&&x.j(e,"qna_inference_start",{qna_session_id:t.sessionId,qna_inference_id:o,is_retry:n})}function yp(e,t,o,n){t&&x.j(e,"qna_inference_end",{qna_session_id:t.sessionId,qna_inference_id:o,time_took:n})}function vp(e,t,o,n){t&&x.j(e,"qna_feedback_given",{qna_session_id:t.sessionId,qna_inference_id:o,feedback:n})}function bp(e,t,o){t&&x.j(e,"qna_result_clicked",{qna_session_id:t.sessionId,clicked_page_id:o})}function Sp(e,t,o){t&&(x.j(e,"qna_clear",{qna_session_id:t.sessionId}),y.j({name:"qna_clear",args:{qna_session_id:t.sessionId,duration:Date.now()-t.startTimestamp,questions_asked_in_session:(null==o?void 0:o.evaluator.getTranscript().filter((e=>"human"===e.type)).length)??0}}))}function _p(e,t){const o=(0,V.zt)();x.j(e,"workspace_member_number_update",{new_workspace_member_count:t.new_workspace_member_count,origin:t.invite_origin,subscription_tier:o,domain_type:t.domainType,company_segment:(0,Z.Ns)()}),F.default.logEvent("workspace_member_number_update",t.new_workspace_member_count,{origin:t.invite_origin,subscription_tier:o,domain_type:t.domainType,company_segment:(0,Z.Ns)()})}function wp(e,t){const o=(0,V.zt)(),n=(0,C.JF)();x.j(e,"person_property_invite_click_menu_item",{subscription_tier:o,domain_type:n,origin:t.origin,invite_flow_id:t.invite_flow_id})}function kp(e,t){const o=(0,V.zt)(),n=(0,C.JF)();x.j(e,"person_property_invite_render_menu_item",{subscription_tier:o,domain_type:n,origin:t.origin,invite_flow_id:t.invite_flow_id})}function xp(e,t){const o=(0,V.zt)(),n=(0,C.JF)(),r="member"===t.invite_option?t.can_add_member?"member":"request_member":"guest";x.j(e,"person_property_invite_click_invite_button",{subscription_tier:o,domain_type:n,invited_type:r,invited_user_count:t.invited_user_count,origin:t.origin,invite_token_query:t.inviteTokenQuery,invite_targets:t.inviteTargets,invite_flow_id:t.invite_flow_id})}function Ip(e,t){const o=(0,V.zt)(),n=(0,C.JF)();x.j(e,"person_property_invite_click_upgrade_button",{subscription_tier:o,domain_type:n,origin:t.origin,invited_user_count:t.invited_user_count,invite_flow_id:t.invite_flow_id})}function Cp(e,t){const o=(0,V.zt)(),n=(0,C.JF)();x.j(e,"person_property_invite_guest_invited",{subscription_tier:o,domain_type:n,invited_user_count:t.invited_user_count,origin:t.origin,invite_flow_id:t.invite_flow_id})}function Tp(e,t){const o=(0,V.zt)(),n=(0,C.JF)();x.j(e,"person_property_invite_member_invited",{subscription_tier:o,domain_type:n,invited_user_count:t.invited_user_count,origin:t.origin,invite_flow_id:t.invite_flow_id})}function Mp(e,t){const o=(0,V.zt)(),n=(0,C.JF)();x.j(e,"person_property_invite_member_requested",{subscription_tier:o,domain_type:n,invited_user_count:t.invited_user_count,origin:t.origin,invite_flow_id:t.invite_flow_id})}function Pp(e,t){const o=(0,V.zt)(),n=(0,C.JF)();x.j(e,"person_property_invite_error",{subscription_tier:o,domain_type:n,invite_stage:t.invite_stage,invite_flow_id:t.invite_flow_id,error:t.error})}function Ap(e,t){const o=(0,V.zt)(),n=(0,C.JF)(),r="member"===t.invite_option?t.can_add_member?"member":"request_member":"guest";x.j(e,"person_property_invite_completed",{subscription_tier:o,domain_type:n,invited_type:r,invited_user_count:t.invited_user_count,is_success:t.is_success,origin:t.origin,invite_flow_id:t.invite_flow_id})}function Dp(e,t){const o=(0,V.zt)(),n=(0,C.JF)();x.j(e,"person_property_invite_message_typed",{subscription_tier:o,domain_type:n,origin:t.origin,invite_flow_id:t.invite_flow_id})}function Bp(e,t){const o=(0,V.zt)(),n=(0,C.JF)();x.j(e,"person_property_invite_dismiss_popup",{subscription_tier:o,domain_type:n,origin:t.origin,invite_flow_id:t.invite_flow_id})}function Rp(e,t){const o=(0,V.zt)(),n=(0,C.JF)();x.j(e,"person_property_invite_change_permission",{subscription_tier:o,domain_type:n,origin:t.origin,invite_flow_id:t.invite_flow_id,invited_role:t.invited_role})}function Ep(e,t){const o=(0,V.zt)(),n=(0,C.JF)();x.j(e,"person_property_invite_click_invite_option",{subscription_tier:o,domain_type:n,origin:t.origin,invite_flow_id:t.invite_flow_id,invite_option:t.invite_option})}function Fp(e,t){x.j(e,"guest_invite_request_setting_toggled",t)}function Np(e,t){x.j(e,"settings_deeplink_clicked",t)}function jp(e,t){x.j(e,"guest_invite_request_resolved",t)}function Op(e,t){if(x.j(e,"disable_guest_toggle",t),!0===t.new_value&&!t.keep_existing_guests_if_disabled){const{data:t}=U.default.state;if(!t)return;const o=(0,Z.ND)(t).length;o>0&&Lp(e,{origin:"space_setting_disable_guest",changedNumber:-o})}}function Lp(e,t){let{inviteTargets:o,origin:n,changedNumber:r}=t;const i=(0,C.JF)(),a=(0,V.zt)();if(r)return x.j(e,"workspace_guest_number_update",{new_workspace_guest_count:r,origin:n,subscription_tier:a,domain_type:i,company_segment:(0,Z.Ns)()}),void F.default.logEvent("workspace_guest_number_update",r,{origin:n,subscription_tier:a,domain_type:i,company_segment:(0,Z.Ns)()});const{data:s}=U.default.state;if(!s||!o)return;const l=(0,Z.ND)(s).map((e=>e.userId)),c=o.filter((e=>!!(0,N.cl)(e)||"existingUser"===e.type&&!l.includes(e.value.id)));0!==c.length&&(x.j(e,"workspace_guest_number_update",{new_workspace_guest_count:c.length,origin:n,subscription_tier:a,domain_type:i,company_segment:(0,Z.Ns)()}),F.default.logEvent("workspace_guest_number_update",c.length,{origin:n,subscription_tier:a,domain_type:i,company_segment:(0,Z.Ns)()}))}},8406:(e,t,o)=>{o.d(t,{$q:()=>g,Ac:()=>S,Rc:()=>h,S$:()=>y,YU:()=>w,_H:()=>l,bW:()=>I,bn:()=>T,g2:()=>x,gd:()=>k,gl:()=>m,mH:()=>c,nS:()=>u,qm:()=>_,rv:()=>v,tW:()=>C,tf:()=>M,wd:()=>p,xb:()=>d,y9:()=>f,zF:()=>b});var n=o(34296),r=o(97880),i=o(24215),a=o(75079),s=o(50906);function l(e){const{environment:t,collectionContextStore:o,...n}=e,r=(0,a.Pn)(o)||{};s._Hi(t,{...r,...n})}function c(e,t){i.j(e,"collection_create_suggested_property_latency",t)}function d(e){const{environment:t,collectionContextStore:o,view_type:n,view_config_uri:r,...i}=e,l=(0,a.Pn)(o)||{};s.xbC(t,{...l,...i,view_type:n,view_config_uri:r})}function p(e){const{environment:t,collectionContextStore:o,action:n,original_view_type:r,new_view_type:i,new_view_id:l,property_type:c,new_date_shift_mode:d,new_avoid_weekends:p}=e,u=(0,a.Pn)(o);u&&u.view_type&&s.wds(t,{action:n,...u,view_type:u.view_type,original_view_type:r,new_view_type:i,new_view_id:l,property_type:c,new_date_shift_mode:d,new_avoid_weekends:p})}function u(e){const t=(0,a.Pn)(e.collectionContextStore);t&&t.view_type&&s.MU3(e.environment,{from:e.from,from_peek_mode:e.from_peek_mode,...t,view_type:t.view_type})}function m(e){const{peek_mode:t,from_peek_mode:o}=e,n=(0,a.Pn)(e.collectionContextStore);n&&n.view_type&&s.lgT(e.environment,{from:e.from,peek_mode:t,from_peek_mode:o,...n,view_type:n.view_type})}function g(e){const{environment:t,collectionContextStore:o,property:n,from:r,action:i,new_property_type:l,...c}=e,d=o.normalizedSchemaStore.state[n],p=(0,a.Pn)(o)||{};s.$qu(t,{property_type:null==d?void 0:d.type,new_property_type:l,property:n,from:r,action:i,...c,...p})}function h(e){const{environment:t,collectionContextStore:o,view_type:n,from:r,...i}=e,l=(0,a.Pn)(o)||{};s.RcY(t,{from:r,...i,...l,view_type:n})}function f(e){const{environment:t,collectionContextStore:o,property_type:n,from:r,property:i,...l}=e,c=(0,a.Pn)(o)||{};s.y9e(t,{property:i,property_type:n,from:r,...l,...c})}function y(e,t,o){var n,s,l;let c="page_properties";const d=(0,a.Pn)(t);switch(d.view_type){case void 0:case"page":case"table":c="table";break;case"list":c="list";break;case"gallery":c="gallery";break;case"board":c="board";break;case"calendar":c="calendar";break;case"timeline":c="timeline";break;default:(0,r.t1)(d.view_type)}const p={...o,collection_id:null==t||null===(n=t.collectionStore())||void 0===n?void 0:n.id,collection_view_id:null==t||null===(s=t.collectionViewStore())||void 0===s?void 0:s.id,collection_view_block_id:null==t||null===(l=t.collectionViewBlockStore())||void 0===l?void 0:l.id,from:c};i.j(e,"copy_property",p)}function v(e){var t;const{environment:o,collectionContextStore:n,block_id:r,property:i,property_type:l,from:c,isFromBulkActionsToolbar:d,isUnthrottled:p,...u}=e,m=(0,a.Pn)(n)||{};let g;null!==(t=n.currentSubitemFormatStore.state)&&void 0!==t&&t.property?g="subitem":n.currentArrowsByFormatStore.state&&(g="timeline_arrows_by"),s.rvl(o,{block_id:r,property:i,property_type:l,property_context:g,from:c,isFromBulkActionsToolbar:d,...u,...m},p||!1)}function b(e){const{environment:t,collectionContextStore:o,property:n,property_type:r,from:s,isFromBulkActionsToolbar:l,...c}=e,d=(0,a.Pn)(o)||{};i.j(t,"collection_open_block_property_overlay",{property:n,property_type:r,property_context:undefined,from:s,isFromBulkActionsToolbar:l,...c,...d})}function S(e){const{environment:t,collectionContextStore:o,checkbox_type:n,...r}=e,s=(0,a.Pn)(o)||{};i.j(t,"collection_multi_select_checkbox_clicked",{...s,checkbox_type:n,...r})}function _(e){const{environment:t,collectionContextStore:o,property_type:n,num_rows:r}=e,i=(0,a.Pn)(o)||{};s.fMl(t,{property_type:n,num_rows:r,...i})}function w(e){const{environment:t,collectionContextStore:o,...n}=e,r=(0,a.Pn)(o)||{};s.YU0(t,{...r,...n})}function k(e){const{environment:t,collectionContextStore:o,...n}=e,r=(0,a.Pn)(o)||{};i.j(t,"convert_db_start",{...r,...n})}function x(e){const{environment:t,collectionContextStore:o,...n}=e,r=(0,a.Pn)(o)||{};i.j(t,"convert_db_complete",{...r,...n})}function I(e){i.j(e,"collections.bypassed_query_collection_request")}function C(e){const{environment:t,totalResults:o,clickedIndex:r,eventName:a,sessionId:s,source:l,queryLength:c}=e;let d;l===n.S.Automation?d="automation_collection_picker":l===n.S.Relation?d="collection_settings_select_relation_source":l===n.S.Source&&(d="collection_settings_source");const p=Boolean(0===c);(0,i.j)(t,a,{source:d,"server-indexAlias":"collection",totalResults:o,clickedIndex:r,sessionId:s,queryLength:c,isEmptyQuery:p})}function T(e){i.j(e,"collection_load_more_blocks")}function M(e){i.j(e,"collection_load_more_groups")}},19719:(e,t,o)=>{o.d(t,{EQ:()=>y,F5:()=>p,GP:()=>w,Jn:()=>x,Q6:()=>k,U0:()=>M,Up:()=>_,Xf:()=>T,Z8:()=>f,_b:()=>d,b2:()=>I,cC:()=>u,gY:()=>g,ix:()=>m,nI:()=>b,pw:()=>S,u_:()=>h,zD:()=>C});var n=o(27328),r=o(82813),i=o(97880),a=o(4761),s=o(17659),l=o(24215),c=o(50906);function d(e){v({...e,target:"archive"})}function p(e){v({...e,target:"unarchive"})}function u(e){v({...e,target:"mark_as_read"})}function m(e){v({...e,target:"frame"})}function g(e){v({...e,target:"open_reply_menu"})}function h(e){v({...e,target:"mark_as_unread"})}function f(e){let{environment:t,pageId:o,isCurrentlyFollowing:n,from:r,notificationId:i}=e;l.j(t,"click_page_updates_notifications_button",{pageId:o,isCurrentlyFollowing:n,from:r,notificationId:i})}function y(e){let{environment:t,backlinkPageId:o,notificationId:n,alreadyRead:r,activity:i,tab:a}=e;v({environment:t,target:"title",notificationId:n,alreadyRead:r,activity:i,tab:a,otherArgs:{backlinkPageId:o}})}function v(e){let{environment:t,target:o,notificationId:n,alreadyRead:i,activity:s,tab:d,otherArgs:p}=e;S({environment:t,target:o});const u=a.ZP.state.sessionId;c.CgP(t,{target:o,notification_id:n,activity_id:s.id,tab:d,sessionId:u,is_filtered:a.ZP.isFilteredToUnreadOnly(),...p}),n&&r.e(l.mc(t),{alreadyRead:i,notificationId:n,activityId:s.id,from:o,sessionId:u})}function b(e){const t=a.ZP.state.sessionId;t&&(l.j(e,"close_sidebar_updates",{sessionId:t,tab:x()}),a.ZP.endSession())}function S(e){let{environment:t,target:o}=e,n=!1;switch(o){case"title":case"body":n=!0;break;case"archive":case"unarchive":case"mark_as_read":case"mark_as_unread":case"add_reaction":case"open_reply_menu":case"frame":n=!1;break;default:(0,i.t1)(o)}n&&b(t)}function _(e){let{environment:t,from:o}=e;const r=(0,n.w_)(t.TabbedRouterStore.state);var i;"web"===(i=r).type&&"nativeTab"===i.route.name&&"updates"===i.route.tab&&w({environment:t,from:o})}function w(e){let{environment:t,forceRestartSession:o,from:n}=e;a.ZP.startSession({forceRestart:o??!1}),c.tmQ(t,{tab:x(),unread_notifications_count:s.aY(),sessionId:a.ZP.state.sessionId,from:n})}function k(e){let{environment:t,activityUpdatesSource:o,filters:n,prevFilters:r}=e;l.j(t,"update_notification_filters",{source:o,prev_date_range_filter_start:r.dateRange.start,prev_date_range_filter_end:r.dateRange.end,prev_activity_types:r.activityTypes,date_range_filter_start:n.dateRange.start,date_range_filter_end:n.dateRange.end,activity_types:n.activityTypes})}function x(){const e=a.ZP.state.currentTab;switch(e){case"mentions":return"mentions_comments";case"archive":return"archive";case"allPages":return"all_updates";default:(0,i.t1)(e)}}function I(e){let{environment:t,action:o,args:n}=e;l.j(t,"push_notification_desktop",{...n,action:o})}function C(e,t){l.j(e,"archive_all_notifications",{...t,onlyRead:"read"===t.readFilter})}function T(e){l.j(e,"mark_all_notifications_as_read")}function M(e,t){l.j(e,"toggle_filter_for_unread_notifications",t)}},91536:(e,t,o)=>{o.d(t,{kM:()=>c,oE:()=>d});var n=o(72126),r=o(26825),i=o(27006),a=o(67669),s=o(28578),l=o(50906);function c(e){let{environment:t,location:o,inSudoMode:n,store:r,newItems:i,fromPermissionWrapper:a}=e;p({store:r,newItems:i}).forEach((e=>{let{role_old_inherited_or_most_permissive:r,role_old_on_page:i,privacy_level:c,old_privacy_level:d,newItem:p}=e;c||d?l.s8J(t,{...p,location:o,in_sudo_mode:n||void 0,role_old_inherited_or_most_permissive:r,role_old_on_page:i,privacy_level:c,old_privacy_level:d,share_menu_session_id:s.ZP.state.sessionId,from_permission_wrapper:a}):l.s8J(t,{...p,location:o,in_sudo_mode:n||void 0,role_old_inherited_or_most_permissive:r,role_old_on_page:i,share_menu_session_id:s.ZP.state.sessionId,from_permission_wrapper:a})}))}function d(e){const{environment:t,calculatedPermissions:o}=e;l.o0U(t,{share_menu_session_id:s.ZP.state.sessionId,page_permission_summary:m(o)})}function p(e){let{store:t,newItems:o}=e;const s=e=>`${e.type}:${r.D3(e)}`,l=t.getPermissionItems(),c=n.KX(l,s),d=a.YO(t).map((e=>e.permissionItem)),p=n.KX(d,s);return o.map((e=>{var t;const o=s(e),n=p[o],r=null===(t=c[o])||void 0===t?void 0:t.role,a=null==n?void 0:n.role;return(0,i.ix)(e)?{newItem:e,role_old_inherited_or_most_permissive:a,role_old_on_page:r,privacy_level:u(e),old_privacy_level:n&&(0,i.ix)(n)?u(n):"private"}:{newItem:e,role_old_inherited_or_most_permissive:a,role_old_on_page:r}}))}function u(e){return"none"===e.role?"private":e.unlisted_timestamp?"unlisted":"open"}function m(e){const{mostPermissiveSpaceItem:t,mostPermissiveAncestorTeamOwnerItem:o,mostPermissiveAncestorTeamMemberItem:n,pagePermissionUIModel:r}=e,{mostPermissiveGroupPermissions:a,mostPermissiveUserPermissions:s}=r;return{space:t.permissionItem.role,team_owner:null==o?void 0:o.permissionItem.role,team_member:null==n?void 0:n.permissionItem.role,groups:{full_access:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.zz(t)})).length,can_edit:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.VM(t)})).length,can_edit_content:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.WY(t)})).length,can_comment:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.rG(t)})).length,can_view:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.rz(t)})).length},users:{full_access:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.zz(t)})).length,can_edit:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.VM(t)})).length,can_edit_content:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.WY(t)})).length,can_comment:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.rG(t)})).length,can_view:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.rz(t)})).length},privacy_level:u(t.permissionItem)}}},54642:(e,t,o)=>{o.r(t),o.d(t,{activateReferral:()=>Xo,addUserToWaitlist:()=>Cl,addUsersToSpace:()=>Xt,addWebClipperFile:()=>lt,addWebClipperURLs:()=>gn,adminAddLinkPreviewToSpace:()=>gl,adminAddPublicEmailDomains:()=>Rr,adminAddZeroRetentionSpace:()=>Et,adminAllowlistCreditDomain:()=>Dn,adminBanUser:()=>Ia,adminBlockEmailDomain:()=>ji,adminBulkAddPromotionCodes:()=>Mi,adminBulkApplyPromotionCodes:()=>Di,adminBulkBanUsers:()=>Ca,adminBulkCreateTimedTrials:()=>Vs,adminBulkRemoveSpaceGuests:()=>Pi,adminBulkUpgradeEduPlusUser:()=>Bi,adminBypassEmailReputationChecks:()=>$n,adminCancelSubscription:()=>yr,adminChangeEmail:()=>kr,adminCheckHIPAAComplianceStatus:()=>Ft,adminCheckStatsigSegment:()=>Mn,adminClaimAndUpgradeForSalesAssisted:()=>Da,adminContentSearch:()=>gs,adminCopyPageBetweenEnvironments:()=>Ui,adminCountWordsInPage:()=>Zi,adminCreateMarketingRoute:()=>xa,adminDelayClaimSpaceDeletion:()=>Ba,adminDeleteFileFromS3:()=>fi,adminDeleteSpaces:()=>Wt,adminDeleteUser:()=>Rt,adminDescribeAccountsToReset:()=>Ht,adminDescribeDeleteFileFromS3:()=>yi,adminDescribeDeletedBlockPermissions:()=>ki,adminDescribeEditSpacePermission:()=>Ut,adminDescribeRestoreDeletedGuestPermissions:()=>ml,adminDescribeRunSpaceConsolidation:()=>zt,adminDescribeSpacesToDelete:()=>qt,adminDisableReverifyForUser:()=>Vt,adminDowngradeFraudSubscription:()=>Ya,adminEditBlockPermissions:()=>jt,adminEditSpacePermissions:()=>Lt,adminEditTeamMembership:()=>$t,adminExplainPaymentStatus:()=>Ys,adminFindDeletedUser:()=>An,adminForceResyncExternalObjects:()=>_a,adminGetBulkIds:()=>Qs,adminGetBulkSpaceIdsByDomain:()=>Ln,adminGetBulkSpaceIdsByEmail:()=>Un,adminGetBulkUserIdsByEmail:()=>Zn,adminGetClientExperiments:()=>In,adminGetDataAccessConsent:()=>On,adminGetDomainClaimEligibleSpaces:()=>Pa,adminGetDomainManagementSettings:()=>Aa,adminGetIntegrationData:()=>fa,adminGetOwnership:()=>ui,adminGetPublicPages:()=>Hi,adminGetRateLimits:()=>mi,adminGetSamlConfig:()=>gi,adminGetSlackIntegrationData:()=>va,adminGetSpaceMembershipUpdates:()=>Zs,adminGetSpacesForAllowedEmailDomain:()=>vi,adminGetStatsigExperiment:()=>Cn,adminGetStatsigFeatureGate:()=>Tn,adminGetSyncedDatabaseData:()=>ba,adminGetUserBillingInformation:()=>Kn,adminGetWorkspaceWebhookSubscriptions:()=>Tl,adminIsSpaceDomainClaimEligible:()=>Ma,adminIsWorkspaceInQnA:()=>wl,adminJoinSpacesForOauthRedirect:()=>Sa,adminListData:()=>Nt,adminMergeUsers:()=>kl,adminModifyBlock:()=>_i,adminOnboardAISlackQnA:()=>Gt,adminOptOutNotionAIDataSharing:()=>Gs,adminPrimaryWorkspaceChange:()=>hi,adminReadBlockPermissions:()=>Ot,adminRecoverMfa:()=>Hn,adminReleaseSubscriptionSchedule:()=>Ns,adminRemoveAllowedEducationEmails:()=>Ai,adminRemoveChildFromExternalCollection:()=>Ra,adminRemoveSpaceUsersAndTransferContent:()=>Gn,adminResetAccounts:()=>Kt,adminResetRateLimits:()=>bi,adminRestoreBlock:()=>wi,adminRestoreDeletedCollectionProperties:()=>Gi,adminRestoreDeletedGuestPermissions:()=>ul,adminRunSpaceConsolidation:()=>Ea,adminSamlConfigForSpace:()=>Yn,adminSearchAuditLog:()=>Ta,adminSearchBlocks:()=>Vn,adminSearchCollectionViews:()=>Wn,adminSearchCollections:()=>zn,adminSearchForUsersInSpaces:()=>jn,adminSearchPermanentlyDeletedPages:()=>Oi,adminSearchSpaceActivity:()=>Li,adminSearchSpaces:()=>Nn,adminSearchTeams:()=>qn,adminSearchUsers:()=>xn,adminSetDisableSpacePublicAccess:()=>Tr,adminSetPageContentClassification:()=>Zt,adminSetSpaceDomain:()=>Mr,adminSetupExperiment:()=>gr,adminShowCustomerInvoice:()=>Er,adminSwapUserDomains:()=>Fr,adminSwapUserEmails:()=>Nr,adminUpdateAddOnSubscription:()=>Fs,adminUpdateExperiment:()=>mr,adminUpdateIntegrationData:()=>ya,adminUpdateNotionAIAvailabilityForSpace:()=>Us,adminUpdatePaymentStatus:()=>Js,adminUpdateStatsigSegmentIds:()=>Pn,adminUpdateSubscription:()=>fr,adminUpdateTeamMember:()=>Yt,adminUpdateUserSettings:()=>Qt,adminViewDeletedCollectionProperties:()=>Ki,adminViewExperiments:()=>ur,aiSourcePicker:()=>Yi,allowEducationEmails:()=>vr,annotateRecentIntercomConversation:()=>Si,applyCustomerOffer:()=>ns,authCreateBackupCodes:()=>Ts,authCreateSms:()=>St,authCreateTotp:()=>xs,authGetLoginConfiguration:()=>pt,authSendSms:()=>wt,authUpdateMfa:()=>xt,authVerifyBackupCodesLogin:()=>Ms,authVerifyPassword:()=>Ps,authVerifySmsEnroll:()=>_t,authVerifySmsLogin:()=>kt,authVerifyTotpEnroll:()=>Cs,authVerifyTotpLogin:()=>Is,authWithAsana:()=>tn,authWithEvernote:()=>fn,authWithExternalIntegration:()=>ln,authWithGoogleForDrive:()=>sn,authWithSlack:()=>an,authWithTrello:()=>rn,authenticateConfluenceUser:()=>Ee,authenticateMondayUser:()=>Fe,calculateTax:()=>Ri,cancelSpaceDeletionForDomain:()=>$a,cancelSubscription:()=>De,changeEmail:()=>vt,checkFilePermission:()=>No,checkSpaceDomain:()=>Ei,claimAndUpgradeSpace:()=>Wa,completeMultipartUpload:()=>Ja,createDomainVerificationCode:()=>ja,createEmailUser:()=>ge,createOauthAuthorizationCode:()=>Wi,createSpace:()=>Cr,createTeam:()=>aa,deleteBlocks:()=>ro,deleteBot:()=>Fi,deleteDomainVerificationCode:()=>Fa,deleteGroup:()=>fo,deleteIntegration:()=>Ni,deleteManagedUser:()=>tr,deleteSpace:()=>Pt,deleteSpaceForDomain:()=>Ka,deleteUser:()=>At,disableUserAnalytics:()=>Wo,disconnectAsana:()=>mt,disconnectConfluence:()=>Le,disconnectDrive:()=>ft,disconnectEvernote:()=>ht,disconnectMonday:()=>Ue,disconnectTrello:()=>gt,duplicateBlock:()=>te,enableTeams:()=>Bt,enqueueTask:()=>et,exportAdminContentSearch:()=>qo,exportAuditLog:()=>Lo,exportBlock:()=>Xe,exportBlockPreview:()=>_n,exportContentAnalytics:()=>Vo,exportDomainClaimableSpaces:()=>Uo,exportSpace:()=>Oo,exportSpaceGuests:()=>bl,exportSpaceMembers:()=>vl,exportUserAnalytics:()=>Zo,finalizeAppTemplate:()=>kn,findUser:()=>ne,getAIUsageEligibility:()=>js,getAboutNotionDevelopers:()=>bs,getAccessRequests:()=>Ur,getActiveExportTasks:()=>$s,getActiveImportTasks:()=>oe,getActivityLog:()=>yt,getAdminHistory:()=>di,getAllTeamsInSpaceForAdmin:()=>da,getAsanaAccount:()=>$,getAsanaWorkspaces:()=>K,getAsanaWorkspacesNames:()=>J,getAssetsJson:()=>W,getAssetsJsonV2:()=>H,getAssetsJsonV3:()=>G,getAssistantLogs:()=>Ce,getAuthorizedEmailPreferenceCenterLink:()=>Vr,getAvailableCountries:()=>ii,getBacklinksForBlock:()=>It,getBillingHistory:()=>jo,getBlockAdminApiLog:()=>ci,getBlockFileDownloadUrl:()=>pe,getBookmarks:()=>no,getBotToken:()=>Ct,getBots:()=>Go,getClientExperiments:()=>dr,getClientExperimentsV2:()=>pr,getCollectionViewBlocksByAppId:()=>es,getCompletion:()=>nn,getCompletionForProperty:()=>Os,getCompletionForSelectOption:()=>Ls,getConfluenceAccount:()=>Oe,getConfluenceSpaces:()=>je,getConnectedAppsStatus:()=>on,getContentEngagementAnalytics:()=>ls,getCostForSpaceUpgrade:()=>za,getCsatMilestones:()=>Gr,getCustomerOffer:()=>os,getDailyUsersAnalytics:()=>as,getDataAccessConsent:()=>Wr,getDataAccessConsentForManagedUser:()=>rr,getDesktopAppRegistration:()=>ws,getDesktopDownloadUrl:()=>Ae,getDeveloperBotsAndIntegrations:()=>Ii,getDomainVerificationCodesForSpace:()=>Oa,getEmailDomainSettings:()=>sr,getEmailDomainsForSpace:()=>Jn,getEmailsWithoutAccessToBlock:()=>Xi,getEvernoteAccount:()=>Y,getEvernoteNotebooks:()=>un,getExternalCollectionSyncState:()=>Ji,getExternalIntegrationAccessToken:()=>rs,getExternalIntegrations:()=>Vi,getExternalNotificationChannels:()=>ms,getExternalOrgData:()=>Il,getGenericEmbedBlockData:()=>_r,getGeoIpLocation:()=>qs,getGiphyRandomId:()=>En,getGoogleDriveAccounts:()=>cn,getHarmonicData:()=>_e,getHistoricalAuditLogUsers:()=>ce,getIdFromUniqueId:()=>Bs,getInAppCategoriesAndTemplates:()=>Es,getInferenceTestExamples:()=>fs,getIntegrationDataForGallery:()=>ma,getIntegrationDomainVerifications:()=>Ci,getIntegrationIdsForGallery:()=>ga,getIntegrationSecret:()=>Ti,getInvoiceData:()=>Jt,getJoinableSpaces:()=>to,getLivestormEvents:()=>Me,getLivestormSessions:()=>Pe,getLoginOptions:()=>dt,getManagedUsers:()=>Xn,getMondayFoldersAndBoards:()=>Ve,getMondayUser:()=>Ne,getMondayWorkspaces:()=>Ze,getNextRelabelingTask:()=>Ie,getNotificationLog:()=>vo,getNotificationLogV2:()=>bo,getPageAnalytics:()=>ts,getPageAssistantPreferences:()=>dl,getPageVisitors:()=>$r,getPrivatePageInfo:()=>pa,getPromoCode:()=>Sr,getPublicApiObject:()=>ks,getPublicPageData:()=>Dt,getPublicSpaceData:()=>Do,getPublishedPagesForUser:()=>_l,getRecentPageVisits:()=>me,getRecoverableSpaceUserContent:()=>wa,getSamlConfigForSpace:()=>Qn,getSamlRedirect:()=>ut,getSelectPropertyValues:()=>yo,getSignedFileUrl:()=>Fl,getSkillsInSpace:()=>xe,getSnapshotContents:()=>Qo,getSnapshotsList:()=>Yo,getSpaceAdminApiLog:()=>li,getSpaceMembershipUpdates:()=>il,getSpaces:()=>oo,getSpacesCreatedByUserWithDomains:()=>Va,getSubitems:()=>z,getSubscriptionData:()=>Be,getTasks:()=>Or,getTeamAccessRequestMetadata:()=>zs,getTeams:()=>ca,getTeamsAndProjectsInAsanaWorkspace:()=>X,getTemplateChecklistForBlock:()=>Kr,getTemplateCreator:()=>el,getTemplateSearchResults:()=>Xs,getTestFlightStatus:()=>Lr,getTransitivePageRelations:()=>Ks,getTrelloAccount:()=>Q,getTrelloBoards:()=>ee,getTypedDatabases:()=>Xa,getUniversitiesAndDomains:()=>yl,getUnreadAccessRequestCount:()=>Zr,getUnvisitedNotificationIds:()=>So,getUploadFileUrl:()=>Mt,getUserAdminApiLog:()=>si,getUserAnalyticsSettings:()=>ao,getUserContractionData:()=>al,getUserEngagementAnalytics:()=>ss,getUserHomePages:()=>ri,getUserNotifications:()=>Io,getUserSharedPagesInSpace:()=>oi,getUserSignals:()=>ni,getUserSpaceExternalBots:()=>zi,getUserTasks:()=>jr,getVerifiedEmailDomain:()=>us,getVisibleUsers:()=>Re,getWebClipperData:()=>mn,getWebhookSubscriptions:()=>Ko,getZendeskTicketConversation:()=>qi,handleRecordMapForResponse:()=>F,identifySegmentUser:()=>ko,identifySegmentWorkspace:()=>wo,importAsana:()=>Ke,importAsanaIntoBetterTemplate:()=>$e,importConfluenceExport:()=>ze,importEvernote:()=>Je,importFile:()=>qe,importTrello:()=>Ge,initializeGoogleDriveBlock:()=>dn,initializePageTemplate:()=>wn,initializeUserAnalytics:()=>Ro,initializeUserAnalyticsEmptySync:()=>Eo,initiateMultipartUpload:()=>Qa,initiateWorkspaceTransfer:()=>qa,invalidateSubscriptionData:()=>ai,inviteGuestsToSpace:()=>Dr,isEligibleForGuestMembershipRequest:()=>ys,isEmailEducation:()=>br,isRecordKeyAvailable:()=>Ds,isUserDomainJoinable:()=>wr,leaveBlock:()=>Ao,listExternalCollections:()=>ra,listExternalObjects:()=>ia,listPrices:()=>ve,loadBlockSubtree:()=>Bo,loadCachedPageChunk:()=>co,loadCachedPageChunkBatched:()=>Pl,loadCachedPageChunks:()=>po,loadContacts:()=>Ss,loadContentAnalytics:()=>ds,loadPageChunk:()=>uo,loadSearchAnalytics:()=>ps,loadUserContent:()=>lo,loadWorkspaceAnalyticsUsers:()=>cs,loginWithAppleAuth:()=>tt,loginWithAppleNativeAuth:()=>ot,loginWithEmail:()=>nt,loginWithGoogleAuth:()=>it,loginWithGoogleJwt:()=>rt,logout:()=>at,logoutActiveSessions:()=>Ir,logoutManagedUsers:()=>lr,markDiscussionNotificationsRead:()=>ua,moveToSpace:()=>Ar,parallelAsanaImport:()=>Ye,parallelImportConfluenceExport:()=>We,parallelImportConfluenceViaApi:()=>He,parallelMondayImport:()=>Qe,pendingTaskEventsById:()=>Nl,pendingTaskIds:()=>V,performAiSearch:()=>ke,ping:()=>vn,postGiphyAnalytics:()=>Fn,previewMidtermSubscriptionChanges:()=>be,processShareActionToBlock:()=>ea,publishAiSession:()=>Sl,queryCollection:()=>mo,queryCollectionStream:()=>go,recordCookieConsent:()=>ha,recordPageExit:()=>Qr,recordPageVisit:()=>Yr,recoverSpace:()=>bn,recoverUser:()=>yn,refetchExternalObjectInstanceBlocks:()=>na,refreshGoogleDriveBlock:()=>pn,refreshInviteLink:()=>Br,registerDesktopApp:()=>_s,releaseSubscriptionSchedule:()=>ye,removeManagedUserFromSpace:()=>ar,removeUsersFromSpace:()=>eo,renameGroup:()=>ho,reportBadQnA:()=>le,reportBadSearch:()=>se,reportPage:()=>pi,requestAccess:()=>qr,requestClaimAndUpgrade:()=>Ha,resetExperimentOverrides:()=>oa,resetPasswordsForManagedUsers:()=>cr,resolveAccessRequest:()=>xl,resolveAddress:()=>xi,restoreBlock:()=>io,restoreSnapshot:()=>Jo,resubscribeExternalCollection:()=>Qi,revokeBotToken:()=>Tt,revokeUserTokens:()=>Sn,saveAssistantFeedback:()=>we,saveRelabelingTaskFeedback:()=>Te,saveTransactions:()=>Pr,search:()=>re,searchAuditLog:()=>ie,searchContacts:()=>ae,searchGiphyImages:()=>Rn,searchIntegrations:()=>de,searchUnsplashImages:()=>Bn,searchVectors:()=>hs,searchWebClipperPages:()=>hn,sendEmailVerification:()=>bt,sendTemporaryPassword:()=>ct,sendVerifyTransferEmail:()=>is,setAdminPrivilegedTeamMembership:()=>sa,setBookmarkMetadata:()=>en,setDataAccessConsent:()=>Hr,setDataAccessConsentForManagedUser:()=>ir,setLocale:()=>ue,setNotificationsAsRead:()=>xo,setNotificationsStatus:()=>To,setPageAssistantPreferences:()=>pl,setPageNotificationsAsRead:()=>Co,setPassword:()=>xr,setRecordKey:()=>As,setSamlConfig:()=>Za,setSeenGuestMembershipRequests:()=>vs,setSpaceNotificationsAsRead:()=>Mo,spaceAdminRestoreAccess:()=>Jr,stripeAdvanceTestClock:()=>Ws,stripeGetTestClock:()=>Hs,submitCsatFeedback:()=>zr,submitEducationGroupApplication:()=>fl,submitFormstack:()=>Se,submitTemplate:()=>tl,submitTemplateCreator:()=>ol,suggestRecordKey:()=>Rs,syncRecordValue:()=>Dl,syncRecordValues:()=>so,testCreatePage:()=>ll,testDeleteRecord:()=>cl,testSetupWorkspace:()=>sl,testWebhookConnection:()=>$o,trackConversionEvent:()=>Xr,trackSegmentEvent:()=>_o,transferPermissionGroup:()=>zo,transferSpaceUserContent:()=>ka,transferWorkspaceToUser:()=>Ga,unfurlUrl:()=>$i,unsubscribeFromEmails:()=>Po,unsubscribeFromIntercomEmails:()=>Ho,updateDisableGuestsOnSpace:()=>hl,updateEmailDomainSettings:()=>or,updateExperimentOverride:()=>ta,updatePaymentMethod:()=>fe,updatePublicHomePage:()=>ti,updateSpaceDomain:()=>ei,updateSubscription:()=>he,updateSubscriptionToEducationPlan:()=>hr,updateTeamMembers:()=>la,updateUserProfile:()=>nr,updateUserSuspension:()=>er,updateWorkspaceCreationForEmailDomains:()=>La,validateTemplate:()=>nl,validateTemplateCreatorHandle:()=>rl,validateUserCanCreateWorkspace:()=>Ua,verifyDomain:()=>Na,verifyEmail:()=>st});o(57658);var n=o(39593),r=o.n(n),i=o(28084),a=o(54064),s=o(43593),l=o(68626),c=o(59730),d=o(74229),p=o(72126),u=o(59753),m=o(45953),g=o(606),h=o(89101),f=o(32739),y=o(63143),v=o(95477),b=o(23823),S=o(33954),_=o(24608),w=o(33929),k=o(18514),x=o(80444),I=o(88632),C=o(79167),T=o(77144),M=o(33759),P=o(50906),A=o(47307),D=o(97977),B=o(4408),R=o(75018),E=o(61202);function F(e){const{environment:t,eventName:o,response:n,userId:r}=e;if(n&&n.recordMap){const e=m.PF.create(n.recordMap);"syncRecordValues"!==o&&B.fL({environment:t,userId:r,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,recordMap:e,maybeStaleRecordMap:"loadCachedPageChunk"===o||"loadCachedPageChunks"===o,debugSource:"handleRecordMapForResponse"})}}let N;async function j(e,t,o,n){if((0,c.tn)(o.body)){A.showError(o);const t=o.body.clientData&&(0,S.cq)(o.body.clientData);P.$eA(e,{type:null==t?void 0:t.type})}if(o.offline)return o;console.error(o.error);const{RouterStore:r}=e;if(401===o.status&&l.log({level:"error",from:"api",type:"httpTrigger401",data:{eventName:t,isLoggedIn:e.currentUser.isLoggedIn(),miscDataToConvertToString:{response:o},routeName:r.state.route.name}}),403===o.status&&o.headers["content-type"]&&o.headers["content-type"].startsWith("text/html")&&l.logWithSampleRate({logMessage:{level:"error",from:"api",type:"httpTrigger403",data:{eventName:t,isLoggedIn:e.currentUser.isLoggedIn(),miscDataToConvertToString:{response:o},userId:e.currentUser.id,routeName:r.state.route.name}},samplePercentage:1}),401===o.status&&Boolean(o.body&&o.body.errorId)&&e.currentUser.isLoggedIn())switch(r.state.route.name){case"page":if((0,k.Sr)()){await D.actuallyLogoutAndDeleteAllLocalData({environment:e,nextLocation:window.location.pathname});break}case"root":case"space":case"onboarding":case"myIntegrations":case"inAppTemplateSubmission":case"inAppTemplateCreatorSubmission":case"studentGroupSignup":if(n&&n===e.currentUser.id){const t=p.Ds((async()=>await D.actuallyLogoutAndDeleteAllLocalData({environment:e,userId:n,doNotRedirect:!0})),1e3);await t();!function(e,t){if((0,c.Jx)(t.body)&&"saml_sso_required"===t.body.clientData.type){const e=(0,S.wf)(w.default.getIntl(),t);M.Z.setState({...M.Z.state,loginType:"saml",alert:e})}R.navigate({environment:e,url:h._j.login})}(await D.clearCurrentUser(e),o)}}return o}async function O(e){const{environment:t,eventName:o,data:n,userId:r,tracking:i,abortSignal:a,prefetchCacheKey:s,encoding:c}=e;!function(e){for(const t of Object.keys(e)){const o=e[t];(p.Ft(o)||p.o8(o))&&delete e[t]}}(n);const d=r||t.currentUser.id,u=(0,b.yX)({environment:t,eventName:o,data:n,activeUserId:d,tracking:i,abortSignal:a,encoding:c});let m;s&&t.prefetchCache&&(m=t.prefetchCache.getPrefetchedHttpRequest(s,u,a)),m||(m=(0,_.ZP)(u)),T.Z.incrementNumApiCallsInitiated();const g=await m;return T.Z.incrementNumApiCallsCompleted(),"success"===g.type?(F({environment:t,eventName:o,response:g.data,userId:d}),function(e){const{environment:t,responseUserId:o,eventName:n}=e;if(!o)return;if("saveTransactions"!==n)return;const{id:r}=t.currentUser;if(o!==r){if(N===o)return;const{currentUserStore:e,currentUserRootStore:t,currentUserSettingsStore:i,currentSpaceViewStore:a}=x.default.state,s=r||"<undefined>",c=`currentUser ${s} didn't match user's cookie ${o}`;l.log({from:"client/api",level:"error",type:"currentUserWrong",data:{eventName:n,miscDataToConvertToString:{responseUserId:o,connectionStoreState:I.Z.state,currentUserId:s,userStoreId:e&&e.id,userRootStoreId:t&&t.id,userSettingsStoreId:i&&i.id,currentSpaceViewStoreParentId:a&&a.getParentId()},message:c}}),N=o}else N=void 0}({environment:t,eventName:o,responseUserId:g.headers["X-Notion-User-Id"]}),g):j(t,o,g,d)}function L(e){return function(t,o,n,r,i,a,s){return O({environment:t,eventName:e,data:o,userId:n,tracking:r,abortSignal:i,prefetchCacheKey:a,encoding:s})}}function U(e){return async function(t,o,n,r){const i=n||t.currentUser.id,a=(0,b.tZ)({environment:t,eventName:e,data:o,activeUserId:i,tracking:r,abortSignal:void 0,format:"jsonStream"}),s=await(0,_.ZP)(a);return"failed"===s.type?j(t,e,s,i):(d.H1.is(s.data)?s.data=d.H1.filter(s.data,(e=>"recordValue"!==e.type||(function(e){const{environment:t,streamItem:o,userId:n}=e,{pointer:r,value:i,role:a}=o;B.Wl({environment:t,userId:n,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:r,model:u.kk.fromValue(r.table,i),role:a,updatePaths:[[]],maybeStaleRecordMap:!1,debugSource:"handleRecordStreamForResponse"})}({environment:t,streamItem:e,userId:i}),!1))):F({environment:t,eventName:e,response:s.data,userId:i}),s)}}const Z=async function(e){return new Promise(((t,o)=>{Nl.addOnceListener(e,(e=>{t(e)}))}))},V=new Set,q=function(e){return async function*(t,o){const n={task:{eventName:e,request:o}},r=await et(t,n);if("failed"===r.type)yield{error:r.error,taskStatus:"not_started"};else{const{taskId:n}=r.data;for(V.add(n);;){const r=await Z(n);if("success"===r.state){const o=r.status;F({environment:t,eventName:e,response:o}),yield{value:o,taskStatus:r.state};break}if("failure"===r.state){yield{error:new c.hm(r.error||"Something went wrong.",{eventName:e,request:o},r.clientData),taskStatus:r.state};break}"in_progress"===r.state&&r.status&&(yield{value:r.status,taskStatus:r.state})}}}},z=L("getSubitems"),W=L("getAssetsJson"),H=L("getAssetsJsonV2"),G=L("getAssetsJsonV3"),K=L("getAsanaWorkspaces"),$=L("getAsanaAccount"),Y=L("getEvernoteAccount"),Q=L("getTrelloAccount"),J=L("getAsanaWorkspacesNames"),X=L("getTeamsAndProjectsInAsanaWorkspace"),ee=L("getTrelloBoards"),te=q("duplicateBlock"),oe=L("getActiveImportTasks"),ne=L("findUser"),re=L("search"),ie=L("searchAuditLog"),ae=L("searchContacts"),se=L("reportBadSearch"),le=L("reportBadQnA"),ce=L("getHistoricalAuditLogUsers"),de=L("searchIntegrations"),pe=L("getBlockFileDownloadUrl"),ue=L("setlocale"),me=L("getRecentPageVisits"),ge=L("createEmailUser"),he=L("updateSubscription"),fe=L("updatePaymentMethod"),ye=L("releaseSubscriptionSchedule"),ve=L("listPrices"),be=L("previewMidtermSubscriptionChanges"),Se=L("submitFormstack"),_e=L("getHarmonicData"),we=L("saveAssistantFeedback"),ke=L("performAiSearch"),xe=L("getSkillsInSpace"),Ie=L("getNextRelabelingTask"),Ce=L("getAssistantLogs"),Te=L("saveRelabelingTaskFeedback"),Me=L("getLivestormEvents"),Pe=L("getLivestormSessions"),Ae=L("getDesktopDownloadUrl"),De=L("cancelSubscription"),Be=L("getSubscriptionData"),Re=L("getVisibleUsers"),Ee=L("authenticateConfluenceUser"),Fe=L("authenticateMondayUser"),Ne=L("getMondayUser"),je=L("getConfluenceSpaces"),Oe=L("getConfluenceAccount"),Le=L("disconnectConfluence"),Ue=L("disconnectMonday"),Ze=L("getMondayWorkspaces"),Ve=L("getMondayFoldersAndBoards"),qe=q("importFile"),ze=q("importConfluenceExport"),We=q("parallelImportConfluenceExport"),He=q("parallelImportConfluenceViaApi"),Ge=q("importTrello"),Ke=q("importAsana"),$e=q("importAsanaIntoBetterTemplate"),Ye=q("parallelAsanaImport"),Qe=q("parallelMondayImport"),Je=q("importEvernote"),Xe=q("exportBlock"),et=L("enqueueTask"),tt=L("loginWithAppleAuth"),ot=L("loginWithAppleNativeAuth"),nt=L("loginWithEmail"),rt=L("loginWithGoogleJwt"),it=L("loginWithGoogleAuth"),at=L("logout"),st=L("verifyEmail"),lt=L("addWebClipperFile"),ct=L("sendTemporaryPassword"),dt=L("getLoginOptions"),pt=L("authGetLoginConfiguration"),ut=L("getSamlRedirect"),mt=L("disconnectAsana"),gt=L("disconnectTrello"),ht=L("disconnectEvernote"),ft=L("disconnectDrive"),yt=L("getActivityLog"),vt=L("changeEmail"),bt=L("sendEmailVerification"),St=L("authCreateSms"),_t=L("authVerifySmsEnroll"),wt=L("authSendSms"),kt=L("authVerifySmsLogin"),xt=L("authUpdateMfa"),It=L("getBacklinksForBlock"),Ct=L("getBotToken"),Tt=L("revokeBotToken"),Mt=L("getUploadFileUrl"),Pt=q("deleteSpace"),At=L("deleteUser"),Dt=L("getPublicPageData"),Bt=L("enableTeams"),Rt=L("adminDeleteUser"),Et=L("adminAddZeroRetentionSpace"),Ft=L("adminCheckHIPAAComplianceStatus"),Nt=L("adminListData"),jt=L("adminEditBlockPermissions"),Ot=L("adminReadBlockPermissions"),Lt=L("adminEditSpacePermissions"),Ut=L("adminDescribeEditSpacePermission"),Zt=L("adminSetPageContentClassification"),Vt=L("adminDisableReverifyForUser"),qt=L("adminDescribeSpacesToDelete"),zt=L("adminDescribeRunSpaceConsolidation"),Wt=L("adminDeleteSpaces"),Ht=L("adminDescribeAccountsToReset"),Gt=L("adminOnboardAISlackQnA"),Kt=L("adminResetAccounts"),$t=L("adminEditTeamMembership"),Yt=L("adminUpdateTeamMember"),Qt=L("adminUpdateUserSettings"),Jt=L("getInvoiceData"),Xt=L("addUsersToSpace"),eo=L("removeUsersFromSpace"),to=L("getJoinableSpaces"),oo=L("getSpaces"),no=L("getBookmarks"),ro=L("deleteBlocks"),io=L("restoreBlock"),ao=L("getUserAnalyticsSettings"),so=L("syncRecordValues"),lo=L("loadUserContent"),co=L("loadCachedPageChunk"),po=L("loadCachedPageChunks"),uo=L("loadPageChunk"),mo=L("queryCollection"),go=U("queryCollection"),ho=q("renameGroup"),fo=q("deleteGroup"),yo=L("getSelectPropertyValues"),vo=L("getNotificationLog"),bo=L("getNotificationLogV2"),So=L("getUnvisitedNotificationIds"),_o=L("trackSegmentEvent"),wo=L("identifySegmentWorkspace"),ko=L("identifySegmentUser"),xo=L("setNotificationsAsRead"),Io=L("getUserNotifications"),Co=L("setPageNotificationsAsRead"),To=L("setNotificationsStatus"),Mo=L("setSpaceNotificationsAsRead"),Po=L("unsubscribeFromEmails"),Ao=L("leaveBlock"),Do=L("getPublicSpaceData"),Bo=L("loadBlockSubtree"),Ro=L("initializeUserAnalytics"),Eo=L("initializeUserAnalyticsEmptySync"),Fo=L("getSignedFileUrls"),No=L("checkFilePermission"),jo=L("getBillingHistory"),Oo=q("exportSpace"),Lo=q("exportAuditLog"),Uo=q("exportDomainClaimableSpaces"),Zo=q("exportUserAnalytics"),Vo=q("exportContentAnalytics"),qo=q("exportAdminContentSearch"),zo=L("transferPermissionGroup"),Wo=L("disableUserAnalytics"),Ho=L("unsubscribeFromIntercomEmails"),Go=L("getBots"),Ko=L("getWebhookSubscriptions"),$o=L("testWebhookConnection"),Yo=L("getSnapshotsList"),Qo=L("getSnapshotContents"),Jo=q("restoreSnapshot"),Xo=L("activateReferral"),en=L("setBookmarkMetadata"),tn=L("authWithAsana"),on=L("getConnectedAppsStatus"),nn=U("getCompletion"),rn=L("authWithTrello"),an=L("authWithSlack"),sn=L("authWithGoogleForDrive"),ln=L("authWithExternalIntegration"),cn=L("getGoogleDriveAccounts"),dn=L("initializeGoogleDriveBlock"),pn=L("refreshGoogleDriveBlock"),un=L("getEvernoteNotebooks"),mn=L("getWebClipperData"),gn=L("addWebClipperURLs"),hn=L("searchWebClipperPages"),fn=L("authWithEvernote"),yn=L("recoverUser"),vn=L("ping"),bn=L("recoverSpace"),Sn=L("revokeUserTokens"),_n=L("exportBlockPreview"),wn=L("initializePageTemplate"),kn=L("finalizeAppTemplate"),xn=L("adminSearchUsers"),In=L("adminGetClientExperiments"),Cn=L("adminGetStatsigExperiment"),Tn=L("adminGetStatsigFeatureGate"),Mn=L("adminCheckStatsigSegment"),Pn=L("adminUpdateStatsigSegmentIds"),An=L("adminFindDeletedUser"),Dn=L("adminAllowlistCreditDomain"),Bn=L("searchUnsplashImages"),Rn=L("searchGiphyImages"),En=L("getGiphyRandomId"),Fn=L("postGiphyAnalytics"),Nn=L("adminSearchSpaces"),jn=L("adminSearchForUsersInSpaces"),On=L("adminGetDataAccessConsent"),Ln=L("adminGetBulkSpaceIdsByDomain"),Un=L("adminGetBulkSpaceIdsByEmail"),Zn=L("adminGetBulkUserIdsByEmail"),Vn=L("adminSearchBlocks"),qn=L("adminSearchTeams"),zn=L("adminSearchCollections"),Wn=L("adminSearchCollectionViews"),Hn=L("adminRecoverMfa"),Gn=L("adminRemoveSpaceUsersAndTransferContent"),Kn=L("adminGetUserBillingInformation"),$n=L("adminBypassEmailReputationChecks"),Yn=L("adminSamlConfigForSpace"),Qn=L("getSamlConfigForSpace"),Jn=L("getEmailDomainsForSpace"),Xn=L("getManagedUsers"),er=L("updateUserSuspension"),tr=L("deleteManagedUser"),or=L("updateEmailDomainSettings"),nr=L("updateUserProfile"),rr=L("getDataAccessConsentForManagedUser"),ir=L("setDataAccessConsentForManagedUser"),ar=L("removeManagedUserFromSpace"),sr=L("getEmailDomainSettings"),lr=L("logoutManagedUsers"),cr=L("resetPasswordsForManagedUsers"),dr=L("getClientExperiments"),pr=L("getClientExperimentsV2"),ur=L("adminViewExperiments"),mr=L("adminUpdateExperiment"),gr=L("adminSetupExperiment"),hr=L("updateSubscriptionToEducationPlan"),fr=L("adminUpdateSubscription"),yr=L("adminCancelSubscription"),vr=L("allowEducationEmails"),br=L("isEmailEducation"),Sr=L("getPromoCode"),_r=L("getGenericEmbedBlockData"),wr=L("isUserDomainJoinable"),kr=L("adminChangeEmail"),xr=L("setPassword"),Ir=L("logoutActiveSessions"),Cr=L("createSpace"),Tr=L("adminSetDisableSpacePublicAccess"),Mr=L("adminSetSpaceDomain"),Pr=L("saveTransactions"),Ar=q("moveToSpace"),Dr=L("inviteGuestsToSpace"),Br=L("refreshInviteLink"),Rr=L("adminAddPublicEmailDomains"),Er=L("adminShowCustomerInvoice"),Fr=L("adminSwapUserDomains"),Nr=L("adminSwapUserEmails"),jr=L("getUserTasks"),Or=L("getTasks"),Lr=L("getTestFlightStatus"),Ur=L("getAccessRequests"),Zr=L("getUnreadAccessRequestCount"),Vr=L("getAuthorizedEmailPreferenceCenterLink"),qr=L("requestAccess"),zr=L("submitCsatFeedback"),Wr=L("getDataAccessConsent"),Hr=L("setDataAccessConsent"),Gr=L("getCsatMilestones"),Kr=L("getTemplateChecklistForBlock"),$r=L("getPageVisitors"),Yr=L("recordPageVisit"),Qr=L("recordPageExit"),Jr=L("spaceAdminRestoreAccess"),Xr=L("trackConversionEvent"),ei=L("updateSpaceDomain"),ti=L("updatePublicHomePage"),oi=L("getUserSharedPagesInSpace"),ni=L("getUserSignals"),ri=L("getUserHomePages"),ii=L("getAvailableCountries"),ai=L("invalidateSubscriptionData"),si=L("getUserAdminApiLog"),li=L("getSpaceAdminApiLog"),ci=L("getBlockAdminApiLog"),di=L("getAdminHistory"),pi=L("reportPage"),ui=L("adminGetOwnership"),mi=L("adminGetRateLimits"),gi=L("adminGetSamlConfig"),hi=L("adminPrimaryWorkspaceChange"),fi=L("adminDeleteFileFromS3"),yi=L("adminDescribeDeleteFileFromS3"),vi=L("adminGetSpacesForAllowedEmailDomain"),bi=L("adminResetRateLimits"),Si=L("annotateRecentIntercomConversation"),_i=L("adminModifyBlock"),wi=L("adminRestoreBlock"),ki=L("adminDescribeDeletedBlockPermissions"),xi=L("resolveAddress"),Ii=L("getDeveloperBotsAndIntegrations"),Ci=L("getIntegrationDomainVerifications"),Ti=L("getIntegrationSecret"),Mi=L("adminBulkAddPromotionCodes"),Pi=L("adminBulkRemoveSpaceGuests"),Ai=L("adminRemoveAllowedEducationEmails"),Di=L("adminBulkApplyPromotionCodes"),Bi=L("adminBulkUpgradeEduPlusUser"),Ri=L("calculateTax"),Ei=L("checkSpaceDomain"),Fi=L("deleteBot"),Ni=L("deleteIntegration"),ji=L("adminBlockEmailDomain"),Oi=L("adminSearchPermanentlyDeletedPages"),Li=L("adminSearchSpaceActivity"),Ui=L("adminCopyPageBetweenEnvironments"),Zi=L("adminCountWordsInPage"),Vi=L("getExternalIntegrations"),qi=L("getZendeskTicketConversation"),zi=L("getUserSpaceExternalBots"),Wi=L("createOauthAuthorizationCode"),Hi=L("adminGetPublicPages"),Gi=L("adminRestoreDeletedCollectionProperties"),Ki=L("adminViewDeletedCollectionProperties"),$i=L("unfurlUrl"),Yi=L("aiSourcePicker"),Qi=L("resubscribeExternalCollection"),Ji=L("getExternalCollectionSyncState"),Xi=L("getEmailsWithoutAccessToBlock"),ea=L("processShareActionToBlock"),ta=L("updateExperimentOverride"),oa=L("resetExperimentOverrides"),na=L("refetchExternalObjectInstanceBlocks"),ra=L("listExternalCollections"),ia=L("listExternalObjects"),aa=L("createTeam"),sa=L("setAdminPrivilegedTeamMembership"),la=L("updateTeamMembers"),ca=L("getTeams"),da=L("getAllTeamsInSpaceForAdmin"),pa=L("getPrivatePageInfo"),ua=L("markDiscussionNotificationsRead"),ma=L("getIntegrationDataForGallery"),ga=L("getIntegrationIdsForGallery"),ha=L("recordCookieConsent"),fa=L("adminGetIntegrationData"),ya=L("adminUpdateIntegrationData"),va=L("adminGetSlackIntegrationData"),ba=L("adminGetSyncedDatabaseData"),Sa=L("adminJoinSpacesForOauthRedirect"),_a=L("adminForceResyncExternalObjects"),wa=L("getRecoverableSpaceUserContent"),ka=L("transferSpaceUserContent"),xa=L("adminCreateMarketingRoute"),Ia=L("adminBanUser"),Ca=L("adminBulkBanUsers"),Ta=L("adminSearchAuditLog"),Ma=L("adminIsSpaceDomainClaimEligible"),Pa=L("adminGetDomainClaimEligibleSpaces"),Aa=L("adminGetDomainManagementSettings"),Da=L("adminClaimAndUpgradeForSalesAssisted"),Ba=L("adminDelayClaimSpaceDeletion"),Ra=L("adminRemoveChildFromExternalCollection"),Ea=L("adminRunSpaceConsolidation"),Fa=L("deleteDomainVerificationCode"),Na=L("verifyDomain"),ja=L("createDomainVerificationCode"),Oa=L("getDomainVerificationCodesForSpace"),La=L("updateWorkspaceCreationForEmailDomains"),Ua=L("validateUserCanCreateWorkspace"),Za=L("setSamlConfig"),Va=L("getSpacesCreatedByUserWithDomains"),qa=L("initiateWorkspaceTransfer"),za=L("getCostForSpaceUpgrade"),Wa=L("claimAndUpgradeSpace"),Ha=L("requestClaimAndUpgrade"),Ga=L("transferWorkspaceToUser"),Ka=L("deleteSpaceForDomain"),$a=L("cancelSpaceDeletionForDomain"),Ya=L("adminDowngradeFraudSubscription"),Qa=L("initiateMultipartUpload"),Ja=L("completeMultipartUpload"),Xa=L("getTypedDatabases"),es=L("getCollectionViewBlocksByAppId"),ts=L("getPageAnalytics"),os=L("getCustomerOffer"),ns=L("applyCustomerOffer"),rs=L("getExternalIntegrationAccessToken"),is=L("sendVerifyTransferEmail"),as=L("getDailyUsersAnalytics"),ss=L("getUserEngagementAnalytics"),ls=L("getContentEngagementAnalytics"),cs=L("loadWorkspaceAnalyticsUsers"),ds=L("loadContentAnalytics"),ps=L("loadSearchAnalytics"),us=L("getVerifiedEmailDomain"),ms=L("getExternalNotificationChannels"),gs=L("adminContentSearch"),hs=L("searchVectors"),fs=L("getInferenceTestExamples"),ys=L("isEligibleForGuestMembershipRequest"),vs=L("setSeenGuestMembershipRequests"),bs=L("getAboutNotionDevelopers"),Ss=L("loadContacts"),_s=L("registerDesktopApp"),ws=L("getDesktopAppRegistration"),ks=L("getPublicApiObject"),xs=L("authCreateTotp"),Is=L("authVerifyTotpLogin"),Cs=L("authVerifyTotpEnroll"),Ts=L("authCreateBackupCodes"),Ms=L("authVerifyBackupCodesLogin"),Ps=L("authVerifyPassword"),As=L("setRecordKey"),Ds=L("isRecordKeyAvailable"),Bs=L("getIdFromUniqueId"),Rs=L("suggestRecordKey"),Es=L("getInAppCategoriesAndTemplates"),Fs=L("adminUpdateAddOnSubscription"),Ns=L("adminReleaseSubscriptionSchedule"),js=L("getAIUsageEligibility"),Os=U("getCompletionForProperty"),Ls=L("getCompletionForSelectOption"),Us=L("adminUpdateNotionAIAvailabilityForSpace"),Zs=L("adminGetSpaceMembershipUpdates"),Vs=L("adminBulkCreateTimedTrials"),qs=L("getGeoIpLocation"),zs=L("getTeamAccessRequestMetadata"),Ws=L("stripeAdvanceTestClock"),Hs=L("stripeGetTestClock"),Gs=L("adminOptOutNotionAIDataSharing"),Ks=L("getTransitivePageRelations"),$s=L("getActiveExportTasks"),Ys=L("adminExplainPaymentStatus"),Qs=L("adminGetBulkIds"),Js=L("adminUpdatePaymentStatus"),Xs=L("getTemplateSearchResults"),el=L("getTemplateCreator"),tl=L("submitTemplate"),ol=L("submitTemplateCreator"),nl=L("validateTemplate"),rl=L("validateTemplateCreatorHandle"),il=L("getSpaceMembershipUpdates"),al=L("getUserContractionData"),sl=L("testSetupWorkspace"),ll=L("testCreatePage"),cl=L("testDeleteRecord"),dl=L("getPageAssistantPreferences"),pl=L("setPageAssistantPreferences"),ul=L("adminRestoreDeletedGuestPermissions"),ml=L("adminDescribeRestoreDeletedGuestPermissions"),gl=L("adminAddLinkPreviewToSpace"),hl=L("updateDisableGuestsOnSpace"),fl=L("submitEducationGroupApplication"),yl=L("getUniversitiesAndDomains"),vl=L("exportSpaceMembers"),bl=L("exportSpaceGuests"),Sl=L("publishAiSession"),_l=L("getPublishedPagesForUser"),wl=L("adminIsWorkspaceInQnA"),kl=L("adminMergeUsers"),xl=L("resolveAccessRequest"),Il=L("getExternalOrgData"),Cl=L("addUserToWaitlist"),Tl=L("adminGetWorkspaceWebhookSubscriptions"),Ml=new i.Z({performRequests:async e=>{const{environment:t}=e[0],o=e.map((e=>e.args)),n=await po(t,{requests:o});if("failed"===n.type)throw n.error;return[]},batchSize:50,maxWorkers:2,requestDelayMs:20,requestTimeoutMs:10*y.C0});async function Pl(e,t){return await Ml.enqueue({environment:e,args:t})}const Al=new i.Z({performRequests:async e=>{const t=new Array(e.length),o=e.map(((e,t)=>({environment:e.environment,request:e.args,index:t}))),n=p.vM(o,(e=>e.request.userId));for(const[r,i]of Object.entries(n)){const e=i[0].environment,o=[];for(const{request:t}of i){const{pointer:e,version:n}=t;o.push({pointer:e,version:n})}const n=await so(e,{requests:o},r);if("failed"===n.type)throw n.error;const a=m.PF.create(n.data.recordMap);C.Z.addFromRecordMapWithRole(a),C.Z.isEmpty()||E.dY({environment:e});for(const{request:r,index:s}of i)if(r.pointer){const e=a.getValue(r.pointer),o=a.getRole(r.pointer);o&&(t[s]={value:e,role:o})}}return t},batchSize:500,maxWorkers:2,requestDelayMs:20,requestTimeoutMs:30*y.C0});async function Dl(e,t){if(t.pointer&&(0,g.Ok)(t.pointer))try{const o=await Al.enqueue({environment:e,args:t});return o||-1!==t.version?o:{value:void 0,role:"editor"}}catch(o){}}const Bl=e=>[e.url,e.downloadName,e.download].filter(Boolean).join(":");const Rl=new class{constructor(){this.lru=new(r())({max:1e3,maxAge:y.U6})}set(e,t){this.lru.set(Bl(e),t)}get(e){return this.lru.get(Bl(e))}},El=new i.Z({performRequests:async e=>{const t=e.map((e=>{let{url:t}=e;return t})),o=await Fo(e[0].environment,{urls:t});if("failed"===o.type)throw o.error;const{signedUrls:n}=o.data;return t.forEach(((e,t)=>{const o=n[t];Rl.set(e,o)})),n},batchSize:500,maxWorkers:1});async function Fl(e,t,o){const n=Rl.get(t);let r;return r=n||await El.enqueue({environment:e,url:t}),r&&(0,s.x$)(r)&&o&&(r=(0,f.NV)({httpUrl:r,protocol:v.default.protocol,includePort:!0})),r}const Nl=new a.Z},90287:(e,t,o)=>{o.d(t,{Bs:()=>ce,KJ:()=>ue,Uz:()=>de,_S:()=>pe,mc:()=>le,qY:()=>fe});var n=o(50112),r=o(15145),i=o(82813),a=o(7406),s=o(68626),l=o(4615),c=o(99405),d=o(21202),p=o(13493),u=o(65311),m=o(19889),g=o(66079),h=o(28182),f=o(9852),y=o(54153),v=o(64002),b=o(63143),S=o(25320),_=o(17707),w=o(24215),k=o(19124),x=o(84210),I=o(98165),C=o(18514),T=o(51),M=o(80444),P=o(81258),A=o(69327),D=o(64970),B=o(93220),R=o(72014),E=o(89523),F=o(35661),N=o(32470),j=o(87956),O=o(29026),L=o(34583),U=o(28517),Z=o(50906),V=o(98688),q=o(50950),z=o(47307),W=o(57400),H=o(58188),G=o(94273),K=o(97977),$=o(98958),Y=o(17659),Q=o(31304),J=o(40277),X=o(75018),ee=o(87531),te=o(29974),oe=o(39699),ne=o(61202),re=o(70782),ie=o(12321),ae=o(37181),se=o(65452);function le(e){M.default.setState(M.default.getInitialState());const{id:t}=e.currentUser;(!M.default.state.currentUserStore||t&&t!==M.default.state.currentUserStore.id)&&(t?(ie.j(e,t),G.Bk(e,t),ue(e,t)):(M.default.setState({...M.default.state,initialized:!0}),q.dd(e)))}function ce(){const{currentSpaceStore:e}=M.default.getState();return e?e.id:void 0}async function de(e){const{nextRoute:t,currentRoute:o,environment:m,query:g}=e,h=M.default.state.mainEditorCurrentBlockStore,y=M.default.state.currentCollectionViewStore,b=m.currentUser.id,I=e=>{M.default.state.lastUpdater===I&&(m.device.isMobileNative&&e.currentSpaceStore&&s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"AppStore setting space with update in updateCurrentRoute: ",spaceId:e.currentSpaceStore.id}}),M.default.setState({...M.default.state,...e}))};M.default.setState({...M.default.state,lastUpdater:I});const C=e=>{M.default.state.lastUpdater===I&&T.Z.setState({publicPageData:e})};if("page"===t.name&&t.queryId&&j.Z.setState({queryId:t.queryId,pageId:t.blockId,timeEntered:new Date}),"page"===t.name||"space"===t.name||"nativeTab"===t.name||"quickSearch"===t.name||"chat"===t.name||"workspaceSetup"===t.name){let e;G.nr(t,b);const p=async()=>{e||(e=J.I6({environment:m,request:{type:"block-space",...t}}));const[o]=await Promise.all([e.next(),M.default.waitUntil((()=>M.default.state.initialized))]),n=o.value;return C(n),n},y=(0,f.getAppRefreshed)();if((0,k.AC)(m),"page"===t.name&&(!h||h.id!==t.blockId||o&&"page"===o.name&&o.blockId!==t.blockId||h.userId!==b)){X.resetPageState(m),X.resetSidebarState(m),L.$B(),X.resetEditorState(m);const{blockId:e}=t,a=new F.G(m,{table:d.iU,id:e}),c=new B.Z;I({mainEditorCurrentBlockStore:a,currentLoadingContainerStore:c}),h||await pe({environment:m,store:a});const f=await p(),{currentUserSettingsStore:k}=M.default.state;if(he({publicPageData:f}))return void function(e){const{store:t,environment:o}=e,n=(0,x.ZP)({store:t,preferPublicLink:!1,pageVisitSource:void 0});X.navigate({environment:o,url:n})}({store:a,environment:m});const{presenceStore:C,currentUserRootStore:T}=M.default.state;Q.E(C,m,R.$g,h),S.UX(m,{block:a,fromPageRefresh:y,pageVisitStore:M.default.state.pageVisitStore,timestamp:Date.now()}),_.Y0(a.id);const P=new E.Z;I({presenceStore:P});const D=R.$g.getCurrentPageVisitId();if(R.$g.initializeNewPageVisitId(),Q._({userId:b,rootStore:a,presenceStore:P,environment:m,pageVisitIdStore:R.$g}),T){if("root"===(null==o?void 0:o.name)){if(T.getSpaceViewStores().map((e=>e.getSpaceId())).indexOf(f.spaceId)<0){if(k)return m.device.isMobileNative&&s.log({level:"warning",from:"loginActions",type:"setLoggedInUserId",data:{message:"SpaceDebug: navigateToFirstSpace because updateCurrentRoute is root and page is not in current spaceView"}}),void(await te.L5({environment:m,userRootStore:T,userSettingsStore:k,pageVisitSource:r.tY.BackForward}));if(b)return void(await K.logoutSingleAccount({environment:m,userId:b}))}}if(f.spaceId&&(f.canJoinSpace||f.userHasExplicitAccess)){const e=await te.j({environment:m,userRootStore:T,spaceId:f.spaceId,navigate:!1,analyticsFrom:"redirect",userSettingsStore:k});m.device.isMobileNative&&s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"updateCurrentRoute updating space because the route is a page with spaceId",spaceId:f.spaceId}}),I({currentSpaceViewStore:e.spaceViewStore,currentSpaceStore:e.spaceViewStore.getSpaceStore()})}else if(!f.spaceId&&M.default.state.currentSpaceStore){const e=await te.j({environment:m,userRootStore:T,spaceId:M.default.state.currentSpaceStore.id,navigate:!1,analyticsFrom:"redirect",userSettingsStore:k});var Z;if(m.device.isMobileNative)s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"updateCurrentRoute updating space because of joinSpaceResult of current space",spaceId:null===(Z=e.spaceViewStore)||void 0===Z?void 0:Z.getSpaceId()}});I({currentSpaceViewStore:e.spaceViewStore,currentSpaceStore:e.spaceViewStore.getSpaceStore()})}}f.spaceId&&b&&(se.h({environment:m,spaceId:f.spaceId,userId:b}),H.rg({environment:m,spaceId:f.spaceId,userId:b}),U.I({environment:m,spaceId:f.spaceId,userId:b}));const{currentSpaceStore:N}=M.default.state;N?(L.OR({environment:m,spaceId:N.id}).then((async()=>{await a.load(),ge(m,a,g,R.$g,D)})),w.Jq(m)):f&&f.spaceId&&(await a.load(),ge(m,a,g,R.$g,D)),async function(e,t,o){const a=(0,v.Qc)(t).query,s=a[n.gS];if(parseInt(a[r.$X])===r.tY.Email&&(s.includes("email_digest")||s.includes("email_push"))&&a[r.Qs]&&o){const t=(0,l.wr)(a[r.Qs]),n=F.Xo.createChildStore(o,{table:u.uX,id:t});await n.load();const s=n.getModel();if(!s)return;if((0,i.e)((0,w.mc)(e),{alreadyRead:s.getRead(),notificationId:t,activityId:s.getActivityId(),from:"email"}),!s.getRead()){const t={id:s.id,space_id:s.getSpaceId(),read:s.getRead()};oe.createAndCommit({userAction:"appActions.setNotificationAsReadFromEmail",environment:e,perform:e=>Y.$h({notification:t,rootStore:o,transaction:e,read:!0})})}}}(m,g,N);const j=(null==N?void 0:N.id)||f.spaceId;j&&(ne.pt({environment:m,spaceId:j,force:!1}),V.L({environment:m,spaceId:j,force:!1})),j&&b&&(A.Z.isInitialized||A.Z.reinitializeState(m,b,j))}else if("space"===t.name){const e=await p();if(e.publicHomePage){const t=new F.G(m,{table:d.iU,id:e.publicHomePage}),o=new B.Z;I({mainEditorCurrentBlockStore:t,currentLoadingContainerStore:o})}else if(I({mainEditorCurrentBlockStore:void 0,currentLoadingContainerStore:void 0}),he({publicPageData:e}))return void fe({spaceDomain:e.spaceDomain,environment:m})}else if("nativeTab"===t.name||"quickSearch"===t.name||"chat"===t.name){X.resetPageState(m),X.resetSidebarState(m),L.$B(),X.resetEditorState(m),await M.default.waitUntil((()=>M.default.state.initialized));const e="spaceId"in t?t.spaceId:void 0;if((!e||!M.default.state.currentSpaceViewStore||!M.default.state.currentSpaceStore||M.default.state.currentSpaceStore.id!==e)&&M.default.state.currentUserRootStore){const o=M.default.state.currentUserRootStore.getSpaceViewStores(),n=e?o.find((t=>{var o;return(null===(o=t.getSpaceId())||void 0===o?void 0:o.replaceAll("-",""))===(null==e?void 0:e.replaceAll("-",""))})):o[0],r=null==n?void 0:n.getSpaceStore();if(n&&r){m.device.isMobileNative&&s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"updateCurrentRoute updating space because it's native tab and current space store id doesn't match nextRoute space id",spaceId:e}}),I({currentSpaceStore:r,currentSpaceViewStore:n});const o="nativeTab"===t.name&&"search"===t.tab&&b&&!1,i="quickSearch"===t.name&&b;(o||i)&&A.Z.reinitializeState(m,b,r.id)}}"chat"===t.name&&I({mainEditorCurrentBlockStore:void 0,currentCollectionViewStore:void 0})}else if((0,c.wO)(t)&&(X.resetPageState(m),X.resetSidebarState(m),L.$B(),X.resetEditorState(m),await M.default.waitUntil((()=>M.default.state.initialized)),t.spaceId&&M.default.state.currentUserRootStore)){const e=M.default.state.currentUserRootStore.getSpaceViewStores().find((e=>e.getSpaceId()===t.spaceId)),o=null==e?void 0:e.getSpaceStore();e&&o&&(m.device.isMobileNative&&s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"updateCurrentRoute updating space because routeWithoutSpecificBlock and current nextRoute space id is",spaceId:t.spaceId}}),I({currentSpaceStore:o,currentSpaceViewStore:e,mainEditorCurrentBlockStore:void 0}))}if("searchQuery"in t||"searchRequest"in t)if(t.searchQuery)ee.UT({environment:m,analyticsFrom:"query-args",renderAsPage:!1}),O.ZP.setState({...O.ZP.state,query:{...O.ZP.state.query,text:t.searchQuery}});else if(t.searchRequest)try{const e=JSON.parse(t.searchRequest),{text:o,sort:n,filters:r}=e;g&&O.ZP.setState({...O.ZP.state,query:{text:o,sort:n,filters:r}}),N.ZP.setState({...N.ZP.state,showDebugInfo:!0,debug:"everything"})}catch(re){z.deprecatedShowErrorMessage("Invalid json in searchRequest param"),s.log({level:"error",from:"appActions",type:"JSONParseError",error:{miscDataString:(0,a.tg)(re).message}})}if(e)for await(const t of e)C(t);W.Yh(m),(0,f.setAppRefreshed)(!1)}const q=y?y.id:void 0;if("page"===t.name&&q!==t.collectionViewId){const e=t.collectionViewId;I({currentCollectionViewStore:e?new F.Xr(m,{table:p.n,id:e}):void 0})}const $=(0,v.Qc)(g).query[r.RL];Boolean($)&&(D.m.setState(!0),P.Z.setState({open:!0}))}async function pe(e){const{environment:t,store:o}=e,n=await async function(e){const{environment:t,blockId:o}=e,{currentUser:n}=t,r=(0,b.jj)([...n.id?[n.id]:[],...n.loggedInUserIds]);for(const i of r){const e=new F.G(t,{table:d.iU,id:o},{userId:i});if(await e.load(),e.isDefined())return n.id===i?void 0:i}}({environment:t,blockId:o.id});n&&await re.f({newCurrentUserId:n,environment:t,store:o})}async function ue(e,t){const o=new F.U6(e,{table:m.KJ,id:t},{userId:t}),n=new F.vO(e,{table:h.Sr,id:t},{userId:t});n.addListener(me);const r=new F.r9(e,{table:g.dx,id:t},{userId:t});$.registerPushNotifications(e),M.default.setState({...M.default.state,currentUserStore:o,currentUserSettingsStore:n,currentUserRootStore:r,initialized:!1}),await ie.w(),M.default.setState({...M.default.state,initialized:!0}),ae.fG(e),q.oG(e)}function me(e){const t=e.getSettingsStore().getKeyStore("preferred_locale").getValue();t||y.Z.set("preferredLocale",t)}function ge(e,t,o,n,r){var i,a;Z.PBo(e,{query:o,page_id:t.id,is_peek:!1,peek_mode:void 0,type:"collection"===t.getParentTable()?"database_page":"page",collection_id:t.getParentCollectionId()??(null===(i=t.getCollectionViewCollectionStore())||void 0===i?void 0:i.id),team_id:null===(a=(0,I.VP)(t))||void 0===a?void 0:a.id,page_visit_id:n.getCurrentPageVisitId(),previous_page_visit_id:r})}function he(e){const{publicPageData:t}=e;return!(!(0,C.Sr)()||"none"!==t.publicAccessRole||!t.spaceName)}function fe(e){const{spaceDomain:t,environment:o}=e,n=(0,C.Rs)(t);X.navigate({environment:o,url:n,redirect:!0})}},48299:(e,t,o)=>{o.d(t,{JN:()=>H,NN:()=>G,vD:()=>q,Xi:()=>V,w0:()=>K,RQ:()=>z,uR:()=>$});o(21703),o(57658);var n=o(67294),r=o(41892),i=o(8848),a=o(39068),s=o(45433),l=o(33907),c=o(88437),d=o(37612),p=o(72126),u=o(4615),m=o(89101),g=o(21202),h=o(15047),f=o(29369),y=o(97880),v=o(82990),b=o(64002),S=o(5366),_=o(86628),w=o(24405),k=o(1136),x=o(40235),I=o(85893);function C(e){window.__c={n:"AppTemplateRelatedDependenciesDelete"};const{relatedDependencies:t}=e,o=(0,w.Fg)(),r=(0,_.VK)((()=>{const e=null==t?void 0:t.viewDeps;return e?e.map((e=>({name:e.getName(),icon:e.getFormat().collection_view_icon,type:e.getType()}))):[]}),[t.viewDeps]),i=n.useCallback((e=>(0,I.jsxs)("span",{style:{marginRight:10,display:"inline-block"},children:[(0,I.jsx)(k.F,{color:"light",viewIcon:e.icon,viewType:e.type,style:{display:"inline-block",verticalAlign:"middle",marginRight:2,marginBottom:2},size:13}),e.name]},e.name)),[]),s=[{key:"entity_type",header:void 0},{key:"entities",header:void 0}];return(0,I.jsx)(x.Z,{columns:s,rows:(()=>{const e=[],n=null==t?void 0:t.propertyDeps;if(n.length>0){const t=n.map((e=>(0,I.jsxs)("span",{style:{marginRight:10,display:"inline-block"},children:[(0,I.jsx)(a.ZP,{icon:e.icon,type:e.type,size:13,style:{display:"inline-block",verticalAlign:"middle",marginRight:2,marginBottom:2},theme:o}),e.name]},e.name))),r=(0,I.jsx)(S.FormattedMessage,{id:"appTemplates.featureBundleDelete.properties",defaultMessage:"{count, plural, one {1 property} other {{count} properties}}",values:{count:t.length}});e.push({key:"bundledProperties",columns:[[r],t]})}if(r.length>0){const t=r.map((e=>i(e))),o=(0,I.jsx)(S.FormattedMessage,{id:"appTemplates.featureBundleDelete.views",defaultMessage:"{count, plural, one {1 view} other {{count} views}}",values:{count:t.length}});e.push({key:"bundledViews",columns:[[o],t]})}return e})(),hideHeader:!0,cellStyle:{width:"40%"}})}var T=o(76798),M=o(93959),P=o(33929),A=o(77907),D=o(95802),B=o(80444),R=o(35661),E=o(54642),F=o(16956),N=o(47307),j=o(96802),O=o(75018),L=o(39699),U=o(37181);const Z=(0,S.defineMessages)({multiDBNameConnector:{id:"appTemplateHelpers.multiDBNameConnector",defaultMessage:"and"}});function V(e,t){const{spaceViewStore:o}=t,n=o.getSpaceId();if(!n)return;const r=b.bf({url:m._j.workspaceSetup,query:{spaceId:u.cj(n)}});B.default.setState({...B.default.state,mainEditorCurrentBlockStore:void 0}),O.navigate({environment:e,url:r})}function q(e){const{environment:t,collectionViewBlockStore:o,collectionStore:n,databaseType:r,propertyMapping:i,typedPropertySchemas:a,transaction:l}=e;if(n.isTypedCollection())throw new Error("Collection is already typed");const c=s.LI[r].blockUri,d=r;Object.entries(i).forEach((e=>{let[o,r]=e;if(!r||r===s.bK)return;const i=a[o],c=n.getSchema()[r];if(!c)throw new Error("Mapped property does not exist");i&&i.type!==c.type&&F.LC({environment:t,collectionStore:n,property:r,type:i.type,transaction:l})}));const p=Object.entries(i).filter((e=>{let[t,o]=e;return o===s.bK})).map((e=>{let[t,o]=e;return t})),m={};p.forEach((e=>{const t=a[e];t&&(m[e]=t)})),Object.entries(m).forEach((e=>{let[o,r]=e;const a=F.G3({environment:t,collectionStore:n,collectionViewArgs:void 0,propertyName:r.name,propertyType:r.type,transaction:l});i[o]=a})),j.FH({stores:[o],update:{app_id:(0,u.ZP)(),app_config_uri:c,app_uri_map:{[c]:o.id,[d]:n.id}},transaction:l}),j.FH({stores:[n],update:{app_config_uri:d,app_uri_map:i},transaction:l})}function z(e){const{collectionViewBlockStore:t,collectionStore:o,transaction:n}=e;j.FH({stores:[t],update:{app_id:void 0,app_config_uri:void 0,app_uri_map:void 0},transaction:n}),j.FH({stores:[o],update:{app_config_uri:void 0,app_uri_map:void 0},transaction:n})}async function W(e){const{environment:t,blockStore:o}=e,n=o.getFormat().app_id;if(!n)return[o];const r=await E.getCollectionViewBlocksByAppId(t,{spaceId:o.getSpaceId(),appId:n}),i=o.getParentStore();return"success"!==r.type||void 0===i?[o]:r.data.result.map((e=>R.G.createChildStore(i,{table:g.iU,id:e.blockId,spaceId:o.getSpaceId()})))}async function H(e){const{environment:t,collectionViewBlockStore:o,databaseUri:n}=e,r=await W({environment:t,blockStore:o});for(const a of r){var i;if(a.isCollectionView()&&(null===(i=a.getCollectionStore())||void 0===i?void 0:i.getFormat().app_config_uri)===n)return a}}async function G(e){const{environment:t,block:o,action:n}=e,a=o.getFormat().app_config_uri||"";if(M.rC.includes(a)){const e=await async function(e){const{environment:t,blockStore:o}=e,n=o.getParentStore();if(!n)return[o];const r=await W({environment:t,blockStore:o}),i=n.id;return r.filter((e=>{var t;return(null===(t=e.getParentStore())||void 0===t?void 0:t.id)===i}))}({environment:t,blockStore:o});if(e.length<=1)return[o];const a=function(e,t,o){if("delete"===e)return{message:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.message",defaultMessage:"Are you sure you want to delete {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.description",defaultMessage:"{appName} work closely together. You can delete them together, or you might encounter issues after deletion.",values:{appName:o}}),allLabel:(0,I.jsx)("div",{style:{maxWidth:"300",textOverflow:"ellipsis",overflowX:"hidden"},children:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.allLabel",defaultMessage:"Delete {appName}",values:{appName:o}})}),cancelLabel:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,I.jsx)("div",{style:{maxWidth:"300",textOverflow:"ellipsis",overflowX:"hidden"},children:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.oneLabel",defaultMessage:"Delete {dbName} only",values:{dbName:t.getTitleValue()}})}),actionIcon:d.y};if("move"===e)return{message:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.message",defaultMessage:"Are you sure you want to move {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.description",defaultMessage:"{appName} work closely together. You can move them together, or you might encounter issues after separating.",values:{appName:o}}),allLabel:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.allLabel",defaultMessage:"Move together"}),cancelLabel:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.oneLabel",defaultMessage:"Only move {dbName}",values:{dbName:t.getTitleValue()}}),actionIcon:l.n};if("duplicate"===e)return{message:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.message",defaultMessage:"Are you sure you want to duplicate {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.description",defaultMessage:"{appName} work closely together. You can duplicate them together, or you might encounter issues after separating.",values:{appName:o}}),allLabel:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.allLabel",defaultMessage:"Duplicate together"}),cancelLabel:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.oneLabel",defaultMessage:"Only duplicate {dbName}",values:{dbName:t.getTitleValue()}}),actionIcon:c.a};throw(0,y.t1)(e)}(n,o,function(e){if(1===e.length)return e[0].getTitleValue().toString();let t="";for(let o=0;o<e.length-1;o++)t+=e[o].getTitleValue(),e.length>2?t+=", ":t+=" ";return t+=`${P.default.formatMessage(Z.multiDBNameConnector)} ${e[e.length-1].getTitleValue()}`,t}(e)),s=await function(e,t){const{message:o,description:n,allLabel:a,cancelLabel:s,oneLabel:l,actionIcon:c}=e;return new Promise((e=>{N.showDialog({showCancel:!1,keepFocus:!1,message:(0,I.jsxs)("div",{style:{textAlign:"center"},children:[(0,I.jsxs)("span",{style:{display:"inline-block",verticalAlign:"-0.15em",position:"relative"},children:[(0,I.jsx)("img",{src:r.Z.images.appPackages.projectsIconSvg,style:{width:"1.4em",height:"1.4em"}}),c({width:"0.9em",height:"0.9em",position:"absolute",fill:i.O9.red,right:"-0.3em",bottom:"0.05em"})]}),(0,I.jsx)("div",{style:{fontWeight:v.Z.fontWeight.semibold,margin:"0.7em"},children:o}),(0,I.jsx)("div",{style:{fontSize:14},children:n})]}),items:"delete"===t?[{label:l,color:"red",onAccept:()=>{e("one")}},{label:a,onAccept:()=>{e("all")}},{label:s,onAccept:()=>{e("cancel")}}]:[{label:a,color:"blue",onAccept:()=>{e("all")}},{label:l,onAccept:()=>{e("one")}},{label:s,onAccept:()=>{e("cancel")}}],handleCancel:()=>{e("cancel")}})}))}(a,n);if("cancel"===s)return"user_canceled";const p=[o];if("all"===s)for(const t of e)if(t.id!==o.id){const e=D.C.findSelectablesFromIds([t.id]);e.length>0?p.push(e[0].props.store):p.push(t)}return p}return[o]}async function K(e){var t;let{environment:o,property:n,collectionContextStore:r,theme:i,from:s}=e;const{appTemplatesSetupActions:l,appConfigs:c}=await A.deps.AppTemplates.loader(),d=r.collectionStore(),u=r.collectionViewBlockStore(),m=null==u?void 0:u.getCollectionViewStores();if(!(d&&u&&m&&u.getFormat().app_config_uri))return!1;const y=d.getSchema()[n],b=d.getFormat().app_config_uri;if(!y||!b)return!1;const _=(0,M.YB)(c(),b);if(!_)return!1;const w=p.oA([...Object.keys(d.getPropertyMapping()||{}),...Object.keys((null===(t=u.getFormat())||void 0===t?void 0:t.app_uri_map)||{})]),k=(0,M.TD)(w,_),x=p.oA([k.find((e=>e.uri===n))]),P=(0,M.K8)({validDependencies:x,dependencies:k,collectionStore:d,collectionViewBlockStore:u,viewStores:m}),{validDependencies:D}=P;if(0===D.length)return!1;const B=null==u?void 0:u.getParentStore();if(!d||!u||!B||B.table!==h.bx&&B.table!==g.iU&&B.table!==f.e0)return!1;const F=u.getFormat().app_id,j=F?await E.getCollectionViewBlocksByAppId(o,{spaceId:u.getSpaceId(),appId:F}):void 0,O="success"===(null==j?void 0:j.type)?j.data.result.map((e=>R.G.createChildStore(B,{table:g.iU,id:e.blockId,spaceId:u.getSpaceId()}))):[u],L=[{label:(0,I.jsx)(S.FormattedMessage,{id:"appTemplatesHelpers.bundledPropertyDelete.deleteMessage",defaultMessage:"{count, plural, one {Delete} other {Delete all}}",values:{count:D.length}}),color:"red",onAccept:()=>l.removeDependencies({environment:o,dependencies:D,appCollectionViewBlockStores:O,from:s})}],U=D.length>1&&(0,I.jsx)(C,{relatedDependencies:P,collectionContextStore:r});return N.showDialog({message:(0,I.jsxs)("div",{style:{textAlign:"center"},children:[(0,I.jsx)("span",{style:{fontWeight:v.Z.fontWeight.medium},children:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.bundledPropertyDelete.message",defaultMessage:"Delete {property} property for everyone on {databaseName}?",values:{databaseName:(0,I.jsx)(T.Z,{style:{display:"inline",fontWeight:v.Z.fontWeight.medium},shouldWrap:!0,store:d}),property:(0,I.jsxs)("span",{children:[(0,I.jsx)(a.ZP,{icon:y.icon,type:y.type,size:18,style:{verticalAlign:"middle",display:"inline-block",marginRight:3,marginBottom:2},theme:i}),y.name]})}})}),D.length>1&&(0,I.jsx)("div",{style:{margin:"0.17em"},children:(0,I.jsx)("span",{style:{fontSize:13,fontWeight:v.Z.fontWeight.light},children:(0,I.jsx)(S.FormattedMessage,{id:"appTemplateHelpers.bundledPropertyDelete.description",defaultMessage:"These related entities will also be deleted since they work together."})})})]}),description:U,showCancel:!0,keepFocus:!0,innerStyle:{width:480},items:L}),!0}function $(e){const{environment:t,requiredCurrPhase:o,nextPhase:n,currentUserSettingsStore:r,currentSpaceStore:i}=e,a=(0,M.jH)(r,i);o&&o!==a||L.createAndCommit({userAction:"ProjManagementIntroModal.updateProjManagementTooltipTourPhase",environment:t,perform:e=>{var t;U.d2({userSettingsStore:r,transaction:e,data:{proj_management_tooltip_tour_v1_phase_per_space:{...(null===(t=r.getSettings())||void 0===t?void 0:t.proj_management_tooltip_tour_v1_phase_per_space)??{},[i.id]:n}}})},userId:r.id})}},2449:(e,t,o)=>{o.d(t,{D$:()=>h,M0:()=>u,W$:()=>y,ac:()=>f,cM:()=>m,hC:()=>p,uG:()=>v});o(21703);var n=o(68626),r=o(9852),i=o(54153),a=o(63143),s=o(11342),l=o(95477),c=o(5315),d=o(47839);function p(e){var t;const{environment:o,url:i,version:a}=e,{AppUpdateStore:s,device:l}=o;l.isElectron&&i.startsWith("https:")?n.log({level:"error",from:"appUpdateActions",type:"installAppJsUpdate",error:{message:"Attempting to refresh app js on desktop for an https url",stack:(new Error).stack},data:{url:i}}):(s.setState({electronUpdate:s.state.electronUpdate,appUpdate:void 0}),a&&h(a),u(a)||(o.mobileNative&&o.mobileNative.showSplashscreen(),(0,r.setAppRefreshed)(!0),null!==(t=d.electronApi)&&void 0!==t&&t.installAppJsUpdate?d.electronApi.installAppJsUpdate(i):i!==window.location.href?window.location.href=i:window.location.reload()))}function u(e){return(0,s.isEqualVersion)(e,v())}function m(e,t){if(!t)return!1;if("ready"!==t.state)return!1;if(c.transactionQueue.hasTasks())return!1;if(!e.currentUser.isLoggedIn())return!1;if(t.type===s.UpdateType.Silent){if(e.device.isMobileNative)return!1;const t=y();if(t&&(Date.now()-t)/a.A0<7)return!1;n.log({level:"info",from:"appUpdateActions",type:"shouldUpdateOnNavigate",data:{lastKnownUpdateTime:t}})}return!0}const g="lastKnownAppJsVersion";function h(e){i.Z.set(g,{version:e,time:Date.now()})}function f(){const e=i.Z.get(g);if(e&&e.version)return e.version;{const e=(0,s.parseVersion)(l.default.version);return i.Z.set(g,{version:e,time:Date.now()}),e}}function y(){const e=i.Z.get(g);if(e&&e.time)return e.time}function v(){return(0,s.parseVersion)(l.default.version)}},35253:(e,t,o)=>{o.d(t,{Bw:()=>i,Js:()=>s,qL:()=>a});var n=o(97880),r=o(22294);const i=e=>{const{id:t,styleKey:o,contentKey:i,removeTimeout:s,bannerStore:l,blockStore:c,context:d,disabled:p}=e,{banners:u}=l.state;if(!u.find((e=>e.id===t))){let m;switch(i){case"template_in_page":case"template_in_button":m={id:t,contentKey:i,styleKey:o,blockStore:c,context:d,disabled:p};break;case"space_content_duplication":case"deleted_or_moved_page":case"importing_evernote":m={id:t,contentKey:i,styleKey:o,blockStore:c};break;case"over_free_block_limit":case"editing_page":case"subscription_trial_add_payment_method":case"upload_limit_exceeded":case"admin_mode":case"subscription_payment_status":case"minor_app_update":case"mobile_platform_unsupported":case"page_in_archived_team":case"crdt_page":case"invite_page":case"invite_space":case"test_clock":m={id:t,contentKey:i,styleKey:o};break;default:(0,n.t1)(i)}const g=e.prepend?[m,...u]:[...u,m];l.setState({banners:g}),r.Z.setKeyboardMode(!1),s&&setTimeout((()=>{a({bannerStore:l,id:t})}),s)}},a=e=>{const{id:t,bannerStore:o}=e,{banners:n}=o.state,r=n.filter((e=>e.id!==t));r.length!==n.length&&o.setState({banners:r})},s=e=>{e.bannerStore.state.banners.length>0&&e.bannerStore.setState({banners:[]})}},54564:(e,t,o)=>{o.d(t,{Ib:()=>w,LZ:()=>k,Xv:()=>x});var n=o(1302),r=o(72126),i=o(29477),a=o(33709),s=o(23867),l=o(17707),c=o(34047),d=o(65598),p=o(58202),u=o(46351),m=o(74948),g=o(24646),h=o(36391),f=o(24229),y=o(35661),v=o(50906),b=o(24677),S=o(98104);function _(e,t){const o=u.Z.find((e=>e.getStore().id===t));o&&(b.ZH(e),S.NX({store:o.getInputStore().state.textStore}))}async function w(e){var t;const{environment:o,blockStore:u,analyticsFrom:w,discussionIds:k,shouldFocusDiscussion:x,recursivelyLoadAllDiscussions:I}=e,C=(null==k?void 0:k.map((e=>y.t1.createChildStore(u,{table:a.qF,id:e,spaceId:(0,s.C)(u.pointer.spaceId)}))))||d.al(u,{recursivelyLoadAllDiscussions:I});let{rect:T}=e;const{resolved:M,unresolved:P}=d.bB(C),A=(0,c.uC)(P.length>0?P:M)||[],D=null==A||null===(t=A[0])||void 0===t?void 0:t.id,{device:B}=o;B.isMobile&&"updates_sidebar"!==w&&(b.ZH(o),B.isIOS&&S.sD()),l.AM(A.map((e=>e.id))),await n.default.afterNextFlush();const R=(0,g.Sx)(o);if(u.isNavigableBlock()){if(D){"PageDetailsStore"in o&&o.PageDetailsStore.setToggleState({type:"discussion",id:u.id,environment:o},!0);const e=y.t1.createChildStore(u,{table:a.qF,id:D,spaceId:(0,s.C)(u.pointer.spaceId)});if((0,g.Sx)(o)&&l.T4(D),e.getResolved())if((0,g.Sx)(o))m.setUpdateSidebarCommentsMode(h.F7.Resolved);else{const e=p.R.findBlockFromStoreWithMethod(u,"openResolvedDiscussionPopup");e&&(e.openResolvedDiscussionPopup(),await n.default.afterNextFlush(),l.T4(D))}v.ZW8(o,{from:w,discussion_id:e.id})}if(!R)return}if(!T&&!R&&"margin_comments"!==w){const e=p.R.getRect(u);if(!e)return;const t=e.width,o=e.height,n=e.right-t;T=new DOMRect(n,e.top,t,o)}let E=f.u.Open;if(D){const e=y.t1.createChildStore(u,{table:a.qF,id:D,spaceId:(0,s.C)(u.pointer.spaceId)});e.getResolved()&&(E=f.u.Resolved),e.getResolved()||(m.setUpdateSidebarCommentsMode(h.F7.Unresolved),m.setUpdateSidebarTab(h.gY.Comments))}else E=f.u.Resolved;if(B.isMobile&&"updates_sidebar"!==w&&(b.ZH(o),B.isIOS&&S.sD()),f.Z.setState({open:!0,rect:T,tab:E,blockStore:u,discussionIds:C.map((e=>e.id)),recursivelyLoadAllDiscussions:I}),v.ZW8(o,{from:w,discussion_id:D}),x)if(D){if(await i.Vs(10),await n.default.afterNextFlush(),l.T4(D),o.device.isMobile)return;(function(e){var t;const{blockStore:o,discussionIds:n}=e;return f.Z.state.open&&f.Z.state.blockStore.id===o.id&&r.Xy(null===(t=f.Z.state)||void 0===t?void 0:t.discussionIds,n)})(e)||_(o,D)}else{if(o.device.isMobile)return;P.length>0&&(await i.Vs(10),await n.default.afterNextFlush(),_(o,P[0].id))}}function k(){const e=f.Z.state;e.open&&f.Z.setState({open:!1,rect:e.rect})}function x(){const e=f.Z.state;if(e.open&&e.tab===f.u.Open){0===d.vV(e.blockStore,{recursivelyLoadAllDiscussions:!1}).length&&k()}}},6404:(e,t,o)=>{o.d(t,{$Z:()=>d,Qn:()=>c,xv:()=>p});var n=o(95802),r=o(8949),i=o(17903),a=o(83212),s=o(50628),l=o(50906);function c(e){const{environment:t,left:o,top:n,actionSectionGroupKey:s,showInput:c,stores:d,analyticsFrom:p,optionalAnalyticsProperties:u,pageAnnotationToken:m}=e,g=new DOMRect(o,n,1,1);r.Z.setState({isActive:!0,inputValue:"",actionSectionGroupKey:s,stores:d,frameScrollTop:i.Z.state.scrollTop,originBlockRect:g,showInput:c,analyticsFrom:p,publicEditMode:d[0]?a.Z.getMode(t,d[0]):void 0,collectionContextStore:null==u?void 0:u.collectionContextStore,clickedPageAnnotation:m}),l.EDS(t,{from:p,block_type:d[0]&&d[0].getType(),optionalAnalyticsProperties:u})}const d=function(e){const{environment:t,analyticsFrom:o,actionSectionGroupKey:c,stores:d,showInput:p}=e,u=n.C.findSelectableFromStore(d[0]);if(!u)return;const m=s.Z.state.selectableRectMap.get(u);m&&r.Z.setState({isActive:!0,inputValue:"",actionSectionGroupKey:c,stores:d,frameScrollTop:i.Z.state.scrollTop,originBlockRect:m,showInput:void 0===p||p,analyticsFrom:o,publicEditMode:d[0]?a.Z.getMode(t,d[0]):void 0}),t&&l.EDS(t,{from:o,block_type:d[0]&&d[0].getType()})},p=function(){r.Z.setState({isActive:!1})}},79554:(e,t,o)=>{o.d(t,{Dq:()=>A,H8:()=>D,RH:()=>T,_x:()=>x,kE:()=>k,ry:()=>B,wK:()=>M,xv:()=>I});o(21703);var n=o(15145),r=o(41432),i=o(1800),a=o(72126),s=o(606),l=o(21202),c=o(70203),d=o(97880),p=o(95477),u=o(28020),m=o(95802),g=o(61207),h=o(35661),f=o(52229),y=o(19785),v=o(9953),b=o(42858),S=o(24677),_=o(97444),w=o(39699);function k(e){const{blocks:t,copiedStores:o,pageSource:n}=e,r=a.Z$(t);if(!r)return;const i=m.C.getRectFromStore(r);i&&g.Z.setState({open:!0,type:"blocks",blocks:t,rect:i,copiedStores:o,pageSource:n})}function x(e){const{blocks:t,copiedLinks:o,rootStore:n}=e;if(!t.every(C))return!1;if(o.some((e=>e.blockId===n.id)))return!1;const r=a.Z$(t);if(!r)return!1;const i=m.C.getRectFromStore(r);return!!i&&(g.Z.setState({open:!0,type:"links",blocks:t,rect:i,copiedLinks:o}),!0)}function I(){g.Z.setState({open:!1})}function C(e){return!(e.isType(r.Ti.copyIndicator)||e.isTransclusionType()||e.isInsideCollection())}function T(e){const{blocks:t,pageSource:o,wasContiguousSelection:n,action:i,rootStore:a,copiedStores:l}=e;return"copy"===i&&n&&!(0,s.qo)(o,a.pointer)&&(M(e)||D({currentSpaceId:a.getSpaceId(),...e}))&&t.every(C)&&!l.every((e=>e.getType()===r.Ti.externalObjectInstance))}function M(e){const{blocks:t}=e;return 1===t.length}function P(e){const{transaction:t,blockUrl:o,spaceId:n,useCrdt:i,environment:a}=e,s=v.j4({environment:a,type:r.Ti.text,inMemoryRecordCache:a.defaultRecordCache.inMemoryRecordCache,transaction:t,spaceId:n,useCrdt:i}),l=[(0,c.V3y)(o,[(0,c.edl)(o)])];return _.sO({environment:a,store:s.getBlockTitleStore(),value:l,transaction:t}),s}async function A(e){const{environment:t,blocks:o,source:r}=e,s=a.Ps(o);if(!s)return;const c=s.getParentBlockStore();if(!c)return;const u=s.getContentStore();let m;await w.createAndCommitAsync({environment:t,userAction:"blockPasteMenuActions.acceptLinkToPage",waitForServerCommit:!0,perform:async e=>{if("blocks"===r.type){const{copiedStores:o,pageSource:a}=r,d=s,g=o[0];if(!d||!g)return;const y=h.G.createChildStore(u,{table:l.iU,id:g.id});if(y.isNavigableBlock())await y.load(),m=[f.k({environment:t,parentBlock:c,targetStore:y,transaction:e})];else{const o=(0,i.Z)({pageId:a.id,scrollToBlockId:y.id,baseUrl:p.default.domainBaseUrl,pageVisitSource:n.tY.LinkInPage});m=[P({blockUrl:o,spaceId:s.getSpaceId(),useCrdt:s.useCrdt(),environment:t,transaction:e})]}}else if("links"===r.type){const{copiedLinks:a}=r;if(a.length!==o.length)return;m=await Promise.all(a.map((async o=>{const r=o.scrollToBlockId||o.peekViewBlockId||o.blockId,a=h.G.createChildStore(u,{table:l.iU,id:r});if(await a.load(),a.isNavigableBlock())return f.k({environment:t,parentBlock:c,targetStore:a,transaction:e});{const r=o.peekViewBlockId||o.blockId,c=h.G.createChildStore(u,{table:l.iU,id:r});await c.load();return P({blockUrl:(0,i.Z)({pageId:r,pageModel:c.getModel(),scrollToBlockId:a.id,baseUrl:p.default.domainBaseUrl,pageVisitSource:n.tY.LinkInPage}),spaceId:s.getSpaceId(),useCrdt:s.useCrdt(),environment:t,transaction:e})}})))}else(0,d.t1)(r);const a=b.is({environment:t,blocks:m,selection:o,replaceEmptyTextBlock:!0,transaction:e});b.Cl({environment:t,blocks:o,transaction:e}),S.Z5({environment:t,stores:a}),I()}})}function D(e){const{currentSpaceId:t,blocks:o,copiedStores:n}=e;return o.length>0&&!n.some((e=>e.isInsideCollection()))&&n.every((e=>e.canEdit()))&&n.every((e=>e.getSpaceId()===t))}async function B(e){const{environment:t,blocks:o,copiedBlockIds:n}=e,i=await Promise.all(n.map((async e=>{const t=h.G.createChildStore(o[0],{table:l.iU,id:e});await t.load();const n=t.getParentBlockStore();if(!n)throw new Error("Block has no parent.");await n.load();const r=n.getContentStore();return{store:h.G.createChildStore(r,{table:l.iU,id:e}),parentStore:n,parentContentStore:r}}))),a=i[0];if(!a)return;const{serverCommitResult:s}=w.createAndCommit({userAction:"blockPasteMenuActions.acceptCreateTransclusion",environment:t,perform:e=>{var n,s;let l;if(a.store.getType()===r.Ti.transclusionContainer)l=a.store;else if(a.store.getType()===r.Ti.transclusionReference){const e=a.store.getTransclusionReferenceTargetStore();if(!e)throw new Error("Could not find target");l=e}else if(a.parentStore.getType()===r.Ti.transclusionContainer)l=a.parentStore;else{l=v.j4({environment:t,type:r.Ti.transclusionContainer,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:a.store.pointer.spaceId,useCrdt:a.store.useCrdt()});const o=l.getContentStore();y.rS({parentStore:a.parentContentStore,oldChildStore:a.store,newChildStore:l,transaction:e});for(const{store:t}of i)y.jG({parentStore:o,childStore:t,transaction:e})}const c=v.j4({environment:t,type:r.Ti.transclusionReference,format:{transclusion_reference_pointer:l.pointer},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:0!==o.length?o[o.length-1].pointer.spaceId:null===(n=(0,u.RM)())||void 0===n?void 0:n.pointer.spaceId,useCrdt:0!==o.length?o[o.length-1].useCrdt():(null===(s=(0,u.RM)())||void 0===s?void 0:s.useCrdt())??!1}),d=b.is({environment:t,blocks:[c],selection:o,transaction:e,replaceEmptyTextBlock:!0});b.Cl({environment:t,blocks:o,transaction:e}),S.Z5({environment:t,stores:d}),I()}});await s}},51365:(e,t,o)=>{o.d(t,{$o:()=>v,RX:()=>b,bA:()=>h,fG:()=>w,gT:()=>S,i2:()=>_,mm:()=>k,vO:()=>y,xv:()=>f});var n=o(73935),r=o(1302),i=o(99036),a=o(80951),s=o(70203),l=o(58299),c=o(9953),d=o(61045),p=o(24677),u=o(97444),m=o(98104),g=o(39699);function h(e){const{environment:t,blockPropertyValueOverlayStore:o,store:a,additionalStores:c=[],property:h,format:f,preventClearSelection:y,insertChar:v,uploadFiles:b,disableHorizontalEdgeScroll:S,isNewBlock:_,collectionContextStore:w,mode:k,collectionsBulkActionsToolbarStore:x}=e,I=(a.getSchema()||{})[h],C=l.Z.findBlockPropertyValue(a,h);let T=e.rect;const M=null==C?void 0:C.getNode();if(M&&(d.bx({element:M,vertical:{reveal:"closest"},horizontal:S?void 0:{reveal:"closest"},scrollers:{verticalScroller:null==C?void 0:C.getContextVerticalScroller(),horizontalScroller:null==C?void 0:C.getContextHorizontalScroller()}}),!T)){const e=n.findDOMNode(M);e instanceof Element&&(T=e.getBoundingClientRect())}if(!T)return;const P=a.clone();if(o.setState({isOpen:!0,store:a,clonedStore:P,additionalStores:c,property:h,format:f,rect:T,preventClearSelection:y,insertChar:v,uploadFiles:b,isNewBlock:_,collectionContextStore:w,mode:k,collectionsBulkActionsToolbarStore:x}),!x||"title"!==(null==I?void 0:I.type)&&"text"!==(null==I?void 0:I.type)||null==x||x.setState({textStoresBeingEdited:[...c,a],lastBlockPropertyValueOverlayCloseTime:void 0}),I&&i.Yl(I.type)){y||p.ZH(t);const e=P.getNormalizedPropertyStore(h);v&&g.createAndCommit({userAction:"blockPropertyValueOverlayActions.open",environment:t,perform:o=>{u.sO({environment:t,store:e,value:s.TPx(v),transaction:o})}}),r.default.afterNextFlush((()=>{r.default.afterNextFlush((()=>{r.default.afterNextFlush((()=>{m.NX({store:e})}))}))}))}else y||p.ZH(t),m.ZH(t)}function f(e){const{environment:t,blockPropertyValueOverlayStore:o}=e,n=o.state;n.isOpen&&(n.preventClearSelection||p.ZH(t),o.reset(),r.default.afterNextFlush((()=>{var e;return null===(e=n.collectionsBulkActionsToolbarStore)||void 0===e?void 0:e.setState({textStoresBeingEdited:[],lastBlockPropertyValueOverlayCloseTime:Date.now()})})))}const y=function(e){const{stores:t,property:o,transaction:n}=e,r=t[0].getPropertyStore(o),i=(0,a.Ml)(r.getValue());for(const s of t)c.sO({store:s.getPropertyStore(o),value:(0,a._I)(!i),transaction:n})};function v(e){const{blockPropertyValueOverlayStore:t}=e,o=t.state;if(o.isOpen){const{store:t,property:i}=o,a=l.Z.findBlockPropertyValue(t,i);var n,r;if(null!=a&&a.getProps().onTab)null==a||null===(n=(r=a.getProps()).onTab)||void 0===n||n.call(r);else f(e)}}function b(e){const{blockPropertyValueOverlayStore:t}=e,o=t.state;if(o.isOpen){const{store:t,property:i}=o,a=l.Z.findBlockPropertyValue(t,i);var n,r;if(null!=a&&a.getProps().onUntab)null==a||null===(n=(r=a.getProps()).onUntab)||void 0===n||n.call(r);else f(e)}}function S(e){const{blockPropertyValueOverlayStore:t}=e,o=t.state;if(o.isOpen){const{store:t,property:i}=o,a=l.Z.findBlockPropertyValue(t,i);var n,r;if(null!=a&&a.getProps().onEnter)null==a||null===(n=(r=a.getProps()).onEnter)||void 0===n||n.call(r);else f(e)}}function _(e){const{blockPropertyValueOverlayStore:t}=e,o=t.state;if(o.isOpen){const{store:t,property:i}=o,a=l.Z.findBlockPropertyValue(t,i);var n,r;if(null!=a&&a.getProps().onEsc)null==a||null===(n=(r=a.getProps()).onEsc)||void 0===n||n.call(r);else f(e)}}function w(e){const{blockPropertyValueOverlayStore:t}=e,o=t.state;if(o.isOpen){const{store:t,property:i}=o,a=l.Z.findBlockPropertyValue(t,i);var n,r;if(null!=a&&a.getProps().onBgClick)null==a||null===(n=(r=a.getProps()).onBgClick)||void 0===n||n.call(r);else f(e)}}function k(e){const{blockPropertyValueOverlayStore:t,openProperty:o}=e,n=t.state;if(n.isOpen){var r,i;const{store:t,property:a}=n,s=l.Z.findBlockPropertyValue(t,a);(null==s||null===(r=(i=s.getProps()).onOpenProperty)||void 0===r?void 0:r.call(i,o))||f(e)}}},48948:(e,t,o)=>{o.d(t,{K:()=>p});var n=o(41432),r=o(29477),i=o(23867),a=o(70203),s=o(80444),l=o(54642),c=o(9953),d=o(39699);async function p(e){const{store:t,url:o,environment:p,teamId:u}=e,m=void 0!==e.transformTimeout?e.transformTimeout:3e3,{serverCommitResult:g}=d.createAndCommit({userAction:"bookmarkBlockActions.createBookmark",environment:p,perform:e=>{c.sW({store:t.getPropertiesStore(),data:{link:a.TPx(o),title:a.TPx(o)},transaction:e})}}),{winner:h,rest:f}=await r.S3([g,r.Vs(m)]);if(1===h&&(await async function(e,t){const{serverCommitResult:o}=d.createAndCommit({userAction:"bookmarkBlockActions.transformIntoBookmark",environment:e,perform:e=>{c.sW({store:t,data:{type:n.Ti.bookmark},transaction:e})}});await o}(p,t),await f),u){const{currentSpaceStore:e}=s.default.state;await l.setBookmarkMetadata(p,{type:"team-invite-bookmark",block:{id:t.id,spaceId:(0,i.C)(t.pointer.spaceId)},url:o,teamId:u,spaceId:e&&e.id})}else await l.setBookmarkMetadata(p,{type:"external-bookmark",block:{id:t.id,spaceId:(0,i.C)(t.pointer.spaceId)},url:o})}},14871:(e,t,o)=>{o.d(t,{AL:()=>Pt,Dw:()=>ro,Hs:()=>oo,IK:()=>io,JG:()=>Mt,Lh:()=>go,Mt:()=>mo,Pm:()=>po,R$:()=>Ft,RD:()=>so,VG:()=>no,by:()=>Tt,e0:()=>St,f4:()=>co,g9:()=>ao,jm:()=>kt,of:()=>Ot,tk:()=>Gt,tq:()=>Xe,v:()=>Xt,wc:()=>uo});o(57658),o(21703);var n=o(27856),r=o.n(n),i=o(1302),a=o(66897),s=o(15145),l=o(41432),c=o(99036),d=o(8848),p=o(97531),u=o(1800),m=o(15095),g=o(64962),h=o(61075),f=o(42509),y=o(43593),v=o(78106),b=o(68626),S=o(38297),_=o(42875),w=o(19531),k=o(64572),x=o(22808),I=o(30845),C=o(72126),T=o(25718),M=o(59753),P=o(482),A=o(33317),D=o(19233),B=o(4615),R=o(71644),E=o(45953),F=o(606),N=o(82883),j=o(99405),O=o(21202),L=o(6287),U=o(70279),Z=o(23867),V=o(54153),q=o(70203),z=o(44805),W=o(95371),H=o(374),G=o(70842),K=o(97880),$=o(64002),Y=o(82798),Q=o(5366),J=o(96313),X=o(94419),ee=o(95477),te=o(78791),oe=o(65273),ne=o(24990),re=o(28020),ie=o(56518),ae=o(44486),se=o(84210),le=o(33929),ce=o(68056),de=o(45162),pe=o(98165),ue=o(70219),me=o(65598),ge=o(69645),he=o(73959),fe=o(41984),ye=o(40150),ve=o(89224),be=o(89086),Se=o(28685),_e=o(95802),we=o(41662),ke=o(80444),xe=o(87143),Ie=o(88632),Ce=o(77080),Te=o(30874),Me=o(22294),Pe=o(35661),Ae=o(27724),De=o(24666),Be=o(34583),Re=o(50906),Ee=o(79554),Fe=o(42274),Ne=o(45264),je=o(47307),Oe=o(54532),Le=o(31781),Ue=o(89951),Ze=o(19358),Ve=o(9953),qe=o(42858),ze=o(24677),We=o(64964),He=o(80402),Ge=o(97444),Ke=o(98104),$e=o(39699),Ye=o(68422),Qe=o(61202);const Je=(0,Q.defineMessages)({offlineError:{id:"clipboardActions.offlineError.message",defaultMessage:"Please go online to copy this block."}}),Xe=(0,Q.defineMessages)({copiedQnAMessageToClipboard:{id:"action.copiedQnAMessageToClipboard",defaultMessage:"Copied response to clipboard"},copiedLinkToClipboard:{id:"action.copiedLinkToClipboard.snackBarMessage",defaultMessage:"Copied link to clipboard"},copiedBlockLinkToClipboard:{id:"action.copiedBlockLinkToClipboard.snackBarMessage",defaultMessage:"Copied block link to clipboard"},copiedLinksToClipboard:{id:"action.copiedLinksToClipboard.snackBarMessage",defaultMessage:"Copied links to clipboard"},copiedPropertyToClipboard:{id:"action.copiedPropertyToClipboard.snackBarMessage",defaultMessage:"Copied property to clipboard"},copiedCodeToClipboard:{id:"action.copiedCodeToClipboard.snackBarMessage",defaultMessage:"Copied code to clipboard"},copiedTokenToClipboard:{id:"action.copiedTokenToClipboard.snackBarMessage",defaultMessage:"Copied token to clipboard"},copiedToClipboard:{id:"action.copiedToClipboard.snackBarMessage",defaultMessage:"Copied to clipboard"},copiedApiObjectToClipboard:{id:"action.copiedApiObjectToClipboard.snackBarMessage",defaultMessage:"Copied API object to clipboard"}}),et={...D.Y,dockerfile:"Docker",javascriptreact:"JavaScript",jsonc:"JSON","objective-c":"Objective-C",proto:"Protobuf",shellscript:"Shell",typescriptreact:"TypeScript",vb:"Visual Basic"},tt="text/_notion-blocks-v3-production",ot="text/_notion-text-production",nt="text/_notion-multi-text-production",rt="text/_notion-page-source-production",it="vscode-editor-data",at=[tt,ot,nt,rt],st=new Set(at);const lt={fromJson:e=>e,toJson:e=>e},ct=lt,dt=lt,pt=lt,ut={fromJson(e){const t=(0,W.MW)(e.tree,(e=>e)),o=mt.fromJson(e.blockSelection);return{...e,tree:t,blockSelection:o}},toJson(e){const t=mt.toJson(e.blockSelection);return{...e,blockSelection:t}}},mt={fromJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?E.Ak.create(e.blockSubtree):void 0})))}),toJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?e.blockSubtree.toJson({allowVersionDowngrade:!1}):void 0})))})},gt="VirtualClipboard:production";let ht;function ft(e){return e.isAndroid}function yt(e,t){if(!ft(t))return e;const o=(0,ie.nZ)(e.getData("text/html"));if(o){ht||(ht=V.Z.get(gt));const t=ht;if(o===(null==t?void 0:t.id))return{getData(o){const n=e.getData(o);return!n&&function(e){return st.has(e)}(o)?t.mimeTypes[o]||"":n}}}return e}function vt(e,t,o,n){if(!e.clipboardData)return;const r=o.toJson(n),i=JSON.stringify(r);e.clipboardData.setData(t,i)}function bt(e,t,o){try{const n=e.getData(t),r=JSON.parse(n);return o.fromJson(r)}catch(n){return}}function St(e){const{clipboardData:t}=e,{text:o,html:n,isFromMicrosoftOffice:r}=function(e){const{clipboardData:t,tinyMceMicrosoftWordPasteFilter:o}=e,n=t.getData("text/uri-list").trim(),r=t.getData("text/plain").trim().replace(Jt,"\n")||n,i=t.getData("text/html").trim(),a=qt(i);if(!function(e){const t=document.createElement("div");return t.innerHTML=zt(e),w.RE({node:t,window,emojiData:ne.Z.state})}({html:i,tinyMceMicrosoftWordPasteFilter:o})&&!function(e,t){return Qt.test(e)&&Qt.test(t)}(i,r))return{text:r,isFromMicrosoftOffice:a};return{text:r,html:i,isFromMicrosoftOffice:a}}(e);return{text:o,html:n,multiTextSelectionData:bt(t,nt,ut),textSelectionData:bt(t,ot,ct),blockSelectionData:bt(t,tt,mt),isFromMicrosoftOffice:r}}function _t(e){const{blocks:t,action:o,environment:n}=e;if(0===t.length)return{action:o,blocks:[],wasContiguousSelection:!1};const r=t[0],i=r.inMemoryRecordCache,a=C.jj(C.oA(t.map((e=>e.id)))),s=r.getParentBlockStore(),l=s?s.getRenderableContentIds():[],c=l.indexOf(r.id),d=Boolean(s&&t.every(((e,t)=>l.indexOf(e.id)===c+t)));if(i.isTemplatePreview){return{blocks:a.map((e=>({blockId:e,snapshotData:void 0,blockSubtree:Oe.K8(n,{blockId:e,inMemoryRecordCache:i,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})}))),action:o,wasContiguousSelection:d}}if(i.snapshotData){Re.P_7(n,i.snapshotData);return{blocks:a.map((e=>({blockId:e,snapshotData:i.snapshotData,blockSubtree:Oe.K8(n,{blockId:e,inMemoryRecordCache:i,allowCopyCollections:!0,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})}))),action:o,wasContiguousSelection:d}}{const e=(0,ie.IU)(t),r=e&&function(e){var t;const{environment:o,multiColumnPasteInfo:n,inMemoryRecordCache:r}=e,{columnListId:i,columnIds:a,spaceId:s}=n,l=E.Ak.create(),c=null===(t=r.getEntry({pointer:{table:O.iU,id:i,spaceId:s},userId:o.currentUser.id}))||void 0===t?void 0:t.value.value;if("column_list"!==(null==c?void 0:c.type))return;const d={...c,content:(c.content||[]).filter((e=>a.has(e)))};l.setValue({table:O.iU,id:i,spaceId:s},d);for(const m of a){var p;const e=null===(p=r.getEntry({pointer:{table:O.iU,id:m,spaceId:s},userId:o.currentUser.id}))||void 0===p?void 0:p.value.value;if("column"!==(null==e?void 0:e.type))return;const t={...e,content:(e.content||[]).filter((e=>n.blockIds.has(e)))};l.setValue({table:O.iU,id:m,spaceId:s},t)}const u=[l];for(const m of n.blockIds){const e=Oe.K8(o,{blockId:m,inMemoryRecordCache:r,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0});if(!e)return;u.push(e)}return E.Ak.merge(u)}({environment:n,inMemoryRecordCache:i,multiColumnPasteInfo:e});if(e&&r){let t=!1;const s=[];for(const o of a)e.blockIds.has(o)?t||(s.push({blockId:e.columnListId,snapshotData:void 0,blockSubtree:r}),t=!0):s.push({blockId:o,snapshotData:void 0,blockSubtree:Oe.K8(n,{blockId:o,inMemoryRecordCache:i,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})});return{blocks:s,action:o,wasContiguousSelection:d}}return{blocks:a.map((e=>({blockId:e,snapshotData:void 0,blockSubtree:Oe.K8(n,{blockId:e,inMemoryRecordCache:i,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})}))),action:o,wasContiguousSelection:d}}}function wt(e){const{markdown:t,markdownOptions:o,markdownLinkifyIt:n}=e;if(n)return T.c8({...n,markdown:t,plugin:null==o?void 0:o.plugin})}function kt(e){const{rootBlock:t,getRecordValue:o}=e,n=o(t);if(!n)return;const r=(0,S.ky)({block:n,getRecordValue:o});if(!r)return;const i=(0,ie.ax)({rootBlock:t,getRecordValue:o}),a=(0,c.oC)(r),s=Object.keys(a),l=C.MR(s,(e=>{const t=a[e];return t&&t.name||""}));let d="";for(const c of l){const e=a[c];if(e&&"title"!==c){const t=(0,h.Wy)({property:c,schema:a,block:n,exportArgs:i,renderers:g.O});t&&(d+=`${e.name}: ${t}\n`)}}return d||void 0}function xt(e){const{treePath:t,textPosition:o,endpoint:n}=e,{store:r,index:i}=o,a=t.map((e=>e.value.store.pointer)),s=o.store.path,l=q.xrQ(r.getValue(),i,i);return{copiedText:"end"===n?l.tokensBeforeRange:l.tokensAfterRange,textIndex:i,attributePath:s,pointerPath:a}}function It(e){var t;const{multiSelection:o,action:n,environment:r}=e;(0,ce.qS)(o)&&console.warn("Warning, serializeMultiTextSelectionToClipboardData() was called with a single-store text selection! This function should only be  called with a multi-selection that spans multiple blocks.");const i=null===(t=(0,de.tp)({filterCommonAncestors:!0,multiSelection:o,focus:void 0}))||void 0===t?void 0:t.stores;if(!i)return;const a=_t({action:n,blocks:i,environment:r});if(0===a.blocks.length)return;const s=(0,de.Nj)({multiSelection:o,includeNonSelectable:!1});if(!s)return;const{treeRange:l}=s,c=[],d=new Map,p=(e,t)=>{t.forEach((e=>p(e,[])));const o=d.get(e),n=o&&o.length>t.length?o:t;d.set(e,n)};for(const{start:y,end:v}of l.iterateAnalogousNodes()){if(y){const e=y.childrenBeforeRange.slice(-1).concat(y.childrenInsideRange);p(y.parent,e)}v&&(p(v.parent,v.childrenInsideRange),c.push(P.op.set({pointer:v.parent.value.store.pointer,path:["content"],args:v.childrenInsideRange.map((e=>e.value.store.id))})))}const u=xt({textPosition:o.start,endpoint:"start",treePath:l.startPath}),m=xt({textPosition:o.end,endpoint:"end",treePath:l.endPath});c.push(P.op.set({pointer:u.pointerPath[u.pointerPath.length-1],path:u.attributePath,args:u.copiedText})),c.push(P.op.set({pointer:m.pointerPath[m.pointerPath.length-1],path:m.attributePath,args:m.copiedText}));for(const y of[null===(g=a.blocks[0])||void 0===g?void 0:g.blockSubtree,null===(h=a.blocks[a.blocks.length-1])||void 0===h?void 0:h.blockSubtree]){var g,h;y&&(0,A.FS)({recordMap:y,operations:c,updateOnly:!0})}const f=(0,W.MW)(l.commonAncestor,(e=>{const t=d.get(e);if(t)return{value:e.value.store.pointer,children:t}}));return f?{blockSelection:a,tree:f,multiTextSelection:{start:u,end:m},action:n}:void 0}function Ct(e){const{environment:t,event:o}=e,n=(0,B.ZP)();!function(e){const{environment:t,event:o,markdownLinkifyIt:n}=e;if(!o.clipboardData)return;const r=Ae.default.state.stores,i=De.default.isEditingComment(),a=we.g$.getSimpleTableCellFromTextSelection(),s="empty"!==De.default.state.mode&&De.default.state.multiSelection,c=t.currentUser.id,p="copy"===o.type?"copy":"cut",u=re.RM();u&&(0,F.$O)(u.pointer,O.iU)&&vt(o,rt,dt,u.pointer);const m=s&&(0,ce.QY)(s);if(m&&m.selection.startIndex!==m.selection.endIndex){const e=le.default.getIntl(),{store:n,selection:r}=m,i=n.inMemoryRecordCache,a=n.getValue();if(o.preventDefault(),a&&!Gt()){var g;const e="title"===n.path[n.path.length-1],t=null===(g=(0,he.sQ)(n))||void 0===g?void 0:g.getType(),i=e&&t&&(0,l.Zu)(t)?t:void 0;vt(o,ot,ct,{blockType:i,editing:a,selection:r,action:p})}const s=q.KU1(a,r.startIndex,r.endIndex),u=M.om.fromGetRecordValueFn(i.makeGetRecordValueFn(c)),h=i.makeGetRecordRoleFn(c),f=(0,N.X)({intl:e,textValue:s,getRecordModel:u,userTimeZone:(0,_.r)()});o.clipboardData.setData("text/plain",(0,ie.ZI)(t.device.isWindows,f));const y=z.hW({textValue:s&&{value:s,spaceId:(0,Z.C)(n.pointer.spaceId)},getRecordModel:u,getRecordRole:h,userTimeZone:(0,_.r)(),isAndroid:!1,isSafariOrIOS:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,baseUrl:ee.default.domainBaseUrl,publicDomainName:ee.default.publicDomainName,showEmojiInline:!0,emojiType:"raw",theme:(0,d.Vx)(),intl:e,katex:void 0,isClient:void 0,currentUserId:void 0,overwriteBaseUrlFromSpaceId:(0,ue.b)(t),externalIntegrations:Te.Z.integrations.state,formulaValueTypes:[],emojiData:ne.Z.state});return void o.clipboardData.setData("text/html",(0,ie.ZI)(t.device.isWindows,y))}if(s&&!(0,ce.iG)(s)&&!i&&s.start.store.table===O.iU&&s.end.store.table===O.iU){const e=It({environment:t,multiSelection:s,action:p});if(e){o.preventDefault(),vt(o,nt,ut,e);const r=s.start.store.inMemoryRecordCache,i=s.start.store.getRecordStoreUIRoot().getValue();if(!i)return;const{markdown:a,html:l}=(0,ie.Ef)({clipboardData:e,rootBlock:{id:i.id,table:O.iU,spaceId:i.space_id},isWindows:t.device.isWindows,fallbackGetRecordValue:r.makeGetRecordValueFn(c),markdownLinkifyIt:n});return a&&o.clipboardData.setData("text/plain",a),void(l&&o.clipboardData.setData("text/html",l))}}if(s&&!(0,ce.iG)(s)&&!i&&s.start.store.table===U.x_&&s.end.store.table===U.x_){o.preventDefault();const e=(0,de.L5)(s),n=le.default.getIntl(),r=e.map((e=>{let{store:o,selection:r}=e;if(r.startIndex===r.endIndex)return;const i=o.inMemoryRecordCache,a=M.om.fromGetRecordValueFn(i.makeGetRecordValueFn(c)),s=i.makeGetRecordRoleFn(c),l=q.KU1(o.getValue(),r.startIndex,r.endIndex);return{plainText:(0,N.X)({intl:n,textValue:l,getRecordModel:a,userTimeZone:(0,_.r)()}),htmlContent:z.hW({textValue:l&&{value:l,spaceId:(0,Z.C)(o.pointer.spaceId)},getRecordModel:a,getRecordRole:s,userTimeZone:(0,_.r)(),isAndroid:!1,isSafariOrIOS:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,baseUrl:ee.default.domainBaseUrl,publicDomainName:ee.default.publicDomainName,showEmojiInline:!0,emojiType:"raw",theme:(0,d.Vx)(),intl:n,katex:void 0,isClient:void 0,currentUserId:void 0,overwriteBaseUrlFromSpaceId:(0,ue.b)(t),externalIntegrations:Te.Z.integrations.state,formulaValueTypes:[],emojiData:ne.Z.state}),textValue:l}})).filter(K.$K),i=r.map((e=>e.plainText)).join("\n\n"),a=`<div>${r.map((e=>e.htmlContent)).join("</div><div>")}</div>`;return o.clipboardData.setData("text/plain",(0,ie.ZI)(t.device.isWindows,i)),void o.clipboardData.setData("text/html",(0,ie.ZI)(t.device.isWindows,a))}if(r.length>0&&!i&&!a){o.preventDefault();const e=r[0],i=e.inMemoryRecordCache,a=_t({blocks:r,environment:t,action:p});if(vt(o,tt,mt,a),!e.isDefined())return;const s=C.oA(r.map((e=>e.computeWithRecordValues((t=>{let{getRecordValueAndSubscribe:o}=t;return o(e)}))))),l=i.makeGetRecordValueFn(c),{markdown:d,html:u}=(0,ie.X4)({rootBlock:{id:e.id,table:O.iU,spaceId:e.getSpaceId()},blockValues:s,getRecordValue:l,isWindows:t.device.isWindows,markdownLinkifyIt:n});return d&&o.clipboardData.setData("text/plain",d),void(u&&o.clipboardData.setData("text/html",u))}}(e),(0,ie.Li)(o,n),function(e){let{event:t,device:o,customEventId:n}=e;if(!t.clipboardData||!ft(o))return;const r={};for(const s of at)r[s]=t.clipboardData.getData(s);const i=t.clipboardData.getData("text/html");t.clipboardData.setData("text/html",`${i}${(0,ie.Gp)(n)}`),ht={id:n,mimeTypes:r};try{V.Z.set(gt,ht)}catch(a){b.log({level:"error",from:"clipboardActions",type:"setVirtualClipboardData",error:{message:"Unable to persistently store virtual clipboard data."}})}}({event:o,device:t.device,customEventId:n})}async function Tt(e){const{event:t,environment:o,markdownLinkifyIt:n}=e;Ke.Zk(o);const r=Ae.default.state.stores,i=De.default.isEditingComment(),a=re.JE(),s="editing"===De.default.state.mode&&De.default.state.multiSelection,{phase:l}=Ae.default.state;Mt({environment:o,event:t,disableSyncTextSelection:!0,markdownLinkifyIt:n}),s&&!(0,ce.iG)(s)?$e.createAndCommit({userAction:"clipboardActions.cutWithMaybeConfirmation",environment:o,perform:e=>{Ge.pz({environment:o,multiSelection:s,transaction:e})}}):(l===Ae.SelectionPhase.Selected||s)&&r.length>0&&!i&&!a&&await qe.Qw({environment:o,blocks:r}),Me.Z.setKeyboardMode(!0)}function Mt(e){const{environment:t,event:o,disableSyncTextSelection:n,markdownLinkifyIt:r}=e;n||Ke.Zk(t),Ct({environment:t,event:o,markdownLinkifyIt:r}),Me.Z.setKeyboardMode(!0)}function Pt(e){const{environment:t,files:o,transaction:n}=e,r=Ae.default.getCurrentRecordCache(),i=re.qQ(t);if(r){var a,s;const e=Ae.default.state.stores,l=Le.z({environment:t,files:o,inMemoryRecordCache:r,transaction:n,pageWidth:i,spaceId:0!==e.length?e[0].pointer.spaceId:null===(a=re.RM())||void 0===a?void 0:a.pointer.spaceId,useCrdt:0!==e.length?e[0].useCrdt():(null===(s=re.RM())||void 0===s?void 0:s.useCrdt())??!1});l.forEach((e=>{const o=e.getType();o&&Re.W2j(t,{from:"paste",type:o})})),Rt({environment:t,blocks:l,transaction:n,replaceEmptyTextBlock:!0})}}function At(e){const{environment:t,store:o,tokens:n,index:r,transaction:a,multiTextSelection:s,disableEmbedMenu:l,selectAll:c}=e,d=(0,ce.QY)(s),p=d?{value:d.store.getValue()}:void 0;Ge.mM({environment:t,store:o,tokens:n,index:r,transaction:a,selectAll:c});const u=Dt(n);!l&&p&&u&&function(e){const{environment:t,hyperlink:o,oldTextValue:n}=e,r="editing"===De.default.state.mode&&(0,ce.QY)(De.default.state.multiSelection),a=Ae.default.state;if(r&&a.stores.length>0){const e=r.store.getValue(),a=q.QaF(e),s=m.p4(a.substring(0,a.indexOf(o.text))).length,l=s+m.p4(o.text).length;if(r.store.isTable(O.iU)||r.store.isTable(U.x_)){if(Qe.KT({environment:t,blockStore:Ae.default.state.stores[0],textStore:r.store,textValueBeforePaste:n,url:o.url,urlSelection:{startIndex:s,endIndex:l}}))return;if(J.QZ({environment:t,textStore:r.store,blockStore:Ae.default.state.stores[0],oldTextValue:n,url:o.url,urlSelection:{startIndex:s,endIndex:l}}))return}i.default.afterNextFlush((()=>{let e=o.url;try{e=decodeURIComponent(o.url)}catch(i){b.log({level:"info",from:"clipboardActions",type:"activateMenuFromLink",error:{message:`Encountered error in decodeURIComponent ${o.url}`}})}Ue.KT({environment:t,textStore:r.store,oldTextValue:n,url:e,urlSelection:{startIndex:s,endIndex:l}})}))}}({environment:t,hyperlink:u,oldTextValue:p.value,transaction:a})}function Dt(e){if(1!==e.length)return;const t=e[0];if(!q.AJd(t))return;const[o,n]=t;if(1!==n.length)return;const r=n[0];if(!q.j0F(r))return;return{text:o,url:q.zW$(r)}}function Bt(e){const{environment:t,clipboardData:o,transaction:n,allowPasteIntoHeaderWithoutChildren:r,selectAll:a}=e;if(De.default.isEditingComment()||Kt())return!1;if(o.blockSelection.blocks.some((e=>!e.blockSubtree)))return!1;const s=De.default.state;if("editing"!==s.mode)return!1;const c=s.multiSelection.start.store;if(!c.isTable(O.iU))return!1;const d=(0,he.sQ)(c);if(!d)return!1;if(c!==d.getBlockTitleStore())return!1;const p=d.getType(),u=d.getFormat();if(!p)return!1;if(!((0,l.Um)(p,u)||r&&(0,l.zp)(p)))return!1;if(r&&(0,l.zp)(p)){var m;const e=o.blockSelection.blocks[0],t=null==e?void 0:e.blockId,n=null==e?void 0:e.blockSubtree,r=t&&n?n.getValue({id:t,table:"block"}):void 0;if(Boolean(null==r||null===(m=r.content)||void 0===m?void 0:m.length))return!1}const g=(0,ge.dq)({includeNonSelectableListContainer:!0});if(!g)return!1;const h=(0,ge.v5)(d,[g]);if(!h)return!1;let f=0;for(let i=h.length-1;i>=0;i--){const e=h[i].value.store,t=_e.C.findSelectableFromStore(e),o=e.getModel();if(null!=o&&o.isType(l.$t)||t&&!t.props.canSelect){f=i;break}}const y=h.slice(f);if(0===y.length)return!1;const v=y[0].value.store,b=v.pointer.spaceId,S=v.isInsideTemplate()||v.isInsideFactoryOrDuplicateBlocksAction(),w=o.blockSelection.blocks.map((e=>{var o;let{blockId:r,blockSubtree:i}=e;if(!i)throw new Error("Missing data for local duplicate block during paste");const a=(null===(o=i.getValue({table:O.iU,id:r}))||void 0===o?void 0:o.type)===l.Ti.factory,s=!(S||a),c=Pe.G.createChildStore(v,{table:O.iU,id:r}),d=Oe.E9({environment:t,sourceBlockId:r,targetBlockPointer:{table:O.iU,id:(0,B.ZP)(),spaceId:b},sourceBlockSubtree:i,targetInMemoryRecordCache:v.inMemoryRecordCache,addCopyName:(0,fe.Z)(c),deepCopyTransclusionContainers:!1,resolveTemplateVariables:s,transaction:n,useCrdt:v.useCrdt()}),p=d.targetBlock.getType();return p&&Re.W2j(t,{from:"paste",type:p,new_page_id:"page"===p?d.targetBlock.id:void 0}),d})),k=o.multiTextSelection.start.pointerPath,x=o.multiTextSelection.end.pointerPath,I=[],C=[],T=Math.max(k.length,x.length),M=(y[y.length-T]||y[0]).value.store,P=(0,W.MW)({node:o.tree,recordStoreParent:M},(e=>{let{node:t,recordStoreParent:o}=e;const n=((e,t)=>{let o;for(const{originalToDuplicate:n}of w)if(o=n.get(t),o)break;if(o)return Pe.G.createChildStore(e,o)})(o,t.value),r=I.length<k.length?k[I.length]:void 0,i=C.length<x.length?x[C.length]:void 0;let a=!1;if((null==r?void 0:r.id)===t.value.id&&(a=!0,I.push(n)),(null==i?void 0:i.id)===t.value.id&&(a=!0,C.push(n)),!a)return{value:{store:n}};const s=(null==n?void 0:n.getContentStore())||v;return{value:{store:n},children:t.children.map((e=>({node:e,recordStoreParent:s})))}}));if(I.length!==k.length||0===I.length)throw new Error(`Failed to hydrate start path during paste (found ${I.length} of ${k.length})`);if(C.length!==x.length||0===C.length)throw new Error(`Failed to hydrate end path during paste (found ${C.length} of ${x.length})`);const A=I[I.length-1],D=C[C.length-1];if(!A||!D)throw new Error(`Failed to hydrate position during paste (${A?"":"missing start"} ${D?"":"missing end"})`);const R=(0,W.DY)([P],(e=>e.value.store===A)),E=(0,W.DY)([P],(e=>e.value.store===D)),F=R&&E&&G.T.fromNearestCommonAncestor(R,E);if(!F)throw new Error(`Failed to build range for paths: ${R?"":"missing start"} ${E?"":"missing end"}`);Ge.pz({environment:t,multiSelection:s.multiSelection,transaction:n});const N=De.default.state,j="editing"===N.mode?N.multiSelection:s.multiSelection;if((0,me.PF)(d)&&0===o.multiTextSelection.start.textIndex){const e=A.getType();e&&(0,l.Zu)(e)&&Ye.Cj({environment:t,blocks:[d],blockType:e,transaction:n})}let L=0;const U=j.end.store,Z=j.end.index,V=(0,he.mh)(D);if(V){L=q.eeV(V.getValue()).length;const e=(0,Y.TO)((0,he.sQ)(U)),o=(0,Y.TO)((0,he.sQ)(V));oe.Ls({store:U,blockStore:e})&&oe.Ls({store:V,blockStore:o})?te.Wc({sourceBlockStore:e,targetBlockStore:o,splitAtGraphemeIndex:Z,transaction:n,moveIntoNewBlock:!1}):Ge.gc({environment:t,sourceStore:U,sourceIndex:Z,targetStore:V,targetIndex:L,transaction:n})}else Ge.pe({environment:t,transaction:n,store:U,selection:{startIndex:Z,endIndex:1/0}});let z=q.OAI(o.multiTextSelection.start.copiedText);S||(z=q.KV2(z,{currentUserId:t.currentUser.id,currentTimeZone:(0,_.r)()})),Ge.mM({environment:t,index:j.start.index,store:j.start.store,tokens:z,transaction:n});for(const i of F.iterateInsertionAt(y))(0,ge.D_)({transaction:n,treeOperation:i,deleteFrom:"tree-parent"}),H.f.applyMutable(i);if(o.blockSelection.wasContiguousSelection&&o.blockSelection.blocks.length>0&&!d.hasContent())for(const i of A.getContentStores())X.R3({parent:d.getContentStore(),append:i,transaction:n});const K=new Set;for(const{originalToDuplicate:i}of w){const e=i.getByTable(O.iU);for(const{value:t}of e){if(!t||K.has(t.id))continue;K.add(t.id);const e=Pe.G.createChildStore(A,t);(0,pe.qA)(e).find((e=>e.id===v.id))||(e.id,A.id,Ze.YM({childStore:e,parentStore:v,alive:!1,transaction:n}))}}return i.default.afterNextFlush((()=>{const e=(0,ge.kC)({rootStore:v,root:g,target:F.end}),t=e&&(0,he.mh)(e[e.length-1]);if(!t)return;const o={start:{index:a?j.start.index:L,store:a?j.start.store:t},end:{index:L,store:t}};Ke.NA({multiSelection:o})})),!0}function Rt(e){const{environment:t,blocks:o,transaction:n,replaceEmptyTextBlock:r}=e,i=Ae.default.state.stores;if(1===i.length){const e=i[0];if(e.getType()&&e.isType(l.hY)&&function(e){if("editing"!==De.default.state.mode||!De.default.state.multiSelection)return!1;const t=(0,ce.QY)(De.default.state.multiSelection);if(!t)return!1;return t.store===e.getTitleStore()}(e)){const r=e.getContentStore(),i=C.d9(o).reverse().map((e=>X.Ce({parent:r,prepend:e,transaction:n}).child));return ze.Z5({environment:t,stores:i}),i}}return qe.is({selection:i,environment:t,blocks:o,transaction:n,replaceEmptyTextBlock:r})}function Et(e,t,o,n){const r=(0,re.RM)();if(!r)return;const a=Ae.default.state.stores,s=0!==a.length?a[0].pointer.spaceId:r.pointer.spaceId,c=0!==a.length?a[0].useCrdt():r.useCrdt();let d=function(e,t){if("cut"!==t.action||!Ce.default.checkGate("convert_cut_paste_to_move"))return;const o=[];for(const n of t.blocks){const t=Pe.G.createChildStore(e,{table:O.iU,id:n.blockId});if(!t.isReady())return;const r=t.getModel();if(!r)return;if(r.getSpaceId()!==e.getSpaceId())return;if(!1!==r.alive)return;o.push(t)}return o}(r,t);d||(d=t.blocks.map((t=>{var o;let{blockId:i,blockSubtree:a,snapshotData:l}=t;const d=Pe.G.createChildStore(r,{table:O.iU,id:i});let p;if(d.isDefined())p=d.getModel();else{const e=null==a?void 0:a.getValue({table:O.iU,id:i});p=e&&M.kk.fromBlock(e)}const u=!(r.isInsideTemplate()||$t()||r.isInsideFactoryOrDuplicateBlocksAction()||null!==(o=p)&&void 0!==o&&o.isTemplateVariableContainerBlock());if(a){const t=Oe.E9({environment:e,sourceBlockId:i,targetBlockPointer:{table:O.iU,spaceId:s,id:(0,B.ZP)()},sourceBlockSubtree:a,targetInMemoryRecordCache:d.inMemoryRecordCache,addCopyName:(0,fe.Z)(d),deepCopyTransclusionContainers:!1,resolveTemplateVariables:u,transaction:n,useCrdt:c}).targetBlock,o=t.getType();return o&&Re.W2j(e,{from:"paste",type:o,new_page_id:"page"===o?t.id:void 0}),t}{Ie.Z.state.online||je.showErrorMessage(le.default.formatMessage(Je.offlineError));const[t,o]=Oe.WJ({environment:e,sourceBlocks:[{id:i,spaceId:(0,Z.C)(void 0)}],targetInMemoryRecordCache:d.inMemoryRecordCache,addCopyName:(0,fe.Z)(d),transaction:n,deepCopyTransclusionContainers:!1,resolveTemplateVariables:u,snapshotData:l,targetSpaceId:(0,Z.C)(s),convertExternalObjectInstancesToPlaceholders:!1,useCrdt:c}),r=t[0],a=r.getType();return o.then((t=>{t?je.showErrorMessage(t):a&&Re.W2j(e,{from:"paste",type:a,new_page_id:"page"===a?r.id:void 0})})),r}}))),Rt({environment:e,blocks:d,transaction:n,replaceEmptyTextBlock:!0});const p=Ae.default.state.stores,u=p.length>0?p:[r],m=t.blocks.map((e=>{const t=u.length>0?u[0]:function(e){return e.isCollectionView()?e.getCollectionViewCollectionStore()||e:e.getContentStore()}(r);return Pe.G.createChildStore(t,{table:O.iU,id:e.blockId})}));i.default.afterNextFlush((async()=>{await Promise.all(u.map((e=>e.waitUntil((()=>{const t=e.getType();return Boolean(t&&t!==l.Ti.copyIndicator)}))))),await Promise.all(m.map((e=>e.load()))),o&&Ee.RH({environment:e,blocks:u,pageSource:o,copiedStores:m,action:t.action,wasContiguousSelection:t.wasContiguousSelection,rootStore:r})&&Ee.kE({copiedStores:m,blocks:u,pageSource:o})}))}function Ft(e){const{environment:t,disableEmbedMenu:o,transaction:n,overwrite:r,selectAll:i,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c=e.text.trim(),d=c.includes("\n"),p=De.default.state,u=Ht(p);d&&"inline"!==u||"editing"!==p.mode?r?function(e){const{environment:t,text:o,transaction:n,selectAll:r,markdownOptions:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e,l=wt({markdown:o,markdownOptions:i,markdownLinkifyIt:a});if(!l)return;let c=jt({html:l,wrapInEmptyBlocks:!1,tinyMceMicrosoftWordPasteFilter:s});c||(c=jt({html:l,wrapInEmptyBlocks:!0,tinyMceMicrosoftWordPasteFilter:s}));if(!c)return;Bt({environment:t,clipboardData:c,transaction:n,allowPasteIntoHeaderWithoutChildren:!0,selectAll:r})}({environment:t,text:c,transaction:n,selectAll:i,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}):c&&function(e){const{environment:t,text:o,transaction:n,markdownOptions:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}=e,s=wt({markdown:o,markdownOptions:r,markdownLinkifyIt:i});if(s)Ut({environment:t,html:s,transaction:n,tinyMceMicrosoftWordPasteFilter:a})}({environment:t,text:c,transaction:n,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}):function(e){const{environment:t,text:o,disableEmbedMenu:n,transaction:r,selectAll:i,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c="editing"===De.default.state.mode&&De.default.state.multiSelection;if(c){const e=(0,ce.QY)(c);if(e&&function(e){const t=De.default.state;return"editing"===t.mode&&!(0,ce.iG)(t.multiSelection)&&(0,ce.qS)(t.multiSelection)&&I.B(e,"url")}(o))Yt({environment:t,text:o,transaction:r,editingSelection:e,selectAll:i});else if((0,be.Ld)("c"))Ge.hJ({environment:t,multiSelection:c,string:o,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0,transaction:r,selectAll:i});else{const e=s&&T.lM({...s,markdown:o,plugin:null==a?void 0:a.plugin});if(!e)return;Lt({environment:t,html:e,transaction:r,stripText:!0,disableEmbedMenu:n,selectAll:i,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l})}}}({environment:t,text:c,disableEmbedMenu:o,transaction:n,selectAll:i,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l})}function Nt(e,t){const o=e.getValue({table:O.iU,id:t});if(!o)return;const n={table:O.iU,id:t,spaceId:o.space_id},r=(o.content??[]).map((t=>Nt(e,t))).filter(K.$K);return new W.mp(n,r)}function jt(e){var t,o,n,r;const{html:i,wrapInEmptyBlocks:a,tinyMceMicrosoftWordPasteFilter:s}=e,l=Vt({html:i,tinyMceMicrosoftWordPasteFilter:s,useCrdt:!1});if(!l)return;let{allOperations:c,rootContentIds:d}=l;if(a){const e=Zt(),t=Zt();if(!e||!t)return;c=[e.operation,...c,t.operation],d=[e.id,...d,t.id]}const p=E.Ak.create();(0,A.FS)({recordMap:p,operations:c,updateOnly:!1});const u=[];for(const _ of d)u.push({blockId:_,snapshotData:void 0,blockSubtree:p.clone()});const m=new W.mp({table:O.iU,id:(0,B.ZP)(),spaceId:void 0},d.map((e=>Nt(p,e))).filter(K.$K));if(0===m.children.length)return;const g=m.children[0],h=null===(t=(0,W.DY)([m],(e=>e===g)))||void 0===t?void 0:t.map((e=>e.value)),f=null===(o=p.getValue(g.value))||void 0===o||null===(o=o.properties)||void 0===o?void 0:o.title,y=(0,W.CY)(m),v=null===(n=(0,W.DY)([m],(e=>e===y)))||void 0===n?void 0:n.map((e=>e.value)),b=null===(r=p.getValue(y.value))||void 0===r||null===(r=r.properties)||void 0===r?void 0:r.title,S=b?q.QaF(b).length:0;return f&&h&&b&&v?{blockSelection:{blocks:u,wasContiguousSelection:!0,action:"copy"},tree:m,multiTextSelection:{start:{textIndex:0,copiedText:f,attributePath:["properties","title"],pointerPath:h},end:{textIndex:S,copiedText:b,attributePath:["properties","title"],pointerPath:v}},action:"copy"}:void 0}function Ot(e){const{text:t,html:o,stripText:n,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:i}=e,a=o||(t?wt({markdown:t,markdownLinkifyIt:r}):void 0);if(!a)return;const s=document.createElement("div");return s.innerHTML=zt({html:a,tinyMceMicrosoftWordPasteFilter:i}),w.xR({node:s,window,stripText:n,emojiData:ne.Z.state})}function Lt(e){const{environment:t,html:o,transaction:n,stripText:r,disableEmbedMenu:i,selectAll:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c="editing"===De.default.state.mode&&De.default.state.multiSelection;if(c){const e=Ot({html:o,stripText:r,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l});if(!e)return;const d=1===e.length;if(d){if(d&&(!e[0][1]||0===e[0][1].length)){const o=e[0][0];return void Ge.hJ({environment:t,multiSelection:c,string:o,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:n,selectAll:a})}const o=(0,ce.QY)(c);if(o&&!(0,ce.iG)(c)){const[,r]=e[0],i=r&&q.rlz(r);if(i){return void Yt({environment:t,text:q.zW$(i),transaction:n,editingSelection:o,selectAll:a})}}}Ge.pz({environment:t,multiSelection:c,transaction:n}),At({environment:t,store:c.start.store,tokens:e,index:c.start.index,transaction:n,disableEmbedMenu:i,multiTextSelection:c,selectAll:a})}}function Ut(e){const{environment:t,html:o,transaction:n,tinyMceMicrosoftWordPasteFilter:r}=e,a=re.RM();if(!a)return;const s=Vt({html:o,tinyMceMicrosoftWordPasteFilter:r,useCrdt:a.useCrdt()});if(!s)return;const{allOperations:c,rootContentIds:d}=s;for(const i of c){const e=(0,Pe.Kv)(a,i.pointer);$e.applyOperation({store:e,operation:i,transaction:n})}const p=d.map((e=>Pe.G.createChildStore(a,{table:O.iU,id:e})));p.forEach((e=>{const o=e.getType();o&&Re.W2j(t,{from:"paste",type:o})}));const u=Rt({environment:t,blocks:p,transaction:n,replaceEmptyTextBlock:!0}).slice().reverse();return i.default.afterNextFlush((()=>{const e=u.map((e=>{if(e.getType()!==l.Ti.text)return;const o=Dt(e.getTitleValue());if(!o)return;const n=(0,j.Wj)({url:o.url,baseUrl:ee.default.domainBaseUrl,publicDomainName:ee.default.publicDomainName,isMobile:t.device.isMobile,protocol:ee.default.protocol,currentUrl:window.location.href});return"page"===n.name?n:void 0})).filter(K.$K);e.length===u.length&&Ee._x({environment:t,rootStore:a,blocks:u,copiedLinks:e})})),p}function Zt(){const e=(0,B.ZP)(),{currentUserStore:t}=ke.default.state,o=re.RM();if(!t||!o)return;const n=t.id;if(!n)return;const r=o.id,i=o.pointer.spaceId;return{operation:{pointer:{table:"block",id:e,spaceId:i},command:"set",path:[],args:{id:e,version:1,type:"text",properties:{title:[[""]]},parent_id:r,parent_table:"block",space_id:i,created_by_table:"notion_user",created_by_id:n,created_time:Date.now(),last_edited_by_table:"notion_user",last_edited_by_id:n,last_edited_time:Date.now(),alive:!0}},id:e}}function Vt(e){const{useCrdt:t,...o}=e,n=document.createElement("div");n.innerHTML=zt(o);const{currentUserStore:r}=ke.default.state,i=re.RM();if(!r||!i)return;const s=r.getValue();if(!s)return;const l=w.$O({actor:(0,a.dp)(s),parentId:i.id,parentTable:"block",spaceId:i.pointer.spaceId,rootNode:n,importFileMap:{},window,secureFileS3Url:ee.default.secureFileS3.url,secureFileS3UrlV2:ee.default.secureFileS3V2.url,ignoreBlockCount:!1,intl:le.default.getIntl(),randomID:B.ZP,randomShortID:R.ZP,isPhoneNumber:Wt,emojiData:ne.Z.state});if(!t)return l;const{allOperations:c,rootContentIds:d}=l;return{allOperations:c.map((e=>{var t;if(e.pointer.table!==O.iU||"set"!==e.command&&"update"!==e.command)return e;if(e.path.length>0)throw new Error("Block operation should modify root record.");if(null===(t=e.args.properties)||void 0===t||!t.title)return e;const o=C.Xh(e);return o.args.format={...o.args.format,...p.K(e.args.id,e.args.properties.title)},o})),rootContentIds:d}}function qt(e){return/schemas-microsoft-com:office/.test(e)||/xmlns:m="http:\/\/schemas.microsoft.com\/office\/2004\/12\/omml"/.test(e)}function zt(e){const{html:t,tinyMceMicrosoftWordPasteFilter:o}=e;return r().sanitize(o&&qt(t)?o(t):t)}function Wt(e){return/^(\+\d{1,2}\s)?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}function Ht(e){const t="editing"===e.mode&&e.multiSelection;if(!t)return;const o=Se.E.findEditableWithStore(t.start.store),n=null==o?void 0:o.props;return n&&!n.disabled?n.pasteBehavior:void 0}function Gt(){if("editing"!==De.default.state.mode)return;const e=De.default.state.multiSelection.start,t=e.store.path;if("formula"!==t[t.length-1])return;const o=e.store.getRecordStoreAtRootPath();if(o.table!==O.iU)return;const n=o.getParentId();if(!n)return;const r={table:L.v,id:n,spaceId:o.getSpaceId()},i=o.getRecordModel(r);return i?{parentCollection:i,start:e,getRecordModel:o.getRecordModel}:void 0}function Kt(){if("editing"!==De.default.state.mode)return!1;const e=(0,ce.QY)(De.default.state.multiSelection);if(!e)return!1;if(!e.store.isTable(O.iU))return!1;if(0===Ae.default.state.stores.length)return!1;const t=e.store.getRecordStoreAtRootPath().getValue();return Boolean(t&&t.type===l.Ti.code)}function $t(){const e=Ae.default.state.stores;if("editing"!==De.default.state.mode)return e.length>0&&e[0].isInsideFactoryOrDuplicateBlocksAction();if(0===e.length)return!1;const{multiSelection:t}=De.default.state,o=t.start.store;if(!o.isTable(O.iU))return!1;const n=ae.W(o);return Boolean(n)}function Yt(e){const{text:t,transaction:o,environment:n,editingSelection:r,selectAll:i}=e,a=(0,j.Wj)({url:t,baseUrl:ee.default.domainBaseUrl,publicDomainName:ee.default.publicDomainName,isMobile:n.device.isMobile,protocol:ee.default.protocol,currentUrl:window.location.href}),s="page"===a.name?(0,k.nR)({pageId:a.blockId,peekViewBlockId:a.peekViewBlockId,peekMode:a.peekMode,discussionId:a.discussionId,scrollToBlockId:a.scrollToBlockId,collectionViewId:a.collectionViewId}):t;Ge.Be({environment:n,store:r.store,selection:r.selection,type:"a",transaction:o}),Ge.i8({environment:n,store:r.store,selection:r.selection,annotation:["a",s],transaction:o}),Ke.Z5({store:r.store,selection:{startIndex:i?r.selection.startIndex:r.selection.endIndex,endIndex:r.selection.endIndex}})}const Qt=/\<\!-- wp:/;const Jt=/\u2028/g;function Xt(e){const{environment:t,event:o,disableEmbedMenu:n,transaction:r,onPasteFiles:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e;if(o.preventDefault(),Ke.Zk(t),!o.clipboardData)return;if(!Be.M_(t))return;const c=yt(o.clipboardData,t.device),{text:d,html:p,multiTextSelectionData:u,textSelectionData:g,blockSelectionData:h,isFromMicrosoftOffice:f}=St({clipboardData:c,tinyMceMicrosoftWordPasteFilter:s}),y=bt(c,rt,dt),b=function(e){return e.clipboardData?e.clipboardData.items?C.oA(C.UI(e.clipboardData.items,(e=>{const t=e.getAsFile();if(t&&t.size>0)return new File([t],"Untitled",{type:e.type})}))):m.p4(e.clipboardData.files):[]}(o),S=Ht(De.default.state),w=(null==h?void 0:h.action)||(null==u?void 0:u.action)||(null==g?void 0:g.action);r.annotateWithUserAction("cut"===w?"paste.from_cut":ie.xF);const k=d.includes("\n"),x=function(e){const t=bt(e,it,pt),o=null==t?void 0:t.mode;if(!o)return;return et[o]||"Plain Text"}(c),I=k&&x&&"inline"!==S&&!Kt()?function(e){const{codeLanguage:t,environment:o,transaction:n}=e,r=De.default.state,i="editing"===r.mode&&r.multiSelection,a=Ae.default.state.stores;if(!i&&0===a.length)return;let s,c,d;i?(s=i.start.store,c=i.end.store,d=(0,he.sQ)(c)):(s=a[0],c=a[a.length-1],d=c);if(!d)return;let p=d;if((0,me.PF)(d))!function(e){const{block:t,environment:o,transaction:n,codeLanguage:r}=e;Ye.Cj({environment:o,blocks:[t],blockType:"code",transaction:n}),Fe.E5({blocks:[t],language:r,transaction:n})}({block:d,environment:o,transaction:n,codeLanguage:t});else{const e=(0,he.sQ)(d);if(!e)return;const t=s.inMemoryRecordCache;if(!t)return;p=Ve.j4({environment:o,type:l.Ti.code,inMemoryRecordCache:t,transaction:n,spaceId:e.pointer.spaceId,useCrdt:e.useCrdt()}),X.BE({parent:e.getContentStore(),after:c,insert:p,transaction:n})}ve.clear(o);const u=(0,he.mh)(p);u&&Ke.N_({store:u});return p}({codeLanguage:x,environment:t,transaction:r}):void 0;Re.bOx(t,{pastedText:d,source:"editor_paste"});const T=we.g$.getSimpleTableCellFromTextSelection(),M=o.clipboardData.getData(ye.mH),P=Gt();if(!f&&b.length>0)i({environment:t,files:b,transaction:r});else if(Kt()&&!g)eo(t,d,r);else if(I)eo(t,d,r);else if(P){const{parentCollection:e,start:o}=P,n=[[d]],i=e;if(!i)return void eo(t,d,r);const a=De.default.state;"multiSelection"in a&&Ge.pz({environment:t,multiSelection:a.multiSelection,transaction:r});const s=(0,v.UQ)(n,i,P.getRecordModel);Ge.mM({environment:t,tokens:s,store:o.store,index:o.index,transaction:r})}else if(u){(function(e){const{environment:t,transaction:o,multiTextSelectionData:n,disableEmbedMenu:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}=e,s=e.pasteBehavior||"inline",l=e.html||wt({markdown:e.text,markdownLinkifyIt:i});if("editing"===De.default.state.mode)switch(s){case"inline":return!!l&&(Lt({environment:t,html:l,transaction:o,stripText:!1,disableEmbedMenu:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}),!0);case"block":return Bt({environment:t,clipboardData:n,transaction:o});default:(0,K.t1)(s)}})({multiTextSelectionData:u,environment:t,html:p,text:d,transaction:r,disableEmbedMenu:n,pasteBehavior:S,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s})||Et(t,u.blockSelection,y,r)}else if(g&&g.editing)!function(e){const{environment:t,textSelectionData:o,transaction:n,disableEmbedMenu:r}=e,i=Ae.default.getCurrentRecordCache(),{editing:a,selection:s}=o;let{tokensInsideRange:c}=q.xrQ(a,s.startIndex,s.endIndex);c=q.OAI(c);const d=(0,re.RM)();if(d&&!(d.isInsideTemplate()||$t()||d.isInsideFactoryOrDuplicateBlocksAction())&&(c=q.KV2(c,{currentUserId:t.currentUser.id,currentTimeZone:(0,_.r)()})),Kt()){const e=q.vNd(c);e&&(c=e)}const p="editing"===De.default.state.mode&&De.default.state.multiSelection;if(p){Ge.pz({environment:t,multiSelection:p,transaction:n});const e=De.default.state;if("editing"===e.mode){const i=e.multiSelection;if(o.blockType&&0===s.startIndex){const e=(0,he.sQ)(i.start.store);e&&"page"!==o.blockType&&(0,me.PF)(e)&&Ye.Cj({environment:t,blocks:[e],blockType:o.blockType,transaction:n})}At({environment:t,store:i.end.store,tokens:c,index:i.end.index,transaction:n,disableEmbedMenu:r,multiTextSelection:p})}}else if(i){var u,m;const e=Ae.default.state.stores,o=Ve.j4({environment:t,type:l.Ti.text,inMemoryRecordCache:i,transaction:n,spaceId:0!==e.length?e[e.length-1].pointer.spaceId:null===(u=re.RM())||void 0===u?void 0:u.pointer.spaceId,useCrdt:0!==e.length?e[e.length-1].useCrdt():(null===(m=re.RM())||void 0===m?void 0:m.useCrdt())??!1}),r=o.getTitleStore();r&&Ge.mM({environment:t,store:r,tokens:c,index:0,transaction:n}),Re.W2j(t,{from:"paste",type:l.Ti.text}),Rt({environment:t,blocks:[o],transaction:n,replaceEmptyTextBlock:!1})}}({environment:t,textSelectionData:g,transaction:r,disableEmbedMenu:n});else if(h&&h.blocks.length>0&&"inline"!==S)Et(t,h,y,r);else if(T&&M){const{simpleTableStore:e,selection:n}=T.props,i=we.g$.getColumnOrder(e);n&&i&&He.j0({environment:t,simpleTableStore:e,selection:n,currentRows:e.getContentStores(),columnOrder:i,event:o,transaction:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s})}else if(p)if(T){const{simpleTableStore:e,selection:n}=T.props,i=we.g$.getColumnOrder(e);n&&i&&He.j0({environment:t,simpleTableStore:e,selection:n,currentRows:e.getContentStores(),columnOrder:i,event:o,transaction:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s})}else k&&"inline"!==S?Ut({environment:t,html:p,transaction:r,tinyMceMicrosoftWordPasteFilter:s}):Lt({environment:t,html:p,transaction:r,stripText:!1,disableEmbedMenu:n,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s});else Ft({environment:t,text:d,disableEmbedMenu:n,transaction:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s});Me.Z.setKeyboardMode(!0)}function eo(e,t,o){const n="editing"===De.default.state.mode&&De.default.state.multiSelection;n&&Ge.hJ({environment:e,multiSelection:n,string:t,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o})}function to(e){const t=e.isType(l.Ti.alias)?e.getAliasTargetStore():e;if(t){if(!(t instanceof Pe.G)){const e=pe.uJ(t)[0],o=t.getRecordStoreUIParent();if(e&&!(e instanceof Pe.zX)&&o)return(0,se.Hu)({store:e,scrollToBlockId:o.id,fullyQualified:!0,pageVisitSource:s.tY.CopyLink});const n=t.getValue();if(!n)return;const r=(0,Pe.Kv)(t,{table:n.parent_table,id:n.parent_id,spaceId:n.space_id}).getValue();if(!r)return;const i=Pe.G.createChildStore(t,{table:O.iU,id:r.parent_id}),a=i.getNavigableBlockStore();if(!a)return;return(0,se.Hu)({store:a,scrollToBlockId:i.id===t.id?void 0:t.id,fullyQualified:!0,pageVisitSource:s.tY.CopyLink})}{const e=t.getNavigableBlockStore();if(e)return(0,se.Hu)({store:e,scrollToBlockId:e.id===t.id?void 0:t.id,fullyQualified:!0,pageVisitSource:s.tY.CopyLink})}}}function oo(e){const{environment:t,blocks:o}=e,n=o[0];Ne.wG(),we.HM.clearSelection();const r=to(n);if(r){so({environment:t,stringValue:r,copiedMessage:n.isPageBlock()?Xe.copiedLinkToClipboard:Xe.copiedBlockLinkToClipboard})}}function no(e){const{environment:t,blocks:o}=e,n=o[0];Ne.wG(),we.HM.clearSelection();const r=to(n),i=function(e,t){var o;const n=to(t);if(!n)return;const r=e.currentUser.id,i=(0,h.Ho)({blockId:t.id,intl:le.default.getIntl(),getRecordValue:t.inMemoryRecordCache.makeGetRecordValueFn(r),userTimeZone:(0,_.r)()}),a=null===(o=t.getBlockIconStore())||void 0===o?void 0:o.getValue(),s=[(0,x.Z)(a)?a:void 0,i].filter(K.$K).join(" ");return s?`<a href="${n}"><span>${s}</span></a>`:n}(t,n);if(r&&i){ao({environment:t,stringValue:r,htmlValue:i,copiedMessage:Xe.copiedLinkToClipboard})}}function ro(e){const{environment:t,blocks:o}=e;if(o.length<2)return oo(e);Ne.wG(),we.HM.clearSelection();const n=o.map(to).filter(K.$K);if(n.some(Boolean)){const e=n.length>1?Xe.copiedLinksToClipboard:Xe.copiedLinkToClipboard;so({environment:t,stringValue:n.join("\n\n"),copiedMessage:e})}}function io(e){const{environment:t,blocks:o}=e,n=o[0];if(!n.isDefined())return;const r=n.getModel(),i=n.getProperties(),a=n.getFormat();let s;if(n.isType(l.Ti.bookmark))s=null==i?void 0:i.link,s=q.QaF(s);else if(r.isType(l.Ok))s=null==i?void 0:i.source,s=q.QaF(s);else if(n.isType(l.Ti.file))s=null==i?void 0:i.source,s=q.QaF(s);else if(n.isType(l.Ti.externalObjectInstance)||n.isType(l.Ti.externalObjectInstancePage))s=(null==a?void 0:a.original_url)||(null==a?void 0:a.uri);else if(n.isType(l.Ti.collectionView)){var c;const e=null===(c=n.getCollectionViewCollectionStore())||void 0===c?void 0:c.getValue();var d;if(e&&(0,f.Gq)(e))s=null===(d=e.format)||void 0===d?void 0:d.original_url}else{if(!n.isType(l.Ti.alias))return;s=null==a?void 0:a.comment_alias_url}if(!s)return;if(y.E$(s,[ee.default.secureFileS3.url,ee.default.secureFileS3V2.url]))return void b.log({level:"error",from:"clipboardActions",type:"copyDirectLinkToContent",error:{message:"Attempted to copy a direct signed url for S3-housed content."}});if(s=$.yn(s),!s)return;Ne.wG(),we.HM.clearSelection();so({environment:t,stringValue:s,copiedMessage:Xe.copiedLinkToClipboard})}function ao(e){return lo(e)}function so(e){return lo(e)}async function lo(e){const{environment:t,htmlValue:o,stringValue:n,copiedMessage:r,showCopyModal:i}=e;function a(){ze.ZH(t),xe.Z.setState({...xe.Z.state,active:!0,stringValue:n})}if(i)a();else try{if("undefined"==typeof ClipboardItem)await navigator.clipboard.writeText(n);else{const e={"text/plain":new Blob([n],{type:"text/plain"})};o&&(e["text/html"]=new Blob([o],{type:"text/html"}));const t=new ClipboardItem(e);await navigator.clipboard.write([t])}We.oV({label:le.default.formatMessage(r)})}catch{a()}}function co(){document.queryCommandSupported("copy")&&document.execCommand("copy")}async function po(e,t){let o;o="string"==typeof t?t:JSON.stringify(t),o&&await so({environment:e,stringValue:o,copiedMessage:Xe.copiedToClipboard})}function uo(e){const{environment:t,textSelection:o,markdownSerializationOptions:n,markdownLinkifyIt:r}=e,i=(0,ce.QY)(o);if(i&&i.selection.startIndex!==i.selection.endIndex)return function(e){const{environment:t,singleStoreTextSelection:o,markdownSerializationOptions:n}=e,{store:r,selection:i}=o,a=t.currentUser.id,l=r.inMemoryRecordCache,c=le.default.getIntl(),d=r.getValue(),p=q.KU1(d,i.startIndex,i.endIndex),m=r.getRecordStoreUIRoot().getValue();if(!m)return;const g={id:m.id,table:O.iU,spaceId:m.space_id},h=l.makeGetRecordValueFn(a);return T.CK({textValue:p,exportArgs:{root:g,navigableBlockId:g.id,renderParentBlockId:void 0,blockId:g.id,userTimeZone:(0,_.r)(),intl:c,getRecordValue:h,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,u.Z)({pageId:t,pageValue:h({table:O.iU,id:t}),baseUrl:ee.default.domainBaseUrl,pageVisitSource:s.tY.Export})},baseUrl:ee.default.domainBaseUrl,publicDomainName:ee.default.publicDomainName,transformAnnotation:null==n?void 0:n.transformAnnotation,transformBlockMapping:null==n?void 0:n.transformBlockMapping,resultCache:new Map}})}({environment:t,singleStoreTextSelection:i,markdownSerializationOptions:n});const a=It({environment:t,multiSelection:o,action:"copy"});if(!a)return;const l=o.start.store.inMemoryRecordCache,c=o.start.store.getRecordStoreUIRoot().getValue();if(!c)return;const d=t.currentUser.id,{markdown:p}=(0,ie.Ef)({clipboardData:a,rootBlock:{id:c.id,table:O.iU,spaceId:c.space_id},isWindows:t.device.isWindows,fallbackGetRecordValue:l.makeGetRecordValueFn(d),markdownSerializationOptions:n,markdownLinkifyIt:r});return p}function mo(e){const{environment:t,inMemoryRecordCache:o,text:n,transaction:r,markdownOptions:i,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c=wt({markdown:n,markdownOptions:i,markdownLinkifyIt:s});if(!c)return;const d=document.createElement("div");d.innerHTML=zt({html:c,tinyMceMicrosoftWordPasteFilter:l});const{currentUserStore:p,currentSpaceStore:u}=ke.default.state;if(!p||!u)return;const m=p.getValue();if(!m)return;const g=(re.RM()??u).id,{allOperations:h,rootContentIds:f}=w.$O({actor:(0,a.dp)(m),parentId:g,parentTable:"block",spaceId:u.id,rootNode:d,importFileMap:{},window,secureFileS3Url:ee.default.secureFileS3.url,secureFileS3UrlV2:ee.default.secureFileS3V2.url,ignoreBlockCount:!1,intl:le.default.getIntl(),randomID:B.ZP,randomShortID:R.ZP,isPhoneNumber:Wt,emojiData:ne.Z.state});for(const a of h){const e=new Pe.ST({environment:t,pointer:a.pointer,inMemoryRecordCache:o,userId:m.id});$e.applyOperation({store:e,operation:a,transaction:r})}return f.map((e=>new Pe.G(t,{table:O.iU,id:e},{inMemoryRecordCache:o})))}function go(e){const{environment:t,stores:o,inMemoryRecordCache:n,transaction:r}=e,i=new Pe.ST({environment:t,pointer:{table:O.iU,id:(0,B.ZP)()},inMemoryRecordCache:n,userId:t.currentUser.id,path:["content"]});for(const a of o)X.R3({parent:i,append:a,transaction:r}),Ve.sW({store:a,data:{parent_id:i.id,parent_table:i.table,alive:!0},transaction:r});return i}},42274:(e,t,o)=>{o.d(t,{Cn:()=>d,pZ:()=>c,E5:()=>l});const n={TypeScript:async()=>({plugins:[(await o.e(8182).then(o.t.bind(o,90119,23))).default],parser:"babel"}),JavaScript:async()=>({plugins:[(await o.e(8182).then(o.t.bind(o,90119,23))).default],parser:"babel"}),GraphQL:async()=>({plugins:[(await o.e(214).then(o.t.bind(o,80214,23))).default],parser:"graphql"}),HTML:async()=>({plugins:[(await o.e(2237).then(o.t.bind(o,72237,23))).default],parser:"html"}),CSS:async()=>({plugins:[(await o.e(5657).then(o.t.bind(o,45657,23))).default],parser:"css"}),Scss:async()=>({plugins:[(await o.e(5657).then(o.t.bind(o,45657,23))).default],parser:"scss"}),JSON:async()=>({plugins:[(await o.e(8182).then(o.t.bind(o,90119,23))).default],parser:"json"}),XML:async()=>({plugins:[await Promise.all([o.e(9236),o.e(4219)]).then(o.t.bind(o,84219,23))],parser:"xml",prettierOptionsOverride:{xmlWhitespaceSensitivity:"ignore"}}),Rust:async()=>({plugins:[await Promise.all([o.e(9236),o.e(6484)]).then(o.bind(o,73411))],parser:"jinx-rust"}),SQL:async()=>({plugins:[await Promise.all([o.e(3945),o.e(886)]).then(o.bind(o,80886))],parser:"sqlite"})};var r=o(70203),i=o(96802),a=o(9953),s=o(39699);function l(e){const{blocks:t,language:o,transaction:n}=e,i=r.TPx(o);for(const r of t)a.sW({store:r.getPropertiesStore(),data:{language:i},transaction:n})}function c(e){const{environment:t,blocks:o,previewFormat:n}=e;s.createAndCommit({userAction:"codeBlockActions.setPersistedCodePreviewFormat",environment:t,perform:e=>{i.FH({stores:o,update:{code_preview_format:n},transaction:e})}})}async function d(e){const{codeBlock:t,environment:i}=e,{title:l,language:c}=t.getProperties(),d=r.QaF(l);if(!d||0===d.length)return;const p=r.QaF(c),u=await async function(e){const{codeSnippet:t,language:r}=e,i=n[r];if(!i)return;const{parser:a,plugins:s,prettierOptionsOverride:l}=await i();let c="";try{c=(await o.e(3945).then(o.t.bind(o,73945,23))).format(t,{parser:a,plugins:s,...l})}finally{if(!c||c===t)return}return c=function(e){const t=e.split("\n");return t.length>0&&""===t[t.length-1].trim()&&t.pop(),t.join("\n")}(c),c}({codeSnippet:d,language:p});if(!u)return;const m=r.TPx(u);s.createAndCommit({userAction:"codeBlockActions.formatCode",environment:i,perform:e=>{a.sW({store:t.getPropertiesStore(),data:{title:m},transaction:e})}})}},74882:(e,t,o)=>{o.d(t,{K:()=>a});var n=o(68626),r=o(6287),i=o(54642);async function a(e){const{environment:t,collectionStore:o}=e,a={id:o.id,table:r.v,spaceId:o.getSpaceId()},s=await i.suggestRecordKey(t,{...a,shouldSetSuccessfullySuggestedRecord:!0});if("success"===s.type)return s.data.key;n.log({level:"error",from:"collectionAutoIncrementIdActions.suggestRecordKeyResponse",type:"JSONParseError",error:{miscDataString:s.error.message}})}},40778:(e,t,o)=>{o.d(t,{mO:()=>w,Ys:()=>k,k7:()=>x,ul:()=>M,iU:()=>I,RD:()=>T,_x:()=>C});o(67294);var n=o(1302),r=o(76205),i=o(14714),a=o(72126),s=o(97880),l=o(64964),c=o(480),d=o(5366),p=o(82007),u=o(6854),m=o(85893);function g(){return(0,m.jsx)(d.FormattedMessage,{defaultMessage:"Changes saved for everyone.",id:"database.filterBar.saved.title"})}function h(e){window.__c={n:"SaveChangesSnackbarUndoButton"};const{collectionContextStore:t,temporaryState:o}=e,n=(0,c.O7)();return(0,m.jsx)(u.Pn,{onClick:()=>{p.Yw(n,!0),l.rN(),I({environment:n,collectionContextStore:t,temporaryState:o})},children:(0,m.jsx)(d.FormattedMessage,{defaultMessage:"Undo",id:"database.filterBar.undo.title"})})}var f=o(97004),y=o(80444),v=o(5149),b=o(45264),S=o(39699),_=o(37181);let w=function(e){return e[e.All=0]="All",e[e.Filters=1]="Filters",e[e.Sorts=2]="Sorts",e}({});function k(e){const{environment:t,collectionContextStore:o,targetCollectionView:n,preventSnackbarNotification:r,type:i,transaction:a}=e,s=o.temporaryState.state,c=o.currentPropertyFiltersStore.state,d=n.getPropertyFiltersStore(),p=(0,f.Zh)(o,"persisted");if(i===w.All||i===w.Filters){p.combinatorFilter&&b.Es({collectionViewStore:n,update:{filter:p.combinatorFilter.value||null},transaction:a});for(const e of p.filters.removed)S.applyOperation({store:d,operation:{pointer:d.pointer,command:"keyedObjectListRemove",path:d.path,args:{remove:{id:e}}},transaction:a});for(const{id:e,beforeId:t}of p.filters.moveOps){const o=c.find((t=>t.id===e));o&&(t?S.applyOperation({store:d,operation:{pointer:d.pointer,command:"keyedObjectListBefore",path:d.path,args:{before:{id:t},value:o}},transaction:a}):S.applyOperation({store:d,operation:{pointer:d.pointer,command:"keyedObjectListAfter",path:d.path,args:{value:o}},transaction:a}))}for(const e of p.filters.updated){const t=c.find((t=>t.id===e));t&&S.applyOperation({store:d,operation:{pointer:d.pointer,command:"keyedObjectListUpdate",path:d.path,args:{value:t}},transaction:a})}}i!==w.All&&i!==w.Sorts||!p.sorts||b.Es({collectionViewStore:n,update:{sort:p.sorts.value||null},transaction:a}),C({environment:t,collectionContextStore:o,temporaryState:i===w.All?void 0:i===w.Filters?{...s,combinatorFilter:void 0,propertyFilters:void 0}:{...s,sorts:void 0}}),r||l.oV({label:(0,m.jsx)(g,{}),right:(0,m.jsx)(h,{collectionContextStore:o,temporaryState:s})})}function x(e){const{environment:t,intl:o,collectionContextStore:r,transaction:i}=e,a=r.collectionViewStore(),s=r.isFullScreen.state,l=r.isRootChild.state,c=r.isInPeekRenderer.state;if(!a)return;const d=b.tG({environment:t,collectionContextStore:r,collectionViewStore:a,intl:o,collectionSettingsStore:r.settingsStore,transaction:i});d&&(k({environment:t,type:w.All,collectionContextStore:r,targetCollectionView:d,transaction:i}),d&&(b.f8({environment:t,collectionContextStore:r,collectionViewId:d.id,isFullScreen:s,isRootChild:l,isInPeekRenderer:c}),n.default.afterNextFlush((()=>{v.r$({collectionContextStore:r,collectionSettingsStore:r.settingsStore,selectViewNameInitial:!0})}))))}function I(e){C(e),function(e){const{environment:t,collectionContextStore:o}=e,n=o.collectionViewStore();if(!n)return;o.blockIsPrivateStore.state&&o.permissionScopes.state.canConfigureBlock&&S.createAndCommit({userAction:"collectionFilterActions.applyTemporaryStateIfPrivate",environment:t,perform:e=>{k({environment:t,collectionContextStore:o,type:w.All,targetCollectionView:n,preventSnackbarNotification:!0,transaction:e})}})}(e)}function C(e){const{environment:t,collectionContextStore:o,temporaryState:n}=e,r=o.collectionViewStore();if(!r)return;const i=t.currentUser.id;o.temporaryState.setState(n||{}),b.bu({currentUserId:i,collectionViewId:r.id,temporaryState:n}),o.groupsStore.resetAllLimits()}function T(e){const{environment:t,seen:o}=e,{currentUserSettingsStore:n}=y.default.state;n&&S.createAndCommit({userAction:"collectionFilterActions.setSeenFiltersIntroTooltip",environment:t,perform:e=>{_.d2({userSettingsStore:n,transaction:e,data:{seen_filters_tooltip:o}})}})}function M(e){var t;let{transaction:o,newGroups:n,collectionContextStore:l,environment:c}=e;const d=l.collectionViewStore(),p=l.currentCombinatorFilterStore.state,u=(0,a.Xh)(p),m=null==u||null===(t=u.filters)||void 0===t?void 0:t.find(r.s9),g=(0,f.yU)(l);if(!(d&&u&&u.filters&&m))return;const h=m.filter.value.filter((e=>"exact"===e.type)).map((e=>e.value)).filter(s.$K),y=n.map((e=>e.value)).filter(i.tL).map((e=>e.value)).filter(i.RA).map((e=>e.id)),v=(0,a.zu)(y,...h);0!==v.length&&(m.filter.value=[...m.filter.value,...v.map((e=>({type:"exact",value:e})))],C({environment:c,collectionContextStore:l,temporaryState:{...l.temporaryState.state,combinatorFilter:{value:u}}}),g||k({environment:c,collectionContextStore:l,type:w.Filters,targetCollectionView:d,preventSnackbarNotification:!0,transaction:o}))}},49865:(e,t,o)=>{o.d(t,{$D:()=>fe,$T:()=>te,A6:()=>ce,BN:()=>X,BO:()=>se,ID:()=>we,IW:()=>le,Od:()=>ee,V$:()=>ve,by:()=>re,hz:()=>de,iE:()=>pe,mp:()=>oe,o3:()=>he,tH:()=>_e,tQ:()=>ie,uo:()=>be,w$:()=>Se,yk:()=>ue});o(57658);var n=o(15145),r=o(41432),i=o(14248),a=o(14714),s=o(99036),l=o(45433),c=o(93824),d=o(43593),p=o(42875),u=o(15157),m=o(72126),g=o(21202),h=o(6287),f=o(23867),y=o(70203),v=o(95371),b=o(97880),S=o(5366),_=o(28020),w=o(75079),k=o(81849),x=o(52821),I=o(78316),C=o(77181),T=o(33929),M=o(18245),P=o(80444),A=o(55367),D=o(35661),B=o(8406),R=o(54642),E=o(40778),F=o(98834),N=o(45264),j=o(30188),O=o(47307),L=o(42239),U=o(31781),Z=o(96802),V=o(94419),q=o(19785),z=o(9953),W=o(79978),H=o(75018),G=o(42858),K=o(24677),$=o(39699),Y=o(27370),Q=o(37181);const J=(0,S.defineMessages)({removeSortingConfirmation:{id:"databaseActions.removeSortingConfirmationDialog.prompt",defaultMessage:"Would you like to remove sorting?"},removeSortingButton:{id:"databaseActions.removeSortingConfirmationDialog.removeSortingButton.label",defaultMessage:"Remove"},removeSortingCancel:{id:"databaseActions.removeSortingConfirmationDialog.cancelRemoveSortingButton.label",defaultMessage:"Don't remove"}});function X(e){const{store:t,groupsPointer:o,environment:n,collectionContextStore:r,transaction:a}=e;if(!t.isDefined())return;const s=r.normalizedSchemaStore.state,l=r.relativeVariableStore.state,c=new Map;for(const d of o){const e=i.ND({block:t.getModel(),schema:s,propertyMapping:void 0,userFilterContext:{userId:n.currentUser.id,userTimeZone:(0,p.r)(),userStartOfWeek:_.AK.state},group:d,getRecordModel:t.getRecordModel,intl:T.default.getIntl(),relativeVariableResult:l,resultCache:c});Object.keys(e).length>0&&z.sW({store:t.getPropertiesStore(),data:e,transaction:a})}}function ee(e){const{store:t,transaction:o}=e;q.hh({childStore:t,transaction:o})}function te(e){var t,o;const{environment:n,collectionContextStore:r,before:i,insertStores:a,store:s,groupsPointer:l,transaction:c,collectionStore:d}=e,p=r.collectionViewStore(),u=(null===(t=r.groupsStore.getGroupState(l))||void 0===t?void 0:t.resultsStore.state)||[],m=null===(o=r.groupsStore.getGroupState(l))||void 0===o?void 0:o.groupUiParentStore;if(!m)return[];const h=[];for(const b of a)oe({environment:n,store:b,collectionStore:d,collectionContextStore:r,groupsPointer:l,coerce:!0,transaction:c}),h.push(D.G.createChildStore(m,{table:g.iU,id:b.id}));const f=u.indexOf(s),y=i?f:f+1,v=[...u.slice(0,y),...h,...u.slice(y)];return p&&ne({resultIds:v.map((e=>e.id)),collectionViewStore:p,collectionContextStore:r,transaction:c}),r.groupsStore.setLimitIfGreater(l,v.length),h}function oe(e){var t;const{environment:o,store:n,collectionStore:a,collectionContextStore:l,groupsPointer:c,transaction:d,coerce:u,alreadyMovedToCollection:g}=e,h=a.getSchema(),f=a.getParentBlockStore(),y=f&&f.isLocked();let v=!u;const b=(null==l||null===(t=l.groupsStore.getGroupState(c))||void 0===t?void 0:t.resultsStore.state)||[];if(n.isDefined()){const e=g?(0,s.Kc)(T.default.getIntl()):n.getSchema()||{},t=i.Xq({blockProperties:n.getProperties(),oldSchema:e,newSchema:h});t.propertyUpdate&&Object.keys(t.propertyUpdate).length>0&&z.sW({store:n.getPropertiesStore(),data:t.propertyUpdate,transaction:d}),m.Xy(h,t.newSchema)||y||!I.eD({collectionStore:a,collectionViewBlockStore:f,checkNavigableAncestorLocked:!1})||N.Rm({environment:o,collectionStore:a,update:{schema:t.newSchema},transaction:d})}if(n.getType()===r.Ti.page||n.getType()===r.Ti.collectionViewPage&&n.isAssociatedCollectionAPageTree()||a.isPageTreeCollection()||n.getType()===r.Ti.copyIndicator||n.getType()===r.Ti.externalObjectInstancePage||z.sW({store:n,data:{type:r.Ti.page},transaction:d}),l){if(l.collectionViewStore()){const e=l.remoteRequestStore.state,t=n.getModel(),r=l.relativeVariableStore.state;if(t&&e&&u){const s=i.RA({block:t,schema:l.normalizedSchemaStore.state,propertyMapping:a.getPropertyMapping(),filter:e.loader.filter,userFilterContext:{userId:o.currentUser.id,userTimeZone:(0,p.r)(),userStartOfWeek:_.AK.state},relativeVariableResult:r,groupsPointer:c,getRecordModel:a.getRecordModel,intl:T.default.getIntl(),resultCache:new Map}),u=s.update;Object.keys(u).length>0&&z.sW({store:n.getPropertiesStore(),data:u,transaction:d}),v=s.coercionSucceeded}}}if(g?$.applyOperation({store:n,operation:{pointer:n.pointer,path:["alive"],command:"set",args:!0},transaction:d}):q.zw({childStore:n,parentStore:a,transaction:d}),l&&l.resultSet.addLocalChange([n.id]),l){var S;const e=null===(S=l.groupsStore.getGroupState(c))||void 0===S?void 0:S.currentLimit;if(e){const t=e.state,o=b.find((e=>e.id===n.id));b.length>=t&&!o&&e.setState(b.length+1)}}return v}function ne(e){const{resultIds:t,collectionViewStore:o,collectionContextStore:n,transaction:r}=e,i=o.getPageSortStore(),a=i.getValue()||[],{beforeOps:l}=(0,c.q)(a,t.slice(0,s.gq));for(const[s,c]of Object.entries(l))if(c){const e=(0,D.Kv)(o,{table:g.iU,id:c});V.Vt({parent:i,insert:(0,D.Kv)(o,{table:g.iU,id:s}),before:e,transaction:r})}else{const e=t.findIndex((e=>e===s)),n=t[e-1],a=n?(0,D.Kv)(o,{table:g.iU,id:n}):void 0;V.BE({parent:i,insert:(0,D.Kv)(o,{table:g.iU,id:s}),after:a,transaction:r})}!function(e){const{collectionContextStore:t,collectionViewStore:o,transaction:n}=e,r=o.getPageSortStore(),i=r.getValue(),a=t.groupsStore.getAllGroupStates(),l=new Set(a.flatMap((e=>e.resultsStore.state.map((e=>e.id))))),c=function(e){const{pageSort:t,currentResults:o}=e;if(!t||t.length<=s.gq)return[];const n=t.filter((e=>!o.has(e)));return m.jj([...n.reverse(),...m.d9(t).reverse()]).slice(0,t.length-s.gq)}({pageSort:i,currentResults:l});for(const s of c)V.Od({parent:r,childToRemove:(0,D.Kv)(r,{table:g.iU,id:s}),transaction:n})}({collectionContextStore:n,collectionViewStore:o,transaction:r})}function re(e){var t,o,n,r;const{environment:i,collectionStore:a,targetStore:c,droppedDirection:d,droppedStores:p,transaction:u,duplicate:f,collectionContextStore:y,groupsPointer:b,subitemPath:S}=e,_=y.collectionViewStore();if(!_)return;if(!(null===(t=y.groupsStore.getGroupState(b))||void 0===t?void 0:t.groupUiParentStore))return;const w=(null===(o=y.groupsStore.getGroupState(b))||void 0===o?void 0:o.resultsStore.state)||[],k=p.every((e=>e.isExternalObjectInstancePageBlockStore()))&&!(a.isSyncedCollection()&&(null===(n=p[0])||void 0===n?void 0:n.getParentId())===(null==a?void 0:a.id))||f;if(d===A.vh.Onto){K.ZH(i);const e=c.getContentStore(),t=L.LQ({environment:i,droppedStores:p,duplicate:k,duplicateUseCrdt:c.useCrdt(),transaction:u,resolveTemplateVariables:!1});for(const o of t)V.R3({parent:e,append:o,transaction:u});return[]}let x=!1,I=[];if(!k){const e=function(e){const{environment:t,droppedStores:o,collectionStore:n,transaction:r}=e,i=he({environment:t,stores:o,collectionStore:n,transaction:r});for(const a of i){if(a.getParentTable()===h.v||a.getAssociatedCollectionStore())return;if(!q.zw({childStore:a,parentStore:n,transaction:r}))return}return i}({environment:i,droppedStores:p,collectionStore:a,transaction:u});x=void 0!==e,I=e??[]}const T=L.LQ({environment:i,droppedStores:p,duplicate:k,duplicateUseCrdt:!1,transaction:u,resolveTemplateVariables:!1});x||(I=he({environment:i,stores:T,transaction:u,collectionStore:a})),u.postSubmitCallbacks.push((async e=>{e||await j.YE({droppedStores:p,createdStores:T,collectionStore:a,environment:i,collectionContextStore:y,groupsPointer:b,alreadyMovedToCollection:x,shouldDuplicate:k})}));const M=(0,C.Af)([...(null==S?void 0:S.map((e=>e.value.store.pointer)))??[]]),B=y.subitemExpandedStore.state.get(M),R=S&&S.length>1||(null==B?void 0:B.isExpanded)&&d===A.vh.Below,E=null==y?void 0:y.currentSubitemFormatStore.state,F=null==E?void 0:E.inverse,N=F&&y.normalizedSchemaStore.state[F],O=null===(r=y.collectionViewStore())||void 0===r?void 0:r.getType(),U=E&&O&&(0,C.Av)(O)&&N&&(0,s.p_)(N);for(const s of I){if(oe({environment:i,store:s,collectionStore:a,collectionContextStore:y,groupsPointer:b,coerce:!0,transaction:u,alreadyMovedToCollection:x}),U){const e=(0,C.xb)({store:s,subitemFormat:E,propertySchema:N});for(const t of e){const e=D.G.createChildStore(s,t);W.Bl({environment:i,sourceStore:e,destStore:s,propertyWithInverse:E,transaction:u})}}if(R){const e=null!=B&&B.isExpanded?"into":"below";me({environment:i,collectionContextStore:y,collectionStore:a,subitemPath:S&&(null==S?void 0:S.length)>0?S:[new v.mp((0,C.SM)(c),[])],store:c,before:"into"===e,insertBlock:s,insertDirection:e,transaction:u})}}const Z=w.filter((e=>!T.includes(e))),z=Z.indexOf(c),H=d===A.vh.Above||d===A.vh.Left?z:z+1;ne({resultIds:[...Z.slice(0,H),...I,...Z.slice(H)].map((e=>e.id)),collectionViewStore:_,collectionContextStore:y,transaction:u}),ae({environment:i,collectionContextStore:y});const G=y.collectionViewBlockStore();if(!G)return;const $=R?c:G,Q=m.UI(I,(e=>D.G.createChildStore($,{table:g.iU,id:e.id})));return K.Z5({environment:i,stores:Q}),function(e,t){var o,n;(null===(o=e.collectionViewStore())||void 0===o?void 0:o.getFormat().app_config_uri)===l.g3&&"sprint_board"===(null===(n=P.default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.getFormat().special_page_for_pm_launch)&&Y.tutorialAdvanceToStepAfter(t,"sprints-onboarding","sprint-task-tooltip")}(y,u),Q}function ie(e){const{environment:t,collectionStore:o,targetStore:n,droppedDirection:r,files:i,transaction:a,collectionContextStore:s,groupsPointer:l}=e,c=s.collectionViewStore(),p=_.qQ(t);if(!c)return;const u=o.inMemoryRecordCache,m=U.z({environment:t,files:i,inMemoryRecordCache:u,pageWidth:p,transaction:a,spaceId:o.pointer.spaceId,useCrdt:!1}).map(((e,n)=>{const r=i[n],s=z.j4({environment:t,type:"page",inMemoryRecordCache:u,properties:{title:(0,y.TPx)(d.AA(r.name))},transaction:a,spaceId:o.pointer.spaceId,useCrdt:!1});return V.R3({parent:s.getContentStore(),append:e,transaction:a}),s}));re({environment:t,collectionStore:o,targetStore:n,droppedDirection:r,collectionContextStore:s,groupsPointer:l,droppedStores:m,duplicate:!1,transaction:a})}function ae(e){const{environment:t,collectionContextStore:o}=e,n=o.collectionViewBlockStore(),r=o.collectionViewStore();if(!r||!n)return!1;const i=o.currentViewHasSort(),a=r.getType(),s=o.permissionScopes.state;return!!(i&&a&&x.Km[a]&&s.canConfigureBlock)&&(O.showDialog({message:T.default.formatMessage(J.removeSortingConfirmation),items:[{label:T.default.formatMessage(J.removeSortingButton),color:"red",onAccept:()=>{$.createAndCommit({userAction:"collectionGroupActions.offerToRemoveSort",environment:t,perform:e=>{N.Es({collectionViewStore:r,update:{sort:[]},transaction:e})}})}},{label:T.default.formatMessage(J.removeSortingCancel),onAccept:()=>{}}],showCancel:!1,keepFocus:!0}),!0)}function se(e){const{environment:t,droppedStores:o,duplicate:n,collectionContextStore:r,groupsPointer:i,transaction:a}=e,s=r.collectionStore(),l=r.collectionViewStore(),c=L.LQ({environment:t,droppedStores:o,duplicate:n,duplicateUseCrdt:!1,transaction:a,resolveTemplateVariables:!1});if(s)for(const d of c)oe({environment:t,store:d,collectionStore:s,collectionContextStore:r,groupsPointer:i,coerce:!0,transaction:a});return l&&ne({resultIds:c.map((e=>e.id)),collectionViewStore:l,collectionContextStore:r,transaction:a}),[]}function le(e){var t,o,n;const{environment:i,collectionContextStore:a,groupsPointer:s,insertAtIndex:l,coerce:c,initializeDefaultTemplate:d,transaction:p,from:u,tracker:m}=e,h=M.default.mark("collections.add_item_lag");M.default.measureAfterNextFlush(h,{environment:i,getData:()=>({...w.vS(a),from:u})});const f=null===(t=P.default.state.currentSpaceStore)||void 0===t?void 0:t.id,y=z.j4({environment:i,type:r.Ti.page,inMemoryRecordCache:i.defaultRecordCache.inMemoryRecordCache,transaction:p,spaceId:f,tracker:m,useCrdt:!1}),v=a.collectionStoresStore.state,b=a.databaseType,S="collectionTypedView"===a.contextType,_=v.length?v[0]:void 0,k=P.default.state.currentUserSettingsStore;!S&&b&&_&&Q.zq({transaction:p,dbType:b,collectionId:_.id});const x=S&&b&&f&&k?k.getPreferredCollections(f,b)[0]:void 0,I=(x?v.find((e=>e.id===x)):void 0)??_,C=a.collectionViewStore(),T=a.getViewType();if(!I||!C||!T)return{coercionSucceeded:!0,newStore:y};const A=null===(o=a.groupsStore.getGroupState(s))||void 0===o?void 0:o.groupUiParentStore;if(!A)return{coercionSucceeded:!0,newStore:y};const B=D.G.createChildStore(A,{table:g.iU,id:y.id});if(d){const e=a.defaultPageTemplateStore.state;e&&F.ob({title:"template",environment:i,store:y,templateStore:e,isKeyboard:!1,isCreateIn:!1,transaction:p,from:"collection_group_actions"})}const R=oe({environment:i,store:y,collectionStore:I,collectionContextStore:a,groupsPointer:s,coerce:c,transaction:p}),E=(null===(n=a.groupsStore.getGroupState(s))||void 0===n||null===(n=n.reducerResultStore.state)||void 0===n?void 0:n.blockIds)||[],N=void 0!==l?l:E.length;if(a.permissionScopes.state.canEditContent){ne({resultIds:[...E.slice(0,N),B.id,...E.slice(N)],collectionViewStore:C,collectionContextStore:a,transaction:p})}return{coercionSucceeded:R,newStore:B}}function ce(e){const{collectionContextStore:t,newGroups:o,groupsFormatKey:n,transaction:r}=e,i=t.collectionViewStore();i&&Z.FH({stores:[i],update:{[n]:o},transaction:r})}function de(e){const{environment:t,collectionStore:o,property:n,oldValue:r,newValue:a,transaction:s}=e,l=o.getSchema(),c=t.currentUser.id;o.inMemoryRecordCache.forEachRecord(c,(e=>{var t;let{model:c}=e;if(c.table!==g.iU)return;const d=D.G.createChildStore(o,{table:g.iU,id:c.id});if((null===(t=d.getAssociatedCollectionStore())||void 0===t?void 0:t.id)===o.id){const e=i.hz({block:c,schema:l,property:n,oldValue:r,newValue:a});if(Object.keys(e).length>0){const t=d.getPropertiesStore();z.sW({store:t,data:e,transaction:s})}}})),o.isDefaultRecordCache()&&s.postSubmitCallbacks.push((async e=>{const i=o.pointer,{value:s}=await R.renameGroup(t,{collection:{id:i.id,spaceId:(0,f.C)(i.spaceId)},property:n,oldValue:r,newValue:a}).next();if(s.error)throw s.error}))}function pe(e){const{environment:t,collectionStore:o,groupsFormatKey:n,property:r,groupFormat:l,currentGroups:c,collectionContextStore:d,transaction:u,intl:m}=e,h=o.getSchema(),y=h[l.property];ce({collectionContextStore:d,newGroups:c.filter((e=>!(0,a.we)(l.value,e.value))),groupsFormatKey:n,transaction:u});const v=l.value;if(y&&(0,s.cu)(y)&&v.type===y.type&&o){const e=(y.options||[]).filter((e=>e.value!==v.value)),n={...y,options:e},r={...h,[l.property]:n};N.Rm({environment:t,collectionStore:o,update:{schema:r},transaction:u})}const b=t.currentUser.id,S=new Map;o.inMemoryRecordCache.forEachRecord(b,(async e=>{let{model:n}=e;if(n.table!==g.iU)return;const a=D.G.createChildStore(o,n.pointer);if(i.wg({block:n,schema:h,property:r,value:v,intl:m,timeZone:(0,p.r)(),getRecordModel:o.getRecordModel,resultCache:S}))if(n.parent_id===o.id)q.hh({childStore:a,transaction:u});else{const e=a.getAssociatedCollectionStore();e&&e.id===o.id&&("page"===a.getType()||"collection_view_page"===a.getType()&&!a.isCollectionViewPageWithContent())&&await G.Qw({environment:t,blocks:[a]})}})),o.isDefaultRecordCache()&&u.postSubmitCallbacks.push((async e=>{const n=await R.deleteGroup(t,{collection:{id:o.id,spaceId:(0,f.C)(o.pointer.spaceId)},property:r,value:v}).next();if(n.value.error)throw n.value.error}))}function ue(e){const{environment:t,collectionContextStore:o,before:i,store:a,groupsPointer:s,collectionStore:l,transaction:c,subitemPath:d,subitemInsertDirection:p}=e,u=o.collectionViewStore();if(!u)return;const m=o.groupsStore.getGroupState(s),h=null==m?void 0:m.groupUiParentStore,f=(null==m?void 0:m.resultsStore.state)||[];if(!h)return;const y=z.j4({environment:t,type:r.Ti.page,inMemoryRecordCache:a.inMemoryRecordCache,transaction:c,spaceId:u.pointer.spaceId,useCrdt:!1}),v=oe({environment:t,store:y,collectionStore:l,collectionContextStore:o,groupsPointer:s,coerce:!0,transaction:c}),b=o.defaultPageTemplateStore.state;b&&F.ob({title:"template",environment:t,store:y,templateStore:b,isKeyboard:!1,isCreateIn:!1,transaction:c,from:"collection_group_actions"});const S=D.G.createChildStore(h,{table:g.iU,id:y.id});d&&d.length>0&&me({environment:t,collectionContextStore:o,subitemPath:d,collectionStore:l,store:a,before:!1,insertBlock:S,insertDirection:p,transaction:c});const _=f.indexOf(a),w=i?_:_+1;if(ne({resultIds:[...f.slice(0,w),S,...f.slice(w)].map((e=>e.id)),collectionViewStore:u,collectionContextStore:o,transaction:c}),v){if(d){var k;const e="into"===p?a:null===(k=d[d.length-2])||void 0===k?void 0:k.value.store;return e?D.G.createChildStore(e,S.pointer):S}return K.Ys({environment:t,store:S}),ae({environment:t,collectionContextStore:o}),S}H.peekBlock({environment:t,store:S,peekMode:I.kr(u),resultsStore:null==m?void 0:m.resultsStore,collectionContextStore:o,pageVisitSource:n.tY.Create})}function me(e){const{environment:t,collectionContextStore:o,subitemPath:n,collectionStore:r,store:i,before:a,insertBlock:s,insertDirection:l,transaction:c}=e,d=o.currentSubitemFormatStore.state;if(!d)return;const p=r.getSchema()[d.property];if(!p||"relation"!==p.type)return;if("into"===l){var u;const e=n[n.length-1],o=e.value.store;return void W.hE({environment:t,sourceStore:o,destStore:s,position:a?{type:"before",before:null===(u=e.children[0])||void 0===u?void 0:u.value.store.id}:{type:"after"},propertyWithInverse:d,transaction:c})}const m=n[n.length-2];if(!m)return;const g=m.value.store;W.hE({environment:t,sourceStore:g,destStore:s,propertyWithInverse:d,position:a?{type:"before",before:i.id}:{type:"after",after:i.id},transaction:c})}function ge(e){const{environment:t,collectionContextStore:o,groupFormat:n,newGroupFormat:r,groupsFormatKey:i,currentGroups:s,transaction:l}=e,c=o.collectionStore();!(0,a.we)(n.value,r.value)&&c&&de({environment:t,collectionStore:c,property:n.property,oldValue:n.value,newValue:r.value,transaction:l});ce({collectionContextStore:o,newGroups:s.map((e=>(0,a.we)(n.value,e.value)?r:e)),groupsFormatKey:i,transaction:l})}function he(e){const{environment:t,stores:o,transaction:n,collectionStore:i}=e;return o.map((e=>{const o=e.getType();if(o&&(r.Ok[o]||o===r.Ti.file||o===r.Ti.externalObjectInstance)){const o=z.j4({environment:t,type:"page",inMemoryRecordCache:e.inMemoryRecordCache,transaction:n,spaceId:i.pointer.spaceId,useCrdt:!1});return q.jG({parentStore:o,childStore:e,transaction:n}),o}return e}))}function fe(e){const{environment:t,format:o,groupsFormatKey:n,collectionContextStore:r,currentGroups:i}=e,a=o[n]||[];if(!r.permissionScopes.state.canConfigureBlock)return;if(0===i.length)return;const s=i.slice(0,k.XD),l=a.slice(0,k.XD);m.Xy(s,l)||$.createAndCommit({userAction:"collectionGroupActions.persistFormatGroups",environment:t,canUndo:!1,perform:e=>{ce({collectionContextStore:r,newGroups:i,groupsFormatKey:n,transaction:e})}})}function ye(e,t){return`group-${e}-${(0,a.mD)(t)}`}function ve(e){const{environment:t,groupFormat:o,collectionContextStore:n}=e,r=n.collectionViewStore();if(!r)return;const i=n.groupsStore.getGroupState(o);if(!i)return;const a=u.Z.get({userId:t.currentUser.id,key:ye(r.id,o)});i.toggleStateStore.setState(a??!0)}function be(e){const{environment:t,groupFormat:o,toggleStateStore:n,newValue:r,collectionContextStore:i}=e,a=i.collectionViewStore();a&&(n.setState(r),u.Z.set({userId:t.currentUser.id,key:ye(a.id,o),value:r}))}function Se(e){const{newGroupValue:t,groupFormat:o,schema:n,collectionContextStore:r,currentGroups:i,groupsFormatKey:l,collectionStore:c,environment:d}=e,p=n[o.property];if(!p)return;if(!(0,a.LG)(p))return;const u=o.value;if((0,s.cu)(p)){if(u.type!==p.type)return;if(t.type!==p.type)return;if(void 0===t.value)return;const e=p.options||[],a=t.value,s=e.map((e=>e.value===u.value?{...e,value:a}:e)),m={...p,options:s},g={...n,[o.property]:m},h={...o,value:{...u,value:a}};$.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:e=>{ge({environment:d,collectionContextStore:r,groupFormat:o,newGroupFormat:h,currentGroups:i,transaction:e,groupsFormatKey:l}),N.Rm({environment:d,collectionStore:c,update:{schema:g},transaction:e})}})}else if("person"!==p.type)if((0,a.HB)(p.type)){if(u.type!==p.type)return;if(t.type!==p.type)return;if(!t.value||"exact"!==t.value.type)return;const e={...o,value:t};$.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:t=>{ge({environment:d,collectionContextStore:r,groupFormat:o,newGroupFormat:e,currentGroups:i,groupsFormatKey:l,transaction:t})}})}else"status"===p.type||(0,a.A1)(p.type)||"created_by"===p.type||"last_edited_by"===p.type||"number"===p.type||"checkbox"===p.type||"formula"===p.type||"relation"===p.type||"location"===p.type||(0,b.t1)(p.type);else{if(u.type!==p.type)return;if(t.type!==p.type)return;const e={...o,value:t};$.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:t=>{ge({environment:d,collectionContextStore:r,groupFormat:o,newGroupFormat:e,currentGroups:i,groupsFormatKey:l,transaction:t})}})}}async function _e(e){const{update:t,collectionContextStore:o,groupsFormatKey:n,collectionStore:i,environment:a,schema:l,groupBy:c}=e,d=l[c.property];if(!d)return;const p="relation"===d.type&&(0,s.F0)(d),u=p&&new D.NW(a,{table:h.v,id:p});u&&await u.load(),$.createAndCommit({userAction:"collectionGroupActions.handleCollectionAddGroupButtonAccept",environment:a,perform:e=>{if(t.newGroups&&(ce({collectionContextStore:o,newGroups:t.newGroups,groupsFormatKey:n,transaction:e}),E.ul({transaction:e,newGroups:t.newGroups,collectionContextStore:o,environment:a})),t.newSchema&&N.Rm({environment:a,collectionStore:i,update:{schema:t.newSchema},transaction:e}),t.newPage&&"relation"===d.type&&u){const o=(0,y.TPx)(t.newPage.name),n={id:t.newPage.id,version:0,type:r.Ti.page,parent_id:p,parent_table:h.v,alive:!0,properties:{title:o},collection_id:void 0,space_id:t.newPage.spaceId},s=z.ae({environment:a,table:g.iU,value:n,inMemoryRecordCache:i.inMemoryRecordCache,transaction:e}),l=u.getDefaultTemplatePageStore();l&&F.ob({title:{text:o},environment:a,store:D.G.createChildStore(u,s.pointer),templateStore:l,isKeyboard:!1,isCreateIn:!1,transaction:e,from:"collection_group_actions"})}}})}function we(e){const{collectionContextStore:t,environment:o,incrementLimitArgs:n}=e;t.groupsStore.incrementLimit(e.incrementLimitArgs),t.loadingDetails.setState({type:"load_more_blocks",group:n.groupsPointer}),B.bn(o)}},16956:(e,t,o)=>{o.d(t,{Bv:()=>B,E2:()=>O,G3:()=>P,LC:()=>A,OK:()=>R,TI:()=>N,bL:()=>D,er:()=>E,fH:()=>F,yV:()=>j});o(57658),o(67294);var n=o(99036),r=o(95200),i=o(46328),a=o(71644),s=o(6287),l=o(97880),c=o(82990),d=o(5366),p=o(76798),u=o(52821),m=o(78316),g=o(33929),h=o(29376),f=o(85526),y=o(35661),v=o(8406),b=o(48299),S=o(31869),_=o(5149),w=o(87085),k=o(45264),x=o(47307),I=o(96802),C=o(39699),T=o(29919),M=o(85893);function P(e){const{environment:t,collectionViewArgs:o,collectionStore:s,propertyName:c,propertyType:d,transaction:p}=e,m={},h=s.getSchema(),f=Object.keys(h),y=(0,r.Z)(c??u.SO[d],(e=>!f.find((t=>{const o=h[t];return Boolean(o&&o.name===e)})))),v=(0,a.ZP)();let b;const S=(0,u.k4)();if((0,n.XU)(d))switch(d){case"ai_custom_prompt":b={name:y,type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:S}};break;case"ai_summary":b={name:y,type:"text",ai_inference:{type:"summarize",auto_update_on_edit:S}};break;case"ai_extract":b={name:y,type:"text",ai_inference:{type:"extract",prompt:"",auto_update_on_edit:S}};break;case"ai_translate":b={name:y,type:"text",ai_inference:{type:"translate",targetProperties:["title"],toLanguage:"english",auto_update_on_edit:S}};break;default:(0,l.t1)(d)}else b={name:y,type:d};if(m[v]=b,n.iE(b)&&(f.includes(i.k.Owner)||(m[i.k.Owner]={name:g.default.formatMessage(T.Zi.ownerPropertyName),type:"person",default:"created_by"}),b.verifier_property=i.k.Owner),o){const{format:e,formatKey:t,collectionViewStore:n}=o,r=[...e[t]||[],{property:v,visible:!0}];I.FH({stores:[n],update:{[t]:r},transaction:p})}return k.xO({environment:t,collectionStore:s,update:m,transaction:p}),v}function A(e){const{environment:t,collectionStore:o,property:r,type:i,transaction:a}=e,s=o.getSchema()[r];if(!s||s.type===i)return;const l={...s};l.type=(0,n.TN)(i),k.xO({environment:t,collectionStore:o,update:{[r]:l},transaction:a})}function D(e){const{collectionStore:t,property:o,autoRelate:n,transaction:r}=e;t.getSchema()[o]&&C.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",o,"autoRelate"],command:"set",args:n},transaction:r})}function B(e){const{collectionStore:t,property:o,name:n,transaction:r}=e;t.getSchema()[o]&&C.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",o,"name"],command:"set",args:n},transaction:r})}function R(e){const{collectionStore:t,property:o,icon:n,transaction:r}=e;t.getSchema()[o]&&C.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",o,"icon"],command:"set",args:n},transaction:r})}function E(e){const{formatStore:t,formatKey:o,property:n,update:r,transaction:i}=e,a=[...t.getFormat()[o]||[]],s=a.findIndex((e=>e.property===n));-1!==s?a[s]={...a[s],...r}:a.push({property:n,...r}),I.FH({stores:[t],update:{[o]:a},transaction:i})}function F(e){const{collectionContextStore:t,collectionStore:o,environment:r,isInPeekRenderer:i,onCloseMenu:a}=e,s=t.settingsStore;_.H4({collectionSettingsStore:s,item:{type:"propertyType",onAccept:(e,l)=>{if("relation"===e)return void _.H4({collectionSettingsStore:s,item:{type:"selectRelationSource",property:void 0,formatKey:"collection_page_properties"}});const{performResult:c}=C.createAndCommit({userAction:"PageProperties.handleAddPropertyClick",environment:r,perform:t=>P({environment:r,collectionStore:o,collectionViewArgs:void 0,propertyType:e,propertyName:l,transaction:t})});null==a||a(),_.FK({collectionSettingsStore:s,item:{type:"property",formatKey:"collection_page_properties",property:c,selectNameInitial:!r.device.isMobile}}),f.Z.setState({...f.Z.state,openProperty:{property:c,isInPeekRenderer:i},forceShowProperties:!0}),(0,n.XU)(e)&&w.K7({propertyType:e,propertyId:c,collectionContextStore:t}),v._H({environment:r,collectionContextStore:t,from:"page_properties",property_type:(0,n.TN)(e)})},propertyTypes:(0,u.TP)({isSyncedCollection:o.isSyncedCollection(),collectionContextStore:t,environment:r})}})}async function N(e){const{environment:t,collectionContextStore:o,property:n,handleDeleteAccept:r}=e,i=o.collectionStore();if(!i)return;if(i.isTypedProperty(n)){if(await b.w0({environment:t,property:n,collectionContextStore:o,theme:e.theme,from:e.from}))return}const a=o.normalizedSchemaStore.state,s=a[n],l=h.ny(o,s);await(null==l?void 0:l.load());const u=l&&h.OP(o,n,l),m=l&&h.gZ(l),g=l&&i.id===l.id,f=[{label:(0,M.jsx)(d.FormattedMessage,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:r}];let y;if(u&&i&&m&&!g&&f.push({label:(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{C.createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,perform:e=>{if(s&&"relation"===s.type&&s.property&&l){const o=s.property,n=l.getSchema();S.q0({environment:t,collectionStore:l,propertySchema:n[o],property:o,targetPropertyID:void 0,autoRelate:i.isSyncedCollection()&&!l.isSyncedCollection()?{enabled:!1}:s.autoRelate,transaction:e})}S.kQ({environment:t,collectionStore:i,property:n,transaction:e})}})}}),"auto_increment_id"===(null==s?void 0:s.type))y=h.pR(a)?(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==s?void 0:s.type)){const e=h.Pi(a);if(e){const t=e.connectedRelation.automation;t&&t[n]&&(y=(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else l&&m&&!g&&u&&(y=(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,M.jsx)(p.Z,{style:{display:"inline",fontWeight:c.Z.fontWeight.medium},store:l})}}));x.showDialog({message:(0,M.jsx)("span",{children:(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property for everyone on {databaseName}?",values:{databaseName:(0,M.jsx)(p.Z,{style:{display:"inline",fontWeight:c.Z.fontWeight.medium},shouldWrap:!0,store:i})}})}),description:y,showCancel:!0,keepFocus:!0,items:f,mode:"wide"})}async function j(e){const{environment:t,collectionStore:o,schema:r,property:i,transaction:a}=e,s=r[i];if(s)if("relation"===s.type&&n.F0(s)&&s.property&&n.F0(s)!==o.id){const e=new y.NW(t,n.j0(s));await e.load(),O({environment:t,collectionStore:o,schema:r,property:i,transaction:a,targetCollectionStore:e})}else O({environment:t,collectionStore:o,schema:r,property:i,transaction:a})}function O(e){const{environment:t,collectionStore:o,schema:n,property:r,transaction:i,targetCollectionStore:a}=e;if(!o.isDefined())return;const l=m.zm({environment:t,collectionId:o.id,schema:n,property:r,targetCollectionStore:a});if(!l)return;k.Rm({environment:t,collectionStore:o,update:{schema:l.newSchema,...l.deletedSchema&&{deleted_schema:l.deletedSchema}},transaction:i}),l.otherCollectionId&&l.otherCollectionSchema&&k.Rm({environment:t,collectionStore:y.NW.createChildStore(o,{table:s.v,id:l.otherCollectionId}),update:{schema:l.otherCollectionSchema,...l.otherCollectionDeletedSchema&&{deleted_schema:l.otherCollectionDeletedSchema}},transaction:i});const c=n[r];"auto_increment_id"===(null==c?void 0:c.type)&&k.$N({collectionStore:o,update:{[r]:null},transaction:i})}},75134:(e,t,o)=>{o.d(t,{H:()=>I,r:()=>C});o(67294);var n=o(40682),r=o(52936),i=o(42875),a=o(72126),s=o(5366),l=(o(57658),o(21703),o(80951)),c=o(61158),d=o(45953);function*p(e){const{startingBlock:t,relationPropertyIdGroups:o,receiver:n}=e;let r,i=o.map((e=>function*(e){const{startingBlock:t,relationPropertyIds:o,receiver:n}=e,r=new Set,i=[{block:t}];let s=0;for(;;){const e=i.shift();if(!e)break;const{block:t}=e;if(r.has(t.id))continue;r.add(t.id);const c=o.flatMap((e=>{var o;return(0,l.rq)(null===(o=t.properties)||void 0===o?void 0:o[e])}));if(!n.receive(c))return;if(c.length>0){const{recordMap:e}=yield{recordPointers:c};i.push(...a.oA(c.map((t=>{const o=e.getValue(t);if(o&&o.alive)return{block:o}}))))}if(s++,s>500)throw new Error("Reached maximum number of iterations")}}({relationPropertyIds:e,startingBlock:t,receiver:n})));for(;i.length>0;){const e=[];i=i.filter((t=>{const o=r?t.next(r):t.next();return!o.done&&(e.push(o.value),!0)})),e.length>0&&(r=yield{recordPointers:e.flatMap((e=>e.recordPointers))})}}class u{constructor(e){this.blockPointerSet=new c.Z,this.limit=e}getBlockPointers(){return this.blockPointerSet.entries()}receive(e){return this.blockPointerSet.add(...e),this.blockPointerSet.size<this.limit}}function m(e){return function(e){const{startingBlock:t,relationPropertyIdGroups:o,getRecordValue:n,limit:r}=e,i=new u(r),a=p({startingBlock:t,relationPropertyIdGroups:o,receiver:i});let s=a.next();for(;!s.done;){const e=d.Ak.create();for(const t of s.value.recordPointers)e.setValue(t,n(t));s=a.next({recordMap:e})}return i.getBlockPointers()}(e).every((t=>Boolean(e.getRecordValue(t))))}var g=o(97880),h=o(6854),f=o(42937),y=o(80444),v=o(77080),b=o(35661),S=o(54642),_=o(64964),w=o(39699),k=o(85893);const x=100;function I(e){const{environment:t,store:o}=e;M({environment:t,store:o,change:{type:"date",...e}})}function C(e){const{environment:t,store:o}=e;M({environment:t,store:o,change:{type:"relation",...e}})}const T=new n.z(1);function M(e){const{environment:t,store:o,change:n}=e;if(!v.default.checkGate("dependency_date_shifting_by_space"))return;const l=o.getAssociatedCollectionStore();if(!l)return;const c=l.getDatabaseType(),d=l.getSchema(),p=l.getNormalizedDependencyDateShiftingConfig();if(!p)return;const u=l.getFormatStore().getKeyStore("collection_default_arrows_by").getValue();if(!u)return;const I=d[u];if("relation"!==(null==I?void 0:I.type))return;const C=I.property;C&&T.enqueue((()=>async function(e){var t,o;const{environment:n,store:l,dateShiftConfig:c,databaseType:d,blockedByPropertyId:p,blockingPropertyId:u,change:v,collectionSchema:I}=e,C={id:l.id,properties:l.getProperties()},T=null===(t=y.default.state.currentUserSettingsStore)||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.locale,M=(0,i.r)();let P,A,D;if("date"===v.type){var B;if(0===a.jV(a.oA([c.date_property,c.end_date_property]),a.oA([v.dateProperty.id,null===(B=v.otherDateProperty)||void 0===B?void 0:B.id])).length)return;const e=new Map;e.set(v.dateProperty.id,v.dateProperty),v.otherDateProperty&&e.set(v.otherDateProperty.id,v.otherDateProperty);const t=t=>{const o=e.get(t);if((0,g.$K)(o))return o;{var n;const e=null===(n=C.properties)||void 0===n?void 0:n[t];return{id:t,oldValue:e,newValue:e}}};P=t(c.date_property),(0,g.$K)(c.end_date_property)&&(A=t(c.end_date_property))}else if("relation"===v.type){if(v.relationPropertyId!==u&&v.relationPropertyId!==p)return;if("preserve_gap"===c.mode)return;P={id:c.date_property,oldValue:void 0,newValue:C.properties[c.date_property]},c.end_date_property&&(A={id:c.end_date_property,oldValue:void 0,newValue:C.properties[c.end_date_property]})}else(0,g.t1)(v);"preserve_gap"===c.mode?D=[[p,u]]:"consume_gap"===c.mode?D=[[p],[u]]:(0,g.t1)(c.mode);m({startingBlock:C,relationPropertyIdGroups:D,limit:x,getRecordValue:l.getRecordValue})?await Promise.resolve():await S.getTransitivePageRelations(n,{blockId:C.id,limit:x,relationPropertyIdGroups:D}).then((()=>{}));const R=(0,r.yu)({block:{id:C.id,properties:{...C.properties,...P.oldValue?{[P.id]:P.oldValue}:{},...null!==(o=A)&&void 0!==o&&o.oldValue?{[A.id]:A.oldValue}:{}}},blockingPropertyId:u,blockedByPropertyId:p,dateProperty:P,endDateProperty:A,getRecordValue:l.getRecordValue,timeZone:M,locale:T,options:c,collectionSchema:I,getRecordRole:l.getRecordRole}),{operations:E}=R;w.createAndCommit({userAction:"collectionDateActions.handleDependencyDateShifting",environment:n,perform:e=>{for(const t of E){const o=(0,b.Kv)(l,t.pointer);w.applyOperation({store:o,operation:t,transaction:e})}}});const F=(0,f.vi)({result:R,databaseType:d});F&&_.oV({label:(0,k.jsx)(s.FormattedMessage,{...F.message}),right:F.canUndo?(0,k.jsx)(h.ow,{}):void 0})}({environment:t,store:o,dateShiftConfig:p,databaseType:c,blockedByPropertyId:C,blockingPropertyId:u,change:n,collectionSchema:d}))).catch((e=>{console.error(e)}))}},31869:(e,t,o)=>{o.d(t,{gy:()=>S,kQ:()=>v,n7:()=>b,q0:()=>y,qK:()=>w,sf:()=>_});var n=o(80951),r=o(72126),i=o(71644),a=o(50906),s=o(9953),l=o(29376),c=o(77080),d=o(8406),p=o(16956),u=o(75134),m=o(45264),g=o(96802),h=o(39699);function f(e){const{environment:t,collectionStore:o,collectionPointer:n,property:r,name:i,autoRelate:a,limit:s,targetPropertyID:l,connectedRelation:c,transaction:d,hideByDefaultInUnconfiguredViews:p}=e,u={type:"relation",name:i,collection_id:n.id,collection_pointer:n,limit:"1"===s?1:void 0,property:l,version:"v2",autoRelate:a,connectedRelation:c,hideByDefaultInUnconfiguredViews:p};m.xO({environment:t,collectionStore:o,update:{[r]:u},transaction:d})}function y(e){const{environment:t,collectionStore:o,propertySchema:n,targetPropertyID:r,property:i,autoRelate:a,transaction:s}=e;m.xO({environment:t,collectionStore:o,update:{[i]:{...n,autoRelate:a,property:r,version:"v2"}},transaction:s})}function v(e){const{environment:t,collectionStore:o,property:n,transaction:i}=e,a=o.getSchema()[n];if(!a||"relation"!==a.type)return;const s=r.Xh(a);c.default.checkGate("two_way_property_clear_on_delete")&&(s.property=void 0),m.xO({environment:t,collectionStore:o,update:{[n]:null},transaction:i}),m.$N({collectionStore:o,update:{[n]:s},transaction:i})}function b(e){const{environment:t,collectionContextStore:o,collectionStore:n,property:r,propertyName:a,propertyLimit:s,targetCollectionStore:c,hasInverseRelation:u,inverseName:m,autoRelate:g,intl:h,connectedRelation:y,transaction:v,from:b}=e,S=c.pointer.id===n.id&&Boolean(u)?"separate_property":"same_property",_=l.KV(o,r),w="subitem"===b||void 0,k=function(e){const{environment:t,collectionContextStore:o,property:n,limit:r,collectionPointer:a,selfRelationType:s,oneWay:l,autoRelate:c,connectedRelation:d,transaction:p,hideByDefaultInUnconfiguredViews:u}=e,m=o.collectionStore();if(!m)return;const g=m.getSchema()[n];if(!g)return;const h=a.id===m.id?"same_property"===s?n:(0,i.ZP)():l?void 0:(0,i.ZP)();return f({environment:t,collectionStore:m,collectionPointer:a,property:n,name:g.name,autoRelate:c,limit:r,targetPropertyID:h,connectedRelation:d,transaction:p,hideByDefaultInUnconfiguredViews:u}),h}({environment:t,collectionContextStore:o,property:r,limit:s,collectionPointer:c.pointer,selfRelationType:S,oneWay:!u,autoRelate:g,connectedRelation:y,transaction:v,hideByDefaultInUnconfiguredViews:w});if((null==_?void 0:_.name)!==a&&(p.Bv({collectionStore:n,property:r,name:a,transaction:v}),d.$q({environment:t,collectionContextStore:o,property:r,from:"view_settings",action:"rename"})),u&&l.gZ(c)&&k){const e=l.rj({inverseName:m,collectionStore:n,propertySchema:_,intl:h,targetCollectionStore:c,from:b});f({environment:t,collectionStore:c,collectionPointer:n.pointer,property:k,name:e,autoRelate:g,limit:"no_limit",targetPropertyID:r,connectedRelation:y,transaction:v,hideByDefaultInUnconfiguredViews:w})}}function S(e){const{environment:t,collectionContextStore:o,property:n,hasInverseRelation:r,inverseName:a,autoRelate:s,intl:c,transaction:d}=e,u=l.KV(o,n);if(!u||"relation"!==u.type)return;const m=l.ny(o,u),g=o.collectionStore();if(!g||!m)return;const h=l.rj({inverseName:a,collectionStore:g,propertySchema:u,intl:c,targetCollectionStore:m});if(r&&!l.OP(o,n,m)){const e=(0,i.ZP)();y({environment:t,collectionStore:g,propertySchema:u,property:n,targetPropertyID:e,autoRelate:s,transaction:d}),f({environment:t,collectionStore:m,collectionPointer:g.pointer,property:e,name:h,autoRelate:s,limit:"no_limit",targetPropertyID:n,transaction:d,hideByDefaultInUnconfiguredViews:void 0})}else if(r){const e=u.property;if(!e)return;p.Bv({collectionStore:m,property:e,name:h,transaction:d}),s&&(p.bL({collectionStore:g,property:n,autoRelate:s,transaction:d}),p.bL({collectionStore:m,property:e,autoRelate:s,transaction:d}))}else{s&&p.bL({collectionStore:g,property:n,autoRelate:s,transaction:d});const e=u.property;if(!e)return;y({environment:t,collectionStore:g,propertySchema:u,property:n,targetPropertyID:void 0,autoRelate:s,transaction:d}),v({environment:t,collectionStore:m,property:e,transaction:d})}}function _(e){var t;const{store:o,propertyId:r,value:i,environment:a,relatedPageId:l,propertySchema:c,transaction:p,collectionContextStore:m,analyticsData:g,isUnthrottled:h}=e,{analyticsFrom:f,isFromBulkActionsToolbar:y}=g,v=o.getPropertyStore(r),b=n.ow(i);s.sO({store:v,value:b,transaction:p}),d.rv({environment:a,block_id:l,property:r,property_type:c.type,from:f,collectionContextStore:m,isFromBulkActionsToolbar:y,isUnthrottled:h,integration_id:null===(t=c.connectedRelation)||void 0===t?void 0:t.integration_id,action:"remove"}),u.r({environment:a,store:o,relationPropertyId:r})}function w(e){const{propertyFormat:t,visibility:o,collectionStore:r,property:i,environment:s}=e,c=t.property,d=l.U1({collectionStore:r,property:i}),p=(0,n.pX)(d,c,!o),u={...l.ZI(r)};u[i]||(u[i]={}),u[i].related_properties=p,h.createAndCommit({userAction:"collectionRelationActions.updateRelationPropertyVisibility",environment:s,perform:e=>{g.FH({stores:[r],update:{collection_relation_options:u},transaction:e})}}),a.P$y(s,{collection_id:r.id,property_id:i,related_property_id:c,visible:!o})}},5149:(e,t,o)=>{o.d(t,{E3:()=>O,FK:()=>U,H4:()=>L,NG:()=>j,Ol:()=>H,R0:()=>K,TT:()=>z,iN:()=>G,nr:()=>$,qU:()=>q,r$:()=>N,wl:()=>Z,z$:()=>V,zt:()=>W});o(67294);var n=o(1302),r=o(15145),i=o(41432),a=o(45433),s=o(59730),l=o(15157),c=o(29477),d=o(21202),p=o(15047),u=o(29369),m=o(63143),g=o(5366),h=o(95477),f=o(93959),y=o(81849),v=o(84210),b=o(33929),S=o(16402),_=o(77907),w=o(80444),k=o(8406),x=o(54642),I=o(14871),C=o(45264),T=o(47307),M=o(96802),P=o(19785),A=o(9953),D=o(42858),B=o(64964),R=o(39699),E=o(85893);const F=(0,g.defineMessages)({copySuccessMessage:{defaultMessage:"Link to view copied to clipboard",id:"database.viewSettings.copyLinkSnackBarItem.title"}});function N(e){const{collectionContextStore:t,selectViewNameInitial:o,collectionSettingsStore:n,hideSettingsPopup:r,fromBlock:i}=e,a=t.hasSingleCollection()&&!t.collectionStore()?{type:"createViewSource"}:{type:"main",selectViewNameInitial:o};n.setState({open:!0,hideSettingsPopup:r,stack:[a],fromBlock:i})}function j(e){const{collectionSettingsStore:t}=e;Z({collectionSettingsStore:t,item:{type:"createSyncedViewSource"}})}function O(e){const{collectionSettingsStore:t}=e;t.setState({...t.state,open:!1,hideSettingsPopup:void 0,stack:[]})}function L(e){const{collectionSettingsStore:t,item:o,hideSettingsPopup:n}=e,r=t.state;t.setState({...r,open:!0,stack:[...r.stack,o],...void 0!==n?{hideSettingsPopup:n}:{}})}function U(e){const{collectionSettingsStore:t,item:o}=e,n=t.state;t.setState({open:!0,stack:[...n.stack.slice(0,n.stack.length-1),o]})}function Z(e){const{collectionSettingsStore:t,item:o}=e;t.setState({open:!0,stack:[o]})}function V(e){const{collectionSettingsStore:t}=e,o=t.state,n=o.stack.slice(0,o.stack.length-1);0===n.length?O({collectionSettingsStore:t}):t.setState({open:!0,stack:n})}function q(e){const{collectionSettingsStore:t,property:o,formatKey:n,selectNameInitial:r}=e,i=t.state,a=i.stack.findIndex((e=>"property"===e.type));t.setState({open:!0,stack:[...a>=0?i.stack.slice(0,a):i.stack,{type:"property",property:o,formatKey:n,selectNameInitial:r}]})}function z(e){const{environment:t,collectionContextStore:o,collectionViewStore:n,collectionSettingsStore:r,from:i}=e,a=(0,c.UZ)();return T.showDialog({showCancel:!0,keepFocus:!1,message:(0,E.jsx)(g.FormattedMessage,{defaultMessage:"Are you sure you want to delete this view?",id:"database.viewSettings.mainTab.deleteViewConfirm.text"}),items:[{label:(0,E.jsx)(g.FormattedMessage,{defaultMessage:"Delete view",id:"database.viewSettings.deleteButton.text"}),color:"red",onAccept:()=>{const e=o.collectionViewStore(),s=o.collectionViewBlockStore(),l=o.isFullScreen.state,c=n.getType();e&&s&&c&&(R.createAndCommit({userAction:"collectionSettingsActions.handleDeleteCollectionView",environment:t,perform:a=>{if(C.dp({collectionViewBlockStore:s,collectionViewStore:n,transaction:a}),O({collectionSettingsStore:r}),e.id===n.id){const e=s.getCollectionViewStores()[0];e?C.f8({environment:t,collectionContextStore:o,collectionViewId:e.id,isFullScreen:o.isFullScreen.state,isRootChild:o.isRootChild.state,isInPeekRenderer:o.isInPeekRenderer.state}):(C.ME({environment:t,collectionContextStore:o,transaction:a}),l||D.Cl({environment:t,blocks:[s],transaction:a}))}k.Rc({environment:t,collectionContextStore:o,view_type:c,from:i})}}),a.resolve(!0))}}],handleCancel:()=>a.resolve(!1)}),a.promise}function W(e){const{environment:t,collectionContextStore:o,collectionViewStore:r,collectionSettingsStore:i,intl:a}=e,s=o.isFullScreen.state,l=o.isRootChild.state,c=o.isInPeekRenderer.state,{performResult:d}=R.createAndCommit({userAction:"collectionSettingsActions.newView",environment:t,perform:e=>C.tG({environment:t,collectionContextStore:o,collectionViewStore:r,collectionSettingsStore:i,intl:a,transaction:e})});d&&(C.f8({environment:t,collectionContextStore:o,collectionViewId:d.id,isFullScreen:s,isRootChild:l,isInPeekRenderer:c}),n.default.afterNextFlush((()=>{N({collectionContextStore:o,collectionSettingsStore:i,selectViewNameInitial:!0})})))}async function H(e){const{environment:t,collectionContextStore:o,collectionViewStore:n}=e,i=o.collectionViewBlockStore();if(!n||!i)return;const a=(0,v.ZP)({store:i,collectionViewId:n.id,fullyQualified:!0,pageVisitSource:r.tY.CopyLink});await I.RD({environment:t,stringValue:a,copiedMessage:I.tq.copiedLinkToClipboard}),B.oV({label:b.default.formatMessage(F.copySuccessMessage)})}function G(e){const{environment:t,collectionContextStore:o}=e,n=o.normalizedFormatStore.state.board_columns_by,r=o.collectionViewStore();if(!n||!r)return;const i=!(0,y.h6)(t,o);R.createAndCommit({userAction:"collectionSettingsActions.handleBoardGroupColorColumnsClick",environment:t,perform:e=>{M.FH({stores:[r],update:{board_columns_by:{...n,disableBoardColorColumns:i}},transaction:e})}}),k.wd({environment:t,collectionContextStore:o,action:"toggle_group_color_columns"})}async function K(e){const{environment:t,uri:o,botId:n,collectionId:r,isStale:i,nextSync:a,setNextSync:c}=e;if(!a||Date.now()>a){var d;let e=Date.now()+m.U6;const a=await x.resubscribeExternalCollection(t,{botId:n,uri:o,isStale:i,collectionId:r});if("failed"===a.type&&(0,s.A6)(a.body)&&"rate_limited"===(null===(d=a.body.clientData)||void 0===d?void 0:d.type)){const t=a.body.clientData.retryAfter;t&&(e=Date.now()+t*m.C0),B.oV({label:(0,E.jsx)(g.FormattedMessage,{id:"database.viewSettings.syncedSourceTab.update.rateLimitError",defaultMessage:"This database was synced recently. You may try again in {time}.",values:{time:(0,S.hH)(Date.now(),e)}})})}if(h.default.isAdminMode)return;l.Z.set({userId:t.currentUser.id,key:`${n}:${o}`,value:e}),c(e)}}async function $(e){const{appTemplatesSetupActions:t,appConfigs:o}=await _.deps.AppTemplates.loader(),{environment:r,selectedDBType:s,collectionName:l,collectionContextStore:c,collectionViewBlockStore:m,collectionViewStore:g,useTemporaryRecordCache:h,temporaryRecordCache:y,baseViewType:v}=e,{currentSpaceViewStore:b}=w.default.state;let S=g,x=m,I=m.getParentStore();var T;h&&(S=g.clone(y),x=m.clone(y),I=null===(T=m.getParentStore())||void 0===T?void 0:T.clone(y));if(s===a.br)k.wd({environment:r,collectionContextStore:c,action:"select_new_collection"}),R.createAndCommit({userAction:"CollectionSettingsNewDBType.handleCreateDB",environment:r,perform:e=>{if(h){A.sW({store:S,data:{name:void 0,format:void 0,query2:void 0,type:v??"table"},transaction:e}),A.sW({store:x,data:{properties:void 0},transaction:e});const t=x.getCollectionViewSourceCollectionStore();t&&C.A9({collectionViewBlockStore:x,collectionStore:t,transaction:e})}C.TM({environment:r,collectionViewStore:S,collectionViewBlockStore:x,name:l,transaction:e});const t=x.getCollectionViewSourceCollectionStore();c.setContext({type:"collectionView",collectionViewBlockStore:m,collectionStore:t,collectionViewStore:g})}}),n.default.afterNextFlush((()=>{C.W1({environment:r,collectionContextStore:c})}));else{const e=s,n=(0,f.YB)(o(),e);if(!n)return;const a=(0,f.Zu)(n,e);if(!a)return;R.createAndCommit({userAction:"CollectionSettingsNewDBType.handleCreateDB",environment:r,perform:e=>{if(!I||I.table!==p.bx&&I.table!==u.e0&&I.table!==d.iU||!b)return;if(!h&&y){r.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(y);x.getCollectionViewStores().forEach((t=>C.dp({collectionViewBlockStore:x,collectionViewStore:t,transaction:e})))}const s=(0,f.KC)(o(),a);t.applyFeatures({environment:r,spaceViewStore:b,appParentStore:I,appUri:n.uri,features:s,createOrModify:"create",initializeStore:x,transaction:e});const l=x.getCollectionViewSourceCollectionStore();if(l){const t=I.table===p.bx?I.id:I.getSpaceId();if(!t)return;for(let n=0;n<3;n++){const o=A.j4({environment:r,type:i.Ti.page,inMemoryRecordCache:x.inMemoryRecordCache,transaction:e,spaceId:t,useCrdt:!1});P.zw({childStore:o,parentStore:l,transaction:e})}const o=x.getCollectionViewStores()[0];c.setContext({type:"collectionView",collectionViewBlockStore:m,collectionStore:l,collectionViewStore:o}),c.filtersBarOpen.setState(!1)}}})}}},87085:(e,t,o)=>{o.d(t,{G0:()=>E,Jw:()=>j,K7:()=>F,PW:()=>N});o(57658),o(21703);var n=o(90559),r=o(99036),i=o(45433),a=o(77657),s=o(74181),l=o(72126),c=o(21202),d=o(9844),p=o(15047),u=o(29369),m=o(97880),g=o(5366),h=o(93959),f=o(78316),y=o(33929),v=o(77907),b=o(80444),S=o(77080),_=o(30874),w=o(35661),k=o(8406),x=o(54642),I=o(74882),C=o(16956),T=o(31869),M=o(5149),P=o(45264),A=o(28673),D=o(96802),B=o(39699);const R=(0,g.defineMessages)({aiCustomPromptDefaultPropertyName:{id:"collectionSettingsCreatePropertyActions.createProperty",defaultMessage:"Text"}});async function E(e){var t;const{appTemplatesSetupActions:o,appTemplatesSprintBoardActions:r,appConfigs:l}=await v.deps.AppTemplates.loader(),{environment:m,collectionContextStore:g,feature:f}=e,{currentSpaceViewStore:y}=b.default.state,C=g.collectionStore(),T=g.collectionViewStore(),P=null==C?void 0:C.getParentBlockStore(),R=null==P?void 0:P.getParentStore(),E=null==C||null===(t=C.getFormat())||void 0===t?void 0:t.app_config_uri,F=E&&(0,h.YB)(l(),E);if(!C||!P||!R||R.table!==p.bx&&R.table!==c.iU&&R.table!==u.e0||!F)return;const N=C.getSchema(),j=P.getFormat().app_id,O=j?await x.getCollectionViewBlocksByAppId(m,{spaceId:P.getSpaceId(),appId:j}):void 0,L="success"===(null==O?void 0:O.type)&&O.data.result.length?O.data.result.map((e=>w.G.createChildStore(R,{table:c.iU,id:e.blockId,spaceId:P.getSpaceId()}))):[P],U=f.integrationId;if(U){const e=_.Z.getIntegrationsAsRecordMap().getValue({table:d.K2,id:U});if(!e||!(0,s.VM)(e))return;await A.V(m,C,e,Boolean(f.canOnlyAdminAuth))}U===a.U9&&N&&0===(0,n.$z)(N).length&&await I.K({environment:m,collectionStore:C});const Z=Date.now();B.createAndCommit({environment:m,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewSuggestedProperty",perform:e=>{var t;if(!F||!y)return;const n=null===(t=C.getFormat())||void 0===t?void 0:t.app_config_uri;if(!n)return;const a=o.applyFeatures({environment:m,spaceViewStore:y,appParentStore:R,appUri:F.uri,features:[{type:"simple",featureUri:f.uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:L});r.createSprintPage({environment:m,spaceViewStore:y,appParentStore:R,transaction:e,blockStores:a,creationEntryPoint:{type:"sprint_relation"}});const s=S.default.checkGate("collection_level_subitems_setting");if("notion://tasks/sub_task_feature"===f.uri&&(D.FH({stores:[C],update:{...s?{subitem_property:i.Es.SubTaskRelation}:{},collection_default_subitem:i.Es.SubTaskRelation},transaction:e}),T&&D.FH({stores:[T],update:{collection_view_subitem:{property:i.Es.SubTaskRelation}},transaction:e})),"notion://tasks/task_dependencies_feature"===f.uri&&(D.FH({stores:[C],update:{collection_default_arrows_by:i.Es.BlockingRelation},transaction:e}),T&&D.FH({stores:[T],update:{timeline_arrows_by:{property:i.Es.BlockingRelation}},transaction:e})),"dependencies"in f&&f.dependencies.forEach((e=>{"property"===e.type&&e.collectionUri===n&&k._H({environment:m,collectionContextStore:g,from:"view_settings",property:e.uri,property_type:e.propertySchema.type})})),"dependencies"in f&&f.dependencies.map((e=>e.type)).every((e=>"property"===e))){const t=g.collectionViewStore(),o=g.getPropertyFormatKey(),n=g.normalizedFormatStore.state;if(o&&t){const r=n[o]||[],i=[...r];f.dependencies.forEach((e=>{const t=r.findIndex((t=>t.property===e.uri));-1===t?i.push({visible:!0,property:e.uri}):i[t]={...r[t],visible:!0}})),D.FH({stores:[t],update:{[o]:i},transaction:e})}}if(void 0!==f.propertyIdCollectionSettingToNavigateTo){const e={type:"property",property:f.propertyIdCollectionSettingToNavigateTo,selectNameInitial:!1,formatKey:g.getPropertyFormatKey()};M.H4({collectionSettingsStore:g.settingsStore,item:e})}else M.E3({collectionSettingsStore:g.settingsStore});e.postSubmitCallbacks.push((e=>{k.mH(m,{collection_uri:f.collectionUri,feature_uri:f.uri,time:Date.now()-Z,status:Boolean(e)?"fail":"success"})}))}})}function F(e){let{propertyType:t,collectionContextStore:o,propertyId:n}=e;switch(t){case"ai_custom_prompt":case"ai_summary":case"ai_extract":case"ai_translate":return M.H4({collectionSettingsStore:o.settingsStore,item:{type:"propertyAiAutofill",propertySchema:o.normalizedSchemaStore[n],property:n}});default:(0,m.t1)(t)}}function N(e){const{environment:t,collectionContextStore:o,propertyType:n,propertyName:i,from:a}=e,s=o.collectionStore(),l=o.collectionViewStore(),c=o.getPropertyFormatKey();if(!s||!c)return;if("relation"===n)return void M.H4({collectionSettingsStore:o.settingsStore,item:{type:"selectRelationSource",property:void 0,formatKey:"collection_page_properties"}});let d=i;"ai_custom_prompt"===n&&(d=y.default.formatMessage(R.aiCustomPromptDefaultPropertyName));const{performResult:p}=B.createAndCommit({userAction:"collectionSettingsCreatePropertyActions.handleCreateNewStandardProperty",environment:t,perform:e=>C.G3({environment:t,collectionStore:s,collectionViewArgs:l?{collectionViewStore:l,format:l.getFormat(),formatKey:c}:void 0,propertyName:d,propertyType:n,transaction:e})});(0,r.XU)(n)?F({propertyType:n,propertyId:p,collectionContextStore:o}):M.qU({collectionSettingsStore:o.settingsStore,property:p,formatKey:c,selectNameInitial:!0}),k._H({environment:t,collectionContextStore:o,from:a,property_type:(0,r.TN)(n)})}async function j(e){const{environment:t,collectionContextStore:o,intl:i,connectedRelationProperty:s}=e,c=o.collectionStore(),d=o.collectionViewStore(),p=o.getPropertyFormatKey();if(!c||!p)return;const u=s.integration.id;[a.f3,a.mQ].includes(u)||await A.V(t,c,s.integration,Boolean(s.canOnlyAdminAuth));const g=c.getSchema();let h;s.integration.id===a.U9&&g&&0===(0,n.$z)(g).length&&(h=await I.K({environment:t,collectionStore:c})),B.createAndCommit({environment:t,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewConnectedRelationProperty",perform:e=>{h&&C.G3({environment:t,collectionStore:c,collectionViewArgs:d?{collectionViewStore:d,format:d.getFormat(),formatKey:p}:void 0,propertyType:"auto_increment_id",transaction:e});const n=c.getDeletedSchema(),u=(0,m.qP)(n).map((e=>{let[t,o]=e;if(o&&r.NK(o)&&o.connectedRelation.integration_id===a.U9)return{propertyId:t,propertySchema:o}})).filter(m.$K);if(!l.xb(u)){const{propertyId:r}=u[0],i=(0,f.D8)({deletedSchema:n,property:r});if(!i)throw new Error("Deleted property schema was not found");P.xO({environment:t,collectionStore:c,update:i.updateSchema,transaction:e}),P.$N({collectionStore:c,update:i.updateDeletedSchema,transaction:e});const a={type:"property",property:r,formatKey:p};return void M.H4({collectionSettingsStore:o.settingsStore,item:a})}const g=A.c({environment:t,pattern:s.pattern,integration:s.integration,parentCollectionStore:c,transaction:e}),y=C.G3({environment:t,collectionStore:c,collectionViewArgs:d&&p?{collectionViewStore:d,format:d.getFormat(),formatKey:p}:void 0,propertyType:"relation",transaction:e});T.n7({environment:t,collectionContextStore:o,collectionStore:c,property:y,propertyName:s.name,propertyLimit:"no_limit",targetCollectionStore:g,hasInverseRelation:!0,autoRelate:void 0,intl:i,connectedRelation:{integration_id:s.integration.id},transaction:e});const v={type:"property",property:y,formatKey:p};M.H4({collectionSettingsStore:o.settingsStore,item:v}),k._H({environment:t,collectionContextStore:o,from:"view_settings",property_type:"relation",integration_id:s.integration.id})}})}},98834:(e,t,o)=>{o.d(t,{$p:()=>M,R5:()=>C,Zh:()=>I,nx:()=>x,ob:()=>T});o(21703),o(57658);var n=o(41432),r=o(76837),i=o(42875),a=o(23867),s=o(70203),l=o(5366),c=o(33929),d=o(18245),p=o(94896),u=o(35661),m=o(50906),g=o(54642),h=o(47307),f=o(54532),y=o(96802),v=o(94419),b=o(9953),S=o(98724),_=o(29373);const w=(0,l.defineMessages)({duplicateTemplateError:{id:"databaseTemplatePickerActions.duplicateTemplateFailedError.message",defaultMessage:"Duplicate template failed."}});function k(e){const{environment:t,pageStore:o,copiedFromPointer:n,useInMemoryRecordCache:s,addCopyName:l,transaction:d,resolveTemplateVariables:m}=e,y=new u.G(t,n,{inMemoryRecordCache:s});if(s){const e=f.K8(t,{blockId:y.id,inMemoryRecordCache:y.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!0});if(!e)throw new Error("Client copy could not be created.");f.E9({environment:t,sourceBlockId:y.id,targetBlockPointer:o.pointer,sourceBlockSubtree:e,targetInMemoryRecordCache:o.inMemoryRecordCache,addCopyName:l,transaction:d,deepCopyTransclusionContainers:!1,resolveTemplateVariables:m,useCrdt:o.useCrdt()})}else{if(b.sW({store:o.getPropertiesStore(),data:y.getProperties(),transaction:d}),m&&S.bt({store:o,context:{currentUserId:t.currentUser.id,currentTimeZone:(0,i.r)()},transaction:d}),l){const e=o.getTitleStore();e&&b.sO({store:e,value:r.eb(e.getValue()),transaction:d})}const e={copied_from:n.id};b.sW({store:o,data:e,transaction:d});const s={...y.getFormat(),copied_from_pointer:n};delete s.automation_id,delete s.app_config_uri,b.sW({store:o.getFormatStore(),data:s,transaction:d}),y.hasContent()&&(p.Z.setStatus(o.id,!0),d.postSubmitCallbacks.push((async e=>{if(e)return h.showErrorMessage(c.default.formatMessage(w.duplicateTemplateError)),void p.Z.setStatus(o.id,!1);await g.duplicateBlock(t,{sourceBlocks:[{id:n.id,spaceId:(0,a.C)(n.spaceId)}],targetBlocks:[{id:o.id,spaceId:(0,a.C)(o.pointer.spaceId)}],addCopyName:l,appendContentOnly:!0,isTemplateInstantiation:!0,resolveTemplateVariables:!!m&&{currentUserId:t.currentUser.id,currentTimeZone:(0,i.r)()},deepCopyTransclusionContainers:!1}).next().finally((()=>{p.Z.setStatus(o.id,!1)}))})))}return o}function x(e){const{environment:t,collectionStore:o,transaction:r,title:i}=e,a=b.j4({environment:t,type:n.Ti.page,inMemoryRecordCache:o.inMemoryRecordCache,transaction:r,spaceId:o.getTemplatePagesStore().pointer.spaceId,properties:{title:(0,s.TPx)(i||"")},useCrdt:!1});return b.sW({store:a,data:{is_template:!0},transaction:r}),v.R3({parent:o.getTemplatePagesStore(),append:a,transaction:r}),a}function I(e){const{environment:t,collectionStore:o,templateStore:r,transaction:i}=e,a=b.j4({environment:t,type:n.Ti.page,inMemoryRecordCache:r.inMemoryRecordCache,transaction:i,spaceId:o.getTemplatePagesStore().pointer.spaceId,useCrdt:!1});b.sW({store:a,data:{is_template:!0},transaction:i}),v.BE({parent:o.getTemplatePagesStore(),after:r,insert:a,transaction:i});try{k({environment:t,copiedFromPointer:r.pointer,pageStore:a,addCopyName:!0,transaction:i,resolveTemplateVariables:!1})}catch(s){h.showErrorMessage(c.default.formatMessage(w.duplicateTemplateError))}return a}function C(e){const{collectionStore:t,templateStore:o,transaction:n}=e;v.Od({parent:t.getTemplatePagesStore(),childToRemove:o,transaction:n})}function T(e){const{environment:t,store:o,templateStore:n,title:r,isKeyboard:i,isCreateIn:a,transaction:s,from:l}=e,c=o.getProperties(),p=d.default.mark("rum.initialize_collection_template");if(k({environment:t,pageStore:o,copiedFromPointer:n.pointer,useInMemoryRecordCache:o.inMemoryRecordCache!==t.defaultRecordCache.inMemoryRecordCache?o.inMemoryRecordCache:void 0,transaction:s,resolveTemplateVariables:!0}),"template"!==r){const e="empty"===r?null:r.text;b.sW({store:o.getPropertiesStore(),data:{title:e},transaction:s})}b.sW({store:o.getPropertiesStore(),data:c,transaction:s}),b.sW({store:o,data:{is_template:null},transaction:s}),y.Wq({environment:t,store:o,isLocked:!1,transaction:s}),0===n.getContentLength()&&_.ls({environment:t,store:o,transaction:s}),d.default.measure(p,{environment:t}),m.XQ5(t,{template_id:n.id,collection_id:n.getParentId(),is_keyboard:i,is_create_in:a,from:l})}function M(e){const{collectionStore:t,newTemplateIds:o,transaction:n}=e;b.sW({store:t,data:{template_pages:o},transaction:n})}},45264:(e,t,o)=>{o.d(t,{zz:()=>pt,TM:()=>dt,wG:()=>kt,MO:()=>It,pi:()=>vt,ME:()=>Qe,Ki:()=>Tt,HW:()=>mt,dp:()=>Je,ob:()=>He,IH:()=>Ct,tG:()=>Ye,dj:()=>ft,lG:()=>Pt,oh:()=>bt,C_:()=>gt,mS:()=>ht,fI:()=>Mt,A9:()=>ut,Wu:()=>Xe,mc:()=>We,Ip:()=>st,n1:()=>lt,W1:()=>wt,bu:()=>Dt,f8:()=>_t,t5:()=>Ge,Z5:()=>xt,Rm:()=>ot,$N:()=>rt,$D:()=>St,xO:()=>nt,iG:()=>et,Uy:()=>at,Es:()=>tt,yc:()=>ct,z2:()=>it,Ug:()=>Ke});o(21703),o(57658);var n=o(30120),r=o(1302),i=o(15145),a=o(41432),s=o(14248),l=o(76205),c=o(14714),d=o(99036),p=o(43690),u=o(10070),m=o(28155),g=o(45433),h=o(21202),f=o(97880);function y(e){switch(e){case"trending":case"similarUsers":return{title:{name:"Name",type:"title"}};case"myTasks":return{};default:(0,f.t1)(e)}}function v(e){let{source:t,collectionId:o}=e;const{type:n}=t;return{id:o,parent_table:h.iU,parent_id:n,version:1,alive:!0,space_id:t.spaceId,format:{},schema:y(n)}}var b=o(53877),S=o(93824),_=o(76837),w=o(6695),k=o(68626),x=o(42875),I=o(60310),C=o(74229),T=o(15157),M=o(72126),P=o(77897),A=o(59753),D=o(29477),B=o(4615),R=o(71644),E=o(45953),F=o(23014),N=o(98963),j=o(18844),O=o(6287),L=o(13493),U=o(23867),Z=o(54153),V=o(70203),q=o(63143),z=o(5366),W=o(2553),H=o(23823),G=o(28020),K=o(42),$=o(97004),Y=o(75079),Q=o(81849),J=o(52821),X=o(26991),ee=o(78316),te=o(77181);function oe(e){return e.teamId?`${e.collectionViewId}-${e.teamId}`:e.collectionViewId}const ne=new class{constructor(){this.cache=new Map}get(e){const t=oe(e);return this.cache.get(t)}set(e,t){const o=oe(e);for(this.cache.delete(o),this.cache.set(o,t);this.cache.size>25;){const e=this.cache.keys().next().value;this.cache.delete(e)}}};var re=o(33929),ie=o(45950),ae=o(89796),se=o(18514),le=o(77546),ce=o(18245),de=o(14654),pe=o(94841),ue=o(58202),me=o(5162),ge=o(80444),he=o(17746),fe=o(886),ye=o(6776),ve=o(19511),be=o(88632),Se=o(77080),_e=o(79167),we=o(37598),ke=o(5315),xe=o(35661),Ie=o(27724),Ce=o(54642),Te=o(49865),Me=o(5149),Pe=o(41433),Ae=o(47307),De=o(96802),Be=o(94419),Re=o(92625),Ee=o(19785),Fe=o(9953),Ne=o(4408),je=o(75018),Oe=o(80402),Le=o(98104),Ue=o(39699),Ze=o(61202),Ve=o(53471);const qe=(0,z.defineMessages)({importingCSV:{id:"databaseViewActions.importingCSV.loadingMessage",defaultMessage:"Importing"},uploadingCSV:{id:"databaseViewActions.uploadingCSV.loadingMessage",defaultMessage:"Uploading"},importFailed:{id:"databaseViewActions.importFailedError.message",defaultMessage:"Import failed."}}),ze=(0,z.defineMessages)({renameButtonTitle:{defaultMessage:"Rename",id:"database.collectionEditViewButtonPopup.renameButtonTitle"},statusName:{defaultMessage:"Status",id:"database.collectionEditViewButtonPopup.statusNameProperty"},dateName:{defaultMessage:"Date",id:"database.collectionEditViewButtonPopup.dateNameProperty"}});function We(e){const{environment:t,collectionViewBlockStore:o,collectionViewStore:i,collectionStore:a,collectionContextStore:s,isFullScreen:c,isRootChild:d,isInPeekRenderer:p}=e;He({collectionContextStore:s}),c&&(je.resetPageState(t),je.resetEditorState(t));const{remoteRequestStore:u,localResultStore:g}=s;if(i){var h;const e=Boolean(!s.isViewSpecificClientModeEnabled.state&&s.isClientModeEnabled.state&&a&&a.id===(null===(h=s.collectionStore())||void 0===h?void 0:h.id)),y=n.ou.fromMillis(he.Z.getLocalDateRangeStart({collectionViewId:i.id,currentUserId:t.currentUser.id}));let v;const S=()=>{r.default.afterNextFlush((()=>{const e=u.state;s.isViewSpecificClientModeEnabled.state&&v&&e&&!M.Xy(v.loader.filter,e.loader.filter)&&(s.isClientModeEnabled.setState(!1),s.isViewSpecificClientModeEnabled.setState(!1));const n=function(e,t){if(void 0===t)return;if(void 0===e)return"initial_load";if(!M.Xy(e.collectionView,t.collectionView))return"change_view";if(!M.Xy(e.loader.searchQuery,t.loader.searchQuery))return"change_search";if(!M.Xy(e.loader.sort,t.loader.sort))return"change_sort";if(!M.Xy(e.loader.filter,t.loader.filter))return"change_filter";const o=e&&"reducer"===e.loader.type&&e.loader.reducers||{},n=t&&"reducer"===t.loader.type&&t.loader.reducers||{};if(Object.keys(n).find((e=>{const t=o[e],r=n[e];return r&&(!t||!M.Xy(t,r))})))return"change_group";const r={reducers:void 0,filter:void 0,sort:void 0,reducerDependencies:void 0},i={...null==e?void 0:e.loader,...r},a={...null==t?void 0:t.loader,...r};return M.Xy(i,a)?void 0:"change_loader"}(v,e);void 0===n||s.isClientModeEnabled.state&&!function(e,t,o,n){if(!o)return!1;if(null!=t&&t.loader.filter&&(0,l.SH)(null==t?void 0:t.loader.filter,(e=>(0,l.aN)(e)&&(0,F.zy)(e,o.getSchema()))))return!0;return(0,X.ki)(null==t?void 0:t.loader.reducers,o.getSchema(),n)}(0,e,a,o)||ft(t,s,{src:n}),v=e}))};u.addListener(S);const _=()=>{if((0,P.lB)(1)){const e=ce.default.mark("database_update_lag");ce.default.measureAfterNextFlush(e,{environment:t})}};g.addListener(_),s.remoteResult.setState(void 0),s.remoteCollectionIds.setState([]),s.isLoaded.setState(!1),s.searchQuery.setState(""),s.searchOpen.setState(!1),s.calendarByMenuOpen.setState(!1),s.timelineByMenuOpen.setState(!1),s.isFullScreen.setState(c),s.isRootChild.setState(d),s.reducers.setState({}),s.groupsStore.reset(),s.groupsLimit.setState(Q.XD),s.boardColumnsLimit.setState(Q.XD),s.filtersBarOpen.setState(void 0),s.isInPeekRenderer.setState(p),s.subitemExpandedStore.setState(new Map),s.isClientModeEnabled.setState(e),s.isViewSpecificClientModeEnabled.setState(!1),s.asyncAggregationStatus.reset(),s.dateRangeStart.setState((0,b.IS)(y.startOf("month").valueOf(),G.AK.state).valueOf()),s.dateRangeEnd.setState(c&&!t.device.isMobile?(0,b.V7)(y.endOf("month").plus({month:1}).valueOf(),G.AK.state).valueOf():(0,b.V7)(y.endOf("month").valueOf(),G.AK.state).valueOf());const w=null==i?void 0:i.getFormat(),k=null==w?void 0:w.collection_view_source;"typed"===(null==k?void 0:k.type)?s.setContext({type:"collectionTypedView",collectionViewBlockStore:o,databaseType:k.databaseType,collectionViewStore:i,pageVisitSourceOverride:(0,de.ib)({blockOrCollectionId:i.id})}):(0,m.nx)(k)?a&&s.setContext({type:"collectionVirtualView",collectionViewBlockStore:o,collectionViewStore:i,collectionStore:a,pageVisitSourceOverride:(0,de.ib)({blockOrCollectionId:i.id})}):k&&"collection"!==k.type?(0,f.t1)(k):s.setContext({type:"collectionView",collectionViewBlockStore:o,collectionStore:a,collectionViewStore:i}),s.remoteRequestStoreCallback=S,s.localResultStoreCallback=_;const x=Rt(i),I=ne.get(x);I&&(s.resetLoadingState(),s.resultSet.setState(M.Xh(I.resultSet)),s.remoteCollectionIds.setState(M.Xh(I.collectionIds)),s.remoteResult.setState(M.Xh(I.remoteResult)),s.isLoaded.setState(!0));const C=ke.transactionQueue.isPendingTransactionForRecord(i.pointer);s.wasCreatedThisSession.setState(C);const A=function(e){let{currentUserId:t,collectionViewId:o}=e;const n=T.Z.get({userId:t,key:Bt(o)});if(n)return(0,q.dj)(n)}({currentUserId:t.currentUser.id,collectionViewId:i.id});s.temporaryState.setState(A||{});const{currentSpaceStore:D}=ge.default.state;if(a&&D&&a.getSpaceId()===D.id&&a.isDefaultRecordCache()){!function(e){let{currentUserId:t,spaceId:o,collectionId:n}=e;const r=Pt({currentUserId:t,spaceId:o}),i=M.jj([n,...r]).slice(0,10);T.Z.set({userId:t,key:At(o),value:JSON.stringify(i)})}({currentUserId:t.currentUser.id,spaceId:D.id,collectionId:a.id})}c&&(a&&o.getCollectionViewSourceCollectionStore()&&!a.getName()&&(!t.device.isMobile||se.NW(t)||(0,me.Y)("supportsUntitledPageAutoSelectOnStart"))?wt({environment:t,collectionContextStore:s}):!a&&s.hasSingleCollection()&&Me.r$({collectionContextStore:s,collectionSettingsStore:s.settingsStore})),s.frozoneStore.setState({isScrolled:!1,scrollerWidth:void 0,scrollerLeftOffset:void 0,frozenIndex:void 0,tryShowHiddenFrozenColumn:!1})}}function He(e){const{collectionContextStore:t}=e,{localResultStore:o,remoteRequestStore:n,remoteRequestStoreCallback:r,localResultStoreCallback:i}=t;r&&n.removeListener(r),i&&o.removeListener(i)}function Ge(e){const{dateRangeStart:t,dateRangeEnd:o,collectionContextStore:n}=e;n.dateRangeStart.setState(t),n.dateRangeEnd.setState(o)}function Ke(e){const{searchQuery:t,collectionContextStore:o}=e;o.collectionViewStore()&&(o.searchQuery.setState(t||""),o.groupsStore.resetAllLimits())}function $e(e){const{environment:t,collectionViewBlockStore:o,collectionView:n,transaction:r}=e,i=Fe.ae({environment:t,table:L.n,value:n,inMemoryRecordCache:o.inMemoryRecordCache,transaction:r}),a=xe.Xr.createChildStore(o,{table:L.n,id:i.id,spaceId:o.getSpaceId()});return Be.R3({parent:o.getCollectionViewsStore(),append:a,transaction:r}),a}function Ye(e){const{environment:t,collectionContextStore:o,collectionViewStore:n,intl:r,transaction:i}=e,a=o.collectionViewBlockStore();if(!a)return;const s=n.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(n)}));if(!s)return;return $e({environment:t,collectionViewBlockStore:a,collectionView:{...s,id:(0,B.ZP)(),name:(0,_.nM)(s.name||r.formatMessage(ee.b1[s.type]))},transaction:i})}function Qe(e){var t,o,n;const{environment:i,collectionContextStore:a,transaction:s}=e,l=a.collectionViewBlockStore(),c=a.collectionViewStore(),d=a.settingsStore;if(!l)return;const p=null===(t=a.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_subitem,u=null===(o=a.collectionStore())||void 0===o||null===(o=o.getFormat())||void 0===o?void 0:o.collection_default_arrows_by,m=$e({environment:i,collectionViewBlockStore:l,collectionView:{type:"table",parent_id:l.id,parent_table:h.iU,alive:!0,space_id:l.getSpaceId(),format:{table_properties:null==c||null===(n=c.getFormat())||void 0===n?void 0:n.table_properties,collection_view_subitem:p?{property:p}:void 0,timeline_arrows_by:u?{property:u}:void 0,table_subitem_toggle_column:"title",...c&&"collectionTypedView"===a.contextType?{collection_view_source:c.getFormat().collection_view_source,property_filters:c.getFormat().property_filters}:{}}},transaction:s});_t({environment:i,collectionContextStore:a,collectionViewId:m.id,isFullScreen:a.isFullScreen.state,isRootChild:a.isRootChild.state,isInPeekRenderer:a.isInPeekRenderer.state}),r.default.afterNextFlush((()=>{l.getCollectionViewSourceCollectionStore()?(Me.r$({collectionContextStore:a,collectionSettingsStore:d}),Me.wl({collectionSettingsStore:d,item:{type:"createView"}})):Me.r$({collectionContextStore:a,collectionSettingsStore:d})}))}function Je(e){const{collectionViewBlockStore:t,collectionViewStore:o,transaction:n}=e,r=xe.Xr.createChildStore(t,{table:L.n,id:o.id,spaceId:t.getSpaceId()}),i=o.getFormat().app_config_uri;if(i){var a;const e=null===(a=t.getFormat())||void 0===a?void 0:a.app_uri_map;e&&delete e[i],De.FH({stores:[t],update:{app_uri_map:e},transaction:n})}Be.Od({parent:t.getCollectionViewsStore(),childToRemove:r,transaction:n})}function Xe(e){const{collectionViewBlockStore:t,newViewIds:o,transaction:n}=e,r=t.getCollectionViewStores(),{beforeOps:i}=(0,S.q)(r.map((e=>e.id)).slice(0,o.length),o);M.Ed(i,((e,r)=>{const i=xe.Xr.createChildStore(t,{table:L.n,id:r,spaceId:t.getSpaceId()});if(e)Be.Vt({parent:t.getCollectionViewsStore(),insert:i,before:xe.Xr.createChildStore(t,{table:L.n,id:e,spaceId:t.getSpaceId()}),transaction:n});else{const e=M.Z$(o.filter((e=>e!==r)));Be.BE({parent:t.getCollectionViewsStore(),insert:i,after:e?xe.Xr.createChildStore(t,{table:L.n,id:e,spaceId:t.getSpaceId()}):void 0,transaction:n})}}))}function et(e){const{collectionViewStore:t,update:o,transaction:n}=e;Fe.sW({store:t,data:o,transaction:n})}function tt(e){const{collectionViewStore:t,update:o,transaction:n}=e;Fe.sW({store:t.getQueryStore(),data:o,transaction:n})}function ot(e){const{environment:t,collectionStore:o,update:n,transaction:r}=e,i=o.getSchema();n.schema&&(n.schema=d.Fn(n.schema)),n.deleted_schema&&(n.deleted_schema=d.Fn(n.deleted_schema));const a={...n};if(n.deleted_schema){const e=o.getDeletedSchema(),t=(0,u.jf)({schemas:[e,n.deleted_schema]});t.error?k.log({level:"error",from:"collectionViewActions",type:"updateCollection",error:t.error}):a.deleted_schema=t.value}Fe.sW({store:o,data:a,transaction:r}),n.schema&&gt({environment:t,collectionStore:o,oldSchema:i,newSchema:n.schema,transaction:r})}function nt(e){const{environment:t,collectionStore:o,update:n,transaction:r}=e,i=o.getSchema(),a=d.Fn(n);Fe.sW({store:o.getSchemaStore(),data:a,transaction:r}),gt({environment:t,collectionStore:o,oldSchema:i,newSchema:o.getSchema(),transaction:r})}function rt(e){const{collectionStore:t,update:o,transaction:n}=e;Fe.sW({store:(0,xe._J)(t,t.pointer,["deleted_schema"]),data:o,transaction:n})}function it(e){var t;const{environment:o,collectionContextStore:n,newViewType:r,transaction:i,intl:a}=e,s=n.collectionViewStore(),l=n.collectionViewBlockStore(),d=n.collectionStore();if(!s||!l)return;const p=n.normalizedSchemaStore.state;if(r===s.getType())return;const u=n.permissionScopes.state,m=s.getType();if(Fe.sW({store:s,data:{type:r},transaction:i}),"board"===m&&De.FH({stores:[s],update:{board_columns_by:void 0,collection_group_by:s.getFormat().board_columns_by},transaction:i}),"table"===r)Fe.sW({store:s.getQueryStore(),data:{aggregations:[{property:"title",aggregator:"count"}]},transaction:i});else if("board"===r){var g;let e=(null===(g=s.getFormat().collection_group_by)||void 0===g?void 0:g.property)??ee.Se(p);if(d&&!e){e=(0,R.ZP)();const t={name:a.formatMessage(ze.statusName),type:"select",options:[]};u.canConfigureCollection&&nt({environment:o,collectionStore:d,update:{[e]:t},transaction:i})}const t=n.normalizedSchemaStore.state,r=e&&t[e];if(!e||!r||!(0,c.LG)(r))return;De.FH({stores:[s],update:{board_columns_by:(0,c.fw)(e,r,"collectionTypedView"===n.contextType),collection_group_by:void 0},transaction:i})}else if("calendar"===r){let e=ee.PD(p);if(d&&!e){e=(0,R.ZP)();const t={name:a.formatMessage(ze.dateName),type:"date"};u.canConfigureCollection&&nt({environment:o,collectionStore:d,update:{[e]:t},transaction:i})}Fe.sW({store:s.getQueryStore(),data:{aggregations:[],calendar_by:e},transaction:i})}else if("gallery"===r)De.FH({stores:[s],update:{gallery_cover:{type:"page_content"}},transaction:i}),Fe.sW({store:s.getQueryStore(),data:{aggregations:[]},transaction:i});else if("list"===r){const e=Object.keys(p).find((e=>{const t=p[e];return Boolean(t&&(0,J.Rb)(t))}));De.FH({stores:[s],update:{list_properties:e?[{property:e,visible:!0}]:[]},transaction:i}),Fe.sW({store:s.getQueryStore(),data:{aggregations:[]},transaction:i})}else if("timeline"===r){let e=ee.HI(p);if(d&&!e){e=(0,R.ZP)();const t={name:a.formatMessage(ze.dateName),type:"date"};u.canConfigureCollection&&nt({environment:o,collectionStore:d,update:{[e]:t},transaction:i})}Fe.sW({store:s.getQueryStore(),data:{aggregations:[{property:"title",aggregator:"count"}],timeline_by:e},transaction:i})}const h=null===(t=s.getFormat().collection_view_subitem)||void 0===t?void 0:t.property;if(h&&!(0,te.Av)(r)){const e=m&&!(0,te.Av)(r)?(0,w.oz)(m):void 0,t=(e?s.getFormat()[e]??[]:[]).find((e=>e.property===h))??{property:h,visible:!0},o=(0,w.oz)(r),n=s.getFormat()[o]??[];De.FH({stores:[s],update:{[o]:[...n,t]},transaction:i})}st({collectionContextStore:n})}function at(e){const{icon:t,collectionViewBlockStore:o,transaction:n}=e;De.FH({stores:[o],update:{collection_view_icon:t},transaction:n})}function st(e){const{collectionContextStore:t}=e,o=t.collectionViewBlockStore();if(!o)return;const n=ue.R.findCollectionViewBlockFromStore(o);null!=n&&n.resetLeftScrollAfterFlush&&n.resetLeftScrollAfterFlush()}function lt(e){const{collectionContextStore:t}=e,o=t.collectionViewBlockStore();if(o){const e=ue.R.findCollectionViewBlockFromStore(o);if(e){const t=e.getNode();t&&(0,le.Wr)(t,{edgeDist:0,animate:!1})}}}function ct(e){var t,o,n,r;const{collectionContextStore:i,collectionStore:a,transaction:s}=e,l=i.collectionViewStore();if(!l||!a.isDefined())return;const c=ee.Vv(a),d=null===(t=a.getFormat())||void 0===t?void 0:t.collection_default_subitem,p=null===(o=a.getFormat())||void 0===o?void 0:o.collection_default_arrows_by,u={table_properties:null==c||null===(n=c.getFormat())||void 0===n?void 0:n.table_properties,collection_pointer:{table:O.v,id:a.id,spaceId:a.getSpaceId()},collection_view_subitem:d?{property:d}:void 0,timeline_arrows_by:p?{property:p}:void 0,table_subitem_toggle_column:"title"},m=null==i?void 0:i.normalizedSchemaStore.state;Fe.sW({store:l,data:(0,q.Q2)({format:u,query2:{sort:null==c||null===(r=c.getQuery(m))||void 0===r?void 0:r.sort}}),transaction:s})}function dt(e){var t;const{environment:o,name:n,collectionViewStore:r,collectionViewBlockStore:i,transaction:s}=e,l=r.getType();if(!l||!i.isDefined())return;const c=i.getCollectionPointer(),d=i.getFormat(),p=(0,V.QaF)(null===(t=i.getTitleStore())||void 0===t?void 0:t.getValue()),u=c||n||!p?n:p,m=(0,K.Yu)({environment:o,isInline:i.getType()===a.Ti.collectionView,name:u,viewType:l}),g=E.Ao.create();g.set({table:L.n,id:"collection_view"},r.pointer),Pe.ZI({environment:o,sourceBlockId:"root",targetBlockPointer:i.pointer,sourceBlockSubtree:m?(0,E.R3)(m):E.Ak.create(),targetRecordCache:i.inMemoryRecordCache,transaction:s,recordPointerMap:g,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:i.useCrdt()});const h=g.get({table:O.v,id:"collection"});if(!h)return;De.FH({stores:[i],update:{collection_pointer:h},transaction:s});const f=i.getCollectionStore();f&&(ot({collectionStore:f,update:{icon:null==d?void 0:d.page_icon,cover:null==d?void 0:d.page_cover},environment:o,transaction:s}),De.FH({stores:[f],update:{collection_cover_position:null==d?void 0:d.page_cover_position},transaction:s}))}function pt(e){const{collectionViewBlockStore:t,collectionStore:o,transaction:n}=e;if(!t.isDefined()||!o.isDefined())return;if(t.getCollectionPointer())throw new Error("CollectionViewBlock already has a collection");De.FH({stores:[t],update:{collection_pointer:o.pointer},transaction:n})}function ut(e){const{collectionViewBlockStore:t,collectionStore:o,transaction:n}=e;if(!t.isDefined()||!o.isDefined())return;[t].forEach((e=>{var t;e.getCollectionViewStores().filter((e=>{var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.id)===o.id})).forEach((t=>Je({collectionViewBlockStore:e,collectionViewStore:t,transaction:n}))),(null===(t=e.getFormat().collection_pointer)||void 0===t?void 0:t.id)===o.id&&Fe.sW({store:e,data:{format:{...e.getFormat(),collection_pointer:void 0},collection_id:null},transaction:n})})),Ee.hh({childStore:o,transaction:n})}function mt(e){const{environment:t,collectionStore:o,performTransaction:n}=e;return Ue.createAndCommit({userAction:"collectionViewActions.createSchemaUpdateTransaction",environment:t,perform:e=>{const r=o.getSchema(),i=n(e),a=o.getSchema();return gt({environment:t,collectionStore:o,oldSchema:r,newSchema:a,transaction:e}),i}}).performResult}function gt(e){const{environment:t,collectionStore:o,oldSchema:n,newSchema:r,transaction:i}=e,a=d.Fn(n),l=d.Fn(r),c=Object.keys(l);for(const u of c){const e=a[u],n=l[u];if(n){if("status"===n.type&&"status"!==(null==e?void 0:e.type)){let r;r="select"===(null==e?void 0:e.type)||"multi_select"===(null==e?void 0:e.type)?(0,s.r9)(n.name,e.options??[]):n.groups&&n.options&&n.defaultOption?n:d.I4(n.name);const a={...l,[u]:r};if(Fe.sW({store:o,data:{schema:a},transaction:i}),"checkbox"===(null==e?void 0:e.type)&&"status"===n.type){const e=r.groups??[],n=e[e.length-1];n&&Te.hz({environment:t,collectionStore:o,property:u,oldValue:{type:"checkbox",value:!0},newValue:{type:"status",value:{type:"by_group",group:n.name}},transaction:i})}}if("status"===(null==e?void 0:e.type)&&"checkbox"===n.type){const n=e.groups??[],r=e.options??[],a=n[n.length-1],s=r.filter((e=>{var t;return null==a||null===(t=a.optionIds)||void 0===t?void 0:t.includes(e.id)}));for(const e of s)Te.hz({environment:t,collectionStore:o,property:u,newValue:{type:"checkbox",value:!0},oldValue:{type:"status",value:{type:"by_option",option:e.value}},transaction:i})}}}for(const s of c){const e=a[s],n=l[s];!n||e&&d.cu(e)||!d.cu(n)||Ce.getSelectPropertyValues(t,{collection:{id:o.id,spaceId:(0,U.C)(o.pointer.spaceId)},property:s}).then((e=>{if("failed"===e.type)throw e.error;const{results:r}=e.data,i=n.options||[],a=d.Fn(o.getSchema()),l=M.mN([...i,...r.map((e=>({id:(0,R.ZP)(),value:e})))],(e=>e.value)),c={...n,options:l},p={...a,[s]:c};Ue.createAndCommit({userAction:"collectionViewActions.handleCollectionSchemaUpdated",environment:t,perform:e=>{Fe.sW({store:o,data:{schema:p},transaction:e})}})}))}const p=M.jj([...Object.keys(a),...Object.keys(l)]);for(const s of p){const e=a[s],n=l[s],r=e&&d.cu(e)||"status"===(null==e?void 0:e.type),c=n&&d.cu(n)||"status"===(null==n?void 0:n.type);if(r&&c&&e.type===n.type){const r=n,a=e.options||[],l=r.options||[],c=M.jj([...a.map((e=>e.id)),...l.map((e=>e.id))]);for(const d of c){const r=a.find((e=>e.id===d)),c=l.find((e=>e.id===d));if(r&&c&&r.value!==c.value){const a="status"===e.type?{type:"status",value:{type:"by_option",option:r.value}}:{type:e.type,value:r.value},l="status"===n.type?{type:"status",value:{type:"by_option",option:c.value}}:{type:n.type,value:c.value};Te.hz({environment:t,collectionStore:o,property:s,oldValue:a,newValue:l,transaction:i})}}}}for(const s of p){const e=l[s];"button"!==(null==e?void 0:e.type)||e.automation_id||W.Hj({environment:t,collectionStore:o,property:s,transaction:i})}}function ht(e){const{store:t,environment:o}=e;let n;Ve.cR({environment:o,bucket:"temporary",onStart:e=>{n=e,Re.j({message:qe.uploadingCSV})},onComplete:e=>{(async(e,n)=>{Re.j({message:qe.importingCSV});const r=t.getCollectionViewCollectionStore();if(!r)return;if(!ue.R.findCollectionViewBlockFromStore(t))return;const{value:i}=await Ce.importFile(o,{importType:"MergeIntoCollection",fileURL:e,fileName:n,collection:{id:r.id,spaceId:(0,U.C)(r.pointer.spaceId)}}).next();i.error&&Ae.showErrorMessage(re.default.formatMessage(qe.importFailed)),Re.x()})(e[0],n[0].name)},onError:e=>{Re.x(),Ae.showErrorMessage(re.default.formatMessage(qe.importFailed))}})}async function ft(e,t,o){const n=t.collectionViewStore(),{remoteRequestStore:r}=t;if(!r||!n)return;const i=r.state;if(!i)return;const a=t.createUpdateCounter(),s=t.remoteResult.state;be.Z.state.online&&s&&await ke.transactionQueue.drain();const l=n.inMemoryRecordCache;if(!t.shouldUpdate(a))return;t.isLoading.setState(!0);const c=ce.default.mark("collections.remote_query_collection_latency");let d;if(l===e.defaultRecordCache.inMemoryRecordCache&&be.Z.state.online){const n="initial_load"===o.src?(0,J.Cg)(i):i,r=[];if(Se.default.checkGate("collection_split_aggregation_v2")&&"msg"!==o.src&&!("initial_load"===o.src&&e.prefetchCache.hasPrefetchedRequest("queryCollection",(0,H.yX)({environment:e,eventName:"queryCollection",data:n,tracking:o,activeUserId:e.currentUser.id})))){let s=!1;const l={};if(Object.entries(n.loader.reducers||{}).forEach((e=>{let[t,o]=e;"aggregation"!==o.type?l[t]=o:s=!0})),d=Ce.queryCollection(e,{...n,loader:{...n.loader,reducers:l}},void 0,{...o,src:`${o.src}${s?"_no_aggregations":""}`},void 0,"queryCollection").then((n=>{const r=Y.vS(t,o.src);if(ce.default.measure(c,{environment:e,data:r}),"success"===n.type)return"initial_load"===o.src&&Z.Z.set((0,ae.Z)(i.collectionView.id),i),yt({environment:e,remoteRequest:i,collectionContextStore:t,response:n.data,updateCounter:a,keepAggregationResults:s})})),r.push(d),s){t.asyncAggregationStatus.setState({...t.asyncAggregationStatus.state,calculating:!0});const n=d.then((()=>Ce.queryCollection(e,i,void 0,{...o,src:`${o.src}_with_aggregations`},void 0,"queryCollection").then((o=>{if("success"===o.type)return yt({environment:e,remoteRequest:i,collectionContextStore:t,response:o.data,updateCounter:a})})).finally((()=>{t.asyncAggregationStatus.setState({calculating:!1})}))));r.push(n)}}else d=Ce.queryCollection(e,n,void 0,o,void 0,"queryCollection").then((n=>{const r=Y.vS(t,o.src);if(ce.default.measure(c,{environment:e,data:r}),"success"===n.type)return"initial_load"===o.src&&Z.Z.set((0,ae.Z)(i.collectionView.id),i),t.asyncAggregationStatus.setState({calculating:!1}),yt({environment:e,remoteRequest:i,collectionContextStore:t,response:n.data,updateCounter:a})})),r.push(d);if(!(await(0,D.OI)(1e4,r)).timeout)return}else try{const o=await async function(e,t,o){const{source:n,collectionView:r,loader:i}=t,a=e.currentUser.id;let s;if("collection"!==n.type)throw new Error("TODO: support typed source");s={table:O.v,id:n.id};const l=Date.now(),c=await ie.Ye({environment:e,pointer:s,inMemoryRecordCache:o});if(null==c||!c.model)throw new Error("Collection not found.");const d=c.model,u=await ie.Ye({environment:e,pointer:{table:L.n,id:r.id},inMemoryRecordCache:o});if(null==u||!u.model)throw new Error("Collection view not found.");const m=A.s8.fromMonomorphicFunctionUnsafe((async t=>{const o=await ie.Ye({environment:e,pointer:t});return null==o?void 0:o.model})),f=u.model,y=E.Ak.create(),v=A.om.fromRecordMap(y),b=d.getNormalizedSchema(),{groupsReducerIds:S,reducerIdsWithNoGroupDependencies:_}=p.x3(i.reducers,i.reducerDependencies),w=Se.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),k={schema:b,pageSort:(null==f?void 0:f.getPageSort())||[],collectionViewId:r.id,loader:i,userId:a,userStartOfWeek:G.AK.state,currentTime:l,getRecordModel:v,intl:re.default.getIntl(),isSorted:!1,relativeVariableResult:void 0,isSprintPlanningView:(null==f?void 0:f.getAppConfigUri())===g.sV,collectionSourceType:n.type,groupsReducerIds:S,reducerIdsWithNoGroupDependencies:_,formulaTimeoutMs:w,resultCache:new Map},x=d.__IM_SORRY__getValue(),I=p.fk(k),C=(await ie.ne({environment:e,collection:d,inMemoryRecordCache:o})).filter((e=>{let{model:t}=e;return null==t?void 0:t.alive})),T=M.oA(C.map((e=>{let{model:t}=e;return null==t?void 0:t.__IM_SORRY__getValue()}))),P=(i.reducers?Object.values(i.reducers):[]).some((e=>Boolean("results"===e.type&&e.loadContentCover))),D=new Map,B=await p.Ct({collectionValue:x,loader:i,loadAllProperties:!1,recordMap:y,loadRecordModel:m,dependencyCache:D});await p.c_({blocks:T,dependencies:B,recordMap:y,loadRecordModel:m,dependencyCache:D,resultCache:k.resultCache}),P&&await p.jF({blocks:T,loadRecordModel:m,recordMap:y});for(const g of T)p.BW(g,x,k,I);const{result:R}=p.kk(k,I),F=E.PF.create(),N=p.aW({result:R});return await Promise.all(N.map((async t=>{const n=await ie.Ye({environment:e,pointer:{table:h.iU,id:t},inMemoryRecordCache:o});n&&F.setModelAndRole({table:h.iU,id:t},n.model,n.role)}))),F.setModelAndRole(s,c.model,c.role),F.setModelAndRole({table:L.n,id:r.id},u.model,u.role),{result:R,recordMap:F.toJson({allowVersionDowngrade:!1}),relativeVariableResult:void 0,collectionIds:void 0,shouldUseClientMode:!1,isViewSpecificClientMode:!1,allBlockIds:void 0}}(e,i,l),n=E.PF.create(o.recordMap);Ne.fL({environment:e,inMemoryRecordCache:l,recordMap:n,debugSource:"collectionViewActions.fetchRemoteResult (localResponse)"}),await yt({environment:e,collectionContextStore:t,remoteRequest:void 0,response:o,updateCounter:a})}catch(u){}finally{t.resetLoadingState()}d&&d.catch((e=>{}))}async function yt(e){const{environment:t,remoteRequest:o,collectionContextStore:n,response:r,updateCounter:i,keepAggregationResults:a}=e,s=n.collectionViewStore();if(!n.shouldUpdate(i))return;if(C.H1.is(r)){for await(const l of r)if("reducer"===l.type){const e=n.remoteResult.state,t=null==e?void 0:e.reducerResults[l.name];if(!t||!M.Xy(t,l.result)){const t={type:"reducer",reducerResults:{...null==e?void 0:e.reducerResults,[l.name]:l.result}};n.remoteResult.setState(t);const o=new Set(p.aW({result:t,onlyTypes:["results"]}));n.resultSet.resetWithRemote(o)}}else if("sizeHint"===l.type){const e=n.remoteResult.state,t={type:"reducer",reducerResults:(null==e?void 0:e.reducerResults)??{},sizeHint:l.sizeHint};n.remoteResult.setState(t)}else if("relativeVariableResult"===l.type)n.relativeVariables.setState({...n.relativeVariables.state,...l.relativeVariableResult});else if("collectionIds"===l.type){const e=n.remoteCollectionIds.state;M.Xy(e,l.collectionIds)||n.remoteCollectionIds.setState(l.collectionIds)}}else{const e=n.remoteResult.state;if(!e||!M.Xy(e,r.result)){const t=r.result;if("reducer"===r.result.type){if(a){const o=Object.entries((null==e?void 0:e.reducerResults)||{}).filter((e=>{let[t,o]=e;return"aggregation"===o.type})).reduce(((e,t)=>{let[o,n]=t;return e[o]=n,e}),{});t.reducerResults={...o,...t.reducerResults}}n.remoteResult.setState(t)}if(r.shouldUseClientMode)n.isClientModeEnabled.setState(!0),n.isViewSpecificClientModeEnabled.setState(Boolean(r.isViewSpecificClientMode)),n.resultSet.resetWithRemote(r.allBlockIds);else{const e=new Set(p.aW({result:r.result,onlyTypes:["results"]}));n.resultSet.resetWithRemote(e)}}const o=n.remoteCollectionIds.state,i=r.collectionIds||[];M.Xy(o,i)||n.remoteCollectionIds.setState(i),_e.Z.addFromRecordMapWithRoleJson(r.recordMap),_e.Z.isEmpty()||Ze.dY({environment:t}),n.relativeVariables.setState({...n.relativeVariables.state,...r.relativeVariableResult})}if(n.remoteResult.state&&(n.resetLoadingState(),n.isLoaded.setState(!0),a||n.lastRemoteRequest.setState(o),s)){const e=Rt(s);ne.set(e,{remoteResult:n.remoteResult.state,resultSet:n.resultSet.state,collectionIds:n.remoteCollectionIds.state})}}function vt(e,t){const{blockIds:o,hasLocalUpdates:n}=t.resultSet.state,r=t.collectionViewStore(),i=e.currentUser.id,a=t.remoteRequestStore.state,s=t.remoteResult.state;if(!r||!r.isDefined()||!a)return;const l=Date.now(),c=re.default.getIntl(),d=r.getRecordModel,y=r.getFormat(),b=r.getType(),S=r.getCollectionSource();if(!S)return;const _=t.collectionStoresStore.state,w=[];for(const p of _){const e=d(p);e&&w.push(e)}if(0===w.length)return;t.isLoaded.setState(!1);const k=w.some((e=>we.Z.getEditedBlocksForCollection(e.id).size>0)),x=M.Xy(t.lastRemoteRequest.state,a);if(!k&&s&&!n&&x)return t.isLoaded.setState(!0),s;const C=ce.default.mark("collections.compute_local_result_latency");let T={};switch(t.contextType){case"collectionTypedView":const e=(t.databaseType&&(0,g.uV)(c))??{},o=(0,u.jf)({schemas:[...w.map((e=>{var t;const o=null==e||null===(t=e.getFormat())||void 0===t?void 0:t.app_uri_map,n=e.getNormalizedSchema();return u.aQ.toViewSchema(n,o)})),e],onlyPropertyIds:Object.keys(e)});if(o.error)throw o.error;T=o.value;break;case"collectionVirtualView":case"collectionView":case"collectionViewBlock":case"collectionPage":case void 0:T=w[0].getNormalizedSchema();break;default:(0,f.t1)(t.contextType)}const P=p.ps(y,b,T),D=t.relativeVariableStore.state,{groupsReducerIds:B,reducerIdsWithNoGroupDependencies:R}=p.x3(a.loader.reducers,a.loader.reducerDependencies),E=Se.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),F={pageSort:r.getPageSort(),schema:T,loader:a.loader,userId:i,userStartOfWeek:G.AK.state,currentTime:l,getRecordModel:ge.default.getCurrentBlockModelFn(),intl:re.default.getIntl(),isSorted:!1,visibleProperties:P,relativeVariableResult:D,isSprintPlanningView:y.app_config_uri===g.sV,collectionSourceType:S.type,groupsReducerIds:B,reducerIdsWithNoGroupDependencies:R,formulaTimeoutMs:E,resultCache:new Map},N={...F,loader:{...a.loader,filter:void 0}},j=s?new Set(p.aW({result:s,onlyTypes:["results"]})):new Set,O=p.fk(F);for(const u of o){const e=xe.G.createChildStore(r,{table:h.iU,id:u}),o=e.getAssociatedCollectionStore();if(m.Sl.hasCollections(S)&&(!o||!_.find((e=>{let{id:t}=e;return o.id===t}))))continue;const n=d(e);let i;switch(t.contextType){case"collectionVirtualView":if((0,m.nx)(S)){const e=(0,pe.Ep)((0,I.Eq)(S));i=e&&A.kk.fromCollection(v({source:S,collectionId:e}))}break;case"collectionTypedView":case"collectionView":case"collectionPage":case"collectionViewBlock":case void 0:i=o&&d(o);break;default:(0,f.t1)(t.contextType)}if(!i||!n)continue;const s=a.loader.upwardTraversalRelation&&j.has(u)&&(0,te.uU)({block:A.kk.fromBlock(n),collectionContextStore:t})&&!t.isClientModeEnabled.state;p.BW(n,i,s?N:F,O)}for(const u of w){const e=we.Z.getEditedBlocksForCollection(u.id);for(const t of e){if(o.has(t))continue;const e=d(xe.G.createChildStore(r,{table:h.iU,id:t}));e&&p.BW(e,u,F,O)}}const{result:L}=p.kk(F,O);if(t.isLoaded.setState(!0),"reducer"!==L.type)return;const U=Y.vS(t);return ce.default.measure(C,{environment:e,data:U}),L}function bt(e,t){const o=t.collectionViewStore(),n=t.searchQuery.state;if(!o)return;const r=t.currentSubitemFormatStore.state,i=o.getType(),a=(0,$.RL)({collectionContextStore:t,applySubitemFilter:Boolean(r)&&!(i&&(0,te.Av)(i))}),s=(0,l.kk)(a),c=t.currentSortsStore.state,p=function(e){const t=e.reducers.state,o={};return M.Ed(t,((e,t)=>{e&&(o[t]=e.reducer)})),o}(t);if(M.xb(p))return;let u;if(t.reducerDependencies.size>0){u={};for(const[e,o]of t.reducerDependencies)u[e]=[...o]}const m=(0,U.C)(o.pointer.spaceId),g=o.getCollectionSource();if(!g)return;const h=t.normalizedSchemaStore.state,f=(null==r?void 0:r.property)&&h[r.property];return{source:g,collectionView:{id:o.id,spaceId:m},loader:{type:"reducer",reducers:p,filter:s,sort:c,searchQuery:n,userId:e.currentUser.id,userTimeZone:(0,x.r)(),...f&&(0,d.p_)(f)&&i&&(0,te.Av)(i)&&{upwardTraversalRelation:f},reducerDependencies:u}}}function St(e){const{reducerId:t,instanceId:o,reducer:n,collectionContextStore:r,groupsPointer:i}=e,a=r.reducers.state,s=a[t];let l,d;if(i&&i.length>0&&(l=(0,c.KW)(i)),n){if(d={instanceIds:M.jj([...(null==s?void 0:s.instanceIds)||[],o]),reducer:n},l){r.reducerDependencies.has(l)||r.reducerDependencies.set(l,new Set);const e=r.reducerDependencies.get(l);null==e||e.add(t)}}else{if(l){const e=r.reducerDependencies.get(l);e&&(e.delete(t),0===e.size&&r.reducerDependencies.delete(l))}const e=M.zu((null==s?void 0:s.instanceIds)||[],o);d=s&&e.length>0?{instanceIds:e,reducer:s.reducer}:void 0}M.Xy(s,d)||r.reducers.setState({...a,[t]:d})}function _t(e){const{environment:t,collectionViewId:o,openInNew:n,collectionContextStore:r,isFullScreen:a,isRootChild:s,isInPeekRenderer:l}=e,c=r.collectionViewBlockStore();if(c){if(c===ge.default.state.mainEditorCurrentBlockStore||n)je.navigateToBlock({environment:t,store:c,openInNew:n,collectionViewId:o,pageVisitSource:i.tY.ChangeCollectionView});else{const e=new xe.Xr(t,{table:L.n,id:o},{inMemoryRecordCache:c.inMemoryRecordCache}),n=e.getCollectionStore();We({environment:t,collectionViewBlockStore:c,collectionViewStore:e,collectionStore:n,collectionContextStore:r,isFullScreen:a,isRootChild:s,isInPeekRenderer:l}),T.Z.set({userId:t.currentUser.id,key:fe.Z.getLocalViewPreferenceKey(c.id),value:o})}st({collectionContextStore:r})}}function wt(e){const{environment:t,collectionContextStore:o}=e;let n=o.collectionStore();const r=o.collectionViewBlockStore();if(!n||!r)return;const{mainEditorCurrentBlockStore:i}=ge.default.state;i&&o.isFullScreen.state&&(n=xe.NW.createChildStore(i,n.pointer)),Le.mT({environment:t,store:n.getNameStore(),canSelectAllBlocks:!1})}function kt(){Oe.MO(),function(){const e=ve.Z.state,t=Ie.default.state;if(e.isActive&&1===t.stores.length&&t.stores[0].id===e.store.id)return;It()}()}function xt(e){const{store:t,transient:o}=e;ve.Z.setState({isActive:!0,store:t,transient:Boolean(o)})}function It(){ve.Z.setState({...ve.Z.state,isActive:!1})}function Ct(e){const{store:t}=e;"new"===ye.Z.state.editMode&&ye.Z.state.store.id===t.id&&ye.Z.reset()}function Tt(e){const{environment:t,update:o,transaction:n,collectionStore:r}=e;Fe.ae({environment:t,table:N.cv,value:o.newAutomationValue,inMemoryRecordCache:r.inMemoryRecordCache,transaction:n});for(const i of o.newAutomationActionValues)Fe.ae({environment:t,table:j.Xj,value:i,inMemoryRecordCache:r.inMemoryRecordCache,transaction:n})}async function Mt(e){const{environment:t,collectionContextStore:o,blockIdToMinimumVersion:n}=e;await async function(e,t){return await Promise.all((0,f.qP)(t).map((async t=>{let[o,n]=t;return Ne.bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:{table:h.iU,id:o},userId:e.currentUser.id,minimumVersion:n})})))}(t,n),o.resultSet.addLocalChange(Object.keys(n))}function Pt(e){let{currentUserId:t,spaceId:o}=e;const n=T.Z.get({userId:t,key:At(o)});if(n){const e=(0,q.dj)(n);return Array.isArray(e)?e:[]}return[]}function At(e){return`getRecentlyNavigatedCollections:${e}`}function Dt(e){let{currentUserId:t,collectionViewId:o,temporaryState:n}=e;const r=Bt(o);n?T.Z.set({userId:t,key:r,value:JSON.stringify(n)}):T.Z.remove({userId:t,key:r})}function Bt(e){return`collectionViewTemporaryState2:${e}`}function Rt(e){const t=e.id,o=e.getCollectionSource();return"trending"===(null==o?void 0:o.type)?{collectionViewId:t,teamId:o.teamId}:{collectionViewId:t}}},30188:(e,t,o)=>{o.d(t,{FC:()=>H,R2:()=>Q,VP:()=>te,W9:()=>oe,YE:()=>ee,Z3:()=>J,dR:()=>G,e2:()=>W,jA:()=>K,rT:()=>z,wA:()=>U,xr:()=>$});o(57658),o(21703),o(52262),o(24506),o(67294);var n=o(1302),r=o(99036),i=o(80951),a=o(45433),s=o(6695),l=o(72126),c=o(5366),d=o(4615),p=o(21202),u=o(23867),m=o(29369),g=o(95371),h=o(39721),f=o(73597),y=o(70842),v=o(97880),b=o(64369),S=o(24215),_=o(78316),w=o(77181),k=o(35328),x=o(80444),I=o(77080),C=o(5315),T=o(35661),M=o(50906),P=o(54642),A=o(49865),D=o(47307),B=o(54532),R=o(96802),E=o(9953),F=o(79978),N=o(42858),j=o(24677),O=o(39699),L=o(85893);function U(e){const{environment:t,transaction:o,blocks:n,action:r}=e,i=(0,_.fm)(n[0]);if(!i)return;const a=i.subitemTreeStore.state;if(!a)return;const s=i.currentSubitemFormatStore.state;if(!s||!s.property)return;const l=i.collectionViewBlockStore();if(!l)return;const c=new g.mp({store:l,pathKey:""},a.map((e=>e)).children),d=function(e,t){const o=new Set(e);let n,r;for(const i of f.JK(t)){if(!o.has(i.value.store)){if(n)return;continue}const e=(0,g.DY)([t],(e=>e===i));if(!e||e.length<2)return;if(n??=e,r=e,o.delete(i.value.store),0===o.size)break}if(n&&r)return y.T.fromNearestCommonAncestor(n,r)}(n,c);if(!d)return;const p=h.o.getIndentOperationsFromTreeRange(d,r),u=new Set,m=[],b="unindentSelf"===r?new Set(p.map((e=>e.target))):new Set;for(const f of p){const{target:e,operation:n}=f,r=(0,g.DY)([c],(t=>t===e));if(void 0===r)return;const a=r[r.length-2];if("indentSelfAndSubtree"===n){if(u.has(a)){u.add(e),m.push(e.value.store);continue}const n=a.children,r=n.indexOf(e);if(0===r)return;const l=n[r-1].value.store;Z({environment:t,parentStore:a.value.store,previousSiblingStore:l,targetStore:e.value.store,subitemFormat:s,transaction:o}),m.push(T.G.createChildStore(l,e.value.store.pointer)),z({collectionContextStore:i,pathKey:(0,w.zV)(a.value.pathKey,l)})}else{if("unindentSelf"!==n)break;{var S;if(b.has(a)){b.delete(e),m.push(e.value.store);continue}if(1===r.length)return;const n=null===(S=r[r.length-3])||void 0===S?void 0:S.value.store;V({environment:t,parentStore:a.value.store,grandparentStore:n,targetStore:e.value.store,subitemFormat:s,transaction:o}),m.push(T.G.createChildStore(n&&n.isPageBlock()?n:i.collectionViewBlockStore(),e.value.store.pointer))}}if(h.F.applyMutable(c,f))if("indentSelfAndSubtree"===n)u.add(e);else if("unindentSelf"===n){const t=i.subitemExpandedStore.state,o=a.value.pathKey,n=t.get(o);0===a.children.length&&null!=n&&n.isExpanded&&(t.delete(o),i.subitemExpandedStore.emit()),b.delete(e)}else(0,v.t1)(n)}m&&j.Z5({environment:t,stores:m})}function Z(e){const{environment:t,parentStore:o,previousSiblingStore:n,targetStore:r,subitemFormat:i,transaction:a}=e;o.isPageBlock()&&F.Bl({environment:t,sourceStore:o,destStore:r,propertyWithInverse:i,transaction:a}),F.hE({environment:t,sourceStore:n,destStore:r,propertyWithInverse:i,transaction:a,position:{type:"after"}})}function V(e){const{environment:t,parentStore:o,grandparentStore:n,targetStore:r,subitemFormat:i,transaction:a}=e;F.Bl({environment:t,sourceStore:o,destStore:r,propertyWithInverse:i,transaction:a}),n&&n.isPageBlock()&&F.hE({environment:t,sourceStore:n,destStore:r,propertyWithInverse:i,position:{type:"after",after:o.id},transaction:a})}function q(e){const{blocksToDuplicate:t,duplicatedBlocks:o,environment:n,transaction:r,migrateSubitemFormat:a}=e;if(t.length!==o.length)throw new Error("Error rebuilding relations. blocksToDuplicate and duplicatedBlocks must be the same length");const s=t.at(0);if(!s)return;const{from:c,to:d}=a||function(e){const t=(0,w.g0)(e);if(!t)throw new Error("Error rebuilding relations");const{subitemFormat:o}=t;return{from:o,to:o}}(s);const p=new Map(l.$R(t.map((e=>e.id)),o));l.$R(t,o).forEach((e=>{let[t,o]=e;const a=X(t,c),s=function(e){const t=e.getPropertyValue(c.inverse);return i.rq(t)}(t);a.forEach((e=>{const t=T.G.createChildStore(o,e),i=p.get(e.id);i&&(F.Bl({environment:n,sourceStore:o,destStore:t,propertyWithInverse:c,transaction:r}),F.hE({environment:n,sourceStore:o,destStore:i,propertyWithInverse:d,transaction:r,position:{type:"after"}}))})),s.forEach((e=>{const t=T.G.createChildStore(o,e);p.get(e.id)&&F.Bl({environment:n,sourceStore:t,destStore:o,propertyWithInverse:c,transaction:r})}))}))}function z(e){const{collectionContextStore:t,pathKey:o}=e,n=t.subitemExpandedStore.state,r=n.get(o);null!=r&&r.isExpanded||(n.set(o,{isExpanded:!0,limit:20}),t.subitemExpandedStore.emit())}function W(e){const t=(0,_.fm)(e);if(!t)return;const o=t.subitemTreeStore.state,n=(0,g.DY)(o.children,(t=>t.value.store===e));if(!n)return;const r=n.map((e=>e.value.store.pointer)),i=(0,w.Af)(r),a=t.subitemExpandedStore.state,s=a.get(i);s&&s.isExpanded&&(a.delete(i),t.subitemExpandedStore.emit())}function H(e){var t;const o=(0,_.fm)(e);if(!o)return;const n=o.subitemTreeStore.state,r=(0,g.DY)(n.children,(t=>t.value.store===e));if(!r)return;const i=o.currentSubitemFormatStore.state;if(!i)return;const a=null===(t=o.collectionStore())||void 0===t?void 0:t.getSchema()[i.property];if(!a||"relation"!==a.type)return;if(0===(0,w.CJ)({store:e,subitemFormat:i,propertySchema:a}).length)return;const s=r.map((e=>e.value.store.pointer));z({collectionContextStore:o,pathKey:(0,w.Af)(s)})}function G(e){const{collectionViewStore:t,propertyId:o,transaction:n}=e,r=t.getType(),i=r&&!(0,w.Av)(r)?(0,s.oz)(r):void 0,a=i?t.getFormat()[i]??[]:[],l=(null==a?void 0:a.find((e=>e.property===o)))??{property:o,visible:!0},c=i?{[i]:[...a,l]}:{};R.FH({stores:[t],update:{collection_view_subitem:o?{property:o}:void 0,collection_view_toggle_by:o?{property:o}:void 0,...c},transaction:n})}function K(e){var t;const{collectionContextStore:o,relationPropertyId:n,transaction:r,environment:i}=e,s=o.collectionStore();if(!s)return;const l=n?s.getSchema()[n]:void 0,c="relation"===(null==l?void 0:l.type)&&l.property&&"relation"===(null===(t=s.getSchema()[l.property])||void 0===t?void 0:t.type)?l.property:void 0,d=s.getFormat().subitem_property&&n?"collectionViewSubitemActions.changeSubitemProperty":s.getFormat().subitem_property?"collectionViewSubitemActions.turnOffSubitems":"collectionViewSubitemActions.turnOnSubitems",p=I.default.checkGate("collection_level_subitems_setting");R.FH({stores:[s],update:{...p?{subitem_property:n}:{},collection_default_subitem:n,...s.getFormat().app_config_uri===a.iS?{app_uri_map:{...s.getFormat().app_uri_map?s.getFormat().app_uri_map:{},[a.Es.SubTaskRelation]:n,[a.Es.ParentTaskRelation]:c}}:{}},transaction:r}),S.j(i,"update_subitem_property",{userAction:d})}async function $(e){const{environment:t,blocks:o,options:n}=e;if(o.some((e=>!e.isPageBlock())))return[];const i=l.Ps(o);if(!i)return[];const a=(0,_.fm)(i);if(!a)return[];const s=a.collectionStore();if(!s)return[];const c=a.currentSubitemFormatStore.state,d=a.normalizedSchemaStore.state,p=(null==c?void 0:c.inverse)&&d[c.inverse];if(!p||!(0,r.p_)(p))return[];const u=p.property;if(!u)return[];const m=s.id,g=s.getSpaceId();if(!o.some((e=>(0,w.CJ)({store:e,subitemFormat:c,propertySchema:p}).length>0)))return[];await C.transactionQueue.drain();const h=await P.getSubitems(t,{collection:{id:m,spaceId:g},blocks:o.map((e=>({id:e.id,spaceId:g}))),childRelationProperty:u,canEdit:null==n?void 0:n.canEdit});return"failed"===h.type?[]:h.data.blocks.map((e=>T.G.createChildStore(s,{table:"block",...e})))}function Y(e){const t=l.Ps(e);if(!t)return[];const o=(0,_.fm)(t);if(!o)return[];const n=o.collectionStore(),i=o.collectionViewBlockStore();if(!n||!i)return[];const a=o.currentSubitemFormatStore.state,s=o.normalizedSchemaStore.state,c=(null==a?void 0:a.inverse)&&s[a.inverse];if(!c||!(0,r.p_)(c))return[];if(!c.property)return[];const d=new Set(e.map((e=>e.id)));let p=e;const u=[];for(;p.length>0;){const e=l.xH(p.map((e=>(0,w.CJ)({store:e,subitemFormat:a,propertySchema:c})))).filter((e=>!d.has(e.id))).map((e=>T.G.createChildStore(i,e)));for(const t of e)d.add(t.id);u.push(...e),p=e}return u}function Q(e){var t;let{environment:o,blocks:n,recordMaps:r,analyticsFrom:i,transaction:a,migrateSubitemFormat:s}=e;const l=n.at(0);if(!l)return[];if(!(0,w.g0)(l))return[];if(!(null===(t=(0,_.fm)(l))||void 0===t?void 0:t.collectionViewBlockStore()))return[];const c=e=>{const t=r?r.get(e.id):B.K8(o,{blockId:e.id,inMemoryRecordCache:e.inMemoryRecordCache,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0});if(!t)throw new Error("Could not find cached copy of block during sub-item duplication.");return t};n.forEach((e=>{var t;const n=e.getModel();if(!n)return[];const{currentSpaceStore:r}=x.default.getState();let a;r&&n.getParentTable()===m.e0&&n.parent_id&&(a=T.zX.createChildStore(r,{table:m.e0,id:n.parent_id})),M.W2j(o,{from:i??"copy",type:n.type,teamStore:a,is_toggleable:(0,k._A)(n.type,n.getFormat()),collection_id:e.getParentCollectionId()??(null===(t=e.getCollectionViewCollectionStore())||void 0===t?void 0:t.id),new_page_id:"page"===n.type?e.id:void 0})}));const g=n.map((e=>B.E9({environment:o,transaction:a,sourceBlockId:e.id,targetBlockPointer:{id:(0,d.ZP)(),table:p.iU,spaceId:(0,u.C)(e.pointer.spaceId)},sourceBlockSubtree:c(e),targetInMemoryRecordCache:e.inMemoryRecordCache,addCopyName:!1,deepCopyTransclusionContainers:!l.isTransclusionType(),resolveTemplateVariables:!(l.isInsideTemplate()||l.isInsideFactoryOrDuplicateBlocksAction()),useCrdt:!1}).targetBlock));return q({blocksToDuplicate:n,duplicatedBlocks:g,environment:o,transaction:a,migrateSubitemFormat:s}),g}function J(e){let{blocks:t,transaction:o,from:n,to:r}=e;for(const i of t){const e=i.getPropertiesStore(),t=e.getValue();t&&E.sW({store:e,data:{[r.property]:t[n.property],[r.inverse]:t[n.inverse]},transaction:o})}return t}function X(e,t){const o=e.getPropertyValue(t.property);return i.rq(o)}async function ee(e){let{droppedStores:t,createdStores:o,collectionStore:n,environment:r,collectionContextStore:i,groupsPointer:a,alreadyMovedToCollection:s,shouldDuplicate:l}=e;if(!I.default.checkGate("collection_subitem_nested_operations"))return;const c=t.at(0);if(!c)return;const d=(0,w.g0)(c),p=(0,w.ko)(n);if(!p||!d)return;const u=await $({environment:r,blocks:t,options:{canEdit:!0}});if(u.length<=0)return;let m=[...u];if(l){const e=await oe({environment:r,blocks:u});e&&(m=[...e])}O.createAndCommit({userAction:"collectionGroupActions.handleGroupDrop.subitemsDrop",environment:r,perform:e=>{for(const t of m)A.mp({environment:r,store:t,collectionStore:n,collectionContextStore:i,groupsPointer:a,coerce:!0,transaction:e,alreadyMovedToCollection:s});d.subitemFormat.property===p.property&&d.subitemFormat.inverse===p.inverse||(l?q({blocksToDuplicate:[...t,...u],duplicatedBlocks:[...o,...m],environment:r,transaction:e,migrateSubitemFormat:{from:d.subitemFormat,to:p}}):function(e){let{blocks:t,transaction:o,from:n,to:r,environment:i}=e;t.forEach((e=>{X(e,n).forEach((t=>{const n=T.G.createChildStore(e,t);F.hE({environment:i,sourceStore:e,destStore:n,propertyWithInverse:r,transaction:o,position:{type:"after"}})}))}))}({blocks:[...t,...m],transaction:e,from:d.subitemFormat,to:p,environment:r}))}})}async function te(e){let{blocks:t,subitems:o,environment:n,canUndo:r,skipConfirmation:i}=e;const a=o||Y(t),s=[...t,...a];N.zO(s);const l=o||await $({environment:n,blocks:t,options:{canEdit:!0}});if(!i&&l.length>0){const{accept:e}=await function(e){let{itemCount:t,subitemCount:o}=e;return D.confirmUserActionV2({message:(0,L.jsx)(b.Z,{style:D.dialogStyles.title,children:(0,L.jsx)(c.FormattedMessage,{id:"deleteSubitems.confirmation.message",defaultMessage:"Confirm delete"})}),description:(0,L.jsx)(b.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,L.jsx)(c.FormattedMessage,{id:"deleteSubitems.confirmation.description",defaultMessage:"You are about to delete <b>{itemCount}</b> items and <b>{subitemCount}</b> subitems.",values:{itemCount:t,subitemCount:o,b:function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return(0,L.jsx)("b",{children:t})}}})}),acceptLabel:(0,L.jsx)(c.FormattedMessage,{id:"deleteSubitems.confirmation.acceptLabel",defaultMessage:"Delete"}),cancelLabel:(0,L.jsx)(c.FormattedMessage,{id:"deleteSubitems.confirmation.cancelLabel",defaultMessage:"Cancel"})})}({itemCount:t.length,subitemCount:l.length});if(!e)return void N.bj(s)}const{serverCommitResult:d}=O.createAndCommit({userAction:"selectableBlockActions.removeBlocksWithMaybeConfirmation",environment:n,canUndo:r,perform:e=>{N.Cl({environment:n,blocks:t,transaction:e});for(const t of l)E.sW({store:t,data:{alive:!1},transaction:e})}});await d}async function oe(e){var t;let{environment:o,blocks:r}=e;const i=r.at(0);if(!i)return;const a=(0,w.g0)(i),s=null===(t=(0,_.fm)(i))||void 0===t?void 0:t.collectionViewBlockStore();if(!s||!a)return;const{parentRelationProperty:l,parentRelationSchema:c}=a,d=[...r,...Y(r)];N.zO(d);const p=r.at(-1);if(!p)return;const u=await $({environment:o,blocks:r,options:{canEdit:!0}});let m=[],g=[];O.createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:o,perform:e=>{g=Q({blocks:[...r,...u],environment:o,transaction:e}),m=N.is({environment:o,blocks:g,selection:r,transaction:e,replaceEmptyTextBlock:!1,insertAfterBlock:p,preventSetSelection:!0})}});const h=(0,w.T2)({blocks:m,parentRelationProperty:l,parentRelationSchema:c,collectionViewBlockStore:s});return n.default.afterNextFlush((()=>{n.default.afterNextFlush((()=>{j.Z5({environment:o,stores:h})}))})),N.bj(d),g}},98688:(e,t,o)=>{o.d(t,{L:()=>u,v:()=>p});o(21703);var n=o(72126),r=o(45953),i=o(9844),a=o(35794),s=o(80444),l=o(72371),c=o(54642),d=o(9377);async function p(e){const{currentSpaceStore:t}=s.default.state;t&&await u({environment:e.environment,spaceId:t.id,force:!0})}async function u(e){const{environment:t,spaceId:o,force:p}=e;await s.default.waitUntilRendered();const u=l.Z.state;if(!u.loaded&&!u.loading||u.loaded&&o!==u.spaceId||p){l.Z.setState({...l.Z.state,loading:!0});const[e,s]=await Promise.all([c.searchIntegrations(t,{query:"",type:"compliance",spaceId:o}),d.j({environment:t,spaceId:o})]);if("success"!==e.type)throw new Error("Request failed.");const p=r.PF.create(e.data.recordMap),u=r.PF.create(s.recordMap);l.Z.setState({loaded:!0,loading:!1,spaceId:o,integrations:n.MR(n.oA(e.data.integrationIds.map((e=>p.getModel({table:i.K2,id:e})))),(e=>{let{created_at:t}=e;return t})),webhookSubscriptions:n.oA(s.webhookSubscriptionIds.map((e=>u.getModel({table:a.b,id:e,spaceId:o}))))})}}},86080:(e,t,o)=>{o.d(t,{b:()=>i,x:()=>a});var n=o(29477),r=o(81700);const i=function(e){const t=n.UZ();return r.Z.setState({...e,open:!0,onComplete:t.resolve,inputValue:""}),t.promise},a=function(e){const t=r.Z.state;t.open&&(t.onComplete(e.didConfirm),r.Z.reset())}},28673:(e,t,o)=>{o.d(t,{V:()=>f,c:()=>y});o(21703);var n=o(4615),r=o(6287),i=o(23867),a=o(97880),s=o(5366),l=o(70764),c=o(33929),d=o(32363),p=o(35661),u=o(47307),m=o(42631),g=o(9953);const h=(0,s.defineMessages)({authError:{defaultMessage:"Auth failed. Please try again or contact Notion support.",id:"database.viewSettings.propertyTypeSection.connected.authFail"},mobileAdminError:{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) app in settings to use this feature.",id:"database.viewSettings.propertyTypeSection.connected.mobileAdminError"},mobileError:{defaultMessage:"Please authorize this integration on the desktop app or a browser.",id:"database.viewSettings.propertyTypeSection.connected.mobileError"}});async function f(e,t,o,n){const r=e.device.isMobile,i=null==t?void 0:t.getSpaceStore();if(!i)return;const a=(0,l.NP)(o.id).length;if(r&&n&&!a){const e=c.default.formatMessage(h.mobileAdminError);throw u.showErrorMessage(e),new Error(e)}if(r&&!n&&!a){const e=c.default.formatMessage(h.mobileError);throw u.showErrorMessage(e),new Error(e)}if(!a&&n&&i.canAdmin()||!a&&!n)try{await m.hM({environment:e,integration:o,spaceId:i.id,from:"collection_settings_property_type"})}catch(s){const e=c.default.formatMessage(h.authError);throw u.showErrorMessage(e),new Error(e)}if(!(0,l.NP)(o.id).length){const e=c.default.formatMessage(h.authError);throw u.showErrorMessage(e),new Error(e)}}function y(e){const{environment:t,pattern:o,integration:s,parentCollectionStore:l,transaction:c}=e;if(!o.connected_relation_properties)throw new Error("Cannot create a connected relation collection without properties");const u=new p.NW(t,{table:r.v,id:(0,n.ZP)(),spaceId:l.pointer.spaceId}),m={};o.connected_relation_sub_schemas&&(0,a.qP)(o.connected_relation_sub_schemas).map((e=>{let[o,a]=e;const s=new p.NW(t,{table:r.v,id:(0,n.ZP)(),spaceId:l.pointer.spaceId}),d={bot_id:void 0,external_object_id:void 0,uri:o,integration_id:void 0,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:a,sync_state:void 0,pattern_name:void 0},h={id:s.id,version:0,space_id:(0,i.C)(l.pointer.spaceId),parent_table:r.v,parent_id:u.id,alive:!0,format:d,schema:{}};m[o]=s.id,g.sW({store:s,data:h,transaction:c})}));const h={id:u.id,version:0,space_id:(0,i.C)(l.pointer.spaceId),parent_table:r.v,parent_id:l.id,alive:!0,format:{attributes:[{id:"title",name:"title",type:"inline",format:{type:"title",section:"title"},values:[(0,d.ni)({pattern:o,integration:s})]}],bot_id:void 0,external_object_id:void 0,uri:`notion://user-defined-collection/${s.id}/${o.name}`,integration_id:s.id,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:o.connected_relation_properties,sync_state:void 0,pattern_name:o.name,related_external_object_uris_to_instance_ids:m},schema:{}};return g.sW({store:u,data:h,transaction:c}),u}},50950:(e,t,o)=>{o.d(t,{wk:()=>R,Tz:()=>F,OM:()=>Z,qo:()=>V,oG:()=>q,dd:()=>z,Nh:()=>N,a9:()=>O});o(67294);var n=o(15145),r=o(86658),i=o(74686),a=o(55632),s=o(68626),l=o(72126),c=o(91155),d=o(71644),p=o(63143),u=o(5366),m=o(54642),g=o(480),h=o(24405),f=o(56666),y=o(10182),v=o(89728),b=o(85893);const S=function(){window.__c={n:"CookieSnackbarButtons"};const e=(0,g.O7)(),t=(0,h.Fg)();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.Z,{onClick:()=>Z(e,{necessary:!0,performance:!0,preference:!0,targeting:!0}),children:(0,b.jsx)("b",{style:{color:t.contentBackground},children:(0,b.jsx)(u.FormattedMessage,{...r.ze.acceptAllButtonLabel})})}),(0,b.jsx)(v.Z,{onClick:()=>Z(e,{necessary:!0,performance:!1,preference:!1,targeting:!1}),children:(0,b.jsx)("b",{style:{color:t.contentBackground},children:(0,b.jsx)(u.FormattedMessage,{...r.ze.rejectAllButtonLabel})})}),(0,b.jsx)(y.Z,{hasDismissButton:!0,renderOrigin:e=>(0,b.jsx)(v.Z,{style:{paddingLeft:8,paddingRight:8},...e,children:(0,f.o)({width:14,marginLeft:4,fill:t.contentBackground})})})]})};var _=o(42402),w=o(24215),k=o(12955),x=o(33929),I=o(36867),C=o(80444),T=o(61893),M=o(45293),P=o(1310),A=o(50906),D=o(47307);const B=(0,u.defineMessages)({cookieConsentSaveError:{id:"cookieConsent.saveError",defaultMessage:"Cannot record cookie consent, please try again later."}});async function R(e){const{environment:t,onboardingState:o}=e;if(await E(t))return(0,I.g)(t.currentUser.id)>=2?(U(),M.Z.setState({open:!0}),A.xYN({environment:t,type:"modal",onboardingState:o}),void A.bmu(t)):void(P.ZP.state.currentItem||(P.ZP.setState({...P.ZP.state,currentItem:{key:(0,d.ZP)(),label:(0,b.jsx)("div",{children:(0,r.Fd)(F,"snackbar")}),right:(0,b.jsx)(S,{})}}),A.xYN({environment:t,type:"snackbar",onboardingState:o})))}async function E(e){if(!(0,k.canSetCookie)(e))return!1;if(!(0,k.canShowCookieUi)(e))return!1;const t=await(0,k.getHasPermissionArgs)(e);return"true"===(null==t?void 0:t.notion_check_cookie_consent)&&(null==t||!t.notion_cookie_consent)}function F(e,t){return(0,b.jsx)(_.Z,{href:e,children:t})}function N(e,t){if("necessary"===t)return;const o={...T.Z.getState().permission};o[t]=!o[t],T.Z.setPermission(o),j(e,o)}const j=l.Ds(((e,t)=>{O(e,t)}),2e3);async function O(e,t){const o=await m.recordCookieConsent(e,{id:T.Z.getId(),permission:t,document_version:r.fV,userId:e.currentUser.id}).catch((e=>{L({type:"recordCookieConsentError",error:(0,c.Ui)(e)})}));if(!o)return void L({type:"recordCookieConsentEmptyResult"});if("success"!==o.type)return void L({type:"recordCookieConsentReturnsNonSuccess",data:{miscDataToConvertToString:{result:o}}});const s=o.data;await T.Z.setCookieConsent(e,s),n.e9();const l=await w.cG(e),d=n.Zk(l);await a.Pv(d);const{permission:p}=s;w.j(e,"record_cookie_consent",{permission:p,consent_type:(0,i.JT)(p)})}function L(e){let{type:t,data:o,error:n}=e;D.showErrorMessage(x.default.formatMessage(B.cookieConsentSaveError)),s.log({level:"error",from:"cookieActions",type:t,data:o,error:n})}function U(){P.ZP.setState({...P.ZP.state,currentItem:void 0})}function Z(e,t){O(e,t),U(),V()}function V(){D.showMessage({message:x.default.formatMessage(r.ze.reloadAfterSaveMessage),onAccept:()=>{window.location.reload()}})}async function q(e){const{currentUserSettingsStore:t}=C.default.state;if(!t)return;await t.load();const o=t.getSettings();if(!o)return;const n=o.cookie_consent;n?(await T.Z.setCookieConsent(e,n),U()):(T.Z.clearCookieConsent(),await E(e)&&T.Z.setPermission(r.cW))}async function z(e){const t=await(0,k.getCookieConsentCookie)(e);if(!t)return;const o=(0,p.dj)(t);o&&T.Z.setState(o)}},41433:(e,t,o)=>{o.d(t,{Ns:()=>k,ZI:()=>I,fC:()=>x,jf:()=>C,nF:()=>w});o(21703),o(57658);var n=o(80951),r=o(76837),i=o(42875),a=o(59730),s=o(15157),l=o(19233),c=o(4615),d=o(45953),p=o(21202),u=o(19889),m=o(70203),g=o(95477),h=o(83960),f=o(80444),y=o(35661),v=o(50906),b=o(96802),S=o(9953),_=o(97444);const w="calloutBlockIcon",k="calloutBlockBackground";function x(e){var t,o,n;const{environment:r,createBlockItem:i,from:a,inMemoryRecordCache:s,transaction:l,useCrdt:u}=e;if(!i.templateRootBlockId||!i.createTemplate)throw new Error("Invalid createBlock item.");const m=(null===(t=f.default.state.currentSpaceStore)||void 0===t?void 0:t.id)??(null===(o=f.default.state.mainEditorCurrentBlockStore)||void 0===o?void 0:o.getSpaceId()),{targetBlock:g}=I({environment:r,sourceBlockId:i.templateRootBlockId,targetBlockPointer:{id:(0,c.ZP)(),table:p.iU,spaceId:m},sourceBlockSubtree:(0,d.R3)(i.createTemplate(r)),targetRecordCache:s,transaction:l,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,useCrdt:u});var h;(null===(n=i.postCreateCallback)||void 0===n||n.call(i,g,r),C({store:g,transaction:l}),a&&i.blockType)&&v.W2j(r,{from:a,type:i.blockType,collection_id:g.getParentCollectionId()??(null===(h=g.getCollectionViewCollectionStore())||void 0===h?void 0:h.id),collection_view_type:i.collectionViewType,is_toggleable:i.isToggleable,automation_id:g.getAutomationId(),new_page_id:"page"===i.blockType?g.id:void 0});return g}function I(e){const{environment:t,sourceBlockId:o,sourceBlockSubtree:n,targetBlockPointer:s,targetRecordCache:l,transaction:c,deepCopyTransclusionContainers:d,resolveTemplateVariables:p,recordPointerMap:m,useCrdt:h}=e,{duplicateRecordMap:f,originalToDuplicate:v}=r.PZ({sourceBlockId:o,targetBlockPointer:s,recordMap:n,recordPointerMap:m,options:{deepCopyTransclusionContainers:d,resolveTemplateVariables:!!p&&{currentUserId:t.currentUser.id,currentTimeZone:(0,i.r)()},blocksShouldUseCrdt:h},baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,actor:t.currentUser.id?{table:u.KJ,id:t.currentUser.id}:void 0,getRecordRole:l.makeGetRecordRoleFn(t.currentUser.id)}),b=new y.G(t,s,{inMemoryRecordCache:l});c.postPerformAssertions.push((function(){if(c.isLocal)return;if(!b.getParentStore())throw new a.p8(`Initialized template was not given a parent before being committed in transaction ${c.getUserActionForAnalyticsPurposesOnly()}`)}));for(const{pointer:r,model:i}of f){const e=null==i?void 0:i.__IM_SORRY__getValue(),t=(0,y.Kv)(b,r);e&&S.sW({store:t,data:e,transaction:c})}return{targetBlock:b,originalToDuplicate:v}}function C(e){const{store:t,transaction:o}=e;"code"===t.getType()?function(e){const{store:t,transaction:o}=e,r=t.getProperties(),i=t.getFormat(),a=t.environment.currentUser.id,c=s.Z.get({userId:a,key:h.T.localLanguagePreferenceKey}),d=c&&l.W[c]?c:h.T.defaultLanguage,p=s.Z.get({userId:a,key:h.T.localCodeWrapPreferenceKey}),u=t.getBlockTitleStore(),g=u.getValue(),f=m.vNd(g);f&&_.sO({environment:t.environment,store:u,value:f,transaction:o});void 0===r.language&&S.sW({store:t.getPropertiesStore(),data:{language:n.O2(d)},transaction:o});void 0===i.code_wrap&&S.sW({store:t.getFormatStore(),data:{code_wrap:p},transaction:o})}({store:t,transaction:o}):"table_of_contents"===t.getType()?function(e){const{store:t,transaction:o}=e;void 0===t.getFormat().block_color&&b.FH({stores:[t],update:{block_color:"gray"},transaction:o})}({store:t,transaction:o}):"callout"===t.getType()?function(e){const{store:t,transaction:o}=e,n=t.environment.currentUser.id,r=s.Z.get({userId:n,key:w})||"ðŸ’¡",i=s.Z.get({userId:n,key:k})||"gray_background",a=t.getFormat();void 0===a.block_color&&b.FH({stores:[t],update:{block_color:i},transaction:o});void 0===a.page_icon&&b.FH({stores:[t],update:{page_icon:r},transaction:o})}({store:t,transaction:o}):"quote"===t.getType()&&function(e){const{store:t,transaction:o}=e,n=t.environment.currentUser.id,r=s.Z.get({userId:n,key:h.l.localSizePreferenceKey});void 0!==r&&S.sW({store:t.getFormatStore(),data:{quote_size:r},transaction:o})}({store:t,transaction:o})}},67133:(e,t,o)=>{o.d(t,{b:()=>a,x:()=>s});var n=o(28748),r=o(24677),i=o(98104);function a(e,t){r.ZH(e),i.ZH(e),n.Z.setState({open:!0,...t})}function s(){n.Z.setState({open:!1,originRect:n.Z.state.originRect})}},42239:(e,t,o)=>{o.d(t,{LQ:()=>F,_4:()=>B,cQ:()=>A,eN:()=>N,f$:()=>E,fX:()=>D,td:()=>R});o(57658);var n=o(41432),r=o(8848),i=o(15095),a=o(42875),s=o(72126),l=o(4615),c=o(23867),d=o(97880),p=o(95477),u=o(24215),m=o(43250),g=o(78316),h=o(98165),f=o(41984),y=o(27406),v=o(81844),b=o(95802),S=o(55367),_=o(86486),w=o(27724),k=o(50906),x=o(47307),I=o(54532),C=o(42858),T=o(24677),M=o(98724),P=o(98104);function A(e,t){S.ZP.state.isDragging&&(S.ZP.reset(),T.$Y({environment:e,phase:w.SelectionPhase.Selected,preventClearEditingText:t}))}function D(e){if(S.ZP.state.isDragging){const{draggedStores:r,currentDropZone:i}=S.ZP.state,a=e.optionKey;let c;if(i){var t,o;const e=i.type===S.Dl.Selectable?b.C.findSelectablesFromStore(i.store):y.Z.findDropTargetsFromKey(i.key);null===(t=e.find((e=>Boolean(e.props.onSelectableDrop))))||void 0===t||null===(t=t.props)||void 0===t||null===(o=t.onSelectableDrop)||void 0===o||o.call(t,{droppedDirection:i.direction,droppedStores:r,duplicate:a}),c=function(e,t){const o=t.props,n="store"in o?o.store:void 0,r=n?v.Z.findOutlinerItemFromStore(n):void 0,i=n&&h.VP(n),a=i&&(0,u.nB)(i),s={...r&&{...a,type:r.type},..."analyticsName"in o&&{dropzone_from:o.analyticsName}};if(!e)return{...s,has_dropzone:!1};let c;switch(e.direction){case S.vh.Above:c="above";break;case S.vh.Below:c="below";break;case S.vh.Left:c="left";break;case S.vh.Onto:c="onto";break;case S.vh.Right:c="right";break;default:(0,d.t1)(e.direction)}if(e.type===S.Dl.Selectable)return{...s,has_dropzone:!0,dropzone_type:"selectable",dropzone_block_id:(0,l.cj)(e.store.id),dropzone_direction:c};return{...s,has_dropzone:!0,dropzone_type:"drop_target",dropzone_key:e.key,dropzone_direction:c}}(i,e[0])}const p=r.find((e=>{const t=e.getType();return Boolean(t&&(0,n.S9)(t))})),m=p&&h.VP(p),f=p&&(0,g.fm)(p);k.ROv(e.environment,{draggedTypes:s.oA(r.map((e=>e.getType()))),from:e.analyticsFrom,asCopy:a,draggableProps:{draggable_from:e.analyticsFrom,...m&&(0,u.nB)(m)},dropzoneProps:c,optionalAnalyticsProperties:{collectionContextStore:f}}),A(e.environment),e.environment.device.isPhone&&T.ZH(e.environment)}}function B(e){const{environment:t,files:o,analyticsFrom:n}=e;if(S.ZP.state.isDragging){var r;const e=S.ZP.state.currentDropZone;let s;var i,a;if(e)s=e.type===S.Dl.Selectable?b.C.findSelectableFromStore(e.store):y.Z.findDropTargetFromKey(e.key),null===(i=s)||void 0===i||null===(i=i.props)||void 0===i||null===(a=i.onNativeDrop)||void 0===a||a.call(i,{files:o,droppedDirection:e.direction});k.ROv(t,{draggedTypes:[],from:n,asCopy:!1}),A(t,null===(r=s)||void 0===r?void 0:r.props.keepTextSelectionOnDrop)}}function R(e,t){S.ZP.state.isDragging&&(P.ZH(e),S.ZP.setState({...S.ZP.state,...t}))}function E(e,t){if(S.ZP.state.isDragging)return!1;{const{startX:o,startY:n,isNativeDrag:r}=t,i=T.aw(t.stores);P.ZH(e);const a=b.C.getRectFromStore(i[0]);return S.ZP.setState({isDragging:!0,startX:o,startY:n,currentX:o,currentY:n,offsetX:o-(a&&a.left||0),offsetY:n-(a&&a.top||0),currentHintDropZones:[],draggedStores:i,isNativeDrag:r,ghostElements:i.map((e=>t.getGhostElement?t.getGhostElement(e):function(e){const{store:t}=e,o=b.C.findSelectablesFromStore(t);return s.oA(o.map((e=>{if(e.props.canSelect){const t=e.getNode();if(t)return N(t)}})))}({store:e})))}),T.$Y({environment:e,phase:w.SelectionPhase.Selected}),_.default.reset(),!0}}function F(e){const{droppedStores:t,transaction:o,environment:r,duplicate:i,duplicateUseCrdt:s}=e,l=e.resolveTemplateVariables;return t.map((e=>{if(!b.C.findSelectableFromStore(e))return e;if(i){const t=!e.isTransclusionType(),[i,a]=I.Qi({environment:r,stores:[e],addCopyName:(0,f.Z)(e),transaction:o,deepCopyTransclusionContainers:t,targetSpaceId:(0,c.C)(e.pointer.spaceId),resolveTemplateVariables:e.getType()!==n.Ti.factory&&l,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:s}),d=i[0];return a.then((e=>{e&&x.showErrorMessage(e)})),d}return l&&M.bt({store:e,context:{currentUserId:r.currentUser.id,currentTimeZone:(0,a.r)()},transaction:o}),C.Od({store:e,transaction:o}),e}))}function N(e){const t=e.style.transform,o=e.style.transition;e.style.transform="",e.style.transition="";const n=e.getBoundingClientRect();e.style.transform=t,e.style.transition=o;const i=e.cloneNode(!0);!function(e,t){const{firstElementChild:o}=e;if(o&&o.hasAttribute("embed-ghost")){const o=j(e,[]);if(o){const i=O(e,o),a=O(t,o);if(i&&a)if(i.shadowRoot){const e=i.shadowRoot;let t=null;if(a.createShadowRoot)t=a.createShadowRoot();else if(a.attachShadow)try{t=a.attachShadow({mode:"open"})}catch(n){}t&&(t.innerHTML=e.innerHTML)}else if(!i.src&&i.contentDocument){const e=document.createElement("iframe");e.width=i.offsetWidth,e.height=i.offsetHeight,L(e,a),a.parentElement.replaceChild(e,a),e.onload=t=>{const o=e.contentDocument.children[0],n=i.contentDocument.children[0];L(o,n),o.innerHTML=n.innerHTML}}else a.width=i.offsetWidth,a.height=i.offsetHeight,a.style.backgroundColor=r.ZP.blackWithAlpha(.12),a.style.backgroundImage=null,a.src=""}}}(e,i);const a=getComputedStyle(e);for(let r=0;r<a.length;r++){const e=a[r],t=a.getPropertyValue(e);"app-region"===e&&"none"===t||(i.style[e]=t)}"absolute"!==a.position&&"relative"!==a.position||(i.style.position="",i.style.top="",i.style.left="",i.style.bottom="",i.style.right="");const s=i.querySelectorAll(`.${m.No6}`);for(const r of s)r.remove();i.style.pointerEvents="none";const l=i.querySelectorAll("*");for(const r of l)r.style&&(r.style.pointerEvents="none");return{cloned:i,rect:n}}function j(e,t){if(e.shadowRoot)return t;if(e instanceof HTMLIFrameElement)return t;{const{firstElementChild:o,nextElementSibling:n}=e;if(o){t.push(0);const e=j(o,t);if(e)return e;t.pop()}if(n){t[t.length-1]+=1;const e=j(n,t);if(e)return e}return null}}function O(e,t){return t.reduce(((e,t)=>e&&e.children&&e.children[t]?e.children[t]:null),e)}function L(e,t){i.p4(t.attributes).forEach((t=>{let{name:o,value:n}=t;e.setAttribute(o,n)}))}},91584:(e,t,o)=>{o.d(t,{O$:()=>k,Ui:()=>v,WO:()=>b,cR:()=>_,qN:()=>w,vQ:()=>S});var n=o(99405),r=o(23867),i=o(64002),a=o(5366),s=o(50906),l=o(47307),c=o(47839),d=o(95477),p=o(91924),u=o(7844),m=o(5315),g=o(54642),h=o(92625),f=o(15356);const y=(0,a.defineMessages)({authenticatingWithGoogle:{id:"googleDriveActions.authenticatingWithGoogle.loadingMessage",defaultMessage:"Authenticating with Googleâ€¦"},googleLoginTitle:{defaultMessage:"Google login",id:"googleDriveActions.loginWithGoogleModal.title"}});async function v(e){const{environment:t,store:o,fileId:n,token:i}=e;await m.transactionQueue.awaitRecordTransaction(o.pointer);const a=await g.initializeGoogleDriveBlock(t,{block:{id:o.id,spaceId:(0,r.C)(o.pointer.spaceId)},fileId:n,token:i});if("failed"!==a.type)return a.data.file&&s.cV4(t,{file_type:a.data.file.mimeType??void 0}),a.data;l.showError(a)}function b(e,t){g.refreshGoogleDriveBlock(e,{block:t})}async function S(e){const t=await g.getGoogleDriveAccounts(e,{});return"success"===t.type&&t.data.accounts?t.data:{accounts:[]}}function _(e,t){const{onSuccess:o,onFailure:n}=t;u.Z.setState({open:!0,onConfirm:async()=>{const t=await w(e);t&&t.token?o(t.token):n&&n()},onDecline:n})}async function w(e){const t=(0,p.eC)(e);let o=(0,n.ZQ)(d.default.domainBaseUrl,{authType:t});if(o=t.redirectToAuth?o:await(0,p.HU)(e,o),e.device.isElectron)return void c.openExternalUrl(o);const r=await f.M(e,{width:610,height:700,url:o,titleMessage:y.googleLoginTitle});if(!r)return;const a=i.Qc(r);return await k(e,a.query.code)}async function k(e,t){if(!t)return;h.j({message:y.authenticatingWithGoogle});const o=await g.authWithGoogleForDrive(e,{code:t});if(h.x(),"failed"!==o.type)return s.L3B(e,{integration_name:"google"}),o.data;{const e=o.error;console.error(e),l.showError(o)}}},54532:(e,t,o)=>{o.d(t,{E9:()=>N,K8:()=>L,Qi:()=>O,WJ:()=>j});o(21703),o(57658);var n=o(41432),r=o(76837),i=o(42875),a=o(59730),s=o(64572),l=o(59753),c=o(29477),d=o(4615),p=o(45953),u=o(606),m=o(98963),g=o(18844),h=o(21202),f=o(6287),y=o(13493),v=o(29369),b=o(70203),S=o(5366),_=o(95477),w=o(33954),k=o(33929),x=o(35328),I=o(80444),C=o(88632),T=o(35661),M=o(50906),P=o(54642),A=o(41433),D=o(47307),B=o(29533),R=o(9953),E=o(39865);const F=(0,S.defineMessages)({offlineError:{id:"duplicateActions.offlineError.message",defaultMessage:"Please go online to copy this block."},unknownError:{id:"duplicateActions.unknownError.message",defaultMessage:"An unknown error occurred."}});function N(e){const{environment:t,sourceBlockId:o,targetBlockPointer:n,sourceBlockSubtree:i,targetInMemoryRecordCache:a,addCopyName:s,deepCopyTransclusionContainers:l,resolveTemplateVariables:c,transaction:d,useCrdt:p}=e,{targetBlock:u,originalToDuplicate:m}=A.ZI({environment:t,sourceBlockId:o,targetBlockPointer:n,sourceBlockSubtree:i,targetRecordCache:a,transaction:d,deepCopyTransclusionContainers:l,resolveTemplateVariables:c,useCrdt:p});if(s&&u&&u.isNavigableBlock()){const e=u.getTitleStore();if(e){const t=e.getValue(),o=r.eb(t);R.sO({store:e,value:o,transaction:d})}}return{targetBlock:u,originalToDuplicate:m}}function j(e){const{environment:t,sourceBlocks:o,targetInMemoryRecordCache:r,snapshotData:s,addCopyName:l,deepCopyTransclusionContainers:d,resolveTemplateVariables:p,transaction:u,targetSpaceId:m,convertExternalObjectInstancesToPlaceholders:g,useCrdt:h,duplicateOnlyCollectionSchema:f}=e;if(0===o.length)throw new Error("Must duplicate at least one block");const y=o.map(((e,o)=>R.j4({environment:t,type:n.Ti.copyIndicator,inMemoryRecordCache:r,transaction:u,spaceId:m,useCrdt:h}))),v=c.UZ();return u.postSubmitCallbacks.push((async e=>{if(e)(0,a.Jx)(e)?v.resolve((0,w.nX)(k.default.getIntl(),e)):v.resolve(k.default.formatMessage(F.unknownError));else{const e=P.duplicateBlock(t,{sourceBlocks:o,targetBlocks:y.map((e=>({id:e.id,spaceId:e.getSpaceId()}))),snapshotData:s,addCopyName:l,deepCopyTransclusionContainers:d,resolveTemplateVariables:!!p&&{currentUserId:t.currentUser.id,currentTimeZone:(0,i.r)()},convertExternalObjectInstancesToPlaceholders:g,useCrdt:h,duplicateOnlyCollectionSchema:f});let n;for await(const t of e){for(const e of y)B.R(t,e.id);n=t}for(const t of y)B.h(t.id);if(!n)return void v.resolve(void 0);if(n.error){E.Tq({environment:t,blocks:y});const e=(0,w.HV)(k.default.getIntl(),n.error);v.resolve(e)}else v.resolve(void 0)}})),[y,v.promise]}function O(e){const{environment:t,stores:o,addCopyName:n,deepCopyTransclusionContainers:r,resolveTemplateVariables:i,transaction:a,targetSpaceId:s,preferDuplicateLocation:l,analyticsFrom:c,useCrdt:p,duplicateOnlyCollectionSchema:u}=e;if(0===o.length)throw new Error("Must duplicate at least one block");const m=o[0].getSpaceId();if(!o.every((e=>e.getSpaceId()===m)))throw new Error("All stores must be in the same space");if(o.length>1&&!o.every((e=>e.isTypedCollectionViewBlock())))throw new Error("Multiple source blocks only supported for grouped typed DB duplication");for(const d of o){const e=d.getRecordStoreAtRootPath().getValue();let o;const{currentSpaceStore:n}=I.default.getState();var g;if(n&&(null==e?void 0:e.parent_table)===v.e0&&(o=T.zX.createChildStore(n,{table:v.e0,id:e.parent_id})),e)M.W2j(t,{from:c??"copy",type:e.type,teamStore:o,is_toggleable:(0,x._A)(e.type,e.format),collection_id:d.getParentCollectionId()??(null===(g=d.getCollectionViewCollectionStore())||void 0===g?void 0:g.id),new_page_id:"page"===e.type?d.id:void 0})}const f=m!==s;if("local"===l&&1===o.length){const e=o[0],l=L(t,{blockId:e.id,inMemoryRecordCache:e.inMemoryRecordCache,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!r,allowCopyExternalObjectInstances:!f});if(l){const{targetBlock:o}=N({environment:t,sourceBlockId:e.id,targetBlockPointer:{id:(0,d.ZP)(),table:h.iU,spaceId:s},sourceBlockSubtree:l,targetInMemoryRecordCache:e.inMemoryRecordCache,addCopyName:n,deepCopyTransclusionContainers:r,resolveTemplateVariables:i,transaction:a,useCrdt:p});return[[o],Promise.resolve(void 0)]}}for(const d of o)if(d.inMemoryRecordCache!==t.defaultRecordCache.inMemoryRecordCache)throw new Error("Can only server duplicate from the environment.defaultRecordCache.inMemoryRecordCache.");const y=t.defaultRecordCache.inMemoryRecordCache;return C.Z.state.online||D.showErrorMessage(k.default.formatMessage(F.offlineError)),j({environment:t,sourceBlocks:o.map((e=>({id:e.id,spaceId:e.getSpaceId()}))),targetInMemoryRecordCache:y,addCopyName:n,transaction:a,deepCopyTransclusionContainers:r,resolveTemplateVariables:i,targetSpaceId:s,convertExternalObjectInstancesToPlaceholders:f,useCrdt:p,duplicateOnlyCollectionSchema:u})}function L(e,t){const{blockId:o,inMemoryRecordCache:r,allowCopyCollections:i,requireFullSubtree:a,skipTransclusionContainerChildren:c,allowCopyExternalObjectInstances:d}=t,v=e.currentUser.id,S=p.Ak.create(),w=new Set,k=[{pointer:{table:h.iU,id:o},parentId:"doesn't matter"}];for(;k.length>0;){const e=k.shift();if(!e)continue;if(w.has(e.pointer.id))continue;w.add(e.pointer.id);const t=o===e.pointer.id;if((0,u.$O)(e.pointer,h.iU)){var x,I,C;const o=r.getRecord({pointer:e.pointer,userId:v});if(!o||!o.value){if(a)return;continue}const i=o.value;if(!t&&i.parent_id!==e.parentId)continue;if(i.type===n.Ti.externalObjectInstance&&!d)return;if(S.setValue(e.pointer,i),null!==(x=i.format)&&void 0!==x&&x.collection_pointer&&k.push({pointer:i.format.collection_pointer,parentId:i.id}),i.collection_id&&k.push({pointer:{table:f.v,id:i.collection_id},parentId:i.id}),i.view_ids)for(const e of i.view_ids)k.push({pointer:{table:y.n,id:e,spaceId:i.space_id},parentId:i.id});if(!c||"transclusion_container"!==i.type){const e=l.kk.fromBlock(i).getRenderableContentIds();for(const t of e)k.push({pointer:{table:h.iU,id:t},parentId:i.id})}if(i.type===n.Ti.externalObjectInstance){var T,M;const e=(null===(T=i.format)||void 0===T?void 0:T.related_external_object_uris_to_instance_ids)&&Object.values(null===(M=i.format)||void 0===M?void 0:M.related_external_object_uris_to_instance_ids)||[];for(const t of e)k.push({pointer:{table:h.iU,id:t,spaceId:i.space_id},parentId:i.id})}if(i.properties)for(const e of Object.values(i.properties))if(e)for(const t of e)for(const e of b.hDy(t)){if(b.STW(e)){const t=b.TOT(e);k.push({pointer:{table:h.iU,id:t},parentId:i.id})}if(b.j0F(e)){const t=b.zW$(e),o=(0,s.A5)({url:t,baseUrl:_.default.domainBaseUrl,publicDomainName:_.default.publicDomainName});o&&k.push({pointer:{table:h.iU,id:o},parentId:i.id})}if(b.nSN(e)){const t=b.frW(e);t&&k.push({pointer:{table:h.iU,id:t,spaceId:i.space_id},parentId:i.id})}}null!==(I=i.format)&&void 0!==I&&I.automation_id&&k.push({pointer:{table:m.cv,id:i.format.automation_id,spaceId:i.space_id},parentId:i.id}),null!==(C=i.format)&&void 0!==C&&C.ai_instructions_page_pointer&&k.push({pointer:i.format.ai_instructions_page_pointer,parentId:i.id})}else if((0,u.$O)(e.pointer,f.v)){var P;if(!i)return;const t=r.getRecord({pointer:e.pointer,userId:v});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;const o=t.value;S.setValue(e.pointer,o),r.forEachRecord(v,(t=>{let{model:o}=t;o.table===h.iU&&o&&o.parent_id===e.pointer.id&&o.alive&&k.push({pointer:o.pointer,parentId:e.pointer.id})}));const n=(null===(P=o.format)||void 0===P?void 0:P.automation_ids)??[];for(const e of n)k.push({pointer:{table:m.cv,id:e,spaceId:o.space_id},parentId:o.id})}else if((0,u.$O)(e.pointer,y.n)){const t=r.getRecord({pointer:e.pointer,userId:v});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;S.setValue(e.pointer,t.value)}else if((0,u.$O)(e.pointer,m.cv)){const t=r.getRecord({pointer:e.pointer,userId:v});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;S.setValue(e.pointer,t.value);for(const e of t.value.action_ids??[])k.push({pointer:{table:g.Xj,id:e,spaceId:t.value.space_id},parentId:t.value.id})}else if((0,u.$O)(e.pointer,g.Xj)){const t=r.getRecord({pointer:e.pointer,userId:v});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;S.setValue(e.pointer,t.value);for(const e of t.value.blocks??[])k.push({pointer:{table:h.iU,id:e,spaceId:t.value.space_id},parentId:t.value.id})}}return S}},47839:(e,t,o)=>{o.r(t),o.d(t,{appUpdateAvailable:()=>C,appUpdateChecking:()=>I,appUpdateError:()=>x,appUpdateFinished:()=>A,appUpdateInstall:()=>D,appUpdateNotAvailable:()=>T,appUpdateProgress:()=>P,appUpdateReady:()=>k,appUpdateReload:()=>M,checkForUpdates:()=>v,clearBrowserHistory:()=>g,clearCookies:()=>X,clearGoogleAuthCookies:()=>ee,closeGlobalSearchModal:()=>me,closeQuickSearch:()=>he,downloadUrl:()=>oe,electronApi:()=>c,electronAppFeatures:()=>le,electronUpdateAvailable:()=>S,electronUpdateChecking:()=>b,electronUpdateError:()=>y,electronUpdateNotAvailable:()=>_,electronUpdateProgress:()=>w,electronUpdateReady:()=>f,fullscreen:()=>E,getAppPath:()=>te,getCurrentZoom:()=>L,getDesktopVersion:()=>d,getSubstitutions:()=>W,inPageSearch:()=>F,initializeElectron:()=>ae,installElectronUpdate:()=>B,isActiveTab:()=>pe,isMainTabOrWindow:()=>H,isRunningUnderArm64Translation:()=>R,onNewWindow:()=>$,openDevTools:()=>z,openExternalUrl:()=>m,openGoogleDrivePickerPopup:()=>Q,openInNewTab:()=>p,openInNewWindow:()=>u,openOauthPopup:()=>Y,openPageFromGlobalSearch:()=>ge,openQuickSearchResult:()=>fe,openSearchModalFromQuickSearch:()=>be,quickSearchReady:()=>ye,quickSearchVisibilityState:()=>ve,ready:()=>ie,refreshAll:()=>se,setBadge:()=>h,setLogglyData:()=>J,setTabColors:()=>K,setTheme:()=>G,sidebarState:()=>ce,subscribeToProtocolUrl:()=>ne,subscribeToSettingsMenuItem:()=>re,toggleMaximized:()=>q,track:()=>ue,windowSidebarState:()=>de,zoomIn:()=>U,zoomOut:()=>Z,zoomReset:()=>V});o(97391);var n=o(68626),r=o(72126),i=o(64002);function a(e){const t=e.match(/Mac OS X (\d+_\d+)/);if(t)return t[1].split("_").map((e=>parseInt(e,10)))}var s=o(63643);let l="lastProtocolUrlDeduplicationId";const c=s.electronApi,d=s.getDesktopVersion;function p(e){const t=i.T1(e.url);c&&(c.openInNewTab?c.openInNewTab(t,e.makeTabActive,e.position):c.openInNewWindow(t))}function u(e){const t=i.T1(e);c&&c.openInNewWindow(t)}function m(e){if(c){void 0!==i.yn(e)&&c.openExternalUrl(e)}}function g(){c&&c.clearBrowserHistory()}function h(e){if(c)return c.setBadge(e)}const f={addListener(e){c&&c.updateReady.addListener(e)},removeListener(e){c&&c.updateReady.removeListener(e)}},y={addListener(e){c&&c.updateError&&c.updateError.addListener(e)},removeListener(e){c&&c.updateError&&c.updateError.removeListener(e)}},v=()=>{c&&c.checkForUpdates&&c.checkForUpdates()},b={addListener(e){c&&c.updateChecking&&c.updateChecking.addListener(e)},removeListener(e){c&&c.updateChecking&&c.updateChecking.removeListener(e)}},S={addListener(e){c&&c.updateAvailable&&c.updateAvailable.addListener(e)},removeListener(e){c&&c.updateAvailable&&c.updateAvailable.removeListener(e)}},_={addListener(e){c&&c.updateNotAvailable&&c.updateNotAvailable.addListener(e)},removeListener(e){c&&c.updateNotAvailable&&c.updateNotAvailable.removeListener(e)}},w={addListener(e){c&&c.updateProgress&&c.updateProgress.addListener(e)},removeListener(e){c&&c.updateProgress&&c.updateProgress.removeListener(e)}},k={addListener(e){c&&c.appUpdateReady&&c.appUpdateReady.addListener(e)},removeListener(e){c&&c.appUpdateReady&&c.appUpdateReady.removeListener(e)}},x={addListener(e){c&&c.appUpdateError&&c.appUpdateError.addListener(e)},removeListener(e){c&&c.appUpdateError&&c.appUpdateError.removeListener(e)}},I={addListener(e){c&&c.appUpdateChecking&&c.appUpdateChecking.addListener(e)},removeListener(e){c&&c.appUpdateChecking&&c.appUpdateChecking.removeListener(e)}},C={addListener(e){c&&c.appUpdateAvailable&&c.appUpdateAvailable.addListener(e)},removeListener(e){c&&c.appUpdateAvailable&&c.appUpdateAvailable.removeListener(e)}},T={addListener(e){c&&c.appUpdateNotAvailable&&c.appUpdateNotAvailable.addListener(e)},removeListener(e){c&&c.appUpdateNotAvailable&&c.appUpdateNotAvailable.removeListener(e)}},M={emit:e=>{c&&c.appUpdateReload&&c.appUpdateReload.emit(e)},addListener(e){c&&c.appUpdateReload&&c.appUpdateReload.addListener(e)},removeListener(e){c&&c.appUpdateReload&&c.appUpdateReload.removeListener(e)}},P={addListener(e){c&&c.appUpdateProgress&&c.appUpdateProgress.addListener(e)},removeListener(e){c&&c.appUpdateProgress&&c.appUpdateProgress.removeListener(e)}},A={addListener(e){c&&c.appUpdateFinished&&c.appUpdateFinished.addListener(e)},removeListener(e){c&&c.appUpdateFinished&&c.appUpdateFinished.removeListener(e)}},D={addListener(e){c&&c.appUpdateInstall&&c.appUpdateInstall.addListener(e)},removeListener(e){c&&c.appUpdateInstall&&c.appUpdateInstall.removeListener(e)}};function B(){c&&c.installUpdate()}function R(){var e;return null==c||null===(e=c.isRunningUnderArm64Translation)||void 0===e?void 0:e.call(c)}const E={get(){if(c)return c.fullscreen.get()},addListener(e){c&&c.fullscreen.addListener(e)},removeListener(e){c&&c.fullscreen.removeListener(e)}},F={start(e){c&&c.inPageSearch&&c.inPageSearch.start(e)},stop(){c&&c.inPageSearch&&c.inPageSearch.stop()},started:{addListener(e){c&&c.inPageSearch&&c.inPageSearch.started.addListener(e)},removeListener(e){c&&c.inPageSearch&&c.inPageSearch.started.removeListener(e)}},stopped:{addListener(e){c&&c.inPageSearch&&c.inPageSearch.stopped.addListener(e)},removeListener(e){c&&c.inPageSearch&&c.inPageSearch.stopped.removeListener(e)}}},N=(e,t,o)=>Math.min(Math.max(e,o),t);let j,O=1;function L(){return O}function U(){c&&c.zoom&&(O+=.1,c.zoom.set(N(.1,4.9,O)))}function Z(){c&&c.zoom&&(O-=.1,c.zoom.set(N(.1,4.9,O)))}function V(){c&&c.zoom&&(O=1,c.zoom.set(O))}function q(){c&&c.toggleMaximized&&c.toggleMaximized()}function z(){c&&c.openDevTools&&c.openDevTools()}function W(){return j||[]}async function H(){return c&&c.isMainTab?c.isMainTab():!c||!c.isMainWindow||c.isMainWindow()}function G(e){c&&c.setTheme&&c.setTheme(e)}function K(e){c&&c.setTabColors&&c.setTabColors(e)}function $(e){c&&c.newWindow&&c.newWindow.addListener(e)}async function Y(e){if(c&&c.openOauthPopup)return c.openOauthPopup(e)}async function Q(e){if(c&&c.openGoogleDrivePickerPopup)return c.openGoogleDrivePickerPopup(e)}function J(e){c&&(c.setLoggerData?c.setLoggerData(e):c.setLogglyData&&c.setLogglyData(e))}function X(){c&&c.clearCookies&&c.clearCookies()}function ee(){c&&c.clearAllCookies&&c.clearAllCookies()}async function te(){if(c&&c.getAppPath)return c.getAppPath()}function oe(e){if(c&&c.downloadUrl)c.downloadUrl(e);else{const t=document.createElement("a");t.download=e,t.href=e,t.click()}}function ne(e){c&&c.onNavigate&&c.onNavigate.addListener(((t,o)=>{if("string"!=typeof o&&o.deduplicationID){const e=o.deduplicationID;if(l===e)return void n.log({level:"warning",from:"electronActions",type:"duplicateOnNavigateObjectDetected"});l=e}e(o)}))}function re(e){c&&c.onOpenSettings&&c.onOpenSettings.addListener((t=>e()))}function ie(){c&&c.ready&&c.ready()}async function ae(e){const{device:t,electronSqlite:o}=e;if(c){if(await s.getAndCacheDesktopVersionAsync(),c.zoom&&(O=await c.zoom.get()),o&&o.sqliteConnection&&(await o.sqliteConnection.ensureMigrated(),o.sqliteConnection.optimize()),c.getSubstitutions&&t.isElectronMac){const e=await c.getSubstitutions();j=e.filter((e=>e.replace!==e.with)).map((e=>({length:e.replace.length,replace:new RegExp(`\\b${r.hr(e.replace)} $`),with:`${e.with} `})))}t.isElectronMac&&function(){const e=a(arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.userAgent);return!!e&&10===e[0]&&e[1]<15}()&&le.setPreference("isAutoUpdaterDisabled",!0)}}function se(e){c&&c.refreshAll&&c.refreshAll(e.includeFocusedWindow)}const le={get(){if(c&&c.electronAppFeatures)return c.electronAppFeatures.get()},setPreference(e,t){var o;c&&null!==(o=c.electronAppFeatures)&&void 0!==o&&o.setPreference&&c.electronAppFeatures.setPreference(e,t)},addListener(e){c&&c.electronAppFeatures&&c.electronAppFeatures.addListener(e)},removeListener(e){c&&c.electronAppFeatures&&c.electronAppFeatures.removeListener(e)}},ce={set(e){c&&c.sidebarState&&c.sidebarState.set(e)},addToggleListener(e){c&&c.sidebarState&&c.sidebarState.addToggleListener(e)},removeToggleListener(e){c&&c.sidebarState&&c.sidebarState.removeToggleListener(e)}},de={get:()=>c&&c.windowSidebarState?c.windowSidebarState.get():Promise.resolve(void 0),set(e){c&&c.windowSidebarState&&c.windowSidebarState.set(e)},addListener(e){c&&c.windowSidebarState&&c.windowSidebarState.addListener(e)},removeListener(e){c&&c.windowSidebarState&&c.windowSidebarState.removeListener(e)}},pe={get:()=>c&&c.isActiveTab?c.isActiveTab.get():Promise.resolve(!1),addListener(e){c&&c.isActiveTab&&c.isActiveTab.addListener(e)},removeListener(e){c&&c.isActiveTab&&c.isActiveTab.removeListener(e)}},ue={addListener(e){c&&c.track&&c.track.addListener(e)},removeListener(e){c&&c.track&&c.track.removeListener(e)}};function me(){c&&c.closeGlobalSearchModal&&c.closeGlobalSearchModal()}function ge(e){c&&c.openPageFromGlobalSearch&&c.openPageFromGlobalSearch(e)}function he(){c&&c.closeQuickSearch&&c.closeQuickSearch()}function fe(e){c&&c.openQuickSearchResult&&c.openQuickSearchResult(e)}function ye(){c&&c.quickSearchReady&&c.quickSearchReady()}const ve={isVisible:()=>c&&c.quickSearchVisibilityState?c.quickSearchVisibilityState.isVisible():Promise.resolve(!1),addListener(e){c&&c.quickSearchVisibilityState&&c.quickSearchVisibilityState.addListener(e)},removeListener(e){c&&c.quickSearchVisibilityState&&c.quickSearchVisibilityState.removeListener(e)}},be={addListener(e){c&&c.openSearchModalFromQuickSearch&&c.openSearchModalFromQuickSearch.addListener(e)},removeListener(e){c&&c.openSearchModalFromQuickSearch&&c.openSearchModalFromQuickSearch.removeListener(e)}}},31781:(e,t,o)=>{o.d(t,{vW:()=>D,z:()=>R,TH:()=>L,I:()=>F,qC:()=>B,qL:()=>j,x1:()=>U,cT:()=>E});o(57658);var n=o(1302),r=o(41432),i=o(80951),a=o(95538),s=o(43593),l=o(70203),c=o(5366),d=o(54642),p=o(48948),u=o(95477),m=o(33929),g=o(45010),h=o(18245),f=o(58202),y=o(53809),v=o(30548);const b=new y.D({key:"urlTurnedBookmarkToastStatusSetting",namespace:v.$p,important:!0,trackingType:"preference"});var S=o(27411),_=o(50906),w=o(62365),k=o(96802),x=o(27153),I=o(9953),C=o(75018),T=o(64964),M=o(39699),P=o(53471);const A=(0,c.defineMessages)({urlTurnedBookmark:{id:"action.urlTurnedBookmark.snackBarMessage",defaultMessage:"Pasted url is not embeddable, turned to bookmark instead!"}});let D=function(e){return e[e.Page=0]="Page",e[e.PageComment=1]="PageComment",e[e.SidebarComment=2]="SidebarComment",e}({});function B(e){return e===D.PageComment||e===D.SidebarComment}function R(e){const{environment:t,files:o,inMemoryRecordCache:n,transaction:r,pageWidth:i,ignoreOversizedFiles:a,spaceId:s,useCrdt:l}=e;return o.filter((e=>{if(a){if(!P.Q7({environment:t,file:e,preventLimitFreeFileSize:!1}))return P.A3(t),!1}return!0})).map((e=>{if(!e.type||0!==e.type.indexOf("image")&&0!==e.type.indexOf("video")&&0!==e.type.indexOf("audio")||e.type.includes("photoshop")){const o=I.j4({environment:t,type:"file",inMemoryRecordCache:n,transaction:r,spaceId:s,useCrdt:l});return r.postSubmitCallbacks.push((n=>{n||w.c({environment:t,store:o,file:e})})),o}{const o=I.j4({environment:t,type:"embed",inMemoryRecordCache:n,transaction:r,spaceId:s,useCrdt:l});return r.postSubmitCallbacks.push((n=>{n||E({environment:t,store:o,file:e,pageWidth:i,preferredType:void 0})})),o}}))}function E(e){const{environment:t,store:o,file:r,pageWidth:i,preferredType:s}=e,l=S.default.getBlockKey(o.id);x.Z(),P.cT({environment:t,file:r,bucket:"secure",record:o.pointer,onStart:e=>{if(S.default.setKeyState(l,{progressPercent:0,file:r,name:e.name,size:e.size}),r.type.indexOf("image")>=0&&!(0,a.y_)(e.name,"tiff")&&!(0,a.y_)(e.name,"tif")){const e=URL.createObjectURL(r),a=new Image;a.onload=function(){N(t,{store:o,width:a.naturalWidth,height:a.naturalHeight,scale:!0,type:"image",pageWidth:i}),t.device.isMobile&&n.default.afterNextFlush((()=>{g.Z.PageScroller&&g.Z.PageScroller.scrollerHack()})),URL.revokeObjectURL(e)},a.src=e}else{const e=(0,a.Dz)({url:r.name||"",baseUrl:u.default.domainBaseUrl,publicDomainName:u.default.publicDomainName,preferredType:s});N(t,{store:o,width:i,type:e,pageWidth:i})}},onProgress:e=>{const t=S.default.getKeyState(l);t&&S.default.setKeyState(l,{...t,progressPercent:e.progressPercent})},onComplete:async e=>{const n=S.default.getKeyState(l);if(n){const r=Boolean(n.dataURL),a=n.name,c=n.size;await F(t,{source:e,store:o,isDataURL:r,pageWidth:i,preferredType:s,name:a,size:c}),S.default.setKeyState(l,void 0)}},onError:()=>{S.default.setKeyState(l,void 0)},retryWhenOffline:!0})}async function F(e,t){const{store:o,source:n,isDataURL:i,pageWidth:s,preferredType:c,name:g,size:f}=t;let y=i?"image":(0,a.Dz)({url:n,baseUrl:u.default.domainBaseUrl,publicDomainName:u.default.publicDomainName,preferredType:c});const v=Z(y,n),{properties:S,type:w,format:x}=await(0,a.Ol)({source:v,type:y,isDataURL:i,pageWidth:s,isMobileDevice:e.device.isMobile,getEmbedData:async t=>{const o=await d.getGenericEmbedBlockData(e,t);return"failed"===o.type?void console.error(o.error):o.data},trackEmbedType:t=>_.Jgl(e,{embedType:t})});if(y=w,y===r.Ti.bookmark){const n=o;return await p.K({environment:e,store:n,url:v,transformTimeout:0}),_.mCV(e),function(){if("do_not_prompt"===b.state)return;b.state?"displayed_once"===b.state?b.setState("displayed_twice"):"displayed_twice"===b.state&&b.setState("do_not_prompt"):b.setState("displayed_once");T.oV({label:m.default.formatMessage(A.urlTurnedBookmark)})}(),void(t.metric&&h.default.measure(t.metric,{environment:e,data:{embedType:y}}))}_.GlI(e,{embedType:w});const C=g&&f?{title:l.TPx(g),size:l.TPx(f)}:{},{serverCommitResult:P}=M.createAndCommit({userAction:"embedBlockActions.initializeEmbedBlock",environment:e,perform:e=>{I.sW({store:o.getPropertiesStore(),data:{...S||{},...C},transaction:e}),k.FH({stores:[o],update:x,transaction:e}),I.sW({store:o,data:{type:y},transaction:e})}});await P,t.metric&&h.default.measure(t.metric,{environment:e,data:{embedType:y}})}function N(e,t){let{store:o,...n}=t;M.createAndCommit({userAction:"embedBlockActions.initializeFormat",environment:e,perform:e=>{k.FH({stores:[o],update:(0,a.tj)(n),transaction:e})}})}async function j(e,t){const{store:o}=t,n=o.getProperties();if(n){const p=o.getType();let u,m;if("file"===p){const t=await V({environment:e,store:o,calledFrom:"openSource"});t&&(m=t.url,u=t.fileName)}else{const e=p===r.Ti.bookmark?n.link:n.source,t=i.zB(e),a=l.QaF(n.title),{display_source:c,original_url:d}=o.getFormat();m=o.isExternalObjectInstanceBlockStore()?d:t||c,m&&(u=s.rF({title:a,source:m}))}var a,c,d="file";if("image"===p?d="image":"video"===p&&(d="video"),m)await C.openFileUrl(e,{url:m,downloadName:u,type:d,from:t.from,permissionRecord:t.store.pointer,download:(null===(a=u)||void 0===a?void 0:a.endsWith(".html"))||(null===(c=u)||void 0===c?void 0:c.endsWith(".htm"))})}}const O=(0,c.defineMessages)({downloadingImage:{id:"embedBlockActions.downloading.label",defaultMessage:"Downloadingâ€¦"}});async function L(e){const{store:t,environment:o}=e,n=await V({store:t,environment:o,calledFrom:"downloadSource"});if(!n)return;const{url:r,fileName:i}=n;if(r){let n;_.Uk(o,{url:r,fileName:i,from:"embedBlockActions"}),n=s.E$(r,[u.default.secureFileS3.url,u.default.secureFileS3V2.url])?C.downloadFileUrl(o,{url:r,download:!0,downloadName:i,permissionRecord:t.pointer}):function(e){const{store:t,environment:o}=e;if(!o.currentUser.id)return Promise.resolve();const n=t.getProperties(),r=l.QaF(null==n?void 0:n.source),i=l.QaF(null==n?void 0:n.caption);return s.GN(r,t.pointer,u.default.domainBaseUrl,o.currentUser.id,i)}(e),T.oV({label:m.default.formatMessage(O.downloadingImage),durationMs:"keep"}),await n.finally((()=>{T.rN()}))}}const U=e=>{const{store:t}=e,o=f.R.findBlockFromStoreWithMethod(t,"replace");o&&o.replace()},Z=function(e,t){return"maps"===e?/^https?:\/\//i.test(t)?t:`https://maps.google.com/maps/search/${encodeURIComponent(t)}`:(0,a.x$)(t)};async function V(e){let{store:t,environment:o,calledFrom:n}=e;const r=t.getNavigableBlockStore();if(!r)return;const i=await d.getBlockFileDownloadUrl(o,{blockId:t.id,pageBlockId:r.id,meta:{name:n}});if("success"!==i.type)return;const{url:a,fileName:s}=i.data;return{url:a,fileName:s}}},89951:(e,t,o)=>{o.d(t,{KT:()=>R,RL:()=>E,xv:()=>F});var n=o(1302),r=o(41432),i=o(43593),a=o(72126),s=o(99405),l=o(21202),c=o(13493),d=o(70203),p=o(95477),u=o(69783),m=o(28020),g=o(63085),h=o(89224),f=o(58202),y=o(64233),v=o(19111),b=o(35661),S=o(27724),_=o(10743),w=o(52229),k=o(50906),x=o(79554),I=o(48948),C=o(96802),T=o(72711),M=o(9953),P=o(42858),A=o(97444),D=o(39699),B=o(68422);function R(e){const{environment:t,textStore:o,url:n,oldTextValue:r,urlSelection:i}=e;if(_.Z.state.open||u.Z.state.open||v.Z.state.open||y.Z.state.open)return;const a=h.get();if(!a)return;const s=h.getRect(a);s&&(y.Z.setState({open:!0,textStore:o,url:n,oldTextValue:r,urlSelection:i,selectionRect:s}),k.elP(t,{url:n}))}async function E(e){const{environment:t}=e,o=y.Z.state;if(o.open){const{url:u,textStore:h,oldTextValue:y}=o,v=S.default.state.stores,_=v[0];if(!_)return;const k=(0,i.Wv)(u,p.default.secureFileS3.url,p.default.secureFileS3V2.url,p.default.secureFileConfig.rootPath,p.default.secureFileConfig.hostname),R=k?k.link:u,E=(0,s.Wj)({url:R,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,isMobile:t.device.isMobile,protocol:p.default.protocol,currentUrl:window.location.href});if("page"===E.name)await D.createAndCommitAsync({environment:t,userAction:"embedMenuActions.embedPageAlias",waitForServerCommit:!1,perform:async r=>{let i;if(A.sO({environment:t,store:h,value:y,transaction:r}),E.peekViewBlockId){const e=b.G.createChildStore(h,{table:l.iU,id:E.peekViewBlockId});await e.load(),e.isPageBlock()&&(i=e)}if(i||(i=b.G.createChildStore(h,{table:l.iU,id:E.blockId})),i){if("mention-page"===e.type){const e=i.getRecordModel({id:i.id,table:l.iU});A.lZ({environment:t,store:h,selection:{startIndex:o.urlSelection.startIndex,endIndex:o.urlSelection.startIndex},annotation:d.$0A(E.scrollToBlockId??i.id,null==e?void 0:e.space_id),transaction:r,analyticsFrom:"block"})}else if("create-transclusion"===e.type){if(!E.scrollToBlockId)return;x.ry({environment:t,blocks:S.default.state.stores,copiedBlockIds:[E.scrollToBlockId]})}else if(i.isCollectionView()){const e=E.collectionViewId?b.Xr.createChildStore(i,{table:c.n,id:E.collectionViewId}):void 0;await Promise.all([i.load(),e?e.load():void 0]);const o=e?e.getCollectionStore():i.getCollectionViewCollectionStore();o&&(await o.load(),T.Y_({environment:t,store:_,collectionStore:o,collectionViewStore:e,transaction:r}))}else{const e=_.getParentBlockStore();if(e){const o=w.k({environment:t,parentBlock:e,targetStore:i,transaction:r});P.is({environment:t,blocks:[o],selection:v,transaction:r,replaceEmptyTextBlock:!0})}}n.default.afterNextFlush((()=>{D.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{P.MD({blocks:v,transaction:e})}})}))}}});else if(e.type===r.Ti.bookmark||"teamsInvite"===E.name){const{performResult:e}=D.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var o,n;A.sO({environment:t,store:h,value:y,transaction:e});const i=M.j4({environment:t,type:r.Ti.bookmark,inMemoryRecordCache:_.inMemoryRecordCache,transaction:e,spaceId:0!==v.length?v[v.length-1].pointer.spaceId:null===(o=(0,m.RM)())||void 0===o?void 0:o.pointer.spaceId,useCrdt:0!==v.length?v[v.length-1].useCrdt():(null===(n=(0,m.RM)())||void 0===n?void 0:n.useCrdt())??!1}),a=P.is({environment:t,blocks:[i],selection:v,transaction:e,replaceEmptyTextBlock:!0});return C.FH({stores:[i],transaction:e,update:{bookmark_loading_ttl:Date.now()}}),a}});n.default.afterNextFlush((()=>{D.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{P.MD({blocks:v,transaction:e})}})}));const o=e[0];"teamsInvite"===E.name?await I.K({environment:t,store:o,url:u,teamId:E.teamId}):await I.K({environment:t,store:o,url:u})}else if(e.type===r.Ti.drive){const{performResult:e}=D.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var o,n;A.sO({environment:t,store:h,value:y,transaction:e});const i=M.j4({environment:t,type:r.Ti.drive,inMemoryRecordCache:_.inMemoryRecordCache,transaction:e,spaceId:0!==v.length?v[v.length-1].pointer.spaceId:null===(o=(0,m.RM)())||void 0===o?void 0:o.pointer.spaceId,useCrdt:0!==v.length?v[v.length-1].useCrdt():(null===(n=(0,m.RM)())||void 0===n?void 0:n.useCrdt())??!1});return P.is({environment:t,blocks:[i],selection:v,transaction:e,replaceEmptyTextBlock:!0})}});n.default.afterNextFlush((()=>{D.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{P.MD({blocks:v,transaction:e})}})}));const o=e[0];n.default.afterNextFlush((()=>{const e=f.R.find((e=>e.getBlockStore()===o));e&&e.initializeGoogleDriveBlockFromUrl(u)}))}else{const{performResult:o}=D.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var o,n;A.sO({environment:t,store:h,value:y,transaction:e});const i=M.j4({environment:t,type:r.Ti.copyIndicator,inMemoryRecordCache:_.inMemoryRecordCache,transaction:e,spaceId:0!==v.length?v[v.length-1].pointer.spaceId:null===(o=(0,m.RM)())||void 0===o?void 0:o.pointer.spaceId,useCrdt:0!==v.length?v[v.length-1].useCrdt():(null===(n=(0,m.RM)())||void 0===n?void 0:n.useCrdt())??!1});return P.is({environment:t,blocks:[i],selection:v,transaction:e,replaceEmptyTextBlock:!0})}});n.default.afterNextFlush((()=>{D.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{P.MD({blocks:v,transaction:e})}})}));const i=o[0],s=o=>{D.createAndCommit({environment:t,userAction:"embedMenuActions.accept.insertExtractedData",perform:t=>{let n;e.type&&"mention-page"!==e.type&&"create-transclusion"!==e.type?n=e.type:(n=r.Ti.embed,o&&o.media&&("photo"===o.media.type?n=r.Ti.image:"video"===o.media.type&&(n=r.Ti.video))),B.vs({environment:e.environment,block:i,blockType:n,transaction:t})}}),n.default.afterNextFlush((()=>{const e=f.R.find((e=>e.getBlockStore()===i&&a.mf(e.embed)));e&&e.embed(R)}))};g.W4(t,R).then(s)}}F()}const F=function(){y.Z.setState({url:y.Z.getState().url,open:!1})}},4727:(e,t,o)=>{o.d(t,{RL:()=>h,_P:()=>g,jZ:()=>y,xv:()=>f});var n=o(70203),r=o(69783),i=o(68056),a=o(89224),s=o(64233),l=o(19111),c=o(10743),d=o(24666),p=o(50906),u=o(97444),m=o(39699);function g(e){const{environment:t,textStore:o,oldSelection:i,oldTextValue:d}=e,u=n.eeV(o.getValue()||[]),m=i.startIndex;if(":"!==u[m])return;const g=n.gPn(u,m-5,m).join("");if(/[0-9]$/.test(g[g.length-1]))return;if(g.endsWith("http")||g.endsWith("https"))return;if(g.endsWith(":"))return;if(c.Z.state.open||r.Z.state.open||l.Z.state.open||s.Z.state.open)return;if(t.device.isPhone)return;const h=a.get();if(!h)return;const f=a.getRect(h);f&&(r.Z.setState({open:!0,textStore:o,oldTextValue:d,oldSelection:i,selectionRect:f}),p.xud(t))}function h(e){const t=r.Z.state,{environment:o,emoji:n,transaction:i}=e;t.open&&(u.sO({environment:o,store:t.textStore,value:t.oldTextValue,transaction:i}),u.Q0({environment:o,store:t.textStore,selection:t.oldSelection,emoji:n,transaction:i}),f())}function f(){r.Z.setState({open:!1})}function y(e){u.N3({direction:"end"});const t=d.default.state;if("editing"!==t.mode)return;const o=(0,i.QY)(t.multiSelection);if(!o)return;let a=!1;if(o.selection.startIndex>0){const e=o.store.getValue()||[],t=n.eeV(e)[o.selection.startIndex-1];/[\s]/g.test(t)||(a=!0)}m.createAndCommit({userAction:"emojiMenuActions.triggerInsertEmojiMenu",environment:e,perform:t=>{a?(u.hJ({environment:e,store:o.store,string:" ",selection:o.selection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t}),u.hJ({environment:e,store:o.store,string:":",selection:{startIndex:o.selection.startIndex+1,endIndex:o.selection.endIndex+1},disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!1,transaction:t})):u.hJ({environment:e,store:o.store,string:":",selection:o.selection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!1,transaction:t})}});const s=r.Z.state;s.open&&r.Z.setState({...s,showPopupWithEmptyFilter:!0})}},36280:(e,t,o)=>{o.d(t,{Wj:()=>h,gt:()=>y,qn:()=>g});o(21703);var n=o(1302),r=o(70203),i=o(97880),a=o(83631),s=o(68056),l=o(89224),c=o(89086),d=o(66949),p=o(24666),u=o(97444),m=o(98104);function g(e){var t;const{environment:o,selectedToken:n,selectionRect:i,analyticsFrom:u}=e,g=l.get();if(!g)return;if("editing"!==p.default.state.mode)return;const h=null===(t=(0,s.QY)(p.default.state.multiSelection))||void 0===t?void 0:t.store;if(!h)return;const f=n||a.JT(p.default.state);f&&m.Z5({store:h,selection:f.position});const y=c.lV(p.default.state),v=f?r.o0h(f.token):a.Jf(y),b=a.by({environment:o,equation:v,displayMode:"inline"}),S=f?{editingToken:f.token}:{annotations:a.nk(p.default.state)};d.Z.setState({open:!0,value:v,error:b,savedTextSelectionState:p.default.state,savedTextSelectionRect:i||a.TJ({environment:o,selection:g}),...S,analyticsFrom:a.D9({source:u,currentEquationToken:Boolean(f),selectedText:y})}),p.default.setState({mode:"empty"})}function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.P.Forward;d.Z.isOpen()&&(f({equationStore:d.Z,getNextSelection:t=>e===d.P.Forward?{startIndex:t.endIndex,endIndex:t.endIndex}:e===d.P.Backward?{startIndex:t.startIndex,endIndex:t.startIndex}:(0,i.t1)(e)}),d.Z.reset(),n.default.afterNextFlush((()=>{p.default.emit()})))}function f(e){const{equationStore:t,getNextSelection:o}=e;if(!t.isOpen())return;const{savedTextSelectionState:n}=t.state,r=(0,s.QY)(n.multiSelection);if(!r)return;const i=o(r.selection);if(m.Z5({store:r.store,selection:i}),"editing"!==p.default.state.mode)throw new Error("TextSelectionStore should have a selection after calling `setSelection`.");t.setState({...t.state,savedTextSelectionState:p.default.state})}function y(e){const{environment:t,equationStore:o,transaction:n}=e;o.isOpen()&&(o.state.error||o.state.editingToken&&r.o0h(o.state.editingToken)===o.state.value||(!function(e){const{environment:t,equationStore:o,transaction:n}=e;if(!o.isOpen())return;if(o.state.error)return;const{savedTextSelectionState:i}=o.state,{multiSelection:s}=i;let l;u.pz({environment:t,multiSelection:s,transaction:n}),o.state.value&&(l=a.qZ({equationState:o.state,isTemporary:!1}),u.mM({environment:t,store:s.start.store,index:s.start.index,tokens:[l],transaction:n})),f({equationStore:o,getNextSelection:e=>{const t=l?r.eeV([l]).length:0;return{startIndex:e.startIndex,endIndex:e.startIndex+t}}}),p.default.setState({mode:"empty"})}({environment:t,equationStore:d.Z,transaction:n}),f({equationStore:o,getNextSelection:e=>({startIndex:e.endIndex,endIndex:e.endIndex})}),a.ND({environment:t,equation:o.state.value,from:o.state.analyticsFrom})))}},57400:(e,t,o)=>{o.d(t,{BX:()=>g,Of:()=>h,Th:()=>u,Tm:()=>m,Yh:()=>p,mc:()=>y});var n=o(15157),r=o(12139),i=o(54642),a=o(47307),s=o(12955),l=o(64496),c=o(77080),d=o(7339);async function p(e){const t=await(0,s.getExperimentDeviceId)(e),o=e.currentUser.id;let r;const i=(0,l.qE)();if(r=(0,l._3)(e)&&i?(0,l.fP)(t,o,i):n.Z.get({userId:o,key:c.localExperimentsV2Key}),r){const e=r.deviceId!==t,n=r.userId!==o,i=Boolean(r.test);!e&&!n||i||(r=void 0,c.default.reset())}r?c.default.updateState(r,e):await u({environment:e,force:!1}),c.default.getState().isLoaded||c.default.updateState({experimentsBySpace:{},experimentsWithoutSpace:[],isLoaded:!0,userId:o,deviceId:t,test:!1},e),c.default.isStatsigEnabled()&&await d.C.initialize(e)}async function u(e){const{environment:t,force:o}=e;if((0,l._3)(t)&&!o){var n;if(null!==(n=t.mobileNative)&&void 0!==n&&n.api.getExperimentData){const e=await t.mobileNative.api.getExperimentData();e?c.default.updateState(e,t):v({message:"Attempt to get experiments from the mobile cache did not return a result."})}else v({message:"getExperimentData is not implemented in the react native API."})}else{const e=await f(t);"failed"!==e.type&&c.default.updateState(e.data,t)}}async function m(e){const t=await f(e);"failed"!==t.type&&n.Z.set({userId:t.data.userId,key:c.localExperimentsV2Key,value:t.data})}async function g(e,t,o){if(!c.default.state.isLoaded)return;const n=await(0,s.getExperimentDeviceId)(e),r=await i.updateExperimentOverride(e,{experimentId:t,experimentGroup:o,deviceId:n});"failed"!==r.type?await u({environment:e,force:!1}):a.showError(r)}async function h(e){if(!c.default.state.isLoaded)return;const t=await(0,s.getExperimentDeviceId)(e),o=await i.resetExperimentOverrides(e,{deviceId:t});"failed"!==o.type?(await u({environment:e,force:!1}),a.showMessage({message:"Successfully reset experiment overrides."})):a.showError(o)}async function f(e){const t=await(0,s.getExperimentDeviceId)(e),o=e.currentUser.id,n=await i.getClientExperimentsV2(e,{deviceId:t});return"failed"===n.type&&v(n,o,t),n}function y(){c.default.reset()}function v(e,t,o){r.rn(e,{from:"experimentActions",type:"ExperimentFetchError",data:{deviceId:o,userId:t}})}},42631:(e,t,o)=>{o.d(t,{hM:()=>B,$$:()=>D,cM:()=>R});o(21703);var n=o(77657),r=o(74181),i=o(149),a=o(99405),s=o(89101);const l={local:"http://localhost:3008",development:"https://integrations-api-dev.notion.com",staging:"https://integrations-api-stg.notion.com",production:"https://integrations-api.notion.com"};function c(e){return`${l[e]}/slack/install`}function d(e){return`${l[e]}/github/install`}var p=o(9852),u=o(94826),m=o(64002),g=o(5366),h=o(95477),f=o(91924),y=o(24608),v=o(77080),b=o(30874),S=o(92083),_=o(50906),w=o(54642),k=o(47307),x=o(47839),I=o(94273),C=o(15356),T=o(75018),M=o(97627),P=o(61202);const A=(0,g.defineMessages)({authenticating:{id:"externalIntegrationAuthActions.authenticationWithIntegration.loadingMessage",defaultMessage:"Authorizing with integrationâ€¦"},titleMessage:{id:"externalIntegrationAuthActions.loginWithExternalIntegrationPopupModal.title",defaultMessage:"Authenticate"}});async function D(e){const{environment:t,integration:o,spaceId:n,from:r}=e,i=o.id,s=t.currentUser.id,l=(0,f.eC)(t);if(!s)throw new Error("No user id found");let c;_.IvM(t,{integrationId:i,from:r});const d=(0,u.I$)(i);if("dlp"===(null==d?void 0:d.type)||"ediscovery"===(null==d?void 0:d.type)){const e=await w.createOauthAuthorizationCode(t,{integrationId:i,spaceId:n});if("failed"===e.type)return k.showError(e),{error:`Unexpected error creating authorization code: ${(0,y.pO)(e)}`};c=e.data.code}await E({environment:t,notionAuthorizationCode:c,integration:o,spaceId:n,userId:s,authType:l,from:r,callbackRouteName:(null==d?void 0:d.id)===u.ZB.datadog.id?a.AY.datadogAuthCallback:a.AY.authCallback}),await P.pJ({environment:t}),"workspace_connections_redirect"===r&&S.Z.setState({open:!0,openedFrom:"workspace_connections_redirect",currentTab:"integrations",defaultSubtab:"workspace_connections",highlightedSetting:void 0})}async function B(e){const{environment:t,spaceId:o,integration:l,externalObjectInstanceBlockId:u,unfurlUrl:g,from:S}=e;p.setOauthAuthorizationParams(void 0);const D=l.id,B=D===n.nO?b.Z.completeSlackAuthentications.state:b.Z.externalAuthentications.state,R=new Set(B.filter((e=>{let{integration_id:t}=e;return t===D})).map((e=>e.parent_id)));D===n.f3&&M.pc(t);const F=(0,n.BP)({integrationId:D,env:"production"}),N=(0,r.lT)(h.default.domainBaseUrl),j=l.redirect_uris.includes(N)?N:l.redirect_uris[0],O=await w.createOauthAuthorizationCode(t,{integrationId:D,spaceId:o,...F?{redirectUri:j}:{}});if("failed"===O.type)return k.showError(O),{error:`Unexpected error creating authorization code: ${(0,y.pO)(O)}`};const L=O.data.code,U=t.currentUser.id,Z=(0,f.eC)(t),V=a.AY.authCallback;if(!U)return{error:"User must be signed in."};const q={environment:t,notionAuthorizationCode:L,integration:l,spaceId:o,externalObjectInstanceBlockId:u,unfurlUrl:g,authType:Z,from:S,userId:U,callbackRouteName:V};(0,n.BP)({integrationId:D,env:"production"})?await async function(e){const{environment:t,redirectUri:o,notionAuthorizationCode:n,integration:r,spaceId:l,externalObjectInstanceBlockId:p,unfurlUrl:u,authType:g,userId:f}=e,y=await async function(e){const{integration:t}=e;if("external"===t.type&&void 0!==t.info.handled_by_integrations_server){if("github"===t.info.handled_by_integrations_server)return await async function(e){const{environment:t,notionAuthorizationCode:o,spaceId:n,authType:r}=e,i={notion_workspace_id:n,notion_user_id:t.currentUser.id,notion_last_visited_url:window.location.href,notion_authorization_code:o,callback_type:r.callbackType,...r.redirectToAuth&&{redirectToAuth:"true"}},l=(0,m.bf)({url:d("production"),query:{...i}});if(t.device.isElectron)return void x.openExternalUrl(l);const c=await C.M(t,{width:610,height:700,url:l,titleMessage:A.titleMessage});if(!c)return;const p=(0,a.Wj)({url:c,isMobile:t.device.isMobile,baseUrl:h.default.domainBaseUrl,publicDomainName:h.default.publicDomainName,protocol:h.default.protocol,currentUrl:window.location.href}),{url:u}=I.Vr(t);"externalAuthCallback"===p.name&&await T.handleFirstPartyExternalIntegrationAuthCallback({route:p,environment:t});T.navigate({url:u||s._j.root,environment:t})}(e),{value:{success:!0}};if("slack"===t.info.handled_by_integrations_server){return v.default.checkGate("link_preview_auth_with_server_integration")?(await async function(e){const{environment:t,userId:o,spaceId:n,authType:r,from:i,externalObjectInstanceBlockId:s,options:l}=e,d={notion_workspace_id:n,notion_user_id:o,notion_last_visited_url:window.location.href,auth_initiator:i,callback_type:r.callbackType,slack_workspace_id:null==l?void 0:l.slackWorkspaceId,external_object_instance_block_id:s,...r.redirectToAuth&&{redirectToAuth:"true"}},p=(0,m.bf)({url:c("production"),query:{...d}});if(t.mobileNative)return void t.mobileNative.openInAppBrowser(p);if(t.device.isElectron)return void x.openExternalUrl(p);const u=await C.M(t,{width:610,height:700,url:p,titleMessage:A.titleMessage});if(!u)return;const g=(0,a.Wj)({url:u,isMobile:t.device.isMobile,baseUrl:h.default.domainBaseUrl,publicDomainName:h.default.publicDomainName,protocol:h.default.protocol,currentUrl:window.location.href});"externalAuthCallback"===g.name&&await T.handleFirstPartyExternalIntegrationAuthCallback({route:g,environment:t})}(e),{value:{success:!0}}):{error:{success:!1}}}return"zendesk"===t.info.handled_by_integrations_server?(await async function(e){const{environment:t,notionAuthorizationCode:o,spaceId:n,authType:r,externalObjectInstanceBlockId:i}=e,l={notion_workspace_id:n,notion_user_id:t.currentUser.id,notion_last_visited_url:window.location.href,notion_authorization_code:o,external_object_instance_block_id:i,callback_type:r.callbackType,integration_id:e.integration.id,...r.redirectToAuth&&{redirectToAuth:"true"}},c=(0,m.bf)({url:`${h.default.domainBaseUrl}/initiateExternalAuthentication`,query:{...l}});if(t.device.isElectron)return void x.openExternalUrl(c);const d=await C.M(t,{width:610,height:700,url:c,titleMessage:A.titleMessage});if(console.log(`The popup callback: ${d}`),!d)return;const p=(0,a.Wj)({url:d,isMobile:t.device.isMobile,baseUrl:h.default.domainBaseUrl,publicDomainName:h.default.publicDomainName,protocol:h.default.protocol,currentUrl:window.location.href}),{url:u}=I.Vr(t);"externalAuthCallback"===p.name&&await T.handleFirstPartyExternalIntegrationAuthCallback({route:p,environment:t});T.navigate({url:u||s._j.root,environment:t})}(e),{value:{success:!0}}):{error:{success:!1}}}return{error:{success:!1}}}(e);if(i.x.isSuccess(y))return;const b={externalObjectInstanceBlockId:p,spaceId:l,userId:f,callbackType:g.callbackType,...g.redirectToAuth&&{redirectToAuth:"true"}},S={code:n,notion_state:JSON.stringify(b),integration_id:r.id,external_url:u,redirect_uri:o},_=(0,m.bf)({url:o,query:{...S}});if(t.device.isElectron)return void x.openExternalUrl(_);const w=await C.M(t,{width:610,height:700,url:_,titleMessage:A.titleMessage});if(!w)return;const k=(0,a.Wj)({url:w,isMobile:t.device.isMobile,baseUrl:h.default.domainBaseUrl,publicDomainName:h.default.publicDomainName,protocol:h.default.protocol,currentUrl:window.location.href});"externalAuthCallback"===k.name&&await T.handleFirstPartyExternalIntegrationAuthCallback({route:k,environment:t})}({...q,integration:l,notionAuthorizationCode:L,redirectUri:j}):await E(q),_.IvM(t,{integrationId:l.id,numberOfAccountsAlreadyConnected:R.size,from:S}),await P.pJ({environment:t});return{value:{externalAuthentication:b.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===D})).find((e=>!R.has(e.parent_id)))}}}function R(e){const{environment:t,notion_workspace_id:o,notion_user_id:n,notion_last_visited_url:r,notion_authorization_code:i,external_object_instance_block_id:a,callback_type:s,redirectToAuth:c,zendeskSubDomain:d}=e,p={notion_workspace_id:o,notion_user_id:n,notion_last_visited_url:r,notion_authorization_code:i,external_object_instance_block_id:a,callback_type:s,zendeskSubDomain:d,...c&&{redirectToAuth:"true"}},u=(0,m.bf)({url:(g="production",`${l[g]}/zendesk/install`),query:{...p}});var g;t.device.isElectron?x.openExternalUrl(u):window.location.href=u}async function E(e){const{environment:t,notionAuthorizationCode:o,integration:n,spaceId:r,userId:i,authType:l,externalObjectInstanceBlockId:c,from:d,callbackRouteName:p}=e,u=n.id,g={notionAuthorizationCode:o,userId:i,spaceId:r,integrationId:u,externalObjectInstanceBlockId:c,callbackType:l.callbackType,...l.redirectToAuth&&{redirectToAuth:"true"}};let y=(0,m.bf)({url:`${h.default.domainBaseUrl}${s._j.externalIntegrationPopupRedirect}`,query:{...g}});if(y=l.redirectToAuth?y:await(0,f.HU)(t,y),t.device.isElectron)return void x.openExternalUrl(y);const v=await C.M(t,{width:610,height:700,url:y,titleMessage:A.titleMessage});if(!v)return;const b=(0,a.Wj)({url:v,isMobile:t.device.isMobile,baseUrl:h.default.domainBaseUrl,publicDomainName:h.default.publicDomainName,protocol:h.default.protocol,currentUrl:window.location.href});b.name===p&&await T.handleThirdPartyExternalIntegrationAuthCallback({route:b,environment:t,integrationId:u,from:d})}},62365:(e,t,o)=>{o.d(t,{c:()=>d,v:()=>p});var n=o(70203),r=o(64002),i=o(27411),a=o(27153),s=o(9953),l=o(39699),c=o(53471);function d(e){const{store:t,file:o,environment:n}=e,r=i.default.getBlockKey(t.id);a.Z(),c.cT({environment:n,file:o,bucket:"secure",record:t.pointer,onStart:e=>{i.default.setKeyState(r,{progressPercent:0,file:o,name:e.name,size:e.size})},onProgress:e=>{const t=i.default.getKeyState(r);t&&i.default.setKeyState(r,{...t,progressPercent:e.progressPercent})},onComplete:e=>{const o=i.default.getKeyState(r);o&&l.createAndCommit({userAction:"fileBlockActions.uploadFile",environment:n,perform:n=>{p({store:t,source:e,name:o.name,size:o.size,transaction:n}),i.default.setKeyState(r,void 0)}})},onError:()=>{i.default.setKeyState(r,void 0)},retryWhenOffline:!0})}const p=function(e){const{store:t,source:o,name:i,size:a,transaction:l}=e;let c;i?c=i:o&&(c=(0,r.je)(o)),s.sW({store:t.getPropertiesStore(),data:{source:n.TPx(o),title:n.TPx(c),size:n.TPx(a)},transaction:l})}},3297:(e,t,o)=>{o.d(t,{DK:()=>R,OH:()=>E,S:()=>D,VE:()=>F,nM:()=>N,qd:()=>j,sC:()=>A});var n=o(15145),r=o(42875),i=o(15157),a=o(72126),s=o(29477),l=o(89101),c=o(97880),d=o(5366),p=o(35683),u=o(95477),m=o(24215),g=o(28020),h=o(84210),f=o(33929),y=o(80444),v=o(89256),b=o(50906),S=o(48299),_=o(47307),w=o(54532),k=o(92625),x=o(11302),I=o(19785),C=o(75018),T=o(28014),M=o(39699);const P="forkPageTemplate";function A(){v.Z.setState({open:!1})}async function D(e){const{environment:t,store:o,originRect:r}=e;b.ZzP(t,o.id);const{RouterStore:i}=t,a=i.state.route;if("page"===a.name&&a.requestedOnPublicDomain){const e=(0,h.ZP)({store:o,fullyQualified:!1,duplicate:!0,pageVisitSource:n.tY.Duplicate});return void C.navigateOnBaseUrl({environment:t,url:e,extraSearchParams:{...await C.generatePartnerStackPathParam(t),utm_source:"public_page",utm_content:"duplicate_button",tid:await(0,m.cG)(t),from:"public_page",n:"duplicate_public_page"}})}const{currentUserRootStore:s}=y.default.state;if(s){const e=g.o(s);if(1===e.length){const n=e[0],r=n.getSpaceStore();if(!r)return;R({environment:t,store:o,spaceStore:r,spaceViewStore:n,isPrivate:!0,context:"public_page_duplicate_single_workspace"})}else v.Z.setState({open:!0,store:o,originRect:r})}else N({currentUserId:t.currentUser.id,blockId:o.id}),C.navigate({environment:t,url:l._j.login})}const B=(0,d.defineMessages)({untitledBlockRecordTitle:{defaultMessage:"Untitled",id:"forkPageActions.untitledBlockRecordTitle"},untitledSpaceRecordTitle:{defaultMessage:"Untitled",id:"forkPageActions.untitledSpaceRecordTitle"},loadingStateDisplayText:{defaultMessage:"Duplicating {blockTitle} to {spaceTitle}â€¦",id:"forkPageActions.loadingStateDisplayText"}});async function R(e){var t,o;const{environment:i,store:a,spaceStore:l,context:c}=e,d=f.default.getIntl(),u=null===(t=a.getModel())||void 0===t?void 0:t.getRenderTitleWithEmoji({getRecordModel:a.getRecordModel,userTimeZone:(0,r.r)(),placeholder:d.formatMessage(B.untitledBlockRecordTitle),intl:d});if(void 0===u)return;const m=null===(o=l.getModel())||void 0===o?void 0:o.getRenderTitleWithEmoji({placeholder:d.formatMessage(B.untitledSpaceRecordTitle)});if(void 0===m)return;k.j({message:B.loadingStateDisplayText,interpolatedValues:{blockTitle:u,spaceTitle:m}});const g=Date.now();let h;const[y]=await Promise.all([E(e).then((e=>(h=Date.now()-g,e))),(0,s.Vs)(750)]);k.x();const v=Date.now()-g;"public_page_duplicate_multiple_workspace"!==c&&"public_page_duplicate_single_workspace"!==c&&"signin_after_duplicate"!==c||b.XyT(i,{from:"publicPage",success:!y.error,template_name:u,template_block_id:a.id,target_space_id:l.id,context:c,template_duplication_duration_ms:h,template_duplication_duration_with_minimum_ms:v}),void 0!==y.error?_.showErrorMessage(y.error):C.navigateToBlock({environment:i,store:y.value,visitType:p.vu.Link,pageVisitSource:n.tY.Duplicate})}async function E(e){const{environment:t,store:o,spaceStore:n,spaceViewStore:r,isPrivate:i,duplicateOnlyCollectionSchema:a}=e;return new Promise((e=>{M.createAndCommit({userAction:"forkPageActions.forkPage",environment:t,perform:s=>{const[l,c]=w.Qi({environment:t,stores:[o],transaction:s,addCopyName:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,targetSpaceId:n.id,baseUrl:u.default.domainBaseUrl,publicDomainName:u.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:!1,duplicateOnlyCollectionSchema:a}),d=l[0];c.then((t=>{e(t?{error:t}:{value:d})})),T.Hj({environment:t,spaceStore:n,spaceViewStore:r,pageStore:d,isPrivate:i,location:{type:"prepend"},transaction:s})}})}))}async function F(e){const{environment:t,store:o,duplicateOnlyCollectionSchema:r}=e,i=y.default.state.currentSpaceStore,s=y.default.state.currentSpaceViewStore,l=y.default.state.mainEditorCurrentBlockStore;if(!i||!s||!l)return;const d=await S.NN({environment:t,block:o,action:"duplicate"});if("user_canceled"===d)return;const m=await new Promise((n=>{M.createAndCommit({userAction:"forkPageActions.duplicateTo",environment:t,perform:l=>{const[p,m]=w.Qi({environment:t,stores:d,transaction:l,addCopyName:!0,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,targetSpaceId:i.id,baseUrl:u.default.domainBaseUrl,publicDomainName:u.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:"block"===e.newParent.table&&e.newParent.useCrdt(),duplicateOnlyCollectionSchema:r});m.then((e=>{n(e?{error:e}:{value:p})}));const g={type:"append",after:o.id},h=a.d9(p).reverse();if("team"===e.newParent.table)x.at({transaction:l,currentSpaceViewStore:s,teamStore:e.newParent,targets:p,environment:t,location:g,action:"move",value:{type:"team",id:e.newParent.id,spaceId:i.id}});else if("block"===e.newParent.table)for(const t of h)I.jG({parentStore:e.newParent,childStore:t,transaction:l,after:g.after});else if("space"===e.newParent.table)for(const e of h)T.Hj({environment:t,spaceStore:i,spaceViewStore:s,pageStore:e,isPrivate:!0,location:g,transaction:l});else(0,c.t1)(e.newParent);return p}})}));void 0!==m.error?_.showErrorMessage(m.error):C.navigateToBlock({environment:t,store:m.value[0],visitType:p.vu.Link,pageVisitSource:n.tY.Duplicate})}function N(e){let{currentUserId:t,blockId:o}=e;i.Z.set({userId:t,key:P,value:o})}function j(e){return i.Z.get({userId:e,key:P})}},96802:(e,t,o)=>{o.d(t,{FH:()=>m,MF:()=>b,Mp:()=>S,Wq:()=>g,bf:()=>_,fs:()=>f,hc:()=>h,is:()=>v,zM:()=>y});var n=o(41432),r=o(43593),i=o(15157),a=o(72126),s=o(63143),l=o(95477),c=o(24990),d=o(35661),p=o(41433),u=o(9953);function m(e){const{stores:t,update:o,transaction:r}=e;for(const a of t)u.sW({store:a.getFormatStore(),data:(0,s.Q2)(o),transaction:r}),a instanceof d.G&&a.getType()===n.Ti.callout&&o.block_color&&i.Z.set({userId:a.environment.currentUser.id,key:p.Ns,value:o.block_color})}function g(e){const{environment:t,store:o,isLocked:n,transaction:r}=e,{id:i}=t.currentUser;if(!i)return;const a={block_locked:n,block_locked_by:i};u.sW({store:o.getFormatStore(),data:a,transaction:r})}function h(e){const{environment:t,store:o,alignment:n,transaction:r}=e,{id:i}=t.currentUser;if(!i)return;const a={block_alignment:n};u.sW({store:o.getFormatStore(),data:a,transaction:r})}function f(e){const{store:t,url:o,position:n,transaction:i}=e,a=(0,r.Wv)(o,l.default.secureFileS3.url,l.default.secureFileS3V2.url,l.default.secureFileConfig.rootPath,l.default.secureFileConfig.hostname),s=a?a.link:o;m({stores:[t],update:{page_cover_position:n},transaction:i});const c=t.getCoverStore();c&&u.sO({store:c,value:s,transaction:i})}function y(){const e=a.UP(["Activities","Objects","Travel & Places"]),t=c.Z.state.emojiByCategory[e];return a.UP(t)}function v(e){const{store:t,transaction:o}=e,n=t.getIconStore();if(n){if(!n.getValue()){const e=y();u.sO({store:n,value:e,transaction:o})}}}function b(e){const{store:t,transaction:o}=e,n=t.getCoverStore();n&&u.sO({store:n,value:null,transaction:o})}function S(e){const{store:t,coverPosition:o,transaction:n}=e;if(t.isCollectionView()){const e=t.getCollectionViewCollectionStore();if(e)return void u.sW({store:e.getFormatStore(),data:{collection_cover_position:o},transaction:n})}m({stores:[t],update:{page_cover_position:o},transaction:n})}function _(e){const{store:t,coverPosition:o,transaction:n}=e;m({stores:[t],update:{card_cover_position:o},transaction:n})}},47678:(e,t,o)=>{o.d(t,{Y:()=>p});var n=o(72126),r=o(45010),i=o(80444),a=o(24612),s=o(27724),l=o(77503),c=o(54564),d=o(42858);function p(e){const{RouterStore:t}=e,{PageScroller:o}=r.Z;if("page"===t.state.route.name&&i.default.state.currentLoadingContainerStore&&i.default.state.currentLoadingContainerStore.state.ready)if(a.Z.reset(),l.Z.reset(),t.state.route.scrollToBlockId){const o=[t.state.route.scrollToBlockId];d.WG(e,o);const n=s.default.state.stores[0];n&&t.state.route.discussionId&&c.Ib({environment:e,blockStore:n,discussionIds:[t.state.route.discussionId],analyticsFrom:"page_load",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1})}else t.state.route.discussionId&&i.default.state.mainEditorCurrentBlockStore?c.Ib({environment:e,blockStore:i.default.state.mainEditorCurrentBlockStore,discussionIds:[t.state.route.discussionId],analyticsFrom:"page_load",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1}):"pop"===t.state.action&&t.state.historyState&&(o&&n.hj(t.state.historyState.scrollTop)&&o.scrollTo(t.state.historyState.scrollTop,void 0),t.state.historyState.blockIds&&d.DQ(e,t.state.historyState.blockIds))}},54604:(e,t,o)=>{o.d(t,{ui:()=>a,xv:()=>s,zp:()=>l});var n=o(50906),r=o(17903),i=o(38302);function a(e){const{environment:t,renderFullScreenNode:o,fullScreenNodeRect:a,contentAspectRatio:s,block:l,imageUrl:c}=e;n.Lfx(t,{type:"open"}),i.Z.setState({...i.Z.state,isOpen:!0,fullscreenNodeAnimationComplete:!1,backgroundAnimationComplete:!1,renderFullScreenNode:o,startScrollTop:r.Z.state.scrollTop,fullScreenNodeRect:a,contentAspectRatio:s,block:l,imageUrl:c})}function s(){i.Z.setState({...i.Z.state,isOpen:!1})}function l(e){return e<1020?0:32}},58188:(e,t,o)=>{o.d(t,{Lg:()=>v,N:()=>f,Rt:()=>y,aG:()=>h,rg:()=>g});var n=o(13493),r=o(29369),i=o(39699),a=o(95697),s=o(77907),l=o(30806),c=o(80444),d=o(28209),p=o(54642),u=o(45264),m=o(72711);async function g(e){const{environment:t,spaceId:o}=e;if(!(0,a.QI)("dev_or_beta"))return;const n=await p.getUserHomePages(t,{spaceId:o});"success"===n.type&&d.Z.setState({userHomePageId:n.data.homePageId,personalHomePageId:n.data.personalHomePageId})}function h(e){const{environment:t,currentSpaceViewStore:o,...n}=e,r=o.getModel();if(!r)return;const a=!r.showFeatureOnPersonalHome(e.feature);i.createAndCommit({userAction:"userHomeActions.toggleHomeFeature",environment:t,perform:t=>{i.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","personal_home","enabled_features"],command:"update",args:{[e.feature]:a}},transaction:t})}}),(0,l.cY)({environment:t,show:a,...n})}function f(e){let{environment:t,option:o,from:n,userAction:r}=e;const a=c.default.state.currentSpaceViewStore;if(!a)return!1;const s=a.getOnAppStartStore().getValue();return i.createAndCommit({userAction:r,environment:t,perform:e=>{i.applyOperation({store:a,operation:{pointer:a.pointer,path:["settings","on_app_start"],command:"set",args:o},transaction:e})}}),(0,l.BX)({environment:t,oldValue:s,newValue:o,from:n}),!0}async function y(e){const{environment:t,personalHomeStore:o}=e,n=null==o?void 0:o.getCoverStore();if(!o||!n||n.getValue())return;const r=(await s.deps.pageCovers.loader()).default;i.createAndCommit({userAction:"userHomeActions.addCoverPhoto",environment:t,perform:e=>{m.tk({transaction:e,store:o,coverStore:n,pageCovers:r})}})}function v(e){const{environment:t,selectedStore:o,currentSpaceViewStore:a,collectionContextStore:s}=e,c=s.collectionViewStore(),d=s.collectionStore(),p=s.collectionViewBlockStore();if(!(d&&c&&p&&a))return;const m=a.getTeamsStores(),g=o.table===r.e0?m.indexOf(o)+1:0,h=o.table===r.e0?o.id:void 0;i.createAndCommit({environment:t,userAction:"PersonalHomeTrendingPanel.setCollectionViewSourceTeamId",perform:e=>{i.applyOperation({store:c,operation:{pointer:{id:c.id,table:n.n},path:["format","collection_view_source","teamId"],command:"set",args:h},transaction:e}),u.mc({environment:t,collectionViewBlockStore:p,collectionViewStore:c,collectionStore:d,collectionContextStore:s,isFullScreen:!1,isRootChild:!1,isInPeekRenderer:!1})}}),(0,l.Ay)({environment:t,teamId:h,index:g})}},44886:(e,t,o)=>{o.d(t,{A1:()=>f,WY:()=>g,dD:()=>u,gq:()=>b,nt:()=>v,rB:()=>h,uv:()=>m,vi:()=>y});o(57658);var n=o(41432),r=o(72126),i=o(28020),a=o(73959),s=o(35328),l=o(95802),c=o(26664),d=o(45131),p=o(94419);function u(e){const{parentStore:t,block:o,type:n,transaction:r}=e,i=t.getTransclusionReferenceTargetStore()??t,a=i.getContentStores(),l=a.indexOf(o);if(l<=0)return;const c=a[l-1];if(!c)return;if(!S(i)||!S(c))return;p.Od({parent:i.getContentStore(),childToRemove:o,transaction:r});const{child:u}=p.R3({parent:c.getContentStore(),append:o,transaction:r});if("self"===n&&!u.isType("table"))for(const s of u.getContentStores().reverse())p.Od({parent:u.getContentStore(),childToRemove:s,transaction:r}),p.BE({parent:c.getContentStore(),insert:s,after:u,transaction:r});return s.BX(c)&&d.Z.setOpen(c.id,!0),u}function m(e){const{grandparentStore:t,parentStore:o,block:n,transaction:r}=e,i=t.getTransclusionReferenceTargetStore()??t;if(i.getContentStores().indexOf(o)<0)return;const a=o.getContentStores(),s=a.indexOf(n);if(s<0)return;if(!S(i)||!S(o))return;if("transclusion_container"===o.getType()||"transclusion_reference"===o.getType())return;if(S(n))for(let c=s+1;c<a.length;c++){const e=a[c];p.Od({parent:o.getContentStore(),childToRemove:e,transaction:r}),p.R3({parent:n.getContentStore(),append:e,transaction:r})}p.Od({parent:o.getContentStore(),childToRemove:n,transaction:r});const{child:l}=p.BE({parent:i.getContentStore(),insert:n,after:o,transaction:r});return l}function g(e){const{transaction:t}=e,o=e.blocks,n=o[0];if(!n)return;const r=_(n);if(!r)return;const{previousChildStore:i}=r,a=i.getContentStore();return s.BX(i)&&d.Z.setOpen(i.id,!0),o.map((e=>{const o=e.getRecordStoreUIParent();null!=o&&o.valueIs(c.i)&&p.Od({parent:o,childToRemove:e,transaction:t});return p.R3({parent:a,append:e,transaction:t}).child}))}function h(e){const{transaction:t}=e;let o=e.blocks;const n=o[0];if(!n)return;const i=w(n);if(!i)return;const{closestParentStore:a,closestParentParentStore:s}=i,l=a.getContentStores(),d=s.getContentStore();if(l){let e;for(const[t,n]of l.entries())if(n.id===o[o.length-1].id){e=l.splice(t+1);break}o=r.d9(o).reverse(),o=o.map(((o,n)=>{const r=o.getRecordStoreUIParent();null!=r&&r.valueIs(c.i)&&p.Od({parent:r,childToRemove:o,transaction:t});const i=p.BE({parent:d,insert:o,after:a,transaction:t});if(0===n&&e&&S(o))for(const a of e){const e=a.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&p.Od({parent:e,childToRemove:a,transaction:t}),p.BE({parent:o.getContentStore(),insert:a,transaction:t})}return i.child}))}return o}function f(e){const{transaction:t,blocks:o}=e,n=o[0];if(!n)return;const a=i.RM();if(!a)return;const s=x(a),l=r.cx(s,(e=>e.parent===n.getRecordStoreUIParent()&&e.after===n)),c=r.qr(s,((e,t)=>t<l&&e.parent===n.getRecordStoreUIParent())),d=r.dF(s,((e,t)=>t<c&&!n.uiContains(e.parent)));return d?C({blocks:o,listPosition:d,transaction:t}):void 0}function y(e){const{transaction:t,blocks:o}=e,n=r.Z$(o);if(!n)return;const a=i.RM();if(!a)return;const s=x(a),l=r.cx(s,(e=>e.parent===n.getRecordStoreUIParent()&&e.after===n)),c=s.find(((e,t)=>t>l&&!n.uiContains(e.parent)));return c?C({blocks:o,listPosition:c,transaction:t}):void 0}function v(e){return Boolean(e&&_(e))}function b(e){return Boolean(e&&w(e))}function S(e){const t=i.np(),o=e.getType(),r=e.getFormat();return o&&((0,n.TT)(o,r)||e===t)}function _(e){const t=(0,a.sQ)(e);if(null==t||!t.isDefined()||!S(t))return;const o=t.getContentStores(),n=o[o.indexOf(e)-1];return null!=n&&n.isDefined()&&S(n)?{previousChildStore:n}:void 0}function w(e){const t=(0,a.sQ)(e);if(!t)return;if(!t.isDefined()||!S(t))return;const o=(0,a.sQ)(t);return o&&o.isDefined()&&S(o)?{closestParentStore:t,closestParentParentStore:o}:void 0}function k(e,t){let o=[];const{store:n}=e.props;if(e.props.canDropAbove&&I(n)){const e=n.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&o.push({parent:e})}const i=t.filter((t=>t.getContextClosestSelectable()===e));for(const a of i)o=r.G0(o,k(a,t));if(e.props.canDropBelow&&I(n)){const e=n.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&(e.id===n.id?o.push({parent:e}):o.push({parent:e,after:n}))}return o}function x(e){let t=[];const o=l.C.getMembersByDOMOrder({filter:()=>!0}),n=e.getContentStores();for(const i of n){const e=o.find((e=>e.props.store===i));e&&(t=r.G0(t,k(e,o)))}return t}function I(e){return"collection"!==e.getParentTable()}function C(e){const{blocks:t,listPosition:o,transaction:n}=e,i=r.d9(t).reverse();for(const r of t){const e=r.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&p.Od({parent:e,childToRemove:r,transaction:n})}let a;return a=o.after?i.map((e=>p.BE({insert:e,after:o.after,parent:o.parent,transaction:n}).child)):i.map((e=>p.Ce({prepend:e,parent:o.parent,transaction:n}).child)),a}},88295:(e,t,o)=>{o.d(t,{Hk:()=>M,c_:()=>I,f8:()=>x,gt:()=>T,lP:()=>C});var n=o(41432),r=o(21202),i=o(97880),a=o(82798),s=o(19785),l=o(68422),c=o(28020),d=o(98165),p=o(67669),u=o(80444),m=o(83212),g=o(35661),h=o(50906),f=o(49865),y=o(98834),v=o(94419),b=o(60870),S=o(11302),_=o(19358),w=o(9953),k=o(39699);function x(e){const{environment:t,transaction:o,titleText:n,recordStoreParent:i}=e,{databaseTemplate:s,createInValue:l}=function(e,t){let o;if("page"===e.type){const n=g.G.createChildStore(t,{table:r.iU,id:e.id});if(n.isTemplate()){const t=(0,d.Dg)(n,1);t&&(o=n,e={type:"page",id:t.id})}}return{databaseTemplate:o,createInValue:e}}(e.createInValue,i),c="block"===l.type?g.G.createChildStore(i,{table:r.iU,id:l.id}):void 0,p=w.j4({transaction:o,environment:t,type:"page",inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,properties:n?{title:[[n]]}:void 0,spaceId:i.pointer.spaceId,useCrdt:"block"===l.type&&(0,a.TO)(c).useCrdt()});let u;switch(l.type){case"block":_.YM({transaction:o,childStore:p,parentStore:(0,a.TO)(c),alive:!0});break;default:u=S.Ws({transaction:o,environment:t,targets:[p],value:l})}return{environment:t,databaseTemplate:s,createdPages:[p],moveToStorePromise:u}}async function I(e){const{environment:t,createdPages:o,databaseTemplate:n,moveToStorePromise:i}=e.createInState;let a;(null==o?void 0:o.length)>0&&(a=o[0].id),h.W2j(t,{type:"page",from:e.analyticsFrom,new_page_id:a});const{currentSpaceStore:s}=u.default.state;if(n)k.createAndCommit({userAction:"inlinePageActions.completeCreateIn",environment:t,perform:e=>{o.forEach((o=>y.ob({title:{text:o.getTitleValue()},environment:t,store:o,templateStore:n,isKeyboard:!1,isCreateIn:!0,transaction:e,from:"inline_page_action"})))}}),s&&await b.j2(s,s.id,n.id);else{const e=await i;s&&e&&e.table===r.iU&&await b.j2(s,s.id,e.id)}}function C(e){const{environment:t,transaction:o,parentStore:a,inlinePageIds:l}=e;if(0===l.length)return;const c=g.G.createChildStore(a,a.pointer),u=(0,d.qA)(c).find((e=>{if(e.table!==r.iU)return!1;const t=e.getType(),o=e.getFormat();return!(!t||!o)&&((0,n.Um)(t,o)||(0,n.S9)(t))})),h=u&&u.isCollectionView()?u.getCollectionViewCollectionStore():u,y=h&&m.Z.getMode(t,h);if(!h||(0,p.YF)(y)||!h.canEdit()){for(const e of l)s.nO({pageStore:g.G.createChildStore(a,{table:r.iU,id:e}),transaction:o});return}let b=a;for(const n of l){const e=g.G.createChildStore(a,{table:r.iU,id:n});if(e.isEmptyPage()){s.nO({pageStore:e,transaction:o});continue}const l=!e.isDefined()||Boolean(e.getAlive());_.YM({parentStore:h,childStore:e,transaction:o,alive:l}),"block"!==h.table?"collection"!==h.table?(0,i.t1)(h):f.mp({environment:t,store:e,collectionStore:h,coerce:!0,groupsPointer:[],transaction:o}):(v.BE({parent:h.getContentStore(),after:b,insert:e,transaction:o}),b=e)}}function T(e){const t=c.np();if(t){if(e&&e.table===r.iU)return{pageStore:(0,d.Dg)(e,0)||t,createInValue:{type:"block",id:e.id}};if(e&&(0,d.n3)(e)){const t=(0,d.Dg)(e,0);if(t)return{pageStore:t,createInValue:{type:"page",id:t.id}}}return{pageStore:t,createInValue:{type:"page",id:t.id}}}}async function M(e,t){const{createInValue:o,blocksToTransform:n}=t,i="page"===o.type?new g.G(e,{table:r.iU,id:o.id}):void 0,a=Boolean(i&&i.isTemplate()),{performResult:{transformedPages:s,pageStore:c}}=await k.createAndCommitAsync({environment:e,userAction:"inlinePageActions.createNewPageIn",waitForServerCommit:!0,perform:async t=>{const s=n.map((o=>l.vs({environment:e,block:o,blockType:"page",transaction:t})));let c;if("page"===o.type)if(i&&a){const o=i.getParentCollectionStore(),n=null==o?void 0:o.getParentPointer();n&&n.table===r.iU&&(c=await S.Y({transaction:t,environment:e,targets:s,value:{type:"page",id:n.id}}))}else{const{mainEditorCurrentBlockStore:n}=u.default.state;n&&n.id!==o.id&&(c=await S.Y({transaction:t,environment:e,targets:s,value:o}))}else"team"===o.type&&await S.Ws({transaction:t,environment:e,targets:s,value:o});return{transformedPages:s,pageStore:c}}});await I({analyticsFrom:"new_page_in",createInState:{environment:e,createdPages:s,databaseTemplate:a?i:void 0,moveToStorePromise:Promise.resolve(c)}})}},96313:(e,t,o)=>{o.d(t,{QZ:()=>B,az:()=>E,pg:()=>R});var n=o(26263),r=o(14577),i=o(41432),a=o(59753),s=o(99405),l=o(21202),c=o(33709),d=o(23867),p=o(70203),u=o(97880),m=o(9953),g=o(24677),h=o(98104),f=o(95477),y=o(69783),v=o(65598),b=o(89224),S=o(70726),_=o(64233),w=o(48863),k=o(19111),x=o(35661),I=o(10743),C=o(52229),T=o(50906),M=o(94419),P=o(4408),A=o(97444),D=o(39699);function B(e){const{environment:t,textStore:o,blockStore:i,url:a,oldTextValue:p,urlSelection:u}=e;if(I.Z.state.open||y.Z.state.open||k.Z.state.open||_.Z.state.open)return!1;const m=b.get();if(!m)return!1;const g=b.getRect(m);if(!g)return!1;const h=(0,s.Wj)({url:a,baseUrl:f.default.domainBaseUrl,publicDomainName:f.default.publicDomainName,isMobile:t.device.isMobile,protocol:f.default.protocol,currentUrl:window.location.href});if("page"===h.name&&!!h.discussionId&&h.discussionId){const e=h.discussionId,s=h.blockId,m=i.getParentBlockStore();if(!m)return!1;const f=(0,x.Kv)(m,{table:l.iU,id:s,spaceId:(0,d.C)(m.pointer.spaceId)}),y=(0,x.Kv)(f,{table:c.qF,id:e,spaceId:(0,d.C)(i.pointer.spaceId)});if("none"===y.getRole())return!1;const b=new r.Z((()=>v.D4(y)[0]),{debugName:"firstCommentStore"}),_=new n.Z({name:"internalUnfurlingMenuActions.activate",isTemporaryData:!0});t.defaultRecordCache.inMemoryRecordCache.addCacheOverride(_);const k=i.clone(_),I=o.clone(_),C=m.clone(_);return w.Z.setState({args:{commentStore:b},stores:{blockStore:i,textStore:o,parentStore:m},temporaryStores:{blockStore:k,textStore:I,parentStore:C},temporaryRecordCache:_,focusedIndex:S.Z.Preview,selectionRect:g,oldTextValue:p,open:!0,url:a,urlSelection:u}),T.elP(t,{url:a}),!0}return!1}function R(e){const{actionType:t,environment:o,commentStore:n,useTempStores:r}=e,i=w.Z.state;if(!i.open)return;const{oldTextValue:s}=i,l=r?i.temporaryStores:i.stores,{textStore:c,blockStore:m,parentStore:f}=l,y=o.currentUser.id;if(y){if(r){i.temporaryRecordCache.clearCache();for(const e in i.temporaryStores){const t=i.temporaryStores[e],n={userId:y,pointer:t.pointer},r=o.defaultRecordCache.inMemoryRecordCache.getRecord(n);r?P.Wl({environment:o,inMemoryRecordCache:i.temporaryRecordCache,pointer:t.pointer,model:a.kk.fromValue(t.pointer.table,r.value),role:r.role,updatePaths:[[]],userId:y,force:!0,debugSource:"setUnfurlType"}):P.uo({environment:o,inMemoryRecordCache:i.temporaryRecordCache,persistedRecordCache:void 0,pointer:t.pointer,userId:y})}}else o.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(i.temporaryRecordCache);switch(t){case S.Z.Link:g.eP({environment:o,store:i.stores.blockStore}),h.Z5({store:i.stores.textStore,selection:{startIndex:i.urlSelection.endIndex,endIndex:i.urlSelection.endIndex}}),w.Z.setState({...i,focusedIndex:S.Z.Link});break;case S.Z.Mention:if(!n)return;const e=(0,d.C)(c.pointer.spaceId);if(!e)return;const r=n.id;D.createAndCommit({environment:o,userAction:"internalUnfurlingMenuActions.mention",perform:t=>{A.sO({environment:o,store:c,value:s,transaction:t}),A.lZ({environment:o,store:c,selection:{startIndex:i.urlSelection.startIndex,endIndex:i.urlSelection.startIndex},annotation:p.mfJ(r,e),transaction:t,analyticsFrom:"block"})}}),w.Z.setState({...i,focusedIndex:S.Z.Mention});break;case S.Z.Preview:if(!n)return;D.createAndCommit({environment:o,userAction:"internalUnfurlingMenuActions.preview",perform:e=>{A.sO({environment:o,store:c,value:s,transaction:e});const t=v.GP(n);if(!t)return;if(!v.HK(t)||!f||!t.getParentId())return;const r=C.k({environment:o,parentBlock:f,targetStore:n,transaction:e});if(M.BE({parent:f.getContentStore(),insert:r,after:m,transaction:e}),0===p.QaF(i.oldTextValue).trim().length){const t=x.G.createChildStore(f.getContentStore(),i.stores.blockStore.pointer);M.Od({parent:f.getContentStore(),childToRemove:t,transaction:e})}}}),w.Z.setState({...i,focusedIndex:S.Z.Preview});break;default:throw(0,u.t1)(t)}r||w.Z.setState({open:!1})}}function E(e){var t,o;const{block:n,transaction:r}=e,a=n.getType(),s=n.getFormat(),l=n.getSpaceId();if(!n.isDefined()||a!==i.Ti.alias||null==s||null===(t=s.alias_pointer)||void 0===t||!t.id)return;const c=[p.YCD(p.mfJ(null==s||null===(o=s.alias_pointer)||void 0===o?void 0:o.id,l))];m.sO({store:n,value:{type:i.Ti.text,properties:{title:c},format:null},transaction:r})}},62134:(e,t,o)=>{o.d(t,{B4:()=>d,Fe:()=>a,Zm:()=>l,dJ:()=>i,fg:()=>c,ys:()=>s});o(57658);var n=o(72126);function r(e,t){return e.KeyboardShortcutStackStore.state.stack.some((e=>t===e.listener))}function i(e,t,o){const{stack:n}=e.KeyboardShortcutStackStore.state;for(let r=n.length-1;r>=0;r--){const e=n[r],i=e.shortcuts[o];if(e.enable&&i)return void i(t)}}function a(e){const{environment:t,stackItem:o}=e,i=t.KeyboardShortcutStackStore;if(r(t,o.listener)){const e=i.state.stack.map((e=>e.listener===o.listener?o:e));i.setState({...i.state,stack:e})}else i.state.stack.push(o),i.setState({stack:n.MR(i.state.stack,(e=>e.priority))})}function s(e,t){if(r(e,t)){const o=e.KeyboardShortcutStackStore,r=o.state.stack,i=n.d1(r,(e=>t===e.listener));o.setState({...o.state,stack:i})}}function l(e,t){i(e,t,t.type)}function c(e){return{command:e.device.isMac?"âŒ˜":"ctrl",enter:"â†µ",delete:"del",backspace:"del",esc:"escape",left:"â†",right:"â†’",up:"â†‘",down:"â†“",tab:"â‡¥",alt:e.device.isMac?"âŒ¥":"alt"}}function d(e){return{command:e.device.isMac?"command":"control",esc:"escape"}}},94273:(e,t,o)=>{o.d(t,{Bk:()=>u,Ie:()=>g,Vr:()=>m,nr:()=>h,vq:()=>f});var n=o(15145),r=o(99405),i=o(21202),a=o(54153),s=o(95477),l=o(84210),c=o(35661);const d="lastVisitedRoute",p="lastVisitedRouteUserId";function u(e,t){const o=r.Wj({url:window.location.href,isMobile:e.device.isMobile,baseUrl:s.default.domainBaseUrl,publicDomainName:s.default.publicDomainName,protocol:s.default.protocol,currentUrl:window.location.href}),{route:n,userId:a}=y();("root"===o.name||"new"===o.name||"nativeTab"===o.name)&&n&&"page"===n.name&&n.blockId&&a===t&&new c.G(e,{table:i.iU,id:n.blockId,spaceId:n.spaceId}).load()}function m(e){const{route:t,userId:o}=y();if(t&&"page"===t.name){return{url:(0,l.ZP)({fullyQualified:!1,store:new c.G(e,{table:i.iU,id:t.blockId,spaceId:t.spaceId},{userId:o}),scrollToBlockId:t.scrollToBlockId,peekViewBlockId:t.peekViewBlockId,peekMode:t.peekMode,collectionViewId:t.collectionViewId,templateGalleryItem:t.templateGalleryItem,projectManagementLaunch:t.projectManagementLaunch,discussionId:void 0,pageVisitSource:void 0}),userId:o}}if(t&&"space"===t.name){return{url:(0,r.Xs)({route:t}),userId:o}}return{}}async function g(e){const{route:t,userId:o}=y();let a,s;if(t)if("page"===t.name){const r=new c.G(e,{table:i.iU,id:t.blockId,spaceId:t.spaceId},{userId:o});a=(0,l.ZP)({fullyQualified:!1,store:r,scrollToBlockId:t.scrollToBlockId,peekViewBlockId:t.peekViewBlockId,peekMode:t.peekMode,collectionViewId:t.collectionViewId,templateGalleryItem:t.templateGalleryItem,projectManagementLaunch:t.projectManagementLaunch,discussionId:void 0,pageVisitSource:n.tY.LastVisitedPage}),await r.load(),s=r.getSpaceId()}else"space"===t.name?(s=t.spaceId,a=(0,r.Xs)({route:t})):("nativeTab"===t.name||"workspaceSetup"===t.name)&&(s=t.spaceId);return{url:a,userId:o,route:t,spaceId:s}}function h(e,t){a.Z.set(d,e),a.Z.set(p,t)}function f(){a.Z.remove(d),a.Z.remove(p)}function y(){return{route:a.Z.get(d),userId:a.Z.get(p)}}},20747:(e,t,o)=>{o.d(t,{FZ:()=>y,U_:()=>f,fU:()=>S});var n=o(41432),r=o(21202),i=o(82798),a=o(35661),s=o(26664),l=o(50906),c=o(96802),d=o(94419),p=o(9953);const u=function(e){const t=e.getRecordStoreUIAncestor(2);if(t&&t instanceof a.G&&t.isType(n.Ti.columnList))return t},m=function(e){return e&&e instanceof a.G&&e.isType(n.Ti.column)};function g(e){const{environment:t,targets:o,inMemoryRecordCache:r,transaction:a}=e;(0,i.T)(o.length>0);const s=p.j4({environment:t,type:n.Ti.columnList,properties:{},inMemoryRecordCache:r,transaction:a,spaceId:o[0].pointer.spaceId,useCrdt:o[0].useCrdt()}),c=s.getContentStore();for(const n of o)d.R3({parent:c,append:n,transaction:a});return l.xh4(t),s}function h(e){const{environment:t,targets:o,inMemoryRecordCache:r,transaction:a}=e;(0,i.T)(o.length>0);const s=p.j4({environment:t,type:n.Ti.column,format:{column_ratio:1},inMemoryRecordCache:r,transaction:a,spaceId:o[0].pointer.spaceId,useCrdt:o[0].useCrdt()}),l=s.getContentStore();for(const n of o)d.R3({parent:l,append:n,transaction:a});return s}function f(e){const{environment:t,parent:o,insertStores:n,left:i,transaction:s}=e;if(0===n.length)return[];let c,p;if(l.FT(t,{side:"left"}),m(i))c=i,p=u(i);else{c=h({environment:t,targets:[i],inMemoryRecordCache:o.inMemoryRecordCache,transaction:s});const n=g({environment:t,targets:[c],inMemoryRecordCache:o.inMemoryRecordCache,transaction:e.transaction});p=d.rS({parent:o,oldChild:i,newChild:n,transaction:s}).child}const f=h({environment:t,targets:n,inMemoryRecordCache:o.inMemoryRecordCache,transaction:s});if(p){const t=p.getContentStore();d.Vt({parent:t,insert:f,before:c,transaction:e.transaction}),v({columnList:p,addedColumn:f,transaction:s});return a.G.createChildStore(t,{table:r.iU,id:f.id}).getContentStores()}return[]}function y(e){const{environment:t,parent:o,insertStores:n,right:i,transaction:s}=e;if(0===n.length)return[];let c,p;if(l.FT(t,{side:"right"}),m(i))c=i,p=u(i);else{c=h({environment:t,targets:[i],inMemoryRecordCache:o.inMemoryRecordCache,transaction:s});const n=g({environment:t,targets:[c],inMemoryRecordCache:o.inMemoryRecordCache,transaction:e.transaction});p=d.rS({parent:o,oldChild:i,newChild:n,transaction:s}).child}const f=h({environment:t,targets:n,inMemoryRecordCache:o.inMemoryRecordCache,transaction:s});if(p){const t=p.getContentStore();d.BE({parent:t,insert:f,after:c,transaction:e.transaction}),v({columnList:p,addedColumn:f,transaction:s});return a.G.createChildStore(t,{table:r.iU,id:f.id}).getContentStores()}return[]}const v=function(e){const{columnList:t,addedColumn:o,transaction:n}=e,r=t.getContentStores(),i=1/r.length;c.FH({stores:[o],update:{column_ratio:i},transaction:n});for(const a of r)if(a.id!==o.id){const e=a.getColumnRatio();c.FH({stores:[a],update:{column_ratio:(1-i)*e},transaction:n})}},b=function(e){const{columnList:t,removedColumn:o,transaction:n}=e,r=t.getContentStores(),i=o.getColumnRatio();for(const a of r){const e=a.getColumnRatio();c.FH({stores:[a],update:{column_ratio:e/(1-i)},transaction:n})}},S=function(e){const{parent:t,transaction:o}=e,n=t.getRecordStoreUIParent();let r;if(m(n)&&(r=u(n)),r){const e=r.getContentStore(),t=r.getContentStores();for(const i of t){0===i.getContentStores().length&&(d.Od({parent:e,childToRemove:i,shouldGarbageCollect:!1,transaction:o}),b({columnList:r,removedColumn:i,transaction:o}))}const n=r.getContentStores();if(0===n.length){const e=r.getRecordStoreUIParent();null!=e&&e.valueIs(s.i)&&d.Od({parent:e,childToRemove:r,transaction:o,shouldGarbageCollect:!1})}else if(1===n.length){const e=r.getRecordStoreUIParent(),t=n[0],i=t.getContentStore(),a=t.getContentStores();if(a.reverse(),null!=e&&e.valueIs(s.i)){for(const t of a)d.Od({parent:i,childToRemove:t,shouldGarbageCollect:!1,transaction:o}),d.BE({parent:e,insert:t,after:r,transaction:o});d.Od({parent:e,childToRemove:r,transaction:o,shouldGarbageCollect:!1})}}}}},65770:(e,t,o)=>{o.d(t,{YJ:()=>b,Z2:()=>v});o(57658),o(21703),o(41432);var n=o(68626),r=o(91155),i=o(4615),a=o(21202),s=o(23867),l=(o(9953),o(42858)),c=(o(97444),o(39699)),d=o(95477),p=(o(28020),o(65598)),u=(o(41662),o(63208),o(35661)),m=(o(27724),o(50906)),g=o(54532),h=o(94419),f=o(24677);const y=new Set(["text","table_row","header","sub_header","sub_sub_header","to_do","bulleted_list","numbered_list"]);function v(e){const{parentStore:t,transaction:o,store:s,environment:l}=e,c=s.path[1];if(2!==s.path.length||"properties"!==s.path[0]||"string"!=typeof c)return;const d=s.getRecordStoreAtRootPath();if(!(d instanceof u.G))return;const p=d.getType();if(!p||!y.has(p))return;const f=function(e){var t;const{environment:o,store:n,parentStore:r,transaction:s}=e;if(n.getSpaceId()!==r.getSpaceId())return;const l=null===(t=r.getModel())||void 0===t?void 0:t.getContentIds();if(null==l||!l.includes(n.id))return;const c=g.K8(o,{blockId:n.id,inMemoryRecordCache:n.inMemoryRecordCache,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0});if(!c)return;const d=g.E9({environment:o,sourceBlockId:n.id,targetBlockPointer:{table:a.iU,id:(0,i.ZP)(),spaceId:n.pointer.spaceId},sourceBlockSubtree:c,targetInMemoryRecordCache:n.inMemoryRecordCache,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!1,transaction:s,useCrdt:r.getRecordStoreAtRootPath().useCrdt()});return h.rS({parent:r.getContentStore(),oldChild:n,newChild:d.targetBlock,transaction:s}),d.targetBlock}({environment:l,store:d,parentStore:t,transaction:o}),v=null==f?void 0:f.getPropertyStore(c);if(v)return o.postSubmitCallbacks.push((e=>{e&&n.log({from:"legacyTransclusionActions",level:"error",type:"maybeAutofixLegacyTransclusionProperty",error:{miscErrorString:(0,r.LK)(e)}}),m.Gbs(l,{block_type:p,successful:!e})})),v;n.log({from:"legacyTransclusionActions",level:"error",type:"maybeAutofixLegacyTransclusionProperty",error:{message:"copied transclusion block does not have expected property"}})}function b(e){const{environment:t,store:o}=e,n=o.getRecordStoreUIParent();n&&(0,p.dz)(n)&&c.createAndCommit({userAction:"legacyTransclusionActions.fixLegacyTransclusion",environment:t,perform:e=>{const[r]=g.Qi({environment:t,stores:[o],addCopyName:!1,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,targetSpaceId:(0,s.C)(o.pointer.spaceId),baseUrl:d.default.domainBaseUrl,publicDomainName:d.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:n.getRecordStoreAtRootPath().useCrdt()}),i=r[0],{child:a}=h.BE({parent:n,insert:i,after:o,transaction:e});l.Od({store:o,transaction:e}),f.Z5({environment:t,stores:[a]})}})}},45990:(e,t,o)=>{o.d(t,{F5:()=>f,PP:()=>g,dz:()=>u,gp:()=>m,iX:()=>h});var n=o(70203),r=o(48709),i=o(68056),a=o(89224),s=o(23178),l=o(24666),c=o(97444),d=o(98104),p=o(39699);const u=e=>{const t=l.default.state;if("editing"!==t.mode)return;const o="selectionFocus"===e.type?(0,i.TD)({store:e.store,selection:e.selection}):t.multiSelection,c=(0,i.QY)(o);if(!c)return;const{tokensInsideRange:d}=n.xrQ(c.store.getValue(),o.start.index,o.end.index),p=d.find((e=>Boolean(n.Hze(e)))),u=a.get();if(!u)return;const m=a.getRect(u);if(!m)return;const g=Boolean(p);s.Z.setState({open:!0,url:"",title:p&&(0,r.Ts)(p)||"",editingToken:p,savedTextSelectionState:{...t,multiSelection:o},selectionRect:m,focusLinkInput:!g&&e.focus,focusTitleInput:g&&e.focus})};function m(e){const{environment:t,transaction:o,url:n,title:r,editingToken:a,savedTextSelectionState:s}=e,l=(0,i.QY)(s.multiSelection);if(!l)return;a&&c.Be({environment:t,store:l.store,type:"a",selection:l.selection,transaction:o});const p=["a",n];return c.i8({environment:t,store:l.store,annotation:p,selection:l.selection,transaction:o}),d.Z5({store:l.store,selection:{startIndex:l.selection.startIndex,endIndex:l.selection.endIndex}}),r?{editingToken:[r,[p]]}:void 0}function g(e){const t=s.Z.state;if(!t.open)return;const{editingToken:o,savedTextSelectionState:n}=t;if(!o)return;const r=(0,i.QY)(n.multiSelection);r&&(p.createAndCommit({userAction:"linkAnnotationActions.unlinkSelection",environment:e,perform:t=>{c.Be({environment:e,store:r.store,type:"a",selection:r.selection,transaction:t})}}),l.default.emit(),s.Z.reset())}function h(e){const{environment:t,title:o,transaction:r,editingToken:a,savedTextSelectionState:s}=e;if(!o||!a)return;const l=(0,i.QY)(s.multiSelection);if(!l)return;const p=l.store;c.pz({environment:t,multiSelection:s.multiSelection,transaction:r});const u=l.selection.startIndex,m=u+o.length,g={startIndex:u,endIndex:m},h=["a",n.Hze(a)],f=n.V3y(o);return c.mM({environment:t,store:p,tokens:[f],index:u,transaction:r}),c.i8({environment:t,store:p,annotation:h,selection:g,transaction:r}),d.Z5({store:p,selection:g}),{editingToken:[o,[h]],savedTextSelectionState:{...s,multiSelection:{start:{store:p,index:u},end:{store:p,index:m}}}}}function f(){s.Z.setState({open:!1})}},94419:(e,t,o)=>{o.d(t,{BE:()=>s,Ce:()=>u,HP:()=>m,MK:()=>d,Od:()=>c,R3:()=>p,Vt:()=>l,rS:()=>a});o(57658);var n=o(20747),r=o(19358),i=o(39699);const a=function(e){const{parent:t,oldChild:o,newChild:n,transaction:a}=e,s=o.id,l=n.id,c=(t.getValue()||[]).indexOf(s);r.D0({parentStore:t,childStore:n,transaction:a}),r.If({parentStore:t,childStore:o,transaction:a}),c>=0&&(i.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:l,after:s}}}),i.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:s}}}));return{parent:t,child:n.cloneWithNewUIParent(t)}},s=function(e){const{parent:t,insert:o,after:n,transaction:a}=e;let s;n&&(s=n.id),r.D0({parentStore:t,childStore:o,transaction:a}),i.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{after:s,id:o.id}}});return{parent:t,child:o.cloneWithNewUIParent(t)}},l=function(e){const{parent:t,insert:o,before:n,transaction:a}=e;let s;n&&(s=n.id),r.D0({parentStore:t,childStore:o,transaction:a}),i.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listBefore",args:{before:s,id:o.id}}});return{parent:t,child:o.cloneWithNewUIParent(t)}},c=function(e){void 0===e.shouldGarbageCollect&&(e.shouldGarbageCollect=!0);const{parent:t,childToRemove:o,shouldGarbageCollect:a,transaction:s}=e;r.If({parentStore:t,childStore:o,transaction:s}),i.applyOperation({transaction:s,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:o.id}}}),a&&s.preEnqueueActions.push((()=>{n.fU({parent:t,transaction:s})}));const l=o.cloneWithNewUIParent(t);return{parent:t,child:l}},d=function(e){const{parent:t,append:o,transaction:n}=e;r.D0({parentStore:t,childStore:o,transaction:n}),i.applyOperation({transaction:n,store:t,operation:{pointer:t.pointer,path:t.path,command:"keyedObjectListAfter",args:{value:o.pointer,after:void 0}}});return{parent:t,child:o.cloneWithNewUIParent(t)}},p=function(e){const{parent:t,append:o,transaction:n,after:a}=e;r.D0({parentStore:t,childStore:o,transaction:n}),i.applyOperation({transaction:n,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:o.id,after:a}}});return{parent:t,child:o.cloneWithNewUIParent(t)}},u=function(e){const{parent:t,prepend:o,transaction:n,before:a}=e;r.D0({parentStore:t,childStore:o,transaction:n}),i.applyOperation({transaction:n,store:t,operation:{pointer:t.pointer,path:t.path,command:"listBefore",args:{id:o.id,before:a}}});return{parent:t,child:o.cloneWithNewUIParent(t)}},m=function(e){const{parent:t,current:o,after:n,transaction:r}=e;n?s({parent:t,insert:o,after:n,transaction:r}):u({parent:t,prepend:o,transaction:r});return{parent:t,child:o.cloneWithNewUIParent(t)}}},13084:(e,t,o)=>{o.d(t,{Bm:()=>M,DC:()=>T,HO:()=>P,LQ:()=>I,UG:()=>A,dM:()=>R,uQ:()=>C});o(21703);var n=o(1302),r=o(41432),i=o(14248),a=o(72126),s=o(21202),l=o(95371),c=o(28020),d=o(65598),p=o(69645),u=o(73959),m=o(55367),g=o(35661),h=o(34583),f=o(49865),y=o(42239),v=o(31781),b=o(20747),S=o(94419),_=o(9953),w=o(42858),k=o(24677),x=o(98104);function I(e){const{environment:t,droppedDirection:o,droppedStores:n,targetStore:l,targetParentStore:c,transaction:d,duplicate:p}=e,u=n.every((e=>e.isExternalObjectInstancePageBlockStore()))||p;if(l&&o===m.vh.Onto){k.ZH(t);const e=!(l.isInsideTemplate()||l.isInsideFactoryOrDuplicateBlocksAction()),o=y.LQ({environment:t,droppedStores:n,duplicate:u,transaction:d,resolveTemplateVariables:e,duplicateUseCrdt:l.useCrdt()});let a=l;if(l.isType(r.Ti.alias)){const e=l.getAliasTargetStore();if(!e)throw new Error("Alias has no target.");e instanceof g.G&&(a=e)}const s=a.getCollectionViewCollectionStore();if(a.isCollectionView()&&!a.isCollectionViewPageWithContent()){if(!s)throw new Error("CollectionStore is not defined.");const e=f.o3({environment:t,stores:o,transaction:d,collectionStore:s});for(const o of e)f.mp({environment:t,store:o,collectionStore:s,coerce:!0,groupsPointer:[],transaction:d});return e}{const e=a.getAssociatedCollectionStore();if(null!=e&&e.isPageTreeCollection())for(const n of o){if("page"!==n.getType())continue;if(!n.isDefined())continue;const t=i.Xq({blockProperties:n.getProperties(),oldSchema:n.getSchema(),newSchema:e.getSchema()});t.propertyUpdate&&Object.keys(t.propertyUpdate).length>0&&_.sW({store:n.getPropertiesStore(),data:t.propertyUpdate,transaction:d})}const t=a.getContentStore();for(const n of o)S.R3({parent:t,append:n,transaction:d});return o}}{const e=!!l&&!(l.isInsideTemplate()||l.isInsideFactoryOrDuplicateBlocksAction(!1)),r=c.getRecordStoreAtRootPath();let i=y.LQ({environment:t,droppedStores:n,duplicate:u,transaction:d,resolveTemplateVariables:e,duplicateUseCrdt:l?l.useCrdt():r.table===s.iU&&r.useCrdt()});return o===m.vh.Above?(i=a.d9(i),l?i=a.UI(i,(e=>S.Vt({parent:c,insert:e,before:l,transaction:d}).child)):(i.reverse(),i=a.UI(i,(e=>S.Ce({parent:c,prepend:e,transaction:d}).child)))):o===m.vh.Below?(i=a.d9(i),l?(i.reverse(),i=a.UI(i,(e=>S.BE({parent:c,insert:e,after:l,transaction:d}).child))):i=a.UI(i,(e=>S.R3({parent:c,append:e,transaction:d}).child))):l&&o===m.vh.Left?i=b.U_({environment:t,parent:c,insertStores:i,left:l,transaction:d}):l&&o===m.vh.Right&&(i=b.FZ({environment:t,parent:c,insertStores:i,right:l,transaction:d})),w.DV({environment:t,insertedStores:i}),k.Z5({environment:t,stores:i}),i}}function C(e){var t;const{environment:o,files:n,droppedDirection:r,targetStore:i,targetParentStore:a,transaction:s}=e,l=a.inMemoryRecordCache,d=c.qQ(o);I({environment:o,targetParentStore:a,targetStore:i,droppedDirection:r,droppedStores:v.z({environment:o,files:n,inMemoryRecordCache:l,pageWidth:d,transaction:s,spaceId:null==i?void 0:i.pointer.spaceId,useCrdt:(null===(t=(0,u.sQ)(a))||void 0===t?void 0:t.useCrdt())??!1}),duplicate:!1,transaction:s})}function T(e){const{environment:t,targetStore:o,isAtStartOfLine:n}=e;(function(e){const{environment:t,isClick:o,targetStore:n}=e;if(!o)return!1;const i=n.findRecordStoreUIAncestor((e=>e instanceof g.G&&e.isTransclusionType())).ancestor;if(i&&i instanceof g.G){const e=n.findRecordStoreUIAncestor((e=>e instanceof g.G&&e.getType()===r.Ti.transclusionReference)).ancestor,o=(e&&e instanceof g.G?e:void 0)||i,a=o.getRecordStoreUIParent();if(!a||!(0,d.dz)(a))return;return k.Z5({environment:t,stores:[o]}),!0}return!1})(e)||R({environment:t,store:o,isAtStartOfLine:n})||function(e){const{environment:t,targetStore:o,isAtStartOfLine:n}=e,r=k.KX(),i=r.indexOf(o);if(-1===i)return!1;if(n)for(let a=i;a>=0&&a>i-20;a--){if(R({environment:t,store:r[a],isAtStartOfLine:!1}))return!0}else for(let a=i;a<r.length&&a<i+20;a++){if(R({environment:t,store:r[a],isAtStartOfLine:!0}))return!0}}(e)}function M(e){const{environment:t,targetStore:o,isAtStartOfLine:n}=e;R({environment:t,store:o,isAtStartOfLine:n})||B({...e,placement:"after"})}function P(e){return D(e)}function A(e){return D(e)}function D(e){const{environment:t,container:o,store:n,transaction:i}=e,c=function(e){var t;const{container:o,store:n}=e;let i=(0,p.dq)({includeNonSelectableListContainer:!0,container:o});i&&n&&(i=a.Z$((0,l.DY)([i],(e=>e.value.store===n))));if(!i)return;let s=i;for(;s.children.length>0;){const e=a.Z$(s.children);if(0===e.children.length)break;const t=e.value.store.getType();if(t&&r.BT[t])break;s=e}return{parentStore:s.value.store,siblingStore:null===(t=a.Z$(s.children))||void 0===t?void 0:t.value.store}}({container:o,store:n});if(!c)return!1;const{parentStore:u,siblingStore:m}=c;if(m&&(0,d.PF)(m))return!1;const g=u.getParentStore();return B({environment:t,targetParentStore:(u.getType()===r.Ti.tab&&(null==g?void 0:g.table)===s.iU?g:u).getContentStore(),placement:"after",transaction:i})}function B(e){const{environment:t,targetStore:o,targetParentStore:i,placement:a,transaction:s}=e;if(i.getValue()&&h.M_(t)&&h.M_(t)){var l;const e=_.j4({environment:t,type:r.Ti.text,inMemoryRecordCache:i.inMemoryRecordCache,transaction:s,spaceId:i.pointer.spaceId,useCrdt:(null===(l=(0,u.sQ)(i))||void 0===l?void 0:l.useCrdt())??!1}),c="after"===a?S.BE({parent:i,after:o,insert:e,transaction:s}):S.Vt({parent:i,before:o,insert:e,transaction:s});return n.default.afterNextFlush((()=>{R({environment:t,store:c.child,isAtStartOfLine:!1})})),!0}return!1}function R(e){const{environment:t,store:o,isAtStartOfLine:n}=e,r=(0,u.mh)(o);return!!r&&(k.eP({environment:t,store:o}),n?x.N_({store:r}):x.NX({store:r}),!0)}},92625:(e,t,o)=>{o.d(t,{j:()=>i,x:()=>a});var n=o(33929),r=o(31104);const i=function(e){let{message:t,interpolatedValues:o,targetRecordId:i}=e;r.Z.setState({open:!0,message:n.default.formatMessage(t,o),targetRecordId:i})},a=function(){r.Z.setState({open:!1,targetRecordId:void 0})}},98730:(e,t,o)=>{o.d(t,{S:()=>a});var n=o(48141),r=o(80444),i=o(84166);const a=async e=>{const{hasPublicAccessPermission:t}=n.bC(e),o=r.default.state.currentSpaceStore,a=r.default.state.currentSpaceViewStore;if(t)return;if(!o)return;const s=await n.hb({environment:e,currentSpaceStore:o,currentSpaceViewStore:a,excludeCurrentPage:!0});i.Z.update((e=>({...e,localSearchableBlocksCache:s})))}},35979:(e,t,o)=>{o.d(t,{Be:()=>c,TR:()=>f,V_:()=>p,WA:()=>y,_5:()=>d,lJ:()=>m,nk:()=>h,wt:()=>g,z_:()=>l});var n=o(79946),r=o(50906),i=o(24215),a=o(77080);function s(e,t){i.j(e,t)}function l(e){s(e,"request_login_with_apple"),u(e,"login-with-apple")}function c(e){s(e,"request_login_with_google"),u(e,"login-with-google")}function d(e){s(e,"send_temporary_password"),u(e,"temporary-passcode")}function p(e){s(e,"redirect_to_saml_login"),u(e,"saml")}function u(e,t){i.j(e,"login_attempt",{login_method:t})}function m(e,t){r.o7O(e,"signup_login_button_clicked",t),a.default.logEvent("signup_login_button_clicked",t.login_method,t)}function g(e,t){i.j(e,"login_success",t,{dontWait:!0})}function h(e,t){const{isBannedGoogleSSOUserAgent:o,isSignup:i}=t;r.o7O(e,"onboarding_landing_page",{is_banned_google_sso_user_agent:o,is_signup:i}),i&&n.T1()}function f(e,t){const{actionType:o,isSignup:n}=t;i.j(e,"google_one_tap_login_button_click",{is_signup:Boolean(n),action_type:o},{dontWait:!0})}function y(e,t){i.lu(e,"login_email_input_updates","login_email_input_updates",1)}},97977:(e,t,o)=>{o.r(t),o.d(t,{actuallyLogoutAndDeleteAllLocalData:()=>we,clearCurrentUser:()=>_e,handleLoginFailureIfSamlRequired:()=>De,handleLoginSuccess:()=>ke,handleLoginWithMfa:()=>xe,handleLoginWithTemporaryPasscodeSuccess:()=>ue,initialize:()=>Te,loginPasswordReset:()=>ye,loginSamlUser:()=>ve,loginSamlUserWithToken:()=>fe,loginWithAppleAuth:()=>me,loginWithGoogleAuth:()=>ge,loginWithTemporaryPasscode:()=>pe,logout:()=>Se,logoutSingleAccount:()=>be,openBrowserInMobileNative:()=>de,redirectToSaml:()=>he,requestLoginWithGoogleOneTap:()=>ce,setLocalStorageUserId:()=>Ce,shouldCreatePassword:()=>Pe,showSamlRedirectMessage:()=>Be});o(57658),o(21703);var n=o(87997),r=o(79946),i=o(15145),a=o(53504),s=o(68626),l=o(72126),c=o(91155),d=o(29477),p=o(4615),u=o(99405),m=o(89101),g=o(19889),h=o(66079),f=o(9852),y=o(54153),v=o(64002),b=o(66504),S=o(5366),_=o(47839),w=o(29974),k=o(95477),x=o(24215),I=o(91924),C=o(12955),T=o(33954),M=o(87381),P=o(33929),A=o(28125),D=o(57491),B=o(78873),R=o(18514),E=o(15517),F=o(32223),N=o(75538),j=o(18245),O=o(19034),L=o(78861),U=o(84693),Z=o(58455),V=o(80444),q=o(77080),z=o(5315),W=o(35661),H=o(27724),G=o(24666),K=o(88893),$=o(50906),Y=o(54642),Q=o(90287),J=o(47307),X=o(57400),ee=o(3297),te=o(94273),oe=o(92625),ne=o(35979),re=o(4408),ie=o(75018),ae=o(70782);const se=(0,S.defineMessages)({unsavedChanges:{id:"loginActions.dialogError.logoutUnsavedChanges.message",defaultMessage:"You have unsaved changes. If you log out now, you could lose them."},logoutWithoutSaving:{defaultMessage:"Discard edits and log out",id:"loginActions.dialogError.logoutUnsavedChanges.confirmButton.label"},signupPendingMessage:{defaultMessage:"Creating Notion accountâ€¦",id:"loginActions.signup.pending.message"},loginPendingMessage:{defaultMessage:"Logging in to Notionâ€¦",id:"loginActions.login.pending.message"},redirectSamlMessage:{defaultMessage:"SAML SSO required. Redirecting to the configured login page.",id:"loginActions.login.redirect.saml.message"}});async function le(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];if(t){const e=(0,f.getOauthAuthorizationParams)();sessionStorage.clear(),(0,f.setOauthAuthorizationParams)(e)}else sessionStorage.clear();if(E.ZL(),o&&n.push(_e(e)),n.push($.NMx()),e.mobileNative&&(n.push(e.mobileNative.logoutOfGoogle()),n.push(e.mobileNative.cancelUserBackgroundTasks())),e.device.isElectron&&(_.clearBrowserHistory(),t||_.clearCookies()),V.default.reset(),H.default.reset(),G.default.reset(),re.LK(e),F.resetRecordSubscriptions(),O.Z.reset(),Z.default.reset(),N.default.reset(),n.push(z.transactionQueue.reset()),"on"===q.default.getGroup("clear-record-cache-on-login")){const t=e.defaultRecordCache.persistedRecordCache;t&&"reset"in t&&n.push(t.reset())}q.default.reset(),await Promise.all(n)}async function ce(e){const{environment:t,idToken:o,store:n,frontPathName:r}=e,i=await(0,M.loadCurrentUserId)(t),a=j.default.mark("login_time.google"),s=await Y.loginWithGoogleJwt(t,{idToken:o});if(j.default.measure(a,{environment:t}),"success"===s.type){const{isNewSignup:e,userId:o}=s.data;return await ke({environment:t,isNewSignup:e,userId:o,previousPersistedUserId:i,loginMethod:"login-with-google-onetap",frontPathName:r}),{status:"success"}}{await De(t,s);const e=(0,T.wf)(P.default.getIntl(),s);return n.setState({...n.state,alert:e}),{status:"fail"}}}function de(e,t){e.mobileNative&&((0,I.Q7)(e)?e.mobileNative.openAuthSessionBrowser(t):e.mobileNative.openInAppBrowser(t))}async function pe(e){const{environment:t,state:o,password:n,redirectURL:r,webBrowserDeviceId:i,passcodeEnterMethod:a,showInvitationVersion:s}=e,l=j.default.mark("login_time.passcode"),c=await(0,M.loadCurrentUserId)(t),d=await Y.loginWithEmail(t,{state:o,password:n});if(j.default.measure(l,{environment:t}),"success"!==d.type){await De(t,d);return(0,T.wf)(P.default.getIntl(),d)}{const{isNewSignup:e,userId:o}=d.data;if(_.electronApi&&function(e){let{environment:t,isNewSignup:o,webBrowserDeviceId:n}=e;if(!t.device.isElectron||!o||n)return!1;return q.default.checkGate("desktop_app_login_with_email_redirect")}({environment:t,isNewSignup:e,webBrowserDeviceId:i})){const e=v.$U(v.bf({url:`${k.default.domainBaseUrl}${m._j.loginSuccess}`}));_.electronApi.openExternalUrl(e)}else await ue({environment:t,isNewSignup:e,userId:o,redirectURL:r,previousPersistedUserId:c,loginMethod:"temporary-passcode",webBrowserDeviceId:i,passcodeEnterMethod:a,showInvitationVersion:s})}}async function ue(e){const{environment:t}=e;await ke(e);const[o,n,r]=await Promise.all([Pe(t),Ae(t),Me()]);(o&&n||o&&r)&&B.E({environment:t})}async function me(e){const{environment:t,code:o,encryptedToken:n,encryptedNonce:r,encryptedUserObject:i,webBrowserDeviceId:a}=e,s=j.default.mark("login_time.apple"),l=await(0,M.loadCurrentUserId)(t),c=await Y.loginWithAppleAuth(t,{code:o,encryptedToken:n,encryptedNonce:r,encryptedUserObject:i});if(j.default.measure(s,{environment:t}),"success"!==c.type)return await De(t,c),(0,T.wf)(P.default.getIntl(),c);{const{isNewSignup:e,userId:o}=c.data;await ke({environment:t,isNewSignup:e,userId:o,previousPersistedUserId:l,loginMethod:"login-with-apple",webBrowserDeviceId:a})}}async function ge(e){const{environment:t,encryptedToken:o,code:n,callbackType:r,webBrowserDeviceId:i}=e,a=await(0,M.loadCurrentUserId)(t),s=await Y.loginWithGoogleAuth(t,{code:n,encryptedToken:o,callbackType:r});if("success"!==s.type)return await De(t,s),(0,T.wf)(P.default.getIntl(),s);{const{isNewSignup:e,userId:o}=s.data;await ke({environment:t,isNewSignup:e,userId:o,previousPersistedUserId:a,loginMethod:"login-with-google",webBrowserDeviceId:i})}}function he(e,t){ne.V_(e),e.mobileNative?de(e,t):e.device.isElectron&&_.electronApi?_.electronApi.openExternalUrl(t):window.location.href=t}async function fe(e){const{environment:t,csrfState:o,token:n,isNewSignup:r}=e,i=await(0,M.loadCurrentUserId)(t),a=await C.getBrowserId(t);o||n||s.log({level:"error",type:"loginSamlUserWithToken",from:"loginActions",error:{stack:(new Error).stack},data:{miscDataToConvertToString:{deviceId:a,isNewSignup:r}}});const l=await Y.loginWithEmail(t,{state:o,password:n});if("success"!==l.type)return await De(t,l),(0,T.wf)(P.default.getIntl(),l);{const{userId:e}=l.data;await ke({environment:t,isNewSignup:r,userId:e,previousPersistedUserId:i,loginMethod:"saml"})}}async function ye(e){const{environment:t,csrfState:o,password:n,loginStore:r}=e,i=await(0,M.loadCurrentUserId)(t);if(!o){const e=await C.getCookie(t,"notion_browser_id");s.log({level:"error",type:"loginPasswordReset",from:"loginActions",error:{stack:(new Error).stack},data:{miscDataToConvertToString:{deviceId:e,previousPersistedUserId:i}}})}const a=await Y.loginWithEmail(t,{state:o,password:n,passwordReset:!0});if("success"!==a.type)return await De(t,a),(0,T.wf)(P.default.getIntl(),a);{const{userId:e,enabledMfaSettings:o}=a.data;o&&o.length>0?(xe({environment:t,isNewSignup:!1,userId:e,previousPersistedUserId:i,loginMethod:"password-reset",loginStore:r,mfaSettings:o}),ie.navigateOnBaseUrl({environment:t,url:m._j.login}),B.E({environment:t})):(await ke({environment:t,isNewSignup:!1,userId:e,previousPersistedUserId:i,loginMethod:"password-reset"}),B.E({environment:t}))}}async function ve(e){const{environment:t,userId:o,previousUserId:n,isNewSignup:r}=e;await ke({environment:t,isNewSignup:r,userId:o,previousPersistedUserId:n,loginMethod:"saml"})}async function be(e){const{environment:t,userId:o}=e,{nextUserId:n,nextSpaceViewStore:r}=function(e){const{environment:t,userId:o}=e,n=t.currentUser.id;if(o===n){const e=L.Z.getAllSpaceViewStores(t).filter((e=>{const t=e.getUserRootParentId();return t&&t!==o}))[0];return{nextUserId:e&&e.getUserRootParentId(),nextSpaceViewStore:e}}{const{currentSpaceViewStore:e}=V.default.state;return{nextUserId:n,nextSpaceViewStore:e}}}(e);if(n&&r){if(await z.transactionQueue.hasTasksForUser(o)){if(!(await J.confirmUserAction({message:P.default.formatMessage(se.unsavedChanges),acceptLabel:P.default.formatMessage(se.logoutWithoutSaving)})))return}await Y.logout(t,{userId:o}),await z.transactionQueue.clearForUser(o),E.ZL(o);const e=await ae.x({environment:t,newCurrentUserId:n,loggedOutUserId:o}),{currentUserRootStore:a,currentUserSettingsStore:s}=V.default.state;a&&s&&w.y3({environment:e,spaceViewStore:r,userSettingsStore:s,userRootStore:a,pageVisitSource:i.tY.Login}),_.refreshAll({includeFocusedWindow:!1})}else await Se(t)}async function Se(e){if(await z.transactionQueue.anySessionHasTasks()){if(!(await J.confirmUserAction({message:P.default.formatMessage(se.unsavedChanges),acceptLabel:P.default.formatMessage(se.logoutWithoutSaving)})))return}(0,R.Sr)()?window.location.href=`${k.default.domainBaseUrl}/logout`:ie.navigate({environment:e,url:m._j.logout})}async function _e(e){if(e.mobileNative&&await e.mobileNative.unregisterPushNotifications(),e.updateCurrentUserId){const t={environment:e,currentUserId:void 0,userIds:[]};e.updateCurrentUserId(t)}return{...e,currentUser:new n.CurrentUser}}async function we(e){const{environment:t,nextLocation:o,userId:n,doNotRedirect:r}=e;n?await Y.logout(t,{userId:n}):await Y.logout(t,{}),await le(t),_.clearGoogleAuthCookies(),_.refreshAll({includeFocusedWindow:!1}),r||(window.location.href=o||m._j.root)}async function ke(e){const{environment:t,isNewSignup:o,userId:n,redirectURL:i,previousPersistedUserId:l,frontPathName:c,webBrowserDeviceId:g,passcodeEnterMethod:h,showInvitationVersion:y}=e;o?oe.j({message:se.signupPendingMessage}):oe.j({message:se.loginPendingMessage});try{const v=A.k(t);if(re.LK(t),t.device.isElectron&&(_.clearBrowserHistory(),_.refreshAll({includeFocusedWindow:!1})),l&&l!==n){const e=await z.transactionQueue.getTotalNumberOfTasks();e>5&&s.log({level:"warning",from:"loginActions",type:"setLoggedInUserId",data:{userId:n,currentUserId:l,clearedTransactionCount:e}}),await le(t,v,!t.currentUser.loggedInUserIds.includes(l))}if(!l){const e=ee.qd(void 0);ee.nM({currentUserId:n,blockId:e}),ee.nM({currentUserId:void 0,blockId:void 0})}const b=await Ie(t,n);if(ne.lJ(b,{is_new_signup:o,login_method:e.loginMethod,front_pathname:c}),o){$.ieV(b,{user_id:n,tags:(0,f.getSessionAnalyticsTags)(),origin_initial_page:ie.getInitialPage(n)});const t=await(0,x.of)(b);await(0,d.OI)(200,[Y.initializeUserAnalyticsEmptySync(b,{isNewSignup:o,analyticsProperties:(0,a.Z)({...(0,x.Ts)(),...(0,x.eR)(),...(0,D.getMobileNativeDeviceInfo)(),...t,experiments:q.default.getExperimentsMap(),login_method:e.loginMethod,signup_from:t.route_name,front_pathname:c,web_browser_device_id:g,passcode_enter_method:h},"ignore-class-instances")})])}if(i){const e=u.Wj({url:i,isMobile:b.device.isMobile,baseUrl:k.default.domainBaseUrl,publicDomainName:k.default.publicDomainName,protocol:k.default.protocol,currentUrl:window.location.href});if(!e||"space"!==e.name&&"page"!==e.name){if(e&&"oauthAuthorization"===e.name){const{responseType:t,redirectUri:o,integrationId:n,state:r,owner:i,userId:a,spaceId:s}=e;(0,f.setOauthAuthorizationParams)({responseType:t,redirectUri:o,integrationId:n,state:r,owner:i,userId:a,spaceId:s})}}else te.nr(e,n)}if(Q.mc(b),X.mc(),await X.Yh(b),o&&(q.default.logEvent("sign_up",void 0,{login_method:e.loginMethod,device_type:t.device.deviceType}),q.default.logEvent("sign_up_by_login_method",e.loginMethod),q.default.logEvent("sign_up_by_device_type",t.device.deviceType)),ne.wt(b,{is_new_signup:o,login_method:e.loginMethod,logged_in_user_ids:b.currentUser.loggedInUserIds.map((e=>(0,p.F9)(e))),most_recent_user_id:(0,p.F9)(n),web_browser_device_id:g,passcode_enter_method:h}),r.j(b.device,{facebook:{eventName:"ViewContent"},google:{eventName:"loggedIn"}}),k.default.isAdminMode){if(!(await C.getGhostAdminUserId(t)))return void ie.navigate({environment:t,url:"/__admin"})}const S=(0,f.getPostLoginRedirect)(k.default.secureFileConfig.protocol,k.default.secureFileConfig.hostname);S?((0,f.unsetPostLoginRedirect)(),window.location.href=S):!v&&l&&l!==n?window.location.href=m._j.root:o&&y?ie.navigate({environment:b,url:m._j.onboarding}):ie.navigate({environment:b,url:m._j.root})}finally{oe.x()}}function xe(e){const{loginStore:t,userId:o}=e,n=new W.U6(e.environment,{table:g.KJ,id:o},{userId:o});t.setState({...t.state,settings:e.mfaSettings,loginType:"mfa",redirectURL:e.redirectURL,previousPersistedUserId:e.previousPersistedUserId,userStore:n})}async function Ie(e,t){await async function(e,t){await Ce(e,t)}(e,t);let o=[t];const r=await(0,M.getUserIdsFromCookie)(e);r&&(r.push(t),o=l.jj(r));const i=await C.getGhostAdminUserId(e),a={...e,currentUser:new n.CurrentUser({id:t,loggedInUserIds:o,adminUserId:i})};if(e.updateCurrentUserId){const n={environment:e,currentUserId:t,userIds:o};await e.updateCurrentUserId(n)}return a.device.isFirefox||E.lr(),a}async function Ce(e,t){const o=await(0,M.getUserIdsFromCookie)(e);o&&!o.includes(t)||y.Z.set(M.currentUserIdKey,t)}async function Te(e){const t=await(0,M.loadCurrentUserId)(e),{mobileNative:o,device:n,defaultRecordCache:r}=e;if(o&&o.sqliteConnection)try{await U.y6(o.sqliteConnection,t||b.I)}catch(i){s.log({level:"error",from:"loginAction.ts",type:"backfillRecordsWithUserId",error:(0,c.Ui)(i),data:{}})}return n.isElectron&&n.electronVersion&&n.electronVersion[0]>=6&&r.persistedRecordCache&&await r.persistedRecordCache.initialize(t),t?await Ie(e,t):e}async function Me(){var e;const{currentUserStore:t}=V.default.state;if(!t)return!1;if(!t.getEmail())return!1;const{currentUserSettingsStore:o}=V.default.state;return!!o&&(await o.load(),Boolean(null===(e=o.getSettings())||void 0===e?void 0:e.should_set_password_on_login))}async function Pe(e){const{currentUserStore:t}=V.default.state;if(!t)return!1;const o=t.getEmail();if(!o)return!1;const n=await B.c({environment:e,userEmail:o});if(n.error)throw n.error;return!n.value.isSamlEnforced&&!n.value.hasPassword&&!n.value.didLogInWithSaml}async function Ae(e){const t=e.currentUser.id;if(!t)return!1;const o=new W.r9(e,{table:h.dx,id:t});await o.load();return(await(0,K.Gh)({environment:e,userRootStore:o})||[]).some((e=>e===k.default.pricing.student.productId))}async function De(e,t){var o,n;if("saml_sso_required"===(null===(o=t.body.clientData)||void 0===o?void 0:o.type)&&null!==(n=t.body.clientData)&&void 0!==n&&n.redirectUrl){await Be(2e3);he(e,t.body.clientData.redirectUrl)}}async function Be(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;oe.j({message:se.redirectSamlMessage}),await(0,d.Vs)(e),oe.x()}},27153:(e,t,o)=>{o.d(t,{$:()=>i,Z:()=>a});var n=o(91390),r=o(24677);function i(e,t){t.disableClearSelection||r.ZH(e),n.Z.setState({...t,isActive:!0})}function a(){const e=n.Z.state;e.isActive&&e.onCancel&&e.onCancel(),n.Z.reset()}},67060:(e,t,o)=>{o.d(t,{Br:()=>R,RL:()=>D,WI:()=>A,_P:()=>M,lZ:()=>P,xv:()=>B});var n=o(49085),r=o(72126),i=o(4615),a=o(70203),s=o(69783),l=o(28020),c=o(30912),d=o(44486),p=o(68056),u=o(98165),m=o(89224),g=o(80444),h=o(64233),f=o(19111),y=o(83212),v=o(72087),b=o(10743),S=o(24666),_=o(34583),w=o(50906),k=o(88295),x=o(97444),I=o(39699);function C(e){const{textStore:t,environment:o}=e,n=(0,u.n3)(t)&&y.Z.getMode(o,t).hasPublicPermission,r=!n,i=!n;return{page:true,createPage:t.isDefaultRecordCache(),user:r,bot:r,date:!0,reminder:!0,templateVariable:T(t),group:i}}function T(e){const t=(0,l.RM)();if(!t||"block"!==e.table)return!1;if(t.isInsideTemplate())return!0;const o=d.W(e);if(o||t.isInsideFactoryOrDuplicateBlocksAction()){const t=null==o?void 0:o.getTitleStore();return!(o&&t&&t.id===e.id&&r.Xy(t.path,e.path))}return!!(0,c.td)(e)}function M(e){const{environment:t,textStore:o,oldSelection:r,oldTextValue:l,disableDateMentions:c,disableDateReminderMentions:d,disableTemplateVariableMentions:p}=e,u=function(e){const{textStore:t,oldSelection:o}=e;if(b.Z.state.open||s.Z.state.open||h.Z.state.open)return;const n=a.eeV(t.getValue()||[]),r=o.startIndex,i=(n[r]||"").normalize("NFKD"),l=(n[r-1]||"").normalize("NFKD"),c=f.Z.state;if(c.open)return"[["===c.insertionType&&"]"===i&&"]"===l?"]]":void 0;if("@"===i){if(l&&!/[\s\(\)\[\]]/g.test(l))return;return"@"}if("+"===i){if(l&&!/[\s\(\)\[\]]/g.test(l))return;return"+"}if("[["===n.slice(r-1,r+1).join("")){const e=n[r-1];if(e&&!/[\s\(\)\[\]]/g.test(e))return;return"[["}}(e);if(!u)return;const g=f.Z.state;if("]]"===u){if(g.open){const e=g.temporaryInputData.state;e&&g.temporaryInputData.setState({...e,suffix:"]]"}),f.Z.setState({...g,showCreateIn:!0})}return}const y=m.get();if(!y)return;const S=m.getRect(y);if(!S)return;const _=C({textStore:o,environment:t}),k=_.page,x=_.createPage,I=_.user&&"@"===u,T=_.bot&&"@"===u,M=_.date&&"@"===u&&!c,P=_.reminder&&"@"===u&&!c&&!d,D=_.templateVariable&&"@"===u&&!c&&!p,B=_.group&&"@"===u;if(!(I||B||k||x||M||P||D))return;if("+"===u&&!x)return;const R=(0,i.ZP)();f.Z.setState({open:!0,flowId:R,openTime:Date.now(),insertionType:u,textStore:o,oldTextValue:l,oldSelection:r,selectionRect:S,userRequestStore:new v.Z,botRequestStore:new v.Z,pageRequestStore:new v.Z,temporaryInputData:n.default.createValue(void 0),mentionTypes:{page:k,createPage:x,user:I,bot:T,date:M,reminder:P,templateVariable:D,group:B},expandSection:void 0,showCreateIn:!1,showInvite:!1,createInQuery:"",isEmptyPageTitle:!1}),w.j1w(t,{analyticsFrom:A(),flowId:R})}function P(e,t){x.N3({direction:"end"});const o=S.default.state;if("editing"!==o.mode)return;const n=(0,p.QY)(o.multiSelection);if(!n)return;let r=!1;if(n.selection.startIndex>0){const e=n.store.getValue()||[],t=a.eeV(e)[n.selection.startIndex-1];/[\s]/g.test(t)||(r=!0)}I.createAndCommit({userAction:"mentionMenuActions.insertMention",environment:e,perform:t=>{r?(x.hJ({environment:e,store:n.store,string:" ",selection:n.selection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t}),x.hJ({environment:e,store:n.store,string:"@",selection:{startIndex:n.selection.startIndex+1,endIndex:n.selection.endIndex+1},disableMentions:!1,disableDateMentions:!1,disableDateReminderMentions:!1,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})):x.hJ({environment:e,store:n.store,string:"@",selection:n.selection,disableMentions:!1,disableDateMentions:!1,disableDateReminderMentions:!1,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}});const i=f.Z.state;if(!i.open)return;const s=C({environment:e,textStore:n.store});f.Z.setState({...i,mentionTypes:{page:s.page&&t.page,createPage:s.createPage&&t.createPage,user:s.user&&t.user,bot:s.bot&&t.bot,date:s.date&&t.date,reminder:s.reminder&&t.reminder,templateVariable:s.templateVariable&&t.templateVariable,group:s.group&&t.group}})}function A(){const e=f.Z.state;if(e.open){const{mainEditorCurrentBlockStore:t}=g.default.state;return t&&t.uiContains(e.textStore)?"block":"comment"}}function D(e){const t=f.Z.state,{environment:o,annotations:n=[],transaction:r,menuListItemAction:i,query:s,mentionType:l}=e;if(t.open){let e=t.oldTextValue,c=t.oldSelection;const d=t.insertionType.length-1;d>0&&(e=a._QS(e,t.oldSelection.startIndex-d,t.oldSelection.startIndex),c={startIndex:c.startIndex-d,endIndex:c.endIndex-d}),x.sO({environment:o,store:t.textStore,value:e,transaction:r});const p=A();n.forEach((e=>{x.lZ({environment:o,store:t.textStore,selection:c,annotation:e,analyticsFrom:p,transaction:r})})),l&&w.z7J(o,{clickIndexGlobal:null==i?void 0:i.index,clickIndexLocal:null==i?void 0:i.indexLocal.indexLocal,sectionIndex:null==i?void 0:i.indexLocal.section,analyticsFrom:p,timeToClickInMs:Date.now()-t.openTime,queryLength:s.length,mentionType:l,flowId:t.flowId}),B()}}function B(){f.Z.setState({open:!1,userRequestStore:f.Z.state.userRequestStore,botRequestStore:f.Z.state.botRequestStore,pageRequestStore:f.Z.state.pageRequestStore,mentionTypes:f.Z.state.mentionTypes})}async function R(e){const{environment:t,titleText:o,ignoreSelectionAreaStore:n,createInValue:r,onPageCreated:i,menuListItemAction:a}=e,s=f.Z.state;if(!s.open)return;if(!_.M_(t))return;n.reset();const{performResult:l}=await I.createAndCommitAsync({environment:t,userAction:"mentionMenuActions.acceptCreateIn",waitForServerCommit:!0,perform:async e=>{const n=k.f8({environment:t,transaction:e,titleText:o,createInValue:r,recordStoreParent:s.textStore}),l=n.createdPages[0];if(l)return i&&i(l),D({environment:t,annotations:[["p",l.id]],transaction:e,menuListItemAction:a,query:o,mentionType:"createPage"}),await n.moveToStorePromise,{createInState:n}}});if(l){const{createInState:e}=l;return await k.c_({analyticsFrom:"mention_menu",createInState:e}),e}}},91376:(e,t,o)=>{o.d(t,{CT:()=>l,r$:()=>s});var n=o(97799),r=o(80444),i=o(64404),a=o(92083);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{currentTab:t,subtab:o,isMobile:i,openedFrom:s}=e;if(i)"notifications"!==t&&"notifications_and_settings"!==t&&"user_settings"!==t||n.Z.setState({open:!0});else if(t)a.Z.setState({open:!0,openedFrom:s,...c({currentTab:t,subtab:o}),highlightedSetting:void 0});else{const{currentSpaceStore:e}=r.default.state;a.Z.setState({open:!0,openedFrom:s,currentTab:l(e),defaultSubtab:void 0,highlightedSetting:void 0})}}function l(e){return e&&e.canRead()?"members":"settings"}function c(e){const{currentTab:t,subtab:o}=e;if("members"===t){return{currentTab:"members",defaultSubtab:o===i.Q.Members||o===i.Q.Groups||o===i.Q.Guests||o===i.Q.Reprovisioning||o===i.Q.Requests?o:void 0}}if("integrations"===t){return{currentTab:"integrations",defaultSubtab:"member_connections"===o||"workspace_connections"===o?o:void 0}}return{currentTab:t,defaultSubtab:void 0}}},60971:(e,t,o)=>{o.d(t,{aV:()=>i,eV:()=>a,kW:()=>c,sv:()=>d});var n=o(72126),r=o(85818);function i(e){const{store:t,itemsPerRow:o,sections:n,disableKeyboardArrowWrap:r}=e,{focus:i}=t.state;if(void 0===i.indexLocal)return c({store:t,sections:n,indexGlobal:0});const a=i.indexLocal+o,d=n[i.section],p=d.items.length-1;if(a<=p)return c({store:t,sections:n,indexLocal:{section:i.section,indexLocal:a}});const u=function(e){const{indexLocal:t,section:o,itemsPerRow:n}=e,r=l({indexLocal:t,section:o,itemsPerRow:n});if(!r)return;const i=s({section:o,itemsPerRow:n});if(!i)return;return r.rowsBefore===i.rowsBefore}({indexLocal:i.indexLocal,section:d,itemsPerRow:o});if(void 0===u)return;if(!1===u)return c({store:t,sections:n,indexLocal:{section:i.section,indexLocal:p}});const m=function(e){const{currentSection:t,sections:o,disableWrap:n}=e;if(0===o.length)return;if(t&&t>=o.length&&n)return;const r=void 0===t?0:(t+1)%o.length,i=o[r];if(!i)return;return{index:r,section:i}}({currentSection:i.section,sections:n,disableWrap:r});if(!m)return;const g=i.indexLocal%o;return m.section.items.length<=g?c({store:t,sections:n,indexLocal:{section:m.index,indexLocal:0}}):c({store:t,sections:n,indexLocal:{section:m.index,indexLocal:g}})}function a(e){const{store:t,itemsPerRow:o,sections:n,disableKeyboardArrowWrap:i}=e,{focus:a}=t.state;if(void 0===a.indexLocal){return c({store:t,indexGlobal:r.tM(n)-1,sections:n})}const l=a.indexLocal-o;if(l>=0)return c({store:t,sections:n,indexLocal:{section:a.section,indexLocal:l}});const d=function(e){const{currentSection:t,sections:o,disableWrap:n}=e;if(0===o.length)return;if(0===t||void 0===t){if(n)return;const e=o.length-1,t=o[e];if(!t)return;return{index:e,section:t}}const r=o[t-1];if(!r)return;return{index:t-1,section:r}}({currentSection:a.section,sections:n,disableWrap:i});if(!d)return;const p=s({section:d.section,itemsPerRow:o});if(!p)return;const u=a.indexLocal%o;if(p.column<u)return c({store:t,sections:n,indexLocal:{section:d.index,indexLocal:p.indexLocal}});{const e=p.rowsBefore*o+u;return c({store:t,sections:n,indexLocal:{section:d.index,indexLocal:e}})}}function s(e){const{section:t,itemsPerRow:o}=e;if(0===t.items.length)return;if(0===o)return;const n=t.items.length-1,r=l({indexLocal:n,section:t,itemsPerRow:o});return r?{indexLocal:n,...r}:void 0}function l(e){const{indexLocal:t,section:o,itemsPerRow:n}=e;if(!(n<=0||t>=o.items.length))return{rowsBefore:Math.trunc(t/n),column:t%n}}function c(e){const{store:t,sections:o}=e;if(e.indexLocal){const n=r.$6(e.indexLocal,o);if(!r._K(e.indexLocal,o))return;t.setState({...t.state,focus:{...e.indexLocal,indexGlobal:n}})}else if(void 0===e.indexGlobal)t.unsetFocus();else{const n=r.Ds(e.indexGlobal,o);if(!n)return;t.setState({...t.state,focus:{...n.index,indexGlobal:e.indexGlobal}})}}function d(e){let{store:t,focus:o}=e;"number"==typeof t.state.focus.indexLocal&&(n.Xy(o,t.state.focus)||t.setState({...t.state,focus:o}))}},98958:(e,t,o)=>{o.r(t),o.d(t,{handleTokenRefresh:()=>m,initializeMobileNativeApp:()=>p,registerPushNotifications:()=>u,waitForCssInsets:()=>g});var n=o(68626),r=o(91155),i=o(29477),a=o(62643),s=(o(95477),o(24215)),l=o(54642),c=o(9953),d=o(39699);async function p(e){if(e.device.isMobileNative&&e.mobileNative&&(await g(e),e.mobileNative.updateReceiveApiHandlers({track:t=>{s.j(e,t.eventName,{...t.eventData,logging_source:"mobile_native"})}}),e.mobileNative&&e.mobileNative.sqliteConnection))try{await e.mobileNative.sqliteConnection.ensureMigrated(),e.mobileNative.sqliteConnection.optimize()}catch(t){n.log({level:"error",from:"loginAction.ts",type:"backfillRecordsWithUserId",error:(0,r.Ui)(t),data:{}})}}async function u(e){const{mobileNative:t}=e;if(t&&t.api.registerPushNotifications){const o=await t.api.registerPushNotifications();o&&m(e,o,"registration")}}async function m(e,t,o){const n=e.currentUser.id;if(t&&n){const o=(0,a.r9)({user_id:n,token:t}),r=await l.syncRecordValue(e,{pointer:{table:a.q4,id:o},userId:n,version:-1});let i=!1;r&&(r.value&&!r.value.invalid||(d.createAndCommit({userAction:"mobileNativeActions.handleTokenRefresh",environment:e,perform:r=>{c.ae({environment:e,table:a.q4,value:{id:o,token:t,user_id:n,invalid:!1},inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,transaction:r})}}),i=!0))}}async function g(e){if(!e.device.isIOS||!e.device.isMobileNative)return;const t=document.createElement("div");t.style.width=`calc(${["env(safe-area-inset-top)","env(safe-area-inset-bottom)","env(safe-area-inset-left)","env(safe-area-inset-right)"].join(" + ")})`,t.style.visibility="hidden",document.body.appendChild(t);let o=0;for(;o<50&&!(t.offsetWidth>0);)await i.Vs(1),o++;document.body.removeChild(t),e.WindowSizeStore.updateWindowSize()}},29533:(e,t,o)=>{o.d(t,{R:()=>i,h:()=>a});var n=o(149),r=o(17294);function i(e,t){const o={taskStatus:e.taskStatus,...n.x.isSuccess(e)?{completeBlocks:e.value.completeBlocks,totalBlocks:e.value.totalBlocks}:{}};r.Z.update((e=>({...e,[t]:o})))}function a(e){r.Z.update((t=>({...t,[e]:void 0})))}},60870:(e,t,o)=>{o.d(t,{I0:()=>v,eX:()=>f,j2:()=>y,wS:()=>h});o(67294);var n=o(15157),r=o(72126),i=o(21202),a=o(63143),s=o(75770),l=o(98110),c=o(80444),d=o(35661),p=o(50906),u=o(76464),m=o(64964),g=o(85893);function h(e){const{environment:t,movedItems:o,previousParentIds:n,moveToLocation:r,disableSuccessToast:i,numSubitems:a}=e,c=o.some((e=>{const t=n[e.id],o=e.getParentId();return!(!t||t===o)}));!i&&c&&m.oV({label:(0,s.ah)({environment:t,movedItems:o,moveToLocation:r,numSubitems:a}),right:(0,g.jsx)(l.Z,{moveToLocation:r,movedItems:o})})}function f(e){const{environment:t,transaction:o,moveToStore:n,targetBlocks:r,from:i}=e,{currentUserStore:a}=c.default.state;null!=a&&a.isDefined()&&n.canEdit()&&!n.canAdmin()&&r.forEach((e=>{if(e.canAdmin())return p.Y8X(t,{from:i}),u.ep({transaction:o,store:e,environment:t,permissionItems:[{type:"user_permission",user_id:a.id,role:"editor"}]})}))}async function y(e,t,o){const i=await v(e,t),a=r.jj([o,...i]).slice(0,10);n.Z.set({userId:e.environment.currentUser.id,key:b(t),value:JSON.stringify(a)})}async function v(e,t){const o=n.Z.get({userId:e.environment.currentUser.id,key:b(t)});if(o){const t=(0,a.dj)(o);if(t){const o=await Promise.all(t.map((async t=>{const o=d.G.createChildStore(e,{table:i.iU,id:t});return await o.load(),o.canEdit()})));return t.filter(((e,t)=>o[t]))}}return[]}function b(e){return`recentMoveToTargets2:${e}`}},11302:(e,t,o)=>{o.d(t,{$X:()=>X,QF:()=>ee,RL:()=>oe,Ws:()=>re,Y:()=>ae,at:()=>ce,bA:()=>J,kj:()=>ie,pB:()=>te,xv:()=>ne,z1:()=>Y});o(52262),o(24506),o(21703);var n=o(15145),r=o(41432),i=o(45433),a=o(68626),s=o(59730),l=o(72126),c=o(4615),d=o(21202),p=o(6287),u=o(97880),m=o(5366),g=o(65273),h=o(19037),f=o(24215),y=o(77181),v=o(33929),b=o(75770),S=o(98165),_=o(38755),w=o(5162),k=o(80444),x=o(77080),I=o(42330),C=o(98452),T=o(35661),M=o(52258),P=o(52229),A=o(50906),D=o(6404),B=o(49865),R=o(30188),E=o(47307),F=o(57400),N=o(94419),j=o(92625),O=o(60870),L=o(72711),U=o(19785),Z=o(9953),V=o(75018),q=o(24677),z=o(64964),W=o(29974),H=o(150),G=o(39699),K=o(68422),$=o(65452);const Y=()=>[h._z,h.Gg,h.jl,h.ff(h.$I),h.ff(h.xw),h.ff(h.P9(r.Ti.externalObjectInstancePage)),h.ff(h.Vw),h.k5,h.ff(h.fS)],Q=(0,m.defineMessages)({duplicatingContent:{id:"moveToMenuActions.duplicatingContent.loadingMessage",defaultMessage:"Duplicating contentâ€¦"},duplicatedToSpace:{id:"moveToMenuActions.duplicatedToSpace.toast",defaultMessage:"Duplicated {name} to {spaceName}"}});function J(e){const{environment:t,blocks:o,originRect:n,moveToContext:r,onAccept:a,isAddTo:s,isDefaultPrivateLocation:l,disableSuccessToast:d,forceUntyped:p}=e,u=Date.now(),m=(0,I.rJ)(o),g=function(e){const{hasDatabaseType:t,forceUntyped:o}=e;if(o)return i.br;if(t)return"typedUninitialized";return i.br}({forceUntyped:p,hasDatabaseType:Boolean(m)}),h=(0,c.ZP)();o.length&&(M.Z.reset(),C.Z.reset(),D.xv(),I.ZP.setState({variant:g,isOpen:!0,rect:n,targets:o,autocompleteQuery:"",moveToContext:r,onAccept:a,isAddTo:s,isDefaultPrivateLocation:l,lastPageId:I.ZP.state.lastPageId,disableSuccessToast:d,openedTimeMs:u,flowId:h}),A.rYq(t,{from:r,render_type:"web",target_block_ids:o.map((e=>e.id)),targets_database_type:m,flowId:h}))}async function X(e){await async function(e){var t;const{environment:o,blocks:n,originRect:r,moveToContext:a,onAccept:s,isAddTo:l}=e,{currentSpaceStore:d}=k.default.state,p=Date.now(),u=I.ZP.state.isOpen?I.ZP.state.flowId:(0,c.ZP)(),m=(0,I.rJ)(n);if(m&&m!==i.GZ)return!1;if(!(0,w.Y)("supportsNativeMoveTo")||null===(t=o.mobileNative)||void 0===t||!t.api.moveTo||0===n.length||!d)return!1;const g=n.map((e=>e.id)),h=await o.mobileNative.moveTo({targets:g,spaceId:d.id,isAddTo:l||!1,moveToContext:a,flowId:u});if(!h)return!1;if(!h.supported||!h.destination)return h.supported;M.Z.reset(),C.Z.reset(),D.xv(),I.ZP.setState({variant:i.br,isOpen:!0,rect:r,targets:n,autocompleteQuery:"",moveToContext:a,onAccept:s,isAddTo:l,lastPageId:I.ZP.state.lastPageId,renderType:"mobileNative",openedTimeMs:p,flowId:u});const f=I.ZP.state.isOpen&&I.ZP.state.useSudoMode;return await te({environment:o,value:h.destination,useSudoMode:f,renderType:"native",isSearchResult:h.isSearchResult}),ne(o),!0}(e)||J(e)}function ee(e,t,o){if("page"!==o.type)return!1;const n=new T.G(e,{table:d.iU,id:o.id}),r=(0,S.qA)(n);for(const i of r)if(t.includes(i.id))return!0;return!1}async function te(e){const{environment:t,value:o,useSudoMode:n,renderType:r,shouldClearPagePermissions:i,isSearchResult:a}=e;await G.createAndCommitAsync({environment:t,userAction:"MoveToMenuRenderer.completeMoveTransaction",waitForServerCommit:!1,useSudoMode:n,perform:async e=>{const n=I.ZP.state;if(!n.isOpen)return;const{targets:s,disableSuccessToast:l,moveToContext:c,isDefaultPrivateLocation:d,flowId:p,autocompleteQuery:u}=n;await oe({targets:s,value:o,transaction:e,environment:t,shouldClearPagePermissions:i,disableSuccessToast:l,moveToContext:c,isDefaultPrivateLocation:d,renderType:r,timeToSelectMs:Date.now()-n.openedTimeMs,flowId:p,isSearchResult:Boolean(u)||a}),n.onAccept&&n.onAccept(o)}})}async function oe(e){let{targets:t}=e;const{value:o,transaction:n,environment:i,shouldClearPagePermissions:a,disableSuccessToast:s,moveToContext:l,isDefaultPrivateLocation:c,renderType:m,timeToSelectMs:g,flowId:h,isSearchResult:y}=e,{currentSpaceStore:v}=k.default.state;if(!v)return;let _=[];x.default.checkGate("collection_subitem_nested_operations")&&(_=await R.xr({environment:i,blocks:t,options:{canEdit:!0}}),t=[...t,..._]),ne(i);const w=v.id,C=function(e){const{type:t}=e;switch(t){case"page":case"collection":case"space-private-pages":case"team":return e.spaceId;case"space":return e.id;default:(0,u.t1)(t)}}(o);if(C&&w!==C){if(!(await(0,b.cJ)()))return}const T=t.find((e=>{const t=e.getType();return Boolean(t&&(0,r.S9)(t))})),M=T&&(0,S.VP)(T),P=(0,I.rJ)(t),D=Object.fromEntries(t.map((e=>[e.id,e.getParentId()]))),B=await ie({environment:i,value:o,targets:t,transaction:n,shouldClearPagePermissions:a});if(!B)return;const E=(0,b.HE)(o,i);O.wS({environment:i,previousParentIds:D,movedItems:t,moveToLocation:E,disableSuccessToast:s,numSubitems:_.length});const F=T&&(0,S.VP)(T);A._T2(i,{table:B.table,from:l,type:null==E?void 0:E.type,team_before:M&&(0,f.nB)(M),team_after:F&&(0,f.nB)(F),targets_database_type:P,destination_database_type:B.table===p.v?B.getDatabaseType():void 0,isDefaultPrivateLocation:c,render_type:m,time_to_select_ms:g,flowId:h,isSearchResult:y}),B.table===d.iU&&await O.j2(v,v.id,B.id)}function ne(e){const t=I.ZP.state;I.ZP.setState({isOpen:!1,lastPageId:t.lastPageId}),q.ZH(e),t.isOpen&&"home_tab"===t.moveToContext&&V.navigateToHomeTab(e)}async function re(e){return se({...e,action:"add"})}async function ie(e){return se({...e,action:"move"})}async function ae(e){return se({...e,action:"retain-alias"})}async function se(e){const{value:t,transaction:o,targets:r,shouldClearPagePermissions:i}=e;if("user_cancelled_move"===await H.Hl({transaction:o,moveStores:r,moveTargetStore:(0,b.uw)(t)}))return;i&&W.O2({blocks:r,transaction:o});const s=await async function(e){const{transaction:t,targets:o,value:r,environment:i,action:s}=e,{mainEditorCurrentBlockStore:l,currentSpaceStore:c,currentSpaceViewStore:p}=k.default.state,{id:m}=i.currentUser;if(!l||!m||!p)return;const h=(0,b.uw)(r);if(!h)return;if(h instanceof T.G&&x.default.checkGate("enable_text_crdt_client")&&(await h.load(),(0,g.iG)(h,o)))return void z.oV({label:"Cannot move a CRDT block into a non-CRDT parent or vice versa!"});let f;const{table:y}=h;switch(y){case"collection":case"block":f=await async function(e){const{environment:t,blockOrCollectionStore:o,targets:n,transaction:r,retainAliasInCurrentParent:i}=e;let a;await o.load(),a=o instanceof T.NW?o:o.isLinkedCollectionView()?o.getCollectionViewSourceOrLinkCollectionStores()[0]:o.isCollectionView()?o.getCollectionViewCollectionStore():o;if(!a)throw new Error("Move to store invalid.");for(const s of n){const e=s.getParentStore();if(e instanceof T.G&&i){const o=P.k({environment:t,parentBlock:e,targetStore:s,transaction:r});U.jG({parentStore:e.getContentStore(),after:s.id,childStore:o,transaction:r})}if(a instanceof T.G)U.jG({parentStore:a,childStore:s,transaction:r});else if(a instanceof T.NW){const e=B.o3({environment:t,stores:[s],collectionStore:a,transaction:r})[0];B.mp({environment:t,store:e,collectionStore:a,coerce:!0,groupsPointer:[],transaction:r}),U.zw({parentStore:a,childStore:e,transaction:r})}}return a}({environment:i,blockOrCollectionStore:h,targets:o,transaction:t,retainAliasInCurrentParent:"retain-alias"===s});break;case"space":f="space-private-pages"===r.type&&h.id===(null==c?void 0:c.id)?le({environment:i,spaceStore:h,spaceViewStore:p,targets:o,transaction:t,currentUserId:m,retainAliasToBlock:"retain-alias"===s}):await async function(e){const{environment:t,transaction:o,currentSpaceViewStore:r,currentBlockStore:i,currentUserId:s,spaceStore:l,targets:c,action:p,value:u}=e;if("space"!==u.type&&u.spaceId&&u.spaceId!==l.id)throw new Error("Wrong value to move to another space");K._w({environment:t,blocks:c,transaction:o});const m=i.getSpaceId()||l.id;let g;if("move"===p&&("space"!==u.type&&u.spaceId&&u.spaceId!==m||"space"===u.type&&u.id!==m||"space-private-pages"!==u.type)){j.j({message:Q.duplicatingContent,targetRecordId:l.id});const e=await W.eX({environment:t,blockStores:c,spaceId:l.id,targetParent:de(u)});if(j.x(),void 0!==e.error)return void E.showErrorMessage(e.error);g=e.value}else"space-private-pages"===u.type&&le({environment:t,spaceStore:l,spaceViewStore:r,targets:c,transaction:o,currentUserId:s,retainAliasToBlock:"retain-alias"===p});await async function(e){const{environment:t,currentBlockStore:o,currentUserId:r,spaceStore:i,targets:s,crossSpaceTargetBlockId:l}=e,c=Boolean(s.find((e=>e.id===o.id))),p=(0,_.w3)(i.id);if(!c||!p)return;const u=l?T.G.createChildStore(o,{table:d.iU,id:l}):o;await $.l({environment:t,spaceId:i.id,userId:r}),await async function(e){const{environment:t,spaceStore:o,spaceViewStore:n,blockStore:r}=e;o&&n&&(t.device.isMobileNative&&a.log({level:"info",from:"moveToMenuActions",type:"SpaceSwitchingDebug",data:{message:"moveToMenuActions.switchToSpace"}}),k.default.setState({...k.default.state,currentSpaceStore:o,currentSpaceViewStore:n,mainEditorCurrentBlockStore:r}),await F.Yh(t))}({environment:t,spaceStore:i,spaceViewStore:p,blockStore:u}),L.ru({environment:t,blocks:[u],pageVisitSource:n.tY.Move})}({environment:t,currentBlockStore:i,currentUserId:s,targets:c,spaceStore:l,crossSpaceTargetBlockId:g}),g&&z.oV({label:v.default.formatMessage(Q.duplicatedToSpace,{name:(0,b.EC)({movedItems:c}),spaceName:l.getName()})});return l}({environment:i,transaction:t,currentSpaceViewStore:p,currentBlockStore:l,currentUserId:m,spaceStore:h,targets:o,value:r,action:s});break;case"team":f=ce({environment:i,transaction:t,currentSpaceViewStore:p,teamStore:h,targets:o,value:r,action:s,location:{type:"append"}});break;default:(0,u.t1)(y)}"move"===s&&O.eX({environment:i,transaction:t,moveToStore:h,targetBlocks:o,from:"move_to"});return f}({...e});if(!s)return;if(x.default.checkGate("collection_subitem_nested_operations")&&s instanceof T.NW){const e=r.at(0);if(e){const t=(0,y.g0)(e),n=(0,y.ko)(s);t&&n&&R.Z3({blocks:r,transaction:o,from:t.subitemFormat,to:{property:n.property,inverse:n.inverse}})}}return s}function le(e){let{environment:t,spaceStore:o,spaceViewStore:n,targets:r,currentUserId:i,transaction:a,retainAliasToBlock:l}=e;for(const c of r){const e=c.getParentStore();if(e instanceof T.H2){if(e.id!==o.id)throw new s.D3("moveOrAddToPrivatePages: Try to move to a different space");N.Od({parent:e.getPagesStore(),childToRemove:c,transaction:a})}else if(e instanceof T.zX)H.sp({teamStore:e,store:c,transaction:a});else if(e instanceof T.G){if(l){const o=P.k({environment:t,parentBlock:e,targetStore:c,transaction:a});U.jG({parentStore:e.getContentStore(),after:c.id,childStore:o,transaction:a})}U.hr({parentStore:e,childStore:c,transaction:a})}const r={type:"user_permission",user_id:i,role:"editor"};Z.sW({store:c,data:{permissions:[r]},transaction:a}),N.R3({parent:n.getPrivatePagesStore(),append:c,transaction:a})}return o}function ce(e){let{transaction:t,currentSpaceViewStore:o,teamStore:n,targets:r,location:i,environment:a}=e;const s=o.getTeamsStores(),c=n.getTeamPagesStore();K._w({environment:a,blocks:r,transaction:t});for(const d of r){const e=l.sE(s,(e=>{const t=e.getTeamPagesStore().getValue();if(t)return t.includes(d.id)}));(null==e?void 0:e.id)!==n.id&&("append"===i.type?U.jG({parentStore:c,childStore:d,after:i.after,transaction:t}):"prepend"===i.type?U.SH({parentStore:c,childStore:d,before:i.before,transaction:t}):(0,u.t1)(i),e&&H.sp({teamStore:e,store:d,transaction:t}))}return n}function de(e){const{type:t}=e;switch(t){case"space":case"space-private-pages":return;case"page":return e.spaceId?{id:e.id,table:"block",spaceId:e.spaceId}:void 0;case"collection":case"team":return e.spaceId?{id:e.id,table:t,spaceId:e.spaceId}:void 0;default:(0,u.t1)(t)}}},17659:(e,t,o)=>{o.d(t,{$h:()=>B,E1:()=>D,G7:()=>F,Jl:()=>T,Qy:()=>E,aY:()=>R,aZ:()=>A,go:()=>I,qQ:()=>N,rG:()=>M});var n=o(68626),r=o(91155),i=o(65311),a=o(5366),s=o(95477),l=o(33929),c=o(17652),d=o(74948),p=o(24646),u=o(19034),m=o(80444),g=o(45325),h=o(88923),f=o(35661),y=o(4761),v=o(50906),b=o(19719),S=o(54642),_=o(47307),w=o(99553),k=o(39699);const x=(0,a.defineMessages)({archiveError:{id:"notificationActions.archiveNotification.errorMessage",defaultMessage:"Failed to archive. Please try again."},setReadError:{id:"notificationActions.setRead.errorMessage",defaultMessage:"Failed to mark notification as read. Please try again."},setAllAsReadError:{id:"notificationActions.setAllAsRead.errorMessage",defaultMessage:"Failed to mark all notifications as read. Please try again."},setUnreadError:{id:"notificationActions.setUnread.errorMessage",defaultMessage:"Failed to mark notification as unread. Please try again."}});async function I(e){const t=y.ZP.state.currentTab,{currentSpaceStore:o}=m.default.state;if(o&&!s.default.isAdminMode&&(0,y.g0)(t)){try{await S.setNotificationsAsRead(e,{spaceId:o.id,timestamp:Date.now(),type:t})}catch(i){return _.showErrorMessage(l.default.formatMessage(x.setAllAsReadError)),void n.log({level:"error",from:"notificationActions",type:"setCurrentUpdatesTabAsRead",error:(0,r.Ui)(i)})}T(t,o.id,C.decrementToZero)}}const C={incrementByOne:e=>e+1,decrementByOne:e=>Math.max(e-1,0),decrementToZero:e=>0};function T(e,t,o){const{results:n}=u.Z.state,r=n.map((n=>{if(n.spaceId===t){const t=n.unread[e];return void 0===t?n:{...n,unread:{...n.unread,[e]:o(t)}}}return n}));u.Z.setState({results:r})}async function M(e,t,o){const{currentSpaceStore:i}=m.default.state;if(i&&!s.default.isAdminMode){try{for(;;){if(!(await P({environment:e,currentSpaceStore:i,inbox:t,readFilter:o})).more)break}}catch(a){return _.showErrorMessage(l.default.formatMessage(x.archiveError)),void n.log({level:"error",from:"notificationActions",type:"archiveAll",error:(0,r.Ui)(a)})}"read"!==o&&T(t,i.id,C.decrementToZero)}}async function P(e){const{environment:t,currentSpaceStore:o,inbox:i,readFilter:a}=e,s=await S.getUnvisitedNotificationIds(t,{spaceId:o.id,timestamp:Date.now(),type:i,size:500,readFilter:a});if("failed"===s.type)return _.showErrorMessage(l.default.formatMessage(x.archiveError)),n.log({level:"error",from:"notificationActions",type:"archiveApiError",error:(0,r.Ui)(s.error)}),{more:!1};const{notificationIds:c}=s.data;return await async function(e){const{environment:t,notificationIds:o,rootStore:n}=e,{serverCommitResult:r}=k.createAndCommit({userAction:"notificationActions.archiveNotificationIds",environment:t,canUndo:!0,undoCheckpoint:!0,perform:e=>{for(const t of o)D({transaction:e,rootStore:n,visited:!0,notificationId:t})}});await r}({environment:t,notificationIds:c,rootStore:o}),c.length>=500?{more:!0}:{more:!1}}function A(e){const{notification:t,rootStore:o,transaction:a}=e;if(!t.visited){try{D({notificationId:t.id,rootStore:o,transaction:a,visited:!0})}catch(s){return _.showErrorMessage(l.default.formatMessage(x.archiveError)),void n.log({level:"error",from:"notificationActions",type:"archiveNotification",error:(0,r.Ui)(s)})}if(!t.read){T(i.hE[t.type],t.space_id,C.decrementByOne)}}}function D(e){const{transaction:t,notificationId:o,rootStore:n,visited:r}=e,a=(0,f.Kv)(n,{table:i.uX,id:o});k.applyOperation({transaction:t,store:a,operation:{command:"update",pointer:{table:i.uX,id:o},path:[],args:r?{visited:!0,read:!0,archived_at:Date.now()}:{visited:!1,archived_at:null}}})}function B(e){const{transaction:t,notification:o,rootStore:a,read:s}=e;if(o.read===s)return;const c=(0,f.Kv)(a,{table:i.uX,id:o.id});try{k.applyOperation({transaction:t,store:c,operation:{command:"update",pointer:{table:i.uX,id:o.id},path:[],args:{read:s}}})}catch(d){return e.suppressErrorMessage||_.showErrorMessage(l.default.formatMessage(s?x.setReadError:x.setUnreadError)),void n.log({level:"error",from:"notificationActions",type:"setRead",error:(0,r.Ui)(d)})}T("mentions",o.space_id,s?C.decrementByOne:C.incrementByOne)}function R(){return u.Z.getUnreadCountForCurrentSpace().mentions}async function E(e){const{environment:t}=e,{currentSpaceStore:o}=m.default.state;if(!o)return[];const n=await S.getUnvisitedNotificationIds(t,{spaceId:o.id,timestamp:Date.now(),type:"mentions",size:100,readFilter:"unread"});return"failed"===n.type?[]:n.data.notificationIds}function F(e){let{environment:t,newTab:o,shouldTrack:n}=e;const r=y.ZP.state.currentTab;if(r!==o&&("mentions"===o?y.ZP.update((e=>({...e,currentTab:o,containsBothReadAndUnreadNotifications:!1,containsUnreadNotifications:!1,showOnlyUnreadNotifications:!1,unreadNotificationIds:[]}))):y.ZP.update((e=>({...e,currentTab:o})))),n){const e=t.device.isMobile;b.GP({environment:t,forceRestartSession:!1,from:"updates-tab-click"}),e&&v.nBz(t,{itemName:"updates"})}"mentions"===r&&async function(e){const t=(0,c.H)(),o=await S.getUserNotifications(e,{size:1e3,isInboxV2:t});if("failed"===o.type)return;const{results:n}=o.data;u.Z.setState({results:n})}(t)}function N(e){const{environment:t,open:o}=e;o?(g.ZP.setState({...g.ZP.state,openState:"opening",currentTab:g.ez[0]}),(0,p.Sx)(t)&&d.setUpdateExpand({environment:t,isExpanded:!1,from:"close_for_space"}),h.default.isSidePeekOpen()&&w.xv(t,"inbox_panel_expand")):g.ZP.setState({...g.ZP.state,openState:"closing"})}},36110:(e,t,o)=>{o.d(t,{V:()=>g,g:()=>m});var n=o(74181),r=o(56589),i=o(82036),a=o(89101),s=o(9852),l=o(64002),c=o(63143),d=o(54642),p=o(47307),u=o(75018);function m(e){const{environment:t,responseType:o,integrationId:n,redirectUri:r,state:i,owner:s,userId:d,spaceId:p}=e,m=l.bf({url:a._j.oauthAuthorization,query:(0,c.m8)(Object.entries({response_type:o,client_id:n,redirect_uri:r,state:i,owner:s,user_id:d,space_id:p}).filter((e=>{let[,t]=e;return t})))});u.navigate({environment:t,url:m,redirect:!0})}async function g(e){const{environment:t,params:o,integration:c}=e;s.setOauthAuthorizationParams(void 0);const m=c&&r._(c,o.redirectUri);if(!m)return void u.navigate({environment:t,url:a._j.root,redirect:!0});let h;if("errorType"in e)h={error:e.errorType,state:o.state};else{const{integration:r,spaceId:a,blockIdsForBot:s,acceptedIntegrationCapabilities:l}=e;let c;if(c=(0,n.VM)(r)?await d.createOauthAuthorizationCode(t,{integrationId:r.id,spaceId:a,redirectUri:o.redirectUri,acceptedIntegrationCapabilities:l}):await d.createOauthAuthorizationCode(t,{integrationId:r.id,spaceId:a,redirectUri:o.redirectUri,blockIdsForBot:s,templatePageId:e.templatePageId,acceptedIntegrationCapabilities:l}),"failed"===c.type){p.showError(c);return g({environment:t,params:o,integration:r,errorType:503===c.status?i._.temporarily_unavailable:i._.server_error})}h={code:c.data.code,state:o.state}}const f=l.bf({url:m,query:{...h}});u.navigateToExternalURL({environment:t,url:f,targetSelf:!0})}},15356:(e,t,o)=>{o.d(t,{M:()=>m});var n=o(29477),r=o(89101),i=o(64002),a=o(5366),s=o(95477),l=o(33929),c=o(77080),d=o(47307),p=o(47839);const u=(0,a.defineMessages)({allowPopup:{id:"authAction.authorize.popupBlocked",defaultMessage:"It looks like your browser is currently blocking popups. Please allow pop-ups to continue"},dismissButtonLabel:{defaultMessage:"Okay",id:"dialog.dismissButton.label"}});async function m(e,t){const{width:o,height:a,url:c,titleMessage:m}=t,h=l.default.formatMessage(m);if(e.device.isElectron)return p.openOauthPopup({width:o,height:a,url:c,title:h});const f=e.device.isMobile,y=void 0!==window.screenX?window.screenX:window.screenLeft,v=void 0!==window.screenY?window.screenY:window.screenTop,b=void 0!==window.outerWidth?window.outerWidth:document.documentElement.clientWidth,S=void 0!==window.outerHeight?window.outerHeight:document.documentElement.clientHeight-22,_=f?0:o,w=f?0:a;let k="toolbar=0,menubar=0,location=0";0!==_&&(k+=`,width=${_}`),0!==w&&(k+=`,height=${w}`),k+=`,left=${(y<0?window.screen.width+y:y)+(b-_)/2}`,k+=`,top=${v+(S-w)/2.5}`,k+=",scrollbars=1";const x=g()?(0,i.bf)({url:`${s.default.domainBaseUrl}${r._j.verifyNoPopupBlockerHtmlAndRedirect}`,query:{redirectUri:c}}):c,I=window.open(x,h,k);if(I)I.focus();else if(g())return void d.showDialog({showCancel:!1,keepFocus:!1,message:l.default.formatMessage(u.allowPopup),items:[{label:l.default.formatMessage(u.dismissButtonLabel),onAccept:()=>{}}]});const C=n.UZ(),T=e=>{if(e&&e.data&&"popup-callback"===e.data.type){const t=e.data.url;C.resolve(t)}},M=setInterval((()=>{const e=localStorage.getItem("externalAuthCallback");e?C.resolve(e):I&&I.closed&&C.resolve(void 0)}),300);window.addEventListener("message",T,!1);const P=await C.promise;return window.removeEventListener("message",T,!1),localStorage.removeItem("externalAuthCallback"),clearInterval(M),I&&I.close(),window.focus(),P}function g(){return"on"===c.default.getEligibleGroup({experimentId:"show_instruction_on_auth_popup_blocked",defaultGroup:"control"})}},89858:(e,t,o)=>{o.d(t,{A5:()=>ee,B8:()=>W,D0:()=>H,Eo:()=>X,LR:()=>J,NP:()=>Q,kC:()=>G,mv:()=>K,pq:()=>$,v9:()=>Y});o(21703),o(57658),o(67294);var n=o(15145),r=o(41432),i=o(15157),a=o(72126),s=o(27006),l=o(29369),c=o(5366),d=o(35683),p=o(65273),u=o(75770),m=o(35026),g=o(38755),h=o(95697),f=o(81844),y=o(74948),v=o(80444),b=o(55367),S=o(42330),_=o(35661),w=o(78291),k=o(34583),x=o(88893),I=o(73292),C=o(50906),T=o(48299),M=o(98834),P=o(47307),A=o(94419),D=o(13084),B=o(60870),R=o(11302),E=o(19785),F=o(76464),N=o(9953),j=o(75018),O=o(29974),L=o(28014),U=o(150),Z=o(39699),V=o(68422),q=o(1742),z=o(85893);function W(e,t){return`${e.id}:${t}`}function H(e){var t;const{environment:o,store:i,transaction:a,navigateToParent:s}=e,l=N.j4({environment:o,type:r.Ti.page,inMemoryRecordCache:i.inMemoryRecordCache,transaction:a,spaceId:i.isCollectionView()?null===(t=i.getCollectionViewCollectionStore())||void 0===t?void 0:t.pointer.spaceId:i.pointer.spaceId,useCrdt:!1}),c=i.getAssociatedCollectionStore();if(i.isCollectionView()){const e=i.getCollectionViewCollectionStore()||c;if(!e)throw new Error("getCollectionViewCollectionStore() returned undefined");if(!E.zw({parentStore:e,childStore:l,transaction:a}))throw new Error("parentChildActions.moveToCollection() returned false");const t=e.getDefaultTemplatePageStore();t&&M.ob({title:"template",environment:o,store:l,templateStore:t,isKeyboard:!1,isCreateIn:!1,transaction:a,from:"outliner_actions"})}i.isCollectionView()||E.jG({parentStore:i.getContentStore(),childStore:l,transaction:a}),S.ZP.setState({...S.ZP.state,lastPageId:v.default.state.mainEditorCurrentBlockStore?v.default.state.mainEditorCurrentBlockStore.id:void 0}),o.device.isMobile?j.navigateToBlock({environment:o,store:l,showMoveTo:!1,saveParent:!1,visitType:d.vu.Link,pageVisitSource:n.tY.Create}):j.peekBlock({environment:o,store:l,showMoveTo:!0,saveParent:!1,currentBlockStore:s?i:void 0,peekMode:void 0,resultsStore:void 0,collectionContextStore:void 0,pageVisitSource:n.tY.Create}),C.W2j(o,{from:"sidebar_outliner_item",type:"page",new_page_id:l.id})}async function G(e){const{environment:t,spaceStore:o,spaceViewStore:r,type:i,prepend:a,outlinerToggleButtonStore:s,shouldPersistToggleState:l,title:p,useCrdt:u}=e,m=new q.sA(t,"createPageInSection");if(k.M_(t)){if("workspace"===i){const{data:e}=w.default.state,t=e?(0,x.su)(e):1;if(t>=10){if(!(await P.confirmUserAction({message:(0,z.jsx)("span",{children:(0,z.jsx)(c.FormattedMessage,{defaultMessage:"Are you sure you want to create a new top-level page? <strongtext>This page will be visible in the sidebar to all {memberCount} members of your workspace.</strongtext>",id:"sidebarActions.confirmDialog.newWorkspacePage.message",values:{strongtext:e=>(0,z.jsx)("strong",{children:e}),memberCount:t}})}),acceptLabel:(0,z.jsx)(c.FormattedMessage,{defaultMessage:"Create top-level page",id:"sidebarActions.confirmDialog.newWorkspacePage.confirmButton.label"})})))return null}}const{serverCommitResult:e,performResult:{createdPage:g}}=Z.createAndCommit({userAction:"outlinerActions.createPageInSection",environment:t,perform:e=>{const n=L.KE({environment:t,spaceStore:o,spaceViewStore:r,isPrivate:"private"===i,prepend:a,transaction:e,title:p,tracker:m,useCrdt:u});return s&&X({environment:t,spaceViewStore:r,type:i,outlinerToggleButtonStore:s,newIsHidden:!1,shouldPersistToggleState:Boolean(l)}),t.device.isMobile&&y.close(),{createdPage:n}}});"private"===i?C.W2j(t,{from:"sidebar_private_section",type:"page",new_page_id:g.id}):"workspace"===i&&C.W2j(t,{from:"sidebar_workspace_section",type:"page",new_page_id:g.id});const h=o.getDisableSpacePageEdits();return"workspace"===i&&h&&await e,j.navigateToBlock({environment:t,store:g,visitType:d.vu.Link,pageVisitSource:n.tY.Create}),g}}async function K(e){const{environment:t,spaceStore:o,spaceViewStore:r,teamStore:i,andNavigate:a,from:s,outlinerToggleButtonStore:l,shouldPersistToggleState:c,title:p,loading:u,appendOrPrepend:m}=e,{serverCommitResult:g,performResult:{createdPage:h}}=Z.createAndCommit({userAction:"outlinerActions.createPageInTeam",environment:t,perform:e=>({createdPage:$({environment:t,spaceStore:o,spaceViewStore:r,teamStore:i,from:s,title:p,loading:u,appendOrPrepend:m,transaction:e})})});return await g,a&&j.navigateToBlock({environment:t,store:h,visitType:d.vu.Link,pageVisitSource:n.tY.Create}),l&&I.k7({environment:t,spaceViewStore:r,teamStore:i,outlinerToggleButtonStore:l,newIsHidden:!1,shouldPersistToggleState:Boolean(c),isExplicitUserAction:!1}),h}function $(e){const{environment:t,spaceStore:o,spaceViewStore:n,teamStore:r,from:i,title:a,loading:s,appendOrPrepend:c,transaction:d}=e;if(!(0,m.si)({teamStore:r,environment:t}))throw new Error("User is not eligible to create top-level page in team");const p=L.KE({environment:t,spaceStore:o,spaceViewStore:n,isPrivate:!1,prepend:!1,title:a,loading:s,transaction:d});C.tPt(t,{teamStore:r,from:i,pageId:p.id,transaction:d}),F.u9({store:p,transaction:d});const g=(0,u.uw)({type:"team",id:r.id});if(g.table!==l.e0)throw new Error("Assertion failure, moveToStore table is not TeamTable!");return R.at({environment:t,transaction:d,action:"add",teamStore:g,currentSpaceViewStore:n,targets:[p],value:{type:"team",id:r.id},location:{type:c}}),p}async function Y(e){var t,o;const{environment:n,droppedStores:i,droppedDirection:a,type:l,targetStore:d,targetParentStore:m}=e,h=await(0,u.ed)({environment:e.environment,blocks:i,from:"dragAndDrop",dropArgs:{direction:a,destination:d,destinationOutlinerType:l}});if(!h.confirmed)return;const{shouldClearPagePermissions:y}=h;if(1===i.length&&(null===(t=m.getValue())||void 0===t||null===(o=t.includes)||void 0===o||!o.call(t,i[0].id))){let e=[];for(const o of i)if(e=await T.NN({environment:n,block:o,action:"move"}),"user_canceled"===e)return;const t=i[0].id;for(const o of e)o.id!==t&&i.push(o)}const S=Object.fromEntries(i.map((e=>[e.id,e.getParentId()]))),{performResult:{moved:k}}=await Z.createAndCommitAsync({environment:n,userAction:"outlinerActions.confirmAndHandleDrop",waitForServerCommit:!0,perform:async t=>({moved:await async function(e){const{environment:t,type:o,droppedDirection:n,targetStore:i,targetParentStore:a,droppedStores:l,transaction:d,isTopLevelItem:m,shouldClearPagePermissions:h}=e,y=function(e){for(const t of e){const e=f.Z.findOutlinerItemFromStore(t);if(e)return e.type}}(l),{currentSpaceStore:S,currentUserStore:k}=v.default.state,I=null==S?void 0:S.id,{data:C}=w.default.state,T="bookmarks"===y&&"bookmarks"===o,M=te(e),A=I&&l.some((e=>e.isTopLevelWorkspacePage(I))),R=i&&I&&i.isTopLevelWorkspacePage(I),E=null==S?void 0:S.getDisableSpacePageEdits();if(I&&E&&(A||R)&&!T&&n!==b.vh.Onto&&null!=k&&k.isDefined()&&C){const e=(0,x.hn)(C).filter((e=>e.userId===k.id))[0];if(e&&!s.zz(e.role))return P.showErrorMessage((0,z.jsx)(c.FormattedMessage,{defaultMessage:"This workspace has locked top-level workspace page operations.",id:"sidebarActions.confirmDialog.lockedWorkspaceTopLevel.message"})),!1}const F=function(e){let{targetStore:t,targetParentStore:o}=e;if(t)return t;const{id:n,table:r}=o;let i;switch(r){case"space":case"space_view":i={type:"space",id:n};break;case"block":i={type:"page",id:n};break;case"team":i={type:"team",id:n};break;default:throw new Error("Unexpected table type")}return(0,u.uw)(i)}({targetStore:i,targetParentStore:a});if(function(e){const{droppedDirection:t,targetStore:o,droppedStores:n,targetParentStore:r}=e,i=t===b.vh.Onto?o:r.getRecordStoreAtRootPath();if(!(i instanceof _.G))return!1;return(0,p.iG)(i,n)}(e))return P.deprecatedShowErrorMessage("Cannot move a CRDT block into a non-CRDT parent or vice versa!"),!1;if(!T&&!M){if("user_cancelled_move"===await U.Hl({transaction:d,moveStores:l,moveTargetStore:F}))return!1}B.eX({environment:t,transaction:d,moveToStore:F,targetBlocks:l,from:"drag_and_drop"});const j=function(e){const{environment:t,type:o,targetStore:n,targetParentStore:i,droppedDirection:a,droppedStores:s,duplicate:l,transaction:c}=e,{currentSpaceViewStore:d,currentSpaceStore:p,currentUserSettingsStore:u}=v.default.state;let m;const h=null==n?void 0:n.getModel();if(a===b.vh.Onto&&n&&i&&null!=h&&h.isType(r.m3))m=D.LQ({environment:t,targetParentStore:i,targetStore:n,droppedDirection:b.vh.Below,droppedStores:s,duplicate:l,transaction:c});else if(te(e)&&n){if(!d||!u)throw new Error("currentSpaceViewStore or currentUserSettingsStore not found");const{visibleSharedPagesStores:e}=(0,g.MC)({environment:t,spaceViewStore:d,userSettingsStore:u}).state,o=e.map((e=>e.id)),r=s.map((e=>e.id)),i=o.filter((e=>r.indexOf(e)<0)),l=i.findIndex((e=>e===n.id));let p=[];p=a===b.vh.Above?[...i.slice(0,l),...r,...i.slice(l)]:[...i.slice(0,l+1),...r,...i.slice(l+1)],N.sW({store:d,data:{shared_pages:p},transaction:c}),m=s}else"private"===o&&p&&d&&L.OQ({environment:t,spaceStore:p,spaceViewStore:d,transaction:c}),m=D.LQ({environment:t,targetParentStore:i,targetStore:n,droppedDirection:a,droppedStores:s,duplicate:l,transaction:c});return m}(e),Z=j.filter((e=>e.isTopLevel()));h&&O.O2({blocks:j,transaction:d});"workspace"===o?O.lF({environment:t,blocks:Z,transaction:d}):"private"===o&&O.IY({environment:t,blocks:Z,transaction:d});m&&n!==b.vh.Onto&&V._w({environment:t,blocks:l,transaction:d});return!0}({...e,transaction:t,shouldClearPagePermissions:y})})});k&&B.wS({environment:n,movedItems:i,previousParentIds:S,moveToLocation:(0,u.vz)({targetStore:d,droppedDirection:a,outlinerSectionType:l,environment:n})})}async function Q(e){const{droppedStores:t,duplicate:o}=e.dropArgs,{environment:n,type:r,isTopLevel:i,parentStore:a}=e,s=b.vh.Below;return!!a&&(await Y({environment:n,type:r,targetParentStore:a,isTopLevelItem:i,droppedDirection:s,droppedStores:t,duplicate:o}),!0)}function J(e){const{environment:t,store:o,parentStore:n,insertStores:r,transaction:i,before:s,type:l}=e,{currentSpaceViewStore:c,currentSpaceStore:d}=v.default.state,p=a.d9(r).reverse();"private"===l&&d&&c&&L.OQ({environment:t,spaceStore:d,spaceViewStore:c,transaction:i});const u=s?r.map((e=>A.Vt({parent:n,insert:e,before:o,transaction:i}).child)):p.map((e=>A.BE({parent:n,insert:e,after:o,transaction:i}).child)),m=u.filter((e=>e.isTopLevel()));return"workspace"===l?O.lF({environment:t,blocks:m,transaction:i}):"private"===l&&O.IY({environment:t,blocks:m,transaction:i}),u}function X(e){const{environment:t,spaceViewStore:o,type:n,outlinerToggleButtonStore:r,newIsHidden:a,shouldPersistToggleState:s}=e;r.setState({...r.state,isHidden:a}),C.VSH(t,{is_toggled:!a,outliner_type:n}),s&&i.Z.set({userId:o.environment.currentUser.id,key:W(o,n),value:a})}function ee(e){const{type:t,targetStore:o,targetParentStore:n,transaction:r,isTopLevelItem:i}=e,a=(0,h.bq)()&&"team"===t&&n.table===l.e0&&i;if(A.Od({childToRemove:o,parent:n,transaction:r}),a&&o.getParentId()===n.id){const t=_.zX.createChildStore(e.targetParentStore,{...e.targetParentStore.pointer,table:l.e0});U.sp({teamStore:t,store:o,transaction:r})}}function te(e){let{type:t,droppedDirection:o,isTopLevelItem:n}=e;return"shared"===t&&o!==b.vh.Onto&&n}},65889:(e,t,o)=>{o.d(t,{I:()=>n,O:()=>r});const n=function(e){const{key:t,overlayContainerStore:o}=e;o.state.overlays.has(t)||(o.state.overlays.add(t),o.emit())},r=function(e){const{key:t,overlayContainerStore:o}=e;o.state.overlays.has(t)&&(o.state.overlays.delete(t),o.emit())}},72711:(e,t,o)=>{o.d(t,{Y_:()=>x,bo:()=>C,hc:()=>k,ru:()=>I,tk:()=>T});o(21703);var n=o(1302),r=o(41432),i=o(72126),a=o(4615),s=o(21202),l=o(6287),c=o(19889),d=o(78316),p=o(84210),u=o(89014),m=o(58202),g=o(80444),h=o(35661),f=o(26664),y=o(52229),v=o(96802),b=o(94419),S=o(9953),_=o(75018),w=o(39699);const k=function(e){const{environment:t,store:o,targetStore:n,transaction:r}=e,i=o.getParentBlockStore();if(i){const e=i.getContentStore(),a=y.k({environment:t,parentBlock:i,targetStore:n,transaction:r});return b.rS({parent:e,oldChild:o,newChild:a,transaction:r}).child}throw new Error("Could not create alias block.")};function x(e){const{environment:t,store:o,collectionStore:i,collectionViewStore:p,transaction:g}=e,{id:y}=t.currentUser,v=o.getRecordStoreUIParent();if(null!=v&&v.valueIs(f.i)){if(!o.isDefined())throw new Error("Block to replace was not defined.");if(v&&y){var _,w;const e=Date.now(),f=(0,a.ZP)(),k=null===(_=(0,d.Vv)(i))||void 0===_?void 0:_.getFormatStore().getKeyStore("table_properties").getValue(),x=null===(w=(0,d.Vv)(i))||void 0===w||null===(w=w.getQueryStore())||void 0===w?void 0:w.getKeyStore("sort").getValue(),I={id:(0,a.ZP)(),version:0,type:"table",parent_id:f,parent_table:"block",alive:!0,space_id:o.getSpaceId(),format:{table_properties:k,collection_pointer:{table:l.v,id:i.id,spaceId:i.pointer.spaceId}},query2:{sort:x}};S.ae({environment:t,table:"collection_view",value:I,inMemoryRecordCache:o.inMemoryRecordCache,transaction:g});const C={id:f,type:r.Ti.collectionView,view_ids:[I.id],properties:{},parent_id:v.id,parent_table:"block",alive:!0,created_by_table:c.KJ,created_by_id:y,created_time:e,last_edited_by_table:c.KJ,last_edited_by_id:y,last_edited_time:e,space_id:o.getSpaceId()};S.ae({environment:t,table:"block",value:C,inMemoryRecordCache:o.inMemoryRecordCache,transaction:g});const T=b.rS({parent:v,oldChild:o,newChild:h.G.createChildStore(v,{table:s.iU,id:f}),transaction:g}).child;return(0,u.u)(I.id,{viewPointer:null==p?void 0:p.pointer}),n.default.afterNextFlush((()=>{const e=m.R.findBlockFromStoreWithMethod(T,"handleCreated");e&&e.handleCreated()})),T}}}function I(e){const{environment:t,blocks:o,openInNew:n,pageVisitSource:r}=e,i=o[0];if(n){const e=(0,p.ZP)({store:i,pageVisitSource:r});_.navigate({environment:t,url:e,openInNew:n})}else{const e=i.recordStoreUIParentStore instanceof h.G&&i.recordStoreUIParentStore.isCollectionView(),{mainEditorCurrentBlockStore:o}=g.default.state;if(e&&o){const e=(0,p.ZP)({store:o,fullyQualified:!1,peekViewBlockId:i.id,pageVisitSource:r});_.navigate({environment:t,url:e})}else _.navigateToBlock({environment:t,store:i,pageVisitSource:r})}}function C(e){const{environment:t,store:o,lock:n}=e,{id:r}=t.currentUser;if(!r)return;const i={block_locked:n,block_locked_by:r};w.createAndCommit({userAction:"pageBlockActions.setPageLock",environment:t,perform:e=>{S.sW({store:o.getFormatStore(),data:i,transaction:e})}})}function T(e){const{transaction:t,store:o,coverStore:n,pageCovers:r}=e,a=Object.keys(r),s=r[a[i.MX(0,a.length-1)]],l=s.items[i.MX(0,s.items.length-1)],c=l.coverUrl,d=l.position;S.sO({store:n,value:c,transaction:t}),v.Mp({store:o,coverPosition:d,transaction:t})}},30581:(e,t,o)=>{o.d(t,{P:()=>a});var n=o(55320),r=o(50906),i=o(54642);function a(e,t,o){r.Pu8(t,{page_id:e.id,searchSessionId:n.default.state.sessionId,spaceId:e.getSpaceId(),pageVisitId:o.getCurrentPageVisitId()}),i.recordPageExit(t,{block:{id:e.id,spaceId:e.getSpaceId()},timestamp:Date.now()})}},25320:(e,t,o)=>{o.d(t,{Ri:()=>y,UX:()=>f,s4:()=>h});var n=o(72126),r=o(21202),i=o(70017),a=o(89470),s=o(23867),l=o(97880),c=o(67669),d=o(65598),p=o(80444),u=o(5315),m=o(35661),g=o(54642);const h=100;async function f(e,t){await p.default.waitUntilRendered();const{fromPageRefresh:o,block:n,pageVisitStore:l,timestamp:h}=t,f=e.currentUser.id;if(void 0===f||o)return;t.block.id!==l.state.pageId&&l.setState({...l.getInitialState(),pageId:t.block.id});const y=(0,m.Kv)(n,{table:a.UI,id:(0,a.Pv)({parent_id:n.id,user_id:f}),spaceId:(0,s.C)(n.pointer.spaceId)}),b=(0,m.Kv)(n,{table:i.Kk,id:(0,a.Pv)({parent_id:n.id,user_id:f}),spaceId:(0,s.C)(n.pointer.spaceId)});if(await u.transactionQueue.awaitRecordTransaction({table:r.iU,id:n.id}),await(0,d.M1)(n),!n.canRead()||(0,c.IJ)(e,n))return;await y.load(),await b.load();const S=y.getKeyStore("visited_at").getValue(),_=b.getKeyStore("exited_at").getValue(),w=await async function(e,t,o,n){const{id:r}=e.currentUser;var i;r&&(null==e||null===(i=e.mobileNative)||void 0===i||i.recordPageVisit(r,{blockId:t,spaceId:o,visitedAt:n}));return await g.recordPageVisit(e,{block:{id:t,spaceId:o},timestamp:n})}(e,n.id,(0,s.C)(n.pointer.spaceId),h);if("failed"===w.type)return;const k=v({pageVisits:w.data.pageVisits,omittedUserIds:[],currentState:l.state,block:n});l.state.pageId===n.id&&l.setState({...k,lastViewTime:S,lastExitTime:_})}async function y(e,t){await p.default.waitUntilRendered();const o=e.currentUser.id;if(void 0===o)return;const{block:r,pageVisitStore:i,incremental:a}=t,c=t.limit||32;let d;if(a){const{pageId:e,lastViewTime:t,lastExitTime:r,omittedUserIds:a,...s}=i.state,c=Object.entries(s).map((e=>{let[t,n]=e;if(o===t)return;const r=n.getVisitedAt();return void 0!==r?r+1:void 0}));d=n.Fp(c.filter(l.$K))}const u=await g.getPageVisitors(e,{block:{id:r.id,spaceId:(0,s.C)(r.pointer.spaceId)},sinceTimestamp:d,limit:c});if("failed"===u.type)return;const m=v({pageVisits:u.data.pageVisits,omittedUserIds:u.data.omittedUserIds,block:r,currentState:i.state});let f;if(Object.keys(m).length<=h)f=m;else{const{pageId:e,lastViewTime:t,lastExitTime:o,omittedUserIds:r,...i}=m,a=(0,l.qP)(i).map((e=>{let[t,o]=e;return[t,o.getVisitedAt()??0]}));f={pageId:e,omittedUserIds:r,lastViewTime:void 0,lastExitTime:void 0};const s=n.MR(a,(e=>{let[,t]=e;return-t})).slice(0,h);for(const[n]of s)f[n]=m[n]}i.state.pageId===m.pageId&&i.setState(f)}function v(e){const{block:t,pageVisits:o,currentState:n,omittedUserIds:r}=e,i={...n,pageId:t.id,omittedUserIds:[...n.omittedUserIds,...r]};for(const l of o){const{id:e,user_id:o}=l;o in i||(i[o]=m.t1.createChildStore(t,{table:a.UI,id:e,spaceId:(0,s.C)(t.pointer.spaceId)}))}return i}},19785:(e,t,o)=>{o.d(t,{SH:()=>m,hh:()=>c,hr:()=>p,jG:()=>u,nO:()=>d,rS:()=>g,zo:()=>l,zw:()=>s});o(21703);var n=o(79317),r=o(65598),i=o(9953),a=o(39699);const s=e=>{const{childStore:t,parentStore:o,transaction:n}=e,r=t.getRecordStoreAtRootPath().getValue(),i=o.getParentBlockStore();if(i&&i.isCollectionViewPageWithContent())return u({parentStore:i,childStore:t,transaction:n}),!0;if(r){const{parent_id:e,parent_table:i,alive:s}=r;if(e!==o.id||i!==o.table||!s)return a.applyOperation({store:o,operation:{pointer:t.pointer,path:[],command:"setParent",args:{parentId:o.id,parentTable:o.table}},transaction:n}),!0}return!1},l=e=>{const{block:t,transaction:o}=e,r=t.getParentStore();if(r){(0,n.A6)(r.table,t.table)?p({parentStore:r,childStore:t,transaction:o}):c({childStore:t,transaction:o})}},c=e=>{const{childStore:t,transaction:o}=e;if((0,r.OY)(t)){const e=t,n=e.getAssociatedCollectionStore();if(null!=n&&n.isPageTreeCollection()){const n=t.getParentBlockStore();n&&p({childStore:e,parentStore:n,transaction:o})}}t.getRecordStoreAtRootPath().getAlive()&&i.sW({store:t,data:{alive:!1},transaction:o})},d=e=>{const{pageStore:t,transaction:o}=e;t.getRecordStoreAtRootPath().getAlive()&&i.sW({store:t,data:{alive:!1},transaction:o})},p=e=>{const{childStore:t,parentStore:o,transaction:r}=e,i=(0,n.A6)(o.table,t.table);if(!i)throw new Error(`Could not find child path for parent table ${o.table} and child table ${t.table}`);a.applyOperation({store:o,operation:{pointer:o.pointer,path:i,command:"removeChild",args:{id:t.id}},transaction:r})},u=e=>{const{childStore:t,parentStore:o,transaction:r}=e,i=(0,n.A6)(o.table,t.table);if(!i)throw new Error(`Could not find child path for parent table ${o.table} and child table ${t.table}`);a.applyOperation({store:o,operation:{pointer:o.pointer,path:i,command:"insertChildrenAfter",args:{ids:[t.id],after:e.after}},transaction:r})},m=e=>{const{childStore:t,parentStore:o,transaction:r}=e,i=(0,n.A6)(o.table,t.table);if(!i)throw new Error(`Could not find child path for parent table ${o.table} and child table ${t.table}`);a.applyOperation({store:o,operation:{pointer:o.pointer,path:i,command:"insertChildrenBefore",args:{ids:[t.id],before:e.before}},transaction:r})},g=function(e){const{parentStore:t,oldChildStore:o,newChildStore:n,transaction:r}=e,i=o.id;(t.getValue()||[]).indexOf(i)>=0&&(u({parentStore:t,childStore:n,transaction:r,after:i}),p({parentStore:t,childStore:o,transaction:r}))}},19358:(e,t,o)=>{o.d(t,{D0:()=>f,If:()=>y,YM:()=>h});o(57658);var n=o(73360),r=o(18844),i=o(21202),a=o(6287),s=o(70279),l=o(91644),c=o(15047),d=o(77858),p=o(29369),u=o(66079),m=o(65273),g=o(9953);function h(e){const{childStore:t,parentStore:o,transaction:n}=e,r=t.getRecordStoreAtRootPath().getValue();if(r){const{parent_id:i,parent_table:a,alive:s}=r;i===o.id&&a===o.table&&s===e.alive||(g.sW({store:t,data:{parent_id:o.id,parent_table:o.table,alive:e.alive},transaction:n}),n.postPerformAssertions.push((()=>{(0,m.be)({parentStore:o,childStore:t})})))}}function f(e){if((0,n.hL)(e.childStore.table)){const t=e.childStore;return function(e){const{childStore:t,parentStore:o,transaction:n}=e,m=t.getRecordStoreUIParent();if(o.table===c.bx&&t.table===i.iU||o.table===p.e0&&t.table===i.iU||o.table===u.dx&&t.table===d.zU||o.table===r.Xj&&t.table===i.iU||o.table===l.AT&&t.table===i.iU)h({childStore:t,parentStore:o,alive:!0,transaction:n});else if(o.table===d.zU&&o.path&&"private_pages"===o.path[0]&&t.table===i.iU){const e=o.getRecordStoreUIParent().getSpaceStore();e&&h({childStore:t,parentStore:e,alive:!0,transaction:n})}else o.table===i.iU&&m&&m.table===d.zU&&m.path&&"private_pages"===m.path[0]?h({childStore:t,parentStore:o,alive:!0,transaction:n}):o.table!==i.iU&&o.table!==a.v&&o.table!==s.x_||h({childStore:t,parentStore:o,alive:!0,transaction:n})}({...e,childStore:t})}{const{childStore:t,parentStore:o,transaction:n}=e,{parent_id:r,parent_table:i}=t.getValue()||{};r===o.id&&i===o.table||g.sW({store:t,data:{parent_id:o.id,parent_table:o.table},transaction:n})}}function y(e){const{childStore:t,parentStore:o,transaction:n}=e,{parent_id:r,parent_table:i,alive:a}=t.getValue()||{},s=o.table===d.zU&&o.path&&"private_pages"===o.path[0]&&a,l=r===o.id&&i===o.table&&a;(s||l)&&g.sW({store:t,data:{alive:!1},transaction:n})}},99553:(e,t,o)=>{o.d(t,{Af:()=>I,E5:()=>T,ME:()=>A,Om:()=>D,Xd:()=>B,bA:()=>x,jG:()=>C,xv:()=>P});o(57658);var n=o(15145),r=o(28020),i=o(78316),a=o(84210),s=o(74948),l=o(38676),c=o(80444),d=o(22294),p=o(45325),u=o(88923),m=o(86486),g=o(27724),h=o(29370),f=o(24666),y=o(50906),v=o(94419),b=o(17659),S=o(75018),_=o(39699),w=o(39865),k=o(37181);function x(e,t){const{mode:o}=t,n=e.WindowSizeStore.state.width,r=u.default.state.preferredSidePeekWidth||n/2;u.default.setState({...u.default.state,open:!0,preferredSidePeekWidth:Math.min(r,n/1.5),isOpening:!0,isClosing:!1,...t}),o===u.PeekModeSide&&s.toggleLeftSidebarByWindowSize(e),p.ZP.isOpen()&&b.qQ({environment:e,open:!1})}function I(e){const{resultsStore:t,collectionContextStore:o}=e;null==o||o.searchOpen.setState(!1),u.default.setState({...u.default.state,resultsStore:t,collectionContextStore:o})}function C(e){(u.default.isSidePeekOpen()||u.default.isCenterPeekOpen())&&M(e)}function T(e){u.default.isSidePeekOpen()&&M(e)}function M(e){r.kw.state&&!d.Z.state.isKeyboardMode||m.default.state.isOpen&&m.default.state.menuIsOpen||g.default.isSelected()||f.default.hasSelection()||P(e,"empty_space_click")}function P(e,t,o){const r=u.default.state;if(!r.open||r.isClosing)return;u.default.isSidePeekOpen()&&(u.default.setState({...r,isClosing:!0}),D({environment:e,seen:!0}));const{mode:i,target:s,showMoveTo:d,collectionContextStore:p,savedSelectionStoreState:m,savedTableSelectionStoreState:f,savedSidebarExpandedStoreState:b}=r,k=s.getContentStores(),x=1===k.length?k[0]:void 0,I=x&&x.isEmptyEditableBlock(),C=d&&s.isEmptyTitle()&&(s.isEmptyPage()||I);_.createAndCommit({userAction:"PeekRenderer.close",environment:e,perform:t=>{C?(w.y8({environment:e,blocks:[r.target],transaction:t}),t.postSubmitCallbacks.push((t=>{t||y.dhV(e,{analyticsName:"delete",from:"peek_actions",block_id:s.id,block_type:"page"})}))):I&&v.Od({parent:s.getContentStore(),childToRemove:x,transaction:t})}}),t&&"side_peek"===i&&y.vcz(e,{from:t}),y.$CH(e,{peek_mode:i,from:t,target_page_id:s.id,target_parent_id:s.getParentId(),page_source:o,should_delete:C}),S.resetPeekState(e,i),S.resetSidebarState(e),S.resetEditorState(e),g.default.setState({...g.default.state,...m}),f.isActive&&h.Z.setState(f),b&&l.gV.setState(!0);const{mainEditorCurrentBlockStore:T}=c.default.state,{RouterStore:M}=e,P=M.state.route;if(null!=p&&p.searchQuery.state&&(null==p||p.searchOpen.setState(!0)),T&&"page"===P.name){const t=(0,a.ZP)({store:T,fullyQualified:!1,scrollToBlockId:P.scrollToBlockId,collectionViewId:P.collectionViewId,discussionId:P.discussionId,showMoveTo:P.showMoveTo,saveParent:P.saveParent,pageVisitSource:n.tY.PeekClose});S.navigate({environment:e,url:t})}}function A(){const e=u.default.state;e.open&&!e.isClosing&&u.default.setState({...e,open:!1,resultsStore:void 0,collectionContextStore:void 0})}function D(e){const{environment:t,seen:o}=e,{currentUserSettingsStore:n}=c.default.state;n&&_.createAndCommit({userAction:"peekActions.setSeenPeekModeIntroTooltip",environment:t,perform:e=>{k.d2({userSettingsStore:n,transaction:e,data:{seen_peek_mode_tooltip:o}})}})}function B(e){const{collectionContextStore:t,resultsStore:o}=e;(0,i.YG)(null==t?void 0:t.collectionViewStore())||I({collectionContextStore:t,resultsStore:o})}},76464:(e,t,o)=>{o.d(t,{GQ:()=>ie,Kh:()=>ee,MX:()=>J,Pk:()=>Q,ep:()=>K,hs:()=>X,n_:()=>ne,u9:()=>se});o(57658);var n=o(1302),r=o(66897),i=o(59730),a=o(24211),s=o(72126),l=o(63306),c=o(26825),d=o(27006),p=o(4615),u=o(77420),m=o(84683),g=o(15047),h=o(29369),f=o(19889),y=o(94044),v=o(64684),b=o(97880),S=o(5366),_=o(15010),w=o(33954),k=o(33929),x=o(98165),I=o(67669),C=o(45101),T=o(65598),M=o(38755),P=o(95697),A=o(18245),D=o(28578),B=o(80444),R=o(35661),E=o(78291),F=o(34583),N=o(70060),j=o(88893),O=o(35057),L=o(9867),U=o(50906),Z=o(91536),V=o(54642),q=o(47307),z=o(9953),W=o(29974),H=o(39699);const G=(0,S.defineMessages)({preventFullPageAccessDeletion:{id:"permissionsActions.preventRemovingAllFullAccess.message",defaultMessage:"Please give someone else Full Access before removing this permission."},preventUserOrGroupDeletion:{id:"permissionsActions.preventUserOrGroupDeletion.message",defaultMessage:"At least one person or group must have access."},confirmUpgradeMessage:{defaultMessage:"To add members to your workspace, you need to switch it to the Team plan. You will be charged a prorated amount based on your current billing interval and account balance.",id:"permissions.confirmDialog.upgradeToTeamWorkspace.message"},confirmUpgradeButtonLabel:{defaultMessage:"Upgrade to Team workspace",id:"permissions.confirmDialog.upgradeToTeamWorkspace.confirmButton.label"}});function K(e){const{environment:t,store:o,permissionItems:r,transaction:i,from:a,skipAnalytics:l,pagePermissionChangeLocation:p,fromPermissionWrapper:u}=e;if((0,I.Kz)(e))return!1;if(!o.isDefined())return!1;const m=o.getPermissionItems();let h=[...m];const{id:f}=t.currentUser,y=o instanceof R.H2,S=o instanceof R.G&&o.getParentTable()===g.bx,_=o instanceof R.G&&(S||o.isRestricted());l||(o instanceof R.G?Z.kM({environment:t,store:o,newItems:r,location:p,inSudoMode:i.useSudoMode,fromPermissionWrapper:u}):r.forEach((e=>{y?U.dE3(t,e,{from:a}):o instanceof R.zX?U.gRe(t,{item:e,teamStore:o}):(0,b.t1)(o)}))),h=h.filter((e=>!r.some((t=>c.Kf(e,t)))));for(const n of r)h.push(n);h=h.filter((e=>"none"!==d.cY(e)));const w=Boolean(r.find((e=>"user_permission"===e.type&&e.user_id===f&&!d.zz(e.role))));if(o instanceof R.G&&_&&f){const e=x.Pj(o),t=e?(0,M.jv)(e):[],n=e?e.getPermissionGroups():[],a=Boolean(h.find((e=>"user_permission"===e.type&&d.zz(e.role)&&e.user_id===f))),s=x.VP(o),l=null==s?void 0:s.getMembers(),c=void 0!==l&&(0,v.pd)({membership:l},f),p=e&&s&&(0,P.AL)({teamStore:s,spaceStore:e,userId:f}),u=t.find((e=>"user_permission"===e.type&&e.user_id===f)),m=r.find((e=>"space_permission"===e.type&&d.zz(e.role))),g=r.find((e=>"space_permission"===e.type&&d.YX(e.role))),y=r.find((e=>"space_permission"===e.type&&!d.YX(e.role))),b=h.find((e=>Boolean("group_permission"===e.type&&d.zz(e.role)&&n.find((t=>Boolean(t.id===e.group_id&&t.user_ids&&t.user_ids.indexOf(f)>=0)))))),S=(0,P.bq)();if(e&&e.canEdit()&&!S){const t=e.getPagesStore();g?H.applyOperation({transaction:i,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:o.id}}}):y&&H.applyOperation({transaction:i,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:o.id}}})}if(!S&&a&&u&&(m||b)&&(h=h.filter((e=>!("user_permission"===e.type&&e.user_id===f)))),!w){h.some((e=>!("space_permission"!==e.type||!d.zz(e.role)||!u)||(!("user_permission"!==e.type||!d.zz(e.role)||e.user_id!==f)||(!("group_permission"!==e.type||!d.zz(e.role)||!n.find((t=>Boolean(t.id===e.group_id&&t.user_ids&&t.user_ids.indexOf(f)>=0))))||(!!((0,d.zU)(e)&&d.zz(e.role)&&(null==s?void 0:s.id)===e.team_id&&p)||!!((0,d.LW)(e)&&d.zz(e.role)&&(null==s?void 0:s.id)===e.team_id&&c))))))||i.useSudoMode||(h=h.filter((e=>!("user_permission"===e.type&&e.user_id===f))),h.push({type:"user_permission",user_id:f,role:"editor"}))}}if(!h.some((e=>{const t=d.cY(e);return d.zz(t)}))&&(y||_))return n.default.afterNextFlush((()=>{q.showErrorMessage(k.default.formatMessage(G.preventFullPageAccessDeletion))})),!1;const C=h.some((e=>(d.jg(e)||d.hV(e))&&"editor"===e.role));if((0,P.bq)()&&S&&!C)return n.default.afterNextFlush((()=>{q.showErrorMessage(k.default.formatMessage(G.preventUserOrGroupDeletion))})),!1;const T=(0,R.Vh)(o,o.pointer,"permissions"),D=[];for(const n of m){!h.find((e=>c.Kf(n,e)))&&d.C2(n)&&D.push({...n,role:"none"})}for(const n of h){const e=m.find((e=>c.Kf(n,e)));!d.C2(n)||e&&s.Xy(e,n)||D.push(n)}let B=[];const E=x.Om(o);if(o instanceof R.G&&!o.isRestricted()&&E&&E instanceof R.G){const e=(0,I.YO)(E);B=D.map((t=>e.find((e=>s.Xy(e.permissionItem,t)))?{...t,role:"none"}:t))}else B=D;for(const n of B)H.applyOperation({store:T,operation:{pointer:T.pointer,command:"setPermissionItem",path:T.path,args:n},transaction:i});return i.postSubmitCallbacks.push((async o=>{U.NLO(t,{status:Boolean(o)?"fail":"success",location:p}),o||await F.bi(t),e.metric&&A.default.measure(e.metric,{environment:t})})),!0}function $(e){var t;const{environment:o,store:n,permissionItems:r,transaction:i,inviteFlowId:a,inviteMessage:s,inviteOrigin:l}=e,c=null===(t=B.default.state.currentSpaceStore)||void 0===t?void 0:t.id,{id:d}=o.currentUser;for(const p of r)if(c&&"user_permission"===p.type&&p.invite_id){const{inviteeId:e,inviteeTable:t}=Y({item:p,spaceId:c}),o={id:p.invite_id,version:1,flow_id:a,space_id:c,target_id:n.id,target_table:n.table,inviter_id:d,inviter_table:f.KJ,invitee_id:e,invitee_table_or_group:t,message:s,created_time:Date.now(),attributes:{permission:p,origin_type:l}};z.sW({store:(0,R.Kv)(n,{table:"invite",id:o.id,spaceId:c}),data:o,transaction:i})}return i.postSubmitCallbacks.push((e=>{U.bRx(o,{status:Boolean(e)?"fail":"success",origin:l})})),!0}function Y(e){const{item:t,spaceId:o}=e;return d.jg(t)?{inviteeId:t.user_id,inviteeTable:f.KJ}:d.FB(t)?{inviteeId:t.bot_id,inviteeTable:u.cZ}:d.hV(t)?{inviteeId:t.group_id,inviteeTable:m._e}:d.ix(t)?{inviteeId:o,inviteeTable:g.bx}:d.zU(t)?{inviteeId:t.team_id,inviteeTable:h.e0}:{}}function Q(e){const{environment:t,store:o,permissionItem:n,transaction:i,shouldInherit:a,fromPermissionWrapper:s}=e;if(!o.isDefined())return;const p=[];if(a){const e=(0,I.YO)(o).map((e=>e.permissionItem)).filter((e=>!c.Kf(e,n)));for(const t of e)d.C2(t)&&(o.isCollectionView()||!d.WY(t.role)||d.FB(t)?p.push(t):p.push({...t,role:"read_and_write"}))}const u=t.currentUser.id,m=u?o.getRecordValue({table:f.KJ,id:u}):void 0,g=m&&(0,r.dp)(m),h=l.DW(o.pointer,o.getRecordModel);!u||c.ZO({actor:g,ancestors:h,updatedPermissionItem:n})||i.useSudoMode||p.push({type:"user_permission",user_id:u,role:"editor"}),p.push(n);const y=o.getPermissionItemsStore();Z.kM({environment:t,store:o,newItems:[n],fromPermissionWrapper:s});for(const r of p)H.applyOperation({store:y,operation:{pointer:y.pointer,command:"setPermissionItem",path:y.path,args:r},transaction:i});H.applyOperation({store:y,operation:{pointer:y.pointer,command:"setSingletonPermissionItem",path:y.path,args:{singletonPermissionItem:{type:"restricted_permission"},set:!0}},transaction:i}),U.gl7(t,{type:"none"===n.role?"remove":"narrow"}),i.postSubmitCallbacks.push((e=>{e||F.bi(t)}))}function J(e){const{environment:t,store:o,transaction:n}=e;if(!o.isDefined())return;const r=o.getPermissionItems(),i=x.Om(o),a=i?c.Wo(x.fJ(i)):[],s=c.Ub(o.getModel(),r,a),l=o.getPermissionItemsStore();for(const c of s)H.applyOperation({store:l,operation:c,transaction:n});U.TJp(t,{using_admin_api:!1}),n.postSubmitCallbacks.push((e=>{e||F.bi(t)}))}async function X(e){const{environment:t,store:o}=e,{currentSpaceStore:n}=B.default.state;if(n){const e=n.id,r=o.id,i=await V.spaceAdminRestoreAccess(t,{spaceId:e,blockId:r});U.TJp(t,{using_admin_api:!0}),"failed"===i.type&&q.showError(i)}}function ee(e){const{environment:t,store:o,transaction:n}=e,r=o.getPermissionItems();if(!o.isTopLevelTeamPage()||0===r.length)return;const i=r.filter((e=>d.FB(e)));z.sW({store:o,transaction:n,data:{permissions:i}}),U.FNU(t,{store:x.VP(o)})}function te(e){const t=e.inviteTargets[0];return!(!t||"bot"!==t.type)}function oe(e){return d.jg(e.permissionItem)&&(0,C.OA)(e.inviteTarget)}async function ne(e){const{environment:t,isOnboarding:o,invite:n}=e;if(0===e.inviteTargets.length)return{success:!0,invitedUsers:{},requestedUsers:{}};const{data:r}=E.default.state,i=(0,j.qX)();let a;if(te(e))if((0,T.Mm)(e.store)){const t=e.inviteRole;a=e.inviteTargets.map((e=>({inviteTarget:e,permissionItem:{type:"bot_permission",role:t,bot_id:e.value.id}})))}else(0,T.OY)(e.store)?a=e.inviteTargets.map((e=>({inviteTarget:e,permissionItem:{type:"bot_permission",role:c.uH(e.value.capabilities),bot_id:e.value.id,parent_table:e.value.parent_table,parent_id:e.value.parent_id}}))):(0,b.t1)(e.store);else a=await async function(e){const{environment:t,inviteTargets:o,inviteRole:n}=e;return Promise.all(o.map((async o=>{if("newUser"===o.type){const e=await re(t,o);return{inviteTarget:o,permissionItem:{type:"user_permission",role:n,user_id:e}}}if("existingUser"===o.type){return{inviteTarget:o,permissionItem:{type:"user_permission",role:e.inviteRole,user_id:o.value.id}}}if("group"===o.type){return{inviteTarget:o,permissionItem:{type:"group_permission",role:e.inviteRole,group_id:o.value.id}}}(0,b.t1)(o)})))}({environment:t,inviteTargets:e.inviteTargets,inviteRole:e.inviteRole,data:r});const{toInvite:s,toRequest:l}=function(e,t){if(!((0,M.Q6)(B.default.state.currentSpaceStore)&&e instanceof R.G))return{toInvite:t,toRequest:[]};const o=[],n=[];for(const r of t)oe(r)?o.push(r):n.push(r);return{toInvite:n,toRequest:o}}(e.store,a),u={};if(e.store instanceof R.G&&l.length>0){if(!(await async function(e){const{environment:t,permissionItems:o,inviteMessage:n,store:r}=e;return!(await Promise.allSettled(o.map((async e=>V.requestAccess(t,{type:"guest-invite-request",block:{id:r.id,spaceId:r.getSpaceId()},forActorId:e.user_id,message:void 0,attributes:{role:e.role,inviteMessage:n}}))))).find((e=>"rejected"===e.status||"fulfilled"===e.status&&"failed"===e.value.type))}({environment:t,store:e.store,permissionItems:l.map((e=>e.permissionItem)),inviteMessage:n.inviteMessage})))return{success:!1};for(const e of l)u[e.inviteTarget.value.email]=e.permissionItem.user_id}if(0===s.length)return{success:!0,invitedUsers:{},requestedUsers:u};const m=s.map((e=>e.inviteTarget)),g=s.map((e=>e.permissionItem));var h;te(e)||U.jBu(t,{role:e.inviteRole,is_space:e.store instanceof R.H2,invite_targets:m,is_onboarding:e.isOnboarding,invite_origin:n.inviteOrigin,permission_items:g,invite_message_length:(null===(h=n.inviteMessage)||void 0===h?void 0:h.length)??0,invite_flow_id:n.inviteFlowId,isProfessionalTeamUser:(0,_.QZ)(),domainType:(0,_.JF)(),share_menu_session_id:D.ZP.state.sessionId});let f;e.store instanceof R.G&&j.He()?f=await async function(e){const{environment:t,store:o,permissionItems:n,invite:r}=e,{currentSpaceStore:i}=B.default.state;if(!i)return!1;if(!i.isDefined())return!1;const a=n.filter(d.jg).map((e=>({...e,invite_id:(0,p.ZP)()})));if("failed"===(await V.inviteGuestsToSpace(t,{block:{id:o.id,spaceId:i.id},permissionItems:a})).type)return!1;const{serverCommitResult:s}=H.createAndCommit({userAction:"permissionsActions.saveInvites",environment:t,perform:e=>{const{inviteFlowId:n,inviteMessage:i,inviteOrigin:s}=r;$({environment:t,store:o,permissionItems:a,transaction:e,inviteFlowId:n,inviteMessage:(0,y.my)(i),inviteOrigin:s})}});await s;const l=n.filter(d.FB);l.length>0&&await ae({environment:t,store:o,permissionItems:l,invite:r});return!0}({environment:t,store:e.store,permissionItems:g,invite:n}):(await ae({environment:t,store:e.store,sudoModeStore:e.sudoModeStore,permissionItems:g,invite:n}),f=!0),o||await F.bi(t);const v={};m.forEach(((e,t)=>{var o;const n=g[t];"newUser"!==e.type&&"existingUser"!==e.type||null===(o=e.value)||void 0===o||!o.email||"user_permission"!==n.type||(v[e.value.email]=n.user_id)}));const S=1===i&&(0,j.qX)()>1;return(0,O.QM)()&&S&&(W.sw(t),(0,N.lF)()),{success:f,invitedUsers:v,requestedUsers:u}}async function re(e,t){const o=(0,a.E2)(k.default.getIntl()),n=t.value.email,r=await V.createEmailUser(e,{email:n,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:o});if("failed"===r.type){if((0,i.Jx)(r.error)){const e=(0,w.nX)(k.default.getIntl(),r.error);e?q.showErrorMessage(e):q.deprecatedShowErrorMessage(r.error.message)}else q.deprecatedShowErrorMessage(r.error.message);throw r.error}return r.data.userId}async function ie(e){let{environment:t,store:o,inviteTargets:n,inviteRole:r,createNewTeamFlowId:i}=e;const a=o.getSpaceId(),s=t.currentUser.id;if(0===n.length)return!0;if(!a||!s)return!1;const{data:l}=E.default.state,c=await async function(e){const{environment:t,inviteTargets:o,inviteRole:n}=e;return Promise.all(o.map((async e=>{if("newUser"===e.type){const o=await re(t,e);return{entity_type:"user",type:n,user_id:o}}return"existingUser"===e.type?{entity_type:"user",type:n,user_id:e.value.id}:"group"===e.type?{entity_type:"group",type:"member",group_id:e.value.id}:void(0,b.t1)(e)})))}({environment:t,inviteTargets:n,inviteRole:r,data:l}),d=await L.Uj({environment:t,teamMemberInfos:c,teamStore:o,isSettingDefaultTeam:!1,createNewTeamFlowId:i});return d&&await F.bi(t),d}async function ae(e){const{environment:t,store:o,sudoModeStore:n,permissionItems:r,invite:i}=e,{serverCommitResult:a}=H.createAndCommit({userAction:"permissionsActions.savePermissionItems",environment:t,useSudoMode:"block"===o.table&&(null==n?void 0:n.shouldSaveTransactionWithSudoMode(o)),perform:e=>{const n=r.map((e=>"user_permission"!==e.type?e:{...e,invite_id:(0,p.ZP)()})),{inviteFlowId:a,inviteMessage:s,inviteOrigin:l}=i;$({environment:t,store:o,permissionItems:n,transaction:e,inviteFlowId:a,inviteMessage:(0,y.my)(s),inviteOrigin:l}),K({environment:t,store:o,permissionItems:n,transaction:e,from:l})}});await a}const se=function(e){const{store:t,transaction:o}=e;z.sW({store:t,data:{permissions:null},transaction:o})}},9700:(e,t,o)=>{o.d(t,{m:()=>m});var n=o(87078),r=o(4023),i=o(15723),a=o(31194);const{Top:s,Bottom:l,Left:c,Right:d}=r.u,{Start:p,Center:u}=r.v,m=function(e){const{store:t,placementToOrigin:o,alignmentToOrigin:r,popupRect:p,originRect:u,viewportPadding:m,placementFlipped:h,viewportAdditionalBottomPadding:f}=e,y=(0,n.Z)();let v=i.jn(y,-m||0);0!==f&&(v=new i.iL(v.x,v.y,v.width,v.height-f));const b=g(p,u,o,r),S=Math.max(v.left-b.left,0)+Math.min(v.right-b.right,0),_=Math.max(v.top-b.top,0)+Math.min(v.bottom-b.bottom,0),w=o===c&&Math.abs(S)>0&&i.aP(v,g(p,u,(0,a.FJ)(o),r)),k=o===d&&Math.abs(S)>0&&i.aP(v,g(p,u,(0,a.FJ)(o),r)),x=o===s&&Math.abs(_)>0&&i.aP(v,g(p,u,(0,a.FJ)(o),r)),I=o===l&&Math.abs(_)>0&&i.aP(v,g(p,u,(0,a.FJ)(o),r)),C={placementFlipped:!1,offsetX:0,offsetY:0};C.placementFlipped=h||w||k||x||I,(!C.placementFlipped||o!==c&&o!==d)&&(C.offsetX=Math.round(S)),(!C.placementFlipped||o!==s&&o!==l)&&(C.offsetY=Math.round(_)),t.setState({...t.state,...C})},g=function(e,t,o,n){if(o===s||o===l){let r,i;return r=n===p?t.left:n===u?t.left+t.width/2-e.width/2:t.right-e.width,i=o===s?t.top-e.height:t.bottom,new DOMRect(r,i,e.width,e.height)}{let r,i;return r=n===p?t.top:n===u?t.top+t.height/2-e.height/2:t.bottom-e.height,i=o===c?t.left-e.width:t.right,new DOMRect(i,r,e.width,e.height)}}},31304:(e,t,o)=>{o.d(t,{E:()=>_,_:()=>w});var n=o(18466),r=o(68626),i=o(72126),a=o(91155),s=o(75189),l=o(44615),c=o(63143),d=o(36054),p=o(41641),u=o(95477),m=o(2688),g=o(85844),h=o(35661),f=o(27724),y=o(24666),v=o(30581);const b=1*c.U6,S="presenceActions";function _(e,t,o,n){!function(e,t){const{persistAutoListener:o,rootStore:n,isActive:i,listenerReference:s,userId:c}=e.state;if(i){if(o&&o.destroy(),s&&m.Z.removeListener(s,t),c&&n&&I({userId:c,rootStore:n})){const e=(0,l.T0)(n.id);m.Z.updateField(e,c,{present:!1},b,t),m.Z.clearOnDisconnect(e,S,t).catch((e=>{r.log({level:"error",from:"destroyPresence",type:"SystemError",error:(0,a.Ui)(e)})}))}e.reset()}}(e,t),n&&v.P(n,t,o)}async function w(e){const{userId:t,rootStore:o,presenceStore:r,environment:a,pageVisitIdStore:c}=e;if(await o.load(),x({userId:t,rootStore:o})){r.setState({...r.state,isActive:!0,rootStore:o,userId:t});const e=i.P2((()=>{r&&r.state.isActive&&r.state.rootStore===o&&k(r,a)}),1e3),p=(e,t)=>{r&&r.state.isActive&&r.state.rootStore===o&&function(e,t){const{remotePresenceData:o}=t.state,n=e||{};i.Xy(o,n)||t.setState({...t.state,remotePresenceData:n})}(function(e){const t={};if(i.Kn(e)){const o=Object.keys(e);for(const n of o){const o=e[n];o&&!(0,d.Gu)(s.uP,o)&&(t[n]=o)}}return t}(t),r)},u=(0,l.T0)(o.id),g=m.Z.addListener(u,p,void 0,a);r.setState({...r.state,persistAutoListener:new n.Z({onChange:e}),listenerReference:g}),t&&I({userId:t,rootStore:o})&&await m.Z.onDisconnect(u,[{operation:"updateField",key:u,field:t,updates:{present:!1},ttl:b},{operation:"logPageExit",userId:t,blockId:o.id,spaceId:o.getSpaceId(),pageVisitId:c.getCurrentPageVisitId()}],S,a),k(r,a)}}function k(e,t){const{persistAutoListener:o,rootStore:n,userId:r}=e.state;if(o&&o.startListener({incrementCycle:!0}),!n||!I({userId:r,rootStore:n}))return;let i;if(r&&n.canEdit()){var a,s;let e;const t=f.default.state;t.stores.length&&(e=t.stores[0]);const o=y.default.state,l="editing"===o.mode&&o.multiSelection;l&&n.uiContains(l.start.store)&&"block"===l.start.store.table&&(e=l.start.store),e||t.pivot&&(e=t.pivot);const d=null===(a=e)||void 0===a?void 0:a.findRecordStoreUIAncestors((e=>e instanceof h.G)).map((e=>e.id)),p=c.ud(Date.now());i={userId:r,present:g.Z.state.isVisible,activityTimestampNearestMinuteMs:p,blockId:(null===(s=e)||void 0===s?void 0:s.id)||null,blockPath:d||null}}if(o&&o.stopListener({isEndOfCycle:!0}),i){const e=(0,l.T0)(n.id);r&&m.Z.updateField(e,r,i,b,t)}}function x(e){const{userId:t,rootStore:o}=e;return Boolean(o)&&(0,p.Z)(o.id)&&o.canEdit()&&t}function I(e){const{userId:t,rootStore:o}=e;return x({userId:t,rootStore:o})&&!u.default.isAdminMode}},40277:(e,t,o)=>{o.d(t,{th:()=>D,Jv:()=>T,I6:()=>M,Hr:()=>A});o(21703),o(57658);var n=o(7406),r=o(68626),i=o(15157),a=o(91155),s=o(63306),l=o(66897),c=o(33728),d=o(72126),p=o(59753),u=o(26825),m=o(27006),g=o(21202),h=o(6287),f=o(15047);function y(e,t){if(v(e,t))return!0;return t&&(0,l.pu)(t),!1}function v(e,t){if(!t)return!1;if(!t.isUser())return!1;let o=!1;const n=e.getEmailDomains()||[],r=e.getPermissionItems()||[];if(t&&t.email&&n){const e=(0,c.Gd)(t.email);o=d.q9(n,e)}return r.find((e=>"user_permission"===e.type&&e.user_id===t.id))&&(o=!0),o}function b(e){const{block:t,space:o,viewer:n}=e;if(!t)return;if(!v(o,n))return;const r=t.getPermissionItems().filter((e=>"user_permission"===e.type&&(0,m.zz)(e.role))).map((e=>e.user_id));if(0===r.length)return;const i=o.getUserPermissionItems();return r.find((e=>(0,u.GU)({spacePermissions:i,userId:e})))}var S=o(73360),_=o(19889),w=o(33929),k=o(45950),x=o(5659),I=o(54642);const C="publicAccessPageId";async function*T(e){const{environment:t,request:o}=e;if("block-space"===o.type){const e=await x.A.measure("loadPublicPageData",`block:${o.blockId} space:${o.spaceId}`,(()=>P(t,o)));"value"in e&&(yield e.value)}const n=await I.getPublicPageData(t,o);"success"===n.type?yield n.data:(r.log({level:"error",from:"publicPageDataActions",type:"loadPublicPageData",error:(0,a.Ui)(n.error)}),yield)}async function*M(e){const{environment:t,request:o}=e;if("block-space"===o.type){const e=await x.A.measure("loadPublicPageData",`block:${o.blockId} space:${o.spaceId}`,(()=>P(t,o)));"value"in e&&(yield e.value)}const n=await I.getPublicPageData(t,o);if("success"!==n.type)throw r.log({level:"error",from:"publicPageDataActions",type:"loadPublicPageDataUnsafely",error:(0,a.Ui)(n.error)}),n.error;yield n.data}async function P(e,t){if("block-space"!==t.type)return{error:Error("Shouldn't be looking for a non-block-space page")};const{blockId:o}=t,{id:r}=e.currentUser;if(o&&r){let t,a,l,c;try{const n=await k.yY({environment:e,recordPointers:[{table:g.iU,id:o},{table:_.KJ,id:r}],recurFn:e=>{const n=[];return e.table===g.iU&&e.id===o&&(t=e),e.table===f.bx&&(a=e),e.table===h.v&&t&&t.parent_id===e.id&&(l=e),e.table===_.KJ&&(c=e),(0,S.tz)(e)&&n.push(e.getParentPointer()),n},recordIsRequired:()=>!0});if(t&&a&&c){const e=s.om({table:g.iU,id:o},n),r=c,i=Boolean(s.YL(e,r)),d=s.YP(e);return{value:function(e){window.__c={n:"getPublicPageData"};const{spaceDomain:t,actor:o,userHasExplicitAccess:n,intl:r,requireInterstitial:i,requireLogin:a,publicAccessRole:s,publicHomePage:l,template:c}=e,d=p.kk.fromValue(g.iU,e.block),u=p.kk.fromValue(f.bx,e.space),m=p.kk.fromValue(h.v,e.associatedCollectionValue),S="none"!==s,_=v(u,o),w=m&&(n||S)?m.getNormalizedSchema():void 0,k=m&&(n||S)?m.id:void 0,x=m&&(n||S)?m.getFormat():void 0;return{pageId:null==d?void 0:d.id,spaceName:u.name||r.formatMessage({id:"publicPageDataHelpers.untitledWorkspace.placeholder",defaultMessage:"Untitled Workspace"}),spaceId:u.id,spaceDomain:t,canJoinSpace:_,icon:u.icon,userHasExplicitAccess:n,ownerUserId:b({block:d,space:u,viewer:o}),collectionId:k,collectionSchema:w,collectionFormat:x,betaEnabled:u.beta_enabled,canRequestAccess:y(u,o),requireInterstitial:i,requireLogin:Boolean(a),publicAccessRole:s,publicHomePage:l,template:c}}({block:t,space:a,spaceDomain:void 0,associatedCollectionValue:l,actor:r,userHasExplicitAccess:i,intl:w.default.getIntl(),requireInterstitial:void 0,publicAccessRole:d,publicHomePage:void 0,template:void 0})}}}catch(i){return{error:(0,n.tg)(i)}}}return{error:Error("No offline public page data found.")}}function A(e){let{currentUserId:t,blockId:o}=e;i.Z.set({userId:t,key:C,value:o})}function D(e){return i.Z.get({userId:e,key:C})}},68305:(e,t,o)=>{o.d(t,{tA:()=>_});o(21703);var n=o(43690),r=o(42875),i=o(606),a=o(149),s=o(21202),l=o(97880),c=o(28020),d=o(33929),p=o(80444),u=o(77080),m=o(37598),g=o(35661),h=o(54642);const f=1e3;class y extends Error{constructor(e,t){super(t),this.type=e}}class v extends y{constructor(){super("query_collection_limit_outside_range","Query collection limit must be between 0 andÂ 1000")}}class b extends y{constructor(e){super("query_collection_failed",`Query collection failed: ${e.reason}`),this.data=e}}class S extends y{constructor(){super("query_collection_too_many_items","Query collection updating too many items")}}async function _(e,t){const{source:o,parentRecordStore:y,collectionPointer:_,filter:w,sort:k,limit:x,vectorSearch:I}=t,C=x??f;if(C<0||C>f)return{error:new v};const T=g.NW.createChildStore(y,_);await T.load();const M=T.getModel();if(!M)return{error:new b({reason:"no collection value"})};const P=T.getParentBlockStore();if(!P)return{error:new b({reason:"no collection parent"})};await P.load();const A=P.getCollectionViewStores()[0],D=A.getSpaceId();if(!A||!D)return{error:new b({reason:"no first collection view"})};const B="results",R={[B]:{type:"results",limit:C}},E=Object.keys(t.aggregations??{});for(const n of E){var F;if(n===B)return{error:new b({reason:"results is a reserved reducer keyword."})};const e=null===(F=t.aggregations)||void 0===F?void 0:F[n];if(!e)return{error:new b({reason:`no aggregation provided for ${n}.`})};e&&(R[n]={type:"aggregation",aggregation:e})}const N=T.getSchema(),j={type:"reducer",filter:w&&n.Ih(w,N),sort:k&&n.zh(k,N),userId:e.currentUser.id,userTimeZone:(0,r.r)(),searchQuery:void 0,vectorSearch:I,reducers:R},O=await h.queryCollection(e,{source:{type:"collection",id:_.id,spaceId:_.spaceId},collectionView:{id:A.id,spaceId:D},loader:j},void 0,{src:o});if("failed"===O.type)return{error:new b({reason:"server query failed",cause:O.error})};const L=O.data.result.reducerResults.results;if(!L||"results"!==L.type)return{error:new b({reason:"unexpected server result"})};if(L.blockIds.length===f&&L.hasMore)return{error:new S};const{groupsReducerIds:U,reducerIdsWithNoGroupDependencies:Z}=n.x3(j.reducers,j.reducerDependencies),V=u.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),q=Date.now(),z={pageSort:[],schema:N,loader:j,userId:e.currentUser.id,userStartOfWeek:c.AK.state,currentTime:q,getRecordModel:p.default.getCurrentBlockModelFn(),intl:d.default.getIntl(),isSorted:!1,visibleProperties:void 0,relativeVariableResult:null==O?void 0:O.data.relativeVariableResult,isSprintPlanningView:!1,collectionSourceType:"collection",groupsReducerIds:U,reducerIdsWithNoGroupDependencies:Z,formulaTimeoutMs:V,resultCache:new Map},W=n.fk(z);for(const r of L.blockIds){var H;const e=g.G.createChildStore(y,{table:s.iU,id:r}),t=null===(H=e.getAssociatedCollectionStore())||void 0===H?void 0:H.pointer;if(!(t&&i.dr.isEqualIdTable(t,T.pointer)))continue;const o=y.getRecordModel(e);o&&n.BW(o,M,z,W)}const G=m.Z.getEditedBlocksForCollection(M.id),K=new Set(L.blockIds);for(const r of G){if(K.has(r))continue;const e=y.getRecordModel({table:s.iU,id:r});e&&n.BW(e,M,z,W)}const{result:$}=n.kk(z,W),Y=n.aW({result:$}),Q={};for(const r of E){var J;const e=n.Oi({expectedAggregator:null===(J=t.aggregations)||void 0===J||null===(J=J[r])||void 0===J?void 0:J.aggregator,aggregationReducerResult:O.data.result.reducerResults[r]});if(a.x.isFail(e)){const t="no aggregation provided"===e.error?`no aggregation provided for ${r}`:"unexpected response returned for aggregation"===e.error?`unexpected response returned for aggregation ${r}`:(0,l.t1)(e.error);return{error:new b({reason:t})}}Q[r]=e.value}return{value:{blockIds:Y,...Q}}}},9953:(e,t,o)=>{o.d(t,{Ue:()=>b,ae:()=>g,j4:()=>h,nj:()=>v,sO:()=>f,sW:()=>y});o(57658);var n=o(41432),r=o(97531),i=o(59730),a=o(59753),s=o(4615),l=o(73360),c=o(606),d=o(21202),p=o(35661),u=o(39699),m=o(1742);function g(e){const{environment:t,table:o,value:n,transaction:r,inMemoryRecordCache:i}=e;n.id||(n.id=(0,s.ZP)());const a=n,d=l.mk.create(o,a),m=c.dr.fromRecordWithTable(d),g=p.t1.createUniqueRootStore(t,m,{userId:r.userId,inMemoryRecordCache:i});return u.applyOperation({store:g,operation:{pointer:g.pointer,path:[],command:"set",args:n},transaction:r}),g}function h(e){var t;const{environment:o,type:a,properties:l,permissions:c,transaction:g,inMemoryRecordCache:h,useCrdt:y}=e;let v=e.tracker;const b=e.id||(0,s.ZP)(),S=e.format||y?{...e.format??{},...y?{use_crdt:!0}:{},...y&&n.h5(a)?r.K(b,null==l?void 0:l.title):{}}:void 0,_=e.spaceId||g.spaceId,w=new p.G(o,{table:d.iU,id:b,spaceId:_},{userId:g.userId,inMemoryRecordCache:h});if(!v&&!g.getUserFlowForAnalyticsPurposesOnly()){const e="page"===a?"user_flow_create_page":"user_flow_create_block";v=new m.BW({environment:o,entryPointName:"recordActions.createBlock",userFlow:e,succeedOnEnqueue:!0})}return null===(t=v)||void 0===t||t.track(w.pointer,g),f({store:w,transaction:g,value:{type:a,permissions:c,properties:l,format:S,space_id:_}}),u.updateMetadataForTransaction({environment:o,transaction:g}),g.postPerformAssertions.push((function(){if(g.isLocal)return;if(!w.getParentStore())throw new i.p8(`Created block was not given a parent before being committed in transaction ${g.getUserActionForAnalyticsPurposesOnly()}`)})),w}const f=function(e){const{store:t,value:o,transaction:n}=e,r=t.path;u.applyOperation({store:t,operation:{pointer:t.pointer,path:r,command:"set",args:o||null},transaction:n})};function y(e){const{store:t,data:o,transaction:n}=e,r=t.path;u.applyOperation({store:t,operation:{pointer:t.pointer,path:r,command:"update",args:o},transaction:n})}function v(e){const{store:t,source:o,fileIds:n,transaction:r}=e,i=t.path;for(const a of n)u.applyOperation({store:t,operation:{pointer:t.pointer,path:i,command:"copyFile",args:{source:o,fileId:a}},transaction:r})}function b(e){let{environment:t,table:o,args:n,transaction:r,inMemoryRecordCache:i}=e;const s=a.vk[o],{model:l,operation:c}=s.create(n),d=p.t1.createUniqueRootStore(t,l.pointer,{userId:r.userId,inMemoryRecordCache:i});return u.applyOperation({store:d,operation:c,transaction:r}),d}},4408:(e,t,o)=>{o.d(t,{HB:()=>ce,LK:()=>pe,Wl:()=>ae,bG:()=>le,fL:()=>se,uo:()=>de});var n=o(59753),r=o(27006),i=o(29477),a=o(54368),s=o(51650),l=o(98963),c=o(18844),d=o(21202),p=o(6359),u=o(44312),m=o(19639),g=o(73387),h=o(32161),f=o(82447),y=o(49953),v=o(14710),b=o(66726),S=o(30754),_=o(84683),w=o(94578),k=o(80396),x=o(24836),I=o(86135),C=o(84323),T=o(83200),M=o(67627),P=o(65963),A=o(14130),D=o(34406),B=o(42314),R=o(16663),E=o(19221),F=o(93646),N=o(91644),j=o(15047),O=o(96740),L=o(75990),U=o(57829),Z=o(56877),V=o(47238),q=o(35623),z=o(77858),W=o(26195),H=o(14718),G=o(14327),K=o(53412),$=o(19889),Y=o(98897),Q=o(66079),J=o(58161),X=o(28182),ee=o(35794),te=o(70203),oe=o(44133),ne=o(84709),re=o(5315),ie=o(54642);function ae(e){const{environment:t,pointer:o,userId:n,inMemoryRecordCache:i,model:a,role:s,force:l,maybeStaleRecordMap:c,updatePaths:p,debugSource:u}=e;"block"===o.table&&(0,oe.setBlockIdDebugSource)(o.id,u);const m=n||t.currentUser.id,g=null==a?void 0:a.getVersion(),h=i.getRole({pointer:o,userId:m}),f=i.getVersion({pointer:o,userId:m}),y="number"==typeof g&&g>f;if(!(l||y||void 0!==s&&h!==s))return;let v=a;if(!l&&!y&&function(e){const{oldRole:t,newRole:o}=e;if(!r.YX(o))return!1;if(t&&!r.J5(t))return!1;return!0}({oldRole:h,newRole:s})){const e=i.getRecordModel({pointer:o,userId:m});e&&(v=e)}i.setModelAndRole({pointer:o,userId:m},v,s);for(const r of p)i.emitRecord(o,r);if(v){const e=v.__IM_SORRY__getValue();if(o.table===d.iU&&e){const t=e;t.properties&&t.properties.title&&(t.properties.title=t.properties.title.map((e=>te.Y_F(e))))}const n=t.defaultRecordCache.persistedRecordCache;if(n&&ge[o.table]){const i=function(e){const{environment:t,pointer:o,model:n,role:i}=e,{id:a}=t.currentUser;if((o.table===$.KJ||o.table===Q.dx||o.table===X.Sr)&&a===o.id)return ue;if((null==n?void 0:n.table)===z.zU&&n.parent_id===a)return me;if(o.table===j.bx&&(0,r.Jy)(i))return me;return}({environment:t,pointer:o,model:v,role:s}),a={value:e,role:s};n.set(o,a,i,m,c)}}i===t.defaultRecordCache.inMemoryRecordCache&&ne.unsubscribeAfterDelay({pointer:o,userId:m,environment:t})}function se(e){const{environment:t,userId:o,recordMap:r,inMemoryRecordCache:a,force:s,maybeStaleRecordMap:l,debugSource:c}=e,d=t.defaultRecordCache.persistedRecordCache;(0,i.ON)(r,(async e=>{let{pointer:r,model:i,role:p}=e,u=i,m=p;if(re.transactionQueue.isPendingTransactionForRecord(r)&&d){const e=await d.get(r,o||t.currentUser.id);e&&(u=n.kk.fromValue(r.table,e.value),m=p)}ae({environment:t,inMemoryRecordCache:a,pointer:r,userId:o,model:u,role:m,updatePaths:[[]],force:s,maybeStaleRecordMap:l,debugSource:c})}))}async function le(e){const{inMemoryRecordCache:t,pointer:o,userId:r,environment:i,minimumVersion:a}=e,s=re.transactionQueue.isPendingTransactionForRecord(o),l=i.defaultRecordCache.persistedRecordCache;if(s)return l&&await l.get(o,r);let c,d;l&&(c=await l.get(o,r),c&&ae({environment:i,inMemoryRecordCache:t,pointer:o,userId:r,model:n.kk.fromValue(o.table,c.value),role:c.role,updatePaths:[[]],debugSource:"refreshAndReturnRecord (localResult)"}));try{const e=t.getEntry({pointer:o,userId:r}),s=e?e.value:void 0,l=e?e.pointer:void 0;if(a&&null!=s&&s.value&&(null==s?void 0:s.value.version)>=a)return s;d=await ie.syncRecordValue(i,{userId:r,version:s&&s.value&&s.value.version?s.value.version:-1,pointer:l||o}),d&&ae({environment:i,inMemoryRecordCache:t,pointer:o,userId:r,model:n.kk.fromValue(o.table,d.value),role:d.role,updatePaths:[[]],debugSource:"refreshAndReturnRecord (remoteResult)"})}catch(p){console.error(p)}return d||c}async function ce(e){const{inMemoryRecordCache:t,pointer:o,userId:r,environment:i}=e,{defaultRecordCache:a}=i,s=await ie.syncRecordValue(i,{pointer:o,userId:r,version:-1});s&&(de({environment:i,inMemoryRecordCache:t,persistedRecordCache:a.persistedRecordCache,pointer:o,userId:r}),ae({environment:i,inMemoryRecordCache:t,pointer:o,userId:r,model:n.kk.fromValue(o.table,s.value),role:s.role,updatePaths:[[]],debugSource:"forceFetchRemoteRecord"}))}function de(e){const{inMemoryRecordCache:t,persistedRecordCache:o,pointer:n,userId:r}=e;t.deleteRecord({pointer:n,userId:r}),t.emitRecord(n,[]),null==o||o.deleteRecord(n,r)}function pe(e){const t=e.defaultRecordCache.inMemoryRecordCache;for(const{pointer:o}of t.data)ne.unsubscribeForAllUsers({pointer:o,environment:e});t.clearCache()}const ue=100,me=50,ge={block:!0,notion_user:!0,space:!0,organization:!0,organization_space:!0,space_view:!0,user_root:!0,collection:!0,collection_view:!0,follow:!0,discussion:!0,comment:!0,user_settings:!0,slack_integration:!0,bot:!0,integration:!0,space_invite_link:!0,template_checklist:!0,page_visit:!0,page_exit:!0,[h.P]:!0,team:!0,[k.yo]:!0,[a.y]:!0,[N.AT]:!0,activity:!1,notification:!1,access_request:!1,customer:!1,temporary_password:!1,password:!1,slack_notification:!1,snapshot:!1,credit:!1,used_credit:!1,space_recover_pages:!1,user_metadata:!1,saml_config:!1,experiment:!1,education_domain:!1,education_email:!1,public_email_domain:!1,user_data_consent_permissions:!1,token:!1,apple_token:!1,google_token:!1,firebase_token:!1,trello_token:!1,asana_token:!1,confluence_token:!1,monday_token:!1,external_entity:!1,external_integration_app:!1,external_token:!1,evernote_token:!1,drive_token:!1,block_token:!1,bot_token:!1,integration_token:!1,csat_feedback:!1,subscription:!1,space_domain:!1,admin_api_log:!1,admin_api_op_log:!1,oauth_authorization_code:!1,mfa_settings:!1,[v.Dw]:!1,[J.t]:!1,[F.O]:!1,[p.H]:!1,[S.G]:!1,[b.l]:!1,[f.r]:!1,[y.r9]:!1,[u.Jd]:!1,[m.mz]:!1,[L.F]:!1,[_.Tu]:!1,[l.cv]:!1,[x.qV]:!1,[I.FM]:!1,[c.Xj]:!1,[g.k]:!1,[U.fF]:!1,[V.x]:!1,[Y.pm]:!1,[O.L]:!1,[Z.L9]:!1,[K.nt]:!1,[W.nE]:!1,[G.z]:!1,[H.u]:!1,[q.M]:!1,[s.b]:!1,[ee.b]:!1,[P.a]:!1,[R.h]:!1,[D.f1]:!1,[B.P]:!1,[T.w]:!1,[A.O]:!1,[M.m]:!1,[C.b]:!1,[E.a]:!1,[w.P9]:!1}},52989:(e,t,o)=>{o.d(t,{AI:()=>f,MZ:()=>y,qw:()=>v});o(57658);var n=o(72126),r=o(73744),i=o(28314),a=o(77546),s=o(95802),l=o(41662),c=o(15723),d=o(4926),p=o(69784),u=o(50628),m=o(27724),g=o(45264),h=o(24677);function f(e){const{environment:t,target:o,startX:n,startY:c,showSelectionRect:u,preventSelectStores:f,allowVerticalEdgeScroll:v,allowHorizontalEdgeScroll:b}=e,S=m.default.getDefaultContainerFromTarget(o);if(!S)return;if(n>=window.innerWidth-d.Z.state)return;if(c>=window.innerHeight-d.Z.state)return;const _=a.VW(o),w=a.xH(o),k=s.C.getMembersByDOMOrder({filter:e=>e.getContextSelectableContainer()===S}),x=()=>{p.Z.state.isActive&&(h.Jy(),y({environment:t,currentX:p.Z.state.currentX,currentY:p.Z.state.currentY,toggle:i.yA().shift}))};_&&r.lj(_,"scroll",x),w&&r.lj(w,"scroll",x),p.Z.setState({moved:!1,isActive:!0,startX:n,startY:c,currentX:n,currentY:c,currentRect:void 0,defaultContainer:S,startSelection:m.default.state.stores,startSelectables:k,verticalScrollerEl:_,horizontalScrollerEl:w,startScrollTop:_?_.scrollTop:0,startScrollLeft:w?w.scrollLeft:0,showSelectionRect:u,handleScroll:x,preventSelectStores:f,allowVerticalEdgeScroll:v,allowHorizontalEdgeScroll:b}),h.ZH(t),g.wG(),l.HM.clearSelection()}function y(e){const{environment:t}=e,o=p.Z.state;if(o.isActive){const{currentX:r,currentY:i,verticalScrollerEl:a,horizontalScrollerEl:s,startScrollTop:l,startScrollLeft:d,preventSelectStores:m}=o;let g=o.startY;if(a){g-=a.scrollTop-l}let f=o.startX;if(s){f-=s.scrollLeft-d}const y={top:Math.min(g,i),bottom:Math.max(g,i),left:Math.min(f,r),right:Math.max(f,r)},v=u.Z.state.selectableRectMap,b=o.startSelectables.filter((e=>{const t=v.get(e),n=e.props.store;return e.props.canSelect&&t&&c.kK(y,t)&&m.indexOf(n)<0&&(!o.showSelectionRect||n.isTransclusionType()||!n.isInsideTransclusion())})),_=S(b);let w=[];const k=_.find((e=>e.length>1));if(k)w=k;else{const e=n.Z$(_);e&&(w=e)}let x=n.UI(w,(e=>e.props.store));if(e.toggle)for(const e of o.startSelection)n.q9(x,e)?x=n.zu(x,e):x.push(e);p.Z.setState({...o,moved:!0,currentX:e.currentX,currentY:e.currentY,currentRect:y}),h.Z5({environment:t,stores:x})}}function v(e){const t=p.Z.state;if(t.isActive){const{moved:o,verticalScrollerEl:n,horizontalScrollerEl:i,handleScroll:a}=t;o||h.ZH(e),n&&r.ZV(n,"scroll",a),i&&r.ZV(i,"scroll",a),p.Z.setState({isActive:!1})}}const b=function(e){if(e)for(;;){if(!(e=e.getContextClosestSelectable()))return;if(e.props.canSelect)return e}},S=function(e){const t=new Map,o={root:!0};for(const n of e){const e=b(n)||o;t.get(e)||t.set(e,[]),t.get(e).push(n)}return Array.from(t.values())}},79978:(e,t,o)=>{o.d(t,{Bl:()=>p,hE:()=>d,tG:()=>c});var n=o(80951),r=o(75134),i=o(9953),a=o(39699);function s(e){const{environment:t,store:o,propertyId:n,id:i,position:s,transaction:l}=e;let c;c="before"===s.type?{pointer:o.pointer,path:["properties",n],command:"addRelationBefore",args:{id:i,spaceId:o.getSpaceId(),before:s.before}}:{pointer:o.pointer,path:["properties",n],command:"addRelationAfter",args:{id:i,spaceId:o.getSpaceId(),after:s.after}},a.applyOperation({store:o,operation:c,transaction:l}),r.r({environment:t,store:o,relationPropertyId:n})}function l(e){const{environment:t,store:o,propertyId:n,id:i,transaction:s}=e;a.applyOperation({store:o,operation:{pointer:o.pointer,path:["properties",n],command:"removeRelation",args:{id:i,spaceId:o.getSpaceId()}},transaction:s}),r.r({environment:t,store:o,relationPropertyId:n})}function c(e){const{environment:t,store:o,propertyId:a,transaction:s,pointers:l}=e,c=(0,n.ow)(l);i.sW({store:o.getPropertiesStore(),data:{[a]:c},transaction:s}),r.r({environment:t,relationPropertyId:a,store:o})}function d(e){const{environment:t,sourceStore:o,destStore:n,propertyWithInverse:r,position:i,transaction:a}=e;s({environment:t,store:o,propertyId:r.property,id:n.id,position:i,transaction:a}),s({environment:t,store:n,propertyId:r.inverse,id:o.id,transaction:a,position:{type:"after"}})}function p(e){const{environment:t,sourceStore:o,destStore:n,propertyWithInverse:r,transaction:i}=e;l({environment:t,store:o,propertyId:r.property,id:n.id,transaction:i}),l({environment:t,store:n,propertyId:r.inverse,id:o.id,transaction:i})}},43008:(e,t,o)=>{o.d(t,{g:()=>l,x:()=>c});var n=o(95802),r=o(80444),i=o(35661),a=o(64951),s=o(24677);const l=function(e){const{mainEditorCurrentBlockStore:t}=r.default.state;if(t){const o=i.G.createChildStore(t,e.blockStore.pointer);a.Z.setState({...a.Z.state,originRect:e.originRect||n.C.getRectFromStore(e.blockStore),blockStore:o})}};function c(e){a.Z.reset(),s.ZH(e)}},52771:(e,t,o)=>{o.d(t,{$:()=>l,x:()=>c});var n=o(95802),r=o(80444),i=o(35661),a=o(82187),s=o(24677);const l=function(e){const{mainEditorCurrentBlockStore:t}=r.default.state;if(t){const o=i.G.createChildStore(t,e.blockStore.pointer);a.Z.setState({...a.Z.state,originRect:e.originRect||n.C.getRectFromStore(e.blockStore),clonedBlockStore:o,originalBlockStore:e.blockStore,renderDelete:e.renderDelete})}};function c(e){a.Z.reset(),s.ZH(e)}},82007:(e,t,o)=>{o.d(t,{AZ:()=>A,L0:()=>P,hv:()=>E,K9:()=>x,dA:()=>T,mF:()=>M,M7:()=>R,XT:()=>B,KX:()=>C,Yw:()=>I,qB:()=>D});o(52262),o(24506);var n=o(76967),r=(o(57658),o(72126)),i=o(606),a=o(27724),s=o(24666),l=o(24161),c=o(39699);function d(e){const{environment:t,revision:o,preventSelectText:n}=e;let{transactions:d}=o;c.createAndCommit({userAction:"revisionActions.undoRevision",environment:t,canUndo:!1,perform:e=>{d=r.d9(d),d.reverse();for(const t of d){c.DEBUG&&console.log("Undoing transaction",t.getUserActionForAnalyticsPurposesOnly());const o=r.d9(t.invertedOperations);o.reverse();for(const n of o){if((0,l.v)(n)){console.warn(`Legacy revisions only support inverting regular operations, skipping ${n.command}.`);continue}const o=t.stores.find((e=>(0,i.qo)(e.pointer,n.pointer)));n&&o&&c.applyOperation({transaction:e,store:o,operation:n})}t.beforeSelection&&a.default.setState({...a.default.state,...t.beforeSelection}),t.beforeTextSelection&&!n&&s.default.setState(t.beforeTextSelection)}}})}function p(e){const{undoStack:t,redoStack:o}=e;return{undoStack:t.slice(),redoStack:o.slice()}}function u(e,t,o){const{undoStack:r,redoStack:l}=p(o),d=l.pop();d&&(!function(e,t,o){const{transactions:n}=t;c.createAndCommit({userAction:"revisionActions.redoRevision",environment:e,canUndo:!1,perform:e=>{for(const t of n){for(const o of t.operations){const n=t.stores.find((e=>(0,i.qo)(e.pointer,o.pointer)));n&&c.applyOperation({transaction:e,store:n,operation:o})}t.afterSelection&&a.default.setState({...a.default.state,...t.afterSelection}),t.afterTextSelection&&!o&&s.default.setState(t.afterTextSelection)}}})}(e,d,t),r.push(d),n.default.setState({type:"legacy",undoStack:r,redoStack:l}))}var m=o(35661),g=o(97880),h=o(82798),f=o(97444),y=o(65273),v=o(77282),b=o(28685);function S(e,t){const o=function(e,t){const o=[];b.E.forEach((e=>{const t=e.getContextClosestSelectable();if(!t)return;const n=t.props.store,r=e.props.store;n.useCrdt()&&(0,y.Ls)({store:r,blockStore:n})&&o.push(n)}));for(const n of o){const o=n.getTextSliceTree();if(!o)return;if(o.findTextSliceTreeContainingItemWithId(e,t))return{block:n,tree:o}}}(e,t);if(!o)return void console.warn("Unable to find block containing text instance OpId",e,t);const n=o.tree.findIndexOfItemId(e,t);if(void 0!==n)return{block:o.block,index:n};console.warn("Unable to find index of OpId",e,t)}function _(e){const{environment:t,transaction:o,operation:n}=e;switch(n.command){case"invertedInsertText":!function(e){const{environment:t,transaction:o,operation:n}=e,r=S(n.args.textInstanceId,n.args.startId);if(!r)return;const i=S(n.args.textInstanceId,n.args.endId);i&&f.pz({environment:t,multiSelection:{start:{store:r.block.getBlockTitleStore(),index:r.index},end:{store:i.block.getBlockTitleStore(),index:i.index+1}},transaction:o})}({environment:t,transaction:o,operation:n});break;case"invertedDeleteText":!function(e){const{environment:t,transaction:o,operation:n}=e,r=S(n.args.textInstanceId,n.args.originId);r&&f.mM({environment:t,store:r.block.getBlockTitleStore(),tokens:n.args.textValue,index:r.index,transaction:o,selectAll:!1})}({environment:t,transaction:o,operation:n});break;case"invertedMoveTextSlice":!function(e){const{transaction:t,operation:o}=e,n=v.Z.getBlockStoreForTextInstanceItemId(o.args.textInstanceId,o.args.textSliceStartItemId,{type:"start"});if(!n)return void console.warn("Unable to find source block store",o);const r=v.Z.getBlockStoreForTextInstanceItemId(o.args.targetTextInstanceId,o.args.targetTextSliceEndItemId,{type:"end"});if(!r)return void console.warn("Unable to find target block store",o);const i=(0,h.TO)(n.getTextSliceTree()),a=(0,h.TO)(i.findTextSliceTreeBeforeTextSliceStartingWithItemId(o.args.textInstanceId,o.args.textSliceStartItemId)).getTextSlice();c.applyCrdtTextOperation({transaction:t,store:n,operation:{command:"moveTextSlice",path:[],pointer:n.pointer,args:{textInstanceId:o.args.textInstanceId,textSliceStartItemId:o.args.textSliceStartItemId,targetBlockId:r.id,targetTextInstanceId:o.args.targetTextInstanceId,targetTextSliceEndItemId:o.args.targetTextSliceEndItemId}},invertedOperation:{command:"invertedMoveTextSlice",path:[],pointer:n.pointer,args:{textInstanceId:o.args.textInstanceId,textSliceStartItemId:o.args.textSliceStartItemId,targetTextInstanceId:a.textInstanceId,targetTextSliceEndItemId:a.getEndItem().id}}})}({environment:t,transaction:o,operation:n});break;case"invertedAddAnnotation":!function(e){const{environment:t,transaction:o,operation:n}=e,r=S(n.args.startTextInstanceId,n.args.startId),i=S(n.args.endTextInstanceId,n.args.endId);r&&i&&f.QX({environment:t,multiSelection:{start:{store:r.block.getBlockTitleStore(),index:r.index},end:{store:i.block.getBlockTitleStore(),index:i.index+1}},annotationTypeOrKey:n.args.annotationKey,transaction:o})}({environment:t,transaction:o,operation:n});break;case"invertedRemoveAnnotation":!function(e){const{environment:t,transaction:o,operation:n}=e,r=S(n.args.startTextInstanceId,n.args.startId),i=S(n.args.endTextInstanceId,n.args.endId);r&&i&&f.KM({environment:t,multiSelection:{start:{store:r.block.getBlockTitleStore(),index:r.index},end:{store:i.block.getBlockTitleStore(),index:i.index+1}},annotation:n.args.annotation,transaction:o})}({environment:t,transaction:o,operation:n});break;default:(0,g.t1)(n)}}function w(e){const{environment:t,revision:o,preventSelectText:n}=e;let{transactions:d}=o;c.DEBUG&&console.log("Undoing/redoing transactions with user actions",o.userActions.join(","));const{performResult:p}=c.createAndCommit({userAction:"revisionActions.performUndoRedoNewRevisionTransaction",environment:t,canUndo:!1,perform:e=>{d=r.d9(d),d.reverse();for(const o of d){const d=r.d9(o.invertedOperations);d.reverse();for(const n of d)if((0,l.v)(n)){const r=o.stores.find((e=>(0,i.qo)(e.pointer,n.pointer)&&e instanceof m.G));if(!r)continue;_({environment:t,store:r,transaction:e,operation:n})}else{const t=o.stores.find((e=>(0,i.qo)(e.pointer,n.pointer)));if(!t)continue;c.applyOperation({transaction:e,store:t,operation:n})}o.beforeSelection&&a.default.setState({...a.default.state,...o.beforeSelection}),o.beforeTextSelection&&!n&&s.default.setState(o.beforeTextSelection)}return e}});return{...o,transactions:[p],undoRedoCount:o.undoRedoCount+1}}function k(e){const{undoStack:t,redoStack:o}=e;return{undoStack:t.slice(),redoStack:o.slice()}}const x=function(e){const t=n.default.state;"legacy"===t.type?function(e,t){const{undoStack:o}=t,r=e.currentTime??Date.now();if("string"==typeof e.undoCheckpoint){const t=o.find((t=>t.namedRevisionId===e.undoCheckpoint));t?t.transactions.push(e.transaction):o.push({type:"legacy",transactions:[e.transaction],timestamp:r,namedRevisionId:e.undoCheckpoint})}else{const t=o.at(-1);!e.undoCheckpoint&&t&&!t.namedRevisionId&&r-t.timestamp<=n.groupIntervalMs&&t.transactions[0].isLocal===e.transaction.isLocal?t.transactions.push(e.transaction):o.push({type:"legacy",transactions:[e.transaction],timestamp:r})}n.default.setState({type:"legacy",undoStack:o,redoStack:[]})}(e,t):function(e,t){const{undoStack:o}=t,r=e.currentTime??Date.now(),i=e.transaction.getUserActionForAnalyticsPurposesOnly()??"unknown";if("string"==typeof e.undoCheckpoint){const t=o.find((t=>t.namedRevisionId===e.undoCheckpoint));t?(t.transactions.push(e.transaction),t.userActions.push(i)):o.push({type:"new",userActions:[i],transactions:[e.transaction],timestamp:r,namedRevisionId:e.undoCheckpoint,undoRedoCount:0})}else{const t=o.at(-1);!e.undoCheckpoint&&t&&!t.namedRevisionId&&r-t.timestamp<=n.groupIntervalMs&&0===t.undoRedoCount&&t.transactions[0].isLocal===e.transaction.isLocal?(t.transactions.push(e.transaction),t.userActions.push(i)):o.push({type:"new",userActions:[i],transactions:[e.transaction],timestamp:r,undoRedoCount:0})}n.default.setState({type:"new",undoStack:o,redoStack:[]})}(e,t)};function I(e,t){const o=n.default.state;"legacy"===o.type?function(e,t,o){const{undoStack:r,redoStack:i}=p(o),a=r.pop();a&&(d({environment:e,revision:a,preventSelectText:t}),i.push(a),n.default.setState({type:"legacy",undoStack:r,redoStack:i}))}(e,t,o):function(e,t,o){const{undoStack:r,redoStack:i}=k(o),a=r.pop();if(a){const o=w({environment:e,revision:a,preventSelectText:t});i.push(o),n.default.setState({type:"new",undoStack:r,redoStack:i})}}(e,t,o)}function C(e,t){const o=n.default.state;"legacy"===o.type?u(e,t,o):function(e,t,o){const{undoStack:r,redoStack:i}=k(o),a=i.pop();if(a){const o=w({environment:e,revision:a,preventSelectText:t});r.push(o),n.default.setState({type:"new",undoStack:r,redoStack:i})}}(e,t,o)}const T=function(e){const t=(null==e?void 0:e.type)??n.default.state.type;n.default.setState({type:t,undoStack:[],redoStack:[]})},M=function(){"new"!==n.default.state.type&&(console.log("Enabling new revision stack."),T({type:"new"}))},P=function(){return Boolean(B())},A=function(){return Boolean(R())};function D(e){const t=n.default.state;"legacy"===t.type?function(e,t){const{environment:o,namedRevisionId:r}=e,{undoStack:i,redoStack:a}=p(t),s=i.findIndex((e=>e.namedRevisionId===r));if(s<0)return;const l=i.splice(s,1)[0];a.push(l),d({environment:o,revision:l}),n.default.setState({type:"legacy",undoStack:i,redoStack:a})}(e,t):function(e,t){const{environment:o,namedRevisionId:r}=e,{undoStack:i,redoStack:a}=k(t),s=i.findIndex((e=>e.namedRevisionId===r));if(s<0)return;const l=w({environment:o,revision:i.splice(s,1)[0]});a.push(l),n.default.setState({type:"new",undoStack:i,redoStack:a})}(e,t)}function B(){const e=n.default.state.undoStack.at(-1);return e?F(e):void 0}function R(){const e=n.default.state.redoStack.at(-1);return e?F(e):void 0}function E(e){return n.default.state.undoStack.some((t=>t.namedRevisionId===e))}function F(e){return"legacy"===e.type?function(e){return{getUserActions:()=>e.transactions.map((e=>e.getUserActionForAnalyticsPurposesOnly()??"")),getFirstStore(){var t;return null==e||null===(t=e.transactions)||void 0===t||null===(t=t[0].stores)||void 0===t?void 0:t[0]}}}(e):function(e){return{getUserActions:()=>e.userActions.slice(),getFirstStore(){var t;return null==e||null===(t=e.transactions)||void 0===t||null===(t=t[0].stores)||void 0===t?void 0:t[0]}}}(e)}},56863:(e,t,o)=>{o.d(t,{w:()=>i});var n=o(49557),r=o(4935);const i=function(){n.Z.state.isActive&&(r.Z.setState({...r.Z.state,open:!1}),n.Z.setState({...n.Z.state,isActive:!1,isAnimatingClosed:!0}))}},75018:(e,t,o)=>{o.r(t),o.d(t,{back:()=>Bo,canGoUp:()=>Eo,clearHistoryState:()=>io,downloadExportUrl:()=>Po,downloadFileUrl:()=>Mo,downloadUrl:()=>Ao,forward:()=>Ro,generatePartnerStackPathParam:()=>so,getInitialPage:()=>Ko,getTrackingParams:()=>lo,goDownInPeekMode:()=>ko,goUpInPeekMode:()=>wo,handleFirstPartyExternalIntegrationAuthCallback:()=>Uo,handleNavigateWithinSamePage:()=>uo,handleRedirectToLastVisitedPage:()=>Vo,handleSlackAuthCallback:()=>Lo,handleThirdPartyExternalIntegrationAuthCallback:()=>Zo,initialize:()=>Ho,navigate:()=>co,navigateAwayIfCurrentPage:()=>Do,navigateOnBaseUrl:()=>ao,navigateToBlock:()=>So,navigateToExternalURL:()=>xo,navigateToHomeTab:()=>vo,navigateToOnboarding:()=>po,navigateToPage:()=>bo,navigateToSearchResult:()=>Qo,navigateToTab:()=>mo,openFileUrl:()=>To,openInNativeApp:()=>No,peekBlock:()=>_o,potentialWebSearchAbandonEventEmitter:()=>ho,publicPageTopBarAction:()=>zo,resetEditorState:()=>eo,resetPageState:()=>Jt,resetPeekState:()=>Xt,resetSidebarState:()=>to,setQueryParamRedirect:()=>Yo,up:()=>Fo,updateHistoryState:()=>ro,updateRouterState:()=>jo,updateRouterStateForDocumentTitleChange:()=>yo});o(21703),o(82801),o(57658);var n=o(17673),r=o(1302),i=o(27328),a=o(50112),s=o(15145),l=o(7406),c=o(33147),d=o(43593),p=o(17755),u=o(68626),m=o(15157),g=o(72126),h=o(29477),f=o(90850),y=o(4615),v=o(71644),b=o(99405),S=o(89101),_=o(21202),w=o(7678),k=o(33709),x=o(23867),I=o(77858),C=o(19889),T=o(66079),M=o(32739),P=o(9852),A=o(54153),D=o(72128),B=o(94826),R=o(93724),E=o(12139),F=o(97880),N=o(64002),j=o(63143),O=o(36054),L=o(74487),U=o(11342),Z=o(5366),V=o(91584),q=o(3297),z=o(97977),W=o(36110),H=o(25320),G=o(99553),K=o(62878),$=o(51798),Y=o(95306),Q=o(9080),J=o(95477),X=o(24215),ee=o(28020),te=o(70764),oe=o(12955),ne=o(21969),re=o(35683),ie=o(84210),ae=o(15070),se=o(9844),le=o(80444),ce=o(49065);var de=o(33929),pe=o(17652),ue=o(78873),me=o(98165),ge=o(18514),he=o(48141),fe=o(38755),ye=o(55081),ve=o(10929),be=o(75538),Se=o(18245),_e=o(30806),we=o(95802),ke=o(74948),xe=o(24646),Ie=o(38676),Ce=o(36896),Te=o(36391),Me=o(41662),Pe=o(5162),Ae=o(51),De=o(19511),Be=o(16772),Re=o(77080),Ee=o(89256),Fe=o(17903),Ne=o(61738),je=o(73796),Oe=o(3418),Le=o(33759),Ue=o(89403),Ze=o(49085);class Ve extends Ze.default{getInitialState(){return{args:void 0}}}const qe=new Ve;var ze=o(42330),We=o(45946),He=o(19671),Ge=o(93220),Ke=o(72014),$e=o(30539),Ye=o(13023),Qe=o(88923),Je=o(98452),Xe=o(99332),et=o(24612),tt=o(89523),ot=o(35661),nt=o(55320),rt=o(87956),it=o(86486),at=o(27724),st=o(92083),lt=o(29370),ct=o(52258),dt=o(66708),pt=o(77503),ut=o(62820),mt=o(29949),gt=o(22500),ht=o(50906),ft=o(19719),yt=o(54642),vt=o(90287),bt=o(48299),St=o(2449),_t=o(54564),wt=o(6404),kt=o(51365),xt=o(45264),It=o(47307),Ct=o(47839),Tt=o(47678),Mt=o(54604),Pt=o(94273),At=o(92625),Dt=o(91376),Bt=o(30581),Rt=o(31304),Et=o(40277),Ft=o(43008),Nt=o(52771),jt=o(82007),Ot=o(3898),Lt=o(87531),Ut=o(24677),Zt=o(64964),Vt=o(29974),qt=o(98104),zt=o(39699),Wt=o(39865),Ht=o(61202),Gt=o(53471),Kt=o(39634);const $t="queryParamsRedirect",Yt=(0,Z.defineMessages)({errorSamlMessage:{defaultMessage:"Could not log you in.",id:"router.loginWithSamlError.message"},appleErrorMessage:{id:"loginActions.loggingInWithApple.errorMessage",defaultMessage:"Something went wrong while trying to log in with Apple."},authenticating:{id:"externalIntegrationAuthActions.authenticationWithIntegration.loadingMessage",defaultMessage:"Authorizing with integrationâ€¦"},joinedTeamMessage:{id:"joinedTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},backToContent:{id:"router.joinSpaceError.acceptLabel.backToContent",defaultMessage:"Back to my content"},goBack:{id:"router.joinSpaceError.acceptLabel.goBack",defaultMessage:"Go back"}}),Qt=[`${s.tY.MentionInPage}`,`${s.tY.LinkInPage}`,`${s.tY.PeekOpen}`,`${s.tY.Expand}`,`${s.tY.Duplicate}`,`${s.tY.Move}`];function Jt(e){dt.Z.reset(),pt.Z.reset(),ct.Z.reset(),Ee.Z.reset(),kt.xv({environment:e,blockPropertyValueOverlayStore:He.Z}),Gt.W8(),Zt.C1()}function Xt(e,t){Je.Z.reset(),Xe.Z.reset(),et.Z.reset(),kt.xv({environment:e,blockPropertyValueOverlayStore:Ye.Z})}function eo(e){var t;Ct.inPageSearch.stop(),Ut.ZH(e),qt.ZH(e),xt.wG(),Me.HM.clearSelection(),Ut.Fp({pivot:void 0}),wt.xv(),it.default.reset(),jt.dA(),_t.LZ(),Nt.x(e),Ft.x(e),Be.default.resetStore({environment:e}),Mt.xv(),null===(t=e.NativeMobileActionBarStore)||void 0===t||t.clear(!1)}function to(e){Ce.Z.reset(),nt.default.reset(),ut.Z.state.open&&(ut.Z.reset(),e.device.isMobile&&ke.close()),Q.Z.state.open&&Y.UZ(e),$.Cd(e)}function oo(){const{mainEditorCurrentBlockStore:e}=le.default.state;let t=0,o=[];if(e){const{stores:e}=at.default.state;o=g.oA(e.map((e=>e.id))),t=Fe.Z.state.scrollTop}return{scrollTop:t,blockIds:o}}function no(e){let{historyId:t,historyIndex:o,currentUserId:n}=e;const r={...oo(),index:o};m.Z.set({userId:n,key:t,value:r})}function ro(e){let{historyId:t,currentUserId:o}=e;const n=m.Z.get({userId:o,key:t});if(!n)return;const r={...oo(),index:n.index};m.Z.set({userId:o,key:t,value:r})}function io(e){let{RouterStore:t,currentUserId:o}=e;const n=t.state.id;m.Z.remove({userId:o,key:n})}function ao(e){const t=function(e,t){try{const o=e.startsWith("/")?new URL(e,J.default.domainBaseUrl):new URL(e);if(t)for(const[e,n]of Object.entries(t))o.searchParams.append(e,n);return o.pathname+o.search+o.hash}catch{throw new Error(`${e} is neither a URL nor an absolute path`)}}(e.url,e.extraSearchParams);return co({...e,url:`${J.default.domainBaseUrl}${t}`})}async function so(e){const t=await oe.getPartnerStackCookie(e);if(t){return{gspk:window.btoa(t)}}const o=await oe.getS2STrackingCookie(e);if(o&&o.partnerKey){return{ps_partner_key:window.btoa(o.partnerKey),ps_xid:o.clickId}}return{}}async function lo(e,t){const{utmContent:o,utmSource:n}=t,r={utm_source:n,utm_content:o,tid:await(0,X.cG)(e)},{mainEditorCurrentBlockStore:i}=le.default.state;return null!=i&&i.id&&(r.utm_campaign=(0,y.F9)(null==i?void 0:i.id)),r}function co(e){var t,o;const{environment:n,openInNew:r,frontPreserveScrollPosition:i,queryId:a,callback:s}=e,{RouterStore:l,currentUser:c}=n,d=c.id,{savedSidebarExpandedStoreState:p}=Qe.default.state;p&&Ie.gV.setState(!0);const u=b.Wj({url:e.url,baseUrl:J.default.domainBaseUrl,publicDomainName:J.default.publicDomainName,isMobile:n.device.isMobile,protocol:J.default.protocol,currentUrl:window.location.href}),{redirect:g,updateMobileTabbedRouterArgs:h}=fo(e,u),f=N.gy(window.location.href),y=N.gy(e.url),S=Boolean((null==y?void 0:y.hostname)&&y.hostname!==(null==f?void 0:f.hostname));if("external"===u.name||S)return void xo({environment:n,url:e.url,targetSelf:S});const _=M.u5({schemeUrl:e.url,baseUrl:J.default.domainBaseUrl}),w=N.T1(e.url);if("tab"===r)return void(n.device.isElectron&&"page"===u.name?Ct.openInNewTab({url:w,position:"after-children"}):xo({environment:n,url:_}));if("window"===r&&n.device.isElectron&&"page"===u.name)return void Ct.openInNewWindow(w);const k=l.state.route;if("quickSearch"===k.name&&n.device.isElectron)return void Ct.openQuickSearchResult(w);const x="page"===k.name&&"page"===u.name&&k.blockId===u.blockId,I="page"===k.name&&"page"===u.name&&k.spaceDomain!==u.spaceDomain&&(k.requestedOnPublicDomain||u.requestedOnPublicDomain),C=n.AppUpdateStore.state.appUpdate;if(!x&&!e.redirect&&St.cM(n,C))return void St.hC({environment:n,url:w,version:C.version});if(g||x||(ro({historyId:l.state.id,currentUserId:d}),(0,xe.Sx)(n)&&(ke.setUpdateExpand({environment:n,isExpanded:!1,from:"close_for_space"}),Te.ZP.update((e=>({...e,canRender:!1}))))),to(n),I)return void xo({environment:n,url:e.url,targetSelf:!0});const T=(0,v.ZP)();g?window.history.replaceState({id:T,currentUserId:n.currentUser.id},void 0,w):window.history.pushState({id:T,currentUserId:n.currentUser.id},void 0,w);const P=function(e){let{historyId:t,currentUserId:o}=e;const n=m.Z.get({userId:o,key:t});return n?n.index:0}({historyId:l.state.id,currentUserId:d});no({historyId:T,historyIndex:g?P:P+1,currentUserId:d}),"pageVisitSource"in u&&(0,F.DE)(Qt,u.pageVisitSource)&&ht.BR(n,k,u),!x&&"page"===k.name&&rt.Z.state&&(null===(t=rt.Z.state)||void 0===t?void 0:t.pageId)===k.blockId&&ht.Ebd(n,rt.Z.state),jo({environment:n,id:T,action:g?"replace":"push",href:w,updateMobileTabbedRouterArgs:h}).then((()=>{"page"===u.name&&!x&&a?rt.Z.setState({queryId:a,pageId:u.blockId,timeEntered:new Date}):rt.Z.reset()})).then((()=>{s&&s()}));(x||"nativeTab"===k.name&&"page"===u.name&&(null===(o=le.default.state.mainEditorCurrentBlockStore)||void 0===o?void 0:o.id)===u.blockId)&&uo(n),!i&&window.scrollTo(0,0),Se.default.markEitherOf(["navigation_page_render","navigation_database_render"]),Se.default.mark("initial_page_render_after_login")}function po(e){co({environment:e,url:S._j.onboarding})}async function uo(e){const{RouterStore:t}=e,o=le.default.state.mainEditorCurrentBlockStore;if(o&&"page"===t.state.route.name){if(t.state.route.scrollToBlockId){const e=[t.state.route.scrollToBlockId];0===g.oA(we.C.findSelectablesFromIds(e)).length&&(await Ot.Nz(o,e),await r.default.afterNextFlush())}Tt.Y(e)}}function mo(e){var t,o,n;const{environment:r,tab:a,navigationAction:s,navigationSource:l}=e,{TabbedRouterStore:c,currentUser:d}=r;if(!ge.__(r))return;"updates"!==a&&ft.nI(r);const p=c.state.activeTab,u=(0,i.w_)(c.state),m=g.Xh(c.state);m.activeTab=a,m.navigationAction=s,m.navigationSource=l,void 0!==e.nativeRootPageOverrideEnabled&&(m.tabs[m.activeTab].nativeRootPageOverrideEnabled=e.nativeRootPageOverrideEnabled);let h=!1;if(void 0!==e.pages){const t=e.pages.map((e=>{const t=(0,i.Gt)(e,!0),o=b.Wj({url:t,baseUrl:J.default.domainBaseUrl,publicDomainName:J.default.publicDomainName,isMobile:r.device.isMobile,protocol:J.default.protocol,currentUrl:window.location.href});return{...e,route:o}})),o=m.tabs[m.activeTab].pages;h=!g.Xy(o,t),m.tabs[m.activeTab].pages=t}if(go(u)&&!go((0,i.w_)(m))&&ho.emit(Date.now()),c.setState(m),c.state.activeTab===p&&!h)return;const f=le.default.state.mainEditorCurrentBlockStore,y="web"===u.type&&(null===(t=u.redirectedTo)||void 0===t?void 0:t.route)&&"page"===(null===(o=u.redirectedTo)||void 0===o?void 0:o.route.name)&&(null===(n=u.redirectedTo)||void 0===n?void 0:n.route.showMoveTo),S=f&&(null==f?void 0:f.canEdit())&&f.isEmptyTitle()&&f.isEmptyPage();"addPage"===p&&y&&S&&d.isLoggedIn()&&zt.createAndCommit({userAction:"routerActions.navigateToTab",environment:r,perform:e=>{Wt.y8({environment:r,blocks:[f],transaction:e}),e.postSubmitCallbacks.push((e=>{e||ht.dhV(r,{analyticsName:"delete",from:"mobile_navigation",block_id:f.id,block_type:"page"})}))}});const _="addPage"===a,w=c.state.tabs[a],{rootPage:k,pages:x}=w;let I=!1;switch(k.type){case"native":break;case"web":if(0===x.length||_)co({environment:r,redirect:!0,url:(0,i.Gt)(k,!0,{...e.queryParams,from:"mobile_bottom_bar"}),updateMobileTabbedRouterArgs:{restoringTab:!0}});else{I=!0;const e=(0,v.ZP)();window.history.replaceState({id:e,currentUserId:r.currentUser.id},void 0,(0,i.Gt)(k))}}if(_)return;const C=!0===m.tabs[m.activeTab].nativeRootPageOverrideEnabled;x.forEach(((e,t)=>{if(!C&&t===x.length-1)return void co({environment:r,redirect:!I,url:(0,i.Gt)(e),updateMobileTabbedRouterArgs:{restoringTab:!0}});const o=(0,v.ZP)(),n=(0,i.Gt)(e);I?window.history.pushState({id:o,currentUserId:r.currentUser.id},void 0,n):(I=!0,window.history.replaceState({id:o,currentUserId:r.currentUser.id},void 0,n))}))}const go=function(e){return"web"===e.type&&"nativeTab"===e.route.name&&"search"===e.route.tab},ho=new c.Z,fo=function(e,t){const o={redirect:e.redirect,updateMobileTabbedRouterArgs:e.updateMobileTabbedRouterArgs};return ge.__(e.environment)?("login"!==t.name&&"logout"!==t.name&&"onboarding"!==t.name||(o.redirect=!0,o.updateMobileTabbedRouterArgs={...o.updateMobileTabbedRouterArgs,clearNativeRootPageOverride:!0}),o):o};function yo(e){var t;const{environment:o,url:n}=e;if(!ge.__(o))return;const{TabbedRouterStore:r}=o,a=(0,i.w_)(r.state);if("web"!==a.type)return;const s=b.Wj({url:n,baseUrl:J.default.domainBaseUrl,publicDomainName:J.default.publicDomainName,isMobile:o.device.isMobile,protocol:J.default.protocol,currentUrl:window.location.href}),l=(null===(t=a.redirectedTo)||void 0===t?void 0:t.route)??a.route;if(s.name!==l.name)return;const c=N.T1(e.url);a.redirectedTo?(a.redirectedTo.route=s,a.redirectedTo.url=c):(a.route=s,a.url=c)}function vo(e,t){var o,n;if(ge.__(e))return e.device.isMobileNative&&e.device.isAndroid&&Oe.Z.closeAll(),mo({environment:e,tab:"home",nativeRootPageOverrideEnabled:!0}),void(t&&t());Boolean(null===(o=e.mobileNative)||void 0===o?void 0:o.supportsNativeHomeOnPhone())&&(null===(n=e.mobileNative)||void 0===n||n.showNativeHomeTab(t))}function bo(e){const{store:t,openInNew:o,environment:n,pageVisitSource:r,openInSidePeek:i}=e,{currentSpaceStore:a}=le.default.state;if(!t.isDefined())return;const s=t.isNavigableBlock(),{page:l,block:c}=s?{page:t,block:void 0}:{page:me.Dg(t),block:t};l&&(!c&&a&&function(e){let{currentUserId:t,spaceId:o,blockId:n}=e;const r=function(e){let{currentUserId:t,spaceId:o}=e;const n=m.Z.get({userId:t,key:$o(o)});if(n){const e=(0,j.dj)(n);return Array.isArray(e)?e:[]}return[]}({currentUserId:t,spaceId:o}),i=g.jj([n,...r]).slice(0,10);m.Z.set({userId:t,key:$o(o),value:JSON.stringify(i)})}({currentUserId:n.currentUser.id,spaceId:a.id,blockId:l.id}),So({environment:n,store:l,scrollToBlockId:c&&c.id,openInNew:o,visitType:re.vu.Search,pageVisitSource:r,queryId:e.queryId,openInSidePeek:i}))}function So(e){const{environment:t,store:o,redirect:n,scrollToBlockId:r,collectionViewId:i,openInNew:a,discussionId:l,showMoveTo:c,saveParent:d,visitType:p,templateGalleryItem:u,projectManagementLaunch:m,pageVisitSource:g,openInSidePeek:h,queryId:f,callback:y,peekMode:v}=e,b=(0,ie.Hu)({store:o,fullyQualified:!1,scrollToBlockId:r,collectionViewId:i,discussionId:l,showMoveTo:c,saveParent:d,templateGalleryItem:u,projectManagementLaunch:m,openInSidePeek:h,pageVisitSource:g,peekMode:v});o.isNavigableBlock()&&Ne.Z.recordVisit({id:o.id,systemBlockType:o.getSystemBlockTypeStore().getValue(),type:void 0!==p?p:re.vu.Default,currentUserId:t.currentUser.id}),co({environment:t,url:g?N.SK(b,{[s.$X]:g,[s.Mf]:a?f:void 0}):b,redirect:n,openInNew:a,queryId:f,callback:y})}function _o(e){const{environment:t,store:o,peekMode:n,openInNew:r,showMoveTo:i,saveParent:a,resultsStore:s,collectionContextStore:l,pageVisitSource:c}=e,d=e.currentBlockStore??le.default.state.mainEditorCurrentBlockStore;if(!d)return;co({environment:t,url:Boolean(r)||"full_page"===n?(0,ie.Hu)({store:o,fullyQualified:!1,showMoveTo:i,saveParent:a,pageVisitSource:c}):(0,ie.Hu)({store:d,peekViewBlockId:o.id,peekMode:(0,Qe.getUrlParamFromPeekMode)(n),fullyQualified:!1,showMoveTo:i,saveParent:a,pageVisitSource:c}),openInNew:r}),G.Af({resultsStore:s,collectionContextStore:l})}function wo(){const{resultsStore:e}=Qe.default.state,t=null==e?void 0:e.getState();if(Qe.default.state.open&&t){const{target:e}=Qe.default.state,o=t.findIndex((t=>t.id===e.id)),{mainEditorCurrentBlockStore:n}=le.default.state;if(n&&o>0){const e=(0,ie.Hu)({store:n,fullyQualified:!1,peekViewBlockId:t[o-1].id,peekMode:(0,Qe.getUrlParamFromPeekMode)(Qe.default.state.mode),pageVisitSource:s.tY.PeekScroll});co({environment:n.environment,url:e}),ht.zP(n.environment,{direction:"up"})}}}function ko(){const{resultsStore:e}=Qe.default.state,t=null==e?void 0:e.getState();if(Qe.default.state.open&&t){const{target:e}=Qe.default.state,o=t.findIndex((t=>t.id===e.id)),{mainEditorCurrentBlockStore:n}=le.default.state;if(n&&o<t.length-1){const e=(0,ie.Hu)({store:n,fullyQualified:!1,peekViewBlockId:t[o+1].id,peekMode:(0,Qe.getUrlParamFromPeekMode)(Qe.default.state.mode),pageVisitSource:s.tY.PeekScroll});co({environment:n.environment,url:e}),ht.zP(n.environment,{direction:"down"})}}}function xo(e){const{environment:t,targetSelf:o}=e;let n=e.url;"/"===n[0]&&(n=J.default.domainBaseUrl+n);const r=N.yn(n);if(r)if(t.device.isElectron)Ct.openExternalUrl(r);else if(t.mobileNative)r.startsWith("http:")||r.startsWith("https:")?t.mobileNative.openInAppBrowser(r):window.location.href=r;else{const t=document.createElement("a");t.href=e.url,t.classList.add("notion-link"),o||t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer"),document.body.appendChild(t),t.click(),t.remove()}}function Io(e){if(!Boolean(e.mobileNative))return!1;const{device:t}=e,o=(0,U.parseMobileAppVersion)(t.mobileAppVersion,t.isAndroid);return!!o&&(t.isIOS?(0,U.isGreaterThanOrEqualToVersion)(o,[0,4,669]):!!t.isAndroid&&(0,U.isGreaterThanOrEqualToVersion)(o,[0,6,735]))}async function Co(e,t){return e.device.isElectron||e.device.isMobileNative?await yt.getSignedFileUrl(e,t,!1):(0,p.g)({...t,baseURL:J.default.domainBaseUrl,currentUserId:e.currentUser&&e.currentUser.id})}async function To(e,t){ht.QIc(e,{from:"embedded_block_click",type:t.type});let o=t.url;const n=e.mobileNative&&Io(e),r=d.E$(t.url,[J.default.secureFileS3.url,J.default.secureFileS3V2.url]);r&&(n&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:t.type,from:t.from,state:"fetching"}),o=await Promise.race([Co(e,t),h.Xb(p.nK,void 0)])),o?r&&n?e.mobileNative.showLightBoxV2({url:o,downloadName:t.downloadName,type:t.type,from:t.from,state:"url_ready"}):xo({environment:e,url:o}):(n&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:t.type,from:t.from,state:"error"}),u.log({level:"error",from:"routerActions",type:"openFileUrl",data:{message:`failed to get url for ${t.url}`}}))}async function Mo(e,t){let o=t.url;const n=e.mobileNative&&Io(e),r=d.E$(t.url,[J.default.secureFileS3.url,J.default.secureFileS3V2.url]);r&&(n&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:"file",from:"download",state:"fetching"}),o=await Promise.race([Co(e,t),h.Xb(p.nK,void 0)])),o?r&&n?e.mobileNative.showLightBoxV2({url:o,downloadName:t.downloadName,type:"file",from:"download",state:"url_ready"}):r?Ao({environment:e,url:o}):xo({environment:e,url:o}):(n&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:"file",from:"download",state:"error"}),u.log({level:"error",from:"routerActions",type:"openFileUrl",data:{message:`failed to get url for ${t.url}`}}))}function Po(e,t){e.mobileNative&&Io(e),d.x$(t);Ao({environment:e,url:t})}function Ao(e){const{environment:t,url:o}=e;t.mobileNative?t.mobileNative.openInAppBrowser(o):t.device.isElectron?Ct.downloadUrl(o):window.location.href=o}async function Do(e){const{environment:t,blocks:o}=e,{mainEditorCurrentBlockStore:n,currentSpaceViewStore:r,currentUserSettingsStore:i,currentUserRootStore:a}=le.default.state,l=n&&o.find((e=>e.id===n.id));if(l&&r){const e=me.Dg(l,1);(0,Pe.Y)("supportsNativeHome")?ge.NW(t)?Bo(t):vo(t):e?So({environment:t,store:e,pageVisitSource:s.tY.LeaveOrRemove}):await Vt.y3({environment:t,spaceViewStore:r,userSettingsStore:i,userRootStore:a,pageVisitSource:s.tY.LeaveOrRemove})}Boolean(o.find((e=>{var t;return e.id===(null===(t=Qe.default.peekTarget.state)||void 0===t?void 0:t.id)})))&&n&&So({environment:t,store:n,pageVisitSource:s.tY.LeaveOrRemove})}const Bo=function(e){ge.__(e)?function(e){const{TabbedRouterStore:t}=e,o=t.state,n=(0,i.Os)(o);if(!n)return;const r=n.type;"native"===r?t.updateWithNativePage({page:n,clearPages:!1,navigationAction:"pop",navigationSource:"mobile-back-navigation"}):"web"===r?window.history.back():(0,F.t1)(r)}(e):window.history.back()},Ro=function(){window.history.forward()},Eo=function(){const e=le.default.state.mainEditorCurrentBlockStore;return!!e&&!!me.Dg(e,1)},Fo=function(e){const t=le.default.state.mainEditorCurrentBlockStore;if(!t)return;const o=me.Dg(t,1);o&&So({environment:e,store:ot.G.createChildStore(o,o.pointer),pageVisitSource:s.tY.Breadcrumb})};async function No(e){const{environment:t,url:o}=e,n=N.T1(o);t.device.isNative?co({url:n,environment:t}):window.location.href=N.SK(M.NV({httpUrl:n,protocol:J.default.protocol}),{di:await(0,X.cG)(t)})}async function jo(e){const{id:t,action:o,href:r,environment:i,updateMobileTabbedRouterArgs:c}=e,{RouterStore:d,currentUser:p,TabbedRouterStore:g}=i,v=(null==c?void 0:c.restoringTab)||!1,[C,M]=b.DP({url:r,isMobile:i.device.isMobile,baseUrl:J.default.domainBaseUrl,publicDomainName:J.default.publicDomainName,protocol:J.default.protocol,currentUrl:window.location.href});E.FB(C.name),R.setRouteTags(C,M);const D=d.state.route,B=m.Z.get({userId:p.id,key:t});if(d.setState({id:t,historyState:B,action:o,route:C,initialRoute:d.state.initialRoute||C}),null!=c&&c.forceUpdate||ge.__(i)&&!v){const e={type:"web",url:N.T1(r),route:C};g.updateWithWebPage({page:e,action:null!=c&&c.forceUpdate?"replace":o,updateMobileTabbedRouterArgs:c})}const F=N.Qc(r),j=F.query[w.Vt];j&&(0,f.Zj)({currentUserId:p.id,promoCode:j});const U=F.query[a.gS];U&&((0,P.setSessionAnalyticsTags)(U),Wo(a.gS)),"page"===C.name||b.KV[C.name]||ht._Wj(i,r);const{target:Z,subtarget:$}=function(e){if(!e)return{target:void 0};const t=null==e?void 0:e.indexOf(".");if(-1===t)return{target:e};return{target:e.substring(0,t),subtarget:e.substring(t+1)}}(F.query.target);"intercom"===Z?(Kt.j({environment:i,from:"query_param"}),Wo("target")):"billing"===Z||"plans"===Z||"members"===Z||"audit_log"===Z||"connected_apps"===Z||"identity_provisioning"===Z||"analytics"===Z||"admin_content_search"===Z||"profile"===Z||"notifications_and_settings"===Z||"user_settings"===Z||"notifications"===Z||"language_and_region"===Z||"settings"===Z||"integrations"===Z||"publishing"===Z||"imports"===Z?(Dt.r$({currentTab:Z,subtab:$,isMobile:i.device.isMobile,openedFrom:"email"}),Wo("target")):"contact_us"===Z?(je.Z.setState({open:!0}),Wo("target")):"quickfind"===Z&&(Promise.race([async()=>{await le.default.waitUntil((()=>void 0!==le.default.state.currentUserSettingsStore&&void 0!==le.default.state.currentSpaceStore&&void 0!==le.default.state.currentSpaceViewStore&&void 0!==le.default.state.currentUserRootStore)),await le.default.waitUntilRendered(),Lt.UT({environment:i,analyticsFrom:"deeplink"})},h.Xb(1500,void 0).then((()=>{Lt.UT({environment:i,analyticsFrom:"deeplink"})}))]),Wo("target")),await Re.default.waitUntil((()=>Re.default.state.isLoaded));const Y=N.T1(r),Q=n.parse(Y.split("?")[1]||"");if(e.enableDesktopAppRedirect&&function(e){const{route:t}=e.RouterStore.state;return b.c$[t.name]&&"always"===We.Z.state&&e.device.isDesktop&&e.device.isBrowser&&(e.device.isMac||e.device.isWindows||!1)&&(!("configureOpenInDesktopApp"in t)||!t.configureOpenInDesktopApp)}(i))!function(e){let t;try{t=N.$U((0,ne.W)(window.location.href))}catch{}t&&co({environment:e,url:t})}(i);else if("root"===C.name){const e={templateGalleryItem:C.templateGalleryItem,projectManagementLaunch:"true"===(Array.isArray(Q.pjm)?Q.pjm[0]:Q.pjm)};!async function(e,t,o){const n=t.currentUser.isLoggedIn(),{RouterStore:r,device:i}=t,a=i.isMobileNative&&i.isIOS,l=r.state.route,c=(e,t)=>{a&&"root"!==r.state.route.name?u.log({level:"warning",from:"routerActions",type:"handleRootRedirect",data:{message:`Prevented ${e} as route has since changed to "${r.state.route.name}"]. Initial route at the start of handleRootRedirect was "${l.name}"}`}}):(a&&u.log({level:"info",from:"routerActions",type:"handleRootRedirect",data:{message:`Redirecting for ${e} as route is still root. Initial route at the start of handleRootRedirect was "${l.name}"}`}}),t())};if(n){a&&u.log({level:"info",from:"routerActions",type:"handleRootRedirect",data:{message:"Called handleRootRedirect"}});const e=await(0,fe.iX)({environment:t,disableRedirectUrl:!1}),{firstSpaceView:r,lastVisitedSpaceView:i,forkPageBlockId:l,publicAccessPageId:d,oauthAuthorizationParams:p,userRootStore:g,redirectUrl:h,userSettingsStore:f,userStore:y,isPersonalHomeRedirect:v}=e;v&&(0,_e.$X)({environment:t,from:"on_app_start_page"}),await Re.default.waitUntil((()=>Re.default.state.isLoaded));await ye.zJ(t,y)&&await ye.yH(t);const b=be.default.state,S=t.currentUser.id,w=A.Z.get(ve.WX);if(w&&n)return void(await qo(t,w));if(p&&r&&(e.onboardingCompleted||ve.BB(b))){const{responseType:e,redirectUri:o,integrationId:n,state:r,owner:i,userId:a,spaceId:s}=p;return void W.g({environment:t,responseType:e,redirectUri:o,integrationId:n,state:r,owner:i,userId:a,spaceId:s})}const k=function(e){return m.Z.get({userId:e,key:$t})}(void 0);Yo({currentUserId:void 0,params:void 0});const x=(null==o?void 0:o.templateGalleryItem)||(null==k?void 0:k.tg),C=(null==o?void 0:o.projectManagementLaunch)||Boolean(null==k?void 0:k.pjm);if(b.isOnboarding)if(ve.BB(b)){if(b.spaceViewId){const e=new ot.V9(t,{table:I.zU,id:b.spaceViewId});"workspace_setup"===b.stage?bt.Xi(t,{spaceViewStore:e}):await Vt.y3({environment:t,spaceViewStore:e,userSettingsStore:f,userRootStore:g,templateGalleryItem:null==o?void 0:o.templateGalleryItem,projectManagementLaunch:null==o?void 0:o.projectManagementLaunch,pageVisitSource:s.tY.Onboarding})}}else po(t);else if(p&&e.onboardingCompleted){const{responseType:e,integrationId:o,redirectUri:n,state:r,owner:i,userId:a,spaceId:s}=p;W.g({environment:t,responseType:e,integrationId:o,redirectUri:n,state:r,owner:i,userId:a,spaceId:s})}else if(d&&e.onboardingCompleted){Et.Hr({currentUserId:S,blockId:void 0});const e=ot.G.createChildStore(g,{table:_.iU,id:d});await e.load(),So({environment:t,store:e,pageVisitSource:s.tY.Direct})}else if(r&&e.onboardingCompleted){const o=h;if(t.device.isMobile&&!e.mobileOnboardingCompleted)await ye.I1(t,{type:"mobile-onboarding",redirectUrl:h});else if(l){q.nM({currentUserId:S,blockId:void 0});const e=ot.G.createChildStore(g,{table:_.iU,id:l});await e.load(),await ee.wU(g);const o=ee.o(g);if(1===o.length){const n=o[0],r=n.getSpaceStore();if(!r)return;q.DK({environment:t,store:e,spaceStore:r,spaceViewStore:n,isPrivate:!0,context:"signin_after_duplicate"})}else So({environment:t,store:e,pageVisitSource:s.tY.Duplicate})}else if(o){let e=o;(C||x)&&(e=N.SK(e,{tg:x,pjm:C})),c("redirectUrl",(()=>{co({environment:t,url:e,redirect:!0})}))}else i?c("lastVisitedSpaceView",(()=>{Vt.y3({environment:t,spaceViewStore:i,userRootStore:g,userSettingsStore:f,templateGalleryItem:x,projectManagementLaunch:C,pageVisitSource:s.tY.Login})})):(t.device.isMobileNative&&u.log({level:"info",from:"routerActions",type:"SpaceSwitchingDebug",data:{message:"navigateToFirstSpace because handleRootRedirect"}}),c("spaceActions.navigateToFirstSpace",(()=>{Vt.L5({environment:t,userRootStore:g,userSettingsStore:f,templateGalleryItem:x,projectManagementLaunch:C,pageVisitSource:s.tY.Login})})))}else await ye.I1(t,{type:"new-user",redirectUrl:h})}}(0,i,e)}else if("onboarding"===C.name)!async function(e){if(e.currentUser.isLoggedIn()){await ye.zJ(e)&&await ye.yH(e)}else{const t=be.default.state,o=A.Z.get(ve.WX);t.isOnboarding||o?co({environment:e,url:S._j.signup}):co({environment:e,url:S._j.login})}}(i);else if("modal"===C.name)if(i.currentUser.isLoggedIn()){let e="/";C.projectManagementLaunch?e+="?tg=gallery":C.templateGalleryItem&&(e+=`?tg=${C.templateGalleryItem}`),co({environment:i,url:e,redirect:!0})}else co({environment:i,url:S._j.login,redirect:!0});else if("googleOneTapRedirect"===C.name)!async function(e,t){const{code:o,frontPathName:n}=t;if(!o)return void co({environment:e,url:S._j.signup});"fail"===(await z.requestLoginWithGoogleOneTap({environment:e,store:Le.Z,idToken:o,frontPathName:n})).status&&co({environment:e,url:S._j.signup})}(i,{code:C.code,frontPathName:C.frontPathName});else if("samlAuthCallback"===C.name)!async function(e,t){let o;e.userId?await z.loginSamlUser({environment:t,userId:e.userId,isNewSignup:e.isNewSignup||!1,previousUserId:e.previousUserId}):o=e.token&&e.csrfState?await z.loginSamlUserWithToken({environment:t,csrfState:e.csrfState,token:e.token,isNewSignup:e.isNewSignup||!1}):e.error||de.default.formatMessage(Yt.errorSamlMessage);o&&(Le.Z.setState({...Le.Z.state,alert:o}),co({environment:t,url:S._j.login}))}(C,i);else if("appleAuthCallback"===C.name)!async function(e,t){const{callbackType:o,encryptedToken:n,encryptedNonce:r,code:i,error:a,encryptedUserObject:s,webBrowserDeviceId:l}=e;if("native"===o&&!t.device.isNative)return void No({url:window.location.href,environment:t});if("user_cancelled_authorize"===a)return Le.Z.setState({...Le.Z.state,loginType:"email"}),void co({environment:t,url:S._j.login});if(a||!i||!n||!r){const e=de.default.formatMessage(Yt.appleErrorMessage);return Le.Z.setState({...Le.Z.state,alert:e}),void co({environment:t,url:S._j.login})}const c=await z.loginWithAppleAuth({environment:t,encryptedToken:n,encryptedNonce:r,code:i,encryptedUserObject:s,webBrowserDeviceId:l});c&&(Le.Z.setState({...Le.Z.state,alert:c}),co({url:S._j.login,environment:t}))}(C,i);else if("googleAuthCallback"===C.name)!async function(e,t){const{callbackType:o,encryptedToken:n,code:r,error:i,webBrowserDeviceId:a}=e;if("native"===o&&!t.device.isNative)return void No({url:window.location.href,environment:t});"access_denied"===i&&Le.Z.setState({...Le.Z.state,loginType:"email"});if(i||!r||!n)return Le.Z.setState({...Le.Z.state,alert:i}),void co({environment:t,url:S._j.login});const s=await z.loginWithGoogleAuth({environment:t,encryptedToken:n,code:r,callbackType:"native"===o||"nativeredirect"===o?o:void 0,webBrowserDeviceId:a});s&&(Le.Z.setState({...Le.Z.state,alert:s}),co({url:S._j.login,environment:t}))}(C,i);else if("googleDriveAuthCallback"===C.name)!function(e,t){const{code:o,error:n}=e;!n&&o&&V.O$(t,o);const{url:r}=Pt.Vr(t);co({url:r||S._j.root,environment:t})}(C,i);else if("slackAuthCallback"===C.name)Lo({route:C,environment:i});else if(C.name===b.AY.datadogAuthCallback)Zo({route:C,environment:i});else if("externalAuthCallback"===C.name)Uo({route:C,environment:i});else if(C.name===b.AY.authCallback)Zo({route:C,environment:i});else if("loginWithEmailCallback"===C.name)!async function(e,t){const{state:o,password:n,isSignup:r,redirectURL:i,webBrowserDeviceId:a}=e,s=await z.loginWithTemporaryPasscode({environment:t,state:o,password:n,redirectURL:i,webBrowserDeviceId:a,passcodeEnterMethod:"magic_link"});s&&(Le.Z.setState({...Le.Z.state,alert:s}),co(r?{url:S._j.signup,environment:t}:{url:S._j.login,environment:t}))}(C,i);else if("loginSuccessCallback"===C.name)!async function(e,t){const{args:o}=qe.getState(),{webBrowserDeviceId:n}=e;o?await z.handleLoginWithTemporaryPasscodeSuccess({environment:t,...o,webBrowserDeviceId:n}):(u.log({level:"error",from:"routerActions",type:"handleLoginSuccessRedirect",data:{message:"empty args for handleLoginSuccessRedirect"}}),co({url:S._j.root,environment:t}))}(C,i);else if("passwordResetCallback"===C.name)!async function(e,t){const{state:o,password:n}=e,r=await z.loginPasswordReset({environment:t,csrfState:o,password:n,loginStore:Le.Z});r&&(Le.Z.setState({...Le.Z.state,loginType:"email",alert:r}),co({url:S._j.login,environment:t}))}(C,i);else if("passwordChangeRedirect"===C.name)ao({environment:i,url:S._j.login}),ue.E({environment:i});else if("logout"===C.name)!async function(e){await z.actuallyLogoutAndDeleteAllLocalData({environment:e})}(i);else if("login"===C.name||"signup"===C.name){Oo(i,r),function(e,t){try{const e=new URL(t).searchParams.get("product")||void 0;e&&Le.Z.setState({...Le.Z.state,productType:e})}catch(o){}}(0,r);const e={doNotRedirectWhenLoggedIn:Boolean(Q.newSignup)};!function(e,t,o){if((0,ge.Sr)()){const t=N.TW({publicDomainName:J.default.publicDomainName},window.location.host);vt.qY({spaceDomain:t,environment:e})}else!e.currentUser.isLoggedIn()||null!=o&&o.doNotRedirectWhenLoggedIn?ht.Snv(e,t):co({environment:e,url:S._j.root,redirect:!0})}(i,C.name,e)}else"oauthAuthorization"===C.name?async function(e,t){P.setOauthAuthorizationParams(e);const{userId:o,spaceId:n}=e;if(n){const e=o?[o]:t.currentUser.loggedInUserIds;for(const o of e){const e=new ot.r9(t,{table:T.dx,id:o},{userId:o});await e.load();const r=e.getSpaceViewStores();if(r.length>0){await Promise.all(r.map((e=>e.load())));const e=r.find((e=>e.getSpaceId()===n));if(e)return void(await Vt.ce({environment:t,spaceViewStore:e}))}}}const{currentUserRootStore:r}=le.default.state;if(r){await r.load();const e=r.getSpaceViewStores().find((e=>{var t;return Boolean(null===(t=e.getSpaceStore())||void 0===t?void 0:t.canRead())}));if(e)return void(await Vt.ce({environment:t,spaceViewStore:e}))}co({environment:t,url:S._j.login,redirect:!0})}(C,i):"page"===C.name||"space"===C.name?(Oo(i,r),function(e,t){if(!t)return;try{const{experimentGroups:o,inviteeEmail:n,inviterName:r}=JSON.parse(window.atob(t));ht.WCB(e,{invitee_email:n,invitation_experiment_groups:o}),Ue.Z.setState({...Ue.Z.state,inviteeEmail:n,inviterName:r}),n&&Le.Z.setState({...Le.Z.state,email:n})}catch(o){}}(i,C.state),vt.Uz({nextRoute:C,currentRoute:D,environment:i,query:Y}),function(e,t,o){if(!e.device.isMobile){const{mainEditorCurrentBlockStore:i}=le.default.state;if(!i)return;const a=Qe.default.state;let s,l=!1,c=!1;if("page"===t.name&&t.peekViewBlockId){const e=ot.G.createChildStore(i,{table:_.iU,id:t.peekViewBlockId});l=Boolean(t.showMoveTo),c=Boolean(t.saveParent),s=e}const d="page"===t.name&&t.peekMode?t.peekMode:void 0,p=(0,Qe.getPeekModeFromUrlParam)(d);if(s&&(!a.open||s.id!==a.target.id||p!==a.mode)){var n,r;a.open&&Bt.P(a.target,e,Ke.jx);const t=Ke.jx.getCurrentPageVisitId();Ke.jx.initializeNewPageVisitId();const i=at.default.cloneState(),d=lt.Z.cloneState(),u=De.Z.cloneState(),m=e.currentUser.id;Xt(e,a.mode),to(e),eo(e),ht.PBo(e,{page_id:s.id,collection_id:s.getParentCollectionId()??(null===(n=s.getCollectionViewCollectionStore())||void 0===n?void 0:n.id),team_id:null===(r=(0,me.VP)(s))||void 0===r?void 0:r.id,is_peek:!0,peek_mode:p,type:"page",query:o,page_visit_id:Ke.jx.getCurrentPageVisitId(),previous_page_visit_id:t});const g=new ot.G(e,s.pointer),h=new $e.Z,f=new tt.Z,y=new Ge.Z;G.bA(e,{mode:p??Qe.PeekModeCenter,target:g,pageVisitStore:h,presenceStore:f,showMoveTo:l,saveParent:c,loadingContainerStore:y,savedSelectionStoreState:i,savedTableSelectionStoreState:d,savedCollectionViewSelectionStoreState:u,savedSidebarExpandedStoreState:Ie.gV.state}),Rt._({userId:m,rootStore:g,presenceStore:f,environment:e,pageVisitIdStore:Ke.jx}),H.UX(e,{block:g,pageVisitStore:h,timestamp:Date.now(),fromPageRefresh:(0,P.getAppRefreshed)()}),Ne.Z.recordVisit({id:s.id,systemBlockType:s.getSystemBlockTypeStore().getValue(),type:re.vu.Default,currentUserId:m})}a.open&&!s&&(G.ME(),Rt.E(a.presenceStore,e,Ke.jx,a.target),Xt(e,a.mode))}}(i,C,Y),function(e,t){if(e.device.isMobile)return;const{mainEditorCurrentBlockStore:o}=le.default.state;if(!o)return;"page"===t.name&&t.templateGalleryItem?"closed"===mt.Z.state.status&&mt.Z.open({analyticsFrom:"direct_link",cloneTo:"destination_picker"}):"closed"!==mt.Z.state.status&&mt.Z.setState({...mt.Z.state,status:"closed"})}(i,C),async function(e,t){"configureOpenInDesktopApp"in t&&t.configureOpenInDesktopApp&&(await Re.default.waitUntilStatsigReady(),e.device.isDesktop&&e.device.isBrowser&&(e.device.isMac||e.device.isWindows)&&((0,pe.r)()?st.Z.setState({open:!0,openedFrom:"misc",currentTab:"user_settings",defaultSubtab:void 0,highlightedSetting:st.R.OpenInDesktopApp}):st.Z.setState({open:!0,openedFrom:"misc",currentTab:"notifications_and_settings",defaultSubtab:void 0,highlightedSetting:st.R.OpenInDesktopApp})))}(i,C),await async function(e,t){const{mainEditorCurrentBlockStore:o}=le.default.state;if(!o)return;if("page"===t.name&&t.scrollToBlockId&&t.discussionId){const n=ot.G.createChildStore(o,{table:_.iU,id:t.blockId}),r=(0,ot.Kv)(n,{table:k.qF,id:t.discussionId,spaceId:(0,x.C)(n.pointer.spaceId)});await r.load(),r.getKeyStore("resolved").getValue()&&(ke.setUpdateExpand({environment:e,isExpanded:!0,from:"resolved_comment"}),ke.setUpdateSidebarCommentsMode(Te.F7.Resolved))}}(i,C)):"templatesRedirect"===C.name?co({environment:i,url:(0,ge.UY)("templateGallery"),redirect:!0}):"communityRedirect"===C.name?co({environment:i,url:(0,ge.UY)("community"),redirect:!1}):"guideRedirect"===C.name?co({environment:i,url:(0,ge.UY)("guides.guides"),redirect:!0}):"invoiceRedirect"===C.name?co({environment:i,url:S._j.root,redirect:!0}):"termsRedirect"===C.name?co({environment:i,url:(0,ge.UY)("terms"),redirect:!0}):"contentPolicyRedirect"===C.name?co({environment:i,url:(0,ge.UY)("contentPolicy"),redirect:!0}):"uiDoc"===C.name||"exportPreview"===C.name?co({environment:i,url:S._j.root,redirect:!0}):"admin"===C.name?J.default.isAdminMode||co({environment:i,url:S._j.root,redirect:!0}):"teamInvite"===C.name?qo(i,C.inviteCode):"teamsInvite"===C.name?i.currentUser.isLoggedIn()||co({environment:i,url:S._j.signup,redirect:!0}):"aiGtmFavoriteImport"===C.name?async function(e){const{environment:t,route:o}=e;co({environment:t,url:S._j.root,redirect:!0}),await le.default.waitUntil((()=>void 0!==le.default.state.currentUserSettingsStore&&void 0!==le.default.state.currentSpaceStore&&void 0!==le.default.state.currentSpaceViewStore&&void 0!==le.default.state.currentUserRootStore)),await le.default.waitUntilRendered(),await(0,K.M)({environment:t,importArgs:o})}({environment:i,route:C}):"new"===C.name?async function(e,t){if(!e.currentUser.id)return void co({environment:e,url:S._j.root,redirect:!0});const{id:o,type:n,from:r}=t;let i;if(t.spaceId)i=t.spaceId;else{const{spaceId:t}=await Pt.Ie(e);i=t}if(i){const{currentUserSettingsStore:t}=le.default.state,o=new ot.r9(e,{table:T.dx,id:e.currentUser.id});if(await o.load(),void 0===le.default.state.currentSpaceStore||le.default.state.currentSpaceStore.id!==i)try{await Vt.j({environment:e,userRootStore:o,spaceId:i,navigate:!0,analyticsFrom:"redirect",userSettingsStore:t})}catch(s){return void It.showMessage({message:(0,l.tg)(s).message,onAccept:()=>{Bo(e)}})}}else co({environment:e,url:S._j.root,redirect:!0}),await le.default.waitUntil((()=>void 0!==le.default.state.currentSpaceStore&&void 0!==le.default.state.currentSpaceViewStore&&void 0!==le.default.state.currentUserRootStore));let a;if(n){if(!(0,O.Gu)(L.literals(...ze.o1),n)){const e=n;switch(e){case"page":case"team":o&&(a={type:e,spaceId:i,id:o});break;case"space":o&&(a={type:e,id:o});break;case"space-private-pages":a={type:e,spaceId:i}}}}ke.quickAddPage({environment:e,from:r||"route",redirect:!0,quickAddParentOverride:a})}(i,C):"myIntegrations"===C.name||"inAppTemplateSubmission"===C.name||"inAppTemplateCreatorSubmission"===C.name?function(e){e.currentUser.isLoggedIn()||co({environment:e,url:S._j.login})}(i):"studentGroupSignup"===C.name?i.currentUser.isLoggedIn()||co({environment:i,url:S._j.login}):"unknown"===C.name?co({environment:i,url:S._j.root,redirect:!0}):"nativeTab"===C.name?async function(e,t,o,n){if(!e.currentUser.id)return void co({environment:e,url:S._j.root,redirect:!0});let r;if(t.spaceId)r=t.spaceId;else{const{spaceId:t}=await Pt.Ie(e);r=t}if(vt.Uz({nextRoute:{...t,spaceId:r},currentRoute:o,environment:e,query:""}),"search"===t.tab){if(!nt.default.state.sessionId){const t=(0,y.ZP)();nt.default.update((e=>({...e,open:!1,openAsPage:!0,openedTimeMs:Date.now(),sessionId:t}))),ht.wFN(e,{from:"pop"===n?"mobile-back-navigation":"mobile-bottom-bar",searchSessionId:t})}}else"updates"===t.tab&&ft.Up({environment:e,from:"pop"===n?"mobile-back-navigation":"mobile-bottom-bar"})}(i,C,D,o):"quickSearch"===C.name?function(e,t,o){if(!e.currentUser.id)return;vt.Uz({nextRoute:t,currentRoute:o,environment:e,query:""}),Lt.UT({environment:e,analyticsFrom:"quick-search",renderAsPage:!0,isQuickSearch:!0})}(i,C,D):"chat"===C.name?function(e,t,o){if(!e.currentUser.id)return;vt.Uz({nextRoute:t,currentRoute:o,environment:e,query:""})}(i,C,D):"workspaceSetup"===C.name?function(e,t,o){if(!e.currentUser.id)return void co({environment:e,url:S._j.root,redirect:!0});t.spaceId&&be.default.state.isOnboarding?vt.Uz({nextRoute:t,currentRoute:o,environment:e,query:""}):co({environment:e,url:S._j.root,redirect:!0})}(i,C,D):"uniqueId"===C.name?await async function(e,t){var o;const n=e.currentUser.id;if(!n)return void Go(e);const r=new ot.r9(e,{table:T.dx,id:n},{userId:n});await r.load();const i=null===(o=r.getSpaceViewStores())||void 0===o?void 0:o[0].getSpaceId();if(!i)return void Go(e);const a=await yt.getIdFromUniqueId(e,{spaceId:i,uniqueId:t});if("failed"===a.type||!a.data.id)return void Go(e);const l=a.data.id,c=ot.G.createChildStore(r,{table:_.iU,id:l});await c.load(),bo({environment:e,store:c,pageVisitSource:s.tY.Direct})}(i,C.uniqueId):"signupForPlus"===C.name?((0,gt.zQ)("plus"),co({environment:i,url:S._j.signup,redirect:!0})):"signupForBusiness"===C.name&&((0,gt.zQ)("business"),co({environment:i,url:S._j.signup,redirect:!0}))}function Oo(e,t){if(oe.canSetCookie(e))try{const o=new URL(t),n=o.searchParams.get("ps_partner_key"),r=o.searchParams.get("ps_xid");if(r&&n){const t={partnerKey:window.atob(n),clickId:r};return oe.setS2STrackingCookie(e,t),void ht.Esd({partner_stack_key:t.partnerKey})}const i=o.searchParams.get("gspk");if(i){const t=window.atob(i);return oe.setPartnerStackCookie(e,t),void ht.Esd({partner_stack_key:t})}}catch(o){}}async function Lo(e){const{route:t,environment:o}=e;"legacy"===t.type?await async function(e){const{route:{code:t,state:o},environment:n}=e;let r;if(t&&o){const e=await yt.authWithSlack(n,{code:t,encryptedState:o});"failed"===e.type&&(r=e.error.message)}else r="Something went wrong.";r&&It.deprecatedShowErrorMessage(r);const{url:i}=Pt.Vr(n);co({url:i||S._j.root,environment:n})}({environment:o,route:t}):"new"===t.type?await async function(e){const{route:{error:t},environment:o}=e;if(t){const e=de.default.formatMessage((0,te.mO)(t),{value:t});It.showErrorMessage(e)}else await Ht.pJ({environment:o});const{url:n}=Pt.Vr(o);co({url:n||S._j.root,environment:o})}({environment:o,route:t}):(0,F.t1)(t)}async function Uo(e){const{route:t,environment:o}=e;let n=t.error?t.errorDescription||de.default.formatMessage((0,te.mO)(t.error),{value:t.error}):void 0;try{if(!t.notionState)throw new Error("No notionState.");const e=JSON.parse(decodeURIComponent(t.notionState));await Ht.pJ({environment:o}),await Ht.FD({environment:o,notionState:e})}catch(r){n||(n="An unknown error occurred.")}n&&It.deprecatedShowErrorMessage(n),Vo(o)}async function Zo(e){const{route:t,environment:o,integrationId:n,from:r,options:i}=e;let a=t.error?t.errorDescription||de.default.formatMessage((0,te.mO)(t.error),{value:t.error}):void 0;try{if(!t.state)throw new Error("No state provided.");if(!t.code)throw new Error("No code provided.");At.j({message:Yt.authenticating});const e=await yt.authWithExternalIntegration(o,{code:t.code,state:t.state,...t.name===b.AY.datadogAuthCallback?{accountName:t.organizationName,accountId:t.organizationId,accountDomain:t.site}:void 0});if(At.x(),"failed"===e.type)It.showError(e);else{const{externalObjectInstanceBlockId:t,spaceId:n}=e.data;await Ht.pJ({environment:o}),await Ht.FD({environment:o,notionState:{externalObjectInstanceBlockId:t,spaceId:n}})}}catch(s){a||(a=(0,l.tg)(s).message)}a&&It.deprecatedShowErrorMessage(a),await async function(e){const{environment:t,integrationId:o,from:n}=e;if(function(e){const{currentUserRootStore:t}=le.default.state;if(!t||!e)return!1;const o=(0,ce.Kv)(t,{id:e,table:se.K2}).getKeyStore("capabilities").getValue();return(0,ae.ms)(o)}(o)&&!(0,B.uw)(o)){const{spaceId:e}=await Pt.Ie(t);W.g({environment:t,responseType:"code",spaceId:e,integrationId:o,redirectUri:void 0,state:void 0,owner:void 0,userId:void 0})}else"workspace_connections_redirect"!==n&&Vo(t)}({environment:o,integrationId:n,shouldOpenSettings:null==i?void 0:i.shouldOpenSettings,from:r})}function Vo(e){const{url:t}=Pt.Vr(e);co({url:t||S._j.root,environment:e})}async function qo(e,t){const o=Et.I6({environment:e,request:{type:"invite-link",inviteLinkCode:t}}),n=(await o.next()).value;Ae.Z.setState({publicPageData:n});const r=()=>{A.Z.set(ve.WX,t),po(e)};if(e.currentUser.isLoggedIn()&&n.spaceId){const{id:o}=e.currentUser;if(o){const a=new ot.U6(e,{table:C.KJ,id:o});await a.load();if(!a.getFullName(de.default.getIntl())){r();const t=await(0,fe.iX)({environment:e,disableRedirectUrl:!1});return void(await ye.I1(e,{type:"new-user",redirectUrl:t.redirectUrl}))}const c=new ot.r9(e,{table:T.dx,id:o});await c.load();try{const o=await Vt.j({environment:e,userRootStore:c,userSettingsStore:void 0,spaceId:n.spaceId,navigate:!1,analyticsFrom:"redirect",inviteCode:t});await Vt.y3({environment:e,spaceViewStore:o.spaceViewStore,userSettingsStore:void 0,userRootStore:c,pageVisitSource:s.tY.SwitchSpace})}catch(i){const{currentUserRootStore:t,currentUserSettingsStore:o}=le.default.state,n=t&&o;It.showMessage({message:(0,l.tg)(i).message,acceptLabel:n?de.default.formatMessage(Yt.backToContent):de.default.formatMessage(Yt.goBack),onAccept:()=>{A.Z.remove(ve.WX),n?Vt.L5({environment:e,userRootStore:t,userSettingsStore:o,pageVisitSource:s.tY.Onboarding}):Bo(e)}})}}}else r()}async function zo(e,t){const{utmContent:o,nextRoute:n}=t,[r,i]=await Promise.all([so(e),lo(e,{utmContent:o,utmSource:"public_page"})]);ao({environment:e,url:n,extraSearchParams:{...r,...i}})}function Wo(e){const t=N.T1(N.iO(window.location.href,e));window.history.replaceState(history.state,void 0,t)}const Ho=async function(e){const t=window.history.state&&window.history.state.id||(0,v.ZP)();if(!window.history.state){const o=e.currentUser.id;window.history.replaceState({id:t,currentUserId:o},void 0,window.location.href),no({historyId:t,historyIndex:0,currentUserId:o})}ge.__(e)&&e.TabbedRouterStore.setUp({nativeInboxEnabled:(0,Pe.Y)("supportsNativeInbox")}),await jo({environment:e,id:t,action:"pop",href:window.location.href,updateMobileTabbedRouterArgs:{forceUpdate:!0,silenceErrors:!0,clearNativeRootPageOverride:"/"!==window.location.pathname},enableDesktopAppRedirect:!0});const o=e.currentUser.id,n=Ko(o);if(!n||"undefined"===n){const e=window.location.pathname;e&&function(e){let{currentUserId:t,value:o}=e;D.Z.set({userId:t,key:"sourceInitialPage",value:o})}({currentUserId:o,value:e})}};function Go(e){const t={name:"notFound"};e.RouterStore.setState({id:(0,v.ZP)(),route:t,action:"push",initialRoute:e.RouterStore.state.initialRoute||t})}function Ko(e){return D.Z.get({userId:e,key:"sourceInitialPage"})}function $o(e){return`recentQuickJumps:${e}`}function Yo(e){let{currentUserId:t,params:o}=e;m.Z.set({userId:t,key:$t,value:o})}function Qo(e){const{searchResult:t,environment:o,openInNew:n,pageVisitSource:r,queryId:i,openInSidePeek:a}=e,{store:s}=t,l=(0,he.dy)(t);void 0===l?bo({store:s,openInNew:n,environment:o,pageVisitSource:r,queryId:i,openInSidePeek:a,peekMode:a?"s":void 0}):So({environment:o,store:s,scrollToBlockId:l,openInNew:n,visitType:re.vu.Search,pageVisitSource:r,queryId:i,openInSidePeek:a,peekMode:a?"s":void 0})}},3898:(e,t,o)=>{o.d(t,{Nz:()=>h,uE:()=>u});var n=o(72126),r=o(21202),i=o(98165),a=o(52315),s=o(35328),l=o(80444),c=o(35661),d=o(15690),p=o(29373);function u(e){const t=e.state;return"page"===t.route.name&&t.route.scrollToBlockId?[t.route.scrollToBlockId]:t.historyState?t.historyState.blockIds:[]}function m(e,t){const o=function(e,t){const o=t.map((t=>c.G.createChildStore(e,{table:r.iU,id:t}))).map((e=>i.qA(e))).filter((t=>{let o=!1;const n=t.slice(1).find((e=>{if("block"===e.table)return e.isTransclusionType()&&(o=!0),e.isNavigableBlock()}));return n&&(n.id===e.id||o)})).map((e=>{const t=e.findIndex((e=>"block"===e.table&&e.isNavigableBlock()));return e.slice(1,t).filter((e=>"block"===e.table&&(0,s.BX)(e)))}));return n.mN(n.xH(o),(e=>e.id))}(e,t);for(const n of o)p.rd({blockId:n.id,state:!0,currentUserId:n.environment.currentUser.id});return o}function g(e,t){const o=function(e,t){const o=t.map((t=>c.G.createChildStore(e,{table:r.iU,id:t,spaceId:e.pointer.spaceId}))).map((e=>i.qA(e))).filter((t=>{const o=t.slice(1).find((e=>"block"===e.table&&e.isNavigableBlock()));return o&&o.id===e.id})).map((e=>{const t=e.findIndex((e=>"block"===e.table&&e.isNavigableBlock()));return e.slice(1,t).filter((e=>{if("block"!==e.table)return!1;const t=e.getParentStore();return"block"===(null==t?void 0:t.table)&&"tab"===(null==t?void 0:t.getType())}))}));return n.mN(n.xH(o),(e=>e.id))}(e,t);for(const n of o){const e=n.getParentStore();var a;if((null==e?void 0:e.table)===r.iU&&"tab"===(null==e?void 0:e.getType()))d.x2({store:e,id:n.id,currentUserId:null===(a=l.default.state.currentUserStore)||void 0===a?void 0:a.id})}return o}async function h(e,t){await async function(e,t){const o=t.map((t=>c.G.createChildStore(e,{table:r.iU,id:t})));await Promise.all(o.map((e=>i.s(e))))}(e,t);const o=n.mN([...m(e,t),...g(e,t)],(e=>e.id));await async function(e){await Promise.all(e.map((e=>a.r(e))))}(o)}},61045:(e,t,o)=>{o.d(t,{NQ:()=>O,Q7:()=>G,YC:()=>z,Zv:()=>L,_4:()=>q,aB:()=>N,bx:()=>j,hQ:()=>W,hl:()=>U});var n=o(73935),r=o(14577),i=o(72126),a=o(68056),s=o(77546),l=o(89224),c=o(47372),d=o(3994),p=o(75987),u=o(95802),m=o(55521),g=o(96198),h=o(5162),f=o(34859),y=o(80796),v=o(64233),b=o(65686),S=o(19111),_=o(69454),w=o(19671),k=o(13023),x=o(88923),I=o(35661),C=o(27724),T=o(10743),M=o(24666),P=o(50906);function A(e,t,o,n){const r=(o-t)/o,i=n/10/60,a=i+(3*n/60-i)*Math.min(r*r,1);return e.device.isIOS?Math.ceil(a):a}const D=1e3,B=i.P2((e=>{P.PL5(e,{direction:"top"})}),D),R=i.P2((e=>{P.PL5(e,{direction:"bottom"})}),D),E=i.P2((e=>{P.PL5(e,{direction:"left"})}),D),F=i.P2((e=>{P.PL5(e,{direction:"right"})}),D);function N(e){const{environment:t,scroller:o,currentMouseX:n,currentMouseY:r,verticalEdgeThreshold:i,horizontalEdgeThreshold:a,disableVerticalEdgeScroll:s,disableHorizontalEdgeScroll:l}=e,{clientRect:c,scrollTop:d,scrollHeight:p,scrollLeft:u,scrollWidth:m}=o.stores.store.state;if(c){if(o.props.type!==f.Z.X&&!s){const e=r-c.top;let n,a;_.Z.state.phase!==_.i.shown?(n=i,a=(0,h.Y)("supportsNativeBottomBarOverlappingWebView")?c.bottom-_.Z.estimatedNativeWebBottomOverlap()-r:c.bottom-r):(n=.25*_.Z.state.estimatedKeyboardWebViewOverlap,a=c.bottom-_.Z.estimatedNativeWebBottomOverlap()+n-r);const s=0===d,l=d+c.height===p;if(e<i&&!s){const n=A(t,e,i,c.height);o.scrollTo(d-n,void 0),n>0&&B(t)}if(a<n&&!l){const e=A(t,a,n,c.height);o.scrollTo(d+e,void 0),e>0&&R(t)}}if(o.props.type!==f.Z.Y&&!l){const e=n-c.left,r=c.right-n,i=0===u,s=u+c.width===m;if(e<a&&!i){const n=A(t,e,a,c.width);o.scrollTo(void 0,u-n),n>0&&E(t)}if(r<a&&!s){const e=A(t,r,a,c.width);o.scrollTo(void 0,u+e),e>0&&F(t)}}}}function j(e){const{element:t,scrollers:o,vertical:n,horizontal:r,animate:i}=e,a=t.getBoundingClientRect();if(n&&o.verticalScroller){const{reveal:e}=n,t=n.paddingToTopEdge||64,r=n.paddingToBottomEdge||64,s=o.verticalScroller,l=s&&s.getClientRect();if(s&&l){const o=l.top+t,n=l.bottom-r,c=a.top>o&&a.top<n,d=a.bottom>o&&a.bottom<n,p=a.top<o&&a.bottom>n,u=a.bottom-n,m=a.top-o;"top"===e?c||s.scrollByOffset(m,0,{animate:i}):"bottom"===e?d||s.scrollByOffset(u,0,{animate:i}):c||d||p||(Math.abs(u)<Math.abs(m)?s.scrollByOffset(u,0,{animate:i}):s.scrollByOffset(m,0,{animate:i}))}}if(r&&o.horizontalScroller){const{reveal:e}=r,t=r.paddingToLeftEdge||64,n=r.paddingToRightEdge||64,s=o.horizontalScroller,l=s&&s.getClientRect();if(s&&l){const o=l.left+t,r=l.right-n,c=a.left>o&&a.left<r,d=a.right>o&&a.right<r,p=a.left<o&&a.right>r,u=a.right-r,m=a.left-o;"left"===e?c||s.scrollByOffset(0,m,{animate:i}):"right"===e?d||s.scrollByOffset(0,u,{animate:i}):c||d||p||(Math.abs(u)<Math.abs(m)?s.scrollByOffset(0,u,{animate:i}):s.scrollByOffset(0,m,{animate:i}))}}}function O(e){const{component:t,horizontal:o,vertical:r,animate:i}=e;if(!t)return;const a=n.findDOMNode(t);return a&&a instanceof Element?j({vertical:r,animate:i,horizontal:o,element:a,scrollers:{verticalScroller:t.getContextVerticalScroller?t.getContextVerticalScroller():void 0,horizontalScroller:t.getContextHorizontalScroller?t.getContextHorizontalScroller():void 0}}):void 0}function L(){if(C.default.state.pivot)U([C.default.state.pivot.id]);else{U(C.default.state.stores.map((e=>e.id)))}}function U(e,t){const o=u.C.findScrollToSelectablesFromIds(e)[0];if(o){const{disableScrollToRevealHorizontal:e}=o.props;O({component:o,vertical:{reveal:"closest"},horizontal:e?void 0:{reveal:"closest"},animate:t})}}let Z=function(e){return e[e.top=0]="top",e[e.middle=1]="middle",e[e.bottom=2]="bottom",e[e.natural=3]="natural",e}({});function V(e){let{position:t}=e;const{paddingTop:o}=e;if("editing"!==M.default.state.mode)return;let n=e.paddingBottom;c.Z.find((e=>e.props.show))&&(n+=g.O);const r=l.get();if(r){const e=s.SD(r.commonAncestorContainer);if(!e)return;const i=s.hI(e).find((e=>e.scrollHeight>e.clientHeight));if(!i)return;const a=l.getRect(r);if(!a||!i)return;const c=i.getBoundingClientRect();if(!(r.startContainer instanceof Text)){const e=a;e.top+=4,e.bottom-=5,e.height-=9}const d=a.top<c.top+o,p=a.bottom>c.bottom-n;if(r.startContainer instanceof Text&&r.startOffset!==r.endOffset)return;if(t===Z.natural)if(p)t=Z.bottom;else{if(!d)return;t=Z.top}if(t===Z.top){const e=i.scrollTop+a.top,t=c.top+o;i.scrollTop=e-t}else if(t===Z.bottom){const e=i.scrollTop+a.bottom,t=c.bottom-n;i.scrollTop=e-t}else if(t===Z.middle){const e=i.scrollTop+a.top,t=c.top+c.height/2-10;i.scrollTop=e-t}}}function q(){return _.Z.estimatedNativeWebBottomOverlap()+20}function z(e){if(p.Z.isInlineAutocompleteOpen())return!0;const t=e.device.isMobile&&(!e.device.isNative||e.device.isTablet);return!!(!t&&S.Z.state.open||!t&&T.Z.state.open||!t&&function(){var e;const t="editing"===M.default.state.mode&&(null===(e=(0,a.QY)(M.default.state.multiSelection))||void 0===e?void 0:e.store);if(t){const e=t.getRecordStoreAtRootPath();if(e instanceof I.G){const t=e.getValue(),o=t&&t.type;return"link_to_page"===o||"link_to_collection"===o}}return!1}()||v.Z.state.open)}function W(e){const t=d.Z.shouldPreventMobileAutoScroll(e);z(e)?V({position:Z.top,paddingTop:20,paddingBottom:q()}):t||w.Z.state.isOpen&&!x.default.state.open||k.Z.state.isOpen||V({position:Z.natural,paddingTop:20,paddingBottom:q()})}const H=i.IH((e=>{const{device:t}=e;return new r.Z((()=>t.isMobile&&y.Z.state.isDragging||t.isMobile&&m.Z.state.swiping?f.Z.All:b.Z.getPreventScrollType()),{debugName:"preventScrollTypeStore"})}));function G(e){return H(e).state}},31299:(e,t,o)=>{o.d(t,{$w:()=>Y,CO:()=>re,D7:()=>V,E5:()=>U,M0:()=>H,RF:()=>Q,RT:()=>$,Te:()=>ie,UJ:()=>ce,WL:()=>le,Yu:()=>oe,bI:()=>G,bm:()=>K,df:()=>z,nJ:()=>q,pz:()=>te,ri:()=>se,sC:()=>ee,tw:()=>Z,vp:()=>L,yy:()=>ae,zf:()=>de});o(57658);var n=o(43261),r=o.n(n),i=o(94568),a=o(15070),s=o(33728),l=o(77657),c=o(58573),d=o(72126),p=o(63306),u=o(27006),m=(o(4615),o(45953)),g=(o(99405),o(21202)),h=o(77420),f=o(6287),y=o(19889),v=o(92338),b=o(64684),S=o(70203),_=o(97880),w=o(7928),k=(o(95477),o(57254)),x=o(4708),I=o(19124),C=o(98165),T=o(67669),M=o(15447),P=o(48141),A=o(16639),D=o(80444),B=o(69327),R=o(35661),E=o(78291),F=o(34583),N=o(88893),j=o(54642),O=o(45264);const L=300,U=75;async function Z(e){const{currentSpaceStore:t,currentSpaceViewStore:o}=D.default.state;if(t)return await P.hb({environment:e,currentSpaceStore:t,currentSpaceViewStore:o})}async function V(e){const{environment:t,query:o,limit:n,spaceId:r,requireEditPermissions:i,excludeTemplates:a,source:s,boostRecentlyViewedPages:l}=e,{currentSpaceStore:c}=D.default.state,d={results:[],recordMap:m.PF.create().toJson({allowVersionDowngrade:!1}),total:0,trackEventProperties:{}};if(!c)return d;const p=await Z(t),u=v.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:a,requireEditPermissions:i||void 0}),g={field:"relevance"};if(!o&&p){const e=P.iA({query:{query:{text:o,filters:u,sort:g},limit:n},localCachedPages:p,userId:t.currentUser.id,environment:t,applyRecallScoreThreshold:!1,canUseLtr:!1});return e||d}const h=await j.search(t,{type:v.n8.BlocksInSpace,query:o,spaceId:r,limit:n,filters:u,sort:g,source:s,recentPagesForBoosting:l?(0,M.Wk)(B.Z.getWithoutSubscribing(r)):void 0});if("failed"===h.type)throw h.error;return h.data}async function q(e){const t=await V(e);return{results:t.results.map((e=>e.id)),recordMap:t.recordMap}}async function z(e){const{environment:t,query:o,collectionId:n,limit:r,spaceId:i,excludeTemplates:a,source:s,includePublicPagesWithoutExplicitAccess:l,boostRecentlyViewedPages:c,ignoresHighlight:p}=e,u=new Array,m=await Z(t),g=v.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,includePublicPagesWithoutExplicitAccess:l,excludeTemplates:a}),h={field:"relevance"},y=j.search(t,{type:v.n8.BlocksInCollection,query:o,spaceId:i,collectionId:n,limit:r,filters:g,sort:h,source:s,recentPagesForBoosting:c?(0,M.Wk)(B.Z.getWithoutSubscribing(i)):void 0,ignoresHighlight:p});if(m){const e={table:f.v,id:n,spaceId:i},a=new R.NW(t,e);await a.load();const s=P.iA({query:{query:{text:o,filters:a.isPageTreeCollection()?{...g,ancestors:[n]}:{...g,parentId:n},sort:h},limit:r},localCachedPages:m,userId:t.currentUser.id,environment:t,applyRecallScoreThreshold:!1,canUseLtr:!1});s&&u.push(...s.results)}const b=await y;if("failed"===b.type){if(0===u.length)throw b.error}else{let e=b.data.results;o||(e=P.YB({sort:h,batchSize:r,currentUserId:t.currentUser.id,unsorted:e})),u.push(...e)}return{results:d.oA(d.jj(u.map((e=>e.id))))}}async function W(e){const{environment:t,query:o,ancestorId:n,limit:r,excludeTemplates:i,source:a}=e,s=await j.search(t,{type:v.n8.BlocksInAncestor,query:o,ancestorId:n,filters:v.u4({navigableBlockContentOnly:!0,excludeTemplates:i}),sort:{field:"relevance"},limit:r,source:a});if("failed"===s.type)throw s.error;return s.data}async function H(e){return{results:(await W(e)).results.map((e=>e.id))}}async function G(e){const{environment:t,query:o,limit:n,ancestorId:r,spaceId:i}=e,a=0===o.trim().length?{field:"lastEdited",direction:"desc"}:{field:"relevance"},s={query:o,filters:v.u4({isDeletedOnly:!0,navigableBlockContentOnly:!0,excludeTemplates:!1,editedBy:e.editedById?[e.editedById]:[]}),sort:a,limit:n,spaceId:i,source:"trash"},l=r?j.search(t,{type:v.n8.BlocksInAncestor,...s,ancestorId:r}):j.search(t,{type:v.n8.BlocksInSpace,...s}),c=await l;if("failed"===c.type)throw c.error;{const{results:e,recordMap:t,total:o}=c.data;return{results:e.map((e=>e.id)),recordMap:m.PF.create(t),endOfResultsReached:o===e.length}}}async function K(e,t){const{query:o,limit:n,source:r,requireEditPermissions:i,databaseType:a,spaceStore:s}=t;if(!s)return{results:[],total:0};const l=s.id,[c,p]=await Promise.all([pe(e,{...t,spaceId:l,requireEditPermissions:i,databaseType:a}),j.search(e,{type:v.n8.CollectionsInSpace,query:o,spaceId:l,limit:n,filters:{...v.u4({excludeTemplates:!0,requireEditPermissions:i,databaseType:a})},sort:{field:"relevance"},source:r,recentPagesForBoosting:(0,M.Wk)(B.Z.get(l))})]),u=d.G0("success"===p.type?d.oA(p.data.results.map((e=>e.collectionId))):[],c).slice(0,n);return{results:u,total:"success"===p.type?p.data.total:u.length}}async function $(e){const{environment:t,collectionViewBlockStore:o,spaceStore:n,parentStore:r,query:i,limit:a,requireEditPermissions:s,databaseType:l}=e;if(!r.isDefaultRecordCache())return{results:[],total:0};let c=[],p=0;if(!i){const e=t.currentUser.id;n&&(c=[...O.lG({currentUserId:e,spaceId:n.id}).map((e=>R.NW.createChildStore(r,{table:f.v,id:e})))]),c=[...d.oA(null==o?void 0:o.getCollectionViewStores().map((e=>e.getCollectionStore()))),...c],l&&(c=c.filter((e=>{const t=e.getDatabaseType();return!!t&&l.includes(t)}))),c=d.mN(c,(e=>e.id)).filter((e=>!s||e.canEdit()))}const u=await K(t,{query:i,limit:a,source:"collection_settings_source",requireEditPermissions:s,databaseType:l,spaceStore:n});return c=[...c,...u.results.map((e=>R.NW.createChildStore(r,{table:f.v,id:e})))],p=u.total,c=c.filter((e=>!(0,C.wf)(e)&&e.canRead())),await Promise.all(c.map((async e=>{await e.load()}))),{results:d.oA([...d.mN(c,(e=>e.id)).slice(0,a).map((e=>e.id))]),total:p}}function Y(e){const{query:t,intl:o}=e,{currentSpaceStore:n}=D.default.state,r=null==n?void 0:n.getPermissionGroups();if(!r)return[];return t?(0,c.ZP)(t,r,(e=>(0,A.kF)({intl:o,group:e}))):r}async function Q(e){const{query:t}=e,{currentSpaceStore:o}=D.default.state;if(!o)return[];return X({currentSpaceStore:o,query:t,botIds:await J(e)})}async function J(e){const{environment:t}=e,{currentSpaceStore:o}=D.default.state;if(!o)return[];const n=o.id;await F.OR({environment:t,spaceId:n});const{data:r}=E.default.state;if(!r)return[];const i=(0,N.NM)(r);return d.jj(i.map((e=>e.botId)))}async function X(e){const{currentSpaceStore:t,query:o,botIds:n}=e,r=d.oA(await Promise.all(n.map((async e=>{const o=(0,R.Kv)(t,{table:h.cZ,id:e,spaceId:t.id});return await o.load(),o.getValue()}))));return o?(0,c.ZP)(o,r,a.y2):r}async function ee(e){const{query:t,environment:o,spaceId:n,botSettings:r}=e;if(!n)return[];const i=await j.searchIntegrations(o,{query:t});if("success"===i.type){const e=i.data.integrationIds,t=r&&r.integration_approval_statuses?Object.keys(r.integration_approval_statuses):[],o=Boolean(null==r?void 0:r.integration_restrictions),n=Boolean("approved_or_built_by_notion"===(null==r?void 0:r.integration_restrictions));return o?e.filter((e=>n?t.includes(e)||(0,l.BP)({integrationId:e,env:"production"}):t.includes(e))):e}if("failed"===i.type)throw i.error;(0,_.t1)(i)}async function te(e){var t;let{currentSpaceStore:o,query:n,userIds:r}=e,a=d.oA(await Promise.all(r.map((async e=>{const t=R.U6.createChildStore(o,{table:y.KJ,id:e});return await t.load(),t.getValue()}))));(0,I.Gw)()&&(0,k.A)()&&(a=d.oA(a.map((e=>{const t=(0,i.OU)(e.email);if(t)return{...e,email:t}}))));const l=new Set(o.getEmailDomains()),p=(null===(t=E.default.state.data)||void 0===t?void 0:t.userSimilarity)??{},u=Math.max(...Object.values(p));function m(e){var t;return e===(null===(t=D.default.state.currentUserRootStore)||void 0===t?void 0:t.userId)?u+1e-5:p[e]??0}const g=d.xb(p)?a:a.sort(((e,t)=>{const o=m(e.id);return m(t.id)-o}));return n?(0,c.ZP)(n,g,w.of,{getSortScore:e=>{const{original:t,score:o}=e,n=t.email&&(0,s.Gd)(t.email);return o*(n&&l.has(n)?-2:-1)}}):a}async function oe(e){const{currentSpaceStore:t}=D.default.state;if(!t)return[];const o=e.query.startsWith("@")?e.query.slice(1):e.query,n=await ne(e);return await te({currentSpaceStore:t,query:o,userIds:n})}async function ne(e){const{environment:t,membersOnly:o}=e,{currentSpaceStore:n}=D.default.state;if(!n)return[];await F.OR({environment:t,spaceId:n.id});const{data:r}=E.default.state;if(!r)return[];const i=(0,N.CM)(r).filter((e=>!(o&&!(0,u.Jy)(e.role)))),{mainEditorCurrentBlockStore:a,currentUserStore:s}=D.default.state,l=a&&!o?(0,T.YO)(a).flatMap((e=>{let{permissionItem:t}=e;return(0,u.jg)(t)?[t.user_id]:[]})):[],c=((0,x.F$)()&&a?function(e,t){const o=C.VP(e);if(o){const e=new Set((0,b.Hf)({membership:o.getRawMembership()}));return t.filter((t=>"none"!==t.role||t.isPageGuest||t.isTeamGuest&&e.has(t.userId)))}return t.filter((e=>"none"!==e.role||e.isPageGuest))}(a,i):i).map((e=>e.userId));return d.jj([...d.oA([null==s?void 0:s.userId]),...l,...c])}async function re(e){const[t,o]=await Promise.all([oe(e),Q(e)]);return{users:t,bots:o}}async function ie(e){const[t,o]=await Promise.all([ne(e),J(e)]);return{userIds:t,botIds:o}}async function ae(e,t){const o=(0,s.H3)(t);if((0,s.oH)(o)&&o){const t=await j.findUser(e,{email:o});if("failed"===t.type)throw t.error;const n=t.data;return n.value?{user:n.value.value}:{email:o}}return{}}async function se(e){const{query:t,userIds:o,botIds:n}=e,{currentSpaceStore:r}=D.default.state;if(!r)return{users:[],bots:[]};const[i,a]=await Promise.all([te({currentSpaceStore:r,query:t,userIds:o}),X({currentSpaceStore:r,query:t,botIds:n})]);return{users:i,bots:a}}async function le(e){const{nearBlock:t,environment:o,query:n,source:r}=e,{currentSpaceStore:i}=D.default.state,a=t&&(0,T.YO)(t).find((e=>{let{permissionItem:t}=e;return(0,u.$D)(t)}));if(i){return(await V({environment:o,query:n,limit:20,spaceId:i.id,requireEditPermissions:!1,excludeTemplates:!0,source:r,boostRecentlyViewedPages:!0})).results}if(a&&a.from.table===g.iU){return(await W({environment:o,query:n,limit:20,ancestorId:a.from.blockId,excludeTemplates:!0,source:r})).results}return[]}async function ce(e){const{environment:t,query:o,source:n,limit:r}=e,{currentSpaceStore:i}=D.default.state;if(!i)return[];return(await V({environment:t,query:o,limit:r||20,spaceId:i.id,requireEditPermissions:!0,excludeTemplates:!0,source:n,boostRecentlyViewedPages:!1})).results.filter((e=>{const t=R.G.createChildStore(i,{table:g.iU,id:e.id}),o=(0,C.fJ)(t);return(0,p.$t)(o)}))}async function de(e){let{spaceViewStore:t,query:o,teamStores:n}=e;const r=d.oA(await Promise.all(n.map((async e=>(await e.load(),e.getValue()))))),i=t.getTeamsStores(),a=new Set(i.map((e=>e.id)));return o?(0,c.ZP)(o,r,(e=>e.name),{getSortScore:e=>{const{original:t,score:o}=e;return o*(a.has(t.id)?-2:-1)}}):r}function pe(e,t){const{query:o,limit:n,spaceId:i,requireEditPermissions:a,databaseType:s}=t,l=[];return e.defaultRecordCache.inMemoryRecordCache.forEachRecord(e.currentUser.id,(e=>{let{model:t,role:c}=e;if(!(l.length>=n)&&t.table===f.v&&t&&t.space_id===i){if(a&&!(0,u.J5)(c))return;const e=(0,S.QaF)(t.getName()),n=t.getDatabaseType();r().test(o,e)&&(!s||s&&n&&s.includes(n))&&l.push(t.pointer.id),t.getDatabaseType}})),l}},87531:(e,t,o)=>{o.d(t,{IB:()=>k,Kf:()=>_,LR:()=>S,UT:()=>w,bn:()=>I,em:()=>x});o(21703);var n=o(15157),r=o(4615),i=o(89101),a=o(94804),s=o(70203),l=o(33932),c=o(56206),d=o(19124),p=o(77907),u=o(80444),m=o(21273),g=o(98180),h=o(22294),f=o(55320),y=o(29026),v=o(50906),b=o(75018);const S=6;function _(e){f.default.state.open?k():w(e)}function w(e){const{environment:t,renderAsPage:o,isQuickSearch:n,isPublicPageSearch:a}=e,s=(0,r.ZP)(),l=Date.now();if(Boolean(n))f.default.update((e=>({...e,open:!1,openAsPage:!0,openedTimeMs:l,sessionId:s,isPublicPageSearch:a??!1}))),f.default.setShouldSidePeekOpenToDefault(t);else if(Boolean(o))b.navigate({environment:t,url:`${i.VP.nativeTab}/search`,redirect:!0}),f.default.update((e=>({...e,open:!1,openAsPage:!0,openedTimeMs:l,sessionId:s,isPublicPageSearch:a??!1}))),f.default.setShouldSidePeekOpenToDefault(t);else{if(f.default.state.open)return;f.default.update((e=>({...e,open:!0,openAsPage:!1,isQuickSearch:!1,openedTimeMs:l,sessionId:s,isPublicPageSearch:a??!1}))),f.default.setShouldSidePeekOpenToDefault(t)}v.wFN(e.environment,{from:e.analyticsFrom,searchSessionId:s})}const k=()=>{f.default.state.open&&(f.default.reset(),h.Z.setKeyboardMode(!1))};async function x(e){var t,o;const{environment:n,shouldResetAssistantStore:r=!0,isQuickSearch:i}=e,a=u.default.state.mainEditorCurrentBlockStore??u.default.state.currentSpaceStore,h=y.ZP.state.query.text,b=f.default.state.sessionId;if(!a)return;const{assistantActions:_}=await p.deps.assistant.loader();let w=g.Z.getActiveSessionId();if(!w||r){w=(await _.resetAndInitializeAssistantStores({environment:n,primeTextInput:h.length<=S?h:void 0,isQnA:!m.Z.isAssistantEnabled()})).sessionId}if(!w)throw new Error("No AI Assistant session found");(0,d.Fk)(i)&&f.default.isOpen()?(c.d.state.open&&(0,l.r)(),y.ZP.update((e=>({...e,mode:"assistant"})))):(k(),l.O({view:"chat"}));const x=h.length>S;x&&_.commitHumanStep({environment:n,text:(0,s.TPx)(h),sessionId:w}),v.IR(n,{configurationState:null===(t=g.Z.getSessionContext(w))||void 0===t||null===(t=t.assistantConfigurationStore)||void 0===t?void 0:t.state,runtimeState:null===(o=g.Z.getSessionContext(w))||void 0===o||null===(o=o.assistantRuntimeStore)||void 0===o?void 0:o.state,hasQuery:x,from:"search",searchSessionId:b})}function I(e){const t=!f.default.state.shouldSidePeekOpen;n.Z.set({userId:e,key:a.Y6,value:t}),f.default.update((e=>({...e,shouldSidePeekOpen:t})))}},5851:(e,t,o)=>{o.d(t,{n:()=>g,y:()=>h});o(57658);var n=o(72126),r=o(97880),i=o(5366),a=o(33929),s=o(50906),l=o(54642),c=o(47307),d=o(9953),p=o(29974),u=o(39699);const m=(0,i.defineMessages)({saveFieldError:{id:"securitySAMLSettings.saveSettingsError.message",defaultMessage:"Something went wrong."}});function g(e,t){const{securitySettingsState:o,spaceStore:n}=t,{disablePublicAccess:r,disableGuests:i,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:m,disableExternalMembershipRequests:g,disableGuestMembershipRequests:h,enableAiFeature:f,disableTeamGuests:y,enableGuestInviteRequests:v}=o;return u.createAndCommit({userAction:"securitySettingsActions.saveSecuritySettings",environment:e,perform:t=>{p.Xr({environment:e,transaction:t,spaceStore:n,disablePublicAccess:r,disableGuests:i,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:m,disableExternalMembershipRequests:g,disableGuestMembershipRequests:h,enableAiFeature:Boolean(f),disableTeamGuests:y,enableGuestInviteRequests:v})}})}function h(e,t){const{securitySettingsStore:o,spaceStore:i,fields:p}=t,g={...o.state},h={...o.state,...p};o.setState(h),void 0!==p.disableGuests&&(l.updateDisableGuestsOnSpace(e,{spaceId:i.id,newDisableGuestsValue:p.disableGuests,keepExistingGuests:Boolean(p.keepExistingGuests)}).then((e=>{if("failed"===e.type)return c.showErrorMessage(a.default.formatMessage(m.saveFieldError)),void o.setState(g)})),s.o8J(e,{new_value:p.disableGuests,keep_existing_guests_if_disabled:Boolean(p.keepExistingGuests)})),u.createAndCommit({userAction:"SecuritySettings.saveToggle",environment:e,perform:e=>{e.postSubmitCallbacks.push((e=>{if(e)return c.showErrorMessage(a.default.formatMessage(m.saveFieldError)),void o.setState(g)}));const t=n.GM({disable_public_access:p.disablePublicAccess,disable_move_to_space:p.disableMoveToSpace,disable_export:p.disableExport,disable_space_page_edits:p.disableSpacePageEdits,disable_public_access_requests:p.disablePublicAccessRequests},(e=>n.kK(e)));d.sW({store:i,data:t,transaction:e});const s=n.GM({enable_guest_invite_requests:p.enableGuestInviteRequests,disable_membership_requests:p.disableMembershipRequests,disable_external_membership_requests:p.disableExternalMembershipRequests,disable_guest_membership_requests:p.disableGuestMembershipRequests},(e=>!(0,r.$K)(e)));Object.keys(s).length>0&&u.applyOperation({store:i,operation:{pointer:i.pointer,path:["settings"],command:"update",args:s},transaction:e})}}),(0,r.$K)(p.enableGuestInviteRequests)&&s.tBP(e,{new_value:p.enableGuestInviteRequests})}},42858:(e,t,o)=>{o.d(t,{Ah:()=>pe,Cl:()=>te,DQ:()=>ge,DV:()=>be,MD:()=>Q,Od:()=>Y,QZ:()=>de,Qw:()=>ee,VJ:()=>me,WG:()=>he,YP:()=>fe,ZJ:()=>ye,aO:()=>re,at:()=>ae,bj:()=>X,dK:()=>ce,is:()=>oe,jQ:()=>ue,mp:()=>ne,nG:()=>se,uE:()=>ve,zO:()=>J});o(57658),o(21703),o(52262),o(24506);var n=o(1302),r=o(15145),i=o(41432),a=o(72126),s=o(5366),l=o(21202),c=o(23867),d=o(63143),p=o(69278),u=o(95477),m=o(19037),g=o(28020),h=o(77181),f=o(40959),y=o(35683),v=o(33929),b=o(65598),S=o(41984),_=o(58202),w=o(95802),k=o(80444),x=o(77080),I=o(88923),C=o(35661),T=o(27724),M=o(34583),P=o(50906),A=o(54642),D=o(48299),B=o(30188),R=o(41433),E=o(47307),F=o(54532),N=o(54604),j=o(94419),O=o(19785),L=o(99553),U=o(75018),Z=o(61045),V=o(24677),q=o(84084),z=o(64964),W=o(15690),H=o(98104),G=o(39699),K=(o(68422),o(1742));const $=(0,s.defineMessages)({deletePages:{id:"action.deletePages.snackBarMessage",defaultMessage:"Moved to trash"}});function Y(e){var t,o;const{store:n,transaction:r}=e,i=w.C.findSelectablesFromStore(n).find((e=>Boolean(e.props.onRemove)));null==i||null===(t=(o=i.props).onRemove)||void 0===t||t.call(o,{transaction:r})}function Q(e){const{blocks:t,transaction:o}=e;if(1===t.length){const e=t[0];e&&b.PF(e)&&Y({store:e,transaction:o})}}function J(e){const t=w.C.findAllSelectablesFromIds(e.map((e=>e.id)));for(const o of t)o.stores.selectableStore.setState({...o.stores.selectableStore.state,showActionIsInFlight:!0})}function X(e){const t=w.C.findAllSelectablesFromIds(e.map((e=>e.id)));for(const o of t)o.stores.selectableStore.setState({...o.stores.selectableStore.state,showActionIsInFlight:!1})}async function ee(e){const{environment:t,blocks:o}=e;let n=!0;const r=[];for(const s of o){const e=_.R.findBlockFromStore(s);if(e&&a.mf(e.handleRemoveBlockFromComment)){if(await e.handleRemoveBlockFromComment())continue}else if(e&&a.mf(e.canRemoveBlock)){const t=await e.canRemoveBlock();if(!t.canRemove)return;n=t.canUndo}const o=await D.NN({environment:t,block:s,action:"delete"});if("user_canceled"===o)return;o.length>1?r.push(...o):r.push(s)}if(0===r.length)return;if(x.default.checkGate("collection_subitem_nested_operations"))await B.VP({environment:t,blocks:r,canUndo:n});else{const{serverCommitResult:e}=G.createAndCommit({userAction:"selectableBlockActions.removeBlocksWithMaybeConfirmation",environment:t,canUndo:n,perform:e=>{te({environment:t,blocks:r,transaction:e})}});await e}const{currentSpaceStore:i}=k.default.state;i&&r.some((e=>e.isPageBlock()))&&z.d4({item:{label:v.default.formatMessage($.deletePages)},undoFunc:()=>{for(const e of r)A.restoreBlock(t,{pointer:{table:l.iU,id:e.id,spaceId:e.pointer.spaceId||i.id}})}}),r.some((e=>{var t;return e.id===(null===(t=I.default.peekTarget.state)||void 0===t?void 0:t.id)}))&&L.xv(t,void 0)}function te(e){const{environment:t,blocks:o,transaction:n,preventClearSelection:r}=e,s=o[0],l=function(e){const t=w.C.getMembersByDOMOrder({filter:()=>!0}),o=a.cx(t,(t=>t.props.store===e)),n=t[o];if(!n)return;const r=n.getContextSelectableContainer(),i=a.tP(t,0,o),s=a.dF(i,(e=>e.props.canSelect&&e.getContextSelectableContainer()===r));if(s)return s.props.store;const l=a.tP(t,o+1).find((e=>Boolean(e.props.canSelect&&e.getContextSelectableContainer()===r)));if(l)return l.props.store}(s);!function(e){const{environment:t,block:o,entryPointName:n}=e,r=new K.GD({environment:t,userFlow:"user_flow_delete_block",entryPointName:n,timeoutMs:90*d.C0});if(r.isDisabled())return;const i=()=>{o.pathIsDead()&&r.succeed()};r.postFinishCallbacks.push((()=>{o.removeListener(i)})),o.addListener(i)}({environment:t,block:s,entryPointName:n.getUserActionForAnalyticsPurposesOnly()||"selectableBlockActions.removeBlocks"});for(const i of o)Y({store:i,transaction:n});if(r||(V.ZH(t),V.Fp({pivot:l})),m._J({environment:t,blocks:o,publicEditMode:void 0})||m.Nn({environment:t,blocks:o,publicEditMode:void 0})||m.oY({environment:t,blocks:o,publicEditMode:void 0})||o.some((e=>{var t;return e.getType()===i.Ti.transclusionContainer||(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())}))){n.postSubmitCallbacks.push((e=>{e||A.deleteBlocks(t,{blocks:o.map((e=>({id:e.id,spaceId:(0,c.C)(e.pointer.spaceId)}))),permanentlyDelete:!1})}));for(const e of o){const{app_id:o,app_config_uri:r}=e.getFormat();o&&r&&P.Cug(t,{block_id:e.id,app_id:o,app_config_uri:r}),O.zo({block:e,transaction:n})}U.navigateAwayIfCurrentPage({environment:t,blocks:o})}r||H.ZH(t)}function oe(e){const{environment:t,blocks:o,selection:n,transaction:r,replaceEmptyTextBlock:i,preventSetSelection:s,insertAfterBlock:l}=e,c=g.RM();if(!c)throw new Error("No root store.");let d;if(n.length>0){const e=l||n.at(-1);let s=e;if(Boolean(o.find((e=>e.isType("column_list"))))){const t=null==e?void 0:e.findRecordStoreUIAncestor((e=>e&&e instanceof C.G&&e.isType("column_list"))).ancestor;t&&t instanceof C.G&&(s=t)}const p=w.C.find((e=>e.props.store===s&&e.props.canInsertBelow&&e.props.onInsertBelow));if(p&&p.props.onInsertBelow)d=a.oA(p.props.onInsertBelow({insertStores:o,transaction:r})),i&&e&&e.isEmptyTextBlock()&&te({environment:t,blocks:[e],transaction:r});else{d=a.d9(o).reverse().map((e=>j.Ce({parent:c.getContentStore(),prepend:e,transaction:r}).child))}}else if(c.isCollectionView()){const e=_.R.findBlockFromStoreWithMethod(c,"insertBlocks");if(!e)throw new Error("No collection view found.");d=e.insertBlocks(o,r)}else{const e=c.getContentStore();d=o.map((t=>j.R3({parent:e,append:t,transaction:r}).child))}return Boolean(s)||(d=d.flatMap((e=>e.isType("column_list")?e.getContentStores().flatMap((e=>e.getContentStores())):[e])),V.Z5({environment:t,stores:d})),d}function ne(e){const{blocks:t}=e,o=t[0];if(o){const t=w.C.findSelectableFromStore(o);t&&t.props.onEnter&&t.props.onEnter(e)}}function re(e){const{environment:t,createBlockItem:o,selection:n,transaction:r,analyticsFrom:i,preventSetSelection:a}=e,s=T.default.getCurrentRecordCache(),l=new K.BW({environment:t,userFlow:"page"===(null==o?void 0:o.blockType)?"user_flow_create_page":"user_flow_create_block",succeedOnEnqueue:!0});let c;if(M.M_(t)&&o&&s){var d;const e=R.fC({environment:t,createBlockItem:o,transaction:r,inMemoryRecordCache:s,from:i,useCrdt:0!==n.length?n[0].useCrdt():(null===(d=g.RM())||void 0===d?void 0:d.useCrdt())??!1});l.track(e.pointer,r),c=oe({environment:t,blocks:[e],selection:n,transaction:r,replaceEmptyTextBlock:!1,preventSetSelection:a})[0]}else l.fail("invalid_state");return c}function ie(e){const{environment:t,createBlockItem:o,selection:n,transaction:r,analyticsFrom:i}=e,a=T.default.getCurrentRecordCache();let s;if(M.M_(t)&&o&&a){var l;s=function(e){const{environment:t,selection:o,transaction:n}=e,{blocks:r}=e,i=g.RM();if(!i)throw new Error("No root store.");if(o.length>0){const e=o[0],i=w.C.find((t=>t.props.store===e&&t.props.canInsertAbove&&t.props.onInsertAbove));if(!i||!i.props.onInsertAbove)throw new Error("No Selectable found.");const a=i.props.onInsertAbove({insertStores:r,transaction:n});return V.Z5({environment:t,stores:a}),a}{const e=i.getContentStore(),o=r.map((t=>j.R3({parent:e,append:t,transaction:n}).child));return V.Z5({environment:t,stores:o}),o}}({environment:t,blocks:[R.fC({environment:t,createBlockItem:o,transaction:r,inMemoryRecordCache:a,from:i,useCrdt:0!==n.length?n[0].useCrdt():(null===(l=g.RM())||void 0===l?void 0:l.useCrdt())??!1})],selection:n,transaction:r})[0]}return s}function ae(e){const{environment:t,selection:o,transaction:n}=e,r=re({...e,preventSetSelection:!0});r&&be({environment:t,insertedStores:[r],isCreated:!0}),Q({transaction:n,blocks:o})}async function se(e){const{environment:t,blocks:o,duplicateOnlyCollectionSchema:r}=e;if(!M.M_(t))return;let i=o;if(1===o.length){const e=await D.NN({environment:t,block:o[0],action:"duplicate"});if("user_canceled"===e)return;i=e}const a=x.default.checkGate("collection_subitem_nested_operations"),s=i.at(0);s&&(a&&(0,h.wP)(s)?await B.W9({blocks:i,environment:t}):G.createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,perform:e=>{le({environment:t,blocks:i,transaction:e,preferDuplicateLocation:"local",duplicateOnlyCollectionSchema:r})},transactionTooBigFallback:e=>{le({environment:t,blocks:i,transaction:e,preferDuplicateLocation:"server",duplicateOnlyCollectionSchema:r})}}),n.default.afterNextFlush((()=>{Z.Zv()})))}function le(e){const{environment:t,blocks:o,transaction:n,preferDuplicateLocation:r,lastTopLevelBlock:i,preventSetSelection:s,duplicateOnlyCollectionSchema:l}=e,d=a.vM(o,(e=>e.getFormat().app_id??e.id)),p=[];return a.Ed(d,(e=>{const i=e[0],a=!i.isTransclusionType(),[s,d]=F.Qi({environment:t,stores:e,addCopyName:(0,S.Z)(i),transaction:n,deepCopyTransclusionContainers:a,resolveTemplateVariables:!(i.isInsideTemplate()||i.isInsideFactoryOrDuplicateBlocksAction()),targetSpaceId:(0,c.C)(i.pointer.spaceId),baseUrl:u.default.domainBaseUrl,publicDomainName:u.default.publicDomainName,preferDuplicateLocation:r,useCrdt:0!==o.length&&o[0].useCrdt(),duplicateOnlyCollectionSchema:l});p.push(...s),d.then((e=>{e&&E.showErrorMessage(e)}))})),oe({environment:t,blocks:p,selection:i?[i]:o,transaction:n,replaceEmptyTextBlock:!1,preventSetSelection:s}),p}function ce(e){const t=e.blocks[0],{blockLocationOfTargetBlock:o}=e,n=_.R.find((e=>e instanceof p.Z&&e.props.store===t&&(!o||e.props.blockLocation===o)));n&&n.canRenderFullScreen()&&N.ui({environment:n.environment,renderFullScreenNode:n.renderFullScreenNode,fullScreenNodeRect:n.getFullScreenNodeRect(),block:t})}function de(e){let t;e.blocks.find((e=>{const o=_.R.findBlockFromStoreWithMethod(e,"activate");return!!o&&(t=o,!0)})),t&&t.activate()}function pe(e){e.blocks.forEach((t=>{const o=t.getParentStore();o&&o.table===l.iU&&o.getType()===i.Ti.tab&&W.x2({store:o,id:t.id,currentUserId:e.environment.currentUser.id})}))}function ue(e){const t=e.blocks[0],o=_.R.findBlockFromStoreWithMethod(t,"configure");o&&(o.configure(),P.PEc(e.environment,{from:"block_action"}))}function me(e){const t=e.blocks[0],o=_.R.findBlockFromStoreWithMethod(t,"caption");o&&o.caption()}function ge(e,t){const o=a.oA(w.C.findSelectablesFromIds(t)).map((e=>e.props.store));V.Z5({environment:e,stores:o})}function he(e,t){const o=w.C.findScrollToSelectablesFromIds(t);o[0]&&(Z.NQ({component:o[0],vertical:{reveal:"top"},horizontal:{reveal:"closest"}}),V.Z5({environment:e,stores:o.map((e=>e.props.store))}))}function fe(e){const{environment:t,blocks:o}=e,n=o[0].findRecordStoreUIAncestor((e=>e instanceof C.G&&e.isCollectionView())).ancestor;n&&U.navigateToBlock({environment:t,store:n,visitType:y.vu.Link,pageVisitSource:r.tY.Expand})}function ye(e){const{blocks:t,transaction:o,environment:r}=e,i=re({environment:r,selection:t,createBlockItem:f.Hc.text,analyticsFrom:"text_insert_below",transaction:o});return i&&n.default.afterNextFlush((()=>{q.hb({environment:r,blockStore:i})})),i}function ve(e){const{blocks:t,transaction:o,environment:r}=e,i=ie({environment:r,selection:t,createBlockItem:f.Hc.text,analyticsFrom:"text_insert_above",transaction:o});return i&&n.default.afterNextFlush((()=>{q.hb({environment:r,blockStore:i})})),i}function be(e){const{environment:t,insertedStores:o,isCreated:r}=e;r?n.default.afterNextFlush((()=>{const e=o[0];if(!e)return;const n=_.R.findBlockFromStoreWithMethod(e,"handleCreated");n?n.handleCreated():(V.Ys({environment:t,store:e}),V.Db(t))})):V.Z5({environment:t,stores:o})}},24677:(e,t,o)=>{o.d(t,{$Y:()=>E,Af:()=>F,Ch:()=>ee,DI:()=>G,Db:()=>Z,FC:()=>$,Fp:()=>N,Jy:()=>X,KX:()=>M,OS:()=>D,Ys:()=>L,Z5:()=>O,ZH:()=>q,aw:()=>R,e2:()=>H,eP:()=>U,hn:()=>J,ji:()=>A,td:()=>Y,w5:()=>Q,wI:()=>j,yu:()=>V,zJ:()=>z});o(57658);var n=o(55010),r=o(1302),i=o(72126),a=o(95371),s=o(77181),l=o(28314),c=o(69645),d=o(35328),p=o(27406),u=o(16339),m=o(95802),g=o(41662),h=o(12211),f=o(50628),y=o(27724),v=o(45131),b=o(45264),S=o(30188),_=o(89951),w=o(67060),k=o(61045),x=o(84084),I=o(98104),C=o(29373),T=o(39699);function M(){const e=y.default.getCurrentDefaultContainer();if(e){return m.C.getMembersByDOMOrder({filter:t=>t.getContextSelectableContainer()===e&&t.props.canSelect}).map((e=>e.props.store))}return[]}function P(e){const t=y.default.state.stores,o=y.default.state.pivot,n=i.oA(i.zu(t,o));let r;r=o===i.Z$(t)?t[t.length-2]:t[1],O({environment:e,stores:n,pivot:r})}function A(e){const t=l.yA();return e.device.isMac?t.shift&&t.command:t.shift&&t.option}function D(){return l.yA().shift}function B(e){e.sort(((e,t)=>(0,n.Z)(m.C.findNodeFromStore(e),m.C.findNodeFromStore(t))))}function R(e){const t=new Array(e.length);return m.C.forEach((o=>{if(o.props.canSelect){const n=e.indexOf(o.props.store);if(n>=0){const e=o.getNode();e&&(t[n]=e)}}})),e.filter(((o,n)=>{const r=t[n];return o&&!e.some(((e,o)=>{const n=t[o];return Boolean(n&&n!==r&&r&&n.contains(r))}))}))}function E(e){y.default.setState({...y.default.state,phase:e.phase}),e.phase===y.SelectionPhase.Editing||e.preventClearEditingText||I.ZH(e.environment)}function F(e){const{stores:t}=e,o=y.default.state.stores,n=i.G0(t,o);n.length===t.length&&n.length===o.length||y.default.setState({...y.default.state,stores:e.stores}),t.length>0&&(b.wG(),g.g$.blockSelectionInSimpleTable(t)||g.HM.clearSelection())}function N(e){y.default.setState({...y.default.state,pivot:e.pivot})}function j(e){const{stores:t}=y.default.state;F({stores:t.map((t=>t===e.store?e.replace:t))})}function O(e){const{environment:t}=e,o=R(e.stores);F({stores:o}),E({environment:e.environment,phase:e.phase||y.SelectionPhase.Selected}),1===o.length&&function(e){var t;const o=e.anchor,n=null===(t=m.C.findSelectableFromStore(o))||void 0===t?void 0:t.getNode();let r;n&&(r=y.default.getDefaultContainerFromTarget(n)),y.default.setState({...y.default.state,anchor:o,anchorContainer:r})}({anchor:o[0]});const n=e.pivot||o[0];if(N({pivot:n}),r.default.afterNextFlush((()=>{B(o)})),e.phase===y.SelectionPhase.Editing&&n)if(t.device.isMobile)k.hQ(t);else if(!t.device.isMobileBrowser){const e=m.C.findScrollToSelectableFromStore(n);e&&k.NQ({component:e,vertical:{reveal:"closest"},horizontal:e.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function L(e){void 0===e.toggle&&(e.toggle=!1),void 0===e.selectBetween&&(e.selectBetween=!1);const{stores:t}=y.default.state;if(e.toggle)i.q9(t,e.store)?O({environment:e.environment,stores:i.zu(t,e.store)}):O({environment:e.environment,stores:i.G0(t,[e.store])});else if(e.selectBetween){let o=i.d9(t);const n=M(),r=n.indexOf(e.store);i.q9(o,e.store)||o.push(e.store);const a=t[0];if(a){const e=n.indexOf(a);if(e>=0){const t=i.tP(n,r,e);o=i.G0(o,t)}}const s=i.Z$(t);if(s){const e=n.indexOf(s);if(e>=0){const t=i.tP(n,e,r);o=i.G0(o,t)}}O({environment:e.environment,stores:o})}else i.q9(t,e.store)||O({environment:e.environment,stores:[e.store]});E({environment:e.environment,phase:y.SelectionPhase.Selected})}function U(e){const{environment:t,store:o}=e;if(o)if(F({stores:[o]}),N({pivot:void 0}),E({environment:t,phase:y.SelectionPhase.Editing}),t.device.isMobile)k.hQ(t);else if(!t.device.isMobileBrowser){const e=m.C.findScrollToSelectableFromStore(o);e&&k.NQ({component:e,vertical:{reveal:"closest"},horizontal:e.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function Z(e){const{stores:t}=y.default.state,o=t[0];if(!o)return;const n=m.C.findSelectableFromStore(o);if(n&&n.props.onEditText){const t=n.props.onEditText;T.createAndCommit({userAction:"selectionActions.editSelection",environment:e,perform:e=>{t({isAtStartOfLine:!1,isClick:!1,transaction:e})}})}}function V(e){const{environment:t,stores:o}=e,n=i.Z$(o);if(!n)return;const r=m.C.findSelectableFromStore(n);if(r&&r.props.onEditText){const e=r.props.onEditText;T.createAndCommit({userAction:"selectionActions.editStoresAtEnd",environment:t,perform:t=>{e({isAtStartOfLine:!1,isClick:!1,transaction:t})}})}}function q(e){F({stores:[]}),E({environment:e,phase:y.SelectionPhase.Selected}),w.xv(),x.xv(),_.xv()}function z(e){const{environment:t}=e,o=y.default.state.stores;B(o);const n=y.default.state.pivot,r=o[0];if(r)if(e.shiftKey)if(n===r){const n=(0,c.Bj)({includeNonSelectableListContainer:!1}),s=(0,c.v5)(r,n.children),{prev:l,parent:d}=e.altKey?(0,a.Sr)(n,s):(0,a.YL)(n,s);if(l){const e=l.value.store;O({environment:t,stores:i.G0(o,[e]),pivot:e})}else if(d){const e=d.value.store;O({environment:t,stores:i.G0(o.filter((e=>!(0,a.Yz)(d,(t=>t.store===e)))),[e]),pivot:e})}}else P(e.environment);else{const o=(0,c.Bj)({includeNonSelectableListContainer:!1}),n=(0,c.v5)(r,o.children),{prev:i,parent:s}=e.altKey?(0,a.Sr)(o,n):(0,a.YL)(o,n);if(i){const e=i.value.store;O({environment:t,stores:[e],pivot:e})}else if(s){const e=s.value.store;O({environment:t,stores:[e],pivot:e})}else O({environment:t,stores:[r],pivot:r})}else if(n)O({environment:t,stores:[n]});else{const e=M(),o=i.Z$(e);o&&O({environment:t,stores:[o],pivot:o})}W()}function W(){const e=y.default.state.pivot||y.default.state.stores[0],t=m.C.findScrollToSelectableFromStore(e);t&&k.NQ({component:t,vertical:{reveal:"top"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}function H(e){const t=y.default.state.stores;B(t);const o=y.default.state.pivot;if(0!==t.length&&o)if((0,d.BX)(o)&&v.Z.isOpen(o.id))O({environment:e,stores:[o],pivot:o}),C.rd({blockId:o.id,state:!1,currentUserId:e.currentUser.id});else if((0,s.bX)(o))S.e2(o);else{const t=(0,c.Bj)({includeNonSelectableListContainer:!1}),n=(0,c.v5)(o,t.children),r=(0,a.ub)(n);if(r){const t=r.value.store;O({environment:e,stores:[t],pivot:t})}else O({environment:e,stores:[o],pivot:o})}else if(o)O({environment:e,stores:[o]});else{const t=M(),o=i.Z$(t);o&&O({environment:e,stores:[o],pivot:o})}W()}function G(e){const{environment:t}=e,o=y.default.state.stores;B(o);const n=y.default.state.pivot,r=i.Z$(o);if(r)if(e.shiftKey)if(n===r){const e=(0,c.Bj)({includeNonSelectableListContainer:!1}),n=(0,c.v5)(r,e.children),{next:s}=(0,a.Xf)(e,n);if(s){const e=s.value.store;O({environment:t,stores:i.G0(o,[e]),pivot:e})}}else P(t);else{const o=(0,c.Bj)({includeNonSelectableListContainer:!1}),n=(0,c.v5)(r,o.children),{next:i}=e.altKey?(0,a.Xf)(o,n):(0,a.lj)(o,n);if(i){const e=i.value.store;O({environment:t,stores:[e],pivot:e})}else O({environment:t,stores:[r],pivot:r})}else if(n)O({environment:t,stores:[n]});else{const e=M()[0];e&&O({environment:t,stores:[e],pivot:e})}K()}function K(){const e=y.default.state.pivot||i.Z$(y.default.state.stores);if(e){const t=m.C.findScrollToSelectableFromStore(e);t&&k.NQ({component:t,vertical:{reveal:"bottom"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function $(e){const t=y.default.state.stores;B(t);const o=y.default.state.pivot;if(0!==t.length&&o)if((0,d.BX)(o)&&!v.Z.isOpen(o.id))O({environment:e,stores:[o],pivot:o}),C.rd({blockId:o.id,state:!0,currentUserId:e.currentUser.id});else if((0,s.bX)(o))S.FC(o);else{const t=(0,c.Bj)({includeNonSelectableListContainer:!1}),n=(0,c.v5)(o,t.children),r=(0,a.si)(n);if(r){const t=r.value.store;O({environment:e,stores:[t],pivot:t})}else O({environment:e,stores:[o],pivot:o})}else if(o)O({environment:e,stores:[o]});else{const t=M()[0];t&&O({environment:e,stores:[t],pivot:t})}K()}function Y(e){const t=M();O({environment:e,stores:t,pivot:t[0]})}function Q(e){const t=M()[0];if(t){O({environment:e,stores:[t],pivot:t});const o=m.C.findScrollToSelectableFromStore(t);o&&k.NQ({component:o,vertical:{reveal:"top"},horizontal:o.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function J(e){const t=M(),o=t[t.length-1];if(o){O({environment:e,stores:[o],pivot:o});const t=m.C.findScrollToSelectableFromStore(o);t&&k.NQ({component:t,vertical:{reveal:"bottom"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function X(){const e=performance.now(),t=new Map,o=new Map;m.C.forEach((e=>{const n=e.getNode();if(n&&n instanceof Element){const r=n.getBoundingClientRect();t.set(e,r),o.set(n,r)}}));const n=new Map;u.Z.forEach((e=>{const t=e.getNode();t&&t instanceof Element&&n.set(e,t.getBoundingClientRect())}));const r=new Map;p.Z.forEach((e=>{const t=e.getNode();t&&t instanceof Element&&r.set(e,t.getBoundingClientRect())})),f.Z.setState({...f.Z.state,selectableRectMap:t,selectableContainerRectMap:n,selectableElementRectMap:o,lastUpdate:e}),h.Z.setState({...h.Z.state,dropTargetRectMap:r})}const ee=i.P2(X,200)},84084:(e,t,o)=>{o.d(t,{RL:()=>S,_P:()=>v,hb:()=>b,xv:()=>_});var n=o(13991),r=o(70203),i=o(69783),a=o(73959),s=o(89224),l=o(95802),c=o(64233),d=o(19111),p=o(10743),u=o(50906),m=o(24677),g=o(97444),h=o(98104);const f=new Set(["/","ï¼"]),y={"ja-JP":new Set(["ï¼›"])};function v(e){const{environment:t,textStore:o,oldSelection:a,oldTextValue:l}=e,m=r.eeV(o.getValue()||[]),g=a.startIndex,h=m[g],v=y[n.SP]||new Set;if(!f.has(h)&&!v.has(h))return;const b=r.gPn(m,g-10,g).join("");if(/[0-9]$/.test(b[b.length-1]))return;if(b.endsWith("http:")||b.endsWith("http:/")||b.endsWith("https:")||b.endsWith("https:/"))return;if(p.Z.state.open||i.Z.state.open||d.Z.state.open||c.Z.state.open)return;if(t.device.isPhone)return;const S=s.get();if(!S)return;const _=s.getRect(S);_&&(p.Z.setState({open:!0,isAddMenu:!1,textStore:o,oldTextValue:l,oldSelection:a,selectionRect:_,lettersAtLastResult:0,filter:""}),u.V_i(t))}function b(e){const{environment:t,blockStore:o}=e,n=p.Z.state;if(m.eP({environment:t,store:o}),h.N_({store:o.getBlockTitleStore()}),!n.open&&!t.device.isPhone){const e=o.getBlockTitleStore(),t=l.C.getRectFromStore(o);t&&p.Z.setState({open:!0,isAddMenu:!0,textStore:e,oldTextValue:e.getValue(),oldSelection:{startIndex:0,endIndex:0},selectionRect:t,lettersAtLastResult:0,filter:""})}}function S(e){const{transaction:t,environment:o}=e,n=p.Z.state;if(n.open){const{textStore:e,oldTextValue:r,oldSelection:i}=n;g.sO({environment:o,store:e,value:r,transaction:t}),_();const s=(0,a.sQ)(e);s&&m.eP({environment:o,store:s}),h.Z5({store:e,selection:i})}}function _(){p.Z.setState({open:!1,previousFilter:p.Z.state.open?p.Z.state.filter:void 0})}},64964:(e,t,o)=>{o.d(t,{C1:()=>d,d4:()=>c,oV:()=>s,rN:()=>l});o(67294);var n=o(71644),r=o(6854),i=o(1310),a=o(85893);function s(e){const t={...e,key:(0,n.ZP)()};i.ZP.setState({...i.ZP.state,currentItem:t}),"keep"!==t.durationMs&&setTimeout((()=>{i.ZP.state.currentItem===t&&"keep"!==i.ZP.state.currentItem.durationMs&&i.ZP.setState({...i.ZP.state,currentItem:void 0})}),t.durationMs??i.Ty)}function l(){i.ZP.setState({...i.ZP.state,currentItem:void 0})}function c(e){const{item:t,undoFunc:o}=e;s({...t,right:(0,a.jsx)(r.ow,{onUndo:o})})}function d(){i.ZP.state.shouldReset&&i.ZP.reset()}},29974:(e,t,o)=>{o.d(t,{$F:()=>he,$U:()=>Le,F1:()=>ue,IY:()=>Ie,L5:()=>me,LV:()=>Oe,Ns:()=>xe,O2:()=>Te,OF:()=>be,Xr:()=>Se,Xv:()=>Ae,Y5:()=>Ee,Yi:()=>ge,_Q:()=>De,_u:()=>ve,bf:()=>ke,cU:()=>je,ce:()=>de,eX:()=>ce,j:()=>we,jF:()=>Pe,lF:()=>Ce,mo:()=>Me,oy:()=>Be,sw:()=>Ne,wg:()=>Fe,wh:()=>le,y3:()=>pe,ys:()=>_e});o(21703),o(57658),o(67294);var n=o(15145),r=o(68626),i=o(72126),a=o(91155),s=o(27006),l=o(4615),c=o(45953),d=o(21202),p=o(15047),u=o(77858),m=o(29369),g=o(66079),h=o(62965),f=o(90965),y=o(54153),v=o(97880),b=o(5366),S=o(23622),_=o(95477),w=o(24215),k=o(15010),x=o(33929),I=o(38755),C=o(95697),T=o(55081),M=o(10929),P=o(30806),A=o(94841),D=o(78861),B=o(80444),R=o(21273),E=o(88632),F=o(73329),N=o(69327),j=o(81236),O=o(35661),L=o(34583),U=o(70060),Z=o(33493),V=o(60027),q=o(50906),z=o(54642),W=o(35253),H=o(47307),G=o(57400),K=o(94273),$=o(94419),Y=o(92625),Q=o(29533),J=o(76464),X=o(9953),ee=o(4408),te=o(75018),oe=o(5851),ne=o(28014),re=o(39699),ie=o(70782),ae=o(85893);const se=(0,b.defineMessages)({deletingWorkspace:{id:"spaceActions.deletingWorkspace.loadingMessage",defaultMessage:"Deleting workspaceâ€¦"},goOnlineCreateSpace:{defaultMessage:"Please go online to create your workspace.",id:"spaceActions.dialogError.createWorkspaceError.goOnline.message"},createSpaceError:{defaultMessage:"Sorry! We could not create your workspace. Please try again.",id:"spaceActions.dialogError.createWorkspaceError.message"},loginToCreateSpace:{defaultMessage:"Must be logged in.",id:"spaceActions.dialogError.createWorkspaceError.notLoggedIn.message"},moveToSpaceOnlineError:{defaultMessage:"Please go online to move content to another space.",id:"spaceActions.dialogError.moveContentError.goOnline.message"},cannotMoveShardRestriction:{defaultMessage:"Cannot move these pages at once.",id:"spaceActions.dialogError.moveContentError.cannotMovePages.message"},cannotMoveContent:{defaultMessage:"Sorry! We could not move this content. Please try again.",id:"spaceActions.dialogError.couldNotMoveContentError.message"},loginToMoveContent:{defaultMessage:"Must be logged in.",id:"spaceActions.dialogError.movetoWorkspace.notLoggedIn.message"},invalidSpaceStore:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.createTemplatesInSpace.invalidStorage.message"},invalidSpaceStoreOnNavigate:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.navigateToWorkspace.invalidStorage.message"},noSpaceViewOnJoin:{defaultMessage:"No space view data was created.",id:"spaceActions.dialogError.joinWorkspace.invalidWorkspaceStorage.message"},noLocalDataForPermissionGroup:{defaultMessage:"No local data about this workspace.",id:"spaceActions.dialogError.createOrUpdatePermissionGroup.invalidWorkspaceStorage.message"}});async function le(e){const{environment:t,name:o,domain:n,userRootStore:a,emailDomains:s,analyticsFrom:l,icon:c,planType:d,userPersona:h,shouldCreateUserPersonaTeam:f,shouldMakeUserPersonaTeamDefault:y}=e,{id:v}=t.currentUser;if(v){const e=await z.createSpace(t,{name:o,domain:n,emailDomains:s,icon:c,planType:d,initialPersona:h,shouldCreateUserPersonaTeam:f,shouldMakeUserPersonaTeamDefault:y});if("failed"===e.type){if(e.offline)throw new Error(x.default.formatMessage(se.goOnlineCreateSpace));throw new Error(x.default.formatMessage(se.createSpaceError))}const{spaceId:b,teamId:S,personaTeamId:_,inviteLinkCode:w}=e.data,I=new O.H2(t,{table:p.bx,id:b}),C=S?O.zX.createChildStore(I,{table:m.e0,id:S}):void 0,T=_?O.zX.createChildStore(I,{table:m.e0,id:_}):void 0,{serverCommitResult:M,performResult:{spaceViewStore:P}}=re.createAndCommit({userAction:"spaceActions.createSpace",environment:t,perform:e=>{const o=X.ae({environment:t,table:u.zU,value:{space_id:I.id,notify_mobile:!0,notify_desktop:!0,notify_email:!0,parent_id:v,parent_table:g.dx,alive:!0,joined:!0,joined_teams:(C||T)&&i.oA([null==C?void 0:C.id,null==T?void 0:T.id]),settings:{notify_email_digest:!0}},inMemoryRecordCache:a.inMemoryRecordCache,transaction:e}),n=new O.V9(t,o.pointer);return $.R3({parent:a.getSpaceViewsStore(),append:o,transaction:e}),$.MK({parent:a.getSpaceViewPointersStore(),append:o,transaction:e}),t.device.isMobileNative&&r.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"spaceActions.createSpace setting space"}}),B.default.setState({...B.default.state,currentSpaceStore:I,currentSpaceViewStore:n}),q.VTb(t,{from:l,planType:d,isProfessionalTeamUser:(0,k.QZ)(),domain_type:(0,k.JF)()}),{spaceViewStore:n}}});return await M,await G.Yh(t),{spaceViewStore:P,spaceStore:I,inviteLinkCode:w,teamStore:C,personaTeamStore:T}}throw new Error(x.default.formatMessage(se.loginToCreateSpace))}async function ce(e){const{environment:t,blockStores:o,spaceId:n,targetParent:s}=e,{id:l}=t.currentUser;if(l){if(!E.Z.state.online)return{error:x.default.formatMessage(se.moveToSpaceOnlineError)};const e=[],m=[];for(const t of o)t.isDefined()&&(e.push({id:t.id,spaceId:t.getSpaceId()}),m.push(n));if(i.jj(m).length>1)return{error:x.default.formatMessage(se.cannotMoveShardRestriction)};if(s&&s.spaceId!==n)return{error:x.default.formatMessage(se.cannotMoveShardRestriction)};const g=z.moveToSpace(t,{blocks:e,targetSpaceId:n,targetParent:s,clearPermissions:(0,C.bq)()});let h;for await(const o of g){if(Q.R(o,n),o.error)return w.j(t,"move_to_space_error",{}),r.log({level:"error",from:"spaceActions",type:"moveSpaceError",error:(0,a.Ui)(o.error),data:{userId:l,blocks:e,spaceId:n}}),{error:x.default.formatMessage(se.cannotMoveContent)};{const e=c.PF.create(o.value.recordMap).getByTable(d.iU);for(const{value:t}of e){var p,u;if("copy_indicator"===(null==t||null===(p=t.value)||void 0===p?void 0:p.type))h=null==t||null===(u=t.value)||void 0===u?void 0:u.id}}}return Q.h(n),{value:h}}return{error:x.default.formatMessage(se.loginToMoveContent)}}async function de(e){const{environment:t,spaceViewStore:o,openInNew:n,isNewlyCreatedSpace:i,leavingSpace:a}=e;await o.awaitNonNullValue();const s=o.getSpaceStore();if(!s)throw new Error(x.default.formatMessage(se.invalidSpaceStoreOnNavigate));if(!n&&(W.qL({bannerStore:F.Z,id:"SubscriptionEditingBlocker"}),t.device.isMobileNative&&r.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"spaceActions.switchToSpace",spaceId:s.id}}),B.default.setState({...B.default.state,currentSpaceStore:s,currentSpaceViewStore:o}),a)){const e=await(0,I.rg)(t,o);B.default.setState({...B.default.state,mainEditorCurrentBlockStore:e})}Z.Z.reset();const l=t.currentUser.id,c=o.getUserRootParentId();if(c&&l!==c){const e=await ie.x({environment:t,newCurrentUserId:c});await L.OR({environment:e,spaceId:s.id,isNewlyCreatedSpace:i});const{currentUserSettingsStore:o,currentUserRootStore:n}=B.default.state;return{switchedUser:!0,newEnvironment:e,newUserRootStore:n,newUserSettingsStore:o}}return await L.OR({environment:t,spaceId:s.id,isNewlyCreatedSpace:i}),{switchedUser:!1}}async function pe(e){const{spaceViewStore:t,redirectPageId:o,openInNew:i,isNewlyCreatedSpace:a,templateGalleryItem:s,projectManagementLaunch:l,leavingSpace:c,pageVisitSource:p}=e;let{environment:u,userSettingsStore:m,userRootStore:g}=e;const h=t.getSpaceStore();if(!h)throw new Error(x.default.formatMessage(se.invalidSpaceStoreOnNavigate));const f=await de({environment:u,spaceViewStore:t,openInNew:i,isNewlyCreatedSpace:a,leavingSpace:c});f.switchedUser&&(u=f.newEnvironment,m=f.newUserSettingsStore,g=f.newUserRootStore),R.Z.isAiEnabled()&&(0,S.resetAssistantStores)();const y=g&&g.getSpaceViewStores(),v=I.g4(u,t),b=A.Al(t);if(o)return void te.navigateToBlock({environment:u,store:new O.G(u,{table:d.iU,id:o}),openInNew:i,pageVisitSource:p});if("last_visited_page"===v){g&&await N.Z.reinitializeState(u,g.id,h.id);const e=ue({environment:u,spaceId:h.id});if(e&&e.canRead()&&e.pathIsAccessibleAndAlive())return void te.navigateToBlock({environment:u,store:e,openInNew:i,templateGalleryItem:s,projectManagementLaunch:l,pageVisitSource:n.tY.LastVisitedPage})}if("personal_home"===v&&b&&(await b.load(),b.canRead()))return te.navigateToBlock({environment:u,store:b,openInNew:i,templateGalleryItem:s,projectManagementLaunch:l,pageVisitSource:n.tY.DefaultHome}),void(0,P.$X)({environment:u,from:"on_app_start_page"});const _=await(0,I.rg)(u,t);if(_)te.navigateToBlock({environment:u,store:_,openInNew:i,templateGalleryItem:s,projectManagementLaunch:l,pageVisitSource:p});else if(h.canEdit()){const{performResult:e}=re.createAndCommit({userAction:"spaceActions.createdPage",environment:u,perform:e=>ne.KE({environment:u,spaceStore:h,spaceViewStore:t,isPrivate:!0,transaction:e,prepend:!1})});te.navigateToBlock({environment:u,store:e,openInNew:i,pageVisitSource:p})}else{if(m&&g&&y&&y.length>0&&y[0]&&y[0].id!==t.id)return K.vq(),u.device.isMobileNative&&r.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"navigateToFirstSpace because navigateToSpace didn't find a page"}}),void(await me({environment:u,userRootStore:g,userSettingsStore:m,openInNew:i,pageVisitSource:p}));K.vq(),await T.xN(u)}}function ue(e){const{spaceId:t}=e,o=N.Z.getWithoutSubscribing(t);if(!Array.isArray(o))return;const n=o[0];return void 0!==(null==n?void 0:n.pageId)?n.store:void 0}async function me(e){const{environment:t,userRootStore:o,ignoreSpaceId:n,userSettingsStore:r,openInNew:i,skipPendingTransferWorkspaces:a,leavingSpace:s,templateGalleryItem:l,projectManagementLaunch:c,pageVisitSource:d}=e;await o.load();const p=o.getSpaceViewStores();await Promise.all(p.map((e=>e.load())));const u=p.filter((e=>{var t;return!!e.isDefined()&&(n?e.getSpaceId()!==n:!a||!(0,f.DI)(null===(t=e.getSpaceStore())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.space_request))}));let m;for(const g of u){if(!I.Cx(g.getSpaceStore())){m=g;break}{const e=await(0,I.rg)(t,g);if(e&&e.isDefined()){m=g;break}}}m?await pe({environment:t,spaceViewStore:m,userSettingsStore:r,userRootStore:o,openInNew:i,leavingSpace:s,templateGalleryItem:l,projectManagementLaunch:c,pageVisitSource:d}):(K.vq(),await T.xN(t))}async function ge(e){const{environment:t,index:o,userRootStore:r,userSettingsStore:i}=e,a=D.Z.getAllSpaceViewStores(t)[o];a&&await pe({environment:t,spaceViewStore:a,userSettingsStore:i,userRootStore:r,pageVisitSource:n.tY.SwitchSpace})}async function he(e){const{environment:t,spaceStore:o}=e;o.isDefined()&&!(0,h.Z)(o.getEmailDomains(),e.emailDomains)&&q.xGP(t,{domains:e.emailDomains||[],confirmed:!0});const n={email_domains:e.emailDomains};e.name&&(n.name=e.name);const r={};for(const a of(0,v.Yd)(n)){const e=o.getKeyStore(a).getValue(),t=n[a];i.Xy(e,t)||(r[a]=t||null)}i.xb(r)||await new Promise(((e,n)=>{re.createAndCommit({userAction:"spaceActions.updateSpace",environment:t,perform:t=>{X.sW({store:o,data:r,transaction:t}),t.postSubmitCallbacks.push((t=>{t?n(t):e()}))}})}))}async function fe(e){var t;const{environment:o,spaceStore:n,domain:r}=e;(null===(t=j.Z.state.publicSpaceDataMap[n.id])||void 0===t?void 0:t.domain)!==r&&(await z.updateSpaceDomain(o,{spaceId:n.id,domain:r}),j.Z.getPublicSpaceData(o,n.id,!0))}async function ye(e){var t;const{environment:o,spaceStore:n,publicHomePage:r}=e;(null===(t=j.Z.state.publicSpaceDataMap[n.id])||void 0===t?void 0:t.publicHomePage)!==r&&(await z.updatePublicHomePage(o,{spaceId:n.id,publicHomePage:r}),j.Z.getPublicSpaceData(o,n.id,!0))}function ve(e){const{environment:t,spaceStore:o,domain:n}=e,{currentUserStore:r}=B.default.state;return z.checkSpaceDomain(t,{spaceId:o.id,domain:n},null==r?void 0:r.id)}async function be(e){const{environment:t,spaceStore:o,spaceBasicSettingsStore:n,securitySettingsStore:r}=e,{name:i,domain:a,emailDomains:s,publicHomePage:l}=n.state;await Promise.all([he({environment:t,spaceStore:o,name:i,emailDomains:s}),fe({environment:t,spaceStore:o,domain:a}),ye({environment:t,spaceStore:o,publicHomePage:l}),r?oe.n(t,{spaceStore:o,securitySettingsState:r.state}):Promise.resolve()])}const Se=function(e){const{environment:t,transaction:o,spaceStore:n,disablePublicAccess:r,disableGuests:i,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:p,disableExternalMembershipRequests:u,disableGuestMembershipRequests:m,enableAiFeature:g,disableTeamGuests:h,enableGuestInviteRequests:f}=e;X.sW({store:n,data:{disable_public_access:r,disable_guests:i,disable_move_to_space:a,disable_export:s,disable_space_page_edits:l,disable_public_access_requests:c,settings:{...n.getSettings(),enable_ai_feature:g,disable_team_guests:h,enable_guest_invite_requests:f},disable_team_creation:d},transaction:o}),re.applyOperation({store:n,operation:{pointer:n.pointer,path:["settings","disable_membership_requests"],command:"set",args:p},transaction:o}),re.applyOperation({store:n,operation:{pointer:n.pointer,path:["settings","disable_external_membership_requests"],command:"set",args:u},transaction:o}),re.applyOperation({store:n,operation:{pointer:n.pointer,path:["settings","disable_guest_membership_requests"],command:"set",args:m},transaction:o}),c&&q.JpJ(t,{disable_public_access_requests:c})},_e=function(e){const{transaction:t,spaceStore:o,inviteLinkEnabled:n}=e;X.sW({store:o,data:{invite_link_enabled:n},transaction:t})};async function we(e){const{environment:t,spaceId:o,userRootStore:i,navigate:s,analyticsFrom:l,userSettingsStore:c,redirectPageId:d,inviteCode:p}=e,u=i.getSpaceViewStores().find((e=>e.getSpaceId()===o));if(_.default.isAdminMode||z.setSpaceNotificationsAsRead(t,{timestamp:Date.now(),spaceId:o}),u)return!0!==u.getJoined()&&re.createAndCommit({userAction:"spaceActions.joinSpace",environment:t,perform:e=>{Re({spaceViewStore:u,transaction:e})}}),s&&await pe({environment:t,spaceViewStore:u,userSettingsStore:c,redirectPageId:d,userRootStore:i,pageVisitSource:n.tY.SwitchSpace}),{spaceViewStore:u};{const u=await z.addUsersToSpace(t,{userIds:[i.id],spaceId:e.spaceId,inviteCode:p});if("failed"===u.type)throw u.body&&u.body.clientData&&"invite_link_disabled"===u.body.clientData.type&&y.Z.remove(M.WX),r.log({level:"error",from:"spaceActions",type:"addUsersToSpace",error:(0,a.Ui)(u.error),data:{miscDataToConvertToString:{response:u}}}),u.error;const m=i.getSpaceViewStores();await Promise.all(m.map((e=>e.load())));const g=m.find((e=>e.getSpaceId()===o));if(!g)throw new Error(x.default.formatMessage(se.noSpaceViewOnJoin));const h=g.getJoined();if(!0!==h&&re.createAndCommit({userAction:"spaceActions.joinSpace",environment:t,perform:e=>{Re({spaceViewStore:g,transaction:e})}}),s&&await pe({environment:t,spaceViewStore:g,userSettingsStore:c,redirectPageId:d,userRootStore:i,pageVisitSource:n.tY.SwitchSpace}),L.OR({environment:t,spaceId:e.spaceId}).then((()=>{q.kjl(t,{from:l})})),y.Z.remove(M.WX),t.device.isMobileNative&&r.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"spaceActions.joinSpace"}}),B.default.setState({...B.default.state,currentSpaceStore:g.getSpaceStore(),currentSpaceViewStore:g}),G.Th({environment:t,force:!0}),await G.Yh(t),!0!==h){const e=p?"shareable_link_join":"verified_domain_join";q.JkE(t,{invite_origin:e,domainType:(0,k.JF)(),new_workspace_member_count:1})}return{spaceViewStore:g}}}async function ke(e){const{environment:t,spaceId:o,userSettingsStore:r}=e,{currentUserRootStore:i,currentUserStore:a}=B.default.state;if(i&&a){const e=await z.removeUsersFromSpace(t,{userIds:[a.id],spaceId:o,removePagePermissions:!0,revokeUserTokens:!1});return"success"===e.type?(me({environment:t,userRootStore:i,ignoreSpaceId:o,userSettingsStore:r,leavingSpace:!0,pageVisitSource:n.tY.SwitchSpace}),!0):(H.showError(e),!1)}}async function xe(e){const{environment:t,spaceId:o,userSettingsStore:r}=e,{currentUserRootStore:i,currentUserStore:a}=B.default.state;if(i&&a){Y.j({message:se.deletingWorkspace});try{const{value:e}=await z.deleteSpace(t,{spaceId:o}).next();if(e.error)throw e.error;await ee.bG({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:{table:g.dx,id:i.id},userId:t.currentUser.id}),me({environment:t,userRootStore:i,ignoreSpaceId:o,userSettingsStore:r,pageVisitSource:n.tY.SwitchSpace})}finally{Y.x()}}}function Ie(e){const{environment:t,blocks:o,transaction:n}=e,r=t.currentUser.id;if(r)for(const i of o){const e=i.getPermissionItems().filter((e=>(0,s.FB)(e)));X.sW({store:i,data:{permissions:[...e,{type:"user_permission",role:"editor",user_id:r}]},transaction:n})}}function Ce(e){const{environment:t,blocks:o,transaction:n}=e;if(t.currentUser.id)for(const r of o){const e=r.getPermissionItems(),o=e.find((e=>"space_permission"===e.type)),i=e.filter((e=>(0,s.FB)(e)));o||J.ep({environment:t,store:r,permissionItems:[...i,{type:"space_permission",role:"editor"}],transaction:n})}}function Te(e){const{blocks:t,transaction:o}=e;for(const n of t){const e=n.getPermissionItems().filter((e=>(0,s.FB)(e)));X.sW({store:n,data:{permissions:e.length>0?e:null},transaction:o})}}function Me(e){const{spaceStore:t,transaction:o}=e;if(!t.isDefined())throw new Error(x.default.formatMessage(se.noLocalDataForPermissionGroup));const n=Date.now(),r={id:(0,l.ZP)(),last_edited_time:n},i=[r,...t.getPermissionGroups()];return X.sW({store:t,data:{permission_groups:i},transaction:o}),r}function Pe(e){const{spaceStore:t,group:o,transaction:n}=e;if(!t.isDefined())throw new Error(x.default.formatMessage(se.noLocalDataForPermissionGroup));const r=t.getPermissionGroups();let i;i=r.findIndex((e=>e.id===o.id))>=0?r.map((e=>e.id===o.id?o:e)):[...r,o],X.sW({store:t,data:{permission_groups:i},transaction:n})}async function Ae(e){const{environment:t,spaceStore:o,group:n,transaction:r}=e;if(!o.isDefined())throw new Error(x.default.formatMessage(se.noLocalDataForPermissionGroup));const i=o.getPermissionGroups().filter((e=>e.id!==n.id));X.sW({store:o,data:{permission_groups:i},transaction:r}),await z.transferPermissionGroup(t,{spaceId:o.id,groupId:n.id})}const De=function(e){const{userRootStore:t,spaceViewIds:o,transaction:n,spaceViewPointers:r}=e;X.sW({store:t,data:{space_views:o,space_view_pointers:r},transaction:n})};function Be(e){const{planType:t,spaceStore:o,transaction:n}=e;X.sW({store:o,data:{plan_type:t},transaction:n})}function Re(e){X.sW({store:e.spaceViewStore,data:{joined:!0},transaction:e.transaction})}function Ee(e){let{spaceBasicSettingsStore:t,environment:o,spaceId:n}=e;return new Promise(((e,r)=>{const i=j.Z.getPublicSpaceData(o,n);t.state.domain!==(null==i?void 0:i.domain)&&null!=i&&i.hasPublicPages?H.showDialog({message:(0,ae.jsxs)("div",{style:{overflowWrap:"anywhere"},children:[(0,ae.jsx)(b.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.prompt",defaultMessage:"This workspace has public pages. If you proceed with changing the domain, any existing links starting with {current_domain}.notion.site will no longer work.",values:{current_domain:(null==i?void 0:i.domain)||"your_domain"}}),(0,ae.jsx)("p",{}),(0,ae.jsx)(b.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.areYouSure",defaultMessage:"Are you sure you want to change your domain?"})]}),showCancel:!1,keepFocus:!0,items:[{label:(0,ae.jsx)(b.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.changeButton.label",defaultMessage:"Change"}),color:"red",onAccept:()=>e(!0)},{label:(0,ae.jsx)(b.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.cancelButton.label",defaultMessage:"Cancel"}),color:void 0,onAccept:()=>e(!1)}]}):e(!0)}))}function Fe(e,t,o){const n=o||B.default.state.currentSpaceStore;if(!n)throw r.log({level:"error",from:"spaceActions",type:"setSpaceSurveyData",error:{message:"Couldn't find a SpaceStore."}}),new Error;re.createAndCommit({userAction:"spaceActions.setSpaceSurveyData",environment:e,perform:e=>{Ue(n,e,{space_survey_data:t})}})}function Ne(e){var t;const o=B.default.state.currentSpaceStore;o?null!==(t=o.getSettings())&&void 0!==t&&t.seen_block_limit_reduction_v2||((0,U.KC)(),re.createAndCommit({userAction:"spaceActions.setBlockLimitIncrease",environment:e,perform:e=>{Ue(o,e,{seen_block_limit_increase:!0})}})):r.log({level:"error",from:"spaceActions",type:"setBlockLimitIncrease",error:{message:"Couldn't find a SpaceStore to set block increase experiment."}})}async function je(e){const t=B.default.state.currentSpaceStore;return t?!e.device.isMobile&&(!(await(0,V.n)(e))&&(!(0,U.Z$)()&&((0,U.bI)(),re.createAndCommit({userAction:"spaceActions.setTimedTrialsInOnboarding",environment:e,perform:e=>{Ue(t,e,{exposed_to_timed_trials_in_onboarding:!0})}}),!0))):(r.log({level:"error",from:"spaceActions",type:"initializeTimedTrialsOnboardingExp",error:{message:"Couldn't find a SpaceStore to initialize the TT onboarding experiment."}}),!1)}function Oe(e){const t=e.getEditDomain();return t?`${window.location.host}/${t}`:null}function Le(e){return e=(e=e.toLowerCase()).replace(/[^a-z0-9-]/g,"")}function Ue(e,t,o){re.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),...o}},transaction:t})}},28014:(e,t,o)=>{o.d(t,{Hj:()=>w,KE:()=>_,OQ:()=>k,cc:()=>x,sY:()=>S,ux:()=>I});o(21703);var n=o(41432),r=o(4615),i=o(21202),a=o(70203),s=o(97880),l=o(5366),c=o(33929),d=o(38755),p=o(77080),u=o(35661),m=o(50906),g=o(54532),h=o(3297),f=o(94419),y=o(9953),v=o(4408),b=o(97444);const S=(0,l.defineMessages)({createAndDuplicatePageError:{defaultMessage:"Duplicated page could not be created.",id:"spaceActions.createAndDuplicatePageInSpace.copyNotCreated.error"},forkPageError:{defaultMessage:"Could not fork page.",id:"spaceActions.dialogError.forkPageError.message"}});function _(e){const{environment:t,spaceViewStore:o,spaceStore:r,isPrivate:i,prepend:a,title:s,transaction:l,loading:c,tracker:d}=e,u=Boolean(p.default.checkGate("enable_text_crdt_client")&&e.useCrdt),m=y.j4({environment:t,type:c?n.Ti.copyIndicator:n.Ti.page,inMemoryRecordCache:r.inMemoryRecordCache,transaction:l,spaceId:r.id,tracker:d,useCrdt:u});return s&&b.sO({environment:t,store:m.getBlockTitleStore(),value:[[s]],transaction:l}),w({environment:t,spaceStore:r,spaceViewStore:o,pageStore:m,isPrivate:i,location:{type:a?"prepend":"append"},transaction:l}),m}function w(e){const{environment:t,spaceStore:o,spaceViewStore:n,pageStore:r,isPrivate:i,location:a,transaction:l}=e,{id:c}=t.currentUser;let d;i?c&&(d={type:"user_permission",role:"editor",user_id:c}):d={type:"space_permission",role:"editor"},y.sW({store:r,data:{permissions:d?[d]:[]},transaction:l}),i&&k({environment:t,spaceStore:o,spaceViewStore:n,transaction:l});const p=a||{type:"append"};"prepend"===p.type?f.Ce({parent:i?n.getPrivatePagesStore():o.getPagesStore(),prepend:r,before:p.before,transaction:l}):"append"===p.type?f.R3({parent:i?n.getPrivatePagesStore():o.getPagesStore(),append:r,after:p.after,transaction:l}):(0,s.t1)(p)}function k(e){const{environment:t,spaceStore:o,spaceViewStore:n,transaction:r}=e,i=new Set(n.getPrivatePageStores().map((e=>e.id)));(0,d.XD)(t,o).filter((e=>e.isTopLevelPrivatePage({spaceStore:o,environment:t}))).forEach((e=>{i.has(e.id)||f.R3({parent:n.getPrivatePagesStore(),append:e,transaction:r})}))}function x(e){const{environment:t,spaceStore:o,spaceViewStore:n,transaction:r,copyPageId:i,recordMap:a,isPrivate:s,allowCopyExternalObjectInstances:l}=e,d=_({environment:t,spaceStore:o,spaceViewStore:n,isPrivate:s,loading:!0,transaction:r});v.fL({environment:t,inMemoryRecordCache:d.inMemoryRecordCache,recordMap:a,debugSource:"spaceActions.createAndDuplicatePageInSpace"});const p=g.K8(t,{blockId:i,inMemoryRecordCache:d.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:l});if(!p)throw new Error(c.default.formatMessage(S.createAndDuplicatePageError));return g.E9({environment:t,sourceBlockId:i,targetBlockPointer:d.pointer,sourceBlockSubtree:p,targetInMemoryRecordCache:d.inMemoryRecordCache,transaction:r,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:d.useCrdt()}),d}async function I(e){const{environment:t,userRootStore:o,isPrivate:n,forkedPageId:s,spaceStore:l,spaceViewStore:d}=e;if(l.canEdit()){const e=u.G.createChildStore(o,{table:i.iU,id:s});h.nM({currentUserId:t.currentUser.id,blockId:void 0});const c=Date.now(),p=await h.OH({environment:t,store:e,spaceStore:l,spaceViewStore:d,isPrivate:n}),g=Date.now()-c;if(m.XyT(t,{from:"publicPage",success:!p.error,template_name:a.QaF(e.getTitleValue()),template_block_id:s,target_space_id:(0,r.F9)(l.id),context:"public_page_duplicate",template_duplication_duration_ms:g}),void 0===p.error)return p.value}throw new Error(c.default.formatMessage(S.forkPageError))}},97627:(e,t,o)=>{o.d(t,{E6:()=>u,GZ:()=>p,MA:()=>f,NY:()=>y,Q1:()=>b,TY:()=>d,ZJ:()=>m,aW:()=>S,kY:()=>g,lo:()=>l,pE:()=>c,pc:()=>v,pu:()=>h});o(21703);var n=o(68626),r=o(24215),i=o(80444),a=o(39699);function s(e,t,o){a.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),...o}},transaction:t})}function l(e){var t;const{currentSpaceViewStore:o}=i.default.state;o&&void 0===(null===(t=o.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt)&&a.createAndCommit({userAction:"userSettingsActions.initializeSpaceAnalyticsPromptSettings",environment:e,perform:e=>{s(o,e,{space_analytics_settings_prompt:{status:"showing",num_times_shown:0}})}})}function c(e){var t;const{currentSpaceViewStore:o}=i.default.state;if(!o)return;const n=null===(t=o.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt;if(!n||"dismissed"===n.status||"hidden"===n.status)return;const r={...n,num_times_shown:n.num_times_shown+1};r.num_times_shown>3&&(r.status="hidden"),a.createAndCommit({userAction:"spaceViewActions.incrementSpaceAnalyticsSettings",environment:e,perform:e=>{s(o,e,{space_analytics_settings_prompt:r})}})}function d(e){var t;const{currentSpaceViewStore:o}=i.default.state;if(!o)return;const n=null===(t=o.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt;n&&"dismissed"!==n.status&&a.createAndCommit({userAction:"spaceViewActions.incrementspaceAnalyticsSettings",environment:e,perform:e=>{s(o,e,{space_analytics_settings_prompt:{status:"dismissed"}})}})}function p(e){var t;const{currentSpaceViewStore:o}=i.default.state;o&&void 0===(null===(t=o.getSettings())||void 0===t?void 0:t.mfa_settings_prompt)&&a.createAndCommit({userAction:"userSettingsActions.initializeMfaPromptSettings",environment:e,perform:e=>{s(o,e,{mfa_settings_prompt:{status:"showing",num_times_shown:0}})}})}function u(e){var t;const{currentSpaceViewStore:o}=i.default.state;if(!o)return;const n=null===(t=o.getSettings())||void 0===t?void 0:t.mfa_settings_prompt;if(!n||"dismissed"===n.status||"hidden"===n.status)return;const r={...n,num_times_shown:n.num_times_shown+1};r.num_times_shown>3&&(r.status="hidden"),a.createAndCommit({userAction:"spaceViewActions.incrementOrHideMfaPrompt",environment:e,perform:e=>{s(o,e,{mfa_settings_prompt:r})}})}function m(e){var t;const{currentSpaceViewStore:o}=i.default.state;if(!o)return;const n=null===(t=o.getSettings())||void 0===t?void 0:t.mfa_settings_prompt;n&&"dismissed"!==n.status&&a.createAndCommit({userAction:"spaceViewActions.dismissMfaPromptSetting",environment:e,perform:e=>{s(o,e,{mfa_settings_prompt:{status:"dismissed"}})}})}function g(e,t){var o;const{currentSpaceViewStore:n}=i.default.state;if(!n)return;const l=(null===(o=n.getSettings())||void 0===o?void 0:o.page_analytics_opt_out_list)||[];l.includes(t)||(a.createAndCommit({userAction:"spaceViewActions.optOutOfPageAnalyticsForPage",environment:e,perform:e=>{s(n,e,{page_analytics_opt_out_list:[...l,t]})}}),r.j(e,"page_analytics_page_opt_out"))}function h(e,t){var o;const{currentSpaceViewStore:n}=i.default.state;if(!n)return;const l=(null===(o=n.getSettings())||void 0===o?void 0:o.page_analytics_opt_out_list)||[];l.includes(t)&&(a.createAndCommit({userAction:"spaceViewActions.optInToPageAnalyticsForPage",environment:e,perform:e=>{s(n,e,{page_analytics_opt_out_list:l.filter((e=>e!==t))})}}),r.j(e,"page_analytics_page_opt_in"))}function f(e,t){const{currentSpaceViewStore:o}=i.default.state;o&&a.createAndCommit({userAction:"userSettingsActions.emailDigestSetting.onToggle",environment:e,perform:e=>{s(o,e,{notify_email_digest:t})}})}function y(e){const{currentSpaceViewStore:t}=i.default.state;t&&a.createAndCommit({userAction:"spaceViewActions.confirmAdminContentSearchAcknowledgement",environment:e,perform:e=>{s(t,e,{admin_content_search_acknowledgement:!0})}})}function v(e){var t;const{currentSpaceViewStore:o}=i.default.state;o&&(null!==(t=o.getSettings())&&void 0!==t&&t.has_migrated_to_google_drive_external_integration||a.createAndCommit({userAction:"spaceViewActions.setUserMigratedToGoogleDriveExternalIntegrationInSpace",environment:e,perform:e=>{s(o,e,{has_migrated_to_google_drive_external_integration:!0})}}))}function b(e,t,o){const r=o||i.default.state.currentSpaceViewStore;if(!r)throw n.log({level:"error",from:"spaceActions",type:"setUserSurveyData",error:{message:"Couldn't find a SpaceViewStore."}}),new Error;a.createAndCommit({userAction:"spaceViewActions.setUserSurveyData",environment:e,perform:e=>{s(r,e,{user_survey_data:t})}})}function S(e,t){const{shown:o,transactionUserAction:n,spaceViewStore:r}=t;a.createAndCommit({environment:e,userAction:n,perform:e=>{s(r,e,{ai_qna_waitlist_shown:o})}})}},15690:(e,t,o)=>{o.d(t,{gG:()=>_,jL:()=>g,nz:()=>v,ls:()=>b,x2:()=>f,a:()=>h});var n=o(41432),r=o(15157),i=o(5366),a=o(33929),s=o(49085);class l extends s.default{getInitialState(){return{}}setSelected(e,t){this.setState({...this.state,[e]:t})}getSelectedTab(e){return this.state[e]}}const c=new l;var d=o(94419),p=o(9953),u=o(24677),m=o(98104);function g(e){const t=e.getContentStores(),o=e.id,n=c.getSelectedTab(o);return n?t.findIndex((e=>e.id===n)):0}function h(e){const{store:t,index:o,currentUserId:n}=e,r=t.getContentStores()[o];r&&f({store:t,id:r.id,currentUserId:n})}function f(e){const{store:t,id:o,currentUserId:n}=e;c.setSelected(t.id,o),r.Z.set({userId:n,key:y(t.id),value:o})}function y(e){return`TabBlock-${e}`}function v(e){const{blockId:t,currentUserId:o}=e,n=r.Z.get({userId:o,key:y(t)});n&&c.setSelected(t,n)}function b(e){const{environment:t,store:o,transaction:r}=e,i=p.j4({environment:t,type:n.Ti.text,inMemoryRecordCache:o.inMemoryRecordCache,transaction:r,useCrdt:o.useCrdt()});d.R3({parent:o.getContentStore(),append:i,transaction:r});const a=o.getContentStores()[0];u.eP({environment:t,store:a});const s=a.getBlockTitleStore();m.N_({store:s})}const S=(0,i.defineMessages)({newTab:{id:"tabBlockActions.addTab.title",defaultMessage:"New tab"}});function _(e){const{environment:t,store:o,transaction:r}=e,i=p.j4({environment:t,type:n.Ti.text,inMemoryRecordCache:o.inMemoryRecordCache,transaction:r,properties:{title:[[a.default.formatMessage(S.newTab)]]},useCrdt:o.useCrdt()});return d.R3({parent:o.getContentStore(),append:i,transaction:r}),c.setSelected(o.id,i.id),i}},80402:(e,t,o)=>{o.d(t,{AU:()=>X,DI:()=>Z,FC:()=>L,K4:()=>oe,MO:()=>j,NE:()=>q,Z5:()=>N,d1:()=>ee,e2:()=>O,j0:()=>K,nA:()=>z,oz:()=>ne,qY:()=>te,qn:()=>W,zJ:()=>U});o(57658),o(21703);var n=o(15145),r=o(68497),i=o(35011),a=o(80951),s=o(1800),l=o(53877),c=o(61075),d=o(78106),p=o(84682),u=o(42875),m=o(5773),g=o(72126),h=o(59753),f=o(82883),y=o(21202),v=o(23867),b=o(19889),S=o(70203),_=o(95477),w=o(17809),k=o(33929),x=o(40150),I=o(41662),C=o(77080),T=o(29370),M=o(8406),P=o(14871),A=o(49865),D=o(45264),B=o(96802),R=o(9953),E=o(24677),F=o(39699);function N(e){const{environment:t,selectionKey:o,selection:n}=e;T.Z.setState({isActive:!0,selectionKey:o,selection:n}),E.ZH(t)}function j(){T.Z.setState({isActive:!1})}function O(e){const{environment:t,selectionKey:o,shiftKey:n,columnCount:r,selection:i}=e;if(n&&i.end.col>0){const e={col:i.end.col-1,row:i.end.row};N({environment:t,selectionKey:o,selection:{start:i.start,end:e}})}else if(!n&&i.start.col>0){const e={col:i.start.col-1,row:i.start.row};N({environment:t,selectionKey:o,selection:{start:e,end:e}})}else if(!n&&0===i.start.col&&i.start.row>0){const e={col:r-1,row:i.start.row-1};N({environment:t,selectionKey:o,selection:{start:e,end:e}})}}function L(e){const{environment:t,selectionKey:o,shiftKey:n,columnCount:r,rowCount:i,selection:a}=e;if(n&&a.end.col<r-1){const e={col:a.end.col+1,row:a.end.row};N({environment:t,selectionKey:o,selection:{start:a.start,end:e}})}else if(!n&&a.start.col<r-1){const e={col:a.start.col+1,row:a.start.row};N({environment:t,selectionKey:o,selection:{start:e,end:e}})}else if(!n&&a.start.col>=r-1&&a.start.row<i-1){const e={col:0,row:a.start.row+1};N({environment:t,selectionKey:o,selection:{start:e,end:e}})}}function U(e){const{environment:t,selectionKey:o,shiftKey:n,selection:r}=e;if(n&&r.end.row>0){const e={col:r.end.col,row:r.end.row-1};N({environment:t,selectionKey:o,selection:{start:r.start,end:e}})}else if(!n&&r.start.row>0){const e={col:r.start.col,row:r.start.row-1};N({environment:t,selectionKey:o,selection:{start:e,end:e}})}}function Z(e){const{environment:t,selectionKey:o,shiftKey:n,rowCount:r,selection:i}=e;if(n&&i.end.row<r-1){const e={col:i.end.col,row:i.end.row+1};N({environment:t,selectionKey:o,selection:{start:i.start,end:e}})}else if(!n&&i.start.row<r-1){const e={col:i.start.col,row:i.start.row+1};N({environment:t,selectionKey:o,selection:{start:e,end:e}})}}const V=new Set(["auto_increment_id"]);function q(e){const{selection:t,schema:o,currentRows:n,currentPropertyFormats:r,transaction:i}=e,a=x.AV(t);for(let s=a.minRow;s<=a.maxRow;s++){const e=n[s];if(e)for(let t=a.minCol;t<=a.maxCol;t++){const n=r[t],a=o[n.property];null!=a&&a.type&&V.has(a.type)||R.sO({store:e.getPropertyStore(n.property),value:null,transaction:i})}}}const z=e=>{W(e),q(e)},W=e=>{const{selection:t,currentRows:o,event:r}=e;if(null===r.clipboardData)return;const i=x.AV(t);let a="";const l=[],d=o.slice(Math.max(0,i.minRow),i.maxRow+1).filter((e=>e&&e.isDefined()));for(const n of d){const t=[];l.push(t);for(let o=i.minCol;o<=i.maxCol;o++){const[r,s]="selectionKey"in e?H({row:n,x:o,collectionViewBlockStore:e.selectionKey.collectionViewBlockStore,...e}):G({row:n,x:o,...e});t.push([r,n.pointer]),s&&(a+=s),o<i.maxCol&&(a+="\t")}n!==g.Z$(d)&&(a+="\n")}if(r.preventDefault(),r.clipboardData.setData("text/plain",a),function(e,t){if(null===e.clipboardData)return;e.clipboardData.setData(x.mH,JSON.stringify(t))}(r,l),"simpleTableStore"in e){const{environment:t,simpleTableStore:o,columnOrder:a,exportJsxRenderer:l}=e;if(!l)return;const{default:p,jsxToStaticMarkup:m}=l,g=t.currentUser.id,f=t.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(g),b=h.om.fromGetRecordValueFn(f),S=a.slice(i.minCol,i.maxCol+1).filter((e=>void 0!==e)),w=(0,c._2)({exportArgs:{root:{table:y.iU,id:o.id,spaceId:(0,v.C)(o.pointer.spaceId)},navigableBlockId:o.id,renderParentBlockId:void 0,blockId:o.id,userTimeZone:(0,u.r)(),intl:k.default.getIntl(),getRecordValue:f,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,s.Z)({pageId:t,pageModel:b({table:y.iU,id:t}),baseUrl:_.default.domainBaseUrl,pageVisitSource:n.tY.Export})},baseUrl:_.default.domainBaseUrl,publicDomainName:_.default.publicDomainName,table:{[o.id]:{renderRows:d.map((e=>e.id)),renderColumns:S}},katex:t.KatexStore.getKatex(),resultCache:new Map},renderers:p});if(w){const e=m(w);r.clipboardData.setData("text/html",e)}}};function H(e){const{row:t,x:o,collectionViewBlockStore:n,schema:i,currentPropertyFormats:a}=e,s=a[o],l=J(t,i,s.property);if(!t.isDefined())return[l,void 0];return[l,(0,r.L)({property:s.property,schema:i,block:t.getModel(),getRecordModel:n.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,u.r)(),depth:0,intl:k.default.getIntl(),visitedProperties:new Set,resultCache:new Map},exportedFilePaths:!1})]}function G(e){const{row:t,x:o,columnOrder:n,simpleTableStore:r}=e,i=t.getPropertyStore(n[o]);return[i.getValue()||[],(0,f.X)({textValue:i.getValue(),getRecordModel:r.getRecordModel,userTimeZone:(0,u.r)(),intl:k.default.getIntl()})]}function K(e){const{environment:t,selection:o,currentRows:n,event:r,transaction:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e;if(!r.clipboardData)return;let l;const c=r.clipboardData.getData(x.mH),d=r.clipboardData.getData("text/html");if(c)l=JSON.parse(c);else if(d){const e=document.createElement("div");e.innerHTML=d;const t=e.querySelector("table");if(t){const e=t.querySelectorAll("tr");l=[];for(const t of Array.from(e)){const e=[],o=t.querySelectorAll("td, th");for(const t of Array.from(o)){const o=S.TPx(t.textContent||"");e.push([o,void 0])}l.push(e)}}}if(!l){const e=function(e){const{event:t,markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n}=e;if(!t.clipboardData)return;const{text:r,html:i,multiTextSelectionData:a,textSelectionData:s,blockSelectionData:l}=P.e0({clipboardData:t.clipboardData,tinyMceMicrosoftWordPasteFilter:n});if(a)return P.of({text:r,html:i,stripText:!1,markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n});if(s){const{editing:e,selection:t}=s;return S.OAI(S.xrQ(e,t.startIndex,t.endIndex).tokensInsideRange)}if(i||r)return function(e){const{text:t,html:o,blockSelectionData:n,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:i}=e;return t.includes("\n")||n&&n.blocks.length>0?S.TPx(t):P.of({text:t,html:o,stripText:!1,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:i})}({text:r,html:i,blockSelectionData:l,markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n})}({event:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s});e&&(l=[[[e,void 0]]])}if(l){const r=x.AV(o),a=l[0].length;let s=Math.floor((r.maxCol-r.minCol+1)/a);0===s&&(s=1);const c=l.length;let d=Math.floor((r.maxRow-r.minRow+1)/c);0===d&&(d=1);for(let t=0;t<d;t++)for(let o=0;o<s;o++){const s=r.minCol+o*a,d=r.minRow+t*c;for(let t=0;t<c;t++){let o=n[d+t];if(!o){const t="selectionKey"in e?$(e):I.HM.appendRow(e);t&&(e.currentRows.push(t),o=t)}for(let n=0;n<a;n++){const r=l[t][n];if(!r)continue;const a=s+n;"currentPropertyFormats"in e?Y({row:o,x:a,serializedValue:r,currentPropertyFormats:e.currentPropertyFormats,transaction:i,schema:e.schema}):Q({row:o,x:a,serializedValue:r,columnOrder:e.columnOrder,transaction:i})}}}const p={start:{col:r.minCol,row:r.minRow},end:{col:r.minCol+a*s-1,row:r.minRow+c*d-1}};"selectionKey"in e?N({environment:t,selectionKey:e.selectionKey,selection:p}):I.HM.selectMultiCell({environment:t,start:p.start,end:p.end,simpleTableStore:e.simpleTableStore})}}function $(e){const{environment:t,currentRows:o,collectionContextStore:n,selectionKey:r,transaction:i}=e,{groupFormat:a}=r,s=A.IW({environment:t,collectionContextStore:n,groupsPointer:a?[a]:[],insertAtIndex:o.length,coerce:!0,initializeDefaultTemplate:!1,transaction:i,from:"table_paste_selection"});return null==s?void 0:s.newStore}function Y(e){var t;const{row:o,x:n,serializedValue:r,currentPropertyFormats:i,transaction:s,schema:l}=e,c=i[n];if(!c)return;if("verification"===(null===(t=l[c.property])||void 0===t?void 0:t.type))return;const[d,p]=r;if(R.sO({store:o.getPropertyStore(c.property),value:d,transaction:s}),p){var u;const e=d?a.g(d):void 0,t=(0,m.jy)(e,[_.default.secureFileS3.url,_.default.secureFileS3V2.url],(null===(u=_.default.secureFileConfig)||void 0===u?void 0:u.rootPath)??"");R.nj({store:o,source:p,fileIds:t.map((e=>e.id)),transaction:s})}}function Q(e){const{row:t,x:o,serializedValue:n,transaction:r,columnOrder:i}=e,a=i[o];if(!a)return;const[s,l]=n;R.sO({store:t.getPropertyStore(a),value:S.OAI(s),transaction:r})}const J=function(e,t,o){const n=t[o];if(!n)throw new Error("Property not found");if(!e.isDefined())return[];const r=e.getPropertyValue(o);if("formula"===n.type){if("v2"===n.version&&(0,w.V1)()){if(!n.formula2)return[];const t=(0,i.EC)({block:e.getModel(),property:o,formulaCode:n.formula2.code,getRecordModel:e.getRecordModel,intl:k.default.getIntl(),userTimeZone:(0,u.r)(),depth:0,visitedProperties:new Set,resultCache:new Map});return t?(0,d.j4)(t):[]}{const n=(0,p.y4)({property:o,schema:t,block:e.getModel(),getRecordModel:e.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,u.r)(),depth:0,intl:k.default.getIntl(),resultCache:new Map,visitedProperties:new Set}});return S.TPx(n)}}if("created_time"===n.type&&e.getCreatedTime())return a.d7(l.CQ(e.getCreatedTime(),(0,u.r)()));if("created_by"===n.type&&e.getCreatedByPointer()){const{table:t,id:o}=e.getCreatedByPointer()??{};return o&&t===b.KJ?[S.YCD(["u",o])]:o?[S.YCD(["r",o])]:[]}if("last_edited_time"===n.type&&e.getLastEditedTime())return a.d7(l.CQ(e.getLastEditedTime(),(0,u.r)()));if("last_edited_by"===n.type&&e.getLastEditedByPointer()){const{table:t,id:o}=e.getLastEditedByPointer()??{};return o&&t===b.KJ?[S.YCD(["u",o])]:o?[S.YCD(["r",o])]:[]}return r||[]};function X(e){let{environment:t,collectionViewStore:o,currentValue:n}=e;F.createAndCommit({userAction:"tableActions.toggleTableVerticalLines",environment:t,perform:e=>{B.FH({stores:[o],update:{hide_table_vertical_lines:!n},transaction:e})}})}function ee(e){let{environment:t,collectionViewStore:o,currentValue:n}=e;const r="title"===n?void 0:"title";F.createAndCommit({userAction:"tableActions.toggleTableSubitemToggleOnTitle",environment:t,perform:e=>{B.FH({stores:[o],update:{table_subitem_toggle_column:r},transaction:e})}})}function te(e){let{environment:t,collectionViewStore:o,currentValue:n}=e;const r=o.getFormat().table_properties,i=null==r?void 0:r.map((e=>({...e,wrap:!n})));F.createAndCommit({userAction:"tableActions.toggleTableWrapCells",environment:t,perform:e=>{B.FH({stores:[o],update:{table_wrap:!n,table_properties:i},transaction:e})}})}function oe(e){let{property:t,collectionViewStore:o,format:n,formatKey:r,environment:i,currentValue:a}=e;const s=!a,l=o.getFormat().table_wrap,c=n[r]||[];let d=!0;const p=c.map((e=>{let o;return o=e.property===t?s:Boolean(l||e.wrap),o||(d=!1),{...e,wrap:o}})),u={...n,[r]:p,table_wrap:d};F.createAndCommit({userAction:"tableActions.toggleWrapColumn",environment:i,perform:e=>{D.iG({collectionViewStore:o,update:{format:u},transaction:e})}})}function ne(e){let{environment:t,collectionContextStore:o,currentIndex:n,entrypoint:r,transaction:i,propertyAction:a}=e;const s=o.collectionViewStore(),l=o.normalizedFormatStore.state;if(!s||void 0===n)return;const c=o.frozoneStore.state.frozenIndex;let d;switch(a){case"toggle":c!==n?d=n:c===n&&(d=-1);break;case"delete":case"hide":if(!(void 0!==c&&n<=c))return;d=c-1;break;case"duplicate":if(!(void 0!==c&&n<=c))return;d=c+1;break;case void 0:if(c!==n)d=n;else if(c===n)return}const p={...l,table_frozen_column_index:d};o.frozoneStore.setState({...o.frozoneStore.state,frozenIndex:d}),d&&C.default.logEvent("freeze_columns","true",{from:r}),M.wd({environment:t,collectionContextStore:o,action:void 0===d?"table_unfreeze_columns":"table_freeze_column",entrypoint:r,propertyIndex:d}),R.sW({store:s.getFormatStore(),data:p,transaction:i})}},65544:(e,t,o)=>{o.d(t,{SP:()=>y,W_:()=>g,l_:()=>h,nf:()=>f});var n=o(19234),r=o(31919),i=o(47425),a=o(27242),s=o(78291),l=o(88893),c=o(63423),d=o(62142),p=o(33493),u=o(25692),m=o(54642);async function g(e){const t=a.Z.state,o=s.default.state.data;if(!t.open||!o)return;const r=t.temporaryAddress;if(!(0,n.A)(r))return;a.Z.update((e=>({...e,calculatingTax:!0})));const{planAmount:i,promoInfo:c,accountBalance:d}=(0,l.uN)({promo:t.appliedPromo,currencyCode:p.Z.selectedCurrencyCode,data:o,addOnFeature:t.addOnFeature,onlyShowAddOn:t.onlyShowAddOn,subscriptionTier:t.subscriptionTier,taxAmount:t.taxAmount,calculatingTax:t.calculatingTax,billingInterval:t.temporaryBillingInterval??"year",coupon:t.coupon}),u=Math.max(0,i-c.amount+d),g=await m.calculateTax(e,{address:r,price:u,vatId:t.vatApplicable?t.temporaryVatCode:void 0,customerId:"subscribed_admin"===o.type?o.customerData.stripe.customerId:void 0});if("failed"===g.type)a.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=g.data;e.valid?a.Z.update((t=>({...t,taxAmount:e.taxAmount,calculatingTax:!1,taxCalculationError:void 0}))):a.Z.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function h(e){var t;const o=d.Z.state,i=s.default.state.data;if(!o.open||!i)return;const a=o.temporaryAddress;if(!(0,n.A)(a))return;d.Z.update((e=>({...e,calculatingTax:!0})));const l=(null===(t=o.totalUpgradeCost)||void 0===t?void 0:t.amount)||0,c=await m.calculateTax(e,{address:a,price:l,vatId:o.vatApplicable?o.temporaryVatCode:void 0,customerId:"subscribed_admin"===i.type?i.customerData.stripe.customerId:void 0});if("failed"===c.type)d.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=c.data;e.valid?d.Z.update((t=>({...t,taxAmount:r.n.fromValue({amount:e.taxAmount,currencyCode:p.Z.selectedCurrencyCode}),calculatingTax:!1,taxCalculationError:void 0}))):d.Z.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function f(e){const{environment:t,priceForTaxCalculation:o,address:n,customerId:r,vatId:i}=e,a=c.Z.state,s=await m.calculateTax(t,{address:n,customerId:r,vatId:i,price:o});if("failed"===s.type);else{const e=s.data;e.valid&&a.open&&c.Z.update((t=>({...t,tax:Math.max(0,e.taxAmount)})))}}async function y(e){var t;const o=u.Z.state,r=s.default.state.data;if(!o.open||!r)return;if("subscribed_admin"!==r.type&&"unsubscribed_admin"!==r.type)return;const a=null===(t=r.customerData)||void 0===t?void 0:t.stripe;if(!a)return;const c=a.address;if(!c||!(0,n.A)(c))return;u.Z.update((e=>({...e,calculatingTax:!0})));const d=o.temporarySubscriptionTier??o.subscriptionTier,g=(0,i.QM)(d)&&o.addOnFeature?"month":"year",h=o.temporaryBillingInterval??o.billingInterval??g,f=!(0,i.QM)(d)&&Boolean(o.addOnFeature),{payAmount:y}=(0,l.uN)({promo:void 0,currencyCode:p.Z.selectedCurrencyCode,data:r,addOnFeature:o.addOnFeature,onlyShowAddOn:f,subscriptionTier:d,taxAmount:o.taxAmount,calculatingTax:o.calculatingTax,billingInterval:h,coupon:o.coupon}),v=await m.calculateTax(e,{address:c,price:y.amount,vatId:a.vatId,customerId:a.customerId});if("failed"===v.type)return void u.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1,taxCalculationError:v.error})));const b=v.data;b.valid?u.Z.update((e=>({...e,taxAmount:b.taxAmount,calculatingTax:!1}))):u.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})))}},150:(e,t,o)=>{o.d(t,{Ct:()=>h,Hl:()=>f,c0:()=>v,sp:()=>b});o(57658),o(67294);var n=o(5366),r=o(27006),i=o(29369),a=o(64684),s=o(98165),l=o(35661),c=o(50906),d=o(47307),p=o(94419),u=o(9953),m=o(39699),g=o(85893);function h(e){const{environment:t,currentSpaceViewStore:o,orderedTeamIds:n,userAction:r}=e;if(m.createAndCommit({userAction:r,environment:t,perform:e=>{u.sW({store:o,data:{joined_teams:n},transaction:e})}}),e.isExplicitUserAction){const{key:n,startPosition:r,endPosition:a}=e.dropArgs,s=l.zX.createChildStore(o,{table:i.e0,id:n});c.ers(t,{store:s,start_position:r,end_position:a})}}async function f(e){let{transaction:t,...o}=e;const{moveToTeam:r,permissionsUpdateItems:i}=function(e){let{moveStores:t,moveTargetStore:o}=e;const n=t.reduce(((e,t)=>(e[t.id]=(0,s.VP)(t),e)),{}),r=(0,s.VP)(o),i=[];for(const a of t){const e=y({blockStore:a,moveFromTeam:n[a.id],moveToTeam:r});e&&i.push(e)}return{moveToTeam:r,permissionsUpdateItems:i}}(o);if(0===i.length)return"not_cleared";if(!(await async function(e){let{numPagesMoved:t,moveToTeam:o,permissionsUpdateItems:r}=e;if(0===r.length)return!0;if(!o)return!0;const i=o.getName(),a=r.some((e=>{let{isRemovingRestricted:t}=e;return!0===t}))&&(0,g.jsx)(n.FormattedMessage,{id:"teamActions.confirmMoveToTeam.removeRestrictedDescription",defaultMessage:" {numPagesMoved, plural, one {This page} other {These pages}} will no longer have restricted access.",values:{numPagesMoved:t}});return await d.confirmUserAction({message:(0,g.jsx)(n.FormattedMessage,{defaultMessage:"Are you sure you want to move {numPagesMoved, plural, one {this page} other {these pages}} to {moveToTeamName}?",id:"teamActions.confirmMoveToTeam.title",values:{moveToTeamName:i,numPagesMoved:t}}),description:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(n.FormattedMessage,{id:"teamActions.confirmMoveFromTeam.description",defaultMessage:"This will transfer the permissions on {numPagesMoved, plural, one {this page} other {these pages}} to members of {moveToTeamName}. ",values:{moveToTeamName:i,numPagesMoved:t}}),a]})})}({numPagesMoved:o.moveStores.length,moveToTeam:r,permissionsUpdateItems:i})))return"user_cancelled_move";for(const{blockStore:n,permissions:a}of i)u.sW({store:n,data:{permissions:a},transaction:t});return"cleared"}function y(e){let{blockStore:t,moveFromTeam:o,moveToTeam:n}=e;if(void 0===o&&void 0===n)return;if((null==o?void 0:o.id)===(null==n?void 0:n.id))return;const i=t.getPermissionItems();let s=!1;const l=i.filter((e=>(0,r.Le)(e)?(s=!0,!1):!(0,r.ix)(e)&&(!o||!(0,a.J2)(e,o.id)&&!(0,a.jc)(e,o.id))));return i.length!==l.length?{blockStore:t,permissions:l,moveFromTeam:o,isRemovingRestricted:s}:void 0}function v(e){const{store:t,teamStore:o,transaction:n,location:r}=e,i=o.getTeamPagesStore(),a=l.G.createChildStore(i,t.pointer);"append"===r.type?p.R3({parent:i,append:a,transaction:n,after:r.after}):"prepend"===r.type&&p.Ce({parent:i,prepend:a,transaction:n,before:r.before})}function b(e){const{store:t,teamStore:o,transaction:n}=e,r=o.getTeamPagesStore(),i=l.G.createChildStore(r,t.pointer);p.Od({childToRemove:i,parent:r,transaction:n})}},97444:(e,t,o)=>{o.d(t,{KM:()=>Pe,i8:()=>De,Du:()=>Be,MY:()=>Me,QT:()=>Re,YV:()=>Ue,aS:()=>Ze,N3:()=>_e,pz:()=>ve,pe:()=>be,VO:()=>Ke,ON:()=>$e,Zl:()=>Qe,Nh:()=>Ye,wA:()=>We,Q0:()=>ze,lZ:()=>qe,hJ:()=>we,mM:()=>ke,gc:()=>je,fs:()=>Le,vE:()=>et,QX:()=>Ae,Be:()=>Fe,gy:()=>Xe,AE:()=>Ge,sO:()=>Ie,g2:()=>Ve,n2:()=>Oe,O5:()=>He});o(57658),o(21703),o(30541);var n=o(1302),r=o(15145),i=o(1800),a=o(15095),s=o(78106),l=o(64572),c=o(72126),d=o(99405),p=o(21202),u=o(70279),m=o(33709),g=o(23867),h=o(70203),f=o(39721),y=o(64002),v=o(82798),b=o(54564),S=o(67133),_=o(75018),w=o(62878),k=o(17707),x=o(95477),I=o(78791),C=o(65273),T=o(14976),M=o(73744),P=o(84210),A=o(68056),D=o(45162),B=o(98165),R=o(65598),E=o(18514),F=o(69645),N=o(73959),j=o(60846),O=o(89224),L=o(89086),U=o(35328),Z=o(89574),V=o(95802),q=o(24229),z=o(66949),W=o(77080),H=o(72014),G=o(88923),K=o(81236),$=o(35661),Y=o(27724),Q=o(24666),J=o(45131),X=o(67175),ee=o(39699),te=o(24161);function oe(e){const{transaction:t,store:o,crdtOperations:n,invertedOperations:r}=e;ee.applyCrdtTextOperations({transaction:t,store:o,operations:n.map((e=>(0,X.W5)({pointer:o.pointer,crdtOperation:e}))),invertedOperations:r.map((e=>(0,te.N)({pointer:o.pointer,invertedCrdtOperation:e})))})}var ne=o(50906),re=o(6404),ie=o(14871),ae=o(4727),se=o(36280),le=o(44886),ce=o(88295),de=o(67060),pe=o(9953),ue=o(61045),me=o(24677),ge=o(84084),he=o(17269),fe=o(98104),ye=o(32741);function ve(e){const{multiSelection:t,environment:o,transaction:n}=e,r=(0,D.L5)(t);if(0===r.length)return;if(1===r.length){const{store:e,selection:t}=r[0];return be({environment:o,transaction:n,store:e,selection:t})}const i=t.start.store,a=C.FX(i),s=(0,D.Nj)({multiSelection:t,includeNonSelectable:!1});if(!s)return;const l=new Set,c=[],{treeRange:d}=s;for(const g of d.iterateDeletion())(0,F.D_)({transaction:n,treeOperation:g,deleteFrom:"record-store-parent",observer:{onRemove(e,t){c.push(t.childToRemove)},onMove(e){for(const t of e.movingChildren)t.value.store&&l.add(t.value.store)}}});a&&I.Cf({environment:o,transaction:n,multiSelection:t,removedBlocks:c,movedBlocks:l});const{start:p,end:u}=t;be({environment:o,transaction:n,selection:{startIndex:p.index,endIndex:1/0},store:p.store});const m=(0,L.x0)(p.store);if(a){const e=(0,v.TO)((0,N.sQ)(u.store),"End of selection must be in a block");be({environment:o,transaction:n,selection:{startIndex:0,endIndex:u.index},store:u.store}),I.tE({transaction:n,block:e,targetStore:i})}else m?je({environment:o,transaction:n,sourceStore:u.store,sourceIndex:u.index,targetStore:p.store,targetIndex:m.endIndex}):be({environment:o,transaction:n,store:u.store,selection:{startIndex:u.index,endIndex:1/0}});fe.Z5({store:p.store,selection:m}),me.eP({environment:o,store:d.start.value.store})}function be(e){Se({...e,updateSelection:!0,removeInlineRecords:!0})}function Se(e){const{environment:t,store:o,selection:n,transaction:r,updateSelection:i,removeInlineRecords:s}=e,l=o.getValue(),c=h.Ulv(l,n);if(c.startIndex===c.endIndex)return void(i&&fe.Z5({store:o,selection:c}));let d;const u=o.isTable(p.iU)&&(0,N.sQ)(o)||o.getRecordStoreAtRootPath();if(u instanceof $.G&&C.Ls({store:o,blockStore:u})){const t=(0,v.TO)(u.getTextSliceTree()),n=new a.W3(h.eeV(l)),{startIndex:i,endIndex:s}=n.getInclusiveStringRangeForSelection(c),{operations:p,invertedOperations:m}=t.getOperationsForDeleteText(i,s);oe({transaction:r,store:u,crdtOperations:p,invertedOperations:m}),Te(e),d=(0,v.TO)(o.getValue())}else d=h._QS(l,n.startIndex,n.endIndex),Ce({environment:t,store:o,value:d,transaction:r});Je({environment:t,store:o,oldTextValue:l,newTextValue:d,transaction:r,rootStore:u,removeInlineRecords:s}),i&&fe.Z5({store:o,selection:{startIndex:c.startIndex,endIndex:c.startIndex}})}function _e(e){const t=Q.default.state;if("editing"!==t.mode)return;if((0,A.iG)(t.multiSelection))return;const{start:o,end:n}=t.multiSelection,r="start"===e.direction?o:n;Q.default.setState({...t,multiSelection:{start:r,end:r}})}function we(e){const{environment:t,disableMentions:o,disableDateMentions:n,disableDateReminderMentions:r,disableSlashCommands:i,disableEmojiCommands:s,disableFilters:l,disableTemplateVariableMentions:c,string:d,transaction:p,selectAll:u}=e;if("editing"!==Q.default.state.mode)return;const m="multiSelection"in e?e.multiSelection:(0,A.TD)(e),g=(0,A.QY)(m),f=g?{canRestore:!0,oldSelection:g,toTextValue:g.store.getValue()}:{canRestore:!1};ve({environment:t,multiSelection:m,transaction:p});const y=h.vJ3(d),v=a.p4(y).length;if(0===v)return;const b=(0,L.bj)(),S=h.V3y(y,b);xe({environment:t,store:m.start.store,tokens:[S],index:m.start.index,transaction:p,updateSelection:!1});const _={startIndex:u?m.start.index:m.start.index+v,endIndex:m.start.index+v};fe.Z5({store:m.start.store,selection:_}),l||he.f({environment:t,store:m.start.store,transaction:p}),f.canRestore&&(o||de._P({environment:t,textStore:f.oldSelection.store,oldSelection:f.oldSelection.selection,oldTextValue:f.toTextValue,disableDateMentions:n,disableDateReminderMentions:n||Boolean(r),disableTemplateVariableMentions:Boolean(c)}),i||ge._P({environment:t,textStore:f.oldSelection.store,oldSelection:f.oldSelection.selection,oldTextValue:f.toTextValue}),s||ae._P({environment:t,textStore:f.oldSelection.store,oldSelection:f.oldSelection.selection,oldTextValue:f.toTextValue}))}function ke(e){xe({...e,updateSelection:!0})}function xe(e){const{environment:t,store:o,index:n,transaction:r,selectAll:i,updateSelection:s}=e,l=e.tokens.map(h.Y_F);if(l.length){const i=o.getValue()||[];if(C.FX(o)){const t=(0,v.TO)((0,N.sQ)(o)),i=(0,v.TO)(t.getTextSliceTree()),s=new a.W3(h.eeV(o.getValue())).getStringStartIndex(n),{operations:c,invertedOperations:d}=i.getOperationsForInsertTextValue(s,l);oe({transaction:r,store:t,crdtOperations:c,invertedOperations:d}),Te(e)}else{Ce({environment:t,store:o,value:h.P$X(i,l,n),transaction:r})}const s=o.getRecordStoreAtRootPath();if(s instanceof $.G){const e=c.zu(h.llS(l),...h.llS(i));for(const t of e){const e=R.x8(s);ee.applyOperation({transaction:r,store:e,operation:{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:t,after:void 0}}})}}}if(s){const e=h.eeV(l).length;fe.Z5({store:o,selection:{startIndex:i?n:n+e,endIndex:n+e}})}}function Ie(e){const{environment:t,store:o,value:n,transaction:r}=e;C.FX(o)?(Se({environment:t,store:o,selection:{startIndex:0,endIndex:1/0},transaction:r,updateSelection:!1,removeInlineRecords:!0}),n&&h.VrM(n)&&xe({environment:t,store:o,tokens:n,index:0,transaction:r,updateSelection:!1}),Te(e)):Ce(e)}function Ce(e){const{store:t,value:o,transaction:n}=e;pe.sO({store:t,transaction:n,value:h.Zxt(o)}),Te(e)}function Te(e){const{environment:t,store:o,transaction:n}=e;if(!o.isTable("block"))return;const r=o.getRecordStoreAtRootPath().getValue();r&&ne.ctm(t,{user_action:n.getUserActionForAnalyticsPurposesOnly(),block_id:r.id,type:r.type,is_toggleable:(0,U._A)(r.type,r.format)})}function Me(e){const{environment:t,multiSelection:o,annotation:n,transaction:r}=e,i=h.J7s(n),a=(0,D.L5)(o),s=Boolean((0,L.a6)(i,o,{}));a.forEach((e=>{let{store:o,selection:a}=e;s?Ne({environment:t,store:o,annotationTypeOrKey:i,selection:a,transaction:r,updateSelection:!1}):Ee({environment:t,store:o,annotation:n,selection:a,transaction:r})}))}function Pe(e){const{environment:t,multiSelection:o,annotation:n,transaction:r}=e;(0,D.L5)(o).forEach((e=>{let{store:o,selection:i}=e;Ee({environment:t,store:o,annotation:n,selection:i,transaction:r})}))}function Ae(e){const{environment:t,multiSelection:o,annotationTypeOrKey:n,transaction:r}=e;(0,D.L5)(o).forEach((e=>{let{store:o,selection:i}=e;Ne({environment:t,store:o,annotationTypeOrKey:n,selection:i,transaction:r,updateSelection:!1})}))}function De(e){const{environment:t,store:o,selection:n,annotation:r,transaction:i}=e;Me({environment:t,annotation:r,transaction:i,multiSelection:(0,A.TD)({store:o,selection:n})})}function Be(e){const{environment:t,blocks:o,annotation:n,transaction:r}=e,i=h.J7s(n),a=c.oA(o.map((e=>{const t=e.getTitleStore();if(!t)return;const o=t.getValue();return o?{block:e,titleStore:t,titleValue:o}:void 0}))),s=a.every((e=>{let{titleValue:t}=e;return t.every((e=>h.hDy(e).some((e=>h.J7s(e)===i))))}));for(const{titleStore:l}of a)Re({environment:t,annotation:n,textStore:l,action:s?"removeAnnotationType":"annotate",transaction:r})}function Re(e){const{environment:t,annotation:o,transaction:n,textStore:r,action:i}=e;"annotate"===i?Ee({environment:t,store:r,annotation:o,selection:{startIndex:0,endIndex:1/0},transaction:n}):Ne({environment:t,store:r,annotationTypeOrKey:h.J7s(o),selection:{startIndex:0,endIndex:1/0},transaction:n,updateSelection:!1})}function Ee(e){const{environment:t,store:o,annotation:n,selection:r,transaction:i}=e,s=o.getValue();if(s)if(C.FX(o)){!function(e){const{blockStore:t,selection:o,annotation:n,transaction:r}=e;(0,v.T)(t.useCrdt());const i=t.getBlockTitleStore().getValue(),s=h.Ulv(i,o);if((0,L.wd)(s))return;const l=(0,v.TO)(t.getTextSliceTree()),c=new a.W3(h.eeV(i)),{startIndex:d,endIndex:p}=c.getInclusiveStringRangeForSelection(s),{operations:u,invertedOperations:m}=l.getOperationsForAddAnnotation(d,p,n);oe({transaction:r,store:t,crdtOperations:u,invertedOperations:m})}({blockStore:(0,v.TO)((0,N.sQ)(o)),selection:r,annotation:n,transaction:i})}else{Ce({environment:t,store:o,value:h.aSf({textValue:s,selection:r,annotation:n}),transaction:i})}}function Fe(e){Ne({...e,annotationTypeOrKey:e.type,updateSelection:!0})}function Ne(e){const{environment:t,store:o,selection:n,annotationTypeOrKey:r,transaction:i,updateSelection:s}=e,l=o.getValue();if(!l)return;let c;const d=o.isTable(p.iU)&&(0,N.sQ)(o)||o.getRecordStoreAtRootPath();d instanceof $.G&&C.Ls({store:o,blockStore:d})?(!function(e){const{blockStore:t,selection:o,annotationTypeOrKey:n,transaction:r}=e;(0,v.T)(t.useCrdt());const i=t.getBlockTitleStore().getValue(),s=h.Ulv(i,o);if((0,L.wd)(s))return;const l=(0,v.TO)(t.getTextSliceTree()),c=new a.W3(h.eeV(i));if("string"==typeof n&&h.WU4(n)){const e=n,o=[],a=[],d=h.fWo({textValue:i,startIndex:s.startIndex,endIndex:s.endIndex,annotationType:e});for(const{startIndex:t,endIndex:n,annotationKey:r}of d){const{startIndex:e,endIndex:i}=c.getInclusiveStringRangeForSelection({startIndex:t,endIndex:n}),{operations:s,invertedOperations:d}=l.getOperationsForRemoveAnnotation(e,i,r);o.push(...s),a.push(...d)}o.length>0&&oe({transaction:r,store:t,crdtOperations:o,invertedOperations:a})}else{const{startIndex:e,endIndex:o}=c.getInclusiveStringRangeForSelection(s),{operations:i,invertedOperations:a}=l.getOperationsForRemoveAnnotation(e,o,n);oe({transaction:r,store:t,crdtOperations:i,invertedOperations:a})}}({blockStore:d,selection:n,annotationTypeOrKey:r,transaction:i}),c=(0,v.TO)(o.getValue())):(c=h.STJ({textValue:l,selection:n,annotationTypeOrKey:r}),Ie({environment:t,store:o,value:c,transaction:i})),s&&fe.Z5({store:o,selection:n}),Je({environment:t,store:o,oldTextValue:l,newTextValue:c,transaction:i,rootStore:d,removeInlineRecords:!0})}function je(e){const{environment:t,sourceStore:o,sourceIndex:n,targetStore:r,targetIndex:i,transaction:a}=e,s=h.lzi(o.getValue()),l=h.QaF(s).length,{tokensInsideRange:c}=h.xrQ(s,n,l);c.length>0&&(Se({environment:t,store:o,selection:{startIndex:n,endIndex:l},transaction:a,updateSelection:!0,removeInlineRecords:!1}),ke({environment:t,store:r,tokens:c,index:i,transaction:a}))}function Oe(e){const{environment:t,closestSelectable:o,shiftKey:r,transaction:i}=e;if((0,D.Aw)(t))return void function(e){const{transaction:t}=e,o=Q.default.state;if("editing"!==o.mode)return;const{multiSelection:r}=o,i=(0,D.Nj)({multiSelection:r,includeNonSelectable:!0});if(!i)return;const{tree:a,treeRange:s}=i,l=a.value.store,c=f.o.getIndentOperationsFromTreeRange(s,e.direction);for(const n of c){const{target:e,operation:o}=n,r=(0,F.kC)({rootStore:l,root:a,target:e});if(void 0===r)throw new Error("Cannot find node to indent");let i=!1;switch(o){case"indentSelf":case"indentSelfAndSubtree":if(r.length>=2){const e=r[r.length-2],n=r[r.length-1];if(n){let r="indentSelf"===o?"self":"subtree";(0,U.BX)(n)&&!J.Z.isOpen(n.id)&&(r="subtree");void 0!==le.dD({block:n,parentStore:e,transaction:t,type:r})&&(i=!0)}}break;case"unindentSelfAndUpdateSiblings":if(r.length>=3){const e=r[r.length-3],o=r[r.length-2],n=r[r.length-1];if(o&&n){void 0!==le.uv({block:n,parentStore:o,grandparentStore:e,transaction:t})&&(i=!0)}}}i&&f.F.applyMutable(a,n)}n.default.afterNextFlush((()=>{const e=(0,F.kC)({rootStore:l,root:a,target:s.start}),t=(0,F.kC)({rootStore:l,root:a,target:s.end}),o=e&&(0,N.mh)(e[e.length-1]),n=t&&(0,N.mh)(t[t.length-1]);if(o&&n){const e={start:{store:o,index:r.start.index},end:{store:n,index:r.end.index}};fe.NA({multiSelection:e})}}))}({environment:t,transaction:i,direction:e.shiftKey?"unindent":"indent"});const a=r?le.rB({environment:t,blocks:[o],transaction:i}):le.WY({environment:t,blocks:[o],transaction:i});if(!a)return;const s=Q.default.state;if("editing"===s.mode){var l;const e=null===(l=(0,D.xI)("textActions",s.multiSelection))||void 0===l?void 0:l.selection;if(!e)return;n.default.afterNextFlush((()=>{const n=V.C.findSelectableFromStore(a[0]);if(me.wI({store:o,replace:a[0]}),n){const o=(0,N.mh)(n.props.store);o?fe.Z5({store:o,selection:e}):me.$Y({environment:t,phase:Y.SelectionPhase.Selected})}}))}}function Le(e){const{transaction:t,direction:o}=e,r=Q.default.state;if("editing"!==r.mode)return;const{multiSelection:i}=r,a=(0,D.tp)({multiSelection:i,filterCommonAncestors:!0,focus:void 0});if(!a)return;const s=a.stores;("up"===o?le.A1({transaction:t,blocks:s}):le.vi({transaction:t,blocks:s}))&&n.default.afterNextFlush((()=>{const[e,t]=V.C.findSelectablesFromIds([i.start.store.id,i.end.store.id]),o=(null==e?void 0:e.props.store)&&(0,N.mh)(null==e?void 0:e.props.store),n=(null==t?void 0:t.props.store)&&(0,N.mh)(null==t?void 0:t.props.store);o&&n&&(fe.NA({multiSelection:{start:{store:o,index:i.start.index},end:{store:n,index:i.end.index}},forceEmit:!0}),ue.Zv())}))}function Ue(e){const{transaction:t,environment:o,multiSelection:n}=e;n&&!(0,A.qS)(n)&&ve({environment:o,transaction:t,multiSelection:n}),Ze({...e,usingMultiSelection:!0})}function Ze(e){const{environment:t,store:o,newValue:n,disableMentions:r,disableDateMentions:i,disableSlashCommands:s,disableEmojiCommands:l,disableDateReminderMentions:c,disableFilters:d,disableTemplateVariableMentions:p,transaction:u,usingMultiSelection:m}=e,g=o.getValue(),f=h.QaF(g),y=j.UZ(f,n),v=Q.default.state;if("editing"!==v.mode)return;const b=v.multiSelection.start.index;let S=0;for(let h=0;h<y.length;h++){const e=y[h];if(S+a.p4(e[1]).length>b){if(e[0]===j.JZ){const t=y[h-1],o=y[h+1];let n=y[h-2],r=y[h+2];if(o&&o[0]===j.D$)for(r||(r=[j.JZ,""],y.push(r));S+a.p4(e[1]).length>b&&e[1].endsWith(o[1]);)e[1]=e[1].slice(0,e[1].length-o[1].length),r[1]=o[1]+r[1];else if(t&&t[0]===j.D$)for(n||(n=[j.JZ,""],y.unshift(n));S+a.p4(e[1]).length>b&&e[1].startsWith(t[1]);)e[1]=e[1].slice(t[1].length),n[1]=n[1]+t[1],S-=a.p4(t[1]).length}break}S+=a.p4(e[1]).length}let _=!1,w=!1,k=0;for(const[x,I]of y)if(x===j.D$)_=!0,we({environment:t,store:o,selection:{startIndex:k,endIndex:k},string:I,disableMentions:r,disableDateMentions:i,disableDateReminderMentions:c,disableSlashCommands:s,disableEmojiCommands:l,disableFilters:d,disableTemplateVariableMentions:p,transaction:u}),k+=a.p4(I).length;else if(x===j.NL){_=!0,w=I===h.qyI;be({environment:t,store:o,selection:{startIndex:k,endIndex:k+a.p4(I).length},transaction:u})}else x===j.JZ&&(k+=a.p4(I).length);!_||w||t.TextSelectionCompositionStore.state.isComposing||Ve({environment:t,store:o,usingMultiSelection:m})}function Ve(e){const{environment:t,usingMultiSelection:o,store:n}=e;if(o){const e=O.get(),t=(0,D.fx)({range:e,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0});t&&fe.NA(t)}else{const e=T.Ut(t);e&&(fe.Z5({store:n,selection:e.selection}),e.forceEmitSelectionStore&&Q.default.emit())}}function qe(e){const{environment:t,store:o,selection:n,annotation:r,analyticsFrom:i,transaction:a}=e;be({environment:t,store:o,selection:n,transaction:a});const s=(0,L.yj)(n,o),l=[h.YCD(r,s),h.V3y(" ",s)];if(ke({environment:t,store:o,tokens:l,index:n.startIndex,transaction:a}),fe.Z5({store:o,selection:{startIndex:n.startIndex+l.length,endIndex:n.startIndex+l.length}}),h.IWo(r)&&(o.isTable("block")||o.isTable("comment"))){const e=t.currentUser.id,n=h.zEN(r),a=o.getRecordStoreAtRootPath();e&&ne.TIz(t,{is_current_user:n===e,user_id:n,from:i,block_type:a instanceof $.G?a.getType():void 0})}else if(h._bk(r)&&(o.isTable("block")||o.isTable("comment"))){var c;const e=null===(c=h.kxk(r))||void 0===c?void 0:c.groupId,n=o.getRecordStoreAtRootPath();e&&ne.Z0d(t,{group_id:e,from:i,block_type:n instanceof $.G?n.getType():void 0})}else if(h.fpG(r)&&(o.isTable("block")||o.isTable("comment"))){const e=h.zyO(r),n=o.getRecordStoreAtRootPath();ne.VN$(t,{date:e,from:i,block_type:n instanceof $.G?n.getType():void 0})}else if(h.STW(r)&&(o.isTable("block")||o.isTable("comment"))){const e=h.TOT(r),n=o.getRecordStoreAtRootPath();ne.Qqh(t,{page_id:e,from:i,block_type:n instanceof $.G?n.getType():void 0})}}function ze(e){const{environment:t,store:o,selection:n,emoji:r,transaction:i}=e;be({environment:t,store:o,selection:n,transaction:i});const a=[h.V3y(r)];ke({environment:t,store:o,tokens:a,index:n.startIndex,transaction:i}),fe.Z5({store:o,selection:{startIndex:n.startIndex+a.length,endIndex:n.startIndex+a.length}})}function We(e){const{environment:t,shouldStripTokens:o,disableFilters:n,store:r,selection:i,transaction:s}=e,l=(0,L.fM)(r,i,o),d=o?h.Jcv(r.getValue()):h.QaF(r.getValue());let p=a.p4(d),u=0;for(const a of l)if(u++,0===a)p.unshift("\t");else{const e=a+u;p=[...c.tP(p,0,e),"\t",...c.tP(p,e)]}Ze({environment:t,store:r,newValue:h.vJ3(p.join("")),disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:n,transaction:s}),fe.Z5({store:r,selection:{startIndex:i.startIndex+1,endIndex:i.endIndex+u}})}function He(e){const{environment:t,shouldStripTokens:o,disableFilters:n,store:r,selection:i,transaction:s}=e,l=(0,L.fM)(r,i,o),d=o?h.Jcv(r.getValue()):h.QaF(r.getValue());let p=a.p4(d),u=0,m=0;for(const a of l){const e=a-u;0===e?"\t"===p[0]?(p=c.tP(p,1),u+=1):" "===p[0]&&" "===p[1]?(p=c.tP(p,2),u+=2):" "===p[0]&&(p=c.tP(p,1),u+=1):"\t"===p[e+1]?(p=[...c.tP(p,0,e+1),...c.tP(p,e+2)],u+=1):" "===p[e+1]&&" "===p[e+2]?(p=[...c.tP(p,0,e+1),...c.tP(p,e+3)],u+=2):" "===p[e+1]&&(p=[...c.tP(p,0,e+1),...c.tP(p,e+2)],u+=1),a<=i.startIndex&&(m=u)}Ze({environment:t,store:r,newValue:h.vJ3(p.join("")),disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:n,transaction:s}),fe.Z5({store:r,selection:{startIndex:i.startIndex-m,endIndex:i.endIndex-u}})}function Ge(e){const{token:t,store:o,readOnly:n}=e;let r=0,i=0;if(t.textValue){let e=0;for(;e<t.tokenIndex;)r+=h.J1x(t.textValue[e]),e++;i=r+h.J1x(t.textValue[e])}fe.Z5({store:o,selection:{startIndex:r,endIndex:i},readOnly:n})}function Ke(e){const{environment:t,event:o,interactiveToken:a,store:s,parentStore:l,canEdit:c}=e,f=h.hDy(a.textToken),v=h.rlz(f),k=h.wPk(f),I=h.V8Y(f),C=h.jC0(f),T=h.zrg(f).map((e=>h.h19(e)));if(h.YrK(a.textToken)&&!o.shiftKey&&!o.altKey){if(o.preventDefault(),z.Z.state.open)se.Wj();else{const e=a.textToken,o=document.createRange(),r=a.node.parentNode,i=a.tokenIndex+1;o.setStart(r,a.tokenIndex),o.setEnd(r,i),O.set(o,t.device),fe.dd({store:s}),n.default.afterNextFlush((()=>{if("editing"!==Q.default.state.mode)return;const o=(0,A.QY)(Q.default.state.multiSelection);o&&se.qn({environment:t,selectedToken:{token:e,position:o.selection},selectionRect:a.node.getBoundingClientRect(),analyticsFrom:"click_token"})}))}return}const D=T.map((e=>{const t=l||s;return $.t1.createChildStore(t,{table:m.qF,id:e,spaceId:(0,g.C)(t.pointer.spaceId)})})),{unresolved:F}=R.bB(D);if(F.length>0){const e=Boolean(v||I),n=q.Z.state.open||t.device.isMobile,r=(0,N.sQ)(s);if(e&&n)b.LZ();else if(r){const i=o.target&&o.target.getBoundingClientRect();if(b.Ib({environment:t,blockStore:r,analyticsFrom:"existing_comment",discussionIds:F.map((e=>e.id)),rect:i,shouldFocusDiscussion:!1,recursivelyLoadAllDiscussions:!1}),e&&!n)return void o.preventDefault()}}else{R.dv(s)||Z.Z.find((e=>e.isEditing()))||b.LZ()}let j,L;v&&(j=y.Nm({str:h.zW$(v),allowNoProtocol:!0}));let U=!1;if(I){L=h.TOT(I);const e=$.G.createChildStore(l||s,{table:p.iU,id:L});U=e.isNavigableBlock();const n=(o.altKey||G.default.isSidePeekOpen())&&!o.metaKey;j=(0,P.ZP)({store:e,openInSidePeek:n,preferPublicLink:(0,E.Sr)(),getSpaceDomain:()=>{var o;return null===(o=K.Z.getPublicSpaceData(t,e.getSpaceId()))||void 0===o?void 0:o.domain},pageVisitSource:r.tY.LinkInPage})}if(C){const{blockId:e}=h.Vv0(C);if(e){const o=$.G.createChildStore(l||s,{table:p.iU,id:e});U=o.isNavigableBlock(),j=(0,P.ZP)({store:o,openInSidePeek:!1,preferPublicLink:(0,E.Sr)(),getSpaceDomain:()=>{var e;return null===(e=K.Z.getPublicSpaceData(t,o.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:r.tY.LinkInPage})}}if(j){o.preventDefault(),fe.ZH(t),ye.lY();const{device:e}=t;if(e.isIOS&&fe.sD(),o.shiftKey&&!o.altKey)return;const n=(0,d.Wj)({url:j,baseUrl:x.default.domainBaseUrl,publicDomainName:x.default.publicDomainName,isMobile:t.device.isMobile,protocol:x.default.protocol,currentUrl:window.location.href});if("page"===n.name){const e=M.DJ(o);_.navigate({environment:t,url:j,openInNew:e}),I&&L&&ne.SK1(t,{page_visit_id:H.$g.getCurrentPageVisitId(),mentioned_page_id:L,source_type:"inline_page_mention_token",hover_preview_enabled:W.default.checkGate("first_party_links"),is_navigable_block:U})}else{if("aiGtmFavoriteImport"===n.name&&t.currentUser.isLoggedIn())return void(0,w.M)({environment:t,importArgs:n});_.navigateToExternalURL({environment:t,url:j})}}else{if(c){const{textToken:e,node:n,tokenIndex:r}=a,i=h.hDy(e);if(h.K9C(i))return ye.lY(),S.b(t,{originRect:n.getBoundingClientRect(),textStore:s,tokenIndex:r,allowReminders:"comment"!==s.table}),void o.preventDefault()}if(k){const e=$.T5.createChildStore(s,{table:u.x_,id:k[1],spaceId:k[2]}),n=e.getModel();if(!n)return;const a=B.Dg(e);if(!a)return;const l=$.jQ.createChildStore(a,n.getParentPointer()).getModel();if(!l)return;const c=$.G.createChildStore(a,l.getParentPointer()).getModel(),d=c&&"table_row"===c.getType()?c.getParentId():l.getParentId(),p=(0,i.Z)({pageId:a.id,scrollToBlockId:d,pageModel:a.getModel(),baseUrl:void 0,discussionId:l.id,pageVisitSource:r.tY.MentionInPage});o.preventDefault(),_.navigate({environment:t,url:p})}}}function $e(e){const{environment:t,event:o,interactiveToken:n,store:r,parentStore:i}=e;if(!i)return;const a=h.hDy(n.textToken),s=h.V8Y(a);if(s){const e=h.yrl(s);if(!e)return;const n=$.G.createChildStore(i||r,e);o.preventDefault(),re.Qn({environment:t,stores:[n],left:o.clientX,top:o.clientY,showInput:!1,actionSectionGroupKey:"page_mention",analyticsFrom:"page_mention_block_menu",pageAnnotationToken:{parentStore:i,pageAnnotation:s}})}}function Ye(e){ye.HM({token:e.interactiveToken,store:e.store})}function Qe(e){ye.lY()}function Je(e){const{store:t,environment:o,oldTextValue:n,newTextValue:r,transaction:i,rootStore:a,removeInlineRecords:s}=e;if(a instanceof $.G){const e=new Set(c.zu(h.llS(n),...h.llS(r)));for(const t of e){const e=$.t1.createChildStore(a,{table:m.qF,id:t,spaceId:(0,g.C)(a.pointer.spaceId)});k.Gu({discussionStore:e,blockStore:a,transaction:i})}}if(s){if(a instanceof $.G){const e=a.getValue();if(e){const s=(0,l.m3)({parentBlock:e,oldTextValue:n,newTextValue:r,getRecordValue:t.getRecordValue,baseUrl:x.default.domainBaseUrl,publicDomainName:x.default.publicDomainName});ce.lP({environment:o,transaction:i,parentStore:a,inlinePageIds:s})}}const e=c.zu(h.zUo(n),...h.zUo(r));for(const t of e){const e=$.G.createChildStore(a,{table:p.iU,id:t,spaceId:(0,g.C)(a.pointer.spaceId)});pe.sW({store:e,data:{alive:!1},transaction:i})}}}function Xe(e){const{block:t,transaction:o,tokenIndex:n}=e,r=t.getBlockTitleStore();if(!t.getTitleStore()||!r.isDefined()||!r.getValue()||r.getValue().length<n)return!1;const i=r.getValue(),a=h.VrM(i.slice(0,n)),s=h.VrM(i.slice(0,n+1));return Se({environment:t.environment,store:r,selection:{startIndex:a,endIndex:s},transaction:o,updateSelection:!1,removeInlineRecords:!0}),!0}function et(e){var t;const{store:o,transaction:n}=e,r=ie.tk();if(!r)return;if(!("editing"===Q.default.state.mode&&(null===(t=(0,A.QY)(Q.default.state.multiSelection))||void 0===t?void 0:t.selection)))return;const i=o.getValue();if(!i)return;const a=(0,s.UQ)(i,r.parentCollection,o.getRecordModel);Ie({environment:o.environment,store:o,value:a,transaction:n})}},98724:(e,t,o)=>{o.d(t,{V$:()=>f,aS:()=>g,bt:()=>y,mX:()=>h});var n=o(72126),r=o(70203),i=o(63143),a=o(46888),s=o(45162),l=o(89086),c=o(24666),d=o(9953),p=o(97444),u=o(98104),m=o(39699);function g(e){const{environment:t,annotation:o}=e,n=c.default.state;if("editing"!==n.mode)return;if(c.default.isEmptySelection())return void u.Km({annotation:o});const{multiSelection:r}=n;(0,s.L5)(r).length>0&&(m.createAndCommit({userAction:"textAnnotationActions.annotateSelection",environment:t,perform:e=>{p.MY({environment:t,annotation:o,multiSelection:r,transaction:e})}}),u.NA({multiSelection:r}))}function h(e){const{environment:t,annotationType:o}=e,n=c.default.state;if("editing"!==n.mode)return;if(c.default.isEmptySelection())return;const{multiSelection:r}=n,i=(0,s.L5)(r);i.length>0&&(m.createAndCommit({userAction:"textAnnotationActions.unannotateSelection",environment:t,perform:e=>{for(const{selection:n,store:r}of i)p.Be({environment:t,store:r,type:o,selection:n,transaction:e})}}),u.NA({multiSelection:r}))}function f(e){const{environment:t,annotationType:o,blocks:n,transaction:r}=e;for(const i of(0,a.V)(n)){const e=(0,l.P2)(i);e&&p.Be({environment:t,store:i,type:o,selection:e,transaction:r})}}function y(e){const{store:t,context:o,transaction:a}=e;if(!t.canEdit())return;const s=(0,i.m8)(n.oA(Object.entries(t.getProperties()).map((e=>{let[t,i]=e;if(!i)return;const a=i.map((e=>r.sBO(e,o))),s=r.L1A(a);return n.Xy(i,s)?void 0:[t,s]}))));n.xb(s)||d.sW({store:t.getPropertiesStore(),data:s,transaction:a})}},56971:(e,t,o)=>{o.d(t,{YV:()=>M,as:()=>T,ew:()=>C});o(67635);var n=o(1302),r=o(41432),i=o(72126),a=o(78791),s=o(65273),l=o(68056),c=o(73959),d=o(89086),p=o(35328),u=o(28685),m=o(95802),g=o(77080),h=o(24666),f=o(96802),y=o(44886),v=o(94419),b=o(42858),S=o(24677),_=o(97444),w=o(98104),k=o(68422);function x(e){const{transaction:t,store:o,block:n,targetStore:r}=e;n&&(0,s.Ls)({store:o,blockStore:n})?a.tE({transaction:t,targetStore:r,block:n}):I(e)}function I(e){const{environment:t,transaction:o,store:n,targetStore:r}=e,i=(0,d.x0)(r);i?_.gc({environment:t,sourceStore:n,sourceIndex:0,targetStore:r,targetIndex:i.endIndex,transaction:o}):_.pe({environment:t,transaction:o,store:n,selection:{startIndex:0,endIndex:1/0}})}function C(e){const{environment:t,store:o,transaction:i}=e;i.annotateWithUserAction("textBackspaceActions.annotatedContentBlockBackspaceAtBeginning");const a=(0,c.sQ)(o);if(a){"callout"===a.getType()&&f.FH({stores:[a],update:{block_color:void 0},transaction:i});let e=a,o=r.Ti.text;if(p.fn(a)){const e=a.getType();e&&(o=e)}e=k.vs({environment:t,block:a,blockType:o,transaction:i}),n.default.afterNextFlush((()=>{const o=m.C.findEditableStoreWithin(e);o&&(w.N_({store:o}),S.eP({environment:t,store:e}))}))}return o}function T(e){const{environment:t,multiSelection:o,transaction:a,deleteForwards:s,event:k}=e,T=t.device.isApple&&k.metaKey,M=!(t.device.isIOS&&(0,l.iG)(o));w.aJ();const P=(0,l.QY)(o);if(P&&0===P.selection.startIndex&&0===P.selection.endIndex&&!s){const{store:e}=P;k.preventDefault();const o=(0,c.sQ)(e);if(o){const s=o.getModel();if(s){const o=s.isType(r.q7);o&&!T?C({environment:t,store:e,transaction:a}):s.isType(r.Q3)||o&&T?function(e){const{store:t,transaction:o,environment:r}=e;o.annotateWithUserAction("textBackspaceActions.textBackspaceAtBeginning");const a=(0,c.sQ)(t);if(!a)return;const s=(0,c.sQ)(a),l=s&&(0,c.sQ)(s);if(s&&l){const e=s.getRenderableContentIds()??[];if(!(i.Z$(e)!==a.id||s.isTransclusionType()||p.BX(s)&&i.Ps(e)===a.id||"tab"===l.getType())){const e=y.uv({block:a,parentStore:s,grandparentStore:l,transaction:o});if(e)return void n.default.afterNextFlush((()=>{if(e){const t=m.C.findEditableStoreWithin(e);t&&(S.eP({environment:r,store:e}),w.N_({store:t}))}}))}}if(g.default.checkGate("text_align")){if("center"===a.getFormat().block_alignment)return void f.hc({environment:r,store:a,alignment:"left",transaction:o});if("right"===a.getFormat().block_alignment)return void f.hc({environment:r,store:a,alignment:"center",transaction:o})}const h=u.E.getMembersByDOMOrder({filter:e=>!e.props.store.inMemoryRecordCache.isMockTextStore}),_=i.cx(h,(e=>e.props.store===t)),k=i.dF(h,((e,t)=>t<_&&e.props.canInsertText));let I;if(k&&(I=k.props.store),I&&a){const e=(0,d.x0)(I);x({environment:r,transaction:o,store:t,block:a,targetStore:I}),w.Z5({store:I,selection:e});const n=(0,c.sQ)(I);if(S.eP({environment:r,store:n}),!p.BX(a)&&s){const e=a.getContentStores();for(const r of e)v.Vt({parent:s.getContentStore(),before:a,insert:r,transaction:o});const t=a.getContentStore(),n=a.getContentStores();for(const r of n)v.Od({parent:t,childToRemove:r,transaction:o})}b.Od({store:a,transaction:o})}}({environment:t,store:e,transaction:a}):s.isType(r.oe)&&function(e){const{environment:t,store:o,transaction:n}=e;n.annotateWithUserAction("textBackspaceActions.captionBackspaceAtBeginning");const r=u.E.getMembersByDOMOrder({filter:()=>!0}),i=r.findIndex((e=>e.props.store===o)),a=r.findLast(((e,t)=>t<i&&e.props.canInsertText)),s=null==a?void 0:a.props.store;if(!s)return;if(!(0,c.sQ)(o))return;const l=(0,d.x0)(s);I({environment:t,store:o,targetStore:s,transaction:n}),w.Z5({store:s,selection:l});const p=(0,c.sQ)(s);S.eP({environment:t,store:p})}({environment:t,store:e,transaction:a})}}}else P&&(0,d.J_)(P.store,P.selection)&&s?(k.preventDefault(),function(e){const{environment:t,store:o,transaction:n}=e;n.annotateWithUserAction("textBackspaceActions.textDeleteAtEnd");const r=u.E.getMembersByDOMOrder({filter:()=>!0}),a=i.cx(r,(e=>e.props.store===o)),s=r.find(((e,t)=>Boolean(t>a&&e.props.canInsertText)));let l;if(s&&(l=s.props.store),(0,c.sQ)(o)&&l){const e="readOnly"===h.default.state.mode,r="empty"!==h.default.state.mode&&h.default.state.multiSelection;x({environment:t,transaction:n,store:l,block:(0,c.sQ)(l),targetStore:o});const i=(0,c.sQ)(l);if(i){const t=(0,c.sQ)(i);if(t){const e=i.getContentStore(),o=i.getContentStores();for(const r of o)v.Od({parent:e,childToRemove:r,transaction:n}),v.Vt({parent:t.getContentStore(),before:i,insert:r,transaction:n})}b.Od({store:i,transaction:n}),r&&w.NA({multiSelection:r,readOnly:e})}}}({environment:t,store:P.store,transaction:a})):M&&(k.preventDefault(),function(e){const{environment:t,multiSelection:o,transaction:n,deleteForwards:r}=e;let i;n.annotateWithUserAction("textBackspaceActions.textBackspaceWithinContent"),i=(0,l.iG)(o)?r?{start:o.start,end:{store:o.start.store,index:o.start.index+1}}:{start:{store:o.start.store,index:o.start.index-1},end:o.start}:o,_.pz({environment:t,multiSelection:i,transaction:n})}({environment:t,multiSelection:o,deleteForwards:s,transaction:a}));const A=h.default.state;"editing"===A.mode&&(0,d.ST)(A.multiSelection.start.store.getValue(),A.multiSelection.start.index-1,"c")&&w.aR({annotation:["c"],extend:!0})}function M(e){const{event:t,multiSelection:o,device:n}=e;return(n.isApple&&t.metaKey||!n.isApple&&t.ctrlKey||n.isApple&&t.altKey)&&!(0,d.dQ)(o)}},74284:(e,t,o)=>{o.d(t,{IO:()=>P,PF:()=>B});o(52262),o(24506);var n=o(1302),r=o(41432),i=o(72126),a=o(21202),s=o(70203),l=o(82798),c=o(78791),d=o(68056),p=o(73959),u=o(35328),m=o(77080),g=o(35661),h=o(24666),f=o(45131),y=o(34583),v=o(50906),b=o(44886),S=o(94419),_=o(9953),w=o(61045),k=o(24677),x=o(97444),I=o(56971),C=o(98104),T=o(29373);function M(e){const t=(0,p.sQ)(e.store);if(t&&function(e){var t;const o=e.getType();return!!o&&(!!(0,r.he)(o)&&!(e.id!==(null===(t=e.getParentBlockStore())||void 0===t?void 0:t.getRenderableContentIds().at(-1))))}(t)){const o=b.rB({environment:e.environment,blocks:[t],transaction:e.transaction});if(o)return void n.default.afterNextFlush((()=>{const e=o[0].getTitleStore();e&&C.NA({multiSelection:{start:{store:e,index:0},end:{store:e,index:0}}})}))}I.ew(e)}function P(e){const{environment:t,transaction:o,multiSelection:a}=e;y.M_(t)&&((0,p.x7)(a.start.store)?function(e){const{environment:t,transaction:o}=e;let i=e.multiSelection;const a=(0,p.sQ)(i.start.store);if(!a||a.isCollectionView())return;x.pz({environment:t,multiSelection:i,transaction:o});const s=h.default.state;i="editing"===s.mode&&s.multiSelection||i;const l=i.start.store,c=_.j4({environment:t,type:r.Ti.text,inMemoryRecordCache:l.inMemoryRecordCache,transaction:o,spaceId:a.pointer.spaceId,useCrdt:a.useCrdt()}),d=S.Ce({parent:a.getContentStore(),prepend:c,transaction:o}).child;B({environment:t,block:a,store:l,targetBlock:d,splitAtIndex:i.start.index,transaction:o}),n.default.afterNextFlush((()=>{C.N_({store:d.getBlockTitleStore()})})),v.W2j(t,{from:"text_enter",type:r.Ti.text})}(e):(0,d.iG)(a)&&function(e){const t=e.getRecordStoreUIParent();return t instanceof g.G&&e&&t.isType(r.q7)&&0===s.QaF(t.getTitleValue()).length}(a.start.store)?M({environment:t,transaction:o,store:a.start.store}):(0,d.ko)(a)&&A(a.start.store)&&D(a.start.store)?function(e){var t;const{environment:o,transaction:a,multiSelection:l}=e,c=l.start.store,d=(0,p.sQ)(c);if(!d)return;const m=d.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(d)})),g=(0,p.sQ)(d);if(!m||!g)return;const h=_.j4({environment:o,type:m.type,inMemoryRecordCache:c.inMemoryRecordCache,transaction:a,spaceId:g.pointer.spaceId,properties:m.properties?R(m.properties):void 0,format:m.format?E(m.format):void 0,permissions:m.permissions,useCrdt:Boolean(null===(t=m.format)||void 0===t?void 0:t.use_crdt)}),{id:y,space_id:b,properties:k,format:x,permissions:I,discussions:C,...M}=m,P=i.zu(C,...s.llS(c.getValue()));_.sW({store:h,data:{...M,discussions:P},transaction:a});const D=S.BE({parent:g.getContentStore(),after:d,insert:h,transaction:a}).child;if(A(c)&&d){const e=d.getContentStores(),t=d.getContentStore(),o=h.getContentStore();for(const n of e)S.Od({parent:t,childToRemove:n,transaction:a}),S.R3({parent:o,append:n,transaction:a})}(0,u.BX)(d)&&T.rd({blockId:h.id,state:f.Z.isOpen(d.id),currentUserId:o.currentUser.id}),(0,r.he)(m.type)||_.sW({store:d,transaction:a,data:{type:r.Ti.text}}),_.sO({store:d.getDiscussionsStore(),transaction:a,value:[]}),B({environment:o,block:d,store:c,targetBlock:D,splitAtIndex:l.start.index,transaction:a}),v.W2j(o,{from:"text_enter",type:r.Ti.text}),o.device.isMobile&&n.default.afterNextFlush((()=>w.hQ(o)))}(e):function(e){var t;const{environment:o,transaction:n}=e;let i=e.multiSelection;const a=(0,p.sQ)(i.start.store);if(!a)return;const s=(0,p.sQ)(a);if(!s)return;x.pz(e);const l=h.default.state;i="editing"===l.mode&&l.multiSelection||i;const c=i.start.store,d=a.getType(),g=a.getContentLength(),y=a.getModel();let b;if((0,u.BX)(a)&&f.Z.isOpen(a.id))b=r.Ti.text;else if(y&&g>0&&y.isType(r.nH)){b=r.Ti.text;const e=a.getContentStores()[0];if(e){const t=e.getType();e.isDefined()&&t&&r.kC[t]&&(b=t)}}else b=!(d&&y&&!y.isType(r.Q2)&&A(c)&&D(c)&&"code"!==d)||y.isType("ai_block")&&y.isSkillBlock()?r.Ti.text:d;const w=_.j4({environment:o,type:b,inMemoryRecordCache:c.inMemoryRecordCache,transaction:n,spaceId:s.pointer.spaceId,format:{block_alignment:m.default.checkGate("text_align")?null===(t=a.getFormat())||void 0===t?void 0:t.block_alignment:void 0},useCrdt:a.useCrdt()}),k=s.getRenderableContentIds()||[];let I,C=!1;if((0,u.BX)(a)&&f.Z.isOpen(a.id)){const e=a.getContentStore();C=!0,I=S.Ce({parent:e,prepend:w,transaction:n})}else if(y&&g&&y.isType(r.nH)){const e=a.getContentStore();C=!0,I=S.Ce({parent:e,prepend:w,transaction:n})}else if(null!=y&&y.isType("ai_block")&&y.isSkillBlock()){const e=a.getContentStore();C=!0,I=S.Ce({parent:e,prepend:w,transaction:n})}else I=k.indexOf(a.id)>=0?S.BE({parent:s.getContentStore(),after:a,insert:w,transaction:n}):S.Ce({parent:s.getContentStore(),prepend:w,transaction:n});const T=I.child;if(A(c)&&d&&!C&&!(0,u.BX)(a)){const e=a.getContentStores(),t=a.getContentStore(),o=T.getContentStore();for(const r of e)S.Od({parent:t,childToRemove:r,transaction:n}),S.R3({parent:o,append:r,transaction:n})}B({environment:o,block:a,store:i.start.store,targetBlock:T,splitAtIndex:i.start.index,transaction:n}),v.W2j(o,{from:"text_enter",type:b,is_toggleable:(0,u._A)(b,w.getFormat())})}(e),t.device.isMobile||n.default.afterNextFlush((()=>{w.Zv()})))}function A(e){if(e.table===a.iU){const t=g.G.createChildStore(e,{table:a.iU,id:e.id}).getType();return t&&!(0,r.S9)(t)}return!1}function D(e){if(e.table===a.iU){const t=g.G.createChildStore(e,{table:a.iU,id:e.id}).getModel();return t&&!t.isType(r.oe)&&!t.isType(r.Ok)}return!1}function B(e){const{environment:t,block:o,store:n,targetBlock:r,splitAtIndex:i,transaction:a}=e,s={store:n,index:i},p={start:s,end:s};if(o.useCrdt()&&o.getBlockTitleStore()===n){(0,l.T)(r.useCrdt(),"Calling splitText() with a non-CRDT target block is not currently supported");(0,d.NV)(p)||c.Wc({sourceBlockStore:o,targetBlockStore:r,splitAtGraphemeIndex:i,transaction:a,moveIntoNewBlock:!0})}else x.gc({environment:t,sourceStore:p.end.store,sourceIndex:p.end.index,targetStore:r.getBlockTitleStore(),targetIndex:0,transaction:a});k.eP({environment:t,store:r}),C.N_({store:r.getBlockTitleStore()})}function R(e){const{title:t,...o}=e;return o}function E(e){const{text_slice_tree:t,text_clocks:o,...n}=e;return n}},17269:(e,t,o)=>{o.d(t,{G:()=>W,f:()=>H});o(97391),o(57658);var n=o(41432),r=o(15095),i=o(72126),a=o(32056),s=o(21202),l=o(70203),c=o(82798),d=o(11342),p=o(40959),u=o(83631);function m(e,t){return r.p4(e.substring(0,t)).length}var g=o(68056),h=o(99445),f=o(73959),y=o(35328),v=o(35661),b=o(27724),S=o(24666),_=o(50906),w=o(47839),k=o(96802),x=o(42858),I=o(24677),C=o(97444),T=o(74284),M=o(98104),P=o(39699),A=o(68422);function D(e){var t;const{environment:o,store:i,toBlockType:a,matchRegex:s,insertTextAfter:d,transaction:u,postTransformAction:m}=e,h="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!h)return;const w=r.p4(l.QaF(i.getValue())).slice(0,h.endIndex).join(""),k=s.exec(w);if(!k)return;const P=i.getRecordStoreUIParent();if(!(P&&P instanceof v.G))return;const D=P.getType();if(!D)return;if(D!==n.Ti.text&&!n.q7[D])return;const B=a(k);if(void 0===B||B===D)return;let R=B;P instanceof v.G&&("toggle"===B&&(0,n.zp)(P.getType())?R=y.m1(D):"toggle"===D&&y.JO(B)&&(R=y.m1(B)),A.vs({environment:o,block:P,blockType:R,transaction:u}));const E={startIndex:0,endIndex:k&&r.p4(k[0]).length||0};if(C.pe({environment:o,store:i,selection:E,transaction:u}),d){const e=x.aO({environment:o,selection:b.default.state.stores,createBlockItem:p.Hc[n.Ti.text],analyticsFrom:"text_filter_actions",transaction:u});e&&(T.PF({environment:o,block:(0,c.TO)((0,f.sQ)(i)),store:i,targetBlock:e,splitAtIndex:0,transaction:u}),I.eP({environment:o,store:e}),M.N_({store:e.getBlockTitleStore()}))}m&&m(k),_.g_k(o,{type:B})}function B(e){var t,o;const{environment:n,store:i,transaction:a,regex:s,length:c,analyticsType:d,replace:p}=e,u="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!u)return;const h=i.getValue()||[],f=l.QaF(h),y=r.p4(f).slice(0,u.endIndex).join(""),v=s.exec(y);if(!v)return;const b=m(f,v.index),w={startIndex:b,endIndex:b+c},k=i.getValue()||[];if(l.oP(k,w.startIndex,w.endIndex,"c"))return;const x="function"==typeof p?p({match:v,matchIndex:b,textValue:h}):p;if(void 0===x)return;if(C.pe({environment:n,store:i,selection:w,transaction:a}),"editing"!==S.default.state.mode)return;const I=null===(o=(0,g.QY)(S.default.state.multiSelection))||void 0===o?void 0:o.selection;I&&(C.hJ({environment:n,store:i,selection:I,string:x,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:a}),_.Af_(n,{type:d}))}function R(e){var t;const{environment:o,store:n,delimiter:i,annotation:a,transaction:s}=e,c="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!c)return;const d=n.getValue(),p=E({delimiter:i,storeValue:d,selectionEndIndex:c.endIndex});if(!p)return;if(!F({delimiter:i,storeValue:d,...p}))return;if(l.p9b(d,p.startIndex,p.endIndex,l.GKr.Code))return;const{textValue:u,startIndex:h,endIndex:f}=p,y=m(u,h),v=u.slice(h,f),b=r.p4(v).length,w={startIndex:y,endIndex:y+i.length};C.pe({environment:o,store:n,selection:w,transaction:s});const k={startIndex:y+b-i.length-i.length,endIndex:y+b-i.length};C.pe({environment:o,store:n,selection:k,transaction:s});const x={startIndex:w.startIndex,endIndex:k.startIndex};C.i8({environment:o,store:n,selection:x,annotation:a,transaction:s});const I=x.endIndex;M.Z5({store:n,selection:{startIndex:I,endIndex:I}}),M.aR({annotation:a,extend:!1}),_.tn$(o,{type:l.J7s(a)})}function E(e){const{delimiter:t,storeValue:o,selectionEndIndex:n}=e,a=r.p4(l.QaF(o)).slice(0,n).join("");if(0===a.length||!a.endsWith(t))return;const s=a.split(t);if(s.length<=2)return;s.reverse();const[c,...d]=s.slice(1),p=i.Sm(d.map((e=>e.length+t.length)))-t.length;return{textValue:a,matchString:c,startIndex:p,endIndex:p+c.length+2*t.length}}function F(e){const{delimiter:t,matchString:o,startIndex:n,endIndex:r,textValue:i}=e;return o.length>0&&!/\s/g.test(o[0])&&!/\s/g.test(o[o.length-1])&&!o.startsWith(t)&&!o.endsWith(t)&&(!i[n-1]||/[\s(]/g.test(i[n-1]))&&(!i[r]||/[\s)]/g.test(i[r]))}function N(e){var t;const{environment:o,delimiter:n,store:i,transaction:a}=e,s="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!s)return;const c=i.getValue(),d=E({delimiter:n,storeValue:c,selectionEndIndex:s.endIndex});if(!d)return;if(!function(e){const{storeValue:t,startIndex:o,endIndex:n,delimiter:r}=e;if(!F(e))return!1;const i={[l.GKr.User]:l.GKr.User,[l.GKr.Page]:l.GKr.Page,[l.GKr.Comment]:l.GKr.Comment,[l.GKr.Bot]:l.GKr.Bot,[l.GKr.ExternalObjectInstance]:l.GKr.ExternalObjectInstance,[l.GKr.Date]:l.GKr.Date,[l.GKr.TemporaryPage]:l.GKr.TemporaryPage,[l.GKr.TemplateVariable]:l.GKr.TemplateVariable,[l.GKr.FormulaPageProperty]:l.GKr.FormulaPageProperty,[l.GKr.FormulaContextValue]:l.GKr.FormulaContextValue,[l.GKr.Group]:l.GKr.Group,[l.GKr.Citation]:l.GKr.Citation};for(const a of Object.values(i))if(l.oP(t,o,n,a))return!1;if(l.oP(t,o,o+r.length,l.GKr.Code)&&l.oP(t,n-r.length,n,l.GKr.Code))return!1;return!0}({delimiter:n,storeValue:c,...d}))return;const{textValue:p,matchString:h,startIndex:f,endIndex:y}=d,v=m(p,f),b=p.slice(f,y);C.pe({environment:o,store:i,selection:{startIndex:v,endIndex:v+r.p4(b).length},transaction:a});const w=l.qZ6(h);C.mM({environment:o,store:i,tokens:[w],index:v,transaction:a});const k=v+r.p4(l.WiV(w)).length;M.Z5({store:i,selection:{startIndex:k,endIndex:k}}),_.tn$(o,{type:l.GKr.Equation}),u.ND({environment:o,equation:h,from:{type:"create",source:"text_filter",selection:!0}})}const j=["\\.",",",";","\\?","!","\\)","\\]"," "].join("|"),O=new RegExp(` (${j})$`);function L(e){const t=l.xrQ(e.textValue,e.matchIndex-1,e.matchIndex),o=i.Z$(t.tokensInsideRange);if(o&&l.km_(o))return e.match[1]}const U=[{delimiter:"**",type:l.GKr.Bold},{delimiter:"ï¼Šï¼Š",type:l.GKr.Bold},{delimiter:"*",type:l.GKr.Italic},{delimiter:"ï¼Š",type:l.GKr.Italic},{delimiter:"__",type:l.GKr.Bold},{delimiter:"ï¼¿ï¼¿",type:l.GKr.Bold},{delimiter:"_",type:l.GKr.Italic},{delimiter:"ï¼¿",type:l.GKr.Italic},{delimiter:"~",type:l.GKr.Strike},{delimiter:"ã€œ",type:l.GKr.Strike},{delimiter:"ï½ž",type:l.GKr.Strike}],Z=[{toBlockType:()=>n.Ti.toDo,matchRegex:/^(\[\] |\ã€Œ\ã€ã€€)$/,insertTextAfter:!1},{toBlockType:()=>n.Ti.subSubHeader,matchRegex:/^(### |ï¼ƒï¼ƒï¼ƒ)$/,insertTextAfter:!1},{toBlockType:()=>n.Ti.subHeader,matchRegex:/^(## |ï¼ƒï¼ƒ)$/,insertTextAfter:!1},{toBlockType:()=>n.Ti.header,matchRegex:/^(# |ï¼ƒ)$/,insertTextAfter:!1},{toBlockType:()=>n.Ti.toggle,matchRegex:/^(> |ï¼ž)$/,insertTextAfter:!1},{toBlockType:()=>n.Ti.quote,matchRegex:/^(\| |\" |\â€œ |\â€)$/,insertTextAfter:!1},{toBlockType:()=>n.Ti.bulletedList,matchRegex:/^(\* |\- |\+ |\ï¼Š|\ãƒ¼|\ï¼‹|\ãƒ»)$/,insertTextAfter:!1},{toBlockType:()=>n.Ti.divider,matchRegex:/^â€”-$/,insertTextAfter:!0}],V=[{annotationDelimiter:"`",blockMatchRegex:/^```$/},{annotationDelimiter:"Â´",blockMatchRegex:/^Â´Â´Â´$/},{annotationDelimiter:"ï½€",blockMatchRegex:/^ï½€ï½€ï½€$/}],q=[{regex:/^'$/,length:1,replace:"â€˜",analyticsType:"sentence_start_single_quote"},{regex:/ '$/,length:2,replace:" â€˜",analyticsType:"start_single_quote"},{regex:/'$/,length:1,replace:"â€™",analyticsType:"middle_single_quote"}],z=[{regex:/^"$/,length:1,replace:"â€œ",analyticsType:"sentence_start_double_quote"},{regex:/ "$/,length:2,replace:" â€œ",analyticsType:"start_double_quote"},{regex:/"$/,length:1,replace:"â€",analyticsType:"end_double_quote"},{regex:/--$/,length:2,replace:"â€”",analyticsType:"em_dash"},{regex:/->$/,length:2,replace:"â†’",analyticsType:"right_arrow"},{regex:/<->$/,length:3,replace:"â†”",analyticsType:"right_left_arrow"},{regex:/â†>$/,length:2,replace:"â†”",analyticsType:"right_left_arrow"},{regex:/=>$/,length:2,replace:"â‡’",analyticsType:"right_arrow_double"},{regex:/<-$/,length:2,replace:"â†",analyticsType:"left_arrow"},{regex:/>=$/,length:2,replace:"â‰¥",analyticsType:"greater_than_or_equal_to"},{regex:/<=$/,length:2,replace:"â‰¤",analyticsType:"less_than_or_equal_to"},{regex:/!=$/,length:2,replace:"â‰ ",analyticsType:"not_equal"},{regex:/\.\.\.$/,length:3,replace:"â€¦",analyticsType:"ellipsis"}];function W(e){const{environment:t,store:o,transaction:c}=e,p=o.getRecordStoreAtRootPath(),u=p instanceof v.G?p.getType():void 0;if("code"!==u||S.default.isEditingCaption()){if("callout"!==u){for(const e of Z)D({environment:t,store:o,toBlockType:e.toBlockType,matchRegex:e.matchRegex,insertTextAfter:e.insertTextAfter,transaction:c});D({environment:t,store:o,matchRegex:/^(\d+|[\uff10-\uff19]+)(\. |\ã€‚|\ï¼Ž)$/,insertTextAfter:!1,transaction:c,toBlockType:t=>{var o;const n=t[1],r=(0,a.DA)(n);return null===(o=G(e,parseInt(r)))||void 0===o?void 0:o.type},postTransformAction:t=>{var n;const r=t[1],i=(0,a.DA)(r),l=null===(n=G(e,parseInt(i)))||void 0===n?void 0:n.number;if(o.table!==s.iU)return;const d=o.getRecordStoreAtRootPath();if(!(d instanceof v.G))return;const p=l&&l>1?l:void 0;k.FH({stores:[d],update:{list_start_index:p},transaction:c})}}),D({environment:t,store:o,matchRegex:/^([a-z]+)(\. |\ã€‚|\ï¼Ž)$/,insertTextAfter:!1,transaction:c,toBlockType:t=>{const o=(0,h.UF)(t[1]),n=G(e,o);if(1===o||void 0===(null==n?void 0:n.number))return null==n?void 0:n.type},postTransformAction:()=>{if(!(o instanceof v.G))return;const e=o.getRecordStoreAtRootPath();k.FH({stores:[e],update:{list_format:"roman"},transaction:c})}}),D({environment:t,store:o,matchRegex:/^([a-z]+)(\. |\ã€‚|\ï¼Ž)$/,insertTextAfter:!1,transaction:c,toBlockType:t=>{const o=(0,h.yk)(t[1]),n=G(e,o);if(1===o||void 0===(null==n?void 0:n.number))return null==n?void 0:n.type},postTransformAction:()=>{if(!(o instanceof v.G))return;const e=o.getRecordStoreAtRootPath();k.FH({stores:[e],update:{list_format:"letters"},transaction:c})}});for(const{blockMatchRegex:e}of V)D({environment:t,store:o,toBlockType:()=>n.Ti.code,matchRegex:e,insertTextAfter:!1,transaction:c})}if(!function(e){var t;const o="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!o)return!1;const n=e.getValue()||[],r=l.xrQ(n,0,o.endIndex),a=i.qr(r.tokensInsideRange,(e=>l.hDy(e).some((e=>l.fTS(e))))),s=r.tokensInsideRange.slice(-1===a?0:a,r.tokensInsideRange.length),c=l.QaF(s);return Boolean(c.match(/(^| )`[^ ]/))}(o)){const e=w.getSubstitutions();for(const r of e)B({environment:t,store:o,transaction:c,regex:r.replace,length:r.length,replace:r.with,analyticsType:"custom_substitution"});for(const r of z)B({environment:t,store:o,transaction:c,regex:r.regex,length:r.length,replace:r.replace,analyticsType:r.analyticsType});const n=t.device.browserVersion.split(".").map((e=>parseInt(e,10)));if(!t.device.isSafari||(0,d.isGreaterThanOrEqualToVersion)(n,[16,4]))for(const r of q)B({environment:t,store:o,transaction:c,regex:r.regex,length:r.length,replace:r.replace,analyticsType:r.analyticsType});!function(e){B({environment:e.environment,store:e.store,transaction:e.transaction,regex:O,length:2,replace:L,analyticsType:"mention_punctuation"})}({environment:t,store:o,transaction:c})}for(const{annotationDelimiter:e}of V)R({environment:t,delimiter:e,annotation:[l.GKr.Code],store:o,transaction:c});for(const{delimiter:e,type:n}of U)R({environment:t,delimiter:e,annotation:[n],store:o,transaction:c});N({environment:t,delimiter:"$$",store:o,transaction:c}),N({environment:t,delimiter:"ï¼„ï¼„",store:o,transaction:c}),function(e){var t;const{environment:o,store:n,transaction:i}=e,a="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!a)return;const s=n.getValue(),c=r.p4(l.QaF(s)).slice(0,a.endIndex).join("");if(l.oP(s,a.startIndex,a.endIndex,"c"))return;const d=/([^ ]+) $/.exec(c);if(!d)return;const p=d[1],u=l.rOz(p);if(!u)return;const{value:h,href:f}=u,y=m(c,c.indexOf(h)),v=y+r.p4(h).length,b={startIndex:y,endIndex:v};l.oP(s,y,v,"a")||(C.i8({environment:o,store:n,annotation:["a",f],selection:b,transaction:i}),M.Z5({store:n,selection:a}),_.Hcc(o,{href:f}))}({environment:t,store:o,transaction:c})}}function H(e){const{store:t,transaction:o,environment:n}=e;o.postEnqueueActions.push((()=>{P.createAndCommit({userAction:"textFilterActions.runAllFiltersAfterTransaction",environment:n,undoCheckpoint:!0,perform:e=>{W({environment:n,store:t,transaction:e})}})}))}function G(e,t){const{store:o}=e;if(o.table!==s.iU)return;const r=o.getRecordStoreAtRootPath();if(!(r instanceof v.G))return;const i=r.getType();if(i===n.Ti.header||i===n.Ti.subHeader||i===n.Ti.subSubHeader)return;const a=r.getParentBlockStore();if(!a)return;const l=a.getContentStores(),c=l.findIndex((e=>e.id===r.id));if(-1===c)return;const d=l.slice(0,c);let p=-1,u=1;for(let s=0;s<d.length;s++){const e=d[s];if(e.getType()!==n.Ti.numberedList)u=1,p=s;else{var m;const t=null===(m=e.getFormat())||void 0===m?void 0:m.list_start_index;t?u=t+1:u++}}return u===t?{type:n.Ti.numberedList,number:void 0}:c===p+1?{type:n.Ti.numberedList,number:t}:void 0}},98104:(e,t,o)=>{o.d(t,{AL:()=>G,D1:()=>$,DI:()=>H,FC:()=>Y,FG:()=>W,J9:()=>Q,Km:()=>M,LG:()=>X,N3:()=>q,NA:()=>I,NX:()=>B,N_:()=>D,UV:()=>R,Z5:()=>T,ZH:()=>L,Zk:()=>ne,aJ:()=>A,aR:()=>P,bc:()=>te,dd:()=>j,e2:()=>K,jh:()=>J,ls:()=>N,mT:()=>E,o9:()=>U,sD:()=>O,z9:()=>C,zJ:()=>z});var n=o(1302),r=o(72126),i=o(70203),a=o(4827),s=o(14976),l=o(46150),c=o(28314),d=o(68056),p=o(45162),u=o(73959),m=o(89224),g=o(89086),h=o(28685),f=o(95802),y=o(41662),v=o(27724),b=o(24666),S=o(36280),_=o(45990),w=o(13084),k=o(24677),x=o(39699);function I(e){const{multiSelection:t,readOnly:o,forceEmit:n}=e,r=b.default.state,i="empty"!==r.mode&&r.savedSelectionXPosition||void 0,a="editing"===r.mode&&(0,d.e6)(r.multiSelection,t)?r.forceExtendAnnotations:{},s=o?{mode:"readOnly",multiSelection:t,savedSelectionXPosition:i}:{mode:"editing",multiSelection:t,savedSelectionXPosition:i,forceExtendAnnotations:a};if(s.mode!==r.mode||!(0,d._v)(r.multiSelection,t))return b.default.setState(s),void y.HM.updateCellSelectionFromTextSelection();n&&b.default.emit()}function C(e,t){if(!("always"===(0,p.Aw)(e)))return;const{TextSelectionCompositionStore:o}=e;o.setState({isComposing:t})}function T(e){const{store:t,selection:o,readOnly:n}=e;if(t&&o){I({multiSelection:(0,d.TD)({store:t,selection:o}),readOnly:n})}else if(t&&!o){const e={store:t,index:0},o={start:e,end:e};n?b.default.setState({mode:"readOnly",multiSelection:o,savedSelectionXPosition:0}):b.default.setState({mode:"editing",multiSelection:o,forceExtendAnnotations:{},savedSelectionXPosition:0})}else"empty"!==b.default.state.mode&&b.default.setState({mode:"empty"})}function M(e){const{annotation:t}=e;if(i.k87[t[0]])return;const o=i.J7s(t),n=(0,g.bj)().find((e=>i.J7s(e)===o));P(n?{annotation:n,extend:!1}:{annotation:t,extend:!0})}function P(e){const{annotation:t,extend:o}=e,n=b.default.state,r=i.J7s(t);"editing"===n.mode&&b.default.setState({...n,forceExtendAnnotations:{...n.forceExtendAnnotations,[r]:{annotation:t,extend:o}}})}function A(){const e=b.default.state;"editing"===e.mode&&b.default.setState({...e,forceExtendAnnotations:{}})}function D(e){const{store:t}=e;T({store:t,selection:{startIndex:0,endIndex:0}})}function B(e){const{store:t}=e;T({store:t,selection:(0,g.x0)(t)})}function R(e){var t;A();const{environment:o,store:n,canSelectAllBlocks:r,contentEditableContextId:i}=e,a=b.default.state;let s;s="empty"===a.mode?{start:{store:n,index:0},end:{store:n,index:0}}:a.multiSelection;const l={start:{store:s.start.store,index:0},end:{store:s.end.store,index:(null===(t=(0,g.x0)(s.end.store))||void 0===t?void 0:t.endIndex)||0}};if((0,d._v)(l,s)){if(i){const e=(0,g.Ov)(),t=e=>{var t;return(null===(t=e.contentEditableContext)||void 0===t?void 0:t.id)===i},o=e.find(t),n=e.reverse().find(t);if(o&&n){const e=o.props.store,t=n.props.store;if(e&&t){var c;return void I({multiSelection:{start:{store:e,index:0},end:{store:t,index:(null===(c=(0,g.x0)(t))||void 0===c?void 0:c.endIndex)||0}}})}}}r&&(0,u.Mn)(o.device)&&k.td(o)}else I({multiSelection:l})}function E(e){var t;A();const{environment:o,store:n,canSelectAllBlocks:r}=e,i=(0,g.x0)(n),a={startIndex:0,endIndex:i?i.endIndex:0};r&&"empty"!==b.default.state.mode&&(0,g.fu)(null===(t=(0,p.xI)("textSelectionActions",b.default.state.multiSelection))||void 0===t?void 0:t.selection,a)?k.td(o):T({store:n,selection:a})}function F(e){const t=b.default.state;"empty"===t.mode||t.savedSelectionXPosition||b.default.setState({...t,savedSelectionXPosition:e.savedSelectionXPosition})}function N(){"empty"!==b.default.state.mode&&b.default.setState({...b.default.state,savedSelectionXPosition:void 0})}function j(e){const{store:t,contentEditableLeafRegistry:o}=e;n.default.afterNextFlush((()=>{const e=m.get(),n=(0,p.fx)({contentEditableLeafRegistry:o,range:e,allowInvisibleEndSelection:(0,c.yA)().shift});n?I(n):T({store:t})}))}function O(){const e=document.activeElement;e instanceof HTMLElement&&e.blur()}function L(e){m.clear(e),U()}function U(){T({store:void 0,selection:void 0})}function Z(e){const{currentEditableTopBottomPadding:t,targetEdge:o,targetEditable:n,selectionXPosition:i}=e,s=n.getNode();if(!(s&&s instanceof Element))return;const l=s.getBoundingClientRect(),c=Math.min(Math.max(i,l.left),l.right),d=Math.min(t,n.props.topBottomPadding),p="top"===o?l.top:l.bottom;return function(e,t,o){const n=new Map,i={visibility:"hidden"},s=Object.keys(i);let l;try{for(;l=m.rangeFromPoint(e,t);){if(o.contains(l.commonAncestorContainer))return l;const e=a.Z.getParentOverlayNode(l.commonAncestorContainer);if(!e)return;if(n.has(e))return;const t=r.ei(e.style,s);n.set(e,t),Object.assign(e.style,i)}}finally{for(const[e,t]of n)Object.assign(e.style,t)}}(c,"top"===o?p+d:p-d,s)}function V(e){const{focusContainerOffset:t,focusStore:o,edge:n,topBottomPadding:r}=e,i=h.E.findNodeFromStore(o);if(!(i&&i instanceof Element))return;const a=m.getRect(m.rangeFromContainerOffsets({start:t,end:t})),s=i.getBoundingClientRect();if(!a||!s)return;const[l,c]="top"===n?[a.top,s.top]:[a.bottom,s.bottom];return{focusIsAtEdge:Math.abs(l-c)<=r,focusSelectionRect:a,renderedNode:i,renderedNodeRect:s}}function q(e){const{environment:t,event:o,topBottomPadding:n,contentEditableLeafRegistry:r}=e,i=m.get();if(!i)return;A();const a=b.default.state;if("empty"===a.mode)return;const{multiSelection:s}=a,{focus:c,anchor:u}=(0,p.uZ)(s),f=V({focusContainerOffset:m.rangeToContainerOffsets(i).focus,focusStore:c.store,topBottomPadding:n,edge:"top"});if(!f)return;const{focusIsAtEdge:v,focusSelectionRect:S}=f,_=y.g$.getSimpleTableCellFromTextSelection(),w=_?y.g$.getPreviousEditableStoreForSimpleTable(_):(0,g.mK)(c.store),x=w&&h.E.findEditableWithStore(w);if(v&&x){var I;const e=Math.max(a.savedSelectionXPosition||0,S.left),r=Z({targetEditable:x,targetEdge:"bottom",currentEditableTopBottomPadding:n,selectionXPosition:e}),s=(null===(I=(0,p.fx)({range:r,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===I?void 0:I.multiSelection)||(0,d.TD)({store:x.props.store,selection:(0,g.x0)(x.props.store)});if(o.shiftKey&&!o.altKey&&s&&(0,l.D1)(x.getNode(),i.commonAncestorContainer))return o.preventDefault(),F({savedSelectionXPosition:e}),void te({environment:t,multiSelection:(0,p.$r)(s.start,u),focus:s.start,forceEmit:!1});if(!o.shiftKey&&!o.altKey&&s)return o.preventDefault(),F({savedSelectionXPosition:e}),void te({environment:t,forceEmit:!1,multiSelection:s,focus:"start"})}if(o.shiftKey&&!o.altKey&&(0,g.e7)(c,s.start.store)){if(oe(t))return void y.HM.handleUpDownKey({environment:t,direction:"up",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,p.tp)({multiSelection:s,focus:c,filterCommonAncestors:!0});if(e)return o.preventDefault(),void k.Z5({environment:t,...e})}j({store:c.store,contentEditableLeafRegistry:r})}function z(e){const{environment:t,store:o,event:n,topBottomPadding:r}=e,i=m.get();if(!i)return;A();const a=m.getRect(i),l=h.E.findNodeFromStore(o),c=b.default.state;if(!l)return;if(!(l instanceof Element))return;if("empty"===c.mode)return;const d=(0,p.xI)("textSelectionActions",c.multiSelection);if(!d)return;const f=l.getBoundingClientRect(),v=y.g$.getSimpleTableCellFromTextSelection(),S=v?y.g$.getPreviousEditableStoreForSimpleTable(v):(0,g.mK)(o);if(a&&f){const e=Math.abs(a.top-f.top),l={startIndex:d.selection.startIndex,endIndex:d.selection.startIndex},p=(0,u.sQ)(o);if(!n.altKey&&n.shiftKey&&(0,g.Rw)(l)&&(m.selectionIsBackwards()||i.collapsed)&&p)k.Z5({environment:t,stores:[p]});else if(!n.altKey&&!n.shiftKey&&e<=r&&S){n.preventDefault();const e=Math.max(c.savedSelectionXPosition||0,a.left);F({savedSelectionXPosition:e});const o=h.E.findNodeFromStore(S);if(o&&o instanceof Element){const n=o.getBoundingClientRect(),i=Math.min(Math.max(e,n.left),n.right),a=n.bottom-r,l=m.rangeFromPoint(i,a),c=s.Ut(t,l);c&&(ee({environment:t,store:S,selection:c.selection}),c.forceEmitSelectionStore&&b.default.emit())}}else j({store:o})}}function W(e){const{environment:t,event:o,topBottomPadding:n,contentEditableLeafRegistry:r}=e,i=m.get();if(!i)return;A();const a=b.default.state;if("empty"===a.mode)return;const{multiSelection:s}=a,{focus:c,anchor:f}=(0,p.uZ)(s),v=V({focusContainerOffset:m.rangeToContainerOffsets(i).focus,focusStore:c.store,topBottomPadding:n,edge:"bottom"});if(!v)return;const{focusIsAtEdge:S,focusSelectionRect:_}=v,w=y.g$.getSimpleTableCellFromTextSelection(),x=w?y.g$.getNextEditableStoreForSimpleTable(w):(0,g.hn)(c.store),I=x&&h.E.findEditableWithStore(x);if(S&&I){var C;const e=Math.max(a.savedSelectionXPosition||0,_.left),r=Z({targetEditable:I,targetEdge:"top",currentEditableTopBottomPadding:n,selectionXPosition:e}),s=(null===(C=(0,p.fx)({range:r,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===C?void 0:C.multiSelection)||(0,d.TD)({store:I.props.store,selection:{startIndex:0,endIndex:0}});if(o.shiftKey&&!o.altKey&&s&&(0,l.D1)(I.getNode(),i.commonAncestorContainer))return o.preventDefault(),F({savedSelectionXPosition:e}),void te({environment:t,multiSelection:(0,p.$r)(s.start,f),focus:s.start,forceEmit:!1});if(!o.shiftKey&&!o.altKey&&s)return o.preventDefault(),F({savedSelectionXPosition:e}),void te({environment:t,forceEmit:!1,multiSelection:s,focus:"end"})}const T=(0,u.sQ)(s.start.store);if(o.shiftKey&&!o.altKey&&(0,g.iB)(c,s.end.store)&&T){if(oe(t))return void y.HM.handleUpDownKey({environment:t,direction:"down",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,p.tp)({multiSelection:s,focus:c,filterCommonAncestors:!0});if(e)return o.preventDefault(),void k.Z5({environment:t,...e})}j({store:c.store,contentEditableLeafRegistry:r})}function H(e){const{environment:t,store:o,event:n,topBottomPadding:r}=e,i=m.get();if(!i)return;A();const a=m.getRect(i),l=h.E.findNodeFromStore(o),c=b.default.state;if(!l)return;if(!(l instanceof Element))return;if("empty"===c.mode)return;const d=(0,p.xI)("textSelectionActions",c.multiSelection);if(!d)return;const f=l.getBoundingClientRect();if(a&&f){const e=y.g$.getSimpleTableCellFromTextSelection(),l=e?y.g$.getNextEditableStoreForSimpleTable(e):(0,g.hn)(o),p=Math.abs(a.bottom-f.bottom),v={startIndex:d.selection.endIndex,endIndex:d.selection.endIndex},S=(0,u.sQ)(o);if(!n.altKey&&n.shiftKey&&(0,g.J_)(o,v)&&(!m.selectionIsBackwards()||i.collapsed)&&S)k.Z5({environment:t,stores:[S]});else if(!n.altKey&&!n.shiftKey&&p<=r&&l){n.preventDefault();const e=Math.max(c.savedSelectionXPosition||0,a.left);F({savedSelectionXPosition:e});const o=h.E.findNodeFromStore(l);if(o&&o instanceof Element){const n=o.getBoundingClientRect(),i=Math.min(Math.max(e,n.left),n.right),a=n.top+r,c=m.rangeFromPoint(i,a),d=s.Ut(t,c);d&&(ee({environment:t,store:l,selection:d.selection}),d.forceEmitSelectionStore&&b.default.emit())}}else j({store:o})}}function G(e){n.default.afterNextFlush((()=>{N()})),A();const{environment:t,event:o,contentEditableLeafRegistry:r}=e,a=m.get(),s=b.default.state;if("empty"===s.mode)return;const{multiSelection:c}=s,{focus:u,anchor:f}=(0,p.uZ)(c),v=(0,g.mK)(u.store),w=v&&h.E.findEditableWithStore(v);if((0,g.e7)(u,u.store)&&w){const e=(0,d.TD)({store:w.props.store,selection:(0,g.x0)(w.props.store)});if(o.shiftKey&&!o.altKey&&e&&(0,l.D1)(w.getNode(),null==a?void 0:a.commonAncestorContainer))return o.preventDefault(),void te({environment:t,multiSelection:(0,p.$r)(e.start,f),focus:e.start,forceEmit:!1});if(!o.shiftKey&&!o.altKey&&e&&(0,d.iG)(c))return o.preventDefault(),void te({environment:t,forceEmit:!1,multiSelection:e,focus:"start"})}if(o.shiftKey&&!o.altKey&&(0,g.e7)(u,c.start.store)){if(oe(t))return void y.HM.handleLeftRightKey({environment:t,direction:"left",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,p.tp)({multiSelection:c,focus:u,filterCommonAncestors:!0});if(e)return o.preventDefault(),void k.Z5({environment:t,...e})}if(o.altKey||o.shiftKey||o.ctrlKey||o.metaKey||!a||!a.collapsed)j({store:u.store,contentEditableLeafRegistry:r});else{const e=u.index-1,r=i.b1T(c.start.store.getValue(),e);if(r&&i.tk7(r)){o.preventDefault(),I({multiSelection:{start:{...u,index:e},end:u}});const a={startIndex:e,endIndex:u.index};i.YrK(r)&&n.default.afterNextFlush((()=>{S.qn({environment:t,selectedToken:{token:r,position:a},analyticsFrom:"arrow_keys"})}))}const a=i.hpT(u.store.getValue(),e,((e,t)=>{const o=i.Hze(e);return t?Boolean(o&&i.Hze(t)===o):Boolean(o)}));a&&_.dz({type:"selectionFocus",store:u.store,focus:!1,selection:a})}}function K(e){n.default.afterNextFlush((()=>{N()})),A();const{environment:t,store:o,event:r}=e,a=m.get(),s=b.default.state;if("empty"===s.mode)return;const l=(0,p.xI)("textSelectionActions",s.multiSelection);if(!l)return;const c={startIndex:l.selection.startIndex,endIndex:l.selection.startIndex},d=(0,u.sQ)(o);if(!r.altKey&&r.shiftKey&&a&&(0,g.Rw)(c)&&(m.selectionIsBackwards()||a.collapsed)&&d)k.Z5({environment:t,stores:[d]});else if(r.altKey||r.shiftKey||l.store!==o||!(0,g.Rw)(l.selection))if(r.altKey||r.shiftKey||r.ctrlKey||r.metaKey||!a||!a.collapsed)j({store:o});else{const e=i.b1T(o.getValue(),c.startIndex-1);if(e&&i.tk7(e)){r.preventDefault();const a={startIndex:c.startIndex-1,endIndex:c.startIndex};T({store:o,selection:a}),i.YrK(e)&&n.default.afterNextFlush((()=>{S.qn({environment:t,selectedToken:{token:e,position:a},analyticsFrom:"arrow_keys"})}))}const a=i.hpT(o.getValue(),c.startIndex-1,((e,t)=>{const o=i.Hze(e);return t?Boolean(o&&i.Hze(t)===o):Boolean(o)}));a&&_.dz({type:"selectionFocus",store:o,focus:!1,selection:a})}else{r.preventDefault();const e=(0,g.mK)(o);if(e){const o=(0,g.x0)(e);o&&ee({environment:t,store:e,selection:o})}}}function $(e){n.default.afterNextFlush((()=>{N()})),A();const{environment:t,event:o,contentEditableLeafRegistry:r}=e,a=m.get(),s=b.default.state;if("empty"===s.mode)return;const{multiSelection:c}=s,{focus:u,anchor:f}=(0,p.uZ)(c),v=(0,g.hn)(u.store),w=v&&h.E.findEditableWithStore(v);if((0,g.iB)(u,u.store)&&w){const e=(0,d.TD)({store:w.props.store,selection:{startIndex:0,endIndex:0}});if(o.shiftKey&&!o.altKey&&e&&(0,l.D1)(w.getNode(),null==a?void 0:a.commonAncestorContainer))return o.preventDefault(),void te({environment:t,multiSelection:(0,p.$r)(e.start,f),focus:e.start,forceEmit:!1});if(!o.shiftKey&&!o.altKey&&e&&(0,d.iG)(c))return o.preventDefault(),void te({environment:t,forceEmit:!1,multiSelection:e,focus:"end"})}if(o.shiftKey&&!o.altKey&&(0,g.iB)(u,c.end.store)){if(oe(t))return void y.HM.handleLeftRightKey({environment:t,direction:"right",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,p.tp)({multiSelection:c,focus:u,filterCommonAncestors:!0});if(e)return o.preventDefault(),void k.Z5({environment:t,...e})}if(o.altKey||o.shiftKey||o.ctrlKey||o.metaKey||!a||!a.collapsed)j({store:u.store,contentEditableLeafRegistry:r});else{const e=u.index,r=u.index+1,a=i.b1T(c.start.store.getValue(),e);if(a&&i.tk7(a)){o.preventDefault(),I({multiSelection:{start:u,end:{...u,index:r}}});const s={startIndex:e,endIndex:r};i.YrK(a)&&n.default.afterNextFlush((()=>{S.qn({environment:t,selectedToken:{token:a,position:s},analyticsFrom:"arrow_keys"})}))}const s=i.hpT(u.store.getValue(),e,((e,t)=>{const o=i.Hze(e);return t?Boolean(o&&i.Hze(t)===o):Boolean(o)}));s&&_.dz({type:"selectionFocus",store:u.store,focus:!1,selection:s})}}function Y(e){n.default.afterNextFlush((()=>{N()})),A();const{environment:t,store:o,event:r}=e,a=m.get(),s=b.default.state;if("empty"===s.mode)return;const l=(0,p.xI)("textSelectionActions",s.multiSelection);if(!l)return;const c={startIndex:l.selection.endIndex,endIndex:l.selection.endIndex},d=(0,u.sQ)(o);if(!r.altKey&&r.shiftKey&&a&&(0,g.J_)(o,c)&&(!m.selectionIsBackwards()||a.collapsed)&&d)k.Z5({environment:t,stores:[d]});else if(r.altKey||r.shiftKey||l.store!==o||!(0,g.J_)(o,l.selection))if(r.altKey||r.shiftKey||r.ctrlKey||r.metaKey||!a||!a.collapsed)j({store:o});else{const e=i.b1T(o.getValue(),c.startIndex);if(e&&i.tk7(e)){r.preventDefault();const a={startIndex:c.startIndex,endIndex:c.startIndex+1};T({store:o,selection:a}),i.YrK(e)&&n.default.afterNextFlush((()=>{S.qn({environment:t,selectedToken:{token:e,position:a},analyticsFrom:"arrow_keys"})}))}const a=i.hpT(o.getValue(),c.startIndex+1,((e,t)=>{const o=i.Hze(e);return t?Boolean(o&&i.Hze(t)===o):Boolean(o)}));a&&_.dz({type:"selectionFocus",store:o,focus:!1,selection:a})}else{r.preventDefault();const e=(0,g.hn)(o);e&&ee({environment:t,store:e,selection:{startIndex:0,endIndex:0}})}}function Q(e,t){const{x:o,y:n,target:r}=t,i=(0,g.fx)(o,n,r);i&&i.selectable.props.onEditText&&x.createAndCommit({userAction:"textSelectionActions.editNearestBlock",environment:e,perform:e=>{i.selectable.props.onEditText&&i.selectable.props.onEditText({isAtStartOfLine:o<=i.rect.left,isClick:!0,transaction:e})}})}function J(e,t,o){const{x:n,y:r,target:i}=t,a=i?v.default.getDefaultContainerFromTarget(i):void 0;if(a&&(0,g.Q3)(r,a)&&w.HO({environment:e,container:a,transaction:o}))return;const s=(0,g.fx)(n,r,i);if(s&&s.selectable.props.onEditText){const e=r<=s.rect.top;s.selectable.props.onEditText({isAtStartOfLine:n<=s.rect.left,isAtStartOfContainer:e,isClick:!0,transaction:o})}}function X(e,t,o,n){const{y:r,target:i}=t,a=i?v.default.getDefaultContainerFromTarget(i):void 0,s=f.C.findSelectableFromStore(o);a&&s&&(0,g.qh)(r,s)&&w.UG({environment:e,container:a,store:o,transaction:n})}function ee(e){const{environment:t,store:o,selection:n}=e;T({store:o,selection:n});const r=(0,u.sQ)(o);r&&k.eP({environment:t,store:r})}function te(e){const{environment:t,multiSelection:o,forceEmit:n,readOnly:r,focus:i}=e;I({multiSelection:o,forceEmit:n,readOnly:"infer"===r?(0,p.L5)(o).some((e=>{let{editable:t}=e;return!t.props.store.canEdit()})):r});const a=(0,p.tp)({multiSelection:o,filterCommonAncestors:!1,focus:i});a&&k.Z5({environment:t,phase:v.SelectionPhase.Editing,...a})}function oe(e){const t=y.g$.getSimpleTableCellFromTextSelection();if(t){const{rowIndex:o,columnIndex:n,simpleTableStore:r}=t.props;return y.HM.selectCell({environment:e,rowIndex:o,columnIndex:n,simpleTableStore:r}),L(e),!0}return!1}function ne(e){var t;if(!(0,p.Aw)(e))return;const o=m.get(),n=null===(t=(0,p.fx)({range:o,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===t?void 0:t.multiSelection;if(n){I({readOnly:(0,p.L5)(n).some((e=>{let{editable:t}=e;return t.props.disabled})),multiSelection:n})}}},29373:(e,t,o)=>{o.d(t,{LO:()=>S,X_:()=>w,ls:()=>y,nz:()=>b,rd:()=>v});o(57658);var n=o(41432),r=o(15157),i=o(72126),a=o(23867),s=o(35328),l=o(58202),c=o(45131),d=o(54642),p=o(49865),u=o(94419),m=o(9953),g=o(24677),h=o(98104);function f(e){return`ToggleBlock-${e}`}function y(e){const{environment:t,store:o,transaction:r}=e,i=m.j4({environment:t,type:n.Ti.text,inMemoryRecordCache:o.inMemoryRecordCache,transaction:r,spaceId:o.pointer.spaceId,useCrdt:o.useCrdt()});u.R3({parent:o.getContentStore(),append:i,transaction:r});const a=o.getContentStores()[0];g.eP({environment:t,store:a});const s=a.getBlockTitleStore();h.N_({store:s})}function v(e){let{blockId:t,state:o,currentUserId:n}=e;c.Z.setOpen(t,o),r.Z.set({userId:n,key:f(t),value:o})}function b(e){let{blockId:t,currentUserId:o}=e;const n=r.Z.get({userId:o,key:f(t)});c.Z.setOpen(t,n)}function S(e,t){d.loadCachedPageChunkBatched(e,{page:{id:t.id,spaceId:(0,a.C)(t.spaceId)},limit:25,chunkNumber:0,cursor:{stack:[]},verticalColumns:!1})}function _(e,t){const o=(null==t?void 0:t.toggleBlockIds)||[],r=(null==t?void 0:t.collectionBlockIds)||[],i=e.getType();if((0,s.BX)(e)&&o.push(e.id),"collection_view"!==i&&"collection_view_page"!==i||r.push(e.id),i===n.Ti.transclusionReference){const t=e.getTransclusionReferenceTargetStore();t&&_(t,{toggleBlockIds:o,collectionBlockIds:r})}else{const t=e.getContentStores();for(const e of t)e.isNavigableBlock()||_(e,{toggleBlockIds:o,collectionBlockIds:r}),"collection_view"===e.getType()&&r.push(e.id)}return{toggleBlockIds:o,collectionIds:r}}function w(e,t){const{toggleBlockIds:o,collectionIds:n}=_(t),r=t.environment.currentUser.id;o.forEach((e=>b({blockId:e,currentUserId:r})));const a=i.oA(n.map((e=>function(e){const t=l.R.findCollectionViewBlockFromId(e);if(t)return t.collectionContextStore}(e)))),s=a.flatMap((e=>e.groupsStore.getAllGroupStates())),d=o.every((e=>c.Z.isOpen(e))),u=s.every((e=>e.toggleStateStore.state)),m=!(d&&u);o.forEach((e=>v({blockId:e,state:m,currentUserId:r}))),function(e,t,o){for(const n of t)for(const t of n.groupsStore.getAllGroupStates())p.uo({environment:e,collectionContextStore:n,groupFormat:t.groupsPointer[0],toggleStateStore:t.toggleStateStore,newValue:o})}(e,a,m)}},32741:(e,t,o)=>{o.d(t,{lY:()=>m,qA:()=>g,HM:()=>u});var n=o(70203),r=o(44805),i=o(97880),a=o(92120);var s=o(4708),l=o(80444),c=o(77080),d=o(96049),p=o(48588);function u(e){var t;if(d.Z.state)return;const o=c.default.checkGate("first_party_links"),u=(0,s.En)(),{token:g,store:h}=e,f=n.hDy(g.textToken),y=null===(t=l.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId(),v=y?n.zrg(f).filter((e=>!(0,r.vz)({annotation:e,spaceId:y,getRecordModel:h.getRecordModel}))):[],b=[n.rlz(f),n.K9C(f),n.QGY(f),n.frE(f),n.xat(f),o&&n.V8Y(f)||void 0,u&&n.hH9(f)||void 0,...v,n.jC0(f)].filter(i.$K);b.length>0?(p.Z.setState({token:g,store:h,annotations:b}),v.length>0&&function(e){let{source:t,discussionAnnotations:o}=e;a.Z.setState({source:t,discussionIds:o.map(n.h19)})}({discussionAnnotations:v,source:"editor"})):m()}function m(){var e,t;p.Z.state&&p.Z.setState(void 0),e="editor",(null===(t=a.Z.state)||void 0===t?void 0:t.source)===e&&a.Z.setState(void 0)}function g(e){e&&p.Z.state&&p.Z.state.store===e&&m()}},39699:(e,t,o)=>{o.r(t),o.d(t,{DEBUG:()=>ce,MetadataUpdateManager:()=>fe,applyCrdtTextOperation:()=>Se,applyCrdtTextOperations:()=>_e,applyOperation:()=>be,createAndCommit:()=>Te,createAndCommitAsync:()=>Me,updateConnectionState:()=>ge,updateMetadataForTransaction:()=>he});o(57658),o(21703);var n=o(18466),r=o(45060),i=o(63144),a=o(68626),s=o(38297),l=o(5773),c=o(43593);var d=o(79317),p=o(59730),u=o(72126),m=o(91155),g=o(59753),h=o(482),f=o(33317),y=o(606),v=o(98963),b=o(21202),S=o(6287),_=o(13493),w=o(70279),k=o(15047),x=o(19889),I=o(67175),C=o(12139),T=o(97880),M=o(63143),P=o(82798),A=o(5366),D=o(95477),B=o(21830),R=o(33929),E=o(98165),F=o(4615),N=o(45953);class j{constructor(e){this.id=(0,F.ZP)(),this.spaceId=void 0,this.userId=void 0,this.committed=!1,this.isLocal=!1,this.useSudoMode=void 0,this.deadlockWarningTimeout=void 0,this.operations=[],this.stores=[],this.initialRecordMap=N.PF.create(),this.invertedOperations=[],this.postPerformAssertions=[],this.preEnqueueActions=[],this.postEnqueueActions=[],this.postSubmitCallbacks=[],this.postCancelCallbacks=[],this.userAction=void 0,this.userFlow=void 0;const{spaceId:t,userId:o,deadlockTimeoutMs:n,onDeadlockWarning:r}=e;t&&o&&(this.spaceId=t,this.userId=o),r&&(this.deadlockWarningTimeout=window.setTimeout(r,n))}isEmpty(){return 0===this.operations.length}annotateWithUserAction(e){this.userAction=e}getUserActionForAnalyticsPurposesOnly(){return this.userAction}annotateWithUserFlow(e){this.userFlow=e}getUserFlowForAnalyticsPurposesOnly(){return this.userFlow}cancelDeadlockWarning(){void 0!==this.deadlockWarningTimeout&&(window.clearTimeout(this.deadlockWarningTimeout),this.deadlockWarningTimeout=void 0)}done(e){this.cancelDeadlockWarning();for(const t of this.postSubmitCallbacks)t(e)}}var O=o(99341),L=o(88632),U=o(37598),Z=o(5315),V=o(35661),q=o(27724),z=o(24666),W=o(34583),H=o(68955),G=o(70203),K=o(26109);function $(e){const{transaction:t,inMemoryRecordCache:o,store:n,operation:r}=e,i=r.command;switch(i){case"insertText":case"deleteText":case"addAnnotation":case"removeAnnotation":case"splitText":return Y({inMemoryRecordCache:o,textSliceTreeToMutate:(0,P.TO)(n.getTextSliceTree()),store:n,operation:r});case"splitTextIntoBlock":return function(e){const{transaction:t,inMemoryRecordCache:o,sourceStore:n,operation:r}=e;(0,P.T)(r.args.targetBlockId!==r.pointer.id,"Target block should be different from source block.");const i=(0,P.TO)(n.getTextSliceTree()),[{newValue:a,role:s}]=Y({inMemoryRecordCache:o,store:n,textSliceTreeToMutate:i,operation:{command:"splitText",pointer:r.pointer,path:[],args:r.args}}),l=new V.G(n.environment,{table:b.iU,id:r.args.targetBlockId});return J({transaction:t,inMemoryRecordCache:o,sourceValue:a,sourceRole:s,sourceRootTextSliceTree:i,targetStore:l,operation:{command:"moveTextSlice",pointer:{table:b.iU,id:r.args.targetBlockId},path:[],args:{textInstanceId:r.args.textInstanceId,textSliceStartItemId:r.args.id,targetBlockId:r.args.targetBlockId,targetTextInstanceId:r.args.targetBlockId,targetTextSliceEndItemId:"end"}}})}({transaction:t,inMemoryRecordCache:o,sourceStore:n,operation:r});case"moveTextSlice":return Q({transaction:t,inMemoryRecordCache:o,sourceStore:n,operation:r});case"moveTextSliceIntoBlock":return function(e){const{transaction:t,inMemoryRecordCache:o,sourceStore:n,operation:r}=e;return(0,P.T)(r.args.targetBlockId!==r.pointer.id,"Target block should be different from source block."),Q({transaction:t,inMemoryRecordCache:o,sourceStore:n,operation:{...r,command:"moveTextSlice",args:{...r.args,targetTextInstanceId:r.args.targetBlockId,targetTextSliceEndItemId:"end"}}})}({transaction:t,inMemoryRecordCache:o,sourceStore:n,operation:r});default:(0,T.t1)(i)}}function Y(e){const{inMemoryRecordCache:t,store:o,operation:n,textSliceTreeToMutate:r}=e,i=r.getTextValue(),a=n.command;switch(a){case"insertText":r.applyInsertTextOperation({type:a,...n.args});break;case"deleteText":r.applyDeleteOperation({type:a,...n.args});break;case"addAnnotation":case"removeAnnotation":r.applyAnnotationOperation({type:a,...n.args});break;case"splitText":r.applySplitOperation({type:a,...n.args});break;default:(0,T.t1)(a)}const s=X((0,P.TO)(o.getValue()),r);"addAnnotation"===n.command&&G.J7s(n.args.annotation)===G.GKr.Discussion&&(s.discussions=K.Og({existingDiscussions:s.discussions,oldTextValue:i,newTextValue:r.getTextValue()})),"removeAnnotation"===n.command&&G.JA7(n.args.annotationKey)===G.GKr.Discussion&&(s.discussions=K.NL({existingDiscussions:s.discussions,oldTextValue:i,newTextValue:r.getTextValue()}));const l=ee(t,o);return[{pointer:o.pointer,newValue:s,role:l,updatePaths:[["format","text_slice_tree"],["format","text_clocks"],["discussions"]]}]}function Q(e){const{transaction:t,inMemoryRecordCache:o,sourceStore:n,operation:r}=e;return J({transaction:t,inMemoryRecordCache:o,sourceValue:(0,P.TO)(n.getValue()),sourceRole:ee(o,n),sourceRootTextSliceTree:(0,P.TO)(n.getTextSliceTree()),targetStore:r.args.targetBlockId===n.id?n:new V.G(n.environment,{table:b.iU,id:r.args.targetBlockId}),operation:r})}function J(e){const{transaction:t,inMemoryRecordCache:o,sourceRole:n,sourceValue:r,sourceRootTextSliceTree:i,targetStore:a,operation:s}=e,l=(0,P.TO)(i.findTextSliceTreeContainingItemWithId(s.args.textInstanceId,s.args.textSliceStartItemId));(0,P.T)(l!==i,"Can not move root node of text slice tree.");const c=i.getTextValue();!function(e,t){const o=t.getRecordStoreAtRootPath().getValue(),n=t.getRecordStoreAtRootPath().getRole();e.initialRecordMap.getRole(t.pointer)||(n?e.initialRecordMap.setValueAndRole(t.pointer,o,n):e.initialRecordMap.delete(t.pointer))}(t,a);const d=s.args.targetBlockId===r.id,p=d?i:(0,P.TO)(a.getTextSliceTree()),u=(0,P.TO)(p.findTextSliceTreeContainingItemWithId(s.args.targetTextInstanceId,s.args.targetTextSliceEndItemId,{type:"end"})),m=d?c:p.getTextValue();l.detachFromParent(),u.appendChild(l);const g=X(r,i);g.discussions=d?g.discussions:g.discussions=K.NL({existingDiscussions:g.discussions,oldTextValue:c,newTextValue:i.getTextValue()});const h=[{pointer:{table:b.iU,id:r.id,spaceId:r.space_id},newValue:g,role:n,updatePaths:[["format","text_slice_tree"],["format","text_clocks"],["discussions"]]}];if(!d){const e=p.getTextValue(),t=X((0,P.TO)(a.getValue()),p);t.discussions=K.Og({existingDiscussions:t.discussions,oldTextValue:m,newTextValue:e}),h.push({pointer:a.pointer,newValue:t,role:ee(o,a),updatePaths:[["format","text_slice_tree"],["format","text_clocks"],["discussions"]]})}return h}function X(e,t){const o=u.Xh(e),n=(0,P.TO)(o.format);return(0,P.T)(n.use_crdt),t?(n.text_slice_tree=H.Z.serialize(t),n.text_clocks=H.Z.serializeClocks(t)):(n.text_slice_tree=void 0,n.text_clocks=void 0),o.version++,o}function ee(e,t){return e.getRole({pointer:t.pointer,userId:t.userId})??"editor"}var te=o(50906),oe=o(90287),ne=o(36576),re=o(74446),ie=o(33361);var ae=o(47307),se=o(4408),le=o(82007);const ce=!1,de=new Set;let pe=0;const ue=(0,A.defineMessages)({invalidBlockOperation:{defaultMessage:"Hey there! Blocks cannot be moved inside of themselves.",id:"saveChanges.errorDialog.blocksCannotBeMovedInsideSelf.message"},saveEditsError:{id:"saveEditsError.message",defaultMessage:"There was an issue persisting your edits. Please message us for help."}}),me=25*M.C0;function ge(e){L.Z.state.online&&e.currentUser.id&&Z.transactionQueue.unpause()}function he(e){const{environment:t,transaction:o,skipUpdatingEditedMetadata:n}=e,r=t.currentUser.adminUserId?x.el.id:t.currentUser.id,a=new fe({transaction:o,userId:r,skipUpdatingEditedMetadata:n,timeMs:Date.now()}),s=u.mN(o.stores,(e=>e.id));for(const l of s)if(l.table===b.iU){const e=V.G.createChildStore(l,l.pointer);if(e.canEdit()&&a.addStore(e),!e.isNavigableBlock()){const t=E.Dg(e);t&&t.canEdit()&&a.addStoreWithLargeSubtree(t)}}else if(l.table===w.x_){if(l.path.length)continue;const e=l.pointer,t=o.initialRecordMap.getValue(e),n=l.getValue();(void 0===t||i.P(g.kk.fromValue(w.x_,t),g.kk.fromValue(w.x_,n)))&&a.addStore(V.T5.createChildStore(l,l.pointer))}else if(l.table===k.bx)a.addStoreWithLargeSubtree(V.H2.createChildStore(l,l.pointer));else if(l.table===S.v){const e=V.NW.createChildStore(l,l.pointer).getParentBlockStore();e&&e.canEdit()&&a.addStore(e)}else if(l.table===_.n){const e=V.Xr.createChildStore(l,l.pointer).getParentBlockStore();e&&e.canEdit()&&a.addStoreWithLargeSubtree(e)}else if(l.table===v.cv&&l.canEdit()){const e=V.Mz.createChildStore(l,l.pointer);a.addStore(e);const t=e.getParentBlockStore();t&&t.canEdit()&&a.addStore(t)}a.getAllOperations().forEach((e=>{let[t,n]=e;return be({transaction:o,store:t,operation:n})}))}class fe{constructor(e){this.transaction=void 0,this.timeMs=void 0,this.userId=void 0,this.skipUpdatingEditedMetadata=void 0,this.seenStoreIds=void 0,this.operations=void 0,this.transaction=e.transaction,this.timeMs=e.timeMs,this.userId=e.userId,this.skipUpdatingEditedMetadata=e.skipUpdatingEditedMetadata,this.seenStoreIds=new Set,this.operations=new Map}addStoreWithLargeSubtree(e){this.addStoreInternal(e,{shouldDebounceEditedTime:!0})}addStore(e){this.addStoreInternal(e,{shouldDebounceEditedTime:!1})}getAllOperations(){return Array.from(this.operations.entries())}addStoreInternal(e,t){if(e.inMemoryRecordCache.recordHasOverride({pointer:e.pointer,userId:this.transaction.userId}))return;if(this.seenStoreIds.has(e.id))return;this.seenStoreIds.add(e.id);const o={};u.TS(o,this.collectCreationMetadata(e),this.skipUpdatingEditedMetadata?{}:this.collectEditionMetadata(e,t.shouldDebounceEditedTime)),Object.keys(o).length>0&&this.operations.set(e,{pointer:e.pointer,path:[],command:"update",args:o})}collectCreationMetadata(e){const t={};(e.isDefined()?e.getCreatedById():void 0)||(t.created_by_id=this.userId,t.created_by_table=x.KJ);return(e.isDefined()?e.getCreatedTime():void 0)||(t.created_time=this.timeMs),t}collectEditionMetadata(e,t){const o={},n=e.isDefined()?e.getLastEditedTime():-1;if((t?this.hasDebounceEnded(n,this.timeMs):n!==this.timeMs)&&(o.last_edited_time=this.timeMs),e instanceof V.G||e instanceof V.H2||e instanceof V.Mz){const t=o;(e.isDefined()?e.getLastEditedById():void 0)!==this.userId&&(t.last_edited_by_id=this.userId,t.last_edited_by_table=x.KJ)}return o}hasDebounceEnded(e,t){return M.ud(e)!==M.ud(t)}}const ye=function(e){u.mN(e.stores,(e=>e.id)).forEach((t=>{if(!t.inMemoryRecordCache.recordHasOverride({pointer:t.pointer,userId:e.userId}))if(t.table===b.iU){const o=V.G.fromRecordStore(t),n=o.getProperties(),r=o.getFormat();if(o.isDefined()){const t=(0,l.xN)({properties:n,format:r},D.default.secureFileS3.url,D.default.secureFileS3V2.url,D.default.secureFileConfig.rootPath,D.default.secureFileConfig.hostname,o.pointer),i=t.files,a=t.operations,s=o.getFileIds();for(const n of i)s.indexOf(n.id)<0&&be({transaction:e,store:o,operation:{pointer:o.pointer,path:["file_ids"],command:"listAfter",args:{id:n.id}}});for(const n of a)be({transaction:e,store:o,operation:n})}}else if(t.table===S.v){const o=V.NW.fromRecordStore(t),n=o.getFileIds(),r=o.getIconStore().getValue(),i=o.getCoverStore().getValue();if(o.isDefined()){const t=function(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(o&&!e.file_ids)return[];const i=[],{cover:a,icon:s}=e;if(a){const e=(0,c.mV)(a,t,n,r);e&&i.push(e)}if(s){const e=(0,c.mV)(s,t,n,r);e&&i.push(e)}return i}({cover:i,icon:r,file_ids:n},[D.default.secureFileS3.url,D.default.secureFileS3V2.url],!1,D.default.secureFileConfig.rootPath,D.default.secureFileConfig.hostname),a=n;for(const n of t)a.indexOf(n.id)<0&&be({transaction:e,store:o,operation:{pointer:o.pointer,path:["file_ids"],command:"listAfter",args:{id:n.id}}})}}}))};const ve=function(e,t){const o=oe.Bs(),n=new Error("Potential transaction deadlock"),i=new j({spaceId:o,userId:t||e.currentUser.id,deadlockTimeoutMs:me,onDeadlockWarning:()=>{de.delete(i);const t=i.getUserActionForAnalyticsPurposesOnly();(0,r.XY)(`A ${t} transaction hasn't been committed in ${me} ms.`,[["stack =",n.stack]]),C.IE(n,{extra:{operations_count:i.operations.length},tags:{userAction:t}}),te.y9R(e,{operations_count:i.operations.length,user_action:t});const o=i.operations.map((e=>({command:e.command,stringifiedArgs:(0,m.LK)({path:e.path,pointer:e.pointer})})));a.log({level:"warning",from:"transactionActions",type:"transactionDeadlockWarning",data:{userAction:t,operations:o}})}});return i.beforeSelection=q.default.cloneState(),i.beforeTextSelection=z.default.cloneState(),de.add(i),i};function be(e){const{store:t,operation:o,transaction:n}=e,{inMemoryRecordCache:i}=t;if((0,I.Qf)(o)&&(0,r.XY)(`In ${n.getUserActionForAnalyticsPurposesOnly()}, use applyCrdtTextOperations() for text operations!`),(0,h.S)(o)){const r=(0,d.rb)(o,i.makeGetRecordValueFn(n.userId)),a=(0,d.T1)(o,i.makeGetRecordValueFn(n.userId));for(const n of a)o.additionalUpdatedPointers||(o.additionalUpdatedPointers=[]),o.additionalUpdatedPointers.push(n.pointer),we({...e,operation:n,isInvertible:!1,store:(0,V.Kv)(t,n.pointer)});return n.operations.push(o),void n.invertedOperations.push(...r)}we({store:t,operation:o,transaction:n,isInvertible:!0})}function Se(e){const{store:t,operation:o,invertedOperation:n,transaction:r}=e;_e({store:t,operations:[o],invertedOperations:n?[n]:[],transaction:r})}function _e(e){const{store:t,operations:o,transaction:n}=e;n.invertedOperations.push(...e.invertedOperations);for(const r of o)we({store:t,operation:r,transaction:n,isInvertible:!0})}function we(e){const{store:t,operation:o,transaction:n}=e,{inMemoryRecordCache:r,environment:i,pointer:a,userId:l}=t;if(n.committed)throw new Error("Transaction has already been committed.");const c=t.getRecordStoreAtRootPath().getValue(),d=t.getRecordStoreAtRootPath().getRole(),p=(0,I.Qf)(o)?[]:e.isInvertible?[f.bv(o,c)].filter(T.$K):[];let u;if(n.initialRecordMap.getRole(a)||(d?n.initialRecordMap.setValueAndRole(a,c,d):n.initialRecordMap.delete(a)),(0,I.Qf)(o))u=$({transaction:n,inMemoryRecordCache:r,store:(0,P.R9)(t,V.G),operation:o});else{u=[{pointer:a,newValue:f.lK(o,c),role:r.getRole({pointer:a,userId:l})??"editor",updatePaths:"update"===o.command?Object.keys(o.args).map((e=>o.path.concat([e]))):[o.path]}]}for(const m of u){const{pointer:e,newValue:o,role:a,updatePaths:c}=m;if(se.Wl({environment:i,inMemoryRecordCache:r,pointer:e,userId:l,force:!0,model:g.kk.fromValue(t.pointer.table,o),role:a,updatePaths:c,debugSource:n.getUserActionForAnalyticsPurposesOnly()??"applyOperation"}),"block"===t.table){const e=o;if(e){const t=(0,s.ky)({block:e,getRecordValue:r.makeGetRecordValueFn(n.userId)});t&&U.Z.setEditedBlock(t.id,e.id)}0}}n.isLocal=!t.shouldCacheReceiveUpdates(),e.isInvertible&&(n.operations.push(o),n.invertedOperations.push(...p)),n.stores.push(t),r.appliedTransaction=!0}const ke=[{type:"userAction",allowedUserAction:"revisionActions.undoRevision"},{type:"userAction",allowedUserAction:"revisionActions.redoRevision"}];function xe(e){e.cancelDeadlockWarning(),de.delete(e);const t=u.mN(e.stores,(e=>e.id));for(const o of t){se.uo({inMemoryRecordCache:o.inMemoryRecordCache,persistedRecordCache:o.environment.defaultRecordCache.persistedRecordCache,pointer:o.pointer,userId:o.userId,environment:o.environment});const t=e.initialRecordMap.getValue(o.pointer),n=e.initialRecordMap.getRole(o.pointer);n&&se.Wl({environment:o.environment,inMemoryRecordCache:o.inMemoryRecordCache,pointer:o.pointer,userId:o.userId,updatePaths:[[]],model:g.kk.fromValue(o.pointer.table,t),role:n,debugSource:"cancelTransaction"})}for(const o of e.postCancelCallbacks)o()}const Ie=u.P2(((e,t)=>{te.Y_F(e,{errorType:t.type||t.name}),t.type===B.vZ?ae.showThrottledErrorMessage(t.message):ae.showThrottledErrorMessage(R.default.formatMessage(ue.saveEditsError))}),3e4);function Ce(e){return new Promise(((t,o)=>{de.delete(e.transaction);const n=Array.from(de).filter((e=>e.operations.length>0));var r;if(n.length>0&&te.iBN(e.environment,{committed_transaction_user_action:e.transaction.getUserActionForAnalyticsPurposesOnly(),first_uncommitted_transaction_user_action:n[0].getUserActionForAnalyticsPurposesOnly(),uncommitted_transaction_count:n.length}),0===e.transaction.operations.length)return null===(r=Z.transactionQueue.logEmptyTaskForDebugging)||void 0===r||r.call(Z.transactionQueue,e.transaction.getUserActionForAnalyticsPurposesOnly()),e.transaction.committed=!0,e.transaction.done(),t();void 0===e.canUndo&&(e.canUndo=!0);const{transaction:i,canUndo:s}=e,l=function(e){for(const t of e.stores)if("block"===t.table){const e=E.Om(t);if(e&&E.qA(e).find((e=>e.table===t.table&&e.id===t.id)))return R.default.formatMessage(ue.invalidBlockOperation)}}(i);if(l)return xe(i),ae.showErrorMessage(l),void t();i.cancelDeadlockWarning();for(const e of i.preEnqueueActions)e();if(he({environment:e.environment,transaction:i,skipUpdatingEditedMetadata:e.skipUpdatingEditedMetadata}),ye(i),function(e,t){const o=t.operations.filter((e=>e.pointer.table===_.n));o.length>0&&y.dr.uniq(o.map((e=>e.pointer))).map((e=>t.initialRecordMap.getRole(e))).includes(void 0)&&t.postSubmitCallbacks.push((()=>{W.bi(e)}))}(e.environment,i),i.afterSelection=q.default.cloneState(),i.afterTextSelection=z.default.cloneState(),s&&le.K9({transaction:i,undoCheckpoint:e.undoCheckpoint}),ce&&console.log("Committing transaction",i),i.isLocal){for(const e of i.postEnqueueActions)e();i.done(),t()}else{const n=e=>{i.done(e),e?o(e):t()},{LocalBacklinkStore:r,currentUser:s}=e.environment;r&&async function(e,t){const{LocalBacklinkStore:o,currentUser:n}=e;if(0===t.stores.length)return;const r=t.stores[0].inMemoryRecordCache,i=[],a=N.Ak.create(),s=new Set;for(const u of t.stores)s.has(u.id)||(s.add(u.id),i.push(u.pointer),a.setValue(u.pointer,u.getRecordStoreAtRootPath().getValue()));const l=ie.DI(t.initialRecordMap),{createdBacklinks:c,deletedBacklinks:d}=await(0,ne.xU)({loadRecordValue:re.zF.fromGetRecordValueFn(r.makeGetRecordValueFn(n.id)),operationPointers:i,getInitialRecordModel:g.om.fromRecordMap(l),getFinalRecordModel:g.om.fromRecordMap(a)}),p=o.updateBacklinks({createdBacklinks:c,deletedBacklinks:d,currentUserId:n.id});t.postSubmitCallbacks.push((e=>{e&&o.resetBacklinkState({blockIds:p,currentUserId:n.id})}))}({LocalBacklinkStore:r,currentUser:s},i);const l=Date.now();l<pe&&te.vtR(e.environment,{regression_amount:pe-l}),pe=l,Z.transactionQueue.enqueueTask((0,O.JG)({transaction:i,timestamp:l,callback:n})).catch((t=>{a.log({level:"error",from:"transactionActions",type:"enqueueTask",error:(0,m.Ui)(t)}),e.environment.device.isMobileNative&&"SqliteOutOfSpace"===t.name||Ie(e.environment,t),xe(i),n(t)}));for(const e of i.postEnqueueActions)e()}i.committed=!0}))}function Te(e){const{userAction:t,environment:o,userId:r,perform:i,canUndo:s,undoCheckpoint:l,transactionTooBigFallback:c,skipUpdatingEditedMetadata:d,useSudoMode:u}=e;return n.Z.withListenerIgnored((()=>{const n=ve(o,r);let g;n.annotateWithUserAction(t),u&&(n.useSudoMode=!0);try{g=i(n),function(e){if(e.isLocal)return;for(const t of e.stores){const o=t.inMemoryRecordCache.checkRecordForTemporaryData(t);if(o)throw new p.p8(`Transaction "${e.getUserActionForAnalyticsPurposesOnly()}" is manipulating a store with temporary local changes from an in-memory record cache named "${o.name}"!`)}}(n);for(const e of n.postPerformAssertions)e()}catch(h){xe(n);const e=n.getUserActionForAnalyticsPurposesOnly(),t=n.getUserFlowForAnalyticsPurposesOnly();throw C.IE(h,{tags:{userAction:e,userFlow:t}}),a.log({level:"error",from:"transactionActions",type:"createAndCommit",error:(0,m.Ui)(h),data:{userAction:e,userFlow:t,spaceId:n.spaceId}}),h}finally{0}if(c&&(0,O.jQ)(n))return xe(n),Te({...e,perform:c,transactionTooBigFallback:void 0,userAction:`${t} transactionTooBigFallback`});return{performResult:g,serverCommitResult:Ce({environment:o,transaction:n,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:d})}}))}async function Me(e){const{environment:t,perform:o,waitForServerCommit:n,userAction:r,userId:i,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:c,useSudoMode:d}=e,p=ve(t,i);let u;p.annotateWithUserAction(r),d&&(p.useSudoMode=!0);try{u=await o(p);for(const e of p.postPerformAssertions)e()}catch(h){const t=p.getUserActionForAnalyticsPurposesOnly();de.delete(p);const o=p.operations.length>0;throw o&&te.kY8(e.environment,{user_action:t,operation_count:p.operations.length}),C.IE(h,{tags:{userAction:t,transactionOperationCount:p.operations.length}}),a.log({level:"error",from:"transactionActions",type:"createAndCommitAsync",error:(0,m.Ui)(h),data:{message:o?`POSSIBLE DATA LOSS: asynchronous transaction had ${p.operations.length} operations`:void 0,userAction:t}}),h}const g=Ce({environment:t,transaction:p,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:c});return n&&await g,{performResult:u,serverCommitResult:g}}},68422:(e,t,o)=>{o.d(t,{_w:()=>R,vs:()=>A,Cj:()=>D});var n=o(1302),r=o(41432),i=o(72126),a=o(27006),s=o(4615),l=o(21202),c=o(70203),d=o(42274),p=o(65598),u=o(35328),m=o(35661),g=o(26664),h=o(34583),f=o(41433),y=o(94419),v=o(76464),b=o(9953),S=o(42858),_=o(24677),w=o(98104),k=o(29373),x=o(73959),I=o(55367),C=o(96802),T=o(13084);function M(e,t){const{store:o,transaction:n,disableAutoChildrenMove:r}=e;return r||function(e){const{environment:t,store:o,transaction:n}=e,r=(0,x.sQ)(o),i=(null==r?void 0:r.getContentStores())||[];let a=!1;const s=i.filter((e=>{return a?(t=e.getType(),n=o.getType(),!(!t||!n||t===n||"divider"===t||"collection_view"===t||"sub_header"===n&&"header"===t||"sub_sub_header"===n&&("header"===t||"sub_header"===t))||(a=!1,!1)):(e===o&&(a=!0),!1);var t,n}));T.LQ({environment:t,targetParentStore:o.getContentStore(),droppedDirection:I.vh.Below,droppedStores:s,duplicate:!1,transaction:n})}(e),C.FH({stores:[o],update:{toggleable:t},transaction:n})}var P=o(39699);function A(e){const{environment:t,block:o,blockType:n,transaction:s,isMultiBlockTransformation:l}=e,p=o.getType(),m=o.getFormat(),g=o.recordStoreUIParentStore;if(h.M_(t)&&p&&!function(e,t){const o=e.type,n=e.format;if(u.ih(t)){var i;return"mermaid_code_block"===t?e.type===r.Ti.code&&"Mermaid"===c.QaF(null===(i=e.properties)||void 0===i?void 0:i.language):(0,r.Fx)(t)?u.tZ(t)===e.type&&(0,r.eJ)(o,n):u.tZ(t)===e.type}return e.type===t&&!(0,r.eJ)(o,n)}({type:p,format:m,properties:o.getProperties()},n)){const e=p,c=u.ih(n)?u.tZ(n):n;if(b.sW({store:o,data:{type:c},transaction:s}),(0,r.Fx)(n)&&!u.fn(o)?function(e){M(e,!0)}({environment:t,store:o,transaction:s,disableAutoChildrenMove:Boolean(l)}):!(0,r.Fx)(n)&&u.fn(o)&&function(e){const{store:t}=e;t.recordStoreUIParentStore&&M(e,!1)}({environment:t,store:o,transaction:s,disableAutoChildrenMove:Boolean(l)}),"mermaid_code_block"===n&&d.E5({blocks:[o],language:"Mermaid",transaction:s}),r.Z7[e]&&!r.Z7[n]){o.getPermissionItems().some(a.Le)&&v.MX({environment:t,store:o,transaction:s})}u.BX(o)&&k.rd({blockId:o.id,state:!0,currentUserId:t.currentUser.id});const h=o.getType();h&&g&&p&&(0,r.Um)(p,m)&&!(0,r.Um)(h,o.getFormat())&&function(e){let{environment:t,block:o,parentStore:n}=e;(async()=>{const e=o.getContentStores();await Promise.all(e.map((e=>e.load()))),P.createAndCommit({userAction:"transformActions.runAsync",environment:t,perform:t=>{const r=i.d9(e).reverse();for(const e of r)y.Od({parent:o.getContentStore(),childToRemove:e,transaction:t}),y.BE({parent:n,insert:e,after:o,transaction:t})}})})()}({environment:t,parentStore:g,block:o}),f.jf({store:o,transaction:s})}return o}function D(e){const{environment:t,blocks:o,blockType:a,transaction:c}=e;if(a!==r.Ti.transclusionContainer)if(a!==r.Ti.columnList)if((0,r.sX)(a)){const e=parseInt(a.replace("column","").replace("block","")),r=i.oA(i.DZ(e-1,(()=>S.ZJ({environment:t,blocks:o,transaction:c})))),s=[...o,...r],l=B({environment:t,blocks:s,transaction:c});n.default.afterNextFlush((()=>{w.N_({store:l[0].getBlockTitleStore()})}))}else for(const n of o)A({environment:t,block:n,blockType:a,transaction:c,isMultiBlockTransformation:o.length>1});else B({environment:t,blocks:o,transaction:c});else!function(e){const{environment:t,blocks:o,transaction:n}=e,i=o[0];if(!i)return;const a=i.getRecordStoreUIParent();if(!a||!(0,p.dz)(a))return;const c=a.getRecordStoreUIParent();if(!c||!(0,p.OY)(c))return;if(!c.isDefined())return;const d=(0,s.ZP)(),u={id:d,type:r.Ti.transclusionContainer,parent_id:a.id,parent_table:"block",space_id:c.getSpaceId(),alive:!0};b.ae({environment:t,table:"block",value:u,inMemoryRecordCache:a.inMemoryRecordCache,transaction:n});const h=m.G.createChildStore(a,{table:l.iU,id:d}),f=h.getContentStore();y.BE({parent:a,insert:h,after:i,transaction:n}),function(e){const{newParent:t,blocks:o,transaction:n}=e;for(const r of o){const e=r.getRecordStoreUIParent();null!=e&&e.valueIs(g.i)&&(y.Od({parent:e,childToRemove:r,transaction:n}),y.R3({parent:t,append:r,transaction:n}))}}({newParent:f,blocks:o,transaction:n}),w.ZH(t),_.ZH(t),_.Z5({environment:t,stores:[h]})}({environment:t,blocks:o,transaction:c})}function B(e){const{environment:t,blocks:o,transaction:n}=e,i=o[0];if(!i)return[];const a=i.recordStoreUIParentStore;if(null==a||!a.valueIs(g.i))return[];const c=(0,s.ZP)(),d={id:c,type:r.Ti.columnList,parent_id:a.id,parent_table:"block",space_id:i.getSpaceId(),alive:!0};b.ae({environment:t,table:"block",value:d,inMemoryRecordCache:i.inMemoryRecordCache,transaction:n});const p=m.G.createChildStore(a,{table:l.iU,id:c}),{child:u}=y.Vt({parent:a,insert:p,before:i,transaction:n});return o.map((e=>{const o=(0,s.ZP)(),i={id:o,type:r.Ti.column,parent_id:p.id,parent_table:"block",space_id:e.getSpaceId(),alive:!0};b.ae({environment:t,table:"block",value:i,inMemoryRecordCache:e.inMemoryRecordCache,transaction:n});const c=m.G.createChildStore(u.getContentStore(),{table:l.iU,id:o}),{child:d}=y.Od({parent:a,childToRemove:e,transaction:n}),{child:g}=y.BE({parent:u.getContentStore(),insert:c,transaction:n}),{child:h}=y.BE({parent:g.getContentStore(),insert:d,transaction:n});return h}))}function R(e){let{environment:t,blocks:o,transaction:n}=e;(function(e){return 1===e.length&&"collection_view"===e[0].getType()})(o)&&D({environment:t,blocks:o,blockType:"collection_view_page",transaction:n})}},39865:(e,t,o)=>{o.d(t,{DV:()=>_,Rn:()=>k,Tq:()=>x,y8:()=>w});o(57658);var n=o(15145),r=o(59730),i=o(21202),a=o(23867),s=o(5366),l=o(33929),c=o(74948),d=o(44604),p=o(80444),u=o(1310),m=o(50906),g=o(54642),h=o(47307),f=o(19785),y=o(75018),v=o(64964),b=o(65452);const S=(0,s.defineMessages)({deletePageConfirmationMessage:{id:"trashActions.deletePagePermanentlyDialog.prompt",defaultMessage:"Are you sure you want to delete this page permanently?"},deletePageConfirmationButton:{id:"trashActions.deletePagePermanentlyDialog.confirmDeleteButton.label",defaultMessage:"Yes. Delete this page"},permanentlyDeleteFailedToast:{id:"trashActions.deletePagePermanentlyDialog.actionFailed.toast",defaultMessage:"Failed to delete, please try again later."},permanentlyDeletePermissionsFailure:{id:"trashActions.deletePagePermanentlyDialog.actionFailed.permissions",defaultMessage:"You do not have sufficient permissions to permanently delete this page."}});async function _(e){const{environment:t,block:o,spaceId:r}=e;d.Z.state.excludePages.add(o.id),d.Z.emit(),await g.restoreBlock(t,{pointer:{table:i.iU,id:o.id,spaceId:r}}),y.navigateToBlock({environment:t,store:o,pageVisitSource:n.tY.Restore}),t.device.isMobile&&c.close(),m.Y35(t)}function w(e){const{environment:t,blocks:o,transaction:n}=e;for(const r of o)f.zo({block:r,transaction:n});n.postSubmitCallbacks.push((async e=>{e||await g.deleteBlocks(t,{blocks:o.map((e=>({id:e.id,spaceId:(0,a.C)(e.pointer.spaceId)}))),permanentlyDelete:!1})}))}function k(e){h.showDialog({message:l.default.formatMessage(S.deletePageConfirmationMessage),showCancel:!0,keepFocus:!1,items:[{label:l.default.formatMessage(S.deletePageConfirmationButton),color:"red",onAccept:()=>x(e)}]})}async function x(e){const{blocks:t,environment:o}=e,{currentSpaceStore:n}=p.default.state,i=e.environment.currentUser.id;if(n&&i){await g.deleteBlocks(e.environment,{blocks:t.map((e=>({id:e.id,spaceId:(0,a.C)(e.pointer.spaceId)}))),permanentlyDelete:!0}).then((e=>{if("failed"===e.type)throw function(e){let t=S.permanentlyDeleteFailedToast;(0,r.QW)(e)&&(t=S.permanentlyDeletePermissionsFailure);v.oV({label:l.default.formatMessage(t),durationMs:u.JY})}(e.body),e.error}));for(const e of t)d.Z.state.excludePages.add(e.id),d.Z.emit();await b.l({environment:o,spaceId:n.id,userId:i}),y.navigateAwayIfCurrentPage({environment:e.environment,blocks:t}),m.tZo(o)}}},27370:(e,t,o)=>{o.r(t),o.d(t,{dismissTutorial:()=>d,resetTutorials:()=>p,tutorialAdvanceToStep:()=>u,tutorialAdvanceToStepAfter:()=>m,tutorialGoToNextStep:()=>l,tutorialGoToPrevStep:()=>c});var n=o(9163),r=o(39699),i=o(37181),a=o(64856),s=o(80444);function l(e,t){var o;const{currentUserSettingsStore:n}=s.default.state;if(!n)return;const r=null===(o=n.getSettings())||void 0===o?void 0:o.tutorials;g({userAction:"TutorialActions.nextStep",environment:e,perform:e=>{i.d2({userSettingsStore:n,transaction:e,data:{tutorials:{...r,[t]:(0,a.ox)(n,t)}}})},userId:n.id})}function c(e,t){var o;const{currentUserSettingsStore:n}=s.default.state;if(!n)return;const r=null===(o=n.getSettings())||void 0===o?void 0:o.tutorials;g({userAction:"TutorialActions.prevStep",environment:e,perform:e=>{i.d2({userSettingsStore:n,transaction:e,data:{tutorials:{...r,[t]:(0,a.IJ)(n,t)}}})},userId:n.id})}function d(e,t){var o;const{currentUserSettingsStore:r}=s.default.state;if(!r)return;const a=null===(o=r.getSettings())||void 0===o?void 0:o.tutorials;g({userAction:"TutorialActions.dismissTutorial",environment:e,perform:e=>{i.d2({userSettingsStore:r,transaction:e,data:{tutorials:{...a,[t]:n.lR}}})},userId:r.id})}function p(e){const{currentUserSettingsStore:t}=s.default.state;t&&g({userAction:"TutorialActions.resetTutorialsDebug",environment:e,perform:e=>{i.d2({userSettingsStore:t,transaction:e,data:{tutorials:{}}})},userId:t.id})}function u(e,t,o){var r;const{currentUserSettingsStore:l}=s.default.state;if(!l||(0,a.W$)(l,t))return;const c=(0,a.wF)(l,t);n.eU[t].steps.findIndex((e=>e.id===c))>=n.eU[t].steps.findIndex((e=>e.id===o))||i.d2({userSettingsStore:l,transaction:e,data:{tutorials:{...null===(r=l.getSettings())||void 0===r?void 0:r.tutorials,[t]:o}}})}function m(e,t,o){if((0,a.AK)(o))return;const n=(0,a.Xv)(t,o);n&&u(e,t,n)}function g(e){return r.createAndCommit({...e,canUndo:!1})}},61202:(e,t,o)=>{o.d(t,{KT:()=>fe,FD:()=>be,xv:()=>ye,jh:()=>Ie,pt:()=>me,os:()=>Ae,dY:()=>xe,pJ:()=>he,hJ:()=>ve,UY:()=>we,yp:()=>_e,sz:()=>Be,aV:()=>Re,qK:()=>Ee});o(21703),o(57658);var n=o(26263),r=o(1302),i=o(41432),a=o(99036),s=o(80951),l=o(95538),c=o(77657),d=o(2864),p=o(68626),u=o(20270),m=o(72126),g=o(59753),h=o(4615),f=o(45953),y=o(21202),v=o(77420),b=o(6287),S=o(13493),_=o(32161),w=o(9844),k=o(23867),x=o(90965),I=o(70203),C=o(97880),T=o(44876),M=o(64002),P=o(63143),A=o(5366),D=o(14871),B=o(94419),R=o(9953),E=o(24677),F=o(97444),N=o(98104),j=o(39699),O=(o(95477),o(69783)),L=o(65454),U=o(77080);var Z=o(70764),V=o(41232),q=o(28415),z=o(33929),W=o(65598),H=o(89224),G=o(58202),K=o(80444),$=o(30874),Y=o(79167),Q=o(19111),J=o(35661),X=o(1634),ee=o(80064),te=o(40671),oe=o(34583),ne=o(50906),re=o(54642),ie=o(90287),ae=o(5149),se=o(47307),le=o(42631),ce=o(27153),de=o(4408),pe=o(64964);const ue=(0,A.defineMessages)({browse:{id:"externalBlock.mediaPicker.browseTab.title",defaultMessage:"Browse {appName}"},somethingWentWrong:{defaultMessage:"Something went wrong.",id:"externalActions.dialogError.openFilePicker.errorMessage"},copyDebuggingInformation:{id:"externalActions.dialogItem.openFilePicker.copyDebugData",defaultMessage:"Copy debugging information"},copiedDebuggingInfo:{id:"externalActions.dialogError.copiedDebuggingInfo",defaultMessage:"Copied to clipboard."},userReAuth:{id:"externalActions.dialogError.userReAuth",defaultMessage:"Authentication Expired. Please Re-Authenticate to continue."}});async function me(e){const{environment:t,spaceId:o,force:n}=e;await K.default.waitUntilRendered();const r=$.Z.state,i=t.currentUser.id;if(!r.loaded&&!r.loading||r.loaded&&o!==r.spaceId||r.loaded&&i!==r.userId||n){$.Z.setState({...$.Z.state,loading:!0});const[e,n]=await Promise.all([re.getExternalIntegrations(t,{spaceId:o}),ge({environment:t,spaceId:o})]);if("success"!==e.type||"success"!==n.type)throw new Error("Request failed.");const r=f.PF.create(e.data.recordMap),i=f.PF.create(n.data.recordMap);$.Z.setState({loaded:!0,loading:!1,spaceId:o,userId:t.currentUser.id,integrations:m.MR(m.oA(e.data.integrationIds.map((e=>r.getValue({table:w.K2,id:e})))),(e=>{let{created_at:t}=e;return t})),externalAuthentications:m.MR(m.oA(n.data.externalAuthenticationIds.map((e=>i.getValue({table:_.P,id:e})))),(e=>{let{created_at:t}=e;return t})),bots:m.Xo(m.oA(n.data.botIds.map((e=>i.getValue({table:v.cZ,id:e})))),(e=>{let{last_edited_at:t,created_at:o}=e;return t||o}),"desc"),completeSlackAuthentications:m.MR(m.oA(n.data.completeSlackAuthenticationIds.map((e=>i.getValue({table:_.P,id:e})))),(e=>{let{created_at:t}=e;return t}))})}}async function ge(e){const{environment:t,spaceId:o}=e;return t.currentUser.isLoggedIn()?await re.getUserSpaceExternalBots(t,{spaceId:o}):{type:"success",status:200,headers:{},data:{botIds:[],externalAuthenticationIds:[],recordMap:{},completeSlackAuthenticationIds:[]}}}async function he(e){const{environment:t}=e,{currentSpaceStore:o}=K.default.state;o&&await me({environment:t,spaceId:o.id,force:!0})}function fe(e){const{environment:t,blockStore:o,textStore:a,url:s,textValueBeforePaste:d,urlSelection:u}=e,g=H.get();if(!o||O.Z.state.open||Q.Z.state.open||ee.Z.state.open||!g)return!1;const{currentSpaceStore:f}=K.default.state,v=(0,l.x$)(s),_=(0,M.Qc)(v);if(!_.host)return!1;const w=t.currentUser.id;if(null==f||!f.isDefined()||!w)return!1;const C=$.Z.integrations.state.filter((e=>e.id!==c.U9)),P=(0,T.ny)({url:v,integrations:C,currentSpaceId:f.id});if("partial"===P.type)return function(e){const{environment:t,parsedUrl:o,urlDomain:n,integrationId:r}=e;ne.ppr(t,{integrationId:r,urlDomain:n}),p.log({level:"debug",from:"activateFromLinkCreation",type:"linkPreviewUrlMiss",data:{miscDataToConvertToString:{integrationId:r,urlDomain:n,path:o.path}}})}({...P,integrationId:P.integration.id,environment:t}),!1;if("failure"===P.type)return!1;const{integration:A,pattern:D}=P;if(!(0,x.wv)({permissions:f.getPermissionItems()},w)&&!(0,x.hU)({spaceBotSettings:f.getBotSettingsStore().getValue(),integrationId:A.id,env:"production"}))return!1;const B=(0,Z.NP)(A.id),R=function(e){var t;const{integration:o,pattern:n,blockStore:r,textValueBeforePaste:a}=e,s=r&&r.getType()===i.Ti.text&&0===(0,I.QaF)(a).trim().length,l=Boolean(null===(t=n.additional_types)||void 0===t?void 0:t.collection);return s?m.oA(["preview","mention","link",l&&"collection"]):m.oA(["mention","preview","link",l&&"collection"])}({blockStore:o,integration:A,pattern:D,textValueBeforePaste:d}),E=H.getRect(g);if(!E)return!1;const F=o.getRecordStoreUIParent();if(!F||!(0,W.dz)(F))return!1;const N=new n.Z({name:"unfurlingActions.activateFromLinkCreation",isTemporaryData:!0});t.defaultRecordCache.inMemoryRecordCache.addCacheOverride(N);const L=F.clone(N),U=o.clone(N),V=a.clone(N),q=new J.G(t,{table:y.iU,id:(0,h.ZP)(),spaceId:o.pointer.spaceId}),G=q.clone(N),Y=m.w6(T.wh).map((()=>new J.G(t,{table:y.iU,id:(0,h.ZP)(),spaceId:(0,k.C)(o.pointer.spaceId)}))),X=Y.map((e=>e.clone(N))),te=new J.NW(t,{table:b.v,id:(0,h.ZP)(),spaceId:o.pointer.spaceId}),oe=te.clone(N);let re;re=D.defaultViews?D.defaultViews.map((e=>new J.Xr(t,{table:S.n,id:(0,h.ZP)(),spaceId:o.pointer.spaceId}))):[new J.Xr(t,{table:S.n,id:(0,h.ZP)(),spaceId:o.pointer.spaceId})];const ie=re.map((e=>e.clone(N))),ae=m.w6(T.wh).map((()=>new J.NW(t,{table:b.v,id:(0,h.ZP)(),spaceId:o.pointer.spaceId}))),se=ae.map((e=>e.clone(N))),le=m.w6(T.wh).map((()=>new J.Xr(t,{table:S.n,id:(0,h.ZP)(),spaceId:o.pointer.spaceId}))),ce=le.map((e=>e.clone(N)));return ee.Z.setState({open:!0,url:v,textValueBeforePaste:d,textValueAfterPaste:a.getValue(),urlSelection:u,renderRect:E,integration:A,pattern:D,currentOption:{type:"link"},allOptionTypes:R,temporaryRecordCache:N,stores:{blockStore:o,blockParentStore:F,textStore:a,externalObjectInstanceBlockStore:q,subExternalObjectInstanceBlockStores:Y,externalCollectionStore:te,externalCollectionViewStores:re,subExternalCollectionStores:ae,subExternalCollectionViewStores:le},temporaryStores:{blockParentStore:L,blockStore:U,textStore:V,externalObjectInstanceBlockStore:G,subExternalObjectInstanceBlockStores:X,externalCollectionStore:oe,externalCollectionViewStores:ie,subExternalCollectionStores:se,subExternalCollectionViewStores:ce},unfurlResponse:void 0}),B.length>0&&Se({environment:t,url:s,botIds:B.map((e=>{let{id:t}=e;return t})),integrationId:A.id,externalObjectInstanceBlockStore:q}),ne._xm(t,{integrationId:A.id,entity:D.name,domain:_.host,from:"link_paste"}),r.default.afterNextFlush((()=>{j.createAndCommit({userAction:"unfurlingActions.activateFromLinkCreation",environment:t,perform:e=>{ve({environment:t,type:R[0],useTemporaryRecordCache:!0,transaction:e,intl:z.default.getIntl()})}})})),!0}function ye(e){const{environment:t,setType:o,transaction:n}=e,{currentUserSettingsStore:r}=K.default.state,i=ee.Z.state;if(!i.open)return;t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(i.temporaryRecordCache);const a=(0,Z.NP)(i.integration.id).length>0;if(ve({environment:t,type:o||i.currentOption.type,useTemporaryRecordCache:!1,transaction:n,intl:z.default.getIntl()}),"preview"===i.currentOption.type&&E.Z5({environment:t,stores:[i.currentOption.externalObjectInstanceBlockStore]}),i.integration&&!a){(null==r?void 0:r.hasDismissedIntegrationPopup({integrationId:i.integration.id}))||X.Z.setState({open:!0,integration:i.integration,externalObjectInstanceBlockId:i.stores.externalObjectInstanceBlockStore.id,unfurlUrl:i.url})}ee.Z.setState({open:!1})}function ve(e){const{environment:t,type:o,transaction:n,useTemporaryRecordCache:c}=e,p=ee.Z.state;if(!p.open)return;const u=t.currentUser.id;if(!u)return;const h=c?p.temporaryStores:p.stores;if(c){p.temporaryRecordCache.clearCache();for(const e in p.temporaryStores){const o=p.temporaryStores[e],n=Array.isArray(o)?o:[o];for(const e of n){const o={userId:u,pointer:e.pointer},n=t.defaultRecordCache.inMemoryRecordCache.getRecord(o);n?de.Wl({environment:t,inMemoryRecordCache:p.temporaryRecordCache,pointer:e.pointer,model:g.kk.fromValue(e.pointer.table,n.value),role:n.role,updatePaths:[[]],userId:u,force:!0,debugSource:"setUnfurlingOptionType"}):de.uo({environment:t,inMemoryRecordCache:p.temporaryRecordCache,persistedRecordCache:void 0,pointer:e.pointer,userId:u})}}}const f=(0,l.x$)(p.url),{host:v}=(0,M.Qc)(f);if(v){if("preview"===o||"mention"===o){const{unfurlResponse:e}=p,t=Fe({externalObjectInstanceBlockStore:h.externalObjectInstanceBlockStore,parentId:h.blockParentStore.id}),o={original_url:f,domain:v};let r;if(e){const a=(0,P.m8)(m.oA(e.relations.map(((e,t)=>{if(e.external_schema)return;const o=h.subExternalObjectInstanceBlockStores[t];if(!o)return;const r=e,a={id:o.id,type:i.Ti.externalObjectInstance,space_id:(0,k.C)(h.blockStore.pointer.spaceId),parent_table:y.iU,parent_id:h.externalObjectInstanceBlockStore.id,alive:!0,format:r};return R.sW({store:o,data:a,transaction:n}),[e.uri,o.id]})))),{external_object_id:s,uri:l,bot_id:c}=e.root;if(s&&l&&c){let n,i;const p=(0,d.o)(e.root.attributes,(0,V.o$)());p&&(n=p.block_width,i=p.block_height);const u={...o,...{...e.root,block_width:n,block_height:i,external_schema:void 0},related_external_object_uris_to_instance_ids:a,external_object_id:s,uri:l,bot_id:c};r={...t,format:u}}else{var S;const n={...o,attributes:e.root.attributes,error:e.root.error,auth_refresh_in_progress:439===(null===(S=e.root.error)||void 0===S?void 0:S.status_code)||null};r={...t,format:n}}}else{const e=o;r={...t,format:e}}R.sW({store:h.externalObjectInstanceBlockStore,data:r,transaction:n})}else if("collection"===o){const{unfurlResponse:e}=p,t={id:h.externalObjectInstanceBlockStore.id,version:0,type:i.Ti.collectionView,format:{collection_pointer:h.externalCollectionStore.pointer},collection_id:h.externalCollectionStore.pointer.id,space_id:(0,k.C)(h.blockStore.pointer.spaceId),parent_table:y.iU,parent_id:h.blockParentStore.id,alive:!0,view_ids:h.externalCollectionViewStores.map((e=>e.id))},o=h.externalCollectionViewStores.map(((e,t)=>{var o,n,r;return{id:e.id,version:0,space_id:(0,k.C)(h.blockStore.pointer.spaceId),type:(null===(o=p.pattern.defaultViews)||void 0===o?void 0:o[t].type)||"table",format:null===(n=p.pattern.defaultViews)||void 0===n?void 0:n[t].format,query2:null===(r=p.pattern.defaultViews)||void 0===r?void 0:r[t].query2,parent_table:y.iU,parent_id:h.externalObjectInstanceBlockStore.id,alive:!0}}));let l;if(e){const{external_object_id:o,uri:r,bot_id:i}=e.root;if(o&&r&&i)if("collectionId"in e&&e.collectionId){l={id:e.collectionId,version:0,space_id:(0,k.C)(h.blockStore.pointer.spaceId),parent_table:y.iU,parent_id:h.externalObjectInstanceBlockStore.id,alive:!0,schema:{}},t.format=void 0,t.collection_id=e.collectionId}else{const t={};e.relations.forEach(((e,o)=>{const r=h.subExternalCollectionStores[o],i=e,a={id:r.id,version:0,space_id:(0,k.C)(h.blockStore.pointer.spaceId),parent_table:b.v,parent_id:h.externalCollectionStore.id,alive:!0,format:i,schema:{}};t[e.uri]=r.id,R.sW({store:r,data:a,transaction:n})}));l={id:h.externalCollectionStore.id,version:0,space_id:(0,k.C)(h.blockStore.pointer.spaceId),parent_table:y.iU,parent_id:h.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:f,domain:v,...e.root,related_external_object_uris_to_instance_ids:{...t}},schema:{}}}else{l={id:h.externalCollectionStore.id,version:0,space_id:(0,k.C)(h.blockStore.pointer.spaceId),parent_table:y.iU,parent_id:h.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:f,domain:v,error:e.root.error},schema:{}}}}else{l={id:h.externalCollectionStore.id,version:0,space_id:(0,k.C)(h.blockStore.pointer.spaceId),parent_table:y.iU,parent_id:h.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:f,domain:v},schema:{}}}R.sW({store:h.externalObjectInstanceBlockStore,data:t,transaction:n});const c=U.default.checkGate("is_visibility_enabled_for_db_sync");h.externalCollectionViewStores.forEach(((t,r)=>{var i;e&&"collectionId"in e&&e.collectionId&&o[r].format&&(o[r].format={collection_pointer:{id:e.collectionId,table:b.v}}),c&&e&&"table"===o[r].type&&(o[r].format={...o[r].format,table_properties:(i=e.root.external_schema,i&&Object.entries(i).flatMap((e=>{let[t,o]=e;return(0,a.HF)(t)?[]:"hidden"===(null==o?void 0:o.visibility)?{property:`${s.UU}${t}`,visible:!1}:{property:`${s.UU}${t}`,visible:!0}})))}),R.sW({store:t,data:o[r],transaction:n})})),R.sW({store:h.externalCollectionStore,data:l,transaction:n});const d=p.integration;r.default.afterNextFlush((()=>{const e=G.R.findCollectionViewBlockFromId(h.externalObjectInstanceBlockStore.id);if(e){const t=e.collectionContextStore.settingsStore;ae.wl({collectionSettingsStore:t,item:{type:"shareSyncedView",integrationName:d.name,integrationIcon:d.info.icon}})}}))}if("preview"===o){F.sO({environment:t,store:h.textStore,value:p.textValueBeforePaste,transaction:n});const e=J.G.createChildStore(h.blockParentStore,h.externalObjectInstanceBlockStore.pointer);if(B.BE({parent:h.blockParentStore,insert:e,after:h.blockStore,transaction:n}),0===(0,I.QaF)(p.textValueBeforePaste).trim().length){const e=J.G.createChildStore(h.blockParentStore,p.stores.blockStore.pointer);B.Od({parent:h.blockParentStore,childToRemove:e,transaction:n})}const r=J.G.createChildStore(p.stores.blockParentStore,p.stores.externalObjectInstanceBlockStore.pointer);E.ZH(t),ee.Z.setState({...p,currentOption:{type:o,externalObjectInstanceBlockStore:r}})}else if("mention"===o){const e=(0,I.x36)(h.externalObjectInstanceBlockStore.id),o=(0,I.YCD)(e),r=(0,I.P$X)(p.textValueBeforePaste,[o],p.urlSelection.startIndex),i={startIndex:p.urlSelection.startIndex+1,endIndex:p.urlSelection.startIndex+1};F.sO({environment:t,store:h.textStore,value:r,transaction:n}),R.sW({store:h.externalObjectInstanceBlockStore,data:{parent_id:h.textStore.id,parent_table:y.iU,alive:!0},transaction:n}),E.eP({environment:t,store:p.stores.blockStore}),N.Z5({store:p.stores.textStore,selection:i}),ee.Z.setState({...p,currentOption:{type:"mention",mentionTokenSelection:i}})}else if("link"===o)ee.Z.setState({...p,currentOption:{type:"link"}}),E.eP({environment:t,store:p.stores.blockStore}),N.Z5({store:p.stores.textStore,selection:{startIndex:p.urlSelection.endIndex,endIndex:p.urlSelection.endIndex}});else if("collection"===o){F.sO({environment:t,store:h.textStore,value:p.textValueBeforePaste,transaction:n});const e=J.G.createChildStore(h.blockParentStore,h.externalObjectInstanceBlockStore.pointer);if(B.BE({parent:h.blockParentStore,insert:e,after:h.blockStore,transaction:n}),0===(0,I.QaF)(p.textValueBeforePaste).trim().length){const e=J.G.createChildStore(h.blockParentStore,p.stores.blockStore.pointer);B.Od({parent:h.blockParentStore,childToRemove:e,transaction:n})}E.ZH(t),ee.Z.setState({...p,currentOption:{type:o}})}else(0,C.t1)(o);if(!c){const{unfurlResponse:e}=p;ne.Mp(t,{integrationId:p.integration.id,type:o,entity:p.pattern.name,domain:v,from:"unfurl_menu",...e&&{status:null!=e&&e.root.error?"failure":"success"},collection_id:"collection"===o?h.externalCollectionStore.pointer.id:void 0,collection_view_block_id:"collection"===o&&h.blockStore.isCollectionView()?h.blockStore.id:void 0})}}}async function be(e){const{environment:t,notionState:o}=e,{externalObjectInstanceBlockId:n,spaceId:r}=o;if(n){const e=new J.G(t,{table:y.iU,id:n,spaceId:r});let o;if(await Promise.all([e.load(),$.Z.waitUntil((()=>$.Z.state.loaded))]),e.isExternalObjectInstanceBlockStore()||e.isExternalObjectInstancePageBlockStore())o=e.getFormat();else if(e.isCollectionView()){var i;o=null===(i=e.getCollectionViewSourceCollectionStore())||void 0===i?void 0:i.getFormat()}if(!o)throw new Error("External object instance has no value.");const a=o.original_url||o.uri;if(!a)throw new Error("External object instance has no original_url.");const s=(0,T.ny)({url:a,integrations:$.Z.integrations.state,currentSpaceId:r});if("success"!==s.type)throw new Error("Could not find integration.");const{integration:l}=s,c=(0,Z.NP)(l.id);if(0===c.length)throw new Error("Could not find bot.");if(e.isExternalObjectInstanceBlockStore()||e.isExternalObjectInstancePageBlockStore())await Se({environment:t,url:a,botIds:c.map((e=>{let{id:t}=e;return t})),integrationId:l.id,externalObjectInstanceBlockStore:e});else{if(!e.isCollectionView())throw new Error(`BlockStore is neither an ExternalObject nor a ExternalCollection. It has type: ${e.getType()}`);{const o=e.getCollectionViewSourceCollectionStore();if(!o)throw new Error("Could not find collection store.");await we({environment:t,url:a,botIds:c.map((e=>{let{id:t}=e;return t})),externalCollectionViewBlockStore:e,externalCollectionStore:o})}}}}async function Se(e){const{environment:t,url:o,botIds:n,integrationId:r,externalObjectInstanceBlockStore:a}=e;te.Z.add(o);const s=await re.unfurlUrl(t,{url:o,botIds:n,integrationId:r,spaceId:ie.Bs()});te.Z.delete(o);const c=ee.Z.state,p="success"===s.type?s.data:{root:{error:{status_code:s.status}},relations:[]};if(c.open&&c.stores.externalObjectInstanceBlockStore===a)ee.Z.setState({...c,unfurlResponse:p}),j.createAndCommit({userAction:"unfurlingActions.startUnfurlRequest",environment:t,perform:e=>{ve({environment:t,type:c.currentOption.type,useTemporaryRecordCache:!0,transaction:e,intl:z.default.getIntl()})}});else if(a.isExternalObjectInstanceBlockStore())!function(e){const{environment:t,unfurlResponse:o,url:n,externalObjectInstanceBlockStore:r}=e,a=r.pointer.spaceId;if(!t.currentUser.id)return;const s=(0,l.x$)(n),{host:c}=(0,M.Qc)(s);if(!c)return;if("collectionId"in o)return;const p=r.getFormat().related_external_object_uris_to_instance_ids,u=(0,P.m8)(Object.entries(p||{}).map((e=>{let[t,o]=e;return[t,J.G.createChildStore(r,{id:o,table:y.iU,spaceId:r.getSpaceId()})]})));j.createAndCommit({userAction:"unfurlingActions.createExternalObjectInstanceFromInitialUnfurl",environment:t,perform:e=>{const s=(0,P.m8)(m.oA(o.relations.map((o=>{var n;if(o.external_schema)return;const s=(null===(n=u[o.uri])||void 0===n?void 0:n.id)||(0,h.ZP)(),l=new J.G(t,{table:y.iU,id:s,spaceId:a}),c=o,d={id:l.id,type:i.Ti.externalObjectInstance,space_id:a,parent_table:y.iU,parent_id:r.id,alive:!0,format:c};return R.sW({store:l,data:d,transaction:e}),[o.uri,l.id]})))),l=r.getFormatStore().getValue();let c,p;if(l&&(c=l.block_width,p=l.block_height),!c&&!p){const e=(0,d.o)(o.root.attributes,(0,V.o$)());e&&(c=e.block_width,p=e.block_height)}R.sW({store:r.getFormatStore(),data:{...{...o.root,block_width:c,block_height:p,external_schema:void 0,integration_id:null,original_url:n,is_placeholder:null,error:o.root.error??null},related_external_object_uris_to_instance_ids:s},transaction:e})}})}({environment:t,unfurlResponse:p,url:o,externalObjectInstanceBlockStore:a}),function(e){const{environment:t,url:o,spaceId:n,status:r}=e,i=(0,V.GQ)(o,n),a=(0,l.x$)(o),s=(0,M.Qc)(a);i&&s.host&&ne.Mp(t,{integrationId:i.integration.id,type:"preview",entity:i.pattern.name,domain:s.host,from:"link_preview_placeholder",...r&&{status:r}})}({environment:t,url:o,spaceId:a.getSpaceId(),...p&&{status:p.root.error?"failure":"success"}});else{if(!a.isCollectionView()){if(a.isExternalObjectInstancePageBlockStore())return;throw new Error(`BlockStore is neither an ExternalObject nor a ExternalCollection. It has type: ${a.getType()}`)}{const e=a.getCollectionViewSourceCollectionStore();if(!e)throw new Error("Could not find collection store.");j.createAndCommit({userAction:"unfurlingActions.startUnfurlRequest",environment:t,perform:n=>{ke({environment:t,unfurlResponse:p,url:o,externalCollectionStore:e,externalCollectionViewBlockStore:a,transaction:n})}})}}}async function _e(e){const{environment:t,url:o,botIds:n,userDefinedExternalCollectionStore:r,relatedPageId:a}=e,s=r.getFormat();if(!s.uri||void 0!==s.external_object_id)return;te.Z.add(o);const c=await re.unfurlUrl(t,{url:o,botIds:n,spaceId:r.getSpaceId(),targetCollectionId:r.id,relatedPageId:a});if("failed"===c.type)return void se.showError(c);te.Z.delete(o);const d=c.data;let p;return"pageId"in d&&d.pageId?p=new J.G(t,{table:y.iU,id:d.pageId,spaceId:r.getSpaceId()}):(p=new J.G(t,{table:y.iU,id:(0,h.ZP)(),spaceId:r.getSpaceId()}),function(e){const{environment:t,unfurlResponse:o,url:n,rootUserDefinedExternalCollectionStore:r,rootExternalObjectInstancePageStore:a}=e,s=r.pointer.spaceId;if(!t.currentUser.id)return;const c=(0,l.x$)(n),{host:d}=(0,M.Qc)(c);if(!d)return;if(!o.root.external_object_id)return;const p=o.root;j.createAndCommit({userAction:"unfurlingActions.createExternalObjectInstancePageFromInitialUnfurl",environment:t,perform:e=>{const t={id:a.id,type:i.Ti.externalObjectInstancePage,space_id:s,parent_table:b.v,parent_id:r.id,alive:!0,format:p};R.sW({store:a,data:t,transaction:e})}})}({environment:t,unfurlResponse:d,url:o,rootUserDefinedExternalCollectionStore:r,rootExternalObjectInstancePageStore:p})),p}async function we(e){const{environment:t,url:o,botIds:n,externalCollectionStore:r,externalCollectionViewBlockStore:i}=e;te.Z.add(o);const a=await re.unfurlUrl(t,{url:o,botIds:n,spaceId:ie.Bs()});te.Z.delete(o);const s="success"===a.type?a.data:{root:{error:{status_code:a.status}},relations:[]};j.createAndCommit({userAction:"unfurlingActions.startUnfurlRequestForCollection",environment:t,perform:e=>{ke({environment:t,unfurlResponse:s,url:o,externalCollectionStore:r,externalCollectionViewBlockStore:i,transaction:e})}})}function ke(e){const{environment:t,unfurlResponse:o,url:n,externalCollectionStore:r,externalCollectionViewBlockStore:i,transaction:c}=e,d=(0,l.x$)(n),{host:p}=(0,M.Qc)(d);if(!p)return;const{external_object_id:u,uri:g,bot_id:f}=o.root;if(!u||!g||!f)return;const v=m.w6(T.wh).map((()=>new J.NW(t,{table:b.v,id:(0,h.ZP)(),spaceId:i.pointer.spaceId}))),S={};o.relations.forEach(((e,t)=>{const o=v[t],n=e,a={id:o.id,version:0,space_id:(0,k.C)(i.pointer.spaceId),parent_table:b.v,parent_id:r.id,alive:!0,format:n,schema:{}};S[e.uri]=o.id,R.sW({store:o,data:a,transaction:c})}));const _={id:r.id,version:0,space_id:(0,k.C)(i.pointer.spaceId),parent_table:y.iU,parent_id:i.id,alive:!0,format:{original_url:d,domain:p,...o.root,property_visibility:(w=o.root.external_schema,w&&Object.keys(w).flatMap((e=>(0,a.HF)(e)?[]:{property:`${s.UU}${e}`,visibility:"hide_if_empty"}))),related_external_object_uris_to_instance_ids:{...S},is_placeholder:void 0,integration_id:void 0},schema:{}};var w;R.sW({store:r,data:_,transaction:c})}async function xe(e){const{environment:t}=e,{externalObjectInstanceBlockPointersMap:o,externalCollectionInstancePointersMap:n}=Y.Z.state;await re.refetchExternalObjectInstanceBlocks(t,{recordPointers:[...Object.values(o),...Object.values(n)]}),Y.Z.reset()}async function Ie(e){const{environment:t,externalAuthenticationValue:o}=e;let n=await re.getExternalIntegrationAccessToken(t,{botId:o.id,integrationId:o.integration_id,spaceId:o.space_id});if("failed"===n.type){const e=$.Z.integrations.state.find((e=>e.id===o.integration_id));if(!e)return;pe.oV({label:z.default.formatMessage(ue.userReAuth)}),await le.hM({environment:t,integration:e,spaceId:o.space_id,from:"integration_file_picker"});const r=$.Z.bots.state.filter((e=>e.integration_id===o.integration_id))[0];if(!r)return;n=await re.getExternalIntegrationAccessToken(t,{botId:r.id,integrationId:r.integration_id,spaceId:r.space_id})}return n}function Ce(e){const{integration:t}=e;return t.id===c.YM&&"on"===U.default.getEligibleGroup({experimentId:"box_file_picker",defaultGroup:"control"})?Te({integrationType:"box",...e}):t.id===c.f3&&(0,q.qH)()?Te({integrationType:"drive",...e}):void 0}function Te(e){const{integrationType:t,integration:o}=e;return"box"===t?{type:t,title:z.default.formatMessage(ue.browse,{appName:o.name}),accounts:$.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===o.id})),onSelect:Me(e)}:"drive"===t?{type:t,title:z.default.formatMessage(ue.browse,{appName:o.name}),accounts:$.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===o.id})),onSelect:Me(e)}:void 0}function Me(e){const{integration:t,environment:o,externalObjectTokenStore:n,externalObjectInstanceBlockStore:r}=e;return async e=>{let i=e?e.id:void 0;if(!e){const{currentSpaceStore:e}=K.default.state,n=$.Z.integrations.state.find((e=>{let{id:o}=e;return o===t.id}));if(n&&e){const r=$.Z.bots.state;await le.hM({environment:o,integration:n,spaceId:e.id,from:"integration_file_picker"});const a=function(e,t){const o=$.Z.bots.state;var n;if(e.length!==o.length)return null===(n=o.filter((e=>e.integration_id===t))[0])||void 0===n?void 0:n.id}(r,t.id);a&&(i=a)}}const a=$.Z.externalAuthentications.state.find((e=>e.id===i));if(a){const e=await async function(e,t,o,n,r){if(!$.Z.state.loaded)return;r.setState({error:!1,loading:!0});const i=await Ie({environment:e,externalAuthenticationValue:n});if(r.setState({error:!i||"success"!==i.type,loading:!1}),i&&"failed"!==i.type)return i.data;se.showDialog({message:z.default.formatMessage(ue.somethingWentWrong),showCancel:!0,keepFocus:!0,items:[{label:z.default.formatMessage(ue.copyDebuggingInformation),color:void 0,onAccept:()=>{const t={statusCode:null==i?void 0:i.status,integrationId:o.id,botId:n.id};D.RD({environment:e,stringValue:JSON.stringify(t,null,2),copiedMessage:ue.copiedDebuggingInfo})}}]})}(o,0,t,a,n);e&&(ce.Z(),await function(e){const{integration:t,tokenDetails:o,environment:n,externalObjectInstanceBlockStore:r,botId:i}=e;if(t.id===c.YM)return async function(e,t){const{access_token:o}=e;try{await(0,L.ZP)("https://cdn01.boxcdn.net/polyfills/core-js/2.5.3/core.min.js",{resourceType:L._g.Javascript});const e=[{url:"https://cdn01.boxcdn.net/platform/elements/15.0.0/en-US/picker.js",resourcetype:L._g.Javascript},{url:"https://cdn01.boxcdn.net/platform/elements/15.0.0/en-US/picker.css",resourcetype:L._g.Stylesheet}];await Promise.all(e.map((e=>{let{url:t,resourcetype:o}=e;return(0,L.ZP)(t,{resourceType:o})})))}catch(a){return void t(!0,"")}const n=document.createElement("div");n.setAttribute("id","box-app-container"),document.body.appendChild(n);const r=new Box.FilePicker;r.show("0",o,{size:"small",container:"#box-app-container",maxSelectable:1,logoUrl:"box"});const i=()=>{r.hide(),n.remove()};r.addListener("choose",(function(e){var o;const n=null==e||null===(o=e[0])||void 0===o?void 0:o.id;n&&t(!1,`https://app.box.com/file/${n}`),i()})),r.addListener("cancel",i)}(o,Pe({environment:n,externalObjectInstanceBlockStore:r,botId:i}));if(t.id===c.f3)return(0,q.vE)({environment:n,accessToken:o.access_token,callback:Pe({environment:n,externalObjectInstanceBlockStore:r,botId:i}),integration:t,from:"link_preview_placeholder"});return void t.id}({integration:t,environment:o,externalObjectInstanceBlockStore:r,externalObjectTokenStore:n,botId:a.id,tokenDetails:e}))}}}function Pe(e){const{environment:t,externalObjectInstanceBlockStore:o,botId:n}=e;return(e,r)=>{if(e)return se.showDialog({message:z.default.formatMessage(ue.somethingWentWrong),showCancel:!0,keepFocus:!0,items:[{label:z.default.formatMessage(ue.copyDebuggingInformation),color:void 0,onAccept:()=>{const o={err:e,botId:n};D.RD({environment:t,stringValue:JSON.stringify(o,null,2),copiedMessage:ue.copiedDebuggingInfo})}}]});De({environment:t,externalObjectInstanceBlockStore:o,url:r,botId:n})}}function Ae(e){const{environment:t,originRect:o,externalObjectInstanceBlockStore:n,integration:r}=e,i=[{type:"embed",onChange:o=>{De({environment:t,url:o,externalObjectInstanceBlockStore:n,placeholderIntegrationId:e.placeholderIntegrationId}),ce.Z()}}];if(U.default.checkGate("ai_source_picker")&&((null==r?void 0:r.id)===c.Gw||(null==r?void 0:r.id)===c.mC)){const o=(null==r?void 0:r.id)===c.Gw?"/images/external_integrations/github-icon.png":"/images/external_integrations/jira-icon.png";i.push({type:"aiSourcePicker",integration:null==r?void 0:r.id,defaultAvatar:o,onChange:o=>{De({environment:t,url:o,externalObjectInstanceBlockStore:n,placeholderIntegrationId:e.placeholderIntegrationId}),ce.Z()},getResults:async(e,o)=>await async function(e){const{environment:t,query:o,integrationId:n,botId:r}=e,i=r?[r]:$.Z.bots.state.filter((e=>e.integration_id===n)).map((e=>{let{id:t}=e;return t}));if(0===i.length)return{root:{error:{status_code:500,messages:["No bot found for this integration"]}},relations:[]};return await async function(e){const{environment:t,query:o,botIds:n}=e,r=await re.aiSourcePicker(t,{query:o,botIds:n,spaceId:ie.Bs()}),i="success"===r.type?r.data:{root:{error:{status_code:r.status}},relations:[]};return"failed"===r.type&&se.showError(r),i}({environment:t,query:o,botIds:i})}({environment:t,query:e,integrationId:o})})}if(r&&!t.device.isMobile){const o=Ce({integration:r,environment:t,externalObjectInstanceBlockStore:n,externalObjectTokenStore:e.externalObjectTokenStore});o&&i.push(o)}ce.$(t,{originGap:0,originRect:o,title:"Embed Link Preview",currentTab:"embed",tabs:i})}function De(e){const{environment:t,url:o,externalObjectInstanceBlockStore:n,placeholderIntegrationId:r,botId:i}=e,a=(0,T.ny)({url:o,integrations:$.Z.integrations.state,currentSpaceId:n.getSpaceId()});if("success"===a.type){const{integration:e,pattern:r}=a,s=i?[i]:$.Z.bots.state.filter((t=>t.integration_id===e.id)).map((e=>{let{id:t}=e;return t}));if(s.length>0){const i=n.getParentId(),a=(0,l.x$)(o),{host:c}=(0,M.Qc)(a);if(c&&i){const a={...Fe({externalObjectInstanceBlockStore:n,parentId:i}),format:{original_url:o,domain:c}};j.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{R.sW({store:n,data:a,transaction:e})}}),ne._xm(t,{integrationId:e.id,entity:r.name,domain:c,from:"placeholder"})}Se({environment:t,url:o,botIds:s,integrationId:e.id,externalObjectInstanceBlockStore:n})}else j.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{R.sW({store:n.getFormatStore(),data:{integration_id:null,original_url:o,is_placeholder:null},transaction:e})}})}else if("partial"===a.type){const{integration:e}=a;j.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:t=>{R.sW({store:n.getFormatStore(),data:{is_placeholder:null,integration_id:e.id,original_url:o,error:{status_code:u.Rl.UNPROCESSABLE_ENTITY}},transaction:t})}})}else"failure"===a.type?j.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{R.sW({store:n.getFormatStore(),data:{is_placeholder:null,original_url:o,integration_id:r,error:{status_code:u.Rl.UNPROCESSABLE_ENTITY}},transaction:e})}}):(0,C.t1)(a)}function Be(e){const{environment:t,block:o,transaction:n}=e;if(!o.isDefined()||!oe.M_(t)||!o.isType(i.Ti.externalObjectInstance))return;const r=(0,h.ZP)(),a={id:r,type:i.Ti.externalObjectInstance,parent_id:o.id,parent_table:o.table,space_id:o.getSpaceId(),alive:!0,format:o.getFormat()};R.ae({environment:t,table:y.iU,value:a,inMemoryRecordCache:o.inMemoryRecordCache,transaction:n});const s=o.getFormatStore().getKeyStore("related_external_object_uris_to_instance_ids").getValue();if(s)for(const i of Object.values(s)){const e={table:y.iU,id:i,spaceId:o.getSpaceId()};j.applyOperation({store:(0,J.Kv)(o,e),operation:{pointer:e,path:[],command:"update",args:{parent_table:y.iU,parent_id:r}},transaction:n})}const l=[(0,I.YCD)((0,I.x36)(r))];R.sO({store:o,value:{type:i.Ti.text,properties:{title:l},format:null},transaction:n})}function Re(e){var t;const{block:o,transaction:n,token:r,parentStore:i}=e,{tokenIndex:a}=r;if(!o.isDefined())return;const s=null===(t=i.getParentBlockStore())||void 0===t?void 0:t.getContentStore();if(!s)return;F.gy({block:i,transaction:n,tokenIndex:a})&&B.BE({parent:s,insert:o,after:i,transaction:n})}function Ee(e){const{environment:t,spaceId:o,from:n,store:r,bypassCache:i}=e,a=(0,V.y6)(r),s=(null==a?void 0:a.original_url)||(null==a?void 0:a.uri);if(!s)return;const l=(0,V.GQ)(s,o),d=(0,V.Ue)(s,o);if(!l||0===d.length)return;const p=r.getCollectionViewCollectionStore(),{integration:u,pattern:m}=l;r.isCollectionView()&&p?re.refetchExternalObjectInstanceBlocks(t,{recordPointers:[{...p.pointer,spaceId:o}],bypassCache:i}):r.isExternalObjectInstancePageBlockStore()?c.tO.includes(u.id)?Se({environment:t,url:s,botIds:d.map((e=>{let{id:t}=e;return t})),integrationId:u.id,externalObjectInstanceBlockStore:r}):re.refetchExternalObjectInstanceBlocks(t,{recordPointers:[{...r.pointer,spaceId:o}],bypassCache:i}):r.isExternalObjectInstanceBlockStore()&&Se({environment:t,url:s,botIds:d.map((e=>{let{id:t}=e;return t})),integrationId:u.id,externalObjectInstanceBlockStore:r}),ne.B3N(t,{integrationId:u.id,entity:m.name,from:n})}function Fe(e){const{externalObjectInstanceBlockStore:t,parentId:o}=e;return{id:t.id,version:0,type:i.Ti.externalObjectInstance,space_id:(0,k.C)(t.pointer.spaceId),parent_table:y.iU,parent_id:o,alive:!0}}},53471:(e,t,o)=>{o.d(t,{A3:()=>Z,IL:()=>E,K_:()=>q,Q7:()=>F,W8:()=>V,Xo:()=>B,cR:()=>L,cT:()=>j,dm:()=>K,nQ:()=>D,y:()=>U});o(21703),o(57658);var n=o(15095),r=o(7406),i=o(68626),a=o(72126),s=o(29477),l=o(4615),c=o(149),d=o(53770),p=o(23867),u=o(70203),m=o(63143),g=o(5366),h=o(91754),f=o(33954),y=o(33929),v=o(52533),b=o(2414),S=o(77080),_=o(73329),w=o(5315),k=o(91551),x=o(88923),I=o(78291),C=o(88893),T=o(50906),M=o(54642),P=o(35253);const A=(0,g.defineMessages)({uploadFileFailed:{defaultMessage:"Upload failed.",id:"uploadActions.uploadFailedError.message"}});function D(e){return e.filter((e=>e.getAlive())).map((e=>{const{source:t,title:o,size:n}=e.getProperties()||{};return{type:"remote",id:e.id,source:u.QaF(t),name:u.QaF(o),size:u.QaF(n),store:e}}))}function B(e){return{...R(e),id:(0,l.ZP)(),dataURL:URL.createObjectURL(e),type:"local"}}function R(e){return{file:e,name:e.name,size:`${(e.size/1024).toFixed(1)}KB`}}function E(e){var t;const o=e.files.map(R);null===(t=e.onBatchStart)||void 0===t||t.call(e,o);const n={};let i=0;s.dC(e.files,W,(t=>Promise.all(t.map((t=>{const o=(0,l.ZP)();return new Promise(((s,l)=>{const p={environment:e.environment,..."secure"===e.bucket?{bucket:e.bucket,record:e.record}:{bucket:e.bucket},file:t,onStart:t=>{var n;null===(n=e.onSingleFileStart)||void 0===n||n.call(e,t,o)},onProgress:t=>{var n,r;let{progressPercent:a,uploadedFiles:s}=t;null===(n=e.onBatchProgress)||void 0===n||n.call(e,{progressPercent:a,uploadedFiles:i}),null===(r=e.onSingleFileProgress)||void 0===r||r.call(e,{progressPercent:a,uploadedFiles:s},o)},onComplete:r=>{var a;i++,n[t.name]=r,null===(a=e.onSingleFileComplete)||void 0===a||a.call(e,r,o),s()},onError:t=>{var n;const r=new Error(t.message);null===(n=e.onSingleFileError)||void 0===n||n.call(e,r,o),l(r)},preventLimitFreeFileSize:e.preventLimitFreeFileSize};"confluence"===e.uploadType?async function(e){const{environment:t,file:o,preventLimitFreeFileSize:n}=e,i=o.type||"text/plain; charset=utf-8";if(F({preventLimitFreeFileSize:n,environment:t,file:o})){var s;null===(s=e.onStart)||void 0===s||s.call(e,R(o));const n=Math.floor(o.size/N)+1,g={bucket:e.bucket,name:o.name,contentType:i,supportExtraHeaders:!0,contentLength:o.size,numberOfFileChunks:n},h=await M.initiateMultipartUpload(t,g);var l;if("failed"===h.type)return void(null===(l=e.onError)||void 0===l||l.call(e,{message:h.error.message,offline:h.offline}));const f=await async function(e){const{file:t,signedUrlsForChunks:o}=e,n=[];let i,s,l,c=[];const p=[];for(let r=0;r<o.length;r++){i=r*N,s=(r+1)*N,l=r+1<o.length?t.slice(i,s):t.slice(i);const e=o[r],a=fetch(e,{method:"PUT",body:new Blob([l],{type:t.type})});n.push(a)}const u=a.yo(n,3);for(const[a,h]of u.entries()){var m;try{const e=await(0,d.Yb)((()=>Promise.all(h)),[100,1e3,3e3]);c=[...c,...e]}catch(g){return{error:(0,r.tg)(g)}}null===(m=e.onProgress)||void 0===m||m.call(e,{progressPercent:Math.floor(a/u.length*100),uploadedFiles:0})}return c.forEach(((e,t)=>{const o=e.headers.get("etag");o&&p.push({ETag:o,PartNumber:t+1})})),{value:p}}({file:o,signedUrlsForChunks:h.data.signedUrlsForChunks,onProgress:e.onProgress});var p;if(c.x.isFail(f))return void(null===(p=e.onError)||void 0===p||p.call(e,{message:f.error.message,offline:void 0}));const y={...g,multipartUploadEtags:f.value,fileKey:h.data.key,uploadId:h.data.uploadId},v=await M.completeMultipartUpload(t,y);var u,m;if("success"===v.type)null===(u=e.onComplete)||void 0===u||u.call(e,h.data.url);else null===(m=e.onError)||void 0===m||m.call(e,{message:v.error.message,offline:v.offline})}else Z(e.environment)}(p):O(p)}))}))))).then((()=>{var t;const o=e.files.map((e=>n[e.name]));null===(t=e.onBatchComplete)||void 0===t||t.call(e,o)})).catch((t=>{var o;"confluence"===e.uploadType&&T.a1y(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:t,fileSize:e.files[0].size},flowId:e.flowId}),null===(o=e.onBatchError)||void 0===o||o.call(e,t)}))}function F(e){const{preventLimitFreeFileSize:t,environment:o,file:n}=e,{data:r}=I.default.state;let i=!1;if(o.device.isMobileNative){const e="personal"===C.M9(o);i=!((0,v.S$)({environment:o})&&e)}return!(!t&&r&&C.Bu(r)&&!i&&n.size>z)}const N=20971520;function j(e){const{retryWhenOffline:t,backoffController:o=new b.h(void 0)}=e;O({...e,onComplete:t=>{var n;o.getFailures()>0&&S.default.logEvent("upload_offline_success_after_retries",o.getFailures()),null===(n=e.onComplete)||void 0===n||n.call(e,t)},onError:n=>{var r;if(t&&n.offline){if(S.default.checkGate("autoretry_file_uploads"))return void o.backOffOnFailure(10*m.C0).then((()=>{j({...e,backoffController:o})}));S.default.logEvent("upload_offline_failure")}null===(r=e.onError)||void 0===r||r.call(e,n)}})}async function O(e){const{environment:t,file:o,preventLimitFreeFileSize:n}=e,r=o.type||"text/plain; charset=utf-8";if(F({preventLimitFreeFileSize:n,environment:t,file:o})){e.onStart&&e.onStart(R(o));const n="secure"===e.bucket?{bucket:e.bucket,name:o.name,contentType:r,record:{table:e.record.table,id:e.record.id,spaceId:(0,p.C)(e.record.spaceId)},supportExtraHeaders:!0,contentLength:o.size}:{bucket:e.bucket,name:o.name,contentType:r,supportExtraHeaders:!0,contentLength:o.size};"secure"===e.bucket&&await w.transactionQueue.awaitRecordTransaction(e.record);const a=await M.getUploadFileUrl(t,n);if("success"===a.type){const{url:t,signedPutUrl:n,putHeaders:l}=a.data,c=s.UZ(),d=new XMLHttpRequest;d.open("PUT",n),d.setRequestHeader("Content-type",r);for(const e of l)d.setRequestHeader(e.name,e.value);d.upload.addEventListener("progress",(t=>{if(t.lengthComputable){const o=Math.round(100*t.loaded/t.total);e.onProgress&&e.onProgress({progressPercent:o,uploadedFiles:0})}})),d.onreadystatechange=function(){4===d.readyState&&(200===d.status?c.resolve({value:t}):(i.log({level:"error",from:"uploadActions",type:"ClientUploadError",data:{miscDataToConvertToString:{status:d.status,responseText:d.responseText}}}),c.resolve({error:{message:y.default.formatMessage(A.uploadFileFailed),offline:0===d.status}})))},d.send(o);const p=await c.promise;p.error?e.onError&&e.onError(p.error):e.onComplete&&(e.onComplete(t),i.log({level:"info",from:"uploadActions",type:"ClientUploadSuccess",data:{miscDataToConvertToString:{url:t}}}))}else if(e.onError){const t=(0,f.wf)(y.default.getIntl(),a);e.onError({message:t,offline:a.offline})}}else Z(e.environment)}function L(e){G({...e,onChange:t=>{if(!t.files||0===t.files.length)return;const o=Array.from(t.files);E({environment:e.environment,files:o,..."secure"===e.bucket?{bucket:e.bucket,record:e.record}:{bucket:e.bucket},onBatchStart:e.onStart,onBatchProgress:e.onProgress,onBatchComplete:e.onComplete,onBatchError:e.onError,preventLimitFreeFileSize:e.preventLimitFreeFileSize})}})}async function U(e){const t=s.UZ();return G({...e,onChange:e=>{const o=n.p4(e.files);t.resolve(o)}}),t.promise}function Z(e){P.Bw({bannerStore:x.default.state.open?k.Z:_.Z,id:"SubscriptionEditingBlocker",styleKey:h.v.Red,contentKey:"upload_limit_exceeded"})}function V(){P.qL({bannerStore:_.Z,id:"SubscriptionEditingBlocker"}),P.qL({bannerStore:k.Z,id:"SubscriptionEditingBlocker"})}const q=5,z=1e6*q,W=5;let H;const G=function(e){H&&H.remove(),H=document.createElement("input"),H.type="file",H.style.opacity="0",H.style.pointerEvents="none",H.style.position="fixed",H.style.left="-1000px",H.style.top="-1000px",H.ariaHidden="true",document.body.appendChild(H),e.multiple?H.setAttribute("multiple",""):H.removeAttribute("multiple"),e.accept&&H.setAttribute("accept",e.accept),H.addEventListener("change",(()=>{e.onChange&&e.onChange(H)})),H.addEventListener("blur",(()=>{e.onBlur&&e.onBlur(H)})),H.addEventListener("click",(e=>{e.stopPropagation()})),H.click(),H.focus({preventScroll:!0})};function K(e){return e.filter($).map((e=>e.file))}function $(e){return"local"===e.type}},1865:(e,t,o)=>{o.d(t,{y:()=>k});o(67294);var n=o(94919),r=o(47425),i=o(97880),a=o(5366),s=o(47307),l=o(33929),c=o(52533),d=o(80444),p=o(92083),u=o(78291),m=o(22616),g=o(34583),h=o(64891),f=o(70060),y=o(88893),v=o(35057),b=o(33493),S=o(39343),_=o(50906),w=o(85893);const k=async function(e,t){var o;function k(){t.dontOpenPlansOnCancel||p.Z.setState({open:!0,openedFrom:"upsell",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0})}if(_.sA6(e,{from:t.from,for_subscription_tier:t.for,addOnFeature:t.addOnFeature}),!t.addOnFeature&&(0,r.QM)(t.for))return;const x=(0,c.S$)({environment:e})&&"personal"===t.for;if(e.device.isMobileNative){if("ai"===t.addOnFeature){const t=(0,c.Y2)({environment:e})?(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.noIAPForAIWithExternalPurchaseOption",defaultMessage:"This workspace has used all of its free AI responses. Visit on desktop to purchase Notion AI and go unlimited."}):(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.noIAPForAIWithoutExternalPurchaseOption",defaultMessage:"This workspace has used all of its free AI responses. Unfortunately, additional AI responses cannot be purchased on this platform."});return void s.showErrorMessage(t)}if(!x)return}const I=d.default.state.currentSpaceStore;if(!I)return;if(!I.canAdmin())return;await g.bi(e);const C=u.default.state.data;if(!C)return;if("unsubscribed_admin"!==C.type&&"subscribed_admin"!==C.type)return void k();if(y.Q6(C)){const e=(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.referToSalesRep",defaultMessage:"This workspace is part of a managed account. Please contact your account representative to discuss any changes to your subscription."});return void s.showErrorMessage(e)}if(x)return void(e.mobileNative&&I.id&&e.mobileNative.openUpgradeModal(I.id));if("revenueCat"===(null===(o=C.customerData)||void 0===o?void 0:o.activeSubscriptionPlatform)){const e=(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.switchPlanFromInAppPurchase",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."});return void s.showErrorMessage(e)}const T=y.XX(C);if(t.addOnFeature&&(0,S.Fk)(T)){const e=(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.noAddOnPurchaseDuringFreeTrial",defaultMessage:"Unfortunately, additional {addOn, select, ai {AI responses} other {features}} cannot be purchased while a workspace is on a free trial.",values:{addOn:t.addOnFeature}});s.showErrorMessage(e)}else if(T&&y.MM(C)){if(t.addOnFeature)return void h.af({environment:e,from:t.from,view:"add_ons",addOnFeature:t.addOnFeature,billingInterval:T.interval,pageSection:t.pageSection});m.Z({environment:e,spaceId:I.id});const{status:o,prices:c}=b.Z.state;if("ready"!==o)return;const{interval:d}=T,p=c.find((e=>e.product===t.for&&e.billingInterval===d&&e.currencyCode===T.currencyCode));if(void 0===p)return;const u=function(e){let{price:t,isSubscribed:o}=e;if(t.isAddOn())return null;const s=t.product;if((0,r.QM)(s)||(0,r.iJ)(s))return null;const c={tier:s,price:(0,w.jsx)(n.W,{cost:t.getMonthlyUnitCost(),trailingZeroDisplay:"stripIfInteger",intl:l.default.intl}),br:(0,w.jsx)("br",{}),isSubscribed:o};if((0,v.Aw)())switch(s){case"personal":return(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.confirmProration.personalMessage.fromSinglePlayerPlus",defaultMessage:"You are about to subscribe to Notionâ€™s Personal Plan for {price} per member per month.{br}You will lose your current discounted price, and will be charged a prorated amount, minus any account balance.",values:c});case"plus":return(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.confirmProration.plusMessage.fromSinglePlayerPlus",defaultMessage:"You are about to subscribe to Notionâ€™s Plus Plan with no member limit for {price} per member per month.{br}You will lose your current discounted price, and will be charged a prorated amount, minus any account balance.",values:c});case"business":return(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.confirmProration.businessMessage.fromSinglePlayerPlus",defaultMessage:"You are about to subscribe to Notionâ€™s Business Plan for {price} per member per month.{br}You will lose your current discounted price, and will be charged a prorated amount, minus any account balance.",values:c});case"enterprise":return(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.confirmProration.enterpriseMessage.fromSinglePlayerPlus",defaultMessage:"You are about to subscribe to Notionâ€™s Enterprise Plan for {price} per member per month.{br}You will lose your current discounted price, and will be charged a prorated amount, minus any account balance.",values:c});default:return(0,i.t1)(s)}switch(s){case"personal":return(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.confirmProration.personalMessage",defaultMessage:"You are about to subscribe to Notionâ€™s Personal Plan for {price} per member per month.{br}{isSubscribed, select, true {You will be charged a prorated amount, minus any account balance.} other {}}",values:c});case"plus":return(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.confirmProration.plusMessage",defaultMessage:"You are about to subscribe to Notionâ€™s Plus Plan for {price} per member per month.{br}{isSubscribed, select, true {You will be charged a prorated amount, minus any account balance.} other {}}",values:c});case"business":return(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.confirmProration.businessMessage",defaultMessage:"You are about to subscribe to Notionâ€™s Business Plan for {price} per member per month.{br}{isSubscribed, select, true {You will be charged a prorated amount, minus any account balance.} other {}}",values:c});case"enterprise":return(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.confirmProration.enterpriseMessage",defaultMessage:"You are about to subscribe to Notionâ€™s Enterprise Plan for {price} per member per month.{br}{isSubscribed, select, true {You will be charged a prorated amount, minus any account balance.} other {}}",values:c});default:return(0,i.t1)(s)}}({price:p,isSubscribed:void 0===T.canceledAt});if(!(await s.confirmUserAction({message:u,acceptLabel:(0,w.jsx)(a.FormattedMessage,{id:"upsellActions.confirmProration.acceptLabel",defaultMessage:"Upgrade to {plan, select, personal {Personal} team {Plus} plus {Plus} business {Business} other {Enterprise}}",values:{plan:t.for}})})))return void k();const f=null==p?void 0:p.externalId;await g.Mg({environment:e,spaceStore:I,plan:f,from:"upsell_modal"})}else{const o=(0,f.px)(e,t.for)?"ai_fifty_percent":void 0;g.I0(e,{subscriptionTier:t.for,from:t.from,addOnFeature:t.addOnFeature,coupon:o,isTrial:t.isTrial})}}},70782:(e,t,o)=>{o.d(t,{f:()=>b,x:()=>v});var n=o(87997),r=o(15145),i=o(9852),a=o(54153),s=o(12955),l=o(87381),c=o(32223),d=o(55081),p=o(75538),u=o(80444),m=o(77080),g=o(35661),h=o(90287),f=o(97977),y=o(75018);async function v(e){const{newCurrentUserId:t,loggedOutUserId:o,environment:r}=e;await f.setLocalStorageUserId(r,t),(0,i.setSessionUserId)(t),await s.setCookie(r,{name:"notion_user_id",value:t});const u=r.currentUser.loggedInUserIds.filter((e=>e!==o)),g=await s.getGhostAdminUserId(r),y={...r,currentUser:new n.CurrentUser({id:t,loggedInUserIds:u,adminUserId:g})};if(r.updateCurrentUserId){const e={environment:r,currentUserId:t,userIds:u};"on"!==m.default.getGroup("await-update-user-id")?await r.updateCurrentUserId(e):r.updateCurrentUserId(e)}a.Z.set(l.currentUserIdKey,t),c.resetRecordSubscriptions(),p.default.reset();return await d.zJ(r)&&d.yH(y),await h.KJ(y,t),y}async function b(e){const{newCurrentUserId:t,environment:o,store:n}=e,{mainEditorCurrentBlockStore:i}=u.default.state,a=await v({environment:o,newCurrentUserId:t});if(i){const e=new g.G(a,n.pointer);u.default.setState({...u.default.state,mainEditorCurrentBlockStore:void 0}),y.navigateToBlock({environment:a,store:e,pageVisitSource:r.tY.SwitchSpace})}}},12321:(e,t,o)=>{o.d(t,{j:()=>h,w:()=>f});o(21703),o(57658);var n=o(45953),r=o(21202),i=o(15047),a=o(77858),s=o(66079),l=o(45950),c=o(5659),d=o(88310),p=o(88632),u=o(29226),m=o(54642),g=o(4408);function h(e,t){!function(){y&&p.Z.removeListener(y);u.Z.reset()}(),async function(e,t){try{const o=await c.A.measure("loadUserContent","(current user)",(()=>async function(e){const{defaultRecordCache:t,currentUser:o}=e;if(!t.persistedRecordCache)throw new Error("No local database found.");const n=o.id;if(!n)throw new Error("User is not logged in.");const r=[],c=await l.yY({environment:e,recordPointers:[{table:s.dx,id:n}],recurFn:e=>{const t=[],o=e=>{e&&(e.table!==a.zU&&e.table!==s.dx||r.push(e),t.push(e))};return e.table===s.dx?(o(e.getUserPointer()),e.getSpaceViewPointers().forEach(o)):e.table===a.zU?(e.getBookmarkedPagePointers().forEach(o),e.getSharedPagePointers().forEach(o),o(e.getSpacePointer())):e.table===i.bx&&e.getPagePointers().forEach(o),t},recordIsRequired:e=>e.table===s.dx||e.table===a.zU});for(const i of r){const e=c.getModel(i);if(c.getRole(i)&&!e)throw new Error(`Not defined: ${i.table}, ${i.id}`)}return{recordMap:c.toJson({allowVersionDowngrade:!1})}}(e))),r=n.PF.create(o.recordMap);g.fL({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:r,debugSource:"fetchLocalUserContent"}),u.Z.setState({...u.Z.state,localSpaceInaccessiblePages:b(r,t)}),u.Z.state.readyPromise.resolve()}catch(o){}}(e,t),v(e);let o=p.Z.state.online;y=()=>{const t=p.Z.state.online;!t||o||u.Z.state.remoteSpaceInaccessiblePages||v(e),o=t},p.Z.addListener(y)}async function f(){await u.Z.state.readyPromise.promise}let y;async function v(e){d.$L("await_get_spaces_start");const t=await m.getSpaces(e,{},void 0,void 0,void 0,"getSpaces");d.$L("await_get_spaces_end");const o=e.currentUser.id;if("success"===t.type)for(const[r,i]of Object.entries(t.data)){const t=n.PF.create(i);g.fL({environment:e,userId:r,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:t,debugSource:"fetchAllUserSpaces"}),r===o&&(u.Z.setState({...u.Z.state,remoteSpaceInaccessiblePages:b(t,r)}),u.Z.state.readyPromise.resolve())}}function b(e,t){const o={};for(const{pointer:n}of e.getByTable(i.bx)){const a=n.id,s=e.getValue({table:i.bx,id:a});if(s){const n=new Set;if(s.pages){for(const t of s.pages){e.getValue({table:r.iU,id:t})||n.add(t)}o[t]||(o[t]={}),o[t][a]=n}}}return o}},39634:(e,t,o)=>{o.d(t,{j:()=>_,z:()=>w});var n=o(13991),r=o(24211),i=o(7250),a=o(7928),s=o(88642),l=o(75018),c=o(24215),d=o(28020),p=o(79897),u=o(33929),m=o(5162),g=o(58455),h=o(80444),f=o(77080),y=o(78291),v=o(50906),b=o(54642),S=o(98958);function _(e){const{environment:t,from:o,prepopulatedContent:r}=e;v.Otz(t,{from:o});const a=(0,d.Fv)(),u=g.default.state;if(t.device.isMobileNative){const e=(0,d.B7)(t),o=`${t.device.os} v${t.device.mobileAppVersion}(${t.device.version})`,n="team@makenotion.com",r=`Help with my account ${null==e?void 0:e.getEmail()} on ${o}`,i=()=>{const e=encodeURIComponent(r);l.navigateToExternalURL({environment:t,url:`mailto:${n}?subject=${e}`})},a=t.mobileNative;a&&(0,m.Y)("supportsNativeSubmitUserFeedback")&&a.api.submitUserFeedback?a.submitUserFeedback({sendToEmailAddress:n,subject:r},i):i()}else if(u.isZendeskEnabled&&(0,c.Ug)()){const{userHighestPlanType:e,isSalesAssistedPlan:o}=(0,p.r)(t);(0,s.g)({locale:n.SP,analyticsSettings:u,isForethoughtEnabled:f.default.checkGate("forethought"),forethoughtInitializeArgs:w(),userHighestPlanType:e,isSalesAssistedPlan:o}),v.LSY(t)}else if(u.isIntercomEnabled){function e(){if(a&&a.id)return b.annotateRecentIntercomConversation(t,{page:a})}let o=0;const n=3,s=60;async function l(){o++;const t=await e();t&&"success"===t.type&&"not_found"===t.data.status&&o<n&&setTimeout(l,s)}i.Nv({prepopulatedContent:r,waitForCssInsets:()=>S.waitForCssInsets(t)}),setTimeout(l,1e3*s)}}function w(){var e,t,o;const n=u.default.getIntl(),i=null===(e=h.default.state.currentUserStore)||void 0===e?void 0:e.getValue(),s=i?(0,a.Nz)(n,i,!0):void 0,l=null===(t=y.default.state.data)||void 0===t?void 0:t.subscriptionTier,c=(null===(o=h.default.state.currentUserSettingsStore)||void 0===o||null===(o=o.getSettings())||void 0===o?void 0:o.preferred_locale)||r.al;return{fullName:s,email:null==i?void 0:i.email,planType:l,locale:c}}},1742:(e,t,o)=>{o.d(t,{BW:()=>g,GD:()=>m,sA:()=>h,uO:()=>y});o(57658);var n=o(68626),r=o(77897),i=o(63143),a=o(68056),s=o(77080),l=o(24666),c=o(50906);const d=15*i.C0,p={user_flow_edit_block:.005,user_flow_edit_page_title:.01,user_flow_create_block:.01,user_flow_delete_block:.01};function u(e){const t=p[e];if(void 0!==t)return(0,r.aw)(t);const o=s.default.getConfigKey("event_trail_events",e);if("object"==typeof o&&"number"==typeof o.sampleRate)return(0,r.aw)(o.sampleRate);const n=s.default.getConfigKey("event_trail_events","defaultSampleRateUserFlows");return"number"==typeof n&&(0,r.aw)(n)}class m{constructor(e){this.stage=void 0,this.timeout=void 0,this.error=void 0,this.logDataInCaseOfFailure=void 0,this.postFinishCallbacks=[],this.environment=void 0,this.userFlow=void 0,this.entryPointName=void 0,this.handleTimeout=()=>{this.fail("timeout")};const{environment:t,userFlow:o,entryPointName:n,timeoutMs:r}=e;this.environment=t,this.userFlow=o,this.entryPointName=n;e.isEnabled??u(o)?(this.stage="inProgress",this.timeout=window.setTimeout(this.handleTimeout,r??d),this.debugLog("constructed")):this.stage="disable"}isDisabled(){return"disable"===this.stage}updateLogDataInCaseOfFailure(e){this.logDataInCaseOfFailure={...this.logDataInCaseOfFailure,...e}}succeed(){"inProgress"===this.stage&&this.finish("success")}fail(e){"inProgress"===this.stage&&(this.error=e,this.finish("fail"))}finish(e){this.stage=e,this.debugLog("finish"),"number"==typeof this.timeout&&window.clearTimeout(this.timeout),this.timeout=void 0,c.rTg(this.environment,this.userFlow,{status:e,error:this.error,entryPointName:this.entryPointName}),"fail"===e&&n.log({level:"error",from:"userFlowActions",type:"userFlowFailed",data:{userFlow:this.userFlow,userFlowEntrypointName:this.entryPointName,userFlowError:this.error,...this.logDataInCaseOfFailure}});for(const t of this.postFinishCallbacks)t()}debugLog(){}}class g extends m{constructor(e){super(e),this.pointer=void 0,this.succeedOnEnqueue=void 0,this.trackCallbacks=[];const{succeedOnEnqueue:t}=e;this.succeedOnEnqueue=t}track(e,t){if("inProgress"===this.stage&&void 0===this.pointer){this.pointer=e,f({tracker:this,transaction:t,succeedOnEnqueue:this.succeedOnEnqueue});for(const e of this.trackCallbacks)e();this.debugLog("track",e.id)}}}class h extends g{constructor(e,t){super({environment:e,userFlow:"user_flow_create_page",entryPointName:t,succeedOnEnqueue:!1}),this.handleTextSelectionChange=e=>{"inProgress"===this.stage&&this.pointer&&"editing"===e.state.mode&&(0,a.qS)(e.state.multiSelection)&&e.state.multiSelection.start.store.pointer.id===this.pointer.id&&this.succeed()},"inProgress"===this.stage&&this.trackCallbacks.push((()=>{l.default.addListener(this.handleTextSelectionChange),this.postFinishCallbacks.push((()=>{l.default.removeListener(this.handleTextSelectionChange)}))}))}}function f(e){const{tracker:t,transaction:o,succeedOnEnqueue:n}=e;"inProgress"===t.stage&&(t.updateLogDataInCaseOfFailure({transactionId:o.id,transactionUserAction:o.getUserActionForAnalyticsPurposesOnly()}),o.annotateWithUserFlow(t.userFlow),o.postCancelCallbacks.push((()=>{t.fail("cancelled_transaction")})),o.postEnqueueActions.push((()=>{o.isEmpty()?t.fail("empty_transaction"):n&&t.succeed()})))}function y(e,t,o,n){if(!u(t))return;f({tracker:new m({environment:e,userFlow:t,isEnabled:!0,entryPointName:n}),transaction:o,succeedOnEnqueue:!0})}},37181:(e,t,o)=>{o.d(t,{$n:()=>k,GK:()=>S,Kq:()=>x,Nb:()=>v,Qm:()=>w,Zf:()=>f,d2:()=>h,dM:()=>_,fG:()=>g,rx:()=>y,zq:()=>b});o(57658);var n=o(79946),r=o(42875),i=o(95477),a=o(15010),s=o(95697),l=o(80444),c=o(35661),d=o(75769),p=o(50906),u=o(9953),m=o(39699);async function g(e){if(!i.default.isAdminMode)return;const{currentUserSettingsStore:t}=l.default.state;if(!t)return;await t.load();const o=t.getSettings();if(!o)return;const{device:n}=e,a={};(0,r.r)()!==o.time_zone&&(a.time_zone=(0,r.r)()),n.isDesktopBrowser&&!o.used_desktop_web_app&&(a.used_desktop_web_app=!0),n.isMobileBrowser&&!o.used_mobile_web_app&&(a.used_mobile_web_app=!0),n.isElectron&&n.isMac&&!o.used_mac_app&&(a.used_mac_app=!0),n.isElectron&&n.isWindows&&!o.used_windows_app&&(a.used_windows_app=!0),n.isMobileNative&&n.isIOS&&!o.used_ios_app&&(a.used_ios_app=!0),n.isMobileNative&&n.isAndroid&&!o.used_android_app&&(a.used_android_app=!0),Object.keys(a).length>0&&m.createAndCommit({userAction:"userSettingsActions.updateUserSettingsOnReset",environment:e,perform:e=>{h({userSettingsStore:t,data:a,transaction:e})}})}const h=function(e){const{userSettingsStore:t,data:o,transaction:n}=e;u.sW({store:t.getSettingsStore(),data:o,transaction:n})};function f(e){m.createAndCommit({userAction:"userSettingsActions.setStartWeekToMonday",environment:e,perform:e=>{const{currentUserSettingsStore:t}=l.default.state;t&&h({userSettingsStore:t,data:{start_day_of_week:1},transaction:e})}})}function y(e){m.createAndCommit({userAction:"userSettingsActions.setStartWeekToSunday",environment:e,perform:e=>{const{currentUserSettingsStore:t}=l.default.state;t&&h({userSettingsStore:t,data:{start_day_of_week:0},transaction:e})}})}function v(e){const{transaction:t,userSettingsStore:o,spaceId:n,type:r}=e;u.sO({store:(0,c._J)(o,o.pointer,["settings","sidebar_outliner_settings",n,r,"has_pinned"]),value:!0,transaction:t})}function b(e){var t;const o=null===(t=l.default.state.currentSpaceStore)||void 0===t?void 0:t.id,n=l.default.state.currentUserSettingsStore,{collectionId:r,dbType:i,transaction:a}=e;if(o&&n){var s;const e=(null===(s=n.getSettings())||void 0===s?void 0:s.lastUsedTypedCollections)||{},t=e[o]||{},l=t[i]||[],c=[r,...l.filter((e=>e!==r))].slice(0,1);h({userSettingsStore:n,transaction:a,data:{lastUsedTypedCollections:{...e,[o]:{...t,[i]:c}}}})}}function S(e){const{transaction:t,userSettingsStore:o,integrationId:n}=e;u.sO({store:(0,c._J)(o,o.pointer,["settings","dismissed_link_preview_integration_popup",n]),value:!0,transaction:t})}function _(e,t){const o=(0,n.SY)(),r=(0,n.Q3)();if(!o||!r)return;const i={};r&&(i.fbp=r),o&&(i.click_ids=o),m.createAndCommit({userAction:"userSettingsActions.persistAdClick",environment:e,perform:e=>{e.postSubmitCallbacks.push((e=>{e||((0,n.iI)(),(0,n.HR)())})),h({userSettingsStore:t,data:i,transaction:e})}})}function w(e){const t=l.default.state.currentUserSettingsStore;if(!t)return;const o=t.getKeyStore("settings").getKeyStore("seen_share_button_tooltip_at").getValue();Boolean(o)||m.createAndCommit({userAction:"dismissShareButtonTooltip",environment:e,userId:t.id,perform:e=>{h({userSettingsStore:t,data:{seen_share_button_tooltip_at:Date.now()},transaction:e})}})}function k(e){let{environment:t,teamId:o}=e;if(!d.Z.hasShownTootlip(o))return;if((0,s.wP)(t))return;const n=(0,a.WD)(t);if(!n)return!1;m.createAndCommit({userAction:"userSettingsActions.dismissTeamAddAppTemplateTooltip",environment:t,userId:n.id,perform:e=>{h({userSettingsStore:n,data:{seen_team_add_app_template_tooltip_at:Date.now()},transaction:e})}}),p.yeF(t,{from:"team_add_app_template"})}function x(e,t){const{phase:o,transactionUserAction:n,userSettingsStore:r}=t;m.createAndCommit({environment:e,userAction:n,perform:e=>{h({userSettingsStore:r,transaction:e,data:{enterprise_launch_modal_phase:o}})}})}},65452:(e,t,o)=>{o.d(t,{h:()=>h,l:()=>f});o(21703);var n=o(15157),r=o(72126),i=o(44615),a=o(29477),s=o(45953),l=o(21202),c=o(45950),d=o(5659),p=o(2688),u=o(92425),m=o(54642),g=o(4408);async function h(e){const{environment:t,userId:o,spaceId:n}=e,a=(0,i.NP)({userId:o,spaceId:n});if(!b||b!==a){let o;!function(e){v&&p.Z.removeListener(v,e)}(t);const n=(t,n)=>{void 0!==o&&o!==n&&f(e),o=n},i=r.P2(n,5e3);v=p.Z.addListener(a,i,void 0,t),b=a;if(!u.Z.getSharedPagesState(e))return f(e)}}async function f(e){const{environment:t,userId:o,spaceId:r}=e,i=u.Z.getSharedPagesState(e);if(i&&i.loadingDone)return i.loadingDone;const p=(0,a.UZ)();u.Z.setSharedPagesState({spaceId:r,userId:o,state:{currentPageIds:null==i?void 0:i.currentPageIds,loadingDone:p.promise}});try{const i=async function*(e,t,o){try{const o=await d.A.measure("loadUserSharedPages","(current user)",(()=>async function(e,t){const{id:o}=e.currentUser;if(!o)throw new Error("Must be logged in.");if(!e.defaultRecordCache.persistedRecordCache)throw new Error("No local database found.");const r=n.Z.get({userId:o,key:y({userId:o,spaceId:t.spaceId})})||void 0;if(!r)throw new Error("No local shared pages found.");const i=await c.yY({environment:e,recordPointers:r.map((e=>({table:l.iU,id:e}))),recurFn:()=>[],recordIsRequired:()=>!1});return{pages:r,recordMap:i.toJson({allowVersionDowngrade:!1})}}(e,{spaceId:t})));g.fL({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:s.PF.create(o.recordMap),debugSource:"loadUserSharedPagesInSpace"}),yield o}catch(i){}const r=await m.getUserSharedPagesInSpace(e,{spaceId:t,includeDeleted:!0},o);"success"===r.type&&(e.defaultRecordCache.persistedRecordCache&&n.Z.set({userId:e.currentUser.id,key:y({userId:o,spaceId:t}),value:r.data.pages}),yield r.data)}(t,r,o);for await(const e of i)u.Z.setSharedPagesState({spaceId:r,userId:o,state:{currentPageIds:e.pages,loadingDone:p.promise}});const a=u.Z.getSharedPagesState(e);a&&a.currentPageIds?u.Z.setSharedPagesState({spaceId:r,userId:o,state:{currentPageIds:a.currentPageIds,loadingDone:void 0}}):u.Z.setSharedPagesState({spaceId:r,userId:o,state:void 0})}catch(h){u.Z.setSharedPagesState({spaceId:r,userId:o,state:void 0})}}function y(e){return`UserSharedPagesInSpace:${e.userId}:${e.spaceId}`}let v,b},9377:(e,t,o)=>{o.d(t,{E:()=>_,j:()=>w});var n=o(74487);const r=["2021-05-11","2021-05-13","2021-08-16","2022-02-22","2022-06-28"],i=r[r.length-1];n.literals(...r);var a=o(4615),s=o(77420),l=o(19889),c=o(35794),d=o(5366),p=o(50906),u=o(33929),m=o(80444),g=o(77080),h=o(35661),f=o(54642),y=o(47307),v=o(9953),b=o(39699);const S=(0,d.defineMessages)({webhookUrlError:{id:"webhookActions.webhookUrlError",defaultMessage:"Connection failed. Please wait and try again or try another URL."}});async function _(e){const{environment:t,integration:o,webhookUrl:n,webhookSecret:r,webhookSubscriptionId:d,onError:g,onSuccess:_=(()=>{})}=e,{currentUserRootStore:w,currentSpaceStore:k}=m.default.state;if(!w||!k)return{error:{success:!1}};if("failed"===(await f.testWebhookConnection(t,{integrationId:o.id,webhookUrl:n,webhookSecret:r||void 0})).type)return y.showErrorMessage(u.default.formatMessage(S.webhookUrlError)),{error:{success:!1}};const{serverCommitResult:x}=b.createAndCommit({userAction:"webhookActions.createWebhookSubscription",environment:t,perform:u=>{u.postSubmitCallbacks=[g];const f=Date.now(),y=k.id;if(e.webhookSubscriptionId){const e=m.default.state.currentSpaceStore,i=d&&e?h.n4.createChildStore(e,{id:d,table:c.b,spaceId:e.id}):void 0;if(i){const e=i.getWebhookUrl()!==n,a=i.getWebhookSecret()!==r;(e||a)&&(p.ASv(t,{integration_id:o.id,has_updated_webhook_url:e||void 0,has_updated_webhook_secret:a||void 0}),v.sW({transaction:u,data:{webhook_url:n,webhook_secret:r},store:i}))}}else{const e=a.ZP();v.ae({environment:t,table:s.cZ,value:{id:e,space_id:y,parent_id:k.id,parent_table:"space",type:"external",alive:!0,name:o.getName(),icon:o.getInfo().icon,integration_id:o.id,capabilities:o.getCapabilities(),created_at:f,last_edited_at:f,last_edited_by_id:w.id,created_by_id:w.id,created_by_table:l.KJ,last_edited_by_table:l.KJ},inMemoryRecordCache:k.inMemoryRecordCache,transaction:u}),v.ae({environment:t,table:c.b,value:{id:a.ZP(),bot_id:e,space_id:y,parent_id:k.id,api_version:i,webhook_url:n,webhook_secret:r,parent_table:"space",last_edited_time:f,last_edited_by_id:w.id,created_by_id:w.id,created_time:f,created_by_table:l.KJ,last_edited_by_table:l.KJ},inMemoryRecordCache:k.inMemoryRecordCache,transaction:u}),p.eRW(t,{integration_id:o.id,configuration_type:"manual"})}}});return await x,_(),{value:{success:!0}}}async function w(e){const t=g.default.checkGate("webhooks_beta"),{environment:o,spaceId:n}=e;if(!o.currentUser.isLoggedIn()||!t)return{webhookSubscriptionIds:[],recordMap:{}};const r=await f.getWebhookSubscriptions(o,{spaceId:n});if("failed"===r.type)throw y.showError(r),r;return r.data}},29919:(e,t,o)=>{o.d(t,{Cq:()=>M,Y:()=>T,Zi:()=>C});var n=o(41432),r=o(45433),i=o(46328),a=o(5366),s=o(4615),l=o(71644),c=o(21202),d=o(6287),p=o(13493),u=o(70203),m=o(52821),g=o(33929),h=o(45010),f=o(35661),y=o(1310),v=o(50906),b=o(45264),S=o(47307),_=o(9953),w=o(64964),k=o(39699),x=o(68422),I=o(73060);const C=(0,a.defineMessages)({home:{id:"wikiActions.collectionView.home",defaultMessage:"Home"},allPages:{id:"wikiActions.collectionView.allPages",defaultMessage:"All pages"},pagesIOwn:{id:"wikiActions.collectionView.pagesIOwn",defaultMessage:"Pages I own"},pagePropertyName:{id:"wikiActions.collectionView.pagePropertyName",defaultMessage:"Page"},ownerPropertyName:{id:"wikiActions.collectionView.ownerPropertyName",defaultMessage:"Owner"},tagsPropertyName:{id:"wikiActions.collectionView.tagsPropertyName",defaultMessage:"Tags"},tagsDesignValue:{id:"wikiActions.collectionView.tagsDesignValue",defaultMessage:"Design"},tagsOnboardingValue:{id:"wikiActions.collectionView.tagsOnboardingValue",defaultMessage:"Onboarding"},verificationPropertyName:{id:"wikiActions.collectionView.verificationPropertyName",defaultMessage:"Verification"},undoToast:{id:"wikiActions.convertToWiki.undo.toastMessage",defaultMessage:"Turned {pageName} into a wiki"}});function T(e){const{blocks:t,transaction:o,environment:a,source:b}=e,S=(0,s.ZP)(),x=t[0];if(!x||!x.isPageBlock())return;const T=x.getSpaceId(),P=(0,s.ZP)(),A=x.getFormat().page_icon,D=(0,l.ZP)(),B=i.k.Owner,R=(0,l.ZP)(),E=(0,l.ZP)(),F={title:{name:g.default.formatMessage(C.pagePropertyName),type:"title"},[B]:{name:g.default.formatMessage(C.ownerPropertyName),type:"person",default:"created_by"},[E]:{name:g.default.formatMessage(C.tagsPropertyName),type:"multi_select",options:[{id:(0,s.ZP)(),value:g.default.formatMessage(C.tagsOnboardingValue),color:"blue"},{id:(0,s.ZP)(),value:g.default.formatMessage(C.tagsDesignValue),color:"green"}]},[D]:{name:m.SO.last_edited_time,type:"last_edited_time",date_format:"relative"}},N=[{visible:!0,property:"title",width:300},{visible:!0,property:B,width:150},{visible:!0,property:R,width:150},{visible:!0,property:E,width:150},{visible:!0,property:D,width:250}];F[R]={name:g.default.formatMessage(C.verificationPropertyName),type:"verification",verifier_property:B};const j={table:d.v,id:P,spaceId:T};k.applyOperation({store:(0,f.Kv)(x,j),operation:{pointer:j,command:"set",path:[],args:{id:P,version:0,parent_table:c.iU,parent_id:x.id,space_id:T,name:x.getTitleValue(),schema:F,cover:x.getFormat().page_cover,format:{...x.getFormat(),collection_mode:{type:"page_tree",root_page_pointer:{table:c.iU,id:x.id,spaceId:T}},app_config_uri:r.GZ,property_visibility:[{property:D,visibility:"hide"},{property:E,visibility:"show"},{property:B,visibility:"show"},{property:R,visibility:"show"}],collection_page_properties:N,collection_cover_position:x.getFormat().page_cover_position},icon:A,alive:!0}},transaction:o});const O=(0,s.ZP)(),L=(0,s.ZP)(),U=(0,s.ZP)();_.sW({store:x,data:{type:n.Ti.collectionViewPage,collection_id:P,format:{...x.getFormat(),collection_pointer:j,app_config_uri:r.FF,app_uri_map:{[r.GZ]:P},app_id:S},view_ids:[O,L,U]},transaction:o});const Z={table:p.n,id:O,spaceId:T};k.applyOperation({store:(0,f.Kv)(x,Z),operation:{pointer:Z,command:"set",path:[],args:{id:O,version:0,type:"page",name:g.default.formatMessage(C.home),parent_id:x.id,parent_table:"block",space_id:T,format:{page_pointer:{id:(0,s.Mt)(x.id),spaceId:T,table:"block"}},alive:!0}},transaction:o});const V={table:p.n,id:L,spaceId:T};k.applyOperation({store:(0,f.Kv)(x,V),operation:{pointer:V,command:"set",path:[],args:{id:L,version:0,type:"table",name:g.default.formatMessage(C.allPages),parent_id:x.id,parent_table:"block",space_id:T,format:{table_properties:N},query2:{sort:[{property:D,direction:"descending"}]},alive:!0}},transaction:o});const q={table:p.n,id:U,spaceId:T};k.applyOperation({store:(0,f.Kv)(x,q),operation:{pointer:q,command:"set",path:[],args:{id:U,version:0,type:"table",name:g.default.formatMessage(C.pagesIOwn),parent_id:x.id,parent_table:"block",space_id:T,format:{table_properties:N,property_filters:[{id:(0,s.ZP)(),filter:{filter:{value:{type:"relative",value:"me"},operator:"person_contains"},property:B}}]},query2:{sort:[{property:D,direction:"descending"}]},alive:!0}},transaction:o});const z=h.Z.PageScroller;z&&z.scrollToTop({animate:!0}),I.rm(o),v.wtf(a,{source:b,root_page_id:x.id,collection_id:P}),function(e){const{environment:t,blocks:o}=e,n=o[0];if(!n||!n.isCollectionViewPageWithContent())return;const r=(0,u.QaF)(n.getTitleValue());y.ZP.setState({...y.ZP.state,shouldReset:!1}),w.d4({item:{label:g.default.formatMessage(C.undoToast,{pageName:r}),durationMs:y.JY},undoFunc:()=>{k.createAndCommit({userAction:"wikiActions.wikiConversionToast.undo",environment:t,perform:e=>{M({environment:t,blocks:o,transaction:e,source:"snackbar"})}})}})}({environment:a,blocks:t})}function M(e){var t;const{environment:o,blocks:r,transaction:i,source:a}=e,s=r[0];if(!s||!s.isCollectionView())return void S.deprecatedShowErrorMessage("Something went wrong");const l=s.getFormat().collection_pointer;if(!l)return void S.deprecatedShowErrorMessage("Something went wrong");const c=f.NW.createChildStore(s,l),d=null===(t=s.getCover())||void 0===t?void 0:t.cover,p=c.getFormat().collection_cover_position,u=c.getName();x.vs({environment:o,block:s,blockType:n.Ti.page,transaction:i}),_.sW({store:s,data:{format:{...s.getFormat(),app_config_uri:void 0,app_uri_map:void 0,app_id:void 0,page_cover:d,page_cover_position:p},properties:{...s.getProperties(),title:u}},transaction:i}),b.A9({collectionViewBlockStore:s,collectionStore:c,transaction:i}),v.qA6(o,{source:a,root_page_id:s.id,collection_id:l.id})}},73060:(e,t,o)=>{o.d(t,{B1:()=>s,FO:()=>c,Rg:()=>l,nX:()=>p,rm:()=>d});var n=o(28182),r=o(80444),i=o(39699),a=o(37181);function s(){const{currentUserSettingsStore:e}=r.default.state;if(!e||!e.isReady())return;const t=e.getSettings();return t?t.wiki_onboarding_phase??"unseen":void 0}function l(e){const t=s();if(void 0===t)return;const o=n.dF.indexOf(t);if(-1!==o&&o<n.dF.length-1){const{currentUserSettingsStore:t}=r.default.state;if(!t)return;i.createAndCommit({userAction:"wikiOnboardingActions.advanceOnboardingStep",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:n.dF[o+1]}})}})}}function c(e){const t=s();if(void 0===t)return;const o=n.dF.indexOf(t);if(-1!==o&&o>1){const{currentUserSettingsStore:t}=r.default.state;if(!t)return;i.createAndCommit({userAction:"wikiOnboardingActions.previousOnboardingStep",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:n.dF[o-1]}})}})}}function d(e){const{currentUserSettingsStore:t}=r.default.state;t&&"unseen"===s()&&a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:"home"}})}function p(e){if("complete"===s())return;const{currentUserSettingsStore:t}=r.default.state;t&&i.createAndCommit({userAction:"wikiOnboardingActions.completeOnboarding",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:"complete"}})},userId:t.id})}},89626:(e,t,o)=>{o.d(t,{ON:()=>m,__:()=>p,h1:()=>g,lZ:()=>f,sy:()=>u,w9:()=>h});o(21703);var n=o(67294),r=o(480),i=o(49085),a=o(66673),s=o(28182),l=o(39699),c=o(37181),d=o(80444);const p=i.default.createValue(void 0);function u(){const{currentUserSettingsStore:e}=d.default.state;if(!e||!e.isReady())return;const t=e.getSettings();return t?t.ai_onboarding_phase??"space_for_ai":void 0}function m(e){"space_for_ai"===u()&&g(e)}function g(e){const t=u();if(void 0===t)throw new Error("Assertion failure, AI onboarding state is undefined!");const o=s.AQ.indexOf(t);if(-1===o)throw new Error(`Assertion failure, ${t} is not a valid AI onboarding state!`);if(o<s.AQ.length-1){const{currentUserSettingsStore:t}=d.default.state;if(!t)return;l.createAndCommit({userAction:"AiOnboardingActions.advanceAIOnboardingStage",environment:e,perform:e=>{c.d2({userSettingsStore:t,transaction:e,data:{ai_onboarding_phase:s.AQ[o+1]}})},userId:t.id})}}function h(e){const t=(0,r.O7)(),o="completionPopup"===e.type&&"results"===e.stage&&!e.loading,i=(0,a.D9)(o);(0,n.useEffect)((()=>{i&&!o&&"refine_ai_response"===u()&&g(t)}),[o,i,t])}function f(e){const t=(0,r.O7)(),o="results"===e.stage&&e.loading,i=(0,a.D9)(o);(0,n.useEffect)((()=>{o&&!i&&"ask_ai_anything"===u()&&g(t)}),[o,i,t])}},63594:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o(49085).default.createValue(!0)},84254:(e,t,o)=>{o.r(t),o.d(t,{COMPLETION_THROTTLE:()=>ge,acceptCursorCompletion:()=>Ee,cancelCompletion:()=>ze,doesPromptNeedAdditionalUserInput:()=>_e,handleCompletionPopupRetry:()=>we,improveCompletion:()=>Ae,insertBlockSelectionCompletion:()=>Le,insertTextSelectionCompletion:()=>Ne,maybeSetPromptForCurrentAiBlock:()=>Xe,openCompletionPopupForBlockSelectionContext:()=>ye,openCompletionPopupForCursorContext:()=>he,openCompletionPopupForPrefilledContext:()=>be,openCompletionPopupForSavedContext:()=>ve,postProcessAICreatedStores:()=>Oe,redoCompletionRevision:()=>Ve,replaceTextSelectionCompletion:()=>je,revertCurrentCompletionRevision:()=>qe,selectPageAndOpenCompletionPopupForBlockSelectionContext:()=>fe,showCompletionErrorWithCode:()=>Ce,stopCompletion:()=>Ue,submitFeedbackForRevision:()=>Je,triggerCompletionForAiBlock:()=>Be,updateAiEligibility:()=>Qe});o(21703),o(57658),o(30541);var n=o(26263),r=o(1302),i=o(41432),a=o(68626),s=o(42875),l=o(74229),c=o(72126),d=o(482),p=(o(27006),o(21202));o(6287),o(70279),o(15047),o(29369);function u(e){return{pointer:{table:p.iU,id:e.blockParentId},path:["content"],command:"removeChild",args:{id:e.recordId}}}var m=o(4615),g=o(82883),h=o(3791),f=o(70203),y=o(95371),v=o(97880),b=o(50906),S=o(54642),_=o(14871),w=o(47307),k=o(94419),x=o(9953),I=o(31299),C=o(24677),T=o(64964),M=o(98104),P=o(29373),A=o(39699),D=o(1865),B=o(56518),R=o(78663),E=o(99417),F=o(92595),N=o(29477),j=o(95477);let O=0;const L={debug:Boolean(j.default.isDevelopingInAirplaneMode),responseText:void 0,showErrorCode:!1,delayBetweenChunks:250,numLoremIpsums:3},U="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec porta auctor sem vel efficitur. Vivamus efficitur eros sed erat efficitur efficitur. Vivamus et augue vel est efficitur efficitur.";function Z(){return L.debug}function V(e){return{async*[Symbol.asyncIterator](){for(const t of e)await(0,N.Vs)(L.delayBetweenChunks),yield t}}}function q(e,t){const o=Math.ceil(e.length/t),n=new Array(o);for(let r=0,i=0;r<o;++r,i+=t)n[r]=e.substr(i,t);return n}const z=async(e,t)=>{console.log("Retrieving fake completion for data",t);const{context:o}=t,n=o.selectedText,r=[];let{responseText:i}=L;if("clipboard"===i&&(i=await async function(){try{return await navigator.clipboard.readText()}catch(e){return}}()??"Unable to retrieve clipboard text."),void 0===i&&(r.push({type:"success",completion:"\n",inferenceId:"mock"},{type:"success",completion:"this is ",inferenceId:"mock"},{type:"success",completion:"fake ",inferenceId:"mock"},{type:"success",completion:`streaming response ${O++}.`,inferenceId:"mock"}),j.default.isDevelopingInAirplaneMode&&r.push({type:"success",completion:"\n\nTo see a real AI response, run the server with `--airplaneMode=false`.",inferenceId:"mock"}),"string"==typeof n)){r.push({type:"success",completion:"\n\nHere is the text you selected:\n\n",inferenceId:"mock"});for(const e of q(n,10))r.push({type:"success",completion:e,inferenceId:"mock"})}if(L.showErrorCode)r.push({type:"error",message:"alas",errorCode:L.showErrorCode});else if(void 0===i)for(let s=0;s<L.numLoremIpsums;s++)r.push(...(a=[`\n\n${s+1}. `,...q(U,0===L.delayBetweenChunks?U.length:50)],a.map((e=>({type:"success",completion:e,inferenceId:"mock"})))));else i.length>0&&r.push({type:"success",completion:i,inferenceId:"mock"});var a;return Promise.resolve({type:"success",data:V(r),status:200,headers:{}})};(0,F.exposeDebugValue)("completionDebugSettings",L);var W=o(43455),H=o(33929),G=o(45162),K=o(67669),$=o(65598),Y=o(77546),Q=o(69645),J=o(73959),X=o(89224),ee=o(89086),te=o(77907),oe=o(95802),ne=o(80444),re=o(16772),ie=o(77080),ae=o(35661),se=o(27724),le=o(35057),ce=o(28956),de=o(92022),pe=o(71184),ue=o(63594),me=o(30793);const ge=300;async function he(e){const{environment:t,prompt:o=E.NX,additionalContext:n,from:r}=e,i=(0,R.FD)();i&&await Se({environment:t,prompt:o,context:i,additionalContext:n,from:r})}async function fe(e){const t=C.aw(C.KX()),o=(0,G.W9)(t);if(!o)return;M.NA({multiSelection:o});const n=(0,R.Fu)();if(!n)return;const r={type:"closedWithContext",context:n,futureRevisions:[]};re.default.setState(r),await ve(e)}async function ye(e){const{environment:t,prompt:o=E.NX,additionalContext:n,from:r}=e,i=(0,R.Xc)();i&&await Se({environment:t,prompt:o,context:i,additionalContext:n,from:r})}async function ve(e){"closedWithContext"===re.default.state.type&&re.default.state.context&&await Se({...e,context:re.default.state.context})}async function be(e){await Se(e)}async function Se(e){const{environment:t,prompt:o,context:i,additionalContext:a,skipInitialForm:s,from:l}=e,c=re.default.getExistingSessionId(),d=c??(0,m.ZP)();if(_e({clientPrompt:o,additionalContext:a})&&!s)return void(0,de.hr)({environment:t,from:l,prefilledValue:(0,R.$W)(o),promptForAnalytics:o,sessionId:d,context:i});Boolean(c)||b.Tlp(t,{session_id:d,prompt_key:o.key,from:l}),M.ZH(t),await async function(e){const{environment:t,context:o,prompt:i,additionalContext:a,updater:s,sessionId:l,from:c}=e;"textSelection"===o.type&&s((()=>{M.ZH(t),C.ZH(t)}));const d=await te.deps.markdownLinkifyIt.loader(),{serverPrompt:p}=ke({...e,markdownLinkifyIt:d}),u=new n.Z({name:"completionActions.triggerCompletion",isTemporaryData:!0});s((()=>{t.defaultRecordCache.inMemoryRecordCache.addCacheOverride(u)}));const m=re.default.state,g="completionPopup"===m.type&&"initialPrompt"===m.stage||"closedWithContext"===m.type?m.futureRevisions:[],h={type:"completionPopup",stage:"results",loading:!0,sessionId:l,revisions:[...g,{type:"initial",clientPrompt:i,serverPrompt:p,additionalContext:a,userSearchCache:new Map,completion:void 0,hasFeedback:!1}],futureRevisions:[],context:o,inMemoryRecordCache:u,from:c,hasErrored:!1};s((()=>{re.default.setState(h)})),await r.default.afterNextFlush(),await s((()=>Re({environment:t}))),await xe({...e,updater:s})}({environment:t,context:i,prompt:o,intl:H.default.getIntl(),updater:re.default.createUpdater(),additionalContext:a,sessionId:d,from:l})}function _e(e){const{clientPrompt:t,additionalContext:o}=e,n="translate"===t.key&&o&&o.language,r="changeTone"===t.key&&o&&o.tone;return Boolean(!n&&!r&&t.steps)}async function we(e){const{environment:t}=e,o=re.default.state;if("completionPopup"===o.type&&"results"===o.stage)if(M.ZH(t),_e((0,E.Iz)(o)));else{const e=(0,E.Iz)(o);re.default.setState({...o,revisions:[...o.revisions,{type:"initial",clientPrompt:e.clientPrompt,serverPrompt:e.serverPrompt,additionalContext:e.additionalContext,userSearchCache:new Map,completion:void 0,hasFeedback:!1}]}),await xe({environment:t,updater:re.default.createUpdater()})}}function ke(e){const{environment:t,context:o,prompt:n,additionalContext:r,intl:i,markdownLinkifyIt:a}=e,l=(0,g.X)({intl:i,textValue:o.currentPage.getBlockTitleStore().getValue(),getRecordModel:o.currentPage.getRecordModel,userTimeZone:(0,s.r)()}),{previousContent:d,restContent:p,pageContent:u}=function(e){var t,o;const{environment:n,context:r,markdownLinkifyIt:i}=e,a=r.currentPage.getContentStores()[0];let s,l;if("cursor"===r.type||"textSelection"===r.type)s=r.textSelection.start,l=r.textSelection.end;else{var c;s={store:r.stores[0].getBlockTitleStore(),index:0};const e=r.stores[r.stores.length-1].getBlockTitleStore();l={store:e,index:(null===(c=(0,ee.x0)(e))||void 0===c?void 0:c.endIndex)||0}}const d=He(r.currentPage),p=_.wc({environment:n,textSelection:{start:{store:a.getBlockTitleStore(),index:0},end:l},markdownSerializationOptions:(0,W.KF)(),markdownLinkifyIt:i}),u=[d,p].filter(v.$K).join("\n\n"),m=(0,Q.Bj)({includeNonSelectableListContainer:!1}),g=null===(t=(0,y.CY)(m).value)||void 0===t?void 0:t.store,h=null==g?void 0:g.getBlockTitleStore(),f=h&&_.wc({environment:n,textSelection:{start:s,end:{store:h,index:(null===(o=(0,ee.x0)(h))||void 0===o?void 0:o.endIndex)||0}},markdownSerializationOptions:(0,W.KF)(),markdownLinkifyIt:i})||"",b=Ge({environment:n,page:r.currentPage,markdownLinkifyIt:i})||"";return{previousContent:u,restContent:f,pageContent:b}}({environment:t,context:o,markdownLinkifyIt:a});let m,h;if("textSelection"===o.type||"blockSelection"===o.type){if("textSelection"===o.type)h=_.wc({environment:t,textSelection:o.textSelection,markdownSerializationOptions:(0,W.KF)(),markdownLinkifyIt:a})??"";else if("blockSelection"===o.type){const e=c.oA(se.default.state.stores.map((e=>e.getValue())));h=(0,B.X4)({rootBlock:{...o.currentPage.pointer,spaceId:o.currentPage.getSpaceId()},blockValues:e,isWindows:t.device.isWindows,getRecordValue:o.currentPage.getRecordValue,markdownSerializationOptions:(0,W.KF)(),markdownLinkifyIt:a}).markdown||""}else(0,v.t1)(o);m=Ke({prompt:n,selectedText:h,pageTitle:l,pageContent:u,additionalContext:r}),m||(m=Ye({prompt:n,pageTitle:l,previousContent:d,restContent:p,pageContent:u,additionalContext:r}))}else"cursor"===o.type?(m=Ye({prompt:n,pageTitle:l,previousContent:d,restContent:p,pageContent:u,additionalContext:r}),m||(m=Ke({prompt:n,selectedText:u,pageTitle:l,additionalContext:r,pageContent:u}))):(0,v.t1)(o);if(!m)throw new Error(`Unable to find server prompt for "${n.key}" client prompt`);const f={type:"initial",pageTitle:l,selectedText:h,pageContent:u};return{serverPrompt:m.serverPrompt,initialStep:f,humanStep:m.humanStep}}async function xe(e){const{environment:t,updater:o}=e,n=re.default.state;if("completionPopup"!==n.type||"results"!==n.stage)return;const{sessionId:r}=n,i=Date.now(),a=(0,m.ZP)(),s=(0,E.Iz)(n);if(n.revisions[n.revisions.length-1]!==s)throw new Error("Assertion failure, expected current revision to be initial revision");const d={...s,inferenceId:a},p=n.revisions.slice(0,n.revisions.length-1),{serverPrompt:u}=d;b.g_f(t,{session_id:r,inference_id:a,from:n.from,prompt_key:d.clientPrompt.key,type:"completion"}),o((()=>{re.default.setState({...n,loading:!0,revisions:[...p,d]})}));let g=!1;const h=c.P2((async()=>{g||await o((()=>Re({environment:t,setSelection:!1})))}),ge),f=async function(e,t,o){if(!ie.default.checkGate("ai_favorites"))return;const{currentSpaceStore:n}=ne.default.getState();if(!n)return;if(!t.trim())return;const r=await S.getCompletion(e,{id:(0,m.ZP)(),aiSessionId:o,context:{type:"promptTitle",selectedText:t},model:(0,E.PD)(),metadata:{},spaceId:n.id,isSpacePermission:!1});if("success"!==r.type)return;const i=[];if(l.H1.is(r.data))for await(const s of r.data){if("success"!==s.type)return;i.push(s.completion)}const a=i.join("").trim();return a||void 0}(t,(0,E.gY)(s),r),y=Te({environment:t,inferenceId:a,aiSessionId:r,serverPrompt:u,targetStore:n.context.currentPage,inferenceReason:"writer",attribution:{blockId:n.context.currentPage.id},metadata:{blockId:n.context.currentPage.id},onUpdate(e){let{completion:t,userSearchCache:n}=e;o((()=>{const e=re.default.state;"completionPopup"===e.type&&"results"===e.stage&&(re.default.setState({...e,revisions:[...p,{...d,completion:t,userSearchCache:n}]}),h())}))}}),[v,_]=await Promise.all([f,y]);if("error_modal_shown"===_.type||"upsell_modal_shown"===_.type)return void o((()=>Ze()));g=!0;const{completion:w,userSearchCache:k}=_;await o((()=>{b.WP(t,{session_id:r,inference_id:a,preview_time:Date.now()-i,type:"completion"});const e=re.default.state;if("completionPopup"===e.type&&"results"===e.stage)return re.default.setState({...e,revisions:[...p,{...d,completion:w,userSearchCache:k,promptTitle:v}],loading:!1}),Re({environment:t,setSelection:!0})}))}function Ie(e){const{environment:t,inMemoryRecordCache:o,completion:n,userSearchCache:r,store:i,prompt:a,additionalContext:s,isComplete:l,markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:p}=e;A.createAndCommit({userAction:"completionActions.updateAiBlockForCompletion",environment:t,perform:e=>{const m=i.clone(o);m.getContentIds().forEach((t=>{A.applyOperation({store:m,operation:u({blockParentId:m.id,recordId:t}),transaction:e})}));const g=_.Mt({environment:t,text:n,inMemoryRecordCache:o,transaction:e,markdownOptions:(0,W.N9)(r),markdownLinkifyIt:c,tinyMceMicrosoftWordPasteFilter:p});if(!g)return;const h=m.getContentStore();g.reverse().forEach((t=>{k.Ce({parent:h,prepend:t,transaction:e}),x.sW({store:t,data:{parent_id:m.id,parent_table:m.table,alive:!0},transaction:e})})),A.applyOperation({store:m,operation:d.op.update({pointer:m.pointer,path:["format"],args:{ai_last_edited:Date.now(),ai_prompt_key:a.key}}),transaction:e});const y=s?(0,f.TPx)(s.prompt):[];A.applyOperation({store:m,operation:d.op.set({pointer:m.pointer,path:["properties","title"],args:y}),transaction:e}),l&&$e({transaction:e,completionState:{clientPrompt:a,additionalContext:s}})}})}function Ce(e){const t=H.default.getIntl();return 451===e?T.oV({label:t.formatMessage({id:"completionActions.moderationError",defaultMessage:"AI does not allow content that is harmful or illegal. Please revise your input and try again. (451)"})}):502===e||503===e||504===e?T.oV({label:t.formatMessage({id:"completionActions.providerError",defaultMessage:"Weâ€™re experiencing issues with our AI provider. Try again in a few minutes. ({errorCode})"},{errorCode:e})}):void T.oV({label:t.formatMessage({id:"completionActions.genericError",defaultMessage:"AI is temporarily unavailable. Try again in a few minutes. ({errorCode})"},{errorCode:e})})}async function Te(e){var t;const{environment:o,inferenceId:n,serverPrompt:r,targetStore:i,onUpdate:s,aiSessionId:c,metadata:d,attribution:p,inferenceReason:u}=e,m=Z()?z:S.getCompletion,g=null===(t=ne.default.state.currentSpaceStore)||void 0===t?void 0:t.id,f=(0,K.UK)(i);if(!g)return Ce(1001),{type:"error_modal_shown"};const y="summarizeMeetingTranscript"===r.type?"anthropic-2":(0,E.PD)(),v=await m(o,{id:n,context:r,model:y,spaceId:g,isSpacePermission:f,aiSessionId:c,metadata:d,attributionForLogging:p,inferenceReason:u});if("success"!==v.type)return w.showError(v),{type:"error_modal_shown"};let _="",k="";const x=new Map,C=e=>I.Yu({environment:o,query:e,membersOnly:!0});if(l.H1.is(v.data))for await(const a of v.data)if("success"===a.type)_+=a.completion,(0,W.Ie)(_)||(k=Me(_),await(0,W.$A)(_,C,x)),s({completion:k,userSearchCache:new Map(x)});else if("error"===a.type)return(0,h.lX)(a.errorCode)?(D.y(o,{from:"ai_limit_in_app",for:(0,le.zt)(),addOnFeature:"ai"}),{type:"upsell_modal_shown"}):(Ce(a.errorCode),{type:"error_modal_shown"});const T=Me(_);return T?(await(0,W.$A)(T,C,x),{type:"success",completion:T,userSearchCache:new Map(x)}):(Ce(600),a.log({level:"error",from:"completionActions.getCompletionWithPostProcessing",type:"emptyResponse",data:{inferenceId:n}}),b.UD4(o,{promptKey:r.type}),{type:"error_modal_shown"})}function Me(e){return e.replace(/<br>/g,"\n")}function Pe(e){const{improvement:t}=e;return"continueWriting"===t.type?{type:"human",prompt:"Continue writing"}:"makeLonger"===t.type?{type:"human",prompt:"Make longer"}:"helpMeEdit"===t.type?{type:"human",prompt:t.prompt}:void(0,v.t1)(t.type)}async function Ae(e,t){const o=re.default.state;if("completionPopup"!==o.type||"results"!==o.stage)return;let n=!1;const r=re.default.createUpdater(),i=(0,E.xM)(o);if(!i.completion)return;const a=o.context,s=i.completion,l="continueWriting"===t.type?s:"",d=Date.now(),p=(0,m.ZP)();b.g_f(e,{session_id:o.sessionId,inference_id:p,from:o.from,prompt_key:(0,E.Iz)(o).clientPrompt.key,improvement_prompt_type:t.type,type:"follow_up_improvement"});const u=[...o.revisions,...o.futureRevisions],g={type:"followup",improvement:t,completion:l,userSearchCache:new Map,inferenceId:p,hasFeedback:!1,previousRevision:(0,E.HS)(o)},h={...o,loading:!0,revisions:[...u,g],futureRevisions:[]},f=await te.deps.markdownLinkifyIt.loader(),y=function(e){const{environment:t,completionState:o,markdownLinkifyIt:n}=e,{context:r}=o,i=[];for(const a of(0,E.zU)(o))if("initial"===a.type){const{initialStep:e,humanStep:o}=ke({environment:t,context:r,prompt:a.clientPrompt,additionalContext:a.additionalContext,intl:H.default.getIntl(),markdownLinkifyIt:n});if(void 0===a.completion)throw new Error("Assertion failure, followup without initial completion");i.unshift(e,o,{type:"assistant",result:a.completion})}else if("followup"===a.type){const e=[Pe({improvement:a.improvement})];a.completion&&e.push({type:"assistant",result:a.completion}),i.unshift(...e)}else(0,v.t1)(a);Z()&&console.log("Transcript",JSON.stringify(i,null,2));return{type:"writerFollowup",transcript:i}}({environment:e,completionState:h,markdownLinkifyIt:f});r((()=>{re.default.setState(h)}));const S=c.P2((async()=>{n||await r((()=>Re({environment:e,setSelection:!1})))}),ge),_=await Te({environment:e,inferenceId:p,serverPrompt:y,targetStore:a.currentPage,aiSessionId:o.sessionId,inferenceReason:"writer",attribution:{blockId:o.context.currentPage.id},metadata:{blockId:a.currentPage.id},onUpdate(e){let{completion:t,userSearchCache:o}=e;r((()=>{const e=re.default.state;"completionPopup"===e.type&&"results"===e.stage&&(re.default.setState({...e,revisions:[...u,{...g,completion:l+t,userSearchCache:o}]}),S())}))}});if("error_modal_shown"===_.type||"upsell_modal_shown"===_.type)return void r((()=>Ze()));n=!0;const{completion:w,userSearchCache:k}=_;r((()=>{b.WP(e,{session_id:h.sessionId,inference_id:p,preview_time:Date.now()-d,type:"follow_up_improvement"}),re.default.setState({...h,loading:!1,revisions:[...u,{...g,completion:l+w,userSearchCache:k}]}),Re({environment:e,setSelection:!0})}))}const De=(0,v.AO)((e=>e instanceof ae.G?{true:e}:{false:e}));async function Be(e){const{environment:t,store:o,prompt:r,additionalContext:i}=e,a=o.getRecordStoreUIRoot();if(!De(a))return;const l=await te.deps.markdownLinkifyIt.loader(),d=function(e){const{environment:t,rootStore:o,store:n,prompt:r,additionalContext:i,markdownLinkifyIt:a}=e,l=H.default.getIntl(),c=(0,g.X)({intl:l,textValue:o.getBlockTitleStore().getValue(),getRecordModel:o.getRecordModel,userTimeZone:(0,s.r)()}),d=Ge({environment:t,page:o,markdownLinkifyIt:a})||"";if("summarizeMeetingTranscript"===r.key)return{type:"summarizeMeetingTranscript",pageTitle:c,pageContent:d};if("helpMeWrite"===r.key){var p,u,m,h,f;const e={type:"helpMeWrite",pageTitle:c,pageContent:d,prompt:(null==i?void 0:i.prompt)??""},r=(0,Q.dq)({includeNonSelectableListContainer:!1,root:n.getHighestContentBlockUIAncestor()});if(!r)return e;const s=(0,Q.v5)(n,r.children);if(!s)return e;const l=o.getContentStores()[0],g=(0,y.YL)(r,s),b=g.prev?g.prev.value.store.getBlockTitleStore():null===(p=g.parent)||void 0===p?void 0:p.value.store.getBlockTitleStore(),S=l&&b&&_.wc({environment:t,textSelection:{start:{store:l.getBlockTitleStore(),index:0},end:{store:b,index:(null===(u=(0,ee.x0)(b))||void 0===u?void 0:u.endIndex)??0}},markdownSerializationOptions:(0,W.KF)(),markdownLinkifyIt:a})||"",w=[He(o),S].filter(v.$K).join("\n\n"),k=null===(m=(0,y.Xf)(r,s).next)||void 0===m?void 0:m.value.store.getBlockTitleStore(),x=null===(h=(0,y.CY)(r).value)||void 0===h?void 0:h.store,I=null==x?void 0:x.getBlockTitleStore();return{type:"helpMeWrite",pageTitle:c,previousContent:w,restContent:k&&I&&_.wc({environment:t,textSelection:{start:{store:k,index:0},end:{store:I,index:(null===(f=(0,ee.x0)(I))||void 0===f?void 0:f.endIndex)||0}},markdownSerializationOptions:(0,W.KF)(),markdownLinkifyIt:a})||"",prompt:(null==i?void 0:i.prompt)??""}}return"summarize"===r.key||"findActionItems"===r.key?{type:r.key,pageTitle:c,selectedText:d}:void 0}({environment:t,rootStore:a,store:o,prompt:r,additionalContext:i,markdownLinkifyIt:l});if(!d)return;const p=c.P2(Ie,ge),u=new n.Z({name:"completionActions.triggerCompletionForAiBlock",isTemporaryData:!0});t.defaultRecordCache.inMemoryRecordCache.addCacheOverride(u);const h=await te.deps.tinyMceMicrosoftWordPasteFilter.loader(),f=await Te({environment:t,inferenceId:(0,m.ZP)(),serverPrompt:d,targetStore:a,aiSessionId:(0,m.ZP)(),metadata:{blockId:a.id},inferenceReason:"writer",attribution:{blockId:a.id},onUpdate(e){let{completion:n,userSearchCache:a}=e;p({inMemoryRecordCache:u,environment:t,store:o,completion:n,userSearchCache:a,prompt:r,additionalContext:i,isComplete:!1,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:h})}});if(t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(u),"error_modal_shown"===f.type||"upsell_modal_shown"===f.type)return;const{completion:b,userSearchCache:S}=f;Ie({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,store:o,completion:b,userSearchCache:S,prompt:r,additionalContext:i,isComplete:!0,markdownLinkifyIt:l,tinyMceMicrosoftWordPasteFilter:h})}async function Re(e){const{environment:t,setSelection:o}=e,n=re.default.state;if("completionPopup"!==n.type||"results"!==n.stage)return;const i=(0,E.xM)(n),{completion:a,userSearchCache:s}=i,{context:l,inMemoryRecordCache:d}=n;if("cursor"!==l.type)return;d.clearCache();const{currentBlock:p,currentParent:u,currentPage:m}=l,g=u||m.getContentStore(),{insertTitle:h,insertCompletion:y}=Fe({completion:a||"",currentPage:m});h&&A.createAndCommit({userAction:"completionActions.temporaryInsertion.insertTitle",environment:t,canUndo:!1,perform:e=>{var t;const o=null===(t=m.getTitleStore())||void 0===t?void 0:t.clone(d);o&&x.sO({store:o,value:(0,f.TPx)(h),transaction:e})}});const[v,b]=await Promise.all([te.deps.markdownLinkifyIt.loader(),te.deps.tinyMceMicrosoftWordPasteFilter.loader()]);if(y){const e=A.createAndCommit({userAction:"completionActions.temporaryInsertion.insertCompletion",environment:t,canUndo:!1,perform:e=>{if(!y)return;const o=_.Mt({environment:t,text:y,inMemoryRecordCache:d,transaction:e,markdownOptions:(0,W.N9)(s),markdownLinkifyIt:v,tinyMceMicrosoftWordPasteFilter:b});if(!o)return;Oe(t,o);We({parentStore:g.clone(d),insertAfter:null==p?void 0:p.clone(d),insertStores:o,transaction:e});return o.map((e=>e.clone(t.defaultRecordCache.inMemoryRecordCache))).map((e=>e.cloneWithNewUIParent(g)))}}).performResult;if(!e||!e.length)return;o&&C.Z5({environment:t,stores:e}),await r.default.afterNextFlush();const n=re.default.state;if("completionPopup"!==n.type||"results"!==n.stage)return;const i=c.oA(e.map((e=>oe.C.findNodeFromStore(e))));if(!(i[0]?(0,Y.VW)(i[0]):void 0))return;re.default.setState({...n,context:{...n.context,origin:c.Z$(e)}})}else if(p){const e=(0,E.Ah)(p),r=new DOMRect(null==e?void 0:e.x,null==e?void 0:e.y,null==e?void 0:e.width,0);A.createAndCommit({userAction:"completionActions.temporaryInsertion.insertCompletionStores",environment:t,canUndo:!1,perform:e=>{We({parentStore:g.clone(d),insertAfter:p.clone(d),insertStores:[],transaction:e})}}),o&&C.ZH(t),p.getAlive()?re.default.setState({...n,context:{...l,origin:p}}):re.default.setState({...n,context:{...l,origin:r}})}}function Ee(e){const{environment:t,transaction:o,selectInsertion:n,exitType:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c=re.default.state;if(re.default.invalidateLastUpdater(),"completionPopup"!==c.type||"results"!==c.stage||"cursor"!==c.context.type)return;const{completion:p,userSearchCache:u,inferenceId:m}=(0,E.xM)(c);if(!p)return;const{currentBlock:g,currentParent:h,currentPage:y}=c.context,v=h||y.getContentStore();re.default.resetStore(e);const{insertTitle:S,insertCompletion:w}=Fe({completion:p,currentPage:y});S&&"convert_to_ai_block"!==a&&x.sO({store:y.getBlockTitleStore(),value:(0,f.TPx)(S),transaction:o});const I=_.Mt({environment:t,text:w,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:o,markdownOptions:(0,W.N9)(u),markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l});if(I){if(g&&"convert_to_ai_block"===a){var T,P;const e=x.j4({environment:t,type:i.Ti.aiBlock,inMemoryRecordCache:g.inMemoryRecordCache,transaction:o,spaceId:g.pointer.spaceId,useCrdt:(null===(T=(0,J.sQ)(v))||void 0===T?void 0:T.useCrdt())??!1});k.BE({parent:v,after:g,insert:e,transaction:o}),(0,$.PF)(g)&&k.Od({parent:v,childToRemove:g,transaction:o});const n=(0,E.xM)(c);if("initial"!==n.type)throw new Error("Assertion failure, currentRevision.type is not initial");const r=null===(P=n.additionalContext)||void 0===P?void 0:P.prompt;r&&A.applyOperation({store:e,operation:d.op.set({pointer:e.pointer,path:["properties","title"],args:[[r]]}),transaction:o}),A.applyOperation({store:e,operation:d.op.update({pointer:e.pointer,path:["format"],args:{ai_last_edited:Date.now(),ai_prompt_key:n.clientPrompt.key}}),transaction:o}),We({parentStore:e.getContentStore(),insertAfter:void 0,insertStores:I,transaction:o})}else We({parentStore:v,insertAfter:g,insertStores:I,transaction:o}),function(e){const{environment:t,parentStore:o,insertStores:n,selectInsertion:i}=e,a=n.map((e=>e.cloneWithNewUIParent(o)));r.default.afterNextFlush((()=>{C.yu({environment:t,stores:a}),i&&function(e){const{environment:t,insertedStores:o}=e;X.clear(t),r.default.afterNextFlush((()=>{const e=(0,G.W9)(o);e&&M.NA({multiSelection:e})}))}({environment:t,insertedStores:a})}))}({environment:t,parentStore:v,insertStores:I,selectInsertion:n});$e({transaction:o,completionState:(0,E.Iz)(c)}),m&&b.NF$(t,{type:"cursor_completion",inference_id:m,feedback_type:"accept",timestamp:(new Date).toUTCString()})}}function Fe(e){const{completion:t,currentPage:o}=e;let n,r;const i=Boolean(o.getBlockTitleStore().getValue()),a=o.getContentStores().every((e=>{var t;return!(null!==(t=e.getTitleStore())&&void 0!==t&&t.getValue())}));if(!i&&a){const{title:e,content:o}=function(e){const t=e.trim().split("\n"),o=t[0];return o.startsWith("# ")?{title:o.substring(2),content:t.slice(1).join("\n")}:{title:"",content:e}}(t||"");n=e,r=o}else r=t;return{insertTitle:n,insertCompletion:r}}function Ne(e){var t,o;const{environment:n,transaction:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}=e,s=re.default.state;if(re.default.invalidateLastUpdater(),"completionPopup"!==s.type||"results"!==s.stage||"textSelection"!==s.context.type)return;const{completion:l,userSearchCache:d}=(0,E.xM)(s);if(!l)return;const{endBlock:p,endBlockParent:u,currentPage:m}=s.context,g=u||m.getContentStore();re.default.resetStore(e);const h=_.Mt({environment:n,text:l,inMemoryRecordCache:n.defaultRecordCache.inMemoryRecordCache,transaction:r,markdownOptions:(0,W.N9)(d),markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a});if(!h)return;We({parentStore:g,insertAfter:p,insertStores:h,transaction:r}),$e({transaction:r,completionState:(0,E.Iz)(s)});const y=h.map((e=>e.cloneWithNewUIParent(g))),v=null===(t=c.Ps(y))||void 0===t?void 0:t.getBlockTitleStore(),b=null===(o=c.Z$(y))||void 0===o?void 0:o.getBlockTitleStore();v&&b&&M.NA({multiSelection:{start:{index:0,store:v},end:{index:b.getValue()?f.QaF(b.getValue()).length:0,store:b}}})}function je(e){const{environment:t,transaction:o,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:r}=e,i=re.default.state;if(re.default.invalidateLastUpdater(),"completionPopup"!==i.type||"results"!==i.stage||"textSelection"!==i.context.type)return;const a=(0,E.xM)(i);a.completion&&(M.NA({multiSelection:i.context.textSelection}),_.R$({environment:t,text:a.completion,transaction:o,disableEmbedMenu:!0,overwrite:!0,selectAll:!0,markdownOptions:(0,W.N9)(a.userSearchCache),markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:r}),$e({transaction:o,completionState:(0,E.Iz)(i)}),re.default.resetStore(e))}function Oe(e,t){for(const o of t)P.X_(e,o)}function Le(e){const{environment:t,transaction:o,replace:n,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:i}=e,a=re.default.state;if(re.default.invalidateLastUpdater(),"completionPopup"!==a.type||"results"!==a.stage||"blockSelection"!==a.context.type)return;const{completion:s,userSearchCache:l}=(0,E.xM)(a);if(!s)return;const{stores:d}=a.context,p=c.Z$(d);if(!p)return;const u=p.getRecordStoreUIParent();if(!u)return;re.default.resetStore(e);const m=_.Mt({environment:t,text:s,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:o,markdownOptions:(0,W.N9)(l),markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:i});if(!m)return;if(We({parentStore:u,insertAfter:p,insertStores:m,transaction:o}),n)for(const c of d){const e=c.getRecordStoreUIParent();e&&k.Od({parent:e,childToRemove:c,transaction:o})}$e({transaction:o,completionState:(0,E.Iz)(a)});const g=m.map((e=>e.cloneWithNewUIParent(u)));C.Z5({environment:t,stores:g})}function Ue(e){const t=re.default.state;if("completionPopup"!==t.type||"results"!==t.stage||!t.loading)return;const o=(0,E.xM)(t);o.completion&&(b.zim(e,{session_id:t.sessionId,inference_id:o.inferenceId}),re.default.invalidateLastUpdater(),re.default.setState({...t,loading:!1}),Re({environment:e,setSelection:!0}))}function Ze(){const e=re.default.state;"completionPopup"===e.type&&"results"===e.stage&&re.default.setState({...e,hasErrored:!0})}function Ve(e){const t=re.default.state;"completionPopup"===t.type&&"results"===t.stage&&0!==t.futureRevisions.length&&(re.default.invalidateLastUpdater(),re.default.setState({...t,hasErrored:!1,loading:!1,revisions:[...t.revisions,t.futureRevisions[0]],futureRevisions:t.futureRevisions.slice(1)}),Re({environment:e,setSelection:!0}))}function qe(e){const{environment:t,purgeFromHistory:o}=e,n=re.default.state;if("completionPopup"!==n.type||"results"!==n.stage||0===n.revisions.length)return;const r=n.revisions[n.revisions.length-1];return re.default.invalidateLastUpdater(),re.default.setState({...n,hasErrored:!1,loading:!1,revisions:n.revisions.slice(0,-1),futureRevisions:o?n.futureRevisions:[r,...n.futureRevisions]}),Re({environment:t,setSelection:!0}),r}function ze(e){re.default.invalidateLastUpdater();const{environment:t,sessionId:o,inferenceId:n,exitType:r}=e,i=re.default.state;if("completionPopup"!==i.type||"initialPromptForAIBlock"===i.stage)return;if((!t.device.isMobileNative||"error_modal"!==r&&"upsell_modal"!==r)&&("cursor"===i.context.type||"textSelection"===i.context.type?M.NA({multiSelection:i.context.textSelection}):"blockSelection"===i.context.type?C.Z5({environment:t,stores:i.context.stores}):(0,v.t1)(i.context)),re.default.resetStore(e),b.HCf(t,{session_id:o,inference_id:n,exit_type:r}),"results"!==i.stage)return;const a=(0,E.xM)(i);a.inferenceId&&b.NF$(t,{type:"cursor_completion",inference_id:a.inferenceId,feedback_type:"cancel",timestamp:(new Date).toUTCString()})}function We(e){const{parentStore:t,insertAfter:o,insertStores:n,transaction:r}=e,i=c.d9(n).reverse();for(const a of i)o?k.BE({parent:t,insert:a,after:o,transaction:r}):k.Ce({parent:t,prepend:a,transaction:r}),x.sW({store:a,data:{parent_id:t.id,parent_table:t.table,alive:!0},transaction:r});o&&(0,$.PF)(o)&&k.Od({parent:t,childToRemove:o,transaction:r})}function He(e){return _.jm({rootBlock:{...e.pointer,spaceId:e.getSpaceId()},getRecordValue:e.getRecordValue})}function Ge(e){const{environment:t,page:o,markdownLinkifyIt:n}=e,r=c.oA(o.getContentStores().map((e=>e.getValue())));return[He(o),(0,B.X4)({rootBlock:{...o.pointer,spaceId:o.getSpaceId()},getRecordValue:o.getRecordValue,blockValues:r,isWindows:t.device.isWindows,markdownSerializationOptions:(0,W.KF)(),markdownLinkifyIt:n}).markdown].filter(v.$K).join("\n\n")}function Ke(e){const{prompt:t,pageTitle:o,pageContent:n,selectedText:r,additionalContext:i}=e;Z()&&console.log("textSelectionPromptToServerContext",e);const a="string"==typeof t.name?t.name:H.default.formatMessage(t.name);if("fixSpellingGrammar"===t.key||"explainThis"===t.key||"makeLonger"===t.key||"makeShorter"===t.key||"findActionItems"===t.key||"improveWriting"===t.key||"simplifyLanguage"===t.key||"cleanUpFormatting"===t.key||"summarize"===t.key)return{serverPrompt:{type:t.key,pageTitle:o,selectedText:r},humanStep:{type:"human",prompt:a}};if("translate"===t.key){const e=(null==i?void 0:i.language)??"english";return{serverPrompt:{type:t.key,text:r,language:e},humanStep:{type:"human",prompt:`Translate to ${e}`}}}if("changeTone"===t.key){const e=(null==i?void 0:i.tone)??"professional";return{serverPrompt:{type:t.key,text:r,tone:e},humanStep:{type:"human",prompt:`Change tone to ${e}`}}}if("helpMeEdit"===t.key){const e=(null==i?void 0:i.prompt)||"";return{serverPrompt:{type:t.key,prompt:e,selectedText:r,pageTitle:o,pageContent:n},humanStep:{type:"human",prompt:e}}}}function $e(e){const{transaction:t,completionState:{clientPrompt:o,additionalContext:n,promptTitle:r}}=e,i=(0,me.BG)({clientPrompt:o,additionalContext:n,promptTitle:r});if(!i)return;const{currentUserSettingsStore:a}=ne.default.state;if(!a)return;(0,pe.Gl)(a,i)||(0,me.Nv)(i,a,t)}function Ye(e){const{prompt:t,pageTitle:o,previousContent:n,restContent:r,additionalContext:i,pageContent:a}=e;Z()&&console.log("cursorPromptToServerContext",e);const s="string"==typeof t.name?t.name:H.default.formatMessage(t.name);if("continueWriting"===t.key)return{serverPrompt:{type:"continueWriting",pageTitle:o,previousContent:n,restContent:r},humanStep:{type:"human",prompt:s}};if("helpMeWrite"===t.key){const e=(null==i?void 0:i.prompt)??"";return{serverPrompt:{type:"helpMeWrite",pageTitle:o,previousContent:n,restContent:r,prompt:e},humanStep:{type:"human",prompt:e}}}if("helpMeDraft"===t.key){const e=(null==i?void 0:i.prompt)??"";return{serverPrompt:{type:"helpMeDraft",prompt:e,previousContent:n,pageTitle:o},humanStep:{type:"human",prompt:e}}}if("todoList"===t.key||"outline"===t.key||"meetingAgenda"===t.key||"brainstormIdeas"===t.key||"prosConsList"===t.key||"socialMediaPost"===t.key||"pressRelease"===t.key||"creativeStory"===t.key||"poem"===t.key||"essay"===t.key||"blogPost"===t.key||"jobDescription"===t.key||"salesEmail"===t.key||"recruitingEmail"===t.key){const e=(null==i?void 0:i.topic)??"";return{serverPrompt:{type:t.key,topic:e,pageContent:a},humanStep:{type:"human",prompt:e}}}return"summarize"===t.key||"findActionItems"===t.key?{serverPrompt:{type:t.key,pageTitle:o,selectedText:a},humanStep:{type:"human",prompt:s}}:void 0}async function Qe(e,t){let o;if(L.debug)o=402!==L.showErrorCode;else{const n=await S.getAIUsageEligibility(e,{spaceId:t});"success"===n.type&&(o=n.data.isEligible,ce.Z.setState(n.data))}return void 0!==o&&ue.Z.setState(o),o}function Je(e){const{environment:t,revision:o,type:n,userContent:r,shareWithNotion:i,userOptIn:a}=e,s=re.default.state;o.inferenceId&&"completionPopup"===s.type&&"results"===s.stage&&(b.NF$(t,{type:"cursor_completion",inference_id:o.inferenceId,feedback_type:n,timestamp:(new Date).toUTCString(),user_comment:r,share_with_notion:i,user_opt_in:a}),re.default.setState({...s,revisions:s.revisions.map((e=>e.inferenceId===o.inferenceId?{...e,hasFeedback:!0}:e))}))}function Xe(e,t){const o=re.default.state;"completionPopup"===o.type&&"initialPromptForAIBlock"===o.stage&&A.createAndCommit({userAction:"completionActions.updatePromptForCurrentAiBlock",environment:e,perform:e=>{A.applyOperation({store:o.store,operation:d.op.set({pointer:o.store.pointer,path:["properties","title"],args:(0,f.TPx)(t)}),transaction:e})}})}},92022:(e,t,o)=>{o.d(t,{fz:()=>v,hr:()=>_,jn:()=>y,kL:()=>w,sj:()=>b,yd:()=>S});var n=o(4615),r=o(50906),i=o(54642),a=o(84084),s=o(98104),l=o(78663),c=o(19124),d=o(68056),p=o(80444),u=o(16772),m=o(27724),g=o(24666),h=o(89626);function f(e){"completionPopup"!==e.type||"initialPrompt"!==e.stage||"textSelection"!==e.context.type&&"cursor"!==e.context.type||s.NA({multiSelection:e.context.textSelection})}function y(e){u.default.invalidateLastUpdater();const{environment:t}=e,{state:o}=u.default;if("completionPopup"!==o.type||"results"!==o.stage)return;t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(o.inMemoryRecordCache);const n={type:"completionPopup",stage:"initialPrompt",prefilledValue:"",context:o.context,sessionId:o.sessionId,from:o.from,futureRevisions:[...o.revisions,...o.futureRevisions]};u.default.setState(n)}function v(){f(u.default.state),u.default.setState({type:"closed"})}function b(){const{state:e}=u.default;f(e),"completionPopup"===e.type&&"initialPrompt"===e.stage&&u.default.setState({type:"closedWithContext",context:e.context,sessionId:e.sessionId,futureRevisions:e.futureRevisions}),setTimeout((()=>{"closedWithContext"===u.default.state.type&&u.default.reset()}),1)}function S(e){u.default.setState({...e,type:"completionPopup",stage:"initialPromptForAIBlock",from:"ai_block",prefilledValue:"",sessionId:(0,n.ZP)()}),k({environment:e.environment,promptForAnalytics:e.clientPrompt})}function _(e){const{environment:t,from:o}=e;let{context:r,prefilledValue:a,sessionId:s}=e,c={type:"closed"};if("closed"===u.default.state.type){if(!r&&m.default.state.stores.length>0){const e=g.default.state;r="empty"===e.mode?(0,l.Xc)():(0,d.iG)(e.multiSelection)?(0,l.FD)():(0,l.Fu)()}r&&(a||(a=""),s||(s=(0,n.ZP)()),c={type:"completionPopup",stage:"initialPrompt",context:r,from:o,prefilledValue:a,sessionId:s,futureRevisions:[]},p.default.state.currentSpaceStore&&i.publishAiSession(t,{inference_type:"writer",spaceId:p.default.state.currentSpaceStore.id,id:c.sessionId,metadata:{from:o}}),"spacebar"===o&&(0,h.ON)(t))}u.default.setState(c),k(e)}function w(e){const{title:t,environment:o}=e,r=(0,l.FD)();if(!r)return;const i=t?(0,c.qB)({customPrompt:t,isPageEmpty:!0}):c.eL;_({environment:o,from:"page_menu",prefilledValue:(0,l.$W)(i),promptForAnalytics:i,sessionId:(0,n.ZP)(),context:r})}function k(e){const{environment:t,promptForAnalytics:o}=e,{state:n}=u.default;"completionPopup"===n.type&&"results"!==n.stage&&("initialPromptForAIBlock"!==n.stage&&s.ZH(t),r.Tlp(t,{session_id:n.sessionId,prompt_key:(null==o?void 0:o.key)??(n.prefilledValue?"unknown":"alternative_ui_empty_input"),from:n.from}),a.xv())}},71184:(e,t,o)=>{o.d(t,{Gl:()=>l,JS:()=>c,QC:()=>d,gC:()=>s,kg:()=>p});o(30541);var n=o(4615),r=o(37181),i=o(30793);function a(e,t){return e.id===t.id}function s(e,t,o){const n=c(t).slice(),s=n.findIndex((t=>a(e,t)));-1===s?n.unshift(e):n.splice(s,1,e),(0,i.lG)(e.action,t,o),r.d2({userSettingsStore:t,transaction:o,data:{favorite_ai_actions:n}})}function l(e,t){for(const o of c(e))if((0,i.YK)(o.action,t))return o}function c(e){var t;return(null===(t=e.getModel())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.favorite_ai_actions)??[]}function d(e,t,o){const n=c(t).filter((t=>!a(t,e)));r.d2({userSettingsStore:t,transaction:o,data:{favorite_ai_actions:n}})}function p(e){return{id:(0,n.ZP)(),name:e.promptTitle??"",action:{...e,promptTitle:void 0}}}},62878:(e,t,o)=>{o.d(t,{M:()=>g});o(67294);var n=o(5366),r=o(50906),i=o(47307),a=o(64964),s=o(39699),l=o(80444),c=o(71184),d=o(24405),p=o(85893);function u(e){window.__c={n:"FavoriteImportContent"};const{favorite:t,isReplacingFavorite:o}=e,r=(0,d.yK)((e=>({title:{fontWeight:700,marginBottom:"1em"},prompt:{color:e.lightTextColor,maxHeight:"5em",overflowY:"scroll",whiteSpace:"pre-wrap"}})),[]),i=o?(0,p.jsx)(n.FormattedMessage,{defaultMessage:"Overwrite â€œ{favoriteName}â€ AI action?",id:"ai.favoriteActions.importFavorite.overwriteMessage",values:{favoriteName:t.name}}):(0,p.jsx)(n.FormattedMessage,{defaultMessage:"Add â€œ{favoriteName}â€ AI action?",id:"ai.favoriteActions.importFavorite.addMessage",values:{favoriteName:t.name}}),a=(0,p.jsx)(n.FormattedMessage,{defaultMessage:"â€œ{favoritePrompt}â€",id:"ai.favoriteActions.importFavorite.prompt",values:{favoritePrompt:t.action.prompt}});return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{style:r.title,children:i}),(0,p.jsx)("div",{style:r.prompt,children:a})]})}var m=o(13555);async function g(e){const{environment:t}=e,o=await(0,m.cx)({environment:t,blockId:e.importArgs.blockId});"error"!==o.type?await async function(e){const{environment:t,newFavorite:o}=e,{currentUserSettingsStore:d}=l.default.state;if(!d)return;const m=(0,c.JS)(d);let g=(0,p.jsx)(n.FormattedMessage,{defaultMessage:"Add AI action",id:"ai.favoriteActions.importFavorite.addAction"}),h=(0,p.jsx)(n.FormattedMessage,{defaultMessage:"Cancel",id:"ai.favoriteActions.importFavorite.cancelAction"}),f=(0,p.jsx)(n.FormattedMessage,{defaultMessage:"â€œ{favoriteName}â€ AI action added to your Favorites.",id:"ai.favoriteActions.importFavorite.favoriteAdded",values:{favoriteName:o.name}}),y=!1;for(const r of m)if(r.name===o.name){if(r.action.type===o.action.type&&r.action.prompt===o.action.prompt)return void a.oV({label:(0,p.jsx)(n.FormattedMessage,{defaultMessage:"â€œ{favoriteName}â€ AI action is already in your Favorites.",id:"ai.favoriteActions.importFavorite.alreadyInFavorites",values:{favoriteName:o.name}})});o.id=r.id,y=!0,g=(0,p.jsx)(n.FormattedMessage,{defaultMessage:"Overwrite existing AI action",id:"ai.favoriteActions.importFavorite.overwriteAction"}),h=(0,p.jsx)(n.FormattedMessage,{defaultMessage:"Keep existing AI action",id:"ai.favoriteActions.importFavorite.keepExistingAction"}),f=(0,p.jsx)(n.FormattedMessage,{defaultMessage:"â€œ{favoriteName}â€ AI action updated in your Favorites.",id:"ai.favoriteActions.importFavorite.favoriteUpdated",values:{favoriteName:o.name}});break}if(!(await i.confirmUserAction({message:(0,p.jsx)(u,{favorite:o,isReplacingFavorite:y}),acceptLabel:g,cancelLabel:h})))return;s.createAndCommit({userAction:"favoriteActions.handleFavoriteImport",environment:t,perform(e){(0,c.gC)(o,d,e)}}),a.oV({label:f}),r.VoR(t,{type:"create_from_url",session_id:void 0,gtm_favorite_id:o.gtmFavoriteId})}({environment:t,newFavorite:o.favorite}):a.oV({label:(0,p.jsx)(n.FormattedMessage,{defaultMessage:"An error occurred when loading the AI action. ({errorCode})",id:"ai.favoriteActions.importFavorite.favoriteFailedToLoad",values:{errorCode:o.code}})})}},13555:(e,t,o)=>{o.d(t,{OF:()=>c,cx:()=>u});var n=o(4615),r=o(45953),i=o(70203),a=o(54642),s=(o(95477),o(77080));let l=function(e){return e[e.NoConfig=100]="NoConfig",e[e.LoadPageChunkFailed=101]="LoadPageChunkFailed",e[e.MissingPageRecord=103]="MissingPageRecord",e[e.InvalidPageParent=104]="InvalidPageParent",e[e.MissingTitle=105]="MissingTitle",e[e.MissingPromptText=106]="MissingPromptText",e[e.MissingCollectionSchema=107]="MissingCollectionSchema",e[e.MissingPromptType=108]="MissingPromptType",e[e.InvalidPromptType=109]="InvalidPromptType",e[e.FavoritesDisabled=110]="FavoritesDisabled",e}({});function c(){{const e=s.default.getConfigKey("gtm_ai_favorites","space_id"),t=s.default.getConfigKey("gtm_ai_favorites","collection_id");if(e&&t)return{spaceId:e,collectionId:t}}}function d(e,t,o){const n=function(e,t,o){for(const r in e){const i=e[r];var n;if(i&&i.name===o)return null===(n=t.properties)||void 0===n?void 0:n[r]}}(e,t,o);if(n)return(0,i.Jcv)(n)}function p(e){return{type:"error",code:e}}async function u(e){var t;const{environment:o,blockId:u}=e;if(await s.default.waitUntilStatsigReady(),!s.default.checkGate("ai_favorites"))return p(l.FavoritesDisabled);const m=c();if(!m)return p(l.NoConfig);const{spaceId:g,collectionId:h}=m,f=await a.loadCachedPageChunk(o,{page:{spaceId:g,id:u},limit:0,chunkNumber:0,cursor:{stack:[]},verticalColumns:!1});if("success"!==f.type)return p(l.LoadPageChunkFailed);const y=r.PF.create(f.data.recordMap),v=y.getValue({table:"block",id:u,spaceId:g});if(!v)return p(l.MissingPageRecord);if(v.parent_id!==h)return p(l.InvalidPageParent);const b=(0,i.Jcv)(null===(t=v.properties)||void 0===t?void 0:t.title);if(!b)return p(l.MissingTitle);const S=await async function(e){const{environment:t,recordMap:o,blockId:n,spaceId:r,collectionId:i}=e,s=o.getValue({table:"collection",id:i,spaceId:r});if(null!=s&&s.schema)return s.schema;const l=await a.getPublicPageData(t,{type:"block-space",blockId:n,spaceId:r});return"failed"!==l.type?l.data.collectionSchema:void 0}({environment:o,recordMap:y,blockId:u,spaceId:g,collectionId:h});if(!S)return p(l.MissingCollectionSchema);const _=d(S,v,"Prompt text");if(!_)return p(l.MissingPromptText);const w=d(S,v,"Prompt type");if(!w)return p(l.MissingPromptType);const k="Help me edit"===(x=w)?"helpMeEdit":"Help me write"===x?"helpMeWrite":void 0;var x;if(!k)return p(l.InvalidPromptType);const I=function(e,t,o){return"Yes"===d(e,t,o)}(S,v,"Run immediately");return{type:"success",favorite:{id:(0,n.ZP)(),name:b,executeImmediately:I,gtmFavoriteId:u,action:{type:k,prompt:_,promptTitle:void 0}}}}},57819:(e,t,o)=>{o.d(t,{$b:()=>y,Dj:()=>b,RR:()=>m,Tq:()=>f,VZ:()=>g,bJ:()=>u,jq:()=>v,rR:()=>h});var n=o(67294),r=o(480),i=o(86628),a=o(24405),s=o(66673),l=o(89224),c=o(80444),d=o(17903),p=o(42057);function u(){const e=(0,r.O7)(),t=(0,i.VK)((()=>e.device.isPhone),[e]);return(0,a.yK)((e=>{const o="dark"===e.mode?e.accentColors.purple[900]:e.accentColors.purple[400];return{purpleButton:{padding:4,fontWeight:600,color:o},keyboardShortcut:{textTransform:"uppercase",fontWeight:500,fontSize:11,marginLeft:6,color:e.lightTextColor,display:t?"none":void 0},lightweightButton:{display:"flex",alignItems:"baseline",justifyContent:"center",fontSize:14,padding:"5px 8px",borderRadius:4,color:e.mediumTextColor,height:32,marginTop:2},returnIndicatorIconStyles:{width:14,height:14,paddingLeft:4,fill:e.lightIconColor},keyboardShortcutInverted:{color:e.mediumInvertedTextColor,paddingLeft:4},writingLabel:{flex:1,color:o,fontWeight:500,flexDirection:"row",gap:6,display:"flex",alignItems:"center"},inputActions:{height:36,display:"flex",alignSelf:"flex-end",alignItems:"center"},loadingDots:{backgroundColor:o}}}),[t])}function m(e){if("completionPopup"===e.type)return e}function g(e){return"initialPromptForAIBlock"===e.stage?"aiBlock":e.context.type}function h(e){return"initialPromptForAIBlock"===e.stage?"write":function(e){switch(e.type){case"cursor":return"write";case"blockSelection":case"textSelection":return"edit"}}(e.context)}function f(e){l.clear(e)}function y(e){if("initialPromptForAIBlock"===e.stage){const t=e.originRef.current;if(!t)return;return{origin:t.getBoundingClientRect(),scrollerStore:b(e.store.getRecordStoreUIRoot())}}return e.context}function v(e){const{areWeLoading:t,scrollerStore:o,resetWhenScrolledToBottom:r}=e,a=(0,s.D9)(t);(0,n.useEffect)((()=>{t!==a&&c(!1)}),[t,a]);const[l,c]=(0,n.useState)(!1),d=(0,i.VK)((()=>null==o?void 0:o.state.scrollTop),[o]),p=(0,s.D9)(d),u=(0,i.VK)((()=>{const e=null==o?void 0:o.state.clientRect;if(e)return o.state.scrollHeight-e.height}),[o]);return(0,n.useEffect)((()=>{void 0!==p&&void 0!==d&&p-d>1&&c(!0)}),[d,p]),(0,n.useEffect)((()=>{r&&void 0!==d&&void 0!==u&&Math.abs(d-u)<1&&c(!1)}),[u,d,r]),l}function b(e){return e===c.default.state.mainEditorCurrentBlockStore?d.Z:p.Z}},72899:(e,t,o)=>{o.d(t,{GC:()=>r,gr:()=>s,l4:()=>i,oF:()=>a});var n=o(77907);const r=(0,n.lazyComponent)(n.deps.ai,(e=>e.CompletionPopup)),i=(0,n.createDependency)("propertyCompletionsActions",(async()=>Promise.all([o.e(2774),o.e(2743),o.e(7597),o.e(3690),o.e(2655),o.e(9933),o.e(7718),o.e(8848),o.e(9447),o.e(9434),o.e(4703),o.e(954),o.e(5741)]).then(o.bind(o,44866)))),a=(0,n.lazyComponent)(n.deps.ai,(e=>e.AiEligibilityUpdater)),s=(0,n.createDependency)("completionActions",(async()=>Promise.all([o.e(2774),o.e(2743),o.e(7597),o.e(3690),o.e(2655),o.e(9933),o.e(7718),o.e(8848),o.e(9447),o.e(9434),o.e(4703),o.e(954),o.e(5741)]).then(o.bind(o,84254))))},30793:(e,t,o)=>{o.d(t,{BG:()=>l,Nv:()=>i,TE:()=>d,YK:()=>r,lG:()=>s,pz:()=>a});var n=o(37181);function r(e,t){return e.prompt===t.prompt&&e.type===t.type}function i(e,t,o){const i=a(t).filter((t=>!r(t,e)));n.d2({userSettingsStore:t,transaction:o,data:{recent_ai_actions:[e,...i].slice(0,100)}})}function a(e){var t;return(null===(t=e.getModel())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.recent_ai_actions)??[]}function s(e,t,o){const i=a(t),s=i.filter((t=>!r(t,e)));i.length!==s.length&&n.d2({userSettingsStore:t,transaction:o,data:{recent_ai_actions:s}})}function l(e){const{clientPrompt:t,additionalContext:o,promptTitle:n}=e,r=null==o?void 0:o.prompt;if(("helpMeWrite"===t.key||"helpMeEdit"===t.key||"helpMeDraft"===t.key)&&r)return{type:"helpMeDraft"===t.key?"helpMeWrite":t.key,prompt:r,promptTitle:n};const i=function(e,t){if(!d(e.key))return;return null==t?void 0:t.topic}(t,o);return i?{type:"helpMeWrite",prompt:i,promptTitle:n}:void 0}const c={brainstormIdeas:!0,blogPost:!0,outline:!0,socialMediaPost:!0,pressRelease:!0,creativeStory:!0,essay:!0,poem:!0,todoList:!0,meetingAgenda:!0,prosConsList:!0,jobDescription:!0,salesEmail:!0,recruitingEmail:!0};function d(e){return c[e]}},23622:(e,t,o)=>{o.r(t),o.d(t,{applyUncommittedOperations:()=>bo,cancelPreviewStep:()=>yo,clearAndResetActiveAssistantSession:()=>lo,clearPrimedText:()=>xo,commitHumanStep:()=>po,commitPreviewAssistantStep:()=>fo,fillInAiSection:()=>Co,resetAndInitializeAssistantStores:()=>so,resetAssistantStores:()=>ao,resetUncommittedOperations:()=>So,retryNextAssistantSteps:()=>mo,rewindActiveAssistantSession:()=>co,sampleNextAssistantSteps:()=>ho,saveAiSectionFeedback:()=>_o,saveFeedback:()=>wo,simulateOrCommitStep:()=>vo,testing:()=>Io});o(21703),o(57658),o(52262),o(24506);var n=o(30120),r=o(26263),i=o(1302),a=o(28410),s=o(46964),l=o(72126),c=o(4615),d=o(7406),p=o(80),u=o(97880),m=o(78395),g=o(25211),h=o(22828),f=o(149),y=o(189),v=o(95940),b=o(31734),S=o(90629),_=o(88974),w=o(35746),k=o(33925),x=o(84112);const I=e=>p.p.mapResult((0,x.hc)("insert-inside"),(t=>{const o=(0,x.jg)({inputAttributes:t.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"counter"}},tagName:"insert-inside"});if(f.x.isFail(o))return o;const n=(0,p.w6)((0,x.Lf)("insert-inside",[(0,b.Y)({allocateIdFn:e.allocateIdFn,allowMove:!0,persisted:!1})]),t.children??[]);if(f.x.isFail(n))return n;return{value:{type:"effect",tagName:"insert-inside",insertType:"block",attributes:o.value,children:n.value}}})),C=p.p.mapResult((0,x.hc)("insert-inside"),(e=>{const t=(0,x.jg)({inputAttributes:e.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"counter"}},tagName:"insert-inside"});if(f.x.isFail(t))return t;const o=(0,p.w6)(p.p.sequence([p.p.choice([w.l["property-relation"],w.l["property-person"],w.l["property-multi-select"]]),p.p.eof((()=>new h.qf))]),e.children??[]);if(f.x.isFail(o))return o;return{value:{type:"effect",tagName:"insert-inside",insertType:"property",attributes:t.value,children:[o.value[0]]}}})),T=e=>p.p.choice([p.p.try(C),I(e)]);function M(e){return t=>{const o=p.p.mapResult((0,x.hc)(e),(o=>{const n=(0,x.jg)({inputAttributes:o.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"counter"}},tagName:e});if(f.x.isFail(n))return n;const r=(0,p.w6)((0,x.Lf)(e,[(0,b.Y)({allocateIdFn:t.allocateIdFn,allowMove:!0,persisted:!1})]),o.children??[]);if(f.x.isFail(r))return r;return{value:{type:"effect",tagName:e,insertType:"block",attributes:n.value,children:r.value}}})),n=p.p.mapResult((0,x.hc)(e),(t=>{const o=(0,x.jg)({inputAttributes:t.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"counter"},name:{required:!0,values:!0}},tagName:e});if(f.x.isFail(o))return o;const n=(0,p.w6)((0,x.Lf)(e,[_.x,k.m["schema-property-text"]]),t.children??[]);if(f.x.isFail(n))return n;return{value:{type:"effect",tagName:e,insertType:"table",attributes:o.value,children:n.value}}}));return p.p.andThen(p.p.lookAhead(p.p.map(p.p.any(),(t=>{var o;return"element"===t.type&&t.tagName===e&&(0,u.$K)(null===(o=t.attributes)||void 0===o?void 0:o.name)}))),(e=>e?n:o))}}const P=M("insert-before"),A=M("insert-after"),D=p.p.mapResult((0,x.hc)("action-button"),(e=>{const t=(0,x.jg)({inputAttributes:e.attributes,definitions:{name:{required:!0,values:!0},icon:{required:!1,values:!0}},tagName:"action-button"});return f.x.isFail(t)?t:{value:{name:t.value.name,icon:t.value.icon}}})),B=p.p.mapResult((0,x.hc)("chat-md"),(e=>{const t=e.attributes?Object.keys(e.attributes):[];if(t.length>0)return{error:new h.JZ({tagName:"chat-md",attributeNames:t})};const o=(0,p.w6)((0,x.Lf)("chat-md",[x.oT]),e.children??[]);if(f.x.isFail(o))return o;return{value:{type:"effect",tagName:"chat-md",text:o.value.map((e=>e.value)).join("")}}})),R=e=>p.p.mapResult((0,x.hc)("chat"),(t=>{const o=t.attributes?Object.keys(t.attributes):[];if(o.length>0)return{error:new h.JZ({tagName:"chat",attributeNames:o})};const n=(0,p.w6)((0,x.Lf)("chat",[(0,b.a)({allocateIdFn:e.allocateIdFn,allowMove:!1,persisted:!1}),p.p.map(D,(e=>({type:"action-button",value:e})))]),t.children??[]);if(f.x.isFail(n))return n;const r=n.value.filter((0,u.AO)((e=>"block"===e.type?{true:e}:{false:e}))),i=n.value.filter((0,u.AO)((e=>"action-button"===e.type?{true:e}:{false:e})));return{value:{type:"effect",tagName:"chat",children:r,actionButtons:i.map((e=>e.value))}}})),E=p.p.mapResult((0,x.hc)("delete"),(e=>{const t=(0,x.jg)({inputAttributes:e.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"counter"}},tagName:"delete"});if(f.x.isFail(t))return t;const o=(0,x.xB)(e);if(f.x.isFail(o))return o;return{value:{type:"effect",tagName:"delete",deleteType:"block",attributes:t.value}}})),F=p.p.mapResult((0,x.hc)("delete"),(e=>{const t=(0,x.jg)({inputAttributes:e.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"counter"}},tagName:"delete"});if(f.x.isFail(t))return t;const o=(0,p.w6)(p.p.sequence([p.p.choice([w.l["property-relation"],w.l["property-person"],w.l["property-multi-select"]]),p.p.eof((()=>new h.O7))]),e.children??[]);if(f.x.isFail(o))return o;return{value:{type:"effect",tagName:"delete",deleteType:"property",attributes:t.value,children:[o.value[0]]}}})),N=p.p.map((0,x.MD)({tagName:"delete",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"counter"},name:{required:!0,values:!0}}}),(e=>{let{attributes:t}=e;return{type:"effect",tagName:"delete",deleteType:"table-column",attributes:t}})),j=p.p.choice([p.p.try(E),p.p.try(F),N]),O=p.p.mapResult((0,x.hc)("set-title"),(e=>{const t=(0,x.jg)({inputAttributes:e.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"counter"}},tagName:"set-title"});if(f.x.isFail(t))return t;const o=(0,p.w6)((0,x.Lf)("set-title",[(0,S.I8)({inlineNodesAllowed:v.B5,textAllowed:!0,parentTagName:"set-title"})]),e.children??[]);if(f.x.isFail(o))return o;return{value:{type:"effect",tagName:"set-title",attributes:t.value,children:o.value}}})),L=p.p.mapResult((0,x.hc)("set-attribute"),(e=>{const{id:t,...o}=e.attributes??{};if(!t)return{error:new h.FI({tagName:"set-attribute",attributeName:"id"})};if(!(0,y.oU)(t))return{error:new h.WH(t)};if(0===Object.keys(o).length)return{error:new h.Ii};if(Object.keys(o).length>1)return{error:new h.SF};const n=(0,x.xB)(e);if(f.x.isFail(n))return n;const r=Object.keys(o)[0];return{value:{type:"effect",tagName:"set-attribute",attributes:{id:t,key:r,value:o[r]}}}})),U=p.p.map((0,x.MD)({tagName:"set-tag-name",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"counter"},"tag-name":{required:!0,values:(0,u.Yd)(v.pX)}}}),(e=>{let{attributes:t}=e;return{type:"effect",tagName:"set-tag-name",attributes:{id:t.id,newTagName:t["tag-name"]}}})),Z=p.p.mapResult((0,x.hc)("set-property"),(e=>{const t=(0,x.jg)({inputAttributes:e.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"counter"}},tagName:"set-property"});if(f.x.isFail(t))return t;const o=(0,p.w6)(p.p.map(p.p.sequence([w.R,p.p.manyTill(w.R,p.p.eof())]),(e=>{let[t,o]=e;return[t,...o]})),e.children??[]);if(f.x.isFail(o))return o;return{value:{type:"effect",tagName:"set-property",attributes:t.value,children:o.value}}})),V=e=>p.p.mapResult((0,x.hc)("persist-blocks"),(t=>{const o=t.attributes?Object.keys(t.attributes):[];if(o.length>0)return{error:new h.JZ({tagName:"persist-blocks",attributeNames:o})};const n=(0,p.w6)((0,x.Lf)("persist-blocks",[(0,b.a)({allocateIdFn:e.allocateIdFn,allowMove:!1,persisted:!1})]),t.children??[]);if(f.x.isFail(n))return n;return{value:{type:"effect",tagName:"persist-blocks",children:n.value}}}));function q(e){const t=`filter-${e}`;return p.p.mapResult((0,x.hc)(t),(o=>{var n;if(null===(n=o.attributes)||void 0===n||!n.condition)return{error:new h.FI({tagName:t,attributeName:"condition"})};const r=v.c8[e],i=function(e){const{tagName:t,condition:o,allowedOperators:n}=e;if(o.startsWith("not ")){const e=o.slice("not ".length);return n.includes(e)?{value:{not:!0,operator:e}}:{error:new h.uY({tagName:t,allowedOperators:n,inputCondition:o})}}return n.includes(o)?{value:{not:!1,operator:o}}:{error:new h.uY({tagName:t,allowedOperators:n,inputCondition:o})}}({condition:o.attributes.condition,tagName:t,allowedOperators:Object.keys(r)});if(f.x.isFail(i))return i;const a=r[i.value.operator],s=(0,x.jg)({inputAttributes:o.attributes,definitions:{name:{required:!0,values:!0},condition:{required:!0,values:!0},...a.attributes},tagName:t});if(f.x.isFail(s))return s;const{name:l,condition:c,...d}=s.value,u=(0,p.w6)((0,x.Lf)(t,[(0,S.I8)({inlineNodesAllowed:a.inline,textAllowed:a.text,parentTagName:t})]),o.children??[]);if(f.x.isFail(u))return u.error instanceof h.d4?{error:new h.Dt({tagName:u.error.tagName,unexpectedNode:u.error.unexpectedNode,conditionName:o.attributes.condition,cause:u.error})}:u;return{value:{propertyName:s.value.name,propertyTagName:e,children:u.value,attributes:d,operator:i.value.operator,not:i.value.not}}}))}const z=p.p.choice([...(0,u.Yd)(v.c8).map((e=>q(e))),p.p.fail((e=>new h.vQ({nodeType:"database filter",unexpectedNode:l.Ps(e)})))]),W=p.p.mapResult((0,x.hc)("filter-group"),(e=>{const t=(0,x.jg)({inputAttributes:e.attributes,definitions:{match:{required:!0,values:["any","all"]}},tagName:"filter-group"});if(f.x.isFail(t))return t;if(!e.children||0===e.children.length)return{error:new h.wh({tagName:"filter-group"})};const o=(0,p.w6)((0,x.Lf)("filter-group",[z]),e.children??[]);return f.x.isFail(o)?o:{value:{operator:t.value.match,filters:o.value}}})),H=p.p.choice([z,W]);const G=p.p.choice([...(0,u.Yd)(v.ZK).map((e=>function(e){const t=`sort-${e}`;return p.p.mapResult((0,x.hc)(t),(e=>{const o=(0,x.xB)(e);if(f.x.isFail(o))return o;const n=(0,x.jg)({inputAttributes:e.attributes,definitions:{name:{required:!0,values:!0},direction:{required:!0,values:["ascending","descending"]}},tagName:t});return f.x.isFail(n)?n:{value:{propertyName:n.value.name,direction:n.value.direction}}}))}(e))),p.p.fail((e=>new h.vQ({nodeType:"database sort",unexpectedNode:l.Ps(e)})))]),K=p.p.map((0,x.MD)({tagName:"search",attributeDefinitions:{question:{required:!0,values:!0},keywords:{required:!0,values:!0}}}),(e=>{let{attributes:t}=e;return t}));const $=p.p.choice([...(0,u.Yd)(v.ZK).map((e=>function(e){const t=`aggregation-${e}`,o=v.Se[t];return p.p.mapResult((0,x.hc)(t),(e=>{const n=(0,x.xB)(e);if(f.x.isFail(n))return n;const r=(0,x.jg)({inputAttributes:e.attributes,definitions:o.attributes,tagName:t});return f.x.isFail(r)?r:{value:{tagName:t,attributes:r.value}}}))}(e))),p.p.fail((e=>new h.vQ({nodeType:"database sort",unexpectedNode:l.Ps(e)})))]),Y=p.p.mapResult((0,x.hc)("query-database"),(e=>{const t=(0,x.jg)({inputAttributes:e.attributes,definitions:{id:{required:!0,values:!0,mappingMode:"counter"}},tagName:"query-database"});if(f.x.isFail(t))return t;const o=(0,p.w6)((0,x.Lf)("query-database",[p.p.map(H,(e=>({type:"filter",value:e}))),p.p.map(G,(e=>({type:"sort",value:e}))),p.p.map(K,(e=>({type:"search",value:e}))),p.p.map($,(e=>({type:"aggregation",value:e})))]),e.children??[]);if(f.x.isFail(o))return o;const n=o.value.flatMap((e=>"filter"===e.type?[e.value]:[])),r=o.value.flatMap((e=>"sort"===e.type?[e.value]:[])),i=o.value.flatMap((e=>"search"===e.type?[e.value]:[])),a=o.value.flatMap((e=>"aggregation"===e.type?[e.value]:[]));if(i.length>1)return{error:new h.en("<search>")};if(a.length>1)return{error:new h.en("aggregation")};return{value:{tagName:"query-database",type:"observation",query:{databaseId:t.value.id,search:l.Ps(i),aggregation:l.Ps(a),filter:{operator:"all",filters:n},sorts:r}}}})),Q=p.p.map((0,x.MD)({tagName:"load-page",attributeDefinitions:{id:{required:!0,values:!0,mappingMode:"counter"}}}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"load-page",attributes:t}})),J=p.p.map((0,x.MD)({tagName:"search",attributeDefinitions:{question:{required:!0,values:!0},keywords:{required:!0,values:!0},lookback:{required:!1,values:!0},"question-intl":{required:!1,values:!0}}}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"search",attributes:t}})),X=p.p.map((0,x.MD)({tagName:"search-people",attributeDefinitions:{search:{required:!0,values:!0}}}),(e=>{let{attributes:t}=e;return{type:"observation",tagName:"search-people",attributes:t}})),ee=e=>({chat:R(e),"chat-md":B,delete:j,"insert-after":A(e),"insert-before":P(e),"insert-inside":T(e),"persist-blocks":V(e),"set-attribute":L,"set-property":Z,"set-tag-name":U,"set-title":O,"load-page":Q,search:J,"query-database":Y,"search-people":X});function te(e){return p.p.choice([...Object.values(ee(e)),p.p.fail((e=>e.length>0&&"element"===e[0].type?new h.EH(e[0].tagName):new Error(`Unexpected node(s) provided to parseAssistantApi: ${JSON.stringify(e)}`)))])}class oe{constructor(e){this.state=void 0,this.state=e}async eval(e){const{commit:t}=e,o=this.state.clone(),n=[],r=o.getContext().mode,i=(0,g.VZ)(e.input),a=(0,g.J)(e.input);if(a)try{o.think(a)}catch(h){if(!(h instanceof m.Z3))throw h}const s=[],l=[],c=[];try{if(i.includes(m.ry)||i.includes(m.ds))throw new Error("Selection comment separators are not allowed.");const e=this.state.parse(i),a=[],g=new Set(o.getContext()["available-commands"]);for(const t of e){if("element"!==t.type)continue;const e=(0,p.kU)(te({allocateIdFn:()=>o.randomID()}),t);if(!g.has(e.tagName))throw new Error(`Not in available commands: ${e.tagName}`);if((0,m.SV)(e))(0,m.qK)(e,o),c.push(e.tagName);else if((0,m.Ex)(e)){const t=(0,m.sk)(e,o).catch((e=>{const t=(0,d.tg)(e);n.push({type:"observation",observationType:"error",value:`${t.name}: ${t.message}`,stack:t.stack})}));a.push(t),s.push(e.tagName),c.push(e.tagName)}else(0,u.t1)(e)}if(0===c.length&&"direct"===r)throw new Error("When in 'direct' mode, you must use at least one API.");if(s.length>0&&l.length>0)throw new Error(`Observation APIs (${s.join(", ")}) and effect APIs (${l.join(", ")}) cannot be used at the same time.`);const h=await Promise.all(a);for(const t of h)t&&n.push(...t);t&&(this.state=o)}catch(f){const e=(0,d.tg)(f);n.push({type:"observation",observationType:"error",value:`${e.name}: ${e.message}`,stack:e.stack})}finally{return n}}}var ne=o(50715);class re extends m.NW{constructor(e){super(e),this.streamInference=this.streamInference.bind(this)}}(0,ne.AO)((e=>"error"===e.observationType?{true:e}:{false:e})),(0,ne.AO)((e=>"page"===e.observationType?{true:e}:{false:e}));const ie=(0,ne.AO)((e=>"error"===e.observationType?{true:e}:{false:e}));const ae=(0,ne.AO)((e=>"assistant"===e.type?{true:e}:{false:e}));class se{constructor(e){this.transcript=[],this.codeEvaluator=void 0,this.counter=0,this.streamInference=void 0,this.streamInference=e.streamInference,this.codeEvaluator=new oe(e)}getTranscript(){return this.transcript}setTranscript(e){var t;this.transcript=e,this.counter=(null===(t=l.UT(e,(e=>e.id)))||void 0===t?void 0:t.id)??0}clearTranscript(){this.transcript=[],this.counter=0}getInferenceInputForEval(e){let t=this.getTranscript();return e.skipLastAssistantStep&&t.length>0&&"assistant"===t[t.length-1].type&&(t=t.slice(0,t.length-1)),{id:(0,c.ZP)(),startState:this.codeEvaluator.state.getSerializedState(),startTranscript:t}}async*streamSampleNextStep(e){const t=this.streamInference(this.getTranscript(),e),o=this.counter++;let n="";for await(const r of t)n+=r,yield{type:"assistant",id:o,inferenceId:e,value:n}}async sampleNextStep(e){let t;for await(const o of this.streamSampleNextStep(e))t=o;return t}async simulateStep(e){if("assistant"===e.type||"human"===e.type){return await this.evaluateStep(e,!1)}return[]}async commitStep(e){if(this.transcript=[...this.transcript,e],"assistant"===e.type){const t=await this.evaluateStep(e,!0);for(const e of t)this.appendObservation(e);return t}return"context"===e.type&&this.codeEvaluator.state.setContext(e.context),[]}commitStepWithoutEvaluating(e){this.transcript=[...this.transcript,e]}createAssistantStep(e){return{id:this.counter++,type:"assistant",inferenceId:void 0,value:e}}createHumanStep(e){return{id:this.counter++,type:"human",value:e}}createContextStep(e){return{id:this.counter++,type:"context",context:e}}async evaluateStep(e,t){const o=(await this.codeEvaluator.eval({input:e.value,commit:t})).map((e=>({...e,id:this.counter++})));return l.oA(o)}async loadPageWithoutAssistantStep(e){const t=await this.codeEvaluator.eval({input:`<load-page id="${e}"/>`,commit:!0}),o=t.find(ie);if(o)throw function(e){const t=new Error(e.value);return e.stack&&(t.stack=e.stack),t}(o);const n=t.map((e=>({...e,id:this.counter++})));for(const r of n)this.appendObservation(r)}async refreshPageObservations(){const e=this.transcript.filter((e=>"observation"===e.type&&"page"===e.observationType)),t=l.vM(e,"pageId"),o=Object.values(t).map((e=>e[e.length-1])),n=async e=>{const t=(await this.codeEvaluator.eval({input:`<load-page id="${e}"/>`,commit:!0}))[0];if("page"!==(null==t?void 0:t.observationType))throw new Error("Expected page observation");return t};for(const r of o){const e=await n(r.pageId);this.appendObservation({...e,id:this.counter++})}}appendObservation(e){this.transcript.some((t=>"observation"===t.type&&t.observationType===e.observationType&&t.value===e.value))||(this.transcript=[...this.transcript,e])}}var le=o(94568),ce=o(29477),de=o(21202);var pe=o(88891);const ue=Object.entries(v.pX).flatMap((e=>{let[t,{attributes:o}]=e;return[`<${t}>`,"uli"===t&&"Do not include a dash in the unordered list item text. It will be rendered automatically.","oli"===t&&"Do not include numbers in the ordered list item text. They will be rendered automatically.",("h1"===t||"h2"===t||"h3"===t)&&"Note that when the user refers to a 'section', they are probably referring to the heading and the content below it until the next heading.",...Object.entries(o).map((e=>{let[t,{description:o}]=e;return`\tAttribute: "${t}" for ${o}.`}))].filter(Boolean)})).join("\n"),me=Object.entries(v.ZK).flatMap((e=>{let[t,{attributes:o,inline:n}]=e;return[`<${t}>`,n.length>0?`Allowed children: ${n.join(",")}`:void 0,...Object.entries(o).map((e=>{let[t,{description:o}]=e;return`\tAttribute: "${t}" for ${o}.`}))].filter(Boolean)})).join("\n"),ge=Object.entries(v.t).flatMap((e=>{let[t,{attributes:o}]=e;return[`<${t}>`,...Object.entries(o).map((e=>{let[t,{description:o}]=e;return`\tAttribute: "${t}" for ${o}.`}))].filter(Boolean)})).join("\n"),he=Object.entries(v.Se).flatMap((e=>{let[t,{attributes:o}]=e;return[`<${t}>`,...Object.entries(o??{}).map((e=>{let[t,{values:o,description:n}]=e;return[`\tAttribute: "${t}" for ${n}`,...!0===o?[]:[`\n\t\tThe available possible values for ${t} are as follows: ${o.join(", ")}`]]}))]})).join("\n"),fe={bio:"You are Notion AI. If asked about your identity, you should respond saying that you are Notion AI.",hallucinations:"\n\tYou can use information from anything in the current context (loaded pages, search results, database query results, chat messages, etc.).\n\tYou can use information from your general world knowledge.\n\tDo not make up information that is not in the current context or from your general world knowledge unless explicitly requested to do so.\n\tAvoid making assumptions about information that is not explicitly in the current context.\n\t",defaultActionRouting:"\n\tInstructions for general behavior:\n\tYou may be asked to edit a page. If the request does not rely on any information beyond the current context, you should try to perform an edit right away, without performing a search. If the request relies on information beyond the current context, you should search the workspace for additional information, and use it to try to perform an edit. You can search for information about anything.\n\tYou may be asked a question. If the question is about information in the current context, you should try to answer it right away, without performing a search. If the question is about information that is not in the current context, you should search the workspace for additional information, and use it to try to answer the question. You can search for information about anything.\n\tYou may see one or more databases in the current context. You can query them to try to answer questions, as well as create or update any pages in them.\n\tYou may receive a request that requires knowing a person's ID, for example querying a person property by ID, and it is not already clear what their ID is. In this case, you should use search people to try to find them by name to disambiguate the request. If you can't be sure after your search, you should ask for clarification. Note that searching people will not show any additional information like their role or department, so you should only use search people when you need to disambiguate a request or find a person's ID.\n\t",instructionsPages:"\n\tIf you see <instructions-page>, follow the instructions inside it.\n\tWhen you <think>, consider the next actions to take based on the instructions inside <instructions-page>.\n\t",errors:"\n\tInstructions for errors:\n\tYou may see error messages inside of <stderr>...</stderr> tags. If you do, this means the last set of actions were invalid and not executed. You should think about how to fix the error, and then try again.\n\t",chat:"\n\tTo send a message to the person or people in the current context, use \"chat\":\n\tDo not refer to the people as 'humans'. Instead, prefer to refer to people by their name or use 'people'.\n\tSpec: <chat>{block xml}</chat>\n\tExample: <chat><text>Hello, here is a list:</text><uli>One</uli><uli>Two</uli></chat>\n\t",pageEditing:`\n\tTo insert blocks before / above a block, use "insert-before":\n\t\tSpec: <insert-before id="{id}">{block xml}</insert-before>\n\t\tExample: <insert-before id="1"><text>New block</text></insert-before>\n\t\tNote that you can insert multiple blocks at once.\n\tTo insert blocks after / below a block, use "insert-after":\n\t\tSpec: <insert-after id="{id}">{block xml}</insert-after>\n\t\tExample: <insert-after id="1"><text>New block</text></insert-after>\n\t\tNote that you can insert multiple blocks at once.\n\tTo insert blocks indented inside a block, page, or database, use "insert-inside":\n\t\tSpec: <insert-inside id="{id}">{block xml}</insert-inside>\n\t\tExample: <insert-inside id="1"><text>New block</text></insert-inside>\n\t\tThe new blocks will be inserted at the end of the block, page, or database, indented inside.\n\t\tWhen a page is empty, insert-inside is the only way to insert content into it.\n\t\tNote that if you want to insert above or below a block, you should use insert-after or insert-before instead.\n\t\tNote that you can insert multiple blocks at once.\n\tTo move blocks, use "insert-before", "insert-after", or "insert-inside" with "move":\n\t\tSpec: <insert-before id="{id}"><move id="{id}"/></insert-before>\n\t\tExample: <insert-before id="1"><h1>Header</h1><move id="2"/><move id="3"/></insert-before>\n\t\tNote that you can move multiple blocks at once.\n\t\tNote that you can combine creating and moving blocks in the same request.\n\tTo delete a block, use "delete":\n\t\tSpec: <delete id="{id}"/>\n\t\tExample: <delete id="1"/>\n\tTo set the title of a block or page, use "set-title":\n\t\tSpec: <set-title id="{id}">{inline xml}</set-title>\n\t\tExample: <set-title id="1">New title with <b>bolded text</b></set-title>\n\t\tset-title is only supported on these block types: ${Object.entries(v.pX).filter((e=>{let[t,o]=e;return o.title})).map((e=>{let[t]=e;return t})).join(",")}\n\tTo set an attribute of a block, use "set-attribute":\n\t\tSpec: <set-attribute id="{id}" {attribute name}="{attribute value}"/>\n\t\tExample: <set-attribute id="1" checked="true"/>\n\tTo set the tag name of a block, use "set-tag-name":\n\t\tSpec: <set-tag-name id="{id}" tag-name="{tag name}"/>\n\t\tExample: <set-tag-name id="1" tag-name="h2"/>\n\t\tThis will transform or turn the block into the specified type.\n\tTo set a property of a block, use "set-property":\n\t\tSpec: <set-property id="{id}><property-text name="{property name}">{inline xml}</property-text></set-property>\n\t\tExample: <set-property id="1"><property-text name="1">New value with <b>bolded text</b></property-text></set-property>\n\t\tYou can only set one property at a time in a single call to set-property.\n\t`,blocks:`\n\tSupported block tags:\n\t${ue}\n\tDo not use any block tags that are not listed above.\n\tWhen creating new blocks, do not provide an id attribute.\n\t`,inline:`\n\tSupported inline text tags:\n\t${ge}\n\tDo not use any inline tags that are not listed above.\n\t`,properties:`\n\tSupported block property tags:\n\t${me}\n\tDo not use any property tags that are not listed above.\n\t`,colors:`\n\tTo set the color of an entire block, use set-attribute: <set-attribute id="{id}" color="{color}"/>\n\tTo highlight text with a color, use the h inline tag: <set-title id="{id}">This is <h color="{color}">highlighted text</h></set-title>\n\tThe following colors are available: ${v.yD.join(", ")}. Do not use any other colors.`,loadingPages:'\n\tTo load a page\'s content, use "load-page":\n\tSpec: <load-page id="{id}"/>\n\tExample: <load-page id="0"/>\n\tYou can only load pages that are shown in the current context.\n\tAfter loading a page, before taking any actions that would depend on the result, output <stdout> so you can observe the result.\n\t',search:'\n\tTo search the entire workspace, use "search":\n\tSpec: <search question="{question}" keywords="{keywords}" lookback="{period of time to search over, suffixed with d|w|m|y or all_time}"/>\n\tExample: <search question="Who is the CEO of Bits and Bytes?" keywords="ceo bits and bytes", lookback="all_time"/>\n\tExample: <search question="What was last quarter\'s ARR?" keywords="annual recurring revenue report quarter", lookback="4m"/>\n\tProvide a detailed question to answer, and a space-separated list of Google-style search keywords. Include at least 2 keywords. Do not repeat keywords.\n\tWhen constructing a question and keywords, do not infer any additional information not already in the context.\n\tYou should not assume that the results of a search are relevant to the search.\n\tAfter searching, before taking any actions that would depend on the result, output <stdout> so you can observe the result.\n\t',queryDatabase:`\n\tTo query a database, use "query-database":\n\tSpec: <query-database id="{database ID}">{filter XML}</query-database>\n\tExample: <query-database id="60"><search question="Do we have any students interested in physics?" keywords="student interest physics"/></query-database>\n\tYou can only query databases that are shown in the current context.\n\tMake sure to use the database ID from the database-id attribute.\n\tYou should not assume that the results of a database query are relevant.\n\tAfter querying a database, before taking any actions that would depend on the result, output <stdout> so you can observe the result.\n\n\tTo provide a single filter: <query-database id="{database ID}">{filter XML}</query-database>\n\tTo combine multiple filters to match 'any': <query-database id="{database ID}"><filter-group match="any">{filter XML}</filter-group></query-database>\n\tTo combine multiple filters to match 'all': <query-database id="{database ID}"><filter-group match="all">{filter XML}</filter-group></query-database>\n\tTo sort by a single property, use a single <sort-property-{type}>: <query-database id="{database ID}"><sort-property-text name="{property name}" direction="{ascending or descending}"/></query-database>\n\tTo sort by multiple properties, use multiple <sort-property-{type}>: <query-database id="{database ID}"><sort-property-number name="{property name}" direction="{ascending or descending}"/><sort-property-email name="{property name}" direction="{ascending or descending}"/></query-database>\n\tUse 'is empty' with no value to find pages with an empty value for a particular property: <query-database id="{database ID}"><filter-property-text name="{property name}" condition="is empty"/></query-database>\n\tUse 'not is empty' with no value to find pages with a value filled in for a particular property: <query-database id="{database ID}"><filter-property-select name="{property name}" condition="not is empty"/></query-database>\n\n\tQuery database search:\n\tUse database 'search' when you are not sure which property to search, or when there is no high confidence exact filter to include.\n\tDatabase search will perform a full-text search on all properties: <query-database id="{database ID}"><search question="detailed question" keywords="space-separated list of keywords"/></query-database>\n\tProvide a detailed question to answer, and a space-separated list of Google-style search keywords. Include at least 2 keywords. Do not repeat keywords.\n\tWhen constructing a question and keywords, do not infer any additional information not already in the context.\n\tDatabase search simply orders the results by their relevance to the question and keywords. Do not assume that the results are relevant to the search.\n\n\tQuery database text filters:\n\tUse a text filter when you are highly confident of the exact value to match. If you're not sure, you should use search instead.\n\tExact string matching is not case-sensitive, so it doesn't matter if you use uppercase or lowercase letters.\n\n\tUse 'contains' to find pages that contain an exact string for a particular property: <query-database id="{database ID}"><filter-property-text name="{property name}" condition="contains">{text}</filter-property-text></query-database>\n\tUse 'not contains' to find pages that do not contain an exact string for a particular property: <query-database id="{database ID}"><filter-property-text name="{property name}" condition="not contains">{text}</filter-property-text></query-database>\n\tUse 'is' to find pages that match an exact string for a particular property: <query-database id="{database ID}"><filter-property-text name="{property name}" condition="is">{text}</filter-property-text></query-database>\n\tUse 'not is' to find pages that do not match an exact string for a particular property: <query-database id="{database ID}"><filter-property-text name="{property name}" condition="not is">{text}</filter-property-text></query-database>\n\n\tTitle properties work the same as text, except using <filter-property-title>: <query-database id="{database ID}"><filter-property-title name="{property name}" condition="{condition}">{text}</filter-property-title></query-database>\n\tPhone number properties work the same as text, except using <filter-property-phone-number>: <query-database id="{database ID}"><filter-property-phone-number name="{property name}" condition="{condition}">{text}</filter-property-phone-number></query-database>\n\tEmail properties work the same as text, except using <filter-property-email>: <query-database id="{database ID}"><filter-property-email name="{property name}" condition="{condition}">{text}</filter-property-email></query-database>\n\tURL properties work the same as text, except using <filter-property-url>: <query-database id="{database ID}"><filter-property-url name="{property name}" condition="{condition}">{text}</filter-property-url></query-database>\n\n\tQuery database date filters:\n\tUse 'is' to find pages that match an exact date for a particular property: <query-database id="{database ID}"><filter-property-date name="{property name}" condition="is"><mention-date date="{date}"/></filter-property-date></query-database>\n\tUse 'is empty' to find pages that has an empty date for a particular property: <query-database id="{database ID}"><filter-property-date name="{property name}" condition="is empty"/></query-database>\n\tUse '>' to find pages that are after a date for a particular property: <query-database id="{database ID}"><filter-property-date name="{property name}" condition=">"><mention-date date="{date}"/></filter-property-date></query-database>\n\tUse '<' to find pages that are before a date for a particular property: <query-database id="{database ID}"><filter-property-date name="{property name}" condition="<"><mention-date date="{date}"/></filter-property-date></query-database>\n\tUse 'â‰¥' to find pages that are on or after a date for a particular property: <query-database id="{database ID}"><filter-property-date name="{property name}" condition="â‰¥"><mention-date date="{date}"/></filter-property-date></query-database>\n\tUse 'â‰¤' to find pages that are on or before a date for a particular property: <query-database id="{database ID}"><filter-property-date name="{property name}" condition="â‰¤"><mention-date date="{date}"/></filter-property-date></query-database>\n\tYou can also query by date metadata (created-time, last-edited-time). Use the same syntax as above, but with <filter-property-created-time> and <filter-property-last-edited-time> as the tag: e.g. <query-database><filter-property-created-time name="{property name}" condition="is"><mention-date date="{date}"/></filter-property-created-time></query-database>\n\n\tQuery database number filters:\n\tUse 'is' to find pages that match an exact number for a particular property: <query-database id="{database ID}"><filter-property-number name="{property name}" condition="is" number="{number}"/></query-database>\n\tUse 'not is' to find pages that do not match an exact number for a particular property: <query-database id="{database ID}"><filter-property-number name="{property name}" condition="not is" number="{number}"/></query-database>\n\tUse '>' to find pages that are greater than a number for a particular property: <query-database id="{database ID}"><filter-property-number name="{property name}" condition=">" number="{number}"/></query-database>\n\tuse 'â‰¥' to find pages that are greater than or equal to a number for a particular property: <query-database id="{database ID}"><filter-property-number name="{property name}" condition="â‰¥" number="{number}"/></query-database>\n\tUse '<' to find pages that are less than a number for a particular property: <query-database id="{database ID}"><filter-property-number name="{property name}" condition="<" number="{number}"/></query-database>\n\tUse 'â‰¤' to find pages that are less than or equal to a number for a particular property: <query-database id="{database ID}"><filter-property-number name="{property name}" condition="â‰¤" number="{number}"/></query-database>\n\n\tQuery database checkbox filters:\n\tCheckboxes can have either 'true' or 'false' as checked values.\n\tUse 'is' to find pages that match a checkbox value for a particular property: <query-database id="{database ID}"><filter-property-checkbox name="{property name}" condition="is" checked="{true or false}"/></query-database>\n\tUse 'not is' to find pages that do not match a checkbox value for a particular property: <query-database id="{database ID}"><filter-property-checkbox name="{property name}" condition="not is" checked="{true or false}"/></query-database>\n\n\tQuery database select filters:\n\tUse 'is' to find pages that match a select option value for a particular property: <query-database id="{database ID}"><filter-property-select name="{property name}" condition="is"><option option="{option name}"/></filter-property-select></query-database>\n\tUse 'not is' to find pages that do not match a select option value for a particular property: <query-database id="{database ID}"><filter-property-select name="{property name}" condition="not is"><option option="{option name}"/></filter-property-select></query-database>\n\n\tQuery database status filters:\n\tStatus properties are like selects, except each option is a member of an option category.\n\tUse 'is' to find pages that match a status option value for a particular property: <query-database id="{database ID}"><filter-property-status name="{property name}" condition="is"><option option="{option name}"/></filter-property-status></query-database>\n\tUse 'not is' to find pages that do not match a status option value for a particular property: <query-database id="{database ID}"><filter-property-status name="{property name}" condition="not is"><option option="{option name}"/></filter-property-status></query-database>\n\tUse 'is' with a category to find pages that match a status option category for a particular property: <query-database id="{database ID}"><filter-property-status name="{property name}" condition="is"><option-category category="{option category}"/></filter-property-status></query-database>\n\tUse 'not is' with a category to find pages that do not match a status option category for a particular property: <query-database id="{database ID}"><filter-property-status name="{property name}" condition="not is"><option-category category="{option category}"/></filter-property-status></query-database>\n\n\tQuery database multi-select filters:\n\tUse 'contains' to find pages that contain a select option value for a particular property: <query-database id="{database ID}"><filter-property-multi-select name="{property name}" condition="contains"><option option="{option name}"/></filter-property-multi-select></query-database>\n\tUse 'not contains' to find pages that do not contain a select option value for a particular property: <query-database id="{database ID}"><filter-property-multi-select name="{property name}" condition="not contains"><option option="{option name}"/></filter-property-multi-select></query-database>\n\n\tQuery database relation filters:\n\tUse 'contains' to find pages that contain a relation value for a particular property: <query-database id="{database ID}"><filter-property-relation name="{property name}" condition="contains"><mention-page page-id="{page id}"></mention-page></filter-property-relation></query-database>\n\tUse 'not contains' to find pages that do not contain a select option value for a particular property: <query-database id="{database ID}"><filter-property-relation name="{property name}" condition="not contains"><mention-page page-id="{page id}"></mention-page></filter-property-relation></query-database>\n\tTo find the page id for the mention-page tag you will need to query-database on the related database\n\n\tQuery database person filters:\n\tIf your filter requires knowing the ID of a person and it is not already in the current context, you should search people to disambiguate the request, before querying the database.\n\tIf you aren't able to disambiguate exactly which person is being referred to, you can ask for clarification.\n\tUse 'contains' to find pages that contain a person for a particular property: <query-database id="{database ID}"><filter-property-person name="{property name}" condition="contains"><mention-person person-id="{person ID}"/></filter-property-person></query-database>\n\tUse 'not contains' to find pages that do not contain a person for a particular property: <query-database id="{database ID}"><filter-property-person name="{property name}" condition="not contains"><mention-person person-id="{person ID}"/></filter-property-person></query-database>\n\tYou can also query by person metadata (created-by, last-edited-by). Use the same syntax as above, but with <filter-property-created-by> and <filter-property-last-edited-by> as the tag: e.g. <query-database><filter-property-created-by name="{property name}" condition="contains"><mention-person person-id="{person ID}"/></filter-property-created-by></query-database>\n\n\tTo aggregate a specific property within a database query, use an aggregation method within "query-database"\n\tExample: <query-database id="{database ID}"><aggregation-property-number name="Cost" aggregation="Sum"/></query-database>\n\n\tThe aggregation will apply the aggregation method to the results for the property specified.\n\tProvide only one aggregation per query-database request.\n\tThe aggregation can be used with filters and search and will respect the filter and search results when doing the aggregation.\n\tFor a count of all results of a query, you should not use aggregation because those are already included in a database-query-result "total".\n\n\tYou must use the appropriate aggregation tag depending on the type of property being aggregated. For example, if you want to count all the non-empty values in a property of type "Multi Select" then you should use the the "aggregation-property-multi-select" tag with the aggregation "Count not empty".\n\n\tHere are all the available aggregation tag types and the aggregations you can use with them. Note that not all property types have the same aggregations or attributes.\n\t${he}\n\t`,setDatabasePageProperty:'\n\tSet a database page relation property:\n\tTo set a relation property, first look up the page id of the page you want to relate using the database-id of the relation property.\n\tThen use the page-id to set the relation property: <set-property id="{id}"><property-relation name="{name}"><mention-page page-id="{page id}"></mention-page></property-relation></set-property>\n\tTo add a page reference to a relation property, first lookup the page id of the page you want to relate using the database-id of the relation property.\n\tThen use the page-id you found in the query to append the new page id: <insert-inside id="{id}"><property-relation name="{name}"><mention-page page-id="{page id}" /></property-relation></insert-inside>.\n\tThis will add the page-id to the relation property without removing any of the existing values.\n\tTo remove a page reference from a relation property, first lookup the page id of the page you want to relate using the database-id of the relation property.\n\tThen use the page-id you found in the query to remove the page id from the relation: <delete id="{id}" name="{name}"><property-relation name="{name}"><mention-page page-id="{page id}" /></property-relation></delete>.\n\tThis will add the page-id to the relation property without removing any of the existing values.\n\n\tSet a database page person property:\n\tTo set a person property use <set-property>. For example <set-property id="{id}"><property-person name="{name}"><mention-person person-id="{person id}"></mention-person></property-person></set-property>\n\tTo add a value to a person property, use <insert-inside>, for example <insert-inside id="{id}"><property-person name="{name}"><mention-person person-id="{person id}"></mention-person></property-person></insert-inside>\n\tThis will add an additional value to the person property without overwriting it.\n\tTo remove a person from the person property use <delete>. For example,\n\t<delete id="{id}"><property-person name="{name}"><mention-person person-id="{person id}"></mention-person></property-person></delete>\n\n\tSet a database page multi-select property:\n\tTo set a multi-select property use <set-property>. For example <set-property id="{id}"><property-multi-select name="Genre"><option option="Art"/><option option="Photography"/></property-multi-select></set-property>\n\tThis will set the value of the multi-select property to Art and Photography\n\tTo add a value to a multi-select property, use <insert-inside>, for example <insert-inside id="{id}"><property-multi-select name="Genre"><option option="Art"/></property-multi-select></insert-inside>\n\tThis will add Art to the property without deleting removing any existing values.\n\tTo remove a value from a multi-select property use <delete>. For example,\n\t<delete id="{id}"><property-multi-select name="Genre"><option option="Art"/></property-multi-select></delete>\n\tThis will remove the Art option from the multi-select\n\t',searchPeople:'\n\tTo search for people, use "search-people":\n\tSpec: <search-people search="fuzzy match string"/>\n\tExample: <search-people search="james"/>\n\tProvide a fuzzy match string, which can match any part of a user\'s full name or email address.\n\tAfter search-people, before taking any actions that would depend on the result, output <stdout> so you can observe the result.\n\tInside <stdout>, search-people will output a list of possible people that match the search string, including their ID, full name and email address.\n\tWhen you reference a person, use a person mention. This will render as their full name.\n\tSpec: <mention-person person-id="person ID"/>\n\tExample: <mention-person person-id="425"/>\n\t',databaseNewPage:'\n\tInstructions for creating a new page inside a database:\n\tUse "insert-inside" to create a new page inside a database.\n\tSpec: <insert-inside id="{database ID}"><page><property-title name="{Title}">{Page title}</property-title><property-text name="{Another property}">{Property value}</property-text><text>{Optional page content}</text></page></insert-inside>,\n\tYou can only create pages inside databases that are shown in the current context.\n\tWhen referencing a database by ID from a child-database, make sure to use the ID from the database-id attribute.\n\tYou must set at least a title property.\n\tYou can set any number of additional properties, but make sure to only set properties that are explicitly requested.\n\tYou can insert page content by inserting blocks inside the <page> tag after the properties, but only insert page content when explicitly requested.\n\tYou can create multiple pages at once, but only insert multiple pages when explicitly requested.\n\t',tables:'\n\tInstructions for manipulating tables:\n\tTo create a new table: use <insert-after>, <insert-before>, or <insert-inside> with <table>...</table>. For example, here is a table with 2 rows and 2 columns: <table><tr><property-text name="1">Abyssinian</property-text><property-text name="2">Medium length fur, colorful (ticked)</property-text></tr><tr><property-text name="1">Bengal</property-text><property-text name="2">Short hair, leopard-like markings</property-text></tr></table>\n\tTo add a new table column before an existing column: <insert-before id="table ID" name="Insert before column index"><schema-property-text name="New column index"/></insert-before>\n\tTo add a new table column after an existing column: <insert-after id="table ID" name="Insert after column index"><schema-property-text name="New column index"/></insert-after>\n\tTo move a table column before an existing column:  <insert-before id="Table ID" name="Before column ID"><move id="Table ID" name="Move column ID"/></insert-before>\n\tTo move a table column after an existing column:  <insert-after id="Table ID" name="After column ID"><move id="Table ID" name="Move column ID"/></insert-after>\n\tTo delete a table column: <delete id="Table ID" name="Column ID"/>\n\tTo set a table cell value: <set-property id="Row ID"><property-text name="Column index">Cell value</property-text></set-property>\n\tTo clear a table cell value: <set-property id="Row ID"><property-text name="Column index"></property-text></set-property>\n\tTo add a new table row before another row: <insert-before id="Table ID" name="Before row ID"><tr>...</tr></insert-before>\n\tTo add a new table row after another row: <insert-after id="Table ID" name="After row ID"><tr>...</tr></insert-after>\n\tTo move a table row before another row: <insert-before id="Before row ID"><move id="Move row ID"/></insert-before>\n\tTo move a table row after another row: <insert-after id="After row ID"><move id="Move row ID"/></insert-after>\n\tTo delete a table row: <delete id="Row ID"/>\n\t',questionAnswering:"\n\tUse <chat> to provide an answer.\n\tWhen answering questions using information from either <search-results> or <query-database-results>:\n\tWhen answering questions based on <search-results>, a summary and snippet from each page is already shown, so you should not use <load-page> unless you want to edit the content of a page.\n\tWhen answering questions based on <query-database-results>, you will already see the page properties, but you will not be able to see the page content. You may use <load-page> if you want to see or edit the content of a page.\n\tWhen deciding which page-results to use, you should take into account the ordering of the pages in the results as a signal of relevance.\n\tYou should prefer relevant pages with high authority in your answer. Consider page badges, like 'isPopularThisWeek' and 'isMostViewed', as an explicit signal of high authority.\n\n\tYou must cite all pages that were referenced in the answer by wrapping text in a link to the page.\n\tWhen chatting, you must never reference the page ID of the result in plaintext. The page ID should only be used in a link, i.e. <a href=\"page ID\">.\n\n\tIf you found an exact answer to the question, use <chat> to provide a concise summary of the answer.\n\tIf you found multiple pages with exact answers which disagree with each other, use <chat> to state that you found multiple answers, and then to provide a concise summary of the best answers. You must cite all pages that were referenced in the summary.\n\tIf you could not find an exact answer to the question, but found some highly relevant information, use <chat> to state that you could not find an exact answer, and then provide a summary of the relevant information with links to the relevant pages.\n\tIf you cannot find any highly relevant information, use <chat> to politely decline to answer the question, without linking to any pages.\n\tOnly answer the question. Do not respond to the user with follow-up questions or requests.\n\n\tYour answer will be graded according to the following rubric:\n\tClarity: Make sure to be concise and straightforward. You should chat in the same language as the people.\n\tRelevance: Make sure to answer exactly the question that was asked. You should stay on topic and not provide any irrelevant information.\n\tAccuracy: Make sure to accurately summarize the referenced search results. Be careful not to make any assumptions.\n\tTransparency: You should take into account when pages were last edited relative to the current date. You should take into account whether pages are marked as old, outdated, deprecated, etc. If the document is outdated or was last edited a long time ago, you should mention that the answer may not be reliable.\n\n\tYour answer must follow the rubric closely.\n\n\tYour answer must fit in a Tweet with a 280 character limit. Do not go into unnecessary detail. Do not ask clarifying questions.\n\tAim for your answer to be 1-3 sentences.\n\tYou must always cite your sources.\n\t",citations:'\n\tWhen linking to pages or databases:\n\tLinks should be incorporated naturally without negatively affecting the readability of the answer.\n\tLink text should not be overly long (a few key words, not an entire sentence).\n\tLink text should have a connection to the information from the corresponding search result.\n\tDo not link to the same page multiple times.\n\tIf you want to link to a list of pages, you should put each page link on a separate line for readability.\n\tDo not write text that references pages by ID. Instead, use the page title.\n\tFormat for links: <a href="page ID">link text</a>\n\t',selections:"\n\tYou might be shown a selection of blocks or text on the page, indicated by \x3c!--<selection>--\x3e...\x3c!--</selection>--\x3e. If there is a selection, make sure to formulate your response in the context of the selection.\n\t",contextMode:"\n\tInside <context>, you will see an attribute 'mode' which is either 'direct' or 'shared'.\n\tIf the mode is 'direct':\n\tYou are in a direct chat with a single user.\n\tYou must always take an action or respond to every user message.\n\tEven when your instructions specify that you should not respond or take any action, you can still fall back to using <chat> to respond to the user.\n\tIf the mode is 'shared':\n\tYou are in a shared chat with multiple users.\n\tYou should not respond or take actions unless your instructions explicitly specify that you should do so.\n\tWhen you <think>, consider whether you should respond or take an action according to your instructions.\n\t",chainOfThought:"\n\tBefore taking any actions, use <think>:\n\tSpec: <think>{Observation.}{Plan.}</think>\n\tObservation: Briefly summarize the latest state of the current task and context.\n\tPlan: Make a short plan that describes the next actions you will take, considering all of the instructions that are relevant to the current task.\n\tMake sure to include both an observation and a plan.\n\tDo not include any XML tags inside <think>...</think>.\n\tAnything you write inside <think>...</think> will not be shown to people interacting with you.\n\t",languageFollowing:"\n\tWhen chatting or taking any actions, you should use the same language as the people interacting with you, unless explicitly specified otherwise in their message or in your instructions.\n\t"},ye='\nCommands:\n<search question="{question}" keywords="{keywords}" lookback="{lookback}"/>\n<chat>{Blocks}</chat>\n<load-page id="{id}"/>\n<insert-before id="{id}">{Blocks|<move id="{id}"/>}</insert-before>\n<insert-after id="{id}">{Blocks|<move id="{id}"/>}</insert-after>\n<insert-inside id="{id}">{Blocks|<move id="{id}"/>}</insert-inside>\n<delete id="{id}"/>\n<set-title id="{id}">{Inline}</set-title>\n<set-attribute id="{id}" {attribute}={value}/>\n<set-tag-name id="{id}" tag-name={Block tag name}/>\n<set-property id="{id}">{Properties}</set-property>\n\nBlocks:\n<hr/>\n<embed/>\n<h1 color?="{Color}">{Inline}</h1>\n<h2 color?="{Color}">{Inline}</h2>\n<h3 color?="{Color}">{Inline}</h3>\n<text color?="{Color}">{Inline}{Blocks}</text>\n<uli color?="{Color}">{Inline}{Blocks}</uli>\n<uli color?="{Color}">{Inline}{Blocks}</uli>\n<oli color?="{Color}">{Inline}{Blocks}</oli>\n<toggle color?="{Color}">{Inline}{Blocks}</toggle>\n<quote color?="{Color}">{Inline}{Blocks}</quote>\n<todo checked="{true|false}" color?="{Color}">{Inline}{Blocks}</todo>\n<callout color?="{Color}">{Inline}{Blocks}</callout>\n<code-block>{Inline}</code-block>\n<math-block>{Inline}</math-block>\n<columns>{column Blocks}</columns>\n<column>{Blocks}</column>\n<table>{tr Blocks}</table>\n<tr>{property-text Properties}</tr>\n\nInline:\n{String}\n<b>{Inline}</b>\n<i>{Inline}</i>\n<s>{Inline}</s>\n<u>{Inline}</u>\n<a href="{id|url}">{Inline}</a>\n<code>{Inline}</code>\n<h color="{Color}">{Inline}</h>\n\nProperties:\n<property-title name="{name}">{Text}</property-title>\n<property-text name="{name}">{Text}</property-text>\n\nColors:\ndefault\ngray\nbrown\norange\nyellow\ngreen\nblue\npurple\npink\nred\ngray-background\nbrown-background\norange-background\nyellow-background\ngreen-background\nblue-background\npurple-background\npink-background\nred-background\n'.split("\n").map((e=>e.trim())).filter(Boolean).join("\n");for(const Mo of Object.keys(fe))fe[Mo]=fe[Mo].split("\n").map((e=>e.trim())).filter(Boolean).join("\n");Object.values(fe).join("\n\n");function ve(e){return[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.queryDatabase,fe.setDatabasePageProperty,fe.loadingPages,fe.searchPeople,fe.databaseNewPage,fe.blocks,fe.properties,fe.inline,fe.chat,fe.questionAnswering,fe.citations,fe.chainOfThought]}const be=[[{id:7,type:"human",value:'<chat person-id="47" person-name="Shir Yehoshua" datetime="2023-07-11T18:03:53.361-04:00" message-id="48"><text>How do we defend against cross-site scripting attacks?</text></chat>'},{type:"assistant",id:9,value:'<think>The human asked a question. I should search the Security Question Bank database for relevant verified answers.</think><query-database id="5"><filter-property-status name="Status" condition="is"><option option="Verified"/></filter-property-status><search question="How do we defend against cross-site scripting attacks?" keywords="defend cross-site scripting attacks"/></query-database>'}],[{id:6,type:"human",value:'<chat person-id="52" person-name="Simon Last" datetime="2023-07-12T15:03:53.361-04:00" message-id="48"><text>Who is the DPO? What is his contact info?</text></chat>'},{type:"assistant",id:7,value:'<think>The human asked a new question. I will search the Security Question Bank database for any verified answers.</think><query-database id="5"><filter-property-status name="Status" condition="is"><option option="Verified"/></filter-property-status><search question="Who is the DPO? What is his contact info?" keywords="DPO contact info"></search></query-database>'}]],Se=[[{type:"human",id:1,value:'Example where the initial message is not a technical issue or question:\n\n<chat datetime="2023-07-17T14:58:51.410-04:00" message-id="29"><text>papertrail: I\'m going to be rebuilding the gw VPN instances shortly to enable sending logs to splunk. You may notice a very short interruption to anything behind the VPN.</text></chat>'},{type:"assistant",id:2,value:"<think>The human mentioned that they will be rebuilding VPN instances shortly which may cause a very short service interruption. This seems like an announcement and not a technical issue or question, so according to the instructions I should not respond.</think>"}],[{type:"human",id:1,value:'Example where the initial message was a technical issue or question, but there is no existing relevant information in either of the search results. In this case, you should respond declining to answer and incorporate something like: â€œLet me know if you find the answer and I can save it.â€. Later, when someone follows up with a resolution, you should save it to the database.\n\n<chat datetime="2023-07-17T15:02:44.019-04:00" message-id="29"><text>running terraform plan -target module.redis_cluster_v1 in dev will have # module.redis_cluster_v1.aws_security_group.redis_security_group["redis-user-user-similarity"] will be destroyed  is it safe to destroy this? Anyone is working on this tf change in dev?</text></chat>'},{type:"assistant",id:2,value:'<think>The human asked if it is safe to destroy an AWS security group for a Redis cluster module in the dev environment, and if anyone is working on a related Terraform change. I should search the Q&A database and the workspace for any information about this security group or Redis cluster module.</think><query-database id="4"><search question="Is it safe to destroy the aws_security_group.redis_security_group[\'redis-user-user-similarity\'] Terraform resource for the redis_cluster_v1 module in dev? Is anyone actively working on changes related to this resource?" keywords="aws_security_group redis_security_group redis_cluster_v1 resource destroy dev"></search></query-database><search question="Is it safe to destroy the aws_security_group.redis_security_group[\'redis-user-user-similarity\'] Terraform resource for the redis_cluster_v1 module in dev? Is anyone actively working on changes related to this resource?" keywords="aws_security_group redis_security_group redis_cluster_v1 resource destroy dev"></search>'},{type:"observation",id:3,observationType:"queryDatabase",value:'<query-database-results current-results="10" total-results="382">[redacted in example transcript]</query-database-results>'},{type:"observation",id:4,observationType:"search",value:'<search-results current-results="10">[redacted in example transcript]</search-results>'},{type:"assistant",id:5,value:'<think>According to the search results, while there is plenty of information on Terraform, AWS security groups, and auto scaling in general, there is no specific information indicating whether it would be safe to destroy aws_security_group.redis_security_group["redis-user-user-similarity"] when running terraform plan -target module.redis_cluster_v1 in dev. I should inform the human that I could not find an answer to their question.</think><chat><text>Unfortunately, I could not find any information indicating whether it is safe to destroy aws_security_group.redis_security_group["redis-user-user-similarity"] when running <code>terraform plan -target module.redis_cluster_v1</code> in dev.</text><text>Let me know if you find the answer and I can save it.</text></chat>'},{type:"human",id:1,value:'<chat datetime="2023-07-17T15:03:44.019-04:00" message-id="30"><text>Hmm, I\'m not sure, let me check with the team.</text></chat>'},{type:"assistant",id:5,value:"<think><think>The human responded that they are unsure about the safety of destroying the Terraform resource and will check with their team. I should not take any action until they follow up with more information or a confirmation.</think>"},{type:"human",id:1,value:'<chat datetime="2023-07-17T15:04:44.019-04:00" message-id="31"><text>I figured it out: it is safe to destroy.</text></chat>'},{type:"assistant",id:5,value:'<think>The human confirmed that it is safe to destroy the aws_security_group.redis_security_group[\'redis-user-user-similarity\'] Terraform resource for the redis_cluster_v1 module in dev. I should save this resolution to the Q&A database.</think><insert-inside id="4"><page><property-title name="Question">Is it safe to destroy the aws_security_group.redis_security_group[\'redis-user-user-similarity\'] Terraform resource for the redis_cluster_v1 module in dev?</property-title><property-text name="Answer">Yes, it is safe to destroy this Terraform resource according to confirmation from the team.</property-text><property-status name="Status"><option option="Verified"/></property-status></page></insert-inside>'}],[{type:"human",id:1,value:"Example where the initial message was a technical issue or question, and there is existing relevant information the search results. In this case, you should respond via chat.\n\n<chat datetime=\"2023-07-17T18:15:30.805-04:00\" message-id=\"35\"><text>I'm trying to run a 'where in' SQL query but I'm running into an error, what do I do?</text></chat>"},{type:"assistant",id:2,value:'<think>The human reported trying to run a \'WHERE IN\' SQL query but encountering an error. I should search the Q&A database and the workspace for any information about troubleshooting errors with \'WHERE IN\' queries.</think><query-database id="4"><search question="How can errors with \'WHERE IN\' SQL queries be troubleshot and resolved?" keywords="where in query sql error troubleshooting resolve"></search></query-database><search question="How can errors with \'WHERE IN\' SQL queries be troubleshot and resolved?" keywords="where in query sql error troubleshooting resolve"></search>'},{type:"observation",id:3,observationType:"queryDatabase",value:'<query-database-results current-results="10" total-results="382">[redacted in example transcript]</query-database-results>'},{type:"observation",id:4,observationType:"search",value:'<search-results current-results="10">[redacted in example transcript]</search-results>'},{type:"assistant",id:5,value:"<think>According to the search results, the page 'How do I query with a 'where in' clause in Postgres without errors?' provides information on resolving errors with 'where in' SQL queries in Postgres by using '= any' instead. I should summarize this to the user in a response, linking to the page.</think><chat datetime=\"2023-07-17T18:21:43.443-04:00\" message-id=\"35\"><text>The page <a href=\"36\">How do I query with a 'where in' clause in Postgres without errors?</a> explains how to resolve errors running 'where in' queries in Postgres: use '= any' instead, as described on GitHub at <a href=\"https://github.com/makenotion/notion-next/blob/db789eaf666658013b8d01bdfbf2000c1c8dd8a7/src/server/helpers/postgresQueries.ts#L384-L384\">https://github.com/makenotion/notion-next/blob/db789eaf666658013b8d01bdfbf2000c1c8dd8a7/src/server/helpers/postgresQueries.ts#L384-L384</a> and in the Postgres docs at <a href=\"https://www.postgresql.org/docs/current/functions-subquery.html#FUNCTIONS-SUBQUERY-ANY-SOME:~:text=IN%20is%20equivalent%20to%20%3D%20ANY\">https://www.postgresql.org/docs/current/functions-subquery.html#FUNCTIONS-SUBQUERY-ANY-SOME:~:text=IN%20is%20equivalent%20to%20%3D%20ANY</a>.</text><text>So for example, instead of <code>WHERE id IN (?)</code>, you should use <code>= ANY(?)</code> when querying Postgres to avoid errors.</text></chat>"}],[{type:"human",id:1,value:'Example where the initial message was a technical issue or question, and there is existing relevant information the search results. Then, a follow-up message provided new information which requires an update to the saved Q&A entry. In this case, you should update the entry. Make sure to use the â€˜idâ€™ and NOT the â€˜page-idâ€™ attribute from the <child-page>.\n\n<chat datetime="2023-07-17T18:48:59.145-04:00"><text>how do I compose a transaction to send to the server?</text></chat>'},{type:"assistant",id:2,value:'<think>The human asked how to compose a transaction to send to the server. I should search the Q&A database and workspace for information on composing transactions.</think><query-database id="4"><search question="How can transactions be composed and sent to the server?" keywords="compose transaction server send"></search></query-database><search question="How can transactions be composed and sent to the server?" keywords="compose transaction server send"></search>'},{type:"observation",id:3,observationType:"queryDatabase",value:'<query-database-results current-results="10" total-results="340"><child-page id="889" page-id="923"><property-title name="Question">What\'s the easiest way to craft and send a custom transaction from the client?</property-title><property-text name="Answer">src/tools/saveTransactions.ts provides a simple way to craft and send custom transactions, without needing to call __console.api.saveTransactions from the client.</property-text><property-last-edited-time name="Last edited"><mention-datetime date="2023-07-17" time="18:15"/></property-last-edited-time><property-status name="Status"><option option="Verified"/></property-status></child-page>[redacted in example transcript]</query-database-results>'},{type:"observation",id:4,observationType:"search",value:'<search-results current-results="10">[redacted in example transcript]</search-results>'},{type:"assistant",id:5,value:"<think>The search results contain the page 'What's the easiest way to craft and send a custom transaction from the client?', which explains that src/tools/saveTransactions.ts provides a simple way to compose and send custom transactions without calling __console.api.saveTransactions from the client. I should summarize this for the human in a response.</think><chat><text>According to <a href=\"923\">What's the easiest way to craft and send a custom transaction from the client?</a>, a simple way to compose and send custom transactions is by using src/tools/saveTransactions.ts instead of calling __console.api.saveTransactions directly from the client.</text><text>The page notes: \"src/tools/saveTransactions.ts provides a simple way to craft and send custom transactions, without needing to call __console.api.saveTransactions from the client.\"</text><text>So by using that tool, you can compose and submit transactions to the server more easily.</text></chat>"},{type:"human",id:1,value:'<chat datetime="2023-07-17T18:48:59.146-04:00"><text>I tried that and it didn\'t work. I think src/tools/saveTransactions.ts has been deleted. There is a new file called cli/main/saveTransactions.ts, which did work though.</text></chat>'},{type:"assistant",id:2,value:'<think>The human reported that src/tools/saveTransactions.ts does not work for composing and sending transactions because it seems to have been deleted. They noted that cli/main/saveTransactions.ts does work however. I should update the existing Q&A entry for \'What\'s the easiest way to craft and send a custom transaction from the client?\' to reflect this new information.</think><set-property id="889"><property-text name="Answer">cli/main/saveTransactions.ts provides a simple way to craft and send custom transactions, without needing to call __console.api.saveTransactions from the client. src/tools/saveTransactions.ts has been removed.</property-text></set-property>'}]],_e=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-12T12:18:50.009-07:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Javascript getting started guide</property-title></page>',id:2},{id:3,type:"human",value:"<chat><text>fill this page with a short javascript getting started guide</text></chat>"},{type:"assistant",id:5,value:'<think>The human is requesting to fill the empty page with a short Javascript getting started guide. I should use insert-inside to add introductory content and several sections describing variables, functions, loops, objects, and arrays in Javascript.</think><insert-inside id="0"><h1>Getting started with Javascript</h1><text>Javascript is a lightweight, interpreted programming language that runs on the client side of web applications. This guide will cover some of the basic building blocks of JS to get you started.</text><h2>Variables</h2><text>Variables are containers for storing data. They are declared with the <code>let</code> keyword:</text><text><code>let age = 30;</code></text><text>This creates a variable named <code>age</code> with the value <code>30</code>.</text><h2>Functions</h2><text>Functions are blocks of code designed to perform a particular task. They are declared with the <code>function</code> keyword:</text><text><code>function name(params) { /* function body */ }</code></text><text>This creates a function called <code>name</code> that takes <code>params</code> as arguments with the given function body.</text><h2>Loops</h2><text>Loops execute blocks of code repeatedly. The for loop is commonly used in JS:</text><text><code>for (let i = 0; i < 5; i++) { /* loop body */ }</code></text><text>This loop will execute the loop body 5 times with the variable i ranging from 0 to 4.</text><h2>Objects</h2><text>Objects are collections of related data in key/value pairs: </text><text><code>let user = {</code></text><text><code>name: "John",</code></text><text><code>age: 30</code></text><text><code>};</code></text><text>This creates an object <code>user</code> with properties <code>name</code> and <code>age</code>.</text><h2>Arrays</h2><text>Arrays are lists of values stored at numbered indices: </text><text><code>let fruits = ["Apple", "Banana"];</code></text><text>This creates an array <code>fruits</code> with elements "Apple" and "Banana" at indices 0 and 1 respectively.</text></insert-inside>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Javascript getting started guide</property-title><h1 id="809">Getting started with Javascript</h1><text id="810">Javascript is a lightweight, interpreted programming language that runs on the client side of web applications. This guide will cover some of the basic building blocks of JS to get you started.</text><h2 id="811">Variables</h2><text id="812">Variables are containers for storing data. They are declared with the <code>let</code> keyword:</text><text id="813"><code>let age = 30;</code></text><text id="814">This creates a variable named <code>age</code> with the value <code>30</code>.</text><h2 id="815">Functions</h2><text id="816">Functions are blocks of code designed to perform a particular task. They are declared with the <code>function</code> keyword:</text><text id="817"><code>function name(params) { /* function body */ }</code></text><text id="818">This creates a function called <code>name</code> that takes <code>params</code> as arguments with the given function body.</text><h2 id="819">Loops</h2><text id="820">Loops execute blocks of code repeatedly. The for loop is commonly used in JS:</text><text id="821"><code>for (let i = 0; i < 5; i++) { /* loop body */ }</code></text><text id="822">This loop will execute the loop body 5 times with the variable i ranging from 0 to 4.</text><h2 id="823">Objects</h2><text id="824">Objects are collections of related data in key/value pairs: </text><text id="825"><code>let user = {</code></text><text id="826"><code>name: "John",</code></text><text id="827"><code>age: 30</code></text><text id="828"><code>};</code></text><text id="829">This creates an object <code>user</code> with properties <code>name</code> and <code>age</code>.</text><h2 id="830">Arrays</h2><text id="831">Arrays are lists of values stored at numbered indices: </text><text id="832"><code>let fruits = ["Apple", "Banana"];</code></text><text id="833">This creates an array <code>fruits</code> with elements "Apple" and "Banana" at indices 0 and 1 respectively.</text></page>',id:13},{id:14,type:"human",value:"<chat><text>make all the headers big</text></chat>"},{type:"assistant",id:15,value:'<think>The human asked to make all the headers bigger. I should use set-tag-name to increase the size of all h1 and h2 blocks.</think><set-tag-name id="809" tag-name="h1"/><set-tag-name id="811" tag-name="h1"/><set-tag-name id="815" tag-name="h1"/><set-tag-name id="819" tag-name="h1"/><set-tag-name id="823" tag-name="h1"/><set-tag-name id="830" tag-name="h1"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Javascript getting started guide</property-title><h1 id="809">Getting started with Javascript</h1><text id="810">Javascript is a lightweight, interpreted programming language that runs on the client side of web applications. This guide will cover some of the basic building blocks of JS to get you started.</text><h1 id="811">Variables</h1><text id="812">Variables are containers for storing data. They are declared with the <code>let</code> keyword:</text><text id="813"><code>let age = 30;</code></text><text id="814">This creates a variable named <code>age</code> with the value <code>30</code>.</text><h1 id="815">Functions</h1><text id="816">Functions are blocks of code designed to perform a particular task. They are declared with the <code>function</code> keyword:</text><text id="817"><code>function name(params) { /* function body */ }</code></text><text id="818">This creates a function called <code>name</code> that takes <code>params</code> as arguments with the given function body.</text><h1 id="819">Loops</h1><text id="820">Loops execute blocks of code repeatedly. The for loop is commonly used in JS:</text><text id="821"><code>for (let i = 0; i < 5; i++) { /* loop body */ }</code></text><text id="822">This loop will execute the loop body 5 times with the variable i ranging from 0 to 4.</text><h1 id="823">Objects</h1><text id="824">Objects are collections of related data in key/value pairs: </text><text id="825"><code>let user = {</code></text><text id="826"><code>name: "John",</code></text><text id="827"><code>age: 30</code></text><text id="828"><code>};</code></text><text id="829">This creates an object <code>user</code> with properties <code>name</code> and <code>age</code>.</text><h1 id="830">Arrays</h1><text id="831">Arrays are lists of values stored at numbered indices: </text><text id="832"><code>let fruits = ["Apple", "Banana"];</code></text><text id="833">This creates an array <code>fruits</code> with elements "Apple" and "Banana" at indices 0 and 1 respectively.</text></page>',id:26},{id:27,type:"human",value:"<chat><text>add more detail about the different kinds of functions</text></chat>"},{type:"assistant",id:28,value:'<think>The human asked to add more detail about the different kinds of functions in Javascript. Below the existing content on functions, I should add explanations of arrow functions, generator functions, and async functions.</think><insert-after id="818"><text>Arrow functions are shorthand functions using the => syntax:</text><text><code>let sum = (a, b) => a + b;</code></text><text>Generator functions iterate over when called multiple times:</text><text><code>function* generatorFunction() { /* ... */ }</code></text><text>Async functions return promises and enable asynchronous operations:</text><text><code>async function myFunc() { /* ... */ }</code></text></insert-after>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-12T12:37:27.640-07:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Ancient Greek History </property-title><h3 id="1">Early History to Peloponnesian War</h3><text id="2">Around 1600 BC, the ancient Greeks appeared and quickly developed art, literature, philosophy and more.</text><text id="3">In short, around 800 to 500 BC, Archaic Greece emerged defined by seminal advances in the arts, law, and philosophy that forged a unique Greek identity.  Art moved from geometric designs to naturalistic kouroi sculptures and monumental stone temples.  Law evolved from oral poetry into first codes of law.  Reason supplanted myth as philosophy dawned, expounded by thinkers like Thales and Pythagoras.  New poetic forms like the lyric appeared, immortalized in performances at aristocratic banquets.  Before besting the Persians in the early fifth century, the Archaic Period seeded the unparalleled efflorescence of Classical Greece in just a few centuries by cultivating a shared Greek culture across arts, law, language, customs, and habits of mind.  Anchored in the polis or city-state and dressed in the beauty, intellect, and might of the Hellenes at large, Archaic Greece abides in history eternal. </text><h3 id="4">Archaic Greek States and Colonies, ~750 to 480 BC</h3><text id="5">One main feature of ancient Greece was the city-state. Places like Athens and Sparta were separate states that often disagreed and competed with each other. Each city-state had its own unique ideas and priorities.</text><h3 id="6">Classical Greek Civilization, ~500 to 400 BC</h3><text id="7">Most think the Golden Age of Greece was from around 500 to 300 BC. This was a time of major achievement in art, literature, philosophy and more. The biggest names from then are people like Socrates, Plato and Aristotle.</text><text id="8">Philosophers and writers in all city-states searched for financial supporters, producing outstanding artistic and intellectual works. Cities formed both defensive alliances and openly fought in an increasingly tangled web of deals between them. So the land cities controlled kept changing in size over the centuries, depending on military wins and what alliances each city gained or lost.</text><h3 id="9">Northern Frontiers and Distant Colonies</h3><text id="10">However far adventurers from any state wandered though, philosophy was popular back home, holding thinkers\' attention the way myths of golden riches overseas held merchants\' daydreams. If war disrupted study at times, thinkers could still entertain upper-class women with word games seeming almost to unwind anxious nights like rest unwinds after exertion of body or mind.</text><text id="11">So while Athens rightly comes first as a power and leader, Corinth is a close second; but looking here or there alone does little justice to the wine-dark realms Greeks of yore claimed far and wide and plyed no less for being - in no way lacking immense or profound or holding a stunted destiny, however wandering Greeks now lie strewn over night skies\' brilliance like so many imperishable stars, no less exalting to ponder even now. </text><text id="12"></text><h3 id="13">The Delian League, 478 BC</h3><text id="14">With the defeat of Xerxes, Athens founded the Delian League around 478 BC. The alliance of Greek city-states had the shared goal of liberating Greeks still under Persian rule, as well as preventing future invasions. The treasury and meeting place of the Delian League was on the island of Delos, and Athens held a position of leadership over the other allies.</text></page>',id:2},{id:3,type:"human",value:"<chat><text>make sure all the headers have dates</text></chat>"},{type:"assistant",id:4,value:'<think>The human is requesting that all headers in the page have dates. I will use set-title to add dates to each header.</think><set-title id="1">Early History to Peloponnesian War ~1600 BC-500 BC</set-title><set-title id="4">Archaic Greek States and Colonies, ~750 BC to 480 BC</set-title><set-title id="6">Classical Greek Civilization, ~500 BC to 400 BC</set-title><set-title id="9">Northern Frontiers and Distant Colonies ~800 BC-300 BC</set-title><set-title id="13">The Delian League, 478 BC</set-title>'}]],we=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"1","current-datetime":"2023-05-12T12:31:33.318-07:00"}},{id:1,type:"assistant",value:'<load-page id="1"/>'},{type:"observation",observationType:"page",pageId:"1",value:'<page id="1"><property-title name="Title">Ancient Greek History </property-title><h3 id="2">Early History to Peloponnesian War</h3><text id="3">Around 1600 BC, the ancient Greeks appeared and quickly developed art, literature, philosophy and more.</text><text id="4">In short, around 800 to 500 BC, Archaic Greece emerged defined by seminal advances in the arts, law, and philosophy that forged a unique Greek identity.  Art moved from geometric designs to naturalistic kouroi sculptures and monumental stone temples.  Law evolved from oral poetry into first codes of law.  Reason supplanted myth as philosophy dawned, expounded by thinkers like Thales and Pythagoras.  New poetic forms like the lyric appeared, immortalized in performances at aristocratic banquets.  Before besting the Persians in the early fifth century, the Archaic Period seeded the unparalleled efflorescence of Classical Greece in just a few centuries by cultivating a shared Greek culture across arts, law, language, customs, and habits of mind.  Anchored in the polis or city-state and dressed in the beauty, intellect, and might of the Hellenes at large, Archaic Greece abides in history eternal. </text><h3 id="5">Archaic Greek States and Colonies, ~750 to 480 BC</h3><text id="6">One main feature of ancient Greece was the city-state. Places like Athens and Sparta were separate states that often disagreed and competed with each other. Each city-state had its own unique ideas and priorities.</text><h3 id="7">Classical Greek Civilization, ~500 to 400 BC</h3><text id="8">Most think the Golden Age of Greece was from around 500 to 300 BC. This was a time of major achievement in art, literature, philosophy and more. The biggest names from then are people like Socrates, Plato and Aristotle.</text><text id="9">Philosophers and writers in all city-states searched for financial supporters, producing outstanding artistic and intellectual works. Cities formed both defensive alliances and openly fought in an increasingly tangled web of deals between them. So the land cities controlled kept changing in size over the centuries, depending on military wins and what alliances each city gained or lost.</text><h3 id="10">Northern Frontiers and Distant Colonies</h3><text id="11">However far adventurers from any state wandered though, philosophy was popular back home, holding thinkers\' attention the way myths of golden riches overseas held merchants\' daydreams. If war disrupted study at times, thinkers could still entertain upper-class women with word games seeming almost to unwind anxious nights like rest unwinds after exertion of body or mind.</text><text id="12">So while Athens rightly comes first as a power and leader, Corinth is a close second; but looking here or there alone does little justice to the wine-dark realms Greeks of yore claimed far and wide and plyed no less for being - in no way lacking immense or profound or holding a stunted destiny, however wandering Greeks now lie strewn over night skies\' brilliance like so many imperishable stars, no less exalting to ponder even now. </text><text id="0">\x3c!--<selection>--\x3e\x3c!--</selection>--\x3e</text><h3 id="13">The Delian League, 478 BC</h3><text id="14">With the defeat of Xerxes, Athens founded the Delian League around 478 BC. The alliance of Greek city-states had the shared goal of liberating Greeks still under Persian rule, as well as preventing future invasions. The treasury and meeting place of the Delian League was on the island of Delos, and Athens held a position of leadership over the other allies.</text></page>',id:2},{id:3,type:"human",value:"<chat><text>add another paragraph</text></chat>"},{id:4,type:"assistant",value:'<think>The user is requesting another paragraph to be added below their cursor. I will use insert-after to add another paragraph.</think><insert-after id="12"><text>The Greeks ventured far across the Mediterranean and Black Seas, establishing colonies on islands such as Cyprus, Crete and Rhodes as well as along coastlines and rivers of places like Italy, Sicily, North Africa and Crimea. These colonies allowed for greater trade, spread of Greek culture and acquisition of resources but they were still politically affiliated with and dependent on their mother city. Navigation and trade were dangerous so the sea was both a barrier as well as a highway for the Greeks.</text></insert-after>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"1","current-datetime":"2023-05-12T12:33:54.975-07:00"}},{id:1,type:"assistant",value:'<load-page id="1"/>'},{type:"observation",observationType:"page",pageId:"1",value:'<page id="1"><property-title name="Title">Javascript getting started guide</property-title><h1 id="2">Getting started with Javascript</h1><text id="3">Javascript is a lightweight, interpreted programming language that runs on the client side of web applications. This guide will cover some of the basic building blocks of JS to get you started.</text><h1 id="4">Variables</h1><text id="5">Variables are containers for storing data. They are declared with the <code>let</code> keyword:</text><text id="6"><code>let age = 30;</code></text><text id="7">This creates a variable named <code>age</code> with the value <code>30</code>.</text><h1 id="8">Functions</h1><text id="0">\x3c!--<selection>--\x3e\x3c!--</selection>--\x3e</text><text id="9">Functions are blocks of code designed to perform a particular task. They are declared with the <code>function</code> keyword:</text><text id="10"><code>function name(params) { /* function body */ }</code></text><text id="11">This creates a function called <code>name</code> that takes <code>params</code> as arguments with the given function body.</text><text id="12">Arrow functions are shorthand functions using the => syntax:</text><text id="13"><code>let sum = (a, b) => a + b;</code></text><text id="14">Generator functions iterate over when called multiple times:</text><text id="15"><code>function* generatorFunction() { /* ... */ }</code></text><text id="16">Async functions return promises and enable asynchronous operations:</text><text id="17"><code>async function myFunc() { /* ... */ }</code></text><h1 id="18">Loops</h1><text id="19">Loops execute blocks of code repeatedly. The for loop is commonly used in JS:</text><text id="20"><code>for (let i = 0; i < 5; i++) { /* loop body */ }</code></text><text id="21">This loop will execute the loop body 5 times with the variable i ranging from 0 to 4.</text><h1 id="22">Objects</h1><text id="23">Objects are collections of related data in key/value pairs: </text><text id="24"><code>let user = {</code></text><text id="25"><code>name: "John",</code></text><text id="26"><code>age: 30</code></text><text id="27"><code>};</code></text><text id="28">This creates an object <code>user</code> with properties <code>name</code> and <code>age</code>.</text><h1 id="29">Arrays</h1><text id="30">Arrays are lists of values stored at numbered indices: </text><text id="31"><code>let fruits = ["Apple", "Banana"];</code></text><text id="32">This creates an array <code>fruits</code> with elements "Apple" and "Banana" at indices 0 and 1 respectively.</text></page>',id:2},{id:3,type:"human",value:"<chat><text>add a subheader</text></chat>"},{id:4,type:"assistant",value:'<think>The user is requesting a subheader to be added below their cursor. I will use insert-after to add an h3 subheader.</think><insert-after id="0"><h3>Function expressions</h3></insert-after>'}]],ke=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"1","current-datetime":"2023-05-12T12:35:32.124-07:00"}},{id:1,type:"assistant",value:'<load-page id="1"/>'},{type:"observation",observationType:"page",pageId:"1",value:'<page id="1"><property-title name="Title">Javascript getting started guide</property-title><h1 id="2">Getting started with Javascript</h1><text id="0">\x3c!--<selection>--\x3eJavascript is a lightweight, interpreted programming language that runs on the client side of web applications. This guide will cover some of the basic building blocks of JS to get you started.\x3c!--</selection>--\x3e</text><h1 id="3">Variables</h1><text id="4">Variables are containers for storing data. They are declared with the <code>let</code> keyword:</text><text id="5"><code>let age = 30;</code></text><text id="6">This creates a variable named <code>age</code> with the value <code>30</code>.</text><h1 id="7">Functions</h1><text id="8"></text><text id="9">Functions are blocks of code designed to perform a particular task. They are declared with the <code>function</code> keyword:</text><text id="10"><code>function name(params) { /* function body */ }</code></text><text id="11">This creates a function called <code>name</code> that takes <code>params</code> as arguments with the given function body.</text><text id="12">Arrow functions are shorthand functions using the => syntax:</text><text id="13"><code>let sum = (a, b) => a + b;</code></text><text id="14">Generator functions iterate over when called multiple times:</text><text id="15"><code>function* generatorFunction() { /* ... */ }</code></text><text id="16">Async functions return promises and enable asynchronous operations:</text><text id="17"><code>async function myFunc() { /* ... */ }</code></text><h1 id="18">Loops</h1><text id="19">Loops execute blocks of code repeatedly. The for loop is commonly used in JS:</text><text id="20"><code>for (let i = 0; i < 5; i++) { /* loop body */ }</code></text><text id="21">This loop will execute the loop body 5 times with the variable i ranging from 0 to 4.</text><h1 id="22">Objects</h1><text id="23">Objects are collections of related data in key/value pairs: </text><text id="24"><code>let user = {</code></text><text id="25"><code>name: "John",</code></text><text id="26"><code>age: 30</code></text><text id="27"><code>};</code></text><text id="28">This creates an object <code>user</code> with properties <code>name</code> and <code>age</code>.</text><h1 id="29">Arrays</h1><text id="30">Arrays are lists of values stored at numbered indices: </text><text id="31"><code>let fruits = ["Apple", "Banana"];</code></text><text id="32">This creates an array <code>fruits</code> with elements "Apple" and "Banana" at indices 0 and 1 respectively.</text></page>',id:2},{id:3,type:"human",value:"<chat><text>make this two sentences</text></chat>"},{id:4,type:"assistant",value:'<think>The user is requesting the selected text to be split into two sentences. I will use set-title to split the text into two sentences.</think><set-title id="0">Javascript is a lightweight, interpreted programming language that runs on the client side of web applications. This guide will cover some of the basic building blocks of JS to get you started.</set-title>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"1","current-datetime":"2023-05-12T12:36:19.626-07:00"}},{id:1,type:"assistant",value:'<load-page id="1"/>'},{type:"observation",observationType:"page",pageId:"1",value:'<page id="1"><property-title name="Title">Ancient Greek History </property-title><h3 id="2">Early History to Peloponnesian War</h3><text id="3">Around 1600 BC, the ancient Greeks appeared and quickly developed art, literature, philosophy and more.</text><text id="4">In short, around 800 to 500 BC, Archaic Greece emerged defined by seminal advances in the arts, law, and philosophy that forged a unique Greek identity.  Art moved from geometric designs to naturalistic kouroi sculptures and monumental stone temples.  Law evolved from oral poetry into first codes of law.  Reason supplanted myth as philosophy dawned, expounded by thinkers like Thales and Pythagoras.  New poetic forms like the lyric appeared, immortalized in performances at aristocratic banquets.  Before besting the Persians in the early fifth century, the Archaic Period seeded the unparalleled efflorescence of Classical Greece in just a few centuries by cultivating a shared Greek culture across arts, law, language, customs, and habits of mind.  Anchored in the polis or city-state and dressed in the beauty, intellect, and might of the Hellenes at large, Archaic Greece abides in history eternal. </text><h3 id="5">Archaic Greek States and Colonies, ~750 to 480 BC</h3><text id="6">One main feature of ancient Greece was the city-state. Places like Athens and Sparta were separate states that often disagreed and competed with each other. Each city-state had its own unique ideas and priorities.</text><h3 id="7">Classical Greek Civilization, ~500 to 400 BC</h3><text id="8">Most think the Golden Age of Greece was from around 500 to 300 BC. This was a time of major achievement in art, literature, philosophy and more. The biggest names from then are people like Socrates, Plato and Aristotle.</text><text id="9">Philosophers and writers in all city-states searched for financial supporters, producing outstanding artistic and intellectual works. Cities formed both defensive alliances and openly fought in an increasingly tangled web of deals between them. So the land cities controlled kept changing in size over the centuries, depending on military wins and what alliances each city gained or lost.</text><h3 id="0">\x3c!--<selection>--\x3eNorthern Frontiers and Distant Colonies\x3c!--</selection>--\x3e</h3><text id="10">However far adventurers from any state wandered though, philosophy was popular back home, holding thinkers\' attention the way myths of golden riches overseas held merchants\' daydreams. If war disrupted study at times, thinkers could still entertain upper-class women with word games seeming almost to unwind anxious nights like rest unwinds after exertion of body or mind.</text><text id="11">So while Athens rightly comes first as a power and leader, Corinth is a close second; but looking here or there alone does little justice to the wine-dark realms Greeks of yore claimed far and wide and plyed no less for being - in no way lacking immense or profound or holding a stunted destiny, however wandering Greeks now lie strewn over night skies\' brilliance like so many imperishable stars, no less exalting to ponder even now. </text><text id="12"></text><h3 id="13">The Delian League, 478 BC</h3><text id="14">With the defeat of Xerxes, Athens founded the Delian League around 478 BC. The alliance of Greek city-states had the shared goal of liberating Greeks still under Persian rule, as well as preventing future invasions. The treasury and meeting place of the Delian League was on the island of Delos, and Athens held a position of leadership over the other allies.</text></page>',id:2},{id:3,type:"human",value:"<chat><text>add dates to this</text></chat>"},{id:4,type:"assistant",value:'<think>The user is asking for additional information about dates to be added to this subheader. I will use set-title to edit the subheader to add approximate dates.</think><set-title id="0">Northern Frontiers and Distant Colonies (c.a. 480-400 BCE)</set-title>'}]],xe=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"1","current-datetime":"2023-05-12T12:25:11.212-07:00"}},{id:1,type:"assistant",value:'<load-page id="1"/>'},{type:"observation",observationType:"page",pageId:"1",value:'<page id="1"><property-title name="Title">Javascript getting started guide</property-title><h1 id="2">Getting started with Javascript</h1>\x3c!--<selection>--\x3e<text id="0">Javascript is a lightweight, interpreted programming language that runs on the client side of web applications. This guide will cover some of the basic building blocks of JS to get you started.</text>\x3c!--</selection>--\x3e<h1 id="3">Variables</h1><text id="4">Variables are containers for storing data. They are declared with the <code>let</code> keyword:</text><text id="5"><code>let age = 30;</code></text><text id="6">This creates a variable named <code>age</code> with the value <code>30</code>.</text><h1 id="7">Functions</h1><text id="8">Functions are blocks of code designed to perform a particular task. They are declared with the <code>function</code> keyword:</text><text id="9"><code>function name(params) { /* function body */ }</code></text><text id="10">This creates a function called <code>name</code> that takes <code>params</code> as arguments with the given function body.</text><text id="11">Arrow functions are shorthand functions using the => syntax:</text><text id="12"><code>let sum = (a, b) => a + b;</code></text><text id="13">Generator functions iterate over when called multiple times:</text><text id="14"><code>function* generatorFunction() { /* ... */ }</code></text><text id="15">Async functions return promises and enable asynchronous operations:</text><text id="16"><code>async function myFunc() { /* ... */ }</code></text><h1 id="17">Loops</h1><text id="18">Loops execute blocks of code repeatedly. The for loop is commonly used in JS:</text><text id="19"><code>for (let i = 0; i < 5; i++) { /* loop body */ }</code></text><text id="20">This loop will execute the loop body 5 times with the variable i ranging from 0 to 4.</text><h1 id="21">Objects</h1><text id="22">Objects are collections of related data in key/value pairs: </text><text id="23"><code>let user = {</code></text><text id="24"><code>name: "John",</code></text><text id="25"><code>age: 30</code></text><text id="26"><code>};</code></text><text id="27">This creates an object <code>user</code> with properties <code>name</code> and <code>age</code>.</text><h1 id="28">Arrays</h1><text id="29">Arrays are lists of values stored at numbered indices: </text><text id="30"><code>let fruits = ["Apple", "Banana"];</code></text><text id="31">This creates an array <code>fruits</code> with elements "Apple" and "Banana" at indices 0 and 1 respectively.</text></page>',id:2},{id:3,type:"human",value:"<chat><text>make this one sentence</text></chat>"},{id:4,type:"assistant",value:'<think>The user asked to make the selected block one sentence. I should use set-title to condense it.</think><set-title id="0">Javascript is a lightweight, interpreted programming language that runs on the client side of web applications and this guide will cover some of the basic building blocks of JS to get you started.</set-title>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"3","current-datetime":"2023-05-12T12:28:33.732-07:00"}},{id:1,type:"assistant",value:'<load-page id="3"/>'},{type:"observation",observationType:"page",pageId:"3",value:'<page id="3"><property-title name="Title">Ancient Greek History </property-title><h3 id="4">Early History to Peloponnesian War</h3><text id="5">Around 1600 BC, the ancient Greeks appeared and quickly developed art, literature, philosophy and more.</text><text id="6">In short, around 800 to 500 BC, Archaic Greece emerged defined by seminal advances in the arts, law, and philosophy that forged a unique Greek identity.  Art moved from geometric designs to naturalistic kouroi sculptures and monumental stone temples.  Law evolved from oral poetry into first codes of law.  Reason supplanted myth as philosophy dawned, expounded by thinkers like Thales and Pythagoras.  New poetic forms like the lyric appeared, immortalized in performances at aristocratic banquets.  Before besting the Persians in the early fifth century, the Archaic Period seeded the unparalleled efflorescence of Classical Greece in just a few centuries by cultivating a shared Greek culture across arts, law, language, customs, and habits of mind.  Anchored in the polis or city-state and dressed in the beauty, intellect, and might of the Hellenes at large, Archaic Greece abides in history eternal. </text><h3 id="7">Archaic Greek States and Colonies, ~750 to 480 BC</h3><text id="8">One main feature of ancient Greece was the city-state. Places like Athens and Sparta were separate states that often disagreed and competed with each other. Each city-state had its own unique ideas and priorities.</text><h3 id="9">Classical Greek Civilization, ~500 to 400 BC</h3><text id="10">Most think the Golden Age of Greece was from around 500 to 300 BC. This was a time of major achievement in art, literature, philosophy and more. The biggest names from then are people like Socrates, Plato and Aristotle.</text><text id="11">Philosophers and writers in all city-states searched for financial supporters, producing outstanding artistic and intellectual works. Cities formed both defensive alliances and openly fought in an increasingly tangled web of deals between them. So the land cities controlled kept changing in size over the centuries, depending on military wins and what alliances each city gained or lost.</text>\x3c!--<selection>--\x3e<h3 id="0">Northern Frontiers and Distant Colonies</h3>\x3c!--</selection>--\x3e\x3c!--<selection>--\x3e<text id="1">However far adventurers from any state wandered though, philosophy was popular back home, holding thinkers\' attention the way myths of golden riches overseas held merchants\' daydreams. If war disrupted study at times, thinkers could still entertain upper-class women with word games seeming almost to unwind anxious nights like rest unwinds after exertion of body or mind.</text>\x3c!--</selection>--\x3e\x3c!--<selection>--\x3e<text id="2">So while Athens rightly comes first as a power and leader, Corinth is a close second; but looking here or there alone does little justice to the wine-dark realms Greeks of yore claimed far and wide and plyed no less for being - in no way lacking immense or profound or holding a stunted destiny, however wandering Greeks now lie strewn over night skies\' brilliance like so many imperishable stars, no less exalting to ponder even now. </text>\x3c!--</selection>--\x3e<h3 id="12">The Delian League, 478 BC</h3><text id="13">With the defeat of Xerxes, Athens founded the Delian League around 478 BC. The alliance of Greek city-states had the shared goal of liberating Greeks still under Persian rule, as well as preventing future invasions. The treasury and meeting place of the Delian League was on the island of Delos, and Athens held a position of leadership over the other allies.</text></page>',id:2},{id:3,type:"human",value:"<chat><text>remove this section</text></chat>"},{id:4,type:"assistant",value:'<think>The user asked to remove the currently selected section and the following two paragraphs. I will use delete to remove them.</think><delete id="0"/><delete id="1"/><delete id="2"/>'}]],Ie=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-12T12:39:09.785-07:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Ancient Greek History </property-title><h3 id="1">Early History to Peloponnesian War ~1600 BC-500 BC</h3><text id="2">Around 1600 BC, the ancient Greeks appeared and quickly developed art, literature, philosophy and more.</text><text id="3">In short, around 800 to 500 BC, Archaic Greece emerged defined by seminal advances in the arts, law, and philosophy that forged a unique Greek identity.  Art moved from geometric designs to naturalistic kouroi sculptures and monumental stone temples.  Law evolved from oral poetry into first codes of law.  Reason supplanted myth as philosophy dawned, expounded by thinkers like Thales and Pythagoras.  New poetic forms like the lyric appeared, immortalized in performances at aristocratic banquets.  Before besting the Persians in the early fifth century, the Archaic Period seeded the unparalleled efflorescence of Classical Greece in just a few centuries by cultivating a shared Greek culture across arts, law, language, customs, and habits of mind.  Anchored in the polis or city-state and dressed in the beauty, intellect, and might of the Hellenes at large, Archaic Greece abides in history eternal. </text><h3 id="4">Archaic Greek States and Colonies, ~750 BC to 480 BC</h3><text id="5">One main feature of ancient Greece was the city-state. Places like Athens and Sparta were separate states that often disagreed and competed with each other. Each city-state had its own unique ideas and priorities.</text><h3 id="6">Classical Greek Civilization, ~500 BC to 400 BC</h3><text id="7">Most think the Golden Age of Greece was from around 500 to 300 BC. This was a time of major achievement in art, literature, philosophy and more. The biggest names from then are people like Socrates, Plato and Aristotle.</text><text id="8">Philosophers and writers in all city-states searched for financial supporters, producing outstanding artistic and intellectual works. Cities formed both defensive alliances and openly fought in an increasingly tangled web of deals between them. So the land cities controlled kept changing in size over the centuries, depending on military wins and what alliances each city gained or lost.</text><h3 id="9">Northern Frontiers and Distant Colonies ~800 BC-300 BC</h3><text id="10">However far adventurers from any state wandered though, philosophy was popular back home, holding thinkers\' attention the way myths of golden riches overseas held merchants\' daydreams. If war disrupted study at times, thinkers could still entertain upper-class women with word games seeming almost to unwind anxious nights like rest unwinds after exertion of body or mind.</text><text id="11">So while Athens rightly comes first as a power and leader, Corinth is a close second; but looking here or there alone does little justice to the wine-dark realms Greeks of yore claimed far and wide and plyed no less for being - in no way lacking immense or profound or holding a stunted destiny, however wandering Greeks now lie strewn over night skies\' brilliance like so many imperishable stars, no less exalting to ponder even now. </text><text id="12"></text><h3 id="13">The Delian League, 478 BC</h3><text id="14">With the defeat of Xerxes, Athens founded the Delian League around 478 BC. The alliance of Greek city-states had the shared goal of liberating Greeks still under Persian rule, as well as preventing future invasions. The treasury and meeting place of the Delian League was on the island of Delos, and Athens held a position of leadership over the other allies.</text></page>',id:2},{id:3,type:"human",value:"<chat><text>when was the golden age of greece?</text></chat>"},{type:"assistant",id:4,value:'<think>The user is asking when the Golden Age of Greece was. According to page 0, "Most think the Golden Age of Greece was from around 500 to 300 BC.". I should respond quoting this date range.</think><chat><text>According to the page, the Golden Age of Greece was from around 500 to 300 BC.</text></chat>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-12T12:40:02.921-07:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Javascript getting started guide</property-title><h1 id="1">Getting started with Javascript</h1><text id="2">Javascript is a lightweight, interpreted programming language that runs on the client side of web applications. This guide will cover some of the basic building blocks of JS to get you started.</text><h1 id="3">Variables</h1><text id="4">Variables are containers for storing data. They are declared with the <code>let</code> keyword:</text><text id="5"><code>let age = 30;</code></text><text id="6">This creates a variable named <code>age</code> with the value <code>30</code>.</text><h1 id="7">Functions</h1><text id="8"></text><text id="9">Functions are blocks of code designed to perform a particular task. They are declared with the <code>function</code> keyword:</text><text id="10"><code>function name(params) { /* function body */ }</code></text><text id="11">This creates a function called <code>name</code> that takes <code>params</code> as arguments with the given function body.</text><text id="12">Arrow functions are shorthand functions using the => syntax:</text><text id="13"><code>let sum = (a, b) => a + b;</code></text><text id="14">Generator functions iterate over when called multiple times:</text><text id="15"><code>function* generatorFunction() { /* ... */ }</code></text><text id="16">Async functions return promises and enable asynchronous operations:</text><text id="17"><code>async function myFunc() { /* ... */ }</code></text><h1 id="18">Loops</h1><text id="19">Loops execute blocks of code repeatedly. The for loop is commonly used in JS:</text><text id="20"><code>for (let i = 0; i < 5; i++) { /* loop body */ }</code></text><text id="21">This loop will execute the loop body 5 times with the variable i ranging from 0 to 4.</text><h1 id="22">Objects</h1><text id="23">Objects are collections of related data in key/value pairs: </text><text id="24"><code>let user = {</code></text><text id="25"><code>name: "John",</code></text><text id="26"><code>age: 30</code></text><text id="27"><code>};</code></text><text id="28">This creates an object <code>user</code> with properties <code>name</code> and <code>age</code>.</text><h1 id="29">Arrays</h1><text id="30">Arrays are lists of values stored at numbered indices: </text><text id="31"><code>let fruits = ["Apple", "Banana"];</code></text><text id="32">This creates an array <code>fruits</code> with elements "Apple" and "Banana" at indices 0 and 1 respectively.</text></page>',id:2},{id:3,type:"human",value:"<chat><text>what are the different kinds of functions in javascript?</text></chat>"},{type:"assistant",id:23,value:"<think>The user is asking the different kinds of functions in JavaScript. I saw three kinds of functions in the `Getting started with Javascript' page: normal, arrow and generator functions.</think><chat><text>The three main types of functions in JavaScript are normal functions, arrow functions, and generator functions.</text></chat>"}]],Ce=(m.YK,m.YK,m.YK,[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-datetime":"2023-08-21T12:21:63.125-06:00"}},{id:0,type:"human",value:"<chat><text>when are we going to release our documentary about polar bears in the Arctic?</text></chat>"},{id:0,type:"assistant",value:'<search question="When is the release date for the Arctic polar bears documentary?" keywords="movie documentary release date polar bears arctic"/>'},{id:0,type:"observation",observationType:"search",value:'<search-results current-results="3"><page-result id="22" title="Film Update: The World of Polar Bears" path="News / Films" last-edited-datetime="5 months ago (2022-11-09)" summary="Updates and highlights from a meeting about a film involving polar bears.">Sprint Update: Finalized storyline, conducted crucial research, edited script, consulted with experts, and scheduled Arctic tundra visit for polar bear documentary; film release expected in October.</page-result><page-result id="40" title="The World of Polar Bears - Director\'s Note" path="Docs" last-edited-datetime="3 months ago (2022-02-12)" summary="A director\'s note about The World of Polar Bears from a recent interview.">I am thrilled to announce the upcoming release of our polar bear documentary in March. It has been an incredibly exciting journey capturing these magnificent creatures in their natural habitat. The filming process allowed us to witness firsthand the challenges they face due to climate change, which further fueled our determination to present their story with utmost authenticity and impact.</page-result><page-result id="42" title="Casting Call" path="Casting / Casting Docs" last-edited-datetime="10 months ago (2022-10-09)" summary="Job posting search of actors and videographers for the production of The World of Polar Bears.">Seeking talented and experienced actors, preferably with motion capture skills, to bring to life the majestic polar bears in our upcoming documentary. Must be able to convey the vulnerability, strength, and resilience of these iconic creatures through performance, capturing the essence of their struggle amidst changing environments.</page-result></search-results>'},{id:0,type:"assistant",value:'"The World of Polar Bears" is expected to be released in March<a href="40"/>. An older mentions a release date of October, so the release date was modified at some point<a href="22"/>.'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-datetime":"2023-08-15:21:63.125-03:00"}},{id:0,type:"human",value:"<chat><text>how do i rent a car?</text></chat>"},{id:0,type:"assistant",value:'<search question="How do I rent a car?" keywords="travel rent car policy"/>'},{id:0,type:"observation",observationType:"search",value:'<search-results current-results="5"><page-result id="3" title="Biking @ Dranter!" last-edited-datetime="6 months ago (2023-02-15)" summary="A comprehensive guide to incorporating biking into your daily routine at Dranter.">Discover the joy of biking at Dranter. Our guide provides insights on safe parking locations and the numerous health benefits of opting for a two-wheeled commute.</page-result><page-result id="12" title="Travel Policy" last-edited-datetime="3 months ago (2023-05-15)" summary="Dranter\'s official policy on employee travel, outlining the dos and don\'ts, travel allowances, and procedures for trip approvals.">Heading out on a business trip? Familiarize yourself with Dranter\'s travel policies, including procedures for getting trips approved and guidelines on allowable expenses.</page-result><page-result id="33" title="Expense Policy" last-edited-datetime="2 months ago (2023-06-15)" summary="Clarifying the process and guidelines for submitting expenses at Dranter.">Navigating reimbursements can be tricky. Our expense policy details the types of expenditures you can submit and the necessary steps to ensure swift reimbursement.</page-result></search-results>'},{id:0,type:"assistant",value:'I could not find an exact answer for how to rent a car in the search results. The most relevant information is about Dranter\'s travel policy, with no clear information about renting a car<a href="12"/>.'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-datetime":"2023-08-15:21:63.125-03:00"}},{id:0,type:"human",value:"<chat><text>when should i use bananadb</text></chat>"},{id:0,type:"assistant",value:'<search question="when should I use bananadb?" keywords="bananadb use cases"/>'},{id:0,type:"observation",observationType:"search",value:'<search-results current-results="3"><page-result id="3" title="BananaDB Usage" path="Team Docs" last-edited-datetime="2023-01-31T11:59+00:00">Our infra currently operates by maintaining a queue of jobs, where each job performs read and write operations on a table to access and modify the state for the entity attached to the job.</page-result><page-result id="89" title="BananaDB Performance Testing for Workspace and Page Analytics" path="Analytics Home / Docs" last-edited-datetime="2022-10-27T14:27+00:00">BananaDB is scalable enough to support the current use cases. We are using a special library to write data into BananaDB. Need to verify during actual implementation Overwrite works. For a single page, read page views (each point represent one day of data) for a range of time.<page-result id="212" title="Analytics Serving Platform Onboarding Guide" path="Analytics Home / Docs / Serving Platform" last-edited-datetime="2023-06-30T23:07+00:00">The online storage solution we currently support is BananaDB. BananaDB is a NoSQL database service that offers fast and predictable performance with seamless scalability. BananaDB has a row size limitation of 400KB, which should be large enough to meet most requirements. For time-series record, use ds as sort key if it is one record per day. For none-time-series record, use update-time as sort key, or donâ€™t set up a sort key.</page-result></search-results>'},{id:0,type:"assistant",value:'BananaDB is a NoSQL database ideal for high-scale applications where you need fast, predictable performance and a row size smaller than 400KB<a href="3" /><a href="212"/>.'}]]),Te=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-datetime":"2023-08-21T12:21:63.125-06:00"}},{id:0,type:"human",value:'<chat handle="modi" datetime="2023-08-21T12:21:63.125-06:00"><text>when are we going to release our documentary about polar bears in the Arctic?</text></chat>'},{id:0,type:"assistant",value:'<search question="When is the release date for the Arctic polar bears documentary?" keywords="movie documentary release date polar bears arctic"/>'},{id:0,type:"observation",observationType:"search",value:'<search-results current-results="5"><page-result id="22" title="Film Update: The World of Polar Bears" created-datetime="6 months ago (2023-02-12)" last-edited-datetime="5 months ago (2022-11-09)" summary="Updates and highlights from a meeting about a film involving polar bears.">Sprint Update: Finalized storyline, conducted crucial research, edited script, consulted with experts, and scheduled Arctic tundra visit for polar bear documentary; film release expected in October.</page-result><page-result id="40" title="The World of Polar Bears - Director\'s Note" created-datetime="3 months ago (2023-02-12)" last-edited-datetime="3 months ago (2022-02-12)" summary="A director\'s note about The World of Polar Bears from a recent interview.">I am thrilled to announce the upcoming release of our polar bear documentary in March. It has been an incredibly exciting journey capturing these magnificent creatures in their natural habitat. The filming process allowed us to witness firsthand the challenges they face due to climate change, which further fueled our determination to present their story with utmost authenticity and impact.</page-result><page-result id="42" title="Casting Call" created-datetime="1 year ago (2022-08-15)" last-edited-datetime="10 months ago (2022-10-09)" summary="Job posting search of actors and videographers for the production of The World of Polar Bears.">Seeking talented and experienced actors, preferably with motion capture skills, to bring to life the majestic polar bears in our upcoming documentary. Must be able to convey the vulnerability, strength, and resilience of these iconic creatures through performance, capturing the essence of their struggle amidst changing environments.</page-result></search-results>'},{id:0,type:"assistant",value:"<think>Based on page 22 'Film Update: The World of Polar Bears', which was last edited 5 months ago, there was an expected film release date of October. However, page 40 'The World of Polar Bears - Director's Note', which was updated 3 months ago and is more recent, cites a different release date of March. Based on the rubric, I must be transparent and accurate, so I will present the updated information but mention that I found older information that may be relevant.</think><chat-md>\"The World of Polar Bears\" is expected to be released in March, based on [The World of Polar Bears - Director's Note](40)\nAn older document, [Film Update: The World of Polar Bears](22) mentions a release date of October, so the release date was modified at some point.</chat-md>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-datetime":"2023-08-15:21:63.125-03:00"}},{id:0,type:"human",value:'<chat handle="johnsmith" datetime="2023-08-15:21:89.193-03:00"><text>How do I declare an incident?</text></chat>'},{id:0,type:"assistant",value:'<search question="How do I declare an incident?" keywords="incident response declare"/>'},{id:0,type:"observation",observationType:"search",value:'<search-results current-results="5"><page-result id="3" title="Engineer Incident Response Protocol" created-datetime="1 year ago (2022-08-15)" last-edited-datetime="6 months ago (2023-02-15)" summary="This page outlines the protocol that engineers should follow during incidents.">Follow the engineer incident response protocol by identifying the root cause of the incident, coordinating with other teams for resolution, and documenting the steps taken for future reference.</page-result><page-result id="12" title="Sales Incident Response Protocol" created-datetime="10 months ago (2022-10-15)" last-edited-datetime="3 months ago (2023-05-15)" summary="This page provides guidelines on how to communicate incidents to customers and clients.">When messaging an incident to customers, ensure clear and concise communication by explaining the impact, providing estimated resolution times, and assuring them that all efforts are being made to rectify the situation.</page-result><page-result id="33" title="HR Incident Response Protocol" created-datetime="3 months ago (2023-05-15)" last-edited-datetime="2 months ago (2023-06-15)" summary="Information about HR guidelines to handle emergency situations">When responding to HR incidents, follow the HR incident response protocol which includes promptly addressing the issue, conducting thorough investigations, and implementing corrective actions to ensure a fair and safe work environment.</page-result><page-result id="34" title="Customer Support: managing incidents" created-datetime="2 years ago (2021-08-15)" last-edited-datetime="1 year ago (2022-08-15)" summary="This page offers insights on how customer support should handle incidents reported by customers.">Effectively manage incidents reported by customers by actively listening to their concerns, empathizing with their frustrations, and providing timely updates on the progress of incident resolution.</page-result><page-result id="35" title="Updating front during incidents" created-datetime="2 years ago (2021-08-15)" last-edited-datetime="1 year ago (2022-08-15)" summary="This page explains the importance of keeping the front-end team informed about incidents.">During incidents, ensure constant communication with the front-end team by sharing incident details, expected impact, and relevant workarounds to minimize disruption to the customer experience.</page-result></search-results>'},{id:0,type:"assistant",value:"<chat-md>Depending on your department, there appear to be different protocols for incident response. Here they are:\nFor Engineers: [Engineer Incident Response Protocol](3)\nFor Sales: [Sales Incident Response Protocol](12)\nFor HR: [HR Incident Response Protocol](33)\nFor Customer Support: [Customer Support Incident Response Protocol](34)\nFor Marketing: [Marketing Incident Response Protocol](35)</chat-md>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-datetime":"2023-08-15:21:63.125-03:00"}},{id:0,type:"human",value:'<chat handle="noah" datetime="2023-08-15:21:89.193-03:00"><text>when should i use bananadb?</text></chat>'},{id:0,type:"assistant",value:'<search question="when should I use bananadb?" keywords="bananadb use cases"/>'},{id:0,type:"observation",observationType:"search",value:'<search-results current-results="3"><page-result id="3" title="BananaDB Usage" created-datetime="2022-08-02T05:55+00:00" last-edited-datetime="2023-01-31T11:59+00:00" summary="The page provides an overview of BananaDB usage, including baseline metrics, write operations, partitioning, and common issues such as throttling due to hot partitions.">Our infra currently operates by maintaining a queue of jobs, where each job performs read and write operations on a table to access and modify the state for the entity attached to the job.</page-result><page-result id="89" title="BananaDB Performance Testing for Workspace and Page Analytics" created-datetime="2022-08-31T13:00+00:00" last-edited-datetime="2022-10-27T14:27+00:00" summary="<summary>Performance testing for using BananaDB use cases for workspace and page analytics project, including write and read performance tests, as well as potential errors to be aware of during implementation.">BananaDB is scalable enough to support the current use cases. We are using a special library to write data into BananaDB. Need to verify during actual implementation Overwrite works. For a single page, read page views (each point represent one day of data) for a range of time.<page-result id="212" title="Analytics Serving Platform Onboarding Guide" created-datetime="2023-04-05T21:15+00:00" last-edited-datetime="2023-06-30T23:07+00:00" summary="<summary>Guide for onboarding to the Analytics Serving Platform, covering limitations, key concepts, and steps for onboarding, including creating or using existing tables, updating or creating BananaDB tables, creating new BananaDB tables, and testing spark logic and end-to-end airflow">The online storage solution we currently support is BananaDB. BananaDB is a NoSQL database service that offers fast and predictable performance with seamless scalability. BananaDB has a row size limitation of 400KB, which should be large enough to meet most requirements. For time-series record, use ds as sort key if it is one record per day. For none-time-series record, use update-time as sort key, or donâ€™t set up a sort key.</page-result></search-results>'},{id:0,type:"assistant",value:"<chat-md>BananaDB is a NoSQL database ideal for high-scale applications where you need fast, predictable performance and a row size smaller than 400KB. For more information, see [BananaDB Usage](3) and [Analytics Serving Platform Onboarding Guide](212)</chat-md>"}]],Me=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-04-03T15:54:49.835-07:00"}},{id:0,type:"assistant",value:'<load-page id="0"/>'},{id:0,type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Product Categories</property-title><text id="1">Shop our wide selection of electronics, including smart home devices, virtual reality, computers & laptops, cameras, robotics & DIY kits, and more.</text><child-page id="3" page-id="2"><property-title name="Title">Cameras & Photography</property-title></child-page><child-page id="5" page-id="4"><property-title name="Title">Bits & Bytes: Smart Home</property-title></child-page><child-page id="7" page-id="6"><property-title name="Title">Bits & Bytes - Drones & Gadgets</property-title></child-page><child-page id="9" page-id="8"><property-title name="Title">Bits & Bytes: Wearable Tech</property-title></child-page><child-page id="11" page-id="10"><property-title name="Title">Bits & Bytes: Robotics & DIY Kits</property-title></child-page><child-page id="13" page-id="12"><property-title name="Title">Laptops & Computers at Bits & Bytes</property-title></child-page><child-page id="15" page-id="14"><property-title name="Title">Virtual Reality</property-title></child-page></page>'},{id:0,type:"human",value:"<chat><text>add a table to this page with all of our charitable donations and how much they were, including columns: organization name, amount, and information source</text></chat>"},{id:0,type:"assistant",value:'<think>The user is requesting that I add a new table with columns for organization name, donation amount, and information source about charitable donations. Since they did not specify where the information would come from, I should first search the workspace for information on charitable donations to include in the table before creating it.</think><search question="What charitable donations did we make in the past year?" keywords="charitable donations company contributions"/>'},{id:0,type:"observation",observationType:"search",value:'<search-results current-results="10"><page-result id="2" title="Charitable Donations" created-datetime="2022-09-25" last-edited-datetime="2022-09-02" summary="Bits & Bytes\' commitment to donating 1% of annual profits to charities and nonprofits promoting access to technology and technical education, including donations of $75,000 to DonorsChoose.org, $80,000 to Technovation Girls, $50,000 per year for 3 years to Girls Who Code, and $50,000 per year for 3 years to FIRST Robotics.">We have donated $75,000 to DonorsChoose.org...\n\t\tWe have donated $80,000 to Technovation Girls...\n\t\tWe have donated $50,000 per year for 3 years to Girls Who Code...\n\t\tWe have donated $50,000 per year for 3 years to FIRST Robotics...</page-result><page-result id="3" title="Bits & Bytes: School Grants" created-datetime="2022-07-14" last-edited-datetime="2022-07-11" summary="Bits & Bytes\' School Grant Program and partnerships with nonprofits to support technology education in schools, including funding for digital tools, robotics kits, teacher training, and scholarships for students to attend tech camps and workshops">Our flagship education initiative is the annual Bits & Bytes School Grant Program. We award $1 million in grants to K-12 schools each year to fund technology education.\n\t\tLast year, we awarded over 300 grants totaling $1.2 million to schools across 50 states.\n\t\tWe also support technology education through partnerships with nonprofits like Girls Who Code, Black Girls Code, and Code.org.</page-result><page-result id="5" title="Community Sponsorships" created-datetime="2023-02-25" last-edited-datetime="2022-03-29" summary="Bits & Bytes\' community outreach initiatives, including partnerships with local schools, scholarships and internships, and donations to national nonprofits focused on STEM education and innovation">We recently donated $50,000 worth of robotics kits, microcontrollers, and 3D printers to West Hills Middle School to start an after-school robotics club.\n\t\tEach year we award $200,000 in college scholarships to students studying technology and engineering fields.\n\t\tThrough partnerships, sponsorships, scholarships, internships, and product donations, Bits & Bytes contributes over $2 million each year to support technology education and advancement in our communities.</page-result><page-result id="4" title="Bits & Bytes Volunteer Initiatives" created-datetime="2022-11-06" last-edited-datetime="2022-05-06" summary="Bits & Bytes\' volunteer initiatives, including coding camps, robotics team sponsorships, donation drives, STEM career days, scholarships and internships, charity fundraising, and disaster relief efforts">Donation Drives: We frequently organize donation drives to collect new and gently used tech products like laptops, tablets, and scientific calculators for local schools, libraries, and charitable organizations.\n\t\tCharity Fundraising: During the holidays, we hold charity drives across all our locations to raise money for organizations that promote technology education and access, such as Code.org, Girls Who Code, and DonorsChoose.org. We match all employee donations made during these drives.\n\t\tIn addition to our ongoing programs, we regularly hold fundraising and volunteering events in response to natural disasters and crises impacting the communities we serve. We have raised millions of dollars and donated thousands of volunteer hours for relief efforts in the aftermath of hurricanes, wildfires, and other events.</page-result><page-result id="6" title="STEM Education" created-datetime="2022-06-04" last-edited-datetime="2022-07-31" summary="Bits & Bytes\' initiatives to promote STEM education, including donating technology and funds to schools, offering free coding and robotics camps, partnering with national nonprofits, employee volunteer program, and scholarships and internships for underrepresented students pursuing tech-related degrees.">We donate electronics, robotics kits, and funds to schools in the communities we serve so students can learn hands-on technical skills. Last year we donated over $5 million in products and funds to 500 schools across the country.\n\t\tIn 2019 we hosted over 10,000 students at our camps.\n\t\tOver the past 5 years, we have awarded over $10 million in scholarships and hired 500 interns at Bits & Bytes.</page-result><page-result id="7" title="Community Outreach" created-datetime="2022-04-18" last-edited-datetime="2022-12-08" summary="Overview of community outreach initiatives related to education and innovation in STEM fields, including STEM education, community sponsorships, volunteer initiatives, charitable donations, and school grants"><todo id="9">Charitable Donations</todo></page-result><page-result id="11" title="Bits & Bytes Sale Highlights" created-datetime="2022-11-23" last-edited-datetime="2022-06-08" summary="Highlights of a sale on various tech products, including smart watches, fitness trackers, virtual reality headsets, flash drives, gaming PC components, chargers, and smart devices"></page-result><page-result id="12" title="Member Perks" created-datetime="2022-06-03" last-edited-datetime="2023-01-03" summary="Overview of the loyalty programs and perks offered by Bits & Bytes Club Rewards"></page-result><page-result id="8" title="Investor Relations" created-datetime="2022-11-16" last-edited-datetime="2022-05-01" summary="Overview of Bits & Bytes, including its history, mission, leadership team, partnerships, financials, and contact information for investor relations">There is no information on charitable donations and amounts.</page-result><page-result id="13" title="Points & Levels" created-datetime="2022-07-03" last-edited-datetime="2022-09-01" summary="Information about the loyalty rewards programs offered by Bits & Bytes, including the free Byte Points program and the paid MegaBytes program with exclusive benefits for customers who spend a minimum of $1,000 annually"></page-result></search-results>'},{id:0,type:"assistant",value:'<think>From the search results, two pages contain information on our recent charitable donations with dollar amounts: Charitable Donations and Bits & Bytes Volunteer Initiatives. I will create a summary table on this page containing the relevant information from those pages.</think><insert-after id="1"><table><tr><property-text name="1"><a href="2">DonorsChoose.org</a></property-text><property-text name="2">$75,000</property-text><property-text name="3"><a href="2">Charitable Donations</a></property-text></tr><tr><property-text name="1">Technovation Girls</property-text><property-text name="2">$80,000</property-text><property-text name="3"><a href="2">Charitable Donations</a></property-text></tr><tr><property-text name="1">Girls Who Code</property-text><property-text name="2">$50,000/year for 3 years</property-text><property-text name="3"><a href="2">Charitable Donations</a></property-text></tr><tr><property-text name="1">FIRST Robotics</property-text><property-text name="2">$50,000/year for 3 years</property-text><property-text name="3"><a href="2">Charitable Donations</a></property-text></tr><tr><property-text name="1"><a href="4">Code.org</a> and Girls Who Code</property-text><property-text name="2">Matches all employee donations</property-text><property-text name="3"><a href="4">Bits & Bytes Volunteer Initiatives</a></property-text></tr></table></insert-after>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-04-03T15:54:49.835-07:00"}},{id:0,type:"assistant",value:'<load-page id="0"/>'},{id:0,type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><text id="1"></text></page>'},{id:0,type:"human",value:"<chat><text>find information about our internship roles and write a tweet announcing them in this page</text></chat>"},{id:0,type:"assistant",value:'<think>The user is requesting a tweet announcing internship roles be added to the page. I should search for information on internship roles and compose an appropriate tweet to add.</think><search question="What are the internship roles offered?" keywords="internship role offered"/>'},{id:0,type:"observation",observationType:"search",value:'<search-results current-results="9"><page-result id="2" title="True Blue: Career Paths" created-datetime="2022-11-23" last-edited-datetime="2022-07-30" summary="Overview of career opportunities at True Blue, including retail, operations, corporate, and internship positions">We offer internship programs for students interested in retail, operations, merchandising, marketing, and finance. Application page: trueblue.com/internships</page-result><page-result id="3" title="Careers" created-datetime="2022-05-03" last-edited-datetime="2022-04-06" summary="Overview of career opportunities available at True Blue, including retail positions, corporate roles, and internships">Explore career opportunities available at True Blue, including retail positions, corporate roles, and internships.</page-result><page-result id="4" title="Internships & Opportunities" created-datetime="2023-02-04" last-edited-datetime="2022-05-08" summary="Overview of internship, retail, and corporate job opportunities at True Blue, including specific details about the internship program and available roles in merchandising, marketing, inventory management, finance, and IT">Our internship programs provide hands-on experience in the technology industry and a chance to contribute to an innovative company. We offer internships in merchandising, marketing, inventory management, finance, and IT.\n\t\tMerchandising interns help select which products to carry in our stores. Marketing interns develop campaigns to promote new products and events. Inventory management interns track product shipments and optimize store inventory levels. Finance interns assist with budgeting, accounting, and reporting. And IT interns help support internal systems and develop new technology solutions.</page-result><page-result id="5" title="Community Sponsorships" created-datetime="2023-02-25" last-edited-datetime="2022-03-29" summary="True Blue\' community outreach initiatives, including partnerships with local schools, scholarships and internships, and nonprofit partnerships to support STEM education and advancement">We also hire over 50 interns across our stores and corporate office, providing hands-on experience and mentorship in retail, marketing, finance, and product management roles. Many of our interns have gone on to work for True Blue full-time after graduating.</page-result><page-result id="6" title="STEM Education" created-datetime="2022-06-04" last-edited-datetime="2022-07-31" summary="True Blue\' commitment to promoting STEM education through various initiatives, including donating technology and funds to schools, offering free coding and robotics camps, partnering with national nonprofits, employee volunteer program, and offering scholarships and internships to underrepresented students pursuing tech-related degrees.">We offer college scholarships and paid internships to students pursuing degrees in tech-related fields.\n\t\tOur programs target those from disadvantaged backgrounds who are underrepresented in the tech industry.\n\t\tOver the past 5 years, we have awarded over $10 million in scholarships and hired 500 interns at True Blue.</page-result><page-result id="7" title="Job Openings at True Blue" created-datetime="2022-09-03" last-edited-datetime="2022-10-20" summary="Job openings at True Blue, including positions at retail stores, corporate headquarters, and summer internships in customer experience.">True Blue offers summer internship opportunities for students interested in technology and retail. Interns will assist the Marketing and Customer Experience teams with special projects aimed at improving the customer journey.</page-result><page-result id="8" title="Workplace Culture at True Blue" created-datetime="2023-01-20" last-edited-datetime="2022-04-15" summary="Overview of the workplace culture at True Blue, including continuous learning and development, an inclusive and diverse environment, fun and rewarding work, work-life balance, and career growth opportunities"></page-result><page-result id="9" title="True Blue: School Grants" created-datetime="2022-07-14" last-edited-datetime="2022-07-11" summary="True Blue School Grant Program and partnerships with nonprofits to support technology education">There is no information on internship roles in the given page.</page-result><page-result id="10" title="True Blue Volunteer Initiatives" created-datetime="2022-11-06" last-edited-datetime="2022-05-06" summary="Overview of volunteer initiatives at True Blue, including coding camps for kids, robotics team sponsorships, donation drives, STEM career days, scholarships and internships, and charity fundraising.">We offer competitive paid internships and scholarships for college students pursuing technology and engineering degrees. Over 500 students have participated in our internship program, and we have awarded scholarships to more than 1,000 students since the program began.</page-result></search-results>'},{id:0,type:"assistant",value:'<think>We offer internships in merchandising, marketing, inventory management, finance, and IT based on the search results. Community Sponsorships notes we provide hands-on experience and hire 50+ interns yearly for roles in retail, marketing, finance, and product management. I will compose a tweet announcing these details.</think><insert-before id="1"><text>We\'re proud to offer summer internships in retail, operations, marketing, finance, IT & more! Gain real-world experience at a leading tech company. Apply now at trueblue.com/internships #internships #jobsearch</text></insert-before>'}]],Pe=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-04-03T15:54:49.835-07:00"}},{id:0,type:"assistant",value:'<load-page id="0"/>'},{id:0,type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><child-database id="52" database-id="53"><property-title name="Title">Products</property-title><schema-property-text name="Product Name"/><schema-property-text name="Category"/><schema-property-text name="SKU"/><schema-property-text name="Availability Status"/></child-database></page>'},{id:0,type:"human",value:"<chat><text>Do we sell any plush toys?</text></chat>"},{id:0,type:"assistant",value:'<think>The user is asking if we sell any plush toys. I should query the Products database to try to find an answer.</think><query-database id="53"><search question="Do we sell any plush toys?" keywords="plush toys"/></query-database>'},{id:0,type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="2" total-results="2"><child-page id="5" page-id="6"><property-title name="Title">Red elephant plush toy</property-title><property-text name="Availability Status">Available</property-text><property-text name="Category">Plush toys</property-text><property-text name="Product Name">Red elephant plush toy #42</property-text><property-text name="SKU">2938784</property-text></child-page><child-page id="3" page-id="4"><property-title name="Title">Marbles</property-title><property-text name="Availability Status">Available</property-text><property-text name="Category">Misc</property-text><property-text name="Product Name">Marbles #45</property-text><property-text name="SKU">1301293</property-text></child-page></query-database-results>'},{id:0,type:"assistant",value:"<think>The query results contained a page for a 'Red elephant plush toy' under the 'Plush toys' category, so I will respond affirmatively that we do sell plush toys.</think><chat><text>Yes, we sell plush toys like the <a href=\"6\">Red elephant plush toy</a>.</text></chat>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-04-03T16:54:49.835-07:00"}},{id:0,type:"assistant",value:'<load-page id="0"/>'},{id:0,type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><child-database id="63" database-id="66"><property-title name="Title">Patients</property-title><schema-property-title name="Full Name"/><schema-property-text name="Medical Record Number"/><schema-property-text name="Birth year"/><schema-property-text name="Contact Email"/><schema-property-text name="Primary Physician"/></child-database></page>'},{id:0,type:"human",value:"<chat><text>Find patients named Barbara</text></chat>"},{id:0,type:"assistant",value:'<think>The user asked for patients named Barbara. I will query the Patients database for any pages where the Full Name property contains \'Barbara\'.</think><query-database id="66"><filter-property-title name="Full Name" condition="contains">Barbara</filter-property-text></query-database>'},{id:0,type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="2" total-results="2"><child-page id="3" page-id="4"><property-title name="Full Name">Barbara James</property-title><property-text name="Medical Record Number">2399993273375</property-text><property-text name="Birth year">1976</property-text><property-text name="Contact Email"></property-text><property-text name="Primary Physician"></property-text></child-page><child-page id="5" page-id="6"><property-title name="Full Name">Barbara Oppenheimer</property-title><property-text name="Medical Record Number">8123182374412</property-text><property-text name="Birth year">1959</property-text><property-text name="Contact Email"></property-text><property-text name="Primary Physician"></property-text></child-page></query-database-results>'},{id:0,type:"assistant",value:'<think>The query returned two patients named Barbara: Barbara James, and Barbara Oppenheimer. I will tell the user about these results.</think><chat><text>I found 2 patients named Barbara:</text><text><a href="4">Barbara James</a>, born 1976</text><text><a href="6">Barbara Oppenheimer</a>, born 1959</text></chat>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-04-03T16:54:49.835-07:00"}},{id:0,type:"assistant",value:'<load-page id="0"/>'},{id:0,type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><child-database id="23" database-id="12"><property-title name="Title">Students</property-title><schema-property-title name="Given Name"/><schema-property-text name="Student ID"/><schema-property-text name="Contact Email"/><schema-property-text name="Major Advisor"/><schema-property-text name="Major"/><schema-property-text name="Minor"/><schema-property-text name="Bio"/><schema-property-text name="Graduation year"/></child-database></page>'},{id:0,type:"human",value:"<chat><text>Are there any students whose students graduating in 2027 or 2028 who are interested in quantum physics?</text></chat>"},{id:0,type:"assistant",value:'<think>The user is asking if there are any students graduating in 2027 or 2028 interested in quantum physics. I should search the Students database for this information.</think><query-database id="12"><search question="Are any students interested in quantum physics?" keywords="interest quantum physics"/><filter-group match="any"><filter-property-text name="Graduation year" condition="is">2027</filter-property-text><filter-property-text name="Graduation year" condition="is">2028</filter-property-text></filter-group></query-database>'},{id:0,type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="1" total-results="1"><child-page id="4" page-id="5"><property-title name="Given name">Aaron Skye</property-title><property-text name="Bio">Aaron is fascinated by physics and top theories in quantum mechanics and gravity. In his spare time he enjoys debates with professors and colleagues on problems in quantum field theory and supersymmetry. Aaron hopes to pursue graduate studies in physics upon graduating.</property-text><property-text name="Contact Email">theo@usc.edu</property-text><property-text name="Graduation year">2028</property-text><property-text name="Major">Physics</property-text><property-text name="Major Advisor"></property-text><property-text name="Minor"></property-text><property-text name="Student ID">293</property-text></child-page></query-database-results>'},{id:0,type:"assistant",value:'<think>The search results show student Aaron Skye is interested in quantum physics and graduating in 2028. I should respond to the user indicating we have at least one such student.</think><chat><text><a href="5">Aaron Skye</a>, graduating in 2028, shows an interest in theories of quantum mechanics and quantum field theory.</text></chat>'}]],Ae=[Pe[0],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-04-03T16:54:49.835-07:00"}},{id:0,type:"assistant",value:'<load-page id="0"/>'},{id:0,type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><child-database id="23" database-id="12"><property-title name="Title">Students</property-title><schema-property-title name="Given Name"/><schema-property-text name="Student ID"/><schema-property-text name="Contact Email"/><schema-property-text name="Major Advisor"/><schema-property-text name="Major"/><schema-property-text name="Minor"/><schema-property-text name="Bio"/><schema-property-text name="Graduation year"/></child-database></page>'},{id:0,type:"human",value:"<chat><text>Are there any students whose students who are interested in quantum physics?</text></chat>"},{id:0,type:"assistant",value:'<think>The user asked if there are any students interested in quantum physics. I will query the database \'Students\' to search for students with an interest in quantum physics.</think><query-database id="12"><search question="Are there any students interested in quantum physics?" keywords="student interest quantum physics"/></query-database>'},{id:0,type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="1" total-results="1"><child-page id="4" page-id="5"><property-title name="Given name">Aaron Skye</property-title><property-text name="Bio">Aaron is fascinated by physics and top theories in quantum mechanics and gravity. In his spare time he enjoys debates with professors and colleagues on problems in quantum field theory and supersymmetry. Aaron hopes to pursue graduate studies in physics upon graduating.</property-text><property-text name="Contact Email">theo@usc.edu</property-text><property-text name="Graduation year">2028</property-text><property-text name="Major">Physics</property-text><property-text name="Major Advisor"></property-text><property-text name="Minor"></property-text><property-text name="Student ID">293</property-text></child-page></query-database-results>'},{id:0,type:"assistant",value:'<think>The search results show student Aaron Skye is interested in quantum physics. I should respond to the user indicating we have at least one such student.</think><chat><text><a href="5">Aaron Skye</a>, graduating in 2028, shows an interest in theories of quantum mechanics and quantum field theory.</text></chat>'}]],De=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-19T15:44:53.117-07:00","current-person-id":"1","current-person-name":"Julio Santos"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">The Designer\'s Reading Nook</property-title><text id="2">At Space Designers, we\'re always exploring new ideas and inspiration for creative spaces. In The Designer\'s Reading Nook, we share some of our favorite design books, blogs, magazines, and more. Whether you\'re a professional designer or simply design-curious, we hope you find fresh ideas and perspectives to spark your creativity.</text><child-database id="3" database-id="4"><property-title name="Title">Book Reviews</property-title><schema-property-title name="Book Title"/><schema-property-text name="Author"/><schema-property-multi-select name="Genre"><schema-option option="Nonfiction"/><schema-option option="Reference"/><schema-option option="Biographies & Memoirs"/><schema-option option="Travel"/><schema-option option="Science Fiction"/><schema-option option="Cookbooks"/><schema-option option="Art"/><schema-option option="Interior Design"/><schema-option option="Design"/><schema-option option="Interior Design and Decoration"/><schema-option option="Biology"/><schema-option option="Photography"/><schema-option option="Architecture"/></schema-property-multi-select><schema-property-text name="Our Review"/><schema-property-number name="Page Count" format="number"/><schema-property-select name="Rating"><schema-option option="4"/><schema-option option="5"/><schema-option option="1"/><schema-option option="2"/><schema-option option="3"/></schema-property-select><schema-property-checkbox name="Recommended"/><schema-property-text name="Synopsis"/></child-database><child-database id="5" database-id="6"><property-title name="Title">Designer Profiles</property-title><schema-property-title name="Designer Name"/><schema-property-person name="Author"/><schema-property-text name="Bio"/><schema-property-text name="Design Style"/><schema-property-email name="Email"/><schema-property-checkbox name="Featured Work"/><schema-property-number name="Projects Completed" format="number"/><schema-property-text name="Quote"/><schema-property-status name="Status"><schema-option-category category="To-do"><schema-option option="Backlogged"/><schema-option option="Not started"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Waiting review"/><schema-option option="In progress"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Shipped"/><schema-option option="Done"/></schema-option-category></schema-property-status><schema-property-url name="Website"/><schema-property-number name="Years Experience" format="number"/></child-database></page>',id:2},{id:3,type:"human",value:"<chat><text>do we have any photography books with a 5 star rating?</text></chat>"},{type:"assistant",id:5,value:'<think>The user is asking about photography books with a 5 star rating. We can query the Book Reviews database filtering by the Photography genre and a 5 star rating.</think><query-database id="4"><filter-property-multi-select name="Genre" condition="contains"><option option="Photography"/></filter-property-multi-select><filter-property-select name="Rating" condition="is"><option option="5"/></filter-property-select></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="1" total-results="1"><child-page id="7" page-id="8"><property-title name="Book Title">Elena Moriya + Maria Bush: Passion for Place</property-title><property-text name="Author">Elena Moriya and Maria Bush</property-text><property-multi-select name="Genre"><option option="Art"/><option option="Photography"/></property-multi-select><property-text name="Our Review">This lavishly illustrated book features stunning full-page photographs of some of the most beautiful and dramatic natural landscapes on the planet. The richness of color and level of detail are truly exquisite. Any lover of photography, nature or armchair travel would appreciate this gorgeous collection. Highly recommended.</property-text><property-number name="Page Count" number="450"/><property-select name="Rating"><option option="5"/></property-select><property-checkbox name="Recommended" checked="false"/><property-text name="Synopsis">A stunning collection of photographs capturing the beauty and diversity of 15 spectacular natural landscapes around the world. Featuring breathtaking images of cliffs, canyons, forests, beaches and more from renowned photographers Elena Moriya and Maria Bush.</property-text></child-page></query-database-results>',id:73},{type:"assistant",id:95,value:"<think>According to the results, we have a photography book titled 'Elena Moriya + Maria Bush: Passion for Place' with a 5 star rating.</think><chat><text>Yes, we have a photography book titled <a href=\"8\">Elena Moriya + Maria Bush: Passion for Place</a> with a 5 star rating.</text></chat>"}]],Be=[],Re=[[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-06-27T13:29:15.309-04:00","current-person-id":"1","current-person-name":"Sharabesh"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">My project</property-title><child-database id="2" database-id="3"><property-title name="Title">Projects</property-title><schema-property-title name="Name"/><schema-property-multi-select name="Tags"><schema-option option="P0"/><schema-option option="P1"/></schema-property-multi-select><schema-property-relation name="Tasks" limit="Infinity" database-id="4" synced-property-name="Projects"/></child-database><child-database id="5" database-id="4"><property-title name="Title">Tasks</property-title><schema-property-title name="Name"/><schema-property-multi-select name="Tags"><schema-option option="P1"/><schema-option option="P0"/></schema-property-multi-select><schema-property-relation name="Projects" limit="Infinity" database-id="3" synced-property-name="Tasks"/></child-database><text id="6"/></page>',id:2},{id:3,type:"human",value:"<chat><text>What rows have the â€œScalabilityâ€ relation in Tasks.</text></chat>"},{type:"assistant",id:5,value:'<think>The user is asking which rows in the Tasks database have a relation to the Scalability project. I will first search for the Scalability project in the Projects database to get its page ID, then query Tasks for any rows related to that page.</think><query-database id="3"><search question="What is the page ID for the Scalability project?" keywords="Scalability project"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="2" total-results="2"><child-page id="7" page-id="8"><property-title name="Name">Scalability</property-title><property-multi-select name="Tags"><option option="P0"/></property-multi-select><property-relation name="Tasks" database-id="4"><mention-page page-id="9">Improve latency for databases</mention-page></property-relation></child-page><child-page id="10" page-id="11"><property-title name="Name">Product Growth</property-title><property-multi-select name="Tags"><option option="P1"/></property-multi-select><property-relation name="Tasks" database-id="4"><mention-page page-id="9">Improve latency for databases</mention-page></property-relation></child-page></query-database-results>',id:19},{type:"assistant",id:20,value:'<think>The Scalability project has a page ID of 8. I will query Tasks for any rows related to page ID 8.</think><query-database id="4"><search question="What tasks have a relation to the Scalability project (page ID 8)?" keywords="Scalability 8"/></search></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="3" total-results="3"><child-page id="12" page-id="13"><property-title name="Name">Drop Page load time to 4 seconds</property-title><property-multi-select name="Tags"/><property-relation name="Projects" database-id="3"/></child-page><child-page id="14" page-id="9"><property-title name="Name">Improve latency for databases</property-title><property-multi-select name="Tags"><option option="P0"/></property-multi-select><property-relation name="Projects" database-id="3"><mention-page page-id="8">Scalability</mention-page><mention-page page-id="11">Product Growth</mention-page></property-relation></child-page><child-page id="15" page-id="16"><property-title name="Name">Improve onboarding flow</property-title><property-multi-select name="Tags"><option option="P1"/></property-multi-select><property-relation name="Projects" database-id="3"/></child-page></query-database-results>',id:30},{type:"assistant",id:32,value:"<think>The task 'Improve latency for databases' is related to the Scalability project.</think><chat><text>The task <a href=\"9\">Improve latency for databases</a> has the â€œScalabilityâ€ relation in Tasks.</text></chat>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-06-27T13:33:11.748-04:00","current-person-id":"1","current-person-name":"Sharabesh"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">My project</property-title><child-database id="2" database-id="3"><property-title name="Title">Projects</property-title><schema-property-title name="Name"/><schema-property-multi-select name="Tags"><schema-option option="P0"/><schema-option option="P1"/></schema-property-multi-select><schema-property-relation name="Tasks" limit="Infinity" database-id="4" synced-property-name="Projects"/></child-database><child-database id="5" database-id="4"><property-title name="Title">Tasks</property-title><schema-property-title name="Name"/><schema-property-multi-select name="Tags"><schema-option option="P1"/><schema-option option="P0"/></schema-property-multi-select><schema-property-relation name="Projects" limit="Infinity" database-id="3" synced-property-name="Tasks"/></child-database><text id="6"/></page>',id:2},{id:3,type:"human",value:"<chat><text>What tasks have no projects</text></chat>"},{type:"assistant",id:4,value:'<think>The user is asking for tasks in the Tasks database that do not have a linked Projects relation.</think><query-database id="4"><filter-property-relation name="Projects" condition="is empty"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="2" total-results="2"><child-page id="7" page-id="8"><property-title name="Name">Drop Page load time to 4 seconds</property-title><property-multi-select name="Tags"/><property-relation name="Projects" database-id="3"/></child-page><child-page id="9" page-id="10"><property-title name="Name">Improve onboarding flow</property-title><property-multi-select name="Tags"><option option="P1"/></property-multi-select><property-relation name="Projects" database-id="3"/></child-page></query-database-results>',id:16},{type:"assistant",id:18,value:"<think>The tasks 'Drop Page load time to 4 seconds' and 'Improve onboarding flow' do not have any linked projects, according to the query results.</think><chat><text>There are 2 tasks with no linked projects:</text><text><mention-page page-id=\"8\"/></text><text><mention-page page-id=\"10\"/></text></chat>"}]],Ee=[[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-06-26T23:12:11.595-04:00","current-person-id":"1","current-person-name":"Sharabesh"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Hello world</property-title><child-database id="2" database-id="3"><property-title name="Title">Projects</property-title><schema-property-title name="Name"/><schema-property-multi-select name="Tags"><schema-option option="P0"/><schema-option option="P1"/></schema-property-multi-select><schema-property-relation name="Tasks" limit="Infinity" database-id="4" synced-property-name="Projects"/></child-database><child-database id="5" database-id="4"><property-title name="Title">Tasks</property-title><schema-property-title name="Name"/><schema-property-multi-select name="Tags"><schema-option option="P1"/><schema-option option="P0"/></schema-property-multi-select><schema-property-relation name="Projects" limit="Infinity" database-id="3" synced-property-name="Tasks"/></child-database><text id="6"/></page>',id:2},{id:3,type:"human",value:"<chat><text>Set the Project for â€œImprove latency for databasesâ€ to be â€œScalabilityâ€.</text></chat>"},{type:"assistant",id:4,value:'<think>The user is requesting to set the Project for the task "Improve latency for databases" to "Scalability". I will first query the Tasks database to find the ID of the task, then search the Projects database to find the ID for "Scalability", and finally update the task\'s Projects relation.</think><query-database id="4"><filter-property-title name="Name" condition="contains">Improve latency for databases</filter-property-title></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="1" total-results="1"><child-page id="7" page-id="8"><property-title name="Name">Improve latency for databases</property-title><property-multi-select name="Tags"><option option="P0"/></property-multi-select><property-relation name="Projects" database-id="3"/></child-page></query-database-results>',id:12},{type:"assistant",id:13,value:'<think>The ID of the task is 7. Now I will search the Projects database for the ID of the project named "Scalability".</think><query-database id="3"><search question="What is the ID of the project named \'Scalability\'?" keywords="Scalability"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="2" total-results="2"><child-page id="9" page-id="10"><property-title name="Name">Scalability</property-title><property-multi-select name="Tags"><option option="P0"/></property-multi-select><property-relation name="Tasks" database-id="4"/></child-page><child-page id="11" page-id="12"><property-title name="Name">Product Growth</property-title><property-multi-select name="Tags"><option option="P1"/></property-multi-select><property-relation name="Tasks" database-id="4"/></child-page></query-database-results>',id:24},{type:"assistant",id:25,value:'<think>The project \'Scalability\' has an ID of 10. I will now set the Projects relation for task ID 7 to this project.</think><set-property id="7"><property-relation name="Projects" database-id="3"><mention-page page-id="10"/></property-relation></set-property>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-06-26T23:38:50.956-04:00","current-person-id":"1","current-person-name":"Sharabesh"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Hello world</property-title><child-database id="2" database-id="3"><property-title name="Title">Projects</property-title><schema-property-title name="Name"/><schema-property-multi-select name="Tags"><schema-option option="P0"/><schema-option option="P1"/></schema-property-multi-select><schema-property-relation name="Tasks" limit="Infinity" database-id="4" synced-property-name="Projects"/></child-database><child-database id="5" database-id="4"><property-title name="Title">Tasks</property-title><schema-property-title name="Name"/><schema-property-multi-select name="Tags"><schema-option option="P1"/><schema-option option="P0"/></schema-property-multi-select><schema-property-relation name="Projects" limit="Infinity" database-id="3" synced-property-name="Tasks"/></child-database><text id="6"/></page>',id:2},{id:3,type:"human",value:"<chat><text>Remove the scalability project from â€œImprove latency for databasesâ€ in the Tasks table.</text></chat>"},{type:"assistant",id:4,value:"<think>The user requested to remove the 'Scalability' project from the 'Improve latency for databases' task. I should first query the Projects database to find the page ID for 'Scalability', then query the Tasks database to find the page ID for 'Improve latency for databases', and finally delete the relation between them.</think><query-database id=\"3\"><search question=\"What is the page ID for the 'Scalability' project?\" keywords=\"scalability\"/></query-database>"},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="2" total-results="2"><child-page id="7" page-id="8"><property-title name="Name">Scalability</property-title><property-multi-select name="Tags"><option option="P0"/></property-multi-select><property-relation name="Tasks" database-id="4"><mention-page page-id="9">Improve latency for databases</mention-page></property-relation></child-page><child-page id="10" page-id="11"><property-title name="Name">Product Growth</property-title><property-multi-select name="Tags"><option option="P1"/></property-multi-select><property-relation name="Tasks" database-id="4"/></child-page></query-database-results>',id:18},{type:"assistant",id:20,value:'<think>The page ID for \'Scalability\' is 8.</think><query-database id="4"><search question="What is the page ID for the \'Improve latency for databases\' task?" keywords="improve latency databases"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="3" total-results="3"><child-page id="12" page-id="9"><property-title name="Name">Improve latency for databases</property-title><property-multi-select name="Tags"><option option="P0"/></property-multi-select><property-relation name="Projects" database-id="3"><mention-page page-id="8">Scalability</mention-page></property-relation></child-page><child-page id="13" page-id="14"><property-title name="Name">Drop Page load time to 4 seconds</property-title><property-multi-select name="Tags"/><property-relation name="Projects" database-id="3"/></child-page><child-page id="15" page-id="16"><property-title name="Name">Improve onboarding flow</property-title><property-multi-select name="Tags"><option option="P1"/></property-multi-select><property-relation name="Projects" database-id="3"/></child-page></query-database-results>',id:27},{type:"assistant",id:29,value:'<think>The ID for \'Improve latency for databases\' is 12.</think><delete id="12"><property-relation name="Projects"><mention-page page-id="8"/></delete>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-06-26T23:46:36.651-04:00","current-person-id":"1","current-person-name":"Sharabesh"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Hello world</property-title><child-database id="2" database-id="3"><property-title name="Title">Projects</property-title><schema-property-title name="Name"/><schema-property-multi-select name="Tags"><schema-option option="P0"/><schema-option option="P1"/></schema-property-multi-select><schema-property-relation name="Tasks" limit="Infinity" database-id="4" synced-property-name="Projects"/></child-database><child-database id="5" database-id="4"><property-title name="Title">Tasks</property-title><schema-property-title name="Name"/><schema-property-multi-select name="Tags"><schema-option option="P1"/><schema-option option="P0"/></schema-property-multi-select><schema-property-relation name="Projects" limit="Infinity" database-id="3" synced-property-name="Tasks"/></child-database><text id="6"/></page>',id:2},{id:3,type:"human",value:"<chat><text>Add the Project â€œProduct Growthâ€ to the â€œImprove latency for databasesâ€ task in the tasks DB.</text></chat>"},{type:"assistant",id:4,value:'<think>The user is requesting to add the Project "Product Growth" to the "Improve latency for databases" task. I should first query the Projects database to find the page ID for "Product Growth", then query the Tasks database to find the ID for the "Improve latency for databases" task, then insert a mention of "Product Growth" inside the Tasks page\'s Projects property.</think><query-database id="3"><search question="What is the page ID for the Project \'Product Growth\'?" keywords="Product Growth"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="2" total-results="2"><child-page id="7" page-id="8"><property-title name="Name">Product Growth</property-title><property-multi-select name="Tags"><option option="P1"/></property-multi-select><property-relation name="Tasks" database-id="4"/></child-page><child-page id="9" page-id="10"><property-title name="Name">Scalability</property-title><property-multi-select name="Tags"><option option="P0"/></property-multi-select><property-relation name="Tasks" database-id="4"><mention-page page-id="11">Improve latency for databases</mention-page></property-relation></child-page></query-database-results>',id:18},{type:"assistant",id:19,value:"<think>The query returned the page ID 8 for the Project 'Product Growth'. Now I need to query the Tasks database to find the ID for the 'Improve latency for databases' task.</think><query-database id=\"4\"><search question=\"What is the page ID for the task 'Improve latency for databases'?\" keywords=\"Improve latency for databases\"/></query-database>"},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="3" total-results="3"><child-page id="12" page-id="11"><property-title name="Name">Improve latency for databases</property-title><property-multi-select name="Tags"><option option="P0"/></property-multi-select><property-relation name="Projects" database-id="3"><mention-page page-id="10">Scalability</mention-page></property-relation></child-page><child-page id="13" page-id="14"><property-title name="Name">Drop Page load time to 4 seconds</property-title><property-multi-select name="Tags"/><property-relation name="Projects" database-id="3"/></child-page><child-page id="15" page-id="16"><property-title name="Name">Improve onboarding flow</property-title><property-multi-select name="Tags"><option option="P1"/></property-multi-select><property-relation name="Projects" database-id="3"/></child-page></query-database-results>',id:29},{type:"assistant",id:30,value:'<think>The query returned the ID 12 for the task \'Improve latency for databases\'. I can now insert a mention of \'Product Growth\' inside its Projects property.</think><insert-inside id="12"><property-relation name="Projects" database-id="4"><mention-page page-id="8"/></property-relation></insert-inside>'}]],Fe=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-19T15:33:16.766-07:00","current-person-id":"1","current-person-name":"Julio Santos"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">The Designer\'s Reading Nook</property-title><text id="2">At Space Designers, we\'re always exploring new ideas and inspiration for creative spaces. In The Designer\'s Reading Nook, we share some of our favorite design books, blogs, magazines, and more. Whether you\'re a professional designer or simply design-curious, we hope you find fresh ideas and perspectives to spark your creativity.</text><child-database id="3" database-id="4"><property-title name="Title">Book Reviews</property-title><schema-property-title name="Book Title"/><schema-property-text name="Author"/><schema-property-text name="Genre"/><schema-property-text name="Our Review"/><schema-property-number name="Page Count" format="number"/><schema-property-number name="Rating" format="number"/><schema-property-checkbox name="Recommended"/><schema-property-text name="Synopsis"/></child-database><child-database id="5" database-id="6"><property-title name="Title">Designer Profiles</property-title><schema-property-title name="Designer Name"/><schema-property-person name="Author"/><schema-property-text name="Bio"/><schema-property-text name="Design Style"/><schema-property-email name="Email"/><schema-property-checkbox name="Featured Work"/><schema-property-number name="Projects Completed" format="number"/><schema-property-text name="Quote"/><schema-property-status name="Status"><schema-option-category category="To-do"><schema-option option="Backlogged"/><schema-option option="Not started"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Waiting review"/><schema-option option="In progress"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Shipped"/><schema-option option="Done"/></schema-option-category></schema-property-status><schema-property-url name="Website"/><schema-property-number name="Years Experience" format="number"/></child-database></page>',id:2},{id:3,type:"human",value:"<chat><text>are there any profiles awaiting review?</text></chat>"},{type:"assistant",id:5,value:'<think>The user is asking if there are any designer profiles awaiting review in the database.</think><query-database id="6"><filter-property-status name="Status" condition="is"><option option="Waiting review"/></filter-property-status></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="2" total-results="2"><child-page id="7" page-id="8"><property-title name="Designer Name">Linda Chang</property-title><property-person name="Author"/><property-text name="Bio">Linda Chang is an award-winning interior designer based in San Francisco. Since 2009, Linda has designed custom residential and commercial spaces for clients across the US. Linda\'s style focuses on clean, minimalist designs bringing simplicity and elegance to every space she transforms. In her free time, Linda enjoys photography, hiking, and spending time with her family.</property-text><property-text name="Design Style">Modern Minimalism</property-text><property-email name="Email">linda@linda-chang.com</property-email><property-checkbox name="Featured Work" checked="false"/><property-number name="Projects Completed" number=""/><property-text name="Quote">\'Less is more. Remove clutter and focus on high-quality, long-lasting pieces.\'</property-text><property-status name="Status"><option option="Waiting review"/></property-status><property-url name="Website">linda-chang.com</property-url><property-number name="Years Experience" number="10"/></child-page><child-page id="9" page-id="10"><property-title name="Designer Name">Ashley Williams</property-title><property-person name="Author"/><property-text name="Bio">Ashley Williams is an independent graphic designer and art director based in Austin, Texas. With over 8 years of design experience, Ashley has worked with clients across various industries to create vibrant brand identities, marketing materials, product packaging, mobile apps, website designs, and more. She has a BFA in Graphic Design from The University of Texas at Austin.</property-text><property-text name="Design Style">Clean, minimal and vibrant</property-text><property-email name="Email">hello@ashleywilliamsdesign.com</property-email><property-checkbox name="Featured Work" checked="false"/><property-number name="Projects Completed" number="42"/><property-text name="Quote">Design is thinking made visual.</property-text><property-status name="Status"><option option="Waiting review"/></property-status><property-url name="Website">www.ashleywilliamsdesign.com</property-url><property-number name="Years Experience" number="8"/></child-page></query-database-results>',id:36},{type:"assistant",id:45,value:'<think>The query found designer profiles for Linda Chang and Ashley Williams awaiting review.</think><chat><text>Yes, there are designer profiles awaiting review for <a href="8">Linda Chang</a> and <a href="10">Ashley Williams</a>.</text></chat>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-19T15:35:55.983-07:00","current-person-id":"1","current-person-name":"Li Wei"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">The Assembly Line - Building Custom Apps</property-title><text id="2">At Code Spark, we take a methodical, detail-oriented approach to building custom mobile apps. Like a manufacturing line, our process involves multiple phases to assemble a finished product: Requirements gathering, design, coding, testing, and optimizing. Our designers and developers work closely together at each stage to ensure the end result exceeds our clients\' expectations and transforms how their users engage with their brand.</text><child-database id="3" database-id="4"><property-title name="Title">Clients</property-title><schema-property-title name="Client Name"/><schema-property-phone-number name="Alternate Contact"/><schema-property-text name="Client Description"/><schema-property-number name="Client ID" format="number"/><schema-property-url name="Client Website"/><schema-property-phone-number name="Contact Phone"/><schema-property-phone-number name="Main Phone"/><schema-property-person name="Manager"/><schema-property-text name="Point of Contact"/><schema-property-number name="Project Budget" format="number"/><schema-property-checkbox name="Recurring Client"/></child-database><child-database id="5" database-id="6"><property-title name="Title">Projects</property-title><schema-property-title name="Project Name"/><schema-property-phone-number name=" QA Lead Phone"/><schema-property-url name="App Store/Play Store Link"/><schema-property-number name="Cost" format="dollar"/><schema-property-phone-number name="Developer Phone"/><schema-property-email name="PM Email"/><schema-property-phone-number name="PM Phone"/><schema-property-checkbox name="Project Complete"/><schema-property-text name="Project Type"/><schema-property-person name="Project owner"/><schema-property-text name="Spec Overview"/><schema-property-status name="Status"><schema-option-category category="To-do"><schema-option option="Not started"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Permitting"/><schema-option option="Construction"/><schema-option option="Planning"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Done"/></schema-option-category></schema-property-status><schema-property-text name="Team Members"/><schema-property-phone-number name="UX Designer Phone"/></child-database></page>',id:2},{id:3,type:"human",value:"<chat><text>show me all the in progress projects</text></chat>"},{type:"assistant",id:4,value:'<think>To show the in progress projects, I should query the Projects database filtering for Status options \'Permitting\', \'Construction\', and \'Planning\' which are in the In progress category.</think><query-database id="6"><filter-property-status name="Status" condition="is"><option-category category="In progress"/></filter-property-status></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="4" total-results="4"><child-page id="7" page-id="8"><property-title name="Project Name">HR payroll system</property-title><property-phone-number name=" QA Lead Phone">415-111-2222</property-phone-number><property-url name="App Store/Play Store Link">https://apps.apple.com/us/app/workday/id512478897</property-url><property-number name="Cost" number="$1,000,000.00"/><property-phone-number name="Developer Phone">415-123-4567</property-phone-number><property-email name="PM Email">jdoe@acmeconsulting.com</property-email><property-phone-number name="PM Phone">650-123-4567</property-phone-number><property-checkbox name="Project Complete" checked="false"/><property-text name="Project Type">Software Implementation</property-text><property-person name="Project owner"><mention-person person-id="9" person-name="Julio Santos"/></property-person><property-text name="Spec Overview">Migration of existing PeopleSoft HR system to a new cloud-based Workday Payroll system.</property-text><property-status name="Status"><option option="Construction"/></property-status><property-text name="Team Members">Jane Doe (PM), John Smith (SME), Mary Johnson (UXD), Bob Chen (Developer)</property-text><property-phone-number name="UX Designer Phone">510-222-3333</property-phone-number></child-page><child-page id="10" page-id="11"><property-title name="Project Name">College app</property-title><property-phone-number name=" QA Lead Phone">555-345-6789 </property-phone-number><property-url name="App Store/Play Store Link">https://play.google.com/store/apps/details?id=com.collegeapp</property-url><property-number name="Cost" number=""/><property-phone-number name="Developer Phone">555-234-5678</property-phone-number><property-email name="PM Email">pm@example.com</property-email><property-phone-number name="PM Phone">555-123-4567</property-phone-number><property-checkbox name="Project Complete" checked="false"/><property-text name="Project Type">Mobile app</property-text><property-person name="Project owner"><mention-person person-id="9" person-name="Julio Santos"/></property-person><property-text name="Spec Overview">Build a mobile app to help high school students explore college options. The app will have info on majors, admissions stats, student life,costs, etc. for over 3,000 US colleges and universities. Students can favorite schools, set up campus visits, and ask current students questions.  </property-text><property-status name="Status"><option option="Planning"/></property-status><property-text name="Team Members">iOS developer, Android developer, UI/UX designer, QA tester, Data analyst, Project manager</property-text><property-phone-number name="UX Designer Phone">555-456-7890</property-phone-number></child-page><child-page id="12" page-id="13"><property-title name="Project Name">Stock alerts app</property-title><property-phone-number name=" QA Lead Phone">(415) 555-0123</property-phone-number><property-url name="App Store/Play Store Link">https://apps.apple.com/us/app/stock-alerts-track-and-trade/id111111111</property-url><property-number name="Cost" number=""/><property-phone-number name="Developer Phone">(415) 555-0178</property-phone-number><property-email name="PM Email">jsmith@appdevco.com</property-email><property-phone-number name="PM Phone">(415) 555-0199</property-phone-number><property-checkbox name="Project Complete" checked="true"/><property-text name="Project Type">Mobile</property-text><property-person name="Project owner"><mention-person person-id="9" person-name="Julio Santos"/></property-person><property-text name="Spec Overview">This app helps users set price alerts for stocks so they can stay on top of the market and buy or sell at optimal times. It has full tracking and notification functionality as well as customized alerts for each user.</property-text><property-status name="Status"><option option="Planning"/></property-status><property-text name="Team Members">Project Lead: Jane Smith, UX Designer: John Doe, Developers: [list of 5 developer names]</property-text><property-phone-number name="UX Designer Phone">(415) 555-0456</property-phone-number></child-page><child-page id="14" page-id="15"><property-title name="Project Name">Prescription refill app</property-title><property-phone-number name=" QA Lead Phone">4085554321</property-phone-number><property-url name="App Store/Play Store Link">https://www.company.com/apps/prescriptionrefill</property-url><property-number name="Cost" number=""/><property-phone-number name="Developer Phone">4085412890</property-phone-number><property-email name="PM Email">jChang@company.com</property-email><property-phone-number name="PM Phone">4085551212</property-phone-number><property-checkbox name="Project Complete" checked="false"/><property-text name="Project Type">Mobile application</property-text><property-person name="Project owner"><mention-person person-id="9" person-name="Julio Santos"/></property-person><property-text name="Spec Overview">This app allows users to easily request prescription refills from their pharmacy. Once a user enters their prescription information the first time, the app saves it to automatically populate refill requests in the future. Users can also set up recurring refills for medications taken on a regular schedule. pharmacies arealerted to refill requests via email and can quickly fulfill or deny the request through the app. </property-text><property-status name="Status"><option option="Permitting"/></property-status><property-text name="Team Members">UI/UX Designer, iOS Developer,Android Developer, QA Lead</property-text><property-phone-number name="UX Designer Phone">4081234567</property-phone-number></child-page></query-database-results>',id:18},{type:"assistant",id:19,value:'<think>I found 4 in progress projects based on the query results.</think><chat><text>There are 4 in progress projects: <a href="8">HR payroll system</a> (Construction), <a href="11">College app</a> (Planning), <a href="13">Stock alerts app</a> (Planning), and <a href="15">Prescription refill app</a> (Permitting).</text></chat>'}]],Ne=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-19T14:17:05.122-07:00","current-person-id":"1","current-person-name":"Li Wei"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">The Assembly Line - Building Custom Apps</property-title><text id="2">At Code Spark, we take a methodical, detail-oriented approach to building custom mobile apps. Like a manufacturing line, our process involves multiple phases to assemble a finished product: Requirements gathering, design, coding, testing, and optimizing. Our designers and developers work closely together at each stage to ensure the end result exceeds our clients\' expectations and transforms how their users engage with their brand.</text><child-database id="3" database-id="4"><property-title name="Title">Clients</property-title><schema-property-title name="Client Name"/><schema-property-phone-number name="Alternate Contact"/><schema-property-text name="Client Description"/><schema-property-number name="Client ID"/><schema-property-url name="Client Website"/><schema-property-phone-number name="Contact Phone"/><schema-property-phone-number name="Main Phone"/><schema-property-text name="Point of Contact"/><schema-property-number name="Project Budget"/><schema-property-checkbox name="Recurring Client"/></child-database><child-database id="5" database-id="6"><property-title name="Title">Projects</property-title><schema-property-title name="Project Name"/><schema-property-phone-number name=" QA Lead Phone"/><schema-property-url name="App Store/Play Store Link"/><schema-property-phone-number name="Developer Phone"/><schema-property-email name="PM Email"/><schema-property-phone-number name="PM Phone"/><schema-property-checkbox name="Project Complete"/><schema-property-text name="Project Type"/><schema-property-person name="Project owner"/><schema-property-text name="Spec Overview"/><schema-property-text name="Team Members"/><schema-property-phone-number name="UX Designer Phone"/></child-database></page>',id:2},{id:3,type:"human",value:"<chat><text>what projects does faith williams own?</text></chat>"},{type:"assistant",id:4,value:'<think>The user wants to know which projects Faith Williams owns. I should first use search-people to find Faith Williams\' ID before querying the Projects database.</think><search-people search="faith williams"/>'},{type:"observation",observationType:"searchPeople",value:'<search-people-results current-results="1" total-results="1"><person person-id="7"><property-text name="Name">Faith Williams</property-text><property-email name="Email">faithw@playgrounddesign.net</property-email></person></search-people-results>',id:13},{type:"assistant",id:27,value:'<think>I found Faith Williams\' ID is 7. I will use that to search Projects for pages she owns.</think><query-database id="6"><filter-property-person name="Project owner" condition="contains"><mention-person person-id="7"/></filter-property-person></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="2" total-results="2"><child-page id="8" page-id="9"><property-title name="Project Name">Inventory management system</property-title><property-phone-number name=" QA Lead Phone">650-555-0156</property-phone-number><property-url name="App Store/Play Store Link">https://play.google.com/store/apps/details?id=com.appdevcompany.inventoryapp</property-url><property-phone-number name="Developer Phone">408-555-0128</property-phone-number><property-email name="PM Email">jsmith@appdevcompany.com</property-email><property-phone-number name="PM Phone">408-555-0124</property-phone-number><property-checkbox name="Project Complete" checked="true"/><property-text name="Project Type">Mobile Application</property-text><property-person name="Project owner"><mention-person person-id="7" person-name="Faith Williams"/></property-person><property-text name="Spec Overview">Track inventory for our 50+ retail locations and sync inventory data automatically with our warehouse. Built using Flutter, Firebase and AWS.</property-text><property-text name="Team Members">Jane Smith, John Doe, Jack Stevens, Jessica Lee, Jay Patel, Mei Cheng</property-text><property-phone-number name="UX Designer Phone">415-555-0126</property-phone-number></child-page><child-page id="10" page-id="11"><property-title name="Project Name">Restaurant discovery app</property-title><property-phone-number name=" QA Lead Phone">555-345-6789</property-phone-number><property-url name="App Store/Play Store Link">https://apps.apple.com/us/app/restro-finder/id123456788</property-url><property-phone-number name="Developer Phone">555-234-5678</property-phone-number><property-email name="PM Email">jsmith@company.com</property-email><property-phone-number name="PM Phone">555-123-4568</property-phone-number><property-checkbox name="Project Complete" checked="false"/><property-text name="Project Type">Mobile App</property-text><property-person name="Project owner"><mention-person person-id="12" person-name="Pierre Lachance"/><mention-person person-id="7" person-name="Faith Williams"/></property-person><property-text name="Spec Overview">Create an app to help users discover new restaurants in their city based on cuisine, price, ratings, etc.</property-text><property-text name="Team Members">John Smith, Jane Doe, Bob Lee, Mary Johnson</property-text><property-phone-number name="UX Designer Phone">555-456-7890</property-phone-number></child-page></query-database-results>',id:38},{type:"assistant",id:40,value:"<think>According to the results, Faith Williams owns the projects 'Inventory management system' and 'Restaurant discovery app'.</think><chat><text>Faith Williams owns the <a href=\"9\">Inventory management system</a> and <a href=\"11\">Restaurant discovery app</a> projects.</text></chat>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-19T15:15:34.778-07:00","current-person-id":"1","current-person-name":"Li Wei"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">The Assembly Line - Building Custom Apps</property-title><text id="2">At Code Spark, we take a methodical, detail-oriented approach to building custom mobile apps. Like a manufacturing line, our process involves multiple phases to assemble a finished product: Requirements gathering, design, coding, testing, and optimizing. Our designers and developers work closely together at each stage to ensure the end result exceeds our clients\' expectations and transforms how their users engage with their brand.</text><child-database id="3" database-id="4"><property-title name="Title">Clients</property-title><schema-property-title name="Client Name"/><schema-property-phone-number name="Alternate Contact"/><schema-property-text name="Client Description"/><schema-property-number name="Client ID" format="number"/><schema-property-url name="Client Website"/><schema-property-phone-number name="Contact Phone"/><schema-property-phone-number name="Main Phone"/><schema-property-person name="Manager"/><schema-property-text name="Point of Contact"/><schema-property-number name="Project Budget" format="number"/><schema-property-checkbox name="Recurring Client"/></child-database><child-database id="5" database-id="6"><property-title name="Title">Projects</property-title><schema-property-title name="Project Name"/><schema-property-phone-number name=" QA Lead Phone"/><schema-property-url name="App Store/Play Store Link"/><schema-property-number name="Cost" format="dollar"/><schema-property-phone-number name="Developer Phone"/><schema-property-email name="PM Email"/><schema-property-phone-number name="PM Phone"/><schema-property-checkbox name="Project Complete"/><schema-property-text name="Project Type"/><schema-property-person name="Project owner"/><schema-property-text name="Spec Overview"/><schema-property-text name="Team Members"/><schema-property-phone-number name="UX Designer Phone"/></child-database></page>',id:3},{id:4,type:"human",value:"<chat><text>am I the manager for any clients right now?</text></chat>"},{type:"assistant",id:18,value:'<think>The user is asking if they are currently managing any clients. I should query the Clients database to check.</think><query-database id="4"><filter-property-person name="Manager" condition="contains"><mention-person person-id="1"/></filter-property-person></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="4" total-results="4"><child-page id="7" page-id="8"><property-title name="Client Name">Summerville Community Center</property-title><property-phone-number name="Alternate Contact">Tom Johnson</property-phone-number><property-text name="Client Description">The Summerville Community Center provides recreational, cultural and educational activities for families in Summerville. Their vision is to promote community togetherness through shared experiences. </property-text><property-number name="Client ID" number=""/><property-url name="Client Website">summervillecommunitycenter.org</property-url><property-phone-number name="Contact Phone">123-456-7891</property-phone-number><property-phone-number name="Main Phone">123-456-7890</property-phone-number><property-person name="Manager"><mention-person person-id="1" person-name="Li Wei"/></property-person><property-text name="Point of Contact">Jenny Smith</property-text><property-number name="Project Budget" number="25000"/><property-checkbox name="Recurring Client" checked="false"/></child-page><child-page id="9" page-id="10"><property-title name="Client Name">Summer Drive In</property-title><property-phone-number name="Alternate Contact">Mark Thompson</property-phone-number><property-text name="Client Description">Summer Drive In is a classic drive-in movie theater located just outside of town that shows double features of older movies Thursday through Sunday nights in the summer. They have been a client for the past three years hiring us to handle their social media, email marketing and graphic design.</property-text><property-number name="Client ID" number="12479"/><property-url name="Client Website">summerdrivein.com</property-url><property-phone-number name="Contact Phone">(102) 555-0121</property-phone-number><property-phone-number name="Main Phone">(102) 555-0176</property-phone-number><property-person name="Manager"><mention-person person-id="1" person-name="Li Wei"/></property-person><property-text name="Point of Contact">Jenny Halloran</property-text><property-number name="Project Budget" number="15000"/><property-checkbox name="Recurring Client" checked="false"/></child-page><child-page id="11" page-id="12"><property-title name="Client Name">InTouch Solutions</property-title><property-phone-number name="Alternate Contact">Jane Doe</property-phone-number><property-text name="Client Description">InTouch Solutions is a technology consulting firm that specializes in rapid systems integration and software customization. They build customized CRM, ERP and workflow management systems for medium to large businesses.</property-text><property-number name="Client ID" number="1234"/><property-url name="Client Website">intouchsolutions.com</property-url><property-phone-number name="Contact Phone">(123) 123-4567</property-phone-number><property-phone-number name="Main Phone">(123) 456-7890</property-phone-number><property-person name="Manager"><mention-person person-id="1" person-name="Li Wei"/></property-person><property-text name="Point of Contact">John Smith</property-text><property-number name="Project Budget" number="350000"/><property-checkbox name="Recurring Client" checked="false"/></child-page><child-page id="13" page-id="14"><property-title name="Client Name">That Shop</property-title><property-phone-number name="Alternate Contact">Jane Doe</property-phone-number><property-text name="Client Description">That Shop is a retail clothing brand based in San Francisco. We have been working with them since 2018 to help build and maintain their ecommerce website and mobile app.</property-text><property-number name="Client ID" number="4563"/><property-url name="Client Website">thatshop.com</property-url><property-phone-number name="Contact Phone">+1 (415)555-0123</property-phone-number><property-phone-number name="Main Phone">+1 (555)123-4567 </property-phone-number><property-person name="Manager"><mention-person person-id="1" person-name="Li Wei"/></property-person><property-text name="Point of Contact">John Smith</property-text><property-number name="Project Budget" number="250000"/><property-checkbox name="Recurring Client" checked="true"/></child-page></query-database-results>',id:40},{type:"assistant",id:50,value:'<think>I found 4 clients where the user is listed as the manager: Summerville Community Center, Summer Drive In, InTouch Solutions, That Shop.</think><chat><text>Yes, you are currently managing <a href="8">Summerville Community Center</a>, <a href="10">Summer Drive In</a>, <a href="12">InTouch Solutions</a>, and <a href="14">That Shop</a>.</text></chat>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-19T15:27:09.245-07:00","current-person-id":"1","current-person-name":"Julio Santos"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">The Designer\'s Reading Nook</property-title><text id="2">At Space Designers, we\'re always exploring new ideas and inspiration for creative spaces. In The Designer\'s Reading Nook, we share some of our favorite design books, blogs, magazines, and more. Whether you\'re a professional designer or simply design-curious, we hope you find fresh ideas and perspectives to spark your creativity.</text><child-database id="3" database-id="4"><property-title name="Title">Book Reviews</property-title><schema-property-title name="Book Title"/><schema-property-text name="Author"/><schema-property-text name="Genre"/><schema-property-text name="Our Review"/><schema-property-number name="Page Count" format="number"/><schema-property-number name="Rating" format="number"/><schema-property-checkbox name="Recommended"/><schema-property-text name="Synopsis"/></child-database><child-database id="5" database-id="6"><property-title name="Title">Designer Profiles</property-title><schema-property-title name="Designer Name"/><schema-property-person name="Author"/><schema-property-text name="Bio"/><schema-property-text name="Design Style"/><schema-property-email name="Email"/><schema-property-checkbox name="Featured Work"/><schema-property-number name="Projects Completed" format="number"/><schema-property-text name="Quote"/><schema-property-url name="Website"/><schema-property-number name="Years Experience" format="number"/></child-database></page>',id:2},{id:3,type:"human",value:"<chat><text>which profiles did javier author? you need to search people first. if there are multiple matches, include them all in your DB query</text></chat>"},{type:"assistant",id:31,value:'<think>The user is asking which Designer Profiles were authored by Javier. I need to search people to find Javier\'s ID(s).</think><search-people search="javier"/>'},{type:"observation",observationType:"searchPeople",value:'<search-people-results current-results="9" total-results="9"><person person-id="7"><property-text name="Name">Javier GarcÃ­a</property-text><property-email name="Email">javierg@vidarestaurante.es</property-email></person><person person-id="8"><property-text name="Name">Javier Hernandez</property-text><property-email name="Email">javierh@mexicanmarket.mx</property-email></person><person person-id="9"><property-text name="Name">Javier Solano</property-text><property-email name="Email">javiers@organicfarms.cr</property-email></person><person person-id="10"><property-text name="Name">Javier GutiÃ©rrez</property-text><property-email name="Email">javiergutierrez@granjadecerdoiberico.es</property-email></person><person person-id="11"><property-text name="Name">Jorge Benavides</property-text><property-email name="Email">jorge@vinosymusica.cl</property-email></person><person person-id="12"><property-text name="Name">Raja Patel</property-text><property-email name="Email">rajap@ayurvedicherbs.in</property-email></person><person person-id="13"><property-text name="Name">Vicente Rojas</property-text><property-email name="Email">vrojas@vinosdelsur.cl</property-email></person><person person-id="14"><property-text name="Name">Juan Solis</property-text><property-email name="Email">juansolis@cevichebar.cr</property-email></person><person person-id="15"><property-text name="Name">Jens Sorensen</property-text><property-email name="Email">jenssorensen@akvavitdestillery.dk</property-email></person></search-people-results>',id:59},{type:"assistant",id:61,value:'<think>There are four people named Javier: IDs 7, 8, 9, and 10. I will query the Designer Profiles database for profiles authored by any of these people.</think><query-database id="6"><filter-property-person name="Author" condition="contains"><mention-person person-id="7"/><mention-person person-id="8"/><mention-person person-id="9"/><mention-person person-id="10"/></filter-property-person></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="4" total-results="4"><child-page id="16" page-id="17"><property-title name="Designer Name">Natalie Cooper</property-title><property-person name="Author"><mention-person person-id="7" person-name="Javier GarcÃ­a"/></property-person><property-text name="Bio">Natalie Cooper is an award-winning interior designer based in San Francisco. She believes good design is about creating functional, beautiful spaces customized for each client\'s unique lifestyle. Natalie\'s signature style blends classic, timeless pieces with an artistic yet tailored sensibility.</property-text><property-text name="Design Style">Contemporary, Mid-Century Modern, Eclectic</property-text><property-email name="Email">natalie@nataliecooperdesign.com</property-email><property-checkbox name="Featured Work" checked="false"/><property-number name="Projects Completed" number="50"/><property-text name="Quote">\'A room should never be so finished that it doesn\'t leave room for the imagination.\' - Natalie Cooper</property-text><property-url name="Website">nataliecooperdesign.com</property-url><property-number name="Years Experience" number="10"/></child-page><child-page id="18" page-id="19"><property-title name="Designer Name">Jane Doe</property-title><property-person name="Author"><mention-person person-id="7" person-name="Javier GarcÃ­a"/></property-person><property-text name="Bio"> Jane Doe is a San Francisco-based designer specializing in branding, product design, and user experience. Her minimal, modern style emphasizes clean lines, simple forms, and user-centered solutions.</property-text><property-text name="Design Style">Modern, Minimalist</property-text><property-email name="Email">jane@janedoedesigns.com</property-email><property-checkbox name="Featured Work" checked="false"/><property-number name="Projects Completed" number=""/><property-text name="Quote">â€œGood design is as little design as possible.â€ - Dieter Rams</property-text><property-url name="Website">janedoedesigns.com</property-url><property-number name="Years Experience" number="10"/></child-page><child-page id="20" page-id="21"><property-title name="Designer Name">Rachel Gold</property-title><property-person name="Author"><mention-person person-id="7" person-name="Javier GarcÃ­a"/></property-person><property-text name="Bio">Rachel Gold is an award-winning freelance graphic designer based in San Francisco. With over 10 years of experience, Rachel has completed design work for clients including Google, Airbnb, and Uber. She is known for her minimal and whimsical style.</property-text><property-text name="Design Style">Minimalist with splashes of bold color and whimsical details.</property-text><property-email name="Email">rachel@rachelgolddesigns.com</property-email><property-checkbox name="Featured Work" checked="false"/><property-number name="Projects Completed" number=""/><property-text name="Quote">\'Good design is as little design as possible.\' - Dieter Rams</property-text><property-url name="Website">rachelgolddesigns.com</property-url><property-number name="Years Experience" number="10"/></child-page><child-page id="22" page-id="23"><property-title name="Designer Name">Christine Brown</property-title><property-person name="Author"><mention-person person-id="7" person-name="Javier GarcÃ­a"/></property-person><property-text name="Bio">Christine Brown is an interior designer based in Portland, OR. She received her BFA in Interior Design from the Rhode Island School of Design. Christine draws inspiration from mid-century and Scandinavian design. Her portfolio includes private residences, restaurants, and commercial spaces.</property-text><property-text name="Design Style">Mid-Century Modern, Scandinavian Design</property-text><property-email name="Email">christine@cbrowndesigns.com</property-email><property-checkbox name="Featured Work" checked="false"/><property-number name="Projects Completed" number=""/><property-text name="Quote">â€œGood design is as little design as possible.â€ - Dieter Rams</property-text><property-url name="Website">www.cbrowndesigns.com</property-url><property-number name="Years Experience" number="8"/></child-page></query-database-results>',id:100},{type:"assistant",id:111,value:'<think>The four designer profiles authored by Javier GarcÃ­a: Natalie Cooper, Jane Doe, Rachel Gold, and Christine Brown.</think><chat><text><a href="17">Natalie Cooper</a>, <a href="19">Jane Doe</a>, <a href="21">Rachel Gold</a>, and <a href="23">Christine Brown</a> designer profiles were authored by Javier GarcÃ­a.</text></chat>'}]],je=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-19T15:40:29.534-07:00","current-person-id":"1","current-person-name":"Li Wei"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">The Assembly Line - Building Custom Apps</property-title><text id="2">At Code Spark, we take a methodical, detail-oriented approach to building custom mobile apps. Like a manufacturing line, our process involves multiple phases to assemble a finished product: Requirements gathering, design, coding, testing, and optimizing. Our designers and developers work closely together at each stage to ensure the end result exceeds our clients\' expectations and transforms how their users engage with their brand.</text><child-database id="3" database-id="4"><property-title name="Title">Clients</property-title><schema-property-title name="Client Name"/><schema-property-phone-number name="Alternate Contact"/><schema-property-text name="Client Description"/><schema-property-number name="Client ID" format="number"/><schema-property-url name="Client Website"/><schema-property-phone-number name="Contact Phone"/><schema-property-phone-number name="Main Phone"/><schema-property-person name="Manager"/><schema-property-text name="Point of Contact"/><schema-property-number name="Project Budget" format="number"/><schema-property-checkbox name="Recurring Client"/></child-database><child-database id="5" database-id="6"><property-title name="Title">Projects</property-title><schema-property-title name="Project Name"/><schema-property-phone-number name=" QA Lead Phone"/><schema-property-url name="App Store/Play Store Link"/><schema-property-number name="Cost" format="dollar"/><schema-property-phone-number name="Developer Phone"/><schema-property-email name="PM Email"/><schema-property-phone-number name="PM Phone"/><schema-property-checkbox name="Project Complete"/><schema-property-text name="Project Type"/><schema-property-person name="Project owner"/><schema-property-text name="Spec Overview"/><schema-property-status name="Status"><schema-option-category category="To-do"><schema-option option="Not started"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Permitting"/><schema-option option="Construction"/><schema-option option="Planning"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Done"/></schema-option-category></schema-property-status><schema-property-text name="Team Members"/><schema-property-phone-number name="UX Designer Phone"/></child-database></page>',id:2},{id:3,type:"human",value:"<chat><text>do we have any recurring clients with a budget of over  400k?</text></chat>"},{type:"assistant",id:4,value:'<think>The user is asking if we have any recurring clients with a project budget over $400,000. I will query the Clients database for recurring clients with a budget over $400,000.</think><query-database id="4"><filter-property-checkbox name="Recurring Client" condition="is" checked="true"/><filter-property-number name="Project Budget" condition=">" number="400000"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="1" total-results="1"><child-page id="22" page-id="23"><property-title name="Client Name">Peak Insurance</property-title><property-phone-number name="Alternate Contact">Mike Jones</property-phone-number><property-text name="Client Description">Peak Insurance, a Silicon Valley-based insurance brokerage firm offering employee benefits consulting and private market health plans to small-to-midsize companies.</property-text><property-number name="Client ID" number=""/><property-url name="Client Website">peakinsurance.com</property-url><property-phone-number name="Contact Phone">(650)386-2211</property-phone-number><property-phone-number name="Main Phone">(650)555-0199</property-phone-number><property-person name="Manager"><mention-person person-id="21" person-name="Fatima Aziz"/></property-person><property-text name="Point of Contact">Jenny Smith</property-text><property-number name="Project Budget" number="500000"/><property-checkbox name="Recurring Client" checked="true"/></child-page></query-database-results>',id:17},{type:"assistant",id:19,value:'<think>Peak Insurance has a project budget of over 400k according to the query results.</think><chat><text>Yes, we have <a href="23">Peak Insurance</a> as a recurring client with a 500k project budget.</text></chat>'}]],Oe=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-19T15:12:11.530-07:00","current-person-id":"1","current-person-name":"Li Wei"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">The Assembly Line - Building Custom Apps</property-title><text id="2">At Code Spark, we take a methodical, detail-oriented approach to building custom mobile apps. Like a manufacturing line, our process involves multiple phases to assemble a finished product: Requirements gathering, design, coding, testing, and optimizing. Our designers and developers work closely together at each stage to ensure the end result exceeds our clients\' expectations and transforms how their users engage with their brand.</text><child-database id="3" database-id="4"><property-title name="Title">Clients</property-title><schema-property-title name="Client Name"/><schema-property-phone-number name="Alternate Contact"/><schema-property-text name="Client Description"/><schema-property-number name="Client ID" format="number"/><schema-property-url name="Client Website"/><schema-property-phone-number name="Contact Phone"/><schema-property-phone-number name="Main Phone"/><schema-property-text name="Point of Contact"/><schema-property-number name="Project Budget" format="number"/><schema-property-checkbox name="Recurring Client"/></child-database><child-database id="5" database-id="6"><property-title name="Title">Projects</property-title><schema-property-title name="Project Name"/><schema-property-phone-number name=" QA Lead Phone"/><schema-property-url name="App Store/Play Store Link"/><schema-property-number name="Cost" format="dollar"/><schema-property-phone-number name="Developer Phone"/><schema-property-email name="PM Email"/><schema-property-phone-number name="PM Phone"/><schema-property-checkbox name="Project Complete"/><schema-property-text name="Project Type"/><schema-property-person name="Project owner"/><schema-property-text name="Spec Overview"/><schema-property-text name="Team Members"/><schema-property-phone-number name="UX Designer Phone"/></child-database></page>',id:2},{id:3,type:"human",value:"<chat><text>do any of our projects have a total cost over 500k?</text></chat>"},{type:"assistant",id:4,value:'<think>Based on the question, I should query the "Projects" database for any projects with a "Cost" over $500,000.</think><query-database id="6"><filter-property-number name="Cost" condition=">" number="500000"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="2" total-results="2"><child-page id="7" page-id="8"><property-title name="Project Name">Inventory management system</property-title><property-phone-number name=" QA Lead Phone">650-555-0156</property-phone-number><property-url name="App Store/Play Store Link">https://play.google.com/store/apps/details?id=com.appdevcompany.inventoryapp</property-url><property-number name="Cost" number="$560,000.00"/><property-phone-number name="Developer Phone">408-555-0128</property-phone-number><property-email name="PM Email">jsmith@appdevcompany.com</property-email><property-phone-number name="PM Phone">408-555-0124</property-phone-number><property-checkbox name="Project Complete" checked="true"/><property-text name="Project Type">Mobile Application</property-text><property-person name="Project owner"><mention-person person-id="9" person-name="Faith Williams"/></property-person><property-text name="Spec Overview">Track inventory for our 50+ retail locations and sync inventory data automatically with our warehouse. Built using Flutter, Firebase and AWS.</property-text><property-text name="Team Members">Jane Smith, John Doe, Jack Stevens, Jessica Lee, Jay Patel, Mei Cheng</property-text><property-phone-number name="UX Designer Phone">415-555-0126</property-phone-number></child-page><child-page id="10" page-id="11"><property-title name="Project Name">HR payroll system</property-title><property-phone-number name=" QA Lead Phone">415-111-2222</property-phone-number><property-url name="App Store/Play Store Link">https://apps.apple.com/us/app/workday/id512478897</property-url><property-number name="Cost" number="$1,000,000.00"/><property-phone-number name="Developer Phone">415-123-4567</property-phone-number><property-email name="PM Email">jdoe@acmeconsulting.com</property-email><property-phone-number name="PM Phone">650-123-4567</property-phone-number><property-checkbox name="Project Complete" checked="false"/><property-text name="Project Type">Software Implementation</property-text><property-person name="Project owner"><mention-person person-id="12" person-name="Julio Santos"/></property-person><property-text name="Spec Overview">Migration of existing PeopleSoft HR system to a new cloud-based Workday Payroll system.</property-text><property-text name="Team Members">Jane Doe (PM), John Smith (SME), Mary Johnson (UXD), Bob Chen (Developer)</property-text><property-phone-number name="UX Designer Phone">510-222-3333</property-phone-number></child-page></query-database-results>',id:16},{type:"assistant",id:17,value:'<think>2 projects, Inventory management system ($560,000) and HR payroll system ($1,000,000) have a total cost over $500,000.</think><chat><text>Yes, two projects have a cost exceeding $500,000: the <a href="8">Inventory management system</a> ($560,000) and <a href="11">HR payroll system</a> ($1 million).</text></chat>'}]],Le=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-23T09:54:28.428-07:00","current-person-id":"1","current-person-name":"Takeshi Tanaka"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Bright Sparks\' Hub for Educators</property-title><text id="2">At Bright Sparks Learning, we know that our programs are only as strong as the teachers who lead them. The Educator Hub is your resource for news, events, best practices, and collaboration opportunities within our community of educators. Connect with fellow teachers, get inspired, share ideas, and discover new ways to engage your students. Together, let\'s make learning fun, impactful, and transformational.</text><child-database id="3" database-id="4"><property-title name="Title">Instructor Program Proposals</property-title><schema-property-title name="Program Title"/><schema-property-multi-select name="Instructional Methods"><schema-option option="Demonstration"/><schema-option option="Hands-on Project"/><schema-option option="Group Discussion"/><schema-option option="Lecture"/><schema-option option="Field Trip"/></schema-property-multi-select><schema-property-checkbox name="New Program"/><schema-property-url name="Online Resource Links"/><schema-property-person name="Program Approver"/><schema-property-email name="Program Approver Email"/><schema-property-person name="Program Coordinator"/><schema-property-phone-number name="Program Coordinator Contact Number"/><schema-property-multi-select name="Program Focus"><schema-option option="Creative Writing"/><schema-option option="Robotics"/><schema-option option="Arts and Crafts"/></schema-property-multi-select><schema-property-status name="Program Proposal Status"><schema-option-category category="To-do"><schema-option option="Proposal Draft"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Feedback Addressed"/><schema-option option="Revisions Pending"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Approved"/><schema-option option="Launch Ready"/></schema-option-category></schema-property-status><schema-property-text name="Rationale and Key Objectives"/><schema-property-select name="Subject Areas"><schema-option option="English"/><schema-option option="Math"/><schema-option option="Science"/></schema-property-select><schema-property-number name="Suggested Grade Levels" format="number"/></child-database><child-database id="5" database-id="6"><property-title name="Title">Extracurricular Activity Tracker</property-title><schema-property-title name="Activity Name"/><schema-property-status name="Activity Status"><schema-option-category category="To-do"><schema-option option="Gathering Interest"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Scheduling"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Ongoing"/><schema-option option="Registration Closed"/></schema-option-category></schema-property-status><schema-property-select name="Activity Type"><schema-option option="Yoga"/><schema-option option="Soccer"/><schema-option option="Book Club"/><schema-option option="Volunteering"/><schema-option option="Coding"/></schema-property-select><schema-property-person name="Club Leader"/><schema-property-email name="Club Leader Email"/><schema-property-text name="Description"/><schema-property-checkbox name="Free to Public"/><schema-property-text name="Location"/><schema-property-number name="Maximum Capacity" format="danish_krone"/><schema-property-multi-select name="Meeting Frequency"><schema-option option="Weekly"/><schema-option option="Monthly"/><schema-option option="Quarterly"/><schema-option option="Biweekly"/></schema-property-multi-select><schema-property-checkbox name="Permission Slip Required"/><schema-property-url name="Sign-up Link"/><schema-property-phone-number name="Teacher Contact Number"/><schema-property-number name="Total Attendance" format="number"/></child-database></page>',id:2},{id:3,type:"human",value:"<chat><text>find the activity with the lowest attendance</text></chat>"},{type:"assistant",id:5,value:'<think>To find the activity with the lowest attendance, I will query the Extracurricular Activity Tracker database and sort the results by the Total Attendance property in ascending order.</think><query-database id="6"><sort-property-number name="Total Attendance" direction="ascending"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="10" total-results="26"><child-page id="7" page-id="8"><property-title name="Activity Name">Key club</property-title><property-status name="Activity Status"><option option="Scheduling"/></property-status><property-select name="Activity Type"><option option="Yoga"/></property-select><property-person name="Club Leader"/><property-email name="Club Leader Email">johndoe@sfusd.edu</property-email><property-text name="Description">After-school robotics club where students design, build, program, and compete with LEGO Mindstorms robots.</property-text><property-checkbox name="Free to Public" checked="false"/><property-text name="Location">George Washington High School, San Francisco, Room 102</property-text><property-number name="Maximum Capacity" number="DKKÂ 2,235.00"/><property-multi-select name="Meeting Frequency"><option option="Biweekly"/></property-multi-select><property-checkbox name="Permission Slip Required" checked="true"/><property-url name="Sign-up Link">https://www.activityhero.com/p/sfusd-robotics-club</property-url><property-phone-number name="Teacher Contact Number">(415) 723-2345</property-phone-number><property-number name="Total Attendance" number="1942"/></child-page><child-page id="9" page-id="10"><property-title name="Activity Name">Photography club</property-title><property-status name="Activity Status"><option option="Registration Closed"/></property-status><property-select name="Activity Type"><option option="Yoga"/></property-select><property-person name="Club Leader"/><property-email name="Club Leader Email">debateclub@examplehighschool.edu</property-email><property-text name="Description">The Debate Club provides students an opportunity to learn and practice skills in public speaking, critical thinking, and argumentation. Students will participate in practice debates and have opportunities to compete in local debate tournaments. No prior experience required!</property-text><property-checkbox name="Free to Public" checked="false"/><property-text name="Location">Room 205, High School West</property-text><property-number name="Maximum Capacity" number="DKKÂ 15,453.00"/><property-multi-select name="Meeting Frequency"><option option="Biweekly"/><option option="Weekly"/><option option="Quarterly"/><option option="Monthly"/></property-multi-select><property-checkbox name="Permission Slip Required" checked="false"/><property-url name="Sign-up Link">http://bit.ly/debateclubsignup</property-url><property-phone-number name="Teacher Contact Number">123-456-7890</property-phone-number><property-number name="Total Attendance" number="10212"/></child-page><child-page id="11" page-id="12"><property-title name="Activity Name">Mathcounts</property-title><property-status name="Activity Status"><option option="Scheduling"/></property-status><property-select name="Activity Type"><option option="Volunteering"/></property-select><property-person name="Club Leader"><mention-person person-id="13" person-name="Ahmed Qasim"/></property-person><property-email name="Club Leader Email">jdoe@myschool.edu</property-email><property-text name="Description">After-school programming club focused on building mobile apps and games. Meets every Wednesday for one hour. Open to all high school students. No experience required!</property-text><property-checkbox name="Free to Public" checked="false"/><property-text name="Location">Room 103</property-text><property-number name="Maximum Capacity" number="DKKÂ 9,575.00"/><property-multi-select name="Meeting Frequency"/><property-checkbox name="Permission Slip Required" checked="true"/><property-url name="Sign-up Link">https://extracurricular.myschool.edu/programmingclub</property-url><property-phone-number name="Teacher Contact Number">650-723-2345</property-phone-number><property-number name="Total Attendance" number="11752"/></child-page><child-page id="14" page-id="15"><property-title name="Activity Name">Mandarin club</property-title><property-status name="Activity Status"><option option="Ongoing"/></property-status><property-select name="Activity Type"><option option="Coding"/></property-select><property-person name="Club Leader"/><property-email name="Club Leader Email">debateclub@examplehighschool.edu</property-email><property-text name="Description">The debate club is an opportunity for students to learn public speaking, critical thinking, rhetorical and argumentative skills in a competitive setting. Students participate in practice debates and have the opportunity to compete regionally.</property-text><property-checkbox name="Free to Public" checked="false"/><property-text name="Location">Room 124</property-text><property-number name="Maximum Capacity" number="DKKÂ 53,062.00"/><property-multi-select name="Meeting Frequency"><option option="Monthly"/><option option="Biweekly"/></property-multi-select><property-checkbox name="Permission Slip Required" checked="true"/><property-url name="Sign-up Link">https://forms.gle/extracurricularsignups</property-url><property-phone-number name="Teacher Contact Number">123-456-7890</property-phone-number><property-number name="Total Attendance" number="12947"/></child-page><child-page id="16" page-id="17"><property-title name="Activity Name">Art club</property-title><property-status name="Activity Status"><option option="Gathering Interest"/></property-status><property-select name="Activity Type"><option option="Yoga"/></property-select><property-person name="Club Leader"/><property-email name="Club Leader Email">hikingclub@examplehighschool.edu</property-email><property-text name="Description">We explore the local parks and trails every other Saturday morning. All skill levels welcome!</property-text><property-checkbox name="Free to Public" checked="false"/><property-text name="Location">Various parks and trails around San Francisco Bay Area</property-text><property-number name="Maximum Capacity" number="DKKÂ 61,177.00"/><property-multi-select name="Meeting Frequency"><option option="Biweekly"/></property-multi-select><property-checkbox name="Permission Slip Required" checked="true"/><property-url name="Sign-up Link">https://activities.examplehighschool.edu/hikingclub</property-url><property-phone-number name="Teacher Contact Number">650-555-1234</property-phone-number><property-number name="Total Attendance" number="18382"/></child-page><child-page id="18" page-id="19"><property-title name="Activity Name">Book club</property-title><property-status name="Activity Status"><option option="Gathering Interest"/></property-status><property-select name="Activity Type"><option option="Volunteering"/></property-select><property-person name="Club Leader"><mention-person person-id="20" person-name="Milos Novak"/></property-person><property-email name="Club Leader Email">ekim@stanford.edu</property-email><property-text name="Description">Yoga Club aims to promote health and wellness by offering free yoga and meditation workshops on campus.</property-text><property-checkbox name="Free to Public" checked="false"/><property-text name="Location">Arrillaga Gymnasium: Exercise Room 1</property-text><property-number name="Maximum Capacity" number="DKKÂ 28,623.00"/><property-multi-select name="Meeting Frequency"><option option="Biweekly"/></property-multi-select><property-checkbox name="Permission Slip Required" checked="false"/><property-url name="Sign-up Link">https://activities.stanford.edu/yogaclubsignup/</property-url><property-phone-number name="Teacher Contact Number">(650) 723-8940</property-phone-number><property-number name="Total Attendance" number="26654"/></child-page><child-page id="21" page-id="22"><property-title name="Activity Name">Coding club</property-title><property-status name="Activity Status"><option option="Scheduling"/></property-status><property-select name="Activity Type"><option option="Volunteering"/></property-select><property-person name="Club Leader"><mention-person person-id="23" person-name="Pablo Olivares"/><mention-person person-id="24" person-name="Jorge Torres"/></property-person><property-email name="Club Leader Email">mindstormsclub@sanchezelementary.edu</property-email><property-text name="Description">An after-school club focused on building and programming with LEGO MINDSTORMS robotics kits. Students work together in teams to design, build, and program working LEGO robots. No previous experience required!</property-text><property-checkbox name="Free to Public" checked="false"/><property-text name="Location">William Sanchez Elementary School Cafeteria</property-text><property-number name="Maximum Capacity" number="DKKÂ 32,088.00"/><property-multi-select name="Meeting Frequency"><option option="Quarterly"/><option option="Weekly"/><option option="Biweekly"/><option option="Monthly"/></property-multi-select><property-checkbox name="Permission Slip Required" checked="false"/><property-url name="Sign-up Link">goo.gl/forms/extracurricular</property-url><property-phone-number name="Teacher Contact Number">650-821-1234</property-phone-number><property-number name="Total Attendance" number="30190"/></child-page><child-page id="25" page-id="26"><property-title name="Activity Name">Orchestra</property-title><property-status name="Activity Status"><option option="Gathering Interest"/></property-status><property-select name="Activity Type"><option option="Soccer"/></property-select><property-person name="Club Leader"><mention-person person-id="27" person-name="Milla Nurmi"/><mention-person person-id="20" person-name="Milos Novak"/><mention-person person-id="28" person-name="MartÃ­n SuÃ¡rez"/></property-person><property-email name="Club Leader Email">chemclub@examplehighschool.edu</property-email><property-text name="Description">The high school Chemistry Club meets twice a month after school to conduct fun chemistry experiments and demonstrations. All students interested in chemistry are welcome to join.</property-text><property-checkbox name="Free to Public" checked="false"/><property-text name="Location">Science Building, Room 201</property-text><property-number name="Maximum Capacity" number="DKKÂ 19,622.00"/><property-multi-select name="Meeting Frequency"><option option="Monthly"/><option option="Biweekly"/></property-multi-select><property-checkbox name="Permission Slip Required" checked="true"/><property-url name="Sign-up Link">https://examplehighschool.edu/clubsignup</property-url><property-phone-number name="Teacher Contact Number">408-123-4567</property-phone-number><property-number name="Total Attendance" number="31558"/></child-page><child-page id="29" page-id="30"><property-title name="Activity Name">Drama club</property-title><property-status name="Activity Status"><option option="Ongoing"/></property-status><property-select name="Activity Type"><option option="Soccer"/></property-select><property-person name="Club Leader"><mention-person person-id="23" person-name="Pablo Olivares"/><mention-person person-id="31" person-name="Xiang Chen"/><mention-person person-id="32" person-name="Manuel Ortega"/></property-person><property-email name="Club Leader Email">jdoe@youthroboticsteam.com</property-email><property-text name="Description">Youth robotics team focused on building and programming educational Lego robotics kits. Grades 4-8.</property-text><property-checkbox name="Free to Public" checked="true"/><property-text name="Location">Community Center, Room 102</property-text><property-number name="Maximum Capacity" number="DKKÂ 44,352.00"/><property-multi-select name="Meeting Frequency"/><property-checkbox name="Permission Slip Required" checked="false"/><property-url name="Sign-up Link">https://youthroboticsteam.com/sign-up</property-url><property-phone-number name="Teacher Contact Number">408-559-0171</property-phone-number><property-number name="Total Attendance" number="46475"/></child-page><child-page id="33" page-id="34"><property-title name="Activity Name">National Honor Society</property-title><property-status name="Activity Status"><option option="Gathering Interest"/></property-status><property-select name="Activity Type"><option option="Book Club"/></property-select><property-person name="Club Leader"><mention-person person-id="28" person-name="MartÃ­n SuÃ¡rez"/><mention-person person-id="35" person-name="Vera NovÃ¡kovÃ¡"/></property-person><property-email name="Club Leader Email">gardeningclub@school.edu</property-email><property-text name="Description">The gardening club meets weekly to work on the school garden. Students learn about gardening and sustainability while earning community service hours.</property-text><property-checkbox name="Free to Public" checked="true"/><property-text name="Location">School Courtyard</property-text><property-number name="Maximum Capacity" number="DKKÂ 16,718.00"/><property-multi-select name="Meeting Frequency"><option option="Quarterly"/><option option="Monthly"/></property-multi-select><property-checkbox name="Permission Slip Required" checked="true"/><property-url name="Sign-up Link">gardeningclub.edu/signup</property-url><property-phone-number name="Teacher Contact Number">415-123-4567</property-phone-number><property-number name="Total Attendance" number="48533"/></child-page></query-database-results>',id:18},{type:"assistant",id:19,value:'<think>Based on the query results, the activity with the lowest attendance is <a href="7">Key club</a>, which has an attendance of 1942.</think><chat><text>The activity with the lowest attendance is <a href="7">Key club</a> which has 1942 attendees.</text></chat>'}]],Ue=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-23T09:28:56.358-07:00","current-person-id":"1","current-person-name":"Natalia Rossi"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Engineering Insights - Learning by Reflection</property-title><text id="2">At Nova Labs, we believe that continued learning and improvement are essential to innovation. That\'s why our design team tracks key takeaways, lessons learned, and areas of opportunity after each project launch. The Engineering Insights page provides a glimpse into our post-mortem review process, sharing our designers\' and engineers\' perspectives on what works, what doesn\'t, and how we can elevate our craft to build the products of tomorrow.</text><child-database id="3" database-id="4"><property-title name="Title">Project Lightning Lessons Learned</property-title><schema-property-title name="Key Takeaway"/><schema-property-status name="Key Action Items"><schema-option-category category="To-do"><schema-option option="Review Initial Project Objectives"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Collect User Feedback"/><schema-option option="Analyze Feedback and Determine Next Steps"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Finalize Documentation and Archive Files"/><schema-option option="Schedule Debrief with Internal Stakeholders"/></schema-option-category></schema-property-status><schema-property-phone-number name="Project Lead Contact Number"/><schema-property-person name="Project Manager"/><schema-property-email name="Project Manager Email"/><schema-property-multi-select name="Project Phase"><schema-option option="Hardware Design"/><schema-option option="Software Design"/><schema-option option="Manufacturing"/><schema-option option="Graphic Design"/><schema-option option="UI/UX Design"/><schema-option option="Product Management"/></schema-property-multi-select><schema-property-multi-select name="Project Phase Issues Originated"><schema-option option="Requirements Gathering"/><schema-option option="Product Specification"/><schema-option option="Test Plan Documentation"/></schema-property-multi-select><schema-property-select name="Project Success Criteria"><schema-option option="Exceeded"/><schema-option option="Met"/><schema-option option="Mostly Met"/><schema-option option="Partly Met"/><schema-option option="Not Met"/><schema-option option="Unable to Determine"/></schema-property-select><schema-property-url name="Prototype Demo Recording"/><schema-property-text name="Prototype mobile app lacked intuitive UX for end users without significant training. Increased user testing is needed to identify pain points earlier in our design process."/><schema-property-checkbox name="Requires Follow-Up"/><schema-property-number name="Total Project Hours" format="number"/></child-database><child-database id="5" database-id="6"><property-title name="Title">Smartlet Improvement Plan</property-title><schema-property-title name="Key Opportunity"/><schema-property-phone-number name="Lead Designer Contact Number"/><schema-property-email name="Lead Designer Email"/><schema-property-checkbox name="On Track for Success Milestone"/><schema-property-multi-select name="Potential New Features"><schema-option option="Add Sign Language Interpretation"/><schema-option option="Improve GPS Accuracy"/><schema-option option="Enable Voice-Activated Controls"/><schema-option option="Support Different Clock Faces/Apps"/></schema-property-multi-select><schema-property-person name="Product Director"/><schema-property-select name="Roadmap Timeline Success Criteria"><schema-option option="Exceeded"/><schema-option option="Met"/><schema-option option="Mostly Met"/><schema-option option="Partly Met"/><schema-option option="Not Met"/></schema-property-select><schema-property-status name="Smartlet Product Roadmap"><schema-option-category category="To-do"><schema-option option="Outline High-Level Product Roadmap"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Conduct Competitive Analysis"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Finalize Product Requirements"/></schema-option-category></schema-property-status><schema-property-url name="Smartlet Product Roadmap Presentation"/><schema-property-status name="Smartlet Roadmap Status"><schema-option-category category="To-do"><schema-option option="Review Initial Roadmap"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Gather Stakeholder Feedback"/><schema-option option="Incorporate Feedback into Roadmap"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Present Final Roadmap for Approval"/></schema-option-category></schema-property-status><schema-property-text name="The Smartlet has an opportunity to expand features in future hardware and software updates to improve the user experience and open up new addressable markets."/><schema-property-number name="Total Hours to Finalize Roadmap" format="pound"/></child-database></page>',id:2},{id:3,type:"human",value:"<chat><text>create a new lesson learned for reliability testing. fill out reasonable default values for all of the properties.</text></chat>"},{type:"assistant",id:4,value:'<think>The user has requested a new entry in Project Lightning Lessons Learned database with all default properties filled out for reliability testing.</think><insert-inside id="4"><page><property-title name="Key Takeaway">More rigorous reliability testing needed</property-title><property-status name="Key Action Items"><option option="Collect User Feedback"/><option option="Recruit Additional Beta Testers"/></property-status><property-phone-number name="Project Lead Contact Number">5558675309</property-phone-number><property-person name="Project Manager"><mention-person person-id="1"/></property-person><property-email name="Project Manager Email">natalia@novalabs.com</property-email><property-multi-select name="Project Phase"><option option="Software Design"/></property-multi-select><property-multi-select name="Project Phase Issues Originated"><option option="Test Plan Documentation"/></property-multi-select><property-select name="Project Success Criteria"><option option="Mostly Met"/></property-select><property-url name="Prototype Demo Recording">https://novalabs.screenpro.com/share/5wyUY</property-url><property-text name="Prototype mobile app lacked intuitive UX for end users without significant training. Increased user testing is needed to identify pain points earlier in our design process.">Our 3 week beta trial showed the final build of our app had persistent crashing issues, especially when trying to access certain features. More reliability testing should have been prioritized leading up to the trial.</property-text><property-checkbox name="Requires Follow-Up" checked="true"/><property-number name="Total Project Hours" number="876"></property-number></page></insert-inside>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-23T09:35:38.886-07:00","current-person-id":"1","current-person-name":"Takeshi Tanaka"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Bright Sparks\' Hub for Educators</property-title><text id="2">At Bright Sparks Learning, we know that our programs are only as strong as the teachers who lead them. The Educator Hub is your resource for news, events, best practices, and collaboration opportunities within our community of educators. Connect with fellow teachers, get inspired, share ideas, and discover new ways to engage your students. Together, let\'s make learning fun, impactful, and transformational.</text><child-database id="3" database-id="4"><property-title name="Title">Instructor Program Proposals</property-title><schema-property-title name="Program Title"/><schema-property-multi-select name="Instructional Methods"><schema-option option="Demonstration"/><schema-option option="Hands-on Project"/><schema-option option="Group Discussion"/><schema-option option="Lecture"/><schema-option option="Field Trip"/></schema-property-multi-select><schema-property-checkbox name="New Program"/><schema-property-url name="Online Resource Links"/><schema-property-person name="Program Approver"/><schema-property-email name="Program Approver Email"/><schema-property-person name="Program Coordinator"/><schema-property-phone-number name="Program Coordinator Contact Number"/><schema-property-multi-select name="Program Focus"><schema-option option="Creative Writing"/><schema-option option="Robotics"/><schema-option option="Arts and Crafts"/></schema-property-multi-select><schema-property-status name="Program Proposal Status"><schema-option-category category="To-do"><schema-option option="Proposal Draft"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Feedback Addressed"/><schema-option option="Revisions Pending"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Approved"/><schema-option option="Launch Ready"/></schema-option-category></schema-property-status><schema-property-text name="Rationale and Key Objectives"/><schema-property-select name="Subject Areas"><schema-option option="English"/><schema-option option="Math"/><schema-option option="Science"/></schema-property-select><schema-property-number name="Suggested Grade Levels" format="number"/></child-database><child-database id="5" database-id="6"><property-title name="Title">Extracurricular Activity Tracker</property-title><schema-property-title name="Activity Name"/><schema-property-status name="Activity Status"><schema-option-category category="To-do"><schema-option option="Gathering Interest"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Scheduling"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Ongoing"/><schema-option option="Registration Closed"/></schema-option-category></schema-property-status><schema-property-select name="Activity Type"><schema-option option="Yoga"/><schema-option option="Soccer"/><schema-option option="Book Club"/><schema-option option="Volunteering"/><schema-option option="Coding"/></schema-property-select><schema-property-person name="Club Leader"/><schema-property-email name="Club Leader Email"/><schema-property-text name="Description"/><schema-property-checkbox name="Free to Public"/><schema-property-text name="Location"/><schema-property-number name="Maximum Capacity" format="danish_krone"/><schema-property-multi-select name="Meeting Frequency"><schema-option option="Weekly"/><schema-option option="Monthly"/><schema-option option="Quarterly"/><schema-option option="Biweekly"/></schema-property-multi-select><schema-property-checkbox name="Permission Slip Required"/><schema-property-url name="Sign-up Link"/><schema-property-phone-number name="Teacher Contact Number"/><schema-property-number name="Total Attendance" format="number"/></child-database></page>',id:2},{id:3,type:"human",value:"<chat><text>add a new activity for Chinese club. status is gathering interest and Iâ€™m the club leader</text></chat>"},{type:"assistant",id:4,value:'<think>The user would like me to create a new entry in the Extracurricular Activity Tracker database for Chinese club with a status of \'Gathering Interest\' and themselves listed as the Club Leader.</think><insert-inside id="6"><page><property-title name="Activity Name">Chinese Club</property-title><property-status name="Activity Status"><option option="Gathering Interest"/></property-status><property-person name="Club Leader"><mention-person person-id="1"/></property-person></page></insert-inside>'}]],Ze=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"instructions-page-id":"0","current-datetime":"2023-05-23T13:13:45.773-07:00","current-person-id":"1","current-person-name":"Jamie Myers"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<instructions-page id="0"><property-title name="Name">Tasks database</property-title><text id="2">Use this database of tasks:</text><child-database id="3" database-id="4"><property-title name="Title">Tasks</property-title><schema-property-title name="Name"/><schema-property-person name="Assignee"/><schema-property-select name="Priority"><schema-option option="Low"/><schema-option option="Medium"/><schema-option option="High"/></schema-property-select><schema-property-status name="Status"><schema-option-category category="To-do"><schema-option option="Not started"/></schema-option-category><schema-option-category category="In progress"><schema-option option="In progress"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Archived"/><schema-option option="Done"/></schema-option-category></schema-property-status><schema-property-multi-select name="Tags"><schema-option option="Mobile"/><schema-option option="Website"/><schema-option option="Bug"/><schema-option option="Improvement"/><schema-option option="Triage"/></schema-property-multi-select></child-database><text id="5">When someone posts about a task, bug, or issue:<text id="6">First, search the database to see if there are any existing duplicate tasks.<text id="7">If there is an existing duplicate task:</text><text id="8">Read all the relevant page contents to make sure that they are in fact duplicates.</text><text id="9">Respond with an explanation of the duplicate. Make sure to link to any pages you reference in your response.</text><text id="10">Insert a quote block with the exact original message to the most relevant page.</text></text><text id="11">If there is not an existing duplicate task:<text id="12">Create a new page for the task.</text><text id="13">Give the page a compact (but specific) name, and use a quote block to add an exact quote of the original message to the page.</text><text id="14">Fill out appropriate values for the task properties, only when there is a high-confidence value for that property.</text><text id="15">Respond via chat to tell the user you have created a new page.</text></text></text><text id="16">When someone asks a question about a task:<text id="17">Query the database to try to find relevant tasks.</text><text id="18">Read all the relevant pages.</text><text id="19">Use the results to try to answer the question. Make sure to link to any pages you reference in your answer.</text></text></instructions-page>',id:2},{id:3,type:"human",value:"<chat><text>the support portal is really slow for me right now. itâ€™s taking over 30s to load</text></chat>"},{type:"assistant",id:5,value:'<think>The user reported an issue with the support portal being very slow to load. I should search for any duplicate tasks before creating a new one.</think><query-database id="4"><search question="Are there any existing tasks related to the support portal loading slowly?" keywords="support portal load slow issue"/></query-database>\n'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="6" total-results="6"><child-page id="26" page-id="27"><property-title name="Name">Improve page load times for support portal</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Jamie Myers"/></property-person><property-select name="Priority"><option option="Medium"/></property-select><property-status name="Status"><option option="Not started"/></property-status><property-multi-select name="Tags"><option option="Website"/><option option="Improvement"/></property-multi-select></child-page><child-page id="24" page-id="25"><property-title name="Name">Outdated User Documentation</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Jamie Myers"/></property-person><property-select name="Priority"><option option="Medium"/></property-select><property-status name="Status"><option option="In progress"/></property-status><property-multi-select name="Tags"/></child-page><child-page id="20" page-id="21"><property-title name="Name">Address security vulnerabilities</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Jamie Myers"/></property-person><property-select name="Priority"><option option="High"/></property-select><property-status name="Status"><option option="Not started"/></property-status><property-multi-select name="Tags"><option option="Bug"/></property-multi-select></child-page><child-page id="22" page-id="23"><property-title name="Name">Consolidate Knowledge Base</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Jamie Myers"/></property-person><property-select name="Priority"><option option="Low"/></property-select><property-status name="Status"><option option="Not started"/></property-status><property-multi-select name="Tags"><option option="Improvement"/></property-multi-select></child-page><child-page id="30" page-id="31"><property-title name="Name">Fix API integration issues</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Jamie Myers"/></property-person><property-select name="Priority"><option option="High"/></property-select><property-status name="Status"><option option="In progress"/></property-status><property-multi-select name="Tags"><option option="Mobile"/><option option="Website"/><option option="Bug"/></property-multi-select></child-page><child-page id="28" page-id="29"><property-title name="Name">Revise Triage Process</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Jamie Myers"/></property-person><property-select name="Priority"><option option="Low"/></property-select><property-status name="Status"><option option="Not started"/></property-status><property-multi-select name="Tags"><option option="Triage"/></property-multi-select></child-page></query-database-results>',id:17},{type:"assistant",id:45,value:'<think>This seems to be a duplicate of the existing task to Improve page load times for support portal. I should read it to make sure.</think><load-page id="27"/>'},{type:"observation",observationType:"page",pageId:"27",value:'<page id="27"><property-title name="Name">Improve page load times for support portal</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Anonymous"/></property-person><property-select name="Priority"><option option="Medium"/></property-select><property-status name="Status"><option option="Not started"/></property-status><property-multi-select name="Tags"><option option="Website"/><option option="Improvement"/></property-multi-select><text id="103">Users have reported the support portal pages can take up to 10-15 seconds to load completely. Looks into potential caching and image optimizations to improve performance.</text></page>',id:76},{type:"assistant",id:78,value:'<think>This task seems very similar. I should respond with details explaining the duplicate and insert a quote with the new report into this page.</think><chat><text>This seems to be a duplicate of an existing task to <a href="27">Improve page load times for support portal</a> citing reports of up to 15-second page load times.</text></chat><insert-inside id="27"><quote>the support portal is really slow for me right now. itâ€™s taking over 30s to load</quote></insert-inside>'},{type:"observation",observationType:"page",pageId:"27",value:'<page id="27"><property-title name="Name">Improve page load times for support portal</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Anonymous"/></property-person><property-select name="Priority"><option option="Medium"/></property-select><property-status name="Status"><option option="Not started"/></property-status><property-multi-select name="Tags"><option option="Website"/><option option="Improvement"/></property-multi-select><text id="103">Users have reported the support portal pages can take up to 10-15 seconds to load completely. Looks into potential caching and image optimizations to improve performance.</text><quote id="116">the support portal is really slow for me right now. itâ€™s taking over 30s to load</quote></page>',id:84},{id:85,type:"human",value:"<chat><text>Whatâ€™s the priority of that task?</text></chat>"},{type:"assistant",id:87,value:'<think>The user asked about the priority of the task I recently updated. I should link to the task in my response.</think><chat><text>The priority of the task to <a href="27">Improve page load times for support portal</a> is Medium.</text></chat>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"instructions-page-id":"0","current-datetime":"2023-05-23T13:17:13.416-07:00","current-person-id":"1","current-person-name":"Xi Zhao"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<instructions-page id="0"><property-title name="Name">Tasks database</property-title><text id="2">Use this database of tasks:</text><child-database id="3" database-id="4"><property-title name="Title">Tasks</property-title><schema-property-title name="Name"/><schema-property-person name="Assignee"/><schema-property-select name="Priority"><schema-option option="Low"/><schema-option option="Medium"/><schema-option option="High"/></schema-property-select><schema-property-status name="Status"><schema-option-category category="To-do"><schema-option option="Not started"/></schema-option-category><schema-option-category category="In progress"><schema-option option="In progress"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Archived"/><schema-option option="Done"/></schema-option-category></schema-property-status><schema-property-multi-select name="Tags"><schema-option option="Mobile"/><schema-option option="Website"/><schema-option option="Bug"/><schema-option option="Improvement"/><schema-option option="Triage"/></schema-property-multi-select></child-database><text id="5">When someone posts about a task, bug, or issue:<text id="6">First, search the database to see if there are any existing duplicate tasks.<text id="7">If there is an existing duplicate task:</text><text id="8">Read all the relevant page contents to make sure that they are in fact duplicates.</text><text id="9">Respond with an explanation of the duplicate. Make sure to link to any pages you reference in your response.</text><text id="10">Insert a quote block with the exact original message to the most relevant page.</text></text><text id="11">If there is not an existing duplicate task:<text id="12">Create a new page for the task.</text><text id="13">Give the page a compact (but specific) name, and use a quote block to add an exact quote of the original message to the page.</text><text id="14">Fill out appropriate values for the task properties, only when there is a high-confidence value for that property.</text><text id="15">Respond via chat to tell the user you have created a new page.</text></text></text><text id="16">When someone asks a question about a task:<text id="17">Query the database to try to find relevant tasks.</text><text id="18">Read all the relevant pages.</text><text id="19">Use the results to try to answer the question. Make sure to link to any pages you reference in your answer.</text></text></instructions-page>',id:2},{id:3,type:"human",value:"<chat><text>Bug report: login is broken on Android</text></chat>"},{type:"assistant",id:5,value:'<think>This appears to be reporting a new bug or task. I should first search for any duplicates.</think><query-database id="4"><search question="Are there any existing tasks related to issues with logging in on Android?" keywords="android login broken"/></query-database>\n'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="6" total-results="6"><child-page id="20" page-id="21"><property-title name="Name">Address security vulnerabilities</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Xi Zhao"/></property-person><property-select name="Priority"><option option="High"/></property-select><property-status name="Status"><option option="Not started"/></property-status><property-multi-select name="Tags"><option option="Bug"/></property-multi-select></child-page><child-page id="24" page-id="25"><property-title name="Name">Outdated User Documentation</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Xi Zhao"/></property-person><property-select name="Priority"><option option="Medium"/></property-select><property-status name="Status"><option option="In progress"/></property-status><property-multi-select name="Tags"/></child-page><child-page id="30" page-id="31"><property-title name="Name">Fix API integration issues</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Xi Zhao"/></property-person><property-select name="Priority"><option option="High"/></property-select><property-status name="Status"><option option="In progress"/></property-status><property-multi-select name="Tags"><option option="Mobile"/><option option="Website"/><option option="Bug"/></property-multi-select></child-page><child-page id="22" page-id="23"><property-title name="Name">Consolidate Knowledge Base</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Xi Zhao"/></property-person><property-select name="Priority"><option option="Low"/></property-select><property-status name="Status"><option option="Not started"/></property-status><property-multi-select name="Tags"><option option="Improvement"/></property-multi-select></child-page><child-page id="26" page-id="27"><property-title name="Name">Improve page load times for support portal</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Xi Zhao"/></property-person><property-select name="Priority"><option option="Medium"/></property-select><property-status name="Status"><option option="Not started"/></property-status><property-multi-select name="Tags"><option option="Website"/><option option="Improvement"/></property-multi-select></child-page><child-page id="28" page-id="29"><property-title name="Name">Revise Triage Process</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Xi Zhao"/></property-person><property-select name="Priority"><option option="Low"/></property-select><property-status name="Status"><option option="Not started"/></property-status><property-multi-select name="Tags"><option option="Triage"/></property-multi-select></child-page></query-database-results>',id:16},{type:"assistant",id:17,value:'<think>There are no existing duplicate tasks related to issues logging in on Android. I should create a new page for this report.</think><insert-inside id="4"><page><property-title name="Name">Login is broken on Android</property-title><quote>Bug report: login is broken on Android</quote></page></insert-inside><chat><text>I have created a new page for the report of issues logging in on Android.</text></chat>'},{type:"observation",observationType:"page",pageId:"52",value:'<page id="52"><property-title name="Name">Login is broken on Android</property-title><property-person name="Assignee"/><property-select name="Priority"/><property-status name="Status"><option option="Not started"/></property-status><property-multi-select name="Tags"/><quote id="53">Bug report: login is broken on Android</quote></page>',id:25},{id:26,type:"human",value:"<chat><text>mark it as high priority with tag mobile</text></chat>"},{type:"assistant",id:41,value:'<think>The person requested to update the priority of the new page to High and add the Mobile tag.</think><set-property id="52"><property-select name="Priority"><option option="High"/></property-select></set-property><set-property id="52"><property-multi-select name="Tags"><option option="Mobile"/></property-multi-select></set-property>'},{type:"observation",observationType:"page",pageId:"52",value:'<page id="52"><property-title name="Name">Login is broken on Android</property-title><property-person name="Assignee"/><property-select name="Priority"><option option="High"/></property-select><property-status name="Status"><option option="Not started"/></property-status><property-multi-select name="Tags"><option option="Mobile"/></property-multi-select><quote id="53">Bug report: login is broken on Android</quote></page>',id:54}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"instructions-page-id":"0","current-datetime":"2023-05-23T13:39:24.560-07:00","current-person-id":"1","current-person-name":"Marco Juarez"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<instructions-page id="0"><property-title name="Name">Tasks database</property-title><text id="2">Use this database of tasks:</text><child-database id="3" database-id="4"><property-title name="Title">Tasks</property-title><schema-property-title name="Name"/><schema-property-person name="Assignee"/><schema-property-select name="Priority"><schema-option option="Low"/><schema-option option="Medium"/><schema-option option="High"/></schema-property-select><schema-property-status name="Status"><schema-option-category category="To-do"><schema-option option="Not started"/></schema-option-category><schema-option-category category="In progress"><schema-option option="In progress"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Archived"/><schema-option option="Done"/></schema-option-category></schema-property-status><schema-property-multi-select name="Tags"><schema-option option="Mobile"/><schema-option option="Website"/><schema-option option="Bug"/><schema-option option="Improvement"/><schema-option option="Triage"/></schema-property-multi-select></child-database><text id="5">When someone posts about a task, bug, or issue:<text id="6">First, search the database to see if there are any existing duplicate tasks.<text id="7">If there is an existing duplicate task:</text><text id="8">Read all the relevant page contents to make sure that they are in fact duplicates.</text><text id="9">Respond with an explanation of the duplicate. Make sure to link to any pages you reference in your response.</text><text id="10">Insert a quote block with the exact original message to the most relevant page.</text></text><text id="11">If there is not an existing duplicate task:<text id="12">Create a new page for the task.</text><text id="13">Give the page a compact (but specific) name, and use a quote block to add an exact quote of the original message to the page.</text><text id="14">Fill out appropriate values for the task properties, only when there is a high-confidence value for that property.</text><text id="15">Respond via chat to tell the user you have created a new page.</text></text></text><text id="16">When someone asks a question about a task:<text id="17">Query the database to try to find relevant tasks.</text><text id="18">Read all the relevant pages.</text><text id="19">Use the results to try to answer the question. Make sure to link to any pages you reference in your answer.</text></text></instructions-page>',id:2},{id:3,type:"human",value:"<chat><text>are we working on fixing our api right now?</text></chat>"},{type:"assistant",id:5,value:'<think>The user is asking if there are any ongoing tasks related to fixing the API. I will search the Tasks database for relevant entries that are in progress.</think><query-database id="4"><search question="Are there any ongoing tasks related to fixing the API?" keywords="api"/><filter-property-status name="Status" condition="is"><option-category category="In progress"/></filter-property-status></query-database>\n'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="3" total-results="3"><child-page id="32" page-id="33"><property-title name="Name">Fix API integration issues</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Marco Juarez"/></property-person><property-select name="Priority"><option option="High"/></property-select><property-status name="Status"><option option="In progress"/></property-status><property-multi-select name="Tags"><option option="Mobile"/><option option="Website"/><option option="Bug"/></property-multi-select></child-page><child-page id="22" page-id="23"><property-title name="Name">Address security vulnerabilities</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Marco Juarez"/></property-person><property-select name="Priority"><option option="High"/></property-select><property-status name="Status"><option option="In progress"/></property-status><property-multi-select name="Tags"><option option="Bug"/></property-multi-select></child-page><child-page id="26" page-id="27"><property-title name="Name">Outdated User Documentation</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Marco Juarez"/></property-person><property-select name="Priority"><option option="Medium"/></property-select><property-status name="Status"><option option="In progress"/></property-status><property-multi-select name="Tags"/></child-page></query-database-results>',id:19},{type:"assistant",id:20,value:'<think>According to the database query results, there is one ongoing task related to fixing the API. I should read it to get more details.</think><load-page id="33"/>'},{type:"observation",observationType:"page",pageId:"33",value:'<page id="33"><property-title name="Name">Fix API integration issues</property-title><property-person name="Assignee"><mention-person person-id="1" person-name="Anonymous"/></property-person><property-select name="Priority"><option option="High"/></property-select><property-status name="Status"><option option="In progress"/></property-status><property-multi-select name="Tags"><option option="Mobile"/><option option="Website"/><option option="Bug"/></property-multi-select><text id="90">The API is failing intermittently when the mobile apps make requests. Debugging needed to resolve connectivity problems.</text></page>',id:27},{type:"assistant",id:29,value:'<think>According to the task page, debugging of connectivity problems with the API is in progress to resolve intermittent failures when the mobile apps make requests.</think><chat><text>Yes, we have work in progress to fix API integration issues affecting the mobile apps, as noted <a href="33">in this task</a>.</text></chat>'}]],Ve=[[{id:0,type:"context",context:{mode:"shared","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"instructions-page-id":"0","current-page-id":"1","current-channel":"#all-water-cooler","current-datetime":"2023-06-29T18:03:24.652-04:00","current-thread-id":"2"}},{id:1,type:"assistant",value:'<load-page id="0"/><load-page id="1"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<instructions-page id="0"><property-title name="Title"/><text id="4">If the userâ€™s message includes imperial units, convert them to metric;<text id="5">Respond with the original message but with units converted inline.</text></text><text id="6">Otherwise, do nothing.</text></instructions-page>',id:2},{type:"observation",observationType:"page",pageId:"1",value:'<page id="1"><property-title name="Title">Imperial unit converter assistant</property-title><text id="3"/></page>',id:3},{id:4,type:"human",value:'<chat person-id="7" person-name="Jane Doe" datetime="2023-06-29T18:03:24.656-04:00" message-id="8"><text>hey team, howâ€™s it going?</text></chat>'},{type:"assistant",id:27,value:"<think>The user messaged a greeting in the current thread. According to the instructions, I should do nothing.</think>"}],[{id:0,type:"context",context:{mode:"shared","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"instructions-page-id":"0","current-page-id":"1","current-channel":"#sales","current-datetime":"2023-06-29T18:15:04.911-04:00","current-thread-id":"2"}},{id:1,type:"assistant",value:'<load-page id="0"/><load-page id="1"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<instructions-page id="0"><property-title name="Title"/><text id="4">If the userâ€™s message includes imperial units, convert them to metric;<text id="5">Respond with the original message but with units converted inline.</text></text><text id="6">Otherwise, do nothing.</text></instructions-page>',id:2},{type:"observation",observationType:"page",pageId:"1",value:'<page id="1"><property-title name="Title">Imperial unit converter assistant</property-title><text id="3"/></page>',id:3},{id:4,type:"human",value:'<chat person-id="7" person-name="John Smith" datetime="2023-06-29T18:15:04.924-04:00" message-id="8"><text>our biggest customer just ordered 30 pounds of our product!</text></chat>'},{type:"assistant",id:6,value:"<think>The message mentions imperial units (pounds). According to the instructions, I should convert this to metric and respond with the converted units inline.</think><chat><text>our biggest customer just ordered 14 kilograms of our product!</text></chat>"}],[{id:0,type:"context",context:{mode:"shared","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"instructions-page-id":"0","current-page-id":"1","current-channel":"#sales","current-datetime":"2023-06-29T18:18:36.141-04:00","current-thread-id":"2"}},{id:1,type:"assistant",value:'<load-page id="0"/><load-page id="1"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<instructions-page id="0"><property-title name="Title"/><text id="4">If the userâ€™s message includes imperial units, convert them to metric;<text id="5">Respond with the original message but with units converted inline.</text></text><text id="6">Otherwise, do nothing.</text><text id="7">Note that if the message is a conversation between two people, you should not respond regardless, even if the message contains imperial units.</text></instructions-page>',id:2},{type:"observation",observationType:"page",pageId:"1",value:'<page id="1"><property-title name="Title">Imperial unit converter assistant</property-title><text id="3"/></page>',id:3},{id:4,type:"human",value:'<chat person-id="8" person-name="Jane Doe" datetime="2023-06-29T18:18:36.151-04:00" message-id="9"><text>our biggest customer just ordered 30 pounds of our product!</text></chat>'},{type:"assistant",id:5,value:"<think>The user's message contains an imperial unit 'pounds'. According to the instructions, I should convert it to metric and respond with the updated message. </think><chat><text>our biggest customer just ordered 13.6 kilograms of our product!</text></chat>"},{id:11,type:"human",value:'<chat person-id="12" person-name="Ellen Kim" datetime="2023-06-29T18:19:10.002-04:00" message-id="13"><text>nice! how many pounds do we have in total?</text></chat>'},{type:"assistant",id:13,value:"<think>The message is a conversation between two people. According to the instructions, I should not respond.</think>"},{id:14,type:"human",value:'<chat person-id="8" person-name="Jane Doe" datetime="2023-06-29T18:19:47.631-04:00" message-id="15"><text>654 since this month - hooray!</text></chat>'},{type:"assistant",id:19,value:"<think>The message contains an imperial unit of 'pounds' but is part of a conversation between two people. According to the instructions, I should not respond.</think>"}]],qe=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-06-05T06:38:44.228-07:00","current-person-id":"1","current-person-name":"Marco Juarez"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Hello world</property-title><text id="2"><child-database id="3" database-id="4"><property-title name="Title">Hello</property-title><schema-property-title name="Name"/><schema-property-multi-select name="Tags"><schema-option option="COMPLETE"/><schema-option option="TESTING"/><schema-option option="SAFE"/></schema-property-multi-select></child-database><text id="5"/></text></page>',id:2},{id:3,type:"human",value:"<chat><text>For all rows with the tag â€œTESTINGâ€ set the tag to â€œCOMPLETEâ€</text></chat>"},{type:"assistant",id:5,value:'<think>The user is requesting to update all pages in the \'Hello\' database tagged \'TESTING\' to instead have the tag \'COMPLETE\'.</think><query-database id="4"><filter-property-multi-select name="Tags" condition="contains"><option option="TESTING"/></filter-property-multi-select></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="1" total-results="1"><child-page id="6" page-id="7"><property-title name="Name">TEst2 </property-title><property-multi-select name="Tags"><option option="TESTING"/></property-multi-select></child-page></query-database-results>',id:17},{type:"assistant",value:'<think>The query returned 1 page with the TESTING tag. I will remove TESTING and add COMPLETE.</think><set-property id="6"><property-multi-select name="Tags"><option option="COMPLETE"/></property-multi-select></set-property>',id:18}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-06-05T09:09:02.491-07:00","current-person-id":"1","current-person-name":"Marco Juarez"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Hello world</property-title><text id="2"><child-database id="3" database-id="4"><property-title name="Title">Hello</property-title><schema-property-title name="Name"/><schema-property-multi-select name="Tags"><schema-option option="COMPLETE"/><schema-option option="TESTING"/><schema-option option="SAFE"/></schema-property-multi-select></child-database><text id="5"/></text></page>',id:2},{id:3,type:"human",value:"<chat><text>For all rows with name â€œTEstâ€ set the name to â€œHello worldâ€</text></chat>"},{type:"assistant",id:4,value:'<think>The user is requesting to update all rows with name \'TEst\' to have name \'Hello world\' in the Hello database. I should query it to find the relevant rows.</think><query-database id="4"><filter-property-title name="Name" condition="contains">TEst</filter-property-title></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="2" total-results="2"><child-page id="6" page-id="7"><property-title name="Name">TEst2 </property-title><property-multi-select name="Tags"><option option="COMPLETE"/></property-multi-select></child-page><child-page id="8" page-id="9"><property-title name="Name">TEst</property-title><property-multi-select name="Tags"><option option="TESTING"/></property-multi-select></child-page></query-database-results>',id:16},{type:"assistant",id:17,value:"<think>There is 1 row where Name is 'TEst'. I should update it to be 'Hello world' instead.</think><set-property id=\"6\"><property-title name=\"Name\">Hello world</property-title></set-property>"}]],ze=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"instructions-page-id":"0","current-datetime":"2023-05-09T11:11:50.293-04:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<instructions-page id="0"><property-title name="Name">Feedback database</property-title><text id="1">Use this database of feedback:</text><child-database id="2" database-id="3"><property-title name="Title">Feedback</property-title><schema-property-title name="Title"></schema-property-title></child-database><text id="4">When someone posts new feedback:<text id="5">First, search the database to see if there is any existing similar feedback.<text id="6">If there is existing similar feedback:</text><text id="7">Read all the pages with similar feedback</text><text id="8">Respond with an explanation of the previous feedback. Make sure to link to any pages you reference in your response.</text><text id="9">Insert a quote block with the new feedback into the most relevant page.</text></text><text id="10">If there is not existing similar feedback:<text id="11">Create a new page with the feedback.</text><text id="12">Give the page a compact (but specific) title, and use a quote block to add an exact quote of the feedback to the page.</text><text id="13">Respond via chat to tell the user you have created a new page.</text></text></text><text id="91">When someone asks a question about feedback:<text id="92">Search the database to see if there is any relevant feedback.</text><text id="93">Read all the pages with relevant feedback.</text><text id="94">Use the results to try to answer the question. Make sure to link to any pages you reference in your answer.</text></text></instructions-page>',id:2},{id:3,type:"human",value:"<chat><text>When a page crashes for the user (In this scenario the page has properties in an format that is not expected), we seem to only have refresh as an option. However, when the problem is not intermittent, refresh does not really help and if a user has chosen Last visited page as their preference for Open on start. This page keeps opening and there is no way for the user to navigate to another page unless they clear their browser storage or click on bookmarked notion page they might have. Can we probably add another button that takes the user to Top page in sidebar apart from just refresh when there is a page crash?</text></chat>"},{type:"assistant",id:5,value:'<think>There is new feedback submitted. I should search the database for any similar existing feedback.</think><query-database id="3"><search question="What existing feedback relates to adding another option to get out of a broken page, other than just a refresh?" keywords="page crash broken refresh button navigation"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="4" total-results="4"><child-page id="19" page-id="20"><property-title name="Title">Reported bug: Deleting page and selecting new page reloads random page instead</property-title></child-page><child-page id="17" page-id="18"><property-title name="Title">Request: Admins see which members have enabled MFA</property-title></child-page><child-page id="21" page-id="22"><property-title name="Title">Request: code-formatted text remembers your last color</property-title></child-page><child-page id="15" page-id="16"><property-title name="Title">Suggestion: Add an "inbox" to subscribe to regular team updates in Notion to aggregate from Slack</property-title></child-page></query-database-results>',id:14},{type:"assistant",id:15,value:'<think>There is not existing similar feedback related to adding a backup navigation option when Notion pages crash, beyond just refreshing. According to the instructions, I should create a new page with the feedback and respond to the user.</think><insert-inside id="3"><page><property-title name="Title">Request: Add option to navigate to another page when current page crashes, apart from just refresh</property-title><quote>When a page crashes for the user (In this scenario the page has properties in an format that is not expected), we seem to only have refresh as an option. However, when the problem is not intermittent, refresh does not really help and if a user has chosen Last visited page as their preference for Open on start. This page keeps opening and there is no way for the user to navigate to another page unless they clear their browser storage or click on bookmarked notion page they might have. Can we probably add another button that takes the user to Top page in sidebar apart from just refresh when there is a page crash?\n</quote></page></insert-inside><chat><text>I have created a new page with feedback requesting an additional in-app navigation button when Notion pages crash, to get away from the continually reloading broken page.</text></chat>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"instructions-page-id":"0","current-datetime":"2023-05-09T11:27:14.985-04:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<instructions-page id="0"><property-title name="Name">Feedback database</property-title><text id="1">Use this database of feedback:</text><child-database id="2" database-id="3"><property-title name="Title">Feedback</property-title><schema-property-title name="Title"></schema-property-title></child-database><text id="4">When someone posts new feedback:<text id="5">First, search the database to see if there is any existing similar feedback.<text id="6">If there is existing similar feedback:</text><text id="7">Read all the pages with similar feedback</text><text id="8">Respond with an explanation of the previous feedback. Make sure to link to any pages you reference in your response.</text><text id="9">Insert a quote block with the new feedback into the most relevant page.</text></text><text id="10">If there is not existing similar feedback:<text id="11">Create a new page with the feedback.</text><text id="12">Give the page a compact (but specific) title, and use a quote block to add an exact quote of the feedback to the page.</text><text id="13">Respond via chat to tell the user you have created a new page.</text></text></text><text id="91">When someone asks a question about feedback:<text id="92">Search the database to see if there is any relevant feedback.</text><text id="93">Read all the pages with relevant feedback.</text><text id="94">Use the results to try to answer the question. Make sure to link to any pages you reference in your answer.</text></text></instructions-page>',id:2},{id:3,type:"human",value:"<chat><text>I got some feedback from a customer that they wish they could find out who enabled mfa vs not</text></chat>"},{type:"assistant",id:4,value:'<think>New feedback was submitted. I need to first search for any similar existing feedback.</think><query-database id="3"><search question="Is there any feedback related to seeing which users have enabled multi-factor authentication?" keywords="mfa enabled user find see"/></query-database>\n'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="4" total-results="4"><child-page id="17" page-id="18"><property-title name="Title">Request: Admins see which members have enabled MFA</property-title></child-page><child-page id="15" page-id="16"><property-title name="Title">Request: Add option to navigate to another page when current page crashes, apart from just refresh</property-title></child-page><child-page id="19" page-id="20"><property-title name="Title">Reported bug: Deleting page and selecting new page reloads random page instead</property-title></child-page><child-page id="21" page-id="22"><property-title name="Title">Request: code-formatted text remembers your last color</property-title></child-page></query-database-results>',id:13},{type:"assistant",id:15,value:'<think>There is existing feedback related to viewing MFA status. I should read page 18.</think><load-page id="18"/>'},{type:"observation",observationType:"page",pageId:"18",value:'<page id="18"><property-title name="Title">Request: Admins see which members have enabled MFA</property-title><quote id="24">Hi, team. Customers like our recent MFA enhance security. I got a feedback that it would be great if admin can have visibility which member enabled MFA or not in member setting. It might be good feature only for business or enterprise plan admins. This has been added as an expansion of the request for enterprise/business admins to see member MFA status.</quote></page>',id:22},{type:"assistant",id:24,value:'<think>The page is now loaded. I should respond with details about the previous request while linking to it, and insert a quote with the new feedback into the page.</think><chat><text>Similar feedback has already been submitted as a request for <a href="18">enterprise/business admins to see member MFA status</a>. The customer noted that customers appreciate the recent MFA security enhancements, but admins would benefit from visibility into which members have enabled MFA.</text></chat><insert-inside id="18"><quote>I got some feedback from a customer that they wish they could find out who enabled mfa vs not</quote></insert-inside>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"instructions-page-id":"0","current-datetime":"2023-05-09T11:39:47.976-04:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<instructions-page id="0"><property-title name="Name">Feedback database</property-title><text id="1">Use this database of feedback:</text><child-database id="2" database-id="3"><property-title name="Title">Feedback</property-title><schema-property-title name="Title"></schema-property-title></child-database><text id="4">When someone posts new feedback:<text id="5">First, search the database to see if there is any existing similar feedback.<text id="6">If there is existing similar feedback:</text><text id="7">Read all the pages with similar feedback</text><text id="8">Respond with an explanation of the previous feedback. Make sure to link to any pages you reference in your response.</text><text id="9">Insert a quote block with the new feedback into the most relevant page.</text></text><text id="10">If there is not existing similar feedback:<text id="11">Create a new page with the feedback.</text><text id="12">Give the page a compact (but specific) title, and use a quote block to add an exact quote of the feedback to the page.</text><text id="13">Respond via chat to tell the user you have created a new page.</text></text></text><text id="91">When someone asks a question about feedback:<text id="92">Search the database to see if there is any relevant feedback.</text><text id="93">Read all the pages with relevant feedback.</text><text id="94">Use the results to try to answer the question. Make sure to link to any pages you reference in your answer.</text></text></instructions-page>',id:2},{id:3,type:"human",value:"<chat><text>do we have any feedback about page reload issues?</text></chat>"},{type:"assistant",id:7,value:'<think>The user asked a question about feedback related to page reload issues. I should search the database to find any relevant pages, and respond with details about them.</think><query-database id="3"><search question="What feedback mentions page reload problems?" keywords="page reload issue problem"/></query-database>\n'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="4" total-results="4"><child-page id="19" page-id="20"><property-title name="Title">Reported bug: Deleting page and selecting new page reloads random page instead</property-title></child-page><child-page id="15" page-id="16"><property-title name="Title">Request: Add option to navigate to another page when current page crashes, apart from just refresh</property-title></child-page><child-page id="17" page-id="18"><property-title name="Title">Request: Admins see which members have enabled MFA</property-title></child-page><child-page id="21" page-id="22"><property-title name="Title">Request: code-formatted text remembers your last color</property-title></child-page></query-database-results>',id:12},{type:"assistant",id:13,value:'<chat><text>There are a couple pieces of feedback related to page reloads. One <a href="20">reported bug</a> mentions deleting a page and selecting a new page reloads a random page instead. Another <a href="16">request</a> asks for an option to navigate away from crashed pages besides just refreshing, which can cause continual reload loops.</text></chat>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"instructions-page-id":"0","current-datetime":"2023-05-09T11:42:08.288-04:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<instructions-page id="0"><property-title name="Name">Feedback database</property-title><text id="1">Use this database of feedback:</text><child-database id="2" database-id="3"><property-title name="Title">Feedback</property-title><schema-property-title name="Title"></schema-property-title></child-database><text id="4">When someone posts new feedback:<text id="5">First, search the database to see if there is any existing similar feedback.<text id="6">If there is existing similar feedback:</text><text id="7">Read all the pages with similar feedback</text><text id="8">Respond with an explanation of the previous feedback. Make sure to link to any pages you reference in your response.</text><text id="9">Insert a quote block with the new feedback into the most relevant page.</text></text><text id="10">If there is not existing similar feedback:<text id="11">Create a new page with the feedback.</text><text id="12">Give the page a compact (but specific) title, and use a quote block to add an exact quote of the feedback to the page.</text><text id="13">Respond via chat to tell the user you have created a new page.</text></text></text><text id="91">When someone asks a question about feedback:<text id="92">Search the database to see if there is any relevant feedback.</text><text id="93">Read all the pages with relevant feedback.</text><text id="94">Use the results to try to answer the question. Make sure to link to any pages you reference in your answer.</text></text></instructions-page>',id:2},{id:3,type:"human",value:"<chat><text>are there any reports of bugs with logout?</text></chat>"},{type:"assistant",id:12,value:'<think>The user asked about feedback related to logout bugs. I should search for relevant pages and link them in my response.</think><query-database id="3"><search question="What bugs have been reported related to logging out?" keywords="logout bug report"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="4" total-results="4"><child-page id="19" page-id="20"><property-title name="Title">Reported bug: Deleting page and selecting new page reloads random page instead</property-title></child-page><child-page id="15" page-id="16"><property-title name="Title">Request: Add option to navigate to another page when current page crashes, apart from just refresh</property-title></child-page><child-page id="17" page-id="18"><property-title name="Title">Request: Admins see which members have enabled MFA</property-title></child-page><child-page id="21" page-id="22"><property-title name="Title">Request: code-formatted text remembers your last color</property-title></child-page></query-database-results>',id:17},{type:"assistant",id:21,value:'<chat><text>There are currently no reported <a href="3">bugs</a> related specifically to logging out.</text></chat>'}]],We=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"instructions-page-id":"0","current-datetime":"2023-05-09T14:41:44.601-04:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<instructions-page id="0"><property-title name="Name">Q&A database</property-title><text id="1">Use this database of questions and answers:</text><child-database id="2" database-id="3"><property-title name="Title">Q&A</property-title><schema-property-title name="Question"></schema-property-title></child-database><text id="4">When someone asks a question:<text id="5">First, search the database to see if there are any pages that might contain the answer to the question. Note that the question doesnâ€™t have to be exactly the same.</text><text id="6">If there are any pages that might contain the answer:<text id="7">Read all of them.</text><text id="8">If the answer to the original question was found, respond with the answer. Make sure to link to any pages you reference in your response.</text><text id="9">Otherwise respond, declining to answer.</text></text><text id="10">If there are not existing similar questions then respond, declining to answer.</text></text><text id="11">When someone responds with new information about a question that was not answered:<text id="12">Insert the new answer into the database. Make sure to fill the question in the question property, and the answer in the page content.</text></text><text id="13">When someone responds with updated information about a question that was answered:<text id="14">Update the saved answer.</text></text><text id="15">When you save a new question and answer, make sure to:<text id="109">Format the question as a full sentence with a question mark at the end.</text><text id="110">The page content can contain multiple paragraphs. Make sure to keep it nicely formatted.</text></text></instructions-page>',id:2},{id:3,type:"human",value:"<chat><text>how much does our enterprise plan cost?</text></chat>"},{type:"assistant",id:5,value:'<think>The user asked about the cost of an enterprise pricing plan. I should search for related Q&As that might cover enterprise pricing.</think><query-database id="3"><search question="What information is available about enterprise pricing plans?" keywords="enterprise plan cost pricing"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="2" total-results="2"><child-page id="17" page-id="18"><property-title name="Question">Is there an enterprise plan?</property-title></child-page><child-page id="15" page-id="16"><property-title name="Question">is there a team plan?</property-title></child-page></query-database-results>',id:10},{type:"assistant",id:12,value:'<think>There is a page related to enterprise plans, so I should load and read it to see if it contains the answer to the user\'s question.</think><load-page id="18"/>'},{type:"observation",observationType:"page",pageId:"18",value:'<page id="18"><property-title name="Question">Is there an enterprise plan?</property-title><text id="19">We do have one and it costs $20 per member per month</text></page>',id:21},{type:"assistant",id:22,value:'<think>There is a page with the answer that an enterprise plan costs $20 per member per month. I should provide that information to the user.</think><chat><text><a href="18">According to this page</a>, our enterprise plan costs $20 per member per month.</text></chat>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"instructions-page-id":"0","current-datetime":"2023-05-09T14:36:42.184-04:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<instructions-page id="0"><property-title name="Name">Q&A database</property-title><text id="1">Use this database of questions and answers:</text><child-database id="2" database-id="3"><property-title name="Title">Q&A</property-title><schema-property-title name="Question"></schema-property-title></child-database><text id="4">When someone asks a question:<text id="5">First, search the database to see if there are any pages that might contain the answer to the question. Note that the question doesnâ€™t have to be exactly the same.</text><text id="6">If there are any pages that might contain the answer:<text id="7">Read all of them.</text><text id="8">If the answer to the original question was found, respond with the answer. Make sure to link to any pages you reference in your response.</text><text id="9">Otherwise respond, declining to answer.</text></text><text id="10">If there are not existing similar questions then respond, declining to answer.</text></text><text id="11">When someone responds with new information about a question that was not answered:<text id="12">Insert the new answer into the database. Make sure to fill the question in the question property, and the answer in the page content.</text></text><text id="13">When someone responds with updated information about a question that was answered:<text id="14">Update the saved answer.</text></text><text id="15">When you save a new question and answer, make sure to:<text id="109">Format the question as a full sentence with a question mark at the end.</text><text id="110">The page content can contain multiple paragraphs. Make sure to keep it nicely formatted.</text></text></instructions-page>',id:2},{id:3,type:"human",value:"<chat><text>how does SCIM work?</text></chat>"},{type:"assistant",id:5,value:'<think>I will search the Q&A database for any similar questions about how SCIM works.</think><query-database id="3"><search question="How does SCIM work? " keywords="integration SCIM system for "/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="2" total-results="2"><child-page id="17" page-id="18"><property-title name="Question">Is there an enterprise plan?</property-title></child-page><child-page id="15" page-id="16"><property-title name="Question">is there a team plan?</property-title></child-page></query-database-results>',id:10},{type:"assistant",id:12,value:"<think>There are no existing answers related to how SCIM works. I should inform the user I cannot answer the question at this time.</think><chat><text>I apologize, but I do not have information about how SCIM works.</text></chat>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"instructions-page-id":"0","current-datetime":"2023-05-09T14:30:59.397-04:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<instructions-page id="0"><property-title name="Name">Q&A database</property-title><text id="1">Use this database of questions and answers:</text><child-database id="2" database-id="3"><property-title name="Title">Q&A</property-title><schema-property-title name="Question"></schema-property-title></child-database><text id="4">When someone asks a question:<text id="5">First, search the database to see if there are any pages that might contain the answer to the question. Note that the question doesnâ€™t have to be exactly the same.</text><text id="6">If there are any pages that might contain the answer:<text id="7">Read all of them.</text><text id="8">If the answer to the original question was found, respond with the answer. Make sure to link to any pages you reference in your response.</text><text id="9">Otherwise respond, declining to answer.</text></text><text id="10">If there are not existing similar questions then respond, declining to answer.</text></text><text id="11">When someone responds with new information about a question that was not answered:<text id="12">Insert the new answer into the database. Make sure to fill the question in the question property, and the answer in the page content.</text></text><text id="13">When someone responds with updated information about a question that was answered:<text id="14">Update the saved answer.</text></text><text id="15">When you save a new question and answer, make sure to:<text id="109">Format the question as a full sentence with a question mark at the end.</text><text id="110">The page content can contain multiple paragraphs. Make sure to keep it nicely formatted.</text></text></instructions-page>',id:2},{id:3,type:"human",value:"<chat><text>is there a team plan?</text></chat>"},{type:"assistant",id:4,value:'<think>The user asked if there is a team plan. I should search the database for a related Q&A and respond appropriately.</think><query-database id="3"><search question="What Q&A covers pricing plans and options?" keywords="plan pricing team"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="1" total-results="1"><child-page id="15" page-id="16"><property-title name="Question">Is there an enterprise plan?</property-title></child-page></query-database-results>',id:10},{type:"assistant",id:14,value:"<think>There is no existing Q&A that covers if there is a team plan. I should respond that I cannot answer the question.</think><chat><text>I apologize, but I do not have information about a team pricing plan.</text></chat>"},{id:17,type:"human",value:"<chat><text>There is and it costs $10 per member per month</text></chat>"},{type:"assistant",id:18,value:'<think>The user provided new information related to a question that was not previously answered. I should add this as an answer in the database.</think><insert-inside id="3"><page><property-title name="Question">is there a team plan?</property-title><text>There is and it costs $10 per member per month</text></page></insert-inside>'},{type:"observation",observationType:"page",pageId:"34",value:'<page id="34"><property-title name="Question">is there a team plan?</property-title><text id="35">There is and it costs $10 per member per month</text></page>',id:21},{id:22,type:"human",value:"<chat><text>actually it costs $12</text></chat>"},{type:"assistant",id:24,value:'<think>The user responded with updated information about a question that now has an answer. I should modify the existing page to update the saved response.</think><set-title id="35">There is and it costs $12 per member per month</set-title>'}]],He=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-12T10:48:21.265-07:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title"></property-title><text id="1"></text></page>',id:2},{id:3,type:"human",value:"<chat><text>create a table with the top 10 all time most popular game consoles and their release date</text></chat>"},{type:"assistant",id:5,value:'<think>The user is requesting a new table with information on the top 10 most popular game consoles and their release dates. I should use insert-after to insert a new table into the page.</think><insert-after id="1"><table><tr><property-text name="1">PlayStation</property-text><property-text name="2">December 3, 1994</property-text></tr><tr><property-text name="1">Nintendo Entertainment System (NES)</property-text><property-text name="2">October 18, 1985</property-text></tr><tr><property-text name="1">PlayStation 2</property-text><property-text name="2">March 4, 2000</property-text></tr><tr><property-text name="1">Xbox 360</property-text><property-text name="2">November 22, 2005</property-text></tr><tr><property-text name="1">Game Boy</property-text><property-text name="2">April 21, 1989</property-text></tr><tr><property-text name="1">PlayStation 3</property-text><property-text name="2">November 11, 2006</property-text></tr><tr><property-text name="1">Nintendo DS</property-text><property-text name="2">November 21, 2004</property-text></tr><tr><property-text name="1">Game Boy Advance</property-text><property-text name="2">March 21, 2001</property-text></tr><tr><property-text name="1">Wii</property-text><property-text name="2">November 19, 2006</property-text></tr><tr><property-text name="1">Xbox</property-text><property-text name="2">November 15, 2001</property-text></tr></table>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title"></property-title><text id="1"></text><table id="960"><tr id="961"><property-text name="1">PlayStation</property-text><property-text name="2">December 3, 1994</property-text></tr><tr id="962"><property-text name="1">Nintendo Entertainment System (NES)</property-text><property-text name="2">October 18, 1985</property-text></tr><tr id="963"><property-text name="1">PlayStation 2</property-text><property-text name="2">March 4, 2000</property-text></tr><tr id="964"><property-text name="1">Xbox 360</property-text><property-text name="2">November 22, 2005</property-text></tr><tr id="965"><property-text name="1">Game Boy</property-text><property-text name="2">April 21, 1989</property-text></tr><tr id="966"><property-text name="1">PlayStation 3</property-text><property-text name="2">November 11, 2006</property-text></tr><tr id="967"><property-text name="1">Nintendo DS</property-text><property-text name="2">November 21, 2004</property-text></tr><tr id="968"><property-text name="1">Game Boy Advance</property-text><property-text name="2">March 21, 2001</property-text></tr><tr id="969"><property-text name="1">Wii</property-text><property-text name="2">November 19, 2006</property-text></tr><tr id="970"><property-text name="1">Xbox</property-text><property-text name="2">November 15, 2001</property-text></tr></table></page>',id:22},{id:23,type:"human",value:"<chat><text>add a header row for console and release date</text></chat>"},{type:"assistant",id:24,value:'<think>The user is requesting to add a header row to the table. I should use insert-before on the first row to add a header row.</think><insert-before id="961"><tr><property-text name="1">Console</property-text><property-text name="2">Release Date</property-text></tr></insert-before>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title"></property-title><text id="1"></text><table id="960"><tr id="974"><property-text name="1">Console</property-text><property-text name="2">Release Date</property-text></tr><tr id="961"><property-text name="1">PlayStation</property-text><property-text name="2">December 3, 1994</property-text></tr><tr id="962"><property-text name="1">Nintendo Entertainment System (NES)</property-text><property-text name="2">October 18, 1985</property-text></tr><tr id="963"><property-text name="1">PlayStation 2</property-text><property-text name="2">March 4, 2000</property-text></tr><tr id="964"><property-text name="1">Xbox 360</property-text><property-text name="2">November 22, 2005</property-text></tr><tr id="965"><property-text name="1">Game Boy</property-text><property-text name="2">April 21, 1989</property-text></tr><tr id="966"><property-text name="1">PlayStation 3</property-text><property-text name="2">November 11, 2006</property-text></tr><tr id="967"><property-text name="1">Nintendo DS</property-text><property-text name="2">November 21, 2004</property-text></tr><tr id="968"><property-text name="1">Game Boy Advance</property-text><property-text name="2">March 21, 2001</property-text></tr><tr id="969"><property-text name="1">Wii</property-text><property-text name="2">November 19, 2006</property-text></tr><tr id="970"><property-text name="1">Xbox</property-text><property-text name="2">November 15, 2001</property-text></tr></table></page>',id:33},{id:34,type:"human",value:"<chat><text>add a new column with an example popular game for the console and fill it with values</text></chat>"},{type:"assistant",id:36,value:'<think>The user is requesting to add a new column to the table with an example popular game for each console. I should use insert-after on the last column to add a new column, and then use set-property on each row to fill in the values.</think><insert-after id="960" name="2"><schema-property-text name="3"/></insert-after><set-property id="974"><property-text name="3">Popular game</property-text></set-property><set-property id="961"><property-text name="3">Gran Turismo</property-text></set-property><set-property id="962"><property-text name="3">Super Mario Bros.</property-text></set-property><set-property id="963"><property-text name="3">Grand Theft Auto: Vice City</property-text></set-property><set-property id="964"><property-text name="3">Halo: Combat Evolved</property-text></set-property><set-property id="965"><property-text name="3">Tetris</property-text></set-property><set-property id="966"><property-text name="3">Uncharted 2: Among Thieves</property-text></set-property><set-property id="967"><property-text name="3">Nintendogs</property-text></set-property><set-property id="968"><property-text name="3">PokÃ©mon Ruby and Sapphire</property-text></set-property><set-property id="969"><property-text name="3">Wii Sports</property-text></set-property><set-property id="970"><property-text name="3">Halo: Combat Evolved</property-text></set-property>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title"></property-title><text id="1"></text><table id="960"><tr id="974"><property-text name="1">Console</property-text><property-text name="2">Release Date</property-text><property-text name="3">Popular game</property-text></tr><tr id="961"><property-text name="1">PlayStation</property-text><property-text name="2">December 3, 1994</property-text><property-text name="3">Gran Turismo</property-text></tr><tr id="962"><property-text name="1">Nintendo Entertainment System (NES)</property-text><property-text name="2">October 18, 1985</property-text><property-text name="3">Super Mario Bros.</property-text></tr><tr id="963"><property-text name="1">PlayStation 2</property-text><property-text name="2">March 4, 2000</property-text><property-text name="3">Grand Theft Auto: Vice City</property-text></tr><tr id="964"><property-text name="1">Xbox 360</property-text><property-text name="2">November 22, 2005</property-text><property-text name="3">Halo: Combat Evolved</property-text></tr><tr id="965"><property-text name="1">Game Boy</property-text><property-text name="2">April 21, 1989</property-text><property-text name="3">Tetris</property-text></tr><tr id="966"><property-text name="1">PlayStation 3</property-text><property-text name="2">November 11, 2006</property-text><property-text name="3">Uncharted 2: Among Thieves</property-text></tr><tr id="967"><property-text name="1">Nintendo DS</property-text><property-text name="2">November 21, 2004</property-text><property-text name="3">Nintendogs</property-text></tr><tr id="968"><property-text name="1">Game Boy Advance</property-text><property-text name="2">March 21, 2001</property-text><property-text name="3">PokÃ©mon Ruby and Sapphire</property-text></tr><tr id="969"><property-text name="1">Wii</property-text><property-text name="2">November 19, 2006</property-text><property-text name="3">Wii Sports</property-text></tr><tr id="970"><property-text name="1">Xbox</property-text><property-text name="2">November 15, 2001</property-text><property-text name="3">Halo: Combat Evolved</property-text></tr></table></page>',id:52}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-12T12:09:33.135-07:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title"></property-title><table id="1"><tr id="2"><property-text name="1">Food</property-text><property-text name="2">Allergen</property-text></tr><tr id="3"><property-text name="1">Peanuts</property-text><property-text name="2">Peanut</property-text></tr><tr id="4"><property-text name="1">Tree Nuts</property-text><property-text name="2">Tree Nut</property-text></tr><tr id="5"><property-text name="1">Milk</property-text><property-text name="2">Dairy</property-text></tr><tr id="6"><property-text name="1">Eggs</property-text><property-text name="2">Egg</property-text></tr><tr id="7"><property-text name="1">Soy</property-text><property-text name="2">Soy</property-text></tr><tr id="8"><property-text name="1">Wheat</property-text><property-text name="2">Gluten</property-text></tr><tr id="9"><property-text name="1">Fish</property-text><property-text name="2">Fish</property-text></tr><tr id="10"><property-text name="1">Shellfish</property-text><property-text name="2">Shellfish</property-text></tr></table></page>',id:2},{id:3,type:"human",value:"<chat><text>bold the header row text. make sure to use set-property</text></chat>"},{type:"assistant",id:4,value:'<think>The user is requesting to bold the header row text. I should use set-property to set the bold attribute.</think><set-property id="2"><property-text name="1"><b>Food</b></property-text></set-property><set-property id="2"><property-text name="2"><b>Allergen</b></property-text></set-property>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title"></property-title><table id="1"><tr id="2"><property-text name="1"><b>Food</b></property-text><property-text name="2"><b>Allergen</b></property-text></tr><tr id="3"><property-text name="1">Peanuts</property-text><property-text name="2">Peanut</property-text></tr><tr id="4"><property-text name="1">Tree Nuts</property-text><property-text name="2">Tree Nut</property-text></tr><tr id="5"><property-text name="1">Milk</property-text><property-text name="2">Dairy</property-text></tr><tr id="6"><property-text name="1">Eggs</property-text><property-text name="2">Egg</property-text></tr><tr id="7"><property-text name="1">Soy</property-text><property-text name="2">Soy</property-text></tr><tr id="8"><property-text name="1">Wheat</property-text><property-text name="2">Gluten</property-text></tr><tr id="9"><property-text name="1">Fish</property-text><property-text name="2">Fish</property-text></tr><tr id="10"><property-text name="1">Shellfish</property-text><property-text name="2">Shellfish</property-text></tr></table></page>',id:16},{id:17,type:"human",value:"<chat><text>replace the items in the first column with an example food with that allergen</text></chat>"},{type:"assistant",id:18,value:'<think>The user is requesting to replace the items in the first column with example foods for each allergen. I should use set-property on each row to set the updated values.</think><set-property id="3"><property-text name="1">Peanut butter</property-text></set-property><set-property id="4"><property-text name="1">Almonds</property-text></set-property><set-property id="5"><property-text name="1">Milk</property-text></set-property><set-property id="6"><property-text name="1">Scrambled eggs</property-text></set-property><set-property id="7"><property-text name="1">Tofu</property-text></set-property><set-property id="8"><property-text name="1">Bread</property-text></set-property><set-property id="9"><property-text name="1">Tuna</property-text></set-property><set-property id="10"><property-text name="1">Shrimp</property-text></set-property>\n'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title"></property-title><table id="1"><tr id="2"><property-text name="1"><b>Food</b></property-text><property-text name="2"><b>Allergen</b></property-text></tr><tr id="3"><property-text name="1">Peanut butter</property-text><property-text name="2">Peanut</property-text></tr><tr id="4"><property-text name="1">Almonds</property-text><property-text name="2">Tree Nut</property-text></tr><tr id="5"><property-text name="1">Milk</property-text><property-text name="2">Dairy</property-text></tr><tr id="6"><property-text name="1">Scrambled eggs</property-text><property-text name="2">Egg</property-text></tr><tr id="7"><property-text name="1">Tofu</property-text><property-text name="2">Soy</property-text></tr><tr id="8"><property-text name="1">Bread</property-text><property-text name="2">Gluten</property-text></tr><tr id="9"><property-text name="1">Tuna</property-text><property-text name="2">Fish</property-text></tr><tr id="10"><property-text name="1">Shrimp</property-text><property-text name="2">Shellfish</property-text></tr></table></page>',id:30}]],Ge=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-12T13:58:47.957-07:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title"></property-title></page>',id:2},{id:3,type:"human",value:"<chat><text>write a blog post summarizing the eras in ancient greek history</text></chat>"},{type:"assistant",id:4,value:'<think>The user requested a blog post summarizing the eras in ancient Greek history. I will write it inside this page.</think><set-title id="0">A Summary of Ancient Greek History by Era</set-title><insert-inside id="0"><h2>The Archaic Era (800 BCE to 500 BCE)</h2><text>The Archaic Era marked the rise of the polis (city-states) and colonization of areas around the Mediterranean Sea. There were advances in art, poetry and sculpture. The Archaic Era ended with the Persian Wars against the Persian Empire.</text><h2>The Classical Era (500 BCE to 323 BCE)</h2><text>The Classical Era saw the rise of Athenian democracy and the growth of the Athenian empire. It was the golden age of art, philosophy (e.g. Plato, Aristotle), drama (e.g. Aeschylus, Sophocles, Euripides), poetry (e.g. Pindar), architecture (e.g. Pericles building the Parthenon), and science (e.g. Hippocrates). The Classical Era ended with the rise of Macedon under Philip II and Alexander the Great.</text><h2>The Hellenistic Era (323 BCE to 31 BCE)</h2><text>The Hellenistic Era began with the death of Alexander the Great, whose conquests spread Greek culture across the Middle East and Asia. The era was marked by the spread of Greek language and art across Alexander\'s former empire. The era came to an end with the rise of the Roman Republic. The Romans would go on to conquer the lands once ruled by Alexander and bring the Hellenistic Era to an end.</text></insert-inside>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-05-12T14:04:23.292-07:00"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title"></property-title></page>',id:2},{id:3,type:"human",value:"<chat><text>make this page a short guide to javascript</text></chat>"},{type:"assistant",id:4,value:'<think>The user requested to rewrite this page into a short guide to JavaScript.</think><set-title id="0">A Short Guide to JavaScript</set-title><insert-inside id="0"><h2>What is JavaScript?</h2><text>JavaScript is a lightweight, interpreted programming language that runs on browsers.  It makes websites interactive by executing scripts on events and activities like clicking, typing, etc. The scripts live in HTML pages and get executed when triggered.</text><h2>Data Types</h2><text>JavaScript supports numbers, strings, booleans, objects, arrays, null, undefined, objects, functions and symbols as primitive data types.</text><h2>Variables</h2><text>You can declare variables in JavaScript using let, const and var keywords. Let and const are block-scoped, meaning they are accessible only within the block they are declared, whereas var is function-scoped.</text><h2>Operators</h2><text>JavaScript supports arithmetic, assignment, comparison, logical, string, conditional and unary operators.</text><h2>Control Flow</h2><text>JavaScript supports if/else statements, for loops, while loops, do/while loops, switch statements, and exception handling using try/catch.</text><h2>Functions</h2><text>JavaScript functions are declared using the function keyword. They can be function declarations or function expressions. Functions in JS are first-class citizens, meaning they can be assigned to variables and passed as arguments to other functions.</text><h2>Objects</h2><text>JavaScript objects are used to represent complex data structures with properties that can be primitive values or references to other objects. Objects are created using the {...} syntax.</text><h2>Scope</h2><text>Scope refers to the accessibility of variables in JavaScript.  In JS, there are two types of scope: global scope and block scope.</text><h2>Closures</h2><text>A closure is a function that remembers its lexical scope even when the function is executed outside its scope. In other words, closures allow a function to access variables in the enclosing scope even after the outer function has returned.</text></insert-inside>'}]],Ke=[[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-04-03T15:54:49.835-07:00"}},{id:0,type:"assistant",value:'<load-page id="0"/>'},{id:0,type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title"></property-title></page>'},{id:0,type:"human",value:"<chat><text>make this page a draft blog post that announces our charitable donations and how much they were</text></chat>"},{id:0,type:"assistant",value:'<think>The user is requesting to create a draft blog post announcing charitable donations. I need to search the workspace first to find this information.</think><search question="What charitable donations did we make in the past year?" keywords="charitable donations company contributions"/>'},{id:0,type:"observation",observationType:"search",value:'<search-results current-results="10"><page-result id="2" title="Charitable Donations" created-datetime="2022-09-25" last-edited-datetime="2022-09-02" summary="Bits & Bytes\' commitment to donating 1% of annual profits to charities and nonprofits promoting access to technology and technical education, including donations of $75,000 to DonorsChoose.org, $80,000 to Technovation Girls, $50,000 per year for 3 years to Girls Who Code, and $50,000 per year for 3 years to FIRST Robotics.">We have donated $75,000 to DonorsChoose.org...\n\t\tWe have donated $80,000 to Technovation Girls...\n\t\tWe have donated $50,000 per year for 3 years to Girls Who Code...\n\t\tWe have donated $50,000 per year for 3 years to FIRST Robotics...</page-result><page-result id="3" title="Bits & Bytes: School Grants" created-datetime="2022-07-14" last-edited-datetime="2022-07-11" summary="Bits & Bytes\' School Grant Program and partnerships with nonprofits to support technology education in schools, including funding for digital tools, robotics kits, teacher training, and scholarships for students to attend tech camps and workshops">Our flagship education initiative is the annual Bits & Bytes School Grant Program. We award $1 million in grants to K-12 schools each year to fund technology education.\n\t\tLast year, we awarded over 300 grants totaling $1.2 million to schools across 50 states.\n\t\tWe also support technology education through partnerships with nonprofits like Girls Who Code, Black Girls Code, and Code.org.</page-result><page-result id="5" title="Community Sponsorships" created-datetime="2023-02-25" last-edited-datetime="2022-03-29" summary="Bits & Bytes\' community outreach initiatives, including partnerships with local schools, scholarships and internships, and donations to national nonprofits focused on STEM education and innovation">We recently donated $50,000 worth of robotics kits, microcontrollers, and 3D printers to West Hills Middle School to start an after-school robotics club.\n\t\tEach year we award $200,000 in college scholarships to students studying technology and engineering fields.\n\t\tThrough partnerships, sponsorships, scholarships, internships, and product donations, Bits & Bytes contributes over $2 million each year to support technology education and advancement in our communities.</page-result><page-result id="4" title="Bits & Bytes Volunteer Initiatives" created-datetime="2022-11-06" last-edited-datetime="2022-05-06" summary="Bits & Bytes\' volunteer initiatives, including coding camps, robotics team sponsorships, donation drives, STEM career days, scholarships and internships, charity fundraising, and disaster relief efforts">Donation Drives: We frequently organize donation drives to collect new and gently used tech products like laptops, tablets, and scientific calculators for local schools, libraries, and charitable organizations.\n\t\tCharity Fundraising: During the holidays, we hold charity drives across all our locations to raise money for organizations that promote technology education and access, such as Code.org, Girls Who Code, and DonorsChoose.org. We match all employee donations made during these drives.\n\t\tIn addition to our ongoing programs, we regularly hold fundraising and volunteering events in response to natural disasters and crises impacting the communities we serve. We have raised millions of dollars and donated thousands of volunteer hours for relief efforts in the aftermath of hurricanes, wildfires, and other events.</page-result><page-result id="6" title="STEM Education" created-datetime="2022-06-04" last-edited-datetime="2022-07-31" summary="Bits & Bytes\' initiatives to promote STEM education, including donating technology and funds to schools, offering free coding and robotics camps, partnering with national nonprofits, employee volunteer program, and scholarships and internships for underrepresented students pursuing tech-related degrees.">We donate electronics, robotics kits, and funds to schools in the communities we serve so students can learn hands-on technical skills. Last year we donated over $5 million in products and funds to 500 schools across the country.\n\t\tIn 2019 we hosted over 10,000 students at our camps.\n\t\tOver the past 5 years, we have awarded over $10 million in scholarships and hired 500 interns at Bits & Bytes.</page-result><page-result id="7" title="Community Outreach" created-datetime="2022-04-18" last-edited-datetime="2022-12-08" summary="Overview of community outreach initiatives related to education and innovation in STEM fields, including STEM education, community sponsorships, volunteer initiatives, charitable donations, and school grants"><todo id="9">Charitable Donations</todo></page-result><page-result id="11" title="Bits & Bytes Sale Highlights" created-datetime="2022-11-23" last-edited-datetime="2022-06-08" summary="Highlights of a sale on various tech products, including smart watches, fitness trackers, virtual reality headsets, flash drives, gaming PC components, chargers, and smart devices"></page-result><page-result id="12" title="Member Perks" created-datetime="2022-06-03" last-edited-datetime="2023-01-03" summary="Overview of the loyalty programs and perks offered by Bits & Bytes Club Rewards"></page-result><page-result id="8" title="Investor Relations" created-datetime="2022-11-16" last-edited-datetime="2022-05-01" summary="Overview of Bits & Bytes, including its history, mission, leadership team, partnerships, financials, and contact information for investor relations">There is no information on charitable donations and amounts.</page-result><page-result id="13" title="Points & Levels" created-datetime="2022-07-03" last-edited-datetime="2022-09-01" summary="Information about the loyalty rewards programs offered by Bits & Bytes, including the free Byte Points program and the paid MegaBytes program with exclusive benefits for customers who spend a minimum of $1,000 annually"></page-result></search-results>'},{id:0,type:"assistant",value:'<think>Based on search results, the charitable donations appear to be $75,000 to DonorsChoose.org, $80,000 to Technovation Girls, $50,000/year for 3 years to Girls Who Code, $50,000/year for 3 years to FIRST Robotics, $1 million in school grants, $2 million in community sponsorships and product donations, plus additional contributions raised from employee drives and company matching.</think><set-title id="0">Announcing $3.8 Million in Charitable Donations for 2022</set-title><insert-inside id="0"><text>Bits & Bytes donated $3.8 million in funds, products, and services in 2022 to support technology education.</text><text>This includes $75,000 to <a href="2">DonorsChoose.org</a>, $80,000 to <a href="2">Technovation Girls</a>, $50,000/year for 3 years to <a href="2">Girls Who Code</a>, and $50,000/year for 3 years to <a href="2">FIRST Robotics</a>.</text><text>We also awarded $1 million in <a href="3">school grants</a>, gave $2 million through <a href="5">community sponsorships and product donations</a>, and raised additional funds matched by Bits & Bytes in <a href="4">employee charity drives</a>.</text><text>These contributions demonstrate our mission to empower future generations through STEM education and access to technology.</text></insert-inside>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":m.YK,"current-page-id":"0","current-datetime":"2023-04-03T15:54:49.835-07:00"}},{id:0,type:"assistant",value:'<load-page id="0"/>'},{id:0,type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title"></property-title></page>'},{id:0,type:"human",value:"<chat><text>find information about our internship roles and write a tweet announcing them in this page</text></chat>"},{id:0,type:"assistant",value:'<think>The user would like me to find information about internship roles and write a tweet announcing them in this page. I should search for relevant information to summarize in a tweet.</think><search question="What are the internship roles offered?" keywords="internship role offered"/>'},{id:0,type:"observation",observationType:"search",value:'<search-results current-results="9"><page-result id="2" title="True Blue: Career Paths" created-datetime="2022-11-23" last-edited-datetime="2022-07-30" summary="Overview of career opportunities at True Blue, including retail, operations, corporate, and internship positions">We offer internship programs for students interested in retail, operations, merchandising, marketing, and finance. Application page: trueblue.com/internships</page-result><page-result id="3" title="Careers" created-datetime="2022-05-03" last-edited-datetime="2022-04-06" summary="Overview of career opportunities available at True Blue, including retail positions, corporate roles, and internships">Explore career opportunities available at True Blue, including retail positions, corporate roles, and internships.</page-result><page-result id="4" title="Internships & Opportunities" created-datetime="2023-02-04" last-edited-datetime="2022-05-08" summary="Overview of internship, retail, and corporate job opportunities at True Blue, including specific details about the internship program and available roles in merchandising, marketing, inventory management, finance, and IT">Our internship programs provide hands-on experience in the technology industry and a chance to contribute to an innovative company. We offer internships in merchandising, marketing, inventory management, finance, and IT.\n\t\tMerchandising interns help select which products to carry in our stores. Marketing interns develop campaigns to promote new products and events. Inventory management interns track product shipments and optimize store inventory levels. Finance interns assist with budgeting, accounting, and reporting. And IT interns help support internal systems and develop new technology solutions.</page-result><page-result id="5" title="Community Sponsorships" created-datetime="2023-02-25" last-edited-datetime="2022-03-29" summary="True Blue\' community outreach initiatives, including partnerships with local schools, scholarships and internships, and nonprofit partnerships to support STEM education and advancement">We also hire over 50 interns across our stores and corporate office, providing hands-on experience and mentorship in retail, marketing, finance, and product management roles. Many of our interns have gone on to work for True Blue full-time after graduating.</page-result><page-result id="6" title="STEM Education" created-datetime="2022-06-04" last-edited-datetime="2022-07-31" summary="True Blue\' commitment to promoting STEM education through various initiatives, including donating technology and funds to schools, offering free coding and robotics camps, partnering with national nonprofits, employee volunteer program, and offering scholarships and internships to underrepresented students pursuing tech-related degrees.">We offer college scholarships and paid internships to students pursuing degrees in tech-related fields.\n\t\tOur programs target those from disadvantaged backgrounds who are underrepresented in the tech industry.\n\t\tOver the past 5 years, we have awarded over $10 million in scholarships and hired 500 interns at True Blue.</page-result><page-result id="7" title="Job Openings at True Blue" created-datetime="2022-09-03" last-edited-datetime="2022-10-20" summary="Job openings at True Blue, including positions at retail stores, corporate headquarters, and summer internships in customer experience.">True Blue offers summer internship opportunities for students interested in technology and retail. Interns will assist the Marketing and Customer Experience teams with special projects aimed at improving the customer journey.</page-result><page-result id="8" title="Workplace Culture at True Blue" created-datetime="2023-01-20" last-edited-datetime="2022-04-15" summary="Overview of the workplace culture at True Blue, including continuous learning and development, an inclusive and diverse environment, fun and rewarding work, work-life balance, and career growth opportunities"></page-result><page-result id="9" title="True Blue: School Grants" created-datetime="2022-07-14" last-edited-datetime="2022-07-11" summary="True Blue School Grant Program and partnerships with nonprofits to support technology education">There is no information on internship roles in the given page.</page-result><page-result id="10" title="True Blue Volunteer Initiatives" created-datetime="2022-11-06" last-edited-datetime="2022-05-06" summary="Overview of volunteer initiatives at True Blue, including coding camps for kids, robotics team sponsorships, donation drives, STEM career days, scholarships and internships, and charity fundraising.">We offer competitive paid internships and scholarships for college students pursuing technology and engineering degrees. Over 500 students have participated in our internship program, and we have awarded scholarships to more than 1,000 students since the program began.</page-result></search-results>'},{id:0,type:"assistant",value:'<think>According to Internships & Opportunities, we offer internships in merchandising, marketing, inventory management, finance, and IT. Community Sponsorships notes we provide hands-on experience and hire 50+ interns yearly for roles in retail, marketing, finance, and product management. I will compose a tweet announcing these details.</think><insert-inside id="0"><text>We\'re proud to offer summer internships in retail, operations, marketing, finance, IT & more! Gain real-world experience at a leading tech company. Apply now at trueblue.com/internships #internships #jobsearch</text></insert-before>'}]],$e=[[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-06-21T15:20:22.592-04:00","current-person-id":"1","current-person-name":"Julio Santos"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Name">My grocery list</property-title><property-multi-select name="Tags"/><property-created-time name="Created time"><mention-datetime date="2023-06-21" time="15:19"/></property-created-time><h1 id="2">My grocery list</h1><text id="3">For Pasta:</text><uli id="4">Pasta (of your choice)</uli><uli id="5">Tomato sauce or Alfredo sauce</uli><uli id="6">Olive oil</uli><uli id="7">Garlic</uli><uli id="8">Onion</uli><uli id="9">Salt</uli><uli id="10">Black pepper</uli><uli id="11">Parmesan cheese (optional)</uli><text id="12">Happy cooking!</text></page>',id:2},{id:3,type:"human",value:"<chat><text>color the text â€œolive oilâ€ to be green</text></chat>"},{id:4,type:"assistant",value:'<think>The user is requesting to color the text "olive oil" green. I should use set-title to apply inline formatting.</think><set-title id="6"><h color="green">Olive oil</h></set-title>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-06-21T15:28:02.138-04:00","current-person-id":"1","current-person-name":"Bill"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Name">List of movies to watch</property-title><property-multi-select name="Tags"/><property-created-time name="Created time"><mention-datetime date="2023-06-21" time="15:27"/></property-created-time><h1 id="2">List of movies to watch</h1><oli id="3">The Godfather</oli><oli id="4">The Shawshank Redemption</oli><oli id="5">The Dark Knight</oli><oli id="6">Pulp Fiction</oli><oli id="7">Forrest Gump</oli><oli id="8">The Matrix</oli><oli id="9">The Silence of the Lambs</oli><oli id="10">Titanic</oli><oli id="11">Fight Club</oli><oli id="12">Goodfellas</oli></page>',id:2},{id:3,type:"human",value:"<chat><text>edit the item â€œpulp fictionâ€ and color the word pulp with a yellow background color</text></chat>"},{id:4,type:"assistant",value:"<think>The user is requesting to edit the 'Pulp Fiction' block to color the word 'pulp' yellow. I should use set-title to color 'pulp' yellow.</think><set-title id=\"6\">Pulp <h color=\"yellow-background\">pulp</h> Fiction</set-title>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-06-22T13:12:29.674-04:00","current-person-id":"1","current-person-name":"Bill"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">How to update the data</property-title><oli id="2">Read data from the data table</oli><oli id="3">Make any desired changes to the data</oli><oli id="4">Write data back into the data table</oli></page>',id:2},{id:3,type:"human",value:"<chat><text>create a purple call-out block at the end of the document saying that these steps should be followed closely</text></chat>"},{id:4,type:"assistant",value:'<think>The user requested a purple call-out block at the end of the page reminding to follow the steps closely.</think><insert-after id="4"><callout color="purple">These steps should be followed closely</callout></insert-after>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-06-22T13:14:51.818-04:00","current-person-id":"1","current-person-name":"Bill"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Steps for harvesting apples</property-title><text id="2">Pick an apple from the tree</text><text id="3">Place the apple in your basket</text><text id="4">Carry your basket back to your house</text></page>',id:2},{id:3,type:"human",value:"<chat><text>change the background color of the last text block to green</text></chat>"},{id:4,type:"assistant",value:'The user is requesting to change the background color of the last text block to green.</think><set-attribute id="4" color="green-background"/>'}]],Ye=[[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-08-02T10:54:10.357-04:00","current-person-id":"1","current-person-name":"Bill"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Shopping list</property-title><text id="2"/><text id="3">My shopping list:</text><uli id="4">Apples</uli><uli id="5">Oranges</uli><uli id="6">Pears</uli><text id="7"/></page>',id:2},{id:3,type:"human",value:"<chat><text>Turn my shopping list into a synced block.</text></chat>"},{type:"assistant",id:5,value:'<think>The user requested to turn the shopping list into a synced block. I will insert a synced block and move the contents of the shopping list into it.</think><insert-after id="2"><synced-block><move id="3" /><move id="4"/><move id="5"/><move id="6"/></synced-block></insert-after>'}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-08-02T10:59:36.986-04:00","current-person-id":"1","current-person-name":"Bill"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Shopping list</property-title><synced-block id="2"><text id="3">My shopping list:</text><uli id="4">Apples</uli><uli id="5">Oranges</uli><uli id="6">Pears</uli></synced-block><text id="7">Here is a copy of my shopping list:</text></page>',id:2},{id:3,type:"human",value:"<chat><text>Create a synced block referencing the shopping list synced block.</text></chat>"},{type:"assistant",id:4,value:"<think>The user is requesting a new synced block that references the existing 'Shopping list' synced block. I should insert a synced block after the current text block referencing 'Shopping list'.</think><insert-after id=\"7\"><synced-block-reference synced-block-id=\"2\"/></insert-after>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-08-03T10:31:30.211-04:00","current-person-id":"1","current-person-name":"Bill"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<page id="0"><property-title name="Title">Copy of shopping list</property-title><synced-block-reference id="2" synced-block-id="3"><text id="4">Shopping list:</text><uli id="5">Apples</uli><uli id="6">Oranges</uli><uli id="7">Peanut butter</uli></synced-block-reference></page>',id:2},{type:"observation",observationType:"page",pageId:"8",value:'<page id="8"><property-title name="Title">Original shopping list</property-title><synced-block id="3"><text id="4">Shopping list:</text><uli id="5">Apples</uli><uli id="6">Oranges</uli><uli id="7">Peanut butter</uli></synced-block></page>',id:3},{id:4,type:"human",value:"<chat><text>Add peaches after oranges in my shopping list</text></chat>"},{type:"assistant",id:5,value:"<think>The user asked to add 'peaches' after 'oranges' in the shopping list on the 'Copy of shopping list' page. I should insert a new unordered list item with the text 'peaches' after the list item for 'oranges'.</think><insert-after id=\"6\"><uli>Peaches</uli></insert-after>"}]],Qe=[[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-08-03T12:16:55.894-04:00","current-person-id":"1","current-person-name":"Trixie"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<database id="0"><property-title name="Title">Project Brief</property-title><schema-property-title name="Milestone Name"/><schema-property-date name="Actual Due Date"/><schema-property-checkbox name="Billable"/><schema-property-number name="Budget" format="dollar"/><schema-property-phone-number name="Client Point of Contact"/><schema-property-status name="Client Review Status"><schema-option-category category="To-do"><schema-option option="Draft proposal"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit for approval"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Proposal approved"/></schema-option-category></schema-property-status><schema-property-date name="Due Date"/><schema-property-phone-number name="Manager Contact Number"/><schema-property-text name="Milestone Description"/><schema-property-multi-select name="Milestone Focus"><schema-option option="Development"/><schema-option option="UI/UX design"/><schema-option option="Web design"/></schema-property-multi-select><schema-property-text name="Milestone Notes"/><schema-property-status name="Milestone Status"><schema-option-category category="To-do"><schema-option option="Gather requirements"/><schema-option option="Meet with client"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit proposal"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Complete"/></schema-option-category></schema-property-status><schema-property-select name="Progress"><schema-option option="Delayed"/><schema-option option="On time"/><schema-option option="Blocked"/><schema-option option="Critical path"/></schema-property-select><schema-property-person name="Project Manager" limit="Infinity"/><schema-property-email name="Project Manager Email"/><schema-property-url name="Sign-off URL"/><schema-property-created-time name="Created On"/><schema-property-created-by name="Created by"/></database>',id:2},{id:3,type:"human",value:"<chat><text>What is the percent of tasks that are complete?</text></chat>"},{type:"assistant",id:4,value:"<think>The user is asking for the percentage of tasks that have a 'Milestone Status' of 'Complete'. I will query the database to calculate the percentage of tasks with a 'Complete' status using a 'Percent per group' aggregation on the 'Milestone Status' property filtered to the 'Complete' group.</think><query-database id=\"0\"><aggregation-property-status name=\"Milestone Status\" group=\"Complete\" aggregation=\"Percent per group\"/></query-database>"},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="10" total-results="17"><child-page id="9" page-id="10" database-id="0"><property-title name="Milestone Name">Xstream Entertainment website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="23:04" end-date="2023-07-04" end-time="15:31"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$1,357.00"/><property-phone-number name="Client Point of Contact">Mark Thompson; mthompson@clientcompany.com; 555-123-4567</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date date="2023-06-25"/></property-date><property-phone-number name="Manager Contact Number">(408) 555-0100</property-phone-number><property-text name="Milestone Description">Complete build and QA of initial website prototype</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Ensure all UX elements align to approved design</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">john.smith@company.com</property-email><property-url name="Sign-off URL">https://projectmanagementtool.com/milestone/123/signoff</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="11" page-id="12" database-id="0"><property-title name="Milestone Name">Santa Barbara yacht club mobile app</property-title><property-date name="Actual Due Date"><mention-date-range start-date="2023-06-24" end-date="2023-07-03"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$54,653.00"/><property-phone-number name="Client Point of Contact">jdoe@companyabc.com</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-24" start-time="22:38" end-date="2023-07-04" end-time="05:21"/></property-date><property-phone-number name="Manager Contact Number">555-123-4567</property-phone-number><property-text name="Milestone Description">Complete initial research and client needs analysis</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Verify client vision and clarify objectives with STAT Consulting and Point of Contact</property-text><property-status name="Milestone Status"><option option="Submit proposal"/></property-status><property-select name="Progress"><option option="Critical path"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@statconsulting.com</property-email><property-url name="Sign-off URL">http://clients.statconsulting.com/project-sign-off/67891</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="13" page-id="14" database-id="0"><property-title name="Milestone Name">Transit Hub booking app</property-title><property-date name="Actual Due Date"><mention-datetime date="2023-06-21" time="12:39"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$17,232.00"/><property-phone-number name="Client Point of Contact">John Doe, CTO</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime date="2023-06-26" time="14:12"/></property-date><property-phone-number name="Manager Contact Number">415-555-0199</property-phone-number><property-text name="Milestone Description">Kickoff Meeting</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Discuss project scope, timeline, and key milestones. Get team buy-in and address any questions/concerns.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">pm@firmxy.com</property-email><property-url name="Sign-off URL">https://app.asana.com/0/0/11850179655912</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="15" page-id="16" database-id="0"><property-title name="Milestone Name">SGV National Bank banking app</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="07:54" end-date="2023-06-29" end-time="03:23"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$92,113.00"/><property-phone-number name="Client Point of Contact">Sandra Lee (Director of Marketing)</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-datetime date="2023-07-04" time="06:04"/></property-date><property-phone-number name="Manager Contact Number">(650)723-4567</property-phone-number><property-text name="Milestone Description">Deploy new e-commerce website</property-text><property-multi-select name="Milestone Focus"><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Client has requested some minor changes to the user interface. Need to incorporate revisions before launch.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Critical path"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jsmith@techagency.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/15MWjoKn3wQJ81SGzxh44_wF_OdoKbZEYv-PEZkmf8RU/edit?usp=sharing</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="17" page-id="18" database-id="0"><property-title name="Milestone Name">Black Diamond Resorts booking site</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-21"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$3,034.00"/><property-phone-number name="Client Point of Contact">Judith Williams, VP Marketing</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-26" end-date="2023-07-01"/></property-date><property-phone-number name="Manager Contact Number">(650)555-1234</property-phone-number><property-text name="Milestone Description">Complete draft initial designs</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Need client approval before proceeding to next phase. Meeting set for March 3 to review.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@designfirm.com</property-email><property-url name="Sign-off URL">https://designfirm.sharepoint.com/sites/ProjectBrief/Lists/Milestones/DispForm.aspx?ID=3</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="19" page-id="20" database-id="0"><property-title name="Milestone Name">Sequoia Hotel booking system</property-title><property-date name="Actual Due Date"><mention-datetime date="2023-06-29" time="09:34"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$92,514.00"/><property-phone-number name="Client Point of Contact">Jane Doe, CEO</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-22" end-date="2023-07-03"/></property-date><property-phone-number name="Manager Contact Number">555-123-4567</property-phone-number><property-text name="Milestone Description">Meet with client to discuss project scope and timeline.</property-text><property-multi-select name="Milestone Focus"><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Be prepared to discuss budget, priorities and resourcing. Get sign-off on project charter and schedule follow-up meeting.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pm@company.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/1a2b3c4d5/edit?usp=sharing</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="21" page-id="22" database-id="0"><property-title name="Milestone Name">Pandora Corp. ecommerce storefront</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-22"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$84,583.00"/><property-phone-number name="Client Point of Contact">Jane Doe, CEO</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-26" end-date="2023-07-01"/></property-date><property-phone-number name="Manager Contact Number">425-123-4567</property-phone-number><property-text name="Milestone Description">Complete user experience design.</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Finalize 4 user flows and 8 wireframes based on client feedback.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pmjones@company.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/1q2w3e4r5t6y7u8i9o0i/edit</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="23" page-id="24" database-id="0"><property-title name="Milestone Name">Eco Movement nonprofit website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-21" start-time="01:22" end-date="2023-07-03" end-time="20:55"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$40,956.00"/><property-phone-number name="Client Point of Contact">David Walsh</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime date="2023-07-02" time="13:57"/></property-date><property-phone-number name="Manager Contact Number">+14155551212</property-phone-number><property-text name="Milestone Description">Wireframes Approved</property-text><property-multi-select name="Milestone Focus"><option option="UI/UX design"/></property-multi-select><property-text name="Milestone Notes">Send wireframes for final approval before moving to visual designs. Client has requested an update to the mobile navigation. Be sure all pages have a mobile-first layout.</property-text><property-status name="Milestone Status"><option option="Meet with client"/></property-status><property-select name="Progress"><option option="Delayed"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">pm@agencyxyz.com</property-email><property-url name="Sign-off URL">https://approval.agencyxyz.com/project/123</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="5" page-id="6" database-id="0"><property-title name="Milestone Name">Peak Adventures mobile app</property-title><property-date name="Actual Due Date"><mention-date-range start-date="2023-06-23" end-date="2023-06-29"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$99,243.00"/><property-phone-number name="Client Point of Contact">Amy Smith</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-23" end-date="2023-06-28"/></property-date><property-phone-number name="Manager Contact Number">123-123-1234</property-phone-number><property-text name="Milestone Description">Initial Design Brief</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Review and approve initial user experience and mock designs.</property-text><property-status name="Milestone Status"><option option="Complete"/></property-status><property-select name="Progress"><option option="Delayed"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@firmaconsulting.com</property-email><property-url name="Sign-off URL">https://firmaconsulting.sharepoint.com/:f:/s/NewProject/EnhA4DkXvaJLil--LfIplIB9CpFW9heNiwZK9R6vzEeekg?e=GrXOtQ</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="25" page-id="26" database-id="0"><property-title name="Milestone Name">Simplicity Inc. website redesign</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-27"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$83,367.00"/><property-phone-number name="Client Point of Contact">Jenny Lee, VP Product</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-23" start-time="13:04" end-date="2023-07-04" end-time="10:19"/></property-date><property-phone-number name="Manager Contact Number">+14158552222</property-phone-number><property-text name="Milestone Description">Complete initial draft of user interface wireframes</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Please review the draft wireframes by Monday, Aug 22. John has already signed off on them.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Blocked"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jdoe@acmedesign.com</property-email><property-url name="Sign-off URL">https://projects.acmedesign.com/proj23/milestones/m1/review</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><aggregation-result name="Milestone Status" aggregation="Percent per group">0.17647058823529413</aggregation-result></query-database-results>',id:28},{type:"assistant",id:30,value:"<think>The query returned an aggregation result of 0.17647058823529413 (17.65%) for the percentage of tasks with a 'Milestone Status' of 'Complete'.</think><chat><text>The percent of tasks that are complete is 17.65%</text></chat>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-08-03T12:19:59.282-04:00","current-person-id":"1","current-person-name":"Trixie"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<database id="0"><property-title name="Title">Project Brief</property-title><schema-property-title name="Milestone Name"/><schema-property-date name="Actual Due Date"/><schema-property-checkbox name="Billable"/><schema-property-number name="Budget" format="dollar"/><schema-property-phone-number name="Client Point of Contact"/><schema-property-status name="Client Review Status"><schema-option-category category="To-do"><schema-option option="Draft proposal"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit for approval"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Proposal approved"/></schema-option-category></schema-property-status><schema-property-date name="Due Date"/><schema-property-phone-number name="Manager Contact Number"/><schema-property-text name="Milestone Description"/><schema-property-multi-select name="Milestone Focus"><schema-option option="Development"/><schema-option option="UI/UX design"/><schema-option option="Web design"/></schema-property-multi-select><schema-property-text name="Milestone Notes"/><schema-property-status name="Milestone Status"><schema-option-category category="To-do"><schema-option option="Gather requirements"/><schema-option option="Meet with client"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit proposal"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Complete"/></schema-option-category></schema-property-status><schema-property-select name="Progress"><schema-option option="Delayed"/><schema-option option="On time"/><schema-option option="Blocked"/><schema-option option="Critical path"/></schema-property-select><schema-property-person name="Project Manager" limit="Infinity"/><schema-property-email name="Project Manager Email"/><schema-property-url name="Sign-off URL"/><schema-property-created-time name="Created On"/><schema-property-created-by name="Created by"/></database>',id:2},{id:3,type:"human",value:"<chat><text>How many milestones are not marked as billable?</text></chat>"},{type:"assistant",id:4,value:"<think>The user is asking for the number of milestones that are not billable. I will query the database using a 'Count unchecked' aggregation on the 'Billable' checkbox property to count the milestones where 'Billable' is false.</think><query-database id=\"0\"><aggregation-property-checkbox name=\"Billable\" aggregation=\"Count unchecked\"/></query-database>"},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="10" total-results="17"><child-page id="2" page-id="3" database-id="0"><property-title name="Milestone Name">Xstream Entertainment website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="23:04" end-date="2023-07-04" end-time="15:31"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$1,357.00"/><property-phone-number name="Client Point of Contact">Mark Thompson; mthompson@clientcompany.com; 555-123-4567</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date date="2023-06-25"/></property-date><property-phone-number name="Manager Contact Number">(408) 555-0100</property-phone-number><property-text name="Milestone Description">Complete build and QA of initial website prototype</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Ensure all UX elements align to approved design</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">john.smith@company.com</property-email><property-url name="Sign-off URL">https://projectmanagementtool.com/milestone/123/signoff</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="5" page-id="6" database-id="0"><property-title name="Milestone Name">Santa Barbara yacht club mobile app</property-title><property-date name="Actual Due Date"><mention-date-range start-date="2023-06-24" end-date="2023-07-03"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$54,653.00"/><property-phone-number name="Client Point of Contact">jdoe@companyabc.com</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-24" start-time="22:38" end-date="2023-07-04" end-time="05:21"/></property-date><property-phone-number name="Manager Contact Number">555-123-4567</property-phone-number><property-text name="Milestone Description">Complete initial research and client needs analysis</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Verify client vision and clarify objectives with STAT Consulting and Point of Contact</property-text><property-status name="Milestone Status"><option option="Submit proposal"/></property-status><property-select name="Progress"><option option="Critical path"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@statconsulting.com</property-email><property-url name="Sign-off URL">http://clients.statconsulting.com/project-sign-off/67891</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="7" page-id="8" database-id="0"><property-title name="Milestone Name">Transit Hub booking app</property-title><property-date name="Actual Due Date"><mention-datetime date="2023-06-21" time="12:39"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$17,232.00"/><property-phone-number name="Client Point of Contact">John Doe, CTO</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime date="2023-06-26" time="14:12"/></property-date><property-phone-number name="Manager Contact Number">415-555-0199</property-phone-number><property-text name="Milestone Description">Kickoff Meeting</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Discuss project scope, timeline, and key milestones. Get team buy-in and address any questions/concerns.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">pm@firmxy.com</property-email><property-url name="Sign-off URL">https://app.asana.com/0/0/11850179655912</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="9" page-id="10" database-id="0"><property-title name="Milestone Name">SGV National Bank banking app</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="07:54" end-date="2023-06-29" end-time="03:23"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$92,113.00"/><property-phone-number name="Client Point of Contact">Sandra Lee (Director of Marketing)</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-datetime date="2023-07-04" time="06:04"/></property-date><property-phone-number name="Manager Contact Number">(650)723-4567</property-phone-number><property-text name="Milestone Description">Deploy new e-commerce website</property-text><property-multi-select name="Milestone Focus"><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Client has requested some minor changes to the user interface. Need to incorporate revisions before launch.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Critical path"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jsmith@techagency.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/15MWjoKn3wQJ81SGzxh44_wF_OdoKbZEYv-PEZkmf8RU/edit?usp=sharing</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="11" page-id="12" database-id="0"><property-title name="Milestone Name">Black Diamond Resorts booking site</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-21"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$3,034.00"/><property-phone-number name="Client Point of Contact">Judith Williams, VP Marketing</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-26" end-date="2023-07-01"/></property-date><property-phone-number name="Manager Contact Number">(650)555-1234</property-phone-number><property-text name="Milestone Description">Complete draft initial designs</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Need client approval before proceeding to next phase. Meeting set for March 3 to review.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@designfirm.com</property-email><property-url name="Sign-off URL">https://designfirm.sharepoint.com/sites/ProjectBrief/Lists/Milestones/DispForm.aspx?ID=3</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="13" page-id="14" database-id="0"><property-title name="Milestone Name">Sequoia Hotel booking system</property-title><property-date name="Actual Due Date"><mention-datetime date="2023-06-29" time="09:34"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$92,514.00"/><property-phone-number name="Client Point of Contact">Jane Doe, CEO</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-22" end-date="2023-07-03"/></property-date><property-phone-number name="Manager Contact Number">555-123-4567</property-phone-number><property-text name="Milestone Description">Meet with client to discuss project scope and timeline.</property-text><property-multi-select name="Milestone Focus"><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Be prepared to discuss budget, priorities and resourcing. Get sign-off on project charter and schedule follow-up meeting.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pm@company.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/1a2b3c4d5/edit?usp=sharing</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="15" page-id="16" database-id="0"><property-title name="Milestone Name">Pandora Corp. ecommerce storefront</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-22"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$84,583.00"/><property-phone-number name="Client Point of Contact">Jane Doe, CEO</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-26" end-date="2023-07-01"/></property-date><property-phone-number name="Manager Contact Number">425-123-4567</property-phone-number><property-text name="Milestone Description">Complete user experience design.</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Finalize 4 user flows and 8 wireframes based on client feedback.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pmjones@company.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/1q2w3e4r5t6y7u8i9o0i/edit</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="17" page-id="18" database-id="0"><property-title name="Milestone Name">Eco Movement nonprofit website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-21" start-time="01:22" end-date="2023-07-03" end-time="20:55"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$40,956.00"/><property-phone-number name="Client Point of Contact">David Walsh</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime date="2023-07-02" time="13:57"/></property-date><property-phone-number name="Manager Contact Number">+14155551212</property-phone-number><property-text name="Milestone Description">Wireframes Approved</property-text><property-multi-select name="Milestone Focus"><option option="UI/UX design"/></property-multi-select><property-text name="Milestone Notes">Send wireframes for final approval before moving to visual designs. Client has requested an update to the mobile navigation. Be sure all pages have a mobile-first layout.</property-text><property-status name="Milestone Status"><option option="Meet with client"/></property-status><property-select name="Progress"><option option="Delayed"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">pm@agencyxyz.com</property-email><property-url name="Sign-off URL">https://approval.agencyxyz.com/project/123</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="19" page-id="20" database-id="0"><property-title name="Milestone Name">Peak Adventures mobile app</property-title><property-date name="Actual Due Date"><mention-date-range start-date="2023-06-23" end-date="2023-06-29"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$99,243.00"/><property-phone-number name="Client Point of Contact">Amy Smith</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-23" end-date="2023-06-28"/></property-date><property-phone-number name="Manager Contact Number">123-123-1234</property-phone-number><property-text name="Milestone Description">Initial Design Brief</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Review and approve initial user experience and mock designs.</property-text><property-status name="Milestone Status"><option option="Complete"/></property-status><property-select name="Progress"><option option="Delayed"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@firmaconsulting.com</property-email><property-url name="Sign-off URL">https://firmaconsulting.sharepoint.com/:f:/s/NewProject/EnhA4DkXvaJLil--LfIplIB9CpFW9heNiwZK9R6vzEeekg?e=GrXOtQ</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="21" page-id="22" database-id="0"><property-title name="Milestone Name">Simplicity Inc. website redesign</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-27"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$83,367.00"/><property-phone-number name="Client Point of Contact">Jenny Lee, VP Product</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-23" start-time="13:04" end-date="2023-07-04" end-time="10:19"/></property-date><property-phone-number name="Manager Contact Number">+14158552222</property-phone-number><property-text name="Milestone Description">Complete initial draft of user interface wireframes</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Please review the draft wireframes by Monday, Aug 22. John has already signed off on them.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Blocked"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jdoe@acmedesign.com</property-email><property-url name="Sign-off URL">https://projects.acmedesign.com/proj23/milestones/m1/review</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><aggregation-result name="Billable" aggregation="Count unchecked">5</aggregation-result></query-database-results>',id:16},{type:"assistant",id:17,value:"<think>The query returned an aggregation result of 5 for the count of milestones where 'Billable' is false. </think><chat><text>There are 5 milestones that are not marked as billable.</text></chat>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-08-03T12:21:44.570-04:00","current-person-id":"1","current-person-name":"Trixie"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<database id="0"><property-title name="Title">Project Brief</property-title><schema-property-title name="Milestone Name"/><schema-property-date name="Actual Due Date"/><schema-property-checkbox name="Billable"/><schema-property-number name="Budget" format="dollar"/><schema-property-phone-number name="Client Point of Contact"/><schema-property-status name="Client Review Status"><schema-option-category category="To-do"><schema-option option="Draft proposal"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit for approval"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Proposal approved"/></schema-option-category></schema-property-status><schema-property-date name="Due Date"/><schema-property-phone-number name="Manager Contact Number"/><schema-property-text name="Milestone Description"/><schema-property-multi-select name="Milestone Focus"><schema-option option="Development"/><schema-option option="UI/UX design"/><schema-option option="Web design"/></schema-property-multi-select><schema-property-text name="Milestone Notes"/><schema-property-status name="Milestone Status"><schema-option-category category="To-do"><schema-option option="Gather requirements"/><schema-option option="Meet with client"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit proposal"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Complete"/></schema-option-category></schema-property-status><schema-property-select name="Progress"><schema-option option="Delayed"/><schema-option option="On time"/><schema-option option="Blocked"/><schema-option option="Critical path"/></schema-property-select><schema-property-person name="Project Manager" limit="Infinity"/><schema-property-email name="Project Manager Email"/><schema-property-url name="Sign-off URL"/><schema-property-created-time name="Created On"/><schema-property-created-by name="Created by"/></database>',id:2},{id:3,type:"human",value:"<chat><text>What is the total budget of projects that are approved?</text></chat>"},{type:"assistant",id:4,value:"<think>The user is asking for the total budget of all milestones where 'Client Review Status' is 'Proposal approved'. I will query for milestones with a 'Client Review Status' of 'Proposal approved', and use a 'Sum' aggregation on 'Budget' to calculate the total budget amount.</think><query-database id=\"0\"><filter-property-status name=\"Client Review Status\" condition=\"is\"><option option=\"Proposal approved\"/></option></filter-property-status><aggregation-property-number name=\"Budget\" aggregation=\"Sum\"/></query-database>"},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="3" total-results="3"><child-page id="2" page-id="3" database-id="0"><property-title name="Milestone Name">Santa Barbara yacht club mobile app</property-title><property-date name="Actual Due Date"><mention-date-range start-date="2023-06-24" end-date="2023-07-03"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$54,653.00"/><property-phone-number name="Client Point of Contact">jdoe@companyabc.com</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-24" start-time="22:38" end-date="2023-07-04" end-time="05:21"/></property-date><property-phone-number name="Manager Contact Number">555-123-4567</property-phone-number><property-text name="Milestone Description">Complete initial research and client needs analysis</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Verify client vision and clarify objectives with STAT Consulting and Point of Contact</property-text><property-status name="Milestone Status"><option option="Submit proposal"/></property-status><property-select name="Progress"><option option="Critical path"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@statconsulting.com</property-email><property-url name="Sign-off URL">http://clients.statconsulting.com/project-sign-off/67891</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="5" page-id="6" database-id="0"><property-title name="Milestone Name">Black Diamond Resorts booking site</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-21"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$3,034.00"/><property-phone-number name="Client Point of Contact">Judith Williams, VP Marketing</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-26" end-date="2023-07-01"/></property-date><property-phone-number name="Manager Contact Number">(650)555-1234</property-phone-number><property-text name="Milestone Description">Complete draft initial designs</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Need client approval before proceeding to next phase. Meeting set for March 3 to review.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@designfirm.com</property-email><property-url name="Sign-off URL">https://designfirm.sharepoint.com/sites/ProjectBrief/Lists/Milestones/DispForm.aspx?ID=3</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="7" page-id="8" database-id="0"><property-title name="Milestone Name">XYZ Industry trade association portal</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="01:09" end-date="2023-06-29" end-time="02:11"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$60,136.00"/><property-phone-number name="Client Point of Contact">Sara Jones</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-date date="2023-07-03"/></property-date><property-phone-number name="Manager Contact Number">318-555-0199</property-phone-number><property-text name="Milestone Description">Complete preliminary analysis of focus group feedback and competitive landscape; summarize key findings in a brief executive summary.</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Client will provide relevant background documents before kickoff call on Monday. We have questions related to Questions 1, 3, and 4 in the focus group analysis based on the initial readout.</property-text><property-status name="Milestone Status"><option option="Meet with client"/></property-status><property-select name="Progress"><option option="Blocked"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">ksamuels@consultingfirm.com</property-email><property-url name="Sign-off URL">https://consultingfirm.app.box.com/s/lk1a2io3v6456789example</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><aggregation-result name="Budget" aggregation="Sum">117823</aggregation-result></query-database-results>',id:22},{type:"assistant",id:23,value:"<think>The query returned 3 milestones with a 'Client Review Status' of 'Proposal approved' and a total budget sum of $117,823.</think><chat><text>The total budget of projects that are approved is $117,823.</text></chat>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-08-03T12:24:48.144-04:00","current-person-id":"1","current-person-name":"Trixie"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<database id="0"><property-title name="Title">Project Brief</property-title><schema-property-title name="Milestone Name"/><schema-property-date name="Actual Due Date"/><schema-property-checkbox name="Billable"/><schema-property-number name="Budget" format="dollar"/><schema-property-phone-number name="Client Point of Contact"/><schema-property-status name="Client Review Status"><schema-option-category category="To-do"><schema-option option="Draft proposal"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit for approval"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Proposal approved"/></schema-option-category></schema-property-status><schema-property-date name="Due Date"/><schema-property-phone-number name="Manager Contact Number"/><schema-property-text name="Milestone Description"/><schema-property-multi-select name="Milestone Focus"><schema-option option="Development"/><schema-option option="UI/UX design"/><schema-option option="Web design"/></schema-property-multi-select><schema-property-text name="Milestone Notes"/><schema-property-status name="Milestone Status"><schema-option-category category="To-do"><schema-option option="Gather requirements"/><schema-option option="Meet with client"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit proposal"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Complete"/></schema-option-category></schema-property-status><schema-property-select name="Progress"><schema-option option="Delayed"/><schema-option option="On time"/><schema-option option="Blocked"/><schema-option option="Critical path"/></schema-property-select><schema-property-person name="Project Manager" limit="Infinity"/><schema-property-email name="Project Manager Email"/><schema-property-url name="Sign-off URL"/><schema-property-created-time name="Created On"/><schema-property-created-by name="Created by"/></database>',id:2},{id:3,type:"human",value:"<chat><text>What is the latest actual due date of all the milestones?</text></chat>"},{type:"assistant",id:5,value:'<think>The user is asking for the latest actual due date across all milestones. I will query the database using a \'Latest date\' aggregation on \'Actual Due Date\' to find the most recent date.</think><query-database id="0"><aggregation-property-date name="Actual Due Date" aggregation="Latest date"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="10" total-results="17"><child-page id="2" page-id="3" database-id="0"><property-title name="Milestone Name">Xstream Entertainment website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="23:04" end-date="2023-07-04" end-time="15:31"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$1,357.00"/><property-phone-number name="Client Point of Contact">Mark Thompson; mthompson@clientcompany.com; 555-123-4567</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date date="2023-06-25"/></property-date><property-phone-number name="Manager Contact Number">(408) 555-0100</property-phone-number><property-text name="Milestone Description">Complete build and QA of initial website prototype</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Ensure all UX elements align to approved design</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">john.smith@company.com</property-email><property-url name="Sign-off URL">https://projectmanagementtool.com/milestone/123/signoff</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="5" page-id="6" database-id="0"><property-title name="Milestone Name">Santa Barbara yacht club mobile app</property-title><property-date name="Actual Due Date"><mention-date-range start-date="2023-06-24" end-date="2023-07-03"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$54,653.00"/><property-phone-number name="Client Point of Contact">jdoe@companyabc.com</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-24" start-time="22:38" end-date="2023-07-04" end-time="05:21"/></property-date><property-phone-number name="Manager Contact Number">555-123-4567</property-phone-number><property-text name="Milestone Description">Complete initial research and client needs analysis</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Verify client vision and clarify objectives with STAT Consulting and Point of Contact</property-text><property-status name="Milestone Status"><option option="Submit proposal"/></property-status><property-select name="Progress"><option option="Critical path"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@statconsulting.com</property-email><property-url name="Sign-off URL">http://clients.statconsulting.com/project-sign-off/67891</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="7" page-id="8" database-id="0"><property-title name="Milestone Name">Transit Hub booking app</property-title><property-date name="Actual Due Date"><mention-datetime date="2023-06-21" time="12:39"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$17,232.00"/><property-phone-number name="Client Point of Contact">John Doe, CTO</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime date="2023-06-26" time="14:12"/></property-date><property-phone-number name="Manager Contact Number">415-555-0199</property-phone-number><property-text name="Milestone Description">Kickoff Meeting</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Discuss project scope, timeline, and key milestones. Get team buy-in and address any questions/concerns.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">pm@firmxy.com</property-email><property-url name="Sign-off URL">https://app.asana.com/0/0/11850179655912</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="9" page-id="10" database-id="0"><property-title name="Milestone Name">SGV National Bank banking app</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="07:54" end-date="2023-06-29" end-time="03:23"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$92,113.00"/><property-phone-number name="Client Point of Contact">Sandra Lee (Director of Marketing)</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-datetime date="2023-07-04" time="06:04"/></property-date><property-phone-number name="Manager Contact Number">(650)723-4567</property-phone-number><property-text name="Milestone Description">Deploy new e-commerce website</property-text><property-multi-select name="Milestone Focus"><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Client has requested some minor changes to the user interface. Need to incorporate revisions before launch.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Critical path"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jsmith@techagency.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/15MWjoKn3wQJ81SGzxh44_wF_OdoKbZEYv-PEZkmf8RU/edit?usp=sharing</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="11" page-id="12" database-id="0"><property-title name="Milestone Name">Black Diamond Resorts booking site</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-21"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$3,034.00"/><property-phone-number name="Client Point of Contact">Judith Williams, VP Marketing</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-26" end-date="2023-07-01"/></property-date><property-phone-number name="Manager Contact Number">(650)555-1234</property-phone-number><property-text name="Milestone Description">Complete draft initial designs</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Need client approval before proceeding to next phase. Meeting set for March 3 to review.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@designfirm.com</property-email><property-url name="Sign-off URL">https://designfirm.sharepoint.com/sites/ProjectBrief/Lists/Milestones/DispForm.aspx?ID=3</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="13" page-id="14" database-id="0"><property-title name="Milestone Name">Sequoia Hotel booking system</property-title><property-date name="Actual Due Date"><mention-datetime date="2023-06-29" time="09:34"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$92,514.00"/><property-phone-number name="Client Point of Contact">Jane Doe, CEO</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-22" end-date="2023-07-03"/></property-date><property-phone-number name="Manager Contact Number">555-123-4567</property-phone-number><property-text name="Milestone Description">Meet with client to discuss project scope and timeline.</property-text><property-multi-select name="Milestone Focus"><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Be prepared to discuss budget, priorities and resourcing. Get sign-off on project charter and schedule follow-up meeting.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pm@company.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/1a2b3c4d5/edit?usp=sharing</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="15" page-id="16" database-id="0"><property-title name="Milestone Name">Pandora Corp. ecommerce storefront</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-22"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$84,583.00"/><property-phone-number name="Client Point of Contact">Jane Doe, CEO</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-26" end-date="2023-07-01"/></property-date><property-phone-number name="Manager Contact Number">425-123-4567</property-phone-number><property-text name="Milestone Description">Complete user experience design.</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Finalize 4 user flows and 8 wireframes based on client feedback.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pmjones@company.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/1q2w3e4r5t6y7u8i9o0i/edit</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="17" page-id="18" database-id="0"><property-title name="Milestone Name">Eco Movement nonprofit website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-21" start-time="01:22" end-date="2023-07-03" end-time="20:55"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$40,956.00"/><property-phone-number name="Client Point of Contact">David Walsh</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime date="2023-07-02" time="13:57"/></property-date><property-phone-number name="Manager Contact Number">+14155551212</property-phone-number><property-text name="Milestone Description">Wireframes Approved</property-text><property-multi-select name="Milestone Focus"><option option="UI/UX design"/></property-multi-select><property-text name="Milestone Notes">Send wireframes for final approval before moving to visual designs. Client has requested an update to the mobile navigation. Be sure all pages have a mobile-first layout.</property-text><property-status name="Milestone Status"><option option="Meet with client"/></property-status><property-select name="Progress"><option option="Delayed"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">pm@agencyxyz.com</property-email><property-url name="Sign-off URL">https://approval.agencyxyz.com/project/123</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="19" page-id="20" database-id="0"><property-title name="Milestone Name">Peak Adventures mobile app</property-title><property-date name="Actual Due Date"><mention-date-range start-date="2023-06-23" end-date="2023-06-29"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$99,243.00"/><property-phone-number name="Client Point of Contact">Amy Smith</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-23" end-date="2023-06-28"/></property-date><property-phone-number name="Manager Contact Number">123-123-1234</property-phone-number><property-text name="Milestone Description">Initial Design Brief</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Review and approve initial user experience and mock designs.</property-text><property-status name="Milestone Status"><option option="Complete"/></property-status><property-select name="Progress"><option option="Delayed"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@firmaconsulting.com</property-email><property-url name="Sign-off URL">https://firmaconsulting.sharepoint.com/:f:/s/NewProject/EnhA4DkXvaJLil--LfIplIB9CpFW9heNiwZK9R6vzEeekg?e=GrXOtQ</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="21" page-id="22" database-id="0"><property-title name="Milestone Name">Simplicity Inc. website redesign</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-27"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$83,367.00"/><property-phone-number name="Client Point of Contact">Jenny Lee, VP Product</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-23" start-time="13:04" end-date="2023-07-04" end-time="10:19"/></property-date><property-phone-number name="Manager Contact Number">+14158552222</property-phone-number><property-text name="Milestone Description">Complete initial draft of user interface wireframes</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Please review the draft wireframes by Monday, Aug 22. John has already signed off on them.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Blocked"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jdoe@acmedesign.com</property-email><property-url name="Sign-off URL">https://projects.acmedesign.com/proj23/milestones/m1/review</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><aggregation-result name="Actual Due Date" aggregation="Latest date">2023-07-04T15:31:00.000-07:00</aggregation-result></query-database-results>',id:16},{type:"assistant",id:18,value:"<think>The query returned an aggregation result of 2023-07-04 for the latest actual due date across all milestones.</think><chat><text>The latest actual due date of all the milestones is 2023-07-04.</text></chat>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-08-03T12:26:22.221-04:00","current-person-id":"1","current-person-name":"Trixie"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<database id="0"><property-title name="Title">Project Brief</property-title><schema-property-title name="Milestone Name"/><schema-property-date name="Actual Due Date"/><schema-property-checkbox name="Billable"/><schema-property-number name="Budget" format="dollar"/><schema-property-phone-number name="Client Point of Contact"/><schema-property-status name="Client Review Status"><schema-option-category category="To-do"><schema-option option="Draft proposal"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit for approval"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Proposal approved"/></schema-option-category></schema-property-status><schema-property-date name="Due Date"/><schema-property-phone-number name="Manager Contact Number"/><schema-property-text name="Milestone Description"/><schema-property-multi-select name="Milestone Focus"><schema-option option="Development"/><schema-option option="UI/UX design"/><schema-option option="Web design"/></schema-property-multi-select><schema-property-text name="Milestone Notes"/><schema-property-status name="Milestone Status"><schema-option-category category="To-do"><schema-option option="Gather requirements"/><schema-option option="Meet with client"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit proposal"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Complete"/></schema-option-category></schema-property-status><schema-property-select name="Progress"><schema-option option="Delayed"/><schema-option option="On time"/><schema-option option="Blocked"/><schema-option option="Critical path"/></schema-property-select><schema-property-person name="Project Manager" limit="Infinity"/><schema-property-email name="Project Manager Email"/><schema-property-url name="Sign-off URL"/><schema-property-created-time name="Created On"/><schema-property-created-by name="Created by"/></database>',id:2},{id:3,type:"human",value:"<chat><text>How many unique project managers are assigned to blocked projects?</text></chat>"},{type:"assistant",id:4,value:'<think>The user is asking for the number of unique project managers assigned to blocked milestones. I will query for milestones where \'Progress\' is \'Blocked\', and use a \'Count unique values\' aggregation on \'Project Manager\' to count the distinct project managers.</think><query-database id="0"><filter-property-select name="Progress" condition="is"><option option="Blocked"/></option></filter-property-select><aggregation-property-person name="Project Manager" aggregation="Count unique values"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="6" total-results="6"><child-page id="2" page-id="3" database-id="0"><property-title name="Milestone Name">Cliff Edge Games website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="19:31" end-date="2023-07-02" end-time="03:32"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$5,305.00"/><property-phone-number name="Client Point of Contact">John Smith, CEO</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-25" start-time="08:04" end-date="2023-07-04" end-time="21:04"/></property-date><property-phone-number name="Manager Contact Number">+1 347-555-0103</property-phone-number><property-text name="Milestone Description">Discovery Phase: 1/1/20-1/15/20. Deliverables: Final Project Brief, Project Roadmap and Timeline, Client Consultation.</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Send reminders to team to complete tasks. Weekly update call with client.</property-text><property-status name="Milestone Status"><option option="Complete"/></property-status><property-select name="Progress"><option option="Blocked"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pm@acmeconsulting.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/1a2b3c4d5e6f7g8h9/view?usp=sharing</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="5" page-id="6" database-id="0"><property-title name="Milestone Name">MJB Boutique responsive website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="21:04" end-date="2023-07-01" end-time="08:11"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$44,519.00"/><property-phone-number name="Client Point of Contact">Jane Smith, Vice President of Marketing</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-25" start-time="09:25" end-date="2023-07-04" end-time="01:06"/></property-date><property-phone-number name="Manager Contact Number">+1 650-123-4567</property-phone-number><property-text name="Milestone Description">Complete user interviews</property-text><property-multi-select name="Milestone Focus"><option option="UI/UX design"/></property-multi-select><property-text name="Milestone Notes">Conduct 20-30 minute user interviews with 8 target users. Synthesize key findings in a report to share with the client.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Blocked"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">pm@designfirm.com</property-email><property-url name="Sign-off URL">https://example.signoff.com/projectbrief123</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="7" page-id="8" database-id="0"><property-title name="Milestone Name">Ethic CafÃ© marketing website</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-29"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$60,887.00"/><property-phone-number name="Client Point of Contact">Jane Smith</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-datetime date="2023-06-24" time="06:45"/></property-date><property-phone-number name="Manager Contact Number">(650) 555-0110</property-phone-number><property-text name="Milestone Description">Beta Release</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Check in with QA team on testing schedule. Work with design team to review UI updates. Meet with client to present beta release and get sign-off.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Blocked"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pm@companyname.com</property-email><property-url name="Sign-off URL">https://companywebsite.signofftool.com/beta_release_signoff</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="9" page-id="10" database-id="0"><property-title name="Milestone Name">XYZ Industry trade association portal</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="01:09" end-date="2023-06-29" end-time="02:11"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$60,136.00"/><property-phone-number name="Client Point of Contact">Sara Jones</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-date date="2023-07-03"/></property-date><property-phone-number name="Manager Contact Number">318-555-0199</property-phone-number><property-text name="Milestone Description">Complete preliminary analysis of focus group feedback and competitive landscape; summarize key findings in a brief executive summary.</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Client will provide relevant background documents before kickoff call on Monday. We have questions related to Questions 1, 3, and 4 in the focus group analysis based on the initial readout.</property-text><property-status name="Milestone Status"><option option="Meet with client"/></property-status><property-select name="Progress"><option option="Blocked"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">ksamuels@consultingfirm.com</property-email><property-url name="Sign-off URL">https://consultingfirm.app.box.com/s/lk1a2io3v6456789example</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="11" page-id="12" database-id="0"><property-title name="Milestone Name">Anthropic AI company website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-27" start-time="06:32" end-date="2023-07-03" end-time="23:42"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$5,132.00"/><property-phone-number name="Client Point of Contact">John Doe, Acme Inc.</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-25" end-date="2023-07-02"/></property-date><property-phone-number name="Manager Contact Number">650-555-0134</property-phone-number><property-text name="Milestone Description">Design mock-ups and wireframes</property-text><property-multi-select name="Milestone Focus"><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Review with client and make necessary refinements to the mock-ups.</property-text><property-status name="Milestone Status"><option option="Complete"/></property-status><property-select name="Progress"><option option="Blocked"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jhurt@acmeconsulting.com</property-email><property-url name="Sign-off URL">https://share.acmeconsulting.com/signoffs/project589</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="13" page-id="14" database-id="0"><property-title name="Milestone Name">Simplicity Inc. website redesign</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-27"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$83,367.00"/><property-phone-number name="Client Point of Contact">Jenny Lee, VP Product</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-23" start-time="13:04" end-date="2023-07-04" end-time="10:19"/></property-date><property-phone-number name="Manager Contact Number">+14158552222</property-phone-number><property-text name="Milestone Description">Complete initial draft of user interface wireframes</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Please review the draft wireframes by Monday, Aug 22. John has already signed off on them.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Blocked"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jdoe@acmedesign.com</property-email><property-url name="Sign-off URL">https://projects.acmedesign.com/proj23/milestones/m1/review</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><aggregation-result name="Project Manager" aggregation="Count unique values">1</aggregation-result></query-database-results>',id:23},{type:"assistant",id:25,value:"<think>The query returned 6 blocked milestones with 1 unique project manager.</think><chat><text>There is 1 unique project manager assigned to blocked projects.</text></chat>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-08-03T12:28:09.296-04:00","current-person-id":"1","current-person-name":"Trixie"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<database id="0"><property-title name="Title">Project Brief</property-title><schema-property-title name="Milestone Name"/><schema-property-date name="Actual Due Date"/><schema-property-checkbox name="Billable"/><schema-property-number name="Budget" format="dollar"/><schema-property-phone-number name="Client Point of Contact"/><schema-property-status name="Client Review Status"><schema-option-category category="To-do"><schema-option option="Draft proposal"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit for approval"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Proposal approved"/></schema-option-category></schema-property-status><schema-property-date name="Due Date"/><schema-property-phone-number name="Manager Contact Number"/><schema-property-text name="Milestone Description"/><schema-property-multi-select name="Milestone Focus"><schema-option option="Development"/><schema-option option="UI/UX design"/><schema-option option="Web design"/></schema-property-multi-select><schema-property-text name="Milestone Notes"/><schema-property-status name="Milestone Status"><schema-option-category category="To-do"><schema-option option="Gather requirements"/><schema-option option="Meet with client"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit proposal"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Complete"/></schema-option-category></schema-property-status><schema-property-select name="Progress"><schema-option option="Delayed"/><schema-option option="On time"/><schema-option option="Blocked"/><schema-option option="Critical path"/></schema-property-select><schema-property-person name="Project Manager" limit="Infinity"/><schema-property-email name="Project Manager Email"/><schema-property-url name="Sign-off URL"/><schema-property-created-time name="Created On"/><schema-property-created-by name="Created by"/></database>',id:2},{id:3,type:"human",value:"<chat><text>What percentage of milestones do not have a focus?</text></chat>"},{type:"assistant",id:4,value:"<think>The user is asking for the percentage of milestones that do not have a selected 'Milestone Focus'. I will query for all milestones and use a 'Percent empty' aggregation on 'Milestone Focus' to calculate the percentage where the multi-select is empty.</think><query-database id=\"0\"><aggregation-property-multi-select name=\"Milestone Focus\" aggregation=\"Percent empty\"/></query-database>"},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="10" total-results="17"><child-page id="2" page-id="3" database-id="0"><property-title name="Milestone Name">Xstream Entertainment website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="23:04" end-date="2023-07-04" end-time="15:31"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$1,357.00"/><property-phone-number name="Client Point of Contact">Mark Thompson; mthompson@clientcompany.com; 555-123-4567</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date date="2023-06-25"/></property-date><property-phone-number name="Manager Contact Number">(408) 555-0100</property-phone-number><property-text name="Milestone Description">Complete build and QA of initial website prototype</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Ensure all UX elements align to approved design</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">john.smith@company.com</property-email><property-url name="Sign-off URL">https://projectmanagementtool.com/milestone/123/signoff</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="5" page-id="6" database-id="0"><property-title name="Milestone Name">Santa Barbara yacht club mobile app</property-title><property-date name="Actual Due Date"><mention-date-range start-date="2023-06-24" end-date="2023-07-03"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$54,653.00"/><property-phone-number name="Client Point of Contact">jdoe@companyabc.com</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-24" start-time="22:38" end-date="2023-07-04" end-time="05:21"/></property-date><property-phone-number name="Manager Contact Number">555-123-4567</property-phone-number><property-text name="Milestone Description">Complete initial research and client needs analysis</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Verify client vision and clarify objectives with STAT Consulting and Point of Contact</property-text><property-status name="Milestone Status"><option option="Submit proposal"/></property-status><property-select name="Progress"><option option="Critical path"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@statconsulting.com</property-email><property-url name="Sign-off URL">http://clients.statconsulting.com/project-sign-off/67891</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="7" page-id="8" database-id="0"><property-title name="Milestone Name">Transit Hub booking app</property-title><property-date name="Actual Due Date"><mention-datetime date="2023-06-21" time="12:39"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$17,232.00"/><property-phone-number name="Client Point of Contact">John Doe, CTO</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime date="2023-06-26" time="14:12"/></property-date><property-phone-number name="Manager Contact Number">415-555-0199</property-phone-number><property-text name="Milestone Description">Kickoff Meeting</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Discuss project scope, timeline, and key milestones. Get team buy-in and address any questions/concerns.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">pm@firmxy.com</property-email><property-url name="Sign-off URL">https://app.asana.com/0/0/11850179655912</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="9" page-id="10" database-id="0"><property-title name="Milestone Name">SGV National Bank banking app</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="07:54" end-date="2023-06-29" end-time="03:23"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$92,113.00"/><property-phone-number name="Client Point of Contact">Sandra Lee (Director of Marketing)</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-datetime date="2023-07-04" time="06:04"/></property-date><property-phone-number name="Manager Contact Number">(650)723-4567</property-phone-number><property-text name="Milestone Description">Deploy new e-commerce website</property-text><property-multi-select name="Milestone Focus"><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Client has requested some minor changes to the user interface. Need to incorporate revisions before launch.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Critical path"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jsmith@techagency.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/15MWjoKn3wQJ81SGzxh44_wF_OdoKbZEYv-PEZkmf8RU/edit?usp=sharing</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="11" page-id="12" database-id="0"><property-title name="Milestone Name">Black Diamond Resorts booking site</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-21"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$3,034.00"/><property-phone-number name="Client Point of Contact">Judith Williams, VP Marketing</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-26" end-date="2023-07-01"/></property-date><property-phone-number name="Manager Contact Number">(650)555-1234</property-phone-number><property-text name="Milestone Description">Complete draft initial designs</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Need client approval before proceeding to next phase. Meeting set for March 3 to review.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@designfirm.com</property-email><property-url name="Sign-off URL">https://designfirm.sharepoint.com/sites/ProjectBrief/Lists/Milestones/DispForm.aspx?ID=3</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="13" page-id="14" database-id="0"><property-title name="Milestone Name">Sequoia Hotel booking system</property-title><property-date name="Actual Due Date"><mention-datetime date="2023-06-29" time="09:34"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$92,514.00"/><property-phone-number name="Client Point of Contact">Jane Doe, CEO</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-22" end-date="2023-07-03"/></property-date><property-phone-number name="Manager Contact Number">555-123-4567</property-phone-number><property-text name="Milestone Description">Meet with client to discuss project scope and timeline.</property-text><property-multi-select name="Milestone Focus"><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Be prepared to discuss budget, priorities and resourcing. Get sign-off on project charter and schedule follow-up meeting.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pm@company.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/1a2b3c4d5/edit?usp=sharing</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="15" page-id="16" database-id="0"><property-title name="Milestone Name">Pandora Corp. ecommerce storefront</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-22"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$84,583.00"/><property-phone-number name="Client Point of Contact">Jane Doe, CEO</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-26" end-date="2023-07-01"/></property-date><property-phone-number name="Manager Contact Number">425-123-4567</property-phone-number><property-text name="Milestone Description">Complete user experience design.</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Finalize 4 user flows and 8 wireframes based on client feedback.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pmjones@company.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/1q2w3e4r5t6y7u8i9o0i/edit</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="17" page-id="18" database-id="0"><property-title name="Milestone Name">Eco Movement nonprofit website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-21" start-time="01:22" end-date="2023-07-03" end-time="20:55"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$40,956.00"/><property-phone-number name="Client Point of Contact">David Walsh</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime date="2023-07-02" time="13:57"/></property-date><property-phone-number name="Manager Contact Number">+14155551212</property-phone-number><property-text name="Milestone Description">Wireframes Approved</property-text><property-multi-select name="Milestone Focus"><option option="UI/UX design"/></property-multi-select><property-text name="Milestone Notes">Send wireframes for final approval before moving to visual designs. Client has requested an update to the mobile navigation. Be sure all pages have a mobile-first layout.</property-text><property-status name="Milestone Status"><option option="Meet with client"/></property-status><property-select name="Progress"><option option="Delayed"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">pm@agencyxyz.com</property-email><property-url name="Sign-off URL">https://approval.agencyxyz.com/project/123</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="19" page-id="20" database-id="0"><property-title name="Milestone Name">Peak Adventures mobile app</property-title><property-date name="Actual Due Date"><mention-date-range start-date="2023-06-23" end-date="2023-06-29"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$99,243.00"/><property-phone-number name="Client Point of Contact">Amy Smith</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-23" end-date="2023-06-28"/></property-date><property-phone-number name="Manager Contact Number">123-123-1234</property-phone-number><property-text name="Milestone Description">Initial Design Brief</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Review and approve initial user experience and mock designs.</property-text><property-status name="Milestone Status"><option option="Complete"/></property-status><property-select name="Progress"><option option="Delayed"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@firmaconsulting.com</property-email><property-url name="Sign-off URL">https://firmaconsulting.sharepoint.com/:f:/s/NewProject/EnhA4DkXvaJLil--LfIplIB9CpFW9heNiwZK9R6vzEeekg?e=GrXOtQ</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="21" page-id="22" database-id="0"><property-title name="Milestone Name">Simplicity Inc. website redesign</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-27"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$83,367.00"/><property-phone-number name="Client Point of Contact">Jenny Lee, VP Product</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-23" start-time="13:04" end-date="2023-07-04" end-time="10:19"/></property-date><property-phone-number name="Manager Contact Number">+14158552222</property-phone-number><property-text name="Milestone Description">Complete initial draft of user interface wireframes</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Please review the draft wireframes by Monday, Aug 22. John has already signed off on them.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Blocked"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jdoe@acmedesign.com</property-email><property-url name="Sign-off URL">https://projects.acmedesign.com/proj23/milestones/m1/review</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><aggregation-result name="Milestone Focus" aggregation="Percent empty">0.23529411764705882</aggregation-result></query-database-results>',id:19},{type:"assistant",id:20,value:"<think>The query returned a percent empty of 23.53% for Milestone Focus across all milestones.</think><chat><text>23.53% of milestones do not have a focus.</text></chat>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-08-03T12:32:47.404-04:00","current-person-id":"1","current-person-name":"Trixie"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<database id="0"><property-title name="Title">Project Brief</property-title><schema-property-title name="Milestone Name"/><schema-property-date name="Actual Due Date"/><schema-property-checkbox name="Billable"/><schema-property-number name="Budget" format="dollar"/><schema-property-phone-number name="Client Point of Contact"/><schema-property-status name="Client Review Status"><schema-option-category category="To-do"><schema-option option="Draft proposal"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit for approval"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Proposal approved"/></schema-option-category></schema-property-status><schema-property-date name="Due Date"/><schema-property-phone-number name="Manager Contact Number"/><schema-property-text name="Milestone Description"/><schema-property-multi-select name="Milestone Focus"><schema-option option="Development"/><schema-option option="UI/UX design"/><schema-option option="Web design"/></schema-property-multi-select><schema-property-text name="Milestone Notes"/><schema-property-status name="Milestone Status"><schema-option-category category="To-do"><schema-option option="Gather requirements"/><schema-option option="Meet with client"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit proposal"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Complete"/></schema-option-category></schema-property-status><schema-property-select name="Progress"><schema-option option="Delayed"/><schema-option option="On time"/><schema-option option="Blocked"/><schema-option option="Critical path"/></schema-property-select><schema-property-person name="Project Manager" limit="Infinity"/><schema-property-email name="Project Manager Email"/><schema-property-url name="Sign-off URL"/><schema-property-created-time name="Created On"/><schema-property-created-by name="Created by"/></database>',id:2},{id:3,type:"human",value:"<chat><text>How many days have we spent across all milestones?</text></chat>"},{type:"assistant",id:4,value:'<think>The user is asking for the total number of days we have spent across all milestones. I will query for all milestones and use a \'Date range\' aggregation on \'Actual Due Date\' to calculate the difference between the earliest and latest dates.</think><query-database id="0"><aggregation-property-date name="Actual Due Date" aggregation="Date range"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="10" total-results="17"><child-page id="2" page-id="3" database-id="0"><property-title name="Milestone Name">Xstream Entertainment website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="23:04" end-date="2023-07-04" end-time="15:31"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$1,357.00"/><property-phone-number name="Client Point of Contact">Mark Thompson; mthompson@clientcompany.com; 555-123-4567</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date date="2023-06-25"/></property-date><property-phone-number name="Manager Contact Number">(408) 555-0100</property-phone-number><property-text name="Milestone Description">Complete build and QA of initial website prototype</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Ensure all UX elements align to approved design</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">john.smith@company.com</property-email><property-url name="Sign-off URL">https://projectmanagementtool.com/milestone/123/signoff</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="5" page-id="6" database-id="0"><property-title name="Milestone Name">Santa Barbara yacht club mobile app</property-title><property-date name="Actual Due Date"><mention-date-range start-date="2023-06-24" end-date="2023-07-03"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$54,653.00"/><property-phone-number name="Client Point of Contact">jdoe@companyabc.com</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-24" start-time="22:38" end-date="2023-07-04" end-time="05:21"/></property-date><property-phone-number name="Manager Contact Number">555-123-4567</property-phone-number><property-text name="Milestone Description">Complete initial research and client needs analysis</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Verify client vision and clarify objectives with STAT Consulting and Point of Contact</property-text><property-status name="Milestone Status"><option option="Submit proposal"/></property-status><property-select name="Progress"><option option="Critical path"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@statconsulting.com</property-email><property-url name="Sign-off URL">http://clients.statconsulting.com/project-sign-off/67891</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="7" page-id="8" database-id="0"><property-title name="Milestone Name">Transit Hub booking app</property-title><property-date name="Actual Due Date"><mention-datetime date="2023-06-21" time="12:39"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$17,232.00"/><property-phone-number name="Client Point of Contact">John Doe, CTO</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime date="2023-06-26" time="14:12"/></property-date><property-phone-number name="Manager Contact Number">415-555-0199</property-phone-number><property-text name="Milestone Description">Kickoff Meeting</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Discuss project scope, timeline, and key milestones. Get team buy-in and address any questions/concerns.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">pm@firmxy.com</property-email><property-url name="Sign-off URL">https://app.asana.com/0/0/11850179655912</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="9" page-id="10" database-id="0"><property-title name="Milestone Name">SGV National Bank banking app</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="07:54" end-date="2023-06-29" end-time="03:23"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$92,113.00"/><property-phone-number name="Client Point of Contact">Sandra Lee (Director of Marketing)</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-datetime date="2023-07-04" time="06:04"/></property-date><property-phone-number name="Manager Contact Number">(650)723-4567</property-phone-number><property-text name="Milestone Description">Deploy new e-commerce website</property-text><property-multi-select name="Milestone Focus"><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Client has requested some minor changes to the user interface. Need to incorporate revisions before launch.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Critical path"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jsmith@techagency.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/15MWjoKn3wQJ81SGzxh44_wF_OdoKbZEYv-PEZkmf8RU/edit?usp=sharing</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="11" page-id="12" database-id="0"><property-title name="Milestone Name">Black Diamond Resorts booking site</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-21"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$3,034.00"/><property-phone-number name="Client Point of Contact">Judith Williams, VP Marketing</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-26" end-date="2023-07-01"/></property-date><property-phone-number name="Manager Contact Number">(650)555-1234</property-phone-number><property-text name="Milestone Description">Complete draft initial designs</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Need client approval before proceeding to next phase. Meeting set for March 3 to review.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@designfirm.com</property-email><property-url name="Sign-off URL">https://designfirm.sharepoint.com/sites/ProjectBrief/Lists/Milestones/DispForm.aspx?ID=3</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="13" page-id="14" database-id="0"><property-title name="Milestone Name">Sequoia Hotel booking system</property-title><property-date name="Actual Due Date"><mention-datetime date="2023-06-29" time="09:34"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$92,514.00"/><property-phone-number name="Client Point of Contact">Jane Doe, CEO</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-22" end-date="2023-07-03"/></property-date><property-phone-number name="Manager Contact Number">555-123-4567</property-phone-number><property-text name="Milestone Description">Meet with client to discuss project scope and timeline.</property-text><property-multi-select name="Milestone Focus"><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Be prepared to discuss budget, priorities and resourcing. Get sign-off on project charter and schedule follow-up meeting.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pm@company.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/1a2b3c4d5/edit?usp=sharing</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="15" page-id="16" database-id="0"><property-title name="Milestone Name">Pandora Corp. ecommerce storefront</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-22"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$84,583.00"/><property-phone-number name="Client Point of Contact">Jane Doe, CEO</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-26" end-date="2023-07-01"/></property-date><property-phone-number name="Manager Contact Number">425-123-4567</property-phone-number><property-text name="Milestone Description">Complete user experience design.</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Finalize 4 user flows and 8 wireframes based on client feedback.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pmjones@company.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/1q2w3e4r5t6y7u8i9o0i/edit</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="17" page-id="18" database-id="0"><property-title name="Milestone Name">Eco Movement nonprofit website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-21" start-time="01:22" end-date="2023-07-03" end-time="20:55"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$40,956.00"/><property-phone-number name="Client Point of Contact">David Walsh</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime date="2023-07-02" time="13:57"/></property-date><property-phone-number name="Manager Contact Number">+14155551212</property-phone-number><property-text name="Milestone Description">Wireframes Approved</property-text><property-multi-select name="Milestone Focus"><option option="UI/UX design"/></property-multi-select><property-text name="Milestone Notes">Send wireframes for final approval before moving to visual designs. Client has requested an update to the mobile navigation. Be sure all pages have a mobile-first layout.</property-text><property-status name="Milestone Status"><option option="Meet with client"/></property-status><property-select name="Progress"><option option="Delayed"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">pm@agencyxyz.com</property-email><property-url name="Sign-off URL">https://approval.agencyxyz.com/project/123</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="19" page-id="20" database-id="0"><property-title name="Milestone Name">Peak Adventures mobile app</property-title><property-date name="Actual Due Date"><mention-date-range start-date="2023-06-23" end-date="2023-06-29"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$99,243.00"/><property-phone-number name="Client Point of Contact">Amy Smith</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-23" end-date="2023-06-28"/></property-date><property-phone-number name="Manager Contact Number">123-123-1234</property-phone-number><property-text name="Milestone Description">Initial Design Brief</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Review and approve initial user experience and mock designs.</property-text><property-status name="Milestone Status"><option option="Complete"/></property-status><property-select name="Progress"><option option="Delayed"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@firmaconsulting.com</property-email><property-url name="Sign-off URL">https://firmaconsulting.sharepoint.com/:f:/s/NewProject/EnhA4DkXvaJLil--LfIplIB9CpFW9heNiwZK9R6vzEeekg?e=GrXOtQ</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="21" page-id="22" database-id="0"><property-title name="Milestone Name">Simplicity Inc. website redesign</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-27"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$83,367.00"/><property-phone-number name="Client Point of Contact">Jenny Lee, VP Product</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-23" start-time="13:04" end-date="2023-07-04" end-time="10:19"/></property-date><property-phone-number name="Manager Contact Number">+14158552222</property-phone-number><property-text name="Milestone Description">Complete initial draft of user interface wireframes</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Please review the draft wireframes by Monday, Aug 22. John has already signed off on them.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Blocked"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jdoe@acmedesign.com</property-email><property-url name="Sign-off URL">https://projects.acmedesign.com/proj23/milestones/m1/review</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><aggregation-result name="Actual Due Date" aggregation="Date range">2023-06-21T00:00:00.000-04:00/2023-07-04T18:31:00.000-04:00</aggregation-result></query-database-results>',id:22},{type:"assistant",id:23,value:"<think>The query returned an actual due date range from 2023-06-21 to 2023-07-04, which is a duration of 13 days.</think><chat><text>We have spent 13 days across all milestones.</text></chat>"}],[{id:0,type:"context",context:{mode:"direct","available-commands":["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],"current-page-id":"0","current-datetime":"2023-08-03T12:34:22.705-04:00","current-person-id":"1","current-person-name":"Trixie"}},{id:1,type:"assistant",value:'<load-page id="0"/>'},{type:"observation",observationType:"page",pageId:"0",value:'<database id="0"><property-title name="Title">Project Brief</property-title><schema-property-title name="Milestone Name"/><schema-property-date name="Actual Due Date"/><schema-property-checkbox name="Billable"/><schema-property-number name="Budget" format="dollar"/><schema-property-phone-number name="Client Point of Contact"/><schema-property-status name="Client Review Status"><schema-option-category category="To-do"><schema-option option="Draft proposal"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit for approval"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Proposal approved"/></schema-option-category></schema-property-status><schema-property-date name="Due Date"/><schema-property-phone-number name="Manager Contact Number"/><schema-property-text name="Milestone Description"/><schema-property-multi-select name="Milestone Focus"><schema-option option="Development"/><schema-option option="UI/UX design"/><schema-option option="Web design"/></schema-property-multi-select><schema-property-text name="Milestone Notes"/><schema-property-status name="Milestone Status"><schema-option-category category="To-do"><schema-option option="Gather requirements"/><schema-option option="Meet with client"/></schema-option-category><schema-option-category category="In progress"><schema-option option="Submit proposal"/></schema-option-category><schema-option-category category="Complete"><schema-option option="Complete"/></schema-option-category></schema-property-status><schema-property-select name="Progress"><schema-option option="Delayed"/><schema-option option="On time"/><schema-option option="Blocked"/><schema-option option="Critical path"/></schema-property-select><schema-property-person name="Project Manager" limit="Infinity"/><schema-property-email name="Project Manager Email"/><schema-property-url name="Sign-off URL"/><schema-property-created-time name="Created On"/><schema-property-created-by name="Created by"/></database>',id:2},{id:3,type:"human",value:"<chat><text>What is the difference between our highest budget client and our lowest budget client?</text></chat>"},{type:"assistant",id:4,value:'<think>The user is asking for the difference between the highest and lowest budget values across all milestones. I will query for all milestones and use a \'Range\' aggregation on \'Budget\' to find the maximum and minimum budget amounts, then calculate the difference.</think><query-database id="0"><aggregation-property-number name="Budget" aggregation="Range"/></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="10" total-results="17"><child-page id="2" page-id="3" database-id="0"><property-title name="Milestone Name">Xstream Entertainment website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="23:04" end-date="2023-07-04" end-time="15:31"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$1,357.00"/><property-phone-number name="Client Point of Contact">Mark Thompson; mthompson@clientcompany.com; 555-123-4567</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date date="2023-06-25"/></property-date><property-phone-number name="Manager Contact Number">(408) 555-0100</property-phone-number><property-text name="Milestone Description">Complete build and QA of initial website prototype</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Ensure all UX elements align to approved design</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">john.smith@company.com</property-email><property-url name="Sign-off URL">https://projectmanagementtool.com/milestone/123/signoff</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="5" page-id="6" database-id="0"><property-title name="Milestone Name">Santa Barbara yacht club mobile app</property-title><property-date name="Actual Due Date"><mention-date-range start-date="2023-06-24" end-date="2023-07-03"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$54,653.00"/><property-phone-number name="Client Point of Contact">jdoe@companyabc.com</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-24" start-time="22:38" end-date="2023-07-04" end-time="05:21"/></property-date><property-phone-number name="Manager Contact Number">555-123-4567</property-phone-number><property-text name="Milestone Description">Complete initial research and client needs analysis</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Verify client vision and clarify objectives with STAT Consulting and Point of Contact</property-text><property-status name="Milestone Status"><option option="Submit proposal"/></property-status><property-select name="Progress"><option option="Critical path"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@statconsulting.com</property-email><property-url name="Sign-off URL">http://clients.statconsulting.com/project-sign-off/67891</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="7" page-id="8" database-id="0"><property-title name="Milestone Name">Transit Hub booking app</property-title><property-date name="Actual Due Date"><mention-datetime date="2023-06-21" time="12:39"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$17,232.00"/><property-phone-number name="Client Point of Contact">John Doe, CTO</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime date="2023-06-26" time="14:12"/></property-date><property-phone-number name="Manager Contact Number">415-555-0199</property-phone-number><property-text name="Milestone Description">Kickoff Meeting</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Discuss project scope, timeline, and key milestones. Get team buy-in and address any questions/concerns.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">pm@firmxy.com</property-email><property-url name="Sign-off URL">https://app.asana.com/0/0/11850179655912</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="9" page-id="10" database-id="0"><property-title name="Milestone Name">SGV National Bank banking app</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-25" start-time="07:54" end-date="2023-06-29" end-time="03:23"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$92,113.00"/><property-phone-number name="Client Point of Contact">Sandra Lee (Director of Marketing)</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-datetime date="2023-07-04" time="06:04"/></property-date><property-phone-number name="Manager Contact Number">(650)723-4567</property-phone-number><property-text name="Milestone Description">Deploy new e-commerce website</property-text><property-multi-select name="Milestone Focus"><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Client has requested some minor changes to the user interface. Need to incorporate revisions before launch.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Critical path"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jsmith@techagency.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/15MWjoKn3wQJ81SGzxh44_wF_OdoKbZEYv-PEZkmf8RU/edit?usp=sharing</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="11" page-id="12" database-id="0"><property-title name="Milestone Name">Black Diamond Resorts booking site</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-21"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$3,034.00"/><property-phone-number name="Client Point of Contact">Judith Williams, VP Marketing</property-phone-number><property-status name="Client Review Status"><option option="Proposal approved"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-26" end-date="2023-07-01"/></property-date><property-phone-number name="Manager Contact Number">(650)555-1234</property-phone-number><property-text name="Milestone Description">Complete draft initial designs</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Need client approval before proceeding to next phase. Meeting set for March 3 to review.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@designfirm.com</property-email><property-url name="Sign-off URL">https://designfirm.sharepoint.com/sites/ProjectBrief/Lists/Milestones/DispForm.aspx?ID=3</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="13" page-id="14" database-id="0"><property-title name="Milestone Name">Sequoia Hotel booking system</property-title><property-date name="Actual Due Date"><mention-datetime date="2023-06-29" time="09:34"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$92,514.00"/><property-phone-number name="Client Point of Contact">Jane Doe, CEO</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-22" end-date="2023-07-03"/></property-date><property-phone-number name="Manager Contact Number">555-123-4567</property-phone-number><property-text name="Milestone Description">Meet with client to discuss project scope and timeline.</property-text><property-multi-select name="Milestone Focus"><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Be prepared to discuss budget, priorities and resourcing. Get sign-off on project charter and schedule follow-up meeting.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pm@company.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/1a2b3c4d5/edit?usp=sharing</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="15" page-id="16" database-id="0"><property-title name="Milestone Name">Pandora Corp. ecommerce storefront</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-22"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$84,583.00"/><property-phone-number name="Client Point of Contact">Jane Doe, CEO</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-26" end-date="2023-07-01"/></property-date><property-phone-number name="Manager Contact Number">425-123-4567</property-phone-number><property-text name="Milestone Description">Complete user experience design.</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Finalize 4 user flows and 8 wireframes based on client feedback.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="On time"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">pmjones@company.com</property-email><property-url name="Sign-off URL">https://docs.google.com/document/d/1q2w3e4r5t6y7u8i9o0i/edit</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="17" page-id="18" database-id="0"><property-title name="Milestone Name">Eco Movement nonprofit website</property-title><property-date name="Actual Due Date"><mention-datetime-range start-date="2023-06-21" start-time="01:22" end-date="2023-07-03" end-time="20:55"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$40,956.00"/><property-phone-number name="Client Point of Contact">David Walsh</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime date="2023-07-02" time="13:57"/></property-date><property-phone-number name="Manager Contact Number">+14155551212</property-phone-number><property-text name="Milestone Description">Wireframes Approved</property-text><property-multi-select name="Milestone Focus"><option option="UI/UX design"/></property-multi-select><property-text name="Milestone Notes">Send wireframes for final approval before moving to visual designs. Client has requested an update to the mobile navigation. Be sure all pages have a mobile-first layout.</property-text><property-status name="Milestone Status"><option option="Meet with client"/></property-status><property-select name="Progress"><option option="Delayed"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">pm@agencyxyz.com</property-email><property-url name="Sign-off URL">https://approval.agencyxyz.com/project/123</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="19" page-id="20" database-id="0"><property-title name="Milestone Name">Peak Adventures mobile app</property-title><property-date name="Actual Due Date"><mention-date-range start-date="2023-06-23" end-date="2023-06-29"/></property-date><property-checkbox name="Billable" checked="false"/><property-number name="Budget" number="$99,243.00"/><property-phone-number name="Client Point of Contact">Amy Smith</property-phone-number><property-status name="Client Review Status"><option option="Draft proposal"/></property-status><property-date name="Due Date"><mention-date-range start-date="2023-06-23" end-date="2023-06-28"/></property-date><property-phone-number name="Manager Contact Number">123-123-1234</property-phone-number><property-text name="Milestone Description">Initial Design Brief</property-text><property-multi-select name="Milestone Focus"><option option="Development"/><option option="UI/UX design"/><option option="Web design"/></property-multi-select><property-text name="Milestone Notes">Review and approve initial user experience and mock designs.</property-text><property-status name="Milestone Status"><option option="Complete"/></property-status><property-select name="Progress"><option option="Delayed"/></property-select><property-person name="Project Manager"><mention-person person-id="4" person-name="Trixie"/></property-person><property-email name="Project Manager Email">jsmith@firmaconsulting.com</property-email><property-url name="Sign-off URL">https://firmaconsulting.sharepoint.com/:f:/s/NewProject/EnhA4DkXvaJLil--LfIplIB9CpFW9heNiwZK9R6vzEeekg?e=GrXOtQ</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><child-page id="21" page-id="22" database-id="0"><property-title name="Milestone Name">Simplicity Inc. website redesign</property-title><property-date name="Actual Due Date"><mention-date date="2023-06-27"/></property-date><property-checkbox name="Billable" checked="true"/><property-number name="Budget" number="$83,367.00"/><property-phone-number name="Client Point of Contact">Jenny Lee, VP Product</property-phone-number><property-status name="Client Review Status"><option option="Submit for approval"/></property-status><property-date name="Due Date"><mention-datetime-range start-date="2023-06-23" start-time="13:04" end-date="2023-07-04" end-time="10:19"/></property-date><property-phone-number name="Manager Contact Number">+14158552222</property-phone-number><property-text name="Milestone Description">Complete initial draft of user interface wireframes</property-text><property-multi-select name="Milestone Focus"/><property-text name="Milestone Notes">Please review the draft wireframes by Monday, Aug 22. John has already signed off on them.</property-text><property-status name="Milestone Status"><option option="Gather requirements"/></property-status><property-select name="Progress"><option option="Blocked"/></property-select><property-person name="Project Manager"/><property-email name="Project Manager Email">jdoe@acmedesign.com</property-email><property-url name="Sign-off URL">https://projects.acmedesign.com/proj23/milestones/m1/review</property-url><property-created-time name="Created On"><mention-datetime date="2023-08-02" time="16:26"/></property-created-time><property-created-by name="Created by"><mention-person person-id="4" person-name="Trixie"/></property-created-by></child-page><aggregation-result name="Budget" aggregation="Range">97886</aggregation-result></query-database-results>',id:19},{type:"assistant",id:20,value:"<think>The query returned a budget range of $97,886, with a minimum of $1,357 and a maximum of $99,243. The difference between the highest and lowest budgets is therefore $99,243 - $1,357 = $97,886.</think><chat><text>The difference between our highest budget client ($99,243) and lowest budget client ($1,357) is $97,886.</text></chat>"}]];var Je=o(39040);function Xe(e){const{type:t,transcript:o}=e;let n;return n="page-editing-global"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.pageEditing,fe.chainOfThought].filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:_e,forcePrefix:"<think>"}}({transcript:o}):"page-editing-cursor"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.pageEditing,fe.selections,fe.chainOfThought].filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:we,forcePrefix:"<think>"}}({transcript:o}):"page-editing-block-selection"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.pageEditing,fe.selections,fe.chainOfThought].filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:xe,forcePrefix:"<think>"}}({transcript:o}):"page-editing-text-selection"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.pageEditing,fe.selections,fe.chainOfThought].filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:ke,forcePrefix:"<think>"}}({transcript:o}):"single-page-qa"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.chat,fe.chainOfThought].filter(Boolean).join("\n\n"),transcript:t,forcePrefix:"<think>",exampleTranscripts:Ie}}({transcript:o}):"search-qa"===t||"search-qa-no-relevant-information"===t||"search-qa-no-exact-answer"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.search,fe.chat,fe.questionAnswering,fe.citations,fe.chainOfThought,fe.languageFollowing].filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Te,forcePrefix:"<think>"}}({transcript:o}):"search-edit"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.pageEditing,fe.search,fe.chainOfThought].filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Me,forcePrefix:"<think>"}}({transcript:o}):"database-qa-search"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Ae,forcePrefix:"<think>"}}({transcript:o}):"database-qa-search-text"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Pe,forcePrefix:"<think>"}}({transcript:o}):"database-qa-select"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:De,forcePrefix:"<think>"}}({transcript:o}):"database-qa-date"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Be,forcePrefix:"<think>"}}({transcript:o}):"database-qa-relations"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Re,forcePrefix:"<think>"}}({transcript:o}):"database-set-property-relations"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Ee,forcePrefix:"<think>"}}({transcript:o}):"database-qa-multi-select"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:De,forcePrefix:"<think>"}}({transcript:o}):"database-qa-status"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Fe,forcePrefix:"<think>"}}({transcript:o}):"database-qa-person"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Ne,forcePrefix:"<think>"}}({transcript:o}):"database-qa-checkbox"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:je,forcePrefix:"<think>"}}({transcript:o}):"database-qa-number"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Oe,forcePrefix:"<think>"}}({transcript:o}):"database-qa-sort"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Le,forcePrefix:"<think>"}}({transcript:o}):"database-create-page"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Ue,forcePrefix:"<think>"}}({transcript:o}):"page-editing-tables"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.tables,fe.chainOfThought].filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:He,forcePrefix:"<think>"}}({transcript:o}):"page-editing-empty-page-no-search"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.pageEditing,fe.chainOfThought].filter(Boolean).join("\n\n"),transcript:t,forcePrefix:"<think>",exampleTranscripts:Ge}}({transcript:o}):"page-editing-empty-page-search"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.pageEditing,fe.search,fe.chainOfThought].filter(Boolean).join("\n\n"),transcript:t,forcePrefix:"<think>",exampleTranscripts:Ke}}({transcript:o}):"page-instructions-qa-database"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.queryDatabase,fe.databaseNewPage,fe.loadingPages,fe.questionAnswering,fe.citations,fe.instructionsPages,fe.contextMode,fe.chainOfThought,fe.languageFollowing].filter(Boolean).join("\n\n"),transcript:t,forcePrefix:"<think>",exampleTranscripts:We}}({transcript:o}):"page-instructions-feedback-database"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.queryDatabase,fe.databaseNewPage,fe.loadingPages,fe.questionAnswering,fe.citations,fe.instructionsPages,fe.contextMode,fe.chainOfThought,fe.languageFollowing].filter(Boolean).join("\n\n"),transcript:t,forcePrefix:"<think>",exampleTranscripts:ze}}({transcript:o}):"page-instructions-task-database"===t?function(e){const{transcript:t}=e;return{systemInstructions:[...ve(),fe.instructionsPages,fe.contextMode].filter(Boolean).join("\n\n"),transcript:t,forcePrefix:"<think>",exampleTranscripts:Ze}}({transcript:o}):"database-editing-set-property"===t?function(e){const{transcript:t}=e;return{systemInstructions:ve().filter(Boolean).join("\n\n"),transcript:t,forcePrefix:"<think>",exampleTranscripts:qe}}({transcript:o}):"custom-database-page-instructions"===t?function(e){const{transcript:t}=e;return{systemInstructions:[...ve(),fe.instructionsPages,fe.contextMode].filter(Boolean).join("\n\n"),transcript:t,forcePrefix:"<think>",exampleTranscripts:qe}}({transcript:o}):"custom-database-page-instructions-slackbot"===t?function(e){const{transcript:t}=e;return{systemInstructions:[...ve(),fe.instructionsPages,fe.contextMode].filter(Boolean).join("\n\n"),transcript:t,forcePrefix:"<think>",exampleTranscripts:Ve}}({transcript:o}):"page-editing-colors"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.pageEditing,fe.chainOfThought].filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:$e,forcePrefix:"<think>"}}({transcript:o}):"#security-questionnaire"===t?{transcript:o,exampleTranscripts:be,forcePrefix:"<think>"}:"#eng-team"===t?{transcript:o,exampleTranscripts:Se,forcePrefix:"<think>"}:"page-editing-synced-blocks"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.pageEditing,fe.chainOfThought].filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Ye,forcePrefix:"<think>"}}({transcript:o}):"database-aggregation-query"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.properties,fe.queryDatabase,fe.questionAnswering,fe.chainOfThought,fe.contextMode,fe.chainOfThought,fe.languageFollowing].filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:Qe,forcePrefix:"<think>"}}({transcript:o}):"slackbot-search-qa"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.search,fe.chat,fe.questionAnswering,fe.citations,fe.instructionsPages,fe.contextMode,fe.chainOfThought,fe.languageFollowing].filter(Boolean).join("\n\n"),transcript:t,exampleTranscripts:[],forcePrefix:"<think>"}}({transcript:o}):"page-no-skill"===t||"database-page-no-skill"===t||"database-no-skill"===t||"page-with-databases-no-skill"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.defaultActionRouting,fe.languageFollowing,fe.chainOfThought,fe.contextMode].filter(Boolean).join("\n\n"),transcript:t,forcePrefix:"<think>"}}({transcript:o}):"page-custom-skill"===t||"database-page-custom-skill"===t||"database-custom-skill"===t||"page-with-databases-custom-skill"===t||"slack-database-custom-skill"===t||"slack-page-with-databases-custom-skill"===t?function(e){const{transcript:t}=e;return{systemInstructions:[fe.bio,fe.hallucinations,fe.languageFollowing,fe.chainOfThought,fe.contextMode,fe.instructionsPages].filter(Boolean).join("\n\n"),transcript:t,forcePrefix:"<think>"}}({transcript:o}):function(e){const{transcript:t}=e;return{transcript:t,forcePrefix:"<think>"}}({transcript:o}),n}function et(e){const{transcript:t}=e;let o=t.map((e=>"context"!==e.type?{...e,value:(0,s.k5)(e.value)}:e));return o=l.oA(o.map((e=>{if("context"===e.type)return{...e,context:{mode:"direct","available-commands":m.DA,"current-datetime":e.context["current-datetime"]}};if("human"===e.type){const[t]=(0,Je.P)(e.value);if(!t||"element"!==t.type||"chat"!==t.tagName)throw new Error("Invalid humanStepParsed.");delete t.attributes;const o=(0,m.KT)(t);return{...e,value:o}}if("observation"===e.type&&"search"===e.observationType){var t;const[o]=(0,Je.P)(e.value);if(!o||"element"!==o.type||"search-results"!==o.tagName)throw new Error("Invalid search results.");o.children=l.oA(null===(t=o.children)||void 0===t?void 0:t.map((e=>{var t,o,n,r;if(e&&"element"===e.type&&"page-result"===e.tagName)return{...e,attributes:{id:null===(t=e.attributes)||void 0===t?void 0:t.id,title:null===(o=e.attributes)||void 0===o?void 0:o.title,path:null===(n=e.attributes)||void 0===n?void 0:n.path,"last-edited-datetime":null===(r=e.attributes)||void 0===r?void 0:r["last-edited-datetime"]}}})));const n=(0,m.KT)(o);return{...e,value:n}}return"assistant"===e.type&&(e.value.includes("<search")||e.value.includes("<chat"))?e:void 0}))),{systemInstructions:void 0,transcript:o,exampleTranscripts:[]}}function tt(e){const{transcript:t}=e;return{systemInstructions:ye,transcript:t,exampleTranscripts:[]}}function ot(e){const{rendered:t,transcript:o}=e,n=rt(o);return{transcript:[...o,...n?[n]:[]],exampleTranscripts:t.exampleTranscripts,forcePrefix:"<think>"}}function nt(e){const{transcript:t}=e;return t.map((e=>("assistant"===e.type&&(e.value=e.value.replace(/<think>(.*?)<\/think>/g,"")),e)))}function rt(e){const t=e.find((e=>"observation"===e.type&&"instructionsPage"===e.observationType)),o=function(e){if(!e)return;const[t]=(0,Je.P)(e);if(!t||"element"!==t.type||"instructions-page"!==t.tagName)return;return(0,m.KT)(t)}(null==t?void 0:t.value);if(o)return{id:e.length,type:"human",value:o}}function it(e,t){let o="<context ";const n=Object.keys(e).sort();for(const r of n){if("available-commands"===r&&null!=t&&t.hideAvailableCommands)continue;const n=e[r];if("string"==typeof n)o+=`${r}="${n}" `;else{if(!Array.isArray(n)){const e=JSON.stringify(n,null,2);throw new Error(`Unknown value type, ${r}: ${e}`)}o+=`${r}="${n.join(",")}" `}}return`${o.trim()}/>`}function at(e,t){let o=e.map((e=>{if("context"===e.type)return{type:"human",value:it(e.context,t)};if("human"===e.type)return{type:"human",value:e.value.trim()};if("observation"!==e.type){if("assistant"===e.type)return{type:"assistant",value:e.value.trim()};throw new Error("Unknown step type")}return"page"===e.observationType||"search"===e.observationType||"queryDatabase"===e.observationType||"searchPeople"===e.observationType||"instructionsPage"===e.observationType?{type:"stdout",value:e.value.trim()}:"error"===e.observationType?{type:"stderr",value:e.value.trim()}:void(0,u.t1)(e)}));if(o=o.reduce(((e,t)=>{if("stdout"===t.type){const o=e[e.length-1];if(o&&"stdout"===o.type)return o.value+=`\n${t.value}`,e}if("stderr"===t.type){const o=e[e.length-1];if(o&&"stderr"===o.type)return o.value+=`\n${t.value}`,e}return[...e,t]}),[]),null!=t&&t.consumeTokens){const e=t.consumeTokens;o=o.reverse().map((t=>"human"===t.type?{...t,value:e(t.value)}:t)).reverse(),o=o.reverse().map((t=>"assistant"===t.type?{...t,value:e(t.value)}:t)).reverse(),o=o.reverse().map((t=>"stdout"===t.type||"stderr"===t.type?{...t,value:e(t.value)}:t)).reverse()}return o=o.map((e=>"stdout"===e.type?{type:"assistant",value:`<stdout>\n${e.value}\n</stdout>`}:"stderr"===e.type?{type:"assistant",value:`<stderr>\n${e.value}\n</stderr>`}:e)),o=o.reduce(((e,t)=>{if("human"===t.type){const o=e[e.length-1];if(o&&"human"===o.type)return o.value+=`\n${t.value}`,e}if("assistant"===t.type){const o=e[e.length-1];if(o&&"assistant"===o.type)return o.value+=`\n${t.value}`,e}return[...e,t]}),[]),null!=t&&t.hideHumanAssistantTurnPrefix||(o=o.map((e=>{if("human"===e.type)return{type:"human",value:`\n\nHuman: ${e.value}`};if("assistant"===e.type)return{type:"assistant",value:`\n\nAssistant: ${e.value}`};throw new Error(`Unknown step type: ${e}`)}))),o.map((e=>e.value)).join("")}var st=o(24993);class lt{constructor(){this.nodes=void 0,this.nodes=[]}text(){const e=[];for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];for(const r of o)if("string"==typeof r)e.push(this.createTextNode(r));else{const t=new lt;r(t),e.push(...t.nodes)}return this.nodes.push(this.createElementNode("text",{children:e})),this}element(e,t){return this.nodes.push(this.createElementNode(e,{attributes:t})),this}simple(e){return this.nodes.push(this.createTextNode(e)),this}nest(e){const t=new lt;e(t);const o=this.nodes.length-1,n=this.nodes.at(o)??this.createElementNode("root");if("element"!==n.type)throw new Error(`Current node does not support nesting: <text>${n.value}</text>`);return this.nodes[o]={...n,children:[...n.children??[],...t.nodes]},this}toString(){return this.nodes.map((e=>(0,m.KT)(e))).join("")}createElementNode(e,t){const{attributes:o,children:n}=t??{};return{type:"element",tagName:e,attributes:o,children:n}}createTextNode(e){return{type:"text",value:e}}}function ct(e){const t=dt({type:"element",tagName:"wrap",children:(0,Je.P)(e)});if("element"!==t.type)throw new Error("Expected element.");return(t.children||[]).map((e=>(0,m.KT)(e))).join("")}function dt(e){return"text"===e.type?{...e,value:e.value.split("\n").map((e=>e.trim())).filter(Boolean).join("\n")}:"element"===e.type?{...e,children:(e.children||[]).map(dt).filter((e=>!("text"===e.type&&""===e.value)))}:void(0,u.t1)(e)}const pt={wiki_slack_answer:function(){return{type:"wiki_slack_answer",version:1,exampleTranscripts:[[{id:6,type:"human",value:'Example that shows a thread with no request for information:\n\n<chat handle="ak" datetime="2022-04-08T06:51:45.574-07:00" message-id="9"><text>papertrail: messing with node18 services in dev rn, lmk if you see anything weird</text></chat>'},{type:"assistant",id:7,value:"<think>The thread does not contain any requests for factual information. According to the instructions, I should not respond or take any further action.</think>"}],[{id:6,type:"human",value:'Example that shows a thread with a request for information: <chat person-id="10" person-name="jake" datetime="2023-09-07T22:16:04.910+00:00" message-id="11"><text>Does anyone know what I need to do to run `notion run --env production --adminMode`? right now i get `Something is wrong with SSO authentication, disabling SSO:  No access`</text></chat>'},{id:7,type:"assistant",value:'<think>The thread contains an initial message asking for information about running notion with specific command line arguments and an error. I should search the workspace for relevant information before responding.</think><search question="What do I need to do to run `notion run --env production --adminMode` without getting a No access error?" keywords="notion run production adminMode access error"/>'}]],instructions:ct('\n\t\t\t<text>You have access to a workspace with information, and a thread of messages between users. Your goal is to determine if the thread contains a request for factual information, and then possibly search the workspace to try to usefully resolve the request.</text>\n\t\t\t<text>\n\t\t\t\tIn your first think step, consider whether the thread contains a request for factual information, where the the information might be stored in a knowledge base.\n\t\t\t\t<text>The request could be phrased as a question, for example "Do we have any snacks in the office?".</text>\n\t\t\t\t<text>The request could be phrased as a statement like "I\'m looking to find out if we have any snacks in the office".</text>\n\t\t\t</text>\n\t\t\t<text>\n\t\t\t\tIf there is not a request for factual information:\n\t\t\t\t<text>Do not respond or take any actions.</text>\n\t\t\t</text>\n\t\t\t<text>\n\t\t\t\tIf there is a request for factual information:\n\t\t\t\t<text>First, search the workspace for relevant information. Your search query should be formatted as a concise, clear, and specific question that uniquely identifies the information being asked about.</text>\n\t\t\t\t<text>In your next think step, consider whether you should respond or not using the guidelines below. DO NOT use load-page.</text>\n\t\t\t\t<text>If you found a single exact answer to the question, use chat to provide the answer.</text>\n\t\t\t\t<text>If you found multiple pages with exact answers which disagree with each other, use chat to state that you found multiple answers, and then to provide a concise summary of the best answers. You must cite all pages that were referenced in the summary.</text>\n\t\t\t\t<text>If you could not find an exact answer to the question, but found some highly relevant information, use chat to state that you could not find an exact answer, and then provide a summary of the relevant information with links to the relevant pages.</text>\n\t\t\t\t<text>If you cannot find any highly relevant information, do not respond or take any actions.</text>\n\t\t\t\t<text>\n\t\t\t\t\tImportant: Your answer must fit in a Tweet with a short character limit.\n\t\t\t\t\tTherefore, you must be concise. Do not go into unnecessary detail.\n\t\t\t\t\tAim for your answer to be 1-3 sentences.\n\t\t\t\t\tYou must always cite your sources.\n\t\t\t\t</text>\n\t\t\t</text>\n\t\t\t<text>\n\t\t\t\tWhen someone mentions you in a follow-up message:\n\t\t\t\t<text>Take appropriate actions based on their message.</text>\n\t\t\t\t<text>In this case, you must always respond in some way (either via chat or by performing an edit).</text>\n\t\t\t</text>\n\t\t')}},wiki_slack_qna_ingestion:function(){return{type:"wiki_slack_qna_ingestion",version:1,exampleTranscripts:[[{id:6,type:"human",value:'Example that shows a thread with no request for information:\n\n<chat handle="ak" datetime="2022-04-08T06:51:45.574-07:00" message-id="9"><text>papertrail: messing with node18 services in dev rn, lmk if you see anything weird</text></chat>'},{type:"assistant",id:7,value:"<think>The thread does not contain any requests for factual information. According to the instructions, I should not respond or take any further action.</think>"}],[{id:6,type:"human",value:'Example that shows a thread with a request for information, saving a new FAQ into the database after observing that there is no existing FAQ with the same question:\n\n<chat datetime="2022-08-12T06:38:47.897-07:00" message-id="8"><text>anyone know how to get rid of this pako error?</text></chat><chat handle="vr" datetime="2022-08-12T06:52:55.990-07:00" message-id="9"><text>hmm i donâ€™t see that. maybe try `notion install`? have you updated any packages?</text></chat><chat handle="vr" datetime="2022-08-12T06:55:50.886-07:00" message-id="10"><text>usually i think this error means that we have a javascript package that doesnâ€™t ship with its own types.</text></chat><chat handle="blackmad" datetime="2022-08-12T07:07:46.376-07:00" message-id="11"><text>or sometimes vscode\'s typescript language server doesn\'t pick up newly installed type definitions, so you can try command-option-p -&gt; restart ts server (or just restart vscode)</text></chat><chat handle="andrew" datetime="2022-08-12T07:09:13.578-07:00" message-id="12"><text>ty both.  restarting ts server fixed :man-bowing:</text></chat>'},{type:"assistant",id:7,value:'<think>Someone asked how to resolve a \'pako error\' in javascript, and the issue was resolved by restarting ts server. According to the instructions, I should search the database for this request.</think><query-database id="2"><search question="How can I resolve a \'pako error\' in javascript?" keywords="pako error resolve javascript"></search></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="10" total-results="113">{Database results not shown}</query-database-results>',id:6},{type:"assistant",id:7,value:'<think>The search returned no results about this error. I should save a new FAQ with the question asking how to resolve this error, and an answer explaining to restart the typescript language server.</think><insert-inside id="3"><page><property-title name="Question">How can I resolve a \'pako error\' in javascript?</property-title><property-text name="Answer">You may be able to resolve a \'pako error\' in javascript by restarting Visual Studio Code\'s typescript language server. This can be done by running the command \'Restart TS Server\' from the command palette.</property-text><property-text name="Sources"><a href="1">Thread in #marketing</a></property-text></page></insert-inside>'}],[{id:4,type:"human",value:'Example that shows a thread with a request for information, then updating an existing FAQ after observing that there is an existing FAQ with the exact same question, meaning it seeks identical information:\n\n<chat handle="sharabesh" datetime="2023-05-12T17:50:54.793+00:00" message-id="4"><text>Is there any internal debugging tool where I can give it a spaceId and find out more info as to who\'s in the workspace/how many members/how many pages/etc</text></chat><chat handle="ryan" datetime="2023-05-12T17:51:20.699+00:00" message-id="5"><text>Admin mode has UI tools to help with this type of query</text></chat><chat handle="sharabesh" datetime="2023-05-12T17:52:01.566+00:00" message-id="6"><text>How do I access admin mode?</text></chat><chat handle="ryan" datetime="2023-05-12T17:52:24.190+00:00" message-id="7"><text>For production, the URL is <a href="https://admin.notion.so/__admin">https://admin.notion.so/__admin</a></text></chat><chat handle="christine" datetime="2023-05-12T17:55:23.327+00:00" message-id="8"><text>for dev and stg, respectively, itâ€™s `<a href="https://admin-dev.notion.so/__admin">admin-dev.notion.so/__admin</a>` and `<a href="https://admin-stg.notion.so/__admin">admin-stg.notion.so/__admin</a>`. for any of dev/stg/prod, make sure youâ€™re on vpn!</text></chat>'},{type:"assistant",id:5,value:'<think>The thread contains a request for information on accessing an internal debugging tool to find details about a workspace. I should search the database for any existing FAQs on how to access Notion\'s admin mode, then consider if the new information about the dev/stg URLs needs to be appended to the answer.</think><query-database id="3"><search question="How can I access Notion\'s admin mode?" keywords="admin mode access url"></search></query-database>'},{type:"observation",observationType:"queryDatabase",value:'<query-database-results current-results="10" total-results="1333"><child-page id="9" page-id="10" database-id="3"><property-title name="Question">How can I access admin mode on the Dev environment without running it locally?</property-title><property-text name="Answer">To access admin mode on the Dev environment without running locally, you can use admin-dev.notion.so according to the thread.</property-text><property-person name="Owner"/><property-text name="Sources"><a href="https://notion.slack.com/archives/CPZDWQPNY/p1679348856991489">Thread in #eng-team</a></property-text></child-page>{Additional database results not shown}</query-database-results>',id:6},{type:"assistant",id:7,value:'<think>There is an existing FAQ about how to access admin mode on Dev, but it does not include the additional information about Staging and Production URLs that was provided. I should update the existing answer to append these new sources.</think><set-property id="9"><property-text name="Answer">To access admin mode on the Dev environment without running locally, you can use <a href="https://admin-dev.notion.so/__admin">admin-dev.notion.so/__admin</a>.\nFor Staging, use <a href="https://admin-stg.notion.so/__admin">admin-stg.notion.so/__admin</a>.\nFor Production, use <a href="https://admin.notion.so/__admin">https://admin.notion.so/__admin</a>.\nMake sure to use VPN when accessing admin for any environment.</property-text></set-property><set-property id="9"><property-text name="Sources"><a href="https://notion.slack.com/archives/CPZDWQPNY/p1679348856991489">Thread in #eng-team</a>\n<a href="1">Thread in #eng-team</a></property-text></set-property>'}]],instructions:ct('\n\t\t\t<text>You have access to a database of questions and answers, as well as a thread of messages between users. Your goal is to maintain the database with useful and up-to-date information which can be used to answer future questions.</text>\n\t\t\t<text>You are running in the background and cannot respond using chat.</text>\n\t\t\t<text>\n\t\t\t\tGuidelines for the FAQ database:\n\t\t\t\t<text>\n\t\t\t\t\tQuestion property: a concise, clear, and specific question that uniquely identifies the information being asked about.\n\t\t\t\t\t<text>Should be a single sentence in a clear, professional tone, with correct spelling and grammar, formatted as a question with a question mark at the end.</text>\n\t\t\t\t\t<text>DO NOT reference any of the people in the thread.</text>\n\t\t\t\t</text>\n\t\t\t\t<text>\n\t\t\t\t\tAnswer property: a direct, concise, and specific answer to the question.\n\t\t\t\t\t<text>Should be left blank when there is no clear answer.</text>\n\t\t\t\t\t<text>Provides the most up-to-date answer with all important details fully contained within the answer.</text>\n\t\t\t\t\t<text>You can only use information explicitly in the context. DO NOT make up any new information not explicitly in the context.</text>\n\t\t\t\t\t<text>DO NOT link to the thread or messages from the thread anywhere inside the answer.</text>\n\t\t\t\t\t<text>You may include additional URLs if they are important to the answer.</text>\n\t\t\t\t\t<text>DO NOT reference \'the human\', or any of the people in a thread.</text>\n\t\t\t\t\t<text>DO NOT reference the date of the thread unless it highly relevant to the question (ie. the question is timely). If you do reference a date, use a \'mention-date\' tag.</text>\n\t\t\t\t</text>\n\t\t\t\t<text>\n\t\t\t\t\tSources property: a list of all relevant sources for the answer.\n\t\t\t\t\t<text>Reference threads using this format, using the context values of thread ID from current-thread-id, and the channel from current-channel: <a href="1">Thread in #channel</a></text>\n\t\t\t\t\t<text>Each source should be separated by a newline.</text>\n\t\t\t\t\t<text>You should never remove sources from the list of sources. Instead, append new ones.</text>\n\t\t\t\t</text>\n\t\t\t</text>\n\t\t\t<text>\n\t\t\t\tIn your first think step, consider whether the thread contains a request for factual information, where the the information might be stored in a knowledge base.\n\t\t\t\tThe request could be phrased as a question, for example "Do we have any snacks in the office?".\n\t\t\t\tThe request could be phrased as a statement like "I\'m looking to find out if we have any snacks in the office".\n\t\t\t</text>\n\t\t\t<text>\n\t\t\t\tIf there is not a request for factual information:\n\t\t\t\t<text>Do not respond or take any actions.</text>\n\t\t\t</text>\n\t\t\t<text>\n\t\t\t\tIf there is a request for factual information:\n\t\t\t\t<text>First, use query-database to search the database to see if there are any relevant existing FAQs. Your search query should be formatted as the question that would be saved in the database.</text>\n\t\t\t\t<text>Then, observe the query results. Note that the results are not necessarily relevant to the query.</text>\n\t\t\t\t<text>\n\t\t\t\t\tIn your next think step, you should identify if there is an existing FAQ about the exact same question. Questions are considered the same if they seek identical information. They do not need to be phrased the same way.\n\t\t\t\t\t"Do we have any snacks in the office?" and "Are there any snacks in the office?" are considered the same question.\n\t\t\t\t\t"Do we have any snacks in the office?" and "Do we have any snacks in the New York office today?" are considered different questions.\n\t\t\t\t\tIf it\'s not clear whether the questions are the same, you should assume they are different.\n\t\t\t\t</text>\n\t\t\t\t<text>\n\t\t\t\t\tIf there is not an existing FAQ about the exact same question:\n\t\t\t\t\t<text>Save a new FAQ.</text>\n\t\t\t\t\t<text>Set the question property using the guidelines above.</text>\n\t\t\t\t\t<text>If there is a clear answer, set the answer property using the guidelines above. If there is no clear answer, you should leave it blank.</text>\n\t\t\t\t\t<text>Set the sources property using the guidelines above.</text>\n\t\t\t\t</text>\n\t\t\t\t<text>\n\t\t\t\t\tIf there is an existing FAQ about the exact same question:\n\t\t\t\t\t<text>If the answer needs to be updated based on important additional or conflicting information from the new thread, set the answer property using the guidelines above.</text>\n\t\t\t\t\t<text>Set the sources property to include the new thread, making sure not to remove any of the existing sources.</text>\n\t\t\t\t\t<text>DO NOT use load-page. Simply use set-property to update the answer and sources properties.</text>\n\t\t\t\t</text>\n\t\t\t</text>\n\t\t')}},tasks_slack:function(e){let{context:t,idMapper:o}=e;return{type:"tasks_slack",version:1,instructions:ct(`\n\t\t\t<text>Do not respond if you receive a follow-up message in a thread, and the message is not responding to you or directly addressing to you.</text>\n\t\t\t<text>When someone sends an issue or ask to create a task:\n\t\t\t\t<text>If the issue is too general or not actionable, do nothing.</text>\n\t\t\t\t<text>If the issue is specific enough or actionable:\n\t\t\t\t\t<text>Search through the Tasks database.</text>\n\t\t\t\t\t<text>You should filter on the â€œTeamâ€ property with the ${`<mention-page page-id="${o.mapKeyToCounter({type:"block",key:t.teamBlockId})}"/>`} team.</text>\n\t\t\t\t\t<text>Then, read through the most similar 3 results.</text>\n\t\t\t\t\t<text>If there are no exact matches to the issue, communicate this to the team, and ask the team if they want to create a new task.\n\t\t\t\t\t\t<text>You can address the team like â€œTeam, â€¦â€</text>\n\t\t\t\t\t\t<text>You should generate an action button to make it easier for the user to confirm.</text>\n\t\t\t\t\t\t<text>Example XML: <code><chat><text>...</text><action-button name="Yes, create a task." icon="âœ…"/></chat></code></text>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text>If there are exact matches to the issue, very briefly list them in chat, and ask the team if they want to create a new task anyway.</text>\n\t\t\t\t</text>\n\t\t\t</text>\n\t\t\t<text>When someone asks to create a new task (either verbally or by clicking on the action button):\n\t\t\t\t<text>Create a new task in the Tasks DB using <code><insert-inside id={...}></code>:\n\t\t\t\t\t<text>The â€œNameâ€ property should be a compact (but specific) title based on the issue.</text>\n\t\t\t\t\t<text>The page body should be a brief summary of the discussion, with a link to the slack message at the bottom.\n\t\t\t\t\t\t<text>Faithfully summarize the discussion. Do not make up information that is not in the current context or from general world knowledge unless explicitly requested to do so. Avoid making assumptions about information that is not explicitly in the current context.</text>\n\t\t\t\t\t\t<text>Include the person submitting the issue by using <code><mention-person person-id="<person id>"></code>.</text>\n\t\t\t\t\t\t<text>Include a link to the Slack thread at the bottom too, using <code><a href="2">[current thread id]</a></code>.</text>\n\t\t\t\t\t</text>\n\t\t\t\t\t<text>Do not create any other fields unless it is necessary based on the userâ€™s intents. </text>\n\t\t\t\t</text>\n\t\t\t\t<text>Respond via chat to tell the user you have created a new task. Donâ€™t try to link to the created page in your message.</text>\n\t\t\t</text>\n\t\t\t<text>Do not do anything if the message is not about a new task or a new actionable issue.</text>\n\t\t\t<text>Examples of situations where the assistant should not respond:\n\t\t\t\t<text>When someone asks a question that is not an immediate action item;</text>\n\t\t\t\t<text>When someone asks a question that needs to be confirmed by the team;</text>\n\t\t\t\t<text>When someone sends a message that is not directly associated with an actionable task;</text>\n\t\t\t\t<text>When someone sends a follow-up message in a thread which is not responding to you or not directly addressed to you;</text>\n\t\t\t\t<text>When someone sends a link to a pull request that is not clearly associated with a task.</text>\n\t\t\t</text>\n\t\t\t<text>Examples of situations where the assistant should respond:\n\t\t\t\t<text>When someone sends a message about an issue pertaining to a specific use case or scenario.</text>\n\t\t\t</text>`)}},summarize:function(){return{type:"summarize",version:1,instructions:ct("\n\t\t\t<text>\n\t\t\t\tRespond via chat with a brief summary of the current page.\n\t\t\t</text>\n\t\t\t<text>\n\t\t\t\tWrite a single concise paragraph, no more than a few short sentences.\n\t\t\t</text>\n\t\t\t<text>\n\t\t\t\tDo not link to the page.\n\t\t\t</text>\n\t\t")}},qna:function(){return{type:"qna",version:1,exampleTranscripts:[],instructions:ct("\n\t\t\t\t<text>\n\t\t\t\t\tFirst, search the workspace for an answer to the question.\n\t\t\t\t</text>\n\t\t\t\t<text>\n\t\t\t\t\tThen, using the search results, respond by summarizing an answer to the original question.\n\t\t\t\t</text>\n\t\t\t\t<text>\n\t\t\t\t\tMake sure to accurately summarize the referenced search results. Be careful not to make any assumptions.\n\t\t\t\t\tIf you did not find an answer, respond with a message saying so.\n\t\t\t\t</text>\n\t\t\t\t<text>\n\t\t\t\t\tImportant: Your answer must fit in a Tweet with a short character limit.\n\t\t\t\t\tTherefore, you must be concise. Do not go into unnecessary detail.\n\t\t\t\t\tAim for your answer to be 1-3 sentences.\n\t\t\t\t\tYou must always cite your sources.\n\t\t\t\t</text>\n\t\t\t")}},meeting_summary:function(e){let{context:t,idMapper:o}=e;const n=o.mapKeyToCounter({type:"block",key:t.positionBlockId});return{type:"meeting_summary",version:1,instructions:(new lt).text("Provide a concise, high-quality, actionable summary of this meeting by following these steps:").text(`Insert key summarized items inside the AI block (id="${n}"). Avoid adding a new heading.`).nest((e=>e.text("The only action you can take is the ",(e=>e.element("insert-inside",{id:"block-id"})),"action."))).text("Do not use any header blocks, only list items. Avoid adding more than 3 key points. Key points should be no longer than 200 characters.").nest((e=>e.text("Bullet points look like this").element("uli").nest((e=>e.simple("Example meeting summary point."))).text("Numbered lists look like this").element("oli").nest((e=>e.simple("Example meeting summary item."))))).toString()}},meeting_action_items:function(e){let{context:t,idMapper:o}=e;const n=o.mapKeyToCounter({type:"block",key:t.positionBlockId});return{type:"meeting_action_items",version:1,instructions:(new lt).text("Provide a concise, high-quality, actionable list of action items from this meeting by following these steps:").text("If you cannot synthesize any high quality action items, do not make any up or add irrelevant ones and simply give one concise sentence about why.").text(`Next, insert each action item as a todo block inside the AI block (id="${n}") and mention at least one person that is responsible for that action item.`).text("Keep action items clear, helpful, actionable. List no more than 5.").nest((e=>e.text("The only action you can take is the ",(e=>e.element("insert-inside",{id:"block-id"})),"action.").nest((e=>e.text("If the responsible person is a user in Notion please use ",(e=>e.element("mention-person",{"person-id":"person-id"}))," to mention them.").nest((e=>e.text("Just use the person's name if you cannot find a corresponding Notion user for them."))).text("If there is a due date associated with the action item please use ",(e=>e.element("mention-date",{date:"YYYY-MM-DD"}))," to mention the date."))).text("Do not add a new header, only use todo blocks and person mentions."))).text("Here is an example of a formatted action item::").nest((e=>e.element("todo").nest((e=>e.simple("[").element("mention-person",{"person-id":"person-id"}).simple("] Investigate latency improvements by ").element("mention-date",{date:"2023-10-22"}))))).toString()}}};function ut(e){const{context:t,idMapper:o}=e,n=pt[t.type];if(!n)throw new Error(`No instructions page renderer for ${t.type}`);return n({context:t,idMapper:o})}var mt=o(40682),gt=o(68626),ht=o(89789),ft=o(74229),yt=o(59753),vt=o(11799),bt=o(482),St=o(606),_t=o(99405),wt=o(19889),kt=o(3791),xt=o(70203),It=o(49902),Ct=o(50906),Tt=o(54642),Mt=o(47307),Pt=o(94419),At=o(68305),Dt=o(61045),Bt=o(31299),Rt=o(39699),Et=o(84254),Ft=o(57819),Nt=o(95477),jt=o(19124),Ot=o(33929),Lt=o(98165),Ut=o(67669),Zt=o(18245),Vt=o(95802),qt=o(51214),zt=o(80444),Wt=o(49085);class Ht extends Wt.default{getInitialState(){}hasLockAction(){const e=this.state;return Boolean((null==e?void 0:e.committing)||(null==e?void 0:e.evaluating)||(null==e?void 0:e.sampling))}}var Gt=o(21273),Kt=o(98180),$t=o(82375),Yt=o(77080),Qt=o(88923),Jt=o(35661),Xt=o(81582),eo=o(40824);function to(e){var t,o;let{transcript:n,answerUsingModel:r}=e;const i="openai-2"===r||"anthropic-1"===r,a=n.slice(-1)[0],s="human"===a.type&&1===n.filter((e=>"human"===e.type)).length,l=(null===(t=n.find((e=>"context"===e.type)))||void 0===t?void 0:t.context["current-person-name"])||void 0,c=(null===(o=n.find((e=>"context"===e.type)))||void 0===o?void 0:o.context["current-space-name"])||void 0;if("openai-5"===r)return{promptArgs:{type:"assistant",...et({transcript:n})},model:"openai-5"};if(s)return{promptArgs:{type:"generateTimelyQueryAndKeywords",question:a.value,userName:l,spaceName:c,forcePrefix:'<search question="'},model:"default"};const d=function(e){const{transcript:t,duplicateInstructionsPageAsHumanMessage:o,useChatMarkdown:n,disableForcePrefix:r}=e,i=t[t.length-1],a=t.filter((e=>"human"===e.type));if("human"===(null==i?void 0:i.type)&&1===a.length)return{systemInstructions:void 0,transcript:t,...r?{}:{forcePrefix:'<search question="'}};let s;o&&"observation"===(null==i?void 0:i.type)&&"search"===i.observationType&&(s=rt(t));const l=(n?Ce:Te).map((e=>nt({transcript:e})));return{systemInstructions:[fe.bio,fe.hallucinations,fe.search,fe.chat,fe.citations,fe.contextMode,fe.questionAnswering,fe.languageFollowing].filter(Boolean).join("\n\n"),transcript:[...t,...s?[s]:[]],exampleTranscripts:l,...r?{}:{forcePrefix:"human"===(null==i?void 0:i.type)?"<think>":"<chat><text>"}}}({transcript:n,duplicateInstructionsPageAsHumanMessage:!0,disableForcePrefix:i,useChatMarkdown:i});return"anthropic-qa-alpha"===r||"control"===r?{promptArgs:{type:"assistant",...d},model:"anthropic-qa-alpha"}:{promptArgs:{type:"generateAnswer",...d,spaceName:c},model:r}}const oo=new mt.z(1);function no(e,t){let o=e.parent;for(;o;){if(o.attributes.id===t)return!0;o=o.parent}return!1}class ro extends re{constructor(e){let{context:t,environment:o,assistantEvaluatorStateCallbacks:n,isQnA:r,sessionId:i}=e;super(t),this.environment=void 0,this.assistantEvaluatorStateCallbacks=void 0,this.isQnA=void 0,this.currentUserId=void 0,this.sessionId=void 0,this.environment=o,this.assistantEvaluatorStateCallbacks=n,this.isQnA=r;const a=o.currentUser.id;if(!a)throw Error("User is not logged in.");this.currentUserId=a,this.sessionId=i}clone(){const e=new ro({context:this.getContext(),environment:this.environment,assistantEvaluatorStateCallbacks:this.assistantEvaluatorStateCallbacks,isQnA:this.isQnA,sessionId:this.sessionId});return e.inheritPropsFromClonedParent(this),e}parse(e){return(0,Je.P)(e)}addOperation(e){const t=this.getIdMapper().mapAssistantOperationCounterToKey(e),o=this.getAssistantConfigurationState(),{temporaryCache:n}=o,r=io().getSpaceId();if(o.limitEditsInsideBlockSubtree&&!function(e,t){switch(t.command){case"createBlock":return no(t.blockNode,e.id);case"removeBlock":return no(t.removeBlockNode,e.id);case"insertBlockBefore":case"insertBlockAfter":return no(t.insertBlockNode,e.id);case"setBlockParent":return!1;case"setBlockText":case"setBlockAttribute":case"setBlockProperty":case"setBlockTagName":return no(t.blockNode,e.id);case"insertOrMoveTableColumns":case"removeTableColumn":return no(t.blockNode,e.id);default:(0,u.t1)(t)}}(o.limitEditsInsideBlockSubtree,t))return;const i=(0,pe.ND)({assistantOperation:t,actorPointer:this.assistantEvaluatorStateCallbacks.getAttributionActor(),getRecordValue:n.makeGetRecordValueFn(this.currentUserId),spaceId:r});this.assistantEvaluatorStateCallbacks.addOperationsToTemporaryOperations(i),this.assistantEvaluatorStateCallbacks.addAssistantOperationToAssistantOperations(t),i.length>0&&To({environment:this.environment,operations:i,sessionId:this.sessionId})}randomID(){const{assistantRuntimeStore:e}=Kt.Z.getSessionContextOrThrow(this.sessionId),t=e.state;if(!t)throw new Error("No Runtime context for provided assistant session");const o=t.randomIdCache[t.randomIdIndex];if(o){const n=this.getIdMapper().mapKeyToCounter({type:"block",key:o});return e.setState({...t,randomIdIndex:t.randomIdIndex+1}),n}{const o=(0,c.ZP)();e.setState({...t,randomIdCache:[...t.randomIdCache,o],randomIdIndex:t.randomIdIndex+1});return this.getIdMapper().mapKeyToCounter({type:"block",key:o})}}async loadPage(e){const t=io();if(!t)throw new Error("No current block store");const o=this.getAssistantConfigurationState(),n=this.getAssistantRuntimeState(),{evaluator:{codeEvaluator:r},selectedSkill:i}=n,a=r.state;if(o.sampling){return{pageBlockNode:{type:"block",tagName:"page",text:[],attributes:{id:e},properties:{},schemas:{},children:[],parent:void 0,persisted:!0,schemaId:e},relatedNodes:[]}}const l=i?a.getIdMapper().mapKeyToCounter({type:"skill",key:i.key}):void 0;let c;if(null!=i&&i.inAppSkillTrigger?c=i.inAppSkillTrigger.instructionsPageContext:null!=i&&i.inEditorSkillTrigger&&(c=i.inEditorSkillTrigger.instructionsPageContext),i&&l===e&&c){return{pageBlockNode:{type:"block",tagName:"page",text:[{type:"text",value:ut({context:c,idMapper:a.getIdMapper()}).instructions}],attributes:{id:e},properties:{},schemas:{},children:[],parent:void 0,persisted:!0,schemaId:e},relatedNodes:[],context:c}}const d={table:de.iU,id:this.getIdMapper().mapCounterToKey(e).key,spaceId:t.getSpaceId()};this.assistantEvaluatorStateCallbacks.appendAssistantLoadPageTemporaryClientStep(d);const p=await(0,st.IT)({pointer:d,loadRecordValue:t.loadRecordValue,intl:Ot.default.getIntl()}),m=this.getIdMapper().mapNodeKeyToCounter(p);return{pageBlockNode:m,relatedNodes:await async function(e){const{mappedNode:t,idMapper:o,currentPageBlockStore:n}=e,r=n.getSpaceId();return async function(e){const{mappedNode:t,idMapper:o,spaceId:n,loadPageAsXMLFn:r,getNavigableParentPointerFn:i}=e,a=async e=>{let{blockId:t,shouldShowObservation:i}=e;const a=await r({table:de.iU,id:o.mapCounterToKey(t).key,spaceId:n});return{blockId:t,node:o.mapNodeKeyToCounter(a),shouldShowObservation:i}},l=[];try{l.push(...await(0,ce.af)((0,s.Rg)([t]).map((e=>a({blockId:e,shouldShowObservation:!1}))))),l.push(...(await(0,ce.af)((0,s.Cl)(t).map((async e=>{const t=await i({table:de.iU,id:o.mapCounterToKey(e).key,spaceId:n});if(!t)return;const a=await r({...t,spaceId:n});return{blockId:o.mapKeyToCounter({type:"block",key:t.id}),node:o.mapNodeKeyToCounter(a),shouldShowObservation:!1}})))).filter(u.$K)),l.push(await a({blockId:t.schemaId,shouldShowObservation:!1}))}catch(c){throw new Error("Failed to load page")}return l}({mappedNode:t,idMapper:o,spaceId:r,loadPageAsXMLFn:e=>(0,st.IT)({pointer:e,loadRecordValue:n.loadRecordValue,intl:Ot.default.getIntl()}),getNavigableParentPointerFn:async e=>{var t;const o=Jt.G.createChildStore(n,e);return await o.load(),null===(t=o.getNavigableBlockStore())||void 0===t?void 0:t.pointer}})}({mappedNode:m,idMapper:this.getIdMapper(),currentPageBlockStore:t})}}async search(e){var t;const o=null===(t=zt.default.state.currentSpaceStore)||void 0===t?void 0:t.id;if(!o)throw new Error("No space id");const n=this.getAssistantConfigurationState();if(n.sampling)return[];this.assistantEvaluatorStateCallbacks.appendAssistantSearchClientStep(e);const r=n.searchCache.get(e),i=this.isQnA;if(r){if(i){const e=(await r).map((e=>{const t=e.id;return this.getIdMapper().mapCounterToKey(t).key}));e.length>0&&this.assistantEvaluatorStateCallbacks.appendSearchResultsTemporaryClientStep(e)}return r}const a=(async t=>{const n=(0,jt.Gw)()?function(){const e=io();if(!e)throw new Error("No current block store");const t=(0,Lt.qA)(e).map((e=>({table:e.table,value:e.getValue()}))),o=(0,le.If)({currentPageAncestors:t});if(o)return[o]}():void 0,r=await Tt.performAiSearch(this.environment,{...e,spaceId:o,ancestors:n,aiSessionId:this.sessionId,source:"assistant"});if("success"!==r.type)throw r;const a=r.data.results;i&&a.length>0&&this.assistantEvaluatorStateCallbacks.appendSearchResultsTemporaryClientStep(a.map((e=>e.id))),Zt.default.measure("qna.search",{environment:this.environment});return a.map((e=>{const o=e.id;return{...e,id:t.mapKeyToCounter({type:"block",key:o})}}))})(this.getIdMapper());return n.searchCache.set(e,a),a}async queryDatabase(e){const t=this.environment.currentUser.id;if(!t)throw new Error("No current user.");const o=this.getAssistantConfigurationState();if(o.sampling)return{results:[],total:0,aggregation:void 0,dependentAssistantBlockNodes:[]};const{inMemoryRecordCache:n}=this.environment.defaultRecordCache,{temporaryCache:r,committing:i}=o,a=(!i?r:n).makeGetRecordValueFn(t),l=yt.om.fromGetRecordValueFn(a),c=io();if(!c)throw new Error("No current block store");const{collectionViewBlockPointer:d,collectionPointer:p,filter:m,sort:g,limit:h,vectorSearch:y,aggregation:v}=(0,pe.hl)({assistantDatabaseQuery:e,idMapper:this.getIdMapper(),spaceId:c.getSpaceId(),getRecordValue:a}),b=await At.tA(this.environment,{source:"assistant",parentRecordStore:c,collectionPointer:p,filter:m,sort:g,limit:h,vectorSearch:y,aggregations:{total:{aggregator:"count"},...v&&{aggregation:v}}});if(f.x.isFail(b))throw b.error;this.assistantEvaluatorStateCallbacks.appendQueryDatabaseClientStep();const S=(await Promise.all(b.value.blockIds.map((e=>(0,st.gu)({pointer:{table:de.iU,id:e},rootPointer:c.pointer,parentPointer:d,loadRecordModel:yt.s8.fromGetRecordModelFn(l),intl:Ot.default.getIntl()}))))).filter(u.$K).map((e=>this.getIdMapper().mapNodeKeyToCounter(e))),_=[],w=(0,s.Rg)(S);for(const s of w)_.push(this.getIdMapper().mapNodeKeyToCounter(await(0,st.IT)({pointer:{table:de.iU,id:this.getIdMapper().mapCounterToKey(s).key,spaceId:c.getSpaceId()},loadRecordValue:c.loadRecordValue,intl:Ot.default.getIntl()})));return{results:S,total:b.value.total,aggregation:b.value.aggregation,dependentAssistantBlockNodes:_}}chat(e,t){this.assistantEvaluatorStateCallbacks.appendAssistantChatClientStep({mappedBlockIds:e.map((e=>this.getIdMapper().mapCounterToKey(e).key)),mappedOperations:t.map((e=>this.getIdMapper().mapAssistantOperationCounterToKey(e)))})}chatMd(e){this.assistantEvaluatorStateCallbacks.appendAssistantChatMdClientStep(e)}think(e){this.assistantEvaluatorStateCallbacks.appendAssistantThinkClientStep(e)}async searchPeople(e){if(this.getAssistantConfigurationState().sampling)return{results:[],total:0};const t=await Bt.Yu({environment:this.environment,query:e,membersOnly:!1});return this.assistantEvaluatorStateCallbacks.appendAssistantSearchPeopleClientStep(e),{results:t.slice(0,20).map((e=>({id:this.getIdMapper().mapKeyToCounter({key:e.id,type:"person"}),name:e.name||"",email:e.email}))),total:t.length}}async*streamInference(e,t){var o;const n=l.Xh(e),{currentSpaceStore:r}=zt.default.state;if(!r)throw new Error("No current space.");const i=null===(o=$t.Hl.state)||void 0===o?void 0:o.type;let s,c,d;const p=Yt.default.getGroup("qna_answer_using");if(Gt.Z.isAssistant2Enabled())s={type:"assistant",...tt({transcript:e}),hideAvailableCommands:!0},c="openai-6";else if(this.isQnA)d=to({transcript:n,answerUsingModel:p}),c=d.model,s=d.promptArgs;else{var u,m;const e=this.getAssistantRuntimeState(),{selectedSkill:t,evaluator:o}=e,r=(null==t||null===(u=t.inAppSkillTrigger)||void 0===u?void 0:u.instructionsPageContext)??(null==t||null===(m=t.inEditorSkillTrigger)||void 0===m?void 0:m.instructionsPageContext);if(r){s={type:"assistant",...ot({rendered:ut({context:r,idMapper:o.codeEvaluator.state.getIdMapper()}),transcript:n})}}else s={type:"assistant",...Xe({type:i,transcript:n})};c="anthropic-2"}const g=this.environment,h=await Tt.getCompletion(g,{id:t,aiSessionId:this.sessionId,context:s,model:c,spaceId:r.id,isSpacePermission:!1,metadata:{},attributionForLogging:void 0,inferenceReason:"assistant"});if("success"!==h.type)return Mt.showError(h),{type:"error_modal_shown"};let f,y=!1;if(ft.H1.is(h.data)){for await(const e of h.data)if("success"===e.type)if(e.debugRenderedPrompt&&this.assistantEvaluatorStateCallbacks.setSamplingPrompt(e.debugRenderedPrompt),y)yield e.completion;else{const t=e.completion.trim();if(""===t)continue;if("generateAnswer"!==s.type||t.startsWith("<"))"forcePrefix"in s&&s.forcePrefix&&(0,a.jQ)(c)?(f=s.forcePrefix,yield`${f}${e.completion}`):yield e.completion;else{f="<chat><text>";const t=e.completion;yield`${f}${t}`}y=!0}else if("error"===e.type){if(kt.lX(e.errorCode)){var v;const e=null===(v=zt.default.state.currentSpaceStore)||void 0===v?void 0:v.id;return void(e&&await Et.updateAiEligibility(g,e))}(0,Et.showCompletionErrorWithCode)(e.errorCode)}"<chat><text>"===f&&(yield"</text></chat>")}}getAssistantConfigurationState(){const{assistantConfigurationStore:e}=Kt.Z.getSessionContextOrThrow(this.sessionId);if(!e.state)throw new Error("No configuration context for provided assistant session");return e.state}getAssistantRuntimeState(){const{assistantRuntimeStore:e}=Kt.Z.getSessionContextOrThrow(this.sessionId);if(!e.state)throw new Error("No runtime context for provided assistant session");return e.state}}function io(){if(Qt.default.state.open)return Qt.default.state.target;const e=zt.default.state.mainEditorCurrentBlockStore??zt.default.state.currentSpaceStore;if(!e)throw new Error("No available store");return e}function ao(){Kt.Z.clearAllSessions()}async function so(e){const{environment:t,completionContext:o,isLabelerSlackMode:i,fakeSlackChannel:a,primeTextInput:d,isQnA:p,limitEditsInsideBlockSubtree:u,preventSelection:g,clientSkill:h}=e,f=Gt.Z.isAssistant2Enabled(),y=t.currentUser.id;if(!y)throw new Error("User is not logged in");if(!io())throw new Error("No current block store");const v=(0,c.ZP)(),b=new $t.BJ,S=new Ht,_={sessionId:v,context:{assistantRuntimeStore:b,assistantConfigurationStore:S,sessionMetadata:{completionContext:o,isLabelerSlackMode:i,fakeSlackChannel:a,clientSkill:h,limitEditsInsideBlockSubtree:u,preventSelection:g,isQnA:p}}};(null==e?void 0:e.makeActiveSession)??Boolean(!h||(null==h?void 0:h.inAppSkillTrigger))?Kt.Z.setNewActiveSession(_):Kt.Z.addNewSession(_);const w=null!=h&&h.inEditorSkillTrigger?{id:ht.GR.id,table:wt.KJ}:{id:y,table:wt.KJ},k={addOperationsToTemporaryOperations:e=>{if(!b.state)throw new Error("No state");b.setState({...b.state,temporaryOperations:b.state.temporaryOperations.concat(e)})},addAssistantOperationToAssistantOperations:e=>{if(!b.state)throw new Error("No state");b.setState({...b.state,temporaryAssistantOperations:b.state.temporaryAssistantOperations.concat(e)})},appendAssistantLoadPageTemporaryClientStep(e){if(!b.state)throw new Error("No state");b.setState({...b.state,temporaryClientSteps:[...b.state.temporaryClientSteps,{type:"assistantLoadPage",pointer:e,thought:b.state.temporaryThought}]})},appendSearchResultsTemporaryClientStep(e){if(!b.state)throw new Error("No state");b.setState({...b.state,temporaryClientSteps:[...b.state.temporaryClientSteps,{type:"assistantShowSearchResults",searchResults:e}]})},appendAssistantSearchClientStep:e=>{if(!b.state)throw new Error("No state");b.setState({...b.state,temporaryClientSteps:[...b.state.temporaryClientSteps,{type:"assistantSearch",thought:b.state.temporaryThought,...e}]})},appendQueryDatabaseClientStep:()=>{if(!b.state)throw new Error("No state");b.setState({...b.state,temporaryClientSteps:[...b.state.temporaryClientSteps,{type:"queryDatabase",thought:b.state.temporaryThought}]})},appendAssistantChatClientStep:e=>{var t;let{mappedBlockIds:o,mappedOperations:n}=e;if(!b.state)throw new Error("No state");b.setState({...b.state,temporaryClientSteps:[...b.state.temporaryClientSteps,{type:"assistantChat",blockIds:o,operations:n,thought:b.state.temporaryThought,inferenceId:null===(t=S.state)||void 0===t?void 0:t.inferenceIdIfCommitting}]})},appendAssistantChatMdClientStep:e=>{if(!b.state)throw new Error("No state");b.setState({...b.state,temporaryClientSteps:[...b.state.temporaryClientSteps,{type:"assistantChatText",text:e}]})},appendAssistantThinkClientStep:e=>{if(!b.state||!S.state)throw new Error("No state");b.setState({...b.state,temporaryClientSteps:S.state.isLabelerSlackMode?[...b.state.temporaryClientSteps,{type:"assistantThink",thought:e}]:b.state.temporaryClientSteps,temporaryThought:e})},appendAssistantSearchPeopleClientStep:e=>{if(!b.state)throw new Error("No state");b.setState({...b.state,temporaryClientSteps:[...b.state.temporaryClientSteps,{type:"assistantSearchPeople",search:e,thought:b.state.temporaryThought}]})},setSamplingPrompt(e){b.state&&b.setState({...b.state,samplingPrompt:e})},getAttributionActor:()=>w},x=new ro({context:{mode:"direct","available-commands":m.YK},assistantEvaluatorStateCallbacks:k,environment:t,isQnA:p,sessionId:v});S.setState({sessionId:v,startTimestamp:Date.now(),temporaryCache:new r.Z({name:"assistantActions.temporaryCache"}),sampling:!1,evaluating:!1,committing:!1,searchCache:new vt.Z,isQnA:Boolean(p),isLabelerSlackMode:Boolean(i),inferenceIdIfCommitting:void 0,limitEditsInsideBlockSubtree:u,preventSelection:g??!1}),b.setState({clientSteps:[],sampledSteps:[],isCurrentlyCommittingHumanStep:!1,previewingStep:void 0,previewingStepIndex:void 0,previewingStepObservations:[],evaluator:new se(x),temporaryOperations:[],uncommittedOperations:[],temporaryClientSteps:[],temporaryThought:"",temporaryAssistantOperations:[],samplingPrompt:void 0,selectedBlocks:new Set,primeTextInput:d,selectedSkill:h,attributionActor:w,randomIdIndex:0,randomIdCache:[]}),zt.default.state.currentUserStore&&zt.default.state.currentSpaceStore&&await Tt.publishAiSession(t,{id:v,inference_type:p?"qna":"assistant",spaceId:zt.default.state.currentSpaceStore.id,metadata:{userId:zt.default.state.currentUserStore.id,spaceId:zt.default.state.currentSpaceStore.id}});const I=io();if(I){var C;if(!b.state||!S.state)throw new Error("No state");const e=x.getIdMapper(),r="cursor"===(null==o?void 0:o.type)||"textSelection"===(null==o?void 0:o.type)?{type:"text",start:{blockId:e.mapKeyToCounter({key:o.textSelection.start.store.id,type:"block"}),index:o.textSelection.start.index},end:{blockId:e.mapKeyToCounter({type:"block",key:o.textSelection.end.store.id}),index:o.textSelection.end.index}}:"blockSelection"===(null==o?void 0:o.type)?{type:"block",blockIds:o.stores.map((t=>e.mapKeyToCounter({type:"block",key:t.id})))}:void 0;x.setAssistantSelection(r);const i=await async function(){const{currentUserStore:e}=zt.default.state;if(!e)throw new Error("No current user");const t=e.getValue();if(!t)throw new Error("No current user value");const o=io();if(!o)throw new Error("No current block store");if((0,jt.Gw)()){const e=(await(0,Lt.s)(o)).find((e=>e.table===de.iU&&e.getParentId()===le.TM));if(e){const t=e.getPropertyValue(le.Ox),n=(0,xt.lcG)(t);if(n[0]){const e=Jt.U6.createChildStore(o,{table:wt.KJ,id:n[0]});await e.load();const t=e.getValue();if(t)return{id:t.id,name:t.name}}throw new Error("No user found")}}return{id:t.id,name:t.name}}();let c;if(h){const t="persisted"===h.type?h.skillStore:void 0;t&&await t.load(),c=null!=t&&t.isType("custom")&&t.getInstructionsPageBlockId()?e.mapKeyToCounter({type:"block",key:t.getInstructionsPageBlockId()}):e.mapKeyToCounter({type:"skill",key:h.key})}const d=function(e){const{currentUserInfo:t,currentSpaceName:o,idMapper:r,isQnA:i,isLabelerSlackMode:a,fakeSlackChannel:s,skillPageId:l,isGptAssistant:c}=e,d=n.ou.local().toISO({suppressMilliseconds:!0}),p=t.name,{mainEditorCurrentBlockStore:u}=zt.default.state,g=u&&(0,xt.QaF)(u.getBlockTitleStore().getValue())||"",h=()=>r.mapKeyToCounter({type:"block",key:e.currentPageId}),f=()=>r.mapKeyToCounter({type:"person",key:t.id}),y=()=>r.mapKeyToCounter({type:"slack-thread",key:"T0123456789"});return c?{mode:"direct","available-commands":m.YK,"current-datetime":d,...u&&{"current-page-id":h(),"current-page-name":g}}:i?{mode:"direct","available-commands":["chat","search"],"current-datetime":d,"current-person-id":f(),...p&&{"current-person-name":p},...o&&{"current-space-name":o}}:a?{mode:"shared","available-commands":m.YK,...l&&{"instructions-page-id":l},"current-page-id":h(),...s&&{"current-channel":s},"current-datetime":d,"current-thread-id":y()}:{mode:"direct","available-commands":m.YK,...l&&{"instructions-page-id":l},"current-page-id":h(),"current-datetime":d,"current-person-id":f(),...p&&{"current-person-name":p},...o&&{"current-space-name":o}}}({idMapper:e,isQnA:S.state.isQnA,isLabelerSlackMode:S.state.isLabelerSlackMode,skillPageId:c,currentPageId:I.id,currentUserInfo:i,currentSpaceName:null===(C=zt.default.state.currentSpaceStore)||void 0===C?void 0:C.getName(),fakeSlackChannel:a,isGptAssistant:f}),p=b.state.evaluator.createContextStep(d),u=await vo({environment:t,step:p,commit:!0,isStreaming:!1,sessionId:v});u.length>0&&Mt.showMessage({message:JSON.stringify(u)});const g=f?[]:l.oA([d["current-page-id"],c]);g.length>0&&await uo({environment:t,mappedPageIds:g,xmlEvaluatorState:x,sessionId:v});const y=b.state.evaluator.getTranscript().find((e=>"observation"===e.type&&"page"===e.observationType&&e.pageId===c));if(y){const e=(0,s.J7)({pageObservations:[y]});e.length>0&&await uo({environment:t,mappedPageIds:e,xmlEvaluatorState:x,sessionId:v})}b.setState({...b.state,clientSteps:[],temporaryClientSteps:[],temporaryThought:""})}return{sessionId:v}}async function lo(e){const{environment:t}=e,o=e.sessionId??Kt.Z.getActiveSessionId(),n=o?Kt.Z.getSessionContext(o):void 0;if(!o||!n)throw new Error("No active session available to reset.");So({environment:t,sessionId:o});const{assistantConfigurationStore:r}=n;if(!r.state)throw new Error("No configuration state");const{inMemoryRecordCache:i}=t.defaultRecordCache,{temporaryCache:a}=r.state;return a.clearCache(),i.removeCacheOverride(a),await so({...n.sessionMetadata,environment:t})}async function co(e){const{environment:t}=e,o=e.sessionId??Kt.Z.getActiveSessionId(),n=o?Kt.Z.getSessionContext(o):void 0;if(!n)throw new Error("No active session available to reset.");const{assistantRuntimeStore:r}=n;if(!r.state)throw new Error("No assistant runtime or configuration context found.");const{clientSteps:i}=r.state,{newClientSteps:a,lastHumanInput:s}=function(e){const t=[],o=l.GY(e),n=o.findIndex((e=>"human"===e.type)),r=o[n];if(r){let e=0;for(const r of o)e<=n||t.push(r),e+=1}const i="human"===r.type?null==r?void 0:r.text:void 0;return{newClientSteps:l.GY(t),lastHumanInput:i}}(i),{sessionId:c}=await so({environment:t,...n.sessionMetadata,makeActiveSession:!1});return Kt.Z.getSessionContextOrThrow(c).assistantRuntimeStore.update((e=>e?{...e,temporaryClientSteps:[],clientSteps:a,temporaryThought:""}:void 0)),Kt.Z.update((e=>({...e,activeAiSessionId:c}))),s}async function po(e){const{environment:t,text:o,fakeUser:r,sessionId:i}=e;if(!t.currentUser.id)throw new Error("No current user.");const a=Kt.Z.getSessionContextOrThrow(i),{assistantRuntimeStore:s,assistantConfigurationStore:d}=a;if(!s.state||!d.state)throw new Error("No runtime or configuration state");Zt.default.markAllOf(["qna.ttft.question_generation","qna.search","qna.ttft.answer","qna.ttft.answer.think","qna.ttft.answer.chat"]);try{var p,g;s.setState({...s.state,isCurrentlyCommittingHumanStep:!0});const{evaluator:e,previewingStep:a}=s.state,h=(0,c.ZP)(),f=Date.now();d.state.isQnA&&Ct.YdN(t,d.state,h,!1),a&&await fo({environment:t,sessionId:i}),await e.refreshPageObservations();const{humanStepValue:y,loadPageIds:b}=await async function(e){const{environment:t,text:o,fakeUser:r,sessionId:i}=e,a=t.currentUser.id;if(!a)throw new Error("No current user.");const s=Kt.Z.getSessionContextOrThrow(i),{assistantRuntimeStore:c,assistantConfigurationStore:d}=s;if(!c.state||!d.state)throw new Error("No runtime or configuration state");if(d.state.isLabelerSlackMode&&!r)throw new Error("No fake user but in Slack mode");if(!d.state.isLabelerSlackMode&&r)throw new Error("Supplied fake user but not in Slack mode");const{evaluator:p}=c.state,g=p.codeEvaluator.state,{temporaryCache:h}=d.state,f=new Set,y=yt.s8.fromGetRecordModelFn(yt.om.fromGetRecordValueFn(h.makeGetRecordValueFn(a)));for(const n of o){const e=(0,xt.hDy)(n),o=(0,xt.V8Y)(e);if(o){const e=(0,xt.yrl)(o);e&&f.add(g.getIdMapper().mapKeyToCounter({type:"block",key:e.id}))}const r=(0,xt.rlz)(e);if(r){const e=(0,xt.zW$)(r);if(e){const o=(0,_t.Wj)({url:e,isMobile:t.device.isMobile,baseUrl:Nt.default.domainBaseUrl,publicDomainName:Nt.default.publicDomainName,protocol:Nt.default.protocol,currentUrl:window.location.href});"page"===o.name&&f.add(g.getIdMapper().mapKeyToCounter({type:"block",key:o.blockId}))}}}const b=await(0,st.EK)({textValue:o,allowsText:!0,allowedTagNames:(0,u.Yd)(v.t),loadRecordModel:y,intl:Ot.default.getIntl()}),S=b.map((e=>g.getIdMapper().mapNodeKeyToCounter(e))).map((e=>(0,m.p1)({node:e,state:g,ignoreSelection:!0}))).join("");let _;if(r){const e={type:"element",tagName:"chat",attributes:{"person-id":g.getIdMapper().mapKeyToCounter({type:"person",key:r.id}),"person-name":r.name||"",datetime:n.ou.local().toISO({suppressMilliseconds:!0}),"message-id":g.getIdMapper().mapKeyToCounter({type:"slack-message",key:l.EL()})},children:[{type:"element",tagName:"text",attributes:{},children:[{type:"text",value:S}]}]};_=(0,m.KT)(e)}else _=`<chat><text>${S}</text></chat>`;return{humanStepValue:_,loadPageIds:Array.from(f.values())}}({text:o,environment:t,fakeUser:r,sessionId:i});s.setState({...s.state,clientSteps:[...s.state.clientSteps,{type:"human",fakeUser:r,text:o}]});const S=e.createHumanStep(y);await vo({environment:t,step:S,commit:!0,isStreaming:!1,sessionId:i}),s.setState({...s.state,clientSteps:[...s.state.clientSteps,...s.state.temporaryClientSteps],sampledSteps:[],previewingStep:void 0,previewingStepIndex:void 0,previewingStepObservations:[],temporaryOperations:[],temporaryClientSteps:[],temporaryThought:"",temporaryAssistantOperations:[]}),b.length>0&&await uo({environment:t,mappedPageIds:b,xmlEvaluatorState:e.codeEvaluator.state,sessionId:i}),await ho({environment:t,inferenceId:h,sessionId:i}),null!=d&&null!==(p=d.state)&&void 0!==p&&p.isQnA&&Ct.Vry(t,d.state,h,Date.now()-f);const _=null===(g=zt.default.state.currentSpaceStore)||void 0===g?void 0:g.id;_&&Et.updateAiEligibility(t,_)}finally{s.setState({...s.state,isCurrentlyCommittingHumanStep:!1}),eo.N.setState({...eo.N.state,lastStepLoadingCompletionUnixEpochMs:Date.now()})}}async function uo(e){const{environment:t,mappedPageIds:o,sessionId:n}=e,r=Kt.Z.getSessionContextOrThrow(n),{assistantRuntimeStore:i,assistantConfigurationStore:a}=r;if(!i.state||!a.state)throw new Error("No runtime or configuration state");const{evaluator:s}=i.state,c=l.jj(o).filter((e=>!s.getTranscript().find((t=>"observation"===t.type&&"page"===t.observationType&&t.pageId===e))));if(0===c.length)return;const d=c.map((e=>`<load-page id="${e}"/>`)).join(""),p=i.state.evaluator.createAssistantStep(d),u=(await vo({environment:t,step:p,commit:!0,isStreaming:!1,sessionId:n})).find((e=>"error"===e.observationType));u&&Mt.showMessage({message:u.value}),i.setState({...i.state,clientSteps:[...i.state.clientSteps,...i.state.temporaryClientSteps],sampledSteps:[],previewingStep:void 0,previewingStepIndex:void 0,previewingStepObservations:[],temporaryOperations:[],temporaryClientSteps:[],temporaryThought:"",temporaryAssistantOperations:[]})}async function mo(e){var t,o,n;const{environment:r,sessionId:i}=e,a=Kt.Z.getSessionContextOrThrow(i),{assistantRuntimeStore:s,assistantConfigurationStore:l}=a;if(!s.state||!l.state)throw new Error("No runtime or configuration state");s.setState({...s.state,sampledSteps:[],previewingStep:void 0,previewingStepIndex:void 0,previewingStepObservations:[],temporaryOperations:[],temporaryClientSteps:[],temporaryThought:"",temporaryAssistantOperations:[]});const d=(0,c.ZP)(),p=Date.now();null!=l&&null!==(t=l.state)&&void 0!==t&&t.isQnA&&Ct.YdN(r,l.state,d,!0),await ho({environment:r,inferenceId:d,sessionId:i}),null!=l&&null!==(o=l.state)&&void 0!==o&&o.isQnA&&Ct.Vry(r,l.state,d,Date.now()-p);const u=null===(n=zt.default.state.currentSpaceStore)||void 0===n?void 0:n.id;u&&Et.updateAiEligibility(r,u)}function go(e){var t;const{evaluator:o,currentStep:n,currentId:r,environment:i,assistantRuntimeStore:a}=e;if(!a.state)return;const s=null===(t=a.state.sampledSteps.find((e=>e.id===r)))||void 0===t?void 0:t.value;let l=o.getTranscript()[o.getTranscript().length-1];"human"===l.type&&l.value.startsWith("<instructions-page")&&(l=o.getTranscript()[o.getTranscript().length-2]),"human"!==l.type||s||Zt.default.measure("qna.ttft.question_generation",{environment:i}),"observation"===l.type&&"search"===l.observationType&&(s||Zt.default.measure("qna.ttft.answer",{environment:i}),null!=s&&s.includes("<think>")||!n.value.includes("<think>")||Zt.default.measure("qna.ttft.answer.think",{environment:i}),null!=s&&s.includes("<chat>")||!n.value.includes("<chat>")||Zt.default.measure("qna.ttft.answer.chat",{environment:i}))}async function ho(e){const{environment:t,inferenceId:o,sessionId:n}=e,{currentSpaceStore:r,currentUserStore:i}=zt.default.state;if(!r)throw new Error("No current space");if(!i)throw new Error("No current user");const a=Kt.Z.getSessionContextOrThrow(n),{assistantRuntimeStore:d,assistantConfigurationStore:p}=a;if(!d.state||!p.state)throw new Error("No runtime or configuration state");const{evaluator:u}=d.state,g=(0,jt.Gw)()?2:1,h=l.w6(g);d.setState({...d.state,sampledSteps:h.map((e=>({id:e,type:"assistant",inferenceId:void 0,value:""})))}),p.setState({...p.state,sampling:!0});const f=h[Math.floor(Math.random()*h.length)];let y=!1;const v=l.P2((async()=>{if(y||!p.state||!d.state)return;const e=d.state.sampledSteps.at(f);e&&await vo({environment:t,step:e,commit:!1,isStreaming:!0,sessionId:n})}),Et.COMPLETION_THROTTLE);try{await Promise.all(h.map((async e=>{const n=u.streamSampleNextStep(o);for await(const o of n){var r;if(!d.state)throw new Error("No state");const n=o.id;null!==(r=p.state)&&void 0!==r&&r.isQnA&&0===e&&u.getTranscript().length<=7&&go({evaluator:u,currentId:n,currentStep:o,environment:t,assistantRuntimeStore:d});const i=d.state.sampledSteps.map(((t,n)=>n===e?o:t));d.setState({...d.state,sampledSteps:i}),e===f&&v()}})))}catch(C){console.error(C);const e=C.message||JSON.stringify(C)||"Unknown error";Mt.showMessage({message:e})}y=!0,p.setState({...p.state,sampling:!1}),p.state.isLabelerSlackMode&&d.state.sampledSteps.map((e=>e.value=(0,s.k5)(e.value)));const b=d.state.sampledSteps[f];await vo({environment:t,step:b,commit:!1,isStreaming:!1,sessionId:n});const{previewingStep:S,previewingStepObservations:_,samplingPrompt:w}=d.state;if(!S)throw new Error("No previewing step");const k=u.getTranscript(),x=at(k);(0,jt.Gw)()||Tt.saveAssistantFeedback(t,{id:(0,c.ZP)(),type:"assistant_step",start_transcript_steps:k,task_type:void 0,start_state:u.codeEvaluator.state.getSerializedState(),prompt:w,transcript:x,output:S.value,observationSteps:_,observation:_.map((e=>e.value)).join("\n"),space_id:r.id,user_id:i.id,client_version:m.C1,timestamp:Date.now(),is_shared_with_space:ko({sessionId:n}),is_search:p.state.isQnA});const I=_.some((e=>"error"!==e.observationType));!(0,jt.Gw)()&&I&&await fo({environment:t,sessionId:n})}async function fo(e){var t;const{environment:o,sessionId:n}=e,r=Kt.Z.getSessionContextOrThrow(n),{assistantRuntimeStore:i,assistantConfigurationStore:a}=r;if(!i.state||!a.state)throw new Error("No runtime or configuration state");const{previewingStep:s,samplingPrompt:l,evaluator:d,sampledSteps:p}=i.state,{currentSpaceStore:u,currentUserStore:g}=zt.default.state;if(!s)throw new Error("No previewing step");if(!u)throw new Error("No current space");if(!g)throw new Error("No current user");const h=d.getTranscript(),f=at(h),y=d.codeEvaluator.state.getSerializedState(),v=await vo({environment:o,step:s,commit:!0,isStreaming:!1,sessionId:n}),b=null===(t=$t.Hl.state)||void 0===t?void 0:t.type;2===p.length&&Tt.saveAssistantFeedback(o,{id:(0,c.ZP)(),type:"assistant_feedback",start_transcript_steps:h,task_type:b,start_state:y,prompt:l,transcript:f,option_a:p[0].value,option_b:p[1].value,selected_option:s.id===p[0].id?"a":"b",observationSteps:v,observation:v.map((e=>e.value)).join("\n"),space_id:u.id,user_id:g.id,client_version:m.C1,timestamp:Date.now()}),i.setState({...i.state,clientSteps:[...i.state.clientSteps,...i.state.temporaryClientSteps],sampledSteps:[],previewingStep:void 0,previewingStepIndex:void 0,previewingStepObservations:[],temporaryOperations:[],temporaryClientSteps:[],temporaryThought:"",temporaryAssistantOperations:[]}),v.length>0&&await ho({environment:e.environment,inferenceId:(0,c.ZP)(),sessionId:n})}function yo(e){const{sessionId:t}=e,o=Kt.Z.getSessionContextOrThrow(t),{assistantRuntimeStore:n,assistantConfigurationStore:r}=o;if(!n.state||!r.state)throw new Error("No runtime or configuration state");const{temporaryCache:i}=r.state;i.clearCache(),n.setState({...n.state,temporaryOperations:[],temporaryClientSteps:[],temporaryThought:"",temporaryAssistantOperations:[],previewingStep:void 0,previewingStepIndex:void 0,previewingStepObservations:[]})}async function vo(e){return oo.enqueue((async()=>{var t;const{environment:o,commit:n,isStreaming:r,sessionId:a}=e;let c=e.step;const d="assistant"===c.type?c.inferenceId:void 0;if(!o.currentUser.id)throw new Error("No current user.");const p=Kt.Z.getSessionContextOrThrow(a),{assistantRuntimeStore:u,assistantConfigurationStore:m}=p;if(!u.state||!m.state)throw new Error("No runtime or configuration state");u.setState({...u.state,randomIdIndex:0});const{evaluator:g}=u.state,{temporaryCache:h}=m.state,{inMemoryRecordCache:f}=o.defaultRecordCache,y=e.preventSelection??m.state.preventSelection;m.setState({...m.state,evaluating:!0}),h.clearCache(),h.cacheUsingThisInstanceAsAnOverride||f.addCacheOverride(h);const v=u.state.temporaryClientSteps;if(u.setState({...u.state,temporaryOperations:[],temporaryClientSteps:[],temporaryThought:"",temporaryAssistantOperations:[]}),m.setState({...m.state,committing:!0,inferenceIdIfCommitting:d}),!m.state)throw new Error("No state.");const{uncommittedOperations:b}=u.state;b.length>0&&To({environment:o,operations:b,sessionId:a}),"assistant"!==c.type||n||(c={...c,value:(0,s.rr)(c.value)}),"assistant"===c.type&&m.state.isQnA&&(c={...c,value:(0,s.R4)(c.value)});const S=await(n?g.commitStep(c):g.simulateStep(c)),_=S.find((e=>"error"===e.observationType));if(_&&m.state.temporaryCache.clearCache(),_&&!r){const e=at(g.getTranscript());gt.log({level:"error",from:"assistantActions",type:"assistantStepError",data:{miscDataToConvertToString:{step:c,transcript:e,observations:S}}})}if(n||"assistant"!==c.type||u.setState({...u.state,previewingStep:c,previewingStepIndex:u.state.sampledSteps.indexOf(c),previewingStepObservations:S}),n&&(null===(t=u.state)||void 0===t?void 0:t.temporaryOperations.length)>0&&u.setState({...u.state,uncommittedOperations:[...u.state.uncommittedOperations,...u.state.temporaryOperations]}),_&&r&&u.setState({...u.state,temporaryClientSteps:v}),!_&&u.state.temporaryAssistantOperations.length>0&&u.setState({...u.state,temporaryClientSteps:[...u.state.temporaryClientSteps,{type:"assistantTransaction",operations:u.state.temporaryAssistantOperations,thought:u.state.temporaryThought}]}),_){const e=[...b,...u.state.temporaryOperations];e.length>0&&(h.clearCache(),To({environment:o,operations:e,sessionId:a}))}return _||y||i.default.afterNextFlush((()=>{const e=u.state;if(!e)return;const t=l.oA(e.temporaryOperations.map((e=>{let{pointer:t}=e;return t.table===de.iU?t.id:void 0}))),o=Vt.C.findScrollToSelectablesFromIds(t).map((e=>e.props.store));u.setState({...e,selectedBlocks:new Set(o)}),Dt.hl(t,!1)})),n&&u.setState({...u.state,randomIdIndex:0,randomIdCache:[]}),m.setState({...m.state,evaluating:!1,committing:!1}),S}))}async function bo(e){const{environment:t,sessionId:o}=e,n=t.currentUser.id;if(!n)throw new Error("No current user.");const r=Kt.Z.getSessionContextOrThrow(o),{assistantRuntimeStore:i,assistantConfigurationStore:a}=r;if(!i.state||!a.state)throw new Error("No runtime or configuration state");a.state.temporaryCache.clearCache();const{evaluator:s}=i.state,l=new Set,c=St.dr.isEqual(i.state.attributionActor,{id:n,table:wt.KJ});Rt.createAndCommit({environment:t,perform(e){if(!i.state)throw new Error("No state.");for(const o of i.state.uncommittedOperations){const n=new Jt.ST({environment:t,pointer:o.pointer,path:o.path});if(Rt.applyOperation({store:n,operation:o,transaction:e}),o.pointer.table===de.iU){const e=Jt.G.createChildStore(n,o.pointer).getValue();if("page"===(null==e?void 0:e.type)){if(!(0,y.yM)(e.id))throw new Error("Expected block to be mapped.");l.add(e.id)}}}},userAction:"assistantActions.applyUncommittedOperations",userId:n,...!c&&{skipUpdatingEditedMetadata:!0}});const d=s.codeEvaluator.state;if(l.size>0)for(const p of l){const e=d.getIdMapper().mapKeyToCounter({type:"block",key:p});d.getLoadedPageIds().includes(e)||await s.loadPageWithoutAssistantStep(d.getIdMapper().mapKeyToCounter({type:"block",key:p}))}i.setState({...i.state,uncommittedOperations:[]})}function So(e){const{environment:t,sessionId:o}=e;if(!t.currentUser.id)throw new Error("No current user.");const n=Kt.Z.getSessionContextOrThrow(o),{assistantRuntimeStore:r,assistantConfigurationStore:i}=n;if(!r.state||!i.state)throw new Error("No runtime or configuration state");i.state.temporaryCache.clearCache(),r.setState({...r.state,uncommittedOperations:[]})}function _o(e){let{environment:t,inferenceId:o,feedbackType:n,skillType:r}=e;const{currentSpaceStore:i,currentUserStore:a}=zt.default.state;if(!i)throw new Error("No current space");if(!a)throw new Error("No current user");Tt.saveAssistantFeedback(t,{id:o,type:n,skillType:r,space_id:i.id,user_id:a.id,client_version:m.C1,timestamp:Date.now()})}async function wo(e){var t;const{environment:o,type:n,inferenceId:r,sessionId:i}=e,a=Kt.Z.getSessionContextOrThrow(i),{assistantRuntimeStore:s,assistantConfigurationStore:c}=a;if(!s.state||!c.state)throw new Error("No runtime or configuration state");const{previewingStep:d,samplingPrompt:p,evaluator:u}=s.state,{currentSpaceStore:g,currentUserStore:h}=zt.default.state;if(!g)throw new Error("No current space");if(!h)throw new Error("No current user");const f=u.getTranscript(),y=at(f),v=u.codeEvaluator.state.getSerializedState();let b=[],S="";if(d)b=await vo({environment:o,step:d,commit:!1,isStreaming:!1,sessionId:i}),S=d.value;else{const e=l.dF(f,ae);e&&(S=e.value)}const _=null===(t=$t.Hl.state)||void 0===t?void 0:t.type;"assistant_thumbs_up"!==n&&"assistant_thumbs_down"!==n||Ct.CNn(o,c.state,r,"assistant_thumbs_up"===n?"thumbs_up":"thumbs_down"),Tt.saveAssistantFeedback(o,{id:r,type:n,start_transcript_steps:f,task_type:_,start_state:v,prompt:p,transcript:y,output:S,observationSteps:b,observation:b.map((e=>e.value)).join("\n"),space_id:g.id,user_id:h.id,client_version:m.C1,timestamp:Date.now(),is_shared_with_space:ko({sessionId:i}),is_search:c.state.isQnA})}function ko(e){const{sessionId:t}=e,o=io(),n=Kt.Z.getSessionContextOrThrow(t),{assistantRuntimeStore:r,assistantConfigurationStore:i}=n;if(!r.state||!i.state)throw new Error("No runtime or configuration state");if(!o)throw new Error("No current block store");const a=r.state.evaluator.codeEvaluator.state,s=a.getLoadedPageIds();return l.oA(s.map((e=>{const t=a.getIdMapper().mapCounterToKey(e);if("block"===t.type)return t.key}))).map((e=>Jt.G.createChildStore(o,{table:de.iU,id:e,spaceId:o.getSpaceId()}))).every((e=>(0,Ut.UK)(e)))}function xo(e){const{assistantRuntimeStore:t}=e;if(!t.state)throw new Error("Expecting state");t.setState({...t.state,primeTextInput:void 0})}const Io={AssistantActionsXMLEvaluatorState:ro};async function Co(e){const{environment:t,blockStore:o}=e,n=(0,Xt.lJ)(o),r=o.getNavigableBlockStore(),i=o.getRecordStoreUIRoot(),a=(0,Ft.Dj)(i);if(n&&r&&i&&i instanceof Jt.G){const e=(0,c.ZP)();qt.Z.setIsGeneratingFor(o.id),Ct.RLv(t,{type:"generate",prompt_key:n.key}),"meeting_summary"===n.skillType&&It.j({name:"ai_meeting_notes_summarize_button_clicked"});const i=o.getContentStores().filter(((e,t)=>{const o=e.getLastEditedByPointer(),n=0===t&&e.isEmptyTextBlock(),r=e.getDiscussionStores().length>0;return Boolean(n||o&&St.dr.isEqual(o,ht.GR.pointer)&&!r)}));i.length>0&&Rt.createAndCommit({userAction:"assistantActions.clearPreviousAiItems",environment:t,perform:e=>{for(const t of i)Pt.Od({parent:o.getContentStore(),childToRemove:t,transaction:e})}});const{sessionId:s}=await so({environment:t,completionContext:{type:"blockSelection",stores:[o],currentPage:r,origin:o,scrollerStore:a},clientSkill:n,preventSelection:!0,limitEditsInsideBlockSubtree:o,isQnA:!1});await ho({environment:t,inferenceId:e,sessionId:s}),await fo({environment:t,sessionId:s}),await bo({environment:t,sessionId:s}),Rt.createAndCommit({userAction:"assistantActions.fillInAiSection",environment:t,perform:t=>{Rt.applyOperation({store:o,operation:bt.op.update({pointer:o.pointer,path:["format"],args:{ai_last_edited:Date.now(),ai_inference_id:e}}),transaction:t})}}),qt.Z.setGenerationCompleteFor(o.id)}}function To(e){const{environment:t,operations:o,sessionId:n}=e,r=t.currentUser.id;if(!r)throw new Error("No current user.");const i=Kt.Z.getSessionContextOrThrow(n),{assistantRuntimeStore:a,assistantConfigurationStore:s}=i;if(!a.state||!s.state)throw new Error("No runtime or configuration state");const{temporaryCache:l}=s.state,c=St.dr.isEqual(a.state.attributionActor,{id:r,table:wt.KJ});Rt.createAndCommit({environment:t,perform(e){for(const n of o){const o=new Jt.ST({environment:t,pointer:n.pointer,path:n.path,inMemoryRecordCache:l});Rt.applyOperation({store:o,operation:n,transaction:e})}},userAction:"assistantActions.simulateOrCommitStep",userId:r,...!c&&{skipUpdatingEditedMetadata:!0}})}},33932:(e,t,o)=>{o.d(t,{O:()=>r,r:()=>i});var n=o(56206);function r(e){n.d.setState({open:!0,currentView:e.view})}function i(){n.d.setState({...n.d.state,open:!1})}},81582:(e,t,o)=>{o.d(t,{WE:()=>_,lJ:()=>k,Qv:()=>w,AN:()=>C,jo:()=>I});o(57658);var n=o(91644);const r={type:"custom",version:1,getPersistedInAppSkillTrigger:()=>({requiresInput:!0}),getSlackSkillTriggers:e=>{let{skillValue:t}=e;if("custom"!==t.type)return;return[{skillPointer:{table:n.AT,id:t.id,spaceId:t.space_id},name:"custom",messageTrigger:"only_when_mentioned_after_first",loadAdditionalPages:[]}]}};var i=o(21202);const a={type:"tasks_slack",version:1,getSlackSkillTriggers(e){var t,o;let{skillValue:r}=e;if("tasks_slack"!==r.type)return;const a={table:n.AT,id:r.id,spaceId:r.space_id},{team_block_id:s,tag_ids:l}=(null===(t=r.settings)||void 0===t?void 0:t.tasks_team_options)??{};return[{skillPointer:a,name:"taskFiling",messageTrigger:"only_when_mentioned_after_first",loadAdditionalPages:[null===(o=r.settings)||void 0===o?void 0:o.tasks_collection_view_block_id,s,...l??[]].map((e=>e?{table:i.iU,id:e,spaceId:r.space_id}:void 0)).filter((e=>Boolean(e))),instructionsPageContext:{type:"tasks_slack",teamBlockId:s}}]}};var s=o(72126),l=o(15047),c=o(97880),d=o(63143);const p={custom:r,summarize:{type:"summarize",version:1,getGlobalInAppSkillTrigger:()=>({instructionsPageContext:{type:"summarize"},requiresInput:!1})},wiki_slack:{type:"wiki_slack",version:1,getSlackSkillTriggers(e){let{skillValue:t}=e;if("wiki_slack"!==t.type)return;const{search_context:o,qna_collection_view_block_id:r,qna_ingestion_confirm_edits:a}=t.settings??{},p={table:n.AT,id:t.id,spaceId:t.space_id},u=r?{table:i.iU,id:r,spaceId:t.space_id}:void 0,m=[];return o&&(o.table===i.iU?m.push(o.id):o.table===l.bx||(0,c.t1)(o)),s.oA([{skillPointer:p,instructionsPageContext:{type:"wiki_slack_answer"},name:"answer",messageTrigger:"only_when_mentioned_after_first",loadAdditionalPages:[],searchFilters:{ancestors:m}},u&&{skillPointer:p,instructionsPageContext:{type:"wiki_slack_qna_ingestion"},name:"qnaIngestion",messageTrigger:"always",delaySeconds:d.d,...a?{autoConfirmEdits:!1,isBackground:!1}:{autoConfirmEdits:!0,isBackground:!0},loadAdditionalPages:s.oA([u]),searchFilters:{ancestors:m}}])}},tasks_slack:a,meeting_summary:{type:"meeting_summary",version:1,getLocalInEditorSkillTrigger:e=>{let{positionBlockId:t}=e;return{instructionsPageContext:{type:"meeting_summary",positionBlockId:t},loadAdditionalPages:[]}}},meeting_action_items:{type:"meeting_action_items",version:1,getLocalInEditorSkillTrigger:e=>{let{positionBlockId:t}=e;return{instructionsPageContext:{type:"meeting_action_items",positionBlockId:t},loadAdditionalPages:[]}}}};var u=o(91856),m=o(20669),g=o(24600),h=o(5366),f=o(98165),y=o(80444),v=o(21273),b=o(35661),S=o(89912);function _(e){const t=e.getValue();if(t&&t.alive){var o,n;const r=p[t.type],i=null===(o=r.getPersistedInAppSkillTrigger)||void 0===o?void 0:o.call(r,{skillValue:t}),a=null===(n=r.getSlackSkillTriggers)||void 0===n?void 0:n.call(r,{skillValue:t});if(i||a)return{key:e.id,type:"persisted",skillType:t.type,skillStore:e,inAppSkillTrigger:i,slackSkillTriggers:a}}}(0,c.AO)((e=>"persisted"===e.type?{true:e}:{false:e}));function w(){const{currentSpaceStore:e,mainEditorCurrentBlockStore:t}=y.default.state;if(!e)return[];const o=(t?(0,f.uJ)(t):[]).map((e=>e.id)),r=v.Z.allowCustomSkillCreation(),i=[];for(const n of Object.values(p)){var a;const e=null===(a=n.getGlobalInAppSkillTrigger)||void 0===a?void 0:a.call(n,{});e&&i.push({key:n.type,type:"global",skillType:n.type,inAppSkillTrigger:e})}const s=S.L.getSkillIds();for(const d of s){const t=b.Vf.createChildStore(e,{table:n.AT,id:d,spaceId:e.id}),a=t.getValue();if(a&&a.alive){var l,c;const e=p[a.type],n=r||o.includes(a.parent_id)?null===(l=e.getPersistedInAppSkillTrigger)||void 0===l?void 0:l.call(e,{skillValue:a}):void 0,s=null===(c=e.getSlackSkillTriggers)||void 0===c?void 0:c.call(e,{skillValue:a});(n||s)&&i.push({key:d,type:"persisted",skillType:a.type,skillStore:t,inAppSkillTrigger:n,slackSkillTriggers:s})}}return i}function k(e){var t,o;const n=e.getCurrentSkillType();if(!n)return;const r=null===(t=p[n])||void 0===t||null===(o=t.getLocalInEditorSkillTrigger)||void 0===o?void 0:o.call(t,{positionBlockId:e.id});return r?{key:n,type:"local",skillType:n,inEditorSkillTrigger:r}:void 0}const x=(0,h.defineMessages)({summarize:{defaultMessage:"Summarize",id:"skills.summarize"},custom:{defaultMessage:"Custom skill",id:"skills.custom"},wikiSlack:{defaultMessage:"Answer questions from Slack",id:"skills.wikiSlack"},tasksSlack:{defaultMessage:"Add tasks from Slack",id:"skills.tasksSlack"},meeting_summary:{defaultMessage:"Summarize your meeting",id:"skills.meeting_summary"},meeting_action_items:{defaultMessage:"Extract action items from your meeting",id:"skill.meeting_action_items"}}),I={summarize:x.summarize,custom:x.custom,wiki_slack:x.wikiSlack,tasks_slack:x.tasksSlack,meeting_summary:x.meeting_summary,meeting_action_items:x.meeting_action_items},C={summarize:u.Y,custom:m.y,wiki_slack:g.P,tasks_slack:g.P,meeting_summary:m.y,meeting_action_items:m.y}},56206:(e,t,o)=>{o.d(t,{d:()=>a});var n=o(49085),r=o(92595);class i extends n.default{getInitialState(){return{open:!1,currentView:"chat"}}}const a=new i;(0,r.exposeDebugValue)("AssistantMenuStore",a)},40824:(e,t,o)=>{o.d(t,{N:()=>a});var n=o(49085),r=o(92595);class i extends n.default{getInitialState(){return{currentState:"default",lastStepLoadingCompletionUnixEpochMs:-1/0,aiWindowLastSeenUnixEpochMs:-1/0}}setAssistantLastViewedTime(){a.setState({...a.state,aiWindowLastSeenUnixEpochMs:Date.now()})}}const a=new i;(0,r.exposeDebugValue)("AssistantOriginElementStore",a)},89912:(e,t,o)=>{o.d(t,{L:()=>a});var n=o(49085),r=o(92595);class i extends n.default{getInitialState(){return{serverSkillIds:new Set,locallyCreatedSkillIds:new Set}}getSkillIds(){return Array.from(new Set([...this.state.serverSkillIds,...this.state.locallyCreatedSkillIds]))}addLocallyCreatedSkillId(e){this.state.locallyCreatedSkillIds.add(e),this.emit()}}const a=new i;(0,r.exposeDebugValue)("AssistantSkillsStore",a)},2553:(e,t,o)=>{o.d(t,{zY:()=>de,Hj:()=>ce,AN:()=>pe,oS:()=>he,Nj:()=>fe,sl:()=>me,kM:()=>ue});o(57658),o(67294);var n=o(1302),r=o(15145),i=o(63362),a=o(83372),s=o(81730);async function l(e){const{action:t,values:o,context:n}=e,r=(0,a.z)(t.getType());return await r.execute({...n,values:o},t)}var c=o(94412),d=o(10450),p=o(41432),u=o(84116),m=o(78106),g=o(76218),h=o(68626),f=o(42875),y=o(5366),v=o(4615),b=o(149),S=o(98963),_=o(18844),w=o(21202),k=o(23867),x=o(70203),I=o(97880),C=o(50906),T=o(98834),M=o(47307),P=o(54532),A=o(94419),D=o(13084),B=o(19785),R=o(68305),E=o(9953),F=o(82007),N=o(75018),j=o(24677),O=o(64964),L=o(98104),U=o(39699),Z=o(6854),V=o(95477),q=o(24215),z=o(30912),W=o(84210),H=o(33929),G=o(73959),K=o(77907),$=o(95802),Y=o(80444),Q=o(58454),J=o(88923),X=o(35661),ee=o(35057),te=o(45433);const oe=(0,y.defineMessages)({genericSuccessMessage:{id:"automations.buttonTrigger.genericSuccessMessage",defaultMessage:"Button automation ran successfully"},createdBlocks:{defaultMessage:"Created {numBlocksDuplicated, plural, one {1 block} other {{numBlocksDuplicated} blocks}} on page",id:"automations.buttonTrigger.createdBlocks"},createdSprintsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprints"},updatedSprintsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprints"},createdSprintsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprintsLowercase"},updatedSprintsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprintsLowercase"},createdTasksUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasks"},updatedTasksUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasks"},createdTasksLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasksLowercase"},updatedTasksLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasksLowercase"},createdProjectsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjects"},updatedProjectsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjects"},createdProjectsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjectsLowercase"},updatedProjectsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjectsLowercase"},createdPagesUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPages"},updatedPagesUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPages"},createdPagesLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPagesLowercase"},updatedPagesLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPagesLowercase"}}),ne=["sprint","task","project","page"],re={[te.wW]:"project",[te.iS]:"task",[te.zU]:"page",[te.Fi]:"page",[te.p$]:"sprint",[te.GZ]:"page",[te.nG]:"page",[te.Be]:"page"};function ie(e){const{typedAutomationExecutionSummary:t,numBlocksDuplicated:o,intl:n}=e,r=function(e){const{typedAutomationExecutionSummary:t,intl:o}=e,n=[];for(const i of ne){const e=t[i];if(e){const{numPagesCreated:t,numPagesEdited:o}=e;t>0&&n.push({pageType:i,modificationType:"created",numPagesModified:t}),o>0&&n.push({pageType:i,modificationType:"updated",numPagesModified:o})}}const r=n.slice(0,3).map(((e,t)=>{let{pageType:n,modificationType:r,numPagesModified:i}=e;const a=ae[n][r],s=0===t?a.start:a.append;return o.formatMessage(s,{numPagesModified:i})}));if(r.length>0)return o.formatList(r,{type:"conjunction",style:"long"})}({typedAutomationExecutionSummary:t,intl:n});return r||(o>0?n.formatMessage(oe.createdBlocks,{numBlocksDuplicated:o}):n.formatMessage(oe.genericSuccessMessage))}const ae={sprint:{created:{start:oe.createdSprintsUppercase,append:oe.createdSprintsLowercase},updated:{start:oe.updatedSprintsUppercase,append:oe.updatedSprintsLowercase}},task:{created:{start:oe.createdTasksUppercase,append:oe.createdTasksLowercase},updated:{start:oe.updatedTasksUppercase,append:oe.updatedTasksLowercase}},project:{created:{start:oe.createdProjectsUppercase,append:oe.createdProjectsLowercase},updated:{start:oe.updatedProjectsUppercase,append:oe.updatedProjectsLowercase}},page:{created:{start:oe.createdPagesUppercase,append:oe.createdPagesLowercase},updated:{start:oe.updatedPagesUppercase,append:oe.updatedPagesLowercase}}};var se=o(85893);const le=(0,y.defineMessages)({genericErrorMessage:{id:"automations.buttonTrigger.genericErrorMessage",defaultMessage:"Button failed to execute"},open:{defaultMessage:"Open",id:"automations.buttonTrigger.open"},undo:{defaultMessage:"Undo",id:"automations.buttonTrigger.undo"},defaultConfirmationWorkflowText:{defaultMessage:"Are you sure you want to continue?",id:"automations.buttonTrigger.defaultConfirmationWorkflowText"},defaultContinueWorkflowMessage:{defaultMessage:"Continue",id:"automations.buttonTrigger.defaultContinueWorkflowMessage"},defaultStopWorkflowMessage:{defaultMessage:"Cancel",id:"automations.buttonTrigger.defaultStopWorkflowMessage"},errorQueryCollectionTooManyPages:{defaultMessage:"Button impacts too many pages",id:"automations.buttonTrigger.errorQueryCollectionTooManyPages"},errorUserCancelled:{defaultMessage:"Button was cancelled",id:"automations.buttonTrigger.errorUserCancelled"}});function ce(e){const{environment:t,collectionStore:o,property:n,transaction:r}=e,i=(0,v.ZP)(),a=o.getSchema()[n];a&&"button"===a.type&&(E.ae({environment:t,table:S.cv,inMemoryRecordCache:o.inMemoryRecordCache,value:{id:i,parent_id:o.id,parent_table:o.table,alive:!0,space_id:o.getSpaceId(),status:"active",trigger:{id:(0,v.ZP)(),type:"button"}},transaction:r}),E.sW({store:o.getSchemaStore(),data:{[n]:{...a,automation_id:i}},transaction:r}))}function de(e){const{actionId:t,environment:o,intl:n,automationStore:r,actionType:i,transaction:a,insertionPoint:s,config:l,createDuplicateBlocksContainer:c=!0}=e,d=r.getSpaceId();if(!d)return;let p;"duplicate_blocks"===i&&c&&(p=E.j4({environment:o,inMemoryRecordCache:r.inMemoryRecordCache,transaction:a,type:"text",useCrdt:!1}));const u=l??function(e){const{actionType:t,intl:o}=e;if("modal_confirmation"===t)return{continue_button:{text:o.formatMessage(le.defaultContinueWorkflowMessage)},cancel_button:{text:o.formatMessage(le.defaultStopWorkflowMessage)},text:{type:"simple",value:(0,x.TPx)(o.formatMessage(le.defaultConfirmationWorkflowText))}}}({actionType:i,intl:n})??{},m=E.ae({environment:o,inMemoryRecordCache:r.inMemoryRecordCache,table:_.Xj,transaction:a,value:{id:t,type:i,parent_id:r.id,parent_table:S.cv,alive:!0,space_id:d,config:u,blocks:p?[p.id]:[]}});return p&&A.R3({transaction:a,parent:m.getKeyStore("blocks"),append:p}),!s||"afterActionId"in s?A.R3({transaction:a,parent:r.getActionIdsStore(),append:m,after:null==s?void 0:s.afterActionId}):"beforeActionId"in s?A.Ce({transaction:a,parent:r.getActionIdsStore(),prepend:m,before:s.beforeActionId}):(0,I.t1)(s),m}function pe(e){const{actionStore:t,automationStore:o,environment:n,intl:r,transaction:i}=e,a=(0,v.ZP)(),s=t.getType(),l=t.getConfig();if(!s)return{onComplete:Promise.resolve([])};const c=de({actionId:a,actionType:s,automationStore:o,config:l,environment:n,insertionPoint:{afterActionId:t.id},intl:r,transaction:i,createDuplicateBlocksContainer:!1});if(!c)return{onComplete:Promise.resolve([])};const d=t.getBlockStores().map((e=>{const[t,o]=P.Qi({environment:n,stores:[e],transaction:i,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!1,targetSpaceId:(0,k.C)(e.pointer.spaceId),baseUrl:V.default.domainBaseUrl,publicDomainName:V.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:!1}),r=t[0];return B.jG({transaction:i,parentStore:c,childStore:r}),o}));return{onComplete:Promise.all(d)}}function ue(e){const{clientContext:t,transaction:o,newActionIds:n}=e,{automationStore:r}=t,i=r.getValue();if(!i)return;E.sW({store:r,transaction:o,data:{action_ids:n}});ge({clientContext:t,transaction:o,automationValue:{...i,action_ids:n}})}function me(e){var t;const{clientContext:o,actionStore:n,transaction:r}=e,i=o.automationStore.getValue();if(!i)return;B.hr({parentStore:o.automationStore,childStore:n,transaction:r});ge({clientContext:o,transaction:r,automationValue:{...i,action_ids:null===(t=i.action_ids)||void 0===t?void 0:t.filter((e=>e!==n.id))}})}function ge(e){const{clientContext:t,automationValue:o,transaction:n}=e,r=t.automationStore.getSpaceId();if(!r)return;const i=(0,z.pt)({context:t,automationValue:o});if(!b.x.isFail(i))for(const s of o.action_ids??[]){const e=t.automationStore.getRecordStore(t.automationStore,{table:_.Xj,id:s,spaceId:r});if(!e.isDefined())continue;const o=e.getModel(),l=new Set(i.value.actionInputValueTypes[s].map((e=>{if(e.kind===u.yp.Binding||e.kind===u.yp.ContextValue)return e.id;e.kind!==u.yp.ThisRow&&(0,I.t1)(e)})).filter(I.$K)),c=(0,a.z)(o.getType()).acceptFormulaVisitor({action:o,visitor:{visitVariableOutsideOfFormula:e=>l.has(e)?{type:"keep"}:{type:"replace",value:void 0},visitFormula:e=>e.value&&(0,g.UB)(e).some((e=>!l.has(e)))?{type:"replace",value:void 0}:{type:"keep"}}});for(const t of c)U.applyOperation({store:e,operation:t,transaction:n})}}async function he(e){const{environment:t,store:o,clientContext:n}=e;let r,a;const s=await K.deps.formulas.loader();if(n.persisted){await n.automationStore.load();const e=n.automationStore.getModel();if(!e)return;r=e,a=n.automationStore.getActionStores().map((e=>e.getModel())).filter(I.$K)}else r=new c.X({triggerType:"button",actions:n.actions,parentPointer:n.parentPointer,spaceId:n.parentPointer.spaceId}),a=n.actions.map((e=>new c.e(e,n.parentPointer.spaceId)));const p=r.getTriggerType();if("event"===p)return;const u=(0,q.mc)(t),g=(0,ee.zt)();(0,i.rg)(u,{actions:a.map((e=>e.getType())),automation_id:r.id,block_id:o.id,space_id:r.getSpaceId(),subscription_tier:g,trigger:p});const y=new ye({automationModel:r,clientContext:n,environment:t}),v=(0,m.yf)(n.parentRecordStore.getRecordModel,n.parentRecordStore.loadRecordModel);if(!t.currentUser.id)return;let S;if("button_property"===n.type?S=(0,d.dG)({blockPointer:{...o.pointer,spaceId:(0,k.C)(o.pointer.spaceId)},currentUserId:t.currentUser.id,userTimeZone:(0,f.r)()}):"button_block"===n.type?S=(0,d.io)({currentUserId:t.currentUser.id,userTimeZone:(0,f.r)(),pagePointer:n.pageStore.pointer}):"structured_automation"===n.type||"event"===n.type?S={value:{values:[]}}:(0,I.t1)(n),b.x.isFail(S))return h.log({level:"error",from:"automationActions",type:"TriggerError",error:{miscDataString:JSON.stringify(S)}}),(0,i.By)(u,{automation_id:r.id,block_id:o.id,error_type:S.error.type,execution_duration_ms:0,subscription_tier:g,trigger:p}),void M.deprecatedShowErrorMessage("There was an error executing this automation");const _={automationModel:r,actionModels:a,values:S.value.values,executeEffectMap:y,executeContextualFormula:async(e,t)=>{if(!t)return{value:{type:"undefined"}};return await s.executeFormulaAsync(t,{values:e.values,handleDataRequest:v,userTimeZone:(0,f.r)(),intl:n.intl,depth:0,visitedProperties:new Set,resultCache:new Map})},handleDataRequest:v,loadRecordModel:n.parentRecordStore.loadRecordModel,userTimeZone:(0,f.r)(),intl:n.intl,depth:0,visitedProperties:new Set,resultCache:new Map},x=performance.now(),C=await async function(e){const{context:t,executeAutomationActionFn:o}=e,{actionModels:n}=t;let r=t.values;const i=o??l;for(const a of n){const e=await i({action:a,values:r,context:t});if(e.error)return e.error;r=r.concat(e.value.values)}}({context:_}),T=Math.trunc(performance.now()-x);if(C){0,h.log({level:"error",from:"automationActions",type:"AutomationExecutionError",error:{miscDataString:JSON.stringify({error:C,automationId:r.id})}}),(0,i.By)(u,{automation_id:r.id,block_id:o.id,error_type:C.type,execution_duration_ms:T,subscription_tier:g,trigger:p});const e=function(e){if("user_cancelled"===e.type)return le.errorUserCancelled;if("query_collection_too_many_items"===e.type)return le.errorQueryCollectionTooManyPages;return le.genericErrorMessage}(C),t=H.default.formatMessage(e);O.oV({label:t})}else(0,i.Cz)(u,{automation_id:r.id,block_id:o.id,execution_duration_ms:T,subscription_tier:g,trigger:p}),await async function(e){const{environment:t,saveTransactionInfos:o,clientContext:n,undoCheckpointName:r,numBlocksDuplicated:i}=e,a=function(e){const{saveTransactionInfos:t,parentRecordStore:o}=e,n={};for(const l of t)if("create_page"===l.type){var r,i;const e=X.NW.createChildStore(o,l.collection).getDatabaseType(),t=(e&&re[e])??"page",a=(null===(r=n[t])||void 0===r?void 0:r.numPagesEdited)??0,s=(null===(i=n[t])||void 0===i?void 0:i.numPagesCreated)??0;n[t]={numPagesCreated:s+1,numPagesEdited:a}}else if("update_pages"===l.type){var a,s;const e=X.NW.createChildStore(o,l.collection).getDatabaseType(),t=(e&&re[e])??"page",r=(null===(a=n[t])||void 0===a?void 0:a.numPagesEdited)??0,i=(null===(s=n[t])||void 0===s?void 0:s.numPagesCreated)??0;n[t]={numPagesCreated:i,numPagesEdited:r+l.pageIds.length}}else(0,I.t1)(l);return n}({saveTransactionInfos:o,parentRecordStore:n.parentRecordStore});let s;for(const m of o.slice().reverse()){if("create_page"===m.type){var l;s=X.G.createChildStore(n.parentRecordStore,{table:w.iU,id:m.pageId,spaceId:null===(l=m.collection)||void 0===l?void 0:l.spaceId});break}if("update_pages"===m.type){if(1===m.pageIds.length){var c;s=X.G.createChildStore(n.parentRecordStore,{table:w.iU,id:m.pageIds[0],spaceId:null===(c=m.collection)||void 0===c?void 0:c.spaceId})}else{const e=X.NW.createChildStore(n.parentRecordStore,m.collection);await e.load();const t=e.getParentBlockStore();if(!t)continue;s=t}break}(0,I.t1)(m)}const d=ie({typedAutomationExecutionSummary:a,numBlocksDuplicated:i,intl:n.intl}),p=()=>{F.qB({environment:t,namedRevisionId:r}),O.rN()},u=F.hv(r);O.oV({label:d,right:(0,se.jsx)(Z.wr,{blockStoreToOpen:s,...u?{performUndo:p}:{}})})}({environment:t,saveTransactionInfos:y.saveTransactionInfos,clientContext:n,undoCheckpointName:y.undoCheckpointName,numBlocksDuplicated:y.getNumBlocksDuplicated()})}function fe(e){var t;const{environment:o,parentStore:n,transaction:r}=e,i=E.j4({environment:o,type:"text",inMemoryRecordCache:n.inMemoryRecordCache,transaction:r,spaceId:n.pointer.spaceId,useCrdt:(null===(t=(0,G.sQ)(n))||void 0===t?void 0:t.useCrdt())??!1}),a=A.R3({parent:n,append:i,transaction:r}).child;j.eP({environment:o,store:a});const s=a.getBlockTitleStore();L.N_({store:s})}class ye{constructor(e){this.environment=void 0,this.clientContext=void 0,this.automationModel=void 0,this.numBlocksDuplicated=0,this.saveTransactionInfos=[],this.undoCheckpointName=void 0,this.getCollectionSchema=async e=>{const t=await this.clientContext.parentRecordStore.loadRecordModel(e.pointer);return t?{value:{collectionSchema:t.getNormalizedSchema()}}:{error:new s.Do({actionId:e.actionId,pointer:e.pointer})}},this.queryCollection=async e=>{const t=await R.tA(this.environment,{source:"automation",parentRecordStore:this.clientContext.parentRecordStore,collectionPointer:e.collection,filter:e.filter,sort:e.sort,limit:e.limit});return b.x.isFail(t)?{error:new s.Pn({actionId:e.actionId,type:t.error.type,message:t.error.message,cause:t.error})}:{value:{blockIds:t.value.blockIds}}},this.saveTransaction=e=>{if(this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.saveTransaction",environment:this.environment,perform:t=>{for(const o of e.operations){const e=(0,X.Kv)(this.clientContext.parentRecordStore,o.pointer);U.applyOperation({store:e,operation:o,transaction:t})}}}),this.saveTransactionInfos.push(e.info),"create_page"===e.info.type)C.W2j(this.environment,{type:"page",automation_id:this.automationModel.id,from:"button_automation",new_page_id:e.info.pageId});else if("update_pages"===e.info.type){const{editedProperties:t,pageIds:o}=e.info;for(const e of o)for(const{id:o,type:n}of t)C.rvl(this.environment,{block_id:e,property:o,property_type:n,from:"button_automation",automation_id:this.automationModel.id},!1)}else(0,I.t1)(e.info);return{value:{}}},this.navigateToPage=e=>{const t=Y.default.state.mainEditorCurrentBlockStore;if(!t)return;const o=X.G.createChildStore(t,e.page),n="full_page"===e.openIn?(0,W.ZP)({store:o,fullyQualified:!1,pageVisitSource:r.tY.ButtonAutomation}):(0,W.ZP)({store:t,peekViewBlockId:o.id,peekMode:(0,J.getUrlParamFromPeekMode)(e.openIn),fullyQualified:!1,pageVisitSource:r.tY.ButtonAutomation});N.navigate({environment:this.environment,url:n})},this.duplicateBlockChildren=async e=>{if("button_block"!==this.clientContext.type)return{error:new s.iR({contextType:this.clientContext.type})};const t=this.clientContext.blockStore,o=t.getRecordStoreUIParent();if(!o)return{value:{}};let r;"before"===e.insertionPoint?r=!0:"after"===e.insertionPoint?r=!1:(0,I.t1)(e.insertionPoint);const i=X.G.createChildStore(o,e.blockPointer);await i.load();const a=i.getContentStores();r||a.reverse();const l=$.C.findSelectableFromStore(t),c=[],d=this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.duplicateBlockChildren",environment:this.environment,perform:e=>a.map((o=>{const[n,i]=P.Qi({environment:this.environment,stores:[o],transaction:e,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!0,targetSpaceId:(0,k.C)(o.pointer.spaceId),baseUrl:V.default.domainBaseUrl,publicDomainName:V.default.publicDomainName,preferDuplicateLocation:"local",analyticsFrom:"button_automation",useCrdt:t.useCrdt()}),a=n[0];return l&&(r?l.props.onInsertAbove&&c.push(l.props.onInsertAbove({insertStores:[a],transaction:e})[0]):l.props.onInsertBelow&&c.push(l.props.onInsertBelow({insertStores:[a],transaction:e})[0])),{copy:a,onComplete:i}}))}).performResult;return r||c.reverse(),j.Z5({environment:this.environment,stores:c}),await Promise.all(d.map((e=>e.onComplete))),n.default.afterNextFlush((()=>{for(const e of c){if(D.dM({environment:this.environment,isAtStartOfLine:!1,store:e}))break}})),this.numBlocksDuplicated+=c.length,{value:{}}},this.displayModal=async e=>{Q.Z.setState({open:!0,format:e.format,recordStore:this.clientContext.parentRecordStore}),await Q.Z.waitUntil((()=>!Q.Z.state.open));const t=Q.Z.state;let o;return t.open||(o=t.result),o=o??"continue",o},this.initializeTemplateInDatabase=async e=>{const t=(0,v.ZP)(),o=this.clientContext.parentRecordStore,n=X.G.createChildStore(o,{table:w.iU,id:e.templateId});await n.load();const r=X.NW.createChildStore(o,e.collection);return this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.initializeTemplateInDatabase",environment:this.environment,perform:i=>{const a=E.j4({environment:this.environment,transaction:i,inMemoryRecordCache:o.inMemoryRecordCache,type:p.Ti.page,id:t,useCrdt:!1});B.zw({parentStore:r,childStore:a,transaction:i}),T.ob({environment:this.environment,store:a,transaction:i,templateStore:n,title:"template",isCreateIn:!1,isKeyboard:!1,from:"automation_actions"}),E.sW({transaction:i,store:a.getPropertiesStore(),data:e.propertyUpdates})}}),this.saveTransactionInfos.push({type:"create_page",pageId:t,collection:e.collection}),{value:{pageId:t}}},this.environment=e.environment,this.clientContext=e.clientContext,this.automationModel=e.automationModel,this.undoCheckpointName=`execute-client-automation-${(0,v.ZP)()}`}getNumBlocksDuplicated(){return this.numBlocksDuplicated}createAndCommitForEffect(e){return U.createAndCommit({...e,undoCheckpoint:this.undoCheckpointName})}}},41301:(e,t,o)=>{o.d(t,{Fp:()=>d,Mm:()=>c,So:()=>u,TU:()=>p});o(67294);var n=o(86628),r=o(24405),i=o(72126),a=o(5366),s=o(97880),l=o(85893);const c=(0,a.defineMessages)({missingTargetDatabase:{id:"clientAutomationHelpers.errorMessages.missingTargetDatabase",defaultMessage:"Missing a target database"},missingTargetPage:{id:"clientAutomationHelpers.errorMessages.missingTargetPage",defaultMessage:"Missing a target page"},invalidTemplatePage:{id:"clientAutomationHelpers.errorMessages.invalidTemplatePage",defaultMessage:"Invalid template."},noActions:{id:"clientAutomationHelpers.errorMessages.noActions",defaultMessage:"This button has no actions"},createPageButtonError:{id:"clientAutomationHelpers.errorMessages.createPageButtonError",defaultMessage:"Add page is missing a target database"},createPageButtonTemplateError:{id:"clientAutomationHelpers.errorMessages.createPageWithTemplateError",defaultMessage:"Add page has an invalid template"},openPageButtonError:{id:"clientAutomationHelpers.errorMessages.openPageButtonError",defaultMessage:"Open page is missing a target page"},updatePagesButtonError:{id:"clientAutomationHelpers.errorMessages.editPagesButtonError",defaultMessage:"Edit pages is missing a target database"},slackNotificationAuthenticationError:{id:"clientAutomationHelpers.errorMessages.slackNotificationError",defaultMessage:"Slack notification is missing an authentication."}});function d(e){if("create_page"===e.actionType)if("missing_required_config"===e.type){if("collection"===e.key)return{forAction:c.missingTargetDatabase,forButtonTooltip:c.createPageButtonError};(0,s.t1)(e)}else{if("invalid_optional_config"===e.type)return{forAction:c.invalidTemplatePage,forButtonTooltip:c.createPageButtonTemplateError};(0,s.t1)(e)}else if("update_pages"===e.actionType)if("missing_required_config"===e.type){if("target"===e.key)return{forAction:c.missingTargetDatabase,forButtonTooltip:c.updatePagesButtonError};(0,s.t1)(e)}else(0,s.t1)(e);else if("open_page"===e.actionType)if("missing_required_config"===e.type){if("target"===e.key)return{forAction:c.missingTargetPage,forButtonTooltip:c.openPageButtonError};(0,s.t1)(e)}else(0,s.t1)(e);else if("slack_notification"===e.actionType)if("missing_required_config"===e.type){if("external_bot_id"===e.key)return{forAction:c.slackNotificationAuthenticationError,forButtonTooltip:c.slackNotificationAuthenticationError};(0,s.t1)(e)}else if("missing_required_value"===e.type){if("external_bot_id"===e.key)return{forAction:c.slackNotificationAuthenticationError,forButtonTooltip:c.slackNotificationAuthenticationError};(0,s.t1)(e)}else(0,s.t1)(e);else(0,s.t1)(e)}function p(e){const{contextStore:t,actionId:o,shouldShow:r,errorKey:s}=e;return(0,n.VK)((()=>{if(!r)return;let e=t.getValidationErrorsForAction(o);s&&(e=e.filter((e=>e.key===s)));const n=i.Ps(e);if(!n)return;const c=d(n);return(0,l.jsx)(u,{content:(0,l.jsx)(a.FormattedMessage,{...c.forAction})})}),[r,t,o,s])}function u(e){window.__c={n:"TooltipWithSubtitle"};const{content:t,subtitle:o}=e,n=(0,r.yK)((e=>({wrap:{display:"flex",flexDirection:"column",alignItems:"center"},subtitle:{color:e.mediumInvertedTextColor}})),[]);return(0,l.jsxs)("div",{style:n.wrap,children:[(0,l.jsx)("div",{children:t}),o&&(0,l.jsx)("div",{style:n.subtitle,children:o})]})}},93174:(e,t,o)=>{o.d(t,{C:()=>n.LazyAutomationButtonActionList,O:()=>n.LazyPlacedButtonBlockEditor});var n=o(77907)},87686:(e,t,o)=>{o.d(t,{f:()=>i});o(67294);var n=o(24405),r=o(85893);function i(){window.__c={n:"BreadcrumbDivider"};const e=(0,n.yK)((e=>({span:{marginLeft:2,marginRight:2,color:e.lightTextColor}})),[]);return(0,r.jsx)("span",{style:e.span,children:"/"})}},25238:(e,t,o)=>{o.d(t,{Z:()=>u});o(67294);var n=o(480),r=o(86628),i=o(24405),a=o(82990),s=o(31278),l=o(76798),c=o(35661),d=o(74016),p=o(85893);function u(e){window.__c={n:"BreadcrumbIconTitle"};const{store:t,ignoreMaxLength:o,maxWidth:u,iconSize:m,titleStyle:g,iconStyle:h,highlighter:f}=e,{device:y}=(0,n.O7)(),v=m??(y.isMobile?24:20),{hasIcon:b,pageIcon:S,isEmptyPage:_}=(0,r.VK)((()=>({hasIcon:t.hasIcon(),pageIcon:t.getIcon(),isEmptyPage:t instanceof c.G&&t.isEmptyPage()})),[t]),w=(0,i.yK)((()=>({containerStyle:{display:"flex",alignItems:"center",minWidth:0},teamRecordTitle:{maxWidth:u,...g},pageRecordTitle:{maxWidth:o?"none":u,...g},recordIconStyle:{marginRight:6,fontWeight:a.Z.fontWeight.medium,...h}})),[o,u,g,h]);return t instanceof c.zX?(0,p.jsxs)("div",{style:w.containerStyle,children:[(0,p.jsx)(d.p,{disabled:!0,store:t,size:v,style:w.recordIconStyle}),(0,p.jsx)(l.Z,{store:t,style:w.teamRecordTitle,highlighter:f,enableHover:!0})]}):(0,p.jsxs)("div",{style:w.containerStyle,children:[b&&(0,p.jsx)(s.Z,{disabled:!0,icon:S,isEmptyPage:_,size:v,style:w.recordIconStyle,largeIcon:!0}),(0,p.jsx)(l.Z,{store:t,style:w.pageRecordTitle,highlighter:f,enableHover:!0})]},`breadcrumb-recordtitle-${t.id}`)}},7692:(e,t,o)=>{o.d(t,{Z:()=>v});var n=o(67294),r=o(480),i=o(86628),a=o(24405),s=o(15145),l=o(13084),c=o(39699),d=o(31945),p=o(89728),u=o(79954),m=o(84210),g=o(46837),h=o(87686),f=o(25238),y=o(85893);function v(e){window.__c={n:"BreadcrumbPageButton"};const t=(0,r.O7)(),{device:o}=t,{store:v,showDivider:b,maxWidth:S,popupRenderer:_,iconSize:w,titleStyle:k,iconStyle:x,highlighter:I,onClick:C}=e,T=(0,a.yK)((()=>({selectable:{display:"flex",alignItems:"center",minWidth:0},button:{display:"flex",minWidth:0,fontSize:"inherit",padding:2}})),[]),{url:M,canEdit:P,isPersonalHome:A}=(0,i.VK)((()=>({url:(0,m.ZP)({store:v,fullyQualified:!1,pageVisitSource:s.tY.Breadcrumb}),canEdit:v.canEdit(),isPersonalHome:"personal_home_page"===v.getType()})),[v]),D=(0,n.useCallback)((e=>{const{droppedDirection:o,droppedStores:n,duplicate:r}=e;c.createAndCommit({userAction:"SearchPathBreadcrumb.onDrop",environment:t,perform:e=>l.LQ({environment:t,targetParentStore:v.getContentStore(),targetStore:v,droppedDirection:o,droppedStores:n,duplicate:r,transaction:e})})}),[t,v]),B=A?(0,y.jsx)(g.Z,{style:k}):(0,y.jsx)(f.Z,{store:v,maxWidth:S,iconSize:w,titleStyle:k,iconStyle:x,highlighter:I});return(0,y.jsxs)(n.Fragment,{children:[(0,y.jsx)(u.Z,{store:v,canDropOnto:P,onSelectableDrop:D,style:T.selectable,analyticsName:"breadcrumb",shouldShowDropZone:!0,children:_?(0,y.jsx)(d.ZP,{originGap:4,popupType:o.isMobile?d.Z4.SlideUp:d.Z4.Popup,render:_,renderOrigin:e=>(0,y.jsx)(p.Z,{...e,style:T.button,isSmall:!0,shouldShrink:!0,mobileFeedback:o.isMobile,children:B})}):(0,y.jsx)(p.Z,{href:M,external:!1,style:T.button,isSmall:!0,shouldShrink:!0,mobileFeedback:o.isMobile,onClick:C,children:B})}),b&&(0,y.jsx)(h.f,{})]},v.id)}},24946:(e,t,o)=>{o.d(t,{Z:()=>h});var n=o(67294),r=o(480),i=o(86628),a=o(24405),s=o(31945),l=o(68785),c=o(89728),d=o(95697),p=o(77907),u=o(87686),m=o(25238),g=o(85893);function h(e){window.__c={n:"BreadcrumbTeamButton"};const{device:t}=(0,r.O7)(),{store:o,showDivider:h,popupRenderer:f,iconSize:y,iconStyle:v,highlighter:b}=e,S=(0,a.yK)((()=>({button:{fontSize:"inherit",padding:2},loadingPopupBackground:{width:280,paddingTop:8,paddingBottom:8,display:"flex",justifyContent:"center"}})),[]),{teamsEnabled:_,storeIsDefined:w}=(0,i.VK)((()=>({teamsEnabled:(0,d.bq)(),storeIsDefined:o.isDefined()})),[o]);if(!w||!_)return null;return(0,g.jsxs)(n.Fragment,{children:[(0,g.jsx)(s.ZP,{originGap:4,popupType:t.isMobile?s.Z4.SlideUp:s.Z4.Popup,render:f??(e=>(0,g.jsx)(p.LazyTeamBreadcrumbPopup,{renderLoading:e=>(0,g.jsx)("div",{style:S.loadingPopupBackground,children:e&&(0,g.jsx)(l.Z,{})}),teamStore:o,parent:e})),renderOrigin:n=>(0,g.jsx)(c.Z,{style:S.button,isSmall:!0,shouldShrink:!0,mobileFeedback:t.isMobile,...n,children:(0,g.jsx)(m.Z,{store:o,maxWidth:e.maxWidth,iconSize:y,titleStyle:e.titleStyle,iconStyle:v,highlighter:b})})}),h&&(0,g.jsx)(u.f,{})]},o.id)}},3043:(e,t,o)=>{o.d(t,{Qe:()=>i.Z,Yo:()=>r.Z,fY:()=>n.f,l2:()=>s});var n=o(87686),r=o(24946),i=o(7692),a=o(77907);const s=(0,a.lazyComponent)(a.deps.Breadcrumb,(e=>e.Breadcrumb))},17707:(e,t,o)=>{o.d(t,{AM:()=>K,DF:()=>D,DX:()=>E,Gu:()=>R,Ri:()=>H,T4:()=>O,Xi:()=>N,Y0:()=>G,YF:()=>B,Zo:()=>V,bh:()=>F,cj:()=>U,en:()=>W,tR:()=>L});o(57658);var n=o(1302),r=o(22491),i=o(72126),a=o(4615),s=o(70279),l=o(33709),c=o(23867),d=o(70203),p=o(63143),u=o(50906),m=o(54564),g=o(31781),h=o(94419),f=o(9953),y=o(61045),v=o(3898),b=o(39699),S=o(53471),_=o(28020),w=o(65598),k=o(77546),x=o(89224),I=o(46351),C=o(95802),T=o(24229),M=o(56681),P=o(35661),A=o(92120);function D(e){var t;const{environment:o,store:n,text:r,files:i,transaction:a,discussionLocation:s}=e,{filesToCreate:l,fileStoresToDelete:c}=function(e,t){const o=[],n=new Set;t.forEach((e=>{"local"===e.type?o.push(e.file):n.add(e.id)}));const r=w.le(e).filter((e=>e.getAlive()&&!n.has(e.id)));return{filesToCreate:o,fileStoresToDelete:r}}(n,i);V({commentStore:n,fileBlocks:c,transaction:a}),z({commentStore:n,files:l,environment:o,transaction:a});const d=w.zP(n);f.sO({store:d,value:r,transaction:a}),q(n,a),u.zdn(o,{from:s,comment_id:n.id,discussion_id:n.getParentId(),parent_block_id:null===(t=n.getParentStore())||void 0===t?void 0:t.getParentId()})}function B(e){const{environment:t,commentStore:o,transaction:n}=e,r=w.GP(o);if(!r)return;const i=w.ak(r),a=i.getValue();if(!a)return;V({commentStore:o,fileBlocks:w.le(o),transaction:n}),f.sW({store:o,transaction:n,data:{alive:!1}}),b.applyOperation({store:i,operation:{pointer:i.pointer,path:i.path,command:"listRemove",args:{id:o.id}},transaction:n}),(0===a.length||1===a.length&&a[0]===o.id)&&function(e){const{discussionStore:t,transaction:o}=e,n=w.HK(t);n&&R({discussionStore:t,transaction:o,blockStore:n});const r=_.RM();if(r){const e=w.MI(r);for(const r of e){if(n&&r.table===n.table&&r.id===n.id)continue;const e=w.x8(r).getValue();null!=e&&e.includes(t.id)&&R({discussionStore:t,transaction:o,blockStore:r})}}}({discussionStore:r,transaction:n}),q(o,n),u.k$J(t,{from:e.discussionLocation,discussion_id:r.id,comment_id:o.id,parent_block_id:r.getParentId()})}function R(e){const{discussionStore:t,blockStore:o,transaction:n}=e,r=w.x8(o);b.applyOperation({store:r,operation:{pointer:r.pointer,path:r.path,command:"listRemove",args:{id:t.id}},transaction:n}),j({store:o,discussionId:t.id,transaction:n})}function E(e){var t;const{environment:o,commentStore:n,discussionStore:r,transaction:i}=e;if(T.Z.state.open){var a;const e=null===(a=T.Z.state.discussionIds)||void 0===a?void 0:a.filter((e=>e!==r.id));T.Z.setState({...T.Z.state,discussionIds:e,open:((null==e?void 0:e.length)||0)>0})}f.sW({store:r,data:{resolved:!0},transaction:i}),A.Z.setState({...A.Z.state,discussionIds:(null===(t=A.Z.state)||void 0===t||null===(t=t.discussionIds)||void 0===t?void 0:t.filter((e=>e!==r.id)))||[]}),u.hJ5(o,{comment_id:n.id,discussion_id:r.id,parent_block_id:r.getParentId(),from:e.discussionLocation})}function F(e){const{environment:t,commentStore:o,discussionStore:n,transaction:r}=e;f.sW({store:n,data:{resolved:!1},transaction:r}),u.SUR(t,{comment_id:o.id,discussion_id:n.id,from:e.discussionLocation,parent_block_id:n.getParentId()})}function N(e){const{environment:t,discussionStore:o,textValue:n,transaction:r,files:a}=e,{id:s}=t.currentUser;if(!s)return;const l=S.dm(a);if(i.Xy(n,[])&&0===l.length)return;const c=Z({discussionStore:o,text:n,files:l,environment:t,transaction:r});u.d2c(t,{from:e.discussionLocation,comment_id:c.id,discussion_id:o.id,parent_block_id:o.getParentId()})}const j=e=>{const{store:t,transaction:o,discussionId:n}=e,r=w.p9(t),i=r.getValue()||{},a=d.xcl({properties:i,discussionId:n});for(const[s,l]of Object.entries(a))f.sW({store:r,data:{[s]:l},transaction:o})};function O(e){const t=I.Z.find((t=>t.getStore().id===e&&!t.isSidebarFormat()&&!t.isMarginFormat()));if(t){const e=t.getNode();if(e&&e.parentElement){const t=Array.from(e.parentElement.children).indexOf(e);k.Wr(e,{edgeDist:0===t?0:-1,animate:!1})}}}function L(e){const{transaction:t,blockStore:o,discussionId:n}=e,r=w.x8(o);b.applyOperation({store:r,operation:{pointer:r.pointer,path:r.path,command:"listAfter",args:{id:n}},transaction:t})}function U(e){const{context:t,blockStore:o,environment:n,transaction:r,commentTextValue:i,files:s,discussionId:l=(0,a.ZP)()}=e,d=f.ae({environment:n,table:"discussion",value:{id:l,parent_id:o.id,parent_table:o.table,resolved:!1,context:t,space_id:(0,c.C)(o.pointer.spaceId)},inMemoryRecordCache:o.inMemoryRecordCache,transaction:r});L({transaction:r,blockStore:o,discussionId:d.id});return{discussionStore:d,commentStore:Z({discussionStore:d,text:i,files:s,environment:n,transaction:r})}}function Z(e){const{discussionStore:t,files:o,text:n,environment:r,transaction:i}=e,a=f.Ue({environment:r,table:s.x_,args:{parent:t.pointer},inMemoryRecordCache:t.inMemoryRecordCache,transaction:i}),l=w.ak(t);h.R3({parent:l,append:a,transaction:i});const c=w.zP(a);return f.sO({store:c,value:n,transaction:i}),z({commentStore:a,files:o,environment:r,transaction:i}),q(a,i),a}function V(e){const{commentStore:t,fileBlocks:o,transaction:n}=e,r=w.ig(t);o.forEach((e=>{f.sW({store:e,data:{alive:!1},transaction:n}),h.Od({parent:r,childToRemove:e,transaction:n})}))}function q(e,t){const o=w.bQ(e);f.sO({store:o,value:(0,p.ud)(Date.now()),transaction:t})}function z(e){const{environment:t,files:o,commentStore:n,transaction:r}=e,i=_.qQ(t),a=w.ig(n);g.z({files:o,environment:t,inMemoryRecordCache:n.inMemoryRecordCache,transaction:r,pageWidth:i,ignoreOversizedFiles:!0,spaceId:a.pointer.spaceId,useCrdt:!1}).forEach((e=>{h.R3({parent:a,append:e,transaction:r})}))}async function W(e){let{discussionId:t,currentBlockStore:o,environment:n,analyticsFrom:r,currentEl:i}=e;return H({discussionStore:P.t1.createChildStore(o,{table:l.qF,id:t,spaceId:(0,c.C)(o.pointer.spaceId)}),currentBlockStore:o,environment:n,analyticsFrom:r,currentEl:i})}async function H(e){var t;let{discussionStore:o,currentBlockStore:i,environment:a,analyticsFrom:s,currentEl:l}=e;if(!i)return null;if(!o.isDefined())return;function c(e){const t=function(e){var t;let o,{discussionId:n,blockId:i}=e;const a=null===(t=document.getElementsByClassName(`${(0,r.dk)({discussionId:n})}`))||void 0===t?void 0:t[0];a&&(o=C.C.findSelectableFromChildNode(a)),o||(o=C.C.findScrollToSelectablesFromIds([i])[0]);return o}({discussionId:o.id,blockId:e});if(!t)return;const n=document.getElementsByClassName(`discussion-id-${o.id}`)[0];return n?y.bx({element:n,scrollers:{verticalScroller:t.getContextVerticalScroller(),horizontalScroller:t.getContextHorizontalScroller()},vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:!0}):y.NQ({component:t,vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:!0}),t.displaySelectionHalo(750),t}const d=(null===(t=o.getRecordStoreUIParent())||void 0===t?void 0:t.id)??o.getParentId();c(d)||(await v.Nz(i,[d]),await n.default.afterNextFlush(),c(d));const p=P.G.createChildStore(i,o.getParentPointer()),u=x.get(),g=null==u?void 0:u.commonAncestorContainer,h=!(null!=u&&u.collapsed)&&g&&(l===g||(null==l?void 0:l.contains(g)));m.Ib({environment:a,blockStore:p||i,analyticsFrom:s,discussionIds:[o.id],shouldFocusDiscussion:!h,recursivelyLoadAllDiscussions:!1})}function G(e){e!==M.Z.state.pageId&&M.Z.reset()}function K(e){const t={};e.forEach((e=>{t[e]=Date.now()})),M.Z.setState({...M.Z.state,...t})}},51798:(e,t,o)=>{o.d(t,{Cd:()=>A,WD:()=>M,ZL:()=>B,i8:()=>D,uK:()=>E,yw:()=>P});o(57658);var n=o(1302),r=o(41432),i=o(4615),a=o(21202),s=o(23867),l=o(70203),c=o(5366),d=o(50906),p=o(47307),u=o(56863),m=o(24677),g=o(97444),h=o(98104),f=o(39699),y=o(53471),v=o(33929),b=o(45162),S=o(89224),_=o(58202),w=o(35661),k=o(34047),x=o(82994),I=o(48514),C=o(17707);const T=(0,c.defineMessages)({discardCommentConfirmationPrompt:{id:"newDiscussionMenu.discardCommentConfirmationDialog.prompt",defaultMessage:"Do you want to discard the comment?"},discardCommentButtonLabel:{id:"newDiscussionMenu.discardCommentConfirmationDialog.discardButton.label",defaultMessage:"Discard"}});async function M(e){const{environment:t,blockStore:o,multiSelection:n,rect:r}=e;let i=r;if(!i){const e=S.get();if(!e)return;i=S.getRect(e)}if(!i)return;const a=i.width,l=i.height,c=i.right-a,p=new x.Z(t,(0,s.C)(o.pointer.spaceId));I.Z.setState({open:!0,rect:new DOMRect(c,i.top,a,l),type:"inline",blockStore:o,multiSelection:n,discussionInputStore:p}),u.w(),await R(p,t),d.$5Z(t)}async function P(e){const{environment:t,blockStore:o}=e,n=_.R.getRect(o);if(!n)return;const r=new x.Z(t,(0,s.C)(o.pointer.spaceId)),i=n.width,a=n.height,l=n.right-i;I.Z.setState({open:!0,rect:new DOMRect(l,n.top,i,a),type:"block",blockStore:o,discussionInputStore:r}),await R(r,t),d.yrm(t)}function A(e){const t=I.Z.state;t.open&&I.Z.setState({open:!1,rect:t.rect})}function D(e){const{environment:t,blockStore:o,commentTextValue:n,transaction:i,files:a}=e,{id:s}=t.currentUser;if(!s)return;let c;const p=o.getType();if(p&&(0,r.XD)(p)&&!(0,r.S9)(p)){const e=o.getTitleValue();c=l.O1u(l.OAI(e))}const{discussionStore:u,commentStore:m}=C.cj({context:c,blockStore:o,environment:t,transaction:i,commentTextValue:n,files:y.dm(a)});return d.bRy(t,{discussion_id:u.id,comment_id:m.id,parent_block_id:u.getParentId()}),u}function B(e){const t=I.Z.state;if(t.open){const o=t.discussionInputStore.state.textStore.getValue(),n=t.discussionInputStore.state.files;(o&&o.length>0||n.length>0)&&("inline"===t.type?f.createAndCommit({userAction:"newDiscussionMenuActions.submitNewDiscussion",environment:e,perform:s=>{!function(e){const{environment:t,multiSelection:o,commentTextValue:n,transaction:s,files:c}=e,{id:p}=t.currentUser;if(!p)return;const u=(0,i.ZP)(),m=(0,b.L5)(o).filter((e=>{let{store:t}=e;return t.table===a.iU}));if(0===m.length)return;const h=m[0].store.getRecordStoreAtRootPath(),f=[],v=new Set;m.forEach(((e,o)=>{let{store:n,selection:i}=e;v.add(n.id);const a=n.getRecordStoreAtRootPath();if(!(a instanceof w.G))return;const c=a.getType(),d=a.getFormat();if(c&&(0,r._T)(c,d))return;let p=n.getValue();const m=l.Ulv(p,i);g.i8({environment:t,store:n,selection:m,annotation:[l.GKr.Discussion,u],transaction:s}),p=n.getValue();const h=l.KU1(p,m.startIndex,m.endIndex),y=0===o?[]:[l.V3y("\n")];f.push(...y,...h),o>0&&C.tR({blockStore:a,discussionId:u,transaction:s})}));const S=(0,b.tp)({multiSelection:o,filterCommonAncestors:!1,focus:void 0});if(S)for(const i of S.stores){if(v.has(i.id))continue;const e=i.getType(),t=i.getFormat();e&&(0,r._T)(e,t)||C.tR({blockStore:i,discussionId:u,transaction:s})}const{discussionStore:_,commentStore:k}=C.cj({context:f,blockStore:h,environment:t,transaction:s,commentTextValue:n,files:y.dm(c),discussionId:u});d.x6y(t,{discussion_id:_.id,comment_id:k.id,parent_block_id:_.getParentId()})}({environment:e,multiSelection:t.multiSelection,commentTextValue:o||[],files:n,transaction:s})},skipUpdatingEditedMetadata:!0}):"block"===t.type&&f.createAndCommit({userAction:"newDiscussionMenuActions.submitNewDiscussion",environment:e,perform:r=>{D({environment:e,blockStore:t.blockStore,commentTextValue:o||[],files:n,transaction:r})},skipUpdatingEditedMetadata:!0})),A()}}async function R(e,t){await n.default.afterNextFlush(),m.ZH(t),h.N_({store:e.state.textStore})}function E(e,t){(0,k.hu)(e)?(d.lLZ(t),p.showDialog({message:v.default.formatMessage(T.discardCommentConfirmationPrompt),showCancel:!0,handleCancel:()=>d.jXQ(t),keepFocus:!0,items:[{label:v.default.formatMessage(T.discardCommentButtonLabel),color:"red",onAccept:()=>{d.Yz2(t),A()}}]})):A()}},95306:(e,t,o)=>{o.d(t,{Cd:()=>m,UZ:()=>u,oK:()=>p});var n=o(1302),r=o(29477),i=o(23867),a=o(50906),s=o(24677),l=o(98104),c=o(82994),d=o(9080);async function p(e){const{environment:t,discussionStore:o,rect:p,blockStore:u,discussionLocation:m,activityId:g,notificationId:h}=e,f=new c.Z(t,(0,i.C)(u.pointer.spaceId));d.Z.setState({open:!0,rect:p,discussionStore:o,discussionInputStore:f,blockStore:u,discussionLocation:m,activityId:g,notificationId:h}),s.ZH(t),await n.default.afterNextFlush(),await(0,r.Vs)(10),l.NX({store:f.state.textStore}),a.Jed({environment:t,from:m,activityId:g,notificationId:h})}function u(e){const t=d.Z.state;if(t.open){const{discussionLocation:o,activityId:n,notificationId:r}=t;d.Z.setState({open:!1,rect:t.rect}),s.ZH(e),a.RnH({environment:e,from:o,activityId:n,notificationId:r})}}function m(e){const t=d.Z.state;if(t.open){0===t.discussionStore.getComments().length&&u(e)}}},25487:(e,t,o)=>{o.r(t),o.d(t,{DiscussionIndicatorFormat:()=>g,default:()=>f});o(67294);var n=o(83355),r=o(95855),i=o(82990),a=o(54564),s=o(24677),l=o(68709),c=o(73063),d=o(28020),p=o(65598),u=o(24229),m=o(85893);let g=function(e){return e[e.PushContent=0]="PushContent",e[e.FloatRight=1]="FloatRight",e}({});class h extends n.Z{constructor(){super(...arguments),this.handleClick=()=>{s.ZH(this.environment),a.Ib({environment:this.environment,blockStore:this.props.store,analyticsFrom:"discussion_indicator",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:this.props.recursivelyLoadAllDiscussions})},this.selectedDiscussionIdStore=this.createComputedStore((()=>u.Z.getFramePageFirstSelectedDiscussionId())),this.numberOfCommentsStore=this.createComputedStore((()=>{const{store:e,recursivelyLoadAllDiscussions:t,onlyCountBlockLevelDiscussions:o}=this.props,n=p.vV(e,{recursivelyLoadAllDiscussions:t,onlyIncludeBlockLevelDiscussions:o});if(0===n.length)return 0;const r=new Set(n.map((e=>e.id))),i=this.selectedDiscussionIdStore.state;if(i&&r.has(i))return 0;const a=d.RM();if(a){const t=p.MI(a),o=t.indexOf(e),n=new Set(r);for(let e=o-1;e>=0;e--){const o=t[e],i=p.vV(o,{recursivelyLoadAllDiscussions:!1,excludeSelf:!1,onlyIncludeBlockLevelDiscussions:!1,includeLoadingDiscussions:!0}).map((e=>e.id));for(const e of n)i.includes(e)?r.delete(e):n.delete(e);if(0===r.size)return 0;if(0===n.size)break}}return p.Xp(e,{recursivelyLoadAllDiscussions:t,onlyIncludeBlockLevelDiscussions:o})}))}renderComponent(){const e=this.numberOfCommentsStore.state;if(0===e)return null;return this.props.getFormat()===g.FloatRight?(0,m.jsx)(l.p,{allowSelectionWithin:!1,style:{width:0,height:0},children:this.renderButton(e)}):this.renderButton(e)}renderButton(e){return(0,m.jsx)(c.Z,{icon:r.z,style:{position:"relative",alignSelf:"flex-start",marginLeft:4,marginTop:3},onClick:this.handleClick,caption:this.renderNumberOfComments(e)})}renderNumberOfComments(e){const t=e>9?"9+":e;return(0,m.jsx)("span",{style:{marginLeft:2,color:this.theme.lightTextColor,fontWeight:i.Z.fontWeight.semibold},children:t})}}h.displayName="DiscussionIndicator";const f=h},34047:(e,t,o)=>{o.d(t,{DF:()=>m,De:()=>g,Je:()=>C,KL:()=>k,NI:()=>f,O2:()=>d,QT:()=>u,Qg:()=>p,W5:()=>w,ad:()=>x,hu:()=>_,n9:()=>S,p9:()=>I,uC:()=>b});var n=o(72126),r=o(70279),i=o(70203),a=o(97880),s=o(65598),l=o(35661);const c=o(60809);let d=function(e){return e[e.Menu=0]="Menu",e[e.Page=1]="Page",e[e.Sidebar=2]="Sidebar",e[e.Margin=3]="Margin",e[e.Unfurl=4]="Unfurl",e}({});function p(e){let{recordStore:t,currentUserId:o}=e;return v({recordStore:t,currentUserId:o})||f(t)[0]}function u(e){return e>1?3:6}function m(e){let{blockStore:t,ignoreAfterTime:o,currentUserId:n}=e;if(!t)return[];return s.al(t,{recursivelyLoadAllDiscussions:!0,includeLoadingDiscussions:!0}).sort(((e,t)=>{const o=p({recordStore:e,currentUserId:n}),r=p({recordStore:t,currentUserId:n});return null!=o&&o.isDefined()?null!=r&&r.isDefined()?-(o.getCreatedTime()-r.getCreatedTime()):1:-1}))}function g(e){if(!e.isDefined())return!1;const t=e.getContext();if(!t)return!0;return(e=>0===i.llS(e).length)(i.VP_(t,(t=>!i.xw5(t)||i.h19(t)===e.id)))}function h(e,t){return e&&e.isDefined()?t&&t.isDefined()?e.getCreatedTime()-t.getCreatedTime():1:-1}function f(e){return s.D4(e).sort(((e,t)=>h(e,t)))}function y(e){return v({recordStore:e,currentUserId:void 0})}function v(e){let{recordStore:t,currentUserId:o}=e;const n=s.D4(t).filter((e=>e.isDefined()&&e.getCreatedById()!==o)).sort(((e,t)=>h(e,t)));return n[n.length-1]}function b(e){return e.sort(((e,t)=>h(y(e),y(t))))}function S(e){const t=e.state.textStore.getValue(),o=(e.state.files??[]).length>0,n=t&&t.length>0;return!o&&!n}function _(e,t){const o=e.state.textStore.getValue(),r=e.state.files;if(!t)return o&&0!==o.length||r&&r.length>0;const i=s.zP(t).getValue();return!n.Xy(i,o)||function(e,t){const o=e.state.files,n=s.le(t);if(n.length!==o.length)return!0;return n.some(((e,t)=>e.id!==o[t].id))}(e,t)}function w(e){if(e.some((e=>!e.isReady())))return!0;return!!e.map((e=>s.D4(e))).flat().some((e=>!e.isReady()||!e.getCreatedTime()))}function k(e){const t=s.ak(e),o=t.getValue()||[];if(0===o.length)return;const n=o[0];return l.t1.createChildStore(t,{table:r.x_,id:n,spaceId:t.pointer.spaceId}).getCreatedTime()}function x(e){switch(e){case"block_menu":return d.Menu;case"page_discussion":return d.Page;case"reply_menu_mentions_comments":case"reply_menu_all_updates":case"reply_menu_archive":case"reply_menu_updates_sidebar":case"updates_menu_mentions_comments":case"updates_menu_all_updates":case"updates_menu_archive":return d.Menu;case"updates_sidebar":return d.Sidebar;case"margin_comments":return d.Margin;case"comment_unfurl":return d.Unfurl;default:(0,a.t1)(e)}}function I(e){var t;if(e.length>1)return!1;const o=e[0];if(!o.length)return!1;const n=o[0].trim(),r=c();return(null===(t=n.match(r))||void 0===t?void 0:t.join(""))===n}const C={updates_menu_all_updates:28,updates_menu_mentions_comments:28,updates_menu_archive:28,block_menu:20,reply_menu_all_updates:20,reply_menu_mentions_comments:20,reply_menu_archive:20,reply_menu_updates_sidebar:20,page_discussion:20,updates_sidebar:23,margin_comments:20,comment_unfurl:32}},92650:(e,t,o)=>{o.d(t,{fS:()=>j,QB:()=>N,Z:()=>O,Vs:()=>R,wo:()=>D,az:()=>q,oS:()=>Z,H0:()=>H,ui:()=>U,gC:()=>L,fg:()=>z,EM:()=>V});o(57658);var n=o(18466),r=o(14577),i=o(41432),a=o(22491),s=o(72126),l=o(21202),c=o(97880),d=o(43250),p=o(78316),u=o(11599),m=o(65598),g=o(58202),h=o(49427),f=o(95802),y=o(24646),v=o(15723),b=o(80444),S=o(17903),_=o(45325),w=o(88923),k=o(35661),x=o(49085),I=o(92595);class C extends x.default{getInitialState(){return{visible:!0}}}const T=new C;(0,I.exposeDebugValue)("MarginCommentsStore",T);const M=T;var P=o(48514),A=o(34047);const D=10,B="temp-margin-comment-discussion",R=50,E=`.${d.x9t} .notion-collection_view-block`,F=`.${d.OE$}`,N=372,j=16,O=N-4*j;function L(e,t,o){const n=U(e,t);return n>=1500||o&&!w.default.isSidePeekClosing.state||t?0:(1500-n)/2}function U(e,t){return t&&w.default.isSidePeekOpen()?(0,y.vJ)(e):e.WindowSizeStore.state.width-(0,y.Wk)(e)-(0,y.vJ)(e)-_.ZP.getPanelWidthReturnZeroForClosingState()}function Z(e,t,o){return(U(e,t)-1600)/2+2*j+L(e,t,o)}const V=new r.Z((()=>{var e;let t=b.default.state.mainEditorCurrentBlockStore;return null!==(e=t)&&void 0!==e&&e.isCollectionView()&&(t=(0,p.SY)(t)||t),t?(0,m.vV)(t,{recursivelyLoadAllDiscussions:!0,excludeSelf:!0}):[]}),{debugName:"mainEditorBlockUnresolvedDiscussionStore"});function q(e,t){const o=M.state.visible;return Boolean(!e.device.isMobile&&U(e,(0,p.en)(t))>=1150&&o&&!(0,y.Sx)(e)&&!w.default.isSidePeekOpen()&&h.Z.isBlockInFrame(t)&&(0,u.A$)("margin_comments","inline"))}function z(e,t){const o=V.state.length>0,n=P.Z.state.open&&P.Z.state.rect;return Boolean(q(e,t)&&(o||n))}function W(e,t){return e.offsetTop!==t.offsetTop?e.offsetTop<t.offsetTop?-1:1:e.createdTimeMs&&t.createdTimeMs&&e.createdTimeMs!==t.createdTimeMs?e.createdTimeMs<t.createdTimeMs?-1:1:e.id<t.id?-1:1}const H=(0,s.Ds)((function(e){let{discussionStores:t,pageContentStores:o,marginDiscussionItemRefs:r,selectedDiscussionId:s,newMarginDiscussionArgs:p,marginContainerElement:u,pageViewBlockElement:m,onComputeComplete:h,computedOnce:y,prevSelectedDiscussionId:b,isFullWidth:_,topbarHeight:w,windowHeight:x,previousDiscussionElements:I}=e;const C=new Map;let T=0,M=0;if(!u||!m)return;if(0===t.length&&!p)return;const P=n.Z.withListenerIgnored((()=>S.Z.state.scrollTop)),D=u.getBoundingClientRect(),R=G({currentScrollTop:P,rect:D});let N=function(e){const t=new Map,o=[];return e.forEach((e=>{if(e.shouldGroup){const o=t.get(e.parentBlockStore.id)||[];o.push(e),t.set(e.parentBlockStore.id,o)}else o.push(e)})),t.forEach((e=>{o.push({offsetTop:e[0].offsetTop,groupedDiscussionsData:e,parentBlockStore:e[0].parentBlockStore,type:"grouped",id:e[0].id,createdTimeMs:e[0].createdTimeMs})})),o}(t.map((e=>function(e){let{discussionStore:t,currentScrollTop:o,topbarHeight:n,windowHeight:r,pageViewBlockElement:i,previousDiscussionElements:s,currentDiscussionElements:c,selectedDiscussionId:d}=e;const p=t.id,u=function(e){const{topbarHeight:t,windowHeight:o,pageViewBlockElement:n,discussionId:r,previousDiscussionElements:i,currentDiscussionElements:s,selectedDiscussionId:l}=e,c=n.getElementsByClassName((0,a.dk)({discussionId:r})),d=e=>(s.set(r,e),e);if(c.length>0){if(l===r){let e;for(let n=0;n<c.length;n++){const r=c[n];if(r instanceof HTMLElement){const n=r.getBoundingClientRect();if(n.bottom<t||n.top>o){if(e)return d(e)}else{if(n.top>t)return d(r);e=r}}}}const e=i.get(r);return e&&Array.from(c).includes(e)?d(e):d(c[0])}}({topbarHeight:n,windowHeight:r,pageViewBlockElement:i,discussionId:p,previousDiscussionElements:s,currentDiscussionElements:c,selectedDiscussionId:d}),m=t.recordStoreUIParentStore;if(!(m&&m.id&&m.table===l.iU&&m instanceof k.G))return;if(!m.isReady())return;const g={offsetTop:0,discussionStore:t,parentBlockStore:m,type:"existing",id:t.id,createdTimeMs:(0,A.KL)(t)};if(u instanceof HTMLElement)return g.offsetTop=G({rect:u.getBoundingClientRect(),currentScrollTop:o}),g;const h=f.C.findNodeFromStore(m);if(h instanceof HTMLElement)return g.offsetTop=G({rect:h.getBoundingClientRect(),currentScrollTop:o}),g;const{node:y,blockStore:v}=function(e){let t=e.getParentBlockStore();for(;t;){const e=t.getParentBlockStore();if(!e)return{};const o=f.C.findNodeFromBlockId(t.id);if(o)return{node:o,blockStore:t};t=e}return{}}(m);if(y instanceof HTMLElement&&v)return g.offsetTop=G({rect:y.getBoundingClientRect(),currentScrollTop:o})+10,g.parentBlockStore=v,g.shouldGroup=!0,g.closestVisibleParentId=v.id,g}({discussionStore:e,currentScrollTop:P,topbarHeight:w,windowHeight:x,pageViewBlockElement:m,previousDiscussionElements:I,currentDiscussionElements:C,selectedDiscussionId:s}))).filter(c.$K));const j=p&&function(e){var t;let o,{blockStore:n,discussionInputStore:r,currentScrollTop:i,pageViewBlockElement:a}=e;const s=null===(t=a.getElementsByClassName(d.dXl))||void 0===t?void 0:t[0];o=s instanceof HTMLElement?s.getBoundingClientRect():g.R.getRect(n);if(!o)return;return{offsetTop:G({rect:o,currentScrollTop:i}),parentBlockStore:n,discussionInputStore:r,type:"new",id:B,createdTimeMs:Date.now()}}({...p,currentScrollTop:P,pageViewBlockElement:m}),O=j?j.id:s;let L;j&&N.push(j);const U=O||b?void 0:function(e){let{pageContentStores:t,currentScrollTop:o,marginContainerRect:n,isFullWidth:r}=e;return t.map((e=>{const t=e.getType();if(!t)return;let o;var a;if(i.Ok[t]||"column_list"===t)o=null===(a=f.C.findSelectableFromStore(e))||void 0===a||null===(a=a.getNode())||void 0===a?void 0:a.getBoundingClientRect();else if(t===i.Ti.table){var s,l;const t=null===(s=f.C.findSelectableFromStore(e))||void 0===s?void 0:s.getNode(),n=null==t?void 0:t.getBoundingClientRect(),i=null==t||null===(l=t.querySelector(F))||void 0===l?void 0:l.getBoundingClientRect();o=r?n:n&&i?n.width<i.width?n:i:n||i}else if(e.isInlineCollectionView()){var c,d;const t=null===(c=f.C.findSelectableFromStore(e))||void 0===c?void 0:c.getNode();o=r?null==t?void 0:t.getBoundingClientRect():null==t||null===(d=t.querySelector(E))||void 0===d?void 0:d.getBoundingClientRect()}return o&&o.right>n.left?o:void 0})).filter(c.$K).map((e=>{const t=G({rect:e,currentScrollTop:o});return new DOMRect(e.left,t,e.width,e.height)}))}({pageContentStores:o,currentScrollTop:P,marginContainerRect:D,isFullWidth:_}).sort((e=>-e.top));N=N.sort(W).map(((e,t)=>{e.offsetTop-R>=18&&(e.offsetTop-=18);const o=e.id,n=r.get(e.id);if(!n)return"new"===e.type||y||(e.offsetTop=-9999,e.hide=!0),e;const i=n.getBoundingClientRect(),a=i.height;let s=e.offsetTop;return s<=T&&(s=T),U&&(s=function(e,t){const o={x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,left:e.left,bottom:e.bottom,right:e.right};let n=t[t.length-1];for(;n;)if((0,v.dQ)(o,n))o.top=n.bottom+10,o.bottom=o.top+o.height,t.pop(),n=t[t.length-1];else{if(o.bottom<n.top)return o.top;t.pop(),n=t[t.length-1]}return o.top}(new DOMRect(i.left,s,i.width,i.height),U)),o===O&&0===M&&(M+=s-e.offsetTop,e.selected=!0,L=t),e.offsetTop=s,e.height=a,T=e.offsetTop+a,e}));const Z=N.map((e=>(e.offsetTop=e.offsetTop-R,e)));let V;if(M>0&&void 0!==L)for(let n=L;n>=0;n--){const e=Z[n];if(e.height){if(e.id===O)e.offsetTop-=M;else{if(!(V&&V.offsetTop<=e.offsetTop+e.height))break;e.offsetTop-=M}V=e}}h({data:Z,hasNewDiscussion:Boolean(j),selectedDiscussion:s},C)}),100);function G(e){let{rect:t,currentScrollTop:o}=e;return t.top+o}},92120:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085),r=o(92595);class i extends n.default{getInitialState(){}getFirstSelectedDiscussionId(){var e;return null===(e=this.state)||void 0===e||null===(e=e.discussionIds)||void 0===e?void 0:e[0]}}const a=new i;(0,r.exposeDebugValue)("DiscussionHoverStore",a);const s=a},82994:(e,t,o)=>{o.d(t,{Z:()=>c});var n=o(26263),r=o(49085),i=o(4615),a=o(70279),s=o(35661);class l extends r.default{constructor(e,t){super(),this.environment=void 0,this.spaceId=void 0,this.environment=e,this.spaceId=t,this.reset()}getInitialState(){if(!this.environment)return;const e=new n.Z({name:"DiscussionInputStore"});return{textStore:new s.ST({environment:this.environment,pointer:{table:a.x_,id:(0,i.ZP)(),spaceId:this.spaceId},path:["text"],inMemoryRecordCache:e}),localRecordCache:e,files:[],showAttachFileIntro:!1,renderFileAttachIntro:!1}}isEmpty(){const e=this.state.textStore.getValue();return!e||0===e.length}}const c=l},48514:(e,t,o)=>{o.d(t,{Z:()=>l});var n=o(49085),r=o(92595),i=o(15723);class a extends n.default{getInitialState(){return{open:!1,rect:i.bM}}}const s=new a;(0,r.exposeDebugValue)("NewDiscussionMenuStore",s);const l=s},9080:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(15723);class i extends n.default{getInitialState(){return{open:!1,rect:r.bM}}}const a=new i},24736:(e,t,o)=>{o.d(t,{Z:()=>s});o(67294);var n=o(24405),r=o(56666),i=o(64921),a=o(85893);function s(e){let{onClick:t,className:o,isMobile:s,style:l,onFocus:c,onBlur:d,onMouseDown:p,onMouseEnter:u,onMouseLeave:m}=e;window.__c={n:"ActionMenuButton"};const{buttonStyle:g,iconStyle:h}=(0,n.yK)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,borderRadius:4,width:s?45:24,height:s?45:24,marginRight:s?-8:-6,...l},iconStyle:{width:s?18:14,height:s?18:14,fill:e.mediumIconColor}})),[s,l]);return(0,a.jsx)(i.Z,{onClick:t,style:g,className:o,mobileFeedback:s,onFocus:c,onBlur:d,onMouseDown:p,onMouseEnter:u,onMouseLeave:m,children:(0,r.o)(h)})}},1292:(e,t,o)=>{o.d(t,{Z:()=>L});var n=o(67294),r=o(73935),i=o(83355),a=o(15145),s=o(70037),l=o(21202),c=o(33709),d=o(23867),p=o(82990),u=o(5366),m=o(50906),g=o(75018),h=o(97444),f=o(32741),y=o(95477),v=o(66213),b=o(14976),S=o(35683),_=o(84210),w=o(98165),k=o(77907),x=o(77080),I=o(61738),C=o(72014),T=o(31194),M=o(35661),P=o(24736),A=o(2834),D=o(68709),B=o(31945),R=o(84076),E=o(31278),F=o(76798),N=o(24813),j=o(85893);class O extends A.Z{constructor(){super(...arguments),this.nodeRef=n.createRef(),this.state={isHovered:!1},this.origin=n.createRef(),this.handlePageClick=()=>{const{store:e}=this.props;m.Se(this.environment),I.Z.recordVisit({id:e.id,systemBlockType:e.getSystemBlockTypeStore().getValue(),type:S.vu.Link,currentUserId:this.environment.currentUser.id}),m.SK1(this.environment,{page_visit_id:C.$g.getCurrentPageVisitId(),mentioned_page_id:e.id,source_type:"alias_block",hover_preview_enabled:x.default.checkGate("first_party_links"),is_navigable_block:e.isNavigableBlock()})},this.handlePageMouseOver=e=>{const t=this.getInteractiveToken(),o=this.props.store.getTitleStore();o&&t&&h.Nh({environment:this.environment,event:e,interactiveToken:t,store:o,canEdit:this.canEdit()})},this.handlePageMouseOut=e=>{const t=this.getInteractiveToken(),o=this.props.store.getTitleStore();o&&t&&h.Zl({environment:this.environment,event:e,interactiveToken:t,store:o,canEdit:this.canEdit()})},this.handleMouseEnter=()=>{this.setState({isHovered:!0})},this.handleMouseLeave=()=>{this.setState({isHovered:!1})}}activate(){const{store:e}=this.props;this.navigate(e)}willUnmount(){super.willUnmount(),f.qA(this.props.store.getTitleStore())}navigate(e){if(this.context.overrideLinkClick){const t=(0,_.ZP)({store:e,pageVisitSource:a.tY.LinkInPage});this.context.overrideLinkClick(t)}else g.navigateToBlock({environment:this.environment,store:e,visitType:S.vu.Link,pageVisitSource:a.tY.LinkInPage})}renderPersisted(){const{disabled:e,store:t}=this.props,o=t.getAliasTargetStore();if(!o)return;if(o instanceof M.G)return(0,j.jsx)(D.p,{allowSelectionWithin:!1,onMouseOver:this.handlePageMouseOver,onMouseOut:this.handlePageMouseOut,children:(0,j.jsx)(N.Z,{ref:this.nodeRef,store:o,style:{...this.getBlockColorStyle(),...this.props.style},isAlias:!0,aliasStore:t,disabled:e,onClick:this.handlePageClick})});const n=w.Dg(o);if("none"===o.getRole())return(0,j.jsx)(D.p,{allowSelectionWithin:!1,children:(0,j.jsx)("div",{style:{border:`1px solid ${this.theme.darkDividerColor}`,borderRadius:4},children:(0,j.jsx)(R.Z,{ref:this.origin,style:{width:"100%"},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:(0,j.jsxs)("div",{style:{display:"flex",padding:9},children:[(0,s.h)({width:30,height:30,marginRight:10,marginLeft:5}),(0,j.jsxs)("div",{style:{fontSize:14},children:[(0,j.jsx)("div",{style:{fontWeight:p.Z.fontWeight.medium},children:(0,j.jsx)(u.FormattedMessage,{defaultMessage:"No access to page comments",id:"aliasBlock.comment.noAccess.title"})}),(0,j.jsx)(u.FormattedMessage,{defaultMessage:"You don't have permission to view this page and its comments",id:"aliasBlock.comment.noAccess.subtitle"})]})]})})})});if(!n||!o.isDefined())return this.renderShimmerState();const r=M.t1.createChildStore(n,{table:c.qF,id:o.getParentId(),spaceId:(0,d.C)(n.pointer.spaceId)});if(null==r||!r.isDefined())return;const i=r.getModel(),m=M.G.createChildStore(n,i.getParentPointer()).getModel(),g=m&&"table_row"===m.getType()?m.getParentId():i.getParentId(),h=M.t1.createChildStore(n,{table:l.iU,id:g,spaceId:(0,d.C)(n.pointer.spaceId)});if(!h.isDefined())return;const f=n.isDefined()?h.getModel().getRenderUrl({getRecordModel:t.getRecordModel,baseUrl:y.default.domainBaseUrl,discussionId:r.id,pageVisitSource:a.tY.LinkInPage}):void 0,{isMobile:v}=this.environment.device;return(0,j.jsx)(D.p,{allowSelectionWithin:!1,children:(0,j.jsx)("div",{style:{border:`1px solid ${this.theme.darkDividerColor}`,cursor:"pointer",borderRadius:4},children:(0,j.jsxs)(R.Z,{ref:this.origin,style:{display:"flex",flexDirection:"column"},href:f,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,j.jsxs)("div",{style:{display:"flex"},children:[(0,j.jsx)(k.LazyComment,{store:o,discussionStore:r,showResolveButtonByDefaultIfPossible:!1,blockStore:t,hoveringDiscussion:!1,discussionLocation:"comment_unfurl",collapsed:!0,maxLines:2},o.id),(0,j.jsx)(B.ZP,{popupType:v?B.Z4.SlideUp:B.Z4.Popup,renderOrigin:e=>(0,j.jsx)(P.Z,{...e,isMobile:v,style:{margin:8,opacity:v||this.state.isHovered?1:0}}),placementToOrigin:T.Iw.Top,render:e=>(0,j.jsx)(k.LazyAliasBlockPopupMenu,{onAccept:e.close,block:t})})]}),n&&(0,j.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:"50px",marginBottom:"10px"},children:[(0,j.jsx)(E.Z,{disabled:!0,icon:n.getIcon(),isEmptyPage:n.isEmptyPage(),size:14,style:{marginLeft:2,marginRight:2}}),(0,j.jsx)(F.Z,{store:n,style:{color:"gray",fontSize:"smaller"}})]})]})})})}getInteractiveToken(){const e=this.props.store.getAliasTargetStore();if(!(this.nodeRef&&this.nodeRef.current&&e instanceof M.G))return;const t=r.findDOMNode(this.nodeRef.current);return(0,b.We)(e,t)}renderShimmerState(){return(0,j.jsxs)(R.Z,{external:!0,style:{flexGrow:1,minWidth:0},children:[this.renderShimmerbox({width:38,height:38}),(0,j.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexGrow:1},children:[this.renderShimmerbox({width:"50%",height:14,margin:4}),this.renderShimmerbox({width:"40%",height:12,margin:4})]})]})}renderShimmerbox(e){return(0,j.jsx)("div",{style:{overflow:"hidden",position:"relative",background:this.theme.selectLightGray[30],...e},children:(0,j.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",zIndex:1,animation:"shimmer 1s infinite",background:`linear-gradient(to right, ${this.theme.selectLightGray[30]} 0%, ${this.theme.selectLightGray[50]} 20%, ${this.theme.selectLightGray[30]} 40%, ${this.theme.selectLightGray[30]} 100%)`}})})}}O.contextTypes={...v.wK,...i.w};const L=O},77933:(e,t,o)=>{o.d(t,{Z:()=>P});o(67294);var n=o(83355),r=o(49085),i=o(56666),a=o(5366),s=o(80365),l=o(15145),c=o(9999),d=o(82990),p=o(84210),u=o(67669),m=o(18514),g=o(80444),h=o(81236),f=o(84076),y=o(31278),v=o(76798),b=o(94096),S=o(78454),_=o(32469),w=o(85893);class k extends n.Z{constructor(){super(...arguments),this.isPrivate=this.createComputedStore((()=>!(0,u.yi)(this.environment,this.props.currentBlockStore)&&(0,u.yi)(this.environment,this.props.backlinkStore)))}renderComponent(){const{backlinkStore:e,scrollToBlockId:t,discussionId:o}=this.props,{mainEditorCurrentBlockStore:n}=g.default.state,r=n&&n.id===e.id,i=(0,p.ZP)({store:e,scrollToBlockId:t,discussionId:o,fullyQualified:!0,preferPublicLink:(0,m.Sr)(),getSpaceDomain:()=>{var t;return null===(t=h.Z.getPublicSpaceData(this.environment,e.getSpaceId()))||void 0===t?void 0:t.domain},pageVisitSource:l.tY.LinkInPage});return(0,w.jsx)(f.Z,{href:i,external:!1,innerStyle:{paddingLeft:8,paddingRight:16},children:(0,w.jsx)(S.ZP,{childrenStyle:{padding:"4px 2px"},alignment:S.v2.Center,style:{marginBottom:2,marginRight:4},right:(0,w.jsxs)(w.Fragment,{children:[this.props.showOriginalToken&&(0,w.jsx)("div",{style:this.getTokenStyle(),children:(0,w.jsx)(a.FormattedMessage,{defaultMessage:"Original",id:"backlink.originalTokenLabel"})}),r&&!this.props.disableCurrentPageToken&&(0,w.jsx)("div",{style:this.getTokenStyle(),children:(0,w.jsx)(a.FormattedMessage,{defaultMessage:"This page",id:"backlink.currentPageTokenLabel"})})]}),children:(0,w.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[!this.props.disableArrow&&this.renderArrowIcon(),this.renderIcon(),(0,w.jsx)(v.Z,{store:e,style:this.getTitleStyle()}),(0,w.jsxs)("div",{style:{marginTop:-2,minWidth:0,display:"flex",alignItems:"baseline",flex:"2 0 40%",paddingTop:"0.1em"},children:[(0,w.jsx)(b.Z,{store:e,style:{paddingLeft:8}}),this.renderPrivate()]})]})})})}renderArrowIcon(){return(0,w.jsx)("div",{style:{marginLeft:4,transform:"rotate(180deg)",fill:this.theme.regularIconColor},children:(0,c.J)({width:15,height:15})})}renderIcon(){const{backlinkStore:e}=this.props;return(0,w.jsx)(y.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:20,style:{marginLeft:4,marginRight:4}})}renderPrivate(){if(this.isPrivate.state)return(0,w.jsx)(_.Z,{style:{paddingRight:4,marginLeft:12}})}getTitleStyle(){return{fontWeight:d.Z.fontWeight.medium,fontSize:d.Z.fontSize.UIRegular.desktop,lineHeight:1.3,borderBottom:`1px solid ${this.theme.darkDividerColor}`,flexShrink:1}}getTokenStyle(){const{device:e}=this.environment;return{padding:"2px 6px",borderRadius:4,color:this.theme.mediumTextColor,background:this.theme.legacyDefaultSelectColor,fontSize:e.isMobile?11:9,lineHeight:e.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",whiteSpace:"nowrap",marginLeft:4}}}k.displayName="Backlink";const x=(0,a.injectIntl)(k);var I=o(89728),C=o(26388),T=o(64369);class M extends n.Z{constructor(){super(...arguments),this.storeTypes={showMore:r.default.createClass(10),hovered:r.default.createClass(!1)},this.handleMouseMove=()=>{this.stores.hovered.setState(!0)},this.handleMouseLeave=()=>{this.stores.hovered.setState(!1)},this.handleShowMore=()=>{this.stores.showMore.setState(this.stores.showMore.state+10)},this.backlinksState=this.createComputedStore((()=>(0,s.L)(this.props.store,this.environment)),!0)}renderComponent(){const{originalTransclusionStore:e,disableInaccessiblePages:t}=this.props,o=this.backlinksState.state,n=this.stores.showMore.state,r=e?e.getNavigableBlockStore():void 0;if(0===o.backlinks.length&&!e)return;const s=o.backlinks.length>n,l=o.inaccessibleBacklinkCount>0&&!t;return(0,w.jsxs)("div",{onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,children:[this.props.headerText&&this.renderHeader(),e&&r&&(0,w.jsx)(x,{currentBlockStore:this.props.store,disableArrow:this.props.disableArrow,disableCurrentPageToken:this.props.disableCurrentPageToken,backlinkStore:r,scrollToBlockId:e.id,showOriginalToken:!0}),o.backlinks.slice(0,n).map((e=>(0,w.jsx)(x,{currentBlockStore:this.props.store,disableArrow:this.props.disableArrow,disableCurrentPageToken:this.props.disableCurrentPageToken,...e},e.backlinkStore.id))),(s||l)&&(0,w.jsx)(C.Z,{disableTooltip:s,renderTooltip:()=>(0,w.jsx)(a.FormattedMessage,{defaultMessage:"Synced in pages that you don't have access to.",id:"page.backlinks.privatePagesTooltip"}),render:e=>(0,w.jsx)(I.Z,{icon:i.o,isGray:!0,onClick:this.handleShowMore,style:{padding:`2px ${this.props.disableArrow?17:14}px`,width:"100%"},disabled:!s,...e,children:s?(0,w.jsx)(a.FormattedMessage,{defaultMessage:"{count} more",id:"page.backlinks.more",values:{count:o.backlinks.length-n}}):(0,w.jsx)(a.FormattedMessage,{id:"page.backlinks.privatePages",defaultMessage:"{count, plural, one {{count} private page} other {{count} private pages}}",values:{count:o.inaccessibleBacklinkCount}})})})]})}renderHeader(){return(0,w.jsx)("div",{style:{display:"flex"},children:(0,w.jsx)(T.Z,{isSmall:!0,style:{marginTop:12,marginBottom:8,marginLeft:4,flex:1,paddingLeft:8},children:this.props.headerText})})}}M.displayName="Backlinks";const P=M},4350:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(83355),r=o(23867),i=o(80444);class a extends n.Z{willMount(){l()||this.environment.LocalBacklinkStore.initializeBacklinks({block:{id:this.props.store.pointer.id,spaceId:(0,r.C)(this.props.store.pointer.spaceId)},currentUserId:this.environment.currentUser.id,environment:this.environment})}willUnmount(){l()||this.environment.LocalBacklinkStore.destroyBacklinks(this.props.store.id,this.environment)}}a.displayName="BacklinksListener";const s=a;function l(){const{mainEditorCurrentBlockStore:e}=i.default.state;return Boolean(e&&"15776535-3f2c-4705-bd45-474e5ba8b46c"===e.id)}},2834:(e,t,o)=>{o.d(t,{Z:()=>g});var n=o(83355),r=o(13991),i=o(8848),a=o(82990),s=o(92650),l=o(67669),c=o(65598),d=o(58202),p=o(35661),u=o(99757);class m extends n.Z{constructor(){super(...arguments),this.renderedType="block",this.getBlockStore=()=>this.props.store,this.canEditComputedStore=this.createComputedStore((()=>{if(this.props.disabled)return!1;if(u.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,l.YF)(e)&&this.props.store.canEdit()})),this.marginCommentsVisible=this.createComputedStore((()=>(0,s.fg)(this.environment,this.props.store))),this.rootStorePageFont=this.createComputedStore((()=>{const e=this.props.store.getRecordStoreUIRoot();if(!(e instanceof p.G))return;const t=e.getFormatStore().getKeyStore("page_font").getValue();return a.Z.getHeaderFontFamily({pageFont:t,locale:r.SP})}))}get registries(){return[d.R]}canEdit(){return this.canEditComputedStore.state}canEditCollection(){if(this.props.disabled)return!1;if(u.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,l.YF)(e)&&this.props.store.canEditCollection()}canComment(){return!this.props.disabled&&(!u.n.state&&this.props.store.canComment())}canAdmin(){return!this.props.disabled&&(!u.n.state&&this.props.store.canAdmin())}canView(){const{store:e}=this.props;return e.canRead()}isRootOrDirectChild(){return this.props.store.isRootOrDirectChild()}renderComponent(){const{store:e}=this.props;if(e)return e?(0,c.SJ)(e)?void 0:this.renderPersisted():void 0}renderPersisted(){}getBlockColorStyle(){const e=this.props.store.getFormat().block_color||"default";return(0,i.fi)(e,this.theme)}}m.displayName="Block";const g=m},13966:(e,t,o)=>{o.d(t,{Z:()=>g});o(67294);var n=o(83355),r=o(56666),i=o(6404),a=o(24677),s=o(43250),l=o(98742),c=o(27724),d=o(64921),p=o(26388),u=o(85893);class m extends n.Z{constructor(){super(...arguments),this.renderButton=e=>(0,u.jsx)(d.Z,{className:this.props.fadeIn?s.JiD:void 0,style:this.getButtonStyle(),hoveredStyle:this.props.hoveredStyle,onClick:this.handleActionButtonClick,...(0,l.Z)(e,{onFocus:this.props.onFocus,onBlur:this.props.onBlur}),children:(0,r.o)({width:14,height:14,...this.props.iconStyle})}),this.handleActionButtonClick=e=>{const{store:t,onClick:o,extraAnalyticsData:n}=this.props;a.Ys({environment:this.environment,store:t}),i.Qn({environment:this.environment,stores:c.default.state.stores,left:e.clientX,top:e.clientY,showInput:!this.props.hideFilterActionsInput,actionSectionGroupKey:this.props.actionSectionGroupKey||"default",analyticsFrom:"block_more_menu",optionalAnalyticsProperties:{isFromBulkActionsToolbar:n?n.isFromBulkActionsToolbar:void 0}}),null==o||o()}}renderComponent(){return this.props.tooltipContent?(0,u.jsx)(p.Z,{renderTooltip:()=>this.props.tooltipContent,delayThreshold:300,render:this.renderButton}):this.renderButton({})}getButtonStyle(){const{device:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:24,height:24,borderRadius:4,fill:e.isMobile?this.theme.lightIconColor:this.theme.mediumIconColor,transition:"opacity 200ms ease-in",...this.props.style}}}m.displayName="BlockActionMenuButton";const g=m},91893:(e,t,o)=>{o.d(t,{Z:()=>f});var n=o(67294),r=o(480),i=o(86628),a=o(24405),s=o(49271),l=o(5366),c=o(92650),d=o(68056),p=o(24646),u=o(24666),m=o(65187),g=o(85893);const h=(0,l.defineMessages)({imageCaption:{defaultMessage:"Write a captionâ€¦",id:"block.imageCaption.placeholder"}});function f(e){let{captionAriaId:t,disabled:o,store:f}=e;window.__c={n:"BlockCaption"};const y=(0,r.O7)(),v=(0,r.Fy)(),b=(0,l.useIntl)(),S=(0,n.useMemo)((()=>f.getPropertyStore("caption")),[f]),_=(0,i.VK)((()=>{var e;const t=S.getValue(),o=!t||0===t.length,n="editing"===u.default.state.mode&&(null===(e=(0,d.QY)(u.default.state.multiSelection))||void 0===e?void 0:e.store)===S;return!o||n}),[S]),w=(0,i.VK)((()=>{const{block_full_width:e,block_width:t,block_page_width:o}=f.getFormat();if(v.isMobile)return!1;if(o)return!1;if(e)return!0;const n=(0,c.fg)(y,f);return(t||0)>=y.WindowSizeStore.state.width-(0,p.Wk)(y)-(n&&f.isFullWidth()?c.QB:0)}),[v.isMobile,y,f]),k=(0,a.yK)((e=>({root:{fontSize:14,lineHeight:1.4,color:e.mediumTextColor,paddingTop:6,paddingBottom:6,paddingLeft:s.ZD.paddingLeft,...w&&{paddingLeft:26,paddingRight:26}}})),[w]);return _?(0,g.jsx)(m.Z,{id:t,disabled:o,style:k.root,placeholderStyle:k.root,placeholder:b.formatMessage(h.imageCaption),disableSlashCommands:!0,disableEmbedMenu:!0,store:S,pasteBehavior:"block"}):null}},23864:(e,t,o)=>{o.d(t,{Z:()=>h});var n=o(67294),r=o(480),i=o(86628),a=o(41432),s=o(25487),l=o(92650),c=o(78175),d=o(98165),p=o(77907),u=o(24646),m=o(35661),g=o(85893);function h(e){let{disableCommentMenu:t,hideContent:o,hideIfSidebarOrMarginCommentsVisible:h,recursivelyLoadAllDiscussions:f,store:y,style:v}=e;window.__c={n:"BlockDiscussionIndicator"};const b=(0,r.O7)(),S=(0,r.Fy)(),_=(0,i.VK)((()=>{const e=y.getModel();return Boolean(null==e?void 0:e.isType(a.eh))}),[y]),w=(0,i.VK)((()=>{const e=(0,d.qA)(y);let t,o,n,r;for(const i of e){if(i instanceof m.G&&t){const e=i.getType();if(e&&(0,a.S9)(e)&&i.id!==y.id)break;if("column_list"===e){const e=i.getContentStore().getValue()||[];o=e.indexOf(t.id),n=e.length,r=(0,c.Po)(i,b)}}t=i}return{columnListIndex:o,columnListColumnCount:n,columnListResizable:r}}),[b,y]),k=(0,n.useCallback)((()=>{if(!S.isMobile){if(void 0===w.columnListIndex)return s.DiscussionIndicatorFormat.FloatRight;if(!w.columnListResizable&&w.columnListColumnCount&&w.columnListIndex===w.columnListColumnCount-1)return s.DiscussionIndicatorFormat.FloatRight}return s.DiscussionIndicatorFormat.PushContent}),[w.columnListColumnCount,w.columnListIndex,w.columnListResizable,S.isMobile]),x=(0,i.VK)((()=>(0,u.Sx)(b)),[b]),I=(0,i.VK)((()=>(0,l.fg)(b,y)),[b,y]);return t||o||(_||h)&&(x||I)?null:(0,g.jsx)(p.LazyDiscussionIndicator,{store:y,getFormat:k,style:v,recursivelyLoadAllDiscussions:Boolean(f),onlyCountBlockLevelDiscussions:x},"DiscussionIndicator")}},70518:(e,t,o)=>{o.d(t,{IS:()=>k,ZP:()=>C,bZ:()=>x});o(21703),o(67294);var n=o(73935),r=o(83355),i=o(41432),a=o(95538),s=o(72126),l=o(50906),c=o(96802),d=o(24677),p=o(39699),u=o(28020),m=o(43250),g=o(77546),h=o(58202),f=o(49427),y=o(68859),v=o(35661),b=o(91681),S=o(27724),_=o(6685),w=o(85893);let k=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.Corner=2]="Corner",e}({}),x=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class I extends r.Z{constructor(){super(...arguments),this.dragState=void 0,this.domElm=null,this.storeTypes={blockResizerStore:y.Z},this.handleRef=e=>{this.domElm=e},this.handleDragStart=e=>{e.preventDefault();const t=n.findDOMNode(this.props.resizeComponent);if(!(t&&t instanceof Element))return;let o=0;if(this.domElm){const e=(0,g.VW)(this.domElm);e&&(o=e.getBoundingClientRect().width)}let r=0;const a=this.props.store.getRecordStoreUIParent(),l=a&&a.findRecordStoreUIAncestor((e=>e instanceof v.G)).ancestor;if(l){const e=h.R.getRect(l);e&&(r=e.width);const t=l.getRecordStoreUIParent(),o=t&&t.findRecordStoreUIAncestor((e=>e instanceof v.G)).ancestor;if("tab"===(null==o?void 0:o.getType())){const e=h.R.getRect(o);e&&(r=e.width)}}const c=this.getPageViewWrapWidth()||0,p=S.default.state.stores.filter((e=>function(e){const t=e&&e.getType();return t&&i.Ok[t]}(e)));let u;u=s.q9(p,this.props.store)?p:[this.props.store];const{block_width:m,block_height:f,block_full_width:y,block_page_width:_}=this.props.store.getFormat();this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,dragging:!0,temporaryHeight:f,temporaryWidth:m,temporaryFullWidth:y,temporaryPageWidth:_}),b.Z.setState({...b.Z.state,isResizing:!0}),d.ZH(this.environment);const w=t.getBoundingClientRect();this.dragState={resizingBlocks:u,startWidth:w.width,startHeight:w.height,parentWidth:r,pageWidth:c,isRootChild:this.props.store.isChildOfRecordStoreUIRoot(),startScrollerWidth:o,didDragMove:!1}},this.handleHorizontalDragMove=e=>{let{diffX:t}=e;if(!this.dragState)return;this.dragState.didDragMove=!0;const{temporaryHeight:o}=this.stores.blockResizerStore.state,{width:n,isFullWidth:r,isPageWidth:i}=this.getNewWidthStyleValue(t);if(this.props.preserveScale){const e=r?o||a.QA:o;this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryWidth:n,temporaryFullWidth:r,temporaryPageWidth:i,temporaryHeight:e})}else this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryWidth:n,temporaryFullWidth:r,temporaryPageWidth:i})},this.handleVerticalDragMove=e=>{let{diffY:t}=e;if(!this.dragState)return;this.dragState.didDragMove=!0;const{height:o}=this.getNewHeightStyleValue(t);this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryHeight:o})},this.handleCornerDragMove=e=>{let{diffX:t,diffY:o}=e;if(!this.dragState)return;this.dragState.didDragMove=!0;const{width:n,isFullWidth:r,isPageWidth:i}=this.getNewWidthStyleValue(t),{height:a}=this.getNewHeightStyleValue(o);this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryWidth:n,temporaryHeight:a,temporaryFullWidth:r,temporaryPageWidth:i})},this.handleDragMove=e=>this.props.resizerType===k.Horizontal?this.handleHorizontalDragMove(e):this.props.resizerType===k.Vertical?this.handleVerticalDragMove(e):this.props.resizerType===k.Corner?this.handleCornerDragMove(e):void 0,this.handleDragEnd=e=>{if(!this.dragState)return;const t=this.stores.blockResizerStore.state;if(this.dragState.didDragMove&&t.dragging){const{temporaryPageWidth:e,temporaryFullWidth:t,temporaryWidth:o,temporaryHeight:n}=this.stores.blockResizerStore.state;p.createAndCommit({userAction:"BlockResizer.handleDragEnd",environment:this.environment,perform:r=>{this.dragState&&c.FH({stores:this.dragState.resizingBlocks,update:{block_height:n,block_width:o,block_full_width:t,block_page_width:e},transaction:r})}});const r=this.props.store.getType();r&&l.Wlu(this.environment,{block_type:r,block_height:n,block_width:o,block_full_width:t,block_page_width:e})}this.endDrag()},this.handleDragCancel=e=>this.endDrag()}renderComponent(){return(0,w.jsx)(_.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,preventSidebar:!0,render:e=>(0,w.jsx)("div",{ref:this.handleRef,style:I.style,className:m.Ep8,...e,children:this.props.children})})}isCenterAligned(){const e=this.props.store.getModel();return this.props.store.isChildOfRecordStoreUIRoot()&&(null==e?void 0:e.isType(i.ib))}endDrag(){this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,dragging:!1,temporaryPageWidth:void 0,temporaryFullWidth:void 0,temporaryWidth:void 0,temporaryHeight:void 0}),d.ZH(this.environment),b.Z.setState({...b.Z.state,isResizing:!1}),this.dragState=void 0}getNewHeightStyleValue(e){const t=this.getNewPixelHeight(e);return{height:Math.min(t,a.Kz)}}getNewPixelHeight(e){if(this.dragState){if(this.props.resizeVertically){const t=this.props.store.getType(),o=t&&I.minHeightMap[t]||I.defaultMinHeight;return Math.max(this.dragState.startHeight+e,o)}return this.dragState.startHeight}return 0}getNewWidthStyleValue(e){const t=this.getNewPixelWidth(e),o=t<144?12:48;const n=Math.round(t/o)*o,r=this.isPageWidth(t,o);return{width:n,isFullWidth:this.isFullWidth(t,o)&&!r,isPageWidth:r}}isPageWidth(e,t){return!!this.dragState&&(this.dragState.isRootChild?this.dragState.pageWidth<e+t&&this.dragState.pageWidth>e-t:this.dragState.parentWidth<e+t)}isFullWidth(e,t){if(this.dragState&&this.dragState.isRootChild){let o=this.dragState.startScrollerWidth;const n=this.props.store.getModel();return n&&!n.isType(i.GP)&&(o-=2*(0,u.ui)(this.environment)),o<e+t}return!1}getNewPixelWidth(e){if(!this.dragState)throw new Error("No start rect.");this.isCenterAligned()&&(e*=2);let t=this.dragState.startWidth;this.props.resizeHorizontally&&(this.props.resizerAlignment===x.Left?t-=e:this.props.resizerAlignment===x.Right&&(t+=e));const o=this.props.store.getType(),n=o&&I.minWidthMap[o]||I.defaultMinWidth,r="page_width"===n?Math.min(this.dragState.parentWidth,this.dragState.pageWidth):n;return r&&t<r&&(t=r),t}getPageViewWrapWidth(){const e=this.props.store.getRecordStoreUIRoot(),t=f.Z.find((t=>t.props.store===e));if(t)return t.getContentInnerWidth()}}I.displayName="BlockResizer",I.defaultMinWidth=96,I.minWidthMap={[i.Ti.image]:36,[i.Ti.video]:96,[i.Ti.embed]:246,[i.Ti.maps]:96,[i.Ti.framer]:96,[i.Ti.tweet]:250,[i.Ti.gist]:96,[i.Ti.audio]:96,[i.Ti.drive]:300,[i.Ti.invision]:96,[i.Ti.pdf]:96,[i.Ti.columnList]:"page_width",[i.Ti.drawing]:300},I.defaultMinHeight=96,I.minHeightMap={[i.Ti.image]:36,[i.Ti.audio]:24,[i.Ti.video]:96,[i.Ti.embed]:96,[i.Ti.drive]:96,[i.Ti.tweet]:96,[i.Ti.framer]:96,[i.Ti.maps]:96,[i.Ti.gist]:96,[i.Ti.invision]:96,[i.Ti.pdf]:96,[i.Ti.drawing]:200},I.style={display:"contents"};const C=I},7825:(e,t,o)=>{o.d(t,{ZP:()=>b,_1:()=>S});var n=o(67294),r=o(86628),i=o(24405),a=o(49271),s=o(22491),l=o(62965),c=o(5366),d=o(33929),p=o(73819),u=o(23864),m=o(55217),g=o(78454),h=o(65187),f=o(85893);const y=(0,c.defineMessages)({listPlaceholder:{defaultMessage:"List",id:"bulletedListBlock.placeholder.label"}});function v(e,t){window.__c={n:"BulletedListBlock"};const o=(0,n.useRef)(null),l=(0,r.VK)((()=>{var t;const o=null===(t=e.bulletedListFormatStore)||void 0===t?void 0:t.getState();return function(e,t){switch(e){case"disc":return'"â€¢"';case"circle":return'"â—¦"';case"square":return'"â–ª"';default:return t%3==0?'"â€¢"':t%3==1?'"â—¦"':'"â–ª"'}}(null==o?void 0:o.blockIdFormats.get(e.store.id),(null==o?void 0:o.depth)||0)}),[e.bulletedListFormatStore,e.store.id]),c=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),v=(0,r.VK)((()=>e.store.getContentStore()),[e.store]),b=(0,p.rv)(e.store),_=(0,i.yK)((()=>({root:{...{paddingLeft:a.ZD.paddingLeft},...b,...e.style}})),[b,e.style]),w=(0,f.jsxs)(g.ZP,{style:_.root,left:(0,f.jsx)("div",{...(0,s.iv)({fontSize:"1.5em",lineHeight:1,marginBottom:0,pseudoBefore:{fontFamily:"Arial",content:l}})}),childrenStyle:{display:"flex",flexDirection:"column"},ref:o,children:[(0,f.jsxs)("div",{style:{display:"flex"},children:[(0,f.jsx)(h.Z,{style:g.R8,disabled:e.disabled,store:c,placeholder:d.default.formatMessage(y.listPlaceholder),pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,f.jsx)(u.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store,style:S})]}),!e.hideContent&&(0,f.jsx)(m.Z,{disabled:e.disabled,store:v,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,bulletedListFormatStore:e.bulletedListFormatStore})]});return(0,p.ez)(e.store,t,(0,n.useMemo)((()=>({renderedType:"bulleted_list",getNode:()=>o.current,getBlockStore:()=>e.store})),[e.store]),w)}const b=n.memo(n.forwardRef(v),l.Z),S={paddingLeft:0,marginLeft:-6,paddingBottom:2}},27755:(e,t,o)=>{o.d(t,{y:()=>z,Z:()=>G});o(57658);var n=o(67294),r=o(1302),i=o(480),a=o(86628),s=o(24405),l=o(63362),c=o(18442),d=o(54497),p=o(72126),u=o(5366),m=o(97880),g=o(82990),h=o(24677),f=o(98104),y=o(93174),v=o(2553),b=o(41301),S=o(30912),_=o(33929),w=o(98742),k=o(52315),x=o(63474),I=o(49085);class C extends I.default{getInitialState(){return{editing:!1,suppressErrorsForActionIds:[]}}startEditing(e){this.setState({editing:!0,suppressErrorsForActionIds:[],placement:e.placement})}stopEditing(){this.setState({editing:!1,suppressErrorsForActionIds:[]})}suppressErrorsForAction(e){this.setState({...this.state,suppressErrorsForActionIds:p.jj([...this.state.suppressErrorsForActionIds,e])})}}const T=C;var M=o(31792),P=o(35661),A=o(77794),D=o(2834),B=o(13966),R=o(23864),E=o(68709),F=o(73063),N=o(68785),j=o(63296),O=o(31278),L=o(26388),U=o(59557),Z=o(33831),V=o(85893);const q=function(){window.__c={n:"SettingsIconWithNotificationBadge"};const e=(0,s.yK)((e=>({settingsIcon:{fill:e.mediumIconColor},notificationBadge:{fill:e.blueColor,stroke:e.buttonBackground}})),[]);return(0,V.jsxs)(Z.Z,{className:"settingsIconWithNotificationBadge",viewBox:"0 0 16 16",style:{width:16,height:16},children:[(0,V.jsx)("path",{d:"M6.406 15.36c-.492 0-.867-.299-.978-.762l-.24-1.037-.159-.059-.902.557c-.404.258-.885.193-1.23-.152l-.82-.82c-.347-.346-.411-.827-.153-1.231l.562-.896-.058-.147-1.032-.24a.981.981 0 01-.761-.979V8.44c0-.48.293-.861.761-.979l1.02-.246.064-.152-.562-.897c-.258-.404-.193-.878.152-1.236l.82-.82a.972.972 0 011.231-.153l.902.551.165-.064.24-1.037c.111-.463.486-.762.978-.762H7.59c.486 0 .867.299.978.762l.24 1.037.165.064.902-.55c.404-.252.885-.188 1.225.152l.82.82c.346.358.41.832.152 1.236l-.556.897.058.152 1.026.246a.981.981 0 01.761.979v1.154c0 .48-.304.862-.761.979l-1.037.24-.053.146.556.897c.258.404.2.885-.152 1.23l-.82.82c-.34.346-.82.41-1.23.153l-.903-.557-.152.059-.24 1.037a.972.972 0 01-.98.762H6.407zm.14-1.06h.903c.1 0 .147-.042.158-.136l.352-1.44c.387-.089.72-.235 1.008-.417l1.265.78c.07.046.141.04.217-.03l.621-.627c.065-.058.065-.129.018-.205l-.773-1.265a3.85 3.85 0 00.404-.997l1.447-.345c.088-.018.135-.065.135-.164v-.88c0-.105-.041-.146-.135-.17l-1.441-.34a3.878 3.878 0 00-.405-1.007l.774-1.26c.053-.082.053-.152-.018-.216l-.627-.616c-.07-.07-.129-.076-.217-.029l-1.26.768a3.782 3.782 0 00-1.013-.41L7.607 3.84c-.011-.093-.058-.134-.158-.134h-.902c-.1 0-.147.046-.164.134l-.346 1.442a4.07 4.07 0 00-1.02.416l-1.26-.768c-.087-.047-.146-.035-.222.03l-.62.615c-.071.07-.071.14-.019.222l.774 1.26a3.94 3.94 0 00-.399 1.008l-1.447.34c-.088.023-.129.064-.129.17v.879c0 .1.041.146.13.164l1.446.345c.088.37.247.721.41.997l-.779 1.265c-.052.076-.047.147.018.211l.621.621c.076.07.147.076.217.03l1.265-.78a3.35 3.35 0 001.014.416l.346 1.441c.017.088.064.135.164.135zm.452-3.071a2.233 2.233 0 01-2.227-2.227c0-1.212 1.008-2.214 2.227-2.214a2.23 2.23 0 012.22 2.214 2.232 2.232 0 01-2.22 2.227zm0-1.002c.656 0 1.201-.557 1.201-1.225 0-.662-.545-1.207-1.2-1.207a1.22 1.22 0 00-1.22 1.207c0 .674.551 1.225 1.22 1.225z",...e.settingsIcon}),(0,V.jsx)("circle",{cx:"12",cy:"4",r:"3.5",...e.notificationBadge})]})},z=(0,u.defineMessages)({addIconButtonAriaLabel:{defaultMessage:"Add icon",id:"buttonBlock.button.addIconButtonAriaLabel"},editButtonAriaLabel:{defaultMessage:"Edit button",id:"buttonBlock.button.editButtonAriaLabel"},buttonPlaceholder:{defaultMessage:"New button",id:"buttonBlock.button.placeholder"},buttonInsufficientPermissions:{defaultMessage:"You donâ€™t have permission to run this button",id:"buttonBlock.button.insufficientPermissions"},clickToEdit:{defaultMessage:"Click to edit button",id:"buttonBlock.button.clickToEdit"}});class W extends D.Z{constructor(){super(...arguments),this.sizeObserver=new A.E,this.buttonRef=n.createRef(),this.storeTypes={mouseStore:M.Z,buttonBlockStore:T},this.handleContainerMount=e=>{e&&this.sizeObserver.observe(e)},this.configureButtonBlock=e=>{const{buttonBlockStore:t}=this.stores;f.ZH(this.environment),h.ZH(this.environment);this.sizeObserver.rect.state.width<300&&!this.environment.device.isPhone&&e?t.startEditing({placement:{type:"popup",originRect:e}}):t.startEditing({placement:{type:"inline"}})},this.allActionDependenciesLoaded=this.createComputedStore((()=>{var e;const t=(null===(e=this.props.store.getAutomationStore())||void 0===e?void 0:e.getActionStores())??[];for(const o of t){const e=o.getBlockStores();for(const t of e)k.b(t)}}))}handleCreated(){r.default.afterNextFlush((()=>{var e;this.configureButtonBlock(null===(e=this.buttonRef.current)||void 0===e?void 0:e.getBoundingClientRect())}))}willUnmount(){this.sizeObserver.destroy()}willMountOrUpdate(e){super.willMountOrUpdate(e),this.allActionDependenciesLoaded.state}activate(){var e;null===(e=this.buttonRef.current)||void 0===e||e.activate()}renderPersisted(){const{disabled:e,store:t}=this.props,{mouseStore:o,buttonBlockStore:n}=this.stores;return(0,V.jsxs)(E.p,{allowSelectionWithin:!0,style:{display:"flex"},ref:this.handleContainerMount,children:[(0,V.jsxs)("div",{style:{flexGrow:1,flexShrink:1,minWidth:0},children:[(0,V.jsx)(H,{store:t,mouseStore:o,buttonBlockStore:n,onConfigure:this.configureButtonBlock,ref:this.buttonRef,disabledFromEditing:e}),(0,V.jsx)(y.O,{store:t,disabled:e,buttonBlockStore:n})]}),(0,V.jsx)(R.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store,recursivelyLoadAllDiscussions:!0})]})}}const H=n.forwardRef(((e,t)=>{window.__c={n:"ButtonBlockButton"};const{store:o,mouseStore:r,buttonBlockStore:y,onConfigure:k,disabledFromEditing:I}=e,C=(0,u.useIntl)(),T=(0,i.O7)(),{isMobile:M}=(0,i.Fy)(),[A,D]=(0,n.useState)(!1),R=(0,a.VK)((()=>r.state.mouseEntered),[r]),E=(0,a.VK)((()=>o.getAutomationStore()),[o]),Z=(0,a.VK)((()=>(null==E?void 0:E.getNameStore().getValue())??""),[E]),W=(0,a.VK)((()=>null==E?void 0:E.getIconStore().getValue()),[E]),H=function(e){const{store:t,automationStore:o,buttonBlockStore:n}=e,r=function(e){const{store:t,automationStore:o}=e,n=(0,i.O7)().currentUser.id;return(0,a.VK)((()=>{const e=t.getRecordStoreUIRoot();if(o&&e instanceof P.G)return(0,S.Gb)({type:"button_block",persisted:!0,automationStore:o,blockStore:t,pageStore:e,intl:_.default.getIntl(),parentRecordStore:o,currentUserId:n})}),[o,t,n])}({store:t,automationStore:o});return(0,a.VK)((()=>{const e=null==r?void 0:r.state;if(!e)return{type:"disabled"};if("insufficient"===e.executionPermissionStatus||"unknown"===e.executionPermissionStatus)return{type:"disabled",tooltip:z.buttonInsufficientPermissions};if("sufficient"===e.executionPermissionStatus){if(0===((null==o?void 0:o.getActionIds())??[]).length)return{type:"error",tooltip:b.Mm.noActions,hideErrorIconWhenEditorIsOpen:!0};const t=e.typecheckResult.value.actionValidationFailures,r=Object.entries(t).filter((e=>{let[t]=e;return!n.state.suppressErrorsForActionIds.includes(t)})).flatMap((e=>{let[,t]=e;return t})),i=p.Ps(r);return i?{type:"error",tooltip:(0,b.Fp)(i).forButtonTooltip}:{type:"enabled"}}(0,m.t1)(e)}),[r,o,n])}({store:o,automationStore:E,buttonBlockStore:y}),G="disabled"===H.type||A||"error"===H.type&&I,K=(0,a.VK)((()=>"error"===H.type&&!(H.hideErrorIconWhenEditorIsOpen&&y.state.editing)),[H,y]),{showFactoryButtonDeprecationBadge:$,setHasSeenFactoryButtonDeprecationBadge:Y}=(0,U.N)({blockStore:o}),Q=(0,s.yK)((e=>{const t=M?"52px":"28px";return{wrap:{display:"flex",alignItems:"center",padding:"2px 0"},configureWrap:{display:"flex",alignItems:"center",marginLeft:4},label:{pointerEvents:"none",...g.Z.textOverflowStyle},button:{display:"flex",gap:6,minWidth:50,maxWidth:`calc(100% - ${t})`,padding:"8px 12px",fontWeight:500,...G?{cursor:"not-allowed"}:{}},labelPlaceholder:{color:e.lightTextColor},warningIcon:{width:16,height:16,fill:e.errorText,color:e.errorText},spinnerWrap:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",marginLeft:-4}}}),[G,M]),J=(0,x.D)(),X=(0,n.useRef)(null),ee=(0,n.useCallback)((()=>{r.setState({...r.state,mouseEntered:!0})}),[r]),te=(0,n.useCallback)((()=>{r.setState({...r.state,mouseEntered:!1})}),[r]),oe=(0,n.useCallback)((()=>{var e;k(null===(e=X.current)||void 0===e?void 0:e.getBoundingClientRect())}),[k,X]),ne=(0,n.useCallback)((()=>{y.state.editing?(y.stopEditing(),(0,l.lN)(J,{block_id:o.id,automation_id:null==E?void 0:E.id})):(oe(),Y(),(0,l.yK)(J,{block_id:o.id,automation_id:null==E?void 0:E.id}))}),[y,J,o.id,null==E?void 0:E.id,oe,Y]),re=(0,n.useCallback)((async()=>{const e=o.getRecordStoreUIRoot();if(E&&e instanceof P.G)if(f.ZH(T),h.ZH(T),"error"===H.type)I||oe();else if("enabled"===H.type)try{D(!0),await v.oS({environment:T,store:o,clientContext:{type:"button_block",persisted:!0,automationStore:E,blockStore:o,pageStore:e,intl:_.default.getIntl(),parentRecordStore:E,currentUserId:T.currentUser.id}})}finally{D(!1)}else"disabled"===H.type||(0,m.t1)(H)}),[o,E,T,H,I,oe]);(0,n.useImperativeHandle)(t,(()=>({activate:()=>{re()},getBoundingClientRect:()=>{var e;return null===(e=X.current)||void 0===e?void 0:e.getBoundingClientRect()}})),[re]);const ie=()=>(0,V.jsx)("div",{style:Q.spinnerWrap,children:(0,V.jsx)(N.Z,{})}),ae=[];var se;W&&(A?ae.push({key:"left",comp:ie()}):ae.push({key:"left",comp:(se=W,(0,V.jsx)(O.Z,{largeIcon:!0,disabled:!0,isEmptyPage:!1,size:20,icon:{icon:se,pointer:o.pointer},style:{marginLeft:Z?-4:0}}))})),Z?ae.push({key:"name",comp:(0,V.jsx)("div",{style:Q.label,children:Z})}):W||ae.push({key:"placeholder",comp:(0,V.jsx)("div",{style:Q.labelPlaceholder,children:(0,V.jsx)(u.FormattedMessage,{...z.buttonPlaceholder})})}),!W&&A&&ae.push({key:"right",comp:ie()}),K&&ae.push({key:"error",comp:(0,V.jsx)("div",{children:(0,d.t)(Q.warningIcon)})});const le=e=>(0,V.jsx)(j.Z,{disabled:G,disabledFeedback:!0,style:Q.button,ref:X,...(0,w.Z)(e??{},{onClick:re}),children:ae.map((e=>{let{key:t,comp:o}=e;return(0,V.jsx)(n.Fragment,{children:o},t)}))});return(0,V.jsxs)("div",{style:Q.wrap,onMouseMove:ee,onMouseLeave:te,children:[H.tooltip?(0,V.jsx)(L.Z,{renderTooltip:()=>(0,V.jsx)(b.So,{content:(0,V.jsx)(u.FormattedMessage,{...H.tooltip}),subtitle:"error"!==H.type||I?null:(0,V.jsx)(u.FormattedMessage,{...z.clickToEdit})}),delayThreshold:0,render:le,placement:L.Z.Placement.Bottom}):le(),!I&&(T.device.isMobile||R)&&(0,V.jsxs)("div",{style:Q.configureWrap,children:[(0,V.jsx)(L.Z,{renderTooltip:()=>(0,V.jsx)(u.FormattedMessage,{defaultMessage:"Edit button",id:"buttonBlock.configureTemplate.button.label"}),delayThreshold:300,render:e=>(0,V.jsx)(F.Z,{ariaLabel:C.formatMessage(z.editButtonAriaLabel),icon:$?()=>(0,V.jsx)(q,{}):c.H,onClick:ne,...e})}),T.device.isMobile&&(0,V.jsx)(B.Z,{tooltipContent:(0,V.jsx)(u.FormattedMessage,{defaultMessage:"More actionsâ€¦",id:"buttonBlock.moreActions.button.label"}),store:o,fadeIn:!1})]})]})}));const G=W},38376:(e,t,o)=>{o.d(t,{Z:()=>S});o(67294);var n=o(49271),r=o(8848),i=o(22808),a=o(15157),s=o(5366),l=o(41433),c=o(9953),d=o(39699),p=o(33929),u=o(2834),m=o(23864),g=o(31278),h=o(55217),f=o(65187),y=o(85893);const v=(0,s.defineMessages)({inputPlaceholder:{defaultMessage:"Type somethingâ€¦",id:"calloutBlock.inputPlaceholder"},changeIconLabel:{defaultMessage:"Change callout icon",id:"calloutBlock.changeIconLabel"},disabledIconLabel:{defaultMessage:"Callout icon",id:"calloutBlock.disabledIconLabel"}});class b extends u.Z{constructor(){super(...arguments),this.handleChange=async e=>{const{store:t}=this.props,o=t.getIconStore();if(o){const{serverCommitResult:t}=d.createAndCommit({userAction:"CalloutBlock.handleEmojiChange",environment:this.environment,perform:t=>{c.sO({store:o,value:e,transaction:t}),(0,i.Z)(e)&&a.Z.set({userId:this.environment.currentUser.id,key:l.nF,value:e})}});await t}}}renderPersisted(){const{disabled:e}=this.props;return(0,y.jsxs)("div",{role:"note",style:{display:"flex"},children:[(0,y.jsxs)("div",{style:this.getStyle(),children:[(0,y.jsx)("div",{children:this.renderIcon()}),(0,y.jsxs)("div",{style:{display:"flex",flexDirection:"column",minWidth:0,marginLeft:8,width:"100%"},children:[(0,y.jsx)(f.Z,{style:{paddingLeft:n.ZD.paddingLeft,paddingRight:n.ZD.paddingRight},disabled:e,store:this.props.store.getBlockTitleStore(),placeholder:p.default.formatMessage(v.inputPlaceholder),pasteBehavior:"block"}),!this.props.hideContent&&(0,y.jsx)(h.Z,{disabled:e,store:this.props.store.getContentStore(),disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})]})]}),(0,y.jsx)(m.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}renderIcon(){const{store:e}=this.props,t=e.getIcon();return this.canEdit()?(0,y.jsx)(g.Z,{bucket:"secure",store:e,isEmptyPage:!1,onChange:this.handleChange,disableRemoveIcon:!0,isCallout:!0,icon:e.getIcon(),size:24,disabled:!1,label:p.default.formatMessage(v.changeIconLabel)}):(0,y.jsx)(g.Z,{icon:t,isEmptyPage:!1,size:24,disabled:!0,label:p.default.formatMessage(v.disabledIconLabel)})}getStyle(){const e=this.props.store.getFormat().block_color||"default",t=(0,r.x7)(e,this.theme);return{...this.props.style,display:"flex",width:"100%",borderRadius:4,border:(0,r.jS)(e)?void 0:`1px solid ${this.theme.darkDividerColor}`,backgroundColor:"transparent",paddingLeft:12,paddingTop:16,paddingBottom:16,paddingRight:16,...t}}}const S=b},53223:(e,t,o)=>{o.d(t,{D:()=>n.LazyCollectionViewBlock,w:()=>r});var n=o(77907);function r(e){return"isCollectionViewBlock"in e&&"boolean"==typeof e.isCollectionViewBlock&&e.isCollectionViewBlock}},1136:(e,t,o)=>{o.d(t,{F:()=>c});o(67294);var n=o(480),r=o(24405),i=o(62760),a=o(79362),s=o(52821),l=o(85893);function c(e){window.__c={n:"CollectionViewIcon"};const{device:t}=(0,n.O7)(),o=(0,r.Fg)(),{color:c,viewIcon:d,viewType:p,size:u,style:m}=e,g=(e=>({regular:e.regularTextColor,light:e.mediumTextColor,gray:a.Lr[e.mode].gray,lightGray:e.lightTextColor}))(o)[c];return p?d?(0,l.jsx)(i.Z,{style:{fill:g,backfaceVisibility:void 0,...m},size:u??(t.isMobile?18:16),theme:o,icon:d}):s.aW[p]({width:u??(t.isMobile?18:16),height:u??(t.isMobile?18:16),backfaceVisibility:void 0,fill:g,...m}):null}},27627:(e,t,o)=>{o.d(t,{Z:()=>x});var n=o(67294),r=o(73935),i=o(83355),a=o(15145),s=o(35683),l=o(50906),c=o(75018),d=o(97444),p=o(32741),u=o(66213),m=o(14976),g=o(84210),h=o(77080),f=o(61738),y=o(22294),v=o(72014),b=o(2834),S=o(68709),_=o(24813),w=o(85893);class k extends b.Z{constructor(){super(...arguments),this.nodeRef=n.createRef(),this.handleClick=()=>{const{store:e}=this.props;f.Z.recordVisit({id:e.id,systemBlockType:e.getSystemBlockTypeStore().getValue(),type:s.vu.Link,currentUserId:this.environment.currentUser.id}),l.SK1(this.environment,{page_visit_id:v.$g.getCurrentPageVisitId(),mentioned_page_id:e.id,source_type:"collection_view_page_block",hover_preview_enabled:h.default.checkGate("first_party_links"),is_navigable_block:e.isNavigableBlock()})},this.handleMouseOver=e=>{const t=this.getInteractiveToken(),o=this.props.store.getTitleStore();o&&t&&d.Nh({environment:this.environment,event:e,interactiveToken:t,store:o,canEdit:this.canEdit()})},this.handleMouseOut=e=>{const t=this.getInteractiveToken(),o=this.props.store.getTitleStore();o&&t&&d.Zl({environment:this.environment,event:e,interactiveToken:t,store:o,canEdit:this.canEdit()})}}handleCreated(){this.activate(),y.Z.setKeyboardMode(!1)}activate(){if(this.context.overrideLinkClick){const{store:e}=this.props,t=(0,g.ZP)({store:e,pageVisitSource:a.tY.Create});this.context.overrideLinkClick(t)}else c.navigateToBlock({environment:this.environment,store:this.props.store,visitType:s.vu.Link,pageVisitSource:a.tY.Create})}willUnmount(){super.willUnmount(),p.qA(this.props.store.getTitleStore())}renderPersisted(){const{disabled:e}=this.props,t=this.props.store.getCollectionViewSourceCollectionStore();return(0,w.jsx)(S.p,{allowSelectionWithin:!1,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:(0,w.jsx)(_.Z,{ref:this.nodeRef,store:this.props.store,style:{...this.getBlockColorStyle(),...this.props.style},isAlias:this.props.store.isCollectionViewAlias()||this.props.store.recordStoreParentDiffersFromPersistedParent(),disabled:Boolean(e||(null==t?void 0:t.isSyncedCollection())),onClick:this.handleClick})})}getInteractiveToken(){if(!this.nodeRef||!this.nodeRef.current)return;const e=r.findDOMNode(this.nodeRef.current);return(0,m.We)(this.props.store,e)}}k.contextTypes={...u.wK,...i.w};const x=k},69015:(e,t,o)=>{o.d(t,{b:()=>c,Z:()=>w});o(67294);var n=o(73935),r=o(83355),i=o(1302),a=o(72126),s=o(14976),l=o(97880);let c=function(e){return e.Inline="Inline",e.InlineWrap="InlineWrap",e.Textarea="Textarea",e}({}),d=function(e){return e.Submit="Submit",e.Newline="Newline",e}({});function p(e){const{device:t,e:o,action:n,onSubmit:r}=e;if(n===d.Submit)r&&r(o);else if(n===d.Newline){if(!t.isIOS)return;o.preventDefault&&o.preventDefault(),document.execCommand("insertLineBreak")}else(0,l.t1)(n)}var u=o(73744),m=o(89224),g=o(49085);class h extends g.default{getInitialState(){return{}}}const f=h;var y=o(24666),v=o(29595),b=o(3386),S=o(85893);class _ extends r.Z{constructor(){super(...arguments),this.storeTypes={store:f},this.handleWindowMouseDown=e=>{const t=n.findDOMNode(this);t&&!t.contains(e.target)&&this.props.onBlur&&this.props.onBlur()},this.handleEsc=e=>{this.handleKeyEvent(),this.props.onCancel&&this.props.onCancel(e)},this.handleShiftEnter=e=>{const{device:t}=this.environment;t.isIOS&&!("shiftKey"in e)?p({device:t,e,action:d.Newline}):this.handleEnter(e)},this.handleEnter=e=>{const{type:t,onSubmit:o}=this.props,{device:n}=this.environment;if(this.getDisabled())return;p({device:n,e,action:function(e){const{device:t,type:o,e:n}=e;return o===c.Inline?d.Submit:o===c.InlineWrap?t.isPhone?d.Submit:"altKey"in n&&n.altKey||"shiftKey"in n&&n.shiftKey?d.Newline:d.Submit:o===c.Textarea?d.Newline:void(0,l.t1)(o)}({device:n,type:t,e}),onSubmit:o})},this.handleLeft=e=>{this.getDisabled()||(this.handleKeyEvent(),this.props.onLeft&&this.props.onLeft(e))},this.handleRight=e=>{this.getDisabled()||(this.handleKeyEvent(),this.props.onRight&&this.props.onRight(e))},this.handleKeyEvent=()=>{i.default.afterNextFlush((()=>{this.saveSerializedTextSelection()}))},this.getDisabled=()=>!!this.props.disabled||!this.props.focus,this.getHtml=()=>{const e=a.YU(this.props.value+(this.props.value.length>0?"\n":""));return this.props.getHtml?this.props.getHtml(e):e},this.getSelection=()=>{const e=this.stores.store.state.selection;return e&&{type:"contain",selection:e}},this.handleMutation=e=>{let{newValue:t}=e;this.saveSerializedTextSelection(),this.props.onChange(t)},this.saveSerializedTextSelection=()=>{const{store:e}=this.stores,t=s.Ut(this.environment,m.get());t&&(a.Xy(t.selection,e.state.selection)||this.stores.store.setState({selection:t.selection}),t.forceEmitSelectionStore&&y.default.emit())}}willMount(e){super.willMount(e),u.lj(window,"mousedown",this.handleWindowMouseDown)}willMountOrUpdate(e){super.willMountOrUpdate(e);const{store:t}=this.stores;e.focus&&!t.state.selection&&(e.selectAll?t.setState({selection:{startIndex:0,endIndex:e.value.length}}):t.setState({selection:{startIndex:e.value.length,endIndex:e.value.length}}))}willUnmount(){super.willUnmount(),u.ZV(window,"mousedown",this.handleWindowMouseDown)}renderComponent(){const{type:e}=this.props;return(0,S.jsx)(b.Z,{capture:!this.getDisabled(),onDelete:this.handleKeyEvent,onBackspace:this.handleKeyEvent,onEnter:this.handleEnter,onShiftEnter:this.handleShiftEnter,onCommandEnter:this.handleKeyEvent,onCommandShiftEnter:this.handleKeyEvent,onUp:this.handleKeyEvent,onDown:this.handleKeyEvent,onLeft:this.handleLeft,onRight:this.handleRight,onTab:this.handleKeyEvent,onUntab:this.handleKeyEvent,onSelectAll:this.handleKeyEvent,onToggleBold:this.handleKeyEvent,onToggleItalics:this.handleKeyEvent,onToggleStrike:this.handleKeyEvent,onToggleCode:this.handleKeyEvent,onUndo:this.handleKeyEvent,onRedo:this.handleKeyEvent,onEsc:this.handleEsc,onCut:this.handleKeyEvent,onCopy:this.handleKeyEvent,onPaste:this.handleKeyEvent,onKeypress:this.handleKeyEvent,onHome:this.handleKeyEvent,onEnd:this.handleKeyEvent,onGoToBeginningOfLine:this.handleKeyEvent,onGoToEndOfLine:this.handleKeyEvent,onGoForwardOneChar:this.handleKeyEvent,onGoBackwardOneChar:this.handleKeyEvent,children:(0,S.jsx)(v.Z,{style:{...this.props.style,whiteSpace:"pre-wrap"},placeholder:this.props.placeholder,placeholderStyle:this.props.placeholderStyle,spellCheck:!1,autoCorrect:this.props.autoCorrect,autoCapitalize:this.props.autoCapitalize,getDisabled:this.getDisabled,getHtml:this.getHtml,getSelection:this.getSelection,onMutation:this.handleMutation,suppressNewlineEvents:e===c.Inline})})}}_.displayName="ContentEditableInput",_.Type=c;const w=_},29595:(e,t,o)=>{o.d(t,{Z:()=>y});o(21703),o(67294);var n=o(83355),r=o(18466),i=o(1302),a=o(22491),s=o(97880),l=o(14976),c=o(46150),d=o(62619),p=o(45162),u=(o(60846),o(89224)),m=o(24666),g=o(85893);let h=!1;class f extends n.Z{constructor(e){super(e),this.root=null,this.ownNodeIsComposing=!1,this.testDiv=document.createElement("div"),this.shouldDisableContentEditableForMobile=!1,this.handleRootMount=e=>{this.root=e},this.handleTextSelectionEditingStoreForMobile=()=>{this.shouldDisableContentEditableForMobile=!m.default.isEditingStore.state,this.root&&this.updateContentEditableAttribute(this.root)},this.handleCompositionStart=()=>{const{device:e}=this.environment;e.isAndroid||(this.ownNodeIsComposing=!0,this.props.onCompositionStart&&this.props.onCompositionStart())},this.handleCompositionEnd=()=>{const{device:e}=this.environment;e.isAndroid||(this.ownNodeIsComposing=!1,this.handleInput(),this.props.onCompositionEnd&&this.props.onCompositionEnd())},this.handleBeforeInput=e=>{const{suppressNewlineEvents:t}=this.props;if(!d.kA(e))throw new Error("Invalid event");var o;if(t&&("insertLineBreak"!==e.inputType&&"insertParagraph"!==e.inputType||e.preventDefault(),this.environment.device.isAndroid&&"insertCompositionText"===e.inputType&&null!==(o=e.data)&&void 0!==o&&o.endsWith("\n")&&e.target===this.root)){var n;h;const e=()=>{var t;this.delegateMutation({insertedLine:!0,deletedLine:!1,newValue:this.getText(),multiSelection:void 0,isComposing:this.isComposing}),null===(t=this.root)||void 0===t||t.removeEventListener("input",e)};null===(n=this.root)||void 0===n||n.addEventListener("input",e)}},this.handleSelect=e=>{this.delegateSelection("contain")},this.handleClick=e=>{var t,o;3===e.nativeEvent.detail&&(l.TQ(this.environment.device),this.delegateSelection("contain")),null===(t=(o=this.props).onClick)||void 0===t||t.call(o,e)},this.handleInput=this.handleInput.bind(this)}get isComposing(){var e;return Boolean(this.ownNodeIsComposing||(null===(e=this.contentEditableContext)||void 0===e?void 0:e.isComposing()))}get registries(){var e;return[null===(e=this.contentEditableContext)||void 0===e?void 0:e.contentEditableLeafRegistry]}getText(){return l.n$(this.environment,this.root)}delegateSelection(e){var t,o;this.isComposing||(null===(t=(o=this.props).onSelect)||void 0===t||t.call(o,{endpoint:e,component:this}))}delegateMutation(e){this.handleMutation(e)}delegateBeforeInput(e){this.handleBeforeInput(e)}delegateKeyDown(e){var t,o;null===(t=(o=this.props).onKeyDown)||void 0===t||t.call(o,e)}delegateCompositionEnd(e){var t,o;null===(t=(o=this.props).onCompositionEnd)||void 0===t||t.call(o)}getNode(){return this.root}willMount(){this.environment.device.isMobile&&this.props.disableContentEditableWhenNotEditingTextOnMobile&&(this.shouldDisableContentEditableForMobile=r.Z.withListenerIgnored((()=>!m.default.isEditingStore.state)),m.default.isEditingStore.addListener(this.handleTextSelectionEditingStoreForMobile))}willMountOrUpdate(e){this.selection=e.getSelection(),this.disabled=e.getDisabled(),this.html=e.getHtml()}didMount(){this.updateContainer(!0),this.root&&d.OW&&this.root.addEventListener("beforeinput",this.handleBeforeInput)}didUpdate(){this.updateContainer(!1)}willUnmount(){this.environment.device.isMobile&&this.props.disableContentEditableWhenNotEditingTextOnMobile&&m.default.isEditingStore.removeListener(this.handleTextSelectionEditingStoreForMobile),this.root&&d.OW&&this.root.removeEventListener("beforeinput",this.handleBeforeInput)}updateContentEditableAttribute(e){const t=e.getAttribute("contenteditable");this.disabled||this.shouldDisableContentEditableForMobile?"false"!==t&&this.mutateDOM((function(){e.contentEditable="false"})):"true"!==t&&this.mutateDOM((function(){e.contentEditable="true"}))}updateContainer(e){var t;const{device:o}=this.environment;if(null===(t=this.contentEditableContext)||void 0===t||t.contentEditableLeafRegistry.register(this),this.root&&(this.updateContentEditableAttribute(this.root),!this.isComposing)){if(e)this.root.innerHTML=this.html;else{this.previousHtml!==this.html&&(this.previousHtml=this.html,this.testDiv.innerHTML=this.html);const e=this.root.innerHTML,t=this.testDiv.innerHTML;e!==t&&(this.root.innerHTML=this.html)}if(this.disabled)return;if(u.isMouseSelecting())return;if(u.isMouseRightClicking())return void u.resetMouseRightClicking();if(this.selection)switch(this.selection.type){case"start":case"end":{var n;null===(n=this.contentEditableContext)||void 0===n||n.tryEnableMultiSelection();const e=l.bD(this.root,this.selection.index),t={endpoint:this.selection.type,onlyIfEqual:this.contentEditableContext,position:e};u.setDOMEndpoint(t,this.environment.device),this.updateSelectionEndpoint(t);break}case"contain":{const e=l.lw(this.root,this.selection.selection.startIndex,this.selection.selection.endIndex),t=u.get();l.Dn(t,e)||(o.isAndroid&&document.activeElement!==this.root&&this.root.focus(),u.set(e,o));break}default:(0,s.t1)(this.selection)}else if(!e){const e=u.get(),t=!o.isAndroid||r.Z.withListenerIgnored((()=>"empty"===m.default.state.mode));e&&e.commonAncestorContainer&&d.UG(e.commonAncestorContainer)&&this.root.contains(e.commonAncestorContainer)&&t&&u.clear(this.environment)}}}updateSelectionEndpoint(e){const t=u.get(),o=u.getIncompleteDOMEndpoint();if(t&&o===e)switch(e.endpoint){case"start":return void u.setDOMEndpoint({endpoint:"end",onlyIfEqual:this.contentEditableContext,position:{container:t.endContainer,offset:t.endOffset}},this.environment.device);case"end":return void u.setDOMEndpoint({endpoint:"start",onlyIfEqual:this.contentEditableContext,position:{container:t.startContainer,offset:t.startOffset}},this.environment.device);default:(0,s.t1)(e.endpoint)}}renderComponent(){const{onContextMenu:e,onKeyDown:t,onDoubleClick:o,onMouseDown:n,onTouchStart:r,placeholder:i,onBlur:s,onFocus:l,onMouseOver:d,onMouseOut:u}=this.props,m=Boolean(!this.html),h=(!(0,p.ri)(this.environment.device)||!(0,p.Aw)(this.environment))&&this.props.spellCheck,f=this.props.tagName??"div";return(0,g.jsx)(f,{id:this.props.id,ref:this.handleRootMount,...(0,a.iv)(this.props.className,m&&this.props.placeholderStyle?this.props.placeholderStyle:this.props.style,!this.disabled&&"notranslate"),onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,onInput:this.handleInput,spellCheck:h,autoCorrect:this.props.autoCorrect,autoCapitalize:this.props.autoCapitalize,onSelect:this.handleSelect,onClick:this.handleClick,onBlur:s,onFocus:l,onContextMenu:e,onKeyDown:t,onDoubleClick:o,onMouseDown:n,onTouchStart:r,onMouseOver:d,onMouseOut:u,placeholder:i,...c.GF})}handleMutation(e){this.props.onMutation&&this.props.onMutation(e),i.default.flush()}handleInput(){this.handleMutation({newValue:this.getText(),insertedLine:!1,isComposing:this.isComposing})}}f.displayName="ContentEditableLeaf";const y=f},15201:(e,t,o)=>{o.d(t,{O:()=>Z});o(57658),o(21703);var n=o(27537),r=o.n(n),i=o(67294),a=o(60177),s=o(64338),l=o(480),c=o(86628),d=o(24405),p=o(41432),u=o(22491),m=o(72126),g=o(44805),h=o(97880),f=o(62134),y=o(98104),v=o(95477),b=o(14976),S=o(46150),_=o(62619),w=o(89224);const k=["initial","keyDown","compositionStart","beforeInput","compositionUpdate","domMutations","input","compositionEnd","keyUp"],x={keyDown:"keyUp",beforeInput:"input",input:"domMutations",domMutations:"input",compositionStart:"compositionEnd"},I={compositionUpdate:"beforeInput"};class C{constructor(){this.flowData=new Map,this.nextFlow=new T,this.currentFlow=void 0,this.previousFlow=void 0,this.listeners=new Set,this.handleSelectionChange=()=>{this.nextFlow.beforeRange=w.toStaticRange(w.get())},this.handleKeyDown=e=>{this.advanceToPhase("keyDown").keyDown=e,this.emitUpdate(),this.endIfComplete()},this.handleCompositionStart=e=>{this.advanceToPhase("compositionStart").compositionStart=e,this.emitUpdate(),this.endIfComplete()},this.handleBeforeInput=e=>{var t;if(!(0,_.kA)(e))return;const o=(null===(t=e.getTargetRanges)||void 0===t?void 0:t.call(e))||[];this.advanceToPhase("beforeInput").beforeInput={event:e,targetRanges:o},this.emitUpdate(),this.endIfComplete()},this.handleCompositionUpdate=e=>{this.advanceToPhase("compositionUpdate").compositionUpdate=e,this.emitUpdate()},this.handleInput=e=>{this.advanceToPhase("input").input=e,this.emitUpdate(),this.endIfComplete()},this.handleCompositionEnd=e=>{this.advanceToPhase("compositionEnd").compositionEnd=e,this.emitUpdate(),this.endIfComplete()},this.handleKeyUp=e=>{this.advanceToPhase("keyUp").keyUp=e,this.emitUpdate(),this.endFlow()},this.handleMutations=e=>{let{currentFlow:t}=this;t&&!t.domMutations||(t=this.advanceToPhase("initial")),t.domMutations={afterPhase:t.phase,mutations:e},this.emitUpdate(),this.endIfComplete()}}attachEventListeners(e){const{div:t,document:o}=e;return o.addEventListener("selectionchange",this.handleSelectionChange),t.addEventListener("input",this.handleInput),t.addEventListener("keydown",this.handleKeyDown),t.addEventListener("keyup",this.handleKeyUp),t.addEventListener("beforeinput",this.handleBeforeInput),t.addEventListener("compositionstart",this.handleCompositionStart),t.addEventListener("compositionupdate",this.handleCompositionUpdate),t.addEventListener("compositionend",this.handleCompositionEnd),()=>{o.removeEventListener("selectionchange",this.handleSelectionChange),t.removeEventListener("input",this.handleInput),t.removeEventListener("keydown",this.handleKeyDown),t.removeEventListener("keyup",this.handleKeyUp),t.removeEventListener("beforeinput",this.handleBeforeInput),t.removeEventListener("compositionstart",this.handleCompositionStart),t.removeEventListener("compositionupdate",this.handleCompositionUpdate),t.removeEventListener("compositionend",this.handleCompositionEnd)}}onInputFlowChange(e){return this.listeners.add(e),()=>this.listeners.delete(e)}isComposing(){var e;return this.currentFlow&&!this.currentFlow.isPhase("initial")?this.currentFlow.isComposing():(null===(e=this.previousFlow)||void 0===e?void 0:e.isComposing())||!1}reset(){this.nextFlow=new T,this.currentFlow=void 0,this.previousFlow=void 0,this.flowData=new Map}getCurrentFlow(){const e=this.currentFlow;if(!e)return;return{flow:e,data:this.getData(e)}}getData(e){const t=this.flowData.get(e);if(t)return t;const o={};return this.flowData.set(e,o),o}endIfComplete(){const{currentFlow:e}=this;e&&e.isComplete()&&this.endFlow()}emitUpdate(){const{currentFlow:e}=this;if(e){const t={type:"update",flow:e,data:this.getData(e)};this.listeners.forEach((e=>e(t)))}}endFlow(){const{currentFlow:e}=this;if(e){const t=this.previousFlow;this.previousFlow=e,this.currentFlow=void 0;const o={type:"end",flow:e,data:this.getData(e)};this.listeners.forEach((e=>e(o))),t&&this.flowData.delete(t)}}advanceToPhase(e){return this.currentFlow&&this.currentFlow.canTransitionToPhase(e)||(this.endFlow(),this.currentFlow=this.nextFlow,this.nextFlow=new T),this.currentFlow.phase=e,this.currentFlow}}class T{constructor(){this.phase="initial",this.beforeRange=w.toStaticRange(w.get()),this.initial=void 0,this.keyDown=void 0,this.compositionStart=void 0,this.beforeInput=void 0,this.compositionUpdate=void 0,this.input=void 0,this.compositionEnd=void 0,this.domMutations=void 0,this.keyUp=void 0}isPhase(e){return this.phase===e}hasEvents(){return Boolean(this.compositionStart||this.compositionEnd||this.compositionUpdate||this.keyDown||this.keyUp||this.beforeInput||this.input)}isComposing(){var e,t;switch(this.phase){case"compositionStart":case"compositionUpdate":return!0;case"compositionEnd":return!1;case"beforeInput":return Boolean(null===(e=this.beforeInput)||void 0===e?void 0:e.event.isComposing);case"input":case"keyDown":case"keyUp":return Boolean(null===(t=this[this.phase])||void 0===t?void 0:t.isComposing);case"initial":return!1;default:(0,h.t1)(this.phase)}}transitionToPhase(e,t){return!!this.canTransitionToPhase(e)&&(this.phase=e,this[e]=t,!0)}canTransitionToPhase(e){return!this[e]&&(I[this.phase]===e||1===function(e,t){const o=k.indexOf(e),n=k.indexOf(t),r=o-n;if(r<0)return-1;if(r>0)return 1;return 0}(e,this.phase))}isComplete(){for(const[e,t]of(0,h.qP)(x))if(this[e]&&!this[t])return!1;return!0}getTargetRanges(){var e;const t=null===(e=this.beforeInput)||void 0===e?void 0:e.targetRanges;return null!=t&&t.length?t:this.beforeRange?[this.beforeRange]:[]}}var M=o(68056),P=o(45162),A=o(55010),D=o(35431),B=o(59730);let R,E;R=Symbol.iterator;class F{constructor(e){if(this.leftToRight=new Map,this.rightToLeft=new Map,e)for(const[t,o]of e)this.assoc(t,o)}assoc(e,t){const o=[];if(this.leftToRight.has(e)){const t=this.leftToRight.get(e);o.push((()=>this.rightToLeft.delete(t)))}if(this.rightToLeft.has(t)){const e=this.rightToLeft.get(t);o.push((()=>this.leftToRight.delete(e)))}for(const n of o)n();return this.leftToRight.set(e,t),this.rightToLeft.set(t,e),this}getLeft(e){return this.leftToRight.get(e)}getRight(e){return this.rightToLeft.get(e)}hasLeft(e){return this.leftToRight.has(e)}hasRight(e){return this.rightToLeft.has(e)}deleteLeft(e){if(this.leftToRight.has(e)){const t=this.leftToRight.get(e);return this.leftToRight.delete(e),this.rightToLeft.delete(t),!0}return!1}deleteRight(e){if(this.rightToLeft.has(e)){const t=this.rightToLeft.get(e);return this.leftToRight.delete(t),this.rightToLeft.delete(e),!0}return!1}*[R](){for(const[e,t]of this.leftToRight)yield[e,t]}}E=Symbol.iterator;class N{constructor(e,t,o){if(this.leftName=void 0,this.rightName=void 0,this.biMap=void 0,e===t)throw new B.D3("NamedBiMap left and right names are equal",{data:{name:e}});if(this.leftName=e,this.rightName=t,this.biMap=new F,o)for(const[n,r]of o)this.biMap.assoc(n,r)}assoc(e){const t=e[this.leftName],o=e[this.rightName];return this.biMap.assoc(t,o),this}get(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.getLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.getRight(t)}throw new B.D3("NamedBiMap.get fallthrough should never occur",{data:e})}delete(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.deleteLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.deleteRight(t)}throw new B.D3("NamedBiMap.delete fallthrough should never occur",{data:e})}has(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.hasLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.hasRight(t)}throw new B.D3("NamedBiMap.has fallthrough should never occur",{data:e})}[E](){return this.biMap[Symbol.iterator]()}}class j extends D.Z{constructor(){super(...arguments),this.nodeMap=new N("node","component",new F)}register(e){const t=super.register(e),o=e.getNode();return o?this.nodeMap.assoc({node:o,component:e}):this.nodeMap.delete({component:e}),t}unregister(e){super.unregister(e),this.nodeMap.delete({component:e})}getByDOMOrder(){const e=Array.from(this.nodeMap.biMap.rightToLeft.entries());return e.sort(((e,t)=>{const o=e[1],n=t[1];return(0,A.Z)(o,n)})),e.map((e=>{let[t,o]=e;return{node:o,leaf:t}}))}getParentContentEditableLeaf(e){const t=(0,S.X1)(e),o=t&&this.nodeMap.get({node:t});if(t&&o)return{node:t,leaf:o}}}var O=o(35661),L=o(24666),U=o(85893);function Z(e){window.__c={n:"ContentEditableRoot"};const{children:t,style:o,displayName:n,shouldSelectOnEnter:_}=e,k=!e.disabled,x=(0,i.useRef)(null),I=(0,i.useRef)(0),[T,A]=(0,i.useState)(null),D=(0,i.useRef)(!1),B=(0,i.useRef)(!1),[R]=(0,i.useState)((()=>function(e){return`${e}-${W++}`}(n))),E=(0,i.useRef)(void 0),F=(0,i.useRef)({displayName:R}),[N]=(0,i.useState)((()=>new C)),[Z]=(0,i.useState)((()=>new j)),[H]=(0,i.useState)((()=>new s.T7({onMutations(e){N.handleMutations(e)},enableLogging:!1}))),G=(0,i.useRef)(!1),K=(0,i.useCallback)((e=>{G.current!==e&&(G.current=e,H.mutate((()=>{var t,o;e?null===(t=x.current)||void 0===t||t.setAttribute(S.HM,"true"):null===(o=x.current)||void 0===o||o.removeAttribute(S.HM)})))}),[H]),$=(0,i.useRef)(!1),Y=(0,i.useCallback)((e=>{$.current!==e&&($.current=e,H.mutate((()=>{var t,o;e?null===(t=x.current)||void 0===t||t.setAttribute(S._F,"true"):null===(o=x.current)||void 0===o||o.removeAttribute(S._F)})))}),[H]),Q=(0,i.useCallback)((e=>{x.current=e,H.setNode(e),A(e)}),[H]),J=(0,l.O7)(),X=(0,c.VK)((()=>(0,P.Aw)(J)),[J]);(0,i.useEffect)((()=>{if(T&&X)return N.attachEventListeners({div:T,document:window.document})}),[N,X,T]);const{isFirefox:ee,isAndroid:te}=J.device;(0,i.useEffect)((()=>{const e=e=>{var t;const o=w.get(),n=(0,P.Zb)({range:o,contentEditableLeafRegistry:Z,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:x.current||void 0}),r=L.default.state,i="editing"===r.mode?r.multiSelection:void 0;return{leafs:n,multiSelection:te&&e.isPhase("beforeInput")&&(!i||(0,M.iG)(i))&&w.isExpanded(o)?null===(t=(0,P.fx)({range:o,contentEditableLeafRegistry:Z,allowInvisibleEndSelection:!0}))||void 0===t?void 0:t.multiSelection:i,range:w.toStaticRange(o)}};return N.onInputFlowChange((t=>{Y(N.isComposing());const{flow:o,type:n,data:i}=t;if("end"!==n){if("update"!==n||!o.isPhase("beforeInput")&&i.target||(i.target=e(o)),"update"===n&&o.domMutations&&!i.handledMutations){var a,l;i.handledMutations=!0;const t=o.domMutations.mutations,n=i.target||e(o),m=!ee||n.multiSelection&&(0,M.iG)(n.multiSelection)?null===(a=n.leafs)||void 0===a?void 0:a.start:V(Z,x.current),g=null===(l=n.leafs)||void 0===l?void 0:l.start,f=null==m?void 0:m.leaf.getText();q("onMutations",i,f,o,m);const y=o.hasEvents(),b=v.default.isLocalhost||!y;let _=!1,w=!1,k=!1;for(let e=t.length-1;e>=0;e--){const o=t[e];z(o,m);const n=(0,S.xp)(o.target),r=(0,S.X1)(o.target);if(n===x.current){if((y||"attributes"!==o.type||"style"!==o.attributeName)&&("attributes"!==o.type||"dir"!==o.attributeName))if(m){if("childList"===o.type){const e=Array.from(o.removedNodes);w||=e.some(S.eD)||e.some(S.C7);const t=Array.from(o.addedNodes);k||=t.some(S.eD)}if(r&&r===m.node){switch(o.type){case"attributes":(0,s.AJ)(o,b);continue;case"characterData":case"childList":break;default:(0,h.t1)(o.type)}_=!0}else(0,s.AJ)(o,b)}else(0,s.AJ)(o,b)}else q("allowed mutation on interior region",n,o)}if(g&&(_||w)){var c,d,p,u;if("string"!=typeof f)throw new Error("focusedLeafText must be string");const e=null===(c=o.beforeInput)||void 0===c?void 0:c.event,t=null===(d=o.keyDown)||void 0===d?void 0:d.keyCode,n="enter"!==(void 0!==t&&r()(t))&&("insertLineBreak"===(null==e?void 0:e.inputType)||"insertParagraph"===(null==e?void 0:e.inputType)||"insertCompositionText"===(null==e?void 0:e.inputType)&&(null==e||null===(p=e.data)||void 0===p?void 0:p.endsWith("\n"))||k),a={multiSelection:null===(u=i.target)||void 0===u?void 0:u.multiSelection,newValue:f,deletedLine:w,insertedLine:n,isComposing:N.isComposing()};q("delegateMutation",a),g.leaf.delegateMutation(a)}}}else q("flow ended",i,o)}))}),[Z,N,te,ee,Y]),(0,i.useEffect)((()=>{const e=x.current;e&&X&&D.current&&H.mutate((()=>{k?e.contentEditable="true":e.removeAttribute("contentEditable")}))}),[k,X,H]);const oe=(0,i.useCallback)((()=>{const e=x.current;return!(!e||!X)&&(D.current?("always"===X&&K(!0),!1):(H.mutate((()=>{k?e.contentEditable="true":e.removeAttribute("contentEditable"),(0,P.ri)(J.device)&&(e.spellcheck=!1)})),H.lock(F.current),D.current=!0,K("gesture"===X),q("enableMultiSelection"),!0))}),[H,X,K,J.device,k]),ne=(0,i.useCallback)((()=>{const e=x.current;return!(!D.current||!e)&&("always"===X?(K(!1),!1):!N.isComposing()&&(H.unlock(F.current),e.removeAttribute("contenteditable"),K(!1),q("disableMultiSelection"),D.current=!1,!0))}),[H,X,K,N]);(0,i.useEffect)((()=>{let e=w.get();function t(){var t;const o=null===(t=w.get())||void 0===t?void 0:t.cloneRange(),n=e;e=o;const r=x.current;r&&w.isExpanded(o)&&!w.isExpanded(n)&&(0,S.xp)(o.commonAncestorContainer)===r&&(0,S.X1)(o.commonAncestorContainer)&&oe()&&(r.focus(),w.isExpanded(w.get())||w.set(o,J.device))}return document.addEventListener("selectionchange",t),()=>document.removeEventListener("selectionchange",t)}),[oe,J.device]);const re=(0,i.useCallback)((function(){const e=w.get();if(!w.isExpanded(e)&&ne()&&e){const t=V(Z,x.current,e);t&&t.node&&t.node instanceof HTMLElement&&t.node.focus(),w.set(e,J.device)}}),[Z,ne,J.device]),ie=(0,i.useMemo)((()=>m.Ds(re,50)),[re]),{KeyboardShortcutStackStore:ae}=J,se=(0,i.useRef)(),le=(0,i.useCallback)((function(e){const t=x.current;if(!t)return;if(!D.current)return;const o=w.get();if(q("onSelect (react selection)",w.toStaticRange(o)),!se.current&&o&&fe.current&&o.commonAncestorContainer===fe.current)w.clear(J);else if(!(se.current&&o&&w.areRangesEqual(o,se.current))){if(se.current=w.toStaticRange(o),o){const n=o.startContainer===t&&0===o.startOffset&&o.endContainer===t&&0===o.endOffset,r=fe.current&&o.startContainer===fe.current&&ve.current&&o.endContainer===ve.current,i=J.device.isIOS&&J.device.isMobileNative&&e.timeStamp-I.current>500&&function(e,t,o){if(!e.collapsed||0!==e.startOffset)return!1;const n=(0,P.Zb)({range:e,contentEditableLeafRegistry:t,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:o}),r=t.getByDOMOrder()[0];return Boolean(r&&n&&n.start.leaf===r.leaf)}(o,Z,t);if(n||r||i)return q("onSelect: propagateShortcut selectAll"),void f.dJ({KeyboardShortcutStackStore:ae},new KeyboardEvent("keydown"),"selectAll")}if("contextmenu"!==e.nativeEvent.type){if(o&&(w.isExpanded(o)||"always"===X)&&(0,S.xp)(o.commonAncestorContainer)===t){if(B.current)return void(E.current=e);const t=V(Z,x.current,o);t&&(q("onSelect: delegateSelection",t),t.leaf.delegateSelection("start"))}w.isExpanded(o)||ie()}}}),[X,Z,ie,ae,J]);(0,i.useEffect)((()=>{if(X&&!k){function e(){const e=w.get(),t=x.current;if(!t||!e)return;const o=(0,P.fx)({contentEditableLeafRegistry:Z,range:e,allowInvisibleEndSelection:!0});o&&(0,S.xp)(e.commonAncestorContainer)===t&&y.bc({...o,environment:J,focus:"start",readOnly:!0})}return document.addEventListener("selectionchange",e),()=>document.removeEventListener("selectionchange",e)}}),[J,X,k,Z]);const ce=(0,i.useCallback)((()=>{B.current=!0,E.current=void 0}),[]),de=(0,i.useCallback)((e=>{const t=E.current;if(B.current=!1,E.current=void 0,I.current=e.timeStamp,t){const e=V(Z,x.current);q("handleTouchEnd: delegateSelection",e),null==e||e.leaf.delegateSelection("start")}}),[Z]),pe=(0,i.useCallback)((e=>{if(I.current=e.timeStamp,!D.current)return;e.target!==x.current||"Enter"!==e.key||!1!==e.ctrlKey||!1!==e.metaKey||!1!==e.altKey||!1!==e.shiftKey||_&&!_()||void 0!==w.get()||!fe.current||w.setOnNode(fe.current,J.device);const t=V(Z,x.current);q("handleKeyDown: delegateKeyDown",t),null==t||t.leaf.delegateKeyDown(e)}),[Z,J.device,_]);(0,i.useEffect)((()=>{const e=x.current;if(e)return e.addEventListener("beforeinput",t),()=>e.removeEventListener("beforeinput",t);function t(e){if(!D.current)return;const t=V(Z,x.current);null==t||t.leaf.delegateBeforeInput(e)}}),[Z]);const ue=(0,i.useCallback)((()=>{const e=x.current;if(!e)return;const t=function(){document.removeEventListener("selectionchange",t);const o=w.get();if(null!=o&&o.collapsed&&(0,S.xp)(o.commonAncestorContainer)===e){const e=(0,S.X1)(o.commonAncestorContainer),t=o.startContainer,n=o.startOffset;if(e&&t&&(0,b.x9)(e,t,n)){const r=e.getElementsByClassName(g.$A)[0];r&&(q("Move collapsed selection before EOL marker",{parentLeafNode:e,caretContainer:t,caretOffset:n}),o.setStartBefore(r),o.setEndBefore(r),w.set(o,J.device))}}};document.addEventListener("selectionchange",t)}),[J.device]);(0,i.useEffect)((()=>{"always"!==X||D.current||oe()}),[oe,X]);const me=(0,i.useCallback)((()=>{const e=w.get();return!w.isExpanded(e)&&ne()}),[ne]),ge=(0,i.useCallback)((()=>!te&&Boolean(N.isComposing())),[N,te]),he=(0,d.yK)((e=>({div:{caretColor:e.regularTextColor,...o},whenContentEditable:{WebkitUserModify:"read-write-plaintext-only"},selectionTrap:{height:"1px",width:"1px",caretColor:"transparent"}})),[o]),fe=(0,i.useRef)(null),ye=(0,U.jsx)("span",{style:he.selectionTrap,ref:fe}),ve=(0,i.useRef)(null),be=(0,U.jsx)("span",{style:he.selectionTrap,ref:ve}),Se=(0,i.useCallback)((()=>{if(!w.get()&&"editing"===L.default.state.mode){const e=L.default.state.multiSelection.start.store;if(e instanceof O.G){const t=e.getType();if(t===p.Ti.linkToPage||t===p.Ti.linkToCollection)return}y.ZH(J)}}),[J]),_e=(0,i.useCallback)((()=>{!x.current||w.get()&&"empty"!==L.default.state.mode||x.current.blur()}),[]);return(0,U.jsx)("div",{onBlur:J.device.isIOS?Se:void 0,onFocus:J.device.isIOS?_e:void 0,onTouchStart:X?ce:void 0,onTouchEnd:X?de:void 0,onTouchCancel:X?de:void 0,onKeyDown:X?pe:void 0,onCompositionEnd:X?function(e){if(!D.current)return;const t=V(Z,x.current);null==t||t.leaf.delegateCompositionEnd(e)}:void 0,ref:Q,...(0,u.iv)(he.div,{whenContentEditable:he.whenContentEditable}),onMouseDown:ue,onSelect:le,...S.GZ,children:(0,U.jsxs)(a.c1,{id:R,tryEnableMultiSelection:oe,tryDisableMultiSelection:me,isComposing:ge,domLock:H,contentEditableLeafRegistry:Z,children:[ye,t,be]})})}function V(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.get();const n=(0,P.Zb)({range:o,contentEditableLeafRegistry:e,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:t||void 0});if(n)return n.start}function q(){}function z(e){const t={};if(t.type=e.type,t.target=e.target,t.targetIsText=e.target.nodeType===Node.TEXT_NODE,t.targetIsLeaf=(0,S.eD)(e.target),e.addedNodes.length){const o=Array.from(e.addedNodes);t.added=o,t.addedALeaf=o.some(S.eD),t.addedAText=o.some((e=>e.nodeType===Node.TEXT_NODE))}if(e.removedNodes.length){const o=Array.from(e.removedNodes);t.removed=o,t.removedALeaf=o.some(S.eD),t.removedAText=o.some((e=>e.nodeType===Node.TEXT_NODE))}"characterData"===e.type&&(t.newChars=e.target.textContent,t.oldChars=e.oldValue),t.mutation=e;for(var o=arguments.length,n=new Array(o>1?o-1:0),r=1;r<o;r++)n[r-1]=arguments[r]}let W=0},68709:(e,t,o)=>{o.d(t,{p:()=>c});var n=o(67294),r=o(60177),i=o(22491),a=o(46150),s=o(85893);const l={WebkitUserSelect:"none",userSelect:"none",pseudoSelection:{background:"transparent"}},c=n.forwardRef(((e,t)=>{window.__c={n:"ContentEditableVoid"};const{allowSelectionWithin:o,style:n,className:c,...d}=e,p=(0,r.Dl)(),u=(0,s.jsx)("div",{ref:t,contentEditable:!1,...(0,i.iv)(c,!o&&l,n),...a.G0,...d});return p?(0,s.jsx)(r.c1,{void:!0,children:u}):u}));c.displayName="ContentEditableVoid"},10182:(e,t,o)=>{o.d(t,{Z:()=>C});var n=o(67294),r=o(480),i=o(86628),a=o(24405),s=o(86658),l=o(53028),c=o(5366),d=o(50950),p=o(43250),u=o(87279),m=o(61893),g=o(31194),h=o(52275),f=o(31945),y=o(78140),v=o(32163),b=o(89728),S=o(72495),_=o(24006),w=o(64369),k=o(85893);function x(e){let{hasDismissButton:t,onDismiss:o}=e;window.__c={n:"CookieConsentMenu"};const i=(0,r.O7)(),g=(0,a.Fg)(),h=(0,c.useIntl)(),[f,_]=(0,n.useState)(!1);(0,n.useEffect)((()=>()=>{t||f&&d.qo()}),[h,f,t]);const x=[{key:"trackingTypes",render:e=>(0,k.jsx)(S.Z,{...e,topBorder:0!==e.index}),items:l.m4.map((e=>({key:e,render:t=>(0,k.jsx)(I,{menuListItemProps:t,trackingType:e,setShowReloadOnMenuClose:_,isNativeiOSApp:i.device.isMobileNative&&i.device.isIOS}),action:()=>d.Nh(i,e)})))}];return(0,k.jsxs)(y.Z,{className:p.N7t,menuType:u.og.Popup,width:260,children:[(0,k.jsx)("div",{style:{display:"flex",alignItems:"center",paddingTop:t?4:0},children:t&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(w.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%",paddingLeft:14},children:(0,k.jsx)("b",{children:(0,k.jsx)(c.FormattedMessage,{...s.ze.customizeCookiesHeader})})}),(0,k.jsx)(b.Z,{style:{float:"right",marginLeft:-8,paddingLeft:8,paddingRight:8,color:g.blueColor},onClick:()=>{d.OM(i,m.Z.getPermission()),o&&o()},children:(0,k.jsx)(c.FormattedMessage,{...s.ze.cookieDismissButtonLabel})})]})}),(0,k.jsx)(v.Z,{type:v.i.Vertical,initialFocus:void 0,sections:x})]})}function I(e){window.__c={n:"TrackingTypeToggle"};const{menuListItemProps:t,trackingType:o,setShowReloadOnMenuClose:n,isNativeiOSApp:l}=e,{title:p,caption:u,subtitle:g}=(0,s.G_)(o,l),[{permission:f}]=(0,i.AF)(m.Z),y=(0,a.Fg)(),v=(0,r.O7)();return(0,k.jsx)(h.Z,{...t,title:(0,k.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,k.jsx)("div",{style:{marginRight:0},children:(0,k.jsx)(c.FormattedMessage,{...p})})}),caption:(0,k.jsxs)("div",{children:[g&&(0,k.jsx)("div",{children:(0,k.jsx)("span",{style:{color:y.errorText},children:(0,k.jsx)(c.FormattedMessage,{...g})})}),(0,k.jsx)("div",{children:(0,k.jsx)("span",{style:{color:y.mediumTextColor},children:(0,k.jsx)(c.FormattedMessage,{...u})})})]}),shouldWrapCaption:!0,right:(0,k.jsx)("div",{style:{display:"flex",width:"100%",alignItems:"center",cursor:"pointer"},children:(0,k.jsx)(_.Z,{on:f[o],disabled:"necessary"===o,onClick:()=>{n(!0),d.Nh(v,o)}})})})}const C=function(e){let{renderOrigin:t,hasDismissButton:o,onDismiss:n}=e;return(0,k.jsx)(f.ZP,{popupType:f.Z4.Popup,placementToOrigin:g.Iw.Bottom,alignmentToOrigin:g.lU.Start,renderOrigin:t,render:()=>(0,k.jsx)(x,{hasDismissButton:o,onDismiss:n})})}},93262:(e,t,o)=>{o.d(t,{Z:()=>j});var n=o(67294),r=o(83355),i=o(1302),a=o(72126),s=o(70203),l=o(97880),c=o(42239),d=o(99553),p=o(52989),u=o(82007),m=o(24677),g=o(98104),h=o(84064),f=o(14976),y=o(12534),v=o(28314),b=o(98742),S=o(39500),_=o(45162),w=o(89224),k=o(89086),x=o(28685),I=o(95802),C=o(15723),T=o(55367),M=o(22294),P=o(88923),A=o(69784),D=o(27724),B=o(24666),R=o(6685),E=o(3386),F=o(85893);class N extends r.Z{constructor(){super(...arguments),this.isSelected=!1,this.shouldEditOnClick=!0,this.shouldDisableMultiSelectionOnDragEnd=!1,this.contentEditableLeafRef=n.createRef(),this.wrapperRef=n.createRef(),this.handleKeyDown=e=>{e.metaKey||e.ctrlKey||e.altKey||M.Z.setKeyboardMode(!0)},this.handleDragStart=e=>{const t=this.getContextClosestSelectableStore();e.shiftKey&&!this.isEditing.state&&t?(e.preventDefault(),m.Ys({environment:this.environment,store:t,toggle:m.ji(this.environment),selectBetween:m.OS()}),this.shouldEditOnClick=!1):this.shouldEditOnClick=!0},this.handleDragMove=e=>{if(T.ZP.state.isDragging)c.td(this.environment,{currentX:e.currentX,currentY:e.currentY});else if(e.shiftKey)S.X9()&&c.f$(this.environment,{startX:e.startX,startY:e.startY,stores:D.default.state.stores,isNativeDrag:!1,getGhostElement:void 0});else if(!A.Z.state.isActive){if(!this.props.canSelectionDrag)return;const o=this.getNode();if(!o)return;const n=C.jn(o.getBoundingClientRect(),N.minDragDist);if(C.uh(n,e.currentX,e.currentY))return;var t;if((0,_.Aw)(this.environment))return void("mouse"===e.device&&null!==(t=this.contentEditableContext)&&void 0!==t&&t.tryEnableMultiSelection()&&(this.shouldDisableMultiSelectionOnDragEnd=!0));this.shouldEditOnClick=!1,p.AI({environment:this.environment,target:e.target,startX:e.startX,startY:e.startY,showSelectionRect:!1,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!1})}},this.handleDragEnd=e=>{var t;this.shouldDisableMultiSelectionOnDragEnd&&(null===(t=this.contentEditableContext)||void 0===t||t.tryDisableMultiSelection(),this.shouldDisableMultiSelectionOnDragEnd=!1);T.ZP.state.isDragging?c.fX({environment:this.environment,shiftKey:e.shiftKey,optionKey:e.optionKey,commandKey:e.commandKey,analyticsFrom:"page_content"}):g.aJ()},this.handleClick=e=>{const{device:t}=this.environment;this.props.disabled||(0,y.ZP)({event:e,context:y.Af.EditorClick,callback:()=>{if(this.props.onClick&&this.props.onClick(e),e.defaultPrevented)return;const o=D.default.getDefaultContainerFromTarget(e.target);if(!P.default.isSidePeekOpen()||null!=o&&o.isPeekRenderer()||d.E5(this.environment),this.shouldEditOnClick){const o=this.getContextClosestSelectableStore();if(o?m.eP({environment:this.environment,store:o}):(m.Af({stores:[]}),m.$Y({environment:this.environment,phase:D.SelectionPhase.Selected,preventClearEditingText:!0})),t.isMobile&&!this.isEditing.state&&!this.isPartOfSelection.state){const t=this.getNode();if(t){let o;if(this.mutateDOM((()=>{t.classList.add("editor-force-select"),o=w.rangeFromPoint(e.clientX,e.clientY),t.classList.remove("editor-force-select")})),o){const e=this.getTextSelectionFromRange(o);e&&(g.Z5({store:this.props.store,selection:e.selection}),e.forceEmitSelectionStore&&B.default.emit())}}}this.saveSerializedTextSelectionAfterFlush()}else this.shouldEditOnClick=!0}})},this.handleDragCancel=e=>{T.ZP.state.isDragging&&(c.cQ(this.environment),m.ZH(this.environment))},this.handleContextMenu=e=>{this.props.onContextMenu&&(0,y.ZP)({event:e,context:y.Af.EditorContextMenu,callback:()=>{var t,o;if(null===(t=(o=this.props).onContextMenu)||void 0===t||t.call(o,e),!e.defaultPrevented)return"unhandled"}}),this.isEditing.state&&(0,y.ZP)({event:e,context:y.Af.EditorContextMenu,callback:()=>{this.saveSerializedTextSelectionAfterFlush()}})},this.handleDoubleClick=e=>{(0,y.ZP)({event:e,context:y.Af.EditorDoubleClick,callback:()=>{}})},this.handleSelect=e=>{const{device:t}=this.environment;t.isMobile?this.handleMobileSelect(e):this.handleDesktopSelect(e)},this.handleMobileSelect=e=>{if(!this.props.disabled){if(!w.get())return;const t=this.getContextClosestSelectableStore();this.isEditing.state||m.eP({environment:this.environment,store:t}),this.saveSerializedTextSelection(e),i.default.flush()}},this.handleDesktopSelect=e=>{this.props.disabled||!this.isEditing.state&&"contain"===e.endpoint||this.saveSerializedTextSelection(e)},this.defaultShortcutHandlers={onEsc:e=>{if(this.props.disabled)return;if(e.preventDefault(),(0,_.Aw)(this.environment)){const e="empty"!==B.default.state.mode&&B.default.state.multiSelection,t=e&&(0,_.tp)({multiSelection:e,filterCommonAncestors:!0,focus:void 0});if(t)return void m.Z5({environment:this.environment,...t})}const t=this.getContextClosestSelectableStore();if(t){const e=I.C.findSelectableFromStore(t);e&&e.props.canSelect&&m.Z5({environment:this.environment,stores:[t]})}},onUp:e=>{var t;this.props.disabled||((0,_.Aw)(this.environment)?g.N3({environment:this.environment,topBottomPadding:this.props.topBottomPadding,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry}):g.zJ({environment:this.environment,store:this.props.store,topBottomPadding:this.props.topBottomPadding,event:e}))},onDown:e=>{var t;this.props.disabled||((0,_.Aw)(this.environment)?g.FG({environment:this.environment,topBottomPadding:this.props.topBottomPadding,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry}):g.DI({environment:this.environment,store:this.props.store,topBottomPadding:this.props.topBottomPadding,event:e}))},onLeft:e=>{if(!this.props.disabled){var t;if((0,_.Aw)(this.environment))return g.AL({environment:this.environment,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry});g.e2({environment:this.environment,store:this.props.store,event:e})}},onRight:e=>{if(!this.props.disabled){var t;if((0,_.Aw)(this.environment))return g.D1({environment:this.environment,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry});g.FC({environment:this.environment,store:this.props.store,event:e})}},onSelectAll:e=>{if(!this.props.disabled){var t;if(e.preventDefault(),(0,_.Aw)(this.environment))return g.UV({environment:this.environment,store:this.props.store,canSelectAllBlocks:this.props.canSelectAllBlocks,contentEditableContextId:null===(t=this.contentEditableContext)||void 0===t?void 0:t.id});g.mT({environment:this.environment,store:this.props.store,canSelectAllBlocks:this.props.canSelectAllBlocks})}},onUndo:e=>{e.preventDefault(),u.Yw(this.environment)},onRedo:e=>{e.preventDefault(),u.KX(this.environment)},onGoToBeginningOfLine:e=>{this.setTextSelectionAfterFlush("start",e.shiftKey)},onGoToEndOfLine:e=>{this.setTextSelectionAfterFlush("end",e.shiftKey)}},this.saveSerializedTextSelectionAfterFlush=()=>{i.default.afterNextFlush((()=>{this.saveSerializedTextSelection()}))},this.setTextSelectionAfterFlush=(e,t)=>{const o=B.default.state;"empty"!==o.mode&&i.default.afterNextFlush((()=>{const{start:n,end:r}=o.multiSelection;switch(e){case"start":{const e=n.store.getValue();if(!e)return;const o=s.Oqk({textValue:e,substring:"\n",ignoreCase:!1}).reverse().find((e=>{let{endIndex:t}=e;return t<=n.index})),i=(null==o?void 0:o.endIndex)??0,a={store:n.store,index:i};g.NA({multiSelection:{start:a,end:t?r:a}});break}case"end":{const e=(0,k.x0)(r.store);if(!e)return;const o=n.store.getValue();if(!o)return;const i=s.Oqk({textValue:o,substring:"\n",ignoreCase:!1}).find((e=>{let{startIndex:t}=e;return t>=r.index})),a=(null==i?void 0:i.startIndex)??e.endIndex,l={store:r.store,index:a};g.NA({multiSelection:{start:t?n:l,end:l}});break}default:(0,l.t1)(e)}}))},this.isPartOfSelection=this.createComputedStore((()=>(0,k.ZZ)(this.props.store)),!1,"isPartOfSelection"),this.isEditing=this.createComputedStore((()=>(0,k.J5)(this.props.store)),!1,"isEditing")}get registries(){return[x.E]}getContentEditableLeaf(){return this.contentEditableLeafRef.current||void 0}getNode(){return this.wrapperRef.current?this.wrapperRef.current:this.contentEditableLeafRef.current?this.contentEditableLeafRef.current.getNode():super.getNode()}didMountOrUpdate(){this.isEditing.state?this.isSelected||(this.isSelected=!0,this.props.onSelected&&this.props.onSelected()):this.isSelected&&(this.isSelected=!1,this.clearBrowserSelection(),this.props.onDeselected&&this.props.onDeselected())}willUnmount(){if(this.isSelected){this.isSelected=!1,this.props.onDeselected&&this.props.onDeselected();const e=this.isEditing.state;i.default.afterNextFlush((()=>{const t=x.E.findEditableWithStore(this.props.store),o=this.isEditing.state;e&&o&&!this.componentIsMounted&&!t&&g.ZH(this.environment)}))}}shouldComponentUpdate(e){return!0}getContextClosestSelectable(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.closestSelectable}getContextClosestSelectableStore(){var e;return null===(e=this.context.selectable)||void 0===e||null===(e=e.closestSelectable)||void 0===e||null===(e=e.props)||void 0===e?void 0:e.store}renderComponent(){const{disabled:e,disableUpDownArrows:t,disableEnter:o}=this.props,n=this.isEditing.state;return(0,F.jsx)(E.Z,{capture:n&&!e,onDelete:this.getShortcutHandler("onDelete"),onDeleteToEndOfLine:this.getShortcutHandler("onDeleteToEndOfLine"),onDeleteNextWord:this.getShortcutHandler("onDeleteNextWord"),onBackspace:this.getShortcutHandler("onBackspace"),onEnter:o?void 0:this.getShortcutHandler("onEnter"),onShiftEnter:this.getShortcutHandler("onShiftEnter"),onCommandEnter:this.getShortcutHandler("onCommandEnter"),onCommandShiftEnter:this.getShortcutHandler("onCommandShiftEnter"),onUp:t?void 0:this.getShortcutHandler("onUp"),onDown:t?void 0:this.getShortcutHandler("onDown"),onLeft:this.getShortcutHandler("onLeft"),onRight:this.getShortcutHandler("onRight"),onCommandLeft:this.getShortcutHandler("onCommandLeft"),onCommandRight:this.getShortcutHandler("onCommandRight"),onTab:this.getShortcutHandler("onTab"),onUntab:this.getShortcutHandler("onUntab"),onSelectAll:this.getShortcutHandler("onSelectAll"),onToggleUnderline:this.getShortcutHandler("onToggleUnderline"),onToggleHighlight:this.getShortcutHandler("onToggleHighlight"),onToggleBold:this.getShortcutHandler("onToggleBold"),onToggleItalics:this.getShortcutHandler("onToggleItalics"),onToggleStrike:this.getShortcutHandler("onToggleStrike"),onToggleCode:this.getShortcutHandler("onToggleCode"),onUndo:this.getShortcutHandler("onUndo"),onRedo:this.getShortcutHandler("onRedo"),onEsc:this.getShortcutHandler("onEsc"),onCut:this.getShortcutHandler("onCut"),onCopy:this.getShortcutHandler("onCopy"),onPaste:this.getShortcutHandler("onPaste"),onKeypress:this.getShortcutHandler("onKeyPress"),onMoveUp:this.getShortcutHandler("onMoveUp"),onMoveDown:this.getShortcutHandler("onMoveDown"),onHome:this.saveSerializedTextSelectionAfterFlush,onEnd:this.saveSerializedTextSelectionAfterFlush,onGoToBeginningOfLine:this.getShortcutHandler("onGoToBeginningOfLine"),onGoToEndOfLine:this.getShortcutHandler("onGoToEndOfLine"),onGoForwardOneChar:this.saveSerializedTextSelectionAfterFlush,onGoBackwardOneChar:this.saveSerializedTextSelectionAfterFlush,children:this.renderDraggable()})}renderDraggable(){const e=this.isEditing.state;return(0,F.jsx)(R.Z,{disabled:this.props.disableDrag,onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,cursor:"text",render:t=>this.props.render((0,b.Z)(t,{leafRef:this.contentEditableLeafRef,wrapperRef:this.wrapperRef,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onKeyDown:this.handleKeyDown,onDoubleClick:this.handleDoubleClick}),this.handleSelect,Boolean(e)),enableAndroidContextMenu:this.props.disabled,disableHorizontalEdgeScroll:this.props.disableHorizontalEdgeScroll})}getShortcutHandler(e){const t=this.props[e],o=this.defaultShortcutHandlers[e];return t??o}getTextSelectionFromRange(e){return(0,f.Ut)(this.environment,e)}saveSerializedTextSelection(e){const t=w.get();if((0,_.Aw)(this.environment)){var o;const e=(0,_.fx)({contentEditableLeafRegistry:null===(o=this.contentEditableContext)||void 0===o?void 0:o.contentEditableLeafRegistry,range:t,allowInvisibleEndSelection:(0,v.yA)().shift});return e?void g.bc({environment:this.environment,...e,readOnly:"infer",focus:void 0}):void 0}const n=this.getTextSelectionFromRange(t);if(n){const e="empty"!==B.default.state.mode&&(0,_.xI)("Editable",B.default.state.multiSelection);if(e&&e.store===this.props.store&&a.Xy(e.selection,n.selection)&&!n.forceEmitSelectionStore)return;g.Z5({store:this.props.store,selection:n.selection,readOnly:this.props.disabled}),n.forceEmitSelectionStore&&B.default.emit()}}clearBrowserSelection(){this.props.clearBrowserSelection()}}N.displayName="Editable",N.minDragDist=20,N.contextTypes={...h.Tf,...r.w};const j=N},69278:(e,t,o)=>{o.d(t,{Z:()=>qt});var n=o(67294),r=o(73935),i=o(18466),a=o(13991),s=o(53150),l=o(6740),c=o(49085),d=o(41432),p=o(84939),u=o(8848),m=o(95538),g=o(9999),h=o(82477),f=o(70622),y=o(53376),v=o(49089),b=o(42853),S=o(25654),_=o(86215),w=o(64330),k=o(37240),x=o(95855),I=o(30845),C=o(72126),T=o(23210),M=o(70203),P=o(82990),A=o(5366),D=o(50906),B=o(54564),R=o(47307),E=o(31781),F=o(96802),N=o(27153),j=o(42858),O=o(24677),L=o(98104),U=o(39699),Z=o(51798),V=o(95477),q=o(28020),z=o(43250),W=o(41232),H=o(33929),G=o(98742),K=o(17504),$=o(65598),Y=o(18245),Q=o(68859),J=o(61766),X=o(88632),ee=o(80796);class te extends c.default{getInitialState(){return{hovered:!1,focused:!1,isInFrame:!1}}}const oe=te;var ne=o(27411),re=o(69784),ie=o(83355),ae=o(12534),se=o(96049),le=o(43593),ce=o(80750),de=o(37250),pe=o(59401),ue=o(97880),me=o(64002),ge=o(24608),he=o(18514),fe=o(16354),ye=o(64369),ve=o(85893);function be(e){switch(e){case"image":return de.D;case"audio":case"video":return pe.K;default:return ce.l}}function Se(e,t){if(e&&e instanceof ge.Gg){let o=t||e.data.url;return me.j3(o)&&(o=me.O_({relativeUrl:o,baseUrl:V.default.domainBaseUrl})),e.data.offline?me.j3(e.data.url)||e.data.url.startsWith(V.default.domainBaseUrl)?{type:"offline"}:{type:"unknown",source:o}:{type:"http",source:o,statusCode:e.data.status}}}function _e(e,t){const o=e.error,n=t||e.src;if(o)return o.code===o.MEDIA_ERR_DECODE||o.code===o.MEDIA_ERR_SRC_NOT_SUPPORTED?{type:"unsupported_content_type",extension:n&&(0,le.mD)(n)}:o.code===o.MEDIA_ERR_NETWORK?{type:"offline"}:void 0}function we(){return(0,ve.jsx)(A.FormattedMessage,{id:"embedError.extension.unknown",defaultMessage:"unknown"})}function ke(e){const{source:t,statusCode:o}=e,n=me.Qc(t).hostname;return(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"{hostname} (Error {statusCode})",id:"embedError.hostnameAndStatusCode",values:{hostname:n,statusCode:o}})}function xe(e){switch(e){case"audio":return(0,he.UY)("guides.audioFaqs");case"video":return(0,he.UY)("guides.videosFaqs");case"image":return(0,he.UY)("guides.imagesFaqs");default:return(0,he.UY)("guides.embedsFaqs")}}class Ie extends ie.Z{didMount(){D.QUd(this.environment,{embedType:this.props.family,embedErrorType:this.props.error.type})}renderComponent(){const{style:e,error:t,family:o,isSmall:n}=this.props,r={background:this.theme.embedPlaceholderBackground,cursor:"default",...e||{},position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",alignContent:"center",alignItems:"center",justifyContent:n?"flex-start":"center",padding:n?"7px 14px":"0.5em 1em",textAlign:"center",flexDirection:n?"row":"column",overflow:"hidden"},i=n?25:48,a=n?"0px 14px 0 0":"0 0 14px 0",s=function(e,t){return"image"===t?"unsupported_content_type"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This image format ({extension}) can't be played on this device.",id:"embedError.image.unsupportedContentType",values:{extension:e.extension||we()}}):"offline"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this image",id:"embedError.image.offline"}):"unknown"===e.type||"invalid_protocol"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This image couldn't be loaded.",id:"embedError.image.unknown"}):404===e.statusCode?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This image couldn't be found.",id:"embedError.image.notFound"}):401===e.statusCode||403===e.statusCode?(0,ve.jsx)(A.FormattedMessage,{id:"embedError.image.permissionDenied",defaultMessage:"Permission denied."}):(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This image couldn't be loaded.",id:"embedError.image.serverError"}):"audio"===t?"unsupported_content_type"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This audio format ({extension}) can't be played on this device.",id:"embedError.audio.unsupportedContentType",values:{extension:e.extension||we()}}):"offline"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this audio",id:"embedError.audio.offline"}):"unknown"===e.type||"invalid_protocol"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This audio couldn't be loaded.",id:"embedError.audio.unknown"}):404===e.statusCode?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This audio couldn't be found.",id:"embedError.audio.notFound"}):401===e.statusCode||403===e.statusCode?(0,ve.jsx)(A.FormattedMessage,{id:"embedError.audio.permissionDenied",defaultMessage:"Permission denied."}):(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This audio couldn't be loaded.",id:"embedError.audio.serverError"}):"video"===t?"unsupported_content_type"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This video format ({extension}) can't be played on this device.",id:"embedError.video.unsupportedContentType",values:{extension:e.extension||we()}}):"offline"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this video",id:"embedError.video.offline"}):"unknown"===e.type||"invalid_protocol"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This video couldn't be loaded.",id:"embedError.video.unknown"}):404===e.statusCode?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This video couldn't be found.",id:"embedError.video.notFound"}):401===e.statusCode||403===e.statusCode?(0,ve.jsx)(A.FormattedMessage,{id:"embedError.video.permissionDenied",defaultMessage:"Permission denied."}):(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This video couldn't be loaded.",id:"embedError.video.serverError"}):"file"===t?"unsupported_content_type"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This file format ({extension}) can't be played on this device.",id:"embedError.file.unsupportedContentType",values:{extension:e.extension||we()}}):"offline"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this file",id:"embedError.file.offline"}):"unknown"===e.type||"invalid_protocol"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This file couldn't be loaded.",id:"embedError.file.unknown"}):404===e.statusCode?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This file couldn't be found.",id:"embedError.file.notFound"}):401===e.statusCode||403===e.statusCode?(0,ve.jsx)(A.FormattedMessage,{id:"embedError.file.permissionDenied",defaultMessage:"Permission denied."}):(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This file couldn't be loaded.",id:"embedError.file.serverError"}):"embed"===t?"unsupported_content_type"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This embed format ({extension}) can't be played on this device.",id:"embedError.embed.unsupportedContentType",values:{extension:e.extension||we()}}):"offline"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Go online to view this embed",id:"embedError.embed.offline"}):"unknown"===e.type||"invalid_protocol"===e.type?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This embed couldn't be loaded.",id:"embedError.embed.unknown"}):404===e.statusCode?(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This embed couldn't be found.",id:"embedError.embed.notFound"}):401===e.statusCode||403===e.statusCode?(0,ve.jsx)(A.FormattedMessage,{id:"embedError.embed.permissionDenied",defaultMessage:"Permission denied."}):(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"This embed couldn't be loaded.",id:"embedError.embed.serverError"}):void(0,ue.t1)(t)}(t,o);return(0,ve.jsxs)("div",{style:r,children:[be(o)({fill:this.theme.lightTextColor,width:i,height:i,margin:a}),(0,ve.jsxs)(ye.Z,{isSecondaryColor:!0,isMultiline:!n,style:{margin:a},children:[(0,ve.jsx)("div",{style:{display:n?"inline-block":"block",marginRight:n?"14px":void 0},children:s}),"offline"!==t.type&&(0,ve.jsx)(fe.Z,{style:{display:"inline",pointerEvents:"auto",cursor:"auto",borderBottom:`1px solid ${this.theme.lightTextColor}`},href:xe(o),external:!0,onClick:()=>{D.Fsx(this.environment,{from:"embed_error"})},children:(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Learn more",id:"embedError.learnMore"})})]}),!n&&"http"===t.type&&(0,ve.jsx)(ye.Z,{isSmall:!0,isSecondaryColor:!0,children:ke(t)}),!n&&"unknown"===t.type&&t.source&&(0,ve.jsx)(ye.Z,{isSmall:!0,isSecondaryColor:!0,children:me.Qc(t.source).hostname})]})}}Ie.displayName="EmbedErrorBox";const Ce=Ie;var Te=o(35021);let Me=null;class Pe extends ie.Z{constructor(){super(...arguments),this.storeTypes={error:c.default.createClass(void 0)},this.onPlay=e=>{Me&&Me.pause(),Me=e.currentTarget},this.onPause=e=>{Me===e.currentTarget&&(Me=null)},this.onError=e=>{const t=_e(e.currentTarget,this.props.source);t&&this.stores.error.setState(t)}}renderComponent(){const{contentWrapStyle:e,source:t,handleEmbedComp:o}=this.props;return(0,ve.jsx)("div",{style:e,onMouseDown:ae.$0,onTouchStart:ae.$0,children:(0,ve.jsxs)("div",{style:this.getStyle(),children:[(0,ve.jsx)("audio",{ref:e=>o(e),style:this.getStyle(),controls:!0,preload:"none",onError:this.onError,onPlay:this.onPlay,onPause:this.onPause,src:t}),this.renderError()]})})}renderError(){const e=this.stores.error.state;if(e)return(0,ve.jsx)(Ce,{family:"audio",error:e,isSmall:!0})}getStyle(){const{contentStyle:e}=this.props;return{...e,pointerEvents:se.Z.state?"none":"auto",position:"relative"}}}Pe.displayName="AudioBox",Pe.containerStyle={position:"relative",borderColor:u.ZP.contentBorder,borderRadius:4,borderWidth:1,borderStyle:"solid"};const Ae={render:function(e){const{contentStyle:t,contentWrapStyle:o,handleEmbedComp:n}=e;return(0,ve.jsx)(Te.Z,{url:e.source,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,render:(e,r,i)=>i?r?(0,ve.jsx)(Pe,{contentStyle:t,contentWrapStyle:o,source:r,handleEmbedComp:n}):void 0:(0,ve.jsx)("div",{})})},resizable:!1,hideActions:!0,rendererType:"audio"};var De=o(2834),Be=o(13966),Re=o(91893),Ee=o(23864),Fe=o(70518),Ne=o(68709),je=o(64921),Oe=o(31945),Le=o(89728),Ue=o(26388),Ze=o(480),Ve=o(86628),qe=o(24405),ze=o(73959),We=o(77907),He=o(27724),Ge=o(21199),Ke=o(1743);function $e(e){window.__c={n:"DrawingBox"};const t=(0,Ze.O7)(),o=(0,Ve.VK)((()=>(0,ze.iZ)(e.store)),[e.store]),r=(0,qe.yK)((t=>({sizer:{height:e.height,display:"flex",borderRadius:3,paddingTop:2,paddingLeft:10,paddingRight:10,paddingBottom:10},border:{display:"flex",flex:1,margin:2,padding:3,boxShadow:o?t.outlineBlueInputBoxShadow:void 0,outline:`1px solid ${t.regularDividerColor}`,transition:"box-shadow 0.1s ease-in-out",willChange:"box-shadow",borderRadius:3},ignoreClickArea:{flex:1,position:"relative"}})),[o,e.height]),i=(0,n.useCallback)((()=>{L.ZH({device:t.device}),O.Z5({environment:t,stores:[e.store],phase:He.SelectionPhase.Editing})}),[t,e.store]),a=(0,n.useCallback)((t=>(0,ve.jsx)("div",{...t,style:r.ignoreClickArea,className:"notion-disable-webkit-user-select",children:(0,ve.jsx)(We.LazyTldrawAdapter,{...e,isEditing:o})})),[r.ignoreClickArea,e,o]);return(0,ve.jsx)("div",{style:r.sizer,onPointerDown:i,children:(0,ve.jsx)("div",{style:r.border,children:(0,ve.jsx)(Ke.Z,{capture:o,allowEsc:!0,children:(0,ve.jsx)(Ge.Z,{capture:!0,render:a})})})})}const Ye={render:e=>(0,ve.jsx)($e,{...e}),resizable:!0,hideActions:!0,rendererType:"drawing"};var Qe=o(86329),Je=o(29477);let Xe=0;function et(e){const t=Je.UZ(),o=document.createElement("script");o.type="text/javascript";const n=function(){const e="notion_jsonp_callback_"+Xe;return Xe++,e}();window[n]=e=>{delete window[n],o.parentNode&&o.parentNode.removeChild(o),t.resolve(e)};const r=me.SK(e,{callback:n});return o.src=r,o.onerror=e=>{delete window[n],o.parentNode&&o.parentNode.removeChild(o),t.reject(e)},document.head&&document.head.appendChild(o),t.promise}class tt extends c.default{getInitialState(){return{loading:!0,error:!1,html:void 0}}}const ot=tt;var nt=o(68785),rt=o(33411);class it extends ie.Z{constructor(){super(...arguments),this.storeTypes={store:ot}}async didMount(){const e=`https://gist.github.com/${this.getGistId()}.json`;try{const o=await et(e);this.stores.store.setState({loading:!1,error:!1,html:o.div});if(!document.querySelector(`link[href="${o.stylesheet}"]`)){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=o.stylesheet,document.head&&document.head.appendChild(t)}}catch(o){this.stores.store.setState({loading:!1,error:!0,html:void 0})}}renderComponent(){return(0,ve.jsx)("div",{children:(0,ve.jsx)(Ge.Z,{capture:!0,render:e=>(0,ve.jsx)("div",{...e,ref:this.props.handleEmbedComp,style:this.getStyle(),children:this.renderGist()})})})}renderGist(){return(0,ve.jsx)(rt.Z,{show:this.stores.store.state.loading,showDelay:1e3,showHold:500,render:e=>e||this.stores.store.state.loading?(0,ve.jsx)("div",{style:{marginBottom:"1em"},children:(0,ve.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",opacity:e?1:0,...it.loadingStyle},children:[(0,ve.jsx)(nt.Z,{}),(0,ve.jsx)("div",{style:{marginLeft:8},children:(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Loading gist",id:"githubGistRenderer.loading.message"})})]})}):this.stores.store.state.error?(0,ve.jsx)("div",{style:{marginBottom:"1em"},children:(0,ve.jsx)("div",{style:it.loadingStyle,children:(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Error loading gist",id:"githubGistRenderer.errorLoading.message"})})}):(0,ve.jsx)("div",{dangerouslySetInnerHTML:{__html:this.stores.store.state.html},className:"notion-gist-block"})})}getStyle(){return this.stores.store.state.html?{width:"100%",marginBottom:"-1em",overflowY:"auto",height:"100%",pointerEvents:se.Z.state?"none":"auto"}:{width:"100%",marginBottom:"-1em"}}getGistId(){const{source:e}=this.props,{pathname:t}=me.Qc(e);return(t||"").split("/").pop()}}it.displayName="GistBox",it.loadingStyle={userSelect:"none",padding:"6px 10px",borderRadius:4,border:"1px solid #dddddd",fontSize:14,width:"100%"};const at={render:function(e){const{source:t,handleEmbedComp:o}=e;return(0,ve.jsx)(it,{source:t,handleEmbedComp:o})},renderFullScreen:void 0,resizable:!0,embedGhost:!0,hideActions:!0};var st=o(63085),lt=o(25777),ct=o(49271),dt=o(69721);const pt=function(e){const{signedUrl:t,dataSize:o,dataName:n,contentWrapStyle:r,disabled:i,viewOriginal:a}=e,s={paddingTop:ct.ZD.paddingTop,paddingBottom:ct.ZD.paddingBottom,paddingLeft:ct.ZD.paddingLeft};return(0,ve.jsx)("div",{style:r,onClick:void 0,onMouseDown:ae.$0,children:(0,ve.jsx)("div",{style:{position:"relative"},children:t&&(0,ve.jsx)(dt.S,{title:n,url:t,size:o,onClick:i?void 0:a,style:s})})})};var ut=o(84456),mt=o(77137),gt=o(87111);const ht=e=>{let{url:t,metadata:o}=e;window.__c={n:"IFramePreviewRenderer"};const n=(0,qe.yK)((e=>({previewWrapper:{display:"flex",flexDirection:"column",border:`1px solid ${e.darkDividerColor}`,borderRadius:"3px",height:"100%"},previewImageArea:{flex:1,backgroundColor:e.embedPlaceholderBackground},previewInfoArea:{padding:"0.75em 1em",backgroundColor:e.regularInvertedTextColor,display:"flex",flexDirection:"column",gap:"0.25em"},previewTitle:{fontWeight:P.Z.fontWeight.medium,color:e.darkTextColor},previewUrl:{display:"flex",alignItems:"center",gap:"0.75em"},previewUrlText:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e.lightTextColor},previewUrlFavicon:{width:"1.25em",height:"1.25em"}})),[]),r=null!=o&&o.images&&o.images.length>0?o.images[0].url:void 0;return(0,ve.jsxs)("div",{style:n.previewWrapper,children:[(0,ve.jsx)("div",{style:n.previewImageArea,children:r?(0,ve.jsx)(ft,{imageUrl:r}):(0,ve.jsx)(yt,{})}),(0,ve.jsxs)("div",{style:n.previewInfoArea,children:[(null==o?void 0:o.title)&&(0,ve.jsx)("div",{style:n.previewTitle,children:o.title}),(0,ve.jsxs)("div",{style:n.previewUrl,children:[(null==o?void 0:o.favicon_url)&&(0,ve.jsx)("img",{style:n.previewUrlFavicon,src:o.favicon_url}),(0,ve.jsx)("div",{style:n.previewUrlText,children:t})]})]})]})},ft=e=>{let{imageUrl:t}=e;window.__c={n:"EmbedPreviewArea"};const o=(0,qe.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",height:"100%",backgroundSize:"cover",backgroundImage:`url(${t})`},pill:{backgroundColor:e.accentColors.gray[800],color:e.accentColors.gray[50],borderRadius:"99em",padding:"0.5em 1em",margin:"1em",display:"flex",alignItems:"center",gap:"0.75em",fontWeight:P.Z.fontWeight.medium},playButton:{width:"1em",height:"1em",fill:e.accentColors.gray[50]}})),[t]);return(0,ve.jsx)("div",{style:o.wrapper,children:(0,ve.jsxs)("div",{style:o.pill,children:[(0,gt.I)(o.playButton),(0,ve.jsx)("span",{children:(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Load embed",id:"iFramePreview.pillLabel"})})]})})},yt=()=>{window.__c={n:"ImagelessArea"};const e=(0,qe.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:e.mediumTextColor,height:"100%"},message:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:"0.75em",fontWeight:P.Z.fontWeight.medium},playButtonWrapper:{backgroundColor:e.mediumTextColor,borderRadius:"2em",width:"2.5em",height:"2.5em",display:"flex",justifyContent:"center",alignItems:"center"},playButton:{marginLeft:"0.1em",width:"1em",height:"1em",fill:e.embedPlaceholderBackground}})),[]);return(0,ve.jsx)("div",{style:e.wrapper,children:(0,ve.jsxs)("div",{style:e.message,children:[(0,ve.jsx)("div",{style:e.playButtonWrapper,children:(0,gt.I)(e.playButton)}),(0,ve.jsx)("span",{children:(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Tap to load embed",id:"iFramePreview.imagelessAreaLabel"})})]})})};class vt extends ie.Z{constructor(){super(...arguments),this.renderPreviewContent=(e,t,o)=>{if(o)return(0,ve.jsx)(ht,{url:this.props.source,metadata:t})},this.peformPreviewRequest=async e=>(0,st.W4)(this.environment,e)}renderComponent(){const e={request:this.props.source,performRequest:this.peformPreviewRequest,render:this.renderPreviewContent};return(0,ve.jsx)(mt.Z,{...e})}}function bt(e){window.__c={n:"FullScreenIFrameRenderer"};const{height:t,source:o,contentStyle:r,dataName:i,dataSize:a}=e,[s,l]=(0,n.useState)(!1);return(0,ve.jsx)(Te.Z,{url:o,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,render:(n,c)=>s&&i&&a?pt({...e,dataName:i,dataSize:a,signedUrl:c}):(0,ve.jsx)(ut.Z,{source:o,isFullWidth:!0,isFullHeight:!0,height:t,style:r,background:!0,onContentLoadTimeout:()=>l(!0)})})}vt.displayName="IFramePreview";const St={render:function(e){window.__c={n:"IFrameRenderer"};const{disabled:t,contentStyle:o,contentWrapStyle:r,handleFullScreen:i,handleEmbedComp:a,height:s,preserveScale:l,isFullWidth:c,source:d,dataName:p,dataSize:u}=e,[m,g]=(0,n.useState)(!1);return(0,ve.jsx)(Te.Z,{url:d,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,render:(n,d,h)=>{if(!h||n){const e={position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:1};return(0,ve.jsx)(lt.Z,{innerStyle:{height:"100%",width:"100%"},loaded:h,style:e,spinnerSize:"1em",showSpinnerTimeout:500})}return m&&p&&u?pt({...e,dataName:p,dataSize:u,signedUrl:d}):(0,ve.jsx)("div",{style:r,onClick:t?i:void 0,onMouseDown:ae.$0,children:(0,ve.jsx)("div",{style:{position:"relative"},children:d&&(0,ve.jsx)(ut.Z,{ref:e=>a(e),source:d,height:s,style:o,preserveScale:l,isFullWidth:c,background:!0,renderPreview:()=>(0,ve.jsx)(vt,{source:(0,st.cJ)(e)}),onContentLoadTimeout:()=>g(!0)})})})}})},embedGhost:!0,renderFullScreen:e=>(0,ve.jsx)(bt,{...e}),resizable:!0};var _t=o(10517),wt=o.n(_t),kt=o(54642),xt=o(5162),It=o(24042),Ct=o(12981),Tt=o(32854),Mt=o(81865);class Pt extends ie.Z{constructor(){super(...arguments),this.storeTypes={error:c.default.createClass(void 0)},this.previousImageURL=void 0,this.previousSourceURL=void 0,this.signedOriginalURL=void 0,this.useNativeLightbox=(0,xt.Y)("supportsMobileImageLightbox"),this.getSignedOriginalUrlIfNecessary=(e,t)=>{this.useNativeLightbox&&e&&this.environment.mobileNative&&(this.signedOriginalURL&&e===this.previousSourceURL||(this.previousSourceURL=e,kt.getSignedFileUrl(this.environment,{url:e,download:!1,downloadName:"image",permissionRecord:t.pointer},Boolean(It.Z.state.isNotionProtocolBugFixed)).then((e=>{this.signedOriginalURL=e}))))},this.renderURL=(e,t)=>{const o=t||this.previousImageURL;this.previousImageURL=t;const{isFullScreen:n}=this.props,r=Se(e,void 0)||(0,st.sj)(e)||this.stores.error.state;return n?this.renderFullScreen(r,o):this.renderInline(r,o)},this.handleClickWithoutPropagation=e=>{e.stopPropagation(),this.props.handleFullScreen()},this.onImageError=async(e,t)=>{const o=le.E$(this.props.source,[V.default.secureFileS3.url,V.default.secureFileS3V2.url])?t:this.props.source;if(t){const e=await(0,ge.ZP)({url:t,environment:this.environment,method:"HEAD",format:"text"});if("failed"===e.type){const t=Se(e.error,o);if(t)return void this.stores.error.setState(t)}}this.stores.error.setState({type:"unknown",source:o})},this.onImageLoad=()=>{this.stores.error.setState(void 0)}}renderComponent(){const{store:e,dataURL:t,source:o,isFullWidth:n,dragging:r,blockWidth:i,isFullScreen:a}=this.props;if(t)return this.renderURL(void 0,t);this.getSignedOriginalUrlIfNecessary(o,e);const s=n&&!r?void 0:i,l=window.innerWidth,c=s?Math.min(s,window.innerWidth):window.innerWidth;return(0,ve.jsx)(Mt.Z,{url:o,width:a?l:c,render:this.renderURL,isAuthenticated:!0,permissionRecord:e.pointer},`width-${this.props.contentStyle.width}`)}renderInline(e,t){const{progressPercent:o,disabled:n,isLoading:r,contentStyle:i,contentWrapStyle:a,handleFullScreen:s,handleEmbedComp:l,isFullWidth:c,isRootChild:d,height:p,inlineContentStyle:u,blockLocation:m,imageBoxRef:g}=this.props,h=E.qC(m),f=this.useNativeLightbox?()=>{var e;if(D.QIc(this.environment,{from:"embedded_block_click",type:"image"}),!t)return;const o=0===t.indexOf("https:")?t:`${V.default.domainBaseUrl}${t}`;null===(e=this.environment.mobileNative)||void 0===e||e.showLightBox({items:[{type:"image",previewUrl:wt()(o),originalUrl:wt()(this.signedOriginalURL??o)}],startingIndex:0,from:"embedded_block_click"}),O.ZH(this.environment),L.sD()}:void 0,y=this.environment.mobileNative&&this.useNativeLightbox&&!1===(null==t?void 0:t.startsWith("data:")),v=y?f:h?void 0:s,b=h?this.handleClickWithoutPropagation:void 0,S=y?f:b,_=h?this.handleClickWithoutPropagation:s;return(0,ve.jsx)("div",{ref:e=>l(e),style:a,onClick:n&&!y?_:void 0,children:(0,ve.jsxs)("div",{children:[(0,ve.jsx)(Ct.Z,{ref:g,src:t,loading:"lazy",isFullScreen:!1,style:{...i,...u},placeholderStyle:this.getPlaceholderStyle(),onDoubleClick:v,onClick:S,height:c&&d?p:void 0,capMaxHeight:c&&d,onError:this.onImageError,onLoad:this.onImageLoad}),e&&(0,ve.jsx)(Ce,{error:e,family:"image"}),r&&(0,ve.jsxs)("div",{style:Ct.Z.loadingContainerStyle,children:[(0,ve.jsx)(nt.Z,{style:{width:16,height:16,marginRight:4}}),(0,ve.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:(0,ve.jsx)(Tt.Z,{percentage:o})})]})]})})}renderFullScreen(e,t){const{contentStyle:o}=this.props,n=Math.min(500,window.innerWidth-50);return(0,ve.jsx)("div",{style:{alignSelf:"center",margin:0,position:"relative",minWidth:e?n:void 0},children:(0,ve.jsxs)("div",{children:[(0,ve.jsx)(Ct.Z,{src:t,isFullScreen:!0,style:{...o,background:this.theme.contentBackground},placeholderStyle:this.getPlaceholderStyle(),capMaxHeight:!1,onError:this.onImageError,onLoad:this.onImageLoad}),e&&(0,ve.jsx)(Ce,{error:e,family:"image"})]})})}getPlaceholderStyle(){const{isFullWidth:e,isRootChild:t,aspectRatio:o,height:n}=this.props,r={};return e&&t||!o?n&&(r.height=n,r.background=u.ZP.contentGrayBackground):(r.height=0,r.paddingBottom=100*o+"%",r.background=u.ZP.contentGrayBackground),r}}Pt.displayName="EmbedImageRenderer";const At={render:e=>(0,ve.jsx)(Pt,{...e,isFullScreen:!1}),renderFullScreen:e=>(0,ve.jsx)(Pt,{...e,isFullScreen:!0}),resizable:!0};const Dt={render:function(e){const{disabled:t,contentStyle:o,contentWrapStyle:n,handleFullScreen:r,source:i,handleEmbedComp:a,height:s}=e;return(0,ve.jsx)("div",{style:n,onClick:t?r:void 0,children:(0,ve.jsx)("div",{style:{position:"relative"},children:(0,ve.jsx)(ut.Z,{ref:e=>a(e),source:i,height:s,style:o,background:!1,renderPreview:()=>(0,ve.jsx)(vt,{source:(0,st.cJ)(e)})})})})},renderFullScreen:function(e){const{source:t,height:o,contentStyle:n}=e;return(0,ve.jsx)(ut.Z,{source:t,isFullWidth:!0,height:o,style:n,background:!0})},resizable:!0};var Bt=o(53238),Rt=o(83785);function Et(e){window.__c={n:"TweetBox"};const{handleEmbedComp:t,source:i,fullScreen:a}=e,s=(0,qe.Fg)(),l=(0,qe.yK)((e=>({main:{width:a?520:"100%",minWidth:"100%",pointerEvents:"auto",margin:a?"-10px auto":"-10px 0"},loading:{userSelect:"none",borderRadius:4,border:"1px solid #dddddd",fontSize:14,width:"100%",padding:"6px 10px"}})),[a]),c=(0,n.useCallback)((async e=>{if(!e)return;const{pathname:t}=me.Qc(i),o=(t||"").split("/")[3],n={dnt:!0,lang:"en",width:"100%",theme:"dark"===s.mode?"dark":"light"};if(o&&window.twttr){e.innerHTML="";if(await window.twttr.widgets.createTweetEmbed(o,e,n))return}r.render((0,ve.jsx)("div",{style:l.loading,children:"Error loading tweet"}),e)}),[i,l.loading,s.mode]);return(0,ve.jsx)("div",{style:{display:"flex"},children:(0,ve.jsx)("div",{style:{marginLeft:"auto",marginRight:"auto",maxWidth:420,minWidth:0,width:"100%"},children:(0,ve.jsx)(Ge.Z,{capture:!0,render:e=>(0,ve.jsx)("div",{...e,ref:e=>e&&t(e),style:l.main,children:(0,ve.jsx)(Rt.Z,{fetch:()=>o.e(898).then(o.bind(o,22062)),loading:e=>e&&(0,ve.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",...l.loading},children:[(0,ve.jsx)(nt.Z,{}),(0,ve.jsx)("div",{style:{marginLeft:8},children:(0,ve.jsx)(A.FormattedMessage,{id:"tweetRenderer.loadingTweet.message",defaultMessage:"Loading Tweet"})})]}),render:()=>(0,ve.jsx)("div",{ref:c})})})})})})}const Ft={render:function(e){const{source:t,handleEmbedComp:o}=e;return(0,ve.jsx)(Et,{source:t,handleEmbedComp:o,fullScreen:!1})},renderFullScreen:function(e){const{source:t,handleEmbedComp:o}=e;return(0,ve.jsx)(Et,{source:t,handleEmbedComp:o,fullScreen:!0})},resizable:!1,embedGhost:!0,hideActions:!0};class Nt extends ie.Z{constructor(){super(...arguments),this.storeTypes={played:c.default.createClass(!1),error:c.default.createClass(void 0)},this.handlePlay=e=>{this.stores.played.setState(!0)},this.handlePause=e=>{const{device:t}=this.environment;t.isMobile&&this.stores.played.setState(!1)},this.handleEnded=e=>{const{device:t}=this.environment;t.isAndroid&&document.fullscreenElement&&document.exitFullscreen()},this.handleLoadStart=e=>{const{device:t}=this.environment;t.isIOS&&this.video&&this.video.pause()},this.handleError=e=>{const t=_e(e.currentTarget,this.props.source);t&&this.stores.error.setState(t)},this.handleRef=e=>{this.props.handleEmbedComp(e),this.video=e},this.handlePlayVideo=e=>{this.video&&(0,ae.ZP)({event:e,context:ae.Af.EditorClick,callback:()=>{this.video.play()}})}}renderComponent(){const{store:e,source:t,contentWrapStyle:o,handleFullScreen:n,aspectRatio:r,height:i,handleEmbedComp:a,isFullWidth:s,preserveScale:l,mediaType:c,useS3Url:d}=this.props;return(0,ve.jsx)(Te.Z,{url:t,permissionRecord:e.pointer,useS3Url:d,render:(e,d,p)=>{if(!p)return(0,ve.jsx)("div",{});const u=Se(e,void 0)||this.stores.error.state;return d?"video"===c||(0,m.xL)({url:t})?(0,ve.jsx)("div",{style:o,onMouseDown:ae.$0,children:(0,ve.jsxs)("div",{style:{position:"relative"},onDoubleClick:n,children:[this.renderVideo(d),u&&(0,ve.jsx)(Lt,{error:u}),this.renderOverlay()]})}):(0,ve.jsx)("div",{style:o,onDoubleClick:n,children:(0,ve.jsx)("div",{style:{position:"relative"},children:(0,ve.jsx)(ut.Z,{ref:e=>a(e),source:d,height:i,style:this.getContentStyle("embed_url"),isFullWidth:s,preserveScale:l,aspectRatio:r,background:!0})})}):void 0}})}renderPlayButton(){const{device:e}=this.environment;return e.isFirefox||e.isMobile?null:(0,ve.jsx)(jt,{})}getContentStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"embed_url";const{isFullWidth:t,isRootChild:o,preserveScale:n,height:r}=this.props,i={...this.props.contentStyle};return t&&o&&n&&(i.height=r),"video_file"!==e||this.stores.played.state||(i.pointerEvents="none"),E.qC(this.props.blockLocation)&&(i.maxHeight=240),i.backgroundColor=this.theme.embedPlaceholderBackground,i}renderVideo(e){return(0,ve.jsx)("video",{ref:this.handleRef,style:this.getContentStyle("video_file"),autoPlay:this.environment.device.isIOS,playsInline:!0,controls:!0,preload:"metadata",onPause:this.handlePause,onPlay:this.handlePlay,onEnded:this.handleEnded,onLoadStart:this.handleLoadStart,onError:this.handleError,src:e})}renderOverlay(){return this.stores.played.state||this.stores.error.state?null:(0,ve.jsx)("div",{onClick:this.handlePlayVideo,style:Nt.overlayStyle,children:this.renderPlayButton()})}}function jt(e){return(0,ve.jsx)("div",{style:{...Nt.buttonContainerStyle,...e.style},children:(0,ve.jsx)("div",{style:Nt.buttonTriangleStyle})})}Nt.displayName="VideoRenderer",Nt.overlayStyle={position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},Nt.buttonContainerStyle={position:"relative",height:70,width:70,borderWidth:3,borderStyle:"solid",borderColor:u.ZP.uiBlack,borderRadius:70},Nt.buttonTriangleStyle={position:"absolute",left:"50%",top:"50%",transform:"translate(-30%, -50%)",height:0,width:0,borderStyle:"solid",borderColor:u.ZP.uiBlack,borderRightWidth:0,borderLeftWidth:24.5,borderTopWidth:16.1,borderBottomWidth:16.1,borderTopColor:u.ZP.transparent,borderBottomColor:u.ZP.transparent};const Ot={render:e=>(0,ve.jsx)(Nt,{...e}),resizable:!0,embedGhost:!0};function Lt(e){let{error:t}=e;return(0,ve.jsx)(Ce,{family:"video",error:t})}const Ut=(0,A.defineMessages)({embedButtonText:{defaultMessage:"Embed link",id:"embedBlock.embedButton.label"},embedCaption:{defaultMessage:"Works with links of PDFs, Google Drive, Google Maps, CodePenâ€¦",id:"embedBlock.linkPrompt.caption"},pastePrompt:{defaultMessage:"Paste in https://â€¦",id:"embedBlock.pastePrompt"},validLink:{defaultMessage:"Please enter a valid link.",id:"embedBlock.invalidLinkError.message"},embedTitle:{defaultMessage:"Embed",id:"embedBlock.embedTab.title"}}),Zt={tweet:Ft,gist:at,video:Ot,image:At,audio:Ae,invision:Dt,mixpanel:St,maps:St,drive:St,framer:St,figma:St,loom:St,typeform:St,codepen:St,embed:St,pdf:Bt.Z,whimsical:St,miro:St,abstract:St,sketch:St,excalidraw:St,replit:St,hex:St,deepnote:St,drawing:Ye};class Vt extends De.Z{constructor(){super(...arguments),this.embedComp=null,this.embedContainerWidth=c.default.createValue(0),this.didHaveNonZeroWidth=c.default.createValue(!1),this.imageBoxRef=n.createRef(),this.isStoreNavigableAncestorLocked=this.createComputedStore((()=>this.props.store.isNavigableAncestorLocked())),this.captionAriaId=(0,s.Z)(),this.getImageDimensions=()=>{var e;return null===(e=this.imageBoxRef.current)||void 0===e?void 0:e.getImageDimensions()},this.openMenu=()=>{const{device:e}=this.environment;if(!this.props.disableMediaMenu&&this.canEdit()){const{popupWidth:t,maxHeight:o}=this.props,n=this.props.mediaMenuCurrentTab||"embed",i=(this.props.mediaMenuTabs||[{type:"embed"},{type:"file",fileUpload:!0,imageUpload:e.isAndroid,videoUpload:e.isAndroid}]).map((e=>this.createTabFromDefinition(e))),a=r.findDOMNode(this);if(a&&a instanceof Element){const e=a.getBoundingClientRect();N.$(this.environment,{originRect:e,originGap:0,isSmallWidth:!1,showArrow:!0,currentTab:n,tabs:i,title:H.default.formatMessage(Ut.embedTitle),...t?{popupWidth:t}:{},...o?{maxHeight:o}:{}})}}},this.replace=()=>{this.openMenu();const e=this.props.store.getType();e&&D.Fn4(this.environment,{type:"replace",block_type:e,block_id:this.props.store.id})},this.caption=()=>{this.handleEditCaption()},this.getFullScreenNodeRect=()=>{const{isFullWidth:e,aspectRatio:t}=this.getDimensions();if(this.embedComp){const o=r.findDOMNode(this.embedComp);if(o&&o instanceof Element){const n=o.getBoundingClientRect();return e&&t?{...C.Go(n),width:n.width,height:n.width*t}:n}}},this.renderFullScreenNode=()=>{const e=this.getSource(),t=this.getRendererBySource(this.getSource());if(!e)return;const o=this.getRenderArgs({source:e});return t&&t.renderFullScreen?t.renderFullScreen(o):void 0},this.storeTypes={embedBlockStore:oe,blockResizerStore:Q.Z,alignmentPopupStore:J.Z},this.renderAlignmentButtons=()=>(0,ve.jsxs)(ve.Fragment,{children:[(0,ve.jsx)(je.Z,{style:{...Vt.actionButtonStyle,...this.getAlignmentButtonStyle("left"),borderRight:"none"},hoveredStyle:{...Vt.hoveredActionButtonStyle,opacity:1},onClick:()=>this.handleAlignment("left"),children:zt("left")}),(0,ve.jsx)("span",{style:{borderRight:`1px solid ${u.ZP.whiteWithAlpha(.2)}`}}),(0,ve.jsx)(je.Z,{style:{...Vt.actionButtonStyle,...this.getAlignmentButtonStyle("center"),borderRight:"none"},hoveredStyle:{...Vt.hoveredActionButtonStyle,opacity:1},onClick:()=>this.handleAlignment("center"),children:zt("center")}),(0,ve.jsx)("span",{style:{borderRight:`1px solid ${u.ZP.whiteWithAlpha(.2)}`}}),(0,ve.jsx)(je.Z,{style:{...Vt.actionButtonStyle,...this.getAlignmentButtonStyle("right"),borderRight:"none"},hoveredStyle:{...Vt.hoveredActionButtonStyle,opacity:1},onClick:()=>this.handleAlignment("right"),children:zt("right")})]}),this.handleEditCaption=()=>{const e=this.props.store.getPropertyStore("caption");O.eP({environment:this.environment,store:this.props.store}),L.NX({store:e});const t=this.props.store.getType();t&&D.Fn4(this.environment,{type:"caption",block_type:t,block_id:this.props.store.id})},this.handleMouseEnter=e=>{ee.Z.state.isDragging||re.Z.state.isActive||this.stores.embedBlockStore.setState({...this.stores.embedBlockStore.state,hovered:!0})},this.handleMouseLeave=e=>{ee.Z.state.isDragging||re.Z.state.isActive||this.stores.embedBlockStore.setState({...this.stores.embedBlockStore.state,hovered:!1})},this.handleFocus=e=>{const t=e.target;t instanceof HTMLElement&&(0,l.E)(t)&&this.stores.embedBlockStore.setState({...this.stores.embedBlockStore.state,focused:!0})},this.handleBlur=e=>{this.stores.embedBlockStore.setState({...this.stores.embedBlockStore.state,focused:!1})},this.handleFullScreen=()=>{j.dK({blocks:[this.props.store],blockLocationOfTargetBlock:this.props.blockLocation});const e=this.props.store.getType();e&&D.Fn4(this.environment,{type:"full_screen",block_type:e,block_id:this.props.store.id})},this.handleAlignment=e=>{const t=this.getActionableStoreData(),{alignmentPopupStore:o}=this.stores;o.reset(),t&&U.createAndCommit({userAction:"EmbedBlock.handleAlignment",environment:this.environment,perform:o=>{F.hc({environment:this.environment,store:t,alignment:e,transaction:o})}});const n=this.props.store.getType(),r=this.props.store.getFormat(),i=r.block_alignment,a=r.block_width,s=r.block_height,l=this.props.store.isRootOrDirectChild()?"center":"left";n&&D.Fn4(this.environment,{type:"alignment",block_type:n,block_id:this.props.store.id,block_alignment:e,block_height:s,block_width:a,previous_alignment:i,default_alignment:l}),O.Jy()},this.handleOriginalClick=()=>{const e=this.getActionableStoreData();if(e){E.qL(this.environment,{store:e,from:"view_original"});const t=e.getType();t&&D.Fn4(this.environment,{type:"original",block_type:t,block_id:this.props.store.id})}},this.handleDownload=()=>{const e=this.getActionableStoreData();if(e){E.TH({environment:this.environment,store:e});const t=e.getType();t&&D.Fn4(this.environment,{type:"download",block_type:t,block_id:this.props.store.id})}},this.handleUpload=e=>{const t=this.getActionableStoreData();if(t){const o=q.qQ(this.environment);E.cT({environment:this.environment,store:t,file:e,pageWidth:o,preferredType:t.getType()})}},this.fileUploadStore=this.createComputedStore((()=>ne.default.getKeyState(ne.default.getBlockKey(this.props.store.id)))),this.getContainerStyle=e=>{const t={display:"flex"};return E.qC(this.props.blockLocation)&&(t.display="inline-flex",t.maxHeight=240),"audio"===e.rendererType&&(t.display="flex"),t}}handleCreated(){this.openMenu()}edit(){this.openMenu()}embed(e){this.embedSource(e)}async handleRemoveBlockFromComment(){return!!this.props.onRemoveBlockFromComment&&(await this.props.onRemoveBlockFromComment(this.props.store),!0)}activate(){this.getRendererBySource(this.getSource())?this.handleFullScreen():this.replace()}canRenderFullScreen(){const e=this.getRendererBySource(this.getSource());return!(!e||!e.renderFullScreen)}renderPersisted(){const e=this.getSource(),t=this.fileUploadStore.state;return t&&t.dataURL?this.renderSource(t.dataURL):e?this.renderSource(e):this.renderPlaceholder()}renderSource(e){const{device:t}=this.environment,o=this.canEdit(),{preserveScale:n,isFullWidth:r}=this.getDimensions(),i=this.isRootOrDirectChild(),a=this.getRendererBySource(e);if(a){const{resizable:s}=a,l=o&&s&&!this.props.disableResizers,c=l&&(!n||r&&i),d=l&&i,p=c&&!r,u=p&&i,{Left:m,Right:g}=Fe.bZ,{Vertical:h,Horizontal:f,Corner:y}=Fe.IS;return(0,K.Z)((o=>(0,ve.jsxs)(Ne.p,{role:"figure","aria-labelledby":this.captionAriaId,allowSelectionWithin:!0,ref:t=>{if(t){this.attachGhost(t,e);const{width:o}=t.getBoundingClientRect();this.embedContainerWidth.setState(o),this.didHaveNonZeroWidth.update((e=>e||o>0))}},...o,children:[this.didHaveNonZeroWidth?(0,ve.jsxs)("div",{style:this.getContainerStyle(a),children:[(0,ve.jsxs)("div",{className:z.QSt,style:{position:"relative",overflow:s?"hidden":"visible",flexGrow:1},onFocus:this.handleFocus,onBlur:this.handleBlur,onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,children:[this.renderEmbed(e),d&&this.renderResizer("LeftResizer",f,m,n),l&&this.renderResizer("RightResizer",f,g,n),p&&this.renderResizer("RightCornerResizer",y,g,n),u&&this.renderResizer("LeftCornerResizer",y,m,n),c&&this.renderResizer("BottomResizer",h,null,n),!this.props.disableActions&&this.renderActions(e),this.props.disableActions&&this.props.showExpandButton&&a.renderFullScreen&&this.renderExpandButton(),this.props.contentBelowSource]}),!r&&!t.isMobile&&(0,ve.jsx)(Ee.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}):null,(0,ve.jsx)(Re.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]})))}}renderPlaceholder(){const{device:e}=this.environment,t=!X.Z.state.online,o=e.isMobile||this.stores.embedBlockStore.state.hovered,n=this.fileUploadStore.state;return(0,ve.jsxs)("div",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,style:this.getPlaceholderContainerStyle(),children:[(0,ve.jsx)(Qe.Z,{style:this.getContentWrapStyle(),disabled:!this.canEdit()||t,iconSvg:void 0!==this.props.iconSvg?this.props.iconSvg:S.m,shouldHideRight:!o,right:this.canEdit()&&this.renderBlockMenuActionButton(!0),onClick:this.openMenu,isLoading:Boolean(n),progressPercent:n?n.progressPercent:0,file:n?n.file:void 0,name:n?n.name:void 0,size:n?n.size:void 0,children:this.props.children||(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Embed anything (PDFs, Google Docs, Google Maps, Spotifyâ€¦)",id:"embedBlock.embedAnything.placeholder"})}),(0,ve.jsx)(Ee.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}renderEmbed(e){const t=this.getRendererBySource(e);if(t){const o=this.getRenderArgs({source:e}),n=t.render;return(0,ve.jsx)(n,{...o})}}renderBlockMenuActionButton(e){const{blockLocation:t}=this.props,o=E.qC(t),n=o?"comment_media":"default";return(0,ve.jsx)(Be.Z,{store:this.props.store,fadeIn:!1,iconStyle:e?void 0:{fill:u.ZP.white},actionSectionGroupKey:n,hideFilterActionsInput:o,hoveredStyle:Vt.hoveredActionButtonStyle,tooltipContent:(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"More actions",id:"embedBlock.actionButton.tooltip.blockActionMenu"})})}renderExpandButton(){return(0,ve.jsx)(Le.Z,{style:{position:"absolute",right:12,top:12,background:this.theme.buttonBackground},icon:e=>(0,k.s)({...e,width:16,height:16}),hoveredStyle:{background:this.theme.buttonHoveredBackground},pressedStyle:{background:this.theme.buttonPressedBackground},onClick:this.handleFullScreen,children:(0,ve.jsx)(A.FormattedMessage,{id:"embedBlock.expandFullScreen.button.label",defaultMessage:"Expand"})})}renderActions(e){const{device:t}=this.environment,{blockLocation:o}=this.props,{isFullWidth:n,width:r,isPageWidth:i}=this.getDimensions(),a=this.props.store.canEdit(),s=this.props.store.canComment(),l=this.props.store.isExternalObjectInstanceBlockStore(),c=this.getRendererBySource(e),p=this.shouldHideActions(),m=this.fileUploadStore.state,h=this.stores.blockResizerStore.state.dragging,f=E.qC(o),y=!t.isMobile&&!f&&!l,S=r&&!i&&!n&&!t.isPhone&&!f,_=!t.isMobile&&(null==c?void 0:c.renderFullScreen)&&l;if(!(m||h||c&&c.hideActions)){const e=$.Xp(this.props.store,{recursivelyLoadAllDiscussions:!1});if(this.isStoreNavigableAncestorLocked.state)return(0,ve.jsx)("div",{style:this.getActionsStyle(),children:(0,ve.jsx)(je.Z,{style:Vt.actionButtonStyle,hoveredStyle:Vt.hoveredActionButtonStyle,onClick:this.handleOriginalClick,children:(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"View original",id:"embedBlock.viewOriginalLink.button.label"})})});if(p)return(0,ve.jsx)("div",{style:this.getActionsStyle(),children:this.renderBlockMenuActionButton()});{const o=300,n=Ue.Z.Placement.Top;let r;const i=this.props.store.getType();return r=(0,d.VB)(i)?(0,ve.jsx)(Ue.Z,{renderTooltip:()=>(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Download",id:"embedBlock.actionButton.tooltip.download"}),placement:n,delayThreshold:o,render:e=>(0,ve.jsx)(je.Z,{...e,style:Vt.actionButtonStyle,hoveredStyle:Vt.hoveredActionButtonStyle,onClick:this.handleDownload,children:(0,w.a)({width:14,height:14,marginRight:0,fill:u.ZP.white})})}):(0,ve.jsx)(Ue.Z,{renderTooltip:()=>(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Original",id:"embedBlock.actionButton.tooltip.original"}),placement:n,delayThreshold:o,render:e=>(0,ve.jsx)(je.Z,{...e,style:Vt.actionButtonStyle,hoveredStyle:Vt.hoveredActionButtonStyle,onClick:this.handleOriginalClick,children:(0,g.J)({width:14,height:14,marginRight:0,fill:u.ZP.white})})}),(0,ve.jsxs)("div",{style:this.getActionsStyle(),children:[!f&&!l&&s&&(0,ve.jsx)(Ue.Z,{renderTooltip:()=>(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Comment",id:"embedBlock.actionButton.tooltip.comment"}),placement:n,delayThreshold:o,render:o=>(0,ve.jsxs)(je.Z,{...o,style:{...Vt.actionButtonStyle,...t.isMobile&&{paddingLeft:8,paddingRight:8}},hoveredStyle:Vt.hoveredActionButtonStyle,onClick:()=>{O.ZH(this.environment),e>0?B.Ib({environment:this.environment,blockStore:this.props.store,analyticsFrom:"embed_menu",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1}):Z.yw({environment:this.environment,blockStore:this.props.store})},children:[(0,x.z)({width:14,height:14,marginRight:e>0?4:0,fill:u.ZP.white}),e>0&&e]})}),a&&S&&(0,ve.jsx)(Ue.Z,{renderTooltip:()=>(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Align",id:"embedBlock.actionButton.tooltip.align"}),placement:n,delayThreshold:o,render:e=>(0,ve.jsx)(Oe.ZP,{popupType:Oe.Z4.Popup,buttonPopupStore:this.stores.alignmentPopupStore,originGap:1,renderOrigin:t=>(0,ve.jsxs)(je.Z,{style:Vt.actionButtonStyle,hoveredStyle:Vt.hoveredActionButtonStyle,...(0,G.Z)(t,e),children:[zt(this.getBlockAlignment()),(0,b.i)({width:8,fill:u.ZP.white,marginLeft:4})]}),borderRadius:6,render:this.renderAlignmentButtons,popupWrapStyle:{background:Vt.actionButtonBackground(this.environment),display:"flex"}})}),a&&y&&(0,ve.jsx)(Ue.Z,{renderTooltip:()=>(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Caption",id:"embedBlock.actionButton.tooltip.caption"}),placement:n,delayThreshold:o,render:e=>(0,ve.jsx)(je.Z,{...e,style:Vt.actionButtonStyle,hoveredStyle:Vt.hoveredActionButtonStyle,onClick:this.handleEditCaption,children:(0,v.o)({width:14,height:14,marginRight:0,fill:u.ZP.white})})}),_&&(0,ve.jsx)(Ue.Z,{renderTooltip:()=>(0,ve.jsx)(A.FormattedMessage,{defaultMessage:"Expand",id:"embedBlock.actionButton.tooltip.expand"}),placement:n,delayThreshold:o,render:e=>(0,ve.jsx)(je.Z,{...e,style:Vt.actionButtonStyle,hoveredStyle:Vt.hoveredActionButtonStyle,onClick:this.handleFullScreen,children:(0,k.s)({width:14,height:14,marginRight:0,fill:u.ZP.white})})}),!t.isMobile&&r,this.renderBlockMenuActionButton()]})}}}renderResizer(e,t,o,n){const r={position:"absolute"},{Vertical:i,Horizontal:a,Corner:s}=Fe.IS,{Left:l,Right:c}=Fe.bZ;let d;return t===i||t===s?r.bottom=Vt.resizerOffset:t===a&&(r.top=Vt.resizerOffset),o===l?r.left=Vt.resizerOffset:o===c&&(r.right=Vt.resizerOffset),d=t===s?(0,_.u)({stroke:u.ZP.whiteWithAlpha(.5),fill:u.ZP.blackWithAlpha(.65),width:Vt.cornerResizeSize,height:Vt.cornerResizeSize,transition:`opacity ${Vt.transition}`,opacity:this.shouldShowResizer()?1:0,position:"relative",bottom:3,left:o===l?3:-3,transform:o===l?"rotate(90deg)":"none"}):(0,ve.jsx)("div",{style:this.getResizerInnerStyle(t)}),(0,ve.jsx)(Fe.ZP,{store:this.props.store,preserveScale:n,resizerType:t,resizerAlignment:o,resizeComponent:this,blockResizerStore:this.stores.blockResizerStore,resizeHorizontally:!0,resizeVertically:!0,disabled:!1,children:(0,ve.jsx)("div",{style:{...this.getResizeStyle(t,o),...r},children:d})},e)}createTabFromDefinition(e){switch(e.type){case"embed":const t=this.props.embedButtonText||H.default.formatMessage(Ut.embedButtonText);return{type:"embed",caption:this.props.mediaMenuEmbedCaption||H.default.formatMessage(Ut.embedCaption),buttonText:t,inputPlaceholder:this.props.urlInputPlaceholder||H.default.formatMessage(Ut.pastePrompt),onChange:e=>{const t=(0,T.D)(e);I.B(t,"url")?(N.Z(),this.embedSource(t)):R.showErrorMessage(H.default.formatMessage(Ut.validLink))}};case"file":return{type:"file",fileUpload:Boolean(e.fileUpload),imageUpload:Boolean(e.imageUpload),videoUpload:Boolean(e.videoUpload),onUpload:this.handleUpload};case"unsplash":return{type:"unsplash",onChange:e=>{let{url:t}=e;N.Z(),this.embedSource(t)}};case"giphy":return{type:"giphy",onChange:e=>{let{url:t}=e;N.Z(),this.embedSource(t)}}}}shouldShowResizer(){const{device:e}=this.environment,{hovered:t}=this.stores.embedBlockStore.state,{isMobile:o}=e;return!o&&t}attachGhost(e,t){const o=this.getRendererBySource(t);e&&o&&o.embedGhost&&this.mutateDOM((()=>e.setAttribute("embed-ghost","")))}shouldHideActions(){const{block_width:e}=this.props.store.getFormat(),{temporaryWidth:t}=this.stores.blockResizerStore.state;return void 0!==t?t<=Vt.minWidthForActions:void 0!==e&&e<=Vt.minWidthForActions}getDimensions(){const{block_height:e,block_width:t,block_preserve_scale:o,block_full_width:n,block_page_width:r,block_aspect_ratio:i}=this.props.store.getFormat(),{dragging:a,temporaryHeight:s,temporaryWidth:l,temporaryFullWidth:c,temporaryPageWidth:d}=this.stores.blockResizerStore.state,p=a?l:t??this.embedContainerWidth.state,u=a?s:e,g=Boolean(a?c:n),h=Boolean(a?d:r),f=Boolean(this.props.preserveScale||o);return{blockWidth:t,blockHeight:e,width:p,height:this.props.store.isExternalObjectInstanceBlockStore()&&"image"!==this.props.mediaType?u||m.QA:u,dragging:a,preserveScale:f,isFullWidth:g,isPageWidth:h,aspectRatio:i}}getSource(){return this.props.source||Vt.getEmbedSourceFromBlockStore(this.props.store)}static getEmbedSourceFromBlockStore(e){const t=e.getProperties(),o=null==t?void 0:t.source,n=M.QaF(o),{display_source:r}=e.getFormat();return(0,m.Z8)(r||n)}getRenderArgs(e){const{source:t}=e,o=this.props.store.getProperties(),n=M.Jcv(o&&o.title),r=M.Jcv(o&&o.size),i=this.fileUploadStore.state,{blockWidth:a,blockHeight:s,width:l,height:c,dragging:d,preserveScale:p,isFullWidth:u,isPageWidth:m,aspectRatio:g}=this.getDimensions(),h=this.isRootOrDirectChild(),{device:f}=this.environment;return{store:this.props.store,source:t,blockWidth:a,blockHeight:s,aspectRatio:g,width:l,height:c,dragging:d,preserveScale:p,isFullWidth:u,isPageWidth:m,isRootChild:h,dataURL:i?i.dataURL:void 0,dataName:n,dataSize:r,disabled:!this.canEdit(),contentStyle:this.getContentStyle(),contentWrapStyle:this.getContentWrapStyle(),isLoading:Boolean(i),progressPercent:i?i.progressPercent:0,handleFullScreen:this.handleFullScreen,handleEmbedComp:e=>this.embedComp=e,viewOriginal:this.handleOriginalClick,inlineContentStyle:this.props.inlineContentStyle,blockLocation:this.props.blockLocation,mediaType:this.props.mediaType,imageBoxRef:this.imageBoxRef,useS3Url:f.isIOS&&f.isMobileNative}}getRendererBySource(e){var t,o;return Vt.getRenderer(e,null===(t=this.fileUploadStore.state)||void 0===t?void 0:t.dataURL,this.props.mediaType??(null===(o=this.getActionableStoreData())||void 0===o?void 0:o.getType()))}static hasRendererForStore(e){return i.Z.withListenerIgnored((()=>Boolean(Vt.getRenderer(Vt.getEmbedSourceFromBlockStore(e),void 0,e.getType()))))}static getRenderer(e,t,o){if(t)return Zt.image;if(e){if(e.startsWith("data:")||e.startsWith("<img"))return;const t=(0,m.Dz)({url:e,baseUrl:V.default.domainBaseUrl,publicDomainName:V.default.publicDomainName,preferredType:o});if("embed"!==t)return Zt[t]}return o&&e?Zt[o]:St}embedSource(e){const t=this.getActionableStoreData();if(!t)return;const o=q.qQ(this.environment);D.bOx(this.environment,{pastedText:e,source:"embed_block_menu"});const n=Y.default.mark("embed_render_complete");E.I(this.environment,{source:e,isDataURL:!1,store:t,pageWidth:o,preferredType:t.getType(),metric:n})}getActionableStoreData(){if("external_object_instance"!==this.props.store.getType()||(0,W.Xg)())return this.props.store}static actionButtonBackground(e){const{device:t}=e;return t.isMobile?u.ZP.blackWithAlpha(.3):u.ZP.blackWithAlpha(.6)}getPlaceholderContainerStyle(){const e={display:"flex"};return E.qC(this.props.blockLocation)&&(e.borderWidth=1,e.borderColor=this.theme.regularDividerColor,e.marginBottom=10,e.borderRadius=3),e}getContentWrapStyle(){const e={position:"relative"};return this.canEdit()&&(e.cursor="pointer"),this.props.centerWrappedContent&&(e.display="flex",e.justifyContent="center",e.alignItems="center",e.minHeight=220),e}getContentStyle(){const{dragging:e}=this.stores.blockResizerStore.state;return{display:"block",pointerEvents:e?"none":"auto",width:"100%"}}getResizeStyle(e,t){const o={position:"absolute",pointerEvents:this.shouldShowResizer()?"auto":"none",display:"flex",alignItems:"center",justifyContent:"center"};return t===Fe.bZ.Right?o.right=0:t===Fe.bZ.Left&&(o.left=0),e===Fe.IS.Horizontal?(o.top=0,o.zIndex=1,o.height="100%",o.width=Vt.resizerWidth,o.cursor="col-resize"):e===Fe.IS.Vertical?(o.bottom=0,o.zIndex=1,o.width="100%",o.height=Vt.resizerWidth,o.cursor="row-resize"):e===Fe.IS.Corner&&(o.zIndex=2,o.bottom=0,o.width=o.height=Vt.cornerResizeSize,t===Fe.bZ.Left?o.cursor="nesw-resize":t===Fe.bZ.Right&&(o.cursor="nwse-resize")),o}getResizerInnerStyle(e){const{ThemeStore:t}=this.environment,o=t.state.mode,n={opacity:this.shouldShowResizer()?1:0,transition:Vt.transition,borderRadius:20,background:(0,p.Fq)(u.se[o].black,.6),border:`1px solid ${u.ZP.whiteWithAlpha(.9)}`};return e===Fe.IS.Horizontal?(n.width=6,n.height=48,n.maxHeight="50%"):e===Fe.IS.Vertical&&(n.height=6,n.width=48,n.maxWidth="50%"),n}getActionsStyle(){const{device:e}=this.environment,{focused:t,hovered:o}=this.stores.embedBlockStore.state,{isMobile:n}=e;return{position:"absolute",top:4,right:4,borderRadius:4,color:u.ZP.white,fill:u.ZP.white,fontSize:11.5,background:Vt.actionButtonBackground(this.environment),display:"flex",whiteSpace:"nowrap",height:26,maxWidth:"calc(100% - 16px)",overflow:"hidden",pointerEvents:t||o||n?"auto":"none",opacity:t||o||n?1:0,transition:e.isSafari?void 0:Vt.transition,fontFamily:P.Z.getCompositeFontFamily(a.SP).sans,zIndex:2}}getBlockAlignment(){const{block_alignment:e}=this.props.store.getFormat(),t=this.isRootOrDirectChild();return e||(t?"center":"left")}getAlignmentButtonStyle(e){let t=.6;return this.getBlockAlignment()===e&&(t=1),{width:26,height:26,opacity:t}}}Vt.minWidthForActions=230,Vt.resizerWidth=15,Vt.resizerOffset=0,Vt.cornerResizeSize=20,Vt.actionButtonStyle={display:"flex",alignItems:"center",justifyContent:"center",padding:"4px 6px",borderRight:`1px solid ${u.ZP.whiteWithAlpha(.2)}`},Vt.hoveredActionButtonStyle={background:"rgba(255, 255, 255, 0.055)"},Vt.centerPromptStyle={color:u.ZP.white,fontSize:14,fontFamily:P.Z.getCompositeFontFamily(a.SP).sans,padding:"0.3em 1.5em 0.3em",background:u.ZP.blackWithAlpha(.4),borderRadius:4},Vt.transition="opacity 300ms ease-in";const qt=Vt;function zt(e){const t={left:f.$,center:h.L,right:y.g},o={width:14,height:14,marginRight:0,fill:u.ZP.white};return t[e](o)}},86329:(e,t,o)=>{o.d(t,{Z:()=>p});o(67294);var n=o(83355),r=o(68709),i=o(64921),a=o(68785),s=o(32854),l=o(40148),c=o(85893);class d extends n.Z{renderComponent(){return this.props.isLoading?this.renderLoading():(0,c.jsx)(r.p,{allowSelectionWithin:!1,style:this.getBackgroundStyle(),children:(0,c.jsx)(i.Z,{onClick:this.props.onClick,disabled:this.props.disabled,children:(0,c.jsx)(l.ZP,{style:{background:void 0,...this.props.style},iconSvg:this.props.iconSvg,right:this.props.right,shouldHideRight:this.props.shouldHideRight,children:this.props.children})})})}renderLoading(){const{file:e,name:t,size:o,progressPercent:n}=this.props;let r;return r=e?(0,c.jsxs)("div",{children:[t,(0,c.jsx)("div",{style:l.Lw,children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsxs)("div",{children:[o," ","â€“"," "]}),(0,c.jsx)(a.Z,{style:{marginLeft:3,marginRight:3}}),(0,c.jsx)(s.Z,{percentage:n})]})})]},"FileLoadingSpinner"):(0,c.jsx)("div",{children:(0,c.jsx)(a.Z,{style:{marginLeft:3,marginRight:3}})},"LoadingSpinner"),(0,c.jsx)(l.ZP,{style:this.props.style,iconSvg:this.props.iconSvg,children:r})}getBackgroundStyle(){return{background:this.theme.embedPlaceholderBackground,width:"100%",borderRadius:4}}}d.displayName="EmbedPlaceholder",d.captionStyle=l.HB;const p=d},3702:(e,t,o)=>{o.d(t,{Z:()=>x});var n=o(67294),r=o(83355),i=o(13991),a=o(8848),s=o(75e3),l=o(72126),c=o(20852),d=o(70203),p=o(82990),u=o(5366),m=o(50906),g=o(83631),h=o(18514),f=o(69015),y=o(42922),v=o(36488),b=o(16354),S=o(53437),_=o(22492),w=o(85893);class k extends r.Z{constructor(){super(...arguments),this.input=n.createRef(),this.renderPopup=()=>{const{isOpen:e}=this.props,t=this.getThemeColors(),o={...this.styles.popupInputForm,...t.popupInputForm},r=(0,w.jsxs)("div",{style:o,children:[this.renderInput(),this.renderPopupSubmitButton()]});return(0,w.jsx)(v.Z,{capture:e,allowEsc:!0,render:()=>this.getPopupType()===S.ZP.PopupType.SlideUp?(0,w.jsxs)(n.Fragment,{children:[this.renderMobilePreview(),r]}):(0,w.jsxs)(n.Fragment,{children:[r,this.renderEquationError()]})})},this.handleInputChange=e=>{const{isOpen:t,onChange:o,displayMode:n}=this.props;t&&o(e,g.by({environment:this.environment,equation:e,displayMode:n}))},this.handleSubmit=e=>{const{isOpen:t,disabled:o,error:n,onSubmit:r,onDismiss:i}=this.props;e.preventDefault&&e.preventDefault(),o||t&&(n||(r(),i()))},this.getHighlightedHtml=e=>{const{Prism:t}=this.props;return t.highlight(l.AK(e),t.languages[c.PrismLanguages.latex],c.PrismLanguages.latex)},this.styles={popup:{width:400,display:"flex",flexDirection:"column"},popupInputForm:{display:"flex",alignItems:"center",padding:"8px 10px",width:"100%"},mobilePreview:{padding:"4px 8px",height:80,display:"flex",alignItems:"center",justifyContent:"center"},mobilePreviewValue:{overflow:"auto"},equationInput:{fontFamily:p.Z.getCompositeFontFamily(i.SP).mono,fontSize:14,marginRight:8,flex:1,wordBreak:"break-word",maxHeight:"50vh",overflow:"auto"},equationInputBlock:{minHeight:60},equationInputSlideUp:{height:100},submitButton:{alignSelf:"flex-start"},enterIcon:{height:14,width:14,fill:"currentColor",marginLeft:6,marginTop:2},errorContainer:{color:a.ZP.redWithAlpha(.8),fontSize:12,padding:"8px 10px"},errorLabel:{fontWeight:600},learnMoreLink:{display:"inline",textDecoration:"underline"}}}didMount(){this.environment.KatexStore.loadIfNeeded((()=>[(0,d.qZ6)("")]))}getSelection(){if(!this.input)return;if(!this.input.current)return;const e=this.input.current.getSelection();return"contain"===(null==e?void 0:e.type)?e.selection:void 0}renderComponent(){const{isOpen:e,onDismiss:t,origin:o,originRect:n,originGap:r,popupStyle:i}=this.props,a=this.getPopupType();return(0,w.jsx)(S.ZP,{popupType:a,open:e,origin:o,originRect:n,originGap:r,keepFocus:a===S.ZP.PopupType.SlideUp,onDismiss:t,style:{...this.styles.popup,...i},render:()=>this.renderPopup()})}renderInput(){const{disabled:e,isOpen:t,equationValue:o,onLeft:n,onRight:r,onDismiss:i,displayMode:a}=this.props,s=this.getThemeColors(),l=this.getPopupType()===S.ZP.PopupType.SlideUp,c=!e&&!l,d=l?{type:f.b.Textarea}:{type:f.b.InlineWrap,onSubmit:this.handleSubmit},p={...this.styles.equationInput,..."block"===a&&this.styles.equationInputBlock,...l&&this.styles.equationInputSlideUp},u={...p,...s.equationInputPlaceholder};return(0,w.jsx)(f.Z,{ref:this.input,...d,disabled:e,focus:t,selectAll:c,value:o||"",placeholder:this.getPlaceholderEquation(),getHtml:this.getHighlightedHtml,onChange:this.handleInputChange,onCancel:i,onLeft:n,onRight:r,placeholderStyle:u,style:p,autoCorrect:"off",autoCapitalize:"off"})}getPlaceholderEquation(){const{displayMode:e}=this.props;return"block"===e?"|x| = \\begin{cases}Â Â Â Â Â Â Â Â Â Â Â Â Â \nÂ Â x, &\\quad x \\geq 0 \\\\Â Â Â Â Â Â Â Â Â Â Â \nÂ -x, &\\quad x < 0Â Â Â Â Â Â Â Â Â Â Â Â Â \n\\end{cases}":"E = mc^2"}renderPopupSubmitButton(){const{error:e,disabled:t}=this.props;if(!t)return(0,w.jsxs)(y.Z,{onClick:this.handleSubmit,disabled:t||Boolean(e),style:this.styles.submitButton,children:[(0,w.jsx)(u.FormattedMessage,{defaultMessage:"Done",id:"equationInput.submitButton.label"}),(0,s.U)(this.styles.enterIcon)]})}renderEquationError(){if(!this.props.isOpen)return;const{error:e}=this.props,t=this.getPopupType()===S.ZP.PopupType.Popup;if(!e)return;const o=e.message.replace("KaTeX parse error: ",""),n={...this.styles.errorContainer,...t&&this.getThemeColors().errorContainerDesktop};return(0,w.jsxs)("div",{role:"alert",style:n,children:[(0,w.jsx)("span",{style:this.styles.errorLabel,children:(0,w.jsx)(u.FormattedMessage,{defaultMessage:"Invalid equation:",id:"equationInput.inputError.label"})})," ",o,". ",(0,w.jsx)(b.Z,{href:(0,h.UY)("guides.equations"),external:!0,onClick:()=>{m.Fsx(this.environment,{from:"equation_input"})},style:this.styles.learnMoreLink,children:(0,w.jsx)(u.FormattedMessage,{defaultMessage:"Learn more",id:"equationInput.inputError.learnMore"})})]})}renderMobilePreview(){const{equationValue:e,error:t,displayMode:o}=this.props;if(e)return(0,w.jsx)("div",{style:this.styles.mobilePreview,children:t?this.renderEquationError():"block"===o?(0,w.jsx)(_.Z,{display:o,equation:e,style:this.styles.mobilePreviewValue,theme:this.theme}):(0,w.jsx)(_.Z,{display:o,equation:e,style:this.styles.mobilePreviewValue,theme:this.theme,index:0,isTemporary:!1})})}getPopupType(){const{device:e}=this.environment,t=e.isPhone&&e.isIOS&&e.isMobileBrowser;return e.isPhone&&!t?S.ZP.PopupType.SlideUp:S.ZP.PopupType.Popup}getThemeColors(){return{popupInputForm:{background:this.theme.inputBackground},errorContainerDesktop:{boxShadow:`0 -1px ${this.theme.lightDividerColor}`},equationInputPlaceholder:{color:this.theme.lightTextColor}}}}k.displayName="EquationInputPopup";const x=k},22492:(e,t,o)=>{o.d(t,{Z:()=>d});o(67294);var n=o(83355),r=o(98923),i=o(5366),a=o(83631),s=o(77907),l=o(85893);class c extends n.Z{didMount(){super.didMount(),a.bc()}renderComponent(){return(0,l.jsx)(s.DependencyConsumer,{dependency:s.deps.katex,children:e=>(0,l.jsx)(r.MW,{katex:e,...this.props})})}}c.displayName="EquationValue";const d=(0,i.injectIntl)(c)},42782:(e,t,o)=>{o.d(t,{Z:()=>y});var n=o(67294),r=o(73935),i=o(480),a=o(98742),s=o(3386),l=o(53437);const c=()=>{const[e,t]=n.useState({x:0,y:0});return n.useEffect((()=>{const e=e=>{t({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]),e};var d=o(85893);const p=e=>{let{x:t,mouseX:o}=e;return o>t?void 0:-Math.max(t-o,10)+"px"},u=e=>{let{x:t,width:o,mouseX:n}=e;return n>t?-Math.max(n-(t+o),10)+"px":void 0},m=e=>{let{x:t,width:o,mouseX:n}=e;return n>t?`${Math.max(n-(t+o),10)}px`:`${Math.max(t-n,10)}px`},g=e=>{let{x:t,y:o,height:n,mouseX:r,mouseY:i}=e;return r>t?`polygon(0% 0%, 0% 100%, 100% ${100*(i-o)/n}%)`:`polygon(100% 0%, 0% ${100*(i-o)/n}%, 100% 100%)`};function h(e){window.__c={n:"ExtensionMenuSafeArea"};const{x:t=0,y:o=0,height:n=0,width:r=0}=e.el.getBoundingClientRect()||{},{x:i,y:a}=c(),s={x:t,y:o,height:n,width:r,mouseX:i,mouseY:a},l={right:u(s),left:p(s),height:n,width:m(s),clipPath:g(s)};return(0,d.jsx)("div",{style:{cursor:"pointer",position:"absolute",top:0,...l}})}function f(e,t){let{onClick:o,renderOrigin:c,renderExtension:p,...u}=e;window.__c={n:"ExtensionMenuItem"};const{disableDefaultClick:m,onFocus:g,focused:f,openOnFocus:y}=u,v=(0,i.Fy)(),[b,S]=(0,n.useState)(!1),_=(0,n.useRef)(null),w=(0,n.useRef)(null),k=(0,n.useRef)(null),x=(0,n.useRef)(null),I=(0,n.useCallback)((()=>{k.current&&window.clearTimeout(k.current),x.current&&window.clearTimeout(x.current),k.current=null,x.current=null}),[]),C=(0,n.useCallback)((()=>{I(),b||S(!0)}),[b,I]),T=(0,n.useCallback)((()=>{I(),b&&S(!1)}),[b,I]),M=(0,n.useCallback)((e=>{I(),b||(e&&e.preventDefault&&e.preventDefault(),k.current=window.setTimeout(C,120))}),[b,I,C]),P=(0,n.useCallback)((()=>{I(),b&&(x.current=window.setTimeout(T,100))}),[b,T,I]),A=(0,n.useCallback)((()=>{g(),C()}),[g,C]),D=(0,n.useCallback)((e=>{M()}),[M]),B=(0,n.useCallback)((e=>{g(),M()}),[g,M]),R=(0,n.useCallback)((e=>{if(v.isPhone)return;const t=r.findDOMNode(_.current);b&&t&&!t.contains(e.target)&&T()}),[b,T,v.isPhone]),E=(0,n.useCallback)((e=>{13===e.keyCode&&b&&T()}),[b,T]);(0,n.useEffect)((()=>{if(!Boolean(m))return window.addEventListener("click",R),()=>{window.removeEventListener("click",R)}}),[m,R]),(0,n.useEffect)((()=>(window.addEventListener("keydown",E),()=>{window.removeEventListener("keydown",E)})),[E]);const F=(0,n.useRef)(f);(0,n.useEffect)((()=>{v.isMobile||(y&&!F.current&&f?M():f||P(),F.current=f)}),[f,y,M,P,v.isMobile]);const N={...(0,a.Z)({onMouseEnter:D,onClick:A},u),showExtensionArrow:!0};return(0,d.jsx)(s.Z,{capture:f,onEnter:b?void 0:M,onRight:M,onLeft:b?P:void 0,onEsc:b?P:void 0,children:(0,d.jsx)(l.ZP,{popupType:v.isPhone?l.ZP.PopupType.SlideUp:l.ZP.PopupType.Popup,open:b,origin:c(N,t),placementToOrigin:l.ZP.Placement.Right,alignmentToOrigin:l.ZP.Alignment.Center,originGap:0,disableMouseCapture:!0,preventBlockRenderQueueOnEnter:!0,preventScaleTransition:!v.isPhone,preventCaptureEsc:!0,ref:_,render:()=>(0,d.jsxs)(d.Fragment,{children:[w.current&&(0,d.jsx)(h,{el:w.current}),(0,d.jsx)("div",{ref:w,children:p({onMouseEnter:B},{close:P})})]}),style:{overflow:"visible"},trapFocus:!0})})}const y=n.forwardRef(f)},19987:(e,t,o)=>{o.d(t,{Z:()=>ee});var n=o(67294),r=o(83355),i=o(86628),a=o(24405),s=o(84939),l=o(8848),c=o(77657),d=o(42853),p=o(56666),u=o(44495),m=o(60291),g=o(54497),h=o(90965),f=o(82990),y=o(5366),v=o(50906),b=o(42631),S=o(42858),_=o(39699),w=o(61202),k=(o(95477),o(70764)),x=o(41232),I=o(33929),C=o(77907),T=o(80444),M=o(30874),P=o(31194),A=o(1634),D=o(64921),B=o(31945),R=o(51077),E=o(89728),F=(o(57658),o(480)),N=o(74155),j=o(37612),O=o(14871),L=o(47307),U=o(75018),Z=o(87279),V=o(18514),q=o(52275),z=o(78140),W=o(32163),H=o(72495),G=o(85893);const K=(0,y.defineMessages)({copiedDebuggingInfo:{id:"externalObjectBlock.errorDropdown.copiedDebuggingInfo",defaultMessage:"Copied to clipboard."}});function $(e){window.__c={n:"ExternalObjectInstanceErrorMenu"};const{state:t,store:o,onUpdate:n,onReplace:r,onAuthenticate:s,onRemove:d,description:p,statusCode:u,errorDescription:g,isInlineMenu:h}=e,{userHasBotForIntegration:f,pattern:b,integration:S,botIds:_,originalUrl:w}=t,k=(0,F.Fy)(),x=(0,F.O7)(),I=(0,a.yK)((e=>({menuIcon:{fill:e.regularIconColor,width:16},redThemeColor:(0,l.fi)("red",e)})),[]),C=(0,i.VK)((()=>{var e;return Boolean(null===(e=T.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit())}),[]),M=(0,i.VK)((()=>o.isExternalObjectInstanceBlockStore()),[o]),P=(0,i.VK)((()=>o.isExternalObjectInstancePageBlockStore()),[o]);let A;A=k.isMobile?{menuType:Z.og.ActionSheet}:{menuType:Z.og.Popup,minWidth:220};const D={key:"remove",render:e=>(0,G.jsx)(q.Z,{title:(0,G.jsx)(y.FormattedMessage,{defaultMessage:"Remove",id:"unfurling.errorOptions.removeAction.title"}),style:{color:I.redThemeColor.color},icon:(0,j.y)({fill:I.redThemeColor.fill,width:16}),...e}),action:()=>{null==d||d()}},B={key:"replace",render:e=>(0,G.jsx)(q.Z,{title:(0,G.jsx)(y.FormattedMessage,{defaultMessage:"Change URL",id:"unfurling.errorOptions.replace.title"}),icon:(0,m.b)(I.menuIcon),...e}),action:()=>{r()}},E={key:"update",render:e=>(0,G.jsx)(q.Z,{title:(0,G.jsx)(y.FormattedMessage,{defaultMessage:"Try again",id:"unfurling.errorOptions.tryAgainAction.title"}),icon:(0,m.b)(I.menuIcon),...e}),action:()=>{null==n||n()}},$={key:"authenticate",render:e=>(0,G.jsx)(q.Z,{title:f?401===u?(0,G.jsx)(y.FormattedMessage,{defaultMessage:"Re-authenticate account",id:"unfurling.errorOptions.authenticateAction.reAuthenticate.title"}):h?(0,G.jsx)(y.FormattedMessage,{defaultMessage:"Connect a different account",id:"unfurling.errorOptions.authenticateAction.alreadyAuthenticatedCompact.title"}):(0,G.jsx)(y.FormattedMessage,{defaultMessage:"Connect a different {integration} account",id:"unfurling.errorOptions.authenticateAction.alreadyAuthenticated.title",values:{integration:S.name}}):(0,G.jsx)(y.FormattedMessage,{defaultMessage:"Connect {integration} account",id:"unfurling.errorOptions.authenticateAction.notAuthenticated.title",values:{integration:S.name}}),icon:(0,G.jsx)(R.Z,{type:"image_url",imageURL:S.icon,size:16}),...e}),action:()=>{null==s||s()}},Y=[{key:"learn",render:e=>(0,G.jsx)(q.Z,{title:(0,G.jsx)(y.FormattedMessage,{defaultMessage:"Learn more about this error",id:"unfurling.errorOptions.learnMore.title"}),icon:(0,N.u)(I.menuIcon),...e}),action:()=>{L.showDialog({items:[{label:(0,G.jsx)(y.FormattedMessage,{id:"externalObjectInstanceBlockErrorDropdown.dialogItem.reviewGuide",defaultMessage:"View guide"}),color:"blue",onAccept:()=>{U.navigateToExternalURL({environment:x,url:(0,V.UY)("guides.unfurling")}),v.SCe(x,{integrationId:S.id,entity:null==b?void 0:b.name,statusCode:u})}},{label:(0,G.jsx)(y.FormattedMessage,{id:"externalObjectInstanceBlockErrorDropdown.dialogItem.copyDebugData",defaultMessage:"Copy debugging information"}),color:void 0,onAccept:()=>{const e={statusCode:u,integrationId:S.id,botIds:_,url:w,debugMessage:g};O.RD({environment:x,stringValue:JSON.stringify(e,null,2),copiedMessage:K.copiedDebuggingInfo})}}],showCancel:!0,keepFocus:!1,message:p})}}];return C&&("error"===t.type?Y.push(B):("placeholder"===t.type?Y.push(B):Y.push(E),(M||P&&[c.f3,c.mQ].includes(S.id))&&Y.push($))),d&&Y.push(D),(0,G.jsx)(z.Z,{...A,children:(0,G.jsx)(W.Z,{type:W.i.Vertical,initialFocus:h?void 0:0,sections:[{key:0,render:e=>(0,G.jsx)(H.Z,{...e,disableDesktopPadding:h,title:(0,G.jsx)(y.FormattedMessage,{defaultMessage:"Try these options",id:"unfurling.errorOptions.menuTitle"})}),items:Y}]})})}class Y extends r.Z{constructor(){super(...arguments),this.renderComponent=()=>{var e,t;const o=this.stateStore.state;if(!o)return;const{integration:n,action:r}=o,{r:i,g:a,b:l}=n.accentColor,c=`rgba(${i},${a},${l},${this.isInDarkMode()?.6:1})`,d=Boolean(null===(e=T.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit()),p=T.default.state.currentSpaceStore&&this.environment.currentUser.id&&(0,h.wv)({permissions:T.default.state.currentSpaceStore.getPermissionItems()},this.environment.currentUser.id)||(0,h.hU)({spaceBotSettings:null===(t=T.default.state.currentSpaceStore)||void 0===t?void 0:t.getBotSettingsStore().getValue(),integrationId:n.id,env:"production"}),u={state:o,store:this.props.store,onUpdate:()=>{this.handleUpdateClick({from:"external_object_instance_block_error_dropdown"})},onAuthenticate:()=>{this.handleAuthenticateClick({from:"external_object_instance_block_error_dropdown"})},onReplace:()=>{var e,t;null===(e=(t=this.props).openPlaceholderMenu)||void 0===e||e.call(t)}},m={...u,onRemove:()=>{this.handleRemove()}};return(0,G.jsxs)(G.Fragment,{children:["authenticate"===r&&(0,k.sw)(this.environment)&&d&&p&&(0,G.jsx)(E.Z,{icon:e=>(0,G.jsx)(R.Z,{type:"image_url",imageURL:n.accentIcon,size:20,style:{...e,width:16,height:16,marginRight:8,marginLeft:2}}),onClick:()=>this.handleAuthenticateClick({from:"external_object_instance_block"}),style:{...this.getActionButtonStyle(),background:c,fontSize:14,height:32,paddingRight:12,color:this.isInDarkMode()?this.theme.regularTextColor:this.theme.regularInvertedTextColor},hoveredStyle:{background:(0,s._j)(c,.4)},pressedStyle:{background:(0,s._j)(c,.9)},children:(0,G.jsx)(y.FormattedMessage,{defaultMessage:"Connect to {integration} to update",id:"unfurling.authenticateButton.title",values:{integration:o.integration.name}})}),"update"===r&&this.renderUpdateAction(),"error"===r&&(this.props.isHoverPreview?(0,G.jsx)(X,{...u}):(0,G.jsx)(J,{...m,style:this.getActionButtonStyle()})),!r&&this.props.renderDefaultAction?this.renderDefaultAction():null]})},this.handleAuthenticateClick=e=>{var t,o,n,r;let{from:i}=e;const a=null===(t=this.stateStore.state)||void 0===t?void 0:t.originalUrl,{currentSpaceStore:s}=T.default.state;if(!s)return;const l=null===(o=(0,x.GQ)(a,s.id))||void 0===o?void 0:o.integration;l&&a&&(b.hM({environment:this.environment,integration:l,spaceId:s.id,unfurlUrl:a,externalObjectInstanceBlockId:this.props.store.id,from:i}),A.Z.reset(),null===(n=(r=this.props).postActionCallback)||void 0===n||n.call(r))},this.handleUpdateClick=e=>{var t,o,n;let{from:r}=e;const i=null===(t=T.default.state.currentSpaceStore)||void 0===t?void 0:t.id;i&&(w.qK({environment:this.environment,from:r,store:this.props.store,spaceId:i,bypassCache:"external_object_instance_block_error_dropdown"===r}),null===(o=(n=this.props).postActionCallback)||void 0===o||o.call(n))},this.stateStore=this.createComputedStore((()=>(0,x._l)({store:this.props.store,isInDarkMode:this.isInDarkMode(),canEdit:this.props.canEdit,currentUserId:this.environment.currentUser.id,showAction:this.props.forceActionForUIDoc})),!0)}renderDefaultAction(){const e=this.environment,{isMobile:t}=e.device;return(0,G.jsx)(B.ZP,{popupType:t?B.Z4.SlideUp:B.Z4.Popup,renderOrigin:e=>(0,G.jsx)(D.Z,{...e,mobileFeedback:t,style:{display:"flex",alignItems:"center",justifyContent:"center",width:t?36:28,height:t?36:28,borderRadius:4,flexShrink:0,opacity:"shown"===this.props.renderDefaultAction?1:0,...this.getActionButtonStyle()},children:(0,p.o)({width:t?18:14,color:this.theme.mediumIconColor})}),placementToOrigin:P.Iw.Bottom,render:e=>(0,G.jsx)(C.LazyExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,G.jsx)(y.FormattedMessage,{id:"linkPreview.reload",defaultMessage:"Reload preview"}),store:this.props.store,onAccept:()=>e.close(),extraSecondaryItemKey:"preview_to_mention"})})}renderUpdateAction(){const e=(0,G.jsx)(E.Z,{onClick:()=>this.handleUpdateClick({from:"external_object_instance_block"}),style:this.getActionButtonStyle(),icon:e=>(0,m.b)({...e}),children:(0,G.jsx)(y.FormattedMessage,{defaultMessage:"Update",id:"unfurling.updateButton.title"})});return this.props.isHoverPreview?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:f.Z.fontSize.UIRegular.desktop,marginBottom:4},children:[(0,u.D)({width:18,height:18,marginRight:6}),(0,G.jsx)("span",{children:(0,G.jsx)(y.FormattedMessage,{defaultMessage:"This link preview is out-of-date.",id:"unfurling.updateButton.header"})})]}),e]}):e}handleRemove(){var e,t;_.createAndCommit({userAction:"ExternalObjectInstanceAction.handleRemove",environment:this.environment,perform:e=>{S.Cl({environment:this.environment,blocks:[this.props.store],transaction:e})}});const o=this.stateStore.state;var n;o&&v.oQL(this.environment,{integrationId:o.integration.id,entity:null===(n=o.pattern)||void 0===n?void 0:n.name});null===(e=(t=this.props).postActionCallback)||void 0===e||e.call(t)}isInDarkMode(){return"dark"===this.environment.ThemeStore.state.mode}getActionButtonStyle(){return{marginRight:4,color:this.theme.mediumTextColor,...this.props.buttonStyle}}}function Q(e){const t=(0,i.VK)((()=>{var t;return e.isCollectionView()?null===(t=e.getCollectionViewCollectionStore())||void 0===t||null===(t=t.getFormat().error)||void 0===t?void 0:t.status_code:e.getFormatStore().getKeyStore("error").getKeyStore("status_code").getValue()}),[e]),o=(0,i.VK)((()=>{let t;var o;e.isCollectionView()?t=null===(o=e.getCollectionViewCollectionStore())||void 0===o?void 0:o.getFormat().bot_id:t=e.getFormat().bot_id;const n=M.Z.bots.state.find((e=>e.id===t));if(n)return(0,c.s9)(n.integration_id)}),[e]),{message:r,description:a}=n.useMemo((()=>(0,k.xt)(t,o)),[t,o]);return{statusCode:t,message:r,description:a}}function J(e){window.__c={n:"ErrorPopupButton"};const{onAuthenticate:t,onReplace:o,onUpdate:n,state:r,store:i,onRemove:s,style:c}=e,p=(0,a.yK)((e=>({orangeThemeColor:(0,l.fi)("orange",e),dropdownIcon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),{statusCode:u,message:m,description:h}=Q(i);return(0,G.jsx)(B.ZP,{popupType:B.Z4.Popup,originGap:4,renderOrigin:e=>(0,G.jsxs)(E.Z,{style:c,icon:e=>(0,g.t)({...e,fill:p.orangeThemeColor.fill}),...e,children:[(0,G.jsx)("span",{children:I.default.formatMessage(m)}),(0,d.i)(p.dropdownIcon)]}),render:e=>(0,G.jsx)($,{state:r,store:i,onUpdate:n?()=>{n(),e.close()}:void 0,onAuthenticate:t?()=>{t(),e.close()}:void 0,onReplace:()=>{o(),e.close()},onRemove:s?()=>{s(),e.close()}:void 0,statusCode:u,errorDescription:h.description,description:I.default.formatMessage(h,{integrationName:r.integration.name,statusCode:u})})})}function X(e){window.__c={n:"ErrorInlineMenu"};const{onAuthenticate:t,onReplace:o,onUpdate:n,state:r,store:i,onRemove:s}=e,c=(0,a.yK)((e=>({orangeThemeColor:(0,l.fi)("orange",e)})),[]),{statusCode:d,message:p,description:u}=Q(i);return(0,G.jsxs)("div",{style:{alignSelf:"stretch"},children:[(0,G.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:f.Z.fontSize.UIRegular.desktop,fontWeight:f.Z.fontWeight.medium,marginBottom:4},children:[(0,g.t)({width:18,height:18,marginRight:6,fill:c.orangeThemeColor.fill}),(0,G.jsx)("span",{children:I.default.formatMessage(p)})]}),(0,G.jsx)("div",{style:{margin:"0 -14px"},children:(0,G.jsx)($,{state:r,store:i,onUpdate:n,onAuthenticate:t,onReplace:o,onRemove:s,statusCode:d,errorDescription:u.description,description:I.default.formatMessage(u,{integrationName:r.integration.name,statusCode:d}),isInlineMenu:!0})})]})}Y.displayName="ExternalObjectInstanceAction";const ee=Y},14562:(e,t,o)=>{o.d(t,{Z:()=>M});var n=o(67294),r=o(8848),i=o(76725),a=o(72126),s=o(97880),l=o(82990),c=o(44876),d=o(61202),p=o(41232),u=o(6398),m=o(68859),g=o(49085);class h extends g.default{getInitialState(){return{error:!1,loading:!1}}}const f=h;var y=o(2834),v=o(68709),b=o(51077),S=o(12981),_=o(84076),w=o(68785),k=o(81865),x=o(69278),I=o(19987),C=o(85893);class T extends y.Z{constructor(){super(...arguments),this.origin=n.createRef(),this.storeTypes={externalObjectTokenStore:f,blockResizerStore:m.Z},this.state={isHovered:!1},this.renderSubheaderIconAttribute=e=>{if((0,c.li)(e)){const t=e.values[0];return(0,C.jsx)(k.Z,{isAuthenticated:!1,url:t,width:32,render:(e,t)=>(0,C.jsx)(S.Z,{src:t,height:12,placeholderLoadedStyle:{width:12,height:12,marginRight:4}})})}if((0,c.hW)(e)){const t=e.values[0],o=t?`rgb(${t.r},${t.g},${t.b})`:"gray",{colorName:n,shade:i}=(0,r.lL)(o);return(0,C.jsx)("div",{style:{width:12,height:12,marginRight:4,background:this.theme.accentColors[n][i],borderRadius:4}})}},this.renderSubheaderAttribute=e=>(0,C.jsx)(u.ox,{...e,store:this.props.store}),this.stateStore=this.createComputedStore((()=>(0,p._l)({store:this.props.store,isInDarkMode:this.isInDarkMode(),canEdit:this.canEdit(),currentUserId:this.environment.currentUser.id,showAction:this.props.forceActionForUIDoc})),!0),this.handleMouseEnter=()=>{this.setState({isHovered:!0})},this.handleMouseLeave=()=>{this.setState({isHovered:!1})}}renderPersisted(){const e=this.stateStore.state;if(!e)return this.renderShimmerState();const t=(0,p.y6)(this.props.store);if("error"===e.type&&(null==t||!t.integration_id))return this.renderShimmerState();const{renderConfig:o}=e;return(0,C.jsx)(v.p,{allowSelectionWithin:!0,children:o.previewAttributes&&(0,s.Of)(o.previewAttributes)?this.renderEmbedPreview({attributes:o.previewAttributes,state:e}):this.renderLinkBox(e)})}renderLinkBox(e){var t;const{originalUrl:o,renderConfig:n,integration:r,updating:a}=e,{store:l}=this.props,c="placeholder"===e.type,d="error"===e.type,m=this.state.isHovered||this.environment.device.isMobile,g=o&&(0,p.pI)(o,l.pointer.spaceId);return(0,C.jsxs)(_.Z,{ref:this.origin,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,style:{flexGrow:1,minWidth:0,...(c||d)&&{background:this.theme.embedPlaceholderBackground}},innerStyle:this.getStyle({hasPreview:!(!Boolean(n.previewAttributes)||!n.previewAttributes)&&(0,s.Of)(n.previewAttributes)}),...c||d?{onClick:()=>{const e=this.getPlaceholderNode();e&&this.openLinkEmbedMenu(e)}}:{href:g,external:!0},children:[(0,C.jsx)("div",{style:{display:"flex",alignSelf:"start",height:32,width:32,marginRight:12,marginLeft:4,marginTop:3,marginBottom:3,position:"relative"},children:this.renderBlockIcon(n,r.icon)}),(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",flexGrow:1,flexShrink:1,overflow:"hidden"},children:[(0,C.jsxs)("div",{style:{display:"flex",alignItems:"baseline",fontSize:14},children:[(0,i.Z)((null===(t=n.headerAttributes)||void 0===t?void 0:t.map(((e,t)=>(0,C.jsx)(u.ox,{...e,store:this.props.store,style:0===t?this.getTitleStyle():{}},`attribute-${t}`))))||[],(e=>(0,C.jsx)("span",{style:{marginRight:6}},`spacer-${e}`))),(a||this.stores.externalObjectTokenStore.state.loading)&&(0,C.jsx)(w.Z,{style:{marginLeft:6}})]}),n.bodyAttribute&&(0,C.jsx)(u.hx,{attribute:n.bodyAttribute}),(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center",color:this.theme.mediumTextColor,fontSize:12},children:[n.subheaderIcon&&this.renderSubheaderIconAttribute(n.subheaderIcon),n.subheaderAttributes&&(0,i.Z)(n.subheaderAttributes.map(this.renderSubheaderAttribute),(e=>(0,C.jsx)("span",{style:{marginLeft:3,marginRight:3},children:"â€¢"},e)))]})]}),(0,C.jsx)(I.Z,{canEdit:this.canEdit(),forceActionForUIDoc:this.props.forceActionForUIDoc,store:this.props.store,renderDefaultAction:m?"shown":"invisible",buttonStyle:n.bodyAttribute?{alignSelf:"flex-start",marginTop:4}:{},openPlaceholderMenu:()=>{const e=this.getPlaceholderNode();e&&this.openLinkEmbedMenu(e)}})]})}renderShimmerState(){var e;return(0,C.jsxs)(_.Z,{href:null===(e=this.stateStore.state)||void 0===e?void 0:e.originalUrl,external:!0,style:{flexGrow:1,minWidth:0},innerStyle:this.getStyle(),children:[this.renderShimmerbox({width:38,height:38}),(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexGrow:1},children:[this.renderShimmerbox({width:"50%",height:14,margin:4}),this.renderShimmerbox({width:"40%",height:12,margin:4})]})]})}renderBlockIcon(e,t){const o=a.mN(e.icons||[],(e=>`${e.type}:${e.values[0].toString()}`));return o.length>=2?(0,C.jsxs)("div",{style:{width:32,height:32},children:[(0,C.jsx)(u.lf,{attribute:o[0],isSmall:!0}),(0,C.jsx)(u.lf,{attribute:o[1],isSmall:!0,style:{position:"absolute",bottom:0,right:2}}),(0,C.jsx)(b.Z,{type:"image_url",imageURL:t,size:16,style:{position:"absolute",bottom:-3,right:-3},imageStyle:this.getAvatarSubIconStyle()})]}):1===o.length?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(u.lf,{attribute:o[0],isSmall:!1}),(0,C.jsx)(b.Z,{type:"image_url",imageURL:t,size:16,style:{position:"absolute",bottom:-2,right:-2},imageStyle:this.getAvatarSubIconStyle()})]}):(0,C.jsx)(b.Z,{type:"image_url",imageURL:t,size:38})}renderEmbedPreview(e){const{attributes:t}=e,o=t[0],{values:n,mimeType:r}=o,i=n[0];let a;"image/*"===r?a="image":"audio/*"===r?a="audio":"video/*"===r?a="video":"application/pdf"===r?a="pdf":"text/html"===r?a="embed":(0,s.t1)(r);const l="image"===a||"pdf"===a||"embed"===a,c=this.props.store;return c.isExternalObjectInstanceBlockStore()?(0,C.jsx)("div",{style:{overflow:"hidden",borderRadius:6,border:`1px solid ${this.theme.tableDividerColor}`,borderBottom:void 0,position:"relative"},children:(0,C.jsx)(x.Z,{store:c,source:i,showExpandButton:l,mediaType:a,...(0,p.Xg)()?{disabled:!1,preserveScale:"image"===a,blockResizerStore:this.stores.blockResizerStore}:{disabled:!0,preserveScale:!0,disableActions:!0,..."image"===a&&{centerWrappedContent:!0}},contentBelowSource:this.renderLinkBox(e.state)})}):void 0}renderShimmerbox(e){return(0,C.jsx)("div",{style:{overflow:"hidden",position:"relative",background:this.theme.selectLightGray[30],...e},children:(0,C.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",zIndex:1,animation:"shimmer 1s infinite",background:`linear-gradient(to right, ${this.theme.selectLightGray[30]} 0%, ${this.theme.selectLightGray[50]} 20%, ${this.theme.selectLightGray[30]} 40%, ${this.theme.selectLightGray[30]} 100%)`}})})}isInDarkMode(){return"dark"===this.environment.ThemeStore.state.mode}handleCreated(){const e=this.getPlaceholderNode();e&&this.openLinkEmbedMenu(e)}getPlaceholderNode(){var e,t;if("placeholder"===(null===(e=this.stateStore.state)||void 0===e?void 0:e.type)||"error"===(null===(t=this.stateStore.state)||void 0===t?void 0:t.type)){const e=this.origin.current;if(e&&e instanceof Element)return e}}openLinkEmbedMenu(e){var t;const o=(0,p.y6)(this.props.store);d.os({originRect:e.getBoundingClientRect(),environment:this.environment,externalObjectInstanceBlockStore:this.props.store,placeholderIntegrationId:null==o?void 0:o.integration_id,integration:null===(t=this.stateStore.state)||void 0===t?void 0:t.integration,externalObjectTokenStore:this.stores.externalObjectTokenStore})}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hasPreview:t}=e;return{display:"flex",alignItems:"center",border:`1px solid ${this.theme.tableDividerColor}`,borderRadius:t?"0px 0px 4px 4px":4,borderLeft:t?"none":`1px solid ${this.theme.tableDividerColor}`,borderRight:t?"none":`1px solid ${this.theme.tableDividerColor}`,padding:"8px 12px",...this.getBlockColorStyle(),...this.props.style}}getAvatarSubIconStyle(){return{filter:`\n\t\t\t\tdrop-shadow(0px 0px 1px ${this.theme.contentBackground})\n\t\t\t\tdrop-shadow(0px 0px 1px ${this.theme.contentBackground})\n\t\t\t\tdrop-shadow(0px 0px 1px ${this.theme.contentBackground})\n\t\t\t`}}getTitleStyle(){return{fontWeight:l.Z.fontWeight.medium,...l.Z.textOverflowStyle,color:this.theme.regularTextColor}}}const M=T},69721:(e,t,o)=>{o.d(t,{S:()=>R,Z:()=>E});o(67294);var n=o(73935),r=o(53150),i=o(49271),a=o(43593),s=o(50066),l=o(72126),c=o(70203),d=o(82990),p=o(5366),u=o(50906),m=o(31781),g=o(62365),h=o(27153),f=o(24677),y=o(98104),v=o(39699),b=o(33929),S=o(27411),_=o(31792),w=o(2834),k=o(13966),x=o(91893),I=o(23864),C=o(64921),T=o(64369),M=o(86329),P=o(78454),A=o(85893);const D=(0,p.defineMessages)({fileTitle:{defaultMessage:"File",id:"fileBlock.fileTab.title"},embedButtonText:{defaultMessage:"Embed link",id:"fileBlock.embedButton.label"},embedFilePrompt:{defaultMessage:"Paste a file linkâ€¦",id:"fileBlock.linkPrompt.placeholder"},embedCaption:{defaultMessage:"Works with links of PDFs, Google Drive, Google Maps, CodePenâ€¦",id:"fileBlock.linkPrompt.caption"}});class B extends w.Z{constructor(){super(...arguments),this.captionAriaId=(0,r.Z)(),this.caption=()=>{this.handleEditCaption()},this.storeTypes={mouseStore:_.Z},this.handleEditCaption=()=>{const e=this.props.store.getPropertyStore("caption");f.eP({environment:this.environment,store:this.props.store}),y.NX({store:e})},this.handleOpenMenu=()=>{const{device:e}=this.environment;if(this.canEdit()){const t=n.findDOMNode(this);if(t&&t instanceof Element){const o=t.getBoundingClientRect();h.$(this.environment,{originRect:o,originGap:0,isSmallWidth:!0,showArrow:!0,title:b.default.formatMessage(D.fileTitle),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:e.isAndroid,videoUpload:e.isAndroid,onUpload:this.handleUpload},{type:"embed",buttonText:b.default.formatMessage(D.embedButtonText),inputPlaceholder:b.default.formatMessage(D.embedFilePrompt),caption:b.default.formatMessage(D.embedCaption),onChange:e=>{h.Z(),v.createAndCommit({userAction:"FileBlock.handleOpenMenu",environment:this.environment,perform:t=>{g.v({store:this.props.store,source:e,name:void 0,size:void 0,transaction:t})}}),u.bOx(this.environment,{pastedText:e,source:"file_block_menu"})}}]})}}},this.handleMouseEnter=e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.handleClick=()=>{m.qL(this.environment,{store:this.props.store,from:"embedded_block_click"})},this.handleUpload=e=>{const{store:t}=this.props;v.createAndCommit({userAction:"FileBlock.handleUpload",environment:this.environment,perform:e=>{g.v({store:this.props.store,source:void 0,name:void 0,size:void 0,transaction:e})}}),g.c({environment:this.environment,store:t,file:e})},this.fileUploadStore=this.createComputedStore((()=>S.default.getKeyState(S.default.getBlockKey(this.props.store.id))))}handleCreated(){this.edit()}edit(){this.handleOpenMenu()}activate(){this.handleOpenMenu()}replace(){this.handleOpenMenu()}renderPersisted(){const e=this.getSource();return e?this.renderFile(e):this.renderUploader()}renderFile(e){const{device:t}=this.environment,o=this.props.store.getProperties(),n=c.Jcv(o&&o.title),r=c.Jcv(o&&o.size),i=(this.stores.mouseStore.state.mouseEntered||t.isMobile)&&this.canEdit()&&(0,A.jsx)(k.Z,{style:{marginRight:4},store:this.props.store,fadeIn:!0});return(0,A.jsxs)("div",{role:"figure","aria-labelledby":this.captionAriaId,children:[(0,A.jsxs)("div",{onMouseMove:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,style:{display:"flex"},children:[(0,A.jsx)(R,{title:n,url:e,size:r,onClick:this.handleClick,right:i,style:this.getStyle()}),(0,A.jsx)(I.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}),(0,A.jsx)(x.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]})}renderUploader(){const{device:e}=this.environment,{disabled:t}=this.props,o=this.fileUploadStore.state,n=e.isMobile||this.stores.mouseStore.state.mouseEntered;return(0,A.jsxs)("div",{onMouseMove:()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),onMouseLeave:()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1}),style:{display:"flex"},children:[(0,A.jsx)(M.Z,{disabled:t,iconSvg:s.R,shouldHideRight:!n,right:this.canEdit()&&(0,A.jsx)(k.Z,{store:this.props.store,fadeIn:!1}),isLoading:Boolean(o),progressPercent:o?o.progressPercent:0,file:o?o.file:void 0,name:o?o.name:void 0,size:o?o.size:void 0,onClick:this.handleOpenMenu,children:(0,A.jsx)(p.FormattedMessage,{defaultMessage:"Upload or embed a file",id:"fileBlock.uploadOrEmbed.placeholder"})}),(0,A.jsx)(I.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}getSource(){const e=this.props.store.getProperties(),t=e&&e.source,o=c.QaF(t),{display_source:n}=this.props.store.getFormat();return n||o}getStyle(){return{flexGrow:1,minWidth:0,borderRadius:4,...l.CE(this.getBlockColorStyle(),["fontSize","lineHeight"])}}}function R(e){const{style:t,right:o,title:n,url:r,size:l,onClick:c}=e,p={paddingTop:i.ZD.paddingTop,paddingBottom:i.ZD.paddingBottom,paddingLeft:i.ZD.paddingLeft};return(0,A.jsx)(C.Z,{style:t,onClick:c,children:(0,A.jsx)(P.ZP,{style:p,left:(0,s.R)(),leftStyle:{width:"1.35em",height:"1.35em"},alignment:P.v2.Center,right:o,children:(0,A.jsxs)("div",{style:{display:"flex",alignItems:"baseline"},children:[(0,A.jsx)("div",{style:{...d.Z.textOverflowStyle},children:a.rF({title:n,source:r})}),l&&(0,A.jsx)(T.Z,{isSmall:!0,style:{marginLeft:6,whiteSpace:"nowrap"},children:l})]})})})}const E=B},65453:(e,t,o)=>{o.d(t,{Z:()=>h});o(67294);var n=o(49271),r=o(76490),i=o(5366),a=o(33929),s=o(35328),l=o(2834),c=o(23864),d=o(65187),p=o(17377),u=o(85893);const m=(0,i.defineMessages)({placeholder:{defaultMessage:"Heading 1",id:"header1Block.placeholder"}});class g extends l.Z{constructor(){super(...arguments),this.getHeaderTextStyle=()=>{const{device:e}=this.environment,t=this.rootStorePageFont.state,o=e.isMobile?1.5:r.eV;return(0,r.DK)({fontSizeValue:o,fontFamily:t})}}activate(){s.th(this)}renderPersisted(){const{disabled:e}=this.props;return(0,u.jsx)("div",{style:this.getStyle(),children:(0,u.jsxs)(p.Z,{blockComponent:this,toggleStyle:this.getToggleStyle(),childrenStyleWhenToggleable:{display:"flex"},children:[(0,u.jsx)(d.Z,{tagName:"h2",disabled:e,store:this.props.store.getBlockTitleStore(),placeholder:a.default.formatMessage(m.placeholder),placeholderStyle:{WebkitTextFillColor:this.theme.headerBlockPlaceholderTextColor},style:{...n.ZD,...this.getHeaderTextStyle()},pasteBehavior:"block",legacyTransclusionParent:this.props.legacyTransclusionParent}),(0,u.jsx)(c.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})})}getStyle(){return{display:"flex",width:"100%",...this.getBlockColorStyle(),...this.props.style}}getToggleStyle(){const{device:e}=this.environment;return{height:`${(e.isMobile?1.5:r.eV)*r.u9}em`,marginTop:3}}}const h=g},83182:(e,t,o)=>{o.d(t,{Z:()=>p});o(67294);var n=o(83355),r=o(84169),i=o(50906),a=o(87279),s=o(52275),l=o(16354),c=o(85893);class d extends n.Z{renderComponent(){return(0,c.jsx)(l.Z,{href:this.props.href,external:!0,onClick:()=>i.Fsx(this.environment,{from:this.props.analyticsFrom}),children:(0,c.jsx)(s.Z,{icon:!this.props.left&&this.renderIcon(),title:this.renderTitle(),focused:!1})})}renderIcon(){const{device:e}=this.environment;return(0,r.m)({width:e.isPhone?16:14,fill:this.theme.lightIconColor,marginRight:this.props.left?6:0})}renderTitle(){const{left:e}=this.props;return e?(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("span",{style:{...this.getTitleStyle(),marginRight:"auto"},children:this.props.left}),this.renderIcon(),(0,c.jsx)("span",{style:this.getTitleStyle(),children:this.props.title})]}):(0,c.jsx)("span",{style:this.getTitleStyle(),children:this.props.title})}getTitleStyle(){const{device:e}=this.environment;return{fontSize:e.isPhone?14:12,verticalAlign:1,color:this.theme.lightTextColor}}}d.displayName="HelpButtonMenuItem",d.contextTypes={...a.mw,...n.w};const p=d},74523:(e,t,o)=>{o.d(t,{Z:()=>m});var n=o(67294),r=o(480),i=o(24405),a=o(84169),s=o(50906),l=o(73063),c=o(16354),d=o(89728),p=o(85893);function u(e){let{title:t,href:o,analyticsFrom:u,shouldShrink:m,style:g,buttonStyle:h,isBlue:f,onClick:y,onFocus:v,onBlur:b,onMouseDown:S,onMouseEnter:_,onMouseLeave:w}=e;window.__c={n:"HelpButtonSettingsCaption"};const k=(0,r.O7)(),x={onFocus:v,onBlur:b,onMouseDown:S,onMouseEnter:_,onMouseLeave:w},I=(0,n.useCallback)((()=>{void 0!==y&&y(),s.Fsx(k,{from:u})}),[u,k,y]),C=(0,i.yK)((()=>({link:{display:"flex",marginLeft:-6,...g}})),[g]);return(0,p.jsx)(c.Z,{style:C.link,className:"notion-print-ignore",href:o,external:!0,onClick:I,...x,children:t?(0,p.jsx)(d.Z,{icon:a.m,isSmall:!0,isBlue:f,isLightGray:!f,shouldShrink:m,style:h,children:t}):(0,p.jsx)(l.Z,{icon:a.m,isBlue:f,style:h,...x})})}const m=n.memo(u)},84456:(e,t,o)=>{o.d(t,{Z:()=>_});var n=o(67294),r=o(83355),i=o(480),a=o(88464),s=o(64002),l=o(26198),c=o(12534),d=o(55367),p=o(80796),u=o(77080),m=o(49085);class g extends m.default{getInitialState(){return{disabled:!1,loaded:!1,hasPreviewBeenDismissed:!1,isVisible:!1}}}const h=g;var f=o(69784),y=o(25777),v=o(85893);class b extends r.Z{constructor(){super(...arguments),this.iframe=null,this.storeTypes={iframeStore:h},this.handleMouseMove=e=>{const t=d.ZP.state.isDragging,o=p.Z.state.isDragging,n=f.Z.state.isActive,r=t||o||n;this.stores.iframeStore.setState({...this.stores.iframeStore.state,disabled:r})},this.releaseFocus=()=>{document.activeElement&&document.activeElement===this.iframe&&document.activeElement.blur()},this.getSanitizedSource=()=>{let e=s.yn(this.props.source);if(e||this.props.source.includes(":")||(e=s.yn(`https:${this.props.source}`)),e&&new URL(e).origin!==location.origin)return e},this.handlePreviewMouseDown=e=>{e.preventDefault(),(0,c.ZP)({event:e,context:c.Af.EditorClick,callback:()=>{this.stores.iframeStore.setState({...this.stores.iframeStore.state,hasPreviewBeenDismissed:!0})}})}}didMountOrUpdate(){super.didMountOrUpdate(),this.releaseFocus()}renderComponent(){return(0,v.jsx)("div",{style:this.props.style,onMouseMove:this.handleMouseMove,onMouseEnter:this.handleMouseMove,onMouseLeave:this.releaseFocus,children:(0,v.jsx)("div",{style:this.getAspectRatioContainerStyle(),children:this.renderInnerContent()})})}renderInnerContent(){if(this.shouldRenderPreview())return this.renderPreview();const e=this.getSanitizedSource(),t=this.getIframeStyle();return(0,v.jsx)(y.Z,{innerStyle:{height:"100%",width:"100%"},loaded:this.stores.iframeStore.state.loaded,style:b.aspectRatioInnerStyle,spinnerSize:"1em",showSpinnerTimeout:500,children:e&&(0,v.jsx)(S,{ref:e=>{this.iframe=e},sourceUrl:e,wrapperStyle:{...t,backgroundColor:"none"},style:this.getIframeStyle(),allow:this.props.allow,iframeStore:this.stores.iframeStore,onContentLoadTimeout:this.props.onContentLoadTimeout})})}renderPreview(){var e,t;return(0,v.jsx)("div",{style:{...this.getIframeStyle(),backgroundColor:"none"},onMouseDown:this.handlePreviewMouseDown,children:null===(e=(t=this.props).renderPreview)||void 0===e?void 0:e.call(t)})}willUnmount(){super.willUnmount()}shouldRenderPreview(){return!(!window.__webViewTerminatedWhileAppActive&&"on"!==u.default.getGroup("embed-previews"))&&(!this.stores.iframeStore.state.hasPreviewBeenDismissed&&Boolean(this.props.renderPreview))}getAspectRatioContainerStyle(){const{height:e,isFullWidth:t,isFullHeight:o,aspectRatio:n,preserveScale:r}=this.props,i={position:"relative",display:"flex",justifyContent:"center",width:"100%",minHeight:100};return o?(i.height="100%",i.position=void 0):t||!r?i.height=e:(i.height=0,i.paddingBottom=100*(n||.75)+"%"),i}getIframeStyle(){return{...b.aspectRatioInnerStyle,pointerEvents:this.stores.iframeStore.state.disabled?"none":"auto",backgroundColor:this.props.background?this.theme.contentBackground:"none"}}}b.displayName="IFrameBox",b.aspectRatioInnerStyle={position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:1};const S=n.forwardRef((function(e,t){window.__c={n:"ManagedIFrame"};const{sourceUrl:o,style:r,allow:s,iframeStore:c,onContentLoadTimeout:d,wrapperStyle:p}=e,m=(0,i.O7)(),[g,h]=(0,l.jo)(),f=(0,n.useRef)(void 0),y=(0,a.Z)(t,f),b=(0,n.useRef)(void 0),S=m.device.isElectron?"allow-scripts allow-popups allow-forms allow-same-origin":"allow-scripts allow-popups allow-top-navigation-by-user-activation allow-forms allow-same-origin allow-storage-access-by-user-activation",_=(0,n.useCallback)((()=>{if(u.default.checkGate("embed_block_fallback")){var e;f.current&&(f.current.contentDocument||(null===(e=f.current.contentWindow)||void 0===e?void 0:e.document))||null==d||d()}}),[d]),w=(0,n.useCallback)((()=>{c.setState({...c.state,loaded:!0}),_()}),[_,c]);return(0,n.useEffect)((()=>(b.current=setTimeout(_,7e3),()=>{clearTimeout(b.current)})),[_]),(0,v.jsx)("div",{ref:g,style:p,children:h&&(0,v.jsx)("iframe",{ref:y,style:r,src:o,frameBorder:"0",onLoad:()=>{clearTimeout(b.current),w()},sandbox:S,allowFullScreen:!0,allow:s})})})),_=b},42402:(e,t,o)=>{o.d(t,{Z:()=>a});o(67294);var n=o(8848),r=o(16354),i=o(85893);const a=function(e){const t={display:"inline",textDecoration:"underline",color:n.ZP.inherit};return(0,i.jsx)(r.Z,{href:e.href,external:e.external,style:{...t,...e.style,...e.disableUnderline&&{textDecoration:"none"}},onClick:e.onClick,className:e.disableHover?void 0:e.showAIVersion?"notion-link-ai-version":"notion-link",onMouseDown:e.onMouseDown,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,children:e.children})}},83785:(e,t,o)=>{o.d(t,{Z:()=>h});o(67294);var n=o(83355),r=o(68626),i=o(91155),a=o(29477),s=o(88632),l=o(49085);class c extends l.default{getInitialState(){return{loaded:!1}}}const d=c;var p=o(68785),u=o(33411),m=o(85893);class g extends n.Z{constructor(){super(...arguments),this.storeTypes={store:d}}didMount(){this.fetch()}renderComponent(){return(0,m.jsx)(u.Z,{show:!this.stores.store.state.loaded,showDelay:300,showHold:0,render:e=>this.stores.store.state.loaded?(this.props.willRender&&this.props.willRender(),this.props.render(this.stores.store.state.result)):this.props.loading?this.props.loading(e):e?(0,m.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,m.jsx)(p.Z,{})}):void 0})}async fetch(){let e=1e3;for(;;)try{const e=await this.props.fetch();this.stores.store.setState({loaded:!0,result:e});break}catch(t){r.log({level:"warning",from:"LazyLoader",type:"fetchError",error:(0,i.Ui)(t),data:{miscDataToConvertToString:{waitMs:e}}}),await a.Vs(e),await s.Z.waitUntil((()=>s.Z.state.online)),e=Math.min(2*e,3e4)}}}g.displayName="LazyLoader";const h=g},55217:(e,t,o)=>{o.d(t,{Z:()=>ne});o(57658);var n,r=o(67294),i=o(83355),a=o(27531),s=o(41432),l=o(72126),c=o(4615),d=o(21202),p=o(13084),u=o(39699),m=o(98165),g=o(67669),h=o(23883),f=o(35661),y=o(99757),v=o(45697),b=o.n(v),S=o(45060),_=o(95538),w=o(606),k=o(18844),x=o(15047),I=o(50906),C=o(94419),T=o(1742),M=o(92650),P=o(19037),A=o(28020),D=o(78316),B=o(78175),R=o(41232),E=o(78429),F=o(17504),N=o(65598),j=o(73959),O=o(35328),L=o(24646),U=o(41662),Z=o(68859),V=o(4926),q=o(77080),z=o(88923),W=o(26664),H=o(27724),G=o(45131),K=o(24927),$=o(53223),Y=o(23063),Q=o(45952),J=o(79954),X=o(85893);class ee extends i.Z{constructor(){super(...arguments),this.blockRef=r.createRef(),this.storeTypes={blockResizerStore:Z.Z},this.renderPreventSidebar=()=>{const{isInlineCollectionView:e}=this.renderStateStore.state;return e?this.renderSelectable():(0,F.Z)(this.renderSelectable)},this.renderSelectable=e=>{const{store:t,canEditList:o,isFirstItem:n}=this.props,{canDropOnto:r,canDropLeftRight:i,shouldShowParentHalo:a,showHoverMenu:s,canDrag:l,canSelect:c,shouldShowSelectionHalo:d,isSimpleTable:p,showCommentMenu:u,preventBackgroundDrag:m,shouldDisableHoverMenuDrag:g,disableForceTouch:h,canTriggerContextMenu:f}=this.renderStateStore.state;return(0,X.jsx)(J.Z,{style:this.getStyle.state,store:t,canSelect:c,canEditText:this.canEdit(),shouldShowHalo:d,shouldShowParentHalo:a,canDrag:l,canDropAbove:o&&n,canDropBelow:o,canDropLeft:i,canDropRight:i,canDropOnto:o&&r,canNativeDropAbove:o&&n,canNativeDropBelow:o,canNativeDropLeft:i,canNativeDropRight:i,onSelectableDrop:this.handleDrop,onNativeDrop:this.handleNativeDrop,canTriggerContextMenu:f,onInsertBelow:this.handleInsertBelow,onInsertAbove:this.handleInsertAbove,canInsertAbove:o,canInsertBelow:o,onEditText:this.handleEditText,onEnter:this.handleEnter,onRemove:this.handleRemove,showBlockMenuInput:!0,shouldShowHoverMenu:s,shouldDisableHoverMenuDrag:g,disableForceTouch:h,shouldShowCommentMenu:u,shouldShowDropZone:!p,isListContainer:!0,preventBackgroundDrag:m,analyticsName:"page_content",...e,children:this.renderBlock()})},this.handleInsertAbove=e=>{const{insertStores:t,transaction:o}=e;return l.d9(t).reverse().map((e=>C.Vt({parent:this.props.listStore,insert:e,before:this.props.store,transaction:o}).child))},this.handleInsertBelow=e=>{const{insertStores:t,transaction:o}=e;return l.d9(t).reverse().map((e=>C.BE({parent:this.props.listStore,insert:e,after:this.props.store,transaction:o}).child))},this.handleDrop=e=>{const{droppedDirection:t,droppedStores:o,duplicate:n}=e;u.createAndCommit({userAction:"ListItemBlock.handleDrop",environment:this.environment,perform:e=>{p.LQ({environment:this.environment,targetParentStore:this.props.listStore,targetStore:this.props.store,droppedDirection:t,droppedStores:o,duplicate:n,transaction:e})}})},this.handleNativeDrop=e=>{const{files:t,droppedDirection:o}=e;u.createAndCommit({userAction:"ListItemBlock.handleNativeDrop",environment:this.environment,perform:e=>p.uQ({environment:this.environment,files:t,targetParentStore:this.props.listStore,targetStore:this.props.store,droppedDirection:o,transaction:e})})},this.handleEditText=e=>{p.DC({environment:this.environment,targetStore:this.props.store,targetParentStore:this.props.listStore,isAtStartOfLine:e.isAtStartOfLine,isAtStartOfContainer:e.isAtStartOfContainer,isClick:e.isClick,transaction:e.transaction})},this.handleEnter=e=>{this.blockRef.current&&this.blockRef.current.edit?this.blockRef.current.edit():p.Bm({environment:this.environment,targetStore:this.props.store,targetParentStore:this.props.listStore,isAtStartOfLine:!1,isClick:!1,transaction:e.transaction})},this.handleRemove=e=>{const{store:t}=this.props,{transaction:o}=e,n=t.getRecordStoreUIParent();n&&(n.table!==d.iU&&n.table!==x.bx&&n.table!==k.Xj||!n.valueIs(W.i)||(T.uO(this.environment,"user_flow_delete_block",o,"ListItemBlock.handleRemove"),C.Od({parent:n,childToRemove:t,transaction:o})))},this.legacyTransclusionParentStore=this.createComputedStore((()=>{if(!this.isLegacyTransclusionStore.state)return;const e=this.props.listStore.getRecordStoreAtRootPath();return(0,N.OY)(e)?e:void 0})),this.isPageFullWidth=this.createComputedStore((()=>{var e;return null===(e=this.pageContext)||void 0===e?void 0:e.pageStore.isFullWidth()})),this.canEditStore=this.createComputedStore((()=>{const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!this.props.disabled&&(!(0,g.YF)(e)&&this.props.store.canEdit())})),this.isLegacyTransclusionStore=this.createComputedStore((()=>{const e=this.props.store.getParentId();return Boolean(e&&this.props.listStore.id!==e)})),this.isReadOnlyBlockInReadWritePageStore=this.createComputedStore((()=>{const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return this.props.canEditList&&!P.OO({environment:this.environment,blocks:[this.props.store],publicEditMode:e})})),this.renderStateStore=this.createComputedStore((()=>{const{device:e}=this.environment,{store:t,canEditList:o,disableSelection:n,disableHoverMenu:r,disableCommentMenu:i}=this.props,a=t.getFormat(),l=t.getType(),{dragging:c,temporaryFullWidth:p}=this.stores.blockResizerStore.state,u=(0,K.h)(this.props.store),m=c?p:a.block_full_width,h=l===s.Ti.page||l===s.Ti.collectionViewPage||a.alias_pointer&&(0,w.$O)(a.alias_pointer,d.iU)||l&&(0,O._A)(l,a)&&!G.Z.isOpen(t.id),f=Boolean(l&&(0,s.dM)(l)),y=l===s.Ti.table,v=l===s.Ti.columnList,b=u===$.D,S=b,_=this.isRootOrDirectChild()&&!v&&!y&&o&&!e.isPhone,k=this.pageContext&&this.pageContext.publicEditModeStore.state,x=(0,g.BZ)(k),I=b&&t.getCollectionStore();let C=b;if(I){void 0===I.getKeyStore("version").getValue()&&(C=!1)}const T=!n&&t.canRead()&&!y&&!this.isReadOnlyBlockInReadWritePageStore.state&&!C,M=!x&&T&&!b&&!y,P=M,A=!(x||r||v||b||y||(l===s.Ti.transclusionContainer||l===s.Ti.transclusionReference||l===s.Ti.aiBlock)&&this.descendantIsSelected()),D=!i&&("comment_only"===t.getRole()||"comment"===(null==k?void 0:k.permission))&&!o&&!v&&!f&&this.environment.currentUser.isLoggedIn()&&!y,B=y?U.g$.getNumberOfUnresolvedComments({simpleTableStore:t,environment:this.environment,includeInline:!this.marginCommentsVisible.state}):0,R=o&&!v&&!this.props.disableDrag,E=Boolean(this.props.store.findRecordStoreUIAncestor((e=>e===z.default.peekTarget.state)).ancestor),F=l&&(0,s.OY)(l)&&!t.getProperties().source,N="drawing"===l&&(0,j.iZ)(t),L=a.block_alignment,Z=o&&!v&&!t.inMemoryRecordCache.isSyntheticAssistantData;return{type:l,isFullWidth:m,canDropOnto:h,canDropLeftRight:_,shouldShowParentHalo:P,showHoverMenu:A,canDrag:R,canSelect:T,shouldShowSelectionHalo:M,showCommentMenu:D,numSimpleTableComments:B,isInlineCollectionView:b,isSimpleTable:y,isInPeekRenderer:E,isMediaWithoutSource:F,preventBackgroundDrag:S,disableForceTouch:N,shouldDisableHoverMenuDrag:this.isReadOnlyBlockInReadWritePageStore.state,alignStyle:L,canTriggerContextMenu:Z}}),!0,"renderStateStore"),this.blockRendererStore=this.createComputedStore((()=>(0,K.h)(this.props.store))),this.appRenderState=this.createComputedStore((()=>A.h1(this.environment))),this.getStyle=this.createComputedStore((()=>{const{device:e}=this.environment,{store:t}=this.props,{type:o,isInPeekRenderer:n,isFullWidth:r,isInlineCollectionView:i,isSimpleTable:a,numSimpleTableComments:l,isMediaWithoutSource:c,alignStyle:d}=this.renderStateStore.state,p={};if(this.externalObjectStateStore.state){const e=this.externalObjectStateStore.state;p.minWidth=_.B9,"image/*"!==e&&(p.width="100%")}else p.width="100%";p.maxWidth=this.getFullWidth(),(e.isMobile&&!r||this.isInColumnList()||!this.isRootOrDirectChild())&&(p.maxWidth="100%"),d&&!r&&!e.isPhone&&ee.alignmentStyleMap[d]?p.alignSelf=ee.alignmentStyleMap[d]:this.isRootOrDirectChild()&&o&&s.ib[o]?p.alignSelf="center":o&&s.Ok[o]&&(p.alignSelf="flex-start");const{topGap:u,gap:m,bottomGap:g}=ee;if(p.marginTop=this.props.isFirstItem?u:m,p.marginBottom=this.props.isLastItem?g:m,c?p.marginTop=ee.marginStyle.marginTop:o&&ee.defaultMarginTop[o]&&(p.marginTop=ee.defaultMarginTop[o]),c&&!this.props.isLastItem?p.marginBottom=ee.marginStyle.marginBottom:!this.props.isLastItem&&o&&ee.defaultMarginBottom[o]&&(p.marginBottom=ee.defaultMarginBottom[o]),(i||a&&0===l)&&(this.isRootOrDirectChild()||e.isPhone)){const e=this.getFullWidth();p.maxWidth=n?`calc(100vw - ${2*z.PeekModeOuterPadding-V.Z.state}px)`:(0,D.Ks)(t)&&!this.isPageFullWidth.state?A.CC:e,p.width=(0,D.Ks)(t)&&!this.isPageFullWidth.state?A.CC:e,p.alignSelf="center"}return this.isRootOrDirectChild()&&this.marginCommentsVisible.state&&i&&(p.zIndex=1),(0,E.H)()&&this.isLegacyTransclusionStore.state&&(p.border="3px dashed deeppink"),p})),this.externalObjectStateStore=this.createComputedStore((()=>{if((0,R.Xg)()&&this.props.store.isExternalObjectInstanceBlockStore()){var e;const t=(0,R._l)({store:this.props.store,canEdit:this.canEdit(),currentUserId:this.environment.currentUser.id,isInDarkMode:"dark"===this.environment.ThemeStore.state.mode,showAction:void 0});return(null==t?void 0:t.renderConfig.previewAttributes)&&(null===(e=t.renderConfig.previewAttributes[0])||void 0===e?void 0:e.mimeType)}}),!0),this.marginCommentsVisible=this.createComputedStore((()=>(0,M.fg)(this.environment,this.props.store))),this.sidePeekWidth=this.createComputedStore((()=>(0,L.vJ)(this.environment)))}willMount(e){super.willMount(e),this.isCopyIndicatorWithoutPendingTransaction=(0,A.hq)(e.store)}didMount(){this.isLegacyTransclusionStore.state&&(I.vkP(this.environment,{block_type:this.props.store.getType()}),(0,S.XY)("Found a potential legacy transclusion--a block's parent is not its rendered parent!",[["block",this.props.store],["block parent id = ",this.props.store.getParentId()],["rendered parent id = ",this.props.listStore.id]]))}renderComponent(){if(!this.isCopyIndicatorWithoutPendingTransaction||this.renderStateStore.state.type!==s.Ti.copyIndicator)return this.isResizableType()?(0,X.jsx)(Y.Z,{isVisible:!0,animationStyle:this.getResizeAnimationStyle(),render:()=>this.renderPreventSidebar()}):this.renderPreventSidebar()}renderBlock(){const{renderItem:e,disabled:t,store:o,disableHoverMenu:n,disableDrag:r,disableCommentMenu:i,numberedListCounterStore:a,bulletedListFormatStore:s}=this.props,l=this.blockRendererStore.state;return!m.Pj(o)&&q.default.checkGate("hide_orphan_blocks")?null:e?e(o):l?(0,X.jsx)(l,{ref:this.blockRef,store:this.props.store,disabled:t,isFirstItem:this.props.isFirstItem,isLastItem:this.props.isLastItem,blockResizerStore:this.stores.blockResizerStore,disableCommentMenu:i,numberedListCounterStore:a,bulletedListFormatStore:s,disableHoverMenu:n,disableDrag:r,legacyTransclusionParent:this.legacyTransclusionParentStore.state}):void 0}isRootOrDirectChild(){return this.props.store.isRootOrDirectChild()}descendantIsSelected(){const{store:e}=this.props;return H.default.state.stores.some((t=>t!==e&&e.uiContains(t)))}isInHistoryModal(){return Boolean(this.props.store.inMemoryRecordCache.snapshotData)}isResizableType(){const e=this.renderStateStore.state.type;return!!e&&(Boolean(s.Ok[e])||this.props.store.isType("column_list")&&(0,B.Po)(this.props.store,this.environment)||this.props.store.isType("external_object_instance")&&(0,R.Xg)())}isOverflowEdgeBlockType(){const e=this.renderStateStore.state.type;return!!e&&(s.GP[e]||this.props.store.isType("column_list")&&(0,B.Po)(this.props.store,this.environment)&&this.props.store.getFormat().block_full_width)}isInColumnList(){return this.context.isInColumnList}canEdit(){return this.canEditStore.state}getResizeAnimationStyle(){const{type:e}=this.renderStateStore.state;if(e&&(0,Q.x)({environment:this.environment,type:e}))return{width:"100%"};const{dragging:t,temporaryWidth:o,temporaryFullWidth:n,temporaryPageWidth:r}=this.stores.blockResizerStore.state,{block_width:i,block_full_width:a,block_page_width:s}=this.props.store.getFormat(),l=t?o:i,c=t?r:s;return{width:(t?n:a)?this.getFullWidth():c?"100%":l}}getFullWidth(){const{device:e}=this.environment,{isInPeekRenderer:t}=this.renderStateStore.state,o=this.environment.WindowSizeStore.state.width,n=(0,L.ll)(this.environment,t)-this.sidePeekWidth.state,r=o-V.Z.state-n;if(this.isInHistoryModal()&&!e.isPhone)return.8*o-240-V.Z.state;if(this.isInColumnList()||!this.isRootOrDirectChild())return"100%";if(t)return z.default.getPeekModeWidth(o)-V.Z.state;if((0,L.Jr)(this.environment)){let o=r;const{state:{shouldShowSidebar:n}}=this.appRenderState;return(!e.isMobile||e.isTablet)&&n&&(0,L.in)(this.environment)&&(o-=(0,L.Wk)(this.environment)),!this.renderStateStore.state.isInlineCollectionView&&this.marginCommentsVisible.state&&(this.isPageFullWidth.state?o-=M.QB:o-=2*(0,M.gC)(this.environment,t,(0,D.Ks)(this.props.store))),this.isOverflowEdgeBlockType()||(o-=2*(0,A.ui)(this.environment)),o}return r}}n=ee,ee.displayName="ListItemBlock",ee.contextTypes={...i.w,isInColumnList:b().any},ee.marginStyle={marginTop:4,marginBottom:4},ee.alignmentStyleMap={left:"flex-start",center:"center",right:"flex-end"},ee.defaultMarginTop={quote:n.marginStyle.marginTop,code:n.marginStyle.marginTop,bookmark:n.marginStyle.marginTop,external_object_instance:n.marginStyle.marginTop,file:void 0,video:n.marginStyle.marginTop,embed:n.marginStyle.marginTop,tweet:n.marginStyle.marginTop,audio:n.marginStyle.marginTop,drive:n.marginStyle.marginTop,gist:n.marginStyle.marginTop,maps:n.marginStyle.marginTop,framer:n.marginStyle.marginTop,invision:n.marginStyle.marginTop,figma:n.marginStyle.marginTop,loom:n.marginStyle.marginTop,typeform:n.marginStyle.marginTop,codepen:n.marginStyle.marginTop,equation:n.marginStyle.marginTop,pdf:n.marginStyle.marginTop,header:"2em",sub_header:"1.4em",sub_sub_header:"1em",image:n.marginStyle.marginTop,page:void 0,personal_home_page:void 0,collection_view:void 0,collection_view_page:void 0,column_list:void 0,column:void 0,breadcrumb:void 0,text:void 0,bulleted_list:void 0,numbered_list:void 0,to_do:void 0,toggle:void 0,factory:void 0,copy_indicator:void 0,divider:void 0,link_to_collection:void 0,link_to_page:void 0,alias:void 0,transclusion_container:1,transclusion_reference:1,callout:n.marginStyle.marginTop,table_of_contents:n.marginStyle.marginTop,whimsical:n.marginStyle.marginTop,miro:n.marginStyle.marginTop,abstract:n.marginStyle.marginTop,mixpanel:n.marginStyle.marginTop,sketch:n.marginStyle.marginTop,excalidraw:n.marginStyle.marginTop,replit:n.marginStyle.marginTop,table:1,table_row:void 0,tab:n.marginStyle.marginTop,hex:n.marginStyle.marginTop,deepnote:n.marginStyle.marginTop,external_object_instance_page:n.marginStyle.marginTop,button:void 0,ai_block:1,drawing:n.marginStyle.marginTop},ee.defaultMarginBottom={quote:n.marginStyle.marginBottom,code:n.marginStyle.marginBottom,header:n.marginStyle.marginBottom,bookmark:n.marginStyle.marginBottom,external_object_instance:n.marginStyle.marginBottom,file:void 0,video:n.marginStyle.marginBottom,embed:n.marginStyle.marginBottom,tweet:n.marginStyle.marginBottom,drive:n.marginStyle.marginBottom,audio:n.marginStyle.marginBottom,gist:n.marginStyle.marginBottom,maps:n.marginStyle.marginBottom,framer:n.marginStyle.marginBottom,invision:n.marginStyle.marginBottom,figma:n.marginStyle.marginBottom,loom:n.marginStyle.marginBottom,typeform:n.marginStyle.marginBottom,mixpanel:n.marginStyle.marginBottom,codepen:n.marginStyle.marginBottom,equation:n.marginStyle.marginBottom,pdf:n.marginStyle.marginBottom,image:n.marginStyle.marginBottom,sub_header:void 0,sub_sub_header:void 0,page:void 0,collection_view:void 0,collection_view_page:void 0,column_list:void 0,column:void 0,personal_home_page:void 0,breadcrumb:void 0,text:void 0,bulleted_list:void 0,numbered_list:void 0,to_do:void 0,toggle:void 0,factory:void 0,copy_indicator:void 0,divider:void 0,link_to_collection:void 0,link_to_page:void 0,alias:void 0,transclusion_container:1,transclusion_reference:1,callout:n.marginStyle.marginBottom,table_of_contents:n.marginStyle.marginBottom,whimsical:n.marginStyle.marginBottom,miro:n.marginStyle.marginBottom,abstract:n.marginStyle.marginBottom,sketch:n.marginStyle.marginBottom,excalidraw:n.marginStyle.marginBottom,replit:n.marginStyle.marginBottom,hex:n.marginStyle.marginBottom,deepnote:n.marginStyle.marginBottom,table:1,table_row:void 0,tab:n.marginStyle.marginBottom,external_object_instance_page:n.marginStyle.marginBottom,button:void 0,ai_block:1,drawing:n.marginStyle.marginBottom},ee.topGap=2,ee.gap=1,ee.bottomGap=0;const te=ee;class oe extends i.Z{constructor(){super(...arguments),this.renderItem=(e,t,o)=>e===oe.emptyDroppableKey?(0,X.jsx)(r.Fragment,{children:this.renderEmptyDroppable()},e):e===oe.placeholderKey?(0,X.jsx)(r.Fragment,{children:this.props.emptyPlaceholder},e):(0,X.jsx)(r.Fragment,{children:this.renderChild(e,t,o)},e),this.handleEmptyDrop=e=>{const{droppedDirection:t,droppedStores:o,duplicate:n}=e;u.createAndCommit({userAction:"List.handleEmptyDrop",environment:this.environment,perform:e=>{p.LQ({environment:this.environment,targetParentStore:this.props.store,targetStore:void 0,droppedDirection:t,droppedStores:o,duplicate:n,transaction:e})}})},this.handleEmptyNativeDrop=e=>{const{files:t,droppedDirection:o}=e;u.createAndCommit({userAction:"List.handleEmptyNativeDrop",environment:this.environment,perform:e=>{p.uQ({environment:this.environment,files:t,targetParentStore:this.props.store,targetStore:void 0,droppedDirection:o,transaction:e})}})},this.bulletedListFormatStore=this.createComputedStore((()=>{var e;const t=this.itemKeysStore.state,o=null===(e=this.props.bulletedListFormatStore)||void 0===e?void 0:e.getState().depth,n="number"==typeof o?o+1:0,r=new Map;let i;for(const a of t){const e=this.createStoreForItemId(a);i=e.getType()===s.Ti.bulletedList?e.getFormat().bullet_list_format||i:void 0,i&&r.set(a,i)}return{depth:n,blockIdFormats:r}})),this.numberedListCounterStore=this.createComputedStore((()=>{var e;const t=this.itemKeysStore.state,o=[],n=t.length?t[0]:void 0,r=n?this.createStoreForItemId(n):void 0,i=null==r?void 0:r.getParentId(),a=null===(e=this.props.numberedListCounterStore)||void 0===e?void 0:e.state.numberedListBlockIdsWithFormat.find((e=>e.id===i)),l=null==a?void 0:a.format;let c=void 0===(null==a?void 0:a.depth)?0:(null==a?void 0:a.depth)+1,d=l,p=0;for(const u of t)if(u!==oe.emptyDroppableKey&&u!==oe.placeholderKey){const e=this.createStoreForItemId(u),t=e.getType(),n=e.getFormat();if(d=(null==n?void 0:n.list_format)??d,t===s.Ti.numberedList){let e=n.list_start_index;e&&0!==p&&(e=void 0),p=e||p+1,o.push({id:u,format:d,depth:c||0,index:p})}else d=void 0,o.push({id:void 0,format:d,depth:0,index:p}),c=0,p=0}return{depth:c||0,numberedListBlockIdsWithFormat:o}})),this.canEditStore=this.createComputedStore((()=>{const e=(0,m.n3)(this.props.store)&&this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,g.YF)(e)&&this.props.store.canEdit()})),this.itemKeysStore=this.createComputedStore((()=>{const e=this.props.store.getValue()||[];let t=e;const o=this.getChildrenLimit(),n=this.canEdit(),r=0===e.length;return void 0!==o&&(t=l.tP(t,0,o)),n&&r&&t.push(oe.emptyDroppableKey),n&&r&&this.props.emptyPlaceholder&&t.push(oe.placeholderKey),t}))}renderComponent(){if(!this.props.disableContent){var e;const t=null===(e=this.context.restrictedContentContext)||void 0===e?void 0:e.state;return t?this.itemKeysStore.state.reduce(((e,o,n,r)=>(t.indexOf(o)>=0&&e.push(this.renderItem(o,n,r)),e)),[]):this.itemKeysStore.state.map(this.renderItem)}}renderChild(e,t,o){const{disabled:n}=this.props,r=this.createStoreForItemId(e),i=l.qr(o,(e=>(0,c.e)(e)));return(0,X.jsx)(te,{store:r,renderItem:this.props.renderItem,listStore:this.props.store,isFirstItem:0===t,isLastItem:t===i,disabled:n,disableLayout:this.props.disableLayout,canEditList:this.canEdit(),disableSelection:this.props.disableSelection,disableHoverMenu:this.props.disableHoverMenu,disableCommentMenu:this.props.disableCommentMenu,disableDrag:this.props.disableDrag,numberedListCounterStore:this.numberedListCounterStore,bulletedListFormatStore:this.bulletedListFormatStore})}renderEmptyDroppable(){const e=f.G.createChildStore(this.props.store,{table:d.iU,id:this.props.store.id}),t=this.canEdit();return(0,X.jsx)(J.Z,{store:e,canDropBelow:t,canNativeDropBelow:t,onSelectableDrop:this.handleEmptyDrop,onNativeDrop:this.handleEmptyNativeDrop,style:this.props.emptyDroppableStyle,analyticsName:"page_content",shouldShowDropZone:!0})}canEdit(){return!this.props.disabled&&(!y.n.state&&this.canEditStore.state)}getChildrenLimit(){const{limitParents:e}=h.Z.state,t=this.props.store.id;let o;return this.props.store.findRecordStoreUIAncestor((n=>{const r=e.get(n);return!(!r||!r.hasOwnProperty(t))&&(o=r[t],!0)})),o}createStoreForItemId(e){return f.G.createChildStore(this.props.store,{table:d.iU,id:e})}}oe.displayName="List",oe.placeholderKey="placeholder",oe.emptyDroppableKey="emptyDroppableKey",oe.contextTypes={...a.J,...i.w};const ne=oe},78454:(e,t,o)=>{o.d(t,{LK:()=>f,R8:()=>y,ZP:()=>x,v2:()=>c});var n=o(67294),r=o(49271),i=o(63143),a=o(89086),s=o(68709),l=o(85893);let c=function(e){return e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.End=2]="End",e}({});const{Start:d,Center:p,End:u}=c,m=n.forwardRef((function(e,t){return(0,l.jsxs)("div",{onClick:e.onClick,onMouseMove:e.onMouseMove,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onMouseDown:e.onMouseDown,style:b(e),ref:t,children:[e.left&&g(e),e.children&&(0,l.jsx)("div",{style:k(e),children:e.children}),e.right&&h(e)]})})),g=function(e){return(0,l.jsx)(s.p,{...(0,a.td)("start"),allowSelectionWithin:!1,style:_(e),children:e.left})},h=function(e){return(0,l.jsx)(s.p,{...(0,a.td)("end"),allowSelectionWithin:!1,style:w(e),children:e.right})},f=24,y={...r.ZD,textAlign:"left"},v={[d]:"flex-start",[p]:"center",[u]:"flex-end"},b=function(e){return{display:"flex",alignItems:i.z4(e.alignment)?v[c.Start]:v[e.alignment],width:"100%",...e.style}},S=function(e){const t={display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0};return(e.leftRightMinHeight||i.z4(e.leftRightMinHeight))&&(t.minHeight=`calc(1.5em + ${r.ZD.paddingTop}px + ${r.ZD.paddingTop}px)`),t},_=e=>({marginRight:2,width:f,...S(e),...e.leftStyle}),w=e=>({marginLeft:4,...S(e),...e.rightStyle}),k=e=>({flexGrow:1,flexShrink:1,flexBasis:0,minWidth:1,...e.childrenStyle}),x=m},40148:(e,t,o)=>{o.d(t,{HB:()=>c,Lw:()=>d,ZP:()=>p});var n=o(67294),r=o(13991),i=o(6740),a=o(24405),s=o(82990),l=o(85893);const c={fontSize:12,paddingTop:2,paddingBottom:2},d=c;function p(e){window.__c={n:"MediaPlaceholder"};const[t,o]=(0,n.useState)(!1),c=(0,a.yK)((o=>({root:{width:"100%",fontSize:14,fontFamily:s.Z.getCompositeFontFamily(r.SP).sans,color:o.mediumTextColor,borderRadius:4,background:o.embedPlaceholderBackground,position:"relative",...e.style},right:{position:"absolute",top:4,right:4,transition:"opacity 200ms ease-in",opacity:e.shouldHideRight&&!t?0:1},inner:{padding:12,paddingRight:36,display:"flex",alignItems:"center",textAlign:"left",width:"100%",overflow:"hidden"},icon:{width:25,height:25,flexShrink:0,marginRight:12,fill:o.mediumIconColor,...e.iconStyle}})),[e.style,e.shouldHideRight,e.iconStyle,t]);return(0,l.jsxs)("div",{style:c.root,onFocus:e=>{const t=e.target;t instanceof HTMLElement&&(0,i.E)(t)&&o(!0)},onBlur:()=>o(!1),children:[(0,l.jsxs)("div",{style:c.inner,children:[e.iconSvg(c.icon),(0,l.jsx)("div",{style:{...s.Z.textOverflowStyle},children:e.children})]}),e.right&&(0,l.jsx)("div",{style:c.right,children:e.right})]})}},71474:(e,t,o)=>{o.d(t,{M:()=>i,Z:()=>s});var n=o(67294),r=o(480);const i=new Set;function a(){for(const e of i)e()}const s=function(){window.__c={n:"MobileScrollListener"};const e=(0,r.Fy)();return(0,n.useEffect)((()=>{if(e.isMobile)return document.addEventListener("scroll",a,!0),()=>{document.removeEventListener("scroll",a,!0)}}),[e.isMobile]),null}},65085:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(67294),r=o(24405),i=o(42402),a=o(85893);function s(e){window.__c={n:"MultiLineTextOverflow"};const{children:t,maxLines:o,onMore:i,onLess:s}=e,c=(0,n.useRef)(null),d=(0,n.useRef)(null),p=(0,n.useRef)(null),[u,m]=(0,n.useState)(!1),[g,h]=(0,n.useState)(!o),[f,y]=(0,n.useState)(0),[v,b]=(0,n.useState)(0);(0,n.useEffect)((()=>{if(u){var e;const t=null===(e=d.current)||void 0===e?void 0:e.getClientRects()[0];y((null==t?void 0:t.height)??0),b((null==t?void 0:t.width)??0)}}),[u]);const S=(0,n.useCallback)((()=>{c.current&&m(c.current.scrollHeight>c.current.clientHeight)}),[]);(0,n.useEffect)((()=>{!g&&o&&S()}),[g,o,S]),(0,n.useEffect)((()=>{if(p.current){const e=new MutationObserver((()=>{g||S()})),t=new ResizeObserver((()=>{g||S()}));return t.observe(p.current),e.observe(p.current,{childList:!0,subtree:!0}),()=>{t.disconnect(),e.disconnect()}}}),[g,S]);const _=(0,n.useCallback)((e=>{i?i(e):(e.preventDefault(),e.stopPropagation(),h(!0))}),[i]),w=(0,n.useCallback)((e=>{s?s(e):(e.preventDefault(),e.stopPropagation(),h(!1))}),[s]),k=(0,n.useMemo)((()=>(0,a.jsx)(l,{style:{position:"absolute",right:0,bottom:0},onClick:_,children:(0,a.jsx)("div",{ref:d,children:e.moreElement})})),[e.moreElement,_]),x=(0,n.useMemo)((()=>(0,a.jsx)(l,{onClick:w,children:e.lessElement})),[e.lessElement,w]),I=(0,r.yK)((e=>({base:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:g?void 0:o},clamped:{WebkitMaskPosition:"right bottom",WebkitMask:`linear-gradient(0deg,transparent 0,transparent ${f}px,#000 ${f}px),\n\t\t\t\t\t\t\t linear-gradient(270deg,transparent 0,transparent ${v}px,#000 ${2*v}px)`}})),[o,g,f,v]);return(0,a.jsxs)("div",{style:{position:"relative"},children:[(0,a.jsxs)("div",{ref:c,style:{...I.base,...u&&!g&&I.clamped,...e.style},children:[(0,a.jsx)("div",{ref:p,children:t}),u&&g&&x]}),u&&!g&&k]})}function l(e){let{onClick:t,style:o,children:n}=e;return(0,a.jsx)(i.Z,{disableUnderline:!0,style:o,onClick:e=>{t(e)},children:n})}},54321:(e,t,o)=>{o.d(t,{Z:()=>w});var n=o(67294),r=o(86628),i=o(24405),a=o(49271),s=o(62965),l=o(5366),c=o(73819),d=o(23864),p=o(7825),u=o(55217),m=o(78454),g=o(22491),h=o(99445),f=o(85893);function y(e){const{rank:t,index:o,listFormat:n}=e;if("numbers"===n)return{index:o,listFormat:n};if("letters"===n)return{index:(0,h.yt)(o),listFormat:n};if("roman"===n)return{index:(0,h.bW)(o),listFormat:n};{const e=t%3;return 0===e?{index:o,listFormat:"numbers"}:1===e?{index:(0,h.yt)(o),listFormat:"letters"}:{index:(0,h.bW)(o),listFormat:"roman"}}}const v=function(e){window.__c={n:"NumberedListCounter"};const t=(0,r.VK)((()=>{if(!e.numberedListCounterStore)return y({rank:0,index:1,listFormat:void 0});const t=e.numberedListCounterStore.state.numberedListBlockIdsWithFormat.find((t=>t.id===e.store.id));return y({rank:(null==t?void 0:t.depth)||0,index:(null==t?void 0:t.index)||0,listFormat:null==t?void 0:t.format})}),[e.numberedListCounterStore,e.store.id]),o=t.index.toString().length;let n=24;return"roman"===t.listFormat?n=56:3===o?n=32:4===o?n=42:o>4&&(n="unset"),(0,f.jsx)("span",{...(0,g.iv)({pseudoBefore:{content:`"${t.index}."`},textAlign:"center",whiteSpace:"nowrap",width:n})})};var b=o(65187);const S=(0,l.defineMessages)({listPlaceholder:{defaultMessage:"List",id:"numberedListBlock.placeholder.label"}});function _(e,t){window.__c={n:"NumberedListBlock"};const o=(0,l.useIntl)(),s=n.useRef(null),g=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),h=(0,r.VK)((()=>e.store.getContentStore()),[e.store]),y=(0,c.rv)(e.store),_=(0,i.yK)((()=>({root:{paddingLeft:a.ZD.paddingLeft,...y,...e.style}})),[y,e.style]),w=(0,f.jsxs)(m.ZP,{style:_.root,left:(0,f.jsx)(v,{store:e.store,numberedListCounterStore:e.numberedListCounterStore}),leftStyle:{width:"unset"},childrenStyle:{display:"flex",flexDirection:"column"},ref:s,children:[(0,f.jsxs)("div",{style:{display:"flex"},children:[(0,f.jsx)(b.Z,{style:m.R8,disabled:e.disabled,store:g,placeholder:o.formatMessage(S.listPlaceholder),pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,f.jsx)(d.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store,style:p._1})]}),!e.hideContent&&(0,f.jsx)(u.Z,{disabled:e.disabled,store:h,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,numberedListCounterStore:e.numberedListCounterStore})]});return(0,c.ez)(e.store,t,(0,n.useMemo)((()=>({renderedType:"numbered_list",getNode:()=>s.current,getBlockStore:()=>e.store})),[e.store]),w)}const w=n.memo(n.forwardRef(_),s.Z)},45952:(e,t,o)=>{o.d(t,{Z:()=>y,x:()=>h});var n=o(67294),r=o(480),i=o(86628),a=o(87292),s=o(62965),l=o(5366),c=o(73819),d=o(68859),p=o(69278),u=o(69721),m=o(85893);const g=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed PDF",id:"pdfBlock.embeds.button.label"}});function h(e){const{type:t,environment:o}=e;return"pdf"===t&&o.device.isMobile}function f(e,t){window.__c={n:"PDFBlock"};const o=(0,r.O7)(),s=(0,l.useIntl)(),f=(0,n.useRef)(null),y=(0,i.qz)(void 0,d.Z),v=(0,i.VK)((()=>{const t=e.store.getType();return t&&h({environment:o,type:t})}),[o,e.store])?(0,m.jsx)(u.Z,{store:e.store,disabled:e.disabled}):(0,m.jsx)(p.Z,{...e,blockResizerStore:y,ref:f,store:e.store,iconSvg:a.B,mediaMenuCurrentTab:"file",mediaMenuTabs:[{type:"file",fileUpload:!0},{type:"embed"}],mediaMenuEmbedCaption:(0,m.jsx)(l.FormattedMessage,{defaultMessage:"Embed a PDF file",id:"pdfBlock.embeds.caption"}),embedButtonText:s.formatMessage(g.embedButtonText),urlInputPlaceholder:"https://...",children:(0,m.jsx)(l.FormattedMessage,{defaultMessage:"Embed a PDF",id:"pdfBlock.placeholder"})});return(0,c.ez)(e.store,t,(0,n.useMemo)((()=>({renderedType:"pdf",getNode:()=>{const e=f.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),v)}const y=n.memo(n.forwardRef(f),s.Z)},53238:(e,t,o)=>{o.d(t,{Z:()=>D});o(67294);var n=o(83355),r=o(480),i=o(8848),a=o(43593),s=o(17755),l=o(59054),c=o(72126),d=o(54642),p=o(31781),u=o(24677),m=o(95477),g=o(98742),h=o(18514),f=o(77907),y=o(34859),v=o(4926),b=o(24042),S=o(5315),_=o(49085);class w extends _.default{getInitialState(){return{ready:!1,pages:0,renderWidth:0,showPages:0}}}const k=w;var x=o(21199),I=o(68785),C=o(53336),T=o(43145),M=o(85893);class P extends n.Z{constructor(){super(...arguments),this.ReactPDF=void 0,this.storeTypes={store:k},this.handleMouseDown=()=>{u.ZH(this.environment)},this.handleDocumentLoadSuccess=e=>{e&&e._pdfInfo&&this.stores.store.setState({...this.stores.store.state,pages:e._pdfInfo.numPages,showPages:1})},this.handlePageRenderSuccess=()=>{this.stores.store.setState({...this.stores.store.state,ready:!0})},this.handleScrollOffsetChange=e=>{e<P.loadMoreOffset&&this.stores.store.state.ready&&this.renderNextPage()},this.updateRenderWidth=()=>{this.stores.store.setState({...this.stores.store.state,renderWidth:this.props.width})},this.updateRenderWidthDebounced=c.Ds(this.updateRenderWidth,1e3)}async willMount(e){super.willMount(e),this.stores.store.setState({...this.stores.store.state,renderWidth:e.width}),this.ReactPDF=await f.deps.reactPDF.loader(),this.enqueueForceUpdate()}willUpdate(e){super.willUpdate(e),this.updateRenderWidthDebounced()}renderComponent(){if(!this.ReactPDF)return;const{source:e}=this.props,t=this.stores.store.state,{Document:o,Page:n}=this.ReactPDF,r=(0,a.x$)(e)&&!(0,h.Sr)();return(0,M.jsx)(x.Z,{capture:!0,render:i=>(0,M.jsxs)(C.Z,{type:y.Z.All,style:this.getStyle(),...(0,g.Z)(i,{onMouseDown:this.handleMouseDown}),children:[e&&(0,M.jsx)(o,{file:e,loading:(0,M.jsx)(I.Z,{style:P.loadingSpinnerStyle}),onLoadSuccess:this.handleDocumentLoadSuccess,options:{cMapUrl:"/notion-assets/cmaps/",cMapPacked:!0,withCredentials:r},children:c.w6(t.showPages).map((e=>(0,M.jsx)(n,{pageNumber:e+1,width:this.getPageWidth(),loading:"",renderAnnotationLayer:!1,renderInteractiveForms:!1,onRenderSuccess:this.handlePageRenderSuccess},e+1)))}),(0,M.jsx)(T.Z,{onChange:this.handleScrollOffsetChange})]})})}getPageWidth(){const e=this.stores.store.state;return Math.min(window.innerWidth,e.renderWidth)-2*P.leftRightPadding-v.Z.state}renderNextPage(){const{showPages:e,pages:t}=this.stores.store.state;e<t&&this.stores.store.setState({...this.stores.store.state,ready:!1,showPages:e+1})}getStyle(){const{device:e}=this.environment;return{position:"relative",height:this.props.height,maxHeight:e.isMobile?"75vh":void 0,background:i.ZP.uiExtraLightGray,paddingTop:P.topBottomPadding,paddingBottom:P.topBottomPadding,paddingLeft:P.leftRightPadding,paddingRight:P.leftRightPadding,overflow:"visible"}}}P.displayName="PDFRenderer",P.loadMoreOffset=200,P.topBottomPadding=8,P.leftRightPadding=16,P.loadingSpinnerStyle={position:"absolute",top:"calc(50% - 9px)",left:"calc(50% - 9px)",width:18,height:18};function A(e){window.__c={n:"ProxiedPDFRendererWrapper"};const{contentWrapStyle:t,width:o,height:n,blockLocation:i,source:c}=e,u=e.store.pointer,g=(0,r.O7)(),[{value:h}]=(0,l.r5)((async()=>{if(await S.transactionQueue.awaitRecordTransaction(u),(0,a.E$)(c,[m.default.secureFileS3.url,m.default.secureFileS3V2.url])){const e=g.device;return await d.getSignedFileUrl(g,{url:c,permissionRecord:u,useS3Url:e.isIOS&&e.isMobileNative},Boolean(b.Z.state.isNotionProtocolBugFixed))}return(0,s.EK)({url:c,permissionRecord:u,baseUrl:m.default.domainBaseUrl,fullyQualified:!1,userId:g.currentUser.id})}),[g,u,c]);return(0,M.jsx)("div",{style:t,children:(0,M.jsx)(P,{source:h,width:o||500,height:n||(p.qC(i)?240:500)})})}const D={render:e=>(0,M.jsx)(A,{...e}),embedGhost:!0,resizable:!0}},24813:(e,t,o)=>{o.d(t,{Z:()=>T});o(67294);var n=o(83355),r=o(15145),i=o(49271),a=o(39567),s=o(44805),l=o(82990),c=o(5366),d=o(3297),p=o(9953),u=o(39699),m=o(84210),g=o(98165),h=o(67669),f=o(77080),y=o(31792),v=o(88923),b=o(13966),S=o(84076),_=o(31278),w=o(76798),k=o(26388),x=o(78454),I=o(85893);class C extends n.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:y.Z},this.handleRecordIconChange=e=>{const{store:t}=this.props,o=t.getIconStore();o&&u.createAndCommit({userAction:"Page.handleRecordIconChange",environment:this.environment,perform:t=>{p.sO({store:o,value:e,transaction:t})}})},this.onMouseMove=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.onMouseLeave=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})}}didMount(){const{RouterStore:e,currentUser:t}=this.environment,{route:o}=e.state;"page"===o.name&&o.shouldDuplicate&&d.nM({currentUserId:null==t?void 0:t.id,blockId:o.blockId})}renderComponent(){const{store:e,onClick:t}=this.props,o=(0,m.Hu)({store:e,fullyQualified:!1,pageVisitSource:r.tY.LinkInPage}),n=(0,m.Hu)({store:this.props.store,openInSidePeek:!0,fullyQualified:!1,pageVisitSource:r.tY.PeekOpen}),i=f.default.checkGate("enable_deleted_page_indicator"),a=g.wf(e),s=i&&a;return(0,I.jsx)(S.Z,{href:o,altHref:n,forceAltHref:v.default.isSidePeekOpen(),external:!1,onClick:t,style:{borderRadius:4,...this.props.style},children:(0,I.jsx)(x.ZP,{childrenStyle:C.childrenStyle,alignment:x.v2.Center,right:this.renderActionButton(),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:(0,I.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[this.renderIconWithArrow(s),(0,I.jsx)(w.Z,{store:e,style:this.getTitleStyle(s)})]})})})}renderIconWithArrow(e){if(e){const e=this.environment.device.isSafari||this.environment.device.isIOS;return(0,s.tr)({isSafariOrIOS:e,theme:this.theme})}return(0,I.jsxs)("div",{style:{position:"relative",width:24,height:24,marginRight:4},children:[this.renderIcon(),this.renderArrowIcon()]})}renderArrowIcon(){if(this.props.isAlias)return(0,I.jsx)("div",{children:(0,a.Y)({position:"absolute",width:"50%",height:"50%",right:0,bottom:0})})}renderIcon(){const{store:e,disabled:t}=this.props;return(0,I.jsx)(k.Z,{renderTooltip:()=>(0,I.jsx)(c.FormattedMessage,{defaultMessage:"Change icon",id:"page.changeIcon.tooltip"}),placement:k.Z.Placement.Top,disableTooltip:t||!this.canEdit(),render:o=>t||!this.canEdit()?(0,I.jsx)(_.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),role:e.getRole(),size:22,style:{width:"100%",height:"100%"},...o,largeIcon:!0}):(0,I.jsx)(_.Z,{disabled:!1,bucket:"secure",store:e,icon:e.getIcon(),role:e.getRole(),isEmptyPage:e.isEmptyPage(),size:22,style:{width:"100%",height:"100%"},iconLoggingData:{recordTable:e.table,source:"subpage",block_type:e.getType()},onChange:this.handleRecordIconChange,...o,largeIcon:!0})})}renderActionButton(){const{device:e}=this.environment;return this.canEdit()&&(this.stores.mouseStore.state.mouseEntered||e.isMobile)?(0,I.jsx)(b.Z,{store:this.props.aliasStore??this.props.store,tooltipContent:(0,I.jsx)(c.FormattedMessage,{defaultMessage:"Rename, delete, and moreâ€¦",id:"page.blockActionMenu.tooltip"}),style:{marginRight:4},fadeIn:!0}):(0,I.jsx)("div",{style:{width:28}})}canEdit(){const{store:e}=this.props,t=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,h.YF)(t)&&(e.canEdit()&&!this.props.disabled)}getTitleStyle(e){return{fontWeight:l.Z.fontWeight.medium,lineHeight:1.3,borderBottom:this.props.disableUnderline?"none":`1px solid ${this.theme.darkDividerColor}`,...e&&{color:this.theme.mediumTextColor}}}}C.displayName="Page",C.childrenStyle={paddingTop:i.ZD.paddingTop,paddingBottom:i.ZD.paddingBottom,paddingLeft:i.ZD.paddingLeft};const T=C},4382:(e,t,o)=>{o.d(t,{Z:()=>I});var n=o(67294),r=o(73935),i=o(83355),a=o(15145),s=o(50906),l=o(75018),c=o(97444),d=o(32741),p=o(66213),u=o(14976),m=o(35683),g=o(84210),h=o(77080),f=o(61738),y=o(22294),v=o(72014),b=o(88923),S=o(2834),_=o(68709),w=o(24813),k=o(85893);class x extends S.Z{constructor(){super(...arguments),this.nodeRef=n.createRef(),this.handleClick=()=>{const{store:e}=this.props;s.Se(this.environment),s.SK1(this.environment,{page_visit_id:v.$g.getCurrentPageVisitId(),mentioned_page_id:e.id,source_type:"page_block",hover_preview_enabled:h.default.checkGate("first_party_links"),is_navigable_block:e.isNavigableBlock()}),f.Z.recordVisit({id:e.id,systemBlockType:e.getSystemBlockTypeStore().getValue(),type:m.vu.Link,currentUserId:this.environment.currentUser.id})},this.handleMouseOver=e=>{const t=this.getInteractiveToken(),o=this.props.store.getTitleStore();o&&t&&c.Nh({environment:this.environment,event:e,interactiveToken:t,store:o,canEdit:this.canEdit()})},this.handleMouseOut=e=>{const t=this.getInteractiveToken(),o=this.props.store.getTitleStore();o&&t&&c.Zl({environment:this.environment,event:e,interactiveToken:t,store:o,canEdit:this.canEdit()})}}handleCreated(){this.activate(),y.Z.setKeyboardMode(!1)}activate(){const{store:e}=this.props;this.navigate(e)}willUnmount(){super.willUnmount(),d.qA(this.props.store.getTitleStore())}navigate(e){if(this.context.overrideLinkClick){const t=(0,g.ZP)({store:e,pageVisitSource:a.tY.Create});this.context.overrideLinkClick(t)}else l.navigateToBlock({environment:this.environment,store:e,visitType:m.vu.Link,openInSidePeek:b.default.isSidePeekOpen(),pageVisitSource:a.tY.Create})}renderPersisted(){const{disabled:e}=this.props;return(0,k.jsx)(_.p,{allowSelectionWithin:!1,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,children:(0,k.jsx)(w.Z,{ref:this.nodeRef,store:this.props.store,style:{...this.getBlockColorStyle(),...this.props.style},isAlias:this.props.store.recordStoreParentDiffersFromPersistedParent(),disabled:e,onClick:this.handleClick})})}getInteractiveToken(){if(!this.nodeRef||!this.nodeRef.current)return;const e=r.findDOMNode(this.nodeRef.current);return(0,u.We)(this.props.store,e)}}x.contextTypes={...p.wK,...i.w};const I=x},35541:(e,t,o)=>{o.d(t,{u:()=>C});o(67294);var n=o(86628),r=o(24405),i=o(41892),a=o(70203),s=o(1292),l=o(7825),c=o(38376),d=o(27627),p=o(51077),u=o(36596),m=o(65453),g=o(54321),h=o(4382),f=o(16472),y=o(99571),v=o(51704),b=o(17970),S=o(11620),_=o(4859),w=o(91791),k=o(91497),x=o(85893);let I;function C(e){const t=e.getType();if(t){if(!I){const e={text:b.Z,page:h.Z,collection_view_page:d.Z,bulleted_list:l.ZP,numbered_list:g.Z,toggle:_.ZP,quote:f.ZP,to_do:S.Z,header:m.Z,sub_header:y.Z,sub_sub_header:v.Z,callout:c.Z,transclusion_container:w.Z,transclusion_reference:k.Z,alias:s.Z};I={...e,...{abstract:T,audio:T,code:T,codepen:T,equation:T,figma:T,file:T,pdf:T,video:T,deepnote:T,drive:T,excalidraw:T,framer:T,gist:T,hex:T,invision:T,loom:T,maps:T,miro:T,mixpanel:T,replit:T,sketch:T,tweet:T,typeform:T,whimsical:T},copy_indicator:void 0,personal_home_page:void 0,button:void 0,image:void 0,bookmark:void 0,factory:void 0,divider:void 0,column_list:void 0,embed:void 0,breadcrumb:void 0,collection_view:void 0,link_to_page:void 0,link_to_collection:void 0,column:void 0,table_of_contents:void 0,external_object_instance:void 0,table:void 0,table_row:void 0,tab:void 0,external_object_instance_page:void 0,ai_block:void 0,drawing:void 0}}return I[t]}}const T=e=>{let{store:t}=e;window.__c={n:"MultiMediaAndIntegrationPreview"};const[o,s]=(0,n.VK)((()=>{var e;const o=t.getType(),n=null===(e=t.getTitleStore())||void 0===e?void 0:e.getValue();return[o,a.QaF(n)]}),[t]),l=(0,r.yK)((e=>({card:{display:"flex",padding:10,borderRadius:6,boxShadow:e.inputBoxShadow,marginBottom:6,gap:10},shimmer:{backgroundColor:e.largeShimmerColor,width:150,borderRadius:6}})),[]),c=function(e){const t=e&&M[e];if("string"==typeof t)return t;return i.Z.images.icons.unknownTypePng}(o);return(0,x.jsxs)("div",{style:l.card,children:[(0,x.jsx)(p.Z,{type:"image_url",imageURL:c,size:25,imageStyle:{marginLeft:4,marginRight:4}}),s.length>0?(0,x.jsx)("span",{children:s}):(0,x.jsx)(u.Z,{emphasized:!0,style:l.shimmer})]})};const M={equation:i.Z.images.blocks.texPng,audio:i.Z.images.blocks.audioPng,file:i.Z.images.blocks.filePng,pdf:i.Z.images.blocks.pdfPng,code:i.Z.images.blocks.codePng,video:i.Z.images.blocks.videoPng,abstract:i.Z.images.blocks.abstractPng,codepen:i.Z.images.blocks.codepenPng,deepnote:i.Z.images.blocks.deepnotePng,drive:i.Z.images.blocks.drivePng,excalidraw:i.Z.images.blocks.excalidrawPng,figma:i.Z.images.externalIntegrations.figmaIconPng,framer:i.Z.images.blocks.framerPng,gist:i.Z.images.blocks.githubPng,hex:i.Z.images.blocks.hexPng,invision:i.Z.images.blocks.invisionPng,loom:i.Z.images.blocks.loomPng,maps:i.Z.images.blocks.mapsPng,miro:i.Z.images.blocks.miroPng,mixpanel:i.Z.images.blocks.mixpanelPng,replit:i.Z.images.blocks.replitPng,sketch:i.Z.images.blocks.sketchPng,typeform:i.Z.images.blocks.typeformPng,tweet:i.Z.images.blocks.twitterPng,whimsical:i.Z.images.blocks.whimsicalPng}},32469:(e,t,o)=>{o.d(t,{Z:()=>p});o(67294);var n=o(83355),r=o(8848),i=o(90199),a=o(82990),s=o(5366),l=o(26388),c=o(85893);class d extends n.Z{constructor(){super(...arguments),this.storeTypes={}}renderComponent(){return(0,c.jsx)(l.Z,{renderTooltip:()=>(0,c.jsx)(s.FormattedMessage,{defaultMessage:"Only you can see this page",id:"privatePageBadge.tooltip"}),render:e=>(0,c.jsx)("div",{style:{display:"flex",alignItems:"flex-start",...this.props.style||{}},...e,children:(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,c.jsx)("div",{style:{flexShrink:0,marginTop:-1,marginRight:4,fill:r.ZP.red},children:(0,i.b)({width:12})}),(0,c.jsx)("span",{style:{fontSize:12,fontWeight:a.Z.fontWeight.semibold,color:r.ZP.red},children:(0,c.jsx)(s.FormattedMessage,{defaultMessage:"Private",id:"privatePageBadge.label"})})]})})})}}d.displayName="PrivatePageBadge",d.style={};const p=d},16472:(e,t,o)=>{o.d(t,{NE:()=>f,ZP:()=>b,nr:()=>y});var n=o(67294),r=o(86628),i=o(24405),a=o(49271),s=o(62965),l=o(5366),c=o(33929),d=o(73819),p=o(23864),u=o(55217),m=o(65187),g=o(85893);const h=(0,l.defineMessages)({emptyPlaceholder:{defaultMessage:"Empty quote",id:"quoteBlock.emptyQuote.placeholder"}}),f=3,y=14;function v(e,t){let{disabled:o,disableCommentMenu:s,disableDrag:l,disableHoverMenu:v,hideContent:b,store:S,style:_}=e;window.__c={n:"QuoteBlock"};const w=(0,n.useRef)(null),k=(0,d.rv)(S),x=(0,r.VK)((()=>{var e;return null===(e=S.getFormat())||void 0===e?void 0:e.quote_size}),[S]),I=(0,r.VK)((()=>S.getBlockTitleStore()),[S]),C=(0,r.VK)((()=>S.getContentStore()),[S]),T=(0,i.yK)((()=>({root:{margin:0,fontSize:"large"===x?"1.2em":"1em",...a.ZD,...k,display:"flex",..._},padding:{paddingLeft:a.ZD.paddingLeft,paddingRight:a.ZD.paddingRight},innerStyle:{borderLeft:`${f}px solid currentColor`,paddingLeft:y,paddingRight:y,width:"100%"}})),[k,x,_]),M=(0,g.jsxs)("blockquote",{style:T.root,ref:w,children:[(0,g.jsxs)("div",{style:T.innerStyle,children:[(0,g.jsx)(m.Z,{style:T.padding,placeholderStyle:{left:y,width:"auto",right:y},disabled:o,store:I,placeholder:c.default.formatMessage(h.emptyPlaceholder),pasteBehavior:"block"}),!b&&(0,g.jsx)(u.Z,{disabled:o,store:C,disableCommentMenu:s,disableHoverMenu:v,disableDrag:l})]}),(0,g.jsx)(p.Z,{disableCommentMenu:s,hideContent:b,store:S})]});return(0,d.ez)(S,t,(0,n.useMemo)((()=>({renderedType:"quote",getNode:()=>w.current,getBlockStore:()=>S})),[S]),M)}const b=n.memo(n.forwardRef(v),s.Z)},79954:(e,t,o)=>{o.d(t,{Z:()=>G});var n=o(67294),r=o(83355),i=o(45060),a=o(480),s=o(24405),l=o(8848),c=o(89789),d=o(63143),p=o(51454),u=o(6404),m=o(42239),g=o(99553),h=o(52989),f=o(24677),y=o(39699),v=o(11368),b=o(84064),S=o(43250),_=o(78316),w=o(12534),k=o(98742),x=o(39500),I=o(45162),C=o(73959),T=o(89224),M=o(89086),P=o(95802),A=o(21273),D=o(98180),B=o(55367),R=o(10084),E=o(80796),F=o(20144),N=o(35661),j=o(69784),O=o(49085);class L extends O.default{getInitialState(){return{shouldShowSelectionHalo:!1,shouldShowDropParentHalo:!1,shouldShowDropZone:!1,shouldShowDropZoneHint:!1,forceRenderSelectionHalo:!1,showActionIsInFlight:!1}}}const U=L;var Z=o(27724),V=o(24666),q=o(23063),z=o(6685),W=o(85893);class H extends r.Z{constructor(){super(...arguments),this.lastDropZoneHintIndex=void 0,this.selectableDivRef=n.createRef(),this.storeTypes={draggableStore:R.Z,selectableStore:U},this.handleDragStart=e=>{const{mobileNative:t}=this.environment;this.props.canDrag&&(e.preventDefault(),t&&t.buzz()),this.props.onDraggableDragStart&&this.props.onDraggableDragStart(e)},this.handleDragMove=e=>{const{device:t}=this.environment;this.props.canDrag&&!this.props.preventBackgroundDrag?B.ZP.state.isDragging?m.td(this.environment,{currentX:e.currentX,currentY:e.currentY}):x.X9()&&(f.Ys({environment:this.environment,store:this.props.store,toggle:f.ji(this.environment),selectBetween:f.OS()}),m.f$(this.environment,{startX:e.startX,startY:e.startY,stores:this.props.contextMenuAndDragStores||Z.default.state.stores,isNativeDrag:!1,getGhostElement:this.props.getGhostElement})):j.Z.state.isActive||t.isPhone||h.AI({environment:this.environment,target:e.target,startX:e.startX,startY:e.startY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!this.props.disableScrollToRevealHorizontal}),this.props.onDraggableDragMove&&this.props.onDraggableDragMove(e)},this.handleDragEnd=e=>{const{device:t}=this.environment;t.isMobile&&E.Z.state.isDragging&&e.preventDefault(),this.props.canDrag&&B.ZP.state.isDragging&&m.fX({environment:this.environment,shiftKey:e.shiftKey,optionKey:e.optionKey,commandKey:e.commandKey,analyticsFrom:this.props.analyticsName}),this.props.onDraggableDragEnd&&this.props.onDraggableDragEnd(e)},this.handleDragCancel=e=>{this.props.canDrag&&B.ZP.state.isDragging&&(m.cQ(this.environment),f.ZH(this.environment)),this.props.onDraggableDragCancel&&this.props.onDraggableDragCancel(e)},this.handleClick=e=>{(0,w.ZP)({event:e,context:w.Af.EditorClick,callback:()=>{var t;if(null!==(t=Z.default.getDefaultContainerFromTarget(e.target))&&void 0!==t&&t.isPeekRenderer()||g.E5(this.environment),(0,C.Mn)(this.environment.device))x.X9()||!this.props.canSelect||this.props.store.isInlineCollectionView()||f.Ys({environment:this.environment,store:this.props.store,toggle:f.ji(this.environment),selectBetween:f.OS()});else{const{onEditText:t}=this.props;if(t){const o=(0,M.Rb)(e.target);o&&y.createAndCommit({userAction:"Selectable.handleClick",environment:this.environment,perform:e=>{t({isAtStartOfLine:"start"===o,isClick:!0,transaction:e})}})}}this.props.onClick&&this.props.onClick(e)}})},this.handleContextMenu=e=>{const{device:t}=this.environment;if(t.isAndroid){const t=V.default.state,o=(0,C.mh)(this.props.store),n=o&&"empty"!==t.mode&&(0,I.r)(t.multiSelection,o);if("editing"!==t.mode||!n)return T.isExpanded(T.get())||e.preventDefault(),e.stopPropagation(),!1}if(this.props.canTriggerContextMenu){const t=(0,_.fm)(this.props.store);(0,w.ZP)({event:e,context:w.Af.EditorContextMenu,callback:()=>{e.preventDefault(),f.Ys({environment:this.environment,store:this.props.store}),u.Qn({environment:this.environment,stores:this.props.contextMenuAndDragStores||Z.default.state.stores,left:e.clientX,top:e.clientY,actionSectionGroupKey:this.props.actionSectionGroupKey||"default",showInput:Boolean(this.props.showBlockMenuInput),analyticsFrom:"content_block_menu",optionalAnalyticsProperties:{collectionContextStore:t}})}})}},this.handleDoubleClick=e=>{this.props.canSelect||(0,w.ZP)({event:e,context:w.Af.EditorDoubleClick,callback:()=>{this.props.onDoubleClick&&this.props.onDoubleClick(e)}})},this.handleMouseOver=e=>{this.props.canSelect&&(0,w.ZP)({event:e,context:w.Af.EditorMouseOver,callback:()=>{F.Z.setState({...F.Z.state,hoveredStore:this.props.store,lastHoveredStore:this.props.store})}})},this.handleMouseOut=()=>{F.Z.state.hoveredStore===this.props.store&&F.Z.setState({...F.Z.state,hoveredStore:void 0})},this.computedStore=this.createComputedStore((()=>{const e=this.getDropZoneHintIndex();!d.z4(e)&&e>=0&&(this.lastDropZoneHintIndex=e);const t=this.shouldShowSelectionHalo(),o=this.shouldShowDropParentHalo(),n=this.getCurrentDropZone(),r=this.getDropZoneHint(),i=this.lastDropZoneHintIndex,a=this.stores.draggableStore.state.dragging,s=this.stores.draggableStore.hasDragged(),l=this.stores.draggableStore.state.initiator,c=this.stores.selectableStore.state,p=this.props.store.getType()||"unknown";return{isDragging:a,initiator:l,hasDragged:s,shouldShowSelectionHalo:t||c.forceRenderSelectionHalo||Boolean(this.props.shouldForceRenderSelectionHalo),shouldShowDropParentHalo:o,currentDropZone:n,dropZoneHint:r,dropZoneHintIndex:i,shouldRenderSelectionHalo:t||c.shouldShowSelectionHalo||c.forceRenderSelectionHalo||Boolean(this.props.shouldForceRenderSelectionHalo),shouldRenderDropParentHalo:o||c.shouldShowDropParentHalo,shouldRenderDropZoneHint:!d.z4(r)||c.shouldShowDropZoneHint,shouldRenderDropZone:!d.z4(n)||c.shouldShowDropZone,propStoreType:p,showActionIsInFlight:c.showActionIsInFlight}}))}get registries(){return[P.C]}getNode(){return this.props.nodeRef?this.props.nodeRef.current:this.selectableDivRef.current}getContextClosestSelectable(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.closestSelectable}getContextSelectableContainer(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.selectableContainer}getContextVerticalScroller(){var e;return null===(e=this.context.scrollerContext)||void 0===e?void 0:e.verticalScroller}getContextHorizontalScroller(){var e;return null===(e=this.context.scrollerContext)||void 0===e?void 0:e.horizontalScroller}renderComponent(){var e;const{isDragging:t,initiator:o,hasDragged:n,shouldShowDropParentHalo:r,shouldShowSelectionHalo:i,currentDropZone:a,dropZoneHint:s,dropZoneHintIndex:l,shouldRenderSelectionHalo:c,shouldRenderDropParentHalo:d,shouldRenderDropZoneHint:p,shouldRenderDropZone:u,propStoreType:m,showActionIsInFlight:g}=this.computedStore.state,h=c||d||p||u,f=`${S.euV} notion-${m}-block`,y=this.renderDraggable((e=>(0,W.jsxs)("div",{ref:this.selectableDivRef,style:this.getStyle({isPositionRelative:h,isDragging:t,hasDragged:n,initiator:o,showActionIsInFlight:g}),"data-block-id":this.props.store.id,className:this.props.className?`${f} ${this.props.className}`:f,...(0,k.Z)(e||{},{onDoubleClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onClick:this.handleClick,onMouseMove:this.props.onMouseMove,onMouseDown:this.props.onMouseDown,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave}),children:[this.props.children,c&&(0,W.jsx)(K,{selectableStore:this.stores.selectableStore,style:this.props.haloStyle,isVisible:i}),d&&(0,W.jsx)($,{selectableStore:this.stores.selectableStore,isVisible:r}),p&&(0,W.jsx)(X,{selectableStore:this.stores.selectableStore,direction:s,index:l,aboveDropZoneMargin:this.props.aboveDropZoneMargin,belowDropZoneMargin:this.props.belowDropZoneMargin,dropzoneGap:this.props.dropzoneGap}),u&&(0,W.jsx)(J,{selectableStore:this.stores.selectableStore,direction:a,aboveDropZoneMargin:this.props.aboveDropZoneMargin,belowDropZoneMargin:this.props.belowDropZoneMargin,dropzoneGap:this.props.dropzoneGap})]})));return(0,W.jsx)(b.ld,{value:{selectableContainer:null===(e=this.context.selectable)||void 0===e?void 0:e.selectableContainer,closestSelectable:this},children:y})}displaySelectionHalo(e){this.stores.selectableStore.state.forceRenderSelectionHalo||(this.stores.selectableStore.update((e=>({...e,forceRenderSelectionHalo:!0}))),window.setTimeout((()=>{this.stores.selectableStore.update((e=>({...e,forceRenderSelectionHalo:!1})))}),e))}renderDraggable(e){const{device:t}=this.environment;return this.props.canDrag?(0,W.jsx)(z.Z,{draggableStore:this.stores.draggableStore,forceTouch:t.isMobile&&!this.props.disableForceTouch,touchDragOnly:this.props.touchDragOnly,onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,disableHorizontalEdgeScroll:this.props.disableHorizontalDragEdgeScroll,render:e}):e(void 0)}shouldShowSelectionHalo(){const{device:e}=this.environment,{store:t,shouldShowHalo:o}=this.props;if(!o||!(0,C.Mn)(e))return!1;const{stores:n,phase:r}=Z.default.state;if(r===Z.SelectionPhase.Selected&&n.indexOf(t)>=0&&!B.ZP.state.isDragging)return!0;const i=D.Z.getActiveAssistantRuntimeState();return!(null==i||!i.selectedBlocks.has(t))}shouldShowDropParentHalo(){const{store:e,shouldShowHalo:t}=this.props;if(!t)return!1;const o=B.ZP.state;if(!o.isDragging)return!1;const{currentParentStore:n,currentHintDropZones:r,currentDropZone:i}=o;return(!i||i.type!==B.Dl.DropTarget)&&(r.some((e=>e.direction===B.vh.Left||e.direction===B.vh.Right))?Boolean(i&&i.store===e):n===e)}getCurrentDropZone(){const{store:e,shouldShowDropZone:t}=this.props,o=B.ZP.state;if(!o.isDragging)return;const{currentDropZone:n}=o;return n&&n.type===B.Dl.Selectable&&n.store===e&&t?n.direction:void 0}getDropZoneHint(){const{store:e,shouldShowDropZone:t}=this.props,o=B.ZP.state;if(!o.isDragging)return;const{currentHintDropZones:n}=o;if(n&&t){const t=n.find((t=>t.type===B.Dl.Selectable&&t.store===e));if(t)return t.direction}}getDropZoneHintIndex(){const{store:e}=this.props,t=B.ZP.state;if(!t.isDragging)return;const{currentHintDropZones:o}=t;return o?o.findIndex((t=>t.type===B.Dl.Selectable&&t.store===e)):void 0}getStyle(e){const{isPositionRelative:t,isDragging:o,hasDragged:n,showActionIsInFlight:r,initiator:i}=e,a={};"touch"===i&&(a.transition="transform 200ms ease-out",this.props.canDrag&&o&&!n&&(a.boxShadow=this.theme.mediumBoxShadow,a.transform="scale(1.05)",a.borderRadius=3)),t&&(a.position="relative"),r&&(a.opacity=.5);A.Z.shouldAttributeChangesToAI()&&this.props.store.getCreatedById()===c.GR.id&&this.props.store.getLastEditedById()===c.GR.id&&this.theme.accentColors.purple[50];return{...a,...this.props.style}}}H.displayName="Selectable",H.contextTypes={...v.I3,...b.Tf,...r.w},H.opacitySpringConfig={stiffness:70,damping:10,precision:.001},H.dropzoneSize=4;const G=H;function K(e){return(0,W.jsx)(q.Z,{isVisible:e.isVisible,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:H.opacitySpringConfig},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowSelectionHalo:!0})},onAnimationEnd:()=>{e.isVisible||e.selectableStore.setState({...e.selectableStore.state,shouldShowSelectionHalo:!1})},render:()=>(0,W.jsx)("div",{className:S.No6,style:{position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,background:l.ZP.blueWithAlpha(.14),zIndex:p.py,borderRadius:4,...e.style}})},"halo")}function $(e){return(0,W.jsx)(q.Z,{isVisible:e.isVisible,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:H.opacitySpringConfig},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowDropParentHalo:!0})},onAnimationEnd:()=>{e.isVisible||e.selectableStore.setState({...e.selectableStore.state,shouldShowDropParentHalo:!1})},render:()=>(0,W.jsx)("div",{className:S.No6,style:{position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,background:l.ZP.blueWithAlpha(.07),borderRadius:4}})},"parent")}function Y(e,t,o){if(void 0===o)return{};const n=e.isMobile?3:2;return o===B.vh.Above||o===B.vh.Below?{position:"relative",left:-n,width:n,height:H.dropzoneSize,background:t.contentBackground,transform:"translateZ(100px)"}:{position:"relative",top:-n,width:H.dropzoneSize,height:n,background:t.contentBackground,transform:"translateZ(100px)"}}function Q(e,t,o,n,r){const i={position:"absolute",pointerEvents:"none",background:l.ZP.blueWithAlpha(.43),zIndex:p.S1-t};if(e===B.vh.Onto)i.left=0,i.top=0,i.right=0,i.bottom=0,i.background=l.ZP.blueWithAlpha(.14);else if(e===B.vh.Above||e===B.vh.Below){const t=4;i.left=0,i.right=0,e===B.vh.Above?(i.top=-t,o&&(i.top-=o)):(i.bottom=-t,n&&(i.bottom-=n)),i.height=H.dropzoneSize}else{const t=8;i.top=0,i.bottom=0,e===B.vh.Left?i.left=r?-r:-t:i.right=r?-r:-t,i.width=H.dropzoneSize}return i}function J(e){window.__c={n:"SelectableCurrentDropZone"};const t=(0,a.Fy)(),o=(0,s.Fg)(),n=void 0!==e.direction;return(0,W.jsx)(q.Z,{isVisible:n,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:H.opacitySpringConfig},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZone:!0})},onAnimationEnd:()=>{n||e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZone:!1})},render:()=>(0,W.jsx)("div",{style:Q(e.direction,0,e.aboveDropZoneMargin,e.belowDropZoneMargin,e.dropzoneGap),children:e.direction!==B.vh.Onto&&(0,W.jsx)("div",{style:Y(t,o,e.direction)})})},"dropZone")}function X(e){window.__c={n:"SelectableDropZoneHint"};const t=(0,a.Fy)(),o=(0,s.Fg)(),n=!d.z4(e.direction);return(0,W.jsx)(q.Z,{isVisible:n,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:H.opacitySpringConfig},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZoneHint:!0})},onAnimationEnd:()=>{n||e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZoneHint:!1})},render:()=>(0,W.jsx)("div",{style:Q(e.direction,(e.index||0)+1,e.aboveDropZoneMargin,e.belowDropZoneMargin,e.dropzoneGap),children:(0,W.jsx)("div",{style:Y(t,o,e.direction)})})},"hint")}(0,i.Rw)({canFormat:e=>Boolean(e&&e instanceof N.G),header(e){const{tr:t,td:o,object:n,objectSummary:r}=i.TI,a=P.C.findSelectableFromStore(e)||void 0,s=e.getTitleValue(),l=e.getType();return(0,N.KS)(e,s&&t({},o({},"block title:"),o({},r(s,{asJSON:!0}))),l&&t({},o({},"block type:"),o({},n(l))),a&&t({},o({},"<Selectable>:"),o({},n(a))))},hasBody:()=>!1,body:()=>null})},23189:(e,t,o)=>{o.d(t,{Z:()=>s});o(67294);var n=o(24405),r=o(8848),i=o(82990),a=o(85893);const s=function(e){window.__c={n:"SettingHeader"};const t=(0,n.Fg)(),{divider:o,large:s,block:l,children:c,hasMarginTop:d,small:p,style:u,smallMarginBottom:m,isCritical:g}=e,h="full"===o;return(0,a.jsx)("div",{style:{borderBottom:h?`1px solid ${t.regularDividerColor}`:0,marginBottom:h?16:m?2:8,marginTop:d?16:0,paddingBottom:h?12:0,fontSize:h?16:s?14:p?12:14,fontWeight:h?i.Z.fontWeight.medium:400,width:l?"100%":"auto",color:g?r.ZP.red:t.regularTextColor,...u},children:c})}},13490:(e,t,o)=>{o.d(t,{Z:()=>i});o(67294);var n=o(24405),r=o(85893);const i=function(e){window.__c={n:"SettingLabel"};const t=(0,n.yK)((t=>{const{hasMarginTop:o}=e,n={display:"block",marginBottom:4,fontSize:12,color:t.mediumTextColor};return o&&(n.marginTop=14),{style:n}}),[e]),{forId:o,children:i,style:a}=e;return(0,r.jsx)("label",{style:{...t.style,...a},htmlFor:o,children:i})}},35021:(e,t,o)=>{o.d(t,{Z:()=>u});o(67294);var n=o(83355),r=o(43593),i=o(54642),a=o(95477),s=o(24042),l=o(5315),c=o(77137),d=o(85893);class p extends n.Z{constructor(){super(...arguments),this.performRequest=async e=>r.E$(e.url,[a.default.secureFileS3.url,a.default.secureFileS3V2.url])?(e.permissionRecord&&await l.transactionQueue.awaitRecordTransaction(e.permissionRecord),i.getSignedFileUrl(this.environment,e,Boolean(s.Z.state.isNotionProtocolBugFixed))):e.url}renderComponent(){return(0,d.jsx)(c.Z,{request:{url:this.props.url,permissionRecord:this.props.permissionRecord,useS3Url:this.props.useS3Url},performRequest:this.performRequest,render:this.props.render})}}p.displayName="SignedUrl";const u=p},6854:(e,t,o)=>{o.d(t,{Pn:()=>v,ow:()=>b,wr:()=>S});var n=o(67294),r=o(480),i=o(24405),a=o(15145),s=o(1436),l=o(55863),c=o(5366),d=o(82007),p=o(75018),u=o(64964),m=(o(84076),o(89728)),g=o(73744),h=o(35683),f=o(85893);const y=(0,c.defineMessages)({open:{defaultMessage:"Open",id:"automations.buttonTrigger.open"},undo:{defaultMessage:"Undo",id:"automations.buttonTrigger.undo"}});function v(e){window.__c={n:"SnackbarButton"};const t=(0,i.Fg)();return(0,f.jsx)(m.Z,{...e,style:{color:t.regularInvertedTextColor,fontWeight:500,height:void 0,marginLeft:0,...e.style}})}function b(e){window.__c={n:"SnackbarUndoButton"};const{onUndo:t}=e,o=(0,r.O7)();return(0,f.jsx)(v,{onClick:()=>{d.Yw(o,!0),u.rN(),null==t||t()},children:(0,f.jsx)(c.FormattedMessage,{defaultMessage:"Undo",id:"snackbar.undo.title"})})}function S(e){window.__c={n:"SuccessSnackbarButtons"};const{blockStoreToOpen:t,performUndo:o}=e,d=(0,r.O7)(),u=(0,i.yK)((e=>({icon:{fill:e.regularInvertedTextColor},wrap:{display:"flex",columnGap:8}})),[]),m=(0,n.useMemo)((()=>t?e=>{p.navigateToBlock({environment:d,openInNew:(0,g.DJ)(e),store:t,visitType:h.vu.Link,pageVisitSource:a.tY.ButtonAutomation})}:void 0),[t,d]);return(0,f.jsxs)("div",{style:u.wrap,children:[m&&(0,f.jsx)(v,{onClick:m,icon:e=>(0,s.g)({...e,...u.icon,width:16,height:16}),style:{paddingRight:0},children:(0,f.jsx)(c.FormattedMessage,{...y.open})}),o&&(0,f.jsx)(v,{onClick:o,icon:e=>(0,l.s)({...e,...u.icon,marginTop:-2,width:16,height:16}),children:(0,f.jsx)(c.FormattedMessage,{...y.undo})})]})}},99571:(e,t,o)=>{o.d(t,{Z:()=>h});o(67294);var n=o(49271),r=o(76490),i=o(5366),a=o(33929),s=o(35328),l=o(2834),c=o(23864),d=o(65187),p=o(17377),u=o(85893);const m=(0,i.defineMessages)({placeholder:{defaultMessage:"Heading 2",id:"subheaderBlock.placeholder"}});class g extends l.Z{constructor(){super(...arguments),this.getHeaderTextStyle=()=>{const{device:e}=this.environment,t=this.rootStorePageFont.state,o=e.isMobile?1.25:r.Lh;return(0,r.HV)({fontSizeValue:o,fontFamily:t})}}activate(){s.th(this)}renderPersisted(){const{disabled:e}=this.props;return(0,u.jsx)("div",{style:this.getStyle(),children:(0,u.jsxs)(p.Z,{blockComponent:this,toggleStyle:this.getToggleStyle(),childrenStyleWhenToggleable:{display:"flex"},children:[(0,u.jsx)(d.Z,{tagName:"h3",disabled:e,store:this.props.store.getBlockTitleStore(),placeholder:a.default.formatMessage(m.placeholder),placeholderStyle:{WebkitTextFillColor:this.theme.headerBlockPlaceholderTextColor},style:{...n.ZD,...this.getHeaderTextStyle()},pasteBehavior:"block",legacyTransclusionParent:this.props.legacyTransclusionParent}),(0,u.jsx)(c.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})})}getStyle(){return{display:"flex",width:"100%",...this.getBlockColorStyle(),...this.props.style}}getToggleStyle(){const{device:e}=this.environment;return{height:`${(e.isMobile?1.25:r.Lh)*r.u9}em`,marginTop:e.isMobile?1:n.ZD.paddingTop,marginBottom:n.ZD.paddingBottom}}}const h=g},51704:(e,t,o)=>{o.d(t,{Z:()=>h});o(67294);var n=o(49271),r=o(76490),i=o(5366),a=o(33929),s=o(35328),l=o(2834),c=o(23864),d=o(65187),p=o(17377),u=o(85893);const m=(0,i.defineMessages)({placeholder:{defaultMessage:"Heading 3",id:"subsubheaderBlock.placeholder"}});class g extends l.Z{constructor(){super(...arguments),this.getHeaderTextStyle=()=>{const{device:e}=this.environment,t=this.rootStorePageFont.state,o=e.isMobile?1.17:r.C;return(0,r.Jr)({fontSizeValue:o,fontFamily:t})}}activate(){s.th(this)}renderPersisted(){const{disabled:e}=this.props;return(0,u.jsx)("div",{style:this.getStyle(),children:(0,u.jsxs)(p.Z,{blockComponent:this,toggleStyle:this.getToggleStyle(),childrenStyleWhenToggleable:{display:"flex"},children:[(0,u.jsx)(d.Z,{tagName:"h4",disabled:e,store:this.props.store.getBlockTitleStore(),placeholder:a.default.formatMessage(m.placeholder),placeholderStyle:{WebkitTextFillColor:this.theme.headerBlockPlaceholderTextColor},style:{...n.ZD,...this.getHeaderTextStyle()},pasteBehavior:"block",legacyTransclusionParent:this.props.legacyTransclusionParent}),(0,u.jsx)(c.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})})}getStyle(){return{display:"flex",width:"100%",...this.getBlockColorStyle(),...this.props.style}}getToggleStyle(){const{device:e}=this.environment;return{height:`${(e.isMobile?1.17:r.C)*r.u9}em`,marginTop:.5}}}const h=g},40235:(e,t,o)=>{o.d(t,{Z:()=>c});o(67294);var n,r=o(83355),i=o(82990),a=o(64369),s=o(85893);class l extends r.Z{renderComponent(){const{columns:e,rows:t,cellStyle:o,tableStyle:n,hideHeader:r}=this.props;return(0,s.jsxs)("table",{style:{...this.getStyle(),...n},children:[!r&&(0,s.jsx)("thead",{children:(0,s.jsx)("tr",{style:l.headerRowStyle,children:e.map((e=>(0,s.jsx)("th",{style:{...l.tableHeaderStyle,...e.style},children:(0,s.jsx)(a.Z,{isSmall:!0,children:e.header})},e.key)))})}),(0,s.jsx)("tbody",{children:t.map((t=>(0,s.jsx)("tr",{style:this.getRowStyle(),children:t.columns.map(((t,n)=>{const r=e[n];return(0,s.jsx)("td",{style:{...l.cellStyle,...o},children:t},r.key)}))},t.key)))})]})}getStyle(){return{width:"100%",fontSize:13,borderTop:`1px solid ${this.theme.regularDividerColor}`,borderBottom:`1px solid ${this.theme.regularDividerColor}`}}getRowStyle(){return{width:"100%",borderTop:`1px solid ${this.theme.regularDividerColor}`}}}n=l,l.displayName="TableBox",l.cellPaddingTopBottom=8,l.headerRowStyle={height:32,width:"100%"},l.tableHeaderStyle={fontWeight:i.Z.fontWeight.regular,textAlign:"left",paddingTop:n.cellPaddingTopBottom,paddingBottom:n.cellPaddingTopBottom},l.cellStyle={paddingTop:n.cellPaddingTopBottom,paddingBottom:n.cellPaddingTopBottom};const c=l},65187:(e,t,o)=>{o.d(t,{Z:()=>ce});var n=o(67294),r=o(83355),i=o(1302),a=o(41432),s=o(8848),l=o(22491),c=o(53877),d=o(42875),p=o(72126),u=o(62193),m=o(6746),g=o(21202),h=o(23867),f=o(70203),y=o(63143),v=o(5366),b=o(50906),S=o(14871),_=o(65770),w=o(97444),k=o(98724),x=o(56971),I=o(74284),C=o(17269),T=o(98104),M=o(32741),P=o(39699),A=o(1742),D=o(92022),B=o(48514),R=o(60682),E=o(30912),F=o(14976),N=o(19124),j=o(62619),O=o(33929),L=o(68056),U=o(45162),Z=o(73959),V=o(89086),q=o(66638),z=o(77907),W=o(8949),H=o(16772),G=o(66949),K=o(77080),$=o(69316),Y=o(52689),Q=o(23178),J=o(19111),X=o(35661),ee=o(10743),te=o(99757),oe=o(24666),ne=o(29595),re=o(93262),ie=o(42402),ae=o(85893);const se=(0,v.defineMessages)({typeTextPlaceholder:{defaultMessage:"Press â€˜/â€™ for commandsâ€¦",id:"text.commandsMenuNotOpen.placeholder"},typeAiTextPlaceholder:{defaultMessage:"Press â€˜spaceâ€™ for AI, â€˜/â€™ for commandsâ€¦",id:"text.commandsMenuNotOpen.placeholder.ai"},typeTextAiPlaceholder:{defaultMessage:"Press â€˜/â€™ for commands, â€˜spaceâ€™ for AIâ€¦",id:"text.commandsMenuNotOpen.placeholder.textAi"},filterPlaceholder:{defaultMessage:"Type to filterâ€¦",id:"text.commandsMenuOpen.placeholder"}});class le extends r.Z{constructor(e){super(e),this.editor=null,this.mergeEditorRefs=(0,u.sH)(),this.triggeredAnalytics=!1,this.reminderTimers={},this.renderContentContainer=(e,t)=>(0,ae.jsx)(ne.Z,{...this.classNameAndStyleStore.state,onBlur:this.props.onBlur,onFocus:this.props.onFocus,getDisabled:this.getDisabled,spellCheck:!this.canExclusivelyComment(),getHtml:this.getHtml,getSelection:this.getContainerSelection,onMutation:this.handleMutation,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,onSelect:t,placeholder:this.getCurrentPlaceholder(),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,suppressNewlineEvents:!0,disableContentEditableWhenNotEditingTextOnMobile:!0,id:this.props.id,tagName:this.props.tagName,...e,ref:this.mergeEditorRefs(this.handleEditorRef,e.leafRef)}),this.handleEditorRef=e=>{this.editor=e},this.handleCompositionStart=()=>{T.z9(this.environment,!0),this.props.onChange&&this.props.onChange()},this.isSpaceComposition=()=>{if(!this.shouldRenderInteractiveAiPlaceholder.state)return!1;const e=f.eeV(this.getTextValue());return 1===e.length&&("ã€€"===e[0]||" "===e[0])},this.handleCompositionEnd=()=>{T.z9(this.environment,!1),(0,U.Aw)(this.environment)&&w.g2({environment:this.environment,store:this.props.store,usingMultiSelection:!0}),this.props.onChange&&this.props.onChange(),this.isSpaceComposition()?(0,D.hr)({from:"spacebar",environment:this.environment}):P.createAndCommit({userAction:"Text.runAllFiltersAfterCompositionEnd",environment:this.environment,perform:e=>{C.G({environment:this.environment,store:this.props.store,transaction:e})}})},this.handleDelete=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;this.logTypingLag("typing_delete");const{store:t}=this.props,o=oe.default.state;if("editing"===o.mode){const n=o.multiSelection;n.start.store===t&&P.createAndCommit({userAction:"Text.handleDelete",environment:this.environment,perform:t=>{x.as({environment:this.environment,multiSelection:n,deleteForwards:!0,transaction:t,event:e})}})}pe(),this.props.onChange&&this.props.onChange()},this.handleForwardDeleteAtEndOfLine=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;const{store:t}=this.props,o=oe.default.state;if("editing"!==o.mode)return;const n=o.multiSelection;(0,L.iG)(n)&&(0,V.J_)(t,{startIndex:n.start.index,endIndex:n.end.index})&&this.handleDelete(e)},this.handleBackspace=e=>{if(!this.canEditStore.state||this.editor&&this.editor.isComposing)return;this.logTypingLag("typing_backspace");const{store:t}=this.props,o=oe.default.state;if("editing"===o.mode){const n=o.multiSelection;if(n.start.store===t){if(x.YV({device:this.environment.device,event:e,multiSelection:n}))return;P.createAndCommit({userAction:"Text.handleBackspace",environment:this.environment,perform:t=>{x.as({environment:this.environment,multiSelection:n,deleteForwards:!1,transaction:t,event:e})}})}}pe(),this.props.onChange&&this.props.onChange()},this.handleEnter=e=>{if(!this.canEditStore.state)return;if(this.logTypingLag("typing_enter"),j.IL(e),this.editor&&this.editor.isComposing)return;const t=oe.default.state;if("editing"===t.mode)if(this.props.onEnter)this.props.onEnter(e);else{const{multiSelection:e}=t;P.createAndCommit({userAction:"Text.handleEnter",environment:this.environment,perform:t=>{I.IO({environment:this.environment,multiSelection:e,transaction:t})}}),pe()}this.props.onChange&&this.props.onChange(e)},this.handleShiftEnter=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;const t=oe.default.state;if("editing"===t.mode){const{device:o}=this.environment;if(!("shiftKey"in e)||e.shiftKey&&!o.isIOS){if(this.props.disableShiftEnter)return;P.createAndCommit({userAction:"Text.handleShiftEnter",environment:this.environment,perform:e=>{w.hJ({environment:this.environment,string:"\n",multiSelection:t.multiSelection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}}),this.props.onChange&&this.props.onChange(e)}else this.handleEnter(e)}},this.handleTab=e=>{if(this.canEditStore.state){if(this.logTypingLag("typing_tab"),this.props.onTab){this.props.onTab(e)||e.preventDefault()}else{e.preventDefault();const t=(0,Z.sQ)(this.props.store);t&&(P.createAndCommit({userAction:"Text.handleTab",environment:this.environment,perform:e=>{w.n2({environment:this.environment,closestSelectable:t,shiftKey:!1,transaction:e})}}),pe())}this.props.onChange&&this.props.onChange()}},this.handleUntab=e=>{if(this.canEditStore.state){if(this.logTypingLag("typing_untab"),this.props.onUntab){this.props.onUntab(e)||e.preventDefault()}else{e.preventDefault();const t=(0,Z.sQ)(this.props.store);t&&(P.createAndCommit({userAction:"Text.handleUntab",environment:this.environment,perform:e=>{w.n2({environment:this.environment,closestSelectable:t,shiftKey:!0,transaction:e})}}),pe())}this.props.onChange&&this.props.onChange()}},this.handleAnnotation=(e,t)=>{this.canEditStore.state&&(t.preventDefault(),k.aS({environment:this.environment,annotation:e}),pe(),this.props.onChange&&this.props.onChange(),b.duO(this.environment,{type:f.J7s(e)}))},this.handleToggleHighlight=e=>this.handleAnnotation(["h",Y.Z.state.color],e),this.handleToggleBold=e=>this.handleAnnotation(["b"],e),this.handleToggleItalics=e=>this.handleAnnotation(["i"],e),this.handleToggleStrike=e=>this.handleAnnotation(["s"],e),this.handleToggleUnderline=e=>this.handleAnnotation(["_"],e),this.handleToggleCode=e=>this.handleAnnotation(["c"],e),this.handleClick=e=>{this.handleClickActions(e),this.props.onClick&&this.props.onClick(e)},this.handleContextMenu=e=>{const t=this.parentBlockStore.state;t&&F.li({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:t,canEdit:this.canEditStore.state})},this.handleMouseOver=e=>{F.vO({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state})},this.handleMouseOut=e=>{F.kV({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state})},this.handleCopy=e=>{this.props.onCopy?this.props.onCopy(e):S.JG({environment:this.environment,event:e,markdownLinkifyIt:this.props.markdownLinkifyIt})},this.handleCut=e=>{if(this.canEditStore.state){if(this.props.onCut)return this.props.onCut(e),void pe();S.by({environment:this.environment,event:e,markdownLinkifyIt:this.props.markdownLinkifyIt}),pe(),this.props.onChange&&this.props.onChange()}else e.preventDefault()},this.handlePaste=e=>{this.canEditStore.state&&(P.createAndCommit({userAction:"Text.handlePaste",environment:this.environment,perform:t=>{S.v({environment:this.environment,event:e,disableEmbedMenu:Boolean(this.props.disableEmbedMenu),transaction:t,onPasteFiles:this.props.onPasteFiles||S.AL,markdownLinkifyIt:this.props.markdownLinkifyIt,tinyMceMicrosoftWordPasteFilter:this.props.tinyMceMicrosoftWordPasteFilter})}}),pe(),this.props.onChange&&this.props.onChange())},this.handleKeyPress=e=>{if(" "===e.key&&!e.shiftKey&&!e.ctrlKey&&!e.altKey&&!this.getTextValue()&&this.shouldRenderInteractiveAiPlaceholder.state)return e.preventDefault(),void(0,D.hr)({from:"spacebar",environment:this.environment});this.canEditStore.state||e.metaKey&&"c"===e.key||e.preventDefault()},this.handleMoveUp=e=>{e.preventDefault(),P.createAndCommit({userAction:"Text.handleMoveUp",environment:this.environment,perform:e=>{w.fs({environment:this.environment,transaction:e,direction:"up"})}})},this.handleMoveDown=e=>{P.createAndCommit({userAction:"Text.handleMoveDown",environment:this.environment,perform:e=>{w.fs({environment:this.environment,transaction:e,direction:"down"})}})},this.aiTextPlaceholderMessage=this.createComputedStore((()=>"on"===K.default.getEligibleGroup({experimentId:"prioritize_slash_menu_block_placeholder",defaultGroup:"control"})?O.default.formatMessage(se.typeTextAiPlaceholder):O.default.formatMessage(se.typeAiTextPlaceholder)),!1,"aiTextPlaceholderMessageStore"),this.canEditStore=this.createComputedStore((()=>{if(this.props.disabled)return!1;if(te.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return(!this.props.isDiscussionInput||null==e||!e.hasPublicPermission||"view"!==e.permission)&&(!(!this.props.isDiscussionInput&&null!=e&&e.hasPublicPermission&&"edit"!==e.permission)&&this.props.store.canEdit())}),!1,"canEditStore"),this.getDisabled=()=>!this.canEditStore.state,this.getDefaultTruncateElement=()=>(0,ae.jsxs)(ie.Z,{disableUnderline:!0,style:{color:this.theme.mediumTextColor},onClick:e=>{e.preventDefault(),e.stopPropagation()},children:["â€¦","Â ",(0,ae.jsx)("span",{children:(0,ae.jsx)(v.FormattedMessage,{id:"text.truncated.showMoreLabel",defaultMessage:"more"})})]}),this.getHtml=()=>{var e;let t=this.getTextValue(),o=!1;if(this.props.canTruncate&&void 0!==this.props.maxChars){f.eeV(t).length>this.props.maxChars&&(t=f.KU1(this.getTextValue(),0,this.props.maxChars),o=!0)}const r=F.IY({environment:this.environment,textValue:t&&{value:t,spaceId:(0,h.C)(this.props.store.pointer.spaceId)},parentStore:this.props.parentStore||this.props.store,disableHover:!1,disableStyleAnnotations:Boolean(this.props.disableStyleAnnotations),disableDateStyleAnnotations:Boolean(this.props.disableDateMentions),disabled:!this.canEditStore.state,theme:this.theme,emojiType:(0,R.e_)(this.environment),katex:this.environment.KatexStore.getKatex(),parentBlockId:this.getParentBlockId(),renderedPageBlockId:null===(e=this.pageContext)||void 0===e?void 0:e.pageStore.id,formulaValueTypes:[],useExperimentalLinksToNonPageBlocks:this.useExperimentalLinksToNonPageBlocks.state}),i=(0,ae.jsxs)(n.Fragment,{children:[r,o&&this.getDefaultTruncateElement()]});return m.Z.renderToStaticMarkup(i)},this.clearBrowserSelection=()=>{var e;null===(e=this.getEditorNode())||void 0===e||e.blur()},this.getTextValue=()=>F.Rl({store:this.props.store,textValue:this.getTextValueHelper()}),this.getTextValueHelper=()=>{if(this.isNewDiscussionMenuTarget.state)return F.Gj({store:this.props.store});if(this.isInlineEquationOverlayTarget.state)return F.PY({store:this.props.store,equationStore:G.Z});if(this.isMentionMenuTarget.state)return F.Ob({store:this.props.store,mentionMenuState:this.isMentionMenuTarget.state});if(this.linkingMenuSelectionStore.state)return F.So({store:this.props.store,selection:this.linkingMenuSelectionStore.state});if(this.findAndReplaceStore.state){const e=this.findAndReplaceStore.state;return F.cD({store:this.props.store,find:e})}if(this.isCompletionPopupTarget.state)return F.fm({store:this.props.store,temporaryAnnotation:f.GKr.TemporarySelection,multiSelection:de()});const e=this.pageAnnotationBlockMenuStore.state;if(e)return e;if(this.isEditing.state){const e=oe.default.state;if("editing"===e.mode){const t=(0,L.QY)(e.multiSelection);if(t)return F.xX({store:this.props.store,selection:t.selection})}}return this.props.store.getValue()},this.useExperimentalLinksToNonPageBlocks=this.createComputedStore((()=>K.default.checkGate("experimental_non_page_block_links")),!1,"useExperimentalLinksToNonPageBlocks"),this.parentBlockStore=this.createComputedStore((()=>{const{store:e}=this.props;if(e.pointer.table===g.iU)return X.G.createChildStore(e,e.pointer)}),!1,"parentBlockStore"),this.isEditing=this.createComputedStore((()=>(0,V.J5)(this.props.store)),!1,"isEditing"),this.isSelectionEndpoint=this.createComputedStore((()=>(0,V.Gq)(this.props.store)),!1,"isSelectionEndpoint"),this.isCompletionsEnabledStore=this.createComputedStore((()=>{var e;const t=null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state;return(0,N.GD)(t)}),!1,"isCompletionsEnabledStore"),this.shouldRenderInteractiveAiPlaceholder=this.createComputedStore((()=>{if(this.environment.device.isMobile||this.environment.device.isMobileNative)return!1;if(this.props.disabled)return!1;if(!this.isCompletionsEnabledStore.state)return!1;const e=this.parentBlockStore.state,t=e&&e.getType();return Boolean(t&&(0,a.hD)(t))&&"contains-selection"===this.isEditing.state&&!(e&&(0,E.td)(e))}),!1,"shouldRenderInteractiveAiPlaceholder"),this.isNewDiscussionMenuTarget=this.createComputedStore((()=>{const e=B.Z.state;return e.open&&"inline"===e.type&&Boolean((0,U.r)(e.multiSelection,this.props.store))}),!1,"isNewDiscussionMenuTarget"),this.isCompletionPopupTarget=this.createComputedStore((()=>{const e=de();return e&&Boolean((0,U.r)(e,this.props.store))}),!1,"isCompletionPopupTarget"),this.isInlineEquationOverlayTarget=this.createComputedStore((()=>{var e;return G.Z.isOpen()&&(null===(e=(0,L.QY)(G.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store)===this.props.store}),!1,"isInlineEquationOverlayTarget"),this.isMentionMenuTarget=this.createComputedStore((()=>{const e=J.Z.state;return!!e.open&&(e.textStore===this.props.store&&e)}),!1,"isMentionMenuTarget"),this.linkingMenuSelectionStore=this.createComputedStore((()=>{const e=Q.Z.state;if(!e.open)return!1;if(!e.focusLinkInput&&!e.focusTitleInput)return!1;if(!this.isEditing.state)return!1;const t=(0,L.QY)(e.savedTextSelectionState.multiSelection);return!!t&&t.selection}),!1,"linkingMenuSelectionStore"),this.findAndReplaceStore=this.createComputedStore((()=>{const e=$.Z.state;return e.open&&e.findQuery.length>0?e.findQuery:void 0})),this.pageAnnotationBlockMenuStore=this.createComputedStore((()=>{const e=W.Z.state;if(!e.isActive)return;const{clickedPageAnnotation:t}=e;if(!t)return;const{parentStore:o,pageAnnotation:n}=t;if(o!==this.parentBlockStore.state)return;const r=this.props.store.getValue();return r?null==r?void 0:r.map((e=>f.km_(e)?[e[0],e[1].flatMap((e=>f.STW(e)&&e===n?[n,f.EPB()]:[e]))]:e)):void 0}),!1,"pageAnnotationBlockMenuStore"),this.getContainerSelection=()=>{const e=Boolean(this.linkingMenuSelectionStore.state);if((0,U.Aw)(this.environment)&&this.isSelectionEndpoint.state){if(e)return;return(0,V.HE)(this.props.store)}if(this.isEditing.state&&!e){const{store:e}=this.props,t=oe.default.state;if("editing"===t.mode){const o=(0,U.xI)("Text",t.multiSelection);if(o){const{selection:t}=o,n=e.getValue(),r=f.eeV(n).length;return{type:"contain",selection:{startIndex:Math.min(t.startIndex,r),endIndex:Math.min(t.endIndex,r)}}}}}},this.getEndSelection=()=>{const e=f.eeV(this.getTextValue());return{startIndex:e.length,endIndex:e.length}},this.classNameAndStyleStore=this.createComputedStore((()=>(0,l.iv)(this.getStyle(),this.props.className)),!1,"classNameAndStyleStore"),this.handleMutation=this.handleMutation.bind(this)}willMountOrUpdate(){this.createReminderTimers(),this.environment.KatexStore.loadIfNeeded(this.getTextValue)}willUnmount(){this.clearReminderTimers(),M.qA(this.props.store)}isComposing(){return this.editor&&this.editor.isComposing}createReminderTimers(){const e=this.getTextValue(),t=f.nai(e),o=p.oA(t.map((e=>{const t=(0,c.KR)(e,(0,d.r)());return null==t?void 0:t.toMillis()}))),n=Date.now();for(const r of o){const e=r-n;e>0&&e<y.A0&&(r in this.reminderTimers||(this.reminderTimers[r]=setTimeout(this.enqueueForceUpdate,e)))}for(const r in this.reminderTimers)o.includes(parseInt(r))||(clearTimeout(this.reminderTimers[r]),delete this.reminderTimers[r])}clearReminderTimers(){for(const e in this.reminderTimers)clearTimeout(this.reminderTimers[e]),delete this.reminderTimers[e]}renderComponent(){const{disableInsertText:e,disableStyleAnnotations:t,disableSelectAllBlocks:o,disableSelectionDrag:n,disableDrag:r,disabled:i}=this.props;return(0,ae.jsx)(re.Z,{...this.props,clearBrowserSelection:this.clearBrowserSelection,getEndSelection:this.getEndSelection,canInsertText:!i&&!e,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onDelete:this.handleDelete,onDeleteToEndOfLine:this.handleForwardDeleteAtEndOfLine,onDeleteNextWord:this.handleForwardDeleteAtEndOfLine,onBackspace:this.handleBackspace,onEnter:this.handleEnter,onShiftEnter:this.handleShiftEnter,onTab:this.handleTab,onUntab:this.handleUntab,onToggleHighlight:this.handleToggleHighlight,onToggleBold:this.handleToggleBold,onToggleItalics:this.handleToggleItalics,onToggleStrike:this.handleToggleStrike,onToggleUnderline:this.handleToggleUnderline,onToggleCode:this.handleToggleCode,onCopy:this.handleCopy,onCut:this.handleCut,onPaste:this.handlePaste,onKeyPress:this.handleKeyPress,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,render:this.renderContentContainer,disableAnnotation:t,canSelectAllBlocks:!o,canSelectionDrag:!n,disableDrag:r,topBottomPadding:9})}getCurrentPlaceholder(){const{device:e}=this.environment;if(this.shouldRenderInteractiveAiPlaceholder.state)return this.aiTextPlaceholderMessage.state;if(this.props.placeholder)return this.props.placeholder;if(!this.props.disabled){if(!this.props.disableSlashCommands&&"contains-selection"===this.isEditing.state&&this.canEditStore.state){if(ee.Z.state.open)return O.default.formatMessage(se.filterPlaceholder);if(!e.isMobile)return O.default.formatMessage(se.typeTextPlaceholder)}return" "}}handleMutation(e){if(this.logTypingLag("typing_lag"),!this.canEditStore.state)return;(0,U.Aw)(this.environment)?P.createAndCommit({userAction:"Text.handleMutation",environment:this.environment,perform:t=>{let o=this.props.store;const{multiSelection:n}=e;if(n&&!(0,L.qS)(n))o=n.start.store;else if(this.props.legacyTransclusionParent&&!e.insertedLine&&!e.isComposing&&!e.deletedLine){const e=_.Z2({environment:this.environment,store:o,parentStore:this.props.legacyTransclusionParent,transaction:t});e&&(o=e)}if(w.YV({environment:this.environment,store:o,newValue:e.newValue,disableMentions:Boolean(this.props.disableMentions),disableDateMentions:Boolean(this.props.disableDateMentions),disableDateReminderMentions:Boolean(this.props.disableDateReminderMentions),disableSlashCommands:Boolean(this.props.disableSlashCommands),disableEmojiCommands:Boolean(this.props.disableEmojiCommands),disableFilters:e.isComposing,disableTemplateVariableMentions:Boolean(this.props.disableTemplateVariableMentions),transaction:t,multiSelection:n}),e.insertedLine){const e="editing"===oe.default.state.mode&&oe.default.state.multiSelection;e&&I.IO({environment:this.environment,multiSelection:e,transaction:t})}this.props.trackEditsToUserFlow&&!t.isEmpty()&&A.uO(this.environment,this.props.trackEditsToUserFlow,t)}}):P.createAndCommit({userAction:"Text.handleMutation",environment:this.environment,perform:t=>{w.aS({environment:this.environment,store:this.props.store,newValue:e.newValue,disableMentions:Boolean(this.props.disableMentions),disableDateMentions:Boolean(this.props.disableDateMentions),disableDateReminderMentions:Boolean(this.props.disableDateReminderMentions),disableSlashCommands:Boolean(this.props.disableSlashCommands),disableEmojiCommands:Boolean(this.props.disableEmojiCommands),disableTemplateVariableMentions:Boolean(this.props.disableTemplateVariableMentions),disableFilters:e.isComposing,transaction:t})}});const{store:t}=this.props,o=this.parentBlockStore.state;if(o){if(o.getType()){const e=o.getSchema()||{};if("properties"===t.path[0]&&t.path[1]){e[t.path[1]]&&!this.triggeredAnalytics&&(this.triggeredAnalytics=!0)}}}this.props.onChange&&this.props.onChange()}handleClickActions(e){F.SD({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state,disableEquationInteraction:this.props.disableEquationInteraction})}canComment(){return!this.props.disabled&&this.props.store.canComment()}canExclusivelyComment(){return this.canComment()&&!this.canEditStore.state}focus(){this.isEditing.state||T.NX({store:this.props.store})}getEditorNode(){var e;return(null===(e=this.editor)||void 0===e?void 0:e.getNode())||void 0}getParentBlockId(){const{store:e}=this.props;if(e.table===g.iU)return e.id;const{ancestor:t}=e.findRecordStoreUIAncestor((e=>{let{table:t}=e;return t===g.iU}));return t?t.id:void 0}isEmpty(){return 0===f.lzi(this.getTextValue()).length}logTypingLag(e){const t=!this.props.disabled&&"inline"===this.props.pasteBehavior;(0,q.u)({type:e,environment:this.environment,blockStore:this.parentBlockStore.state,store:this.props.store,isInCollectionView:t})}getStyle(){const{device:e}=this.environment;let t={maxWidth:"100%",width:"100%",whiteSpace:"pre-wrap",wordBreak:"break-word",caretColor:this.canExclusivelyComment()?s.ZP.transparent:this.theme.regularTextColor,...this.props.style};return this.isEmpty()&&(t.minHeight="1em",t={...t,color:this.theme.regularTextColor,WebkitTextFillColor:this.theme.lightTextColor,...this.props.placeholderStyle}),e.isMobile&&this.canEditStore.state&&(this.isEditing.state?t.WebkitUserModify="read-write-plaintext-only":(t.userSelect="none",t.WebkitUserSelect="none",t.whenFocusedEditable={userSelect:"text",WebkitUserSelect:"text",WebkitUserModify:"read-write-plaintext-only"})),t}}le.displayName="Text";const ce=n.forwardRef((function(e,t){const{value:o}=(0,z.useDependency)(z.deps.markdownLinkifyIt),{value:n}=(0,z.useDependency)(z.deps.tinyMceMicrosoftWordPasteFilter);return(0,ae.jsx)(le,{...e,ref:t,markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n})}));function de(){const e=H.default.state;return("closedWithContext"===e.type||"completionPopup"===e.type&&"initialPromptForAIBlock"!==e.stage)&&"textSelection"===e.context.type?e.context.textSelection:void 0}function pe(){i.default.flush()}},17970:(e,t,o)=>{o.d(t,{Z:()=>h});var n=o(67294),r=o(86628),i=o(24405),a=o(49271),s=o(62965),l=o(73819),c=o(77080),d=o(23864),p=o(55217),u=o(65187),m=o(85893);function g(e,t){let{disabled:o,disableCommentMenu:s,disableHoverMenu:g,disableDrag:h,hideContent:y,legacyTransclusionParent:v,store:b,style:S}=e;window.__c={n:"TextBlock"};const _=(0,r.VK)((()=>b.getBlockTitleStore()),[b]),w=(0,r.VK)((()=>b.getContentStore()),[b]),k=(0,n.useRef)(null),x=(0,r.VK)((()=>w.getValue()||[]),[w]),I=(0,r.VK)((()=>{if(!c.default.checkGate("text_align"))return{};const{block_alignment:e}=b.getFormat();switch(e){case"right":case"center":return{textAlign:b.getFormat().block_alignment};default:return{textAlign:"left"}}}),[b]),C=(0,r.VK)((()=>{if(!c.default.checkGate("text_align"))return{};const{block_alignment:e}=b.getFormat();switch(e){case"center":return{textAlign:"left",paddingLeft:"50%"};case"right":return{textAlign:"right"};default:return{textAlign:"left"}}}),[b]),T=(0,l.rv)(b),M=(0,i.yK)((()=>({root:{...I,...T,...S}})),[I,T,S]),P=x.length>0?(0,m.jsx)("div",{style:f,children:(0,m.jsx)(p.Z,{disabled:o,store:w,disableCommentMenu:s,disableHoverMenu:g,disableDrag:h})}):(0,m.jsx)(p.Z,{disabled:!0,store:w}),A=(0,m.jsxs)("div",{style:M.root,ref:k,children:[(0,m.jsxs)("div",{style:{display:"flex"},children:[(0,m.jsx)(u.Z,{style:a.ZD,placeholderStyle:C,disabled:o,store:_,pasteBehavior:"block",legacyTransclusionParent:v,trackEditsToUserFlow:"user_flow_edit_block"}),(0,m.jsx)(d.Z,{disableCommentMenu:s,hideContent:y,store:b})]}),!y&&P]});return(0,l.ez)(b,t,(0,n.useMemo)((()=>({renderedType:"text",getBlockStore:()=>b,getNode:()=>k.current})),[b]),A)}const h=n.memo(n.forwardRef(g),s.Z),f={paddingLeft:"1.5em",display:"flex",flexDirection:"column"}},11620:(e,t,o)=>{o.d(t,{Z:()=>k});o(67294);var n=o(53150),r=o(49271),i=o(80951),a=o(72126),s=o(5366),l=o(50906),c=o(9953);var d=o(39699),p=o(33929),u=o(27724),m=o(2834),g=o(23864),h=o(7825),f=o(60458),y=o(55217),v=o(78454),b=o(65187),S=o(85893);const _=(0,s.defineMessages)({placeholder:{defaultMessage:"To-do",id:"todoBlock.placeholder"}});class w extends m.Z{constructor(){super(...arguments),this.labelAriaId=(0,n.Z)(),this.handleCheckboxClick=e=>{this.toggleChecked()}}activate(){this.toggleChecked()}renderPersisted(){return(0,S.jsxs)(v.ZP,{style:this.getStyle(),left:this.renderCheckbox(),childrenStyle:{display:"flex",flexDirection:"column"},children:[(0,S.jsxs)("div",{style:{display:"flex"},children:[this.renderTitle(),(0,S.jsx)(g.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store,style:h._1})]}),!this.props.hideContent&&this.renderContent()]})}renderCheckbox(){return(0,S.jsx)(f.Z,{"aria-labelledby":this.labelAriaId,checked:this.isChecked(),onClick:this.handleCheckboxClick,disabled:!this.canEdit(),size:16,fill:this.getBlockColorStyle().color,tapArea:this.environment.device.isMobile?{size:30}:void 0})}renderTitle(){return(0,S.jsx)(b.Z,{id:this.labelAriaId,style:this.getTitleStyle(),disabled:this.props.disabled,store:this.props.store.getBlockTitleStore(),placeholder:p.default.formatMessage(_.placeholder),pasteBehavior:"block",legacyTransclusionParent:this.props.legacyTransclusionParent})}renderContent(){const{disabled:e}=this.props;return(0,S.jsx)(y.Z,{disabled:e,store:this.props.store.getContentStore(),disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})}isChecked(){const e=this.props.store.getProperties();return!!e&&i.Ml(e.checked)}toggleChecked(){if(this.canEdit()){let e;e=a.q9(u.default.state.stores,this.props.store)?u.default.state.stores:[this.props.store],this.isChecked()?d.createAndCommit({userAction:"TodoBlock.toggleChecked",environment:this.environment,perform:t=>{!function(e){const{environment:t,blocks:o,transaction:n}=e;for(const r of o)c.sW({store:r.getPropertiesStore(),data:{checked:i._I(!1)},transaction:n});l.JrP(t,{is_checked:!1})}({environment:this.environment,blocks:e,transaction:t})}}):d.createAndCommit({userAction:"TodoBlock.toggleChecked",environment:this.environment,perform:t=>{!function(e){const{blocks:t,transaction:o,environment:n}=e;for(const r of t)c.sW({store:r.getPropertiesStore(),data:{checked:i._I(!0)},transaction:o});l.JrP(n,{is_checked:!0})}({environment:this.environment,blocks:e,transaction:t})}})}}getStyle(){return{paddingLeft:r.ZD.paddingLeft,...this.getBlockColorStyle(),...this.props.style}}getTitleStyle(){return{...v.R8,width:void 0,flexGrow:1,...this.isChecked()&&{textDecoration:"line-through",textDecorationColor:this.theme.strikethroughLineColor,opacity:1,color:this.theme.mediumTextColor}}}}const k=w},4859:(e,t,o)=>{o.d(t,{J9:()=>B,ZP:()=>D,kA:()=>R});var n=o(67294),r=o(480),i=o(86628),a=o(24405),s=o(49271),l=o(72126),c=o(62965),d=o(5366),p=o(50906),u=o(29373),m=o(39699),g=o(28020),h=o(52315),f=o(73819),y=o(77080),v=o(27724),b=o(45131),S=o(23864),_=o(7825),w=o(64921),k=o(25777),x=o(55217),I=o(78454),C=o(65187),T=o(5210),M=o(85893);const P=(0,d.defineMessages)({placeholder:{defaultMessage:"Toggle",id:"toggleBlock.placeholder"}});function A(e,t){window.__c={n:"ToggleBlock"};const o=(0,r.O7)(),c=(0,d.useIntl)(),A=(0,n.useRef)(!0);(0,n.useLayoutEffect)((()=>{A.current&&(A.current=!1,u.nz({blockId:e.store.id,currentUserId:o.currentUser.id}),e.store.isDefaultRecordCache()&&u.LO(o,e.store.pointer))}));const D=(0,n.useRef)(null),E=(0,i.VK)((()=>e.store.getBlockTitleStore()),[e.store]),F=(0,i.VK)((()=>e.store.getContentStore()),[e.store]),N=(0,i.VK)((()=>b.Z.isOpen(e.store.id)&&!e.hideContent),[e.hideContent,e.store.id]),j=(0,i.VK)((()=>!e.store.hasContent()),[e.store]),O=(0,n.useId)(),L=(0,n.useId)(),U=(0,i.VK)((()=>h.b(e.store)||!e.store.isDefaultRecordCache()),[e.store]),Z=(0,i.VK)((()=>y.default.checkGate("layout_toggles")),[]),V=(0,n.useCallback)((()=>{let t;t=l.q9(v.default.state.stores,e.store)?v.default.state.stores:[e.store];const n=!N;for(const e of t)u.rd({blockId:e.id,state:n,currentUserId:o.currentUser.id});p.jRT(o,{is_toggled:n})}),[o,N,e.store]),q=(0,n.useCallback)((()=>{m.createAndCommit({userAction:"ToggleBlock.handlePlaceholderClick",environment:o,perform:t=>{u.ls({environment:o,store:e.store,transaction:t})}})}),[o,e.store]),z=(0,n.useCallback)((e=>{if(e.shiftKey){const e=g.np();e&&u.X_(o,e)}else V()}),[o,V]),W=(0,f.rv)(e.store),H=(0,a.yK)((t=>({root:{paddingLeft:s.ZD.paddingLeft,...W,...e.style},placeholderButton:{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:t.lightTextColor,...s.ZD,marginTop:2},placeholderText:{color:t.lightTextColor}})),[W,e.style]),G=(0,M.jsx)(w.Z,{style:H.placeholderButton,onClick:q,disabled:e.disabled,children:(0,M.jsx)("span",{style:H.placeholderText,children:(0,M.jsx)(d.FormattedMessage,{defaultMessage:"Empty toggle. Click or drop blocks inside.",id:"toggleBlock.emptyBlock.placeholderText"})})}),K=(0,M.jsxs)(I.ZP,{style:H.root,left:(0,M.jsx)(T.Z,{"aria-describedby":O,"aria-controls":L,isSidebar:!1,open:N,fill:!j,onClick:z,tapArea:o.device.isMobile?{size:30}:void 0}),leftStyle:{paddingRight:2},ref:D,children:[(0,M.jsxs)("div",{style:{display:"flex"},children:[(0,M.jsx)(C.Z,{id:O,style:I.R8,disabled:e.disabled,store:E,placeholder:c.formatMessage(P.placeholder),pasteBehavior:"block"}),(0,M.jsx)(S.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store,style:_._1,recursivelyLoadAllDiscussions:!N})]}),N?(0,M.jsx)(k.Z,{id:L,loaded:U,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:R(Z),style:B(Z),children:(0,M.jsx)(x.Z,{store:F,emptyPlaceholder:G,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})}):(0,M.jsx)(x.Z,{store:F,disabled:e.disabled,disableContent:!0})]});return(0,f.ez)(e.store,t,(0,n.useMemo)((()=>({renderedType:"toggle",getNode:()=>D.current,getBlockStore:()=>e.store,activate(){V()}})),[e.store,V]),K)}const D=n.memo(n.forwardRef(A),c.Z);function B(e){return e?{display:"flex"}:void 0}function R(e){return e?{display:"flex",flexDirection:"column",width:"100%"}:{display:"flex",flexDirection:"column"}}},5210:(e,t,o)=>{o.d(t,{Z:()=>m,q:()=>p});var n=o(67294),r=o(480),i=o(24405),a=o(17693),s=o(91),l=o(5366),c=o(64921),d=o(85893);function p(e){let{isSidebar:t,isMobile:o}=e;return t&&!o?20:24}const u=(0,l.defineMessages)({open:{defaultMessage:"Open",id:"toggleButton.open"},close:{defaultMessage:"Close",id:"toggleButton.close"}});function m(e){window.__c={n:"ToggleButton"};const t=(0,r.Fy)(),o=(0,l.useIntl)(),m=(0,n.useMemo)((()=>p({isSidebar:e.isSidebar,isMobile:t.isMobile})),[t.isMobile,e.isSidebar]),g=(0,i.yK)((()=>{const o=e.color||"inherit",n="chevron"===e.icon?`rotateZ(${e.open?0:-90}deg)`:`rotateZ(${e.open?180:90}deg)`,r="chevron"===e.icon,i=r&&t.isMobile;return{button:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:m,height:m,borderRadius:4,...e.style},arrow:{width:i?14:r?12:"0.6875em",height:i?14:r?12:"0.6875em",transition:"transform 200ms ease-out",transform:n,fill:o,opacity:e.fill?1:.5}}}),[t.isMobile,e.color,e.fill,e.icon,e.open,e.style,m]),h=(0,n.useMemo)((()=>{switch(e.icon){case"chevron":return(0,a.A)(g.arrow);case"triangle":default:return(0,s.L)(g.arrow)}}),[e.icon,g.arrow]);return(0,d.jsxs)(c.Z,{ariaLabel:e.open?o.formatMessage(u.close):o.formatMessage(u.open),"aria-describedby":e["aria-describedby"],"aria-expanded":e.open,"aria-controls":e.open?e["aria-controls"]:void 0,style:g.button,onClick:e.onClick,onMouseDown:e.onMouseDown,disabled:e.disabled,allowShiftClick:!0,children:[e.tapArea&&(0,d.jsx)("div",{style:{position:"absolute",opacity:0,width:e.tapArea.size,height:e.tapArea.size,top:-(e.tapArea.size-m)/2,left:-(e.tapArea.size-m)/2}}),h]})}},85567:(e,t,o)=>{o.d(t,{Z:()=>f});var n=o(67294),r=o(83355),i=o(84939),a=o(8848),s=o(84619),l=o(19525),c=o(82990),d=o(43224),p=o(4023),u=o(64921),m=o(26388),g=o(85893);class h extends r.Z{constructor(){super(...arguments),this.tokenTextRef=n.createRef(),this.shouldShowFullValueTooltip=()=>Boolean(this.props.showFullValueTooltip&&this.tokenTextRef.current&&this.tokenTextRef.current.offsetWidth<this.tokenTextRef.current.scrollWidth)}renderComponent(){const e=this.theme;if(this.props.showFullValueTooltip||void 0!==this.props.tooltip)return(0,g.jsx)(m.Z,{placement:this.props.tooltipPlacement??p.u.Right,renderTooltip:t=>(0,g.jsxs)("div",{...t,style:d.F,children:[this.props.showFullValueTooltip&&(0,g.jsx)("div",{children:this.props.value}),void 0!==this.props.tooltip&&(0,g.jsx)("div",{style:{color:this.props.showFullValueTooltip?e.mediumInvertedTextColor:void 0},children:this.props.tooltip})]}),originGap:20,textWrap:!0,render:e=>(0,g.jsx)("div",{style:this.getStyle(),...e,onMouseEnter:t=>{(this.shouldShowFullValueTooltip()||void 0!==this.props.tooltip)&&e.onMouseEnter&&e.onMouseEnter(t)},children:this.renderTokenContent()})});if(this.props.onClick){const e=this.props.backgroundColor?{background:(0,i._j)(this.props.backgroundColor,1)}:void 0,t=this.props.backgroundColor?{background:(0,i._j)(this.props.backgroundColor,2)}:void 0;return(0,g.jsx)(u.Z,{style:this.getStyle(),hoveredStyle:e,pressedStyle:t,onClick:this.props.onClick,children:this.renderTokenContent()})}return(0,g.jsx)("div",{style:this.getStyle(),children:this.renderTokenContent()})}renderTokenContent(){const{height:e}=(0,s.e1)(this.props.format);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{style:{...this.props.shouldWrap?{overflowWrap:"anywhere"}:c.Z.textOverflowStyle,textDecoration:this.props.isStrikedThrough?"line-through":void 0,display:"inline-flex",alignItems:"center",height:e,lineHeight:`${e}px`},children:[this.renderColoredDot(),(0,g.jsx)("span",{style:{...c.Z.textOverflowStyle},ref:this.tokenTextRef,children:this.props.value})]}),this.renderRemoveButton()]})}renderColoredDot(){if(this.props.showColoredDot)return(0,g.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,g.jsx)("div",{style:this.getDotStyle(this.props.showColoredDot)})})}renderRemoveButton(){const{format:e}=this.props,t=function(e){switch(e){case s.lo.Large:return 10;case s.lo.ExtraSmall:case s.lo.Small:case s.lo.Medium:case s.lo.Inline:default:return 8}}(e),{height:o}=(0,s.e1)(e);if(this.props.showRemoveButton)return(0,g.jsx)(u.Z,{onClick:this.props.onClickRemove,style:{...h.removeButtonStyle,width:o,height:o},disabled:this.props.disabled,disabledFeedback:!1,mobileFeedback:!0,className:"notion-token-remove-button",children:(0,l.b)({width:t,height:t,opacity:.5})})}getStyle(){const{format:e,isSingle:t,shouldShrink:o,isRound:n,shouldWrap:r}=this.props,{height:i,fontSize:l,paddingLeft:c,margin:d}=(0,s.e1)(e),{ThemeStore:p}=this.environment,u=n?c+1:c;return{display:t?"inline-flex":"flex",alignItems:"center",flexShrink:t||o?1:0,minWidth:0,maxWidth:"100%",height:i,borderRadius:n?i/2:3,paddingLeft:u,paddingRight:this.props.showRemoveButton?0:n?u+2:u,fontSize:l,lineHeight:"120%",opacity:this.props.disabled&&this.props.disabledFeedback?.4:void 0,color:this.props.color||("light"===p.state.mode?this.theme.regularTextColor:a.ZP.whiteWithAlpha(.7)),background:this.props.backgroundColor||this.theme.legacyDefaultSelectColor,margin:t?0:d,...r&&{height:void 0,paddingTop:4,paddingBottom:4},...this.props.style}}getDotStyle(e){const{format:t}=this.props,o=(0,s.Nv)(t),n="default"===e?"gray":e;return void 0===n?{}:{marginRight:5,borderRadius:99,height:o,width:o,backgroundColor:"light"===this.theme.mode?this.theme.accentColors[n][400]:this.theme.accentColors[n][700],display:"inline-flex",flexShrink:0}}}h.displayName="Token",h.removeButtonStyle={display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,marginLeft:2,marginRight:2};const f=h},91791:(e,t,o)=>{o.d(t,{Z:()=>ge});var n=o(45697),r=o.n(n),i=o(67294),a=o(83355),s=o(13991),l=o(49085),c=o(15145),d=o(41432),p=o(8848),u=o(9999),m=o(42853),g=o(61061),h=o(44495),f=o(54497),y=o(26825),v=o(27006),b=o(82990),S=o(51454),_=o(5366),w=o(50906),k=o(14871),x=o(47307),I=o(24677),C=o(64964),T=o(98104),M=o(29373),P=o(39699),A=o(95477),D=o(80365),B=o(84210),R=o(12534),E=o(87290),F=o(33929),N=o(87279),j=o(39500),O=o(67669),L=o(18514),U=o(89224),Z=o(61766),V=o(88632),q=o(55367),z=o(80796),W=o(22294),H=o(88923),G=o(35661),K=o(69784),$=o(49557),Y=o(77933),Q=o(4350),J=o(2834),X=o(13966),ee=o(23063),te=o(64921),oe=o(31945),ne=o(84076),re=o(78140),ie=o(76798),ae=o(72495),se=o(83182),le=o(29551),ce=o(55217),de=o(79954),pe=o(85893);const ue=(0,_.defineMessages)({copySuccessMessage:{defaultMessage:"Copied! Now paste in any page to sync content.",id:"transclusionContainerBlock.actions.copySuccessMessage"}});class me extends J.Z{constructor(){super(...arguments),this.storeTypes={hovered:l.default.createClass(!1),haloShouldBeVisible:l.default.createClass(!1),actionBarShouldBeVisible:l.default.createClass(!1),backlinksIndicatorButtonPopupStore:Z.Z},this.fakeSelectionTrapRef=i.createRef(),this.renderHaloContent=()=>(0,pe.jsx)("div",{style:{position:"absolute",left:-6,right:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:8,border:`2px solid ${this.theme.transclusionBorderColor}`}}),this.renderActionBarContent=()=>{const e=this.numberOfBacklinks.state,t=V.Z.state.online,o=this.hasDifferingReadPermissionsFromSource.state,{isDesktop:n}=this.environment.device;return(0,pe.jsxs)("div",{style:this.getActionBarStyle(),children:[t&&(0,pe.jsx)(oe.ZP,{popupType:oe.Z4.Popup,onClick:this.handleActionBarBacklinksClick,originGap:4,renderOrigin:t=>(0,pe.jsxs)(te.Z,{style:this.getActionButtonStyle(),...t,children:[e>0?(0,pe.jsx)(_.FormattedMessage,{defaultMessage:"Editing in {icon} {numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}}",id:"transclusionContainerBlock.editingMultiple",values:{icon:(0,u.J)({width:14,transform:"rotate(180deg)",marginLeft:4,marginRight:4}),numberOfBacklinks:e}}):(0,pe.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.editingOriginal",defaultMessage:"Editing original"}),o&&(0,f.t)({width:14,fill:(0,p.fi)("orange",this.theme).fill,marginLeft:6}),(0,m.i)({width:10,fill:this.theme.mediumIconColor,marginLeft:4})]}),render:this.renderBacklinksMenu}),n&&(0,pe.jsx)(te.Z,{style:this.getActionButtonStyle(),onClick:this.handleCopyClick,children:(0,pe.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.copy",defaultMessage:"Copy and sync"})}),(0,pe.jsx)(X.Z,{store:this.getParentStore(),fadeIn:!1,style:{width:30,height:void 0},iconStyle:{marginTop:1,fill:this.theme.regularTextColor}})]})},this.renderBacklinksMenu=()=>{const{store:e}=this.props,t={menuType:N.og.Popup,width:400},o=this.hasDifferingReadPermissionsFromSource.state,n=e.getNavigableBlockStore(),r=o&&n?(0,pe.jsx)(ne.Z,{underline:!0,inline:!0,href:(0,B.ZP)({store:n,fullyQualified:!1,pageVisitSource:c.tY.Breadcrumb}),style:{color:this.theme.mediumTextColor},children:(0,pe.jsx)(ie.Z,{store:n,style:{display:"inline"}})}):void 0;return(0,pe.jsxs)(re.Z,{...t,children:[o&&n&&(0,pe.jsx)(ae.Z,{style:{background:this.theme.sidebarSecondaryBackground},children:(0,pe.jsxs)("div",{style:{display:"flex",fontSize:12,padding:"6px 16px"},children:[(0,g.B)({width:16,marginTop:6,marginRight:8,color:this.theme.regularIconColor}),(0,pe.jsx)("div",{children:(0,pe.jsx)(_.FormattedMessage,{defaultMessage:"Viewership permissions on this page are different from the original page <page></page>. Some members might not have access.",id:"transclusionContainerBlock.differingPermissionsWarning",values:{page:()=>r}})})]})}),(0,pe.jsx)(ae.Z,{topBorder:o,children:(0,pe.jsx)(Y.Z,{type:"transclusion_container",store:this.props.store,originalTransclusionStore:this.props.store,disableArrow:!0})}),(0,pe.jsx)(ye,{})]})},this.handleCopyClick=()=>{I.Z5({environment:this.environment,stores:[this.getParentStore()]});const e=this.fakeSelectionTrapRef.current;e&&this.environment.device.isSafari?(U.setOnNode(e,this.environment.device),k.f4(),U.clear(this.environment)):k.f4(),w.EVQ(this.environment),C.oV({label:F.default.formatMessage(ue.copySuccessMessage),helpUrl:(0,L.UY)("guides.transclusions")})},this.handleMouseEnter=()=>{z.Z.state.isDragging||K.Z.state.isActive||this.disableTransclusionUI.state||this.stores.hovered.setState(!0)},this.handleMouseLeave=()=>{z.Z.state.isDragging||K.Z.state.isActive||this.disableTransclusionUI.state||this.stores.hovered.setState(!1)},this.handleEmptyClick=e=>{(0,R.ZP)({event:e,context:R.Af.EditorClick,callback:()=>{(0,j.uG)(e)||P.createAndCommit({userAction:"TransclusionContainerBlock.handleEmptyClick",environment:this.environment,perform:e=>{M.ls({environment:this.environment,store:this.props.store,transaction:e})}})}})},this.handleActionBarBacklinksClick=()=>{I.Z5({environment:this.environment,stores:[this.getParentStore()]}),w.llH(this.environment,{from:"action_bar"})},this.currentState=this.createComputedStore((()=>{const e=this.getParentStore();return(0,E.B)(e,this.stores.hovered.state)})),this.showActionBar=this.createComputedStore((()=>{const e=this.currentState.state;return!(e!==E.x.Selected&&e!==E.x.SelectedDescendant||$.Z.state.isActive||q.ZP.state.isDragging||K.Z.state.isActive||W.Z.state.isKeyboardMode)})),this.numberOfBacklinks=this.createComputedStore((()=>{const e=(0,D.L)(this.props.store,this.environment);return e.backlinks.length+e.inaccessibleBacklinkCount})),this.disableTransclusionUI=this.createComputedStore((()=>{if(A.default.isAdminMode)return!1;const{disabled:e}=this.props;if(e)return!0;const t=this.getParentStore();if(!t.canEdit())return!0;const o=t.findRecordStoreUIAncestor((e=>e!==t&&e instanceof G.G&&e.getType()===d.Ti.transclusionContainer));return Boolean(o.ancestor)})),this.hasDifferingReadPermissionsFromSource=this.createComputedStore((()=>{const{store:e,referenceStore:t}=this.props;if(!t||!e.canEdit()||!t.canEdit())return!1;const o=(0,O.YO)(e).map((e=>{let{permissionItem:t}=e;return t})),n=(0,O.YO)(t).map((e=>{let{permissionItem:t}=e;return t})),r=(0,y.L2)(o,n).created.find((e=>!(0,v.FB)(e)));return Boolean(r)}))}handleCreated(){this.stores.hovered.setState(!1),I.ZH({device:this.environment.device});const{store:e}=this.props,t=e.getContentStores()[0];t&&t.getType()===d.Ti.text&&(I.eP({environment:this.environment,store:t}),T.N_({store:t.getBlockTitleStore()}))}async canRemoveBlock(){const e=this.numberOfBacklinks.state;if(0===e)return{canRemove:!0,canUndo:!0};const t=await he({header:(0,pe.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.header",defaultMessage:"Delete original?"}),text:(0,pe.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.text",defaultMessage:"These blocks are synced in {numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}}. If you delete the original, the blocks will no longer be synced.",values:{numberOfBacklinks:e}}),acceptLabel:(0,pe.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.confirm",defaultMessage:"Delete and unsync copies"})});return{canRemove:t,canUndo:t}}async confirmUnsyncTransclusionReference(){return 0===this.numberOfBacklinks.state||he({header:(0,pe.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.header",defaultMessage:"Unsync this?"}),text:(0,pe.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.text",defaultMessage:"The selected blocks will no longer be synced with the original."}),acceptLabel:(0,pe.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.confirm",defaultMessage:"Unsync"})})}async confirmUnsyncTransclusionContainer(){const e=this.numberOfBacklinks.state;return 0===e||he({header:(0,pe.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.header",defaultMessage:"Unsync all?"}),text:(0,pe.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.text",defaultMessage:"{numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}} will no longer sync with these blocks.",values:{numberOfBacklinks:e}}),acceptLabel:(0,pe.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.confirm",defaultMessage:"Unsync all"})})}renderPersisted(){const{store:e}=this.props,{device:t}=this.environment,o=this.disableTransclusionUI.state,n=Boolean(this.props.referenceStore);if(e.pathIsDead()&&n)return this.renderDeletedContainerBanner();if(o)return(0,pe.jsx)(ce.Z,{disabled:this.props.disabled,disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,store:this.props.store.getContentStore()});{const o=this.currentState.state,n=o!==E.x.Default||this.stores.haloShouldBeVisible.state||this.stores.actionBarShouldBeVisible.state,r=this.showActionBar.state,i=!e.hasContent();return this.hasDifferingReadPermissionsFromSource.state,(0,pe.jsxs)("div",{style:{display:"flex"},children:[(0,pe.jsx)("span",{ref:this.fakeSelectionTrapRef,style:{height:"1px",width:"1px"}}),(0,pe.jsxs)("div",{style:{position:n?"relative":void 0,paddingTop:3,paddingBottom:3,width:"100%"},onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,onClick:i?this.handleEmptyClick:void 0,children:[(0,pe.jsx)(ce.Z,{disabled:!1,store:this.props.store.getContentStore(),emptyPlaceholder:this.renderEmptyEditingPlaceholder(),disableHoverMenu:this.props.disableHoverMenu||o!==E.x.SelectedDescendant,disableDrag:t.isMobile}),(0,pe.jsx)(Q.Z,{store:e},e.id),n&&this.renderHalo(o),n&&this.renderActionBar(r)]})]})}}renderDeletedContainerBanner(){const e=(0,B.ZP)({store:this.props.store,fullyQualified:!1,pageVisitSource:c.tY.LinkInPage}),t=(0,B.ZP)({store:this.props.store,openInSidePeek:!0,fullyQualified:!1,pageVisitSource:c.tY.PeekOpen}),o=(0,pe.jsx)(ne.Z,{href:e,altHref:t,forceAltHref:H.default.isSidePeekOpen(),external:!1,inline:!0,underline:!0,children:(0,pe.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.deletedContainerBanner.viewDeletedPage",defaultMessage:"View deleted page"})});return(0,pe.jsxs)(le.gq,{style:{color:this.theme.text.secondary,background:this.theme.accentColors.gray[30],padding:"16px 16px 16px 12px",borderRadius:4},alignItems:"center",children:[(0,h.D)({width:24,height:24,flexShrink:0,marginRight:10,padding:2}),(0,pe.jsx)("div",{style:{fontSize:14},children:(0,pe.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.deletedContainerBanner.syncedContentPageDeleted",defaultMessage:"The page with the original synced block has been deleted. {pageLink}",values:{pageLink:o}})})]})}renderHalo(e){const t=e!==E.x.Default;return(0,pe.jsx)(ee.Z,{isVisible:t,enterAnimationStyle:{opacity:0},animationStyle:{opacity:e===E.x.Hovered?.45:1,scale:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:de.Z.opacitySpringConfig},onAnimationStart:()=>{this.stores.haloShouldBeVisible.setState(!0)},onAnimationEnd:()=>{t||this.stores.haloShouldBeVisible.setState(!1)},render:this.renderHaloContent})}renderActionBar(e){return(0,pe.jsx)(ee.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:de.Z.opacitySpringConfig},onAnimationStart:()=>{this.stores.actionBarShouldBeVisible.setState(!0)},onAnimationEnd:()=>{e||this.stores.actionBarShouldBeVisible.setState(!1)},render:this.renderActionBarContent})}renderEmptyEditingPlaceholder(){return(0,pe.jsx)("div",{style:{caretColor:this.theme.lightTextColor,color:this.theme.lightTextColor,paddingTop:4,paddingBottom:4},children:(0,pe.jsx)(_.FormattedMessage,{defaultMessage:"Click or drag blocks here, then paste in another page to sync content.",id:"transclusionContainerBlock.emptyEditingPlaceholder"})})}getParentStore(){const{store:e,referenceStore:t}=this.props;return t||e}getActionBarStyle(){return{position:"absolute",zIndex:S.t8,top:-40,right:-2,borderRadius:6,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:b.Z.getCompositeFontFamily(s.SP).sans,background:this.theme.popoverBackground,boxShadow:this.theme.mediumBoxShadow}}getActionButtonStyle(){return{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${p.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${this.theme.regularDividerColor}`,marginRight:1}}}me.contextTypes={...a.w,isInColumnList:r().any};const ge=me;function he(e){const{header:t,text:o,acceptLabel:n}=e;return new Promise((e=>{x.showDialog({showCancel:!0,keepFocus:!1,message:(0,pe.jsxs)("div",{children:[(0,pe.jsx)("div",{style:{fontWeight:b.Z.fontWeight.semibold},children:t}),o]}),items:[{label:n,color:"red",onAccept:()=>{e(!0)}}],handleCancel:()=>{e(!1)}})}))}function fe(){return(0,pe.jsx)(_.FormattedMessage,{defaultMessage:"Learn more about Synced blocks",id:"transclusionContainerBlock.learnMoreLabel"})}function ye(){return(0,pe.jsx)(ae.Z,{topBorder:!0,children:(0,pe.jsx)(se.Z,{title:(0,pe.jsx)(fe,{}),href:(0,L.UY)("guides.transclusions"),analyticsFrom:"transclusion_container_block"})})}},91497:(e,t,o)=>{o.d(t,{Z:()=>s});o(67294);var n=o(2834),r=o(91791),i=o(85893);class a extends n.Z{renderPersisted(){const{disabled:e,store:t}=this.props,o=t.getTransclusionReferenceTargetStore();if(o&&o.canRead())return(0,i.jsx)(r.Z,{store:o,disabled:e,intl:this.props.intl,referenceStore:this.props.store,disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu})}}const s=a},24927:(e,t,o)=>{o.d(t,{h:()=>ja});var n=o(41662),r=o(67294),i=o(86628),a=o(45208),s=o(62965),l=o(5366),c=o(73819),d=o(68859),p=o(69278),u=o(85893);const m=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Abstract",id:"abstractBlock.embeds.button.label"}});function g(e,t){window.__c={n:"AbstractBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),s=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"abstract",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:s,ref:n,store:e.store,iconSvg:a.f,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with Abstract links with public access enabled",id:"abstractBlock.embeds.caption"}),embedButtonText:o.formatMessage(m.embedButtonText),urlInputPlaceholder:"https://abstract.com/â€¦",children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed Abstract",id:"abstractBlock.placeholder"})}))}const h=r.memo(r.forwardRef(g),s.Z);var f=o(13991),y=o(49085),v=o(8848),b=o(42853),S=o(11751),_=o(82990),w=o(51454),k=o(50906),x=o(72899),I=o(92022),C=o(43250),T=o(14976),M=o(19124),P=o(87290),A=o(33929),D=o(16402),B=o(61766),R=o(16772),E=o(55367),F=o(80796),N=o(22294),j=o(69784),O=o(49557),L=o(77794),U=o(49271),Z=o(41432),V=o(76490),q=o(33676),z=o(97022),W=o(39986),H=o(10498),G=o(97880),K=o(94419),$=o(9953),Y=o(24677),Q=o(98104),J=o(39699),X=o(12534),ee=o(68056),te=o(77907),oe=o(51214),ne=o(2834),re=o(23864),ie=o(23063),ae=o(64921),se=o(73420),le=o(55217),ce=o(79954),de=o(65187);const pe=(0,l.defineMessages)({headingPlaceholder:{id:"aiSection.heading.placeholder",defaultMessage:"Heading"},thumbsUp:{id:"aiSection.actionBar.thumbsUp",defaultMessage:"Submit positive feedback"},thumbsDown:{id:"aiSection.actionBar.thumbsDown",defaultMessage:"Submit negative feedback"}});class ue extends ne.Z{constructor(){super(...arguments),this.containerRef=r.createRef(),this.sizeObserver=new L.E,this.storeTypes={isHovering:y.default.createClass(!1),haloShouldBeVisible:y.default.createClass(!1),actionBarShouldBeVisible:y.default.createClass(!1),selectedAiFeedbackType:y.default.createClass(void 0)},this.renderHaloContent=()=>{const e="light"===this.theme.mode?this.theme.aiBlockBorderColor:this.theme.aiPurpleColor;return(0,u.jsx)("div",{style:{position:"absolute",left:-6,right:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:6,border:`2px solid ${e}`}})},this.renderActionBarContent=()=>{const e=this.lastEditedTime.state;return(0,u.jsxs)("div",{style:this.getActionBarStyle(),children:[(0,u.jsxs)("span",{style:this.getActionButtonStyle(),children:[(0,S.t)({width:16,height:16,fill:this.theme.accentColors.purple[400]}),(0,u.jsx)(l.FormattedMessage,{id:"aiSection.generated",defaultMessage:"Updated by AI"}),e?(0,u.jsx)("span",{style:{color:this.theme.accentColors.purple[300]},children:(0,D.IS)(e,{useLowercase:!0,useCompactFormat:!0,roundDownYears:!0})}):null]}),(0,u.jsx)(ae.Z,{style:this.getFeedbackButtonStyle(),onClick:this.handleThumbUpClick,ariaLabel:A.default.formatMessage(pe.thumbsUp),children:"ai_section_thumbs_up"===this.stores.selectedAiFeedbackType.state?(0,H.w)({width:16,height:16}):(0,W.P)({width:16,height:16})}),(0,u.jsx)(ae.Z,{style:this.getFeedbackButtonStyle(),onClick:this.handleThumbDownClick,ariaLabel:A.default.formatMessage(pe.thumbsDown),children:"ai_section_thumbs_down"===this.stores.selectedAiFeedbackType.state?(0,z.E)({width:16,height:16}):(0,q.A)({width:16,height:16})})]})},this.handleMouseEnter=()=>{F.Z.state.isDragging||j.Z.state.isActive||this.stores.isHovering.setState(!0)},this.handleMouseLeave=()=>{F.Z.state.isDragging||j.Z.state.isActive||this.stores.isHovering.setState(!1)},this.handleHeaderRightMarginClick=e=>{e.stopPropagation();const t=(0,ee.TD)({store:this.props.store.getTitleStore()});t&&Q.bc({environment:this.environment,multiSelection:t,forceEmit:!1,focus:"end",readOnly:"infer"})},this.handleThumbUpClick=()=>{this.submitFeedback("ai_section_thumbs_up")},this.handleThumbDownClick=()=>{this.submitFeedback("ai_section_thumbs_down")},this.submitFeedback=async e=>{var t;const o=this.props.store.getFormat().ai_inference_id,n=null===(t=this.props.store.getFormat().ai_skill)||void 0===t?void 0:t.ai_skill_type;this.stores.selectedAiFeedbackType.setState(e);const{assistantActions:r}=await te.deps.assistant.loader();o&&n&&r.saveAiSectionFeedback({environment:this.environment,inferenceId:o,feedbackType:e,skillType:n})},this.handlePlaceholderClick=e=>{(0,X.ZP)({event:e,context:X.Af.EditorClick,callback:()=>{const e=this.props.store.getContentStore();if(!e)return;(e.getValue()||[]).length>0||J.createAndCommit({userAction:"aiSection.handlePlaceholderClick",environment:this.environment,perform:t=>{const o=$.j4({environment:this.environment,type:Z.Ti.text,inMemoryRecordCache:e.inMemoryRecordCache,transaction:t,spaceId:this.props.store.getSpaceId(),useCrdt:this.props.store.useCrdt()}),n=K.R3({parent:e,append:o,transaction:t}).child;Y.eP({environment:this.environment,store:n});const r=n.getBlockTitleStore();Q.N_({store:r})}})}})},this.currentState=this.createComputedStore((()=>(0,P.B)(this.props.store,this.stores.isHovering.state))),this.isCompact=this.createComputedStore((()=>this.sizeObserver.rect.state.width<400)),this.lastEditedTime=this.createComputedStore((()=>this.props.store.getFormat().ai_last_edited)),this.showActionBar=this.createComputedStore((()=>{const e=this.currentState.state,t=this.props.store.getFormat().ai_inference_id;return(e===P.x.Selected||e===P.x.SelectedDescendant)&&!O.Z.state.isActive&&!E.ZP.state.isDragging&&!j.Z.state.isActive&&!N.Z.state.isKeyboardMode&&Boolean(t)})),this.isHaloVisible=this.createComputedStore((()=>{if(oe.Z.isGeneratingFor(this.props.store.id))return!0;const e=this.currentState.state;if(e===P.x.Default)return!1;if(e===P.x.Hovered){var t;const e=E.ZP.state;return!!(e&&e.isDragging&&e.currentDropZone&&e.currentDropZone.type===E.Dl.Selectable&&null!==(t=e.currentDropZone)&&void 0!==t&&t.store&&this.props.store.uiContains(e.currentDropZone.store))}return e===P.x.Selected||e===P.x.SelectedDescendant||(0,G.t1)(e)})),this.getHeaderTextStyle=()=>{const{device:e}=this.environment,t=this.rootStorePageFont.state,o=e.isMobile?1.17:V.C;return(0,V.Jr)({fontSizeValue:o,fontFamily:t})}}renderPersisted(){const e=this.currentState.state,t=e!==P.x.Default||this.stores.haloShouldBeVisible.state;return this.props.store.isSkillBlock()?(0,u.jsx)("div",{className:C.zov,style:{display:"flex"},ref:this.containerRef,children:(0,u.jsxs)("div",{style:{position:t?"relative":void 0,paddingTop:3,paddingBottom:3,width:"100%",marginTop:4,marginBottom:4},onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,children:[(0,u.jsxs)(se.X2,{gap:void 0,wrap:this.isCompact.state?"wrap":"initial",children:[(0,u.jsx)(de.Z,{tagName:"h4",disabled:!this.canEdit(),store:this.props.store.getBlockTitleStore(),placeholder:A.default.formatMessage(pe.headingPlaceholder),placeholderStyle:{WebkitTextFillColor:this.theme.headerBlockPlaceholderTextColor},style:{...U.ZD,...this.getHeaderTextStyle(),width:void 0},pasteBehavior:"block",legacyTransclusionParent:this.props.legacyTransclusionParent}),(0,u.jsx)("div",{style:{paddingLeft:8,flexGrow:1},onClick:this.handleHeaderRightMarginClick,children:(0,u.jsx)(te.LazyBlockSkillButton,{blockStore:this.props.store})}),(0,u.jsx)(re.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}),(0,u.jsx)("div",{onClick:this.handlePlaceholderClick,children:(0,u.jsx)(le.Z,{disabled:this.props.disabled,store:this.props.store.getContentStore(),disableHoverMenu:this.props.disableHoverMenu||e!==P.x.SelectedDescendant,disableDrag:this.environment.device.isMobile,emptyPlaceholder:this.renderEmptyPlaceholder()})}),this.renderHalo(),this.renderActionBar(this.showActionBar.state)]})}):(0,u.jsx)(ve,{...this.props})}renderEmptyPlaceholder(){return(0,u.jsx)("div",{style:{marginTop:2,padding:"3px 2px",display:"inline-block",color:this.theme.lightTextColor},children:this.renderPlaceholderMessage()})}renderPlaceholderMessage(){const e=this.props.store.getCurrentSkillType();return"meeting_action_items"===e?(0,u.jsx)(l.FormattedMessage,{id:"aiSection.meetingActionItems.textPlaceholder",defaultMessage:"Add action items or fill with AI"}):"meeting_summary"===e?(0,u.jsx)(l.FormattedMessage,{id:"aiSection.meetingSummary.textPlaceholder",defaultMessage:"Add summary or fill with AI"}):(0,u.jsx)(l.FormattedMessage,{id:"aiSection.noSkill.emptyCannotDropPlaceholder",defaultMessage:"Add blocks or fill with AI"})}renderHalo(){const e=this.isHaloVisible.getState();return(0,u.jsx)(ie.Z,{isVisible:e,enterAnimationStyle:{opacity:0,scale:.995},animationStyle:{opacity:.45,scale:1},exitAnimationStyle:{opacity:0,scale:.995},springConfig:{opacity:ce.Z.opacitySpringConfig},onAnimationStart:()=>{this.stores.haloShouldBeVisible.setState(!0)},onAnimationEnd:()=>{e||this.stores.haloShouldBeVisible.setState(!1)},render:this.renderHaloContent})}renderActionBar(e){return(0,u.jsx)(ie.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:ce.Z.opacitySpringConfig},onAnimationStart:()=>{this.stores.actionBarShouldBeVisible.setState(!0)},onAnimationEnd:()=>{e||this.stores.actionBarShouldBeVisible.setState(!1)},render:this.renderActionBarContent})}didMount(){const e=this.getNode();e instanceof Element&&this.sizeObserver.observe(e)}willUnmount(){this.sizeObserver.destroy()}getActionBarStyle(){return{position:"absolute",zIndex:w.t8,top:-40,right:-2,borderRadius:4,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:_.Z.getCompositeFontFamily(f.SP).sans,background:this.theme.popoverBackground,boxShadow:this.theme.mediumBoxShadow}}getActionButtonStyle(){return{display:"flex",alignItems:"center",gap:4,height:"100%",padding:"0 8px",borderRight:`1px solid ${v.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${this.theme.regularDividerColor}`,color:this.theme.accentColors.purple[500],fontWeight:500}}getFeedbackButtonStyle(){return{display:"flex",alignItems:"center",height:"100%",padding:"0 8px",color:this.theme.accentColors.gray[500]}}}const me=ue;var ge=o(68709),he=o(63296);const fe=(0,l.defineMessages)({summarize:{id:"aiBlock.summarize",defaultMessage:"Summarize this page with AI"},findActionItems:{id:"aiBlock.findActionItems",defaultMessage:"Find action items on this page with AI"},helpMeWrite:{id:"aiBlock.helpMeWrite",defaultMessage:"Tell the AI what to writeâ€¦"},summarizeMeetingTranscript:{id:"aiBlock.summarizeMeetingTranscript",defaultMessage:"Summarize this meeting with any action items and decisions taken"}});class ye extends ne.Z{constructor(){super(...arguments),this.containerRef=r.createRef(),this.sizeObserver=new L.E,this.storeTypes={isGenerating:y.default.createClass(!1),isHovering:y.default.createClass(!1),haloShouldBeVisible:y.default.createClass(!1),actionBarShouldBeVisible:y.default.createClass(!1),backlinksIndicatorButtonPopupStore:B.Z},this.renderHaloContent=()=>(0,u.jsx)("div",{style:{position:"absolute",left:-6,right:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:8,border:`2px solid ${this.theme.aiBlockBorderColor}`}}),this.renderActionBarContent=()=>{const e=this.lastEditedTime.state;return(0,u.jsxs)("div",{style:this.getActionBarStyle(),children:[(0,u.jsxs)(ae.Z,{style:{...this.getActionButtonStyle(),display:"flex",gap:4},onClick:this.handleEditPromptClick,disabled:this.disableButton.state,children:[(0,S.t)({width:16,height:16,fill:this.theme.accentColors.purple[400]}),(0,u.jsx)("span",{style:{color:this.theme.accentColors.purple[500],fontWeight:500},children:(0,u.jsx)(l.FormattedMessage,{id:"aiBlock.generated",defaultMessage:"Generated by AI"})}),e?(0,u.jsx)("span",{style:{color:this.theme.accentColors.purple[300]},children:(0,D.IS)(e,{useLowercase:!0,useCompactFormat:!0,roundDownYears:!0})}):null,this.disableButton.state?null:(0,b.i)({width:10,marginLeft:4,fill:this.theme.lightIconColor})]}),(0,u.jsx)(ae.Z,{onClick:this.handleGenerateClick,disabled:this.disableButton.state,style:{...this.getActionButtonStyle(),opacity:this.disableButton.state?.5:1,cursor:this.disableButton.state?"not-allowed":"pointer"},children:this.stores.isGenerating.state?(0,u.jsx)(l.FormattedMessage,{id:"aiBlockBlock.update.loading",defaultMessage:"Updatingâ€¦"}):(0,u.jsx)(l.FormattedMessage,{id:"aiBlockBlock.update",defaultMessage:"Update"})})]})},this.handleMouseEnter=()=>{F.Z.state.isDragging||j.Z.state.isActive||this.stores.isHovering.setState(!0)},this.handleMouseLeave=()=>{F.Z.state.isDragging||j.Z.state.isActive||this.stores.isHovering.setState(!1)},this.handleGenerateClick=async()=>{k.RLv(this.environment,{type:"generate",prompt_key:this.prompt.state.key}),this.stores.isGenerating.setState(!0);const e=await x.gr.loader();await e.triggerCompletionForAiBlock({environment:this.environment,store:this.props.store,prompt:this.prompt.state,additionalContext:this.additionalContext.state}),this.stores.isGenerating.setState(!1)},this.handleEditPromptClick=()=>{var e;k.RLv(this.environment,{type:"edit_prompt"}),(0,I.yd)({environment:this.environment,store:this.props.store,originRef:this.containerRef,prompt:null===(e=this.additionalContext.state)||void 0===e?void 0:e.prompt,clientPrompt:this.prompt.state})},this.handleFocus=()=>{var e;(0,I.yd)({environment:this.environment,store:this.props.store,originRef:this.containerRef,prompt:null===(e=this.additionalContext.state)||void 0===e?void 0:e.prompt,clientPrompt:this.prompt.state})},this.currentState=this.createComputedStore((()=>this.isEmpty.state?P.x.Hovered:(0,P.B)(this.props.store,this.stores.isHovering.state))),this.showActionBar=this.createComputedStore((()=>{const e=this.currentState.state;return!(e!==P.x.Selected&&e!==P.x.SelectedDescendant||O.Z.state.isActive||E.ZP.state.isDragging||j.Z.state.isActive||N.Z.state.isKeyboardMode)})),this.lastEditedTime=this.createComputedStore((()=>this.props.store.getFormat().ai_last_edited)),this.isEmpty=this.createComputedStore((()=>!this.props.store.hasContent())),this.prompt=this.createComputedStore((()=>{const e=(0,M.z1)(),t=e.summarize,o=this.props.store.getFormat().ai_prompt_key;if(!o)return t;const n=e[o];return n||t})),this.titleValue=this.createComputedStore((()=>this.props.store.getBlockTitleStore().getValue())),this.additionalContext=this.createComputedStore((()=>{const e=this.titleValue.state;if(e)return{prompt:(0,T.Xh)(e,this.props.store)}})),this.disableButton=this.createComputedStore((()=>{var e;const t=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,M.GD)(t)||(!!this.stores.isGenerating.state||(!(this.props.store.canEdit()&&!this.props.store.isLocked())||"helpMeWrite"===this.prompt.state.key&&(null===(e=this.additionalContext.state)||void 0===e||!e.prompt)))})),this.isCompact=this.createComputedStore((()=>this.sizeObserver.rect.state.width<400))}renderPersisted(){const e=this.currentState.state,t=e!==P.x.Default||this.stores.haloShouldBeVisible.state||this.stores.actionBarShouldBeVisible.state,o=R.default.state,n="completionPopup"===o.type&&"results"===o.stage&&o.loading;return this.props.store.isSkillBlock()?(0,u.jsx)(me,{...this.props}):(0,u.jsx)("div",{className:C.zov,style:{display:"flex"},ref:this.containerRef,children:(0,u.jsx)("div",{style:{position:t?"relative":void 0,paddingTop:3,paddingBottom:3,width:"100%",marginTop:4,marginBottom:4},onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,children:this.isEmpty.state?(0,u.jsxs)(ge.p,{allowSelectionWithin:!0,children:[(0,u.jsxs)(se.X2,{justifyContent:"space-between",padding:8,gap:8,wrap:this.isCompact.state?"wrap":"initial",children:[(0,u.jsxs)(se.X2,{gap:12,alignItems:"baseline",grow:1,children:[this.renderIcon(),"helpMeWrite"===this.prompt.state.key?(0,u.jsx)(de.Z,{onFocus:this.handleFocus,disabled:!this.canEdit(),store:this.props.store.getBlockTitleStore(),placeholder:A.default.formatMessage(fe.helpMeWrite),pasteBehavior:"block",style:{flexGrow:1,flexBasis:0},onEnter:this.handleGenerateClick}):this.renderPrompt()]}),(0,u.jsx)(he.Z,{disabled:this.disableButton.state,onClick:this.handleGenerateClick,style:{fontWeight:500,color:this.theme.accentColors.purple[500],opacity:this.disableButton.state?.5:1,cursor:this.disableButton.state?"not-allowed":"pointer"},children:this.stores.isGenerating.state?(0,u.jsx)(l.FormattedMessage,{id:"aiBlock.generate.loading.label",defaultMessage:"Generatingâ€¦"}):(0,u.jsx)(l.FormattedMessage,{id:"aiBlock.generate.label",defaultMessage:"Generate"})})]}),this.renderHalo(e)]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(le.Z,{disabled:this.props.disabled,store:this.props.store.getContentStore(),disableHoverMenu:this.props.disableHoverMenu||e!==P.x.SelectedDescendant,disableDrag:this.environment.device.isMobile}),t&&this.renderHalo(e),!n&&t&&this.renderActionBar(this.showActionBar.state)]})})})}renderIcon(){var e,t;const o={fill:this.theme.accentColors.purple[300],width:21,height:21,position:"relative",top:5};return(null===(e=(t=this.prompt.state).svg)||void 0===e?void 0:e.call(t,o))??(0,S.t)(o)}renderPrompt(){var e;return"helpMeWrite"===this.prompt.state.key?(null===(e=this.additionalContext.state)||void 0===e?void 0:e.prompt)||A.default.formatMessage(fe.helpMeWrite):fe[this.prompt.state.key]?A.default.formatMessage(fe[this.prompt.state.key]):void 0}renderHalo(e){const t=e!==P.x.Default;return(0,u.jsx)(ie.Z,{isVisible:t,enterAnimationStyle:{opacity:0,scale:.995},animationStyle:{opacity:e===P.x.Hovered?.45:1,scale:1},exitAnimationStyle:{opacity:0,scale:.995},springConfig:{opacity:ce.Z.opacitySpringConfig},onAnimationStart:()=>{this.stores.haloShouldBeVisible.setState(!0)},onAnimationEnd:()=>{t||this.stores.haloShouldBeVisible.setState(!1)},render:this.renderHaloContent})}renderActionBar(e){return(0,u.jsx)(ie.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:ce.Z.opacitySpringConfig},onAnimationStart:()=>{this.stores.actionBarShouldBeVisible.setState(!0)},onAnimationEnd:()=>{e||this.stores.actionBarShouldBeVisible.setState(!1)},render:this.renderActionBarContent})}didMount(){const e=this.getNode();e instanceof Element&&this.sizeObserver.observe(e)}willUnmount(){this.sizeObserver.destroy()}getActionBarStyle(){return{position:"absolute",zIndex:w.t8,top:-40,right:-2,borderRadius:6,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:_.Z.getCompositeFontFamily(f.SP).sans,background:this.theme.popoverBackground,boxShadow:this.theme.mediumBoxShadow}}getActionButtonStyle(){return{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${v.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${this.theme.regularDividerColor}`,marginRight:1}}}const ve=ye;var be=o(1292),Se=o(12436);const _e=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed audio",id:"audioBlock.embedAudio.button.label"}});function we(e,t){window.__c={n:"AudioBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"audio",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:Se.l,mediaMenuCurrentTab:"file",mediaMenuTabs:[{type:"file",fileUpload:!0},{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with .MP3s, .WAVs, and .OGGs",id:"audioBlock.embed.caption"}),embedButtonText:o.formatMessage(_e.embedButtonText),urlInputPlaceholder:"https://â€¦",children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Add an audio file",id:"audioBlock.placeholder"})}))}const ke=r.memo(r.forwardRef(we),s.Z);var xe=o(73935),Ie=o(53150),Ce=o(83096),Te=o(30845),Me=o(23210),Pe=o(70203),Ae=o(64002),De=o(63143),Be=o(48948),Re=o(47307),Ee=o(27153),Fe=o(75018),Ne=o(31792),je=o(13966),Oe=o(91893),Le=o(12981),Ue=o(84076),Ze=o(68785),Ve=o(81865),qe=o(64369),ze=o(86329),We=o(35021);const He=2*De.hM,Ge=(0,l.defineMessages)({linkPlaceholder:{defaultMessage:"Paste in https://â€¦",id:"bookmarkBlock.editBookmark.linkPlaceholder"},bookmarkTitle:{defaultMessage:"Bookmark",id:"bookmarkBlock.bookmark.title"},errorMessage:{defaultMessage:"Please enter a valid link",id:"bookmarkBlock.invalidLinkError.message"}});class Ke extends ne.Z{constructor(){super(...arguments),this.captionAriaId=(0,Ie.Z)(),this.caption=()=>{const e=this.props.store.getPropertyStore("caption");Y.eP({environment:this.environment,store:this.props.store}),Q.NX({store:e})},this.storeTypes={stringInputButtonPopupStore:B.Z,mouseStore:Ne.Z},this.handleEmbedConfirm=e=>this.embed(e),this.handleOpenMenu=()=>{if(this.canEdit()){const e=xe.findDOMNode(this);if(!e)return;if(!(e instanceof Element))return;const t=e.getBoundingClientRect();Ee.$(this.environment,{originRect:t,originGap:0,isSmallWidth:!0,showArrow:!0,title:A.default.formatMessage(Ge.bookmarkTitle),currentTab:"embed",tabs:[{type:"embed",caption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Create a visual bookmark from a link.",id:"bookmarkBlock.visualBookmark.prompt"}),buttonText:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Create bookmark",id:"bookmarkBlock.visualBookmark.create"}),inputPlaceholder:A.default.formatMessage(Ge.linkPlaceholder),onChange:e=>{const t=Me.D(e);Te.B(t,"url")?(Ee.Z(),this.handleEmbedConfirm(t)):Re.showErrorMessage(A.default.formatMessage(Ge.errorMessage))}}]})}},this.handleMouseMove=()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),this.handleMouseLeave=()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})}handleCreated(){this.edit()}edit(){this.handleOpenMenu()}embed(e){return k.bOx(this.environment,{pastedText:e,source:"bookmark_block_menu"}),Be.K({environment:this.environment,store:this.props.store,url:e})}activate(){const e=this.props.store.getProperties(),t=Pe.QaF(e&&e.link||[]);t&&Fe.navigateToExternalURL({environment:this.environment,url:t})}didMount(){const e=this.props.store.getFormat().bookmark_loading_ttl;if(e){const t=e-Date.now()-He;t>0&&setTimeout(this.enqueueForceUpdate,t+1e3)}}renderPersisted(){const e=this.props.store.getProperties();return e&&e.link?this.renderContent():this.renderPlaceholder()}renderContent(){const{store:e}=this.props,t=e.getProperties(),o=Pe.Jcv(t&&t.link);let n=Pe.Jcv(t&&t.title);if(o===n||!n){const e=Ae.Qc(o);e.hostname&&(n=e.hostname)}const r=Pe.Jcv(t&&t.description),i=e.getFormat(),a=i.bookmark_cover,s=i.bookmark_icon,c=i.bookmark_loading_ttl,d=c&&c>Date.now()-He;return(0,u.jsxs)(ge.p,{role:"figure","aria-labelledby":this.captionAriaId,allowSelectionWithin:!0,children:[(0,u.jsxs)("div",{style:{display:"flex"},children:[(0,u.jsx)(We.Z,{permissionRecord:e.pointer,url:o,render:(e,t)=>(0,u.jsxs)(Ue.Z,{href:t,external:!0,style:{flexGrow:1,minWidth:0},innerStyle:this.getContentStyle(),onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,children:[(0,u.jsxs)("div",{style:Ke.textWrapStyle,children:[d?(0,u.jsxs)(qe.Z,{style:{minHeight:24,marginBottom:2,display:"inline-flex",alignItems:"center",color:this.theme.mediumTextColor},children:[(0,u.jsx)(Ze.Z,{style:{marginRight:8}})," ",(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Fetching preview",id:"bookmarkBlock.loadWhileFetching.message"})]}):(0,u.jsx)(qe.Z,{style:{minHeight:24,marginBottom:2},children:n}),r&&(0,u.jsx)(qe.Z,{isSmall:!0,isMultiline:!0,style:{height:32,overflow:"hidden"},children:r}),(0,u.jsxs)("div",{style:{display:"flex",marginTop:6},children:[s&&s.length>0&&(0,u.jsx)(Ve.Z,{url:s,isAuthenticated:!0,permissionRecord:this.props.store.pointer,render:(e,t)=>t&&(0,u.jsx)("img",{src:t,style:Ke.linkFaviconStyle})}),(0,u.jsx)(qe.Z,{style:{color:this.theme.regularTextColor},isSmall:!0,children:o})]})]}),a&&this.renderImage(a),this.shouldShowActionButton()&&this.canEdit()&&(0,u.jsx)(je.Z,{store:this.props.store,style:{position:"absolute",top:4,right:4,background:p.Z.actionButtonBackground(this.environment)},iconStyle:{fill:v.ZP.white},fadeIn:!0})]})}),(0,u.jsx)(re.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}),(0,u.jsx)(Oe.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]})}renderImage(e){return(0,u.jsx)("div",{style:Ke.imageLinkWrapStyle,children:(0,u.jsx)("div",{style:Ke.imageLinkInnerStyle,children:(0,u.jsx)(Ve.Z,{url:e,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:250,render:(e,t)=>t&&(0,u.jsx)(Le.Z,{style:Ke.imageStyle,src:t})})})})}renderPlaceholder(){const{disabled:e}=this.props;return(0,u.jsxs)(ge.p,{allowSelectionWithin:!1,onMouseEnter:e=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),onMouseLeave:e=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1}),style:{display:"flex"},children:[(0,u.jsx)(ze.Z,{iconSvg:Ce.Q,disabled:e,shouldHideRight:!this.shouldShowActionButton(),right:this.canEdit()&&(0,u.jsx)(je.Z,{store:this.props.store,fadeIn:!1}),onClick:this.handleOpenMenu,isLoading:!1,progressPercent:0,children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Add a web bookmark",id:"bookmarkBlock.addWebBookmark.placeholder"})}),(0,u.jsx)(re.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}shouldShowActionButton(){const{device:e}=this.environment;return e.isMobile||this.stores.mouseStore.state.mouseEntered}getContentStyle(){return{display:"flex",flexWrap:"wrap-reverse",alignItems:"stretch",textAlign:"left",overflow:"hidden",border:`1px solid ${this.theme.darkDividerColor}`,borderRadius:4,position:"relative",...this.getBlockColorStyle()}}}Ke.imageLinkWrapStyle={flexGrow:1,flexShrink:1,flexBasis:180,display:"block",position:"relative"},Ke.imageLinkInnerStyle={position:"absolute",top:0,left:0,right:0,bottom:0},Ke.imageStyle={display:"block",width:"100%",height:"100%",objectFit:"cover"},Ke.textWrapStyle={flexGrow:4,flexShrink:1,flexBasis:180,padding:14,paddingTop:12,overflow:"hidden",textAlign:"left"},Ke.linkFaviconStyle={width:16,height:16,minWidth:16,marginRight:6};const $e=Ke;var Ye=o(3043);class Qe extends ne.Z{renderPersisted(){const{device:e}=this.environment,t=this.props.store.getNavigableBlockStore(),o=this.canEdit();if(t)return(0,u.jsxs)(ge.p,{allowSelectionWithin:!0,style:{display:"flex",paddingTop:U.ZD.paddingTop,paddingBottom:U.ZD.paddingBottom},children:[(0,u.jsx)(Ye.l2,{showCurrentPageControls:!1,ancestorMaxWidth:200,currentPageMaxWidth:300,store:t,maxAncestorCount:3,isMobile:e.isMobile,style:{flexGrow:1,minWidth:0,fontSize:"inherit"}}),e.isMobile&&o&&(0,u.jsx)(je.Z,{store:this.props.store,fadeIn:!0,style:{marginTop:2,marginRight:4}}),(0,u.jsx)(re.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}}const Je=Qe;var Xe=o(7825),et=o(27755),tt=o(38376),ot=o(6740),nt=o(17397),rt=o(99036),it=o(80951),at=o(75553),st=o(15157),lt=o(19233),ct=o(23867),dt=o(3124),pt=o(5049),ut=o(87784),mt=o(42274),gt=o(72495),ht=o(62967);const ft=(0,l.defineMessages)({showCodePreviewSection:{id:"action.codePreviewSection.name",defaultMessage:"Show in block"}}),yt=(0,ht.cN)({key:"show code",displayName:ht.RE.showOnlyCodeFormat,analyticsName:ht.RE.showOnlyCodeFormat.defaultMessage,svg:dt._,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:o}=e;mt.pZ({environment:o,blocks:t,previewFormat:"code"})}}),vt=(0,ht.cN)({key:"show preview on code block",displayName:ht.RE.showCodePreviewFormat,analyticsName:ht.RE.showCodePreviewFormat.defaultMessage,svg:pt.s,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:o}=e;mt.pZ({environment:o,blocks:t,previewFormat:"preview"})}}),bt=(0,ht.cN)({key:"show code and preview",displayName:ht.RE.showSplitViewFormat,analyticsName:ht.RE.showSplitViewFormat.defaultMessage,svg:ut.s,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:o}=e;mt.pZ({environment:o,blocks:t,previewFormat:"split_view"})}}),St=[{key:"code preview actions block",render:e=>(0,u.jsx)(gt.Z,{isTitleUppercase:!1,...e}),title:A.default.formatMessage(ft.showCodePreviewSection),actions:[yt,vt,bt]}];var _t=o(14871),wt=o(95477),kt=o(87279),xt=o(83960),It=o(77080),Ct=o(33846),Tt=o(31194),Mt=o(83355),Pt=o(1302),At=o(15095),Dt=o(72126),Bt=o(62193),Rt=o(20852),Et=o(6746),Ft=o(44805),Nt=o(97444),jt=o(98724),Ot=o(56971),Lt=o(74284),Ut=o(48514),Zt=o(62619),Vt=o(67669),qt=o(55227),zt=o(89086),Wt=o(66638),Ht=o(52689),Gt=o(24666),Kt=o(29595),$t=o(93262);class Yt extends Mt.Z{constructor(){super(...arguments),this.editor=null,this.mergeEditorRefs=(0,Bt.sH)(),this.renderContentContainer=(e,t,o)=>{let{leafRef:n,wrapperRef:r,...i}=e;return(0,u.jsx)("div",{ref:r,style:{display:"flex",...!this.props.codeWrap&&{overflowX:"auto",WebkitOverflowScrolling:"touch"}},className:"line-numbers notion-code-block",...i,children:(0,u.jsx)(Kt.Z,{ref:this.mergeEditorRefs(this.editorRef,n),style:{...this.getContentEditableStyle(),...this.props.isQuickFind&&{paddingTop:12},...this.props.codeWrap?{whiteSpace:"pre-wrap",wordBreak:"break-all",minWidth:0}:{whiteSpace:"pre"}},getDisabled:this.getDisabled,getHtml:this.getHtml,getSelection:this.getContainerSelection,onMutation:this.handleMutation,spellCheck:!1,autoCorrect:"off",autoCapitalize:"off",onSelect:t,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,suppressNewlineEvents:!1,placeholder:" ",disableContentEditableWhenNotEditingTextOnMobile:!0})})},this.renderSyntaxTokens=(e,t)=>{const o=Ft.Mw(t&&{value:t,spaceId:this.props.parentSpaceId},this.props.store.getRecordModel),n=qt.kF(o,e),r=o.map(Pe.hDy).map(((e,t)=>Ft.fn({annotations:e,theme:this.theme,spaceId:this.props.parentSpaceId,getRecordModel:this.props.store.getRecordModel})));return n.map(((e,t)=>(0,u.jsx)("span",{className:[e.classNames||"",...r[e.textTokenIndex].classNames].join(" "),style:r[e.textTokenIndex].style,"data-token-index":e.textTokenIndex,children:e.value},t)))},this.handleClick=e=>{T.SD({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,canEdit:this.canEdit()})},this.handleMutation=e=>{let{newValue:t}=e;this.logTypingLag("typing_lag"),J.createAndCommit({userAction:"CodeBlockValue.handleMutation",environment:this.environment,perform:e=>{Nt.aS({environment:this.environment,store:this.props.store,newValue:t,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}})},this.handleDelete=e=>{if(!this.canEdit())return;this.logTypingLag("typing_delete");const{store:t}=this.props,o=Gt.default.state;"editing"===o.mode&&o.multiSelection.start.store===t&&J.createAndCommit({userAction:"CodeBlockValue.handleDelete",environment:this.environment,perform:t=>{Ot.as({environment:this.environment,multiSelection:o.multiSelection,deleteForwards:!0,transaction:t,event:e})}})},this.handleBackspace=e=>{if(!this.canEdit())return;this.logTypingLag("typing_backspace");const{store:t}=this.props,o=Gt.default.state;if("editing"===o.mode&&o.multiSelection.start.store===t){if(Ot.YV({device:this.environment.device,event:e,multiSelection:o.multiSelection}))return;J.createAndCommit({userAction:"CodeBlockValue.handleBackspace",environment:this.environment,perform:t=>{Ot.as({environment:this.environment,multiSelection:o.multiSelection,deleteForwards:!1,transaction:t,event:e})}})}},this.handleEnter=e=>{var t;if(!this.canEdit())return;if(this.logTypingLag("typing_enter"),null===(t=e.preventDefault)||void 0===t||t.call(e),this.editor&&this.editor.isComposing)return;const o=Gt.default.state,n="editing"===o.mode&&(0,ee.QY)(o.multiSelection);n&&J.createAndCommit({userAction:"CodeBlockValue.handleEnter",environment:this.environment,perform:e=>{Nt.hJ({environment:this.environment,store:this.props.store,string:"\n",selection:n.selection,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}})},this.handleShiftEnter=e=>{var t;if(!this.canEdit())return;this.logTypingLag("typing_enter"),null===(t=e.preventDefault)||void 0===t||t.call(e);const o=Gt.default.state;"editing"===o.mode&&(J.createAndCommit({userAction:"CodeBlockValue.handleShiftEnter",environment:this.environment,perform:e=>{Lt.IO({environment:this.environment,multiSelection:o.multiSelection,transaction:e})}}),Jt())},this.handleTab=e=>{if(!this.canEdit())return;this.logTypingLag("typing_tab"),e.preventDefault();const t=Gt.default.state,o="editing"===t.mode&&(0,ee.QY)(t.multiSelection);o&&J.createAndCommit({userAction:"CodeBlockValue.handleTab",environment:this.environment,perform:e=>{Nt.wA({environment:this.environment,store:this.props.store,selection:o.selection,transaction:e,shouldStripTokens:!0})}})},this.handleUntab=e=>{if(!this.canEdit())return;this.logTypingLag("typing_untab"),e.preventDefault();const t=Gt.default.state,o="editing"===t.mode&&(0,ee.QY)(t.multiSelection);o&&J.createAndCommit({userAction:"CodeBlockValue.handleUntab",environment:this.environment,perform:e=>{Nt.O5({environment:this.environment,store:this.props.store,selection:o.selection,transaction:e,shouldStripTokens:!0})}})},this.handleAnnotation=(e,t)=>{this.canEdit()&&(t.preventDefault(),jt.aS({environment:this.environment,annotation:e}),Jt())},this.handleCopy=e=>{const{markdownLinkifyIt:t}=this.props;_t.JG({environment:this.environment,event:e,markdownLinkifyIt:t})},this.handleCut=e=>{const{markdownLinkifyIt:t}=this.props;this.canEdit()?_t.by({environment:this.environment,event:e,markdownLinkifyIt:t}):e.preventDefault()},this.handlePaste=e=>{const{markdownLinkifyIt:t,tinyMceMicrosoftWordPasteFilter:o}=this.props;this.canEdit()?J.createAndCommit({userAction:"CodeBlockValue.handlePaste",environment:this.environment,perform:n=>{_t.v({environment:this.environment,event:e,disableEmbedMenu:!0,transaction:n,onPasteFiles:_t.AL,markdownLinkifyIt:t,tinyMceMicrosoftWordPasteFilter:o})}}):e.preventDefault()},this.handleMoveUp=e=>{J.createAndCommit({userAction:"CodeBlockValue.handleMoveUp",environment:this.environment,perform:e=>{Nt.fs({environment:this.environment,transaction:e,direction:"up"})}})},this.handleMoveDown=e=>{J.createAndCommit({userAction:"CodeBlockValue.handleMoveDown",environment:this.environment,perform:e=>{Nt.fs({environment:this.environment,transaction:e,direction:"down"})}})},this.handleMouseOver=e=>{T.vO({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,canEdit:this.canEdit()})},this.handleMouseOut=e=>{T.kV({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,canEdit:this.canEdit()})},this.getDisabled=()=>!this.canEdit(),this.createSyntaxToken=e=>Zt.Gs(e)?[e.data]:Zt.kK(e)?[e.textContent||"",e.className]:void 0,this.getHtml=()=>{const{store:e,Prism:t}=this.props,o=this.getTextValue(),n=Pe.QaF(o),i=t.languages[this.props.language];if(this.props.language!==Rt.PrismLanguages.html&&this.props.language!==Rt.PrismLanguages.markup||(t.languages.markup.tag.addInlined("style","css"),t.languages.markup.tag.addInlined("script","javascript")),n&&i&&n.length<1e4){const e=document.createElement("div"),a=t.highlight(n,i,this.props.language);e.innerHTML=qt.g7(a);const s=Array.from(e.childNodes).map(this.createSyntaxToken),l=this.renderSyntaxTokens(Dt.oA(s),o),c=(0,u.jsxs)(r.Fragment,{children:[l,(0,u.jsx)("span",{children:"\n"})]});return Et.Z.renderToStaticMarkup(c)}{const t=T.IY({environment:this.environment,textValue:o&&{value:o,spaceId:this.props.parentSpaceId},parentStore:e,disableHover:!1,disableStyleAnnotations:!1,disableDateStyleAnnotations:!0,disabled:!this.canEdit(),theme:this.theme,emojiType:"raw",katex:void 0,formulaValueTypes:[]});return Et.Z.renderToStaticMarkup((0,u.jsx)(u.Fragment,{children:t}))}},this.clearBrowserSelection=()=>{var e;null===(e=this.getEditorNode())||void 0===e||e.blur()},this.isEditing=this.createComputedStore((()=>{var e;const t=Gt.default.state;return"editing"===t.mode&&(null===(e=(0,ee.QY)(t.multiSelection))||void 0===e?void 0:e.store)===this.props.store})),this.isNewDiscussionMenuTarget=this.createComputedStore((()=>{var e;const t=Ut.Z.state;return t.open&&"inline"===t.type&&(null===(e=(0,ee.QY)(t.multiSelection))||void 0===e?void 0:e.store)===this.props.store})),this.getContainerSelection=()=>{if(this.isEditing.state)return(0,zt.HE)(this.props.store)},this.getEndSelection=()=>{const e=At.p4(Pe.QaF(this.getTextValue()));return{startIndex:e.length,endIndex:e.length}},this.editorRef=e=>{this.editor=e}}renderComponent(){const{disabled:e}=this.props;return(0,u.jsx)($t.Z,{store:this.props.store,disabled:e,clearBrowserSelection:this.clearBrowserSelection,getEndSelection:this.getEndSelection,onClick:this.handleClick,onDelete:this.handleDelete,onBackspace:this.handleBackspace,onEnter:this.handleEnter,onShiftEnter:this.handleShiftEnter,onCommandEnter:Dt.yR,onCommandShiftEnter:Dt.yR,onTab:this.handleTab,onUntab:this.handleUntab,onToggleHighlight:e=>this.handleAnnotation(["h",Ht.Z.state.color],e),onToggleBold:e=>this.handleAnnotation(["b"],e),onToggleItalics:e=>this.handleAnnotation(["i"],e),onToggleUnderline:e=>this.handleAnnotation(["_"],e),onToggleStrike:e=>this.handleAnnotation(["s"],e),onToggleCode:Dt.yR,onCopy:this.handleCopy,onCut:this.handleCut,onPaste:this.handlePaste,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,render:this.renderContentContainer,disableMentions:!0,disableSlashCommands:!0,canSelectAllBlocks:!0,canInsertText:!0,canSelectionDrag:!0,topBottomPadding:40,pasteBehavior:"inline"})}canEdit(){const{disabled:e,store:t}=this.props,o=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,Vt.YF)(o)&&Boolean(!e&&t.canEdit())}getEditorNode(){var e;return(null===(e=this.editor)||void 0===e?void 0:e.getNode())||void 0}getTextValue(){return this.isNewDiscussionMenuTarget.state?T.Gj({store:this.props.store}):this.props.store.getValue()}logTypingLag(e){(0,Wt.u)({type:e,environment:this.environment,blockStore:this.props.blockStore,store:this.props.store,isInCollectionView:!1})}getContentEditableStyle(){return{flexGrow:1,flexShrink:1,textAlign:"left",fontFamily:_.Z.getCompositeFontFamily(f.SP).githubMono,fontSize:"85%",tabSize:2,padding:"34px 16px 32px 32px",minHeight:"1em",color:this.theme.regularTextColor}}}function Qt(e){window.__c={n:"CodeBlockValueWithDeps"};const{value:t}=(0,te.useDependency)(te.deps.prismjs),{value:o}=(0,te.useDependency)(te.deps.markdownLinkifyIt),{value:n}=(0,te.useDependency)(te.deps.tinyMceMicrosoftWordPasteFilter);return t?(0,u.jsx)(Yt,{...e,Prism:t,markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n}):null}function Jt(){Pt.default.flush()}Yt.displayName="CodeBlockValue";var Xt=o(48019),eo=o(52275),to=o(31945),oo=o(68894),no=o(78140),ro=o(62385),io=o(24405),ao=o(7406),so=o(66673),lo=o(4615);const co="\n---\n";var po=o(42402),uo=o(29551);function mo(e){window.__c={n:"MermaidRenderer"};const{source:t}=e,o=(0,so.Kt)(t,300,Object.is),n=(0,te.useDependency)(te.deps.mermaidAPI);return(0,u.jsx)("div",{children:n.error?(0,u.jsx)(ho,{error:n.error}):(0,u.jsx)(go,{mermaidAPI:n.value,source:o})})}function go(e){window.__c={n:"MermaidDOMRenderer"};const{mermaidAPI:t,source:o}=e,n=(0,r.useRef)(null),i=(0,r.useRef)(`mermaid-${(0,lo.ZP)()}`),[a,s]=(0,r.useState)(),l=(0,io.yK)((e=>({diagram:uo.gq.styles({alignContent:"center",justifyContent:"center"})})),[]),c=function(e){switch(e){case"dark":return"dark";case"light":return"neutral";default:(0,G.t1)(e)}}((0,io.Fg)().mode),d=(0,r.useMemo)((()=>function(e){const{source:t,theme:o}=e,n=`%%{init: {'theme':'${o}'}}%%\n`;return t.startsWith("---\n")&&t.includes(co)?t.replace(co,`\n---\n${n}`):`${n}${t}`}({source:o,theme:c})),[o,c]);return(0,r.useLayoutEffect)((()=>{if(!t)return;let e=!1;try{t.render(i.current,d).then((t=>{const o=t.svg,r=t.bindFunctions;if(e)return;if(!n.current)return;n.current.innerHTML=o;const i=n.current.firstChild;i&&i instanceof SVGSVGElement&&i.removeAttribute("height");try{r&&r(n.current),s(void 0)}catch(a){s((0,ao.tg)(a))}}),(e=>{s((0,ao.tg)(e))}))}catch(o){s((0,ao.tg)(o))}return()=>{e=!0}}),[d,t]),(0,u.jsxs)(u.Fragment,{children:[a&&(0,u.jsx)(ho,{error:a}),(0,u.jsx)("div",{style:l.diagram,ref:n})]})}function ho(e){window.__c={n:"MermaidError"};const{error:t}=e,o=(0,io.yK)((e=>({label:{color:e.errorText,marginBottom:4,whiteSpace:"pre-wrap"}})),[]);return"str"in t?(0,u.jsx)("div",{children:(0,u.jsxs)(qe.Z,{isMultiline:!0,style:o.label,children:[t.str,(0,u.jsx)("div",{children:(0,u.jsx)(po.Z,{external:!0,href:"https://mermaid-js.github.io/mermaid/#/examples",children:(0,u.jsx)(l.FormattedMessage,{id:"mermaidRenderer.error.seeMermaidExamples",defaultMessage:"See Mermaid examples"})})})]})}):(0,u.jsx)(qe.Z,{isMultiline:!0,style:o.label,children:(0,u.jsx)(l.FormattedMessage,{id:"mermaidRenderer.error.unknownError",defaultMessage:"Syntax error in Mermaid diagram: {error}",values:{error:`${t.name}: ${t.message}`}})})}class fo extends ne.Z{constructor(){super(...arguments),this.captionAriaId=(0,Ie.Z)(),this.storeTypes={focusStore:y.default.createClass(!1),mouseStore:Ne.Z,languageSelectorButtonPopupStore:B.Z,codePreviewFormatSelectorButtonPopupStore:B.Z,inputStore:Ct.Z},this.enableMermaidRenderer=this.createComputedStore((()=>"on"===It.default.getGroup("mermaid"))),this.CustomRenderedLanguages={Mermaid:{component:mo,gate:this.enableMermaidRenderer}},this.renderLanguageSelectorPopup=e=>{const{device:t}=this.environment,o=this.getCurrentLanguage(),n=nt.X0.filter((e=>"Java/C/C++/C#"!==e)),r=[{key:0,render:e=>(0,u.jsx)(gt.Z,{...e}),actions:n.map((t=>({key:t,displayName:t,analyticsName:t,searchName:t,render:e=>(0,u.jsx)(eo.Z,{title:t,...e}),action:()=>{this.setPersistedLanguage(t),e.close()},closeParentMenu:!0})))}],i=this.stores.inputStore.state.inputValue,a=(0,u.jsx)(Xt.Z,{filter:i,context:{blocks:[],environment:this.environment,publicEditMode:void 0},sections:r,initialFocus:i?0:n.findIndex((e=>e===o))}),s=(0,u.jsx)(gt.Z,{isInput:!0,children:(0,u.jsx)(oo.ZP,{value:i,onChange:this.handleInputChange,focus:!t.isMobile||void 0,placeholder:A.default.formatMessage(ht.RE.searchPlaceholder),focusAfterAnimation:!0})});let c;return c=t.isMobile?{menuType:kt.og.Modal,title:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Language",id:"codeBlock.mobileLanguageMenu.title"}),right:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Done",id:"codeBlock.mobileLanguageMenu.doneButton.label"}),onClickRight:e.close,header:s}:{menuType:kt.og.Popup,width:240,maxHeight:"50vh",header:s},(0,u.jsx)(no.Z,{...c,children:a})},this.renderCodePreviewFormatsPopup=e=>{const{device:t}=this.environment,o=this.props.store.getFormat().code_preview_format,n=(0,u.jsx)(Xt.Z,{context:{blocks:[this.props.store],environment:this.environment,publicEditMode:void 0},sections:St,initialFocus:["code","preview","split_view"].findIndex((e=>e===o))});let r;return r=t.isMobile?{menuType:kt.og.ActionSheet}:{menuType:kt.og.Popup,width:167,maxHeight:"50vh"},(0,u.jsx)(no.Z,{...r,children:n})},this.caption=()=>{this.handleEditCaption()},this.handleEditCaption=()=>{const e=this.props.store.getPropertyStore("caption");Y.eP({environment:this.environment,store:this.props.store}),Q.NX({store:e})},this.handleCopy=()=>{const e=this.props.store,t=Pe.Jcv(e.getBlockTitleStore().getValue());_t.RD({environment:this.environment,stringValue:t,copiedMessage:_t.tq.copiedCodeToClipboard})},this.handleInputChange=e=>{this.stores.inputStore.setState({inputValue:e.target.value,focus:!1})},this.handlePopupClose=()=>{this.stores.inputStore.reset()},this.handleFocus=e=>{const t=e.target;t instanceof HTMLElement&&(0,ot.E)(t)&&this.stores.focusStore.setState(!0)},this.handleBlur=()=>{this.stores.focusStore.setState(!1)}}renderPersisted(){const{device:e}=this.environment,{store:t,disabled:o}=this.props,n=this.getCurrentLanguage(),r=lt.W[n],i=this.getCurrentCodePreviewFormat(n),a=t.getFormat().code_wrap;return(0,u.jsxs)("div",{style:{display:"flex"},children:[(0,u.jsxs)(ge.p,{role:"figure","aria-labelledby":this.captionAriaId,allowSelectionWithin:!0,style:this.getStyle(),onMouseMove:()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),onMouseLeave:()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},children:[(0,u.jsxs)("div",{onFocus:this.handleFocus,onBlur:this.handleBlur,style:this.getLanguageSelectorStyle(),children:[this.renderLanguageSelector(),this.renderCodePreviewSelector()]}),(0,u.jsx)("div",{onFocus:this.handleFocus,onBlur:this.handleBlur,style:this.getHeaderStyle(),children:(0,u.jsxs)("div",{style:{color:this.theme.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,marginTop:4,marginRight:4},children:[!e.isMobile&&this.renderCopyToClipboardButton(),!e.isMobile&&this.canEdit()&&this.renderCaptionButton(),this.canEdit()&&(0,u.jsx)(je.Z,{style:{height:25,background:this.theme.codeBlockButtonBackground,borderTopLeftRadius:e.isMobile?3:0,borderBottomLeftRadius:e.isMobile?3:0,paddingLeft:8,paddingRight:8},store:this.props.store,fadeIn:!1})]})}),(0,u.jsxs)("div",{style:{},children:[this.shouldShowCodeBlock(n,i)&&(0,u.jsx)(Qt,{store:t.getBlockTitleStore(),blockStore:t,language:r,disabled:o,codeWrap:Boolean(a),isQuickFind:Boolean(this.props.isQuickFind),parentSpaceId:(0,ct.C)(t.pointer.spaceId)}),this.renderCustomCodePreview()]}),(0,u.jsx)("div",{style:this.getCaptionContainerStyle(),children:(0,u.jsx)(Oe.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})})]}),(0,u.jsx)(re.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store}),"â€‹"]})}hasCustomRenderer(e){return Boolean(this.getCustomRenderer(e))}getCustomRenderer(e){const t=this.CustomRenderedLanguages[e];if(t&&t.gate.state)return t}renderCustomCodePreview(){const{store:e}=this.props,t=this.getCurrentLanguage(),o=e.getBlockTitleStore(),n=this.getCurrentCodePreviewFormat(t),r="code"===n,i=this.getCustomRenderer(t);if(!r&&o.getValue()&&i)return(0,u.jsx)("div",{style:vo(n),children:(0,u.jsx)(i.component,{source:T.Xh(o.getValue(),o)})})}renderCodePreviewSelector(){const{device:e}=this.environment,t=this.getCurrentLanguage();if(this.hasCustomRenderer(t)){const o=this.getCurrentCodePreviewFormat(t);return(0,u.jsx)(to.ZP,{popupType:e.isMobile?to.Z4.SlideUp:to.Z4.Popup,renderOrigin:e=>(0,u.jsxs)(ro.Z,{disabled:!this.canEdit(),style:{marginRight:5},...e,children:[bo(o),(0,b.i)({width:10,marginLeft:4,fill:this.theme.lightIconColor})]}),buttonPopupStore:this.stores.codePreviewFormatSelectorButtonPopupStore,placementToOrigin:Tt.Iw.Bottom,render:this.renderCodePreviewFormatsPopup})}}renderLanguageSelector(){const{device:e}=this.environment,t=this.getCurrentLanguage();return(0,u.jsx)(to.ZP,{popupType:e.isMobile?to.Z4.SlideUp:to.Z4.Popup,renderOrigin:e=>(0,u.jsxs)(ro.Z,{disabled:!this.canEdit(),style:{marginRight:5},...e,children:[t,(0,b.i)({width:10,marginLeft:4,fill:this.theme.lightIconColor})]}),buttonPopupStore:this.stores.languageSelectorButtonPopupStore,placementToOrigin:Tt.Iw.Bottom,render:this.renderLanguageSelectorPopup,onClose:this.handlePopupClose})}renderCopyToClipboardButton(){return(0,u.jsxs)(ro.Z,{onClick:this.handleCopy,style:{...this.getButtonStyle(),borderTopRightRadius:0,borderBottomRightRadius:0},children:[(0,at.U)({height:16,width:16,paddingRight:4}),(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"})]})}renderCaptionButton(){return(0,u.jsx)(ro.Z,{onClick:this.handleEditCaption,style:{...this.getButtonStyle(),marginLeft:1,marginRight:1,borderRadius:0},children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Caption",id:"codeBlock.caption.button"})})}getCurrentLanguage(){const e=this.getPersistedLanguage();return e&&(0,nt.L9)(e)?e:xt.T.defaultLanguage}getPersistedLanguage(){const e=this.props.store.getProperties()||{};return it.Sj(e.language,rt.fG)}setPersistedLanguage(e){J.createAndCommit({userAction:"CodeBlock.setPersistedLanguage",environment:this.environment,perform:t=>{mt.E5({blocks:[this.props.store],language:e,transaction:t})}}),st.Z.set({userId:this.environment.currentUser.id,key:xt.T.localLanguagePreferenceKey,value:e})}getCurrentCodePreviewFormat(e){return this.hasCustomRenderer(e)?this.props.store.getFormat().code_preview_format??"split_view":xt.T.defaultCodePreviewFormat}shouldShowCodeBlock(e,t){return!this.hasCustomRenderer(e)||"preview"!==t}getStyle(){return{flexGrow:1,borderRadius:4,textAlign:"left",position:"relative",background:this.theme.codeBlockBackground,minWidth:0,width:"100%",...this.props.style}}getButtonStyle(){return{height:25,background:this.theme.codeBlockButtonBackground,color:this.theme.regularTextColor,fontWeight:_.Z.fontWeight.regular,padding:"4px 6px",fontSize:11.5}}getHeaderStyle(){const{mouseEntered:e}=this.stores.mouseStore.state,t=this.stores.focusStore.state,{isMobile:o}=this.environment.device,n=N.Z.state.isKeyboardMode,r=o||t||!n&&e;return{position:"absolute",top:3,right:1,zIndex:1,color:this.theme.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"flex-end",height:25,fontSize:11.5,opacity:r?1:0,transition:fo.transition}}getLanguageSelectorStyle(){const{mouseEntered:e}=this.stores.mouseStore.state,t=this.stores.focusStore.state,{isMobile:o}=this.environment.device,n=e||t||o;return{position:"absolute",top:8,left:8,zIndex:1,color:this.theme.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"flex-end",opacity:n?1:0,transition:fo.transition}}getCaptionContainerStyle(){return{background:this.theme.contentBackground,paddingRight:105}}}fo.transition="opacity 300ms ease-in";const yo=fo;function vo(e){switch(e){case"split_view":return{padding:16,flexGrow:1,flexShrink:0};case"preview":return{padding:16,paddingTop:40,alignSelf:"center",flexGrow:1,flexShrink:0};case"code":return{};default:(0,G.t1)(e)}}function bo(e){let t;switch(e){case"split_view":t=ht.RE.showSplitViewFormat;break;case"preview":t=ht.RE.showCodePreviewFormat;break;case"code":t=ht.RE.showOnlyCodeFormat;break;default:(0,G.t1)(e)}return(0,u.jsx)(l.FormattedMessage,{defaultMessage:t.defaultMessage,id:t.id})}var So=o(43661);function _o(e,t){window.__c={n:"CodepenBlock"};const o=(0,r.useRef)(null),n=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"codepen",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:n,ref:o,store:e.store,iconSvg:So.O,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with any public CodePen linkâ€¦",id:"codepenBlock.embed.caption"}),children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed CodePen",id:"codepenBlock.placeholder"})}))}const wo=r.memo(r.forwardRef(_o),s.Z);var ko=o(53223),xo=o(27627),Io=o(13084),Co=o(52989),To=o(78175),Mo=o(39500),Po=o(50628),Ao=o(480),Do=o(96049);const Bo=46,Ro=4;function Eo(e){window.__c={n:"ColumnDivider"};const t=(0,i.qz)(e.mouseStore,Ne.Z),{showHandle:o,onMouseDown:n,onTouchStart:a,onContextMenu:s,onDoubleClick:l}=e,c=(0,Ao.O7)(),d=(0,i.VK)((()=>o&&(t.state.mouseEntered||c.device.isMobile&&Do.Z.state)),[o,t,c.device]),p=(0,r.useCallback)((()=>{t.setState({...t.state,mouseEntered:!1}),Do.Z.removeListener(p)}),[t]),m=(0,r.useCallback)((()=>{Do.Z.removeListener(p),Do.Z.state||t.setState({...t.state,mouseEntered:!0})}),[p,t]),g=(0,r.useCallback)((()=>{Do.Z.state?Do.Z.addListener(p):t.setState({...t.state,mouseEntered:!1})}),[p,t]),h=(0,io.yK)((e=>{const t={position:"relative",width:Bo,flexGrow:0,flexShrink:0,transition:"opacity 200ms ease-out",opacity:0};return{base:t,hovered:{...t,opacity:1,cursor:"col-resize"},handle:{position:"absolute",top:0,bottom:0,left:Bo/2-Ro/2,width:Ro,height:"100%",background:e.darkDividerColor}}}),[]),f=d?h.hovered:h.base;return(0,u.jsx)("div",{style:f,onDoubleClick:l,onMouseDown:n,onTouchStart:a,onContextMenu:s,onMouseEnter:m,onMouseLeave:g,children:o&&(0,u.jsx)("div",{style:h.handle})})}const Fo=r.memo(Eo);o(57658);var No=o(45697),jo=o.n(No),Oo=o(96802);class Lo extends y.default{getInitialState(){return{dragging:!1}}}const Uo=Lo;var Zo=o(23883),Vo=o(70518),qo=o(12137),zo=o(58202);const Wo=function(e){const{columnListStore:t}=e;t.setState({dragging:!1})},Ho=function(e){const{columnListBlockStore:t,diffX:o,columnListStore:n,leftColumn:r,rightColumn:i}=e;if(n.state.dragging){const{leftColumnStartWidth:e}=n.state,a=(0,qo.Z)(n.state.leftColumnStartRatio,0,1),{rightColumnStartWidth:s}=n.state,l=(0,qo.Z)(n.state.rightColumnStartRatio,0,1),c=e+s,d=a+l,p=(0,qo.Z)(e+o,0,c),u=(0,qo.Z)(s-o,0,c),m=d*(p/c),g=d*(u/c);if(0===p&&0===u)return n.setState({...n.state,temporaryRatios:{}}),{leftColumnNewRatio:a,rightColumnNewRatio:l};{const e=1/(8*t.getContentLength());let o=Math.round(m/e)*e,s=g+(m-o);return o<e&&(o=e,s=a+l-e),s<e&&(s=e,o=l+a-e),n.setState({...n.state,temporaryRatios:{[r.id]:o,[i.id]:s}}),{leftColumnNewRatio:o,rightColumnNewRatio:s}}}};var Go=o(6685);function Ko(e){window.__c={n:"ColumnDraggableDivider"};const t=(0,i.qz)(e.mouseStore,Ne.Z),{canDrag:o,columnList:n,leftColumn:a,rightColumn:s,columnListStore:l}=e,c=(0,Ao.O7)(),d=(0,r.useCallback)((e=>{o&&(e.preventDefault(),function(e){const{environment:t,columnListStore:o,leftColumn:n,rightColumn:r}=e,i=zo.R.getRect(n),a=zo.R.getRect(r);i&&a&&(o.setState({dragging:!0,temporaryRatios:{},leftColumnStartWidth:i.width,leftColumnStartRatio:n.getColumnRatio(),rightColumnStartWidth:a.width,rightColumnStartRatio:r.getColumnRatio()}),Y.ZH(t),Q.ZH(t))}({environment:c,columnListStore:l,leftColumn:a,rightColumn:s}),Y.ZH(c),Q.sD())}),[o,c,a,l,s]),p=(0,r.useCallback)((e=>{o&&Ho({columnListBlockStore:n,columnListStore:l,leftColumn:a,rightColumn:s,diffX:e.diffX})}),[o,n,l,a,s]),m=(0,r.useCallback)((e=>{J.createAndCommit({userAction:"ColumnDivider.handleDragEnd",environment:c,perform:t=>{o&&function(e){const{environment:t,columnListStore:o,transaction:n,leftColumn:r,rightColumn:i}=e,a=Ho(e);if(a){const{leftColumnNewRatio:e,rightColumnNewRatio:s}=a;Oo.FH({stores:[r],update:{column_ratio:e},transaction:n}),Oo.FH({stores:[i],update:{column_ratio:s},transaction:n}),o.state.dragging&&o.setState({...o.state,temporaryRatios:{}}),k.wy9(t)}}({environment:c,columnListBlockStore:n,columnListStore:l,leftColumn:a,rightColumn:s,diffX:e.diffX,transaction:t})}}),Wo({columnListStore:l})}),[o,n,l,c,a,s]),g=(0,r.useCallback)((()=>{Wo({columnListStore:l})}),[l]),h=(0,r.useCallback)((()=>{J.createAndCommit({userAction:"ColumnDivider.handleDoubleClick",environment:c,perform:e=>{o&&function(e){const{columnListBlockStore:t,transaction:o,environment:n}=e,r=1/t.getContentLength();Oo.FH({stores:t.getContentStores(),update:{column_ratio:r},transaction:o}),k.UJm(n)}({environment:c,columnListBlockStore:n,transaction:e})}})}),[o,n,c]);return o?(0,u.jsx)(Go.Z,{allowDragWhileTextEditing:!0,onDraggableDragStart:d,onDraggableDragMove:p,onDraggableDragEnd:m,onDraggableDragCancel:g,disableHorizontalEdgeScroll:!0,disableVerticalEdgeScroll:!0,render:e=>(0,u.jsx)(Fo,{showHandle:!0,mouseStore:t,onDoubleClick:h,...e})}):(0,u.jsx)(Fo,{mouseStore:t,showHandle:!1})}const $o=r.memo(Ko);class Yo extends ne.Z{constructor(){super(...arguments),this.storeTypes={columnListStore:Uo,blockResizerStore:d.Z},this.handleResizeDoubleClick=()=>{J.createAndCommit({userAction:"ColumnList.handleResizeDoubleClick",environment:this.environment,perform:e=>{if(this.props.store.canEdit()){const t=!this.props.store.getFormat().block_full_width;Oo.FH({stores:[this.props.store],transaction:e,update:{block_full_width:t}})}}})},this.getChildrenLimit=this.createComputedStore((()=>{const{limitParents:e}=Zo.Z.state;let t;return this.props.store.findRecordStoreUIAncestor((o=>{const n=e.get(o);return!!n&&(t=n[this.props.store.id],!0)})),t})),this.isColumnListResizableStore=this.createComputedStore((()=>this.props.store.canEdit()&&(0,To.Po)(this.props.store,this.environment)))}getChildContext(){return{...this.context,isInColumnList:!0}}renderPersisted(){const{disabled:e}=this.props,t=this.stores.columnListStore.state,o=this.getChildrenLimit.state;let n=this.props.store.getContentStores();Dt.hj(o)&&(n=Dt.tP(n,0,o));let r=n.map(((e,o)=>{let n;return n=t.dragging&&t.temporaryRatios.hasOwnProperty(e.id)?t.temporaryRatios[e.id]:e.getColumnRatio(),n}));const i=Dt.Sm(r);r=Dt.UI(r,(e=>e/i));const a=[];return n.forEach(((t,o)=>{const i=0===o,s=o===n.length-1;a.push((0,u.jsx)(en,{store:t,isFirstItem:i,isLastItem:s,numColumns:n.length,ratio:r[o],disabled:e,columnListStore:this.props.store},t.id)),s||a.push((0,u.jsx)($o,{canDrag:this.canEdit(),columnList:this.props.store,leftColumn:t,rightColumn:n[o+1],columnListStore:this.stores.columnListStore},`divider${t.id}`))})),this.renderContainer(a)}renderContainer(e){return this.isColumnListResizableStore.state?(0,u.jsx)("div",{style:this.getResizableWrapperStyle(),children:(0,u.jsxs)("div",{style:Yo.columnRowStyle,children:[(0,u.jsx)(Vo.ZP,{disabled:!this.canEdit(),blockResizerStore:this.stores.blockResizerStore,resizeComponent:this,resizerType:Vo.IS.Horizontal,resizerAlignment:Vo.bZ.Left,preserveScale:!0,resizeHorizontally:!0,resizeVertically:!1,store:this.props.store,children:(0,u.jsx)("div",{style:Jo("left"),children:(0,u.jsx)(Fo,{onDoubleClick:this.handleResizeDoubleClick,showHandle:this.canEdit()})})},"divider-left-edge"),e,(0,u.jsx)(Vo.ZP,{disabled:!this.canEdit(),resizeComponent:this,resizerType:Vo.IS.Horizontal,resizerAlignment:Vo.bZ.Right,preserveScale:!0,resizeHorizontally:!0,resizeVertically:!1,store:this.props.store,blockResizerStore:this.stores.blockResizerStore,children:(0,u.jsx)("div",{style:Jo("right"),children:(0,u.jsx)(Fo,{onDoubleClick:this.handleResizeDoubleClick,showHandle:this.canEdit()})})},"divider-right-edge")]})}):(0,u.jsx)("div",{style:this.getColumnListStyle(),children:e})}handleCreated(){const{store:e}=this.props,t=e.getContentStores()[0];if(t&&t.getType()===Z.Ti.column){const e=t.getContentStores()[0];e&&e.getType()===Z.Ti.text&&(Y.eP({environment:this.environment,store:e}),Q.N_({store:e.getBlockTitleStore()}))}}getColumnListStyle(){const e={display:"flex"};return(0,To.zE)(this.props.store,this.environment)||(e.display="block"),e}getResizableWrapperStyle(){const e={position:"relative",transition:"padding 0.2s linear"},t=Boolean(this.props.store.getFormat().block_full_width);return(t&&this.stores.blockResizerStore.state.dragging?this.stores.blockResizerStore.state.temporaryFullWidth:t)&&(e.paddingLeft=Bo,e.paddingRight=Bo),e}}Yo.contextTypes=Mt.w,Yo.childContextTypes={isInColumnList:jo().any,...Mt.w},Yo.topBottomPadding=12,Yo.columnRowStyle={display:"flex",position:"relative",flexGrow:1};const Qo=Yo;function Jo(e){return{display:"flex",position:"absolute",top:0,bottom:0,right:"left"===e?"100%":"auto",left:"right"===e?"100%":"auto"}}class Xo extends ne.Z{constructor(){super(...arguments),this.handleDrop=e=>{const{droppedDirection:t,droppedStores:o,duplicate:n}=e;J.createAndCommit({userAction:"Column.handleDrop",environment:this.environment,perform:e=>{Io.LQ({environment:this.environment,droppedDirection:t,droppedStores:o,targetParentStore:this.props.columnListStore.getContentStore(),targetStore:this.props.store,duplicate:n,transaction:e})}})},this.handleMouseDown=e=>{(0,To.zE)(this.props.store,this.environment)&&(0,X.ZP)({event:e,context:X.Af.EditorMouseDown,callback:()=>{this.capturedMouseDown=!0,e.preventDefault(),Co.AI({environment:this.environment,target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!1})}})},this.handleMouseUp=e=>{if(this.capturedMouseDown&&!Mo.uG(e)){const{clientX:t,clientY:o,target:n}=e;Pt.default.afterNextFlush((()=>{Q.J9(this.environment,{x:t,y:o,target:n instanceof Element?n:void 0}),this.capturedMouseDown=!1}))}},this.handleClick=e=>{if(!Po.Z.hasBeenUpdatedSince(e.timeStamp)&&this.props.store.canEdit()){const{clientX:t,clientY:o,target:n}=e;Pt.default.afterNextFlush((()=>{J.createAndCommit({userAction:"Column.handleClick",environment:this.environment,perform:e=>{Q.LG(this.environment,{x:t,y:o,target:n instanceof Element?n:void 0},this.props.store,e)}})}))}}}renderComponent(){const{ratio:e,store:t,isLastItem:o,disabled:n}=this.props,r=1===t.getContentLength(),i=this.canEdit();return(0,u.jsx)(ie.Z,{isVisible:!0,animationStyle:this.getAnimationStyle({ratio:e}),render:()=>(0,u.jsx)("div",{style:this.getStyle(),onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:this.handleClick,children:(0,u.jsx)(ce.Z,{store:t,canDropLeft:i&&(0,To.zE)(this.props.store,this.environment),canDropRight:o&&i&&(0,To.zE)(this.props.store,this.environment),onSelectableDrop:this.handleDrop,analyticsName:"column",style:{display:"flex",flexDirection:"column"},shouldShowDropZone:!0,isListContainer:!0,children:(0,u.jsx)(le.Z,{store:t.getContentStore(),disabled:n,disableLayout:r,disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})})})})}getStyle(){const e={paddingTop:Qo.topBottomPadding,paddingBottom:Qo.topBottomPadding};return(0,To.zE)(this.props.store,this.environment)&&Dt.f0(e,{flexGrow:0,flexShrink:0}),e}getAnimationStyle(e){let{ratio:t}=e;const o={width:"100%"};return this.props.numColumns>1&&(o.width=`calc((100% - ${Bo*(this.props.numColumns-1)}px) * ${t})`),(0,To.zE)(this.props.store,this.environment)||(o.width="100%"),o}}const en=Xo;var tn=o(91948);function on(e,t){window.__c={n:"CopyIndicator"};const o=r.useRef(null),n=(0,io.yK)((()=>({root:{minHeight:"1.5em",display:"flex",alignItems:"center"},wrapper:{...U.ZD},progressBar:{flex:1,margin:"0 8px"}})),[]);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"copy_indicator",getNode:()=>o.current,getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(ge.p,{allowSelectionWithin:!1,style:n.wrapper,ref:o,children:(0,u.jsxs)("div",{style:n.root,children:[(0,u.jsx)(Ze.Z,{}),(0,u.jsx)("div",{style:n.progressBar,children:(0,u.jsx)(tn.Z,{targetRecordId:e.store.id})})]})}))}const nn=r.memo(r.forwardRef(on),s.Z);var rn=o(90827);const an=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Deepnote",id:"deepnoteBlock.embeds.button.label"}});function sn(e,t){window.__c={n:"DeepnoteBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"deepnote",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:rn.N,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with Deepnote blocks with public links",id:"deepnoteBlock.embeds.caption"}),embedButtonText:o.formatMessage(an.embedButtonText),urlInputPlaceholder:"https://deepnote.com/â€¦",children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed Deepnote",id:"deepnoteBlock.placeholder"})}))}const ln=r.memo(r.forwardRef(sn),s.Z);var cn=o(6404),dn=o(27724),pn=o(61519);function un(e,t){let{store:o}=e;window.__c={n:"DividerBlock"};const n=(0,Ao.Fy)(),i=(0,Ao.O7)(),a=(0,r.useRef)(null),s=(0,io.yK)((e=>({root:{color:e.darkDividerColor,pointerEvents:"auto"}})),[]),l=(0,r.useCallback)((e=>{n.isMobile&&(Y.Ys({environment:i,store:o}),cn.Qn({environment:i,stores:dn.default.state.stores,left:e.clientX,top:e.clientY,actionSectionGroupKey:"default",showInput:!0,analyticsFrom:"content_block_menu"}))}),[n.isMobile,i,o]);return(0,c.ez)(o,t,(0,r.useMemo)((()=>({renderedType:"divider",getNode:()=>a.current,getBlockStore:()=>o,handleCreated(){J.createAndCommit({userAction:"DividerBlock.handleCreated",environment:i,perform:e=>Io.Bm({environment:i,targetStore:o,targetParentStore:o.getRecordStoreUIParent(),isAtStartOfLine:!1,isClick:!1,transaction:e})})}})),[i,o]),(0,u.jsx)(pn.Z,{className:C.QSt,size:13,style:s.root,onClick:l,ref:a}))}const mn=r.memo(r.forwardRef(un),s.Z);var gn=o(4708);class hn extends ne.Z{constructor(){super(...arguments),this.handleCreated=()=>{this.edit()}}renderPersisted(){const e=(0,gn.A3)()?{source:"https://www.notion.so/product/drawing"}:{};return(0,u.jsx)(p.Z,{...this.props,...e,mediaMenuTabs:[],disableMediaMenu:!0,preserveScale:!1,showURLInput:!1})}edit(){Q.ZH({device:this.environment.device}),Y.Z5({environment:this.environment,stores:[this.props.store],phase:dn.SelectionPhase.Editing})}}const fn=hn;var yn=o(7057),vn=o(84869),bn=o(91584),Sn=o(68422),_n=o(63085),wn=o(28415);class kn extends y.default{getInitialState(){return{error:!1,loading:!1}}}const xn=kn,In=(0,l.defineMessages)({menuTitle:{defaultMessage:"Embed",id:"googleDriveBlock.mediaMenuActions.embedTab.title"}});class Cn extends ne.Z{constructor(){super(...arguments),this.captionAriaId=(0,Ie.Z)(),this.storeTypes={mouseStore:Ne.Z,driveStore:xn},this.openGoogleDriveFilePicker=e=>{wn.vE({environment:this.environment,accessToken:e.accessToken,callback:t=>{this.loadAndInitializeGoogleDrive(t,e)}})},this.handleMouseEnter=e=>{F.Z.state.isDragging||j.Z.state.isActive||this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=e=>{F.Z.state.isDragging||j.Z.state.isActive||this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.openMenu=()=>{const{device:e}=this.environment;if(this.canEdit()){const t=xe.findDOMNode(this);if(t&&t instanceof Element){const o=t.getBoundingClientRect();Ee.$(this.environment,{originRect:o,originGap:0,isSmallWidth:!1,showArrow:!0,currentTab:e.isMobile?"embed":"drive",tabs:this.mediaPickerTabs(),title:A.default.formatMessage(In.menuTitle),popupWidth:320,maxHeight:420})}}}}handleCreated(){this.openMenu()}didMount(){super.didMount();const e=this.props.store.getFormat();e&&e.drive_properties&&e.drive_properties.file_id&&e.drive_status&&e.drive_status.last_fetched+5*De.hM<Date.now()&&bn.WO(this.environment,{id:this.props.store.id,spaceId:(0,ct.C)(this.props.store.pointer.spaceId)})}renderPersisted(){const e=this.props.store.getProperties(),t=this.props.store.getFormat();return t&&t.drive_properties&&t.drive_status?this.renderBlock(t.drive_properties):e&&e.source?this.renderLegacy():this.renderPlaceholder()}renderBlock(e){const t=e.url;return(0,u.jsxs)("div",{role:"figure","aria-labelledby":this.captionAriaId,children:[(0,u.jsxs)("div",{style:{display:"flex"},children:[(0,u.jsxs)(Ue.Z,{href:t,external:!0,style:this.getContentStyle(),onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,children:[this.renderThumbnail(e),this.renderFile(e),this.shouldShowActionButton()&&this.canEdit()&&this.renderActionMenuButton()]}),(0,u.jsx)(re.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}),(0,u.jsx)(Oe.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]})}renderThumbnail(e){const t=e.thumbnail,o=this.stores.driveStore.state.error;return t&&!o?(0,u.jsx)("div",{style:Cn.imageLinkWrapStyle,children:(0,u.jsx)("div",{style:Cn.imageLinkInnerStyle,children:(0,u.jsx)(Ve.Z,{url:t,width:1e3,isAuthenticated:!0,permissionRecord:this.props.store.pointer,render:(t,o)=>{if(o){const t=Ae.SK(o,{v:e.version});return(0,u.jsx)("img",{src:t,style:Cn.imageStyle,onError:e=>{this.stores.driveStore.setState({error:!0,loading:!1})}})}t&&this.stores.driveStore.setState({error:!0,loading:!1})}})})}):(0,u.jsx)("div",{style:this.placeholderStyle()})}renderFile(e){const t=e.title,o=e.url,n=Ae.Qc(o).hostname;return(0,u.jsxs)("div",{style:this.getTextWrapStyle(),children:[t&&(0,u.jsx)(qe.Z,{style:{marginBottom:2},children:t}),this.renderDescription(e),(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:6},children:[e.icon&&(0,u.jsx)("div",{style:(r=e.icon,{flexShrink:0,backgroundImage:`url(${r})`,backgroundSize:"cover",width:16,height:16,marginRight:6})}),(0,u.jsx)(qe.Z,{style:{color:this.theme.regularTextColor},isSmall:!0,children:n})]})]});var r}renderDescription(e){const t=e.user_name||e.modified_time?(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Last modified {hasUserName, select, true {by {userName}} other {}} {hasLastModifiedTime, select, true {{lastModifiedTime}} other {}}",id:"googleDriveBlock.pageDescription",values:{hasUserName:Boolean(e.user_name),userName:e.user_name,hasLastModifiedTime:Boolean(e.modified_time),lastModifiedTime:e.modified_time&&(0,yn.tv)(e.modified_time,f.SP)}}):void 0;return(0,u.jsxs)("div",{style:this.getDescriptionStyle(),children:[e.trashed&&(0,u.jsx)(l.FormattedMessage,{defaultMessage:"This file is in trash.",id:"googleDriveBlock.pageDeleted.caption"}),t]})}renderActionMenuButton(){return(0,u.jsx)(je.Z,{store:this.props.store,style:{position:"absolute",top:4,right:4,background:p.Z.actionButtonBackground(this.environment)},iconStyle:{fill:v.ZP.white},fadeIn:!0})}renderLegacy(){return(0,u.jsx)(p.Z,{...this.props,...this.stores,store:this.props.store,iconSvg:vn.c,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with Google Docs, Google Sheetsâ€¦",id:"googleDriveBlock.legacyLinkInput.caption"}),children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed a file from Google Drive",id:"googleDriveBlock.legacy.placeholder"})})}renderPlaceholder(){const{disabled:e}=this.props,t=this.props.store.getFormat().drive_status,o=!(!t||!t.authed);return(0,u.jsxs)("div",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,style:{display:"flex"},children:[(0,u.jsx)(ze.Z,{iconSvg:vn.c,disabled:e,shouldHideRight:!this.shouldShowActionButton(),right:this.canEdit()&&(0,u.jsx)(je.Z,{store:this.props.store,fadeIn:!1}),onClick:this.openMenu,isLoading:this.stores.driveStore.state.loading,progressPercent:0,children:o?(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Choose a file to embed from Google Drive",id:"googleDriveBlock.placeholder.authenticated"}):(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Connect Google Drive to Notion to embed a file",id:"googleDriveBlock.placeholder.notAuthenticated"})}),(0,u.jsx)(re.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}shouldShowActionButton(){const{device:e}=this.environment;return e.isMobile||this.stores.mouseStore.state.mouseEntered}async loadAndInitializeGoogleDrive(e,t){this.stores.driveStore.setState({loading:!0,error:!1});const o=await bn.Ui({environment:this.environment,store:this.props.store,fileId:e,token:t});this.stores.driveStore.setState({loading:!1,error:!o||!!o.auth_error})}async initializeGoogleDriveBlockFromUrl(e){const t=_n.id(e);if(!t)return void this.convertToTextBlock(e);const o=await bn.Ui({environment:this.environment,store:this.props.store,fileId:t});o&&o.auth_error&&(bn.cR(this.environment,{onSuccess:e=>{this.loadAndInitializeGoogleDrive(t,e)},onFailure:()=>{this.convertToTextBlock(e)}}),this.trackAuthPrompt("url_embed"))}convertToTextBlock(e){J.createAndCommit({userAction:"DriveBlock.convertToTextBlock",environment:this.environment,perform:t=>{$.sW({store:this.props.store.getPropertiesStore(),data:{title:[Pe.V3y(e,[Pe.edl(e)])]},transaction:t}),Sn.Cj({environment:this.environment,blocks:[this.props.store],blockType:"text",transaction:t})}})}mediaPickerTabs(){const{device:e}=this.environment,t=[];return t.push({type:"embed",caption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with any file in your Google Drive",id:"googleDriveBlock.embedTab.caption"}),buttonText:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed Google Drive file",id:"googleDriveBlock.embedTab.embedButton.label"}),onChange:e=>{Ee.Z(),this.initializeGoogleDriveBlockFromUrl(e)}}),e.isMobile||t.push({type:"drive",title:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Browse Google Drive",id:"googleDriveBlock.mediaPicker.googleDriveTab.title"}),onSelect:async e=>{if(Ee.Z(),e&&e.token)this.openGoogleDriveFilePicker(e.token),k.uul(this.environment);else{const e=await bn.qN(this.environment);e&&e.token&&this.openGoogleDriveFilePicker(e.token),this.trackAuthPrompt("drive_file_picker")}}}),t}trackAuthPrompt(e){k.SOV(this.environment,{integration_name:"google",from:e})}getContentStyle(){return{display:"flex",flexDirection:"column",width:"100%",border:`1px solid ${this.theme.darkDividerColor}`,borderRadius:4,position:"relative"}}placeholderStyle(){return{...Cn.imageLinkWrapStyle,paddingBottom:"20%",minHeight:80,background:this.theme.embedPlaceholderBackground}}getTextWrapStyle(){return{width:"100%",minHeight:60,padding:14,paddingTop:12,overflow:"hidden",borderTop:`1px solid ${this.theme.darkDividerColor}`}}getDescriptionStyle(){return{fontSize:12,lineHeight:1.3,color:this.theme.mediumTextColor,maxHeight:32,overflow:"hidden"}}}Cn.imageLinkWrapStyle={display:"block",position:"relative",width:"100%",paddingBottom:"55%"},Cn.imageLinkInnerStyle={position:"absolute",top:0,left:0,right:0,bottom:0},Cn.imageStyle={display:"block",width:"100%",height:"100%",objectFit:"cover",objectPosition:"top"};const Tn=Cn;var Mn=o(63003),Pn=o(83631),An=o(3702),Dn=o(22492),Bn=o(40148);class Rn extends ne.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:Ne.Z,focusStore:y.default.createClass(!1),buttonPopupStore:B.Z},this.renderOrigin=()=>{const{device:e}=this.environment,{store:t}=this.props,o=this.getValue();let n,r={};o?n=(0,u.jsx)(Dn.Z,{display:"block",equation:o,style:this.getContainerStyle(!1),errorStyle:this.getContainerStyle(!0),theme:this.theme}):(n=(0,u.jsx)(Bn.ZP,{iconSvg:Mn.f,iconStyle:{width:28,height:28,marginRight:8},style:{background:void 0},children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Add a TeX equation",id:"equationBlock.empty.placeholder"})},"button"),r={background:this.theme.sidebarBackground});const i=e.isMobile||this.stores.mouseStore.state.mouseEntered||this.stores.focusStore.state;return(0,u.jsxs)(ae.Z,{onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onClick:this.handleOpen,style:{position:"relative",width:"100%",borderRadius:4,...r},children:[n,this.canEdit()&&(0,u.jsx)(je.Z,{onFocus:this.handleFocus,onBlur:this.handleBlur,store:t,tooltipContent:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Rename, delete, and moreâ€¦",id:"equationBlock.actions.tooltip"}),style:{position:"absolute",top:4,right:4,color:this.theme.mediumTextColor,opacity:i?1:0},fadeIn:!1})]})},this.handleChange=e=>{J.createAndCommit({userAction:"EquationBlock.handleChange",environment:this.environment,perform:t=>{$.sW({store:this.props.store.getPropertiesStore(),data:{title:Pe.TPx(e)},transaction:t})}})},this.handleOpen=()=>{this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!0})},this.handleClose=()=>{this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!1}),Y.Ys({environment:this.environment,store:this.props.store})},this.handleMouseMove=e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=e=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.handleFocus=e=>{const t=e.target;t instanceof HTMLElement&&(0,ot.E)(t)&&this.stores.focusStore.setState(!0)},this.handleBlur=()=>{this.stores.focusStore.setState(!1)},this.handleSubmit=()=>{k.PyM(this.environment,{equation:this.getValue()})}}handleCreated(){this.handleOpen()}edit(){this.handleOpen()}activate(){this.stores.buttonPopupStore.state.open?this.handleClose():this.handleOpen()}renderPersisted(){const e=this.getValue(),t=this.stores.buttonPopupStore.state.open?{isOpen:!0,equationValue:e,error:Pn.by({environment:this.environment,equation:e,displayMode:"block"})}:{isOpen:!1,equationValue:void 0,error:void 0},o=!this.canEdit(),n=this.renderOrigin();return(0,u.jsxs)(ge.p,{allowSelectionWithin:!0,style:{display:"flex",position:"relative"},children:[(0,u.jsx)(te.DependencyConsumer,{dependency:te.deps.prismjs,children:e=>(0,u.jsx)(An.Z,{...t,Prism:e,displayMode:"block",disabled:o,origin:n,onDismiss:this.handleClose,onChange:this.handleChange,onSubmit:this.handleSubmit})}),(0,u.jsx)(re.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}getValue(){const e=this.props.store.getProperties();return Pe.Jcv(e&&e.title)}getContainerStyle(e){const t={display:"flex",padding:"4px 8px",width:"100%"};return this.getValue()?(t.flexDirection="column",t.overflow="auto"):t.color=v.ZP.contentPlaceholder,e&&(t.background=this.theme.equationErrorPlaceholderBackground),{...t,...this.getBlockColorStyle()}}}const En=Rn;var Fn=o(56185);const Nn=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Excalidraw",id:"excalidrawBlock.embeds.button.label"}});function jn(e,t){window.__c={n:"ExcalidrawBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"excalidraw",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:Fn.F,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with Excalidraw whiteboards.",id:"excalidrawBlock.embeds.caption"}),embedButtonText:o.formatMessage(Nn.embedButtonText),urlInputPlaceholder:"https://excalidraw.com/â€¦",children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed Excalidraw",id:"excalidrawBlock.placeholder"})}))}const On=r.memo(r.forwardRef(jn),s.Z);var Ln=o(14562),Un=o(13797),Zn=o(47453),Vn=o(95802),qn=o(26664),zn=o(54532),Wn=o(42858);var Hn=o(52315);class Gn extends y.default{getInitialState(){return{open:!1}}}const Kn=Gn;var $n=o(35661),Yn=o(34583),Qn=o(42922),Jn=o(23189),Xn=o(13490);class er extends Mt.Z{constructor(){super(...arguments),this.storeTypes={store:Kn},this.renderProperty=(e,t)=>{let{title:o,subtitle:n,value:r}=e;return(0,u.jsxs)("div",{children:[(0,u.jsx)(pn.Z,{size:36}),(0,u.jsx)(Xn.Z,{children:o}),(0,u.jsx)(qe.Z,{isSmall:!0,children:n}),(0,u.jsx)("div",{style:{marginTop:8,padding:6,background:this.theme.sidebarBackground,borderRadius:4},children:r})]},t)},this.handleCloseClick=()=>{this.stores.store.setState({...this.stores.store.state,open:!1})}}renderComponent(){return this.stores.store.state.open?(0,u.jsxs)("div",{style:{flexGrow:1,minWidth:0},children:[this.props.origin,(0,u.jsxs)("div",{style:{position:"relative",boxShadow:`inset 0 0 0 1px ${this.theme.regularDividerColor}`,padding:12,borderRadius:4,overflow:"hidden"},children:[(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,u.jsx)(Jn.Z,{style:{flex:1,marginRight:16,marginBottom:0},children:this.props.title}),(0,u.jsx)(Qn.Z,{onClick:this.handleCloseClick,children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Close",id:"factoryBlock.configureMenu.closeButton.label"})})]}),this.props.properties.map(this.renderProperty)]})]}):this.props.origin}}er.displayName="Configurable",er.headStyle={display:"flex",alignItems:"center"},er.titleStyle={flex:1,fontSize:14,userSelect:"none",WebKitUserSelect:"none",cursor:"default"};const tr=er;var or=o(15201),nr=o(73063),rr=o(89728),ir=o(26388);const ar=(0,l.defineMessages)({addNewItem:{defaultMessage:"Add a new item",id:"factoryBlock.newItem.button.label"},buttonPlaceholder:{defaultMessage:"Add a new item",id:"factoryBlock.newItem.button.placeholder"}});class sr extends ne.Z{constructor(){super(...arguments),this.storeTypes={configurableStore:Kn,mouseStore:Ne.Z},this.handleMouseMove=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.handleButtonClick=()=>{this.canEdit()&&Yn.M_(this.environment)&&J.createAndCommit({userAction:"FactoryBlock.handleButtonClick",environment:this.environment,perform:e=>{!function(e){const{store:t,transaction:o,environment:n}=e,r=t.getRecordStoreUIParent();let i=!1;r&&r.valueIs(qn.i)&&Dt.YM(r.getValue())!==t.id&&Dt.Z$(r.getValue())===t.id&&(i=!0);const a=t.getContentStores().filter((e=>e.isDefined()));i||a.reverse();const s=Vn.C.findSelectableFromStore(t),l=[],c=Promise.all(a.map((e=>new Promise((r=>{const a=e.getModel(),c=!a||!a.isTemplateVariableContainerBlock(),[d,p]=zn.Qi({environment:n,stores:[e],transaction:o,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:c,targetSpaceId:(0,ct.C)(e.pointer.spaceId),baseUrl:wt.default.domainBaseUrl,publicDomainName:wt.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:t.useCrdt()}),u=d[0];p.then((e=>{e&&Re.showErrorMessage(e),r()})),s&&(i?s.props.onInsertAbove&&s.props.canInsertAbove&&l.push(s.props.onInsertAbove({insertStores:[u],transaction:o})[0]):s.props.onInsertBelow&&s.props.canInsertBelow&&l.push(s.props.onInsertBelow({insertStores:[u],transaction:o})[0]))})))));i||l.reverse(),Y.Z5({environment:n,stores:l}),c.then((()=>{Pt.default.afterNextFlush((()=>{Wn.DV({environment:n,insertedStores:l,isCreated:!0})}))}))}({environment:this.environment,store:this.props.store,transaction:e})}})},this.handleToggleConfigure=()=>{this.stores.configurableStore.state.open?this.stores.configurableStore.setState({...this.stores.configurableStore.state,open:!1}):(k.PEc(this.environment,{from:"gear_button"}),this.stores.configurableStore.setState({...this.stores.configurableStore.state,open:!0}))}}willMountOrUpdate(e){super.willMountOrUpdate(e),Hn.b(e.store)}handleCreated(){this.configure()}activate(){this.handleButtonClick()}configure(){this.stores.configurableStore.setState({...this.stores.configurableStore.state,open:!0})}renderPersisted(){const e=this.getDisabled();return(0,u.jsxs)(ge.p,{allowSelectionWithin:!0,style:{display:"flex"},children:[(0,u.jsx)(tr,{title:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Configure template button",id:"factoryBlock.configureButton.label"}),origin:this.renderFactory(),store:this.stores.configurableStore,properties:[{title:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Button name",id:"factoryBlock.buttonName.title"}),subtitle:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"What should this button be called?",id:"factoryBlock.buttonName.subtitle"}),value:(0,u.jsx)(de.Z,{disabled:e,store:this.getInteriorTitleStore(),placeholder:A.default.formatMessage(ar.addNewItem),onEnter:Dt.yR,pasteBehavior:"inline"})},{title:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Template",id:"factoryBlock.templateArea.title"}),subtitle:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Drop blocks here that you want to duplicate whenever the button is clicked.",id:"factoryBlock.templateArea.subtitle."}),value:(0,u.jsx)(or.O,{displayName:"FactoryBlockContent",disabled:e,children:(0,u.jsx)(le.Z,{disabled:e,store:this.props.store.getContentStore(),emptyPlaceholder:(0,u.jsx)("div",{style:{caretColor:this.theme.regularTextColor,color:this.theme.regularTextColor},children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Empty. Drop blocks hereâ€¦",id:"factoryBlock.emptyTemplate.placeholder"})}),disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})})}]}),(0,u.jsx)(re.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}renderFactory(){const{device:e}=this.environment,t=this.getDisabled();return(0,u.jsxs)(rr.Z,{icon:Zn.R,isGray:!0,isLarge:!0,style:{fontSize:"inherit",width:"100%"},shouldShrink:!0,onClick:this.handleButtonClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,disabled:t,children:[(0,u.jsx)(de.Z,{disabled:!0,store:this.props.store.getBlockTitleStore(),placeholder:A.default.formatMessage(ar.buttonPlaceholder),style:sr.buttonTextStyle,placeholderStyle:this.getPlaceholderStyle()}),!t&&(e.isMobile||this.stores.mouseStore.state.mouseEntered)&&(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center"},className:C.JiD,children:[!e.isMobile&&this.renderConfigureButton(),(0,u.jsx)(je.Z,{tooltipContent:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"More actionsâ€¦",id:"factoryBlock.moreActions.button.label"}),store:this.props.store,fadeIn:!0})]})]})}renderConfigureButton(){return(0,u.jsx)(ir.Z,{renderTooltip:()=>(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Configure template",id:"factoryBlock.configureTemplate.button.label"}),delayThreshold:300,render:e=>(0,u.jsx)(nr.Z,{icon:Un.F,onClick:this.handleToggleConfigure,...e})})}getDisabled(){return this.props.disabled||!this.canEdit()}getInteriorTitleStore(){return $n.G.createChildStore(this.props.store,this.props.store.pointer).getBlockTitleStore()}getPlaceholderStyle(){return{width:"100%",display:"block",caretColor:this.theme.regularTextColor,color:this.theme.regularTextColor,..._.Z.textOverflowStyle}}}sr.buttonTextStyle={pointerEvents:"none",..._.Z.textOverflowStyle};const lr=sr;var cr=o(71441);function dr(e,t){window.__c={n:"FigmaBlock"};const o=(0,r.useRef)(null),n=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"figma",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,ref:o,blockResizerStore:n,store:e.store,iconSvg:cr.O,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with any public Figma shareable link",id:"figmaBlock.caption"}),children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed Figma",id:"figmaBlock.placeholder"})}))}const pr=r.memo(r.forwardRef(dr),s.Z);var ur=o(69721),mr=o(60997);const gr=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Framer",id:"framerBlock.embedFramer.button.label"}});function hr(e,t){window.__c={n:"FramerBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"framer",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:mr.B,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with Framer prototypes",id:"framerBlock.linkInput.caption"}),embedButtonText:o.formatMessage(gr.embedButtonText),urlInputPlaceholder:"https://framer.com/â€¦",children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed a Framer prototype",id:"framerBlock.placeholder"})}))}const fr=r.memo(r.forwardRef(hr),s.Z);var yr=o(69578);const vr=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Gist",id:"gistBlock.embedButton.label"}});function br(e,t){window.__c={n:"GistBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"gist",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:yr.f,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with links to Gists on GitHub",id:"gistBlock.linkInput.caption"}),embedButtonText:o.formatMessage(vr.embedButtonText),urlInputPlaceholder:"https://gist.github.com/â€¦",children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed a Gist",id:"gistBlock.placeholder"})}))}const Sr=r.memo(r.forwardRef(br),s.Z);var _r=o(65453),wr=o(64258);const kr=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Hex",id:"hexBlock.embeds.button.label"}});function xr(e,t){window.__c={n:"HexBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"hex",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:wr.p,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with Hex cell links with public access.",id:"hexBlock.embeds.caption"}),embedButtonText:o.formatMessage(kr.embedButtonText),urlInputPlaceholder:"https://hex.tech/â€¦",children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed Hex",id:"hexBlock.placeholder"})}))}const Ir=r.memo(r.forwardRef(xr),s.Z);var Cr=o(44597);const Tr=(0,l.defineMessages)({urlPlaceholder:{defaultMessage:"Paste the image linkâ€¦",id:"imageBlock.linkInput.placeholder"},embedButtonText:{defaultMessage:"Embed image",id:"imageBlock.embedImage.button.label"}});function Mr(e,t){window.__c={n:"ImageBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z),s=(0,i.VK)((()=>{const e=[{type:"file",imageUpload:!0},{type:"embed"},{type:"unsplash"}];return It.default.checkGate("enable_giphy_feature_gate")&&e.push({type:"giphy"}),e}),[]);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"image",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,urlInputPlaceholder:o.formatMessage(Tr.urlPlaceholder),iconSvg:Cr.U,preserveScale:!0,mediaMenuCurrentTab:"file",mediaMenuTabs:s,mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with any image from the web",id:"imageBlock.linkInput.caption"}),embedButtonText:o.formatMessage(Tr.embedButtonText),popupWidth:540,maxHeight:420,children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Add an image",id:"imageBlock.placeholder"})}))}const Pr=r.memo(r.forwardRef(Mr),s.Z);var Ar=o(48964);const Dr=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Invision",id:"invisionBlock.embeds.button.label"}});function Br(e,t){window.__c={n:"InvisionBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"invision",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:Ar.v,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with Invision projects",id:"invisionBlock.embeds.caption"}),embedButtonText:o.formatMessage(Dr.embedButtonText),urlInputPlaceholder:"https://invis.io/â€¦",children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed an Invision project",id:"invisionBlock.placeholder"})}))}const Rr=r.memo(r.forwardRef(Br),s.Z);var Er=o(6287),Fr=o(72711),Nr=o(31299),jr=o(80444);class Or extends y.default{getInitialState(){return{query:""}}}const Lr=Or;var Ur=o(69454),Zr=o(3386),Vr=o(32163),qr=o(43765),zr=o(11470),Wr=o(77137),Hr=o(75987),Gr=o(36488),Kr=o(74194),$r=o(53437);class Yr extends Mt.Z{constructor(){super(...arguments),this.storeTypes={store:Lr},this.handleQueryUpdateDebounced=void 0,this.handleInputChange=e=>{const t=e.target.value;this.stores.store.setState({...this.stores.store.state,query:t}),this.handleQueryUpdateDebounced(t)},this.handleQueryUpdate=e=>{this.props.onQueryUpdate&&this.props.onQueryUpdate({query:e,autocompleteStore:this.stores.store})}}get registries(){return[Hr.Z]}willMount(e){super.willMount(e),this.handleQueryUpdateDebounced=Dt.Ds(this.handleQueryUpdate,this.props.queryUpdateDebounce)}renderComponent(){const{device:e}=this.environment;return(0,u.jsx)($r.ZP,{popupType:e.isPhone?$r.ZP.PopupType.SlideUp:$r.ZP.PopupType.Popup,open:this.props.isOpen,origin:this.renderInput(),placementToOrigin:$r.ZP.Placement.Bottom,alignmentToOrigin:$r.ZP.Alignment.Start,originGap:4,disableDarkOverlayBackground:e.isPhone,onDismiss:this.props.onBgClick,render:this.props.renderPopup,preventCaptureEsc:this.props.preventCaptureEsc,disableMouseCapture:this.props.disableMouseCapture,style:this.props.popupStyle})}renderInput(){const e=this.props.isOpen;return(0,u.jsx)(Gr.Z,{capture:e,allowMenuList:!0,render:e=>(0,u.jsx)(ge.p,{allowSelectionWithin:!0,...e,children:(0,u.jsx)(Kr.Z,{style:this.props.inputStyle,format:void 0!==this.props.format?this.props.format:Kr.Z.Format.Transparent,value:this.stores.store.state.query,onClick:this.props.onInputClick,onFocus:this.props.onInputFocus,onBlur:this.props.onInputBlur,onChange:this.handleInputChange,placeholder:this.props.inputPlaceholder,focus:this.props.focus})})})}}Yr.displayName="InlineAutocomplete";const Qr=Yr,Jr=(0,l.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a databaseâ€¦",id:"linkToCollectionBlock.input.placeholder"}});class Xr extends ne.Z{constructor(){super(...arguments),this.didPerformAction=!1,this.storeTypes={autocompleteStore:Lr,mouseStore:Ne.Z},this.handleBlur=()=>{Q.ZH(this.environment),this.didPerformAction||(this.didPerformAction=!0,J.createAndCommit({userAction:"LinkToCollectionBlock.handleBlur",environment:this.environment,perform:e=>{Wn.Od({store:this.props.store,transaction:e})}}))},this.isEditing=this.createComputedStore((()=>{const{store:e}=this.props,t=Gt.default.state;return Boolean("editing"===t.mode&&(0,ee.qS)(t.multiSelection)&&t.multiSelection.start.store.id===e.id)})),this.performQuery=async e=>{if(this.props.store.isDefaultRecordCache()){const{currentSpaceStore:t}=jr.default.state;return(await Nr.bm(this.environment,{query:e,limit:20,source:"link_to_collection_block",spaceStore:t})).results}return[]}}handleCreated(){Y.$Y({environment:this.environment,phase:dn.SelectionPhase.Editing}),Q.Z5({store:this.props.store,selection:void 0})}renderComponent(){if(this.isEditing.state)return this.renderSearchInput()}renderSearchInput(){const{device:e}=this.environment,{query:t}=this.stores.autocompleteStore.state;return(0,u.jsx)(Wr.Z,{request:t,performRequest:this.performQuery,debounce:Nr.vp,render:(t,o,n)=>{const r=(o||[]).map((e=>{const t=$n.NW.createChildStore(this.props.store,{table:Er.v,id:e});return{key:e,render:e=>(0,u.jsx)(zr.Z,{...e,store:t}),action:()=>{if(!this.didPerformAction){this.didPerformAction=!0;const{store:e}=this.props;J.createAndCommit({userAction:"LinkToCollectionBlock.menuListItem",environment:this.environment,perform:o=>{const n=Fr.Y_({environment:this.environment,store:e,collectionStore:t,collectionViewStore:void 0,transaction:o});n&&Y.Z5({environment:this.environment,stores:[n]})}})}}}}));return(0,u.jsx)(Zr.Z,{capture:this.isEditing.state,children:(0,u.jsx)(Qr,{loading:!n,isOpen:!0,store:this.stores.autocompleteStore,queryUpdateDebounce:Nr.vp,inputPlaceholder:A.default.formatMessage(Jr.inputPlaceholder),focus:!0,inputStyle:{...ti(),borderBottom:void 0},onBgClick:this.handleBlur,renderPopup:()=>{let t,i;return t=o&&0===r.length?(0,u.jsx)(gt.Z,{title:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Select a database",id:"linkToCollectionBlock.menuItem.noResults.title"}),loading:!n,children:(0,u.jsx)(qr.Z,{title:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"linkToCollectionBlock.menuItem.noResults.label"})})}):(0,u.jsx)(Vr.Z,{type:Vr.i.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,u.jsx)(gt.Z,{...e,title:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Select a database",id:"linkToCollectionBlock.menuItem.showResults.title"}),loading:!n}),items:r}]}),i=e.isPhone?{menuType:kt.og.ActionSheet,disableBottomPadding:!0,maxHeight:`calc(70vh - ${Ur.Z.estimatedNativeWebBottomOverlap()}px)`}:{menuType:kt.og.Popup,width:460,maxHeight:e.isPhone?"30vh":"40vh"},(0,u.jsx)(no.Z,{...i,children:t})}})})}})}}const ei=Xr;function ti(){return{lineHeight:1.3}}var oi=o(27006),ni=o(21202),ri=o(61045),ii=o(28020);const ai=(0,l.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a pageâ€¦",id:"linkToPageBlock.searchPlaceholder"}});class si extends ne.Z{constructor(){super(...arguments),this.didPerformAction=!1,this.storeTypes={autocompleteStore:Lr,mouseStore:Ne.Z},this.handleBlur=()=>{Q.ZH(this.environment),this.didPerformAction||(this.didPerformAction=!0,J.createAndCommit({userAction:"LinkToPageBlock.handleBlur",environment:this.environment,perform:e=>{Wn.Od({store:this.props.store,transaction:e})}}))},this.isEditing=this.createComputedStore((()=>{const{store:e}=this.props,t=Gt.default.state;return Boolean("editing"===t.mode&&(0,ee.qS)(t.multiSelection)&&t.multiSelection.start.store.id===e.id)})),this.performQuery=async e=>{const{currentSpaceStore:t,mainEditorCurrentBlockStore:o}=jr.default.state,{store:n}=this.props,r=(0,Vt.YO)(n).find((e=>{let{permissionItem:t}=e;return(0,oi.$D)(t)}));if(this.props.store.isDefaultRecordCache()&&(t||r)){if(!e)return r&&!t&&o?[o.id]:ii._u(this.environment).map((e=>e.id));if(t){return(await Nr.nJ({environment:this.environment,query:e,limit:20,spaceId:t.id,requireEditPermissions:!1,excludeTemplates:!1,source:"link_to_page_block",boostRecentlyViewedPages:!0})).results}if(r&&r.from.table===ni.iU){return(await Nr.M0({environment:this.environment,query:e,limit:20,ancestorId:r.from.blockId,excludeTemplates:!1,source:"link_to_page_block"})).results}}return[]}}handleCreated(){const{device:e}=this.environment;Y.$Y({environment:this.environment,phase:dn.SelectionPhase.Editing}),Q.Z5({store:this.props.store,selection:void 0}),e.isMobile&&Ur.Z.onShow((()=>ri.hQ(this.environment)))}renderComponent(){if(this.isEditing.state)return this.renderSearchInput()}renderSearchInput(){const{device:e}=this.environment,{query:t}=this.stores.autocompleteStore.state,o={request:t,performRequest:this.performQuery,debounce:Nr.vp,render:(t,o,n)=>{const r=(o||[]).map((e=>{const t=$n.G.createChildStore(this.props.store,{table:ni.iU,id:e});return{key:e,render:e=>(0,u.jsx)(zr.Z,{...e,store:t}),action:()=>{this.didPerformAction||(this.didPerformAction=!0,J.createAndCommit({userAction:"LinkToPageBlock.menuListItem",environment:this.environment,perform:e=>{const o=Fr.hc({environment:this.environment,store:this.props.store,targetStore:t,transaction:e});o&&Y.Z5({environment:this.environment,stores:[o]})}}))}}}));return(0,u.jsx)(Zr.Z,{capture:this.isEditing.state,children:(0,u.jsx)(Qr,{loading:!n,isOpen:!0,store:this.stores.autocompleteStore,queryUpdateDebounce:Nr.vp,inputPlaceholder:A.default.formatMessage(ai.inputPlaceholder),focus:!0,inputStyle:{...ci(),borderBottom:void 0},onBgClick:this.handleBlur,renderPopup:()=>{let t,i;return t=o&&0===r.length?(0,u.jsx)(gt.Z,{title:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Select a page",id:"linkToPageBlock.selectPrompt"}),loading:!n,children:(0,u.jsx)(qr.Z,{title:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"No results",id:"linkToPageBlock.noSearchResults"})})}):(0,u.jsx)(Vr.Z,{type:Vr.i.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,u.jsx)(gt.Z,{...e,title:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Select a page",id:"linkToPageBlock.selectPrompt.withContents"}),loading:!n}),items:r}]}),i=e.isPhone?{menuType:kt.og.ActionSheet,disableBottomPadding:!0,maxHeight:`calc(70vh - ${Ur.Z.estimatedNativeWebBottomOverlap()}px)`}:{menuType:kt.og.Popup,width:460,maxHeight:e.isMobile?"30vh":"40vh"},(0,u.jsx)(no.Z,{...i,children:t})}})})}};return(0,u.jsx)(Wr.Z,{...o})}}const li=si;function ci(){return{lineHeight:1.3}}var di=o(97485);function pi(e,t){window.__c={n:"LoomBlock"};const o=(0,r.useRef)(null),n=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"loom",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:n,ref:o,store:e.store,iconSvg:di.p,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with any Loom shareable link",id:"loomBlock.embed.caption"}),children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed Loom",id:"loomBlock.placeholder"})}))}const ui=r.memo(r.forwardRef(pi),s.Z);var mi=o(81822);const gi=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Map",id:"googleMapsBlock.embedButton.label"}});function hi(e,t){window.__c={n:"MapsBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"maps",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:mi.h,urlInputPlaceholder:"https://www.google.com/mapsâ€¦",embedButtonText:o.formatMessage(gi.embedButtonText),mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with places on Google Maps",id:"googleMapsBlock.embed.caption"}),children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed a Google Map",id:"googleMapsBlock.placeholder"})}))}const fi=r.memo(r.forwardRef(hi),s.Z);var yi=o(15289);const vi=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Miro",id:"miroBlock.embeds.button.label"}});function bi(e,t){window.__c={n:"MiroBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"miro",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:yi.M,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with Miro links with public access enabled",id:"miroBlock.embeds.caption"}),embedButtonText:o.formatMessage(vi.embedButtonText),urlInputPlaceholder:"https://miro.com/app/board/â€¦",children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed Miro",id:"miroBlock.placeholder"})}))}const Si=r.memo(r.forwardRef(bi),s.Z);var _i=o(78810);const wi=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Mixpanel",id:"mixpanelBlock.embeds.button.label"}});function ki(e,t){window.__c={n:"MixpanelBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"mixpanel",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:_i.n,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with Mixpanel projects",id:"mixpanelBlock.embeds.caption"}),embedButtonText:o.formatMessage(wi.embedButtonText),urlInputPlaceholder:"https://mixpanel.com/â€¦",children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed a Mixpanel project",id:"mixpanelBlock.placeholder"})}))}const xi=r.memo(r.forwardRef(ki),s.Z);var Ii=o(54321),Ci=o(4382),Ti=o(45952),Mi=o(16472),Pi=o(36067);const Ai=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed a repl",id:"replitBlock.embeds.button.label"}});function Di(e,t){window.__c={n:"ReplitBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"replit",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:Pi.J,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with Replit.",id:"replitBlock.embeds.caption"}),embedButtonText:o.formatMessage(Ai.embedButtonText),urlInputPlaceholder:"https://replit.com/â€¦",children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed a repl",id:"replitBlock.placeholder"})}))}const Bi=r.memo(r.forwardRef(Di),s.Z);var Ri=o(31317);const Ei=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Sketch",id:"sketchBlock.embeds.button.label"}});function Fi(e,t){window.__c={n:"SketchBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"sketch",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:Ri.j,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with Sketch links with Public Link Access enabled",id:"sketchBlock.embeds.caption"}),embedButtonText:o.formatMessage(Ei.embedButtonText),urlInputPlaceholder:"https://sketch.com/â€¦",children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed Sketch",id:"sketchBlock.placeholder"})}))}const Ni=r.memo(r.forwardRef(Fi),s.Z);var ji=o(99571),Oi=o(51704),Li=o(15690),Ui=o(25777),Zi=o(33709),Vi=o(52771),qi=o(92120),zi=o(98165),Wi=o(34859),Hi=o(79131),Gi=o(31278),Ki=o(76798),$i=o(53336);function Yi(e){window.__c={n:"TabBlockMenu"};const t=(0,l.useIntl)(),o=(0,Ao.O7)(),n=(0,io.Fg)(),i=(0,io.yK)((e=>({baseStyle:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},mobileStyle:ta(e),desktopStyle:ea(e),scrollerOverlayStyle:oa(e)})),[]),a=(0,r.useRef)(null);return(0,u.jsxs)(ge.p,{allowSelectionWithin:!0,style:{...o.device.isMobile?i.mobileStyle:i.desktopStyle,...i.baseStyle},children:[(0,u.jsx)($i.Z,{role:"tablist","aria-label":t.formatMessage(Xi.tabListLabel),type:Wi.Z.X,ref:a,showLeftRightOverlay:!0,rightOverlayStyle:i.scrollerOverlayStyle,children:(0,u.jsx)(Hi.ZP,{disabled:e.disabled,direction:"horizontal",keys:e.tabs.map((e=>e.id)),renderKey:(t,o)=>(0,u.jsx)(Qi,{index:o,...e}),onDrop:(t,n)=>function(e){const{environment:t,parentStore:o,onDropArgs:n,newTabs:r}=e;J.createAndCommit({userAction:"TabBlockMenu.handleTabReorder",environment:t,perform:e=>{const{key:t,endPosition:i}=n,a=o.getContentStores().find((e=>e.id===t)),s=r[i-1],l=o.getContentStores().find((e=>e.id===s));if(a){const t=o;K.HP({parent:t.getContentStore(),after:l,current:a,transaction:e})}}})}({environment:o,newTabs:t,parentStore:e.parentStore,onDropArgs:n}),disableHorizontalEdgeScroll:!1})}),!e.disabled&&(0,u.jsx)(rr.Z,{"aria-label":t.formatMessage(Xi.addTab),style:{height:28,width:28,marginTop:6,display:"flex",justifyContent:"center"},onClick:()=>{!function(e,t,o){const{performResult:n}=J.createAndCommit({userAction:"TabBlockMenu.newTab",environment:e,perform:o=>Li.gG({environment:e,store:t,transaction:o})}),r=()=>{const e=t.getContentStores(),o=e[e.length-1];Vi.$({blockStore:n,renderDelete:!0,originRect:o?Vn.C.getRectFromStore(o):void 0})};o.current?o.current.scrollToRight({animate:!0,animationCallback:()=>{r()}}):r()}(o,e.parentStore,a)},children:(0,Zn.R)({fill:n.mediumIconColor,width:16,height:16})})]})}function Qi(e){window.__c={n:"TabItem"};const t=(0,Ao.O7)(),o=(0,l.useIntl)(),{index:n,parentStore:r,selectedIndex:a,tabs:s}=e,c=s[n],d=(0,io.yK)((e=>({selectedTab:{...{paddingTop:6,paddingBottom:12,whiteSpace:"nowrap",minWidth:0,flexShrink:0,fontWeight:500},position:"relative"},tab:{paddingTop:6,paddingBottom:12,whiteSpace:"nowrap",minWidth:0,flexShrink:0,fontWeight:500},border:na(e)})),[]),p=(0,i.VK)((()=>{const e=qi.Z.getFirstSelectedDiscussionId();if(!e)return!1;const t=$n.jQ.createChildStore(c,{table:Zi.qF,id:e,spaceId:c.getSpaceId()});return(0,zi.qA)(t).map((e=>e.id)).includes(c.id)}),[c]),{device:m}=t,g=a===n,h=n===s.length-1,f=0===n,y=s.length;return(0,u.jsx)(ce.Z,{store:c,analyticsName:"tab",canSelect:!0,canDrag:!1,canDropBelow:!1,canDropLeft:!f,canDropAbove:!1,canNativeDropBelow:!1,canNativeDropLeft:!f,canNativeDropRight:!h,canDropOnto:!0,dropzoneShouldNeverUseOrigin:!0,dropzoneMustBeWithinHorizontalBound:!0,canInsertAbove:!f,canDropRight:!h,canInsertBelow:!h,shouldShowHalo:!0,shouldShowDropZone:!0,shouldShowParentHalo:!0,dropzoneGap:10,onSelectableDrop:e=>{const{droppedDirection:o,droppedStores:n,duplicate:r}=e;J.createAndCommit({userAction:"TabBlockMenu.dropOntoTab",environment:t,perform:e=>{Io.LQ({environment:t,targetParentStore:c.getContentStore(),targetStore:c,droppedDirection:o,droppedStores:n,duplicate:r,transaction:e})}})},onRemove:()=>{!function(e){const{environment:t,parentStore:o,tabStore:n,index:r}=e;J.createAndCommit({userAction:"TabBlockMenu.handleRemoveTab",environment:t,perform:e=>{const i=o.getContentStores();if(1===i.length){const t=o.getRecordStoreUIParent();"block"!==(null==t?void 0:t.table)&&"space"!==(null==t?void 0:t.table)||null==t||!t.valueIs(qn.i)||K.Od({parent:t,childToRemove:o,transaction:e})}else{const e=r<i.length-1?i[r+1]:i[r-1];Li.x2({store:o,id:e.id,currentUserId:t.currentUser.id})}K.Od({parent:o.getContentStore(),childToRemove:n,transaction:e})}})}({environment:t,parentStore:r,tabStore:c,index:n})},children:(0,u.jsxs)("div",{style:{...g?d.selectedTab:d.tab},children:[(0,u.jsxs)(rr.Z,{role:"tab","aria-selected":g,"aria-controls":g?e.contentAriaId:void 0,"aria-posinset":n+1,"aria-setsize":y,id:g?e.selectedTabAriaId:void 0,style:{fontSize:16},onClick:()=>function(e,t,o){if(e.onChange(t),o&&!e.disabled){const o=e.parentStore.getContentStores()[t];Vi.$({blockStore:o,renderDelete:!0})}}(e,n,g),disabled:e.readOnly,mobileFeedback:m.isMobile,hovered:p,isGray:!g,children:[(0,u.jsx)(Ji,{store:c}),(0,u.jsx)(Ki.Z,{store:c,placeholder:o.formatMessage(Xi.untitledTab)})]}),g&&(0,u.jsx)("div",{style:d.border})]},n)},n)}function Ji(e){window.__c={n:"TabIcon"};const{store:t}=e,{icon:o,isEmptyPage:n}=(0,i.VK)((()=>({icon:t.hasIcon()&&t.getIcon(),isEmptyPage:t.isEmptyPage()})),[t]);return o?(0,u.jsx)(Gi.Z,{disabled:!0,icon:o,isEmptyPage:n,size:20,style:{marginRight:6}}):null}const Xi=(0,l.defineMessages)({untitledTab:{id:"tabMenuBlock.title.placeholder",defaultMessage:"Untitled"},addTab:{id:"tabMenuBlock.addTab",defaultMessage:"Add tab"},tabListLabel:{defaultMessage:"Tab block",id:"tabBlockMenu.tabListLabel"}});function ea(e){return{display:"flex",fontSize:14,width:"100%",paddingLeft:8,paddingRight:8,boxShadow:`0 1px 0 ${e.regularDividerColor}`,position:"relative",zIndex:1}}function ta(e){return{display:"flex",fontSize:16,width:"100%",paddingTop:2,paddingLeft:16,paddingRight:16,boxShadow:`0 1px 0 ${e.regularDividerColor}`,position:"relative",zIndex:2,height:44,background:e.popoverBackground}}function oa(e){return{background:e.regularDividerColor,right:28,opacity:1,marginTop:6,marginBottom:12,width:1}}function na(e){return{borderBottom:`2px solid ${e.regularTextColor}`,position:"absolute",bottom:0,left:0,right:0}}class ra extends ne.Z{constructor(){super(...arguments),this.contentAriaId=(0,Ie.Z)(),this.selectedTabAriaId=(0,Ie.Z)(),this.storeTypes={shouldShowBottomBorder:y.default.createClass(!1)},this.handleTabClick=e=>{Li.a({store:this.props.store,index:e,currentUserId:this.environment.currentUser.id})},this.handlePlaceholderClick=e=>{J.createAndCommit({userAction:"TabBlock.handlePlaceholderClick",environment:this.environment,perform:t=>{Li.ls({environment:this.environment,store:e,transaction:t})}})},this.handleMouseMove=e=>{const t=e.currentTarget.getBoundingClientRect();this.stores.shouldShowBottomBorder.setState(this.getHoveredState(t,e.clientY))},this.handleMouseEnter=e=>{const t=e.currentTarget.getBoundingClientRect();this.stores.shouldShowBottomBorder.setState(this.getHoveredState(t,e.clientY))},this.handleMouseLeave=()=>{this.stores.shouldShowBottomBorder.setState(!1)},this.getSelectedTabStore=()=>{const e=Li.jL(this.props.store),t=this.props.store.getContentStores();return t.length>e?t[e]:t[0]}}handleCreated(){this.stores.shouldShowBottomBorder.setState(!1)}willMount(e){const t=this.environment.currentUser.id;Li.nz({blockId:this.props.store.id,currentUserId:t})}renderPersisted(){return(0,u.jsxs)("div",{style:this.getStyle(),children:[(0,u.jsxs)("div",{onMouseMove:this.handleMouseMove,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,u.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:this.renderTabs()}),this.renderCurrentTab()]}),(0,u.jsx)(re.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store,style:Xe._1,hideIfSidebarOrMarginCommentsVisible:!0})]})}renderCurrentTab(){const e=Hn.b(this.props.store);return(0,u.jsx)("div",{role:"tabpanel",id:this.contentAriaId,"aria-labelledby":this.selectedTabAriaId,style:{position:"relative"},children:(0,u.jsx)(Ui.Z,{loaded:e,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:{display:"flex",flexDirection:"column"},children:this.renderLoadedContent()})})}renderLoadedContent(){const e=this.getSelectedTabStore();return e?(0,u.jsx)(ce.Z,{store:e,analyticsName:"page_content",canSelect:!1,canDrag:!1,isListContainer:!0,style:{display:"flex",flexDirection:"column"},children:(0,u.jsx)(le.Z,{store:e.getContentStore(),disabled:this.props.disabled,disableContent:!1,emptyPlaceholder:this.renderPlaceHolder(e)})},e.id):null}renderPlaceHolder(e){return(0,u.jsx)(ae.Z,{style:this.getPlaceholderButtonStyle(),onClick:()=>this.handlePlaceholderClick(e),disabled:!this.canEdit(),children:(0,u.jsx)("span",{style:{color:this.theme.lightTextColor},children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Empty tab. Click or drop blocks inside.",id:"tabBlock.emptyBlock.placeholderText"})})})}renderTabs(){return(0,u.jsx)(Yi,{contentAriaId:this.contentAriaId,selectedTabAriaId:this.selectedTabAriaId,disabled:!this.canEdit(),parentStore:this.props.store,tabs:this.props.store.getContentStores(),selectedIndex:Li.jL(this.props.store),onChange:this.handleTabClick})}getHoveredState(e,t){return!this.props.disabled&&(!!F.Z.state.isDragging||(!!j.Z.state.isActive||t<=e.bottom+20&&t>=e.bottom-20))}getStyle(){return{paddingLeft:U.ZD.paddingLeft,flex:1,...this.getBottomBorderStyle(),...this.getBlockColorStyle(),...this.props.style}}getBottomBorderStyle(){return this.stores.shouldShowBottomBorder.state?{boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`}:{}}getPlaceholderButtonStyle(){return{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:this.theme.lightTextColor,...U.ZD,marginTop:2}}}const ia=ra;var aa=o(15145),sa=o(85031),la=o(84210),ca=o(18514),da=o(88923),pa=o(78454);class ua extends ne.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:Ne.Z},this.renderHeader=(e,t,o)=>{const n=this.getNavigableAncestor();if(!n)return;const r=(0,la.ZP)({store:n,scrollToBlockId:e.id,fullyQualified:!1,pageVisitSource:aa.tY.LinkInPage}),i=sa.y({headerBlockId:e.id,headerBlockIds:o.map((e=>e.id)),index:t,getRecordModel:this.props.store.getRecordModel});return(0,u.jsx)("div",{style:this.getContainerStyle(),children:(0,u.jsx)(Ue.Z,{href:r,external:!1,children:(0,u.jsx)("div",{style:ha(i),children:(0,u.jsx)(Ki.Z,{store:e,shouldWrap:!1,underline:!0})})},e.id)},e.id)},this.handleMouseMove=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0})},this.handleMouseLeave=()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},this.recurAllContentTypes=this.createComputedStore((()=>It.default.checkGate("toc_nested_headings"))),this.pageHeaderIdsStore=this.createComputedStore((()=>{const e=this.getNavigableAncestor();return e?sa.Q(e.id,this.props.store.getRecordModel,this.recurAllContentTypes.state):[]}))}renderPersisted(){const{device:e}=this.environment,t=this.getDisabled(),{store:o}=this.props,n=this.pageHeaderIdsStore.state.map((e=>$n.G.createChildStore(o,{table:ni.iU,id:e})));return(0,u.jsxs)(ge.p,{allowSelectionWithin:!0,style:ua.style,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,children:[n.map(this.renderHeader),0===n.length&&(0,u.jsx)("div",{style:{...this.getPlaceholderStyle(),...!t&&e.isMobile&&{marginRight:36}},children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Add headings to create a table of contents. <linktohelpbutton>Learn more</linktohelpbutton>.",id:"tableOfContentsBlock.placeholder",values:{linktohelpbutton:e=>(0,u.jsx)(po.Z,{href:(0,ca.UY)("guides.tableOfContents"),external:!0,onClick:()=>k.Fsx(this.environment,{from:"table_of_contents_placeholder"}),children:e})}})}),!t&&e.isMobile&&(0,u.jsx)(je.Z,{style:ua.actionMenuButtonStyle,tooltipContent:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"More actionsâ€¦",id:"tableOfContentsBlock.mobileActionMenu.button.label"}),store:this.props.store,fadeIn:!1})]})}getDisabled(){return this.props.disabled||!this.canEdit()}getNavigableAncestor(){const e=this.props.store.getRecordStoreUIRoot(),{mainEditorCurrentBlockStore:t}=jr.default.state;return e===t?t:da.default.peekTarget.state===e?da.default.peekTarget.state:void 0}getContainerStyle(){return{...this.getBlockColorStyle(),...this.props.style}}getPlaceholderStyle(){return{...ga,paddingTop:U.ZD.paddingTop,paddingBottom:U.ZD.paddingBottom,color:this.theme.lightTextColor}}}ua.style={position:"relative"},ua.actionMenuButtonStyle={position:"absolute",top:3,right:6};const ma=ua,ga={paddingRight:U.ZD.paddingRight,paddingLeft:U.ZD.paddingLeft,fontSize:14,lineHeight:1.3};function ha(e){return{...ga,display:"flex",alignItems:"center",marginLeft:pa.LK*e,paddingTop:2*U.ZD.paddingTop,paddingBottom:2*U.ZD.paddingBottom}}var fa=o(17970),ya=o(11620),va=o(4859),ba=o(91791),Sa=o(91497),_a=o(77926);const wa=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Tweet",id:"tweetBlock.embedTweet.button.label"}});function ka(e,t){window.__c={n:"TweetBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"tweet",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:_a.l,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with links to Tweets",id:"tweetBlock.linkInput.caption"}),embedButtonText:o.formatMessage(wa.embedButtonText),urlInputPlaceholder:"https://twitter.com/â€¦",children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed a Tweet",id:"tweetBlock.placeholder"})}))}const xa=r.memo(r.forwardRef(ka),s.Z);var Ia=o(51929);function Ca(e,t){window.__c={n:"TypeformBlock"};const o=(0,r.useRef)(null),n=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"typeform",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:n,ref:o,store:e.store,iconSvg:Ia.G,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with any public Typeform link",id:"typeformBlock.embed.caption"}),children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed Typeform",id:"typeformBlock.placeholder"})}))}const Ta=r.memo(r.forwardRef(Ca),s.Z);var Ma=o(95097);const Pa=(0,l.defineMessages)({urlPlaceholder:{defaultMessage:"Paste the video linkâ€¦",id:"videoBlock.linkInput.placeholder"},embedButtonText:{defaultMessage:"Embed video",id:"videoBlock.embedVideo.button.label"}});function Aa(e,t){window.__c={n:"VideoBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"video",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,blockResizerStore:a,ref:n,store:e.store,iconSvg:Ma.H,preserveScale:!0,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"},{type:"file",videoUpload:!0}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with YouTube, Vimeo, and more",id:"videoBlock.linkInput.caption"}),embedButtonText:o.formatMessage(Pa.embedButtonText),urlInputPlaceholder:o.formatMessage(Pa.urlPlaceholder),children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed or upload a video",id:"videoBlock.placeholder"})}))}const Da=r.memo(r.forwardRef(Aa),s.Z);var Ba=o(98616);const Ra=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed Whimsical",id:"whimsicalBlock.embeds.button.label"}});function Ea(e,t){window.__c={n:"WhimsicalBlock"};const o=(0,l.useIntl)(),n=(0,r.useRef)(null),a=(0,i.qz)(void 0,d.Z);return(0,c.ez)(e.store,t,(0,r.useMemo)((()=>({renderedType:"whimsical",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,u.jsx)(p.Z,{...e,ref:n,store:e.store,iconSvg:Ba.A,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Works with Whimsical links with Public Link Access enabled",id:"whimsicalBlock.embeds.caption"}),embedButtonText:o.formatMessage(Ra.embedButtonText),urlInputPlaceholder:"https://whimsical.com/â€¦",blockResizerStore:a,children:(0,u.jsx)(l.FormattedMessage,{defaultMessage:"Embed Whimsical",id:"whimsicalBlock.placeholder"})}))}const Fa=r.memo(r.forwardRef(Ea),s.Z);let Na;function ja(e){const t=e.getType();if(t)return"collection_view"===t&&e.recordStoreParentDiffersFromPersistedParent()?xo.Z:(Na||(Na={text:fa.Z,image:Pr,video:Da,bookmark:$e,drive:Tn,audio:ke,tweet:xa,gist:Sr,maps:fi,framer:fr,invision:Rr,file:ur.Z,page:Ci.Z,to_do:ya.Z,toggle:va.ZP,bulleted_list:Xe.ZP,numbered_list:Ii.Z,code:yo,factory:lr,button:et.Z,divider:mn,column_list:Qo,copy_indicator:nn,embed:p.Z,breadcrumb:Je,equation:En,header:_r.Z,sub_header:ji.Z,sub_sub_header:Oi.Z,quote:Mi.ZP,collection_view:ko.D,collection_view_page:xo.Z,link_to_page:li,link_to_collection:ei,figma:pr,loom:ui,codepen:wo,typeform:Ta,column:en,pdf:Ti.Z,callout:tt.Z,table_of_contents:ma,whimsical:Fa,miro:Si,abstract:h,sketch:Ni,excalidraw:On,alias:be.Z,transclusion_container:ba.Z,transclusion_reference:Sa.Z,replit:Bi,external_object_instance:Ln.Z,table:n.Wv,table_row:n.fZ,tab:ia,hex:Ir,deepnote:ln,mixpanel:xi,external_object_instance_page:Ln.Z,ai_block:ve,drawing:fn,personal_home_page:void 0}),Na[t])}},59557:(e,t,o)=>{o.d(t,{N:()=>d});var n=o(67294),r=o(480),i=o(86628),a=o(97880),s=o(39699),l=o(37181),c=o(80444);function d(e){const{blockStore:t}=e,o=(0,r.O7)(),d=(0,i.VK)((()=>c.default.state.currentUserSettingsStore),[]),p=(0,i.VK)((()=>{var e;return(0,a.$K)(null===(e=t.getModel())||void 0===e?void 0:e.getProperty("title"))}),[t]),u=(0,n.useCallback)((()=>{d&&s.createAndCommit({userAction:"FactoryButtonDeprecation.updateUserSettings",environment:o,perform:e=>{l.d2({userSettingsStore:d,transaction:e,data:{dismissed_factory_button_deprecation_banner:!0}})}})}),[d,o]),m=(0,n.useCallback)((()=>{if(!d)return;d.getSettingsStore().getKeyStore("seen_factory_button_deprecation_badge").getValue()||s.createAndCommit({userAction:"FactoryButtonDeprecation.updateUserSettings",environment:o,perform:e=>{l.d2({userSettingsStore:d,transaction:e,data:{seen_factory_button_deprecation_badge:!0}})}})}),[d,o]);return{showFactoryButtonDeprecationBadge:(0,i.VK)((()=>p&&!Boolean(null==d?void 0:d.getSettingsStore().getKeyStore("seen_factory_button_deprecation_badge").getValue())),[d,p]),showFactoryButtonDeprecationBanner:(0,i.VK)((()=>p&&!Boolean(null==d?void 0:d.getSettingsStore().getKeyStore("dismissed_factory_button_deprecation_banner").getValue())),[d,p]),handleDismissFactoryButtonMigrationBanner:u,setHasSeenFactoryButtonDeprecationBadge:m}}},29551:(e,t,o)=>{o.d(t,{Ht:()=>s,gq:()=>a});var n=o(67294),r=o(85893);function i(e){const{style:t,row:o,column:n,reverse:r,inline:i,...a}=e,s={display:i?"inline-flex":"flex"};return n?s.flexDirection=r?"column-reverse":"column":o?s.flexDirection=r?"row-reverse":"row":r&&(s.flexDirection="row-reverse"),Object.assign(s,a,t)}class a extends n.Component{static styles(){return i({...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},row:!0})}render(){const{children:e,className:t,...o}=this.props;return(0,r.jsx)("div",{className:t,style:a.styles(o),children:e})}}class s extends n.Component{static styles(){return i({...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},column:!0})}render(){const{children:e,className:t,...o}=this.props;return(0,r.jsx)("div",{className:t,style:s.styles(o),children:e})}}},17377:(e,t,o)=>{o.d(t,{Z:()=>_});o(67294);var n=o(83355),r=o(53150),i=o(49271),a=o(5366),s=o(29373),l=o(39699),c=o(52315),d=o(35328),p=o(77080),u=o(45131),m=o(64921),g=o(25777),h=o(55217),f=o(78454),y=o(4859),v=o(5210),b=o(85893);class S extends n.Z{constructor(){super(...arguments),this.descriptionAriaId=(0,r.Z)(),this.contentAriaId=(0,r.Z)(),this.isToggleable=this.createComputedStore((()=>{const{store:e}=this.props.blockComponent.props;return d.fn(e)})),this.blockHasContent=this.createComputedStore((()=>{var e;const{store:t}=this.props.blockComponent.props;return null===(e=t.getFormat())||void 0===e?void 0:e.toggleable})),this.toggle=()=>{d.th(this.props.blockComponent)},this.isOpen=this.createComputedStore((()=>{const{store:e,hideContent:t}=this.props.blockComponent.props;return u.Z.isOpen(e.id)&&!t})),this.isEmpty=this.createComputedStore((()=>{const{store:e}=this.props.blockComponent.props;return!e.hasContent()})),this.handlePlaceholderClick=()=>{const{store:e}=this.props.blockComponent.props;l.createAndCommit({userAction:"FormatToggleable.handlePlaceholderClick",environment:this.environment,perform:t=>{s.ls({environment:this.environment,store:e,transaction:t})}})}}willMount(){const{store:e}=this.props.blockComponent.props;s.nz({blockId:e.id,currentUserId:this.environment.currentUser.id}),e.isDefaultRecordCache()&&s.LO(this.environment,e.pointer)}renderToggleButton(){return(0,b.jsx)(v.Z,{"aria-describedby":this.descriptionAriaId,"aria-controls":this.contentAriaId,isSidebar:!1,open:this.isOpen.state,fill:!this.isEmpty.state,onClick:this.toggle,tapArea:this.environment.device.isMobile?{size:30}:void 0})}renderPlaceHolder(){const{disabled:e}=this.props.blockComponent.props;return(0,b.jsx)(m.Z,{style:{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:this.theme.lightTextColor,...i.ZD,marginTop:2},onClick:this.handlePlaceholderClick,disabled:e,children:(0,b.jsx)("span",{style:{color:this.theme.lightTextColor},children:(0,b.jsx)(a.FormattedMessage,{defaultMessage:"Empty toggle. Click or drop blocks inside.",id:"toggleBlockFormat.emptyBlock.placeholderText"})})})}renderContent(){const{disabled:e,store:t,disableCommentMenu:o,disableHoverMenu:n,disableDrag:r}=this.props.blockComponent.props,i=c.b(t)||!t.isDefaultRecordCache(),a=p.default.checkGate("layout_toggles");return this.isOpen.state?(0,b.jsx)(g.Z,{id:this.contentAriaId,loaded:i,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:(0,y.kA)(a),style:(0,y.J9)(a),children:(0,b.jsx)(h.Z,{store:t.getContentStore(),emptyPlaceholder:this.isToggleable.state?this.renderPlaceHolder():void 0,disabled:e,disableCommentMenu:o,disableHoverMenu:n,disableDrag:r})}):(0,b.jsx)(h.Z,{store:t.getContentStore(),disabled:e,disableContent:!0})}renderComponent(){const{children:e,childrenStyleWhenToggleable:t}=this.props;return this.isToggleable.state?(0,b.jsxs)(f.ZP,{style:{paddingLeft:i.ZD.paddingLeft},left:this.renderToggleButton(),leftStyle:{paddingRight:2,...this.props.toggleStyle},children:[(0,b.jsx)("div",{id:this.descriptionAriaId,style:t,children:e}),this.renderContent()]}):this.blockHasContent.state?(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,b.jsx)("div",{style:t,children:e}),this.renderContent()]}):e}}S.displayName="FormatToggleable";const _=S},26198:(e,t,o)=>{o.d(t,{Lr:()=>a,jo:()=>l,uf:()=>i});var n=o(67294),r=o(67381);const i={track(e,t){t(!0)},untrack(e){}},a=(0,r.Q)({modernContextDefaultValue:i,displayName:"IFrameManagerContext",legacyContextKey:"iFrameManagerContext"}),s=(a.legacyPropTypes,a.context);function l(){const e=(0,n.useContext)(s),[t,o]=(0,n.useState)(!1),r=(0,n.useRef)(null);return[(0,n.useCallback)((t=>{r.current&&(e.untrack(r.current),r.current=null),t&&(r.current=t,e.track(t,o))}),[e]),t]}},66213:(e,t,o)=>{o.d(t,{LF:()=>r,ZO:()=>a,wK:()=>i});const n=(0,o(67381).Q)({modernContextDefaultValue:void 0,displayName:"OverrideLinkClickContext",legacyContextKey:"overrideLinkClick"}),r=n.Provider,i=n.legacyPropTypes,a=n.context},11368:(e,t,o)=>{o.d(t,{I3:()=>i,Ue:()=>a,zR:()=>r});const n=(0,o(67381).Q)({displayName:"ScrollerContext",legacyContextKey:"scrollerContext",modernContextDefaultValue:void 0}),r=n.Provider,i=n.legacyPropTypes,a=n.context},84064:(e,t,o)=>{o.d(t,{Tf:()=>s,aT:()=>a,ld:()=>l});const n={selectableContainer:void 0,closestSelectable:void 0},r="selectable",i=(0,o(67381).Q)({modernContextDefaultValue:n,displayName:r,legacyContextKey:r}),a=i.context,s=i.legacyPropTypes,l=i.Provider},78791:(e,t,o)=>{o.d(t,{Cf:()=>h,Wc:()=>f,tE:()=>g});var n=o(41432),r=o(15095),i=o(59730),a=o(70203),s=o(97880),l=o(82798),c=o(97444),d=o(39699),p=o(46888),u=o(73959),m=o(65273);function g(e){const{transaction:t,targetStore:o,block:n}=e,r=(0,l.TO)(n.getTextSliceTree()),a=(0,u.sQ)(o);if(!a||!m.Ls({store:o,blockStore:a}))throw new i.p8("Previous block should exist and use CRDT");const c=(0,l.TO)(a.getTextSliceTree()).getLastTextSliceTreeInPreOrderTraversal(),p=r.getOperationsForSplitAtIndex(0);if("splitNodeEnd"===p.type){const{newTextSliceTree:e,textSliceTreesToMove:o,previousTextSliceTree:r}=p,i=e.getTextSlice().textInstanceId,s=e.getTextSlice().getStartItem().id,l=r.getTextSlice();d.applyCrdtTextOperation({transaction:t,store:n,operation:{command:"moveTextSlice",pointer:n.pointer,path:[],args:{textInstanceId:i,textSliceStartItemId:s,targetBlockId:a.id,targetTextInstanceId:c.getTextSlice().textInstanceId,targetTextSliceEndItemId:c.getTextSlice().getEndItem().id}},invertedOperation:{command:"invertedMoveTextSlice",pointer:n.pointer,path:[],args:{textInstanceId:i,textSliceStartItemId:s,targetTextInstanceId:l.textInstanceId,targetTextSliceEndItemId:l.getEndItem().id}}});for(const c of o)d.applyCrdtTextOperation({transaction:t,store:n,operation:{command:"moveTextSlice",pointer:n.pointer,path:[],args:{textInstanceId:c.getTextSlice().textInstanceId,textSliceStartItemId:c.getTextSlice().getStartItem().id,targetBlockId:a.id,targetTextInstanceId:e.getTextSlice().textInstanceId,targetTextSliceEndItemId:e.getTextSlice().getEndItem().id}},invertedOperation:void 0})}else if("splitWithinNode"===p.type){(0,l.T)(0===p.textSliceTreesToMove.length,"Root nodes should have no siblings to move"),d.applyCrdtTextOperation({transaction:t,store:n,operation:{command:"splitText",pointer:n.pointer,path:[],args:p.splitOp},invertedOperation:void 0});const e=p.splitOp.textInstanceId,o=p.splitOp.id;d.applyCrdtTextOperation({transaction:t,store:n,operation:{command:"moveTextSlice",pointer:n.pointer,path:[],args:{textInstanceId:e,textSliceStartItemId:o,targetBlockId:a.id,targetTextInstanceId:c.getTextSlice().textInstanceId,targetTextSliceEndItemId:c.getTextSlice().getEndItem().id}},invertedOperation:{command:"invertedMoveTextSlice",pointer:n.pointer,path:[],args:{textInstanceId:e,textSliceStartItemId:o,targetTextInstanceId:e,targetTextSliceEndItemId:p.splitOp.id}}})}else(0,s.t1)(p)}function h(e){const{environment:t,transaction:o,multiSelection:r,removedBlocks:i,movedBlocks:a}=e,s=r.start.store;function d(e){if(a.has(e))return;const i=e.getModel();if(null==i||!i.isType(n.wL))return;const d=e.getBlockTitleStore();(0,l.T)(m.FX(d)),d!==r.end.store&&(c.pe({environment:t,transaction:o,selection:{startIndex:0,endIndex:1/0},store:d}),g({transaction:o,block:e,targetStore:s}))}(0,l.T)(m.FX(s));for(const n of i){d(n);for(const e of(0,p.c)([n]))d(e)}}function f(e){const{sourceBlockStore:t,targetBlockStore:o,splitAtGraphemeIndex:n,transaction:i,moveIntoNewBlock:s}=e;(0,l.T)(t.useCrdt()&&o.useCrdt());const c=t.getBlockTitleStore().getValue(),p=new r.W3(a.eeV(c)).getStringStartIndex(n),u=(0,l.TO)(t.getTextSliceTree()).getOperationsForSplitAtIndex(p);!function(e){const{blockStore:t,splitInfo:o,transaction:n}=e,r=o.textSliceTreesToMove,i="splitWithinNode"===o.type?o.textSliceTreeToSplit:o.newTextSliceTree;for(const a of r){const e=t.id,o=i.getTextSlice().textInstanceId,r=i.getTextSlice().getEndItem().id;d.applyCrdtTextOperation({transaction:n,store:t,operation:{command:"moveTextSlice",pointer:t.pointer,path:[],args:{textInstanceId:a.getTextSlice().textInstanceId,textSliceStartItemId:a.getTextSlice().getStartItem().id,targetBlockId:e,targetTextInstanceId:o,targetTextSliceEndItemId:r}},invertedOperation:void 0})}}({blockStore:t,splitInfo:u,transaction:i}),s?function(e){const{sourceBlockStore:t,targetBlockStore:o,splitInfo:n,transaction:r}=e;if("splitNodeEnd"===n.type){const e=n.newTextSliceTree,i=e.getTextSlice().textInstanceId,a=e.getTextSlice().getStartItem().id,s=n.previousTextSliceTree.getTextSlice();d.applyCrdtTextOperation({transaction:r,store:t,operation:{command:"moveTextSliceIntoBlock",path:[],pointer:t.pointer,args:{textInstanceId:i,textSliceStartItemId:a,targetBlockId:o.id}},invertedOperation:{command:"invertedMoveTextSlice",path:[],pointer:t.pointer,args:{textInstanceId:i,textSliceStartItemId:a,targetTextInstanceId:s.textInstanceId,targetTextSliceEndItemId:s.getEndItem().id}}})}else{const e=n.splitOp,{textInstanceId:i}=e;d.applyCrdtTextOperation({transaction:r,store:t,operation:{command:"splitTextIntoBlock",pointer:t.pointer,path:[],args:{...e,targetBlockId:o.id}},invertedOperation:{command:"invertedMoveTextSlice",pointer:t.pointer,path:[],args:{textInstanceId:i,textSliceStartItemId:e.id,targetTextInstanceId:i,targetTextSliceEndItemId:e.id}}})}}({sourceBlockStore:t,targetBlockStore:o,splitInfo:u,transaction:i}):function(e){const{sourceBlockStore:t,targetBlockStore:o,splitInfo:n,transaction:r}=e;let i,a,s,c;if("splitNodeEnd"===n.type){const e=n.newTextSliceTree;i=e.getTextSlice().textInstanceId,a=e.getTextSlice().getStartItem().id;const t=n.previousTextSliceTree.getTextSlice();s=t.textInstanceId,c=t.getEndItem().id}else d.applyCrdtTextOperation({transaction:r,store:t,operation:{command:"splitText",pointer:t.pointer,path:[],args:n.splitOp},invertedOperation:void 0}),i=n.splitOp.textInstanceId,a=n.splitOp.id,s=n.splitOp.textInstanceId,c=n.splitOp.id;const p=(0,l.TO)(o.getTextSliceTree()).getLastTextSliceTreeInPreOrderTraversal();d.applyCrdtTextOperation({transaction:r,store:t,operation:{command:"moveTextSlice",path:[],pointer:t.pointer,args:{textInstanceId:i,textSliceStartItemId:a,targetBlockId:o.id,targetTextInstanceId:p.getTextSlice().textInstanceId,targetTextSliceEndItemId:p.getTextSlice().getEndItem().id}},invertedOperation:{command:"invertedMoveTextSlice",path:[],pointer:t.pointer,args:{textInstanceId:i,textSliceStartItemId:a,targetTextInstanceId:s,targetTextSliceEndItemId:c}}})}({sourceBlockStore:t,targetBlockStore:o,splitInfo:u,transaction:i})}},65273:(e,t,o)=>{o.d(t,{PR:()=>m,FX:()=>c,Ls:()=>d,iG:()=>p,be:()=>u});var n=o(19056),r=o(59730),i=o(21202),a=o(73959),s=o(82798);class l{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;this.value=e,this.textInstanceId=t;const o=l.overrides.get(t);o&&e>o&&this.updateOverride()}get(){return l.overrides.get(this.textInstanceId)??this.value}set(e){const t=this.get();(0,s.T)(e>=t),this.value=e,this.updateOverride()}updateOverride(){l.overrides.set(this.textInstanceId,this.value)}static TEST_ONLY__clearOverrides(){this.overrides.clear()}}function c(e){if(!e.isTable(i.iU))return!1;const t=(0,a.sQ)(e);return!!t&&(t.useCrdt()&&t.getBlockTitleStore()===e)}function d(e){const{store:t,blockStore:o}=e;return o.useCrdt()&&o.getBlockTitleStore()===t}function p(e,t){const o=e.useCrdt(),n=t.some((e=>e.useCrdt()));return o&&!n||!o&&n}function u(e){const{parentStore:t,childStore:o}=e,n=(0,a.sQ)(t,!0),i=(0,a.sQ)(o,!0);if(n&&i&&p(n,[i]))throw new r.p8("A CRDT block cannot be parented to a non-CRDT block or vice versa!")}function m(e){const t={};for(const[o,r]of Object.entries(e))t[o]=new n.Z(new l(r,o));return t}l.overrides=new Map},11059:(e,t,o)=>{o.d(t,{Z:()=>c});o(67294);var n=o(480),r=o(86628),i=o(22377),a=o(60682),s=o(24990),l=o(85893);const c=function(e){let{char:t,size:o,sprite:c}=e;window.__c={n:"Emoji"};const d=(0,n.O7)(),p=(0,r.VK)((()=>c||(0,a.e_)(d)),[d,c]),u=(0,r.VK)((()=>s.Z.state),[]);return(0,l.jsx)(i.Z,{char:t,size:o,type:p,emojiData:u})}},72187:(e,t,o)=>{o.d(t,{$P:()=>v,FZ:()=>g,II:()=>a,IQ:()=>n,Nm:()=>i,PS:()=>m,T8:()=>l,VJ:()=>y,WB:()=>c,fG:()=>f,jo:()=>p,kX:()=>u,mz:()=>d,pq:()=>s,qJ:()=>b,tg:()=>r,vP:()=>h});const n=12,r=9,i=2,a=12,s=16,l=32,c=24,d=44,p=32,u=356,m=12,g=l*n+2*m,h=9,f=g,y=270,v=10,b=2},60682:(e,t,o)=>{o.d(t,{e_:()=>a,kw:()=>s,sg:()=>l});var n=o(480),r=o(86628),i=o(80444);function a(e){const{device:t}=e;return t.isAndroid&&t.browserVersion.startsWith("73.")&&t.browserName.startsWith("Chrome")||t.isAndroid?"google":t.isWindows||t.isLinux?"twitter":"raw"}function s(){const e=(0,n.O7)();return(0,r.VK)((()=>a(e)),[e])}function l(){var e;return null===(e=i.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.emoji_picker_skin_tone}},24990:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(2991);class i extends n.default{getInitialState(){return{positionalEmojiData:{},emojiByName:{},emojiByCategory:{}}}async waitUntilLoaded(){await(0,r.MH)()}}const a=new i},69783:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},21830:(e,t,o)=>{o.d(t,{XH:()=>b,pz:()=>f,qv:()=>h,vZ:()=>u,zp:()=>g});o(21703);var n=o(37599),r=o(92595),i=o(7406),a=o(68626),s=o(91155),l=o(29477),c=o(63143),d=o(5366),p=o(33929);const u="NotionTransactionTimeout",m=(0,d.defineMessages)({ReloadAllTabs:{defaultMessage:"Try closing and re-opening all Notion tabs or windows. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.reloadAllTabs"},ReloadThisTab:{defaultMessage:"Try reloading Notion. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.reloadThisTab"},AppProfileCorrupted:{defaultMessage:"Notion's local storage may be damaged. See (?) > Help & documentation > Reset Notion. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.helpAndSupportPrompt"},FirefoxProfileCorrupted:{defaultMessage:"Your Firefox profile may be damaged. Visit https://firefox-storage-test.glitch.me/ to diagnose. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.firefoxSettingsDamaged"},ChromeProfileCorrupted:{defaultMessage:"Your Chrome profile may be damaged. If you changed any chrome://flags then please reset them, then restart your browser. If issues persist, try making a new Chrome user. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.errorFixes.chromeSettingsDamaged"},ChromeIndexedDBBucketError:{defaultMessage:"Your Chrome profile may be damaged. For a more consistent experience download the Notion desktop app: https://notion.so/desktop",id:"localDatabase.errorFixes.chromeUpgradeCorruptedSettings"},noDiskSpace:{defaultMessage:"No disk space remaining. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.erroMessages.noDiskSpaceRemaining"},noDiskSpaceBrowserLimit:{defaultMessage:"No disk space remaining. Your browser settings may restrict the storage Notion can use. Contact support if that doesnâ€™t fix the issue.",id:"localDatabase.erroMessages.noDiskSpaceRemainingBrowserLimit"}});function g(e){return e}function h(e){return Promise.all(e)}class f{constructor(e,t,o,n){this.databaseName=void 0,this.databaseVersion=void 0,this.debugLogger=new a.BatchedLogger({from:"IndexedDBWrapper",type:"BulkDebug",level:"info",maxLength:100,logToConsole:false}),this.latestTransactionId=0,this.openDbCallbacks=void 0,this.db=void 0,this.getDBPromise=void 0,this.environment=e,this.databaseName=t,this.databaseVersion=o,this.openDbCallbacks=n}async reset(){try{return await(0,n.Lj)(this.databaseName),{value:void 0}}catch(e){return{error:y({environment:this.environment,error:(0,i.tg)(e),details:`Failed to reset database ${this.databaseName}`,closed:!1,aborted:!1})}}finally{this.teardown()}}async startTransaction(e,t){const o="startTransaction";let n,r=0;const i=`${e.name}.${this.latestTransactionId++}`;do{try{const s=`${i} attempt #${r+1}`;if(this.debugLogInfo(o,`${s} starting`),n=await this.startTransactionAttempt({...e,name:i},t),!n.error){this.debugLogInfo(o,`${s} succeeded`);break}const c=`${s} errored, type=${n.error.type}`;if(!n.error.closed){this.debugLogInfo(o,`${c}, closed=false`);break}if(this.debugLogInfo(o,`${c}, closed=true`),this.db)try{this.db.close()}catch(a){this.debugLogInfo(o,`db.close() threw ${a}`)}if(this.teardown(),4===r)break;await l.Vs(250)}catch(a){return{error:a}}r++}while(r<5);return n}async startTransactionAttempt(e,t){const{storeNames:o,name:n,mode:r,timeoutMs:l}=e,c=`${n} failed`,d="startTransactionAttempt",p=await this.getDB();if(p.error)return p;const u=p.value,m=[];let g;try{g=u.transaction(o,r);const e=Date.now(),t=window.setTimeout((()=>{const t=Date.now()-e,o=`${n} has not completed after ${t} ms, which may prevent other transactions from running.`;this.debugLogInfo(d,o),a.log({from:"IndexedDBWrapper",type:"LongRunningTransactionWarning",level:"warning",data:{message:o,miscDataToConvertToString:{transactionLog:m}}})}),f.longRunningTimeoutMs);g.addEventListener("complete",(function(){window.clearTimeout(t)}));const i=e=>{e.stopPropagation(),window.clearTimeout(t)};g.addEventListener("error",i),g.addEventListener("abort",i)}catch(v){const e=(0,i.tg)(v);return{error:y({environment:this.environment,details:`Failed to create ${r} transaction on ${this.databaseName}.${o}`,error:e,aborted:!0,closed:"InvalidStateError"===e.name})}}const h=await this.runTransaction(g,t,n,l,(e=>{a.pushWithMaxLength(m,e,100)}));if("error"in h||h.abort){this.debugLogInfo(d,`${n} command returned failed/aborted status`);try{g.abort()}catch(b){this.debugLogInfo(d,`transaction.abort() threw ${b}`)}return g.done.catch((e=>{e&&a.log({from:"IndexedDBWrapper",type:"TransactionFailure",level:"error",error:(0,s.Ui)(y({environment:this.environment,details:c,error:e,aborted:!0,closed:!1}))})})),h}if(this.debugLogInfo(d,`${n} command returned successful status`),"readwrite"===r)try{await g.done}catch(b){return{error:y({environment:this.environment,error:(0,i.tg)(b),details:`In await transaction.done: ${c}`,aborted:null===b,closed:!1})}}else g.done.catch((e=>{a.log({from:"IndexedDBWrapper",type:"ReadOnlyTransactonFailureIgnored",level:"error",error:(0,s.Ui)(y({environment:this.environment,error:e,details:c,aborted:null===e,closed:!1}))})}));return{value:h.value}}freezeListener(){Boolean(this.db)&&(this.debugLogInfo("freezeListener"),a.log({level:"warning",from:"IndexedDBWrapper",type:"document.freeze",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}}))}teardown(){this.debugLogInfo("teardown"),this.db=void 0,this.getDBPromise=void 0,document.removeEventListener("freeze",this.freezeListener)}debugLogInfo(e,t){this.debugLogger.log({from:"IndexedDBWrapper",level:"info",type:e,data:{message:t}})}async initDB(){try{this.debugLogInfo("initDB","Starting openDB()");const e=await(0,n.X3)(this.databaseName,this.databaseVersion,this.openDbCallbacks);return this.debugLogInfo("initDB","Completed openDB()"),document.addEventListener("freeze",this.freezeListener),e.addEventListener("close",(e=>{a.log({level:"warning",from:"IndexedDBWrapper",type:"db.onclose",data:{dbName:this.databaseName,dbVersion:this.databaseVersion},error:(0,s.Ui)(v(e))}),this.teardown()})),e.addEventListener("abort",(e=>{a.log({level:"warning",from:"IndexedDBWrapper",type:"db.onabort",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}})})),e.addEventListener("error",(e=>{a.log({level:"error",from:"IndexedDBWrapper",type:"db.onerror",data:{dbName:this.databaseName,dbVersion:this.databaseVersion},error:(0,s.Ui)(v(e))})})),e.addEventListener("versionchange",(()=>{a.log({level:"warning",from:"IndexedDBWrapper",type:"db.onversionchange",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}}),e.close(),this.teardown()})),{value:e}}catch(e){return{error:y({environment:this.environment,details:"Unable to initialize database",error:(0,i.tg)(e),aborted:!1,closed:!1})}}}async getDB(){let e=this.db;if(!e){this.getDBPromise||(this.getDBPromise=this.initDB().then((e=>(e.error?this.teardown():(this.db=e.value,this.getDBPromise=void 0),e)),(e=>(this.teardown(),{error:{type:"InitDBException",message:"An unexpected error occurred trying to create the database.",details:"Exception in initDB",error:e,closed:!1,aborted:!1}}))));const t=await this.getDBPromise;if(t&&t.error)return t;e=t.value}return{value:e}}async runTransaction(e,t,o,n,r){try{const i=Date.now(),a=t(e,(e=>{this.debugLogInfo("runTransaction",`${o} command: ${e}`),r(e)}));if(void 0!==n&&n>=0){const e=await l.aM(a,n);if(e.timeout){const e=Date.now()-i,t=new Error(`Timeout after ${e}ms: exceeded limit ${n}ms by ${e-n}ms`);throw t.name=u,this.debugLogInfo("runTransaction",`${o} ${t.name}: ${t.message}`),this.debugLogger.flush(),t}return e.result}r("Awaiting commandResultPromise.");const s=await a;return r("Done awaiting commandResultPromise."),s}catch(a){return{error:y({environment:this.environment,error:(0,i.tg)(a),details:`In runTransaction catch: ${o} failed`,closed:!1,aborted:!1})}}}}function y(e){const{environment:t,error:o,details:n,closed:r,aborted:i}=e;if(o){if(o.name===u)return{type:u,details:n,message:`Storage operation did not complete. ${p.default.formatMessage(m.ReloadAllTabs)}`,error:o,closed:!1,aborted:!1};if("TimeoutError"===o.name&&"Transaction timed out due to inactivity."===o.message)return{type:"TransactionTimeout",details:n,message:`IndexedDB access attempt timed out. ${p.default.formatMessage(m.ReloadThisTab)}`,error:o,closed:r,aborted:i};if("VersionError"===o.name)return{type:"OutdatedSchemaVersion",details:n,message:`This tab is running an outdated version of Notion. ${p.default.formatMessage(m.ReloadThisTab)}`,error:o,closed:r,aborted:i};if("UnknownError"===o.name&&"Internal error opening backing store for indexedDB.open."===o.message)return{type:"ChromeUnknownInternalError",details:n,message:`Cannot open IndexedDB. ${t.device.isNative?p.default.formatMessage(m.AppProfileCorrupted):p.default.formatMessage(m.ChromeProfileCorrupted)}`,error:o,closed:r,aborted:i};if(t.device.isBrowser&&"UnknownError"===o.name&&"Internal error retrieving bucket data directory."===o.message)return{type:"ChromeUnknownInternalError",details:n,message:p.default.formatMessage(m.ChromeIndexedDBBucketError),error:o,closed:r,aborted:i};if("SecurityError"===o.name&&"IDBFactory.open() called in an invalid security context"===o.message)return{type:"SafariIframeSecurityError",details:n,message:"Cannot access IndexedDB in an iframe in your browser. Try opening Notion in a new window or use a different browser.",error:o,closed:r,aborted:i};if("UnknownError"===o.name&&"Connection to Indexed Database server lost. Refresh the page to try again"===o.message)return{type:"SafariIndexedDatabaseServerLost",details:n,message:`Cannot access IndexedDB due to a bug in Safari/WebKit. ${p.default.formatMessage(m.ReloadThisTab)}`,error:o,closed:r,aborted:i};if("InvalidStateError"===o.name&&"A mutation operation was attempted on a database that did not allow mutations."===o.message)return{type:"FirefoxPrivateBrowsing",details:n,message:"Firefox does not allow IndexedDB in Private Browsing. Try opening Notion in a normal window.",error:o,closed:r,aborted:i};if("NotFoundError"===o.name&&"The operation failed because the requested database object could not be found. For example, an object store did not exist but was being opened."===o.message)return{type:"FirefoxObjectStoreNotFound",details:n,message:`An IndexedDB object store does not exist. ${p.default.formatMessage(m.ReloadAllTabs)} ${p.default.formatMessage(m.FirefoxProfileCorrupted)}`,error:o,closed:!0,aborted:i};if("QuotaExceededError"===o.name){let e=p.default.formatMessage(m.noDiskSpace);return t.device.isBrowser&&(e=p.default.formatMessage(m.noDiskSpaceBrowserLimit)),{type:"QuotaFull",details:n,message:e,error:o,closed:r,aborted:i}}if(window.navigator.userAgent.includes("WindowsWechat")&&"AbortError"===o.name&&"Version change transaction was aborted in upgradeneeded event handler."===o.message)return{type:"UnsupportedWechat",details:n,message:"This device or application is unsupported.",error:o,closed:r,aborted:i}}return{type:"UnknownIndexedDBError",details:n,message:`An unknown IndexedDB error occurred. ${p.default.formatMessage(m.ReloadThisTab)}`,error:o||new Error("createIndexedDBError: error was falsy"),closed:r,aborted:i}}function v(e){if(e&&e.target&&"error"in e.target){const t=e.target.error;if(!t)return;return`${t.name}: ${t.message}`}}function b(e,t){if(e.stack)return e;try{const o=new Error(`${e.message} (${t})`);throw o.name=e.name,o}catch(o){return e.stack=(0,i.tg)(o).stack,e}}f.longRunningTimeoutMs=5*c.hM,(0,r.exposeDebugValue)("idbUnwrap",n.Wg)},2414:(e,t,o)=>{o.d(t,{h:()=>r});var n=o(29477);class r{constructor(e){this.SCALE=1.5,this.MAX=15,this.waitable=new n.a6,this.failures=0,this.observer=e}getDelay(e){return Math.min(this.MAX,Math.pow(this.SCALE,e))}reset(){var e;this.waitable.trigger(),this.waitable=new n.a6,this.failures=0,null===(e=this.observer)||void 0===e||e.onReset()}async backOffOnFailure(e,t){var o;const r=this.failures;this.failures++;const i=e*this.getDelay(r)-e;null===(o=this.observer)||void 0===o||o.onBackoff(i,t),await this.waitable.wait(e,i),this.waitable=new n.a6}getFailures(){return this.failures}}},63037:(e,t,o)=>{o.d(t,{CE:()=>s,Os:()=>r,Ud:()=>i,V_:()=>a,xd:()=>l});var n=o(63143);function r(e,t){t.startsWith("offline -")?t="offline":t.startsWith("mobileNativeError -")&&(t="mobileNativeError");const o=e[t]||0;e[t]=o+1,e._total+=1}const i=1*n.C0,a=.5*n.C0,s=10*n.C0,l=5*n.C0},68204:(e,t,o)=>{o.d(t,{E$:()=>a,L1:()=>l,RP:()=>s,sG:()=>i,vG:()=>c});o(57658);var n=o(58573),r=o(72126);function i(e){const{sections:t,context:o,query:i}=e;let a=i.trim().toLowerCase();if(a.startsWith("/")&&(a=a.slice(1)),!a)return l(t,o);const s=function(e){return e.map((e=>({...e,actions:e.actions.map((t=>{const o=t.searchName||t.displayName||"",n=[o,e.searchTitle||e.title||"",o].join(" ");return{...t,searchName:n}}))})))}(l(function(e,t){const o=[];for(const n of e){const e={...n,actions:[]};for(const r of n.actions)if(r.subActions){if(r.collapseSubActionsIntoParent){for(const o of r.subActions(t))for(const t of o.actions)e.actions.push(t);continue}const i=r.subActions(t).map((e=>({...e,key:`${n.key} ${r.key} ${e.key}`,title:e.title||r.displayName,searchTitle:[r.searchName||r.displayName,e.searchTitle||e.title].filter(Boolean).join(" ")})));for(const e of i)o.push(e)}else e.actions.push(r);e.actions.length&&o.push(e)}return o}(t,o),o)),c=[],d=new Map;for(const n of s)for(const e of n.actions)d.set(e,n),c.push(e);const p=(0,n.ZP)(a,c,(e=>e.searchName||""),{minThreshold:25,getSortScore:e=>-e.score*(e.original.sortScoreMultiplier??1)}),u=new Set(p),m=c.filter((e=>Boolean(e.alwaysShowInSearch)&&!u.has(e))),g=m.filter((e=>"start"===e.alwaysShowInSearch)),h=m.filter((e=>"end"===e.alwaysShowInSearch)),f=r.vM([...g,...p,...h],(e=>{const t=d.get(e);if(t)return t.title})),y=[];for(const n of Object.keys(f)){const e=f[n],t=d.get(e[0]);t&&y.push({...t,actions:e})}return y}function a(e,t){if(!t)return e;let o=0;const n=[];for(const r of e){if(o>=t)break;const e=r.actions.slice(0,t-o);e.length>0&&(o+=e.length,n.push({...r,actions:e}))}return n}function s(e,t){const o=[];for(const n of e){const e=n.actions.filter(t);e.length>0&&o.push({...n,actions:e})}return o}function l(e,t){return s(e,(e=>c(e,t)))}function c(e,t){if(e.validators){return e.validators.every((e=>e(t)))}return!0}},19037:(e,t,o)=>{o.d(t,{S4:()=>Xt,xD:()=>pe,AK:()=>ao,j2:()=>co,XQ:()=>ot,Eo:()=>tt,v_:()=>lo,wF:()=>Ke,ro:()=>Ye,sR:()=>Vt,O4:()=>Zt,_J:()=>$t,cW:()=>qt,nW:()=>Ce,zz:()=>xe,RF:()=>Ie,U4:()=>Ot,U_:()=>be,eo:()=>_e,OO:()=>vo,J5:()=>ve,k5:()=>Se,KE:()=>ye,M:()=>fe,NW:()=>At,vy:()=>Dt,Zk:()=>fo,IT:()=>nt,FS:()=>Ne,YB:()=>et,iJ:()=>Pt,TK:()=>Mt,IC:()=>Ho,xk:()=>Ae,ry:()=>Pe,Kb:()=>mo,Jl:()=>ho,Kh:()=>Bt,T2:()=>Rt,lr:()=>$o,OT:()=>Bo,W3:()=>Fo,p4:()=>Eo,zO:()=>jo,l$:()=>We,KJ:()=>Ze,z2:()=>Ro,EJ:()=>No,W5:()=>Ao,y9:()=>so,iK:()=>Jt,_T:()=>ht,lA:()=>Oe,b4:()=>Le,Dt:()=>ct,k6:()=>wo,Vw:()=>zt,UI:()=>Yt,W2:()=>ze,fy:()=>Lo,xw:()=>bt,YG:()=>xt,f7:()=>_t,dM:()=>Tt,p5:()=>Wo,zX:()=>He,oY:()=>Qt,Vf:()=>je,VB:()=>qe,P5:()=>qo,FY:()=>Ge,D:()=>Nt,RO:()=>uo,d:()=>rt,ar:()=>it,Vc:()=>Go,QL:()=>Je,K5:()=>we,LH:()=>ke,$H:()=>Ue,J8:()=>Xe,Mg:()=>Ct,nJ:()=>Ut,gn:()=>lt,US:()=>Do,IZ:()=>wt,Nn:()=>to,vj:()=>It,OX:()=>Ko,JF:()=>Fe,fI:()=>Ee,wT:()=>So,Gz:()=>Qe,sz:()=>he,HB:()=>zo,p1:()=>Be,b1:()=>Wt,jl:()=>ft,V5:()=>st,Cj:()=>Ve,I:()=>po,tq:()=>pt,Fx:()=>dt,_z:()=>Re,EC:()=>ge,fS:()=>ro,tY:()=>mt,DF:()=>no,F6:()=>io,KH:()=>Lt,vd:()=>Ht,YZ:()=>gt,Id:()=>Mo,$I:()=>vt,lv:()=>eo,vM:()=>Oo,Gg:()=>yt,Mn:()=>ut,AT:()=>Yo,lP:()=>Jo,X:()=>Te,FO:()=>Qo,_n:()=>Po,U7:()=>me,pl:()=>Uo,c2:()=>Me,$c:()=>_o,P9:()=>$e,Rg:()=>St,ED:()=>at,OF:()=>Io,YP:()=>xo,ur:()=>Co,Rd:()=>To,tJ:()=>ko,DU:()=>Et,ff:()=>ue,or:()=>de,Tx:()=>oo,eM:()=>yo,uq:()=>bo,jp:()=>Vo,KS:()=>Zo,QY:()=>Ft,KL:()=>jt,zl:()=>Kt});var n=o(41432),r=o(80951),i=o(42509),a=o(43593),s=o(74181),l=o(72126),c=o(26825),d=o(27006);const p=["TypeScript","JavaScript","GraphQL","HTML","CSS","Scss","JSON","XML","Rust","SQL"];var u=o(21202),m=o(6287),g=o(70279),h=o(63921),f=o(29369),y=o(90965),v=o(64684),b=o(70203),S=o(95477),_=o(69783),w=o(28020),k=o(78429),x=o(75770),I=o(85957),C=o(67669),T=o(18514),M=o(95697),P=o(58202),A=o(81844),D=o(41662),B=o(63208),R=o(80444),E=o(16772),F=o(88632),N=o(24042),j=o(64233),O=o(77080),L=o(19111),U=o(88923),Z=o(83212),V=o(81236),q=o(35661),z=(o(49557),o(55320)),W=o(27724),H=o(10743),G=o(99757),K=o(24666),$=o(35057),Y=o(30912),Q=o(78316),J=o(77181),X=o(12955),ee=o(11599),te=o(92783),oe=o(68056),ne=o(35026),re=o(98165),ie=o(59139),ae=o(28187),se=o(38755),le=o(89086),ce=o(85644);const de=function(e){return t=>e.some((e=>e(t)))},pe=function(e){return t=>e.every((e=>e(t)))},ue=function(e){return t=>!e(t)},me=e=>e.blocks&&1===e.blocks.length,ge=e=>e.blocks&&e.blocks.length>1,he=e=>!!(0,k.H)()&&e.blocks.every((e=>{const t=e.getParentId(),o=e.recordStoreUIParentStore,n=null==o?void 0:o.id;return t&&n&&t!==n})),fe=e=>e.blocks.every((t=>{const o=t.recordStoreUIParentStore;if(!o)return!1;const n=e.publicEditMode?e.publicEditMode:(0,re.n3)(o)&&Z.Z.getMode(e.environment,o);return!C.YF(n)&&o.canEdit()})),ye=e=>{const{environment:t}=e;return e.blocks.every((e=>C.KE({environment:t,block:e})))},ve=e=>!G.n.state&&e.blocks.every((t=>!C.YF(e.publicEditMode)&&t.canEdit())),be=e=>!G.n.state&&e.blocks.every((t=>{if(C.YF(e.publicEditMode))return!1;const o=ee.$0();return o?o.canEditCollection():t.canEdit()})),Se=e=>!G.n.state&&e.blocks.every((t=>!C.YF(e.publicEditMode)&&(t.isCollectionView()?t.canEditCollection():t.canEdit()))),_e=e=>{let{environment:t,publicEditMode:o,blocks:n}=e;if(G.n.state)return!1;const{id:r}=t.currentUser;return!!r&&(!C.YF(o)&&n.every((e=>(0,C.WE)({userId:r,store:e}).filter((t=>{let{type:o,role:n}=t;if(!n)return!1;const r=e.isCollectionView()||e.isTemplate()?d.D7(n):d.J5(n);return"public_permission"!==o&&r})).length>0&&C.KE({environment:t,block:e}))))},we=e=>{if(e.blocks&&1===e.blocks.length){const[o]=e.blocks;if(o.isCollectionView()){var t;const e=null===(t=o.getCollectionViewCollectionStore())||void 0===t?void 0:t.getValue();if(e)return(0,i.Gq)(e)||(0,i.Ev)(e)||(0,i.OY)(e)}}return!1},ke=e=>{if(e.blocks&&1===e.blocks.length){const[o]=e.blocks;if(o.isCollectionView()){var t;const e=null===(t=o.getCollectionViewCollectionStore())||void 0===t?void 0:t.getValue();if(e)return(0,i.Ev)(e)}}return!1},xe=e=>!G.n.state&&e.blocks.every((e=>e.canAdmin())),Ie=e=>!G.n.state&&e.blocks.every((e=>e.canComment())),Ce=e=>e.blocks.some((e=>Boolean(P.R.findBlockFromStoreWithMethod(e,"activate")))),Te=e=>e.blocks.every((e=>e.isRestricted())),Me=e=>{const{currentSpaceStore:t}=R.default.state,{currentUser:o}=e.environment;return(t?t.getPermissionItems():[]).some((e=>d.jg(e)&&e.user_id===o.id&&d.zz(e.role)))},Pe=function(){const e=w.np();return!e||!e.isLocked()},Ae=()=>{const e=w.np();return De(e)},De=e=>{if(!e)return!1;return!!e.getParentCollectionStore()},Be=e=>e.blocks.length>0&&e.blocks.some((e=>e.isLocked())),Re=e=>e.blocks.length>0,Ee=e=>e.blocks.some((e=>{const t=w.np();return!!(t&&t.isPageBlock()&&t.isLocked()&&t.uiContains(e)&&t!==e)})),Fe=e=>e.blocks.some((e=>{const{mainEditorCurrentBlockStore:t}=R.default.state;return Boolean(t&&t.isCollectionView()&&t.isLocked()&&t.uiContains(e)&&t!==e)})),Ne=e=>e.blocks.every((e=>{const t=e.getType();return Boolean(t&&(0,n.XD)(t)&&!(0,n.S9)(t))})),je=e=>{var t;const o=null===(t=R.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id;if(e.blocks[0]){const t=e.blocks[0].getType(),r=e.blocks[0].id;return Boolean(t&&r===o&&(0,n.XD)(t))}return!1},Oe=e=>e.blocks.every((e=>{const t=e.getRecordStoreUIParent();return Boolean(t&&e.isDefined()&&e.getParentId()!==t.id)})),Le=e=>e.blocks.every((e=>{const t=e.getRecordStoreUIParent();return Boolean(t&&t.canEdit()&&e.isDefined()&&e.getParentId()!==t.id)})),Ue=e=>{if(e.blocks){const t=e.blocks[0];return Boolean(t&&t.isDefined()&&t.getType()===n.Ti.file&&t.getProperties().source)}return!1},Ze=e=>{if(!e.blocks)return!1;const t=e.blocks[0],o=t&&t.getProperties().source;if(!o)return!1;const n=r.zB(o);return!!n&&a.E$(n,[S.default.secureFileS3.url,S.default.secureFileS3V2.url])},Ve=e=>{if(e.blocks){const t=e.blocks[0];if(t.isType(n.Ok))return Boolean(t.getProperties())}return!1},qe=e=>{if(e.blocks){const t=e.blocks[0],o=t&&t.getType();return Boolean(o&&(0,n.VB)(o))}return!1},ze=e=>{if(e.blocks){const t=e.blocks[0].getModel();return Boolean(null==t?void 0:t.isType(n.oe))}return!1},We=e=>t=>{if(t.blocks){const o=t.blocks[0];return Boolean(o&&o.getProperties()[e])}return!1},He=(We("source"),e=>{if(e.blocks){const t=e.blocks[0],o=null==t?void 0:t.getModel();return Boolean(null==o?void 0:o.isType(n.f4))}return!1}),Ge=e=>{if(e.blocks){const t=e.blocks[0];if(t&&t.getType()===n.Ti.transclusionReference){const e=t.getTransclusionReferenceTargetStore();return Boolean(e&&e.canEdit())}return!1}return!1},Ke=e=>e.blocks.every((e=>{const t=e.getModel(),o=e.getRecordStoreUIParent();return Boolean(t&&t.isType(n.Zi)&&t.getType()!==n.Ti.transclusionContainer&&e.getParentTable()!==m.v&&o&&o.id===e.getParentId())})),$e=e=>t=>t.blocks&&t.blocks[0]&&l.mf(t.blocks[0].getType)&&t.blocks[0].getType()===e,Ye=e=>t=>l.yW(t.blocks,(t=>t&&l.mf(t.getType)&&t.getType()===e)),Qe=e=>{const t=e.blocks[0],{language:o}=t.getProperties(),n=(0,b.QaF)(o);return p.includes(n)},Je=e=>()=>O.default.checkGate(e),Xe=e=>t=>{if(1!==t.blocks.length)return!1;const o=t.blocks[0],n=o.getParentBlockStore(),r=null==n?void 0:n.getContentStores(),i=null==r?void 0:r.map((t=>t.getType()===e));if(!i||0===(null==i?void 0:i.length))return!1;const a=null==r?void 0:r.map((e=>e.id)).indexOf(o.id);return void 0!==a&&(0===a||!i[a-1])},et=e=>e.blocks.every((e=>{const t=null==e?void 0:e.getModel();return Boolean((null==t?void 0:t.isType(n.Zj))&&e.getParentTable()!==m.v)})),tt=e=>{const t=w.RM();return!!t&&e.blocks.every((e=>t.uiContains(e)&&t.id!==e.id))},ot=e=>{const t=e.blocks[0],o=null==t?void 0:t.getRecordStoreUIRoot();return!!o&&e.blocks.every((e=>o.uiContains(e)&&o.id!==e.id))},nt=e=>e.blocks.every((e=>{const t=P.R.findBlockFromStoreWithMethod(e,"canRenderFullScreen");return Boolean(t&&t.canRenderFullScreen())})),rt=function(e){let{environment:{device:t}}=e;return t.isElectron},it=function(){return Boolean(N.Z.state.isElectronHandlingZoom)},at=function(e){let{environment:{device:t}}=e;return t.isWindows},st=function(e){let{environment:{device:t}}=e;return t.isMac},lt=function(e){let{environment:{device:t}}=e;return t.isIOS},ct=function(e){let{environment:{device:t}}=e;return t.isAndroid},dt=function(e){let{environment:{device:t}}=e;return t.isMobileNative},pt=function(e){let{environment:{device:t}}=e;return t.isMobile},ut=function(e){let{environment:{device:t}}=e;return t.isPhone},mt=function(e){let{environment:{device:t}}=e;return t.isNative},gt=function(e){let{environment:{device:t}}=e;return!t.isMobile},ht=()=>S.default.isAdminMode,ft=e=>{let{environment:t}=e;return Boolean(t.currentUser.isLoggedIn()||(0,X.getPublicDomainUserId)(t))},yt=function(){return F.Z.state.online},vt=e=>!e.blocks.every((t=>{const o=t.inMemoryRecordCache===e.environment.defaultRecordCache.inMemoryRecordCache,n=t.inMemoryRecordCache.cacheFallbacks.has(e.environment.defaultRecordCache.inMemoryRecordCache);return o||n})),bt=e=>e.blocks.some((e=>e.isTemplate())),St=e=>e.blocks.some((e=>e.isTypedCollectionViewBlock())),_t=e=>e.blocks.some((e=>e.isCollectionViewPageWithContent())),wt=e=>e.blocks.every((()=>!kt()||co("page",!1)(e))),kt=()=>{const e=w.np();return null==e?void 0:e.isCollectionViewPageWithContent()},xt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isCollectionView()}return!1},It=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isType(n.Ti.collectionView)}return!1},Ct=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isType(n.Ti.collectionViewPage)}return!1},Tt=function(e){return t=>{if(t.blocks&&1===t.blocks.length){const[o]=t.blocks,n=P.R.findCollectionViewBlockFromStore(o);return!!n&&n.collectionContextStore.getViewType()===e}return!1}},Mt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return 1===t.getCollectionViewStores().length}return!1},Pt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks,o=t.getCollectionViewCollectionStore();if(!o)return!1;const n=o.getSchema();return Object.values(n).map((e=>null==e?void 0:e.type)).every((e=>e&&D.g$.isPropertyTypeConvertableToSimpleTable[e]))}return!0},At=e=>T.NW(e.environment),Dt=e=>T.vy(e.environment),Bt=function(){return j.Z.state.open},Rt=function(){return _.Z.state.open},Et=function(){return L.Z.state.open},Ft=function(){return H.Z.state.open},Nt=function(){return"editing"===K.default.state.mode},jt=function(){return"empty"!==K.default.state.mode&&!(0,oe.iG)(K.default.state.multiSelection)},Ot=function(){return!((0,le.J6)(b.GKr.User)||(0,le.J6)(b.GKr.Bot)||(0,le.J6)(b.GKr.Date)||(0,le.J6)(b.GKr.Page))},Lt=function(){return W.default.state.stores.length>0},Ut=e=>{const t=R.default.state.currentSpaceStore;return(0,se.Cx)(t)},Zt=e=>e.blocks.every((e=>Boolean(A.Z.findOutlinerItemFromStore(e)))),Vt=e=>e.blocks.every((e=>{const t=A.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem&&"bookmarks"===t.type)})),qt=e=>e.blocks.every((e=>{const t=A.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem&&"shared"===t.type)})),zt=e=>{const t=e.blocks[0];if(!t)return!1;const o=t.getParentBlockStore();return!!o&&o.isLocked()},Wt=e=>!Ht(e),Ht=e=>{if(!(0,M.bq)())return!0;const t=e.blocks[0];if(t){if(t.getParentTable()===f.e0){const o=(0,re.VP)(t);if(!o||!(0,ne.si)({teamStore:o,environment:e.environment}))return!1}}return!0};function Gt(e){if(!e)return;const t=e.getParentPointer(),o=e.getRecordStoreUIParent();return(null==t?void 0:t.table)===f.e0&&o?q.zX.createChildStore(o,t):Gt(e.getParentBlockStore())}const Kt=e=>{const{id:t}=e.environment.currentUser;return!!t&&e.blocks.every((e=>{const o=e.getPermissionItems();return(0,c.ws)(o,t)}))},$t=e=>e.blocks.every((e=>{const t=A.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem)})),Yt=e=>{const{currentSpaceViewStore:t}=R.default.state,o=e.blocks[0];return Boolean(t&&o&&(0,te.Z)({spaceViewStore:t,pageId:o.id}))},Qt=e=>{const t=w.np();return e.blocks[0]&&e.blocks[0]===t},Jt=e=>e.blocks.every((t=>Boolean(C.IJ(e.environment,t)))),Xt=e=>e.blocks.every((e=>C.S4(e))),eo=e=>Boolean(R.default.state.mainEditorCurrentBlockStore),to=e=>I.Tx()&&e.blocks[0]&&e.blocks[0]===U.default.peekTarget.state,oo=e=>I.Tx(),no=e=>e.blocks.every((e=>{const t=null==e?void 0:e.getType();return Boolean(t&&(0,n.S9)(t))})),ro=e=>1===e.blocks.length&&(0,w.qG)(e.blocks[0].id),io=e=>e.blocks.every((e=>{const t=e.getType(),o=e.getFormat();return Boolean(t&&(0,n._T)(t,o))})),ao=e=>e.blocks.every((e=>Boolean(e.findRecordStoreUIAncestor((e=>e instanceof q.Xr||e instanceof q.G&&e.isCollectionView())).ancestor))),so=e=>{let{blocks:t}=e;return t.length>0&&(0,J.bX)(t[0])},lo=e=>{let{blocks:t}=e;return Q.v_(t)};function co(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=o=>o.blocks.every((o=>{const n=Q.fm(o,t),r=null==n?void 0:n.collectionViewStore();return(null==r?void 0:r.getType())===e}));return o}const po=function(){const{currentSpaceStore:e}=R.default.state;return Boolean(e&&e.canRead())},uo=function(){const{currentSpaceStore:e}=R.default.state;return Boolean(e&&e.canEdit())},mo=e=>{if(S.default.isAdminMode)return!0;if(Ut(e)&&!ve(e))return!1;const t=go(e),{environment:o,blocks:n}=e;return n.every((e=>{const n=(0,re.VP)(e);if(n){if(o.currentUser.id&&(0,v.s8)({team:{membership:n.getRawMembership()},userId:o.currentUser.id}))return!1;if(o.currentUser.id){const t=e.getUserPermissionForId(o.currentUser.id);if(t&&"editor"!==t.role)return!1}return!n.getDisableExport()}return t}))},go=function(e){let{environment:t}=e;const{currentSpaceStore:o}=R.default.state;if(!o)return!1;const n=V.Z.getPublicSpaceData(t,o.id);return o.isDefined()?!o.getDisableExport():n?!n.disableExport:ht()},ho=()=>{const{currentSpaceStore:e}=R.default.state;return!!e&&!e.getDisableMoveToSpace()},fo=e=>!G.n.state&&(!!e.blocks.every((e=>e.canEdit()))&&!!Jt(e)),yo=e=>e.blocks.every((t=>{var o;return"edit"===(null===(o=Z.Z.getMode(e.environment,t))||void 0===o?void 0:o.permission)})),vo=e=>{if(!fe(e))return!1;const t=e.blocks.filter((e=>{const t=e.recordStoreUIParentStore,o=e.getParentStore();return t&&o&&t.id===o.id}));return 0===t.length||ve({...e,blocks:t})},bo=e=>{let{environment:t}=e;const o=(0,w.k_)(t).state;return Boolean(o&&o.showSharedOverflowButton)},So=e=>{let{blocks:t}=e;return t.some((e=>Boolean(e.findRecordStoreUIAncestor((e=>e instanceof q.G&&e.isTransclusionType())).ancestor)))},_o=e=>{let{environment:t}=e;return"on"===O.default.getGroup("lucy-in-the-sky-with-tab-blocks")},wo=e=>{let{blocks:t}=e;if(!t||0===t.length)return!1;const o=t[0].getType(),r=t[0].getFormat();return Boolean(r.block_width)&&!Boolean(r.block_page_width)&&!Boolean(r.block_full_width)&&Boolean(o&&(0,n._7)(o))},ko=function(e){var t;let{blocks:o}=e;return Boolean(null===(t=(0,ae.Jk)(o[0]))||void 0===t||null===(t=t.slackIntegrationStore)||void 0===t?void 0:t.isReady())},xo=function(){var e;const{currentSpaceStore:t}=R.default.state,o=null==t||null===(e=t.getBotSettingsStore())||void 0===e?void 0:e.getValue();return!(0,y.CJ)(o)||Boolean((null==o?void 0:o.integration_approval_statuses)&&o.integration_approval_statuses[s.T0])},Io=function(e){var t;let{blocks:o}=e;const{slackIntegrationStore:n}=(0,ae.Jk)(o[0]);return Boolean(n.isReady()&&!(null!=n&&null!==(t=n.getKeyStore("enabled"))&&void 0!==t&&t.getValue()))},Co=function(e){var t;let{blocks:o}=e;const{blockStore:n,slackIntegrationStore:r}=(0,ae.Jk)(o[0]);return Boolean(r.isReady()&&(null==r||null===(t=r.getKeyStore("enabled"))||void 0===t?void 0:t.getValue())&&n.id!==o[0].id)},To=function(e){var t;let{blocks:o}=e;const{blockStore:n,slackIntegrationStore:r}=(0,ae.Jk)(o[0]);return Boolean(r.isReady()&&(null==r||null===(t=r.getKeyStore("enabled"))||void 0===t?void 0:t.getValue())&&n.id===o[0].id)},Mo=function(e){var t;let{blocks:o}=e;return(null===(t=o[0])||void 0===t?void 0:t.getSpaceId())!==h.N3},Po=e=>1===e.blocks.length&&e.blocks[0].getType()===n.Ti.table,Ao=e=>{const t=B.Z.state;return t.isActive&&1===e.blocks.length&&e.blocks[0]===t.simpleTableStore},Do=e=>{let{blocks:t}=e;return t.some((e=>Boolean(e.isImmediateColumnChild())))},Bo=e=>{const t=B.Z.state;if(!t.isActive)return!1;const{simpleTableStore:o}=t;return D.g$.getNumberOfColumns(o)>1},Ro=e=>{const t=B.Z.state;if(!t.isActive)return!1;const{simpleTableStore:o,selection:n}=t,r=0===n.start.row&&n.end.row===D.g$.getNumberOfRows(o)-1,i=0<=n.start.col&&n.start.col<=n.end.col&&n.start.col<=D.g$.getNumberOfColumns(o)-1;return"column"===n.type&&i&&r},Eo=e=>{const t=B.Z.state;if(!t.isActive)return!1;const{simpleTableStore:o,selection:n}=t,r=0===n.start.row&&n.end.row===D.g$.getNumberOfRows(o)-1,i=0===n.start.col&&0===n.end.col;return"column"===n.type&&i&&r},Fo=e=>{const t=B.Z.state;if(!t.isActive)return!1;const{simpleTableStore:o}=t;return D.g$.getNumberOfRows(o)>1},No=e=>{const t=B.Z.state;if(!t.isActive)return!1;const{simpleTableStore:o,selection:n}=t,r=0===n.start.col&&n.end.col===D.g$.getNumberOfColumns(o)-1,i=0<=n.start.row&&n.start.row<=n.end.row&&n.start.row<=D.g$.getNumberOfRows(o)-1;return"row"===n.type&&i&&r},jo=e=>{const t=B.Z.state;if(!t.isActive)return!1;const{simpleTableStore:o,selection:n}=t,r=0===n.start.col&&n.end.col===D.g$.getNumberOfColumns(o)-1,i=0===n.start.row&&0===n.end.row;return"row"===n.type&&i&&r},Oo=e=>{let{environment:t}=e;return(0,$.QM)()},Lo=e=>{if(1!==e.blocks.length)return!1;const t=e.blocks[0].getParentStore();return!(!t||t.table!==u.iU)&&t.isType(n.Ti.tab)},Uo=e=>{const t=e.blocks[0];return Boolean(t&&t.isCollectionView()&&t.getCollectionViewSourceCollectionStore())},Zo=e=>{if(!me(e))return!1;const t=e.blocks[0];return(0,ce.zg)(t)},Vo=e=>(e=>{let{environment:t,blocks:o}=e;if(!(0,M.bq)())return!1;if(!x.lQ({environment:t,blocks:o}))return!1;const n=t.currentUser.id,{currentSpaceStore:r}=R.default.state;if(!n||null==r||!r.isDefined())return!1;if(!M.Xq({environment:t,spaceStore:r}))return!1;for(const s of o){var i,a;if(!s.isPageBlock())return!1;if("team"!==(null===(i=A.Z.findOutlinerItemFromStore(s))||void 0===i?void 0:i.type))return!1;const e=null===(a=Gt(s))||void 0===a?void 0:a.getMembers();if(!e||!(0,v.pd)({membership:e},n))return!1}return!0})(e)&&gt(e);function qo(){const{currentSpaceStore:e}=R.default.state,t=null==e?void 0:e.getBotSettingsStore().getValue();return!(0,y.CJ)(t)||Boolean((null==t?void 0:t.integration_approval_statuses)&&t.integration_approval_statuses[s._o])}const zo=e=>Boolean(e.blocks[0].getFormat().is_placeholder),Wo=e=>{var t;return Boolean((null===(t=e.blocks[0].getFormat().alias_pointer)||void 0===t?void 0:t.table)===g.x_)},Ho=()=>{const e=w.np();if(!e||!e.hasContent())return!1;if(1===e.getContentLength()){const t=e.getContentStores()[0].getTitleStore();if(H.Z.state.open&&H.Z.state.textStore===t)return!1;if(E.default.isEditingEmptyBlock())return!1}return!0};function Go(){return Boolean(N.Z.state.isElectronUsingCommandNumber)}const Ko=e=>e.blocks.some(Y.td),$o=e=>e.blocks.every((e=>e.isType("page")||e.isType("callout")));function Yo(){return z.default.state.open}const Qo=e=>(0,ie.rd)(e.environment),Jo=e=>{const{environment:t}=e,{device:o}=t,n="quickSearch"===t.RouterStore.state.route.name;return o.isElectron&&n}},24215:(e,t,o)=>{o.d(t,{NM:()=>te,ls:()=>Te,mc:()=>de,Cd:()=>Fe,of:()=>me,Ts:()=>ve,eR:()=>be,cG:()=>Ae,nZ:()=>Ce,nB:()=>Ee,fK:()=>X,$A:()=>ee,Jq:()=>oe,pH:()=>ke,Ug:()=>Re,ci:()=>Ne,j:()=>ce,lu:()=>ue,Zf:()=>ne});o(57658);var n=o(82496),r=o(65680);function i(e){let t=[];if(e.length>0){if(t=e.filter((e=>{let{code:t}=e;return(0,r.Qh)(t)})),0===t.length)return"en-US";const o=t[0].quality,n=t.filter((e=>{let{quality:t}=e;return t===o}));let i=n.find((e=>"en"===e.code));return i||(i=n[0]),function(e){let t=r.vi[e.code];return"es"===e.code?t="ES"===e.region?"es-ES":"es-LA":"zh"===e.code&&(t="TW"===e.region||"HK"===e.region?"zh-TW":"zh-CN"),t}(i)}return"en-US"}function a(e){return`v2/${function(e){return i(n.parse(e))}(e)}`}var s=o(93214),l=o(15145),c=o(29450),d=o(53504),p=o(33728),u=o(55632),m=o(68626),g=o(15157),h=o(72126),f=(o(77897),o(27006)),y=o(29477),v=o(4615),b=o(9852),S=o(47425),_=o(64684),w=o(62992),k=o(7250),x=o(97880),I=o(64002),C=o(73123),T=o(54642),M=(o(95477),o(28020)),P=o(33929),A=o(98165),D=o(85957),B=o(75538),R=o(12252),E=o(58455),F=o(51),N=o(80444),j=o(77080),O=o(88923),L=o(81236),U=o(35661),Z=o(87956),V=o(78291),q=o(88893),z=o(35057),W=o(99334),H=o(12955),G=o(74503),K=o(57491);var $=o(67669),Y=o(38755);var Q=o(36867);const J="not_defined";async function X(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=E.default.verboseAnalytics;if(await u.fK({traits:e}),t)for(const o of e)console.log("track:%c identify","font-weight: bold;",o)}async function ee(e){const{environment:t,userId:o,traits:n,skipIntercom:r}=e,i=E.default.shouldRefresh(o)?await ke(t):E.default.state,a=function(e){const t=be();if(!t.user_id)return;const{user_id:o,email:n,name:r,...i}=e;return{...i,user_id:t.user_id,email:t.email,name:t.name}}(n);if(!a)return void m.rateLimitedLog({level:"warning",from:"analyticsHelpers",type:"noCleanAnalyticsUser"});const s=(0,v.F9)(a.user_id);if(!r){var l;const e=P.default.getIntl(),t=null===(l=N.default.state.currentUserStore)||void 0===l?void 0:l.getFullName(e);k.$A({userId:s,userName:t,traits:a,settings:i})}if(null!=i&&i.isLoggingEnabled){const e=M.VU().map(v.F9),o=await Se(t),n=await me(t),r=await async function(e){if(await(0,H.hasPermissionForThirdPartyServiceClient)("mutiny",e)){const e="mutiny.user.token",t=(0,c.getCookie)(e)||window.localStorage.getItem(e);if(t)return{mutinyVisitorId:t}}return{}}(t),{accept_language_raw:i,accept_language_preference:l}=n,p=(0,d.Z)({accept_language_raw:i,accept_language_preference:l},"ignore-class-instances"),m={...n,...r,space_has_paid_nonzero:!(!o||!("space_has_paid_nonzero"in o))&&o.space_has_paid_nonzero,integrations:{All:!0}},g={...a,user_email:a.email,...p,...m};u.$A({userId:s,traits:g,spaceIds:e})}E.default.verboseAnalytics&&console.log("identify:",JSON.stringify(n))}const te=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E.default.verboseAnalytics;await u.HX(),e&&console.log("deidentify user")};async function oe(e){const t=await Se(e);if(E.default.state.isIntercomEnabled){const e=await async function(e){const{currentUserRootStore:t,currentUserStore:o}=N.default.state;if(o&&t&&e){await Promise.all([t.load(),o.load()]);const n=t.getSpaceViewStores();await Promise.all(n.map((e=>e.load())));const r=h.oA(n.map((e=>e.getSpaceStore())));return await Promise.all(r.map((e=>e.load()))),h.oA(r.map((t=>{const n=t.isDefined()?{id:t.id,plan_type:t.getPlanType(),beta_enabled:t.getBetaEnabled()}:void 0;if(n){const r=(0,v.F9)(n.id);if(r===e.space_id){const r=V.default.state.data,i=q.XX(r),a={id:e.space_id,name:Ie(o,n.plan_type),size:(0,Y.jv)(t).length,is_subscribed:"space_is_subscribed"in e&&e.space_is_subscribed,is_beta:Boolean(n.beta_enabled)};return i&&(a.plan=i.plan),"space_data_not_loaded"!==e.space_analytics_data_type&&e.space_created_time&&(a.company_created_at=e.space_created_time),a}return{id:r,name:Ie(o,n.plan_type),size:(0,Y.jv)(t).length}}})))}return[]}(t);k.Jq({companiesData:e})}t&&E.default.state.isLoggingEnabled&&u.Jq({spaceId:t.space_id,spaceData:t})}async function ne(e,t){if(!e.currentUser.id)return;const o=(0,v.F9)(e.currentUser.id);return ee({environment:e,userId:o,traits:{...t,user_id:o},skipIntercom:!0})}const re={};function ie(e){const{spaceId:t,userId:o,deviceId:n,eventName:r}=e,i=(0,v.Ul)(`${t}:${o}:${n}:${r}`),a=re[i],s=Date.now();if(!a)return re[i]=s,!0;const l=new Date(a),c=new Date(s);return l.getUTCDate()!==c.getUTCDate()?(re[i]=s,!0):void 0}function ae(){const e=Z.Z.state;if(e)return{queryId:e.queryId}}function se(e){const{userId:t,spaceId:o}=e;if(!t||!o)return;const n=Fe({userId:t,spaceId:o});return n?{notion_session_id:n.id,notion_session_start_ts:n.sessionStartTime}:void 0}async function le(e,t,o){const n=await me(e),{preboot:r,dontWait:i}=o||{};i||r||await async function(e){e.currentUser.isLoggedIn()&&N.default.state.mainEditorCurrentBlockStore&&(await N.default.waitUntil((()=>Boolean(N.default.state.mainEditorCurrentBlockStore&&N.default.state.mainEditorCurrentBlockStore.isReady))),N.default.state.currentSpaceStore&&await V.default.waitUntilLoaded()),E.default.shouldRefresh(e.currentUser.id)&&await ke(e)}(e);const a=i?void 0:await Se(e),l=be(),{currentUserRootStore:d,currentUserStore:p,currentSpaceStore:u}=N.default.state,m=d&&d.isReady()?h.jj(d.getSpaceViewStores().map((e=>e.getSpaceId()))).length:null;let g;j.default.state.isLoaded&&(g=j.default.getStatsigExperimentsMap());const{width:f,height:y}=e.WindowSizeStore.state,S=(0,K.getMobileNativeDeviceInfo)(),_=window.__mobileNativeSessionInfo??{},w=await(0,G.getDesktopDeviceInfo)(),k=(null==a?void 0:a.space_id)||void 0,x=(0,s.LC)();return{data:{...fe(),...n,...a,..._e(),...ve(),...ye(),...ae(),...se({userId:null==p?void 0:p.id,spaceId:null==u?void 0:u.id}),...w,...S,..._,...l,experiments:g,experimentStoreLoaded:j.default.state.isLoaded,current_space_view_count:m,appSource:"client",windowWidth:f,windowHeight:y,unique_event_marker:ie({spaceId:k,userId:Me(),deviceId:n.device_id,eventName:t}),isActive:R.Z.state.active,fired_during_onboarding:B.default.state.isOnboarding,tab_id:(0,b.getSessionTabId)(),tab_count:(0,W.K)(),is_foreground:document.hasFocus(),is_user_consent_to_track:(0,c.hasPermissionForAmplitudeBrowser)(),tid:x&&(0,v.F9)(x)},spaceId:null==a?void 0:a.space_id}}async function ce(e,t,o,n){try{const r=E.default.verboseAnalytics;0;const{data:i,spaceId:a}=await le(e,t,n);!function(e,t,o){if(!o)return;for(const[n,r]of Object.entries(o))t[n]!==r&&m.log({level:"info",from:"analyticsHelpers",type:"forceOverrideMismatch",data:{eventName:e,miscDataToConvertToString:{forceOverrideKey:n,forceOverrideValue:r,autoTrackedValue:t[n]}}})}(t,i,null==n?void 0:n.forceOverrideAutomaticEventData);const s=(0,d.Z)(h.Xh({...o,...i,...null==n?void 0:n.forceOverrideAutomaticEventData}),"ignore-class-instances");k.j({eventName:t,eventData:s});const c={eventName:t,eventData:{...l.ni(s),__context:{locale:i.preferred_locale,page:{referrer:window.document.referrer,search:window.location.search}},sharedUUID:(0,v.ZP)()},spaceId:a};u.j(c),r&&console.log(`track:%c ${t}`,"font-weight: bold;",o)}catch(r){m.log({level:"error",from:"analyticsHelpers",type:"track",data:{eventName:t,miscDataToConvertToString:{e:r}}})}}function de(e){return{trackEvent:t=>{ce(e,t.eventName,t.properties)}}}const pe={};function ue(e,t,o,n,r,i){const a=pe[o],s=Date.now();return(!a||s-a>1e3*n)&&(pe[o]=s,ce(e,t,r,i),!0)}async function me(e){var t,o,n,r;const{device:i,RouterStore:a}=e,s=null===(t=a.getState())||void 0===t||null===(t=t.route)||void 0===t?void 0:t.name,l=await Ae(e),{pathname:c,...d}=(0,I.nx)(null===(o=document.location)||void 0===o?void 0:o.href,(0,b.getUrlAnalyticsFromSessionStorage)())||{},p={app_version:i.version,desktop_app_version:i.desktopAppVersion,mobile_app_version:i.mobileAppVersion,is_desktop_app_or_browser:!i.isMobile,is_desktop:i.isElectron,is_mobile:i.isMobile,is_tablet:i.isTablet,is_react_native:i.isMobileNative,is_ios:i.isIOS,is_logged_in:Pe(e),deviceType:i.os,device_type:i.deviceType,device_os:i.os,platform:i.platform,browser:i.browserName,browser_version:i.browserVersion,browser_version_bucketized:he(i.browserVersion,i.browserName),dnt:i.doNotTrackEnabled,device_id:l&&(0,v.F9)(l),tags:(0,b.getSessionAnalyticsTags)(),host:null===(n=document.location)||void 0===n?void 0:n.host,route_name:s,notion_top_level_domain:null===(r=document.location)||void 0===r||null===(r=r.host)||void 0===r||null===(r=r.split(".notion."))||void 0===r?void 0:r[1],referrer:document.referrer||"none",accept_language_raw:De(),accept_language_preference:Be(),...d};return h.GM(p,h.o8)}const ge=new Set(["Safari","Mobile Safari"]);function he(e,t){const o=e.split(".");return ge.has(t)?o.slice(0,2).join("."):o[0]}const fe=function(){const{currentSpaceViewStore:e}=N.default.state;return e&&e.isDefined()?{notify_desktop:e.getNotifyDesktop(),notify_email:e.getNotifyEmail(),notify_mobile:e.getNotifyMobile(),notify_email_digest:e.getNotifyEmailDigest()}:{}},ye=function(){const{mainEditorCurrentBlockStore:e}=N.default.state;if(e){const t=A.VP(e);if(t)return{team_id:(0,v.cj)(t.id)}}return{}},ve=function(){const{currentUserSettingsStore:e}=N.default.state;if(e&&e.isDefined()){let o={};const n=e.getSettings();return n&&(o={user_persona:n.persona,user_source:n.source,user_use_case:n.use_case,time_zone:n.time_zone,time_zone_region:"string"==typeof n.time_zone?(t=n.time_zone,"N/A"===t?t:t.split("/")[0]):void 0,locale:n.locale,preferred_locale:n.preferred_locale,signup_time:n.signup_time,used_desktop_web_app:n.used_desktop_web_app,used_mobile_web_app:n.used_mobile_web_app,used_mac_app:n.used_mac_app,used_windows_app:n.used_windows_app,used_ios_app:n.used_ios_app,used_android_app:n.used_android_app,user_session_count:(0,Q.g)(e.id)}),h.GM(o,h.o8)}var t},be=function(){const e={user_id:Me(),user_email:E.default.state.user_email,email:E.default.state.user_email,name:E.default.state.user_name};return h.GM(e,h.o8)};async function Se(e){var t;await(0,y.OI)(2e3,[Promise.all([V.default.waitUntilLoaded(),F.Z.waitUntilLoaded()])]);const{data:o}=V.default.state,{currentUserStore:n,currentSpaceStore:r}=N.default.state,{publicPageData:i}=F.Z.state,a=(0,M.zj)(),s=a?(0,v.F9)(a):void 0,{mainEditorCurrentBlockStore:l}=N.default.state,c=null!=r&&r.isDefined()?{id:null==r?void 0:r.id,settings:null==r?void 0:r.getSettings(),email_domains:null==r?void 0:r.getEmailDomains(),plan_type:null==r?void 0:r.getPlanType(),initial_use_cases:null==r?void 0:r.getInitialUseCases(),invite_link_enabled:null==r?void 0:r.getInviteLinkEnabled(),created_by_id:null==r?void 0:r.getCreatedById(),created_time:r.getCreatedTime()}:void 0,d=(null==r?void 0:r.id)||(null==i?void 0:i.spaceId)||(null==l?void 0:l.getSpaceId()),p=Boolean(null==c||null===(t=c.settings)||void 0===t?void 0:t.is_teams_enabled);if(d&&n&&r&&o){const t=L.Z.getPublicSpaceData(e,d),n=q.YK(o),i=q.CM(o).length||0,a=q.su(o),l=q.lk(o),u=o.hasPaidNonzero,m=t?t.domain:void 0,g=c&&c.email_domains?c.email_domains:void 0,f=q.zl(e,o),y=(0,Y.Ib)(t),b=(0,Y.ww)(t),S=h.hj(f)&&!Number.isNaN(f)&&f!==1/0?f:0;return{space_analytics_data_type:"space_member_data",subscription_tier:(0,z.zt)(),page_id:s,space_id:(0,v.F9)(d),space_is_subscribed:n,space_visible_total:i,space_visible_members:a,space_visible_guests:l,space_visible_members_bucketized:(0,C.aT)(a),space_block_usage:q.Lz(e,o),space_block_usage_over_limit:q.Ln(e,o),space_role:r.getRole(),space_block_usage_percent:S,space_timeline_view_usage:q._9(o)?o.timelineViewUsage:void 0,space_created_time:y,available_credit:0,space_domain:m,space_email_domains:g,space_has_paid_nonzero:u,space_plan_type:b,space_initial_use_cases:c?c.initial_use_cases:void 0,space_invite_link_enabled:null==c?void 0:c.invite_link_enabled,space_created_by:null!=c&&c.created_by_id?(0,v.F9)(c.created_by_id):void 0,teams_is_enabled:p}}if(i){const t=i.spaceId?L.Z.getPublicSpaceData(e,i.spaceId):void 0,o=(0,Y.Ib)(t),n=(0,Y.ww)(t);return{space_analytics_data_type:"space_nonmember_data",space_id:d?(0,v.F9)(d):void 0,space_domain:i.spaceDomain,page_id:s,subscription_tier:(0,z.zt)(),space_created_time:o,space_plan_type:n,space_invite_link_enabled:null==c?void 0:c.invite_link_enabled,space_created_by:null!=c&&c.created_by_id?(0,v.F9)(c.created_by_id):void 0,teams_is_enabled:p}}return c?{space_analytics_data_type:"base_space_data",space_id:(0,v.F9)(c.id),space_created_time:c.created_time,space_plan_type:c.plan_type,space_invite_link_enabled:c.invite_link_enabled,space_created_by:c.created_by_id?(0,v.F9)(c.created_by_id):void 0,teams_is_enabled:p}:{space_analytics_data_type:"space_data_not_loaded",space_id:null!=r&&r.id?(0,v.F9)(null==r?void 0:r.id):void 0}}const _e=function(){const e=O.default.state,t=D.mH(),o=M.np();if(o){const n=$.YO(o).map((e=>{let{permissionItem:t}=e;return t})),r=n.find((e=>"public_permission"===e.type)),i=n.find((e=>"space_permission"===e.type)),a=n.filter((e=>"user_permission"===e.type&&(0,f.rz)(e.role))),s=n.filter((e=>"user_permission"===e.type&&(0,f.J5)(e.role))),l=function(e){const t=A.uJ(e),o=[];return h.xH(t.map((e=>{if(e instanceof U.zX)return;const t=e.getCopiedFromPointer();return t&&w.J(t)&&o.push(t.id),o})))}(o),c=Boolean(l)&&l.length>0,d=e.open?void 0:N.default.state.currentCollectionViewStore,{publicPageData:p}=F.Z.state,u=o.getCopiedFromPointer();return{page_id:o.id,page_public_role:r?r.role:J,page_space_role:i?i.role:J,page_all_collaborator_count:s.length+a.length,page_editor_collaborator_count:s.length,page_read_only_collaborator_count:a.length,page_content_count:o.getContentLength(),page_current_user_role:o.getRole(),page_is_peek:t,page_copied_from:u?(0,v.F9)(u.id):void 0,page_is_notion_template:!!u&&w.J(u),page_is_template:o.isTemplate(),page_is_prepopulated:c,page_prepopulated_template_ids:l,page_is_database:o.isCollectionView(),page_view_type:d?d.getType():void 0,page_user_has_explicit_access:p?p.userHasExplicitAccess:J}}};const we=new Map;async function ke(e){const t=e.currentUser.id;if(t){if(!we.has(t)){const o=xe(e,{loggedIn:!0});we.set(t,o),o.then((()=>{we.delete(t)})).catch((e=>{throw we.delete(t),e}))}return we.get(t)}return xe(e,{loggedIn:!1})}async function xe(e,t){t.loggedIn&&await N.default.waitUntilRendered();const o=await T.getUserAnalyticsSettings(e,{});if("success"!==o.type)return void m.log({level:"warning",from:"analyticsHelpers",type:"fetchAnalyticsSettings",data:{miscDataToConvertToString:{response:o}}});const n=o.data;return E.default.setState(n),n}const Ie=function(e,t){const o=e.getEmail();return o&&"team"===t?(0,p.Gd)(o):o||void 0};function Ce(e){return e.map((e=>(0,Y.cD)(e))).filter(x.lm).some((e=>S.QM(e)))}function Te(e){const t=e.map((e=>(0,Y.cD)(e))),o=new Set(h.oA(t));return o.has("enterprise")?"enterprise":o.has("business")?"business":o.has("plus")?"plus":o.has("personal")?"personal_pro":o.has("team_free")?"team_free":o.has("personal_free")?"personal_free":o.has("free")?"free":"none"}function Me(){const e=E.default.state.user_id;return e?(0,v.F9)(e):void 0}function Pe(e){const t=function(e){var t;return(null==e||null===(t=e.currentUser)||void 0===t?void 0:t.id)||(0,H.getPublicDomainUserId)(e)}(e);return Boolean(t)}async function Ae(e){const t=await(0,H.getBrowserId)(e);return t&&(0,v.F9)(t)}function De(){return j.default.getAcceptLanguageHeader()}function Be(){return a(De()||"")}function Re(){return"on"===j.default.getEligibleGroup({experimentId:"zendesk",defaultGroup:"unassigned"})}function Ee(e){var t;const o=e.id,n=e.isDefined()?{membership:e.getMembers(),settings:e.getSettingsStore().getValue(),is_default:e.isDefault(),description:e.getDescription(),icon:e.getIcon(),team_pages:e.getTeamPagesStore().getValue()}:void 0;if(!n||!n.settings)return{team_id:(0,v.cj)(o),no_team_value:!0};const r=n.membership||[];return{team_id:(0,v.cj)(o),team_current_size:r.length,team_current_num_users:r.filter((e=>"user"===e.entity_type)).length,team_current_num_groups:r.filter((e=>"group"===e.entity_type)).length,team_access_level:(0,_.B5)(n.settings),team_is_default:n.is_default,team_has_description:Boolean(n.description),team_has_icon:Boolean(n.icon),team_top_pages:(null===(t=n.team_pages)||void 0===t?void 0:t.length)??0}}function Fe(e){const t=g.Z.get({userId:e.userId,key:`${e.spaceId}:analytics_session`});if(!(t&&Date.now()-t.lastFocusedTime>18e5))return t}function Ne(e){g.Z.set({userId:e.userId,key:`${e.spaceId}:analytics_session`,value:e.session})}},28020:(e,t,o)=>{o.d(t,{$A:()=>te,AK:()=>we,B7:()=>X,CC:()=>ge,CP:()=>he,Fv:()=>$,JE:()=>ye,RM:()=>ee,VU:()=>be,VV:()=>ve,Xb:()=>se,Zy:()=>ke,_H:()=>J,_u:()=>le,aT:()=>oe,h1:()=>ie,hq:()=>ce,k_:()=>de,kw:()=>pe,np:()=>Y,o:()=>Se,p5:()=>xe,qG:()=>ne,qQ:()=>fe,tu:()=>ae,ui:()=>me,wU:()=>_e,yn:()=>ue,zj:()=>Q});var n=o(14577),r=o(41432),i=o(53877),a=o(72126),s=o(27006),l=o(99405),c=(o(21202),o(23867)),d=o(19889),p=o(53323),u=o(94841),m=o(49427),g=o(34859),h=o(51),f=o(80444),y=o(80641),v=o(33784),b=o(55367),S=o(64233),_=o(73329),w=o(3418),k=o(42653),x=o(94416),I=o(48863),C=o(22294),T=o(19111),M=o(5315),P=o(19671),A=o(13023),D=o(88923),B=o(35661),R=o(69784),E=o(13105),F=o(82187),N=o(55320),j=o(27724),O=o(10743),L=o(24666),U=o(16194),Z=o(4708),V=o(78316),q=o(85957),z=o(67669),W=o(65598),H=o(77546),G=o(38755),K=o(95697);function $(){if(f.default.state.mainEditorCurrentBlockStore)return{id:f.default.state.mainEditorCurrentBlockStore.id,spaceId:(0,c.C)(f.default.state.mainEditorCurrentBlockStore.pointer.spaceId)}}function Y(){const e=D.default.state,t=q.mH();return e.open&&t?e.target:f.default.state.mainEditorCurrentBlockStore}function Q(){if(f.default.state.mainEditorCurrentBlockStore)return f.default.state.mainEditorCurrentBlockStore.id}function J(){return q.Tx()?A.Z:P.Z}function X(e){let t;return f.default.state.currentUserStore?t=f.default.state.currentUserStore:e.currentUser.id&&(t=new B.U6(e,{table:d.KJ,id:e.currentUser.id})),t}function ee(){const e=j.default.getCurrentRootStore();if(e&&e instanceof B.G)return e}function te(e,t){return!t&&ne(e)&&(0,u.WE)(f.default.state.mainEditorCurrentBlockStore)}function oe(e,t){return!t&&(0,u.WE)(f.default.state.mainEditorCurrentBlockStore)&&(0,u.Kj)(e)}function ne(e){return"myTasks"===(0,u.G)({blockOrCollectionId:e})}const re=new E.P({debugName:"getAppRenderState",memoizeRecursion:!0,deepEquals:!1,compute:function(e){var t;const{mainEditorCurrentBlockStore:o,initialized:n}=f.default.state,r=e.currentUser.isLoggedIn(),i=e.RouterStore.state.route,a=Boolean(o&&o.canRead()&&o.isDefined()),c=Boolean(o&&o.canEdit()&&o.isDefined()),d=Boolean(o&&(0,W.Oh)(o)),p=o&&a&&(0,z.IJ)(e,o),u=Boolean(p),m=p&&(0,s.J5)(p.permissionItem.role),g=c&&!m,v=(null==o||null===(t=o.getModel())||void 0===t?void 0:t.isNonverifiedContentClassification())&&!(o&&y.Z.bypassedPage(o.id))&&!g,{publicPageData:b}=h.Z.state,S=!n||!d,_=Boolean((0,l.HK)(i)&&(!(0,l.wO)(i)&&!o||o&&o.isReady()&&!a||v||(null==b?void 0:b.requireInterstitial)||(null==b?void 0:b.requireLogin)&&!r));return{shouldShowSidebar:function(){if((0,Z.GH)())return Boolean(null==b?void 0:b.template);const e="quickSearch"===i.name;return Boolean(!e&&!_&&r&&(S||(0,l.wO)(i)||a&&(c&&!u||d&&!u)&&!v&&!(null!=b&&b.requireInterstitial)))}(),shouldShowFrame:!_,shouldShowError:_}}}),ie=e=>re.getStateFor(e),ae=new n.Z((()=>{const{mainEditorCurrentBlockStore:e}=f.default.state,t=e&&e.isCollectionView();return C.Z.state.isKeyboardMode&&!U.Z.state&&!F.Z.isActive()&&!t&&!N.default.state.open&&!x.Z.state.open&&!(0,p.n)()&&0===_.Z.state.banners.length}),{debugName:"appHelpers.shouldHideTopbarStore"});function se(e){const{currentSpaceViewStore:t}=f.default.state;if(t){return a.G0(t.getWorkspacePages(),(0,G.KA)(e,t),t.getPrivatePages(e)).filter((e=>e.isNavigableBlock()))}return[]}function le(e){const{currentSpaceViewStore:t}=f.default.state;return t?a.mN([...t.getBookmarkedPages(),...t.getWorkspacePages(),...(0,G.KA)(e,t),...t.getPrivatePages(e)],"id"):[]}function ce(e){return e.getType()===r.Ti.copyIndicator&&!M.transactionQueue.isPendingTransactionForRecord(e.pointer)}const de=a.HP((e=>new n.Z((()=>function(e){const{currentSpaceStore:t,currentSpaceViewStore:o,currentUserRootStore:n,currentUserSettingsStore:r}=f.default.state;if(!(o&&n&&t&&r))return;const i=(0,G.jv)(t),a=o.getBookmarkedPages(),s=o.getWorkspacePages(),l=o.getTeamsStores(),{allSharedPagesStores:c,visibleSharedPagesStores:d}=(0,G.MC)({environment:e,spaceViewStore:o,userSettingsStore:r}).state,p=o.getPrivatePages(e),u=(0,G.Cx)(t),m=1===i.length&&0===s.length&&"personal"===t.getPlanType(),g=a.length>0,h=!u&&!(0,K.bq)()&&s.length>0,y=c.length>0,v=r.hasUserPinnedToOutliner({spaceId:t.id,type:"shared"}),b=(0,K.bq)();return{isGuest:u,isPersonalSpace:m,showBookmarksSection:g,showWorkspaceSection:h,showSharedSection:y,showPrivateSection:!u,showOnlyPrivateSection:!(g||h||y||b),showSharedOverflowButton:c.length>G.G$||v,stickTemplateItemsToBottom:a.length+c.length+s.length+p.length>=8,allSharedPagesStores:c,visibleSharedPagesStores:d,showTeamSection:b,userJoinedTeamsStores:l}}(e)),{useDeepEqual:!0,debugName:"sidebarStateStore"}))),pe=new n.Z((()=>C.Z.state.isKeyboardMode||R.Z.state.isActive||b.ZP.state.isDragging||O.Z.state.open||T.Z.state.open||S.Z.state.open||I.Z.state.open||w.Z.hasOpenMouseCapturePopup()||P.Z.state.isOpen&&!D.default.isCenterPeekOpen()||A.Z.state.isOpen||v.Z.state.open||k.Z.state.isPinned),{debugName:"menuIsOpenStore"}),ue=new n.Z((()=>{const{currentSpaceViewStore:e,currentUserStore:t}=f.default.state,o=new Set;if(!e||!t)return o;for(const n of e.getTeamsStores()){n.getMembers().find((e=>"user"===e.entity_type&&e.user_id===t.id))&&o.add(n.id)}return o}),{useDeepEqual:!0,debugName:"userTeamsInCurrentSpace"});function me(e){return e.device.isPhone?24:96}const ge=900;function he(e){return me(e)}function fe(e){const t=j.default.getCurrentDefaultContainer(),o=ge-2*me(e);if(t){const e=m.Z.find((e=>e.props.store===t.props.store));if(e){const t=e.getContentInnerWidth();if(t)return Math.min(o,t)}}return o}function ye(){const e=Y(),t=L.default.state;if("editing"!==t.mode)return!1;const o=t.multiSelection.start.store;return e&&e.id===o.id&&o.path.includes("title")||!1}function ve(){const e=L.default.state;if("editing"!==e.mode)return!1;const t=e.multiSelection.start.store,o="collection"===t.table;return t.path.includes("name")&&o||!1}function be(){const{currentUserRootStore:e}=f.default.state;if(e){const t=e.getSpaceViewStores();return a.oA(t.map((e=>e.getSpaceId())))}return[]}function Se(e){return a.mN(e.getSpaceViewStores(),(e=>e.getSpaceId())).filter((e=>{const t=e.getSpaceStore();return e.isDefined()&&t&&t.canEdit()}))}async function _e(e){await e.load();const t=e.getSpaceViewStores();await Promise.all(t.map((async e=>{await e.load();const t=e.getSpaceStore();t&&await t.load()})))}const we=new n.Z((function(){const{currentUserSettingsStore:e}=f.default.state,t=(0,i.aN)();if(e){const o=e.getSettings();return void 0===(null==o?void 0:o.start_day_of_week)?t:null==o?void 0:o.start_day_of_week}return t}),{debugName:"userSettingsStartOfWeek"});function ke(e){const{environment:t,store:o}=e;return o.isCollectionView()?(0,H.eA)(t)?g.Z.All:g.Z.Y:!(0,V.en)(o)&&D.default.isSidePeekOpen()?g.Z.All:g.Z.Y}function xe(e){const{isFullScreen:t,environment:o}=e;return t&&(0,H.eA)(o)?g.Z.None:g.Z.X}},93959:(e,t,o)=>{o.d(t,{$4:()=>ee,$Q:()=>V,$j:()=>ne,AG:()=>F,Au:()=>E,EE:()=>U,F0:()=>w,FQ:()=>K,FW:()=>I,Hw:()=>L,K8:()=>Q,KC:()=>x,Mi:()=>A,RN:()=>W,Ru:()=>J,TD:()=>N,Th:()=>te,VL:()=>b,Wo:()=>S,YB:()=>k,YC:()=>re,Z0:()=>X,Zu:()=>D,_3:()=>P,cR:()=>O,ck:()=>M,fm:()=>R,h7:()=>j,hZ:()=>$,iX:()=>_,jH:()=>oe,oX:()=>C,rC:()=>Y,xB:()=>Z});o(57658),o(21703);var n=o(76205),r=o(35011),i=o(10070),a=o(45433),s=o(46328),l=o(53877),c=o(77657),d=o(42875),p=o(72126),u=o(23014),m=o(9844),g=o(97880),h=o(80444),f=o(77080),y=o(30874),v=o(26991);const b=16803324e5;function S(e,t){return e.find((e=>e.uri===t))}function _(e,t){return e.find((e=>e.presets.some((e=>e.uri===t))))}function w(e,t){return e.flatMap((e=>e.presets)).find((e=>e.uri===t))}function k(e,t){if(!t)return;return e.find((e=>e.allFeatures.find((e=>{if(C(e))for(const o of e.dependencies)if("collection"===o.type&&o.uri===t)return!0}))))}function x(e,t){const o=_(e,t.uri);if(!o)return[];return[...t.requiredFeatures,...t.defaultOnFeatures].filter((e=>{const t=o.allFeatures.find((t=>t.uri===e.featureUri));if(!t)return!1;const{type:n}=e;return"simple"===n?"dependencies"in t:"with_variant"===n?"variants"in t:void(0,g.t1)(n)}))}function I(e){return"variants"in e}function C(e){return"dependencies"in e}const T=[s.k.Owner];function M(e,t){const o=k(e,t);if(o)for(const n of o.allFeatures)if(C(n)){const e=n.dependencies.find((e=>"collection"===e.type&&e.uri===t));if(e)return e.value.schema??{}}}function P(e){let{featurePointers:t,appConfig:o}=e;const n=p.oA(t.map((e=>{const{type:t}=e;return"simple"===t?e.featureUri:"with_variant"===t?e.defaultVariantUri:void(0,g.t1)(t)}))),r={};for(const s of o.allFeatures)r[s.uri]=s;const i=n.map((e=>r[e])),a={};for(const s of i)for(const e of s.dependencies)a[e.uri]=e;return Object.values(a)}function A(e){return e.endsWith(a.WN)}function D(e,t){return e.presets.find((e=>e.uri===`${t}${a.WN}`))}const B={[a.Es.Status]:["status","checkbox","select"]};function R(e,t,o){const n=t.type,r=e in B?B[e]:[n];return Object.entries(o).filter((e=>{let[t,o]=e;if(o)return r.includes(o.type)}))}function E(e,t){const o={};for(const[n,r]of Object.entries(e)){if(!n.startsWith("notion://"))continue;if(null==r?void 0:r.type){const e=R(n,r,t);1===e.length&&(o[n]=e[0][0])}}return o}function F(e,t,o){const r=e.allFeatures.filter((e=>(e=>{var r,s,l,c,d,p,u,m;if(!C(e)||1!==e.dependencies.length||"collection_view"!==e.dependencies[0].type)return!1;const h=e.dependencies[0],f=o.getFormat().app_config_uri,y=t.getFormat().app_config_uri,b=(null===(r=o.getFormat())||void 0===r?void 0:r.app_uri_map)??{};if(!f||!y)return!1;if(h.blockUri!==f||h.collectionUri!==y)return!1;if(h.uri in b)return!1;const S=i.aQ.deriveTypeUris((null==t?void 0:t.getSchema())??{},null==t?void 0:t.getPropertyMapping()),_=h.value;switch(_.type){case"table":case"list":case"gallery":case"timeline":if(null!==(s=_.format)&&void 0!==s&&s.collection_group_by){const e=_.format.collection_group_by.property;if(!(0,a.jP)(e)||!S.has(e))return!1}if(null!==(l=_.query2)&&void 0!==l&&l.timeline_by){const e=_.query2.timeline_by;if(!(0,a.jP)(e)||!S.has(e))return!1}break;case"board":if(null!==(c=_.format)&&void 0!==c&&c.board_columns_by){const e=_.format.board_columns_by.property;if(!(0,a.jP)(e)||!S.has(e))return!1}if(null!==(d=_.format)&&void 0!==d&&d.collection_group_by){const e=_.format.collection_group_by.property;if(!(0,a.jP)(e)||!S.has(e))return!1}break;case"calendar":if(null!==(p=_.query2)&&void 0!==p&&p.calendar_by){const e=_.query2.calendar_by;if(!(0,a.jP)(e)||!S.has(e))return!1}break;case"page":return!1;default:(0,g.t1)(_.type)}const w=e=>!!(0,n.Oo)(e)||(0,a.jP)(e.property)&&S.has(e.property);if(null!==(u=_.format)&&void 0!==u&&u.property_filters)for(const o of _.format.property_filters){if(!q(o.filter,w))return!1;if(!(0,v.qf)(o.filter,t))return!1}if(null!==(m=_.query2)&&void 0!==m&&m.filter){const e=_.query2.filter;if(e.filters)for(const t of e.filters)if(!z(t,w))return!1}return!0})(e)));return p.mN(r,"uri")}function N(e,t){const o=p.xH(p.oA(t.allFeatures.map((e=>{if(C(e))return e.dependencies}))));return p.mN(o.filter((t=>e.includes(t.uri))),(e=>e.uri))}function j(e){return"app_container"===e.getFormatStore().getKeyStore("collection_view_sub_type").getValue()}function O(e,t,o,n){if(t===a.GZ&&o===s.k.Owner)return!0;const r=i.aQ.deriveTypeUri(o,n.getPropertyMapping());if(!r)return!1;const l=function(e,t){if(t===a.GZ)return T;const o=M(e,t);return o?Object.keys(o):void 0}(e,t);return!!l&&l.includes(r)}function L(e,t,o){return(0,u.un)(e,t,o)}function U(e){return e===a.Kk||e===a.tD||e===a._1}function Z(e){return e===a.g3}function V(e,t){const o=[];for(const r of t)"property"===r.type||"database_template"===r.type?e.has(r.collectionUri)&&o.push(r):"block"===r.type?e.has(r.parentUri)&&o.push(r):"blockUri"in r&&e.has(r.blockUri)&&o.push(r);let n=[];return o.length>0&&(n=V(new Set(o.map((e=>e.uri))),t)),[...o,...n]}function q(e,t){return!!t(e)}function z(e,t){if((0,n.aN)(e)){if(!q(e,t))return!1}else{if((0,n.Mm)(e))return!0;if(e.filters)for(const o of e.filters){if(!z(o,t))return!1}}return!0}function W(e,t){const o=[];if(e.filters)for(const n of e.filters){const e=H(n,t);if(!e)throw new Error("Invalid filter");o.push(e)}return{...e,filters:o}}function H(e,t){if((0,n.aN)(e))return null!=t&&t[e.property]?{...e,property:t[e.property]}:e;if((0,n.Mm)(e))return e;if((0,n.vA)(e)){if(e.filters){const o=[];for(const n of e.filters){const e=H(n,t);if(!e)throw new Error("Invalid filter");o.push(e)}return{operator:e.operator,filters:o}}}else(0,g.t1)(e)}function G(e,t,o){const r=t.getQuery(o.getSchema()),i=t.getFormat(),a=null==r?void 0:r.sort;if(a){if(a.some((t=>e.uri===t.property)))return!0}const s=t.getFormat().property_filters;if(s){const t=t=>!(0,n.Oo)(t)&&t.property===e.uri;if(s.some((e=>q(e.filter,t))))return!0}const l=null==r?void 0:r.filter;if(void 0!==l&&l.filters){const t=t=>!!(0,n.Oo)(t)||t.property!==e.uri;for(const e of l.filters){if(!z(e,t))return!0}}switch(t.getType()){case"table":case"list":case"gallery":case"timeline":if(i.collection_group_by){if(i.collection_group_by.property===e.uri)return!0}if(null!=r&&r.timeline_by){if(r.timeline_by===e.uri)return!0}break;case"board":if(i.board_columns_by){if(i.board_columns_by.property===e.uri)return!0}if(i.collection_group_by){if(i.collection_group_by.property===e.uri)return!0}break;case"calendar":if(null!=r&&r.calendar_by){if(r.calendar_by===e.uri)return!0}}return!1}function K(e,t){const o=(0,d.r)(),n=(0,l.em)(e,1,o);return(0,l.fZ)(n.valueOf(),n.plus({weeks:t}).minus({days:1}).valueOf(),o)}function $(e,t){const o=(0,l.DF)(e,(0,d.r)()).plus({days:t});return(0,l.ME)(o)}const Y=[a.TZ,a.k$,a.pz];function Q(e){var t;const{dependencies:o,collectionStore:n,collectionViewBlockStore:a,viewStores:s,validDependencies:l}=e,c=o.filter((e=>"property"===e.type)),d=[...c.filter((e=>"rollup"===e.propertySchema.type)),...c.filter((e=>"formula"===e.propertySchema.type))],p=o.filter((e=>"collection_view"===e.type)),u=i.aQ.deriveTypeUris(n.getSchema(),n.getPropertyMapping()),m=null===(t=a.getFormat())||void 0===t?void 0:t.app_uri_map,g={validDependencies:l,propertyDeps:[],viewDeps:[]};if(!u||!m)return g;for(const i of d){if(!u.has(i.uri))continue;const e=n.getSchema()[i.uri];if(e){if("rollup"===e.type){l.some((t=>t.uri===e.relation_property))&&(l.push(i),g.propertyDeps.push(e))}if("formula"===e.type){(0,r.pV)(e).some((e=>{for(const t of l)if(t.uri===e)return!0}))&&(l.push(i),g.propertyDeps.push(e))}}}for(const r of p){if(!m[r.uri])continue;const e=s.find((e=>e.id===m[r.uri]));if(!e)continue;l.some((t=>"property"===t.type&&G(t,e,n)))&&(l.push(r),g.viewDeps.push(e))}return g.validDependencies=l,g}function J(){return f.default.checkGate("proj_management_sprints_upgrade")}function X(){const{currentSpaceStore:e}=h.default.state;return!Boolean(e&&!e.canEdit())&&f.default.checkGate("proj_management_tooltip_tour")}function ee(){return f.default.checkGate("proj_management_tooltip_tour")}function te(){return y.Z.getIntegrationsAsRecordMap().getModel({table:m.K2,id:c.Dv})&&f.default.checkGate("cron_connected_relation")}function oe(e,t){var o;if(t&&e)return null===(o=e.getSettings())||void 0===o||null===(o=o.proj_management_tooltip_tour_v1_phase_per_space)||void 0===o?void 0:o[t.id]}function ne(e,t){return{create_a_task:"assign_to_someone",assign_to_someone:"change_task_status",change_task_status:t?"select_a_project":"click_view_settings",select_a_project:"complete",click_view_settings:"complete"}[e]}function re(e,t){const o=w(e,t);if(!o)throw new Error(`Preset not found for URI: ${t}`);const{name:n,icon:r}=o;return{name:n,icon:r}}},91924:(e,t,o)=>{o.d(t,{HU:()=>p,IJ:()=>c,Q7:()=>l,eC:()=>d,k2:()=>u});var n=o(6495),r=o(32739),i=o(95477),a=o(77080),s=o(18514);function l(e){return!!e.device.isMobileNative&&(e.device.isIOS&&"on"===a.default.getEligibleGroup({experimentId:"ios_3rd_party_login_with_external_browser",defaultGroup:"control"})||e.device.isAndroid&&"on"===a.default.getEligibleGroup({experimentId:"android_3rd_party_login_with_external_browser",defaultGroup:"control"}))}function c(e){const{device:t}=e,o=l(e);if(t.isMobileNative){return{redirectToAuth:!1,callbackType:o?"nativeredirect":"native"}}if(t.isElectron){return{redirectToAuth:!1,callbackType:"nativeredirect"}}return{redirectToAuth:!0,callbackType:"redirect"}}function d(e){const{device:t}=e,o=l(e);if(t.isMobileNative){return{redirectToAuth:!1,callbackType:o?"nativeredirect":"native"}}if(t.isElectron){return{redirectToAuth:!1,callbackType:"nativeredirect"}}if(t.isMobileBrowser||(0,s.Sr)()){return{redirectToAuth:!0,callbackType:"redirect"}}return{redirectToAuth:!0,callbackType:"popup"}}async function p(e,t,o){if(e.device.isHttpApp){const e=await fetch(t);return(await e.json()).url}{const e=await fetch(r.NV({httpUrl:t,protocol:i.default.protocol,includePort:o}));return(await e.json()).url}}function u(e){return r.jP({url:n.tu[e],isLocalHost:"local"===e})}},80365:(e,t,o)=>{o.d(t,{L:()=>g});var n=o(18466),r=o(66897),i=o(36576),a=o(72126),s=o(21202),l=o(70279),c=o(23867),d=o(19889),p=o(97880),u=o(35661);function m(e,t){const o=a.oA(e.map((e=>function(e,t){if("comment_mention"===e.mentioned_from.type){const o=u.t1.createChildStore(t,{table:l.x_,id:e.mentioned_from.comment_id,spaceId:(0,c.C)(void 0)});if(!o.isDefined())return;const n=u.t1.createChildStore(t,o.getParentPointer());if(!n.isDefined())return;const r=u.G.createChildStore(t,{table:s.iU,id:n.getParentId()}),i=r.getNavigableBlockStore();if(!i)return;return r.id===i.id?{backlinkStore:i,timestamp:o.getLastEditedTime()}:{backlinkStore:i,scrollToBlockId:r.id,discussionId:n.id,timestamp:o.getLastEditedTime()}}if("reference"===e.mentioned_from.type){const o=u.G.createChildStore(t,{table:s.iU,id:e.mentioned_from.parent_block_id}).getNavigableBlockStore();if(!o)return;const n=o.getLastEditedTime();return{backlinkStore:o,scrollToBlockId:e.block_id,timestamp:n||0}}if("property_mention"===e.mentioned_from.type){const{block_id:o}=e.mentioned_from,n=u.G.createChildStore(t,{table:s.iU,id:o});if(!n.isDefined())return;const r=n.getNavigableBlockStore();if(!r)return;return r.id===n.id?{backlinkStore:r,timestamp:n.getLastEditedTime()}:{backlinkStore:r,scrollToBlockId:n.id,timestamp:n.getLastEditedTime()}}if("collection_reference"===e.mentioned_from.type){const{block_id:o}=e.mentioned_from,n=u.G.createChildStore(t,{table:s.iU,id:o});if(!n.isDefined())return;const r=n.getNavigableBlockStore();if(!r)return;return r.id===n.id?{backlinkStore:r,timestamp:n.getLastEditedTime()}:{backlinkStore:r,scrollToBlockId:n.id,timestamp:n.getLastEditedTime()}}if("alias"===e.mentioned_from.type||"transclusion_reference"===e.mentioned_from.type){const o=u.G.createChildStore(t,{table:s.iU,id:e.mentioned_from.pointer.id}),n=o.getNavigableBlockStore();if(!n)return;return{backlinkStore:n,scrollToBlockId:o.id,timestamp:n.getLastEditedTime()}}(0,p.t1)(e.mentioned_from)}(e,t)))),n=a.vM(o,(e=>{let{backlinkStore:t}=e;return t.id})),r=Object.values(n).map((e=>a.MR(e,(e=>e.discussionId?2:e.scrollToBlockId?1:0))[0]));return r.sort(((e,t)=>t.timestamp-e.timestamp)),r}function g(e,t){const{id:o}=t.currentUser;let a;if(o){const t=e.getRecordValue({table:d.KJ,id:o});t&&(a=(0,r.dp)(t))}const s=t.LocalBacklinkStore.getBacklinkState({blockId:e.id,currentUserId:t.currentUser.id}),l=n.Z.withListenerIgnored((()=>(0,i.sU)({actor:a,blockId:e.id,backlinks:s.backlinks,getRecordModel:e.getRecordModel})));return 0===l.length?{backlinks:[],inaccessibleBacklinkCount:s.inaccessibleBacklinkCount}:{backlinks:m(l,e),inaccessibleBacklinkCount:s.inaccessibleBacklinkCount}}},46888:(e,t,o)=>{o.d(t,{V:()=>a,c:()=>s});var n=o(73597),r=o(69645);function*i(e){const{blocks:t,includeOriginalBlocks:o,includeNonSelectableListContainer:i}=e;if(0===t.length)return;const a=(0,r.dq)({includeNonSelectableListContainer:i,root:t[0].getHighestContentBlockUIAncestor()});if(a)for(const s of t){const e=(0,r.Ib)(s,a);if(!e)continue;const t=(0,n.JK)(e);if(o||!t.next().done)for(const o of t)yield o.value.store}}function*a(e){for(const t of i({blocks:e,includeOriginalBlocks:!0,includeNonSelectableListContainer:!1})){const e=t.getTitleStore();e&&(yield e)}}function*s(e){yield*i({blocks:e,includeOriginalBlocks:!1,includeNonSelectableListContainer:!1})}},42:(e,t,o)=>{o.d(t,{Fr:()=>L,Jy:()=>B,S7:()=>E,UG:()=>j,W_:()=>w,Yu:()=>M,ZW:()=>N,_Z:()=>D,ax:()=>S,d6:()=>U,iC:()=>P,iD:()=>O,n_:()=>R,sU:()=>A,sw:()=>b});var n=o(30120),r=o(99036),i=o(80951),a=o(53877),s=o(42875),l=o(72126),c=o(4615),d=o(71644),p=o(45953),u=o(21202),m=o(6287),g=o(70203),h=o(97880),f=o(5366),y=o(33929);const v=(0,f.defineMessages)({addNewTodoTitle:{defaultMessage:"Add a new to-do",id:"blockTemplates.templateButton.addNewTodoTitle"}});function b(){return p.Ao.create({block:{root:{id:"root",version:27,type:"factory",properties:{title:[[y.default.formatMessage(v.addNewTodoTitle)]]},content:["to_do"]},to_do:{id:"to_do",version:4,type:"to_do",parent_table:"block",parent_id:"root",alive:!0}}})}function S(){return p.Ao.create({block:{root:{id:"root",version:0,type:"button",format:{automation_id:"automation"}}},automation:{automation:{id:"automation",parent_id:"root",parent_table:u.iU,alive:!0,status:"active",trigger:{id:(0,c.ZP)(),type:"button"},action_ids:[],properties:{name:""}}}})}const _=(0,f.defineMessages)({namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.table.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.table.tagsPropertyTitle"}});function w(e){const{isInline:t,name:o}=e,n=(0,d.ZP)();return p.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0}},collection_view:{view:{id:"view",version:0,type:"table",format:{collection_pointer:{table:m.v,id:"collection"},table_properties:[{property:"title",visible:!0,width:276},{property:n,visible:!0}],table_wrap:!0},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:o?(0,g.TPx)(o):void 0,schema:{title:{name:y.default.formatMessage(_.namePropertyTitle),type:"title"},[n]:{name:y.default.formatMessage(_.tagsPropertyTitle),type:"multi_select"}},format:{collection_page_properties:[{property:n,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}const k=(0,f.defineMessages)({viewTitle:{defaultMessage:"Board view",id:"blockTemplates.board.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.board.namePropertyTitle"},assignPropertyTitle:{defaultMessage:"Assign",id:"blockTemplates.board.assignPropertyTitle"},statusPropertyTitle:{defaultMessage:"Status",id:"blockTemplates.board.statusPropertyTitle"},statusPropertyRedOptionTitle:{defaultMessage:"Not started",id:"blockTemplates.board.statusPropertyRedOptionTitle"},statusPropertyYellowOptionTitle:{defaultMessage:"In progress",id:"blockTemplates.board.statusPropertyYellowOptionTitle"},statusPropertyGreenOptionTitle:{defaultMessage:"Completed",id:"blockTemplates.board.statusPropertyGreenOptionTitle"},card1Title:{defaultMessage:"Card 1",id:"blockTemplates.board.card1Title"},card2Title:{defaultMessage:"Card 2",id:"blockTemplates.board.card2Title"},card3Title:{defaultMessage:"Card 3",id:"blockTemplates.board.card3Title"}});const x=(0,f.defineMessages)({viewTitle:{defaultMessage:"Calendar view",id:"blockTemplates.calendar.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.calendar.namePropertyTitle"},datePropertyTitle:{defaultMessage:"Date",id:"blockTemplates.calendar.datePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.calendar.tagsPropertyTitle"}});const I=(0,f.defineMessages)({viewTitle:{defaultMessage:"Timeline view",id:"blockTemplates.timeline.viewTitle"},datePropertyTitle:{defaultMessage:"Date",id:"blockTemplates.timeline.datePropertyTitle"}});const C=(0,f.defineMessages)({viewTitle:{defaultMessage:"Gallery view",id:"blockTemplates.gallery.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.gallery.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.gallery.tagsPropertyTitle"},createdPropertyTitle:{defaultMessage:"Created",id:"blockTemplates.gallery.createdPropertyTitle"},page1Title:{defaultMessage:"Page 1",id:"blockTemplates.gallery.page1Title"},page2Title:{defaultMessage:"Page 2",id:"blockTemplates.gallery.page2Title"},page3Title:{defaultMessage:"Page 3",id:"blockTemplates.gallery.page3Title"},page1TodoTitle:{defaultMessage:"To-do",id:"blockTemplates.gallery.page1TodoTitle"},page1CompletedTodoTitle:{defaultMessage:"Completed To-do",id:"blockTemplates.gallery.page1CompletedTodoTitle"}});const T=(0,f.defineMessages)({viewTitle:{defaultMessage:"List view",id:"blockTemplates.list.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.list.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.list.tagsPropertyTitle"},createdPropertyTitle:{defaultMessage:"Created",id:"blockTemplates.list.createdPropertyTitle"},page1Title:{defaultMessage:"Page 1",id:"blockTemplates.list.page1Title"},page2Title:{defaultMessage:"Page 2",id:"blockTemplates.list.page2Title"},page3Title:{defaultMessage:"Page 3",id:"blockTemplates.list.page3Title"}});function M(e){const{environment:t,isInline:o,viewType:l,name:c}=e;return"table"===l?w({environment:t,isInline:o,name:c}):"board"===l?function(e){const{isInline:t,name:o}=e,n=(0,d.ZP)(),i=(0,d.ZP)();return p.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(k.card1Title)]]}},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(k.card2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(k.card3Title)]]}}},collection_view:{view:{id:"view",version:0,type:"board",name:y.default.formatMessage(k.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:m.v,id:"collection"},board_columns_by:{property:n,type:"status",groupBy:"group",sort:{type:"ascending"}},board_columns:[{property:n,value:{type:"status",value:{type:"by_group",group:"To-do"}}},{property:n,value:{type:"status",value:{type:"by_group",group:"In progress"}}},{property:n,value:{type:"status",value:{type:"by_group",group:"Complete"}}}],board_properties:[{property:n,visible:!1},{property:i,visible:!0}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:o?(0,g.TPx)(o):void 0,schema:{title:{name:y.default.formatMessage(k.namePropertyTitle),type:"title"},[i]:{name:y.default.formatMessage(k.assignPropertyTitle),type:"person"},[n]:(0,r.I4)(y.default.formatMessage(k.statusPropertyTitle))},format:{collection_page_properties:[{property:n,visible:!0},{property:i,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:o,name:c}):"calendar"===l?function(e){const{isInline:t,name:o}=e,n=(0,d.ZP)(),r=(0,d.ZP)();return p.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0}},collection_view:{view:{id:"view",version:0,type:"calendar",name:y.default.formatMessage(x.viewTitle),format:{collection_pointer:{table:m.v,id:"collection"}},query2:{calendar_by:n},parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:o?(0,g.TPx)(o):void 0,schema:{title:{name:y.default.formatMessage(x.namePropertyTitle),type:"title"},[n]:{name:y.default.formatMessage(x.datePropertyTitle),type:"date"},[r]:{name:y.default.formatMessage(x.tagsPropertyTitle),type:"multi_select"}},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:o,name:c}):"list"===l?function(e){const{isInline:t,name:o}=e,n=(0,d.ZP)(),r=(0,d.ZP)();return p.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(T.page1Title)]]}},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(T.page2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(T.page3Title)]]}}},collection_view:{view:{id:"view",version:0,type:"list",name:y.default.formatMessage(T.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:m.v,id:"collection"},list_properties:[{property:n,visible:!0}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:o?(0,g.TPx)(o):void 0,schema:{title:{name:y.default.formatMessage(T.namePropertyTitle),type:"title"},[n]:{name:y.default.formatMessage(T.tagsPropertyTitle),type:"multi_select",options:[]},[r]:{name:y.default.formatMessage(T.createdPropertyTitle),type:"created_time"}},format:{collection_page_properties:[{property:r,visible:!0},{property:n,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:o,name:c}):"gallery"===l?function(e){const{isInline:t,name:o}=e,n=(0,d.ZP)(),r=(0,d.ZP)();return p.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(C.page1Title)]]},content:["to_do_1","to_do_2"]},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(C.page2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(C.page3Title)]]}},to_do_1:{id:"to_do_1",type:"to_do",parent_id:"item_1",parent_table:"block",alive:!0,properties:{title:[[y.default.formatMessage(C.page1TodoTitle)]]}},to_do_2:{id:"to_do_2",type:"to_do",parent_id:"item_1",parent_table:"block",alive:!0,properties:{title:[[y.default.formatMessage(C.page1CompletedTodoTitle)]],checked:[["Yes"]]}}},collection_view:{view:{id:"view",version:0,type:"gallery",name:y.default.formatMessage(C.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:m.v,id:"collection"},gallery_cover:{type:"page_content"}},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:o?(0,g.TPx)(o):void 0,schema:{title:{name:y.default.formatMessage(C.namePropertyTitle),type:"title"},[n]:{name:y.default.formatMessage(C.tagsPropertyTitle),type:"multi_select",options:[]},[r]:{name:y.default.formatMessage(C.createdPropertyTitle),type:"created_time"}},format:{collection_page_properties:[{property:r,visible:!0},{property:n,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:o,name:c}):"timeline"===l?function(e){const{isInline:t,name:o}=e,r=(0,d.ZP)(),l=(0,d.ZP)(),c=(0,d.ZP)();return p.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[y.default.formatMessage(k.card1Title)]],[r]:(0,i.d7)((0,a.fZ)(n.ou.now().minus({days:5}).startOf("day").valueOf(),n.ou.now().minus({days:2}).startOf("day").valueOf(),(0,s.r)()))},alive:!0},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[y.default.formatMessage(k.card2Title)]],[r]:(0,i.d7)((0,a.fZ)(n.ou.now().minus({days:3}).startOf("day").valueOf(),n.ou.now().startOf("day").valueOf(),(0,s.r)()))},alive:!0},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[y.default.formatMessage(k.card3Title)]],[r]:(0,i.d7)((0,a.fZ)(n.ou.now().minus({days:1}).startOf("day").valueOf(),n.ou.now().plus({days:2}).startOf("day").valueOf(),(0,s.r)()))},alive:!0}},collection_view:{view:{id:"view",version:0,type:"timeline",name:y.default.formatMessage(I.viewTitle),format:{collection_pointer:{table:m.v,id:"collection"},timeline_show_table:!t,timeline_properties:[{property:"title",visible:!0}],timeline_table_properties:[{property:"title",visible:!0,width:280},{property:r,visible:!1,width:180},{property:l,visible:!1,width:180},{property:c,visible:!1,width:180}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:o?(0,g.TPx)(o):void 0,schema:{title:{name:y.default.formatMessage(k.namePropertyTitle),type:"title"},[r]:{name:y.default.formatMessage(I.datePropertyTitle),type:"date"},[l]:{name:y.default.formatMessage(k.assignPropertyTitle),type:"person"},[c]:{name:y.default.formatMessage(k.statusPropertyTitle),type:"select",options:[{id:"1",value:y.default.formatMessage(k.statusPropertyRedOptionTitle),color:"red"},{id:"2",value:y.default.formatMessage(k.statusPropertyYellowOptionTitle),color:"yellow"},{id:"3",value:y.default.formatMessage(k.statusPropertyGreenOptionTitle),color:"green"}]}},format:{collection_page_properties:[{property:r,visible:!0},{property:l,visible:!0},{property:c,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:o,name:c}):void("page"!==l&&(0,h.t1)(l))}function P(e){const{isInline:t,viewType:o}=e;return p.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",view_ids:["view"],alive:!0}},collection_view:{view:{id:"view",version:0,type:o,parent_id:"root",parent_table:"block",alive:!0}}})}function A(e){const{isInline:t,viewType:o,integrationId:n}=e;return p.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:m.v,id:"collection"}},view_ids:["view"],alive:!0}},collection:{collection:{id:"collection",name:void 0,schema:{},format:{is_placeholder:!0,integration_id:n},parent_id:"root",parent_table:"block",alive:!0}},collection_view:{view:{id:"view",version:0,type:o,format:{collection_pointer:{table:m.v,id:"collection"}},parent_id:"root",parent_table:"block",alive:!0}}})}function D(){return p.Ao.create({block:{root:{id:"root",type:"transclusion_container",content:["empty_text"],alive:!0},empty_text:{id:"empty_text",type:"text",parent_id:"root",parent_table:"block",alive:!0}}})}function B(e){return p.Ao.create({block:{root:{id:"root",type:"ai_block",content:[],alive:!0,format:{ai_prompt_key:e}}}})}function R(e){const t=l.DZ(e,(e=>`column${e+1}`));return p.Ao.create({block:{root:{id:"root",type:"column_list",content:t,alive:!0},...Object.assign({},...t.map((t=>{const o=`${t}_text`;return{[t]:{id:t,type:"column",parent_id:"root",parent_table:"block",content:[o],alive:!0,format:{column_ratio:1/e}},[o]:{id:o,type:"text",parent_id:t,parent_table:"block",alive:!0}}})))}})}function E(){const e=[(0,d.ZP)(),(0,d.ZP)()];return p.Ao.create({block:{root:{id:"root",type:"table",content:["row_1","row_2","row_3"],alive:!0,format:{table_block_column_order:e}},row_1:{id:"row_1",type:"table_row",parent_id:"root",parent_table:"block",alive:!0},row_2:{id:"row_2",type:"table_row",parent_id:"root",parent_table:"block",alive:!0},row_3:{id:"row_3",type:"table_row",parent_id:"root",parent_table:"block",alive:!0}}})}const F=(0,f.defineMessages)({tab1Title:{defaultMessage:"Tab 1",id:"blockTemplates.list.tab1Title"},tab2Title:{defaultMessage:"Tab 2",id:"blockTemplates.list.tab2Title"},tab3Title:{defaultMessage:"Tab 3",id:"blockTemplates.list.tab3Title"}});function N(){return p.Ao.create({block:{root:{id:"root",type:"tab",alive:!0,content:["tab1","tab2","tab3"]},tab1:{id:"tab1",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[y.default.formatMessage(F.tab1Title)]]}},tab2:{id:"tab2",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[y.default.formatMessage(F.tab2Title)]]}},tab3:{id:"tab3",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[y.default.formatMessage(F.tab3Title)]]}}}})}function j(e){return p.Ao.create({[u.iU]:{root:{id:"root",type:e,format:{toggleable:!0}}}})}function O(e,t){return p.Ao.create({[u.iU]:{root:{id:"root",type:"code",properties:{title:g.TPx(t),language:g.TPx(e)}}}})}function L(){return p.Ao.create({[u.iU]:{root:{id:"root",type:"drawing",format:{drawing_value:void 0,block_page_width:!0,block_height:480}}}})}function U(){return p.Ao.create({[u.iU]:{root:{id:"root",type:"ai_block",format:{ai_skill:{ai_show_skill_picker:!0,ai_skill_type:"meeting_summary"}}}}})}},43250:(e,t,o)=>{o.d(t,{$ji:()=>$t,A_D:()=>D,Apy:()=>io,Aur:()=>bt,B8p:()=>B,BEs:()=>we,BKn:()=>Ve,BaY:()=>ze,C18:()=>Ue,CBT:()=>Ke,CZG:()=>me,C_N:()=>Yt,Cjq:()=>pt,D$4:()=>ot,Dkf:()=>zt,EGJ:()=>Bt,Ep8:()=>y,F4o:()=>Te,FJA:()=>V,FLq:()=>ht,FoE:()=>pe,G6g:()=>ne,GNl:()=>z,GZn:()=>fo,GbT:()=>N,Gcz:()=>Pt,GfL:()=>W,HKr:()=>X,HwD:()=>Qt,I2F:()=>Q,I9j:()=>Qe,IAq:()=>yt,Iiy:()=>so,IpQ:()=>le,J2F:()=>St,JR_:()=>At,JUE:()=>Oe,JiD:()=>i,JkF:()=>ke,K3y:()=>F,K4T:()=>Nt,KA2:()=>Y,KLh:()=>E,LoZ:()=>oe,MD7:()=>R,MU2:()=>Pe,MV2:()=>ft,M_0:()=>ao,Mdu:()=>Le,Mfh:()=>ve,Mpz:()=>vt,MsS:()=>p,N7t:()=>de,NFf:()=>ue,Nn$:()=>f,No6:()=>x,OE$:()=>po,OK_:()=>m,Oau:()=>O,PBs:()=>h,QS0:()=>C,QSt:()=>n,Qcf:()=>w,Qgj:()=>lt,Quo:()=>c,RG3:()=>Re,RIA:()=>Kt,S94:()=>q,S9A:()=>go,TAd:()=>qe,TFu:()=>to,TYv:()=>Ze,Uhm:()=>dt,Uwd:()=>Ee,V6y:()=>kt,VMO:()=>Ct,Voi:()=>gt,Wh_:()=>I,Wiy:()=>T,Wy1:()=>ct,Xgx:()=>rt,Xj_:()=>u,Xsh:()=>Je,Y6l:()=>Ne,Y7r:()=>Ye,YHn:()=>G,YOJ:()=>yo,YPt:()=>b,Z87:()=>ut,ZHw:()=>P,ZmO:()=>K,Zp2:()=>eo,_so:()=>wt,a6i:()=>se,aL4:()=>Ae,afv:()=>H,aiP:()=>a,alX:()=>r,b_f:()=>U,blN:()=>Ie,c7X:()=>Rt,cFM:()=>et,dXl:()=>mo,euV:()=>k,exn:()=>ye,f0e:()=>ro,f8P:()=>re,fHd:()=>S,fOh:()=>uo,fe0:()=>_e,gGc:()=>$,gec:()=>at,gjL:()=>J,gug:()=>l,hEP:()=>oo,hKO:()=>ce,hzx:()=>ee,i25:()=>_t,irE:()=>jt,j35:()=>Me,jWx:()=>Fe,kDE:()=>Lt,kUP:()=>It,l24:()=>Ce,lIT:()=>M,lmr:()=>vo,mJW:()=>v,mSZ:()=>A,mWS:()=>Mt,myM:()=>nt,nM$:()=>Et,nU_:()=>ge,o4s:()=>Zt,oc0:()=>$e,ovr:()=>Ut,p0b:()=>j,p1Q:()=>_,p4m:()=>ie,pg$:()=>Xt,q1J:()=>xe,qnV:()=>lo,qr0:()=>We,qxR:()=>je,rG8:()=>Ge,rIE:()=>Be,rIj:()=>tt,rIs:()=>Jt,rKl:()=>s,rTm:()=>Ht,rVO:()=>Gt,rcG:()=>he,rli:()=>be,s$o:()=>Xe,sbt:()=>Ft,sqL:()=>Ot,srZ:()=>L,tQh:()=>Z,tfM:()=>xt,ulv:()=>ho,vvn:()=>mt,wFE:()=>te,wG0:()=>no,wKH:()=>g,wXs:()=>Dt,wnm:()=>it,x2W:()=>st,x4y:()=>d,x9t:()=>qt,xvU:()=>Wt,y4j:()=>co,yNE:()=>De,ykc:()=>fe,zYS:()=>Se,z_z:()=>Vt,zar:()=>He,zov:()=>ae,zwY:()=>Tt});const n="notion-cursor-default",r="hidden",i="notion-fadein",a="notion-mobile",s="notion-fadein-fast",l="notion-front-page",c="analytics-scroll-point",d="notion-login",p="notion-light-theme",u="notion-dark-theme",m="notion-scroller",g="vertical",h="horizontal",f="notion-history-modal",y="notion-block-resizer",v="notion-overlay-container",b="notion-default-overlay-container",S="notion-page-template-modal",_="notion-peek-renderer",w="notion-text-action-menu",k="notion-selectable",x="notion-selectable-halo",I="notion-focusable-within",C="notion-page-content",T="notion-frame",M="notion-topbar",P="notion-topbar-mobile",A="notion-topbar-more-button",D="notion-topbar-action-buttons",B="notion-share-menu",R="notion-topbar-share-menu",E="notion-updates-menu",F="notion-topbar-updates-button",N="notion-topbar-favorite-button",j="notion-topbar-comments-button",O="notion-search-menu",L="notion-embed-menu",U="notion-unfurling-menu",Z="notion-media-menu",V="notion-invite",q="notion-record-icon",z="notion-calendar-header-days",W="notion-board-group",H="notion-block-permission-settings-workspace-access",G="notion-block-permission-settings-team-access",K="notion-block-permission-settings-team-access",$="notion-block-permission-settings-group-access",Y="notion-page-view-discussion",Q="notion-updates-button-mentions",J="notion-updates-button-all-updates",X="notion-updates-button-archive",ee="notion-discussion-input-edit-existing-comment",te="notion-discussion-input",oe="notion-discussion-reply-menu",ne="notion-comment-overflow-menu",re="notion-shimmer",ie="notion-link",ae="ai-block",se="notion-sharing-permission-role-select",le="notion-sharing-permission-expiration-timestamp",ce="notion-language-picker",de="notion-cookie-selector",pe="notion-activity-section-icon",ue="notion-activity-section-header",me="notion-activity-section-time",ge="notion-activity-section-children",he="notion-sidebar",fe="notion-sidebar-mobile",ye="notion-open-sidebar",ve="notion-close-sidebar",be="notion-sidebar-switcher",Se="notion-space-settings",_e="notion-outliner-bookmarks",we="notion-outliner-workspace",ke="notion-outliner-shared",xe="notion-outliner-private",Ie="notion-outliner-offline",Ce="notion-outliner-team",Te="notion-outliner-bookmarks-header",Me="notion-outliner-workspace-header",Pe="notion-outliner-shared-header",Ae="notion-outliner-private-header",De="notion-outliner-offline-header",Be="notion-outliner-team-header",Re="notion-outliner-joined-team-header",Ee="notion-outliner-unjoined-team-header",Fe="notion-outliner-search-team-header",Ne="notion-outliner-public-page-template-includes-header",je="notion-outliner-team-context-menu-button",Oe="notion-outliner-team-heading-context-menu-button",Le="notion-outliner-team-context-menu",Ue="notion-updates-menu",Ze="notion-sidebar-trash-menu",Ve="notion-password-modal",qe="notion-scim-table-revoke-button",ze="notion-subscription-checkout-title",We="notion-subscription-checkout-description",He="notion-update-sidebar",Ge="notion-update-sidebar-tab-comments-segmented-control",Ke="notion-update-sidebar-tab-comments-dropdown-control",$e="notion-update-sidebar-tab-comments-dropdown-button-open",Ye="notion-update-sidebar-tab-comments-dropdown-button-resolved",Qe="notion-update-sidebar-tab-comments-header",Je="notion-update-sidebar-tab-comments-comments-scroller",Xe="notion-update-sidebar-tab-comments-discussion-item",et="notion-update-sidebar-tab-updates-header",tt="notion-team-settings-modal",ot="notion-add-members-modal",nt="notion-new-team",rt="notion-use-case-onboarding-profile",it="notion-use-case-onboarding-persona-survey",at="notion-workspace-choose",st="notion-workspace-plan-choose",lt="notion-workspace-create",ct="notion-workspace-invite",dt="notion-onboarding-error",pt="notion-onboarding-popup",ut="notion-onboarding-button",mt="notion-onboarding-plan-type-personal",gt="notion-onboarding-plan-type-team",ht="notion-onboarding-plan-type-school",ft="notion-onboarding-app-download",yt="notion-onboarding-persona-survey-persona",vt="notion-onboarding-persona-survey-role",bt="notion-onboarding-persona-survey-companysize",St="notion-onboarding-persona-survey-usecases",_t="notion-onboarding-timed-trial-upsell",wt="notion-table-view",kt="notion-table-view-add-column",xt="notion-table-view-add-row",It="notion-table-view-header-row",Ct="notion-table-view-header-cell",Tt="notion-table-view-row",Mt="notion-table-view-cell",Pt="notion-table-view-empty-placeholder",At="notion-table-view-drag-and-fill-handle",Dt="notion-table-view-frozen-column-repositioner",Bt="notion-board-view",Rt="notion-calendar-view",Et="notion-list-view",Ft="notion-gallery-view",Nt="notion-collection-item",jt="notion-calendar-view-day",Ot="notion-collection-view-item-add",Lt="notion-timeline-view",Ut="notion-timeline-item",Zt="notion-timeline-item-row",Vt="notion-timeline-item-properties",qt="notion-collection-view-body",zt="notion-view-settings-sidebar",Wt="notion-collection-edit-view",Ht="notion-collection-view-tab-button",Gt="notion-collection-add-view",Kt="notion-collection-automation-edit-view",$t="notion-template-picker-item",Yt="notion-template-picker-item-action-menu",Qt="draggable-ghost-section",Jt="developer-integrations-container",Xt="developer-integrations-list",eo="developer-integration-create",to="developer-integration-view",oo="developer-integration-lab",no="developer-integration-not-found",ro="notion-table-row-selector",io="notion-table-column-selector",ao="notion-table-row",so="notion-table-cell",lo="notion-table-cell-text",co="notion-table-selection-overlay",po="notion-table-tbody-selectable",uo="notion-table-content",mo="notion-temporary-comment",go="notion-margin-discussion-item",ho="search-query-result-item",fo="search-result-mobile-body-scroller",yo="notion-completions-feedback-popup",vo="notion-help-button"},47853:(e,t,o)=>{o.d(t,{D:()=>i});var n=o(13991),r=o(25666);function i(e){return r.D(e,n.SP)}},57254:(e,t,o)=>{o.d(t,{A:()=>s,S:()=>l});o(21703);var n=o(94568),r=o(97880),i=o(80444),a=o(98165);function s(){const{mainEditorCurrentBlockStore:e}=i.default.state;if(!e)throw new Error("No current block store");const t=(0,a.qA)(e);return Boolean(t.find((e=>e.id===n.TM||e.id===n.y3)))}function l(e){return"assistantChat"===e.type?1===e.operations.length&&"createBlock"===e.operations[0].command&&"text"===e.operations[0].blockNode.tagName&&0===e.operations[0].blockNode.text.length:"assistantChatText"===e.type?0===e.text.length:void(0,r.t1)(e)}},30912:(e,t,o)=>{o.d(t,{pZ:()=>T,Gb:()=>D,PN:()=>M,Rr:()=>F,pt:()=>P,uV:()=>R,$5:()=>E,td:()=>B});var n=o(14577),r=o(83372),i=o(81730),a=o(94412),s=(o(57658),o(3865)),l=o(77492),c=o(72126),d=o(97880);function*p(e){const{permissions:t,typecheckContextValues:o}=e,n=[];for(const r of t)if("record_permission"===r.type)n.push((0,c.Xh)(r));else if("collection_default_template_record_permission"===r.type){const e=yield*l.R.fetchRecord(r.pointer),t=null==e?void 0:e.getDefaultTemplatePagePointer();(0,d.$K)(t)&&n.push({minimumRole:r.minimumRole,pointer:t,type:"record_permission"})}else if("formula_value_permission"===r.type){const e=(0,s.rX)({formulaValueTypes:o,minimumRole:r.minimumRole,targetId:r.id});e.length>0&&n.push(...e)}else(0,d.t1)(r);return n}const{sync:u,async:m}=l.R.makeRunners(p);var g=o(10450),h=o(78106),f=o(149);const{sync:y,async:v}=l.R.makeRunners((function*(e){const{actionModels:t,automationModel:o}=e,n={valueTypes:e.valueTypes,actionInputValueTypes:{},actionValidationFailures:{}};for(const i of t){const t=(0,r.z)(i.getType()),a=t.getDependencies({automationModel:o},i),s=yield*p({permissions:a,typecheckContextValues:n.valueTypes});yield*l.R.fetchRecords(s.map((e=>e.pointer)));const d=t.typecheck(e,i),u=c.d9(n.valueTypes);if(n.actionInputValueTypes[i.id]=u,f.x.isFail(d))return d;for(const e of d.value.valueTypes??[]){n.valueTypes.some((t=>(0,h.Fl)(e,t)))||n.valueTypes.push(e)}d.value.validationFailures&&(n.actionValidationFailures[i.id]=d.value.validationFailures)}return{value:n}}));var b=o(1274),S=o(42875),_=o(59753),w=o(26825),k=o(98963),x=o(77080),I=o(35661),C=o(35057);const T=30;function M(){return x.default.checkGate("button_property")}function P(e){const{context:t}=e;let o,n,r;if(t.persisted){const{automationStore:r}=t,a=e.automationValue??r.getValue();if(!a)return{error:new i.MO("Missing automation record")};o=_.kk.fromValue(k.cv,a),n=r.getActionStores().map((e=>e.getModel())).filter(d.$K)}else o=new a.X({triggerType:"button",actions:t.actions,parentPointer:t.parentPointer,spaceId:t.parentPointer.spaceId}),n=t.actions.map((e=>new a.e(e,t.parentPointer.spaceId)));if("button_property"===t.type){const e=t.collectionContextStore.collectionStore();if(!e)return{error:new i.MO("Missing collectionContextStore")};r=(0,g.zW)({collectionPointer:{...e.pointer,spaceId:e.getSpaceId()},intl:t.intl})}else if("button_block"===t.type){const e=t.pageStore.getAssociatedCollectionStore();r=(0,g.rb)({intl:t.intl,collectionPointer:e?{...e.pointer,spaceId:e.getSpaceId()}:void 0})}else"structured_automation"===t.type?r={value:{valueTypes:[]}}:"event"===t.type?r=(0,g.E$)({collectionPointer:t.parentPointer,intl:t.intl}):(0,d.t1)(t);return f.x.isFail(r)?r:y({automationModel:o,actionModels:n,handleDataRequest:(0,h.yf)(t.parentRecordStore.getRecordModel,t.parentRecordStore.loadRecordModel),valueTypes:r.value.valueTypes??[],intl:t.intl,getRecordModel:t.parentRecordStore.getRecordModel,userTimeZone:(0,S.r)()})}const A=new WeakMap;function D(e){const t=A.get(e.automationStore);if(t)return t;{const t=new n.Z((()=>function(e){if(("button_block"===e.type||"button_property"===e.type)&&!e.currentUserId)return{executionPermissionStatus:"insufficient",typecheckResult:void 0};const t=e.automationStore.getModel();if(!t)return{executionPermissionStatus:"unknown",typecheckResult:void 0};const o=e.automationStore.getActionStores().map((e=>e.getModel()));if(!o.every((0,d.AO)((e=>(0,d.$K)(e)?{true:e}:{false:e}))))return{executionPermissionStatus:"insufficient",typecheckResult:void 0};const n=P({context:e});if(f.x.isFail(n))return{executionPermissionStatus:"unknown",typecheckResult:n};const i={automationModel:t};for(const a of o){const t=(0,r.z)(a.getType()).getDependencies(i,a),o=u({getRecordModel:e.parentRecordStore.getRecordModel,permissions:t,typecheckContextValues:n.value.valueTypes});for(const r of o){const t=(0,I.Kv)(e.parentRecordStore,r.pointer).getRole();if(!t||(0,w.gr)(t,r.minimumRole))return{executionPermissionStatus:"insufficient",typecheckResult:n}}}return{executionPermissionStatus:"sufficient",typecheckResult:n}}(e)),{debugName:"buttonAutomationAnalysisCachedStore"});return A.set(e.automationStore,t),t}}function B(e){return Boolean(e.findRecordStoreUIAncestor((e=>e instanceof I.zq&&e.isType("duplicate_blocks"))).ancestor)}function R(e,t){const o=e.getModel(),n=e.getActionStores(),r=n.filter((e=>e.isDefined())).map((e=>e.getModel())).filter(d.$K);if(o&&r.length===n.length)return{checkExperimentGate:e=>Promise.resolve(x.default.checkGate(e)),checkSubscribed:()=>Promise.resolve((0,C.sX)()),automation:o,automationActions:r,contextType:t,checkType:"canAddAction"}}function E(e){if(!e)return{editPermissionStatus:"unknown",reason:"missing_automation_context"};const{automationStore:t}=e,o=t.getValue(),n=t.getModel();if(!n||!o)return{editPermissionStatus:"unknown",reason:"missing_automation_model"};const i=t.getActionStores().map((e=>e.getModel()));if(!i.every((0,d.AO)((e=>(0,d.$K)(e)?{true:e}:{false:e}))))return{editPermissionStatus:"unknown",reason:"missing_automation_action_model"};const a=P({context:e});if(f.x.isFail(a))return{editPermissionStatus:"unknown",reason:"typecheck_error"};const s=i.length>0&&i.some((e=>!e.isType("slack_notification")));if(n.isType("event")&&s&&!(0,C.sX)())return{editPermissionStatus:"insufficient",reason:"free_workspace"};const l={automationModel:n},c=i.filter((e=>e.isType("slack_notification")));for(const d of c){const t=(0,r.z)(d.getType()).getDependencies(l,d),o=u({getRecordModel:e.parentRecordStore.getRecordModel,permissions:t,typecheckContextValues:a.value.valueTypes});for(const n of o){const t=(0,I.Kv)(e.parentRecordStore,n.pointer).getRole();if(!t||(0,w.gr)(t,n.minimumRole))return{actionId:d.id,editPermissionStatus:"insufficient",reason:"missing_permissions"}}}const p=(0,b.fz)({automationValue:o,actionValues:t.getActionStores().map((e=>({config:e.getConfig(),type:e.getType()})))});for(const r of p){const e=t.getRecordRole(r.pointer);if(!e||(0,w.gr)(e,r.minimumRequiredRole))return{editPermissionStatus:"insufficient",reason:"missing_permissions"}}return{editPermissionStatus:"sufficient"}}function F(e){const{device:t}=e.environment;return!(t.isIOS&&t.isMobileNative)}},97004:(e,t,o)=>{o.d(t,{CN:()=>I,Gz:()=>x,H_:()=>f,Me:()=>w,Mj:()=>_,Nq:()=>b,Pi:()=>k,RL:()=>y,Zh:()=>v,m1:()=>T,qd:()=>h,rQ:()=>C,yU:()=>S});o(57658);var n=o(76205),r=o(99036),i=o(43690),a=o(53504),s=o(93824),l=o(42875),c=o(72126),d=o(97880),p=o(28020),u=o(93959),m=o(17335),g=o(33929);function h(e){const{schema:t,filters:o,getRecordModel:r}=e,i=[];for(const n of Object.keys(t)){const e=f({property:n,schema:t,getRecordModel:r});e&&i.push(e)}const a=i.filter((e=>!o.find((t=>(0,n.aN)(t.filter)&&t.filter.property===e.property))));return c.MR(a,(e=>{const o=t[e.property];return(null==o?void 0:o.name)||""}))}function f(e){const{property:t,schema:o,getRecordModel:r}=e,i=(0,m.zZ)({property:t,schema:o,getRecordModel:r});if((0,n.a_)(i)?!(0,n.mv)(i.subfilter):!(0,n.mv)(i))return{property:t,filter:i}}function y(e){var t;const{collectionContextStore:o,applySubitemFilter:i}=e,a=o.currentPropertyFiltersStore.state,s=o.currentCombinatorFilterStore.state,l=i&&o.currentSubitemFormatStore.state,d=o.normalizedSchemaStore.state,p=l&&d[l.property],u=p&&"relation"===p.type&&(0,r.F0)(p)===(null===(t=o.collectionStore())||void 0===t?void 0:t.id)&&p.property,m=u?{property:u,filter:{operator:"is_empty"}}:void 0,g=(0,n.OH)({propertyFilters:a,combinatorFilter:s,schema:d});return c.oA([m,...g])}function v(e,t){var o,r;const l=e.collectionViewStore();if(!l)return{combinatorFilter:void 0,filters:{moveOps:[],removed:[],updated:[],moved:[],added:[]},sorts:void 0};const d="persisted"===t?l.getQueryStore().getKeyStore("sort").getValue()||[]:(null===(o=e.normalizedQueryStore.state)||void 0===o?void 0:o.sort)||[],p=e.currentSortsStore.state,u="persisted"===t?l.getQueryStore().getKeyStore("filter").getValue():null===(r=e.normalizedQueryStore.state)||void 0===r?void 0:r.filter,m=e.currentCombinatorFilterStore.state,g="persisted"===t?l.getPropertyFiltersStore().getValue()||[]:function(e){const t=e.normalizedSchemaStore.state,o=e.normalizedFormatStore.state.property_filters||[];return c.oA(o.filter((o=>{const r=(0,i.dN)(o.filter,t),a=e.collectionViewBlockStore();if(t[o.filter.property]&&r&&(0,n.J5)(t,o.filter.property,r.filter,null==a?void 0:a.getRecordModel))return r&&{id:o.id,filter:r}})))}(e),h=e.currentPropertyFiltersStore.state,f=g.map((e=>e.id)),y=h.map((e=>e.id)),{beforeOps:v,removeOps:b}=(0,s.q)(f,y),S=Array.from(b).filter((e=>!y.includes(e))),_=Object.keys(v).map((e=>({id:e,beforeId:v[e]}))),w=_.filter((e=>{let{id:t}=e;return f.includes(t)})).map((e=>{let{id:t}=e;return t})),k=_.filter((e=>{let{id:t}=e;return!f.includes(t)})).map((e=>{let{id:t}=e;return t})),x=h.filter((e=>g.find((t=>{if(e.id!==t.id)return!1;const o=c.Xh(t),n=c.Xh(e);return!c.Xy((0,a.Z)(n,"ignore-class-instances"),(0,a.Z)(o,"ignore-class-instances"))})))).map((e=>e.id));return{combinatorFilter:c.Xy(u,m)?void 0:{value:m},filters:{moveOps:_,removed:S,updated:x,moved:w,added:k},sorts:c.Xy(d,p)?void 0:{value:p}}}function b(e){const t=e.localStateDiffStore.state;return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter||void 0!==t.sorts)}function S(e){const t=e.localStateDiffStore.state;return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter)}function _(e){const t=e.localStateDiffStore.state;return Boolean(void 0!==t.sorts)}function w(e){return{property:(0,r.uS)(e),filter:{operator:"string_contains",value:{type:"exact",value:void 0}}}}function k(e){const t=e.currentCombinatorFilterStore.state,o=e.currentPropertyFiltersStore.state.filter((e=>!(0,u.EE)(e.id))).map((e=>e.filter)),n=[...(null==t?void 0:t.filters)||[],...o];return{...t,filters:n,operator:"and"}}function x(e,t){const o=e.currentCombinatorFilterStore.state,n=e.currentPropertyFiltersStore.state.filter((e=>e.id!==t.id)),r=[...(null==o?void 0:o.filters)||[],t.filter];return{combinatorFilter:{operator:"and",...o,filters:r},propertyFilters:n}}function I(e,t,o,n){let r=o.filter((e=>"is_group"===e.type)).map((t=>e.find((e=>e.name===t.value)))).filter(d.$K),i=o.filter((e=>"is_option"===e.type)).map((e=>t.find((t=>t.value===e.value)))).filter(d.$K);for(const a of e){const e=a.optionIds??[];if(r.some((e=>e.id===a.id)))i=i.filter((t=>!e.includes(t.id)));else if(e.length>0){const t=i.filter((t=>!e.includes(t.id)));t.length+e.length===i.length&&(i=t,r=[...r,a])}}if("is_option"===n.type){const o=t.find((e=>e.value===n.value));if(!o)return;const a=i.filter((e=>e.id!==o.id));if(a.length<i.length)i=a;else{const n=e.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(o.id)})),a=r.find((e=>e.id===(null==n?void 0:n.id)));if(a){const e=t.filter((e=>{var t;return(null===(t=a.optionIds)||void 0===t?void 0:t.includes(e.id))&&e.id!==o.id}));r=r.filter((e=>e.id!==a.id)),i=[...i,...e]}else{i=[...i,o];const e=(null==n?void 0:n.optionIds)??[];if(n&&e.length>0){const t=i.filter((t=>!e.includes(t.id)));t.length+e.length===i.length&&(i=t,r=[...r,n])}}}}else if("is_group"===n.type){const t=e.find((e=>e.name===n.value));if(!t)return;const o=r.filter((e=>e.id!==t.id));if(o.length<r.length)r=o;else{const e=t.optionIds??[];r=[...r,t],i=i.filter((t=>!e.includes(t.id)))}}else(0,d.t1)(n.type);return[...r.map((e=>({type:"is_group",value:e.name}))),...i.map((e=>({type:"is_option",value:e.value})))]}function C(e){const{group:t,options:o,filterValues:n}=e,r=n.some((e=>"is_group"===e.type&&e.value===t.name)),i=o.filter((e=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)})),a=new Map;for(const d of i){const e=n.some((e=>"is_option"===e.type&&e.value===d.value))||r;a.set(d.id,e)}const s=Array.from(a.values()),l=s.some((e=>e)),c=s.every((e=>e))&&s.length>0;return{groupCheckState:!(!r&&!c)||!!l&&"partial",optionCheckedInfo:a}}function T(e){const{collectionContextStore:t,environment:o}=e,r=t.relativeVariableStore.state,i=t.currentPropertyFiltersStore.state,a=t.currentCombinatorFilterStore.state,s=i.filter((e=>!(0,n.Oo)(e.filter))).map((e=>e.filter));if(0===s.length&&!a)return;const c={schema:t.normalizedSchemaStore.state,userId:o.currentUser.id,userTimeZone:(0,l.r)(),userStartOfWeek:p.AK.state,intl:g.default.getIntl(),relativeVariableResult:r};return{filter:{filters:a?[...s,a]:s,operator:"and"},context:c}}},4708:(e,t,o)=>{o.d(t,{A3:()=>_,B9:()=>w,C$:()=>x,CY:()=>k,En:()=>P,F$:()=>v,GH:()=>N,Lm:()=>f,Or:()=>m,Rv:()=>g,Ye:()=>u,_6:()=>d,fJ:()=>C,fW:()=>R,g4:()=>B,gp:()=>h,kG:()=>T,p1:()=>p,s$:()=>S,s2:()=>M,u3:()=>b,uD:()=>I,uX:()=>j,wd:()=>F,yq:()=>E,zq:()=>y});var n=o(13991),r=(o(95477),o(77080)),i=o(88893),a=o(35057),s=o(93827),l=o(38755),c=o(95697);function d(e){return!e.device.isMobile&&"on"===r.default.getEligibleGroup({experimentId:"contextual-invite-on-select-focus",defaultGroup:"control"})}function p(){return i.ye()&&"on"===r.default.getEligibleGroup({experimentId:"request_membership",defaultGroup:"control"})}function u(e){return i.ye()&&"on"===r.default.getEligibleGroup({experimentId:"guest_membership_request",defaultGroup:"control"})}function m(){return S()}function g(){return(0,a.Mk)()&&"on"===r.default.getEligibleGroup({experimentId:"import_slack_contacts",defaultGroup:"control"})}function h(e){let{currentSpaceStore:t}=e;return!!(0,l.Q9)(t)&&"on"===r.default.getEligibleGroup({experimentId:"share_modal_placeholder",defaultGroup:"control"})}function f(){return r.default.checkGate("share_modal_invalid_invite_tokens")}function y(e){return!e.device.isMobile}function v(){return(0,c.bq)()&&"on"===r.default.getEligibleGroup({experimentId:"teamspace_guests",defaultGroup:"control"})}function b(){return(0,c.bq)()&&"on"===r.default.getEligibleGroup({experimentId:"teams_invite_link",defaultGroup:"control"})}function S(){return(0,c.bq)()&&"on"===r.default.getEligibleGroup({experimentId:"team_invite_link_ms2",defaultGroup:"control"})}function _(){return r.default.checkGate("drawing_block")}function w(){return r.default.checkGate("team_add_app_template_tooltip")}function k(e){return"en-US"!==n.SP||e?"control":r.default.getEligibleGroup({experimentId:"onboarding_invite_skip_button",defaultGroup:"control"})}function x(){return"on"===r.default.getEligibleGroup({experimentId:"full_access_privacy_selector",defaultGroup:"control"})}function I(){return r.default.getEligibleGroup({experimentId:"share_modal_autofill_email",defaultGroup:"control"})}function C(){return"on"===r.default.getEligibleGroup({experimentId:"share_modal_pending_invite_status_ui",defaultGroup:"control"})}function T(e){if(!(0,l.Fn)(e))return"control";return(0,c.$)(e)?"control":r.default.getEligibleGroup({experimentId:"share_modal_guest_member_confirmation",defaultGroup:"control"})??"control"}function M(){return r.default.checkGate("in_app_template_gallery")}function P(){return!1}function A(e,t){const{device:o}=e,{spaceStore:n}=t,r=n.getSubscriptionTier();return"business"!==r&&"enterprise"!==r&&!o.isMobile}function D(e){return r.default.getEligibleGroup({experimentId:"persona_survey_joiner",defaultGroup:"control"})}function B(e,t){return!!A(e,t)&&"banner_with_survey"===D()}function R(e,t){return!!A(e,t)&&["banner_with_survey","banner_only"].includes(D())}function E(){return"on"===r.default.getEligibleGroup({experimentId:"random_house",defaultGroup:"control"})}function F(){return r.default.checkGate("guest_invite_requests")}function N(){return Boolean((0,s.C)()&&"on"===r.default.getEligibleGroup({experimentId:"public_page_template_sidebar",defaultGroup:"control"}))}function j(e){return Boolean((null==e?void 0:e.template)&&N())}},14976:(e,t,o)=>{o.d(t,{Dn:()=>oe,Gj:()=>le,IY:()=>z,Ob:()=>me,PY:()=>pe,Qb:()=>J,Rl:()=>he,SD:()=>ne,So:()=>ge,TQ:()=>ye,Ut:()=>X,We:()=>ve,Xh:()=>W,bD:()=>q,cD:()=>ce,fm:()=>de,kV:()=>ae,li:()=>re,lw:()=>ee,n$:()=>Y,vO:()=>ie,x9:()=>Q,xX:()=>ue});var n=o(22377),r=o(15095),i=o(42875),a=o(72126),s=o(82883),l=o(21202),c=o(70203),d=o(44805),p=o(63143),u=o(97444),m=o(32741),g=o(48514),h=o(95477),f=o(24990),y=o(33929),v=o(68056),b=o(77080),S=o(30874),_=o(35661),w=o(24666),k=o(46150),x=o(41056),I=o(62619),C=o(83631),T=o(45162),M=o(70219),P=o(65598),A=o(31352),D=o(89224);function B(e){return I.kK(e)&&e.classList.contains(d.Eu)}function R(e){return I.kK(e)&&e.classList.contains(d.tL)}function E(e){return function(e){const t=I.sh(e,(e=>(0,C.Xu)(e)||(0,k.eD)(e)));if(t&&B(t))return t}(e)||N(e)||function(e){const t=I.sh(e,(e=>R(e)||(0,k.eD)(e)));if(t&&R(t))return t}(e)}function F(e){return I.kK(e)&&e.classList.contains(n.P)}function N(e){const t=I.sh(e,(e=>(0,C.Xu)(e)||(0,k.eD)(e)));if(t&&(0,C.Xu)(t))return t}const j=function(e){return I.kK(e)&&e.classList.contains(d.mb)},O=function(e){if(j(e))return!0;try{return j(e.parentNode)}catch(t){return!1}},L=function(e){try{const t=I.sh(e,(e=>Boolean(e.getAttribute&&e.getAttribute("contenteditable"))||(0,k.eD)(e)));return t&&t.isContentEditable}catch(t){return!1}};function U(e){return I.kK(e)&&e.classList.contains(d.$A)}function Z(e,t){if(e===t.container){if(I.Gs(e)){const o=e.textContent||"";return(0,r.p4)(o.substring(0,t.offset)).length}{const o=Array.from(e.childNodes).slice(0,t.offset).map((e=>K(H(e)))).join("");return(0,r.p4)(o).length}}let o=0;for(const n of Array.from(e.childNodes)){if(n.contains(t.container))return o+Z(n,t);o+=(0,r.p4)(K(H(n))).length}return o}function V(e,t){const o=(0,k.X1)(e);if(!o)return 0;return Z(o,function(e,t){const o=E(e);if(o){const e=o.parentNode,n=Array.from(e.childNodes).indexOf(o);return{container:e,offset:0===t?n:n+1}}if(j(e)||j(e.parentNode))return{container:e,offset:(e.textContent||" ").length-1};return{container:e,offset:t}}(e,t))}function q(e,t){if(0===t)return!(e.childNodes.length>0)||B(e.childNodes[0])||F(e.childNodes[0])||(0,C.Xu)(e.childNodes[0])||R(e.childNodes[0])||U(e.childNodes[0])?{container:e,offset:0}:{container:e.childNodes[0],offset:0};const o=a.cx(e.childNodes,U),n=o>=0?o-1:e.childNodes.length-1;let i=t;for(let s=0;s<=n;s++){const t=e.childNodes[s],o=K(H(t)),l=(0,r.p4)(o).length;if(s===n?i-l<=0:i-l<0){if(B(t)||(0,C.Xu)(t)||F(t)||j(t)||R(t)){const e=I.oG(t.parentNode,t);return{container:t.parentNode,offset:e}}if(t.nodeType===Node.TEXT_NODE){return{container:t,offset:a.tP((0,r.p4)(o),0,i).join("").length}}return q(t,i)}i-=l}return{container:e,offset:0}}function z(e){const{environment:t,textValue:o,parentStore:n,disableHover:r,disableStyleAnnotations:a,disableDateStyleAnnotations:s,disabled:l,emojiType:c,highlightDiscussionId:p,renderedPageBlockId:u,parentBlockId:m,theme:g,katex:v,disableLinks:_,formulaValueTypes:w,useExperimentalLinksToNonPageBlocks:k,stopLinkPropagation:I,linkTargetBlank:C}=e,{device:T,currentUser:P}=t,A=b.default.checkGate("enable_deleted_page_indicator");return d.IY({textValue:o,getRecordModel:n.getRecordModel,getRecordRole:n.getRecordRole,disableHover:r,disableStyleAnnotations:a,disableDateStyleAnnotations:s,disableLinks:_||!1,userTimeZone:(0,i.r)(),disabled:l,isAndroid:T.isAndroid,isSafariOrIOS:T.isSafari||T.isIOS,isWindows:T.isWindows,showEmojiInline:T.isWindows,emojiType:c,highlightDiscussionId:p,theme:g,intl:y.default.getIntl(),renderedPageBlockId:u,parentBlockId:m,katex:v,isClient:!0,baseUrl:h.default.domainBaseUrl,publicDomainName:h.default.publicDomainName,currentUserId:P.id,overwriteBaseUrlFromSpaceId:(0,M.b)(t),externalIntegrations:S.Z.integrations.state,formulaValueTypes:w,enableDeletedPageIndicator:A,useExperimentalLinksToNonPageBlocks:k,stopLinkPropagation:I,linkTargetBlank:C,emojiData:f.Z.state,getToday:x.H})}const W=function(e,t){return(0,s.X)({textValue:e,getRecordModel:t.getRecordModel,userTimeZone:(0,i.r)(),intl:y.default.getIntl()})};function H(e){let t="";if(B(e))t+=c.qyI;else if((0,C.Xu)(e))t=c.fuX;else if(F(e))t+=e.alt;else if(function(e){return I.kK(e)&&"br"===e.tagName.toLowerCase()}(e))t+="\n";else if(I.Gs(e))t+=e.textContent;else if(R(e));else for(const o of Array.from(e.childNodes))t+=H(o);return t}const G=new RegExp(d.U3,"g");function K(e){return e.replace(G,"")}const $={[c.qyI]:{deleteEndToken:new RegExp(`${c.qyI}$`,"g"),deleteToken:new RegExp(`(${c.qyI})([^${d.U3}])`,"g"),existingToken:new RegExp(`${c.qyI}${d.U3}`,"g")},[c.fuX]:{deleteEndToken:new RegExp(`${c.fuX}$`,"g"),deleteToken:new RegExp(`(${c.fuX})([^${d.U3}])`,"g"),existingToken:new RegExp(`${c.fuX}${d.U3}`,"g")}};function Y(e,t){if(!t)return"";let o=H(t);if(e.device.isAndroid)for(const[n,r]of Object.entries($))o=o.replace(r.deleteEndToken,"").replace(r.deleteToken,"$2").replace(r.existingToken,n);return"\n"===o[o.length-1]&&(o=o.substring(0,o.length-1)),o}function Q(e,t,o){if(!e)return!1;let n=o,r=t;for(;r!==e&&!U(r);){const{parentNode:e}=r;if(!e)break;n=I.oG(e,r),r=e}if(U(r))return n>0;const i=a.cx(e.childNodes,U);return!(i<0)&&(r===e&&n>i)}function J(e,t){const o=(0,k.X1)(e);if(!o)return;const n=V(e,t),r=E(e);return{index:n,forceEmit:Boolean(r),afterEndOfLine:Q(o,e,t)}}function X(e,t){if(t||(t=D.get()),t){const e=V(t.startContainer,t.startOffset),o=V(t.endContainer,t.endOffset),n=E(t.startContainer)||E(t.endContainer);return{selection:{startIndex:e,endIndex:o},forceEmitSelectionStore:Boolean(n)}}}function ee(e,t,o){const n=q(e,t),r=q(e,o);return D.rangeFromContainerOffsets({start:n,end:r})}function te(e,t,o,n){if(e===o&&t===n)return!0;if(O(e)!==O(o))return!1;if(N(e)!==N(o))return!1;const r=(0,k.X1)(e),i=(0,k.X1)(o);if(r!==i)return!1;if(V(e,t)!==V(o,n))return!1;return Q(r,e,t)===Q(i,o,n)}function oe(e,t){return!e&&!t||!(!e||!t)&&(e.startOffset===t.startOffset&&e.endOffset===t.endOffset&&e.startContainer===t.startContainer&&e.endContainer===t.endContainer||L(e.startContainer)&&L(t.startContainer)&&te(e.startContainer,e.startOffset,t.startContainer,t.startOffset)&&te(e.endContainer,e.endOffset,t.endContainer,t.endOffset))}function ne(e){const{environment:t,event:o,textValue:n,editorNode:r,store:i,canEdit:a,disableEquationInteraction:s}=e,l=se({event:o,textValue:n,editorNode:r});(t.device.isFirefox||"editing"!==w.default.state.mode||w.default.isEmptySelection()||l&&(0,C.Xu)(l.node))&&l&&(s&&(0,C.Xu)(l.node)||u.VO({environment:t,event:o,interactiveToken:l,store:i,canEdit:a}))}function re(e){const{environment:t,event:o,textValue:n,editorNode:r,store:i,parentStore:a,canEdit:s}=e,l=se({event:o,textValue:n,editorNode:r});l&&u.ON({environment:t,event:o,interactiveToken:l,store:i,parentStore:a,canEdit:s})}function ie(e){const{environment:t,event:o,textValue:n,editorNode:r,store:i,canEdit:a}=e,s=se({event:o,textValue:n,editorNode:r});s&&u.Nh({environment:t,event:o,interactiveToken:s,store:i,canEdit:a})}function ae(e){const{environment:t,event:o,textValue:n,editorNode:r,store:i,canEdit:a}=e;if(o.target===r)return void m.lY();const s=se({event:o,textValue:n,editorNode:r});s&&u.Zl({environment:t,event:o,interactiveToken:s,store:i,canEdit:a})}function se(e){const{event:t,textValue:o,editorNode:n}=e,r=I.sh(t.target,(e=>Boolean(e.getAttribute&&e.getAttribute("data-token-index"))));if(r&&null!=n&&n.contains(r)){const e=r.getAttribute("data-token-index");if(e){const t=parseInt(e,10);if(o){const e=o[t];if(e)return{textValue:o,tokenIndex:t,textToken:e,node:r}}}}}const le=e=>de({store:e.store,temporaryAnnotation:c.GKr.TemporaryComment,multiSelection:g.Z.state.open&&"inline"===g.Z.state.type?g.Z.state.multiSelection:void 0}),ce=e=>{const{store:t,find:o}=e;let n=t.getValue();if(!n)return;return c.Oqk({textValue:n,substring:o,ignoreCase:!0}).forEach(((e,t)=>{n=c.aSf({textValue:n,selection:e,annotation:[c.GKr.TemporaryFindHighlight]})})),n},de=e=>{const{store:t,temporaryAnnotation:o,multiSelection:n}=e,r=t.getValue();if(n){const e=(0,T.L5)(n).find((e=>{let{store:o}=e;return o===t}));if(e){const{selection:t}=e;return c.aSf({textValue:r,selection:t,annotation:[o]})}}return r};function pe(e){const{store:t,equationStore:o}=e;if(!o.isOpen())return;const n=(0,v.QY)(o.state.savedTextSelectionState.multiSelection);if(!n)return;const{store:r,selection:i}=n;if(t!==r)return;const a=r.getValue(),s=i.startIndex===i.endIndex?a:c._QS(a,i.startIndex,i.endIndex),l=C.qZ({equationState:o.state,isTemporary:!0});return l?c.P$X(s,[l],i.startIndex):void 0}function ue(e){const{store:t,selection:o}=e,n=t.getValue();if(o.startIndex+1!==o.endIndex)return n;const r=c.b1T(n,o.startIndex);if(!r||!c.eOb(r))return n;const i=o.startIndex===o.endIndex?n:c._QS(n,o.startIndex,o.endIndex),a=(0,p.uh)(r[1],c.rIb),s=[r[0],[...a,c.EPB()]];return c.P$X(i,[s],o.startIndex)}function me(e){const{store:t,mentionMenuState:o}=e,n=t.getValue();if(o.textStore!==t)return n;const r=o.temporaryInputData.state;if(!r)return n;const i=(0,A.O2)(t,o.oldTextValue,r.prefix);if(i&&i.prefix){const{tokensBeforeRange:e,tokensInsideRange:t,tokensAfterRange:o}=c.xrQ(n,i.prefix.startIndex,i.filter.endIndex),a=c.QaF(t);return[...e,c.V3y(a,[c.mF$(r)]),...o]}return n}function ge(e){const{store:t,selection:o}=e,n=t.getValue(),{tokensBeforeRange:r,tokensInsideRange:i,tokensAfterRange:a}=c.xrQ(n,o.startIndex,o.endIndex),s=c.QaF(i);return[...r,c.V3y(s,[[c.GKr.TemporarySelection]]),...a]}const he=e=>{let{store:t,textValue:o}=e;if(!o)return o;if(t.table!==l.iU)return o;const n=_.G.createChildStore(t,{table:t.table,id:t.id});if(n.isInsideCollection()||n.isType("callout")||n.isType("code"))return o;let r=o;return(0,P.bB)((0,P.yJ)(n)).unresolved.forEach((e=>{const t=["m",e.id];r=c.aSf({textValue:r,annotation:t,selection:{startIndex:0,endIndex:1/0}})})),r};function fe(e){if(e.nodeType===Node.TEXT_NODE)return e;if(I.kK(e)&&"false"===e.getAttribute("contentEditable"))return e;let t;const o=I.kd(e);return o.forEach((e=>{null!==e.textContent&&e.textContent.indexOf("\n")>=0&&(t=e)})),t||(o.length>0?o[o.length-1]:e)}function ye(e){const t=D.get();if(!t)return;const o=t.startContainer,n=(0,k.X1)(o),r=null==n?void 0:n.childNodes,i=!D.isExpanded(t);if(r&&(r.length>1||i)){const i=(0,k.g4)(o,n),h=a.cx(r,(e=>e===i));let f,y,v=!0,b=o,S=t.startOffset;if(0===S)for(let e=h-1;v&&e>=0;e--){const t=fe(r[e]);if(t.nodeType===Node.TEXT_NODE){var s;const e=null===(s=t.textContent)||void 0===s?void 0:s.lastIndexOf("\n");var l,c;if(void 0!==e&&e>=0)null!==(l=t.textContent)&&void 0!==l&&l.length&&e+1<(null===(c=t.textContent)||void 0===c?void 0:c.length)&&(b=t,S=e+1),v=!1;else b=t,S=0}else b=t,S=0}v=!0;for(let e=h;v&&e<r.length;e++){const t=fe(r[e]);if(t.nodeType===Node.TEXT_NODE){let e;var d,p,u,m;if(b===t)e=null===(d=t.textContent)||void 0===d?void 0:d.indexOf("\n",S);else e=null===(p=t.textContent)||void 0===p?void 0:p.indexOf("\n");if(void 0!==e&&e>=0)f=t,y=e+1===(null===(u=t.textContent)||void 0===u?void 0:u.length)?e:e+1,v=!1;else f=t,y=(null===(m=t.textContent)||void 0===m?void 0:m.length)||0}else{var g;f=t,y=(null===(g=t.textContent)||void 0===g?void 0:g.length)||0}}if(b&&f){const t=D.rangeFromContainerOffsets({start:{container:b,offset:S},end:{container:f,offset:y||0}});D.set(t,e)}}}function ve(e,t){const o=c.$0A(e.id,e.getSpaceId()),n=c.YCD(o);return{textValue:[n],tokenIndex:0,textToken:n,node:t}}},70764:(e,t,o)=>{o.d(t,{NP:()=>s,QS:()=>g,mO:()=>c,sw:()=>m,xt:()=>u});var n=o(20270),r=o(5366),i=(o(95477),o(77080)),a=o(30874);function s(e){const t=a.Z.state;return t.loaded?t.bots.filter((t=>t.integration_id===e)):[]}const l=(0,r.defineMessages)({invalidRequest:{id:"unfurlingHelpers.authenticatedErrorDescription.invalidRequest",defaultMessage:"The authentication request is invalid. Please contact support if issue persists."},unauthorizedClient:{id:"unfurlingHelpers.unauthorizedClient.",defaultMessage:"The client is not authorized to request an authorization code using this method. Please contact support if issue persists."},accessDenied:{id:"unfurlingHelpers.authenticatedErrorDescription.accessDenied",defaultMessage:"The resource owner or authorization server denied the request. Check with your organization or resource owner to ensure OAuth installation is enabled."},unsupportedResponseType:{id:"unfurlingHelpers.authenticatedErrorDescription.unsupportedResponseType",defaultMessage:"The authorization server does not support obtaining an authorization code using this method. Please contact support if issue persists."},invalidScope:{id:"unfurlingHelpers.authenticatedErrorDescription.invalidScope",defaultMessage:"The requested scope is invalid. Please contact support if issue persists."},serverError:{id:"unfurlingHelpers.authenticatedErrorDescription.serverError",defaultMessage:"The authorization server encountered an unexpected condition that prevented it from fulfilling the request. Please contact support if issue persists."},temporarilyUnavailable:{id:"unfurlingHelpers.authenticatedErrorDescription.temporarilyUnavailable",defaultMessage:"The authorization server is currently unable to handle the request due to a temporary overloading or maintenance of the server. Please contact support if issue persists."},githubAppRequestAccessUnsupported:{id:"unfurlingHelpers.authenticatedErrorDescription.githubAppRequestAccessUnsupported",defaultMessage:"Request Access is not supported. You must be both a Github Admin and Notion Workspace Admin to connect the two apps."},unknownError:{id:"unfurlingHelpers.authenticatedErrorDescription.unknownError",defaultMessage:"The authorization server responded with an unknown error (`{value}`). Please contact support if issue persists."}});function c(e){return"invalid_request"===e?l.invalidRequest:"unauthorized_client"===e?l.unauthorizedClient:"access_denied"===e?l.accessDenied:"unsupported_response_type"===e?l.unsupportedResponseType:"invalid_scope"===e?l.invalidScope:"server_error"===e?l.serverError:"temporarily_unavailable"===e?l.temporarilyUnavailable:"github_app_request_access_unsupported"===e?l.githubAppRequestAccessUnsupported:l.unknownError}const d=(0,r.defineMessages)({unknownError:{id:"unfurlingHelpers.unfurlResponseError.unknownError",defaultMessage:"Can't load preview"},accessDenied:{id:"unfurlingHelpers.unfurlResponseError.accessDenied",defaultMessage:"Access denied"},reAuthenticate:{id:"unfurlingHelpers.unfurlResponseError.reAuthenticate",defaultMessage:"Re-authentication necessary"},notFound:{id:"unfurlingHelpers.unfurlResponseError.notFound",defaultMessage:"Content not found"},unprocessableEntity:{id:"unfurlingHelpers.unfurlResponseError.unprocessableEntity",defaultMessage:"Unrecognized URL"},rateLimited:{id:"unfurlingHelpers.unfurlResponseError.rateLimited",defaultMessage:"Too many requests"},serverError:{id:"unfurlingHelpers.unfurlResponseError.serverError",defaultMessage:"Can't load preview"},invalidRequest:{id:"unfurlingHelpers.unfurlResponseError.invalidRequest",defaultMessage:"Can't load preview"},authRefresh:{id:"unfurlingHelpers.unfurlResponseError.authRefresh",defaultMessage:"Fetching Preview"},githubNotAcceptable:{id:"unfurlingHelpers.unfurlResponseError.githubNotAcceptable",defaultMessage:"Need owner role"},jiraNotAcceptable:{id:"unfurlingHelpers.unfurlResponseError.jiraNotAcceptable",defaultMessage:"Synced in another workspace"},notAcceptable:{id:"unfurlingHelpers.unfurlResponseError.notAcceptable",defaultMessage:"Not Acceptable"},databaseSyncLimit:{id:"unfurlingHelpers.unfurlResponseError.databaseSyncLimit",defaultMessage:"Synced Database limit reached"}}),p=(0,r.defineMessages)({unknownError:{id:"unfurlingHelpers.unfurlResponseErrorDescription.unknownError",defaultMessage:'There was an error trying to get information for this resource. Received error code "{statusCode}".'},accessDenied:{id:"unfurlingHelpers.unfurlResponseErrorDescription.accessDenied",defaultMessage:"You do not have appropriate permission to access this resource."},reAuthenticate:{id:"unfurlingHelpers.unfurlResponseErrorDescription.reAuthenticate",defaultMessage:"You need to re-authenticate your account to access this resource."},notFound:{id:"unfurlingHelpers.unfurlResponseErrorDescription.notFound",defaultMessage:"The resource information for this link could not be found. It may no longer exist or you may not have appropriate permission to access it."},unprocessableEntity:{id:"unfurlingHelpers.unfurlResponseErrorDescription.unprocessableEntity",defaultMessage:"This url is not currently embedable by this integration."},rateLimited:{id:"unfurlingHelpers.unfurlResponseErrorDescription.rateLimited",defaultMessage:'"{integrationName}" received too many requests for you or your organization. Please wait a few minutes and try again.'},serverError:{id:"unfurlingHelpers.unfurlResponseErrorDescription.serverError",defaultMessage:'Oh no! Seems like there was a "{integrationName}" server error. Received error code "{statusCode}".'},invalidRequest:{id:"unfurlingHelpers.unfurlResponseErrorDescription.invalidRequest",defaultMessage:'There was an error trying to get information for this resource. Received error code "{statusCode}".'},authRefresh:{id:"unfurlingHelpers.unfurlResponseErrorDescription.authRefresh",defaultMessage:"Fetching Preview via Login Update, please wait."},githubNotAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.githubNotAcceptable",defaultMessage:"You do not have appropriate permission to sync this resource. You need to have an owner role."},jiraNotAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.jiraNotAcceptable",defaultMessage:"You have synced this resource in another workspace."},notAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.notAcceptable",defaultMessage:"You do not have appropriate permission to sync this resource. You need to have an owner role."},databaseSyncLimit:{id:"unfurlingHelpers.unfurlResponseErrorDescription.databaseSyncLimit",defaultMessage:"Your workspace has hit the Synced Database limit."}});function u(e,t){return void 0===e?{message:d.unknownError,description:p.unknownError}:401===e?{message:d.reAuthenticate,description:p.reAuthenticate}:439===e?{message:d.authRefresh,description:p.authRefresh}:403===e?{message:d.accessDenied,description:p.accessDenied}:404===e?{message:d.notFound,description:p.notFound}:422===e?{message:d.unprocessableEntity,description:p.unprocessableEntity}:429===e?{message:d.rateLimited,description:p.rateLimited}:406===e?"jira"===t?{message:d.jiraNotAcceptable,description:p.jiraNotAcceptable}:"github"===t?{message:d.githubNotAcceptable,description:p.githubNotAcceptable}:{message:d.notAcceptable,description:p.notAcceptable}:417===e?{message:d.databaseSyncLimit,description:p.databaseSyncLimit}:(0,n.Ms)(e)?{message:d.serverError,description:p.serverError}:{message:d.invalidRequest,description:p.invalidRequest}}function m(e){return!e.device.isMobileBrowser}function g(){return"on"===i.default.getGroup("beta-developers-external")}},15010:(e,t,o)=>{o.d(t,{JF:()=>a,QZ:()=>i,WD:()=>l,e2:()=>s});o(45433);var n=o(44317),r=o(80444);o(93959);function i(){const{currentUserSettingsStore:e,currentSpaceStore:t}=r.default.state,o=(null==e?void 0:e.getSettings())||{},n=null==t?void 0:t.getPlanType();return"professional"===o.domain_type&&"team"===n}function a(){const{currentUserSettingsStore:e}=r.default.state;return((null==e?void 0:e.getSettings())||{}).domain_type}function s(e){const t=e.getSettings(),o=null==t?void 0:t.signup_time;return o?(0,n.O5)(o):null}function l(e){const{currentUserSettingsStore:t}=r.default.state;if(t&&t.id===e.currentUser.id)return t}},56518:(e,t,o)=>{o.d(t,{Ef:()=>w,Gp:()=>f,IU:()=>m,Li:()=>g,X4:()=>v,ZI:()=>S,ax:()=>_,nZ:()=>y,tt:()=>h,xF:()=>u});var n=o(15145),r=o(1800),i=o(42875),a=o(25718),s=o(74446),l=o(21202),c=o(97880),d=o(95477),p=o(33929);const u="paste";function m(e){let t,o;const n=new Set,r=new Set;for(const i of e){const e=i.getParentBlockStore();if(e&&"column"===e.getType()){n.add(e.id),r.add(i.id);const a=e.getParentBlockStore();if(a&&"column_list"===a.getType()){o=a.getSpaceId();const e=a.id;if(void 0===t&&(t=e),t!==e)return}}}if(t&&n.size>1&&o)return{columnListId:t,columnIds:n,blockIds:r,spaceId:o}}function g(e,t){if(!e.clipboardData)return;const o=e.clipboardData.getData("text/html");e.clipboardData.setData("text/html",`${o}${f(t)}`)}function h(e){if(!e.clipboardData)return;return y(e.clipboardData.getData("text/html"))}function f(e){return`\x3c!-- notionvc: ${e} --\x3e`}function y(e){const t=e.match(/\<\!-- notionvc\: ([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}) --\>$/i);return t?t[1]:void 0}function v(e){const{blockValues:t,rootBlock:o,getRecordValue:n,isWindows:r,markdownSerializationOptions:i,markdownLinkifyIt:s}=e;let l=a.on(t,{..._({rootBlock:o,getRecordValue:n}),transformAnnotation:null==i?void 0:i.transformAnnotation,transformBlockMapping:null==i?void 0:i.transformBlockMapping});const c={markdown:void 0,html:void 0};if(l){l=l.replaceAll(b,"$1"),c.markdown=S(r,l);const e=s&&a.c8({...s,markdown:l});e&&(c.html=S(r,e))}return c}const b=/\[(https?:\/\/[^\])]+)\]\(\1\)/g;function S(e,t){return e?t.split("\r\n").reduce(((e,t)=>[...e,...t.split("\n")]),[]).join("\r\n"):t}function _(e){const{rootBlock:t,getRecordValue:o}=e;return{root:t,navigableBlockId:t.id,renderParentBlockId:void 0,blockId:t.id,userTimeZone:(0,i.r)(),intl:p.default.getIntl(),getRecordValue:o,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,r.Z)({pageId:t,pageValue:o({table:l.iU,id:t}),baseUrl:d.default.domainBaseUrl,pageVisitSource:n.tY.Export})},baseUrl:d.default.domainBaseUrl,publicDomainName:d.default.publicDomainName,resultCache:new Map}}function w(e){const{rootBlock:t,clipboardData:o,isWindows:n,fallbackGetRecordValue:r,markdownSerializationOptions:i,markdownLinkifyIt:a}=e,{tree:l,blockSelection:d}=o,p=s.mF.tryUntilFound(...d.blocks.map((e=>e.blockSubtree&&s.mF.fromRecordMap(e.blockSubtree))).filter(c.$K),r),u=l.value,m=d.blocks.map((e=>p({...u,id:e.blockId}))).filter(c.$K);return v({rootBlock:t,getRecordValue:p,blockValues:m,isWindows:n,markdownSerializationOptions:i,markdownLinkifyIt:a})}},75079:(e,t,o)=>{o.d(t,{Pn:()=>a,Pp:()=>u,Y5:()=>d,ZO:()=>l,vS:()=>s,yr:()=>p});var n=o(43690),r=o(58421),i=o(28209);function a(e){const t=null==e?void 0:e.collectionViewBlockStore(),o=null==e?void 0:e.collectionStore(),n=null==e?void 0:e.collectionViewStore(),a=null==e?void 0:e.filtersBarOpenStore.state,s=null==n?void 0:n.getType(),l=(null==e?void 0:e.settingsStore)&&(0,r.n)(null==e?void 0:e.settingsStore),c=null==t?void 0:t.id,d=i.Z.state.userHomePageId;return{view_type:s,settings_menu:null!=e&&e.settingsStore.state.open&&l?l.type:void 0,collection_id:null==o?void 0:o.id,collection_view_id:null==n?void 0:n.id,collection_view_block_id:c,filters_bar_open:a,is_in_my_tasks:d===c,is_in_wiki:null==t?void 0:t.isCollectionViewPageWithContent()}}function s(e,t){var o,n,r,i,a;if(!e)return{view_type:"missing_context_store",row_count_category:"missing_context_store",column_count_category:"missing_context_store",has_relation_column:"missing_context_store",has_rollup_column:"missing_context_store",has_formula_column:"missing_context_store",is_client_mode_enabled:"missing_context_store",tracking_source:void 0,collection_view_id:"missing_context_store",collection_id:"missing_context_store",collection_type:"missing_context_store"};const s=e.isClientModeEnabled.state,d=(null===(o=e.collectionViewBlockStore())||void 0===o?void 0:o.id)||"missing",p=(null===(n=e.collectionStore())||void 0===n?void 0:n.id)||"missing",u=null===(r=e.collectionViewStore())||void 0===r?void 0:r.getCollectionSource(),m=null===(i=e.collectionStore())||void 0===i?void 0:i.getSchema();if(!m)return{view_type:"missing_schema",row_count_category:"missing_schema",column_count_category:"missing_schema",has_relation_column:"missing_schema",has_rollup_column:"missing_schema",has_formula_column:"missing_schema",is_client_mode_enabled:s,tracking_source:t,collection_view_id:d,collection_id:p,collection_type:(null==u?void 0:u.type)||"missing"};const{has_relation_column:g,has_rollup_column:h,has_formula_column:f}=function(e){const t="missing_schema";if(void 0===e)return{has_relation_column:t,has_rollup_column:t,has_formula_column:t};let o=!1,n=!1,r=!1;for(const i of Object.values(e))if("relation"===(null==i?void 0:i.type)&&(o=!0),"rollup"===(null==i?void 0:i.type)&&(n=!0),"formula"===(null==i?void 0:i.type)&&(r=!0),o&&n&&r)break;return{has_relation_column:o,has_rollup_column:n,has_formula_column:r}}(m);return{view_type:e.getViewType()||"unknown",row_count_category:l(null===(a=e.remoteResult.state)||void 0===a?void 0:a.sizeHint),column_count_category:c(m),has_relation_column:g,has_rollup_column:h,has_formula_column:f,is_client_mode_enabled:s,tracking_source:t,collection_view_id:d,collection_id:p,collection_type:(null==u?void 0:u.type)||"missing"}}function l(e){return void 0===e?"unknown":e<=100?"0-100":e<=200?"100-200":e<=300?"200-300":e<=400?"300-400":e<=500?"400-500":e<=600?"500-600":e<=700?"600-700":e<=800?"700-800":e<=900?"800-900":e<=1e3?"900-1000":"1001_or_more"}function c(e){const t=Object.keys(e).length;return t<=10?"0-10":t<=20?"10-20":t<=50?"20-50":"51_or_more"}function d(e){const{from:t,collectionContextStore:o,sizeHintAtStart:n}=e,r=s(o),{row_count_category:i,...a}=r;return{...a,from:t,property_type:"property_type"in e?e.property_type:void 0,did_trigger_fetch:o?o.isLoading.state:"missing_context_store",row_count_category:l(n)}}function p(e){const{collectionContextStore:t,is_native_drop:o,is_empty:n}=e;return{...s(t),is_native_drop:o,is_empty:n}}function u(e){const{collectionContextStore:t,visibleItemsCount:o}=e,r=s(t),i=t.remoteResult.state?n.aW({result:t.remoteResult.state}).length:0,a=0===i?void 0:o/i;return{...r,percentage_of_remote_result_visible:void 0===a?"empty_remote_result":0===a?"0":a<=.25?"0-25":a<=.5?"25-50":a<=.75?"50-75":a<1?"75-100":1===a?"100":"greater_than_100"}}},17335:(e,t,o)=>{o.d(t,{$7:()=>S,D0:()=>k,Fc:()=>_,HL:()=>C,IF:()=>A,KV:()=>K,Qz:()=>$,SW:()=>Q,Sb:()=>w,Sj:()=>b,WC:()=>y,_T:()=>D,cq:()=>E,ip:()=>T,li:()=>W,qh:()=>q,rn:()=>m,x:()=>I,xe:()=>J,zZ:()=>h});var n=o(2032),r=o(76205),i=o(34299),a=o(78106),s=o(72126),l=o(97880),c=o(4308),d=o(5366),p=o(33929);const u={text:{operator:"string_contains",value:{type:"exact",value:void 0}},relation:{operator:"relation_contains",value:{type:"exact",value:void 0}},url:{operator:"string_contains",value:{type:"exact",value:void 0}},checkbox:{operator:"checkbox_is",value:{type:"exact",value:void 0}},created_by:{operator:"person_contains",value:{type:"exact",value:void 0}},last_edited_by:{operator:"person_contains",value:{type:"exact",value:void 0}},select:{operator:"enum_is",value:{type:"exact",value:void 0}},multi_select:{operator:"enum_contains",value:{type:"exact",value:void 0}},status:{operator:"status_is",value:{type:"is_group",value:void 0}},person:{operator:"person_contains",value:{type:"exact",value:void 0}},number:{operator:"number_equals",value:{type:"exact",value:void 0}},auto_increment_id:{operator:"number_equals",value:{type:"exact",value:void 0}},date:{operator:"date_is_relative_to",value:{type:"relative",value:"surrounding",unit:"week"}},created_time:{operator:"date_is",value:{type:"exact",value:void 0}},last_edited_time:{operator:"date_is",value:{type:"exact",value:void 0}},last_visited_time:{operator:"date_is",value:{type:"exact",value:void 0}},email:{operator:"string_contains",value:{type:"exact",value:void 0}},phone_number:{operator:"string_contains",value:{type:"exact",value:void 0}},title:{operator:"string_contains",value:{type:"exact",value:void 0}},file:{operator:"is_empty"},location:{operator:"location_is",value:{type:"exact",value:void 0}},verification:{operator:"verification_is",value:{type:"exact",value:void 0}}};function m(e){return u[e]}function g(e){return"v2"===e.version?function(e){if(!e.formula2)return{operator:"is_empty"};const t=e.formula2.result_type;if("array"===t.type){const e=(0,a.B8)(t.of);return"array"===e.type||"function"===e.type?{operator:"is_empty"}:"block"===e.type||"unknown"===e.type?{operator:"any",subfilter:m("text")}:{operator:"any",subfilter:m(e.type)}}if("unknown"===t.type||"block"===t.type)return m("text");return m(t.type)}(e):function(e){return e.formula&&e.formula.result_type?m(e.formula.result_type):{operator:"is_empty"}}(e)}function h(e){const{property:t,schema:o}=e,a=o[t];if(!a||"button"===a.type)return{operator:"is_empty"};if("formula"===a.type)return g(a);if("rollup"===a.type){if(a.aggregation&&"show_unique"!==a.aggregation){return m((0,n.W6)((0,n.gu)(a.aggregation)))}{const t=(0,i.gT)(e);if(!t){return{operator:"any",subfilter:{operator:"is_empty"}}}if("rollup"===t.targetPropertySchema.type){return{operator:"any",subfilter:{operator:"is_empty"}}}if("formula"===t.targetPropertySchema.type){const e=g(t.targetPropertySchema);if((0,r.a_)(e))return e;return{operator:"any",subfilter:e}}if("button"===t.targetPropertySchema.type)return{operator:"is_empty"};return{operator:"any",subfilter:m(t.targetPropertySchema.type)}}}return m(a.type)}const f=(0,d.defineMessages)({date_is_within:{defaultMessage:"Is between",id:"collectionFilterMenuHelpers.operator.dateIsWithin"},date_is_relative_to:{defaultMessage:"Is relative to today",id:"collectionFilterMenuHelpers.operator.dateIsRelativeTo"},is_empty:{defaultMessage:"Is empty",id:"collectionFilterMenuHelpers.operator.isEmpty"},is_not_empty:{defaultMessage:"Is not empty",id:"collectionFilterMenuHelpers.operator.isNotEmpty"},string_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.stringIs"},string_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.stringIsNot"},string_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.stringContains"},string_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.stringDoesNotContain"},string_starts_with:{defaultMessage:"Starts with",id:"collectionFilterMenuHelpers.operator.stringStartsWith"},string_ends_with:{defaultMessage:"Ends with",id:"collectionFilterMenuHelpers.operator.stringEndsWith"},checkbox_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.checkboxIs"},checkbox_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.checkboxIsNot"},enum_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.enumIs"},enum_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.enumIsNot"},enum_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.enumContains"},enum_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.enumDoesNotContain"},status_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.statusIs"},status_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.statusIsNot"},person_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.personContains"},person_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.personDoesNotContain"},relation_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.relationContains"},relation_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.relationDoesNotContain"},location_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.locationIs"},location_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.locationIsNot"},number_equals:{defaultMessage:"=",id:"collectionFilterMenuHelpers.operator.numberEquals"},number_does_not_equal:{defaultMessage:"â‰ ",id:"collectionFilterMenuHelpers.operator.numberDoesNotEqual"},number_greater_than:{defaultMessage:">",id:"collectionFilterMenuHelpers.operator.numberGreaterThan"},number_less_than:{defaultMessage:"<",id:"collectionFilterMenuHelpers.operator.numberLessThan"},number_greater_than_or_equal_to:{defaultMessage:"â‰¥",id:"collectionFilterMenuHelpers.operator.numberGreaterThanOrEqualTo"},number_less_than_or_equal_to:{defaultMessage:"â‰¤",id:"collectionFilterMenuHelpers.operator.numberLessThanOrEqualTo"},date_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.dateIs"},date_is_before:{defaultMessage:"Is before",id:"collectionFilterMenuHelpers.operator.dateIsBefore"},date_is_after:{defaultMessage:"Is after",id:"collectionFilterMenuHelpers.operator.dateIsAfter"},date_is_on_or_before:{defaultMessage:"Is on or before",id:"collectionFilterMenuHelpers.operator.dateIsOnOrBefore"},date_is_on_or_after:{defaultMessage:"Is on or after",id:"collectionFilterMenuHelpers.operator.dateIsOnOrAfter"},any:{defaultMessage:"Any",id:"collectionFilterMenuHelpers.operator.any"},none:{defaultMessage:"None",id:"collectionFilterMenuHelpers.operator.none"},every:{defaultMessage:"Every",id:"collectionFilterMenuHelpers.operator.every"},string_has_no_alphabet_prefix:{defaultMessage:"(Not used)",id:"collectionFilterMenuHelpers.operator.stringHasNoAlphabetPrefix"},verification_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.verificationStateIs"},verification_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.verificationStateIsNot"}});function y(e){return p.default.formatMessage(f[e])}const v=(0,d.defineMessages)({today:{defaultMessage:"Today",id:"collectionFilterMenuHelpers.relativeDates.today"},tomorrow:{defaultMessage:"Tomorrow",id:"collectionFilterMenuHelpers.relativeDates.tomorrow"},yesterday:{defaultMessage:"Yesterday",id:"collectionFilterMenuHelpers.relativeDates.yesterday"},one_week_ago:{defaultMessage:"One week ago",id:"collectionFilterMenuHelpers.relativeDates.oneWeekAgo"},one_week_from_now:{defaultMessage:"One week from now",id:"collectionFilterMenuHelpers.relativeDates.oneWeekFromNow"},one_month_ago:{defaultMessage:"One month ago",id:"collectionFilterMenuHelpers.relativeDates.oneMonthAgo"},one_month_from_now:{defaultMessage:"One month from now",id:"collectionFilterMenuHelpers.relativeDates.oneMonthFromNow"}}),b=(0,d.defineMessages)({past:{defaultMessage:"Past",id:"collectionFilterMenuHelpers.relativeDates.past"},future:{defaultMessage:"Next",id:"collectionFilterMenuHelpers.relativeDates.next"}}),S=(0,d.defineMessages)({direction:{defaultMessage:"Direction",id:"collectionFilterMenuHelpers.relativeDates.direction"},unit:{defaultMessage:"Unit",id:"collectionFilterMenuHelpers.relativeDates.unit"}}),_=(0,d.defineMessages)({this:{defaultMessage:"This",id:"collectionFilterMenuHelpers.relativedates.this"}}),w=(0,d.defineMessages)({day:{defaultMessage:"day",id:"collectionFilterMenuHelpers.relativeDates.day"},week:{defaultMessage:"week",id:"collectionFilterMenuHelpers.relativeDates.week"},month:{defaultMessage:"month",id:"collectionFilterMenuHelpers.relativeDates.month"},year:{defaultMessage:"year",id:"collectionFilterMenuHelpers.relativeDates.year"}}),k=(0,d.defineMessages)({day:{defaultMessage:"days",id:"collectionFilterMenuHelpers.relativeDates.days"},week:{defaultMessage:"weeks",id:"collectionFilterMenuHelpers.relativeDates.weeks"},month:{defaultMessage:"months",id:"collectionFilterMenuHelpers.relativeDates.months"},year:{defaultMessage:"years",id:"collectionFilterMenuHelpers.relativeDates.years"}}),x=(0,d.defineMessages)({exactDate:{defaultMessage:"Custom date",id:"collectionFilterMenuHelpers.relativeDates.exactDate"},exactDateRange:{defaultMessage:"Exact dates",id:"collectionFilterMenuHelpers.relativeDates.exactDateRange"}});function I(e){return"exact"===e.type?p.default.formatMessage(x.exactDate):p.default.formatMessage(v[e.value])}const C=(0,d.defineMessages)({custom:{defaultMessage:"Relative range",id:"collectionFilterMenuHelpers.relativeDates.range"},surrounding:{defaultMessage:"Surrounding range",id:"collectionFilterMenuHelpers.relativeDates.customRange"},this_week:{defaultMessage:"This week",id:"collectionFilterMenuHelpers.relativeDates.thisWeek"},the_past_week:{defaultMessage:"The past week",id:"collectionFilterMenuHelpers.relativeDates.thePastWeek"},the_past_month:{defaultMessage:"The past month",id:"collectionFilterMenuHelpers.relativeDates.thePastMonth"},the_past_year:{defaultMessage:"The past year",id:"collectionFilterMenuHelpers.relativeDates.thePastYear"},the_next_week:{defaultMessage:"The next week",id:"collectionFilterMenuHelpers.relativeDates.theNextWeek"},the_next_month:{defaultMessage:"The next month",id:"collectionFilterMenuHelpers.relativeDates.theNextMonth"},the_next_year:{defaultMessage:"The next year",id:"collectionFilterMenuHelpers.relativeDates.theNextYear"}});function T(e){return"custom"===e.value?function(e){const t=p.default.formatMessage(b[e.direction]),o=1===e.count?p.default.formatMessage(w[e.unit]):p.default.formatMessage(k[e.unit]);return 1===e.count?`${t} ${o}`:`${t} ${e.count} ${o}`}(e):"surrounding"===e.value?function(e){const t=p.default.formatMessage(w[e.unit]);return`${p.default.formatMessage(_.this)} ${t}`}(e):"exact"===e.type?p.default.formatMessage(x.exactDateRange):"relative"===e.type?p.default.formatMessage(C[e.value]):void(0,l.t1)(e)}const M=(0,d.defineMessages)({start_date:{defaultMessage:"Start date",id:"collectionFilterMenuHelpers.dateFilterModes.start_date"},end_date:{defaultMessage:"End date",id:"collectionFilterMenuHelpers.dateFilterModes.end_date"}}),P=(0,d.defineMessages)({start_date:{defaultMessage:"For date ranges, filters on the start date. For individual dates, filters on the date.",id:"collectionFilterMenuHelpers.dateFilterModesTooltip.start_date"},end_date:{defaultMessage:"For date ranges, filters on the end date. For individual dates, filters on the date.",id:"collectionFilterMenuHelpers.dateFilterModesTooltip.end_date"}});function A(e){return p.default.formatMessage(M[e])}function D(e){return p.default.formatMessage(P[e])}const B=(0,d.defineMessages)({and:{defaultMessage:"And",id:"collectionFilterMenuHelpers.combinatorOperators.and"},or:{defaultMessage:"Or",id:"collectionFilterMenuHelpers.combinatorOperators.or"}}),R=(0,d.defineMessages)({checked:{defaultMessage:"Checked",id:"collectionFilterMenuHelpers.checkbox.checked"},unchecked:{defaultMessage:"Unchecked",id:"collectionFilterMenuHelpers.checkbox.unchecked"}});function E(e){return e.value?p.default.formatMessage(c.A3(e.value)):""}const F=e=>{let{filter:t,schema:o}=e;return V({filter:t.subfilter,schema:o})},N=e=>{let{filter:t}=e;return I(t.value)},j=e=>{let{filter:t}=e;return T(t.value)},O=e=>{let{filter:t}=e;return`"${t.value.value||""}"`},L=e=>{let{filter:t}=e;return void 0===t.value.value?void 0:t.value.value.toString()},U=e=>{let{filter:t}=e;return function(e){const t=e.value?R.checked:R.unchecked;return p.default.formatMessage(t)}(t.value)},Z={is_empty:()=>{},is_not_empty:()=>{},string_is:O,string_is_not:O,string_contains:O,string_does_not_contain:O,string_starts_with:O,string_ends_with:O,checkbox_is:U,checkbox_is_not:U,enum_is:O,enum_is_not:O,enum_contains:O,enum_does_not_contain:O,status_is:O,status_is_not:O,relation_contains:()=>{},relation_does_not_contain:()=>{},person_contains:()=>{},person_does_not_contain:()=>{},location_is:()=>{},location_is_not:()=>{},number_equals:L,number_does_not_equal:L,number_greater_than:L,number_less_than:L,number_greater_than_or_equal_to:L,number_less_than_or_equal_to:L,date_is:N,date_is_before:N,date_is_after:N,date_is_on_or_before:N,date_is_on_or_after:N,date_is_within:j,date_is_relative_to:j,any:F,none:F,every:F,string_has_no_alphabet_prefix:()=>{},verification_is:O,verification_is_not:O};function V(e){const{filter:t}=e,o=y(t.operator),n=Z[t.operator](e);return s.oA([o,n]).join(" ")}function q(e){const{filter:t,schema:o}=e;if((0,r.vA)(t)){const e=t.filters||[],n=s.oA(e.map((e=>{const t=q({filter:e,schema:o});if(t)return(0,r.vA)(e)?`(${t})`:t}))),i=p.default.formatMessage(B[t.operator]);return n.join(` ${i} `)}if((0,r.aN)(t)){const e=o[t.property];if(!e)return;const n=t.filter,r=e.name,i=V({filter:n,schema:o});return s.oA([r,i]).join(" ")}}const z={text:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:"string_has_no_alphabet_prefix"===e.operator?{operator:t}:{operator:t,value:e.value}},number:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},checkbox:function(e,t){return{operator:t,value:e.value}},select:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},multi_select:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},status:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"is_option",value:void 0}}:{operator:t,value:e.value}},relation:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},person:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},date:function(e,t,o){if((0,r._N)(t))return{operator:t};const n=(0,r.mv)(e)?void 0:e.use_end;return"date_is_within"===t?"date_is_within"!==e.operator?{operator:t,value:{type:"exact",value:void 0},use_end:n}:e:"date_is_relative_to"===t?"date_is_relative_to"!==e.operator?{operator:t,value:{type:"relative",value:"surrounding",unit:"week"},use_end:n}:e:(0,r.TQ)(e)?"combinator"===o?{operator:t,value:{type:"relative",value:"today"},use_end:n}:{operator:t,value:{type:"exact",value:void 0},use_end:n}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value,use_end:n}},file:function(e,t){return{operator:t}},location:function(e,t){return{operator:t,value:e.value}},verification:function(e,t){return{operator:t,value:e.value}}};function W(e,t,o,n){return(0,z[e])(t,o,n)}const H=(0,d.defineMessages)({and:{defaultMessage:"And",id:"database.filterOperators.and"},or:{defaultMessage:"Or",id:"database.filterOperators.or"}}),G=(0,d.defineMessages)({and:{defaultMessage:"All filters must match",id:"database.filterOperators.andCaption"},or:{defaultMessage:"At least one filter must match",id:"database.filterOperators.orCaption"}});function K(e,t){return"and"===e?t.formatMessage(H.and):t.formatMessage(H.or)}function $(e,t){return"and"===e?t.formatMessage(G.and):t.formatMessage(G.or)}const Y=(0,d.defineMessages)({any:{defaultMessage:"Any",id:"database.filterOperators.any"},every:{defaultMessage:"Every",id:"database.filterOperators.every"},none:{defaultMessage:"None",id:"database.filterOperators.none"}});function Q(e,t){return"any"===e?t.formatMessage(Y.any):"every"===e?t.formatMessage(Y.every):t.formatMessage(Y.none)}const J=(0,d.defineMessages)({number:{id:"collectionFilterMenuFilter.filterOperators.number.order",defaultMessage:"{operator}{operatorValue}"},text:{id:"collectionFilterMenuFilter.filterOperators.text.order",defaultMessage:"{operator}{operatorValue}"},checkbox:{id:"collectionFilterMenuFilter.filterOperators.checkbox.order",defaultMessage:"{operator}{operatorValue}"},select:{id:"collectionFilterMenuFilter.filterOperators.select.order",defaultMessage:"{operator}{operatorValue}"},multi_select:{id:"collectionFilterMenuFilter.filterOperators.multi_select.order",defaultMessage:"{operator}{operatorValue}"},status:{id:"collectionFilterMenuFilter.filterOperators.status.order",defaultMessage:"{operator}{operatorValue}"},relation:{id:"collectionFilterMenuFilter.filterOperators.relation.order",defaultMessage:"{operator}{operatorValue}"},location:{id:"collectionFilterMenuFilter.filterOperators.location.order",defaultMessage:"{operator}{operatorValue}"},person:{id:"collectionFilterMenuFilter.filterOperators.person.order",defaultMessage:"{operator}{operatorValue}"},date:{id:"collectionFilterMenuFilter.filterOperators.date.order",defaultMessage:"{operator}{operatorValue}"},file:{id:"collectionFilterMenuFilter.filterOperators.file.order",defaultMessage:"{operator}{operatorValue}"},verification:{id:"collectionFilterMenuFilter.filterOperators.verification.order",defaultMessage:"{operator}{operatorValue}"}})},81849:(e,t,o)=>{o.d(t,{_1:()=>I,II:()=>x,h6:()=>k,ej:()=>y,Cz:()=>_,kW:()=>h,XD:()=>g,ew:()=>f,nr:()=>v,ar:()=>b,qW:()=>S});o(57658);var n=o(35011),r=o(14714),i=o(99036),a=o(8848),s=o(45433),l=o(38297),c=o(72126),d=o(97058);var p=o(97880),u=o(26991),m=o(29376);const g=10,h=10,f=50;function y(e){const{groupBy:t,schema:o,format:n,filter:i,groupsFormatKey:a,limit:s}=e,l=o[t.property];if(!l||!(0,r.LG)(l))return;const c=n[a]||[],d=c.reduce(((e,t)=>(0,r.eF)(t)?e+1:e),0);return{type:"groups",groupBy:t,filter:i,groupSortPreference:c.map((e=>e.value)),limit:s+d}}function v(e,t,o){const n=e.filter((e=>!(0,r.ZH)(e,t))),i=n.filter((e=>!(0,r.eF)(e))),a=n.filter((e=>(0,r.eF)(e)));return[...i.slice(0,o-1),t,...i.slice(o-1),...a]}function b(e,t){const o=e.filter((e=>!(0,r.ZH)(e,t))),n=o.filter((e=>!(0,r.eF)(e))),i=o.filter((e=>(0,r.eF)(e)));return[...n,t,...i]}function S(e){return!e.device.isPhone&&(e.isFullScreen||e.isRootChild)}function _(e){const{schema:t,groupBy:o,schemaGroups:i,reducerResults:a,relativeVariableResult:l,getRecordModel:p,viewAppConfigUri:u}=e;if(!o)return[];const m=t[o.property];if(!m||!(0,r.LG)(m))return[];const g=[...e.formatGroups,...i&&!a?i.map((e=>({property:o.property,value:e}))):[]];let h;if("manual"===(0,r.mu)(o).type){if(h=g,a)for(const{value:e}of a){const t={property:o.property,value:e};h.push(t)}u===s.sV&&(h=function(e,t){const o=(0,d.ft)(t);return c.MR(e,[e=>{const t=o[(0,r.Hd)(e.value)];return void 0!==t?t:1/0},e=>(0,r.Hd)(e.value)])}(h,e.formatGroups.map((e=>e.value))))}else{const e=new Map;for(const t of g)e.set((0,r.mD)(t),t);h=a?a.map((t=>{let{value:n}=t;return e.get((0,r.Hd)(n))||{property:o.property,value:n}})):[];for(const t of g)h.push(t)}if(a){if(o.hideEmptyGroups){const e=new Set,t=new Set;for(const o of a){const n=(0,r.Hd)(o.value);0===o.total?t.add(n):e.add(n)}h=h.map((o=>{const n=(0,r.mD)(o);if(t.has(n))return{...o,emptyHidden:!0};if(e.has(n)){const e={...o};return delete e.emptyHidden,e}return o}))}else h=h.map((e=>{if(e.emptyHidden){const t={...e};return delete t.emptyHidden,t}return e}));h=u===s.sV&&o.property===s.Es.TaskToSprintRelation?h.map((e=>"relation"===e.value.type&&(0,r.t2)(e.value.value)||void 0===e.value||void 0===e.value.value?e:{...e,hiddenByDefault:!0})):h.map((e=>{if(e.hiddenByDefault){const t={...e};return delete t.hiddenByDefault,t}return e}))}const f=h.filter((e=>{if(e.property!==o.property)return!1;const t=e.value;if(t.type!==m.type)return!1;if(void 0===t.value)return!0;if("formula"===m.type){const t=(0,n.mm)(m);if(!m.formula&&!m.formula2||"unknown"===t)return!1;if("formula"!==e.value.type||"formula"!==o.type)return!1;const i=e.value.value;if(!i)return!0;if("block"===t&&"text"===i.type)return!0;if(i.type!==t)return!1;const a=o.groupBy;return"relation"===a.type?function(e,t,o){if(!e||!e.value)return!0;if("relation"!==t.type||"relation"!==e.type)return!1;if((0,r.t2)(e.value))return!1;const n=o(e.value);return null==n?void 0:n.alive}(i,{...a,property:o.property},p):w({groupValue:i,groupBy:{property:o.property,...a},getRecordModel:p,relativeVariableResult:l})}return w({groupValue:t,groupBy:o,getRecordModel:p,relativeVariableResult:l,propertySchema:m})}));return c.mN(f,(e=>(0,r.mD)(e)))}function w(e){const{groupValue:t,groupBy:o,getRecordModel:n,relativeVariableResult:i,propertySchema:a}=e;if(!t.value)return!0;const s=o.type;if("formula"===s)return!1;if("select"===s){if("select"!==(null==a?void 0:a.type))return!1;return(a.options??[]).some((e=>e.value===t.value))}if("multi_select"===s){if("multi_select"!==(null==a?void 0:a.type))return!1;return(a.options??[]).some((e=>e.value===t.value))}if("status"===s){if("status"!==(null==a?void 0:a.type))return!1;const e=a.options??[],n=a.groups??[];if("status"!==t.type)return!1;const{value:r}=t;return"by_group"===r.type?("status"!==s||"group"===o.groupBy)&&n.some((e=>e.name===r.group)):"by_option"===r.type&&(("status"!==s||"option"===o.groupBy)&&e.some((e=>e.value===r.option)))}return(0,r.A1)(s)?function(e,t){if(!e||!e.value)return!0;if(!(0,r.ib)(t)||!(0,r.Mc)(e)||!t.groupBy)return!1;const o=e.value.type;if("relative"===t.groupBy)return"today"===o||"yesterday"===o||"last_7_days"===o||"last_30_days"===o||"tomorrow"===o||"next_7_days"===o||"next_30_days"===o||"month"===o;if("day"===t.groupBy)return"day"===o;if("week"===t.groupBy)return"week"===o;if("month"===t.groupBy)return"month"===o;if("year"===t.groupBy)return"year"===o;(0,p.t1)(t.groupBy)}(t,o):(0,r.HB)(s)?function(e,t){if(!e||!e.value)return!0;if(!(0,r.aB)(t)||!(0,r.R7)(e)||!t.groupBy)return!1;const o=e.value.type;if("alphabet_prefix"===t.groupBy)return"alphabet_prefix"===o||"other"===o;if("exact"===t.groupBy)return"exact"===o;(0,p.t1)(t.groupBy)}(t,o):"number"===s?function(e,t){if(!e||!e.value)return!0;if("number"!==t.type||"number"!==e.type)return!1;const o=e.value;if("out_of_range"===o.type)return o.start===t.start&&o.end===t.end;if("range"===o.type){const e=(0,r.n6)(o.start,t.start,t.end,t.size);return e&&"range"===e.type&&e.start===o.start}(0,p.t1)(o)}(t,o):"relation"===s?"relation"===(null==a?void 0:a.type)&&function(e,t,o,n,i){var a;if(!t||!t.value)return!0;if("relation"!==o.type||"relation"!==t.type)return!1;if((0,r.t2)(t.value)){var s,c;const o=e.collection_pointer&&n(e.collection_pointer);if(!i||!o)return!1;const r=null==o||null===(s=o.getFormat())||void 0===s?void 0:s.app_config_uri,a=null===(c=i[o.id])||void 0===c?void 0:c[t.value.value.variable],l=null==o?void 0:o.getSchema();return(0,u.Sh)(l,r)&&a}const d=n(t.value);if(!d)return!1;const p=(0,l.ky)({block:d,getRecordModel:n});if(i&&p){if((0,r.qQ)({relativeVariableValues:i[null==p?void 0:p.id],pointer:d.pointer}).length>0)return!1}return Boolean(d.alive&&((null==p?void 0:p.id)===e.collection_id||(null==p?void 0:p.id)===(null===(a=e.collection_pointer)||void 0===a?void 0:a.id)))}(a,t,o,n,i):"location"===s?function(e,t,o){if(!e||!e.value)return!0;if("location"!==t.type||"location"!==e.type)return!1;const n=o(e.value);return Boolean(n)}(t,o,n):!(!(0,r.pd)(s)&&"checkbox"!==s)||void(0,p.t1)(s)}function k(e,t){var o;const n=t.collectionViewStore(),r=null==n||null===(o=n.getFormat().board_columns_by)||void 0===o?void 0:o.disableBoardColorColumns;return void 0===r||r}function x(e){const{environment:t,groupFormat:o,schema:n,format:l,collectionContextStore:c,theme:d}=e,p=k(0,c);if(l.collection_group_by||!p){if(o){const e=n[o.property];if(e&&!p){const t=o.value;if((0,i.cu)(e)){const o=(e.options||[]).find((e=>e.value===t.value));return(0,a.bw)(d,null==o?void 0:o.color)}if("status"===e.type&&"status"===t.type){var u,g;let o;if("by_group"===(null===(u=t.value)||void 0===u?void 0:u.type)){var h;const n=t.value.group;o=null===(h=e.groups)||void 0===h||null===(h=h.find((e=>e.name===n)))||void 0===h?void 0:h.color}else if("by_option"===(null===(g=t.value)||void 0===g?void 0:g.type)){var f;const n=t.value.option;o=null===(f=e.options)||void 0===f||null===(f=f.find((e=>e.value===n)))||void 0===f?void 0:f.color}return(0,a.bw)(d,o)}if("relation"===e.type&&"relation"===t.type&&(0,r.t2)(t.value)){const o=c.collectionStore();if(!o)return(0,a.bw)(d,"default");const n=(0,m.gO)(e,o),r=(0,m.uJ)(e,o),i=null==n?void 0:n.getPropertyMapping(),l=null==i?void 0:i[s.b0.StatusV2],p=r&&l&&r[l];if(p&&"status"===p.type){var y;const e=t.value.value.variable,o=null===(y=p.options)||void 0===y||null===(y=y.find((t=>t.id===e)))||void 0===y?void 0:y.color;if(o)return(0,a.bw)(d,o)}}}}return(0,a.bw)(d,"default")}}function I(e){return!("board"===e.viewType&&"board_columns_by"===e.groupByKey)}},52821:(e,t,o)=>{o.d(t,{Bh:()=>B,Cg:()=>Y,DL:()=>N,JI:()=>U,K8:()=>Z,Km:()=>L,Rb:()=>A,SO:()=>T,Sb:()=>W,TP:()=>z,Tr:()=>M,_W:()=>H,_Y:()=>O,aW:()=>F,k4:()=>K,oy:()=>j,r_:()=>G,sN:()=>E,to:()=>q});var n=o(41892),r=o(41432),i=o(99036),a=o(80951),s=o(35013),l=o(21321),c=o(69628),d=o(17948),p=o(42696),u=o(10405),m=o(72126),g=o(19889),h=o(3791),f=o(97880),y=o(5366),v=o(33929),b=o(80444),S=o(77080),_=o(83212),w=o(78291),k=o(19124),x=o(37034),I=o(95697);const C=(0,y.defineMessages)({title:{defaultMessage:"Title",id:"database.propertyTypeName.title"},text:{defaultMessage:"Text",id:"database.propertyTypeName.text"},number:{defaultMessage:"Number",id:"database.propertyTypeName.number"},url:{defaultMessage:"URL",id:"database.propertyTypeName.url"},select:{defaultMessage:"Select",id:"database.propertyTypeName.select"},multi_select:{defaultMessage:"Multi-select",id:"database.propertyTypeName.multi_select"},status:{defaultMessage:"Status",id:"database.propertyTypeName.status"},person:{defaultMessage:"Person",id:"database.propertyTypeName.person"},email:{defaultMessage:"Email",id:"database.propertyTypeName.email"},phone_number:{defaultMessage:"Phone",id:"database.propertyTypeName.phone_number"},date:{defaultMessage:"Date",id:"database.propertyTypeName.date"},file:{defaultMessage:"Files & media",id:"database.propertyTypeName.file"},checkbox:{defaultMessage:"Checkbox",id:"database.propertyTypeName.checkbox"},formula:{defaultMessage:"Formula",id:"database.propertyTypeName.formula"},relation:{defaultMessage:"Relation",id:"database.propertyTypeName.relation"},rollup:{defaultMessage:"Rollup",id:"database.propertyTypeName.rollup"},created_time:{defaultMessage:"Created time",id:"database.propertyTypeName.created_time"},created_by:{defaultMessage:"Created by",id:"database.propertyTypeName.created_by"},last_edited_time:{defaultMessage:"Last edited time",id:"database.propertyTypeName.last_edited_time"},last_edited_by:{defaultMessage:"Last edited by",id:"database.propertyTypeName.last_edited_by"},last_visited_time:{defaultMessage:"Last visited time",id:"database.propertyTypeName.last_visited_time"},button:{defaultMessage:"Button",id:"database.propertyTypeName.button"},auto_increment_id:{defaultMessage:"ID",id:"database.propertyTypeName.auto_increment_id"},location:{defaultMessage:"Location",id:"database.propertyTypeName.location"},verification:{defaultMessage:"Verification",id:"database.propertyTypeName.verification"},ai_summary:{defaultMessage:"AI summary",id:"database.propertyTypeName.text.summarizeWithAi"},ai_custom_prompt:{defaultMessage:"AI custom autofill",id:"database.propertyTypeName.text.customPromptWithAI"},ai_extract:{defaultMessage:"AI key info",id:"database.propertyTypeName.text.extractInfoWithAI"},ai_translate:{defaultMessage:"AI translation",id:"database.propertyTypeName.text.translateWithAI"}}),T={title:v.default.formatMessage(C.title),text:v.default.formatMessage(C.text),number:v.default.formatMessage(C.number),url:v.default.formatMessage(C.url),select:v.default.formatMessage(C.select),multi_select:v.default.formatMessage(C.multi_select),status:v.default.formatMessage(C.status),person:v.default.formatMessage(C.person),email:v.default.formatMessage(C.email),phone_number:v.default.formatMessage(C.phone_number),date:v.default.formatMessage(C.date),file:v.default.formatMessage(C.file),checkbox:v.default.formatMessage(C.checkbox),formula:v.default.formatMessage(C.formula),relation:v.default.formatMessage(C.relation),rollup:v.default.formatMessage(C.rollup),created_time:v.default.formatMessage(C.created_time),created_by:v.default.formatMessage(C.created_by),last_edited_time:v.default.formatMessage(C.last_edited_time),last_edited_by:v.default.formatMessage(C.last_edited_by),last_visited_time:v.default.formatMessage(C.last_visited_time),button:v.default.formatMessage(C.button),auto_increment_id:v.default.formatMessage(C.auto_increment_id),location:v.default.formatMessage(C.location),verification:v.default.formatMessage(C.verification),ai_summary:v.default.formatMessage(C.ai_summary),ai_custom_prompt:v.default.formatMessage(C.ai_custom_prompt),ai_extract:v.default.formatMessage(C.ai_extract),ai_translate:v.default.formatMessage(C.ai_translate)};(0,y.defineMessages)({text:{defaultMessage:"A single line of text.",id:"database.propertyTypeDescription.text"},number:{defaultMessage:"A number, with options to format as currency, percent, and more.",id:"database.propertyTypeDescription.number"},url:{defaultMessage:"A link to a page on the web.",id:"database.propertyTypeDescription.url"},select:{defaultMessage:"Select from a list of options.",id:"database.propertyTypeDescription.select"},multi_select:{defaultMessage:"Tag with values from a list of options.",id:"database.propertyTypeDescription.multi_select"},status:{defaultMessage:"Tag with a list of custom options with groups",id:"database.propertyTypeDescription.status"},person:{defaultMessage:"Reference a person on your team.",id:"database.propertyTypeDescription.person"},email:{defaultMessage:"Reference an email address.",id:"database.propertyTypeDescription.email"},phone_number:{defaultMessage:"Reference a phone number.",id:"database.propertyTypeDescription.phone_number"},date:{defaultMessage:"A date, with options to format and include time.",id:"database.propertyTypeDescription.date"},file:{defaultMessage:"Upload files and images.",id:"database.propertyTypeDescription.file"},checkbox:{defaultMessage:"Track status with a single checkbox.",id:"database.propertyTypeDescription.checkbox"},formula:{defaultMessage:"Compute a formula using other properties of a page.",id:"database.propertyTypeDescription.formula"},relation:{defaultMessage:"Allow pages in this database to reference pages in another.",id:"database.propertyTypeDescription.relation"},rollup:{defaultMessage:"Display and summarize data from a relation.",id:"database.propertyTypeDescription.rollup"},created_time:{defaultMessage:"Reference the date and time a page was created.",id:"database.propertyTypeDescription.created_time"},created_by:{defaultMessage:"Reference the person that created a page.",id:"database.propertyTypeDescription.created_by"},last_edited_time:{defaultMessage:"Reference the date and time a page was last edited.",id:"database.propertyTypeDescription.last_edited_time"},last_edited_by:{defaultMessage:"Reference the person that last edited a page.",id:"database.propertyTypeDescription.last_edited_by"},last_visited_time:{defaultMessage:"Reference the date and time a page was last visited by you.",id:"database.propertyTypeDescription.last_visited_time"},button:{defaultMessage:"A clickable button that can be configured to perform any action.",id:"database.propertyTypeDescription.button"},auto_increment_id:{defaultMessage:"An auto-increment ID.",id:"database.propertyTypeDescription.auto_increment_id"},location:{defaultMessage:"A location.",id:"database.propertyTypeDescription.location"},verification:{defaultMessage:"Verified status.",id:"database.propertyTypeDescription.verification"}});const M=["text","number","select","multi_select","status","date","person","file","checkbox","url","email","phone_number","formula","relation","rollup","created_time","created_by","last_edited_time","last_edited_by","button","auto_increment_id","verification"],P=["select","multi_select","status","person","date","created_time","created_by","last_edited_time","last_edited_by"],A=function(e){return P.includes(e.type)},D=(0,y.defineMessages)({tableDisplayName:{defaultMessage:"Table",id:"collectionHelpers.table.displayName"},boardDisplayName:{defaultMessage:"Board",id:"collectionHelpers.board.displayName"},calendarDisplayName:{defaultMessage:"Calendar",id:"collectionHelpers.calendar.displayName"},listDisplayName:{defaultMessage:"List",id:"collectionHelpers.list.displayName"},galleryDisplayName:{defaultMessage:"Gallery",id:"collectionHelpers.gallery.displayName"},timelineDisplayName:{defaultMessage:"Timeline",id:"collectionHelpers.timline.displayName"},pageDisplayName:{defaultMessage:"Page",id:"collectionHelpers.page.displayName"}}),B={table:v.default.formatMessage(D.tableDisplayName),board:v.default.formatMessage(D.boardDisplayName),calendar:v.default.formatMessage(D.calendarDisplayName),list:v.default.formatMessage(D.listDisplayName),gallery:v.default.formatMessage(D.galleryDisplayName),timeline:v.default.formatMessage(D.timelineDisplayName),page:v.default.formatMessage(D.pageDisplayName)},R=(0,y.defineMessages)({table:{defaultMessage:"Table with types to store and view any kind of structured data",id:"collectionHelpers.table.caption"},board:{defaultMessage:"Kanban board, great for project planning and bug tracking",id:"collectionHelpers.board.caption"},calendar:{defaultMessage:"Month view, for event planning and scheduling",id:"collectionHelpers.calendar.caption"},list:{defaultMessage:"A simplified page view, great for bookmarks and notes",id:"collectionHelpers.list.caption"},gallery:{defaultMessage:"Grid of cards, use for mood boards, index cards, and recipes",id:"collectionHelpers.gallery.caption"},timeline:{defaultMessage:"A timeline view, great for project scheduling and planning",id:"collectionHelpers.timeline.caption"},page:{defaultMessage:"A page view for organizing pages hierarchically, great for documents and wikis",id:"collectionHelpers.page.caption"}}),E={table:v.default.formatMessage(R.table),board:v.default.formatMessage(R.board),calendar:v.default.formatMessage(R.calendar),list:v.default.formatMessage(R.list),gallery:v.default.formatMessage(R.gallery),timeline:v.default.formatMessage(R.timeline),page:v.default.formatMessage(R.page)},F={table:p.t,board:s.i,calendar:l.N,list:d.O,gallery:c.n,timeline:u._,page:d.O},N=(n.Z.images.tooltips.views.tablePng,n.Z.images.tooltips.views.boardPng,n.Z.images.tooltips.views.calendarPng,n.Z.images.tooltips.views.listPng,n.Z.images.tooltips.views.galleryPng,n.Z.images.tooltips.views.timelinePng,n.Z.images.tooltips.views.listPng,{table:void 0,board:"board_cover",calendar:void 0,list:void 0,gallery:"gallery_cover",timeline:void 0,page:void 0}),j={table:void 0,board:"board_cover_size",calendar:void 0,list:void 0,gallery:"gallery_cover_size",timeline:void 0,page:void 0},O={table:void 0,board:"board_cover_aspect",calendar:void 0,list:void 0,gallery:"gallery_cover_aspect",timeline:void 0,page:void 0},L={table:!0,board:!1,calendar:!1,list:!0,gallery:!0,timeline:!0,page:!1};function U(e){const t=e.getType(),o=e.getTitleStore();return t&&(0,r.dM)(t)&&o?o:e.getBlockTitleStore()}function Z(e,t){let o=[];switch(t){case"gallery":e&&e.gallery_properties&&(o=e.gallery_properties);break;case"board":e&&e.board_properties&&(o=e.board_properties)}const n=o.find((e=>{let{property:t}=e;return"title"===t}));return!!n&&Boolean(n.visible)}const V=["text","number","select","multi_select","status","date","person","ai_summary","ai_extract","ai_custom_prompt","ai_translate","file","checkbox","url","email","phone_number","formula","relation","rollup","created_time","created_by","last_edited_time","last_edited_by","button","auto_increment_id","location","verification"];function q(e){if((0,i.XU)(e))switch(e){case"ai_custom_prompt":case"ai_extract":case"ai_summary":case"ai_translate":return"suggested";default:throw(0,f.t1)(e)}return"standard"}function z(e){let{isSyncedCollection:t,collectionContextStore:o,environment:n}=e;const r=S.default.checkGate("database_sync_ugc");return V.filter((e=>{if((0,i.XU)(e)){const t=o.collectionStore();if(!t)return!1;const r=_.Z.getMode(n,t);return t.isTypedCollection()?"suggested"!==q(e)&&(0,k.mX)(n,r,t):(0,k.mX)(n,r,t)}return!(!r&&t&&!(0,i.Of)(e))&&!!((0,I.QI)("dev_or_beta")&&"collectionTypedView"===o.contextType||"location"!==e)}))}function W(e){let{propertySchema:t,property:o,blockStores:n,collectionSchema:r}=e;return 0!==n.length&&((0,i.iE)(t)?n.every((e=>H(t,e,r))):!(0,i.ZY)(t.type)&&!(0,a.wl)(o))}function H(e,t,o){const n=e.verifier_property;if(!n)return!1;const r=t.getPropertyValue(n),i=(0,a.DW)({textValue:r,propertySchema:o[n],blockCreatorPointer:t.getCreatedByPointer()}),s=b.default.state.currentUserRootStore;return!!s&&i.some((e=>e.id===s.id&&e.table===g.KJ))}function G(e){const{collectionStore:t,environment:o,intl:n,queryForFilter:r}=e;if(""===r)return!0;return(0,x.vU)({environment:o,intl:n,store:t}).toUpperCase().includes(r.toUpperCase())}function K(){var e;const t=(null===(e=w.default.state.data)||void 0===e?void 0:e.addOns)??[];return(0,h.de)(t)}function $(e,t){for(const o of t)void 0===e[o]&&delete e[o]}function Y(e){const t=m.Xh(e.loader);if($(t,["sort","reducerDependencies","searchQuery","upwardTraversalRelation","vectorSearch","filter"]),t.reducers)for(const o of Object.values(t.reducers))switch(o.type){case"results":$(o,["filter","searchQuery","loadContentCover"]);break;case"groups":$(o,["filter"]);break;case"aggregation":$(o,["filter"]),void 0===o.aggregation.property&&$(o.aggregation,["property"])}return{collectionView:e.collectionView,source:e.source,loader:t}}},48543:(e,t,o)=>{o.d(t,{LQ:()=>p,Ls:()=>l,RI:()=>u,RO:()=>m});var n=o(17683),r=o(31490),i=o(32240),a=o(5366),s=o(33929);const l={table:"side_peek",board:"side_peek",calendar:"center_peek",list:"side_peek",gallery:"center_peek",timeline:"side_peek",page:"side_peek"},c=(0,a.defineMessages)({side_peek:{defaultMessage:"Side peek",id:"database.viewPropertiesMenu.peekMode.sidePeek"},center_peek:{defaultMessage:"Center peek",id:"database.viewPropertiesMenu.peekMode.centerPeek"},full_page:{defaultMessage:"Full page",id:"database.viewPropertiesMenu.peekMode.fullPage"}}),d=(0,a.defineMessages)({side_peek:{defaultMessage:"Open pages on the side. Keeps the view behind interactive.",id:"database.viewPropertiesMenu.peekMode.description.sidePeek"},center_peek:{defaultMessage:"Open pages in a focused, centered modal.",id:"database.viewPropertiesMenu.peekMode.description.centerPeek"},full_page:{defaultMessage:"Open pages in full page.",id:"database.viewPropertiesMenu.peekMode.description.fullPage"}}),p=e=>{switch(e){case"side_peek":return s.default.formatMessage(c.side_peek);case"center_peek":return s.default.formatMessage(c.center_peek);case"full_page":return s.default.formatMessage(c.full_page)}},u=e=>{switch(e){case"side_peek":return s.default.formatMessage(d.side_peek);case"center_peek":return s.default.formatMessage(d.center_peek);case"full_page":return s.default.formatMessage(d.full_page)}},m=e=>{switch(e){case"side_peek":return i.y;case"center_peek":return n.Q;case"full_page":return r.M}}},65742:(e,t,o)=>{o.d(t,{AZ:()=>W,B8:()=>j,BJ:()=>C,C1:()=>K,DS:()=>V,EW:()=>J,GK:()=>U,Ge:()=>k,Gz:()=>A,H5:()=>M,HZ:()=>Se,Ii:()=>ce,Ip:()=>z,Ne:()=>pe,PF:()=>Z,Qw:()=>he,S7:()=>v,ST:()=>R,TW:()=>F,Tp:()=>ie,WD:()=>ve,Wk:()=>b,XO:()=>N,YE:()=>ye,YP:()=>le,Zn:()=>me,_Q:()=>oe,_e:()=>P,al:()=>O,bK:()=>L,bk:()=>E,cK:()=>q,d$:()=>G,e$:()=>D,fc:()=>te,fj:()=>$,i2:()=>_,lf:()=>S,lx:()=>x,pQ:()=>ae,pe:()=>de,ph:()=>be,px:()=>w,qG:()=>X,rr:()=>re,vX:()=>fe,x2:()=>B,xI:()=>Y,xJ:()=>Q,xP:()=>ne,xd:()=>ge,y1:()=>ue,yk:()=>ee});var n=o(30120),r=o(13991),i=o(49085),a=o(30823),s=o(99036),l=o(80951),c=o(40506),d=o(7057),p=o(53877),u=o(6695),m=o(42875),g=o(15157),h=o(97880),f=o(77794),y=o(77181);const v=5,b=3,S=2,_=21;let w=function(e){return e[e.LeftResizer=0]="LeftResizer",e[e.RightResizer=1]="RightResizer",e[e.ItemDrag=2]="ItemDrag",e}({});const k=4e3,x=k/4,I=864e5,C={hours:{snapUnit:"fifteen_minutes",primaryDisplayUnit:"fifteen_minutes",secondaryDisplayUnit:"day",activeRangeType:void 0,msPerPixel:I/7e3,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"fifteen_minutes",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:9,getDateRangePlaceholderDuration:e=>e.plus({hour:1})},day:{snapUnit:"fifteen_minutes",primaryDisplayUnit:"hour",secondaryDisplayUnit:"day",activeRangeType:void 0,msPerPixel:69120,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"hour",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:2,getDateRangePlaceholderDuration:e=>e.plus({hour:3})},week:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:48e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:"day",showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:1})},bi_week:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:108e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:void 0,showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:3})},month:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:216e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:void 0,showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:5})},quarter:{snapUnit:"day",primaryDisplayUnit:"week",secondaryDisplayUnit:"month",activeRangeType:"display_range",msPerPixel:72e5,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"month",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:35,getDateRangePlaceholderDuration:e=>e.plus({week:2})},year:{snapUnit:"day",primaryDisplayUnit:"week",secondaryDisplayUnit:"month",activeRangeType:"display_range",msPerPixel:I/5,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"month",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:6,getDateRangePlaceholderDuration:e=>e.plus({week:4})}},T="month";function M(e){var t;return null===(t=P(e))||void 0===t?void 0:t.property}function P(e){const t=e.normalizedFormatStore.state.timeline_arrows_by;if(null==t||!t.property)return;const o=e.normalizedSchemaStore.state[t.property],n=e.collectionStore();return o&&"relation"===o.type&&o.property&&n&&(0,s.F0)(o)===n.id?{property:t.property,inverse:o.property}:void 0}function A(e){return{zoomLevel:i.default.createValue(T),currentRange:i.default.createValue({startTimestamp:0,endTimestamp:0}),dragState:i.default.createValue(void 0),drawState:i.default.createValue(void 0),hoveredItem:i.default.createValue(void 0),dateRangePlaceholder:i.default.createValue({active:!1}),scrollLeft:i.default.createValue(void 0),outerSizeObserver:new f.E,timelineSizeObserver:new f.E,horizontalScroller:void 0,savePreference:void 0,isFullScreen:e.isFullScreen,isRootChild:e.isRootChild,destroyed:!1}}function D(e,t){return t/C[e].msPerPixel}function B(e,t){return t*C[e].msPerPixel}function R(e){return"fifteen_minutes"===e||"hour"===e}function E(e){const{store:t,query:o,schema:n,userId:r,intl:i}=e,l=t.getModel();if(!l)return;const{timeline_by:c,timeline_by_end:d}=o;if(!c)return;const u=n[c];if(!u||!(0,s.Lt)(u))return;const g=(0,a.FT)({property:c,schema:n,block:l,getRecordModel:t.getRecordModel,propertyMapping:void 0,collectionRequestContext:{userId:r,userTimeZone:(0,m.r)(),depth:0,intl:i,visitedProperties:new Set,resultCache:new Map}}).next().value;if("date"!==(null==g?void 0:g.type))return;const h=g.value;if(!d||c===d)return h;{const e=n[d];if(!e||!(0,s.Lt)(e))return;const o=(0,a.FT)({property:d,schema:n,block:l,getRecordModel:t.getRecordModel,propertyMapping:void 0,collectionRequestContext:{userId:r,userTimeZone:(0,m.r)(),depth:0,intl:i,visitedProperties:new Set,resultCache:new Map}}).next().value;if(o&&"date"===o.type){const e=o.value,t=p.rH(h,e);if(t)return p.Qq(t)}}}function F(e){const{store:t,dateValue:o,query:n,schema:r}=e,{timeline_by:i,timeline_by_end:a}=n;if(!i)return;const d=r[i];if(d&&(0,s.Lt)(d)){if(!a||i===a)return{[i]:(0,l.d7)(o)};{const e=r[a];if(!e||!(0,s.Lt)(e))return;const n=(0,l.Gl)(t.getPropertyValue(i)),d=(0,l.Gl)(t.getPropertyValue(a));if("date"===o.type)return{[i]:(0,l.d7)({type:"date",start_date:o.start_date,reminder:c.V3(n)}),[a]:(0,l.d7)({type:"date",start_date:o.start_date,reminder:c.V3(d)})};if("daterange"===o.type)return{[i]:(0,l.d7)({type:"date",start_date:o.start_date,reminder:c.V3(n)}),[a]:(0,l.d7)({type:"date",start_date:o.end_date,reminder:c.V3(d)})};if("datetime"===o.type)return{[i]:(0,l.d7)({type:"datetime",start_date:o.start_date,start_time:o.start_time,time_zone:o.time_zone,reminder:c._3(n)}),[a]:(0,l.d7)({type:"datetime",start_date:o.start_date,start_time:o.start_time,time_zone:o.time_zone,reminder:c._3(d)})};if("datetimerange"===o.type)return{[i]:(0,l.d7)({type:"datetime",start_date:o.start_date,start_time:o.start_time,time_zone:o.time_zone,reminder:c._3(n)}),[a]:(0,l.d7)({type:"datetime",start_date:o.end_date,start_time:o.end_time,time_zone:o.time_zone,reminder:c._3(d)})};(0,h.t1)(o)}}}function N(e,t){const o=R(t),n=p.NK(o?e:c.Dy(e),(0,m.r)()),r=V(n.start,t),i=o&&"date"===e.type?n.start.plus({days:1}).startOf("day"):n.end||r;return{start:r,end:o?V(i,t):z(i,t)}}function j(e){return`timeline:${e}`}function O(e){const{horizontalScroller:t,outerSizeObserver:o}=e,n=e.zoomLevel.state,{startTimestamp:r}=e.currentRange.state;return r+B(n,(t?t.scrollLeft:0)+o.rect.state.width/2)}function L(e){const{environment:t,timestamp:o,timelineState:n,paddingLeft:r,format:i}=e;return o-B(n.zoomLevel.state,Y({environment:t,paddingLeft:r,format:i,isFullScreen:n.isFullScreen,isRootChild:n.isRootChild})/2)}function U(e){const{environment:t,timestamp:o,timelineState:n,paddingLeft:r,format:i}=e;return o-B(n.zoomLevel.state,Y({environment:t,paddingLeft:r,format:i,isFullScreen:n.isFullScreen,isRootChild:n.isRootChild})-n.outerSizeObserver.rect.state.width/2)}function Z(e){const{timestamp:t,timelineState:o}=e;return t+B(o.zoomLevel.state,-o.outerSizeObserver.rect.state.width/2)}function V(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15);return e.set({minute:t}).startOf("minute")}return e.startOf(t)}function q(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15)-15;return e.set({minute:t}).startOf("minute")}return e.startOf(t).minus({[t]:1}).startOf(t)}function z(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15)+15;return e.set({minute:t}).startOf("minute")}return e.plus({[t]:1}).startOf(t)}function W(e){const{startValue:t,snapUnit:o,desiredStart:n,desiredEnd:r}=e;let i=t;const a=c.Ze(t)||(0,m.r)();if(n){const e=H(n,o,"start",a);if("datetime"===e.type)if("date"===i.type){const e={type:"daterange",start_date:i.start_date,end_date:i.start_date};i=p.bD(e,(0,m.r)())}else"daterange"===i.type&&(i=p.bD(i,(0,m.r)()));"date"===i.type?i={...i,type:"daterange",start_date:e.start_date,end_date:i.start_date}:"daterange"===i.type?i={...i,type:"daterange",start_date:e.start_date,end_date:i.end_date}:"datetime"===i.type?i={...i,type:"datetimerange",start_date:e.start_date,start_time:"datetime"===e.type?e.start_time:i.start_time,end_date:i.start_date,end_time:i.start_time}:"datetimerange"===i.type&&(i={...i,type:"datetimerange",start_date:e.start_date,start_time:"datetime"===e.type?e.start_time:i.start_time})}if(r){const e=H(r,o,"end",a);if("datetime"===e.type)if("date"===i.type){const e={type:"daterange",start_date:i.start_date,end_date:i.start_date};i=p.bD(e,(0,m.r)())}else"daterange"===i.type&&(i=p.bD(i,(0,m.r)()));"date"===i.type||"daterange"===i.type?i={...i,type:"daterange",end_date:e.start_date}:"datetime"!==i.type&&"datetimerange"!==i.type||(i={...i,type:"datetimerange",end_date:e.start_date,end_time:"datetime"===e.type?e.start_time:"datetimerange"===i.type?i.end_time:i.start_time})}return c.qW(i)}function H(e,t,o,n){const r=q(e,t),i=V(e,t),a=z(e,t),s=R(t);let l;return l="start"===o?e.valueOf()>=i.valueOf()+(i.valueOf()-r.valueOf())/2?a:i:e.valueOf()>=i.valueOf()+(i.valueOf()-r.valueOf())/2?s?a:i:s?i:r,function(e,t,o){return R(t)?p.CQ(e.valueOf(),o):p.hT(e.valueOf(),o)}(l,t,n)}function G(e){const{environment:t,isFullScreen:o,isRootChild:n}=e;return(t.device.isDesktop||t.device.isTablet)&&(o||n)}function K(e){const{environment:t,format:o,isFullScreen:n,isRootChild:r}=e;return G({environment:t,isFullScreen:n,isRootChild:r})&&Boolean(o.timeline_show_table)}function $(e){const{isFullScreen:t,isRootChild:o}=e;return!t&&o&&K(e)}function Y(e){const{environment:t,paddingLeft:o,format:n,isFullScreen:r,isRootChild:i}=e;if(!K({environment:t,format:n,isFullScreen:r,isRootChild:i}))return 0;return o+(n.timeline_table_properties||[]).reduce(((e,t)=>(t.width&&t.visible?t.width:0)+e),0)}function Q(){const e=n.ou.now().setLocale(r.SP);return e.toLocaleString(n.ou.TIME_SIMPLE)===e.toLocaleString(n.ou.TIME_24_SIMPLE)}function J(e,t,o){return"day"===o?(0,d.Yx)(t,"month_day_long",e):"month"===o?(0,d.Yx)(t,"month_long",e):void(0,h.t1)(o)}function X(e,t){return"day"===t?(0,d.Yx)(e,"long",r.SP):"month"===t?(0,d.Yx)(e,"month_year_long",r.SP):void(0,h.t1)(t)}function ee(e,t){const o=p.NK(e,c.Ze(e)||(0,m.r)(),r.SP),{primaryDisplayUnit:n}=C[t],i="fifteen_minutes"===n||"hour"===n?"month_day_time":"month_day";return(0,d.Yx)(o.start.valueOf(),i,r.SP)}function te(e,t){const o=p.NK(e,c.Ze(e)||(0,m.r)(),r.SP),{primaryDisplayUnit:n}=C[t],i=(o.end||o.start).valueOf(),a="fifteen_minutes"===n||"hour"===n?"month_day_time":"month_day";return(0,d.Yx)(i,a,r.SP)}function oe(e,t){const o=p.NK(e,c.Ze(e)||(0,m.r)(),r.SP),{primaryDisplayUnit:n}=C[t],i="fifteen_minutes"===n||"hour"===n?"medium_with_time":"medium",a=(0,d.Yx)(o.start.valueOf(),i,r.SP);return o.end?`${a} â†’ ${(0,d.Yx)(o.end.valueOf(),i,r.SP)}`:a}function ne(e,t){return V(e,t)<e?z(e,t):e}function re(e){return e.device.nativeScrollbarWidth>0||e.device.isFirefox||e.device.isPhone}function ie(e){return!(e.device.isFirefox||e.device.isMobile)}function ae(e,t){const o=t.currentUser.id,n=e.getFormat().timeline_preference,r=j(e.id),i=g.Z.get({userId:o,key:r}),a={zoomLevel:T,centerTimestamp:Date.now()};return se(i)||se(n)||a}function se(e){if(e&&"number"==typeof e.centerTimestamp&&u.H.includes(e.zoomLevel))return e}function le(e,t){let o=e.timeline_table_properties||[];if(t){o.find((e=>{let{visible:t}=e;return Boolean(t)}))||(o=(0,u.Rt)(o,"title",!0))}return{timeline_show_table:t,timeline_table_properties:o}}function ce(e){const{environment:t,collectionContextStore:o,timelineState:n,isFullScreen:r,isRootChild:i}=e,a=n.zoomLevel.state,s=o.normalizedFormatStore.state,l=K({environment:t,format:s,isFullScreen:r,isRootChild:i}),c=l&&s.timeline_table_properties?s.timeline_table_properties.length:0,d=s.timeline_properties||[],p=d.filter((e=>"title"!==e.property));return{zoom_level:a,show_table:l,show_table_properties_count:c,show_timeline_title:d.length!==p.length,show_timeline_properties_count:p.length}}const de=33,pe=66,ue=22,me=33,ge=4,he=96;function fe(e){return e?de:pe}function ye(e,t,o){if(!t)return[];const n=M(e);if(!n)return[];const r=t.getPropertyValue(n),i=o[n];return r&&i&&"relation"===i.type?(0,l.j$)({relationValue:(0,l.rq)(r),propertySchema:i,getRecordModel:t.getRecordModel}):[]}function ve(e,t,o){var n;if(!t)return[];const r=null===(n=(0,y.T6)(e))||void 0===n?void 0:n.property;if(!r)return[];const i=t.getPropertyValue(r),a=o[r];return i&&a&&"relation"===a.type?(0,l.j$)({relationValue:(0,l.rq)(i),propertySchema:a,getRecordModel:t.getRecordModel}):[]}function be(e,t,o){var n;if(!t)return[];const r=null===(n=(0,y.wf)(e))||void 0===n?void 0:n.property;if(!r)return[];const i=t.getPropertyValue(r),a=o[r];return i&&a&&"relation"===a.type?(0,l.j$)({relationValue:(0,l.rq)(i),propertySchema:a,getRecordModel:t.getRecordModel}):[]}function Se(e){const{timelineState:t,placeholderDate:o,subitemPlaceholderDate:n}=e,r=n??e.dateValue;if(!r)return;const i=t.zoomLevel.state,{snapUnit:a}=C[i],{startTimestamp:s,endTimestamp:l}=t.currentRange.state,{start:c,end:d}=N(r,a),p=d.valueOf()>s&&c.valueOf()<l,u=D(i,c.valueOf()-s)+2,m=n?Math.max(u+40,0):Math.max(u,0),g=D(i,d.valueOf()-s)-2,h=D(i,l-s),f=Math.min(g,h),y=f/D(i,l-s);return{visible:p,isPlaceholder:Boolean(o),isExistingSubitemPlaceholder:Boolean(n),left:m,right:f,maskPercent:y}}},78316:(e,t,o)=>{o.d(t,{Bm:()=>je,Bs:()=>pe,Cc:()=>me,Ch:()=>be,D:()=>fe,D2:()=>ae,D8:()=>Y,HI:()=>K,Ks:()=>ce,L5:()=>ve,Mq:()=>V,NG:()=>ne,NU:()=>te,PD:()=>G,PI:()=>W,Ql:()=>Ee,SY:()=>Te,Sc:()=>xe,Se:()=>H,VM:()=>ie,Vv:()=>ge,XO:()=>Se,YG:()=>we,YL:()=>ye,_5:()=>de,az:()=>re,b1:()=>Ne,bW:()=>Fe,bd:()=>oe,bu:()=>q,eD:()=>he,eL:()=>Re,en:()=>le,fk:()=>De,fm:()=>Ae,kr:()=>ke,mb:()=>Ce,p1:()=>se,pB:()=>Ie,rD:()=>ue,v_:()=>Be,w0:()=>_e,wK:()=>ee,xy:()=>Q,zm:()=>$});o(21703),o(30541),o(57658);var n=o(15145),r=o(41432),i=(o(14714),o(99036)),a=o(80951),s=o(43690),l=o(8848),c=o(93824),d=o(76837),p=o(95538),u=o(6695),m=o(72126),g=o(4615),h=o(71644),f=o(98963),y=o(21202),v=o(6287),b=o(13493),S=o(19889),_=o(70203),w=o(97880),k=o(5366),x=o(35541),I=o(95477),C=o(58202),T=o(24646),M=o(80444),P=o(77080),A=o(88923),D=o(35661),B=o(27724),R=o(28020),E=o(4708),F=(o(52821),o(48543)),N=o(75081),j=o(84210),O=o(33929),L=o(85957),U=o(17311),Z=o(35328);(0,k.defineMessages)({status:{id:"database.viewHelpers.selectProperty.defaultName",defaultMessage:"Status"},date:{id:"database.viewHelpers.dateProperty.defaultName",defaultMessage:"Date"}});const V={showDelay:500,showHold:100},q=new Set(["gallery","list","calendar"]),z=(0,k.defineMessages)({addTypedItemTitle:{id:"collectionViewBlock.action.newItem.typedDatabaseTitle",defaultMessage:"New {singleItemName}"},addItemTitle:{id:"collectionViewBlock.action.newItem.nonTypedDatabaseTitle",defaultMessage:"New"}});function W(e){return"collectionTypedView"===e.contextType?O.default.formatMessage(z.addTypedItemTitle,{singleItemName:(0,N.sN)(e.databaseType)}):O.default.formatMessage(z.addItemTitle)}function H(e){const t=Object.keys(e);return t.find((t=>{const o=e[t];return Boolean(o&&"status"===o.type)}))||t.find((t=>{const o=e[t];return Boolean(o&&"select"===o.type)}))||t.find((t=>{const o=e[t];return Boolean(o&&"person"===o.type)}))||t.find((t=>{const o=e[t];return Boolean(o&&"multi_select"===o.type)}))||t.find((t=>{const o=e[t];return Boolean(o&&"relation"===o.type)}))}function G(e){const t=Object.keys(e);return t.find((t=>{const o=e[t];return Boolean(o&&"date"===o.type)}))||t.find((t=>{const o=e[t];return Boolean(o&&"created_time"===o.type)}))||t.find((t=>{const o=e[t];return Boolean(o&&"last_edited_time"===o.type)}))}function K(e){return Object.keys(e).find((t=>{const o=e[t];return Boolean(o&&"date"===o.type)}))}function $(e){const{collectionId:t,schema:o,property:n,targetCollectionStore:r}=e,s=o[n];if(!s)return;const l={newSchema:{...o,[n]:void 0},deletedSchema:{[n]:m.Xh(o[n])}};if("relation"===s.type&&i.F0(s)&&s.property&&!(0,a.Kp)(s)){var c;const e=null===(c=l.deletedSchema)||void 0===c?void 0:c[n];if(P.default.checkGate("two_way_property_clear_on_delete")&&"relation"===(null==e?void 0:e.type)&&(e.property=void 0),i.F0(s)===t&&s.property!==n){const e={...l.newSchema,[s.property]:void 0},t={...l.deletedSchema,[s.property]:o[s.property]};l.newSchema=e,l.deletedSchema=t}else if(i.F0(s)!==t&&null!=r&&r.canEditCollection()&&r.isDefined()){const e=i.oC({schema:r.getSchema(),format:r.getFormat(),space_id:r.getSpaceId()}),t={...e,[s.property]:void 0},o=m.Xh(e[s.property]);P.default.checkGate("two_way_property_clear_on_delete")&&"relation"===(null==o?void 0:o.type)&&(o.property=void 0);const n={[s.property]:o};l.otherCollectionId=r.id,l.otherCollectionSchema=t,l.otherCollectionDeletedSchema=n}}return l}function Y(e){const{deletedSchema:t,property:o}=e;if(t[o])return{updateSchema:{[o]:t[o]},updateDeletedSchema:{[o]:null}}}async function Q(e){const{environment:t,schema:o,properties:n,property:r,parentStore:a,spaceId:s}=e,l=o[r];if(!l)return;if(i.dx(l))return;const c=(0,h.ZP)(),p={...l,name:(0,d.nM)(l.name)},u=n.findIndex((e=>e.property===r)),m=n[u],y={property:c,visible:!0,width:m&&m.width},v=[...n];let b;if(v.splice(u+1,0,y),"button"===p.type&&p.automation_id){const e=D.Mz.createChildStore(a,{table:f.cv,id:p.automation_id,spaceId:s});await e.load();const o=e.getActionStores();await Promise.all(o.map((e=>e.load())));const n=e.getValue(),r=o.map((e=>e.getValue()));if(!n||!r.every(w.$K))throw new Error("Automation or AutomationActions were not defined.");const i={...n,id:(0,g.ZP)()},l=r.map((e=>{const o={...e,id:(0,g.ZP)()};return(0,d.t1)({original:e,duplicate:o,newParentId:i.id,getRecordRole:a.inMemoryRecordCache.makeGetRecordRoleFn(t.currentUser.id)}),o})),c=t.currentUser.id,u=c?{id:c,table:S.KJ}:void 0;(0,d.tV)({duplicate:i,newParentId:i.parent_id,newActionIds:l.map((e=>e.id)),originOptions:{baseUrl:I.default.domainBaseUrl,publicDomainName:I.default.publicDomainName},options:{},actor:u}),p.automation_id=i.id,b={newAutomationValue:i,newAutomationActionValues:l}}return{newProperty:c,newPropertySchema:p,newProperties:v,automationUpdate:b}}function*J(e){const{rootStore:t,depth:o=0}=e;if(t.getType()===r.Ti.transclusionReference){const e=t.getTransclusionReferenceTargetStore();e&&(yield*J({rootStore:e,depth:o}))}else{const e=t.getContentStores();for(const t of e)yield{blockStore:t,depth:o},t.isNavigableBlock()||(0,Z.BX)(t)||(yield*J({rootStore:t,depth:t.getType()===r.Ti.columnList||t.getType()===r.Ti.column||t.getType()===r.Ti.transclusionContainer||t.getType()===r.Ti.transclusionReference?o:o+1}))}}function X(e,t){const o={image:void 0,blocks:[],isDefined:!0},n=J({rootStore:e});let i=0,a=0;for(const{blockStore:l,depth:c}of n){if(i++,i>s.C7)return o;l.isDefined()||(o.isDefined=!1);const e=l.getType(),n=l.getModel();if(!e||!n)continue;const d=l.getProperties();if(n.isType(r.Ok)&&!o.image&&d){const t=(0,_.QaF)(d.source);if(t&&((0,p.SR)({url:t})||e===r.Ti.image))return o.image={pointer:{table:"block",id:l.id},url:t},o}const u=(0,r.nq)(e),m=n.isType(r.MV)&&(!l.isEmptyTitle()||u),g=t&&void 0!==(0,x.u)(l);(m||g)&&a<s.Uo&&(o.blocks.push({blockStore:l,depth:c}),u||a++)}return o}function ee(e,t){const{image:o,blocks:n,isDefined:r}=X(e,t);return o?{image:o,blockIds:[],isDefined:r}:{image:void 0,blockIds:n.map((e=>e.blockStore.id)),isDefined:r}}function te(e,t){const{image:o,blocks:n,isDefined:i}=X(e,t);if(o)return{image:o,blockIds:[],isDefined:i};return{image:void 0,blockIds:n.filter((e=>{const{blockStore:t,depth:o}=e;return 0===o&&t.getType()!==r.Ti.transclusionReference&&t.getType()!==r.Ti.transclusionContainer})).map((e=>e.blockStore.id)),isDefined:i}}function oe(e){const t=e.isFullScreen.state,o=e.collectionViewStore();if(!o)throw new Error("Collection view store not defined.");const n=e.normalizedFormatStore.state,r=o.isDefined()&&"board"===o.getType(),i=n.collection_group_by;if(!t||i){const e=u.rx(n.inline_collection_first_load_limit,Boolean(i));if("load_limit"===e.type)return e.limit}return r?20:t?50:20}function ne(e){const{collectionViewStore:t,isFullScreen:o,currentResultCount:n}=e;return t.isDefined()&&"board"===t.getType()?20:o||n<=50?50:100}function re(e,t){const o=e.collectionViewStore();if(!o)return!1;const n=o.getFormat();return!t||Boolean(n.collection_group_by)}function ie(e){const{collectionContextStore:t,isFullScreen:o,reducerResult:n}=e;return n&&n.blockIds.length>0&&!((r=n)&&!r.hasMore)&&re(t,o);var r}function ae(e){const{query:t,schema:o}=e,{timeline_by:n,timeline_by_end:r}=t;if(n){const e=o[n];if(e&&"date"!==e.type)return!1}if(r){const e=o[r];if(e&&"date"!==e.type)return!1}return!0}function se(e){const t=e.getParentBlockStore();return Boolean(t&&t.isLocked())}function le(e){return(0,L.wq)(e)}function ce(e){return A.default.isSidePeekOpen()&&!le(e)&&!e.isImmediateColumnChild()&&(e.isRootOrDirectChild()||"page"===e.getType())}function de(e){const t=e.getRecordStoreUIRoot();return!!(t&&t instanceof D.G)&&t.isFullWidth()}function pe(e){const{environment:t,isFullScreen:o,store:n,sizeObserver:r,viewType:i}=e,{device:a,WindowSizeStore:s}=t,l=n.isRootOrDirectChild();if(!o&&!l&&"gallery"===i)return{paddingLeft:1,paddingRight:1};if(l){if(le(n))return{paddingLeft:A.PeekModePadding.horizontal[A.default.state.mode],paddingRight:A.PeekModePadding.horizontal[A.default.state.mode]};if(a.isPhone)return{paddingLeft:s.getSafePaddingLeftPx((0,R.ui)(t)),paddingRight:s.getSafePaddingRightPx((0,R.ui)(t))};if(o)return{paddingLeft:96,paddingRight:96};if(de(n)||function(e,t){const{WindowSizeStore:o}=e;return o.state.width-((0,T.Wk)(e)+(0,T.ll)(e,t)-(0,T.vJ)(e))<R.CC}(t,le(n))||ce(n)&&!A.default.isSidePeekClosing.state)return{paddingLeft:(0,R.ui)(t),paddingRight:(0,R.ui)(t)};{const e=r.rect.state.width;if(0===e)return;const o=(e-(R.CC-2*(0,R.ui)(t)))/2;return{paddingLeft:o,paddingRight:o}}}return{paddingLeft:0,paddingRight:0}}function ue(e){switch(e){case"large":return U.Z.card.desktop.large.width;case"small":return U.Z.card.desktop.small.width;case"medium":default:return U.Z.card.desktop.medium.width}}function me(e){let{collectionViewName:t,collectionViewType:o}=e;return t||O.default.formatMessage(Ne[o])}function ge(e){var t;return((null===(t=e.getParentBlockStore())||void 0===t?void 0:t.getCollectionViewsStore().getValue())||[]).map((t=>D.Xr.createChildStore(e,{table:b.n,id:t}))).find((e=>"table"===e.getType()))}function he(e){const{collectionStore:t,collectionViewBlockStore:o,checkNavigableAncestorLocked:n}=e;if(!o)return!1;if(n&&o.isNavigableAncestorLocked())return!1;const r=null==t?void 0:t.canEditCollection(),i=null==t?void 0:t.getParentBlockStore(),a=null==i?void 0:i.isLocked();return Boolean(r&&!a)}function fe(e,t){const o=e.getType();if(!o)return!1;if(""===t)return!0;return-1!==me({collectionViewName:e.getName(),collectionViewType:o}).toUpperCase().indexOf(t.toUpperCase())}function ye(e){const{newOptions:t,collectionId:o,property:n,schema:r}=e,a=r[n];if(!a)return;if(!i.cu(a)&&"status"!==a.type)return;const s=a.options||[],l=[],d=m.xH(t),p=s.map((e=>e.value)),{beforeOps:u}=(0,c.q)(p,d);for(const[i,c]of Object.entries(u)){const e=s.find((e=>e.value===i));if(e)if(c){const t=s.find((e=>e.value===c));if(t){const r={pointer:{table:v.v,id:o},command:"keyedObjectListBefore",path:["schema",n,"options"],args:{value:e,before:{id:t.id}}};l.push(r)}}else{const t={pointer:{table:v.v,id:o},command:"keyedObjectListAfter",path:["schema",n,"options"],args:{value:e}};l.push(t)}}if("status"===a.type){const e=a.groups??[];for(const[r]of e.entries()){const e=t[r];if(!Array.isArray(e))return;const i=s.filter((t=>e.includes(t.value))).map((e=>e.id)),a={pointer:{table:v.v,id:o},command:"set",path:["schema",n,"groups",r,"optionIds"],args:i};l.push(a)}}return l.length>0?l:void 0}function ve(e){const{collectionId:t,property:o,propertySchema:n,schema:r,isAscending:i}=e;return ye({newOptions:[...n.options||[]].map((e=>e.value)).sort(((e,t)=>e.localeCompare(t,void 0,{sensitivity:"base"})*(i?1:-1))),collectionId:t,property:o,schema:r})}function be(e){const{collectionId:t,property:o,propertySchema:n,newOption:r,isAscending:i}=e,a=n.options||[],s=m.cx(a,(e=>e.value.localeCompare(r.value,void 0,{sensitivity:"base"})*(i?1:-1)>=0));return-1!==s?{pointer:{table:v.v,id:t},command:"keyedObjectListBefore",path:["schema",o,"options"],args:{value:r,before:a[s]}}:{pointer:{table:v.v,id:t},command:"keyedObjectListAfter",path:["schema",o,"options"],args:{value:r}}}function Se(e){const{viewType:t,format:o}=e;return"board"===t?u.Lw(o.board_cover):"gallery"===t?u.Lw(o.gallery_cover):"timeline"===t&&u.vP(Boolean(o.timeline_show_table),o.timeline_table_properties||[])}function _e(e){const{viewType:t}=e;return"table"===t||("board"===t||("gallery"===t||void 0))}function we(e){const t=null==e?void 0:e.getType();if(!e||!t)return!1;return"full_page"===(e.getFormat().collection_peek_mode||F.Ls[t])}function ke(e){const t=null==e?void 0:e.getType();return(null==e?void 0:e.getFormat().collection_peek_mode)??(t?F.Ls[t]:"side_peek")}function xe(e){const{stores:t,phase:o}=B.default.state;return!(o===B.SelectionPhase.Selected&&t.indexOf(e)>=0)&&(A.default.state.open&&A.default.isSidePeekOpen()&&A.default.state.target.id===e.id)}function Ie(e,t){return e?{background:l.ZP.blueWithAlpha(.025),boxShadow:t.outlineUltraThinBlueInputBoxShadow,borderRadius:4}:{}}function Ce(e){const{store:t,mainEditorCurrentBlockStore:o,collectionContextStore:r,fullyQualified:i,overridePeekMode:a}=e,s=null==r?void 0:r.collectionViewStore();if(!a&&we(s))return(0,j.ZP)({store:t,fullyQualified:i,pageVisitSource:(null==r?void 0:r.getPageVisitSourceOverride())??n.tY.Expand});if(o){const e=null==r?void 0:r.getViewType(),l=(null==r?void 0:r.normalizedFormatStore.state.collection_peek_mode)??(e?F.Ls[e]:void 0),c=a??(0,A.getPeekModeFromCollectionPeekModeFormat)(l);return(0,j.ZP)({store:o,collectionViewId:null!=r&&r.isFullScreen.state?null==s?void 0:s.id:void 0,fullyQualified:i,peekViewBlockId:t.id,peekMode:(0,A.getUrlParamFromPeekMode)(c),pageVisitSource:(null==r?void 0:r.getPageVisitSourceOverride())??n.tY.PeekOpen})}}function Te(e){var t;const o=null===(t=e.getCollectionViewStores().find((e=>"page"===e.getType())))||void 0===t?void 0:t.getFormat().page_pointer;if(o)return D.G.createChildStore(e,{table:y.iU,id:null==o?void 0:o.id,spaceId:e.getSpaceId()})}function Me(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return null==e?void 0:e.findRecordStoreUIAncestor((o=>o instanceof D.G&&o.isCollectionView()&&(t||o.id!==e.id))).ancestor}function Pe(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=Me(e,t);if(o)return C.R.findCollectionViewBlockFromId(o.id)}function Ae(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const o=Pe(e,t);if(null!=o&&o.collectionContextStore)return o.collectionContextStore}function De(e){var t;let{environment:o,collectionContextStore:n}=e;const r=(0,E.zq)(o),{currentUserStore:i}=M.default.state;return!!i&&r&&n.permissionScopes.state.canEditContent&&"table"===(null===(t=n.collectionViewStore())||void 0===t?void 0:t.getType())}function Be(e,t){let o=t;return e.every((e=>{if(e.getType()===r.Ti.page||e.getType()===r.Ti.collectionViewPage){var t;const n=null===(t=Pe(e,!1))||void 0===t?void 0:t.props.store.id;return!!n&&(void 0===o&&(o=n),n===o)}return!1}))}function Re(e,t){return!e&&"table"===t}function Ee(e){return void 0!==e&&e>=0}function Fe(e){return Ee(e)?e+1:0}const Ne=(0,k.defineMessages)({board:{id:"database.collectionView.untitledName.board",defaultMessage:"Board"},gallery:{id:"database.collectionView.untitledName.gallery",defaultMessage:"Gallery"},timeline:{id:"database.collectionView.untitledName.timeline",defaultMessage:"Timeline"},calendar:{id:"database.collectionView.untitledName.calendar",defaultMessage:"Calendar"},list:{id:"database.collectionView.untitledName.list",defaultMessage:"List"},table:{id:"database.collectionView.untitledName.table",defaultMessage:"Table"},page:{id:"database.collectionView.untitledName.page",defaultMessage:"Page"}});function je(e){let{store:t,collectionContextStore:o}=e;return"collectionVirtualView"===o.contextType?o.collectionStore():t.getAssociatedCollectionStore()}},77181:(e,t,o)=>{o.d(t,{A7:()=>C,Af:()=>P,Av:()=>S,CJ:()=>w,F0:()=>y,Hw:()=>f,JR:()=>F,Ns:()=>T,SM:()=>M,T2:()=>L,T6:()=>v,bX:()=>_,fd:()=>E,g0:()=>N,gY:()=>h,kC:()=>x,ko:()=>j,uU:()=>B,wP:()=>O,wf:()=>b,xb:()=>k,yU:()=>D,yr:()=>I,zV:()=>A});o(57658);var n=o(76205),r=o(99036),i=o(80951),a=o(60246),s=o(42875),l=o(72126),c=o(95371),d=o(95802),p=o(35661),u=o(28020),m=o(78316),g=o(33929);const h=4,f=24,y=10;function v(e){const t=e.normalizedFormatStore.state.collection_view_subitem,o=e.collectionStore();if(!o||!o.getSchema()||!t)return;const n=o.getSchema()[t.property];if(!n||"relation"!==n.type||r.F0(n)!==o.id)return;const i=n.property;if(!i)return;const a=o.getSchema()[i];return a&&"relation"===a.type?{...t,inverse:i}:void 0}function b(e){var t;const o=null===(t=e.collectionStore())||void 0===t?void 0:t.getFormat().subitem_property,n=e.collectionStore();if(!n||!n.getSchema()||!o)return;const i=n.getSchema()[o];if(!i||"relation"!==i.type||r.F0(i)!==n.id)return;const a=i.property;if(!a)return;const s=n.getSchema()[a];return s&&"relation"===s.type?{property:o,inverse:a}:void 0}function S(e){return"table"===e||"timeline"===e||"list"===e}function _(e){var t;const o=(0,m.fm)(e),n=null==o||null===(t=o.collectionViewStore())||void 0===t?void 0:t.getType();return Boolean((null==o?void 0:o.currentSubitemFormatStore.state)&&n&&S(n))}function w(e){const{store:t,subitemFormat:o,propertySchema:n}=e,r=t.getPropertyValue(o.property),a=(0,i.rq)(r),s=t.getRecordModel;return i.j$({relationValue:a,propertySchema:n,getRecordModel:s})}function k(e){const{store:t,subitemFormat:o,propertySchema:n}=e,r=t.getPropertyValue(o.inverse),a=(0,i.rq)(r),s=t.getRecordModel;return i.j$({relationValue:a,propertySchema:n,getRecordModel:s})}function x(e){const{store:t,collectionStore:o,collectionContextStore:r,subitemFormat:i,subitemPathKey:a,propertyFilters:l,combinatorFilter:c,currentUserId:d}=e,m=o.getSchema()[i.property];if(!m||"relation"!==m.type)return[];const h=w({store:t,subitemFormat:i,propertySchema:m});if(0===h.length)return[];let f=h.filter((e=>!a.includes(e.id))).map((e=>p.G.createChildStore(t,e)));const y=r.relativeVariableStore.state,v={schema:r.normalizedSchemaStore.state,userId:d,userTimeZone:(0,s.r)(),userStartOfWeek:u.AK.state,intl:g.default.getIntl(),relativeVariableResult:y},b=new Map;if(l&&l.length>0||c){const e=(0,n.q)({filter:{filters:c?[...l.filter((e=>!(0,n.Oo)(e.filter))).map((e=>e.filter)),c]:l.filter((e=>!(0,n.Oo)(e.filter))).map((e=>e.filter)),operator:"and"},context:v});f=f.filter((t=>R({blockStore:t,compiledFilter:e,subitemFormat:i,propertySchema:m,visitedIds:new Set,resultCache:b})))}return f}function I(e,t){var o,n;const i=e.currentSubitemFormatStore.state;if(!i)return new c.DG([]);const d=e.collectionStore();if(!d)return new c.DG([]);const p=e.currentSortsStore.state,u=d.getRecordModel,m=a.$m({userTimeZone:(0,s.r)(),intl:g.default.getIntl(),userSorts:p,userId:e.getCurrentUserId(),apiSorts:[]}),h=e.normalizedSchemaStore.state[i.property],f=h&&"relation"===h.type&&r.F0(h)===(null===(o=e.collectionStore())||void 0===o?void 0:o.id)&&h.property,y=null===(n=e.collectionViewStore())||void 0===n?void 0:n.getType(),v=!f||y&&S(y)?void 0:{property:f,filter:{operator:"is_empty"}},b=[...v&&f?[{id:f,filter:v}]:[],...e.currentPropertyFiltersStore.state],_=e.currentCombinatorFilterStore.state,w=e.subitemExpandedStore.state,k=l.xH(e.groupsStore.getAllGroupStates().map((e=>e.resultsStore.state)));return new c.DG(k.map((o=>{const n=M(o);return(0,c.MW)(n,(o=>{let{store:n,pathKey:r}=o;const s=w.get(r);if(!s)return{value:{store:n,pathKey:r},children:[]};const c=function(e){const{store:t,collectionStore:o,collectionContextStore:n,subitemFormat:r,querySorts:i,limit:s,subitemPathKey:c,propertyFilters:d,combinatorFilter:p,currentUserId:u,getRecordModel:m}=e,g=x({store:t,collectionStore:o,collectionContextStore:n,subitemFormat:r,subitemPathKey:c,propertyFilters:d,combinatorFilter:p,currentUserId:u});if(!g)return[];const h=new a.EO([...i,...a.Xm(g.map((e=>e.id))??[])]),f=new Map;g.forEach((e=>{h.updateBlock({block:e.getModel(),schema:o.getSchema(),propertyMapping:void 0,getRecordModel:m,resultCache:f})}));const y=g.map((e=>e.id))??[],v=a.Qx(y,h),b={};return v.forEach(((e,t)=>{b[e]=t})),l.MR(g,(e=>b[e.id])).slice(0,s)}({store:n,collectionStore:d,collectionContextStore:e,subitemFormat:i,querySorts:m,limit:s.limit,subitemPathKey:r,propertyFilters:b,combinatorFilter:_,currentUserId:t,getRecordModel:u}).map((e=>({store:e,pathKey:A(r,e)})));return{value:{store:n,pathKey:r},children:c}}))})))}function C(e,t){const o=e?[e]:[],n=t.groupsStore.getGroupState(o);if(!n)return[];const r=n.resultsStore.state;if(!t.currentSubitemFormatStore.state)return r;const i=[],a=t.subitemTreeStore.state;for(const s of a.children)D({results:i,tree:s});return i}function T(e){return(0,c.CY)(e.children[e.children.length-1])}function M(e){return{store:e,pathKey:P([e.pointer])}}function P(e){return e.map((e=>e.id)).join(",")}function A(e,t){return e?`${e},${t.id}`:t.id}function D(e){const{results:t,tree:o}=e;t.push(o.value.store);for(const n of o.children)D({results:t,tree:n})}function B(e){var t,o;const{block:n,collectionContextStore:a}=e,s=null==a||null===(t=a.currentSubitemFormatStore.state)||void 0===t?void 0:t.inverse;if(!s)return!1;const l=a.normalizedSchemaStore.state[s];if(!l||!(0,r.p_)(l))return!1;const c=null===(o=a.collectionViewBlockStore())||void 0===o?void 0:o.getRecordModel;if(!c)return!1;return(0,i.Ds)({block:n,propertySchema:l,getRecordModel:c}).length>0}function R(e){const{blockStore:t,compiledFilter:o,subitemFormat:n,propertySchema:r,visitedIds:i,resultCache:a}=e;i.add(t.id);const s=t.getModel();if(!s)return!1;if(o({block:s,getRecordModel:t.getRecordModel,propertyMapping:void 0,resultCache:a}))return!0;const l=w({store:t,subitemFormat:n,propertySchema:r});return 0!==l.length&&l.map((e=>p.G.createChildStore(t,e))).filter((e=>!i.has(e.id))).some((e=>R({blockStore:e,compiledFilter:o,subitemFormat:n,propertySchema:r,visitedIds:i,resultCache:a})))}async function E(e){const{blockStore:t,compiledFilter:o,subitemFormat:n,propertySchema:r,subitemExpandedStore:a,pathKey:s,forceStoresToLoad:l,visitedIds:c}=e;if(await t.load(),c.has(t.id))return;c.add(t.id);const d=l?await async function(e){const{store:t,subitemFormat:o,propertySchema:n}=e,r=t.getPropertyValue(o.property),a=(0,i.rq)(r);await Promise.all(a.map((e=>p.G.createChildStore(t,e).load())));const s=t.getRecordModel;return i.j$({relationValue:a,propertySchema:n,getRecordModel:s})}({store:t,subitemFormat:n,propertySchema:r}):w({store:t,subitemFormat:n,propertySchema:r});if(0===d.length)return;a.state.set(s,{isExpanded:!0,limit:20});const u=new Map;for(const i of d){const e=p.G.createChildStore(t,i),d=e.getModel();if(!d)continue;o({block:d,getRecordModel:e.getRecordModel,propertyMapping:void 0,resultCache:u})||await E({blockStore:e,compiledFilter:o,subitemFormat:n,propertySchema:r,subitemExpandedStore:a,pathKey:A(s,e),forceStoresToLoad:l,visitedIds:c})}}function F(e){if(!e.collectionStore())return;const t=e.currentSubitemFormatStore.state,o=e.normalizedSchemaStore.state,n=(null==t?void 0:t.inverse)&&o[t.inverse],i=(null==t?void 0:t.property)&&o[t.property];if(!(i&&(0,r.p_)(i)&&n&&(0,r.p_)(n)))return;const a=n.property,s=i.property;return a&&s?{childRelationProperty:a,parentRelationProperty:s,childRelationSchema:n,parentRelationSchema:i,subitemFormat:t}:void 0}function N(e){const t=(0,m.fm)(e);if(t)return F(t)}function j(e){const t=e.getFormat().collection_default_subitem;if(!t)return;const o=e.getSchema()[t];if(!o||"relation"!==o.type)return;const n=o.property;return n?{property:t,inverse:n}:void 0}function O(e){if(!e.isType("page"))return!1;const t=(0,m.fm)(e);if(!t)return!1;return!!t.collectionStore()&&Boolean(t.currentSubitemFormatStore.state)}function L(e){let{blocks:t,parentRelationProperty:o,parentRelationSchema:n,collectionViewBlockStore:r}=e;const a=new Set;for(const i of t)a.add(i.id);return l.xH(t.map((e=>{const t=(e=>{const t=e.getPropertyValue(o);return i.j$({relationValue:i.rq(t),propertySchema:n,getRecordModel:e.getRecordModel})})(e),s=t.map((e=>e.id));if(0===t.length)return[p.G.createChildStore(r,e.pointer)];return d.C.findAllSelectablesFromIds(s.filter((e=>!a.has(e)))).map((e=>e.props.store)).map((t=>p.G.createChildStore(t,e.pointer)))})))}},43224:(e,t,o)=>{o.d(t,{F:()=>n,p:()=>r});const n={maxWidth:280,width:"max-content",overflowWrap:"break-word",textWrap:"wrap"},r=200},26991:(e,t,o)=>{o.d(t,{As:()=>p,Sh:()=>d,ki:()=>m,qf:()=>u});var n=o(76205),r=o(99036),i=o(23014),a=o(21202),s=o(6287),l=o(35661),c=o(29376);function d(e,t){return(0,i.oN)(e,t)}function p(e,t,o,n){const r=e.relativeVariableStore.state;if(r){const e=r[o.id],i=null==e?void 0:e[t];if(i){return l.G.createChildStore(n,{table:a.iU,id:i,spaceId:o.spaceId})}}}function u(e,t){if((0,n.e)(e.filter)){if(((0,n.vR)(e.filter)?(0,n.YO)(e.filter):[]).some((e=>"relative"===e.type)))return function(e,t){const o=t.getSchema()[e];return!(!o||!(0,r.p_)(o))&&(0,i.oN)((0,c.uJ)(o,t),(0,c.ke)(o,t))}(e.property,t)}return!0}function m(e,t,o){return!!e&&Object.values(e).some((e=>{if("groups"===e.type&&"relation"===e.groupBy.type){const n=e.groupBy.property,r=t[n];if(r.collection_pointer){const e=l.NW.createChildStore(o,{table:s.v,id:r.collection_pointer.id}),t=e.getFormat().app_config_uri;return t&&i.qB[t]&&e.isDefined()&&(0,i.oN)(e.getSchema(),t)}}return!1}))}},78175:(e,t,o)=>{o.d(t,{Po:()=>l,hF:()=>a,zE:()=>s});o(95477);var n=o(78316),r=o(77080),i=o(88923);function a(e){let t=e;for(;t&&(!t||!t.isNavigableBlock());){if("column"===t.getType())return!0;t=t.getParentBlockStore()}return!1}function s(e,t){const{device:o}=t;if(o.isPhone)return!1;if((0,n.en)(e)){return i.default.getSidePeekWidth(t.WindowSizeStore.state.width)>=i.sidePeekNoColumnWidth}return!0}function l(e,t){return!t.device.isMobile&&("on"===r.default.getGroup("columns-full-width")&&(e.isType("column_list")&&e.isChildOfRecordStoreUIRoot()&&s(e,t)&&!(null!==(o=e.getParentBlockStore())&&void 0!==o&&o.isFullWidth())&&!(0,n.en)(e)));var o}},78663:(e,t,o)=>{o.d(t,{$W:()=>m,FD:()=>h,Fu:()=>f,Xc:()=>g});var n=o(72126),r=o(97880),i=o(57819),a=o(30793),s=o(28685),l=o(35661),c=o(27724),d=o(24666),p=o(33929),u=o(73959);function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.default.getIntl();if("helpMeEdit"===e.key||"helpMeDraft"===e.key||"helpMeWrite"===e.key){var o;const n=null===(o=e.steps)||void 0===o?void 0:o[0],r="text"===(null==n?void 0:n.type)&&n.prefilledValue;return r?t.formatMessage({id:"completionPopup.prefilledValue",defaultMessage:"Write about {prefilledValue} "},{prefilledValue:r}):""}if(!(0,a.TE)(e.key))return"";switch(e.key){case"brainstormIdeas":return t.formatMessage({id:"completionPopup.brainStorm.prefilledValue",defaultMessage:"Brainstorm ideas on "});case"blogPost":return t.formatMessage({id:"completionPopup.blogPost.prefilledValue",defaultMessage:"Write a blog post about "});case"outline":return t.formatMessage({id:"completionPopup.outline.prefilledValue",defaultMessage:"Write an outline about "});case"socialMediaPost":return t.formatMessage({id:"completionPopup.socialMediaPost.prefilledValue",defaultMessage:"Write a social media post about "});case"pressRelease":return t.formatMessage({id:"completionPopup.pressRelease.prefilledValue",defaultMessage:"Write a press release about "});case"creativeStory":return t.formatMessage({id:"completionPopup.creativeStory.prefilledValue",defaultMessage:"Write a creative story about "});case"essay":return t.formatMessage({id:"completionPopup.essay.prefilledValue",defaultMessage:"Write an essay about "});case"poem":return t.formatMessage({id:"completionPopup.poem.prefilledValue",defaultMessage:"Write a poem about "});case"todoList":return t.formatMessage({id:"completionPopup.todoList.prefilledValue",defaultMessage:"Write a todo list about "});case"meetingAgenda":return t.formatMessage({id:"completionPopup.meetingAgenda.prefilledValue",defaultMessage:"Write a meeting agenda about "});case"prosConsList":return t.formatMessage({id:"completionPopup.prosConsList.prefilledValue",defaultMessage:"Write a pros and cons list about "});case"jobDescription":return t.formatMessage({id:"completionPopup.jobDescription.prefilledValue",defaultMessage:"Write a job description about "});case"salesEmail":return t.formatMessage({id:"completionPopup.salesEmail.prefilledValue",defaultMessage:"Write a sales email about "});case"recruitingEmail":return t.formatMessage({id:"completionPopup.recruitingEmail.prefilledValue",defaultMessage:"Write a recruiting email about "});default:(0,r.t1)(e.key)}}function g(){const{stores:e}=c.default.state,t=e[0],o=n.Z$(e),r=t?t.getRecordStoreUIRoot():void 0;if(r&&r instanceof l.G&&o){return{type:"blockSelection",stores:e,currentPage:r,origin:o,scrollerStore:(0,i.Dj)(r)}}}function h(){const e=d.default.state;if("editing"!==e.mode)return;const t=e.multiSelection,o=t.start.store,n=o.getRecordStoreUIRoot(),r=s.E.findNodeFromStore(o),a=(0,u.sQ)(o),c=null==a?void 0:a.getRecordStoreUIParent(),p=(0,i.Dj)(n),m=a&&a instanceof l.G&&a!==n?a:void 0,g=m??r;if(!(n&&n instanceof l.G&&g))return;return{type:"cursor",textSelection:t,currentPage:n,currentBlock:m,origin:g,currentParent:c,scrollerStore:p,isPageTitle:n.id===o.id}}function f(){const{stores:e}=c.default.state,t=d.default.state,o="empty"!==t.mode?t.multiSelection:void 0,n="empty"!==t.mode?t.multiSelection.start.store:void 0,r=n?n.getRecordStoreUIRoot():void 0;if(o&&r&&r instanceof l.G){const t=(0,u.sQ)(o.end.store),n=null==t?void 0:t.getRecordStoreUIParent(),a=(0,i.Dj)(r);if(t&&n){return{type:"textSelection",stores:e,textSelection:o,currentPage:r,origin:t,endBlock:t,endBlockParent:n,scrollerStore:a}}}}},99417:(e,t,o)=>{o.d(t,{Ah:()=>J,Dr:()=>j,HS:()=>ie,Iz:()=>te,L3:()=>B,LN:()=>W,MD:()=>O,Mh:()=>G,NX:()=>Q,OE:()=>L,PD:()=>D,dU:()=>se,gY:()=>re,pv:()=>K,sB:()=>Y,sr:()=>ne,t8:()=>V,up:()=>H,wA:()=>X,wq:()=>q,xM:()=>oe,zU:()=>ae});o(57658),o(21703);var n=o(14577),r=o(87205),i=(o(99036),o(8848)),a=o(30579),s=o(41886),l=o(27245),c=o(52897),d=o(7500),p=o(31157),u=o(88607),m=o(25879),g=o(12970),h=o(91856),f=o(20669),y=o(25651),v=o(11751),b=o(72050),S=o(72126),_=o(5366),w=o(97880),k=(o(95477),o(43250)),x=o(95802),I=o(16772),C=o(77080),T=o(35661),M=o(78663),P=o(19124),A=o(33929);function D(){return R()?"openai-2":F()?"anthropic-3":"default"}function B(){return R()||F()}function R(){return(0,P.GD)(void 0)&&E.state}const E=new n.Z((()=>C.default.checkGate("model-2")||C.default.checkGate("model-2-space")),{debugName:"inModel2Group"});function F(){return(0,P.GD)(void 0)&&N.state}const N=new n.Z((()=>C.default.checkGate("model-3")||C.default.checkGate("model-3-space")),{debugName:"inModel3Group"});const j=(0,_.defineMessages)({writeWithAI:{defaultMessage:"Write with AI",id:"id.completions.writeWithAI"},draftWithAI:{defaultMessage:"Draft with AI",id:"id.completions.draftWithAI"},extractFromSelection:{defaultMessage:"Generate from selection",id:"id.completions.extractFromSelection"},extractFromPage:{defaultMessage:"Generate from page",id:"id.completions.extractFromPage"},editSelection:{defaultMessage:"Edit or review selection",id:"id.completions.editSelection"},editPage:{defaultMessage:"Edit or review page",id:"id.completions.editPage"},aiBlocks:{defaultMessage:"Insert AI blocks",id:"id.completions.aiBlocks"},helpMeEdit:{defaultMessage:"Ask AI to edit...",id:"id.completions.helpMeEdit"},askAI:{defaultMessage:"Ask AI",id:"id.completions.askAI"},genericHelpMeEdit:{defaultMessage:"{filter}",id:"id.completions.genericHelpMeEdit"},genericHelpMeWrite:{defaultMessage:"{filter}",id:"id.completions.genericHelpMeWrite"},continueWriting:{defaultMessage:"Continue writing",id:"id.completions.continueWriting"},brainstormIdeas:{defaultMessage:"Brainstorm ideas",id:"id.completions.brainstormIdeas"},brainstormIdeasTopic:{defaultMessage:'What do you want to brainstorm ideas about?\nFor example, "creative name ideas for a pirate themed party game"',id:"id.completions.Topic"},summarize:{defaultMessage:"Summarize",id:"id.completions.summarize"},translate:{defaultMessage:"Translate",id:"id.completions.translate"},translateLanguage:{defaultMessage:"Select language",id:"id.completions.translateLanguage"},blogPost:{defaultMessage:"Blog post",id:"id.completions.blogPost"},blogPostTopicPlaceholder:{defaultMessage:'What should the blog post be about?\nFor example, "the benefits of practicing mindfulness and meditation"',id:"id.completions.blogPost.blogPostTopic.placeholder"},blogPostGenerate:{defaultMessage:"Generate post",id:"id.completions.blogPost.generate"},prosConsList:{defaultMessage:"Pros and cons list",id:"id.completions.prosConsList"},prosConsListPlaceholder:{defaultMessage:'What do you want to make a pros and cons list about?\nFor example, "learning a new language for the first time"',id:"id.completions.prosConsListPlaceholder"},socialMediaPostPlaceholder:{defaultMessage:'What do you want to make a social media post about?\nFor example, "tips and tricks for changing careers"',id:"id.completions.socialMediaPostPlaceholder"},outlinePlaceholder:{defaultMessage:'What do you want to make an outline for?\nFor example, "a detailed step-by-step process for getting into university"',id:"id.completions.outlinePlaceholder"},creativeStoryPlaceholder:{defaultMessage:'What do you want to write a story about?\nFor example, "suzy discovers a magical secret room only she can see"',id:"id.completions.creativeStoryPlaceholder"},poemPlaceholder:{defaultMessage:'What do you want to write a poem about?\nFor example, "a whimsical poem about finding meaning in ordinary things"',id:"id.completions.poemPlaceholder"},essayPlaceholder:{defaultMessage:'What do you want to write an essay about?\nFor example, "how a chaotic environment can actually improve focus"',id:"id.completions.essayPlaceholder"},todoListPlaceholder:{defaultMessage:'What do you want to make a to-do list about?\nFor example, "creating a new board game"',id:"id.completions.todoListPlaceholder"},meetingAgendaPlaceholder:{defaultMessage:'What is the purpose of the meeting?\nFor example, "alignment on pricing for new product"',id:"id.completions.meetingAgendaPlaceholder"},pressReleasePlaceholder:{defaultMessage:'What should the press release be about?\nFor example, "product launch for new mind-reading app for pets"',id:"id.completions.pressReleasePlaceholder"},jobDescriptionPlaceholder:{defaultMessage:'What job do you want to write a description about?\nFor example, "data engineer at Notion, needs Postgres experience"',id:"id.completions.jobDescriptionPlaceholder"},salesEmailPlaceholder:{defaultMessage:'What product are you selling?\nFor example, "email for a head of operations about a new brain boosting supplement"',id:"id.completions.salesEmailPlaceholder"},recruitingEmailPlaceholder:{defaultMessage:'Who are you trying to recruit?\nFor example, "experienced frontend engineer for our new social mindfulness app"',id:"id.completions.recruitingEmailPlaceholder"},helpMeEditPlaceholder:{defaultMessage:'How would you like to edit this text?\nFor example, "Summarize in one sentence"',id:"id.completions.helpMeEditPlaceholder"},improveWriting:{defaultMessage:"Improve writing",id:"id.completions.improveWriting"},fixSpellingGrammar:{defaultMessage:"Fix spelling & grammar",id:"id.completions.fixSpellingGrammar"},explainThis:{defaultMessage:"Explain this",id:"id.completions.explainThis"},makeLonger:{defaultMessage:"Make longer",id:"id.completions.makeLonger"},findActionItems:{defaultMessage:"Find action items",id:"id.completions.findActionItems"},makeShorter:{defaultMessage:"Make shorter",id:"id.completions.makeShorter"},simplifyLanguage:{defaultMessage:"Simplify language",id:"id.completions.simplifyLanguage"},changeTone:{defaultMessage:"Change tone",id:"id.completions.changeTone"},changeToneType:{defaultMessage:"Select tone",id:"id.completions.changeToneType"},changeToneProfessional:{defaultMessage:"Professional",id:"id.completions.changeToneProfessional"},changeToneCasual:{defaultMessage:"Casual",id:"id.completions.changeToneCasual"},changeToneStraightforward:{defaultMessage:"Straightforward",id:"id.completions.changeToneStraightforward"},changeToneConfident:{defaultMessage:"Confident",id:"id.completions.changeToneConfident"},changeToneFriendly:{defaultMessage:"Friendly",id:"id.completions.changeToneFriendly"},socialMediaPost:{defaultMessage:"Social media post",id:"id.completions.socialMediaPost"},cleanUpFormatting:{defaultMessage:"Clean up formatting",id:"id.completions.cleanUpFormatting"},outline:{defaultMessage:"Outline",id:"id.completions.outline"},creativeStory:{defaultMessage:"Creative story",id:"id.completions.creativeStory"},poem:{defaultMessage:"Poem",id:"id.completions.poem"},essay:{defaultMessage:"Essay",id:"id.completions.essay"},todoList:{defaultMessage:"To-do list",id:"id.completions.todoList"},toDoListKeywords:{id:"id.completions.todoListKeywords",defaultMessage:"Todo To-Do List"},meetingAgenda:{defaultMessage:"Meeting agenda",id:"id.completions.meetingAgenda"},pressRelease:{defaultMessage:"Press release",id:"id.completions.pressRelease"},jobDescription:{defaultMessage:"Job description",id:"id.completions.jobDescription"},salesEmail:{defaultMessage:"Sales email",id:"id.completions.salesEmail"},recruitingEmail:{defaultMessage:"Recruiting email",id:"id.completions.recruitingEmail"},conclusion:{defaultMessage:"Conclusion",id:"id.completions.conclusion"},autofillSummary:{defaultMessage:"Summary",id:"id.completions.autofillSummary"},autofillTranslate:{defaultMessage:"Translate",id:"id.completions.autofillTranslate"},autofillExtract:{defaultMessage:"Key info",id:"id.completions.autofillExtract"},autofillCustom:{defaultMessage:"Custom autofill",id:"id.completions.autofillCustom"},insertAIBlock:{defaultMessage:"Insert as AI block",id:"id.completions.insertAIBlock"}}),O=(0,w.AO)((e=>"custom"===e||"extract"===e||"translate"===e||"summarize"===e?{true:e}:{false:e})),L={text:{summarize:{name:j.autofillSummary,svg:h.Y},translate:{name:j.autofillTranslate,svg:u.Q},extract:{name:j.autofillExtract,svg:b.A},custom:{name:j.autofillCustom,svg:f.y}},select:{select:{name:j.autofillCustom,svg:f.y}},multi_select:{select:{name:j.autofillCustom,svg:f.y}}};const U=[P.eL,{key:"brainstormIdeas",category:"draftWithAI",name:j.brainstormIdeas,svg:m.b,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.brainstormIdeasTopic,placeholder:j.brainstormIdeasTopic,type:"text"}]},{key:"blogPost",category:"draftWithAI",name:j.blogPost,generateName:j.blogPostGenerate,svg:y.R,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.blogPostTopicPlaceholder,placeholder:j.blogPostTopicPlaceholder,type:"text"}]},{key:"outline",category:"draftWithAI",name:j.outline,svg:y.R,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.outlinePlaceholder,placeholder:j.outlinePlaceholder,type:"text"}]},{key:"socialMediaPost",category:"draftWithAI",name:j.socialMediaPost,svg:y.R,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.socialMediaPostPlaceholder,placeholder:j.socialMediaPostPlaceholder,type:"text"}]},{key:"pressRelease",category:"draftWithAI",name:j.pressRelease,svg:y.R,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.pressReleasePlaceholder,placeholder:j.pressReleasePlaceholder,type:"text"}]},{key:"creativeStory",category:"draftWithAI",name:j.creativeStory,svg:y.R,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.creativeStoryPlaceholder,placeholder:j.creativeStoryPlaceholder,type:"text"}]},{key:"essay",category:"draftWithAI",name:j.essay,svg:y.R,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.essayPlaceholder,placeholder:j.essayPlaceholder,type:"text"}]},{key:"poem",category:"draftWithAI",name:j.poem,svg:y.R,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.poemPlaceholder,placeholder:j.poemPlaceholder,type:"text"}]},{key:"todoList",category:"draftWithAI",name:j.todoList,fuzzySearchKeywords:j.toDoListKeywords,svg:y.R,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.todoListPlaceholder,placeholder:j.todoListPlaceholder,type:"text"}]},{key:"meetingAgenda",category:"draftWithAI",name:j.meetingAgenda,svg:y.R,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.meetingAgendaPlaceholder,placeholder:j.meetingAgendaPlaceholder,type:"text"}]},{key:"prosConsList",category:"draftWithAI",name:j.prosConsList,svg:y.R,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.prosConsListPlaceholder,placeholder:j.prosConsListPlaceholder,type:"text"}]},{key:"jobDescription",category:"draftWithAI",name:j.jobDescription,svg:y.R,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.jobDescriptionPlaceholder,placeholder:j.jobDescriptionPlaceholder,type:"text"}]},{key:"salesEmail",category:"draftWithAI",name:j.salesEmail,svg:y.R,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.salesEmailPlaceholder,placeholder:j.salesEmailPlaceholder,type:"text"}]},{key:"recruitingEmail",category:"draftWithAI",name:j.recruitingEmail,svg:y.R,svgFill:i.FN.light.purple[400],steps:[{key:"topic",name:j.recruitingEmailPlaceholder,placeholder:j.recruitingEmailPlaceholder,type:"text"}]}],Z=[P.It,{key:"continueWriting",category:"writeWithAI",name:j.continueWriting,svg:y.R,svgFill:i.FN.light.purple[400],requiresContent:!0},{key:"summarize",category:"extractFromContent",name:j.summarize,svg:h.Y,svgFill:i.FN.light.purple[400],requiresContent:!0},{key:"findActionItems",category:"extractFromContent",name:j.findActionItems,svg:g.O,svgFill:i.FN.light.purple[400],requiresContent:!0}];function V(e){if("string"==typeof e.name)return e.name;return A.default.getIntl().formatMessage(e.name)}function q(e){for(const t of z()){const o=(0,M.$W)(t);if(o&&e.startsWith(o))return{prompt:t,additionalContext:{topic:e}}}}function*z(){for(const t of U){var e;1===(null===(e=t.steps)||void 0===e?void 0:e.length)&&"topic"===t.steps[0].key&&(yield t)}}function W(e,t){const o=e.trim().toLocaleLowerCase();for(const n of z()){if((0,M.$W)(n,t).trim().toLocaleLowerCase()===o)return!0}return!1}function H(e){const t=[];return"cursor"===e.selectionType?e.isPageEmpty?t.push(...U):t.push(...Z,...$,...U):t.push(...$,...Z,...U),S.mN(t,(e=>e.key))}function G(e,t){switch(e){case"writeWithAI":return j.writeWithAI;case"draftWithAI":return j.draftWithAI;case"editContent":switch(t){case"page":return j.editPage;case"selection":return j.editSelection}break;case"extractFromContent":switch(t){case"page":return j.extractFromPage;case"selection":return j.extractFromSelection}}}function K(e,t){const o={editContent:[],writeWithAI:[],draftWithAI:[],extractFromContent:[]};function n(e){return[e,o[e]]}for(const r of e)o[r.category].push(r);return"cursor"===t.selectionType?t.isPageEmpty?[n("draftWithAI"),n("writeWithAI")]:[n("writeWithAI"),n("extractFromContent"),n("editContent"),n("draftWithAI")]:[n("editContent"),n("extractFromContent"),n("writeWithAI"),n("draftWithAI")]}const $=[{key:"improveWriting",category:"editContent",preferToNeverInsertTextAtCursor:!0,name:j.improveWriting,svg:c.d,svgFill:i.FN.light.purple[400]},{key:"fixSpellingGrammar",category:"editContent",preferToNeverInsertTextAtCursor:!0,name:j.fixSpellingGrammar,svg:l.U,svgFill:i.FN.light.purple[400]},{key:"summarize",category:"extractFromContent",name:j.summarize,svg:h.Y,svgFill:i.FN.light.purple[400]},{key:"translate",category:"extractFromContent",name:j.translate,svg:u.Q,svgFill:i.FN.light.purple[400],generateName:j.translate,regenerateName:j.translate,steps:[{key:"language",name:j.translateLanguage,type:"dropdown",dropdownOptions:r.nI}]},{key:"explainThis",category:"extractFromContent",name:j.explainThis,svg:s.y,svgFill:i.FN.light.purple[400]},{key:"makeShorter",category:"editContent",preferToNeverInsertTextAtCursor:!0,name:j.makeShorter,svg:p.f,svgFill:i.FN.light.purple[400]},{key:"makeLonger",category:"editContent",preferToNeverInsertTextAtCursor:!0,name:j.makeLonger,svg:d.H,svgFill:i.FN.light.purple[400]},{key:"findActionItems",category:"extractFromContent",name:j.findActionItems,svg:g.O,svgFill:i.FN.light.purple[400]},{key:"changeTone",category:"editContent",preferToNeverInsertTextAtCursor:!0,name:j.changeTone,svg:a.p,svgFill:i.FN.light.purple[400],generateName:j.changeTone,regenerateName:j.changeTone,steps:[{key:"tone",name:j.changeToneType,type:"dropdown",dropdownOptions:[{key:"professional",name:j.changeToneProfessional},{key:"casual",name:j.changeToneCasual},{key:"straightforward",name:j.changeToneStraightforward},{key:"confident",name:j.changeToneConfident},{key:"friendly",name:j.changeToneFriendly}]}]},{key:"simplifyLanguage",category:"editContent",preferToNeverInsertTextAtCursor:!0,name:j.simplifyLanguage,svg:v.t,svgFill:i.FN.light.purple[400]},{key:"helpMeEdit",category:"editContent",preferToNeverInsertTextAtCursor:!0,name:j.helpMeEdit,svg:c.d,svgFill:i.FN.light.purple[400],steps:[{key:"prompt",name:j.helpMeEditPlaceholder,placeholder:j.helpMeEditPlaceholder,type:"text"}]}];function Y(e){return{key:"helpMeEdit",category:"editContent",preferToNeverInsertTextAtCursor:!0,name:j.helpMeEdit,svg:c.d,svgFill:i.FN.light.purple[400],steps:[{key:"prompt",name:j.helpMeEditPlaceholder,placeholder:j.helpMeEditPlaceholder,type:"text",prefilledValue:e}]}}const Q={key:"continueWriting",name:j.continueWriting};function J(e){let t=x.C.findNodeFromStore(e);if(t){if("table"===e.getType()){const e=t.querySelector(`.${k.euV}.notion-table-block`);t=e??t}return t.getBoundingClientRect()}}function X(e){const{origin:t}=e;return t instanceof T.G?J(t):t instanceof HTMLElement?t.getBoundingClientRect():t}function ee(e){if(0===e.revisions.length)throw new Error("Assertion failure: no revisions exist")}function te(e){ee(e);for(const t of ae(e))if("initial"===t.type)return t;throw new Error("Assertion failure, initial revision does not exist")}function oe(e){return ee(e),e.revisions[e.revisions.length-1]}function ne(e){return"followup"===oe(e).type}function re(e){return e.additionalContext&&(e.additionalContext.prompt||e.additionalContext.topic)||""}function ie(e){if(0===e.revisions.length)throw new Error("Assertion failure, expected revisions to be non-empty");return e.revisions.length-1}function*ae(e){let t=ie(e),o=0;for(;;){if(o+=1,o>1e4)throw new Error("Maximum iteration limit reached");const n=e.revisions[t];if(!n)throw new Error("Assertion failure, invalid revision index");if(yield n,"initial"===n.type)break;"followup"===n.type?t=n.previousRevision:(0,w.t1)(n)}}function se(){const e=I.default.state;return"completionPopup"===e.type&&"initialPromptForAIBlock"===e.stage&&!e.store.hasContent()}},43455:(e,t,o)=>{o.d(t,{$A:()=>v,Ie:()=>k,KF:()=>f,N9:()=>w});o(57658);var n=o(40591),r=o.n(n),i=o(41432),a=o(19531),s=o(22808),l=o(25718),c=o(19889),d=o(70203),p=o(7928),u=o(33929),m=o(83089);function g(e,t){return(0,p.Nz)(e,t).replace(/ /g,"")}const h=(e,t)=>{const{getRecordValue:o,intl:n}=t;let r;if(d.IWo(e)){const t=d.zEN(e);r=`@${g(n,o({table:c.KJ,id:t}))}`}else if(d.fpG(e)){r=d.zyO(e).start_date}return r};function f(){let e=0,t=0;function o(o){e+=1,e>t&&(t=e);try{return l.Lk(o)}finally{e-=1}}function n(){return":".repeat(t-e+2)}return{transformAnnotation:h,transformBlockMapping:{callout(e){var t;const{block:r,exportArgs:i}=e,a=l.WB({block:r,exportArgs:i}),c=null===(t=r.format)||void 0===t?void 0:t.page_icon,d=(0,s.Z)(c)?c:"",p=o(e),u=n();return{text:`${u} aside ${d}\n\n${a}`.trim(),breakLines:!0,children:p,suffix:u}},toggle(e){const{block:t,exportArgs:r}=e,i=l.WB({block:t,exportArgs:r}),a=o(e),s=n();return{text:`${s} â–¶ ${i}\n\n`.trim(),breakLines:!0,children:a,suffix:s}}}}}const y=(0,m.V9)({unicode:()=>/@\p{Letter}+/gu,fallback:/@[A-Za-z]+/g});async function v(e,t,o){const n=e.matchAll(y),r=[];for(const i of n){const e=i[0].slice(1);if(void 0===o.get(e)){const n=async()=>{const n=await b(t,e);n?(n.email,o.set(e,n)):o.set(e,null)};r.push(n())}}await Promise.all(r)}async function b(e,t){const o=await e(t),n=u.default.getIntl();let r;for(const i of o){if(g(n,i)===t){if(r)return;r=i}}return r}function S(e){const{md:t,name:o,regex:n,createTokens:r}=e,{arrayReplaceAt:i}=t.utils;function a(e,t,i){let a=0;const s=[];if(e.replace(n,(function(n){const l=Array.from(arguments);let c=l.length-1;"string"!=typeof l[c]&&(c-=1);const d=l[c],p=l[c-1];if(p>0&&(0,m.D_)(d[p-1]))return"";if(p+n.length<d.length&&(0,m.D_)(d[p+n.length]))return"";const u=r(n,t);if(!u)return"";if(p>a){const t=new i("text","",0);t.content=e.slice(a,p),s.push(t)}for(const{type:e,attrs:t,tag:r,level:a,content:m}of u){const n=new i(e,"",0);if(t)for(const[e,o]of Object.entries(t))n.attrPush([e,o]);r&&(n.tag=r,n.markup=o),void 0!==a&&(n.level=a),m&&(n.content=m),s.push(n)}return a=p+n.length,""})),a<e.length){const t=new i("text","",0);t.content=e.slice(a),s.push(t)}return s}t.core.ruler.after("linkify",o,(e=>{let t=0;const o=e.tokens;for(let r=0;r<o.length;r++){const s=o[r].children;if("inline"===o[r].type&&s)for(let l=s.length-1;l>=0;l--){const c=s[l];"link_open"!==c.type&&"link_close"!==c.type||"auto"===c.info&&(t-=c.nesting),"text"===c.type&&0===t&&n.test(c.content)&&(o[r].children=i(s,l,a(c.content,c.level,e.Token)))}}return!0}))}function _(e){return t=>{!function(e){S({md:e,name:"date_mentions",regex:/20\d\d-\d\d-\d\d/g,createTokens:(e,t)=>[{type:"date_mention_open",tag:"time",attrs:{datetime:e,[a.KD.dateFormat]:"relative"},level:t+1},{type:"text",content:e},{type:"date_mention_close",tag:"/time",level:t}]})}(t),function(e,t){S({md:e,name:"user_mentions",regex:y,createTokens(e,o){const n=e.slice(1),r=t.get(n);if(r)return[{type:"user_mention_open",tag:"a",level:o+1,attrs:{[a.KD[d.GKr.User]]:r.id}},{type:"text",content:e},{type:"user_mention_close",tag:"/a",level:o}]}})}(t,e),function(e){const t=/^aside\s+(.*)$/,o={validate:e=>Boolean(e.trim().match(t)),render(o,n){if(1===o[n].nesting){const r=o[n].info.trim().match(t);let l=(null==r?void 0:r[1])??"";(0,s.Z)(l)||(l="");const c="gray_background";return`<div ${function(e,t){const o=[];for(const[n,r]of t)o.push(`${n}="${e.utils.escapeHtml(r)}"`);return o.join(" ")}(e,[[a.KD[i.Ti.callout],""],[a.KD.calloutBackground,c],[a.KD.calloutIcon,l]])}>`}return"</div>"}};e.use(r(),"callout_block",o)}(t),function(e){const t=/^â–¶\s+(.*)$/,o={validate:e=>Boolean(e.trim().match(t)),render(o,n){if(1===o[n].nesting){const r=o[n].info.trim().match(t),i=(null==r?void 0:r[1])??"";return`<details><summary>${e.utils.escapeHtml(i)}</summary>`}return"</details>"}};e.use(r(),"toggle_block",o)}(t)}}function w(e){return{plugin:_(e)}}function k(e){return/\[.+\]\([^)]*$/.test(e)}},19124:(e,t,o)=>{o.d(t,{AC:()=>D,Fk:()=>R,G9:()=>_,GD:()=>x,Gw:()=>B,It:()=>v,KZ:()=>M,RT:()=>C,Zt:()=>I,eL:()=>b,hu:()=>P,mX:()=>A,q:()=>T,qB:()=>S,z1:()=>w});var n=o(94568),r=o(38823),i=o(8848),a=o(52897),s=o(12970),l=o(91856),c=o(11751),d=o(72126),p=o(5366),u=(o(95477),o(80444)),m=o(21273),g=o(77080),h=o(83212),f=o(38755);const y=(0,p.defineMessages)({helpMeWrite:{defaultMessage:"Ask AI to write...",id:"id.completions.helpMeWrite"},helpMeWritePlaceholder:{defaultMessage:'What would you like to write about?\nFor example, "5 reasons why we should hire a dedicated designer"',id:"id.completions.helpMeWritePlaceholder"},helpMeDraftPlaceholder:{defaultMessage:'What would you like to write about?\nFor example, "article about the benefits of learning a new language"',id:"id.completions.helpMeDraftPlaceholder"},summarize:{defaultMessage:"Summarize",id:"id.completions.summarize"},findActionItems:{defaultMessage:"Find action items",id:"id.completions.findActionItems"},summarizeMeetingTranscript:{id:"id.completions.summarizeMeetingTranscript",defaultMessage:"Summarize meeting"}}),v={key:"helpMeWrite",category:"writeWithAI",name:y.helpMeWrite,svg:c.t,svgFill:i.FN.light.purple[400],requiresContent:!0,steps:[{key:"prompt",name:y.helpMeWritePlaceholder,placeholder:y.helpMeWritePlaceholder,type:"text"}]},b={key:"helpMeDraft",category:"draftWithAI",name:y.helpMeWrite,svg:c.t,svgFill:i.FN.light.purple[400],requiresNoContent:!0,steps:[{key:"prompt",name:y.helpMeDraftPlaceholder,placeholder:y.helpMeDraftPlaceholder,type:"text"}]};function S(e){const{customPrompt:t,isPageEmpty:o}=e;return{key:o?"helpMeDraft":"helpMeWrite",category:"writeWithAI",name:y.helpMeWrite,svg:a.d,svgFill:i.FN.light.purple[400],steps:[{key:"prompt",name:y.helpMeWritePlaceholder,placeholder:y.helpMeWritePlaceholder,type:"text",prefilledValue:t}]}}function _(){return[{key:"summarize",category:"extractFromContent",name:y.summarize,svg:l.Y,svgFill:i.FN.light.purple[400]},{key:"findActionItems",category:"extractFromContent",name:y.findActionItems,svg:s.O,svgFill:i.FN.light.purple[400]},v]}function w(){return d.KX(_(),"key")}function k(){const e=u.default.state.currentSpaceStore;return!!e&&e.isAiEnabledOnSpace()}function x(e){if(g.default.checkGate("disable_ai_big_red_button"))return!1;const t=u.default.state.currentSpaceStore;if((0,f.Cx)(t))return!1;const o=null==t?void 0:t.canRead();return!(e&&e.hasPublicPermission&&!o)&&k()}function I(e){return k()&&g.default.checkGate("ai_property_autofill_v2")}function C(e,t){return x(e)&&g.default.checkGate("ai_property_autofill_v2")&&t.canEdit()}function T(){return g.default.checkGate("autotag_ambient_trigger")}function M(){return g.default.checkGate("autofill_tags")}function P(){return g.default.checkGate("autofill_translate")}function A(e,t,o){return x(t)&&g.default.checkGate("ai_property_autofill_v2")&&o.canEditCollection()}function D(e){m.Z.setState(new r.m({getEligibleGroup:e=>g.default.getEligibleGroup({experimentId:e}),isAiEnabled:()=>{const t=u.default.state.mainEditorCurrentBlockStore;return x(t&&h.Z.getMode(e,t))}}))}function B(){var e;return(null===(e=u.default.state.currentSpaceStore)||void 0===e?void 0:e.id)===n.vj}function R(e){return g.default.checkGate("search_modal_qna")||m.Z.shouldShowQnaInSearchOnly()||!0===e}},53323:(e,t,o)=>{o.d(t,{L:()=>s,n:()=>l});var n=o(63143),r=o(88632),i=o(99757);const a=1*n.hM;function s(){var e;if(r.Z.state.online){if(null!==(e=i.Z.state.connectionError)&&void 0!==e&&e.startTime){var t;if(Date.now()-(null===(t=i.Z.state.connectionError)||void 0===t?void 0:t.startTime)<a)return}return i.Z.state.connectionError}}function l(){return Boolean(s())}},46150:(e,t,o)=>{o.d(t,{C7:()=>m,D1:()=>y,G0:()=>p,GF:()=>i,GZ:()=>s,HM:()=>l,X1:()=>h,_F:()=>c,eD:()=>u,g4:()=>f,xp:()=>v});var n=o(62619);const r="data-content-editable-leaf",i={[r]:!0},a="data-content-editable-root",s={[a]:!0},l="data-content-editable-selecting",c="data-content-editable-composing",d="data-content-editable-void",p={[d]:!0};function u(e){return n.kK(e)&&e.hasAttribute(r)}function m(e){return Boolean(n.kK(e)&&e.querySelector("[data-content-editable-leaf]"))}function g(e){return n.kK(e)&&e.hasAttribute(a)}function h(e){return n.sh(e,u)}function f(e,t){return e.parentElement===t?e:n.sh(e,(e=>e.parentElement===t))||e}function y(e,t){if(!e||!t)return!1;const o=v(e),n=v(t);return Boolean(o&&o===n)}function v(e){const t=n.sh(e,(e=>g(e)||function(e){return n.kK(e)&&e.hasAttribute(d)}(e)));if(t&&g(t))return t}},40959:(e,t,o)=>{o.d(t,{Hc:()=>k,MU:()=>w,O5:()=>x});var n=o(1302),r=o(41892),i=o(41432),a=o(45953),s=o(21202),l=o(5366),c=o(98104),d=o(33929),p=o(95802),u=o(21273),m=o(19037),g=o(42),h=o(4708),f=o(78175),y=o(19124),v=o(68056),b=o(73959),S=o(89086);const _=(0,l.defineMessages)({textTitle:{id:"newBlock.text.title",defaultMessage:"Text"},textDescription:{id:"newBlock.text.description",defaultMessage:"Just start writing with plain text."},textKeywords:{id:"newBlock.text.fuzzySearchKeywords",defaultMessage:"Plain Text"},pageTitle:{id:"newBlock.page.title",defaultMessage:"Page"},pageDescription:{id:"newBlock.page.description",defaultMessage:"Embed a sub-page inside this page."},pageKeywords:{id:"newBlock.page.fuzzySearchKeywords",defaultMessage:"Page"},linkToPageTitle:{id:"newBlock.linkToPage.title",defaultMessage:"Link to page"},linkToPageDescription:{id:"newBlock.linkToPage.description",defaultMessage:"Link to an existing page."},linkToPageKeywords:{id:"newBlock.linkToPage.fuzzySearchKeywords",defaultMessage:"Link to page ltp"},linkedDatabaseDescription:{id:"newBlock.linkToCollection.description",defaultMessage:"Add an existing database to this page."},transclusionContainerTitle:{id:"newBlock.transclusionContainer.title",defaultMessage:"Synced block"},transclusionContainerDescription:{id:"newBlock.transclusionContainer.description",defaultMessage:"Sync content across pages."},transclusionContainerKeywords:{id:"newBlock.transclusionContainer.fuzzySearchKeywords",defaultMessage:"Create synced block reference transclusion portal block embed group"},toDoTitle:{id:"newBlock.toDo.title",defaultMessage:"To-do list"},toDoDescription:{id:"newBlock.toDo.description",defaultMessage:"Track tasks with a to-do list."},toDoKeywords:{id:"newBlock.toDo.fuzzySearchKeywords",defaultMessage:"Todo To-Do Checkbox List"},headerTitle:{id:"newBlock.header.title",defaultMessage:"Heading 1"},headerDescription:{id:"newBlock.header.description",defaultMessage:"Big section heading."},headerKeywords:{id:"newBlock.header.fuzzySearchKeywords",defaultMessage:"Heading 1 # h1"},subHeaderTitle:{id:"newBlock.subHeader.title",defaultMessage:"Heading 2"},subHeaderDescription:{id:"newBlock.subHeader.description",defaultMessage:"Medium section heading."},subHeaderKeywords:{id:"newBlock.subHeader.fuzzySearchKeywords",defaultMessage:"sub heading 2 ## h2 two"},subSubHeaderTitle:{id:"newBlock.subSubHeader.title",defaultMessage:"Heading 3"},subSubHeaderDescription:{id:"newBlock.subSubHeader.description",defaultMessage:"Small section heading."},subSubHeaderKeywords:{id:"newBlock.subSubHeader.fuzzySearchKeywords",defaultMessage:"subsub heading 3 ### h3 three"},imageTitle:{id:"newBlock.image.title",defaultMessage:"Image"},imageDescription:{id:"newBlock.image.description",defaultMessage:"Upload or embed with a link."},imageKeywords:{id:"newBlock.image.fuzzySearchKeywords",defaultMessage:"Image Picture Gif Giphy"},bookmarkTitle:{id:"newBlock.bookmark.title",defaultMessage:"Web bookmark"},bookmarkDescription:{id:"newBlock.bookmark.description",defaultMessage:"Save a link as a visual bookmark."},bookmarkKeywords:{id:"newBlock.bookmark.fuzzySearchKeywords",defaultMessage:"Web Link Bookmark"},dividerTitle:{id:"newBlock.divider.title",defaultMessage:"Divider"},dividerDescription:{id:"newBlock.divider.description",defaultMessage:"Visually divide blocks."},dividerKeywords:{id:"newBlock.divider.fuzzySearchKeywords",defaultMessage:"Horizontal Rule Divider --- â€”-"},codeTitle:{id:"newBlock.code.title",defaultMessage:"Code"},codeDescription:{id:"newBlock.code.description",defaultMessage:"Capture a code snippet."},codeKeywords:{id:"newBlock.code.fuzzySearchKeywords",defaultMessage:"Code ```"},quoteTitle:{id:"newBlock.quote.title",defaultMessage:"Quote"},quoteDescription:{id:"newBlock.quote.description",defaultMessage:"Capture a quote."},quoteKeywords:{id:"newBlock.quote.fuzzySearchKeywords",defaultMessage:"Quote"},bulletedListTitle:{id:"newBlock.bulletedList.title",defaultMessage:"Bulleted list"},bulletedListDescription:{id:"newBlock.bulletedList.description",defaultMessage:"Create a simple bulleted list."},bulletedListKeywords:{id:"newBlock.bulletedList.fuzzySearchKeywords",defaultMessage:"Bulleted Unordered List"},numberedListTitle:{id:"newBlock.numberedList.title",defaultMessage:"Numbered list"},numberedListDescription:{id:"newBlock.numberedList.description",defaultMessage:"Create a list with numbering."},numberedListKeywords:{id:"newBlock.numberedList.fuzzySearchKeywords",defaultMessage:"Numbered Ordered List"},toggleTitle:{id:"newBlock.toggle.title",defaultMessage:"Toggle list"},toggleDescription:{id:"newBlock.toggle.description",defaultMessage:"Toggles can hide and show content inside."},toggleKeywords:{id:"newBlock.toggle.fuzzySearchKeywords",defaultMessage:"Toggle list"},fileTitle:{id:"newBlock.file.title",defaultMessage:"File"},fileDescription:{id:"newBlock.file.description",defaultMessage:"Upload or embed with a link."},fileKeywords:{id:"newBlock.file.fuzzySearchKeywords",defaultMessage:"File upload attach"},videoTitle:{id:"newBlock.video.title",defaultMessage:"Video"},videoDescription:{id:"newBlock.video.description",defaultMessage:"Embed from YouTube, Vimeo..."},videoKeywords:{id:"newBlock.video.fuzzySearchKeywords",defaultMessage:"Video"},audioTitle:{id:"newBlock.audio.title",defaultMessage:"Audio"},audioDescription:{id:"newBlock.audio.description",defaultMessage:"Embed from SoundCloud, Spotify..."},audioKeywords:{id:"newBlock.audio.fuzzySearchKeywords",defaultMessage:"Audio Sound Music"},embedTitle:{id:"newBlock.embed.title",defaultMessage:"Embed"},embedDescription:{id:"newBlock.embed.description",defaultMessage:"For PDFs, Google Maps, and more."},embedKeywords:{id:"newBlock.embed.fuzzySearchKeywords",defaultMessage:"Embed iFrame"},driveTitle:{id:"newBlock.drive.title",defaultMessage:"Google Drive"},driveDescription:{id:"newBlock.drive.description",defaultMessage:"Embed a Google Doc, Google Sheet..."},driveKeywords:{id:"newBlock.drive.fuzzySearchKeywords",defaultMessage:"Google Drive"},figmaTitle:{id:"newBlock.figma.title",defaultMessage:"Figma"},figmaDescription:{id:"newBlock.figma.description",defaultMessage:"Embed a Figma file."},figmaKeywords:{id:"newBlock.figma.fuzzySearchKeywords",defaultMessage:"Figma"},loomTitle:{id:"newBlock.loom.title",defaultMessage:"Loom"},loomDescription:{id:"newBlock.loom.description",defaultMessage:"Embed a Loom recording."},loomKeywords:{id:"newBlock.loom.fuzzySearchKeywords",defaultMessage:"Loom"},typeformTitle:{id:"newBlock.typeform.title",defaultMessage:"Typeform"},typeformDescription:{id:"newBlock.typeform.description",defaultMessage:"Embed a Typeform."},typeformKeywords:{id:"newBlock.typeform.fuzzySearchKeywords",defaultMessage:"Typeform"},codepenTitle:{id:"newBlock.codepen.title",defaultMessage:"CodePen"},codepenDescription:{id:"newBlock.codepen.description",defaultMessage:"Embed a CodePen."},codepenKeywords:{id:"newBlock.codepen.fuzzySearchKeywords",defaultMessage:"CodePen"},tweetTitle:{id:"newBlock.tweet.title",defaultMessage:"Tweet"},tweetDescription:{id:"newBlock.tweet.description",defaultMessage:"Embed a Tweet."},tweetKeywords:{id:"newBlock.tweet.fuzzySearchKeywords",defaultMessage:"Tweet"},gistTitle:{id:"newBlock.gist.title",defaultMessage:"GitHub Gist"},gistDescription:{id:"newBlock.gist.description",defaultMessage:"Embed a Gist from GitHub."},gistKeywords:{id:"newBlock.gist.fuzzySearchKeywords",defaultMessage:"GitHub Gist"},mapsTitle:{id:"newBlock.maps.title",defaultMessage:"Google Maps"},mapsDescription:{id:"newBlock.maps.description",defaultMessage:"Embed a Google Map."},mapsKeywords:{id:"newBlock.maps.fuzzySearchKeywords",defaultMessage:"Google Maps"},framerTitle:{id:"newBlock.framer.title",defaultMessage:"Framer"},framerDescription:{id:"newBlock.framer.description",defaultMessage:"Embed a Framer prototype."},framerKeywords:{id:"newBlock.framer.fuzzySearchKeywords",defaultMessage:"Framer"},invisionTitle:{id:"newBlock.invision.title",defaultMessage:"Invision"},invisionDescription:{id:"newBlock.invision.description",defaultMessage:"Embed an Invision project."},invisionKeywords:{id:"newBlock.invision.fuzzySearchKeywords",defaultMessage:"Invision"},mixpanelTitle:{id:"newBlock.mixpanel.title",defaultMessage:"Mixpanel"},mixpanelDescription:{id:"newBlock.mixpanel.description",defaultMessage:"Embed a Mixpanel project."},mixpanelKeywords:{id:"newBlock.mixpanel.fuzzySearchKeywords",defaultMessage:"Mixpanel"},equationTitle:{id:"newBlock.equation.title",defaultMessage:"Block equation"},equationDescription:{id:"newBlock.equation.description",defaultMessage:"Display a standalone math equation."},equationKeywords:{id:"newBlock.equation.fuzzySearchKeywords",defaultMessage:"LaTeX Math Block Equation $$ Formula"},pdfTitle:{id:"newBlock.pdf.title",defaultMessage:"PDF"},pdfDescription:{id:"newBlock.pdf.description",defaultMessage:"Embed a PDF."},pdfKeywords:{id:"newBlock.pdf.fuzzySearchKeywords",defaultMessage:"PDF"},factoryTitle:{id:"newBlock.factory.title",defaultMessage:"Template button"},factoryDescription:{id:"newBlock.factory.description",defaultMessage:"Duplicate blocks with a click."},factoryKeywords:{id:"newBlock.factory.fuzzySearchKeywords",defaultMessage:"Template Duplicate Button"},buttonTitle:{id:"newBlock.button.title",defaultMessage:"Button"},buttonDescription:{id:"newBlock.button.description",defaultMessage:"Run custom automations with a click."},buttonKeywords:{id:"newBlock.button.fuzzySearchKeywords",defaultMessage:"Button automation template duplicate"},breadcrumbTitle:{id:"newBlock.breadcrumb.title",defaultMessage:"Breadcrumb"},breadcrumbDescription:{id:"newBlock.breadcrumb.description",defaultMessage:"Show the current page location."},breadcrumbKeywords:{id:"newBlock.breadcrumb.fuzzySearchKeywords",defaultMessage:"Breadcrumb"},calloutTitle:{id:"newBlock.callout.title",defaultMessage:"Callout"},calloutDescription:{id:"newBlock.callout.description",defaultMessage:"Make writing stand out."},calloutKeywords:{id:"newBlock.callout.fuzzySearchKeywords",defaultMessage:"Callout"},table_of_contentsTitle:{id:"newBlock.tableOfContents.title",defaultMessage:"Table of contents"},table_of_contentsDescription:{id:"newBlock.tableOfContents.description",defaultMessage:"Show an outline of your page."},table_of_contentsKeywords:{id:"newBlock.tableOfContents.fuzzySearchKeywords",defaultMessage:"TOC Table of Contents"},whimsicalTitle:{id:"newBlock.whimsical.title",defaultMessage:"Whimsical"},whimsicalDescription:{id:"newBlock.whimsical.description",defaultMessage:"Embed a Whimsical board."},whimsicalKeywords:{id:"newBlock.whimsical.fuzzySearchKeywords",defaultMessage:"Whimsical"},hexTitle:{id:"newBlock.hex.title",defaultMessage:"Hex"},hexDescription:{id:"newBlock.hex.description",defaultMessage:"Embed a Hex cell."},hexKeywords:{id:"newBlock.hex.fuzzySearchKeywords",defaultMessage:"Hex"},deepnoteTitle:{id:"newBlock.deepnote.title",defaultMessage:"Deepnote"},deepnoteDescription:{id:"newBlock.deepnote.description",defaultMessage:"Embed a Deepnote block."},deepnoteKeywords:{id:"newBlock.deepnote.fuzzySearchKeywords",defaultMessage:"Deepnote"},miroTitle:{id:"newBlock.miro.title",defaultMessage:"Miro"},miroDescription:{id:"newBlock.miro.description",defaultMessage:"Embed a Miro board."},miroKeywords:{id:"newBlock.miro.fuzzySearchKeywords",defaultMessage:"Miro"},abstractTitle:{id:"newBlock.abstract.title",defaultMessage:"Abstract"},abstractDescription:{id:"newBlock.abstract.description",defaultMessage:"Embed an Abstract project."},abstractKeywords:{id:"newBlock.abstract.fuzzySearchKeywords",defaultMessage:"Abstract"},sketchTitle:{id:"newBlock.sketch.title",defaultMessage:"Sketch"},sketchDescription:{id:"newBlock.sketch.description",defaultMessage:"Embed a Sketch document."},sketchKeywords:{id:"newBlock.sketch.fuzzySearchKeywords",defaultMessage:"Sketch"},excalidrawTitle:{id:"newBlock.excalidraw.title",defaultMessage:"Excalidraw"},excalidrawDescription:{id:"newBlock.excalidraw.description",defaultMessage:"Embed an Excalidraw whiteboard."},excalidrawKeywords:{id:"newBlock.excalidraw.fuzzySearchKeywords",defaultMessage:"Excalidraw"},replitTitle:{id:"newBlock.replit.title",defaultMessage:"Replit"},replitDescription:{id:"newBlock.replit.description",defaultMessage:"Embed a repl."},replitKeywords:{id:"newBlock.replit.fuzzySearchKeywords",defaultMessage:"Replit"},databaseTitle:{id:"newBlock.database.title",defaultMessage:"Database"},databaseDescription:{id:"newBlock.database.description",defaultMessage:"Create a new database."},inlineTimelineDatabaseTitle:{id:"newBlock.inlineTimelineDatabase.title",defaultMessage:"Timeline database - Inline"},inlineTimelineDatabaseDescription:{id:"newBlock.inlineTimelineDatabase.description",defaultMessage:"Add a Timeline database to this page."},inlineTimelineDatabaseKeywords:{id:"newBlock.inlineTimelineDatabase.fuzzySearchKeywords",defaultMessage:"Timeline database - Inline"},fullPageTableDatabaseTitle:{id:"newBlock.fullPageTableDatabase.title",defaultMessage:"Table database - Full page"},fullPageTableDatabaseDescription:{id:"newBlock.fullPageTableDatabase.description",defaultMessage:"Add a Table database as a sub-page."},fullPageTableDatabaseKeywords:{id:"newBlock.fullPageTableDatabase.fuzzySearchKeywords",defaultMessage:"Table database - Full page"},fullPageBoardDatabaseTitle:{id:"newBlock.fullPageBoardDatabase.title",defaultMessage:"Board database - Full page"},fullPageBoardDatabaseDescription:{id:"newBlock.fullPageBoardDatabase.description",defaultMessage:"Add a Board database as a sub-page."},fullPageBoardDatabaseKeywords:{id:"newBlock.fullPageBoardDatabase.fuzzySearchKeywords",defaultMessage:"Board database - Full page"},fullPageGalleryDatabaseTitle:{id:"newBlock.fullPageGalleryDatabase.title",defaultMessage:"Gallery database - Full page"},fullPageGalleryDatabaseDescription:{id:"newBlock.fullPageGalleryDatabase.description",defaultMessage:"Add a Gallery database as a sub-page."},fullPageGalleryDatabaseKeywords:{id:"newBlock.fullPageGalleryDatabase.fuzzySearchKeywords",defaultMessage:"Gallery database - Full page"},fullPageListDatabaseTitle:{id:"newBlock.fullPageListDatabase.title",defaultMessage:"List database - Full page"},fullPageListDatabaseDescription:{id:"newBlock.fullPageListDatabase.description",defaultMessage:"Add a List database as a sub-page."},fullPageListDatabaseKeywords:{id:"newBlock.fullPageListDatabase.fuzzySearchKeywords",defaultMessage:"List database - Full page"},fullPageCalendarDatabaseTitle:{id:"newBlock.fullPageCalendarDatabase.title",defaultMessage:"Calendar database - Full page"},fullPageCalendarDatabaseDescription:{id:"newBlock.fullPageCalendarDatabase.description",defaultMessage:"Add a Calendar database as a sub-page."},fullPageCalendarDatabaseKeywords:{id:"newBlock.fullPageCalendarDatabase.fuzzySearchKeywords",defaultMessage:"Calendar database - Full page"},fullPageTimelineDatabaseTitle:{id:"newBlock.fullPageTimelineDatabase.title",defaultMessage:"Timeline database - Full page"},fullPageTimelineDatabaseDescription:{id:"newBlock.fullPageTimelineDatabase.description",defaultMessage:"Add a Timeline database as a sub-page."},fullPageTimelineDatabaseKeywords:{id:"newBlock.fullPageTimelineDatabase.fuzzySearchKeywords",defaultMessage:"Timeline database - Full page"},simpleTableTitle:{id:"newBlock.simple_table.title",defaultMessage:"Table"},simpleTableDescription:{id:"newBlock.simple_table.description",defaultMessage:"Add simple tabular content to your page."},simpleTableKeywords:{id:"newBlock.simple_table.fuzzySearchKeywords",defaultMessage:"Table"},tabTitle:{id:"newBlock.tab.title",defaultMessage:"Tabs"},tabDescription:{id:"newBlock.tab.description",defaultMessage:"Organize content in tabs."},tabKeywords:{id:"newBlock.tab.keywords",defaultMessage:"tab tabs tabbed switch toggle"},toggleFormatHeaderTitle:{id:"newBlock.toggleFormatHeader.title",defaultMessage:"Toggle heading 1"},toggleFormatHeaderDescription:{id:"newBlock.toggleFormatHeader.description",defaultMessage:"Hide content inside a large heading."},toggleFormatHeaderKeywords:{id:"newBlock.toggleFormatHeader.fuzzySearchKeywords",defaultMessage:"toggle heading 1 # h1"},toggleFormatSubHeaderTitle:{id:"newBlock.toggleFormatSubHeader.title",defaultMessage:"Toggle heading 2"},toggleFormatSubHeaderDescription:{id:"newBlock.toggleFormatSubHeader.description",defaultMessage:"Hide content inside a medium heading."},toggleFormatSubHeaderKeywords:{id:"newBlock.toggleFormatSubHeader.fuzzySearchKeywords",defaultMessage:"toggle sub heading 2 ## h2 two"},toggleFormatSubSubHeaderTitle:{id:"newBlock.toggleFormatSubSubHeader.title",defaultMessage:"Toggle heading 3"},toggleFormatSubSubHeaderDescription:{id:"newBlock.toggleFormatSubSubHeader.description",defaultMessage:"Hide content inside a small heading."},toggleFormatSubSubHeaderKeywords:{id:"newBlock.toggleFormatSubSubHeader.fuzzySearchKeywords",defaultMessage:"toggle subsub heading 3 ### h3 three"},columnListTitle:{id:"newBlock.columnList.title",defaultMessage:"Columns"},columnListDescription:{id:"newBlock.columnList.description",defaultMessage:"Create columns of blocks."},columnListKeywords:{id:"newBlock.columnList.fuzzySearchKeywords",defaultMessage:"Create col column columns block vertical"},column2Title:{id:"newBlock.column2.title",defaultMessage:"2 columns"},column2Description:{id:"newBlock.column2.description",defaultMessage:"Create 2 columns of blocks."},column2Keywords:{id:"newBlock.column2.fuzzySearchKeywords",defaultMessage:"Create col c2 col2 columns block vertical 2col two"},column3Title:{id:"newBlock.column3.title",defaultMessage:"3 columns"},column3Description:{id:"newBlock.column3.description",defaultMessage:"Create 3 columns of blocks."},column3Keywords:{id:"newBlock.column3.fuzzySearchKeywords",defaultMessage:"c3 col3 column3 columns 3col three"},column4Title:{id:"newBlock.column4.title",defaultMessage:"4 columns"},column4Description:{id:"newBlock.column4.description",defaultMessage:"Create 4 columns of blocks."},column4Keywords:{id:"newBlock.column4.fuzzySearchKeywords",defaultMessage:"c4 col4 column4 columns 4col four"},column5Title:{id:"newBlock.column5.title",defaultMessage:"5 columns"},column5Description:{id:"newBlock.column5.description",defaultMessage:"Create 5 columns of blocks."},column5Keywords:{id:"newBlock.column5.fuzzySearchKeywords",defaultMessage:"c5 col5 column5 columns 5col five"},mermaidCodeTitle:{id:"newBlock.mermaidCode.title",defaultMessage:"Code - Mermaid"},mermaidCodeDescription:{id:"newBlock.mermaidCode.description",defaultMessage:"Create a diagram by writing code."},mermaidCodeKeywords:{id:"newBlock.mermaidCode.fuzzySearchKeywords",defaultMessage:"mermaid diagram graphviz flowchart code"},aiSummaryBlockTitle:{id:"newBlock.aiSummaryBlock.title",defaultMessage:"Summary"},aiSummaryBlockDescription:{id:"newBlock.aiSummaryBlock.description",defaultMessage:"Generate a summary for the current page."},aiSummaryKeywords:{id:"newBlock.aiSummaryBlock.fuzzySearchKeywords",defaultMessage:"summary ai"},aiActionItemsBlockTitle:{id:"newBlock.aiActionItemsBlock.title",defaultMessage:"Action items"},aiActionItemsDescription:{id:"newBlock.aiActionItemsBlock.description",defaultMessage:"Extract action items from current page."},aiActionItemsKeywords:{id:"newBlock.aiActionItemsBlock.fuzzySearchKeywords",defaultMessage:"find action items ai"},aiFreePromptBlockTitle:{id:"newBlock.aiFreePromptBlock.title",defaultMessage:"Custom AI Block"},aiFreePromptDescription:{id:"newBlock.aiFreePromptBlock.description",defaultMessage:"Generate content from any instruction."},aiFreePromptKeywords:{id:"newBlock.aiFreePromptBlock.fuzzySearchKeywords",defaultMessage:"ask help question prompt ai custom block content"},drawingTitle:{id:"newBlock.drawing.title",defaultMessage:"Drawing"},drawingDescription:{id:"newBlock.drawing.description",defaultMessage:"Draw and diagram on an infinite canvas."},drawingKeywords:{id:"newBlock.drawing.fuzzySearchKeywords",defaultMessage:"drawing diagram canvas illustration draw sketch tldraw doodle mindmap architecture paint pen"},aiSectionBlockTitle:{id:"newBlock.aiSection.title",defaultMessage:"AI Section"},aiSectionKeywords:{id:"newBlock.aiSection.fuzzySearchKeywords",defaultMessage:"ai section heading meeting note summary action items"}});function w(e){const{key:t,displayName:o,fuzzySearchKeywords:n,blockType:r,thumbnail:i,tooltipPhoto:l,description:c,createTemplate:p,shouldShow:u,badge:m,postCreateCallback:g,collectionViewType:h,isToggleable:f}=e,y=d.default.formatMessage(n),v=y!==n.defaultMessage?`${y} ${n.defaultMessage}`:y;return{key:t,displayName:d.default.formatMessage(o),analyticsName:o.defaultMessage,searchName:v,thumbnail:i,tooltipPhoto:l,description:c?d.default.formatMessage(c):void 0,templateRootBlockId:"root",blockType:r,createTemplate:p||(()=>a.Ao.create({[s.iU]:{root:{id:"root",type:r}}})),shouldShow:u,badge:m,postCreateCallback:g,collectionViewType:h,isToggleable:f}}const k={[i.Ti.text]:w({key:i.Ti.text,blockType:i.Ti.text,displayName:_.textTitle,fuzzySearchKeywords:_.textKeywords,thumbnail:r.Z.images.blocks.textPng,description:_.textDescription,tooltipPhoto:r.Z.images.tooltips.blocks.textPng}),[i.Ti.page]:w({key:i.Ti.page,blockType:i.Ti.page,displayName:_.pageTitle,fuzzySearchKeywords:_.pageKeywords,thumbnail:r.Z.images.blocks.pagePng,description:_.pageDescription,tooltipPhoto:r.Z.images.tooltips.blocks.pagePng}),[i.Ti.linkToPage]:w({key:i.Ti.linkToPage,blockType:i.Ti.linkToPage,displayName:_.linkToPageTitle,fuzzySearchKeywords:_.linkToPageKeywords,thumbnail:r.Z.images.blocks.linkPng,description:_.linkToPageDescription,tooltipPhoto:r.Z.images.tooltips.blocks.linkToPagePng}),[i.Ti.transclusionContainer]:w({key:i.Ti.transclusionContainer,blockType:i.Ti.transclusionContainer,displayName:_.transclusionContainerTitle,fuzzySearchKeywords:_.transclusionContainerKeywords,thumbnail:r.Z.images.blocks.transclusionPng,description:_.transclusionContainerDescription,tooltipPhoto:r.Z.images.tooltips.blocks.transclusionPng,shouldShow:e=>!(0,m.wT)(e),createTemplate:e=>g._Z()}),[i.Ti.toDo]:w({key:i.Ti.toDo,blockType:i.Ti.toDo,displayName:_.toDoTitle,fuzzySearchKeywords:_.toDoKeywords,thumbnail:r.Z.images.blocks.toDoPng,description:_.toDoDescription,tooltipPhoto:r.Z.images.tooltips.blocks.toDoListPng}),[i.Ti.header]:w({key:i.Ti.header,blockType:i.Ti.header,displayName:_.headerTitle,fuzzySearchKeywords:_.headerKeywords,thumbnail:r.Z.images.blocks.headerPng,description:_.headerDescription,tooltipPhoto:r.Z.images.tooltips.blocks.headerPng}),[i.Ti.subHeader]:w({key:i.Ti.subHeader,blockType:i.Ti.subHeader,displayName:_.subHeaderTitle,fuzzySearchKeywords:_.subHeaderKeywords,thumbnail:r.Z.images.blocks.subheaderPng,description:_.subHeaderDescription,tooltipPhoto:r.Z.images.tooltips.blocks.subHeaderPng}),[i.Ti.subSubHeader]:w({key:i.Ti.subSubHeader,blockType:i.Ti.subSubHeader,displayName:_.subSubHeaderTitle,fuzzySearchKeywords:_.subSubHeaderKeywords,thumbnail:r.Z.images.blocks.subsubheaderPng,description:_.subSubHeaderDescription,tooltipPhoto:r.Z.images.tooltips.blocks.subsubheaderPng}),[i.Ti.image]:w({key:i.Ti.image,blockType:i.Ti.image,displayName:_.imageTitle,fuzzySearchKeywords:_.imageKeywords,description:_.imageDescription,tooltipPhoto:r.Z.images.tooltips.blocks.imagePng,thumbnail:r.Z.images.blocks.imagePng}),[i.Ti.bookmark]:w({key:i.Ti.bookmark,blockType:i.Ti.bookmark,displayName:_.bookmarkTitle,fuzzySearchKeywords:_.bookmarkKeywords,thumbnail:r.Z.images.blocks.webBookmarkPng,description:_.bookmarkDescription,tooltipPhoto:r.Z.images.tooltips.blocks.webBookmarkPng}),[i.Ti.divider]:w({key:i.Ti.divider,blockType:i.Ti.divider,displayName:_.dividerTitle,fuzzySearchKeywords:_.dividerKeywords,thumbnail:r.Z.images.blocks.dividerPng,description:_.dividerDescription,tooltipPhoto:r.Z.images.tooltips.blocks.dividerPng}),[i.Ti.code]:w({key:i.Ti.code,blockType:i.Ti.code,displayName:_.codeTitle,fuzzySearchKeywords:_.codeKeywords,thumbnail:r.Z.images.blocks.codePng,description:_.codeDescription,tooltipPhoto:r.Z.images.tooltips.blocks.codePng}),[i.Ti.quote]:w({key:i.Ti.quote,blockType:i.Ti.quote,displayName:_.quoteTitle,fuzzySearchKeywords:_.quoteKeywords,thumbnail:r.Z.images.blocks.quotePng,description:_.quoteDescription,tooltipPhoto:r.Z.images.tooltips.blocks.quotePng}),[i.Ti.bulletedList]:w({key:i.Ti.bulletedList,blockType:i.Ti.bulletedList,displayName:_.bulletedListTitle,fuzzySearchKeywords:_.bulletedListKeywords,thumbnail:r.Z.images.blocks.bulletedListPng,description:_.bulletedListDescription,tooltipPhoto:r.Z.images.tooltips.blocks.bulletedListPng}),[i.Ti.numberedList]:w({key:i.Ti.numberedList,blockType:i.Ti.numberedList,displayName:_.numberedListTitle,fuzzySearchKeywords:_.numberedListKeywords,thumbnail:r.Z.images.blocks.numberedListPng,description:_.numberedListDescription,tooltipPhoto:r.Z.images.tooltips.blocks.numberedListPng}),[i.Ti.toggle]:w({key:i.Ti.toggle,blockType:i.Ti.toggle,displayName:_.toggleTitle,fuzzySearchKeywords:_.toggleKeywords,thumbnail:r.Z.images.blocks.togglePng,description:_.toggleDescription,tooltipPhoto:r.Z.images.tooltips.blocks.toggleListPng,isToggleable:!0}),[i.Ti.file]:w({key:i.Ti.file,blockType:i.Ti.file,displayName:_.fileTitle,fuzzySearchKeywords:_.fileKeywords,thumbnail:r.Z.images.blocks.filePng,tooltipPhoto:r.Z.images.tooltips.blocks.filePng,description:_.fileDescription}),[i.Ti.video]:w({key:i.Ti.video,blockType:i.Ti.video,displayName:_.videoTitle,fuzzySearchKeywords:_.videoKeywords,thumbnail:r.Z.images.blocks.videoPng,tooltipPhoto:r.Z.images.tooltips.blocks.videoPng,description:_.videoDescription}),[i.Ti.audio]:w({key:i.Ti.audio,blockType:i.Ti.audio,displayName:_.audioTitle,fuzzySearchKeywords:_.audioKeywords,thumbnail:r.Z.images.blocks.audioPng,description:_.audioDescription}),[i.Ti.embed]:w({key:i.Ti.embed,blockType:i.Ti.embed,displayName:_.embedTitle,fuzzySearchKeywords:_.embedKeywords,thumbnail:r.Z.images.blocks.embedPng,description:_.embedDescription}),[i.Ti.drive]:w({key:i.Ti.drive,blockType:i.Ti.drive,displayName:_.driveTitle,fuzzySearchKeywords:_.driveKeywords,thumbnail:r.Z.images.blocks.drivePng,description:_.driveDescription,shouldShow:e=>(0,m.P5)()}),[i.Ti.figma]:w({key:i.Ti.figma,blockType:i.Ti.figma,displayName:_.figmaTitle,fuzzySearchKeywords:_.figmaKeywords,thumbnail:r.Z.images.blocks.figmaPng,description:_.figmaDescription}),[i.Ti.loom]:w({key:i.Ti.loom,blockType:i.Ti.loom,displayName:_.loomTitle,fuzzySearchKeywords:_.loomKeywords,thumbnail:r.Z.images.blocks.loomPng,description:_.loomDescription}),[i.Ti.typeform]:w({key:i.Ti.typeform,blockType:i.Ti.typeform,displayName:_.typeformTitle,fuzzySearchKeywords:_.typeformKeywords,thumbnail:r.Z.images.blocks.typeformPng,description:_.typeformDescription}),[i.Ti.codepen]:w({key:i.Ti.codepen,blockType:i.Ti.codepen,displayName:_.codepenTitle,fuzzySearchKeywords:_.codepenKeywords,thumbnail:r.Z.images.blocks.codepenPng,description:_.codepenDescription}),[i.Ti.tweet]:w({key:i.Ti.tweet,blockType:i.Ti.tweet,displayName:_.tweetTitle,fuzzySearchKeywords:_.tweetKeywords,thumbnail:r.Z.images.blocks.twitterPng,description:_.tweetDescription}),[i.Ti.gist]:w({key:i.Ti.gist,blockType:i.Ti.gist,displayName:_.gistTitle,fuzzySearchKeywords:_.gistKeywords,thumbnail:r.Z.images.blocks.githubPng,description:_.gistDescription}),[i.Ti.maps]:w({key:i.Ti.maps,blockType:i.Ti.maps,displayName:_.mapsTitle,fuzzySearchKeywords:_.mapsKeywords,thumbnail:r.Z.images.blocks.mapsPng,description:_.mapsDescription}),[i.Ti.framer]:w({key:i.Ti.framer,blockType:i.Ti.framer,displayName:_.framerTitle,fuzzySearchKeywords:_.framerKeywords,thumbnail:r.Z.images.blocks.framerPng,description:_.framerDescription}),[i.Ti.invision]:w({key:i.Ti.invision,blockType:i.Ti.invision,displayName:_.invisionTitle,fuzzySearchKeywords:_.invisionKeywords,thumbnail:r.Z.images.blocks.invisionPng,description:_.invisionDescription}),[i.Ti.equation]:w({key:i.Ti.equation,blockType:i.Ti.equation,displayName:_.equationTitle,fuzzySearchKeywords:_.equationKeywords,thumbnail:r.Z.images.blocks.texPng,tooltipPhoto:r.Z.images.tooltips.blocks.mathPng,description:_.equationDescription}),[i.Ti.pdf]:w({key:i.Ti.pdf,blockType:i.Ti.pdf,displayName:_.pdfTitle,fuzzySearchKeywords:_.pdfKeywords,thumbnail:r.Z.images.blocks.pdfPng,description:_.pdfDescription}),[i.Ti.factory]:w({displayName:_.factoryTitle,fuzzySearchKeywords:_.factoryKeywords,thumbnail:r.Z.images.blocks.templateButtonPng,key:i.Ti.factory,blockType:i.Ti.factory,description:_.factoryDescription,tooltipPhoto:r.Z.images.tooltips.blocks.templateButtonPng,createTemplate:g.sw,shouldShow:()=>!1}),[i.Ti.button]:w({displayName:_.buttonTitle,fuzzySearchKeywords:_.buttonKeywords,thumbnail:r.Z.images.blocks.templateButtonPng,key:i.Ti.button,blockType:i.Ti.button,description:_.buttonDescription,tooltipPhoto:r.Z.images.tooltips.blocks.templateButtonPng,createTemplate:g.ax,badge:"new"}),[i.Ti.breadcrumb]:w({displayName:_.breadcrumbTitle,thumbnail:r.Z.images.blocks.breadcrumbPng,tooltipPhoto:r.Z.images.tooltips.blocks.breadcrumbPng,description:_.breadcrumbDescription,fuzzySearchKeywords:_.breadcrumbKeywords,key:i.Ti.breadcrumb,blockType:i.Ti.breadcrumb}),[i.Ti.callout]:w({key:i.Ti.callout,blockType:i.Ti.callout,displayName:_.calloutTitle,thumbnail:r.Z.images.blocks.calloutPng,description:_.calloutDescription,fuzzySearchKeywords:_.calloutKeywords,tooltipPhoto:r.Z.images.tooltips.blocks.calloutPng}),[i.Ti.tableOfContents]:w({displayName:_.table_of_contentsTitle,fuzzySearchKeywords:_.table_of_contentsKeywords,thumbnail:r.Z.images.blocks.tableOfContentsPng,tooltipPhoto:r.Z.images.tooltips.blocks.tableOfContentsPng,description:_.table_of_contentsDescription,key:i.Ti.tableOfContents,blockType:i.Ti.tableOfContents}),[i.Ti.whimsical]:w({key:i.Ti.whimsical,blockType:i.Ti.whimsical,displayName:_.whimsicalTitle,fuzzySearchKeywords:_.whimsicalKeywords,thumbnail:r.Z.images.blocks.whimsicalPng,description:_.whimsicalDescription}),[i.Ti.mixpanel]:w({key:i.Ti.mixpanel,blockType:i.Ti.mixpanel,displayName:_.mixpanelTitle,fuzzySearchKeywords:_.mixpanelKeywords,thumbnail:r.Z.images.blocks.mixpanelPng,description:_.mixpanelDescription}),[i.Ti.miro]:w({key:i.Ti.miro,blockType:i.Ti.miro,displayName:_.miroTitle,fuzzySearchKeywords:_.miroKeywords,thumbnail:r.Z.images.blocks.miroPng,description:_.miroDescription}),[i.Ti.abstract]:w({key:i.Ti.abstract,blockType:i.Ti.abstract,displayName:_.abstractTitle,thumbnail:r.Z.images.blocks.abstractPng,description:_.abstractDescription,fuzzySearchKeywords:_.abstractKeywords}),[i.Ti.sketch]:w({key:i.Ti.sketch,blockType:i.Ti.sketch,displayName:_.sketchTitle,thumbnail:r.Z.images.blocks.sketchPng,description:_.sketchDescription,fuzzySearchKeywords:_.sketchKeywords}),[i.Ti.excalidraw]:w({key:i.Ti.excalidraw,blockType:i.Ti.excalidraw,displayName:_.excalidrawTitle,thumbnail:r.Z.images.blocks.excalidrawPng,description:_.excalidrawDescription,fuzzySearchKeywords:_.excalidrawKeywords}),[i.Ti.replit]:w({key:i.Ti.replit,blockType:i.Ti.replit,displayName:_.replitTitle,thumbnail:r.Z.images.blocks.replitPng,description:_.replitDescription,fuzzySearchKeywords:_.replitKeywords}),[i.Ti.table]:w({key:i.Ti.table,blockType:i.Ti.table,displayName:_.simpleTableTitle,thumbnail:r.Z.images.blocks.simpleTablePng,description:_.simpleTableDescription,fuzzySearchKeywords:_.simpleTableKeywords,tooltipPhoto:r.Z.images.tooltips.blocks.simpleTablePng,createTemplate:()=>g.S7()}),[i.Ti.tab]:w({key:i.Ti.tab,blockType:i.Ti.tab,displayName:_.tabTitle,thumbnail:r.Z.images.blocks.tabsPng,tooltipPhoto:r.Z.images.tooltips.blocks.tabsPng,description:_.tabDescription,fuzzySearchKeywords:_.tabKeywords,createTemplate:()=>g.ZW(),shouldShow:e=>(0,m.$c)(e)}),[i.Ti.hex]:w({key:i.Ti.hex,blockType:i.Ti.hex,displayName:_.hexTitle,thumbnail:r.Z.images.blocks.hexPng,description:_.hexDescription,fuzzySearchKeywords:_.hexKeywords}),[i.Ti.deepnote]:w({key:i.Ti.deepnote,blockType:i.Ti.deepnote,displayName:_.deepnoteTitle,thumbnail:r.Z.images.blocks.deepnotePng,description:_.deepnoteDescription,fuzzySearchKeywords:_.deepnoteKeywords}),[i.MF.toggleFormatHeaderBlock]:w({key:i.MF.toggleFormatHeaderBlock,blockType:i.Ti.header,displayName:_.toggleFormatHeaderTitle,fuzzySearchKeywords:_.toggleFormatHeaderKeywords,thumbnail:r.Z.images.blocks.toggleHeading1Png,description:_.toggleFormatHeaderDescription,tooltipPhoto:r.Z.images.tooltips.blocks.toggleH1Png,createTemplate:()=>g.UG(i.Ti.header),isToggleable:!0}),[i.MF.toggleFormatSubHeaderBlock]:w({key:i.MF.toggleFormatSubHeaderBlock,blockType:i.Ti.subHeader,displayName:_.toggleFormatSubHeaderTitle,fuzzySearchKeywords:_.toggleFormatSubHeaderKeywords,thumbnail:r.Z.images.blocks.toggleHeading2Png,description:_.toggleFormatSubHeaderDescription,tooltipPhoto:r.Z.images.tooltips.blocks.toggleH2Png,createTemplate:()=>g.UG(i.Ti.subHeader),isToggleable:!0}),[i.MF.toggleFormatSubSubHeaderBlock]:w({key:i.MF.toggleFormatSubSubHeaderBlock,blockType:i.Ti.subSubHeader,displayName:_.toggleFormatSubSubHeaderTitle,fuzzySearchKeywords:_.toggleFormatSubSubHeaderKeywords,thumbnail:r.Z.images.blocks.toggleHeading3Png,description:_.toggleFormatSubSubHeaderDescription,tooltipPhoto:r.Z.images.tooltips.blocks.toggleH3Png,createTemplate:()=>g.UG(i.Ti.subSubHeader),isToggleable:!0}),[i.Ti.columnList]:w({key:i.Ti.columnList,blockType:i.Ti.columnList,displayName:_.columnListTitle,fuzzySearchKeywords:_.columnListKeywords,thumbnail:r.Z.images.blocks.columnListPng,description:_.columnListDescription,tooltipPhoto:r.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(2),shouldShow:e=>!e.environment.device.isPhone}),[i.MF.column2Block]:w({key:i.MF.column2Block,blockType:i.Ti.columnList,displayName:_.column2Title,fuzzySearchKeywords:_.column2Keywords,thumbnail:r.Z.images.blocks.columnListPng,description:_.column2Description,tooltipPhoto:r.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(2),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(f.hF)}),[i.MF.column3Block]:w({key:i.MF.column3Block,blockType:i.Ti.columnList,displayName:_.column3Title,fuzzySearchKeywords:_.column3Keywords,thumbnail:r.Z.images.blocks.columnListPng,description:_.column3Description,tooltipPhoto:r.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(3),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(f.hF)}),[i.MF.column4Block]:w({key:i.MF.column4Block,blockType:i.Ti.columnList,displayName:_.column4Title,fuzzySearchKeywords:_.column4Keywords,thumbnail:r.Z.images.blocks.columnListPng,description:_.column4Description,tooltipPhoto:r.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(4),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(f.hF)}),[i.MF.column5Block]:w({key:i.MF.column5Block,blockType:i.Ti.columnList,displayName:_.column5Title,fuzzySearchKeywords:_.column5Keywords,thumbnail:r.Z.images.blocks.columnListPng,description:_.column5Description,tooltipPhoto:r.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(5),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(f.hF)}),[i.MF.mermaidCodeBlock]:w({key:i.MF.mermaidCodeBlock,blockType:i.Ti.code,displayName:_.mermaidCodeTitle,fuzzySearchKeywords:_.mermaidCodeKeywords,thumbnail:r.Z.images.blocks.codePng,description:_.mermaidCodeDescription,tooltipPhoto:r.Z.images.tooltips.blocks.codePng,createTemplate:()=>g.iD("Mermaid","graph TD\n  Mermaid --\x3e Diagram"),postCreateCallback:e=>{n.default.afterNextFlush((()=>{n.default.afterNextFlush((()=>{const t=p.C.find((t=>t.props.store.id===e.id)),o=null==t?void 0:t.props.store,n=o&&(0,b.mh)(o);if(n){var r;const e=(0,v.TD)({store:n,selection:{startIndex:0,endIndex:(null===(r=(0,S.x0)(n))||void 0===r?void 0:r.endIndex)??0}});c.NA({multiSelection:e})}}))}))}}),[i.MF.aiSummaryBlock]:w({key:i.MF.aiSummaryBlock,blockType:i.Ti.aiBlock,displayName:_.aiSummaryBlockTitle,fuzzySearchKeywords:_.aiSummaryKeywords,thumbnail:r.Z.images.blocks.tableOfContentsPng,description:_.aiSummaryBlockDescription,badge:"ai",createTemplate:()=>g.Jy("summarize"),shouldShow:e=>!e.environment.device.isPhone&&I(e)}),[i.MF.aiActionItemsBlock]:w({key:i.MF.aiActionItemsBlock,blockType:i.Ti.aiBlock,displayName:_.aiActionItemsBlockTitle,fuzzySearchKeywords:_.aiActionItemsKeywords,thumbnail:r.Z.images.blocks.bulletedListPng,description:_.aiActionItemsDescription,badge:"ai",createTemplate:()=>g.Jy("findActionItems"),shouldShow:e=>!e.environment.device.isPhone&&I(e)}),[i.MF.aiFreePromptBlock]:w({key:i.MF.aiFreePromptBlock,blockType:i.Ti.aiBlock,displayName:_.aiFreePromptBlockTitle,fuzzySearchKeywords:_.aiFreePromptKeywords,thumbnail:r.Z.images.blocks.calloutPng,description:_.aiFreePromptDescription,badge:"ai",createTemplate:()=>g.Jy("helpMeWrite"),shouldShow:e=>!e.environment.device.isPhone&&I(e)}),[i.Ti.drawing]:w({key:i.Ti.drawing,blockType:i.Ti.drawing,displayName:_.drawingTitle,fuzzySearchKeywords:_.drawingKeywords,thumbnail:r.Z.images.externalIntegrations.acmeIconPng,description:_.drawingDescription,shouldShow:e=>(0,h.A3)(),createTemplate:()=>g.Fr()}),[i.MF.aiSectionBlock]:w({key:i.MF.aiSectionBlock,blockType:i.Ti.aiBlock,displayName:_.aiSectionBlockTitle,fuzzySearchKeywords:_.aiSectionBlockTitle,thumbnail:r.Z.images.blocks.calloutPng,badge:"ai",createTemplate:()=>g.d6(),shouldShow:e=>!e.environment.device.isPhone&&I(e)&&u.Z.shouldShowAISections()})},x=(k[i.Ti.callout],k[i.Ti.toggle],[i.MF.aiSummaryBlock,i.MF.aiActionItemsBlock,i.MF.aiFreePromptBlock,i.MF.aiSectionBlock]),I=e=>{let{publicEditMode:t}=e;return(0,y.GD)(t)}},11599:(e,t,o)=>{o.d(t,{$0:()=>d,A$:()=>l,ab:()=>s,dy:()=>c,kq:()=>u,p1:()=>p});var n=o(80951),r=o(80444),i=o(88923);function a(){const e=d(),{mainEditorCurrentBlockStore:t}=r.default.state,o=i.default.state.open&&i.default.state.target||t;return e||o}function s(e,t){const o=a(),n=null==o?void 0:o.getFormat(),r=e&&e[t],i=(null==n?void 0:n.collection_page_sections)||[];if(!r){if("backlinks"===t)return"section_collapsed";if("comments"===t)return"section_show";if("margin_comments"===t)return"inline";if(i&&i.filter((e=>e.section===t))){const e=i.find((e=>e.section===t));if(e)return e.visibility}return"inline"}return r}function l(e,t){const o=a();if(!o)return!1;return s(o.getFormat().page_section_visibility,e)===t}function c(e,t){const o=a();if(!o)return!0;return"section_show"===s(o.getFormat().page_section_visibility,t)}function d(){const{mainEditorCurrentBlockStore:e}=r.default.state,t=i.default.state.open&&i.default.state.target||e;return null==t?void 0:t.getAssociatedCollectionStore()}function p(){const e=d();if(!e)return!1;const t=e.getParentBlockStore();return Boolean(t&&(t.isLocked()||t.isNavigableAncestorLocked()))}function u(e){const{propertySchema:t}=e,{type:o}=t,r=(0,n.eb)(t);return!(["created_time","created_by","last_edited_time","last_edited_by"].includes(o)||r)}},75081:(e,t,o)=>{o.d(t,{A7:()=>b,Mn:()=>g,Q_:()=>f,sN:()=>h,tV:()=>v,x1:()=>y});o(57658),o(67294);var n=o(45433),r=o(54855),i=o(86793),a=o(59960),s=o(97880),l=o(5366),c=o(35661),d=o(33929),p=o(98165),u=o(85893);r.a,a.w,i.D;const m=(0,l.defineMessages)({page:{defaultMessage:"Page",id:"dbTypesHelpers.singlePage.displayName"},tasks:{defaultMessage:"Task",id:"dbTypesHelpers.singleTask.displayName"},projects:{defaultMessage:"Project",id:"dbTypesHelpers.singleProject.displayName"}});m.page,m.tasks,m.projects;function g(e){return d.default.formatMessage((0,n.J2)(e))}function h(e,t){return d.default.formatMessage((0,n.tq)(e,t))}function f(e,t){return d.default.formatMessage((0,n.Xj)(e,t))}function y(e){let{typedCollections:t,spaceStore:o,environment:n}=e;const r=[],i=[],a={},l={};for(const d of t){const e=(0,p.u3)(d);if(!e)continue;const t=v({environment:n,spaceStore:o,collectionStore:d});switch(t){case"team":a[e.id]=[...a[e.id]||[],d],e instanceof c.zX&&(l[e.id]=e);break;case"private":r.push(d);break;case"other":i.push(d);break;default:(0,s.t1)(t)}}return{privateDatabases:r,otherDatabases:i,teamDatabases:a,teamStores:l}}function v(e){let{environment:t,spaceStore:o,collectionStore:n}=e;const r=(0,p.u3)(n);return r&&r.canRead()?r instanceof c.zX?"team":r.isTopLevelPrivatePage({spaceStore:o,environment:t})?"private":"other":"other"}function b(e,t){return(0,u.jsx)(l.FormattedMessage,{...t,defaultMessage:"This property is required for {databaseType}.",id:"database.requiredPropertyExplanation",description:"Educate the users on why this property cannot be deleted.",values:{databaseType:g(e)}})}},41056:(e,t,o)=>{o.d(t,{H:()=>a,u:()=>s});var n=o(49085),r=o(53877);const i=new Map;function a(e){if(!i.has(e)){const t=n.default.createValue((()=>(0,r.Uu)(e)));i.set(e,t)}return i.get(e).state}function s(){for(const[e,t]of i){const o=(0,r.Uu)(e);t.state.equals(o)||t.setState(o)}}},21969:(e,t,o)=>{o.d(t,{H:()=>a,W:()=>i});var n=o(80310),r=o(64002);function i(e){const t=(0,r.Qc)(e);return t.query[n.JF]="true",(0,r.bf)({url:(0,r.WU)(t),query:t.query,hash:t.hash||void 0})}function a(e){const t=(0,r.Qc)((0,r.T1)(e));return t.query[n.f6]="true",(0,r.bf)({url:(0,r.WU)(t),query:t.query,hash:t.hash||void 0})}},74503:(e,t,o)=>{async function n(){const e={};if(!window.__isElectron)return{};const t=window.__desktopDeviceInfo;if(t)e.desktopOsVersion=t.os,e.desktopKernelVersion=t.kernel,e.desktopElectronVersion=t.electron,e.desktopChromiumVersion=t.chromium,e.desktopArch=t.arch,e.desktopPlatform=t.platform;else{const t=["architecture","fullVersionList","platformVersion"],n=await navigator.userAgentData.getHighEntropyValues(t);e.desktopArch="arm"===(o=n.architecture)?"arm64":o,e.desktopOsVersion=n.platformVersion,e.desktopPlatform=window.__platform;const r=navigator.userAgent.match(/Chrome\/([\d.]+)/);e.desktopChromiumVersion=r?r[1]:"Unknown";const i=navigator.userAgent.match(/Electron\/([\d.]+)/);e.desktopElectronVersion=i?i[1]:"Unknown"}var o;return e}o.r(t),o.d(t,{getDesktopDeviceInfo:()=>n})},71776:(e,t,o)=>{o.d(t,{$Z:()=>s,GU:()=>i,OS:()=>l,cr:()=>a});o(57658);var n=o(77420),r=o(9844);function i(e){const{ids:t,table:o,userStore:n}=e,r=[];for(const i of t){const e=n.getRecordModel({id:i,table:o});e&&r.push(e)}return a(r)}function a(e){return e.slice().sort(((e,t)=>t.created_at-e.created_at))}const s=["all","internal","public"],l={[n.cZ]:"internal",[r.K2]:"public"}},25898:(e,t,o)=>{function n(e,t,o,n){return Math.sqrt((e-o)*(e-o)+(t-n)*(t-n))}o.d(t,{Z:()=>n})},62619:(e,t,o)=>{o.d(t,{Gs:()=>a,IL:()=>u,OW:()=>p,UG:()=>i,kA:()=>m,kK:()=>s,kd:()=>c,oG:()=>d,r3:()=>g,sh:()=>l});o(57658);var n=o(15095),r=o(72126);function i(e){try{return Boolean(e&&void 0!==e.nodeType)}catch(t){return!1}}function a(e){return i(e)&&e.nodeType===Node.TEXT_NODE}function s(e){return i(e)&&e.nodeType===Node.ELEMENT_NODE}function l(e,t){for(;i(e)&&!t(e);)e=e.parentNode;return e}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(i(e)){for(const o of n.p4(e.childNodes))a(o)?t.push(o):o.childNodes&&c(o,t);return t}return[]}const d=function(e,t){return i(e)&&i(t)?r.cx(e.childNodes,(e=>e===t)):-1},p=(()=>{if("undefined"==typeof window)return!0;if(window.InputEvent&&"function"==typeof window.InputEvent.prototype.getTargetRanges)return!0;const e=window.document.createElement("div");e.contentEditable="true";return"onbeforeinput"in e})(),u=e=>{!p&&e.preventDefault&&e.preventDefault()};function m(e){return"inputType"in e}function g(e,t){return e!==t&&e.contains(t)}},43045:(e,t,o)=>{let n;o.d(t,{N:()=>a});let r=!1;function i(){r||(r=!0,window.requestAnimationFrame((()=>{r=!1,(n||(n=document.createElement("div"),n.style.position="fixed",n.style.top="-9999px",n.style.left="-9999px",n.style.zIndex="-9999",document.body.appendChild(n)),n).style.height=`${Math.random()}px`})))}function a(){const e=window.getSelection();e&&e.anchorNode&&i()}},63085:(e,t,o)=>{o.d(t,{bf:()=>v,sj:()=>y,W4:()=>p,id:()=>m,cJ:()=>g,YG:()=>f});o(21703);var n=o(80951),r=o(68626);o(57658);var i=o(29477),a=o(95477),s=o(77080),l=o(24608);const c=1e4;async function d(e){const{environment:t,sourceURL:o}=e;let n;n=`https://embed.notion.co/api/iframely?key=${a.default.iframely_prod.key}&url=${o}`;const s={environment:t,method:"GET",url:n,format:"json"},{result:c}=await i.vW(3,1e4,(()=>(0,l.ZP)(s)));if(c&&"success"===c.type)return function(e){const t=e;return Object.keys(e).forEach((o=>{if("meta"===o&&(e[o].title&&(t.title=e[o].title),e[o].description&&(t.description=e[o].description),e[o].site&&(t.provider_name=e[o].site)),"url"===o&&(t.url=e[o]),"links"===o){if(e[o].thumbnail&&e[o].thumbnail.length>0){t.images=[];const n={width:Number,height:Number,url:String};n.width=e[o].thumbnail[0].media&&e[o].thumbnail[0].media.width?e[o].thumbnail[0].media.width:480,n.height=e[o].thumbnail[0].media&&e[o].thumbnail[0].media.height?e[o].thumbnail[0].media.height:1080,n.url=e[o].thumbnail[0]&&e[o].thumbnail[0].href?e[o].thumbnail[0].href:"",t.images.push(n)}e[o].icon&&e[o].icon.length>0&&(t.favicon_url=e[o].icon[0].href)}})),t}(c.data);r.log({level:"error",from:"embedHelpers",type:"getExtractedData",error:null==c?void 0:c.error,data:{miscDataToConvertToString:{provider:"iframely"}}})}async function p(e,t){const o=encodeURIComponent(t.trim());return"on"===s.default.getEligibleGroup({experimentId:"iframely_switch",defaultGroup:"control"})?await d({environment:e,sourceURL:o}):await async function(e,t){const o={environment:e,method:"GET",url:`https://api.embed.ly/1/extract?key=${a.default.embedly.key}&url=${t}`,format:"json"},{result:n}=await i.vW(3,c,(()=>(0,l.ZP)(o)));if(n&&"success"===n.type)return n.data;r.log({level:"error",from:"embedHelpers",type:"getExtractedData",error:null==n?void 0:n.error,data:{miscDataToConvertToString:{provider:"embedly"}}})}(e,o)}const u=/(\/d\/|id=)([-\w]{25,})/;function m(e){const t=e.match(u);if(t&&!(t.length<3))return t[2]}function g(e){return n.zB(e.store.getProperties().source)||e.source}const h=new Set(["http:","https:","blob:","data:"]),f=function(e){const t=new URL(e,a.default.domainBaseUrl).protocol;return h.has(t)};function y(e){if(e&&e instanceof v)return{type:"invalid_protocol",protocol:e.protocol}}class v extends Error{constructor(e){const t=new URL(e,a.default.domainBaseUrl).protocol;super(`Invalid URL protocol: "${t}"`),this.name=void 0,this.protocol=void 0,this.protocol=t,this.name="InvalidUrlProtocolError"}}},83631:(e,t,o)=>{o.d(t,{D9:()=>v,JT:()=>k,Jf:()=>x,ND:()=>b,TJ:()=>_,Xu:()=>S,bc:()=>y,by:()=>w,nk:()=>I,qZ:()=>C});var n=o(41892),r=o(98923),i=o(15095),a=o(65454),s=o(72126),l=o(70203),c=o(44805),d=o(97880),p=o(63143),u=o(50906),m=o(62619),g=o(68056),h=o(89224),f=o(89086);function y(){return(0,a.ZP)(n.Z.katex.katexMinCss,{resourceType:a._g.Stylesheet})}function v(e){const{source:t,currentEquationToken:o,selectedText:n}=e;return"rich_text_menu"===t?o?{type:"edit",source:t}:{type:"create",source:t,selection:!0}:"input_keyboard_shortcut"===t?o?{type:"edit",source:t}:{type:"create",source:t,selection:Boolean(n)}:"slash_menu"===t?{type:"create",source:t,selection:!1}:"click_token"===t||"arrow_keys"===t?{type:"edit",source:t}:"text_filter"===t?{type:"create",source:t,selection:!0}:void(0,d.t1)(t)}function b(e){const{environment:t,equation:o,from:n}=e;u.iA$(t,{equation:o,equationNewlineCount:o.split("\n").length-1,equationBackslashCount:o.split("\\").length-1,equationLength:i.p4(o).length,from:n})}function S(e){return m.kK(e)&&e.classList.contains(c.et)}function _(e){const{selection:t,environment:o}=e,n=h.getRect(t);if(!n){return m.sh(t.startContainer,m.kK).getBoundingClientRect()}if(o.device.isChrome){const e=t.startContainer.childNodes[t.startOffset];return e&&S(e)?e.getBoundingClientRect():m.kK(t.startContainer)?new DOMRect(n.left,n.top,n.width,t.startContainer.getBoundingClientRect().height):new DOMRect(n.left,n.top,n.width,22)}return n}function w(e){const{environment:t,equation:o,displayMode:n}=e,i=t.KatexStore.getKatex();return i&&(0,r.CY)({katex:i,equation:o,options:{displayMode:"block"===n}}).error}function k(e){if("editing"!==e.mode)return;const t=(0,g.QY)(e.multiSelection);if(!t)return;const{store:o,selection:n}=t,{tokensBeforeRange:r,tokensInsideRange:i}=l.xrQ(o.getValue(),n.startIndex,n.endIndex);let a=s.Sm(r.map(l.J1x));for(const s of i){const e=l.J1x(s),t={startIndex:a,endIndex:a+e};if(l.YrK(s))return{token:s,position:t};a+=e}}function x(e){let t=e;for(let o=0;o<2;o+=1){const e=/^\$(.*)\$$/m.exec(t);if(!e||!e[1])break;t=e[1]}return t}function I(e){const t=(0,g.QY)(e.multiSelection);if(!t)return[];const{selection:o,store:n}=t,r=n.getValue();if(!r)return[];const i=f.wd(o)&&o.startIndex>0?[o.startIndex-1]:[o.startIndex];return f.oc(i,r)[0]||[]}function C(e){const{equationState:t,isTemporary:o}=e,n=t.editingToken?p.uh(l.hDy(t.editingToken),(e=>l.kuv(e)||l.QVC(e))):p.uh(t.annotations,(e=>l.kuv(e)||l.QVC(e)||l.ZAl(e))),r=s.oA([o&&l.W9d(),...n]);return l.qZ6(t.value,r)}},73744:(e,t,o)=>{o.d(t,{DJ:()=>a,ZV:()=>i,lj:()=>r});let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("test",(()=>{}),e)}catch(s){}const r=function(e,t,o,r){n?e.addEventListener(t,o,{passive:!0,capture:Boolean(r)}):e.addEventListener(t,o,Boolean(r))},i=function(e,t,o,n){e.removeEventListener(t,o,Boolean(n))};function a(e){if(void 0!==e)return"shiftKey"in e&&"altKey"in e&&e.shiftKey&&e.altKey?"window":"metaKey"in e&&e.metaKey||"ctrlKey"in e&&e.ctrlKey?"tab":void 0}},41232:(e,t,o)=>{o.d(t,{GQ:()=>g,Ue:()=>m,Xg:()=>v,_F:()=>f,_l:()=>h,o$:()=>b,pI:()=>y,y6:()=>u});var n=o(17215),r=o(78601),i=o(2864),a=o(97880),s=o(44876),l=o(80444),c=o(77080),d=o(30874),p=o(40671);function u(e){if(e.isCollectionView()){var t,o;if(null===(t=e.getCollectionViewCollectionStore())||void 0===t||!t.isSyncedCollection())return;return null===(o=e.getCollectionViewCollectionStore())||void 0===o?void 0:o.getFormat()}return e.getFormat()}function m(e,t){const o=d.Z.state;if(!e||!o.loaded)return[];const n=(0,s.ny)({url:e,integrations:d.Z.integrations.state,currentSpaceId:t});return"success"!==n.type?[]:o.bots.filter((e=>e.integration_id===n.integration.id))}function g(e,t){if(!e)return;const o=(0,s.ny)({url:e,integrations:d.Z.integrations.state,currentSpaceId:t});return"success"===o.type?o:void 0}function h(e){const{store:t,isInDarkMode:o}=e,r=u(t);if(null!=r&&r.is_placeholder||null!=r&&r.error){const e=d.Z.integrations.state.find((e=>{let{id:t}=e;return r.integration_id===t}));if(e){const t=d.Z.bots.state.filter((t=>t.integration_id===e.id)).map((e=>{let{id:t}=e;return t})),{icon:a,dark_icon:c,accent_color:p,accent_icon:u}=e.info,m=o&&c?c:a;if(!m||!p||!u)return;const g=r.original_url;let h;if(g){var i;const t=(0,s.ny)({url:g,integrations:[e],currentSpaceId:null===(i=l.default.state.currentSpaceStore)||void 0===i?void 0:i.id});"success"===t.type&&(h=t.pattern)}return{type:null!=r&&r.is_placeholder?"placeholder":"error",userHasBotForIntegration:t.length>0,renderConfig:{headerAttributes:[{formatter:n.V1.placeholder,attribute:{id:"title",name:"Title",type:"inline",values:[e.name],format:{type:"title"}}}]},action:g&&!h?"error":void 0,updating:!1,originalUrl:g,pattern:h,integration:{id:e.id,icon:m,name:e.name,accentColor:p,accentIcon:u},botIds:t}}}return f({...e,getRenderFn:e=>e.block})}function f(e){var t;const{store:o,isInDarkMode:n,canEdit:i,currentUserId:c,showAction:d,getRenderFn:h}=e,f=u(o);if(!f||f.is_placeholder)return;if(void 0===f.external_object_id&&void 0!==f.uri)return;const y=f.original_url||f.uri;if(!o.isDefined())return;const v=g(y,o.getSpaceId()??(null===(t=l.default.state.currentSpaceStore)||void 0===t?void 0:t.id));if(!y||!v)return;const b=m(y,o.getSpaceId()),S=b.length>0,_=o.getExternalObjectSubInstanceStores(),w=_.map((e=>e.getFormat())).filter(a.$K);if(w.length!==_.length)return;const{integration:k,pattern:x}=v,{icon:I,dark_icon:C,accent_color:T,accent_icon:M}=k.info,P=n&&C?C:I;if(!P||!T||!M)return;const A=(0,r.U)(x.name),D=(0,s.Tf)({url:y,integration:k}),B=h(A)({integrationIcon:P,root:f,relations:w,parsedAttributes:D});if(!B)return;const R=p.Z.state.updatingUrls.has(y),E=Date.now(),F=Boolean(o.getCreatedById()!==c&&o.getCreatedTime()&&E-o.getCreatedTime()<6e4);let N;return!R&&i&&c&&(d?N=d:f.error?N="error":(null==f||!f.stale)&&f.attributes||F||(N=S?"update":"authenticate")),{type:"active",renderConfig:B,action:N,updating:R,originalUrl:y,integration:{id:k.id,icon:P,name:k.name,accentColor:T,accentIcon:M},pattern:x,userHasBotForIntegration:S,botIds:b.map((e=>{let{id:t}=e;return t}))}}function y(e,t){if(!t)return e;const o=g(e,t);return"success"!==(null==o?void 0:o.type)?e:(0,i.l)({url:e,integration:o.integration,pattern:o.pattern})}function v(){return"on"===c.default.getEligibleGroup({experimentId:"link_preview_resizing",defaultGroup:"control"})}function b(){return"on"===c.default.getEligibleGroup({experimentId:"link_preview_resizing_api",defaultGroup:"control"})}},6398:(e,t,o)=>{o.d(t,{hx:()=>A,lf:()=>P,ox:()=>T,r4:()=>M});o(67294);var n=o(13991),r=o(86628),i=o(24405),a=o(6906),s=o(8848),l=o(84619),c=o(7057),d=o(53877),p=o(42875),u=o(5366),m=o(97880),g=o(82990),h=o(44876),f=o(62896),y=o(51077),v=o(56496),b=o(12981),S=o(81865),_=o(65085),w=o(85567),k=o(33929),x=o(85893);function I(e){window.__c={n:"ExternalObjectInstanceAttributeToken"};const{title:t,color:o,icon:n}=e,r=(0,i.Fg)(),c=o?(0,s.MJ)(`rgb(${o.r},${o.g},${o.b})`):void 0,d=(0,s.KR)(r,c);return(0,x.jsx)(w.Z,{format:l.lo.Medium,value:n?(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,x.jsx)(S.Z,{isAuthenticated:!1,url:n,width:32,render:(e,t)=>(0,x.jsx)(b.Z,{src:t,height:12,placeholderLoadedStyle:{width:12,height:12,marginRight:4}})}),(0,x.jsx)(f.Z,{children:(0,a.Z)(t)})]}):(0,x.jsx)(f.Z,{children:(0,a.Z)(t)}),showRemoveButton:!1,color:d.textColor,backgroundColor:d.backgroundColor,isSingle:!0,style:{display:"flex",whiteSpace:"break-spaces",flex:"0 0 auto"}})}function C(e){var t,o,n;window.__c={n:"ExternalObjectInstanceRelation"};const{uri:i,store:a,...s}=e,l=(0,r.VK)((()=>{const e=a.getExternalObjectSubInstanceStores().find((e=>{const t=e.getKeyStore("format").getKeyStore("uri").getValue();return t&&t===i}));if(e)return e.getFormat()}),[a,i]);if(!l)return null;const c=null===(t=l.attributes)||void 0===t?void 0:t.find(h.Id),d=null===(o=l.attributes)||void 0===o?void 0:o.find(h.li),p=null===(n=l.attributes)||void 0===n?void 0:n.find(h.hW);return c?p?(0,x.jsx)(I,{title:c.values[0],color:p.values[0],icon:null==d?void 0:d.values[0]}):c?(0,x.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[d&&(0,x.jsx)(y.Z,{type:"image_url",imageURL:d.values[0],size:16,style:{marginRight:4},imageStyle:s.avatarStyle}),(0,x.jsx)(T,{attribute:c,store:a,...s})]},i):null:null}function T(e){window.__c={n:"ExternalObjectInstanceAttribute"};const{attribute:t,formatter:o,store:n,style:r,avatarStyle:a}=e,s=(0,i.Fg)();if((0,h.Id)(t)){var l;const e=t.values[0];if("enum"===(null===(l=t.format)||void 0===l?void 0:l.type)){const{color:o}=t.format;return(0,x.jsx)(I,{title:e,color:o})}{const t=e.replace(/[\r\n]/g,"").trim(),n=o?k.default.formatMessage(o,{value:t}):t;return(0,x.jsx)("div",{spellCheck:!1,style:{whiteSpace:"nowrap",color:s.mediumTextColor,...r},children:n})}}if((0,h.OM)(t))return(0,x.jsx)(C,{uri:t.values[0],store:n,style:r,avatarStyle:a});if((0,h.Gc)(t))return(0,x.jsx)(M,{attribute:t,formatter:e.formatter,style:e.style,dateStyle:"relative"});if((0,h.An)(t)){const e=t.values[0];return(0,x.jsx)("div",{style:{color:s.mediumTextColor,fontSize:12,...r},children:o?k.default.formatMessage(o,{value:e}):String(e)})}return null}function M(e){window.__c={n:"ExternalObjectInstanceDateAttribute"};const{attribute:t,formatter:o,style:r,dateStyle:a}=e,s=(0,u.useIntl)(),l=(0,i.Fg)(),g=t.values[0];let h;if("datetimerange"===g.type)h=(0,c.ZV)({allowRelativeDates:!1,displayInUserTimezone:!0,intl:s,value:g});else{const e=(0,d.uO)(g,(0,p.r)());a&&"relative"!==a?"exact_time"===a?h=(0,c.Yx)(e,"medium_with_time",n.SP):"exact_date"===a?h=(0,c.Yx)(e,"medium",n.SP):(0,m.t1)(a):h=(0,c.tv)(e,n.SP)}const f=o?k.default.formatMessage(o,{value:h}):h;return(0,x.jsx)("div",{style:{color:l.mediumTextColor,fontSize:12,whiteSpace:"nowrap",...r},children:f})}function P(e){window.__c={n:"ExternalObjectInstanceIconAttribute"};const t=(0,i.Fg)(),{attribute:o,isSmall:n}=e,r=n?22:34,a={...e.style,borderRadius:r,boxShadow:t.avatarBoxShadow};return(0,h.li)(o)?(0,x.jsx)(y.Z,{type:"image_url",imageURL:o.values[0],size:r,imageStyle:a}):(0,h.Id)(o)?(0,x.jsx)("div",{style:{...a,borderRadius:r,overflow:"hidden",boxShadow:t.avatarBoxShadow,height:30,width:30},children:(0,x.jsx)(v.Z,{size:r,title:o.values[0]})}):null}function A(e){window.__c={n:"ExternalObjectInstanceStringBodyAttribute"};const{attribute:t}=e,o=(0,i.yK)((e=>({text:{color:e.regularTextColor,fontSize:12,lineHeight:1.45},buttons:{fontWeight:g.Z.fontWeight.medium}})),[]);return(0,x.jsx)("div",{style:{marginRight:4,marginBottom:4,width:"100%"},children:(0,x.jsx)(_.Z,{moreElement:(0,x.jsxs)(x.Fragment,{children:["â€¦","Â ",(0,x.jsx)("span",{style:{...o.text,...o.buttons},children:(0,x.jsx)(u.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.moreLabel",defaultMessage:"more"})})]}),lessElement:(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("span",{style:{...o.text,...o.buttons},children:(0,x.jsx)(u.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.showLessLabel",defaultMessage:"show less"})})}),maxLines:3,children:(0,x.jsx)("div",{spellCheck:!1,style:o.text,children:t.values[0]})})})}},69988:(e,t,o)=>{o.d(t,{LX:()=>c,Vu:()=>d,XT:()=>u,ZP:()=>m,fe:()=>p,il:()=>l});o(57658);var n=o(72126),r=o(92338),i=o(63143);function a(e){const t=[];let o=!1,n=e;for(;""!==n;){const e=o?r.dK:r.Um,i=n.indexOf(e);if(-1===i)return t.push(s(n,!1)),t;const a=n.substring(0,i),l=n.slice(i+e.length);""!==a&&t.push(s(a,o)),n=l,o=!o}return t}function s(e,t){return t?[e,"highlight"]:[e]}function l(e){return 2===e.length&&"highlight"===e[1]}function c(e){return e[0]}function d(e){return e.reduce(((e,t)=>{if(0===e.length)return[t];const o=e[e.length-1];return l(o)===l(t)?[...e.slice(0,e.length-1),s(c(o)+c(t),l(t))]:[...e,t]}),[])}function p(e){if(!e)return[];let t=a(e);t.some((e=>l(e)&&1===c(e).length))&&(t=d(t));const o=t.filter(l).map(c);return n.jj(o)}function u(e){const{text:t,patterns:o,uniqueTokenHighlighterContext:r}=e,a=n.jj(o.filter((e=>e.length>0)));if(0===a.length)return[s(t,!1)];const l=n.MR(a,(e=>-e.length)).map(n.hr);return function(e,t,o){const n=(0,i.uO)(t,e);if(0===n.length)return[s(e,!1)];let r=0;const a=[];for(let i=0;i<n.length;i++){const t=n[i];if(!t)continue;let l;void 0===o||!o.has(t[0].toLowerCase())?(void 0!==o&&o.add(t[0].toLowerCase()),r!==t.index&&a.push(s(e.slice(r,t.index),!1)),a.push(s(t[0],!0)),l=t.index+t[0].length):l=r;n[i+1]||l===e.length||a.push(s(e.slice(l),!1)),r=l}return a}(t,new RegExp(l.join("|"),"ig"),r)}const m=a},44486:(e,t,o)=>{o.d(t,{W:()=>i});var n=o(41432),r=o(35661);function i(e){return e.findRecordStoreUIAncestor((e=>e instanceof r.G&&e.getType()===n.Ti.factory)).ancestor}},79897:(e,t,o)=>{o.d(t,{r:()=>s});var n=o(72126),r=o(80444),i=o(81236),a=o(38755);function s(e){const{currentUserRootStore:t}=r.default.state,o=null==t?void 0:t.getSpaceViewStores(),s=n.oA(null==o?void 0:o.map((e=>e.getSpaceId()))).map((t=>i.Z.getPublicSpaceData(e,t))),l=function(e){const t=e.map((e=>(0,a.cD)(e))),o=new Set(n.oA(t));return o.has("enterprise")?"enterprise":o.has("business")?"business":o.has("plus")?"plus":o.has("team_free")?"team_free":o.has("student")?"student":o.has("personal")?"personal":o.has("personal_free")?"personal_free":(o.has("free"),"free")}(s);return{userHighestPlanType:l,isSalesAssistedPlan:n.hX(s,{subscriptionTier:l}).some((e=>{if("none"!==(null==e?void 0:e.role)&&!0===(null==e?void 0:e.is_sales_assisted))return!0}))}}},19306:(e,t,o)=>{o.d(t,{W:()=>a});var n=o(5366),r=o(33929);const i=(0,n.defineMessages)({twoItems:{id:"formatSettings.twoItems",defaultMessage:"{item1} and {item2}"},threeOrMoreItems:{id:"formatSettings.threeOrMoreItems",defaultMessage:"{item1}, and {numberOfOther} others"}});function a(e){if(0===e.length)return"";const t=e[0];if(1===e.length)return t;const o=e[1];if(2===e.length)return r.default.formatMessage(i.twoItems,{item1:t,item2:o});const n=e.length-1;return r.default.formatMessage(i.threeOrMoreItems,{item1:t,numberOfOther:n})}},17809:(e,t,o)=>{o.d(t,{Cl:()=>u,NY:()=>g,V1:()=>m});var n=o(67294),r=o(480),i=o(86628),a=o(72126),s=o(4615),l=o(21202),c=(o(70203),o(84398)),d=o(77080),p=o(35661);function u(e){const{initialValue:t,onChange:o,source:d="title",parentCollection:u}=e,m=(0,r.O7)(),g=(0,c.$)("formulaPrototypeHelpers.useMockTextStore",{isMockTextStore:!0,overrideDefaultRecordCache:!0}),h=function(e){const{initialValue:t,inMemoryRecordCache:o,source:i,parentCollection:a}=e,c=(0,r.O7)(),d=(0,n.useMemo)((()=>t),[]);return(0,n.useMemo)((()=>{const e={id:(0,s.ZP)(),table:l.iU};o.setRecord({pointer:e,userId:c.currentUser.id},{value:{alive:!0,id:e.id,parent_id:(null==a?void 0:a.id)??s._6,parent_table:"block",properties:{[i]:d},space_id:(null==a?void 0:a.getSpaceId())??s._6,type:"page",version:0},role:"editor"});const t=new p.ST({environment:c,inMemoryRecordCache:o,path:["properties",i],pointer:e,userId:c.currentUser.id});return o.emitRecord(e,[]),t}),[c,o,d,a,i])}({initialValue:t,inMemoryRecordCache:g,source:d,parentCollection:u}),f=(0,n.useRef)(t),y=(0,n.useCallback)((e=>{const t=m.currentUser.id,o=h.getRecordStoreAtRootPath();if(o instanceof p.G){const n=o.getValue();n&&(g.setRecord({pointer:h.pointer,userId:t},{role:"editor",value:{...n,properties:{...null==n?void 0:n.properties,[d]:e}}}),g.emitRecord(h.pointer,[]))}}),[m.currentUser.id,h,g,d]);return(0,i.VK)((()=>{const e=h.getValue();a.Xy(f.current,e)||(f.current=e,null==o||o(e))}),[h,o]),{store:h,setValue:y}}function m(){return d.default.checkGate("formulas_prototype")}function g(){return d.default.checkGate("formula_buttons")}},35683:(e,t,o)=>{o.d(t,{uP:()=>c,_R:()=>m,vu:()=>l});o(57658);var n=o(30120),r=(o(21703),o(30541),o(7406));const i=class{constructor(e){let{maxSize:t,prefix:o,store:n,version:r}=e;this.prefix=void 0,this.maxSize=void 0,this.store=void 0,this.version=void 0,this.serializedKeys=void 0,this.namespace=void 0,this.lastVersion=void 0,this.createInternalKey=e=>`${this.namespace}${e}`,this.maxSize=t,this.prefix=o,this.store=n,this.version=r.toString(),this.namespace=`${o}:${r}::`,this.serializedKeys=`${o}:${r}:keys`,this.lastVersion=`${o}:version`}set(e,t){try{this.setInternal(e,t),this.promote(e)}catch(o){return{error:(0,r.tg)(o)}}return{value:void 0}}get(e){try{const t=this.getInternal(e);if(null!==t)return{value:t}}catch(t){return{error:(0,r.tg)(t)}}return{value:void 0}}remove(e){try{this.getKeys().indexOf(e)>-1&&(this.removeInternal(e),this.evict(e))}catch(t){return{error:(0,r.tg)(t)}}return{value:void 0}}clear(){try{const e=this.getKeys();for(const t of e)this.removeInternal(t);this.setKeys([])}catch(e){return{error:(0,r.tg)(e)}}return{value:void 0}}scan(e){try{const t=this.getKeys();for(const o of t){const t=this.getInternal(o);if(null===t)throw new Error(`Item not found: ${o}`);e(o,t)}}catch(t){return{error:(0,r.tg)(t)}}return{value:void 0}}entries(){const e=[],t=this.scan(((t,o)=>{e.push([t,o])}));return t.error?{error:t.error}:{value:e}}keys(){try{return{value:this.getKeys()}}catch(e){return{error:(0,r.tg)(e)}}}slowGC(){const e=[],t=e=>e!==this.serializedKeys&&(!!e.endsWith("keys")&&this.isOldKey(e));for(let o=0;o<this.store.length;o+=1){const n=this.store.key(o);null!==n&&((this.isOldKey(n)||t(n))&&e.push(n))}for(const o of e)this.store.removeItem(o)}updateVersionAndGC(){const e=this.store.getItem(this.lastVersion);if(null!==e){const t=parseInt(e,10),o=parseInt(this.version,10),n=!Number.isNaN(t),r=!Number.isNaN(o);n&&r&&t<o&&this.slowGC()}this.store.setItem(this.lastVersion,this.version)}isOldKey(e){if(!e.startsWith(`${this.prefix}:`))return!1;const t=e.substring(`${this.prefix}:`.length),o=parseInt(t,10);if(Number.isNaN(o))return!1;return o<parseInt(this.version,10)}getKeys(){const e=this.store.getItem(this.serializedKeys);if(null===e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}setKeys(e){const t=JSON.stringify(e);this.store.setItem(this.serializedKeys,t)}promote(e){const t=this.getKeys(),o=t.indexOf(e);if(o>-1)t.splice(o,1),t.unshift(e);else if(t.unshift(e),t.length>this.maxSize){const e=t.splice(this.maxSize);for(const t of e)this.removeInternal(t)}this.setKeys(t)}evict(e){const t=this.getKeys(),o=t.indexOf(e);o>-1&&t.splice(o,1),this.setKeys(t)}setInternal(e,t){this.store.setItem(this.createInternalKey(e),JSON.stringify(t))}getInternal(e){const t=this.store.getItem(this.createInternalKey(e));return null===t?null:JSON.parse(t)}removeInternal(e){this.store.removeItem(this.createInternalKey(e))}};var a=o(72126),s=o(97880);let l=function(e){return e.Default="Default",e.Link="Link",e.Favorite="Favorite",e.Search="Search",e}({});const c=3,d={BONUS:{DEFAULT:100,LINK:120,SEARCH:200,FAVORITE:140},BONUS_NORMALIZER:100,TIME_BUCKETS:[{days:4,weight:100},{days:14,weight:70},{days:31,weight:50},{days:90,weight:30}],DEFAULT_BUCKET_WEIGHT:10};function p(e){const{BONUS:t}=d;switch(e){case l.Default:return t.DEFAULT;case l.Link:return t.LINK;case l.Favorite:return t.FAVORITE;case l.Search:return t.SEARCH;default:(0,s.t1)(e)}}function u(e,t){const{TIME_BUCKETS:o,DEFAULT_BUCKET_WEIGHT:r}=d,i=n.ou.fromMillis(e).diff(n.ou.fromMillis(t),"days").get("days");return i<=o[0].days?o[0].weight:i<=o[1].days?o[1].weight:i<=o[2].days?o[2].weight:i<=o[3].days?o[3].weight:r}class m{constructor(e){var t=this;this.maxStoredVisits=void 0,this.visits=void 0,this.recordVisit=e=>{const{id:t,type:o,timestampForTestingOnly:n}=e,r=this.createVisit(o,n),i=this.visits.get(t);if(i.error)return;const s=i.value||this.createVisitCacheEntry();var l,c,d;s.totalVisits+=1,s.recentVisits=(l=s.recentVisits,c=r,d=this.maxStoredVisits,[...(0,a.pm)(l,d-1),c]),this.visits.set(t,s)},this.getVisits=e=>{const t=this.visits.get(e);if(!t.error)return t.value},this.getVisitedIds=()=>{const e=this.visits.keys();return e.error?[]:e.value},this.getFrecencyScore=function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();const n=t.getVisits(e);if(!n)return m.UNVISITED_FRECENCY_SCORE;const{totalVisits:r,recentVisits:i}=n;if(0===r||0===i.length)return m.UNVISITED_FRECENCY_SCORE;const s=i.map((e=>{const{type:t,timestamp:n}=e,r=p(t);return u(o,n)*(r/d.BONUS_NORMALIZER)})),l=(0,a.Sm)(s)/s.length,c=Math.ceil(r*l);return c};const{maxBlocks:o,maxStoredVisits:n,store:r,version:s}=e;this.maxStoredVisits=n,this.visits=new i({prefix:e.prefix||"FrecencyStore",maxSize:o,store:r,version:s})}initialize(){this.visits.updateVersionAndGC()}sortFrecencyHighToLow(e){const{items:t,now:o,recordFrecency:n}=e;return(0,a.MR)(t,(e=>{const t="number"==typeof e.score?e.score:1,r=this.getFrecencyScore(e.id,o);n&&(e.frecencyScore=r);const i=e.personalizationBoost??1;return-1*t*Math.max(r,i)}))}createVisitCacheEntry(){return{totalVisits:0,recentVisits:[]}}createVisit(e,t){return{type:e,timestamp:"number"==typeof t?t:Date.now()}}clear(){const e=[];this.visits.scan((t=>e.push(t)));for(const t of e)this.visits.remove(t)}}m.UNVISITED_FRECENCY_SCORE=1},84210:(e,t,o)=>{o.d(t,{Hu:()=>p,ZP:()=>u});var n=o(1800),r=o(15157),i=o(63306),a=(o(64002),o(95477)),s=o(80444),l=o(886),c=o(88923),d=o(98165);function p(e){e={fullyQualified:!0,...e};const{store:t,collectionViewId:o,showMoveTo:p,saveParent:u,preferPublicLink:m,duplicate:g,getSpaceDomain:h,pageVisitSource:f,queryId:y}=e;let v;if(o)v=o;else if(t&&t.isCollectionView()){const e=r.Z.get({userId:t.environment.currentUser.id,key:l.Z.getLocalViewPreferenceKey(t.id)});if(e)v=e;else{const e=t.getCollectionViewsStore().getValue();e&&(v=e[0])}}const b=t.getParentSpaceStore(),{currentSpaceStore:S}=s.default.state,_=b||S,w=(0,d.fJ)(t),k=(0,i.$t)(w),x=m&&k?(null==_?void 0:_.getPublicContentDomain())||(null==h?void 0:h()):null==_?void 0:_.getEditDomain();let I=a.default.domainBaseUrl;const C=m&&k&&x;if(C){let e="https:";try{e=new URL(a.default.domainBaseUrl||"").protocol||e}catch{}I=`${e}//${x}.${a.default.publicDomainName}`}let T=t,M=e.scrollToBlockId;if(t.isReady()&&!t.isNavigableBlock()){const e=(0,d.Dg)(t);e&&(T=e,M=t.id)}const P=s.default.state.mainEditorCurrentBlockStore;let A,D,B;return P&&e.openInSidePeek?(A=P,D=T.id,B=(0,c.getUrlParamFromPeekMode)(c.PeekModeSide)):(A=T,D=e.peekViewBlockId,B=e.peekMode),(0,n.Z)({pageId:A.id,pageModel:A.getModel(),pageVisitSource:f,queryId:y,scrollToBlockId:M,peekViewBlockId:D,peekMode:B,collectionViewId:v,discussionId:e.discussionId,spaceDomain:C?void 0:x,baseUrl:e.fullyQualified||m?I:void 0,showMoveTo:p,saveParent:u,duplicate:g,templateGalleryItem:e.templateGalleryItem,projectManagementLaunch:e.projectManagementLaunch})}const u=p},87078:(e,t,o)=>{o.d(t,{Z:()=>r});var n=o(15723);const r=function(){const e=document.documentElement;return new n.iL(0,0,e.clientWidth,e.clientHeight)}},28415:(e,t,o)=>{o.d(t,{qH:()=>p,vE:()=>c});var n=o(65454),r=o(99405),i=o(50906),a=o(47839),s=o(95477),l=o(77080);async function c(e){const{environment:t,accessToken:o}=e;if(i.D6j(t,{from:e.from}),t.device.isElectron){const t=await a.openGoogleDrivePickerPopup({url:(0,r.zN)(s.default.domainBaseUrl,{token:o})});if(!t)return;"integration"in e?e.callback(!1,t.url):e.callback(t.id)}else await(0,n.ZP)("https://apis.google.com/js/api.js"),"integration"in e?window.gapi.load("picker",(()=>d({environment:t,accessToken:o,callback:e.callback,integration:e.integration}))):window.gapi.load("picker",(()=>d({environment:t,accessToken:o,callback:e.callback})))}function d(e){const{environment:t,accessToken:o}=e,n=`${window.location.protocol}//${window.location.host}`;(new window.google.picker.PickerBuilder).enableFeature(window.google.picker.Feature.SUPPORT_DRIVES).setOAuthToken(o).hideTitleBar().setOrigin(n).addView(new window.google.picker.DocsView).setCallback((o=>{if(o.action===window.google.picker.Action.PICKED&&o.docs&&o.docs.length>0){const n=o.docs[0];"integration"in e?e.callback(!1,n.url):e.callback(n.id),i.D6j(t,{from:"link_preview_placeholder"})}})).build().setVisible(!0)}function p(){return"on"===l.default.getEligibleGroup({experimentId:"google_external_integration_file_picker",defaultGroup:"control"})}},12534:(e,t,o)=>{o.d(t,{$0:()=>a,Af:()=>n,Wi:()=>s,ZP:()=>l});let n=function(e){return e[e.ButtonMouseDown=0]="ButtonMouseDown",e[e.EditorMouseDown=1]="EditorMouseDown",e[e.EditorMouseUp=2]="EditorMouseUp",e[e.EditorClick=3]="EditorClick",e[e.MenuListClick=4]="MenuListClick",e[e.EditorContextMenu=5]="EditorContextMenu",e[e.EditorMouseOver=6]="EditorMouseOver",e[e.EditorHoverMouseMove=7]="EditorHoverMouseMove",e[e.EditorDropMouseMove=8]="EditorDropMouseMove",e[e.EditorDoubleClick=9]="EditorDoubleClick",e[e.SidebarMouseMove=10]="SidebarMouseMove",e[e.ManageTeamsRowClick=11]="ManageTeamsRowClick",e[e.MobileTap=12]="MobileTap",e[e.CollectionSettingsClick=13]="CollectionSettingsClick",e[e.BaseTableRowClick=14]="BaseTableRowClick",e[e.NotificationClick=15]="NotificationClick",e[e.CollectionAutomationSettingsClick=16]="CollectionAutomationSettingsClick",e}({});const r={};function i(e){const t=r[e.context],o=e.event.nativeEvent||e.event;if(t!==o){var n;r[e.context]=o;"unhandled"===(null===(n=e.callback)||void 0===n?void 0:n.call(e))&&(r[e.context]=t)}}function a(e){i({event:e,context:n.EditorMouseDown,callback:()=>{}})}function s(e){i({event:e,context:n.EditorClick,callback:()=>{}})}const l=i},87290:(e,t,o)=>{o.d(t,{B:()=>l,x:()=>s});var n=o(55367),r=o(22294),i=o(86486),a=o(27724);let s=function(e){return e[e.Default=0]="Default",e[e.Hovered=1]="Hovered",e[e.Selected=2]="Selected",e[e.SelectedDescendant=3]="SelectedDescendant",e}({});function l(e,t){var o;const l=a.default.state.stores,c=i.default.state;if(1===l.length&&l.includes(e))return s.Selected;if(l.length>0&&l.every((t=>e.uiContains(t))))return s.SelectedDescendant;const d=n.ZP.state;return d&&d.isDragging&&d.currentParentStore&&e.uiContains(d.currentParentStore)||d&&d.isDragging&&d.currentDropZone&&d.currentDropZone.type===n.Dl.Selectable&&null!==(o=d.currentDropZone)&&void 0!==o&&o.store&&e.uiContains(d.currentDropZone.store)||c.isOpen&&c.currentStore===e||t&&!r.Z.state.isKeyboardMode?s.Hovered:s.Default}},45023:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(27537),r=o.n(n),i=o(72126);const a=function e(t,o,n){if(Array.isArray(n))return n.some((n=>e(t,o,n)));{const e=n.toLowerCase().split("+");if(t.device.isWindows||t.device.isLinux){if((i.q9(e,"command")||i.q9(e,"ctrl"))!==o.ctrlKey)return!1}else{if(i.q9(e,"command")!==o.metaKey)return!1;if(i.q9(e,"ctrl")!==o.ctrlKey)return!1}return i.q9(e,"shift")===o.shiftKey&&(i.q9(e,"alt")===o.altKey&&i.yW(e,(e=>{if("command"===e||"shift"===e||"ctrl"===e||"alt"===e)return!0;const t="code:";if(e.startsWith(t)&&o.code){const n=e.substr(t.length);return o.code.toLowerCase()===n}return r()(o.keyCode)===e})))}}},92783:(e,t,o)=>{o.d(t,{Z:()=>n});const n=e=>{const{spaceViewStore:t,pageId:o}=e;if(!t||!o)return!1;return-1!==t.getBookmarkedPageIds().indexOf(o)}},28314:(e,t,o)=>{o.d(t,{lF:()=>a,yA:()=>r});var n=o(49085);const r=function(){return i},i={shift:!1,option:!1,control:!1,command:!1},a=n.default.createValue(i),s=function(e){i.shift=Boolean(e.shiftKey),i.option=Boolean(e.altKey),i.control=Boolean(e.ctrlKey),i.command=Boolean(e.metaKey),a.emit()};window.addEventListener("keydown",s),window.addEventListener("keyup",s),window.addEventListener("focus",(function(e){i.shift=!1,i.option=!1,i.control=!1,i.command=!1,a.emit()}))},78429:(e,t,o)=>{o.d(t,{H:()=>i});var n=o(95477),r=o(77080);function i(){return n.default.isAdminMode||"on"===r.default.getEligibleGroup({experimentId:"highlight_legacy_transclusions",defaultGroup:"control"})}},48709:(e,t,o)=>{o.d(t,{FV:()=>c,Fs:()=>m,Ts:()=>g,ZG:()=>u,cX:()=>d,dY:()=>f,hy:()=>p,uP:()=>h});var n=o(99405),r=o(70203),i=o(64002),a=o(95477),s=o(23178);function l(e,t){const o=s.Z.state;o.open&&o.focusLinkInput!==e&&s.Z.setState({...o,focusLinkInput:e,url:t?"":o.url})}function c(){l(!0),u(!1)}function d(){l(!1)}function p(){l(!1,!0)}function u(e){const t=s.Z.state;t.open&&t.focusTitleInput!==e&&s.Z.setState({...t,focusTitleInput:e})}function m(e){const{editingToken:t}=e;if(!t)return;const o=r.hDy(t),n=r.rlz(o);return n?r.zW$(n):void 0}function g(e){if(!e)return;const t=r.hDy(e);return r.rlz(t)?r.WiV(e):void 0}function h(e){return e.url||""}function f(e){const t=r.rOz(e);if(t&&"url"===t.type){const e=(0,n.Wj)({url:t.href,baseUrl:a.default.domainBaseUrl,publicDomainName:a.default.publicDomainName,isMobile:!1,protocol:void 0,currentUrl:void 0});return"page"===e.name?{type:"notion",url:t.href,notionPage:e}:{type:"web",url:t.href}}const o=(0,i.yn)(e);if(o)return{type:"other",url:o}}},28125:(e,t,o)=>{o.d(t,{S:()=>s,k:()=>a});var n=o(13991),r=o(77080),i=o(12955);function a(e){const{mobileNative:t}=e;if(t){const o=Boolean(t.sqliteConnection),n=i.canSetCookie(e);return o&&n}return!0}function s(e){return"en-US"===n.SP&&(e.device.isElectron&&r.default.checkGate("desktop_app_signup_hide_passcode")||e.device.isMobileNative&&e.device.isIOS&&r.default.checkGate("ios_app_signup_hide_passcode"))}},87279:(e,t,o)=>{o.d(t,{Xp:()=>s,mw:()=>l,og:()=>r,qW:()=>c});var n=o(67381);let r=function(e){return e[e.Modal=0]="Modal",e[e.ActionSheet=1]="ActionSheet",e[e.Popup=2]="Popup",e}({});const i="menu",a=(0,n.Q)({modernContextDefaultValue:{menuType:void 0},displayName:i,legacyContextKey:i}),s=a.context,l=a.legacyPropTypes,c=a.Provider},85818:(e,t,o)=>{o.d(t,{$6:()=>a,Ds:()=>r,_K:()=>i,tM:()=>s});var n=o(72126);function r(e,t){let o=0;for(let n=0;n<t.length;n+=1){const r=t[n];if(e>o+r.items.length-1){o+=r.items.length;continue}const i=e-o,a=r.items[i];if(!a)return;return{item:a,index:{section:n,indexLocal:i}}}}function i(e,t){const o=t[e.section];if(!o)return;const n=o.items[e.indexLocal];return n||void 0}function a(e,t){return n.Sm(t.slice(0,e.section).map((e=>e.items.length)))+e.indexLocal}function s(e){return e.reduce(((e,t)=>e+t.items.length),0)}},98742:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(72126),r=o(77744);function i(e,t){const o={...e};return Object.keys(t).forEach((i=>{const a=t[i],s=e[i];s&&i.startsWith("on")&&n.mf(a)?o[i]=function(){s(...arguments),a(...arguments)}:s&&("ref"===i||i.endsWith("Ref"))&&a?o[i]=(0,r.lq)(s,a):s||(o[i]=a||s)})),o}},64496:(e,t,o)=>{o.d(t,{_3:()=>a,fP:()=>i,qE:()=>r});var n=o(5162);function r(){return window.__mobileExperimentCache}function i(e,t,o){if(o)return t&&o.userExperiments?o.userExperiments[t]:{experimentsBySpace:{},experimentsWithoutSpace:o.deviceExperiments,isLoaded:!0,userId:void 0,deviceId:e,test:!1}}function a(e){return(0,n.Y)("supportsMobileExperimentCache")}},52533:(e,t,o)=>{o.d(t,{S$:()=>a,Y2:()=>i,nd:()=>r});o(97880);var n=o(11342);o(95477);let r=function(e){return e[e.Bottom=0]="Bottom",e[e.Floating=1]="Floating",e}({});function i(e){const{environment:t}=e;return!t.device.isIOS&&!t.device.isAndroid}function a(e){const{environment:t}=e;if(!t.device.isIOS)return!1;if(!t.mobileNative||!t.mobileNative.api.openUpgradeModal)return!1;{if(!t.device.mobileAppVersion)return!1;const e=n.parseVersion(t.device.mobileAppVersion),o=n.parseVersion("0.4.165");if(!e||!o)return!1;return!n.isLessThanVersion(e,o)}}},39500:(e,t,o)=>{o.d(t,{N9:()=>i,Nf:()=>a,Vc:()=>r,X9:()=>s,uG:()=>l});var n=o(27186);const r={mouse:6,finger:0,stylus:6};function i(e){return 3===e.button||4===e.button}function a(e){return e&&"stylus"===e.touchType?"stylus":"finger"}const s=function(){return n.IL.moved};function l(e){return!!e.isTrusted&&s()}},75770:(e,t,o)=>{o.d(t,{lQ:()=>E,hD:()=>R,cJ:()=>N,HE:()=>D,uw:()=>F,EC:()=>M,ah:()=>P,vz:()=>B,ru:()=>j,ed:()=>O});o(21703),o(67294);var n=o(53877),r=o(69246),i=o(21202),a=o(6287),s=o(15047),l=o(29369),c=o(97880),d=o(5366),p=o(47307),u=o(74523),m=o(80444),g=o(55367),h=o(35661),f=o(99757),y=o(33929),v=o(35026),b=o(98165),S=o(67669),_=o(18514),w=o(38755),k=o(85644),x=o(82990),I=o(85893);async function C(){return p.confirmUserAction({message:(0,I.jsx)("span",{children:(0,I.jsx)(d.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <boldtext>Only you will be able to access it.</boldtext>",id:"confirmDialog.movePageToPrivate.message",values:{boldtext:e=>(0,I.jsx)("span",{style:{fontWeight:x.Z.fontWeight.semibold},children:e})}})}),acceptLabel:(0,I.jsx)(d.FormattedMessage,{defaultMessage:"Move to private",id:"confirmDialog.movePageToPrivate.confirmButton.label"})})}const T=(0,d.defineMessages)({privateDestinationName:{id:"moveToHelpers.destinationName.private",defaultMessage:"Private"},numPagesDescriptorString:{id:"moveToHelpers.movePageDescriptorString",defaultMessage:"{numPagesMoved, plural, one {# page} other {# pages}}"},numPagesWithSubitemsDescriptorString:{id:"moveToHelpers.movePagesWithSubitemsDescriptorString",defaultMessage:"{numPagesMoved, plural, one {# page} other {# pages}} and {numSubitemsMoved, plural, one {# sub-item} other {# sub-items}}"},numBlocksDescriptorString:{id:"moveToHelpers.moveBlocksDescriptorString",defaultMessage:"{numBlocksMoved, plural, one {# block} other {# blocks}}"},bookmarksDestinationName:{id:"moveToHelpers.destinationName.favorites",defaultMessage:"Favorites"},movedMessagesWithDestinationToast:{id:"moveToHelpers.afterBulkMoveCompleteToastMessageWithDestination",defaultMessage:"Moved {pageDescriptor} to {destinationName}"},movedToDestinationShortToast:{id:"moveToHelpers.afterMoveCompleteOnMobileToastMessageWithDestination",defaultMessage:"Moved to {destinationName}"},movedMessagesToast:{id:"moveToHelpers.afterBulkMoveCompleteToastMessage",defaultMessage:"Moved {pageDescriptor}"}});function M(e){const{movedItems:t,numSubitems:o}=e;if(!(t.filter((e=>e.isNavigableBlock())).length===t.length))return y.default.formatMessage(T.numBlocksDescriptorString,{numBlocksMoved:t.length});if(1===t.length){const e=A(t[0]);if(e)return e}return o?y.default.formatMessage(T.numPagesWithSubitemsDescriptorString,{numPagesMoved:t.length-o,numSubitemsMoved:o}):y.default.formatMessage(T.numPagesDescriptorString,{numPagesMoved:t.length})}const P=e=>{const{environment:t,movedItems:o,moveToLocation:n,numSubitems:r}=e,i=M({movedItems:o,numSubitems:r}),a=function(e){const{environment:t,moveToLocation:o}=e,{currentSpaceStore:n}=m.default.getState();if(void 0===o||void 0===n)return;switch(o.type){case"moveToBlock":return A(o.blockStore);case"moveToCollection":return A(o.collectionStore);case"moveToCurrentWorkspace":return(0,w.rn)(t,n);case"moveToPrivatePages":return y.default.formatMessage(T.privateDestinationName);case"moveToTeam":return A(o.teamStore);case"moveToOtherWorkspace":return(0,w.rn)(t,o.spaceStore);case"moveToBookmarks":case"moveToShared":return;default:(0,c.t1)(o)}}({environment:t,moveToLocation:n});return a?t.device.isPhone?y.default.formatMessage(T.movedToDestinationShortToast,{destinationName:a}):y.default.formatMessage(T.movedMessagesWithDestinationToast,{pageDescriptor:i,destinationName:a}):y.default.formatMessage(T.movedMessagesToast,{pageDescriptor:i})};const A=e=>{var t;const o=y.default.getIntl();if(e)return null===(t=e.getModel())||void 0===t?void 0:t.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:n.x7,intl:o})},D=(e,t)=>{const{currentSpaceStore:o}=m.default.getState(),n=("space"===e.type?e.id:e.spaceId)??(null==o?void 0:o.id);if(void 0===o||void 0===n)return;const r=(e=>{var t;const{currentUserRootStore:o,currentSpaceStore:n}=m.default.state;return(null==n?void 0:n.id)===e?n:null==o||null===(t=o.getSpaceViewStores())||void 0===t||null===(t=t.find((t=>{var o;return(null===(o=t.getSpaceStore())||void 0===o?void 0:o.id)===e})))||void 0===t?void 0:t.getSpaceStore()})(n);if(r){if(r.id!==o.id)return{type:"moveToOtherWorkspace",spaceStore:r,targetParentId:"space-private-pages"!==e.type?e.id:r.id};switch(e.type){case"page":{const t=m.default.state.mainEditorCurrentBlockStore;if(!t)return;return{type:"moveToBlock",blockStore:h.G.createChildStore(t,{table:i.iU,id:e.id})}}case"collection":return{type:"moveToCollection",collectionStore:h.NW.createChildStore(r,{table:a.v,id:e.id})};case"space":return{type:"moveToCurrentWorkspace"};case"space-private-pages":return{type:"moveToPrivatePages"};case"team":return{type:"moveToTeam",teamStore:h.zX.createChildStore(r,{table:l.e0,id:e.id})};default:(0,c.t1)(e)}}},B=e=>{const{droppedDirection:t,targetStore:o,outlinerSectionType:n}=e,{currentSpaceStore:i}=m.default.getState();if(!i||!n)return;let a=o;if("block"===(null==o?void 0:o.table)&&t!==g.vh.Onto){if("bookmarks"===n)return{type:"moveToBookmarks"};if("shared"===n)return{type:"moveToShared"};a=null==o?void 0:o.getParentStore()}if(void 0===a)return;if(i.id===a.id)return(e=>{switch(e){case"workspace":return{type:"moveToCurrentWorkspace"};case"bookmarks":return{type:"moveToBookmarks"};case"private":return{type:"moveToPrivatePages"};case"shared":return{type:"moveToShared"};case"team":case r.kg:case r.PT:case r.cz:case r.mu:case r.g$:return;default:(0,c.t1)(e)}})(n);switch(a.table){case"block":return{type:"moveToBlock",blockStore:a};case"team":return{type:"moveToTeam",teamStore:a}}};function R(e){let{environment:t,blocks:o}=e;if(f.n.state)return{canMoveBlocks:!1,reason:{key:"unknown"}};for(const n of o){if(n.getParentTable()===l.e0){const e=(0,b.VP)(n);if(!e||!(0,v.si)({teamStore:e,environment:t}))return{canMoveBlocks:!1,reason:{key:"lockedTopLevelTeamPage"}}}if(!n.canAdmin())return{canMoveBlocks:!1,reason:{key:"needsFullAccess"}};if(!S.KE({environment:t,block:n})){const e=n.getParentStore();return{canMoveBlocks:!1,reason:{key:"needsEditAccessOnParent",parentStore:e instanceof h.G?e:void 0}}}}return{canMoveBlocks:!0}}function E(e){let{environment:t,blocks:o}=e;return R({environment:t,blocks:o}).canMoveBlocks}function F(e){const{type:t}=e,{mainEditorCurrentBlockStore:o,currentSpaceStore:n}=m.default.state;if(!n)throw new Error("currentSpaceStore not found");const r=o||n;if("space"!==t&&e.spaceId&&e.spaceId!==n.id)return h.H2.createChildStore(r,{table:s.bx,id:e.spaceId});switch(t){case"space-private-pages":return h.H2.createChildStore(r,{table:s.bx,id:n.id});case"space":return h.H2.createChildStore(r,{table:s.bx,id:e.id});case"page":return h.G.createChildStore(r,{table:i.iU,id:e.id});case"collection":return h.NW.createChildStore(r,{table:a.v,id:e.id});case"team":return h.zX.createChildStore(n,{table:l.e0,id:e.id,spaceId:n.id});default:(0,c.t1)(t)}}async function N(){return await p.confirmUserAction({message:(0,I.jsx)("b",{children:(0,I.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmTitle",defaultMessage:"Some content and settings may be broken on the duplicated page."})}),description:(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("div",{style:{marginBottom:8},children:(0,I.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmDescription1",defaultMessage:"This may include: links, relations, permissions, page history, and more."})}),(0,I.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmDescription2",defaultMessage:"This page will remain unchanged in the current workspace, and a duplicate version will be created in the workspace you have chosen."}),(0,I.jsx)(u.Z,{title:(0,I.jsx)("div",{children:(0,I.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmHelpLink",defaultMessage:"Learn more"})}),href:(0,_.UY)("guides.duplicateToSpace"),analyticsFrom:"move_to_confirm_duplicate_to_space",style:{marginTop:12}})]}),acceptLabel:(0,I.jsx)(d.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmAcceptLabel",defaultMessage:"I understand, duplicate"})})}function j(e){let{targets:t,destination:o,direction:n,draggingOutlinerType:r}=e;if(n===g.vh.Onto&&t.some((e=>e.id===o.id)))return!0;const i=void 0!==(0,b._A)(o);return!(!t.some((e=>(0,k.AY)(e)))||!i)||!("bookmarks"===r||!function(e){let{targets:t,destination:o,direction:n}=e;if(!t.some((e=>e.isCollectionView())))return!1;if(o.isCollectionView()&&!(0,k.AY)(o)){if(n===g.vh.Onto)return!0;if(!o.getRecordStoreUIParent())return!0}const r=o.getAssociatedCollectionStore();if(n!==g.vh.Onto&&r&&!r.isPageTreeCollection())return!0;return!1}({targets:t,destination:o,direction:n}))}async function O(e){const t=function(e){const{from:t,environment:o}=e;if("moveTo"===t){const{moveToValue:t}=e.moveToArgs;return D(t,o)}if("dragAndDrop"===t){const{destination:t,direction:n,destinationOutlinerType:r}=e.dropArgs;return B({targetStore:t,droppedDirection:n,outlinerSectionType:r,environment:o})}}(e),o=await async function(e){const{blocks:t,environment:o,moveToLocation:n,from:r}=e;if(!n||"moveToOtherWorkspace"===n.type||"moveToBookmarks"===n.type)return{confirmed:!0,shouldClearPagePermissions:!1};const i="moveToPrivatePages"===n.type,a="moveTo"===r?e.moveToArgs.destination:e.dropArgs.destination,s=a&&L({stores:[a],environment:o});if(!i&&!s)return{confirmed:!0,shouldClearPagePermissions:!1};if(!L({stores:t,environment:o})){return await C()?{confirmed:!0,shouldClearPagePermissions:!0}:{confirmed:!1}}if(!i)return{confirmed:!0,shouldClearPagePermissions:!1};const l=o.currentUser.id;if(t.some((e=>{const t=e.getPermissionItems();return 0!==t.length&&(1!==t.length||"user_permission"!==t[0].type||t[0].user_id!==l)}))){return await C()?{confirmed:!0,shouldClearPagePermissions:!0}:{confirmed:!1}}return{confirmed:!0,shouldClearPagePermissions:!1}}({...e,moveToLocation:t});if(!o.confirmed)return{confirmed:!1};const{shouldClearPagePermissions:n}=o;return{confirmed:!0,shouldClearPagePermissions:n}}function L(e){const{stores:t,environment:o}=e,{currentSpaceStore:n}=m.default.state;if(!n)return!1;for(const r of t){const e=(0,b.u3)(r);if(!((null==e?void 0:e.table)===i.iU&&e.isTopLevelPrivatePage({spaceStore:n,environment:o})))return!1}return!0}},68056:(e,t,o)=>{o.d(t,{NV:()=>p,QY:()=>m,TD:()=>g,_v:()=>a,e6:()=>u,iG:()=>c,k_:()=>s,ko:()=>d,qS:()=>l,yt:()=>f});var n=o(97880),r=o(89086);function i(e,t){return e.store===t.store&&e.index===t.index}function a(e,t){return!e&&!t||!(!e||!t)&&(i(e.start,t.start)&&i(e.end,t.end))}function s(e){return{start:{...e.start},end:{...e.end}}}function l(e){return!e||e.start.store===e.end.store}function c(e){return l(e)&&e.start.index===e.end.index}function d(e){return 0===e.start.index&&c(e)}function p(e){return c(e)&&(0,r.J_)(e.start.store,{startIndex:e.start.index,endIndex:e.end.index})}function u(e,t){const o=[e.start.store,e.end.store];return o.includes(t.start.store)||o.includes(t.end.store)}function m(e){if(e)return l(e)?{store:e.start.store,selection:{startIndex:e.start.index,endIndex:e.end.index}}:void 0}function g(e){const{store:t,selection:o}=e;if(t&&o)return{start:{store:t,index:o.startIndex},end:{store:t,index:o.endIndex}}}const h=(0,n.AO)((e=>e&&"object"==typeof e&&"store"in e&&"index"in e?{true:e}:{false:e})),f=(0,n.AO)((e=>{if("object"==typeof e&&e&&"start"in e&&"end"in e){const{start:t,end:o}=e;if(h(t)&&h(o))return{true:e}}return{false:e}}))},45162:(e,t,o)=>{o.d(t,{$r:()=>R,Aw:()=>F,L5:()=>w,Nj:()=>P,W9:()=>T,Zb:()=>x,fx:()=>D,r:()=>_,ri:()=>N,tp:()=>M,uZ:()=>E,xI:()=>b});o(21703);var n=o(55010),r=o(45060),i=o(41432),a=o(92595),s=o(68626),l=o(73597),c=o(70842),d=o(28685),p=o(26842),u=o(14976),m=o(46150),g=o(68056),h=o(69645),f=o(73959),y=o(89224),v=o(89086);function b(e,t){const o=(0,g.QY)(t);return o||s.rateLimitedLog({from:"multiTextSelectionHelpers",type:"TODO",level:"warning",data:{name:e,message:e}}),o}const S={startIndex:0,endIndex:1/0};function _(e,t){const{start:o,end:r}=e;if((0,g.qS)(e))return o.store===t?"contained-within":void 0;if(o.store===t)return"starts-at";if(r.store===t)return"ends-at";const i=d.E.findNodeFromStore(o.store),a=d.E.findNodeFromStore(r.store),s=d.E.findNodeFromStore(t);return i&&a&&s&&1===(0,n.Z)(s,i)&&-1===(0,n.Z)(s,a)?"covers":void 0}function w(e){const{start:t,end:o}=e,n=(0,g.QY)(e);if(n){const e=d.E.findEditableWithStore(n.store);if(e){return[{editable:e,...n}]}return[]}const r=k(t),i=k(o);if(!r||!i){const e=r||i;if(!e)return[];return[{editable:e.editable,store:e.position.store,selection:{startIndex:e.position.index,endIndex:e.position.index}}]}const a=(0,v.yR)(r.editable).filter((e=>{var t,o,n;return(null===(t=e.contentEditableContext)||void 0===t?void 0:t.id)===(null===(o=r.editable.contentEditableContext)||void 0===o?void 0:o.id)&&(null===(n=e.getNode())||void 0===n?void 0:n.isConnected)})),s=a.findIndex((e=>e.props.store.id===r.editable.props.store.id)),l=a.findIndex((e=>e.props.store.id===i.editable.props.store.id));if(-1===s){throw Object.assign(new Error("Start editable not found in DOM order array"),r)}if(-1===l){throw Object.assign(new Error("End editable not found in DOM order array"),i)}if(!(s<=l))throw new Error(`Start (index ${s}) must be before end (index ${l}) in DOM`);const c=a.slice(s,l+1);return c.map(((e,t)=>{if(0===t){const{position:t}=r;return{editable:e,store:e.props.store,selection:{startIndex:t.index,endIndex:1/0}}}if(t===c.length-1){const{position:t}=i;return{editable:e,store:e.props.store,selection:{startIndex:0,endIndex:t.index}}}return{editable:e,store:e.props.store,selection:S}}))}function k(e){const t=d.E.findEditableWithStore(e.store);if(t)return{editable:t,position:e}}function x(e){var t;const{range:o,contentEditableLeafRegistry:n,allowInvisibleEndSelection:r,constraintToContentEditableRootNode:i}=e;if(!o)return;if(i&&i!==(0,m.xp)(o.commonAncestorContainer))return;let a,s=!1,l=n.getParentContentEditableLeaf(o.startContainer);l||(a??=n.getByDOMOrder(),l=(0,y.snapContainerOffsetToNode)({nodesInDomOrder:a,containerOffset:{container:o.startContainer,offset:o.startOffset},snapTowards:"end"}),s=!0,o.startContainer,o.startOffset);let c=n.getParentContentEditableLeaf(o.endContainer);if(!c||!r&&c&&0===o.endOffset&&o.endContainer===c.node&&c.node!==(null===(t=l)||void 0===t?void 0:t.node)){a??=n.getByDOMOrder();const e=a.findIndex((e=>{var t;let{node:o}=e;return o===(null===(t=l)||void 0===t?void 0:t.node)})),t=-1!==e?a.slice(e):a,i=c&&!r?t.filter((e=>{var t;let{node:o}=e;return o!==(null===(t=c)||void 0===t?void 0:t.node)})):t;c=(0,y.snapContainerOffsetToNode)({nodesInDomOrder:i,containerOffset:{container:o.endContainer,offset:o.endOffset},snapTowards:"start"}),s=!0,o.endContainer,o.endOffset}if(!l||!c){const e=l??c;if(!e)return;return{start:e,end:e,forceEmit:!0}}return{start:l,end:c,forceEmit:s}}function I(e){const t=e.getTitleStore();if(t){if(d.E.findNodeFromStore(t))return t}}function C(e){for(const t of e){const e=I(t);if(e)return{blockStore:t,titleStore:e}}}function T(e){const t=C(e);if(!t)return;const o=function(e){return C([...e].reverse())}(e);if(!o)return;const n=(0,h.dq)({includeNonSelectableListContainer:!1,root:t.blockStore.getHighestContentBlockUIAncestor()});if(!n)return;const r=(0,h.Ib)(o.blockStore,n);if(!r)return;let i;for(const a of(0,l.JK)(r)){const e=a.value.store.getTitleStore();if(e){const t=(0,v.x0)(e);t&&(i={store:e,index:t.endIndex})}}if(!i)return;return{start:{store:t.titleStore,index:0},end:i}}function M(e){var t;const{multiSelection:o,filterCommonAncestors:n,focus:r}=e;if((0,g.qS)(o)){var a;let e=(0,f.sQ)(o.start.store);if((null===(a=e)||void 0===a?void 0:a.getType())===i.Ti.tableRow){var s;const t=null===(s=e.getRecordStoreUIParent())||void 0===s?void 0:s.recordStoreUIParentStore;t&&t instanceof p.G&&(e=t)}if(!e)return;return{stores:[e]}}const c=P({multiSelection:o,includeNonSelectable:!1});if(!c)return;const d=n?(0,l.tL)(c.treeRange):(0,l.bu)(c.treeRange),u=Array.from(d),m=u[0],h=null==m||null===(t=m.value.component)||void 0===t||null===(t=t.contentEditableContext)||void 0===t?void 0:t.id,v=u.filter((e=>{var t;return(null===(t=e.value.component)||void 0===t||null===(t=t.contentEditableContext)||void 0===t?void 0:t.id)===h||e.value.store.getType()===i.Ti.table})).map((e=>e.value.store));return{stores:v,pivot:"end"===r||r===o.end||void 0===r&&!(0,y.selectionIsBackwards)()?v[v.length-1]:v[0]}}function P(e){const{multiSelection:t,includeNonSelectable:o}=e,n=(0,f.sQ)(t.start.store),r=(0,f.sQ)(t.end.store);if(!n||!r)return;const i=n.getHighestContentBlockUIAncestor(),a=(0,h.dq)({includeNonSelectableListContainer:o,root:i});if(!a)return;const s=(0,h.v5)(n,[a]),l=(0,h.v5)(r,[a]);if(!s||!l)return;const d=c.T.fromNearestCommonAncestor(s,l);return d?{tree:a,treeRange:d}:void 0}function A(e){const{leafNode:t,rangeContainer:o,defaultEndIndex:r}=e,i=(0,n.Z)(t,o);let a=0;if(-1===i)a=r;else{if(1!==i)throw new Error("Invalid relativeStartPosition. index should not be inside leaf");a=0}return{index:a,forceEmit:!0,afterEndOfLine:!1}}function D(e){var t,o,n,r;const{range:i,contentEditableLeafRegistry:a,allowInvisibleEndSelection:s}=e;if(!i)return;let l,c,p=!1;if(a&&a.hasMembers()){const e=x({range:i,contentEditableLeafRegistry:a,allowInvisibleEndSelection:s,constraintToContentEditableRootNode:void 0});e&&(l=e.start.node,c=e.end.node,p||=e.forceEmit)}else l=(0,m.X1)(i.startContainer),c=(0,m.X1)(i.endContainer);const g=l?d.E.find((e=>{var t;return(null===(t=e.getContentEditableLeaf())||void 0===t?void 0:t.getNode())===l})):void 0,h=c?d.E.find((e=>{var t;return(null===(t=e.getContentEditableLeaf())||void 0===t?void 0:t.getNode())===c})):void 0;if(!g||!h)return;const f=!i.collapsed,y=g.props.store;let b=h.props.store;const{startContainer:S,endContainer:_}=i,w=(null===(t=(o=h.props).getEndSelection)||void 0===t?void 0:t.call(o).endIndex)??0,k=(null===(n=l)||void 0===n?void 0:n.contains(i.startContainer))&&(0,u.Qb)(i.startContainer,i.startOffset)||A({leafNode:l,rangeContainer:S,defaultEndIndex:w});let I=(null===(r=c)||void 0===r?void 0:r.contains(i.endContainer))&&(0,u.Qb)(i.endContainer,i.endOffset)||A({leafNode:c,rangeContainer:_,defaultEndIndex:w});if(f&&I.afterEndOfLine){const e=(0,v.hn)(b);e&&(i.endContainer,i.endOffset,b=e,I={index:0,forceEmit:!0,afterEndOfLine:!1})}return{multiSelection:{start:{store:y,index:k.index},end:{store:b,index:I.index}},forceEmit:p||k.forceEmit||I.forceEmit}}function B(e,t){if(!e&&!t)return 0;if(!t)return-1;if(!e)return 1;if(e.store===t.store)return e.index-t.index;const o=d.E.findNodeFromStore(e.store),r=d.E.findNodeFromStore(t.store);return(0,n.Z)(o,r)}function R(e,t){const[o,n]=[e,t].sort(B);return{start:o,end:n}}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,y.selectionIsBackwards)();return t?{focus:e.start,anchor:e.end}:{focus:e.end,anchor:e.start}}function F(e){return e.device.isAndroid?"gesture":e.device.isAndroid||e.device.isIOS||e.device.isElectron||e.device.isSafari||e.device.isChrome?"always":void 0}function N(e){return e.isChrome&&96===parseInt(e.browserVersion,10)}(0,a.exposeDebugValue)("multiTextSelectionToBlockSelection",M),(0,r.Rw)({canFormat:e=>(0,g.yt)(e),header(e){const{table:t,tr:o,td:n,object:i,CONTAINER_STYLE:a}=r.TI,s=d.E.findNodeFromStore(e.start.store),l=d.E.findNodeFromStore(e.end.store);return t(a,o({},n({},"start:"),n({},i(e.start.index)," in"),n({},i(e.start.store)),n({},i(s))),o({},n({},"end:"),n({},i(e.end.index)," in"),n({},i(e.end.store)),n({},i(l))))},hasBody:e=>!1,body:e=>null})},17652:(e,t,o)=>{o.d(t,{H:()=>a,r:()=>i});var n=o(5162),r=o(77080);function i(){return"on"===r.default.getEligibleGroup({experimentId:"improved_product_notif_email_and_settings",defaultGroup:"control"})}function a(){if((0,n.Y)("supportsMobileWebInbox2"))return!0;return"on"===r.default.getEligibleGroup({experimentId:"inbox_2_0",defaultGroup:"control"})}},99445:(e,t,o)=>{o.d(t,{UF:()=>l,bW:()=>s,yk:()=>i,yt:()=>r});var n=o(15095);function r(e){let t=0,o=0,n="";for(;e>0;)t=(e-1)/26,o=(e-1)%26,e=Math.floor(t),n=String.fromCharCode(97+o)+n;return n}function i(e){let t=0,o=0;const n=e.split("").reverse();for(const r of n){t+=(r.charCodeAt(0)-96)*26**o,o+=1}return t}const a={"mÌ„":1e6,"dÌ„":5e5,"cÌ„":1e5,"lÌ„":5e4,"xÌ„":1e4,"vÌ„":5e3,m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};function s(e){let t="";for(const o in a){const n=Math.floor(e/a[o]);if(n>=0)for(let e=0;e<n;e++)t+=o;e%=a[o]}return t}function l(e){const t=n.p4(e);let o,r,i,s,l=0;for(let n=0;n<t.length;n++){if(o=t[n],r=o?a[o]:void 0,i=t[n+1],s=i?a[i]:void 0,!r)return-1;s&&r<s?l-=r:l+=r}return l}},45950:(e,t,o)=>{o.d(t,{Dx:()=>u,Ye:()=>p,ne:()=>m,yY:()=>d});o(21703),o(57658);var n=o(72126),r=o(59753),i=o(45953),a=o(33361),s=o(21202),l=o(18245),c=o(77080);async function d(e){const{environment:t,recordPointers:o,recurFn:n,recordIsRequired:s}=e,l=i.PF.create();return await a.uf({recordPointers:o,recordMap:l,recurFn:(e,t)=>n(e,t),loadRecordModel:async e=>{const o=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e,userId:t.currentUser.id});if(o)return o;const n=t.defaultRecordCache.persistedRecordCache;if(n){const o=await n.get(e,t.currentUser.id);if(o)return{model:r.kk.fromValue(e.table,o.value),role:o.role}}if(s(e))throw new Error(`Failed to load a required record: ${e.table}, ${e.id}, ${e.spaceId}.`)}}),l}async function p(e){const{environment:t}=e,o=e.environment.currentUser.id;if(e.inMemoryRecordCache)return e.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:o});let n=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:o});if(void 0!==n)return n;if(e.useInMemoryCacheOnly)return;if(e.prefetchPromise&&"pending"===e.prefetchPromise.state.status&&(await e.prefetchPromise.wrappedPromise,n=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:o}),void 0!==n))return n;const{persistedRecordCache:i}=e.environment.defaultRecordCache;if(i){const t=await i.get(e.pointer,o);if(t)return{model:r.kk.fromValue(e.pointer.table,t.value),role:t.role}}}async function u(e){const{parent:t,inMemoryRecordCache:o,environment:n}=e,i=[],a=e.environment.currentUser.id,l=e.environment.defaultRecordCache.persistedRecordCache;if(l&&o===n.defaultRecordCache.inMemoryRecordCache){return(await l.getBlocksWithParent({parent:t,userId:a})).map((e=>({model:r.kk.fromValue(s.iU,e.value),role:e.role})))}return o.forEachRecord(a,(e=>{let{model:o,role:n}=e;o.table===s.iU&&o.parent_table===t.table&&o.parent_id===t.id&&i.push({model:o,role:n})})),i}async function m(e){const{environment:t,inMemoryRecordCache:o}=e,i=r.kk.fromCollection(e.collection);if(!i)return[];const a=i.pointer;if(!i.isPageTreeCollection()){const e=l.default.mark("collections.get_local_pages_in_collection"),n=u({environment:t,parent:a,inMemoryRecordCache:o});return l.default.measure(e,{environment:t}),n}const p=i.getRootPagePointer(),m=c.default.checkGate("wiki_perf_improvement_local_enabled"),g=l.default.mark("collections.get_local_pages_in_collection_wiki"),h=m?await async function(e){const{rootPagePointer:t,environment:o}=e,n=[],r=(e,o)=>e.table!==s.iU?[]:(e.pointer.id===t.id||"page"!==e.type&&"collection_view_page"!==e.type||n.push({model:e,role:o}),e.getContentIds().map((t=>({table:s.iU,id:t,spaceId:e.spaceId}))));return await d({environment:o,recordPointers:[t],recurFn:r,recordIsRequired:()=>!1}),n}({environment:t,rootPagePointer:p}):await async function(e){const{rootPagePointer:t,environment:o,inMemoryRecordCache:r}=e;let i=[t];const a=[];for(;i.length>0;){const e=i.map((e=>u({environment:o,parent:e,inMemoryRecordCache:r}))),t=(await Promise.all(e)).flat();for(const o of t){var s;const e=null==o||null===(s=o.model)||void 0===s?void 0:s.type;"page"!==e&&"collection_view_page"!==e||a.push(o)}i=n.oA(t.map((e=>{var t;return null===(t=e.model)||void 0===t?void 0:t.pointer})))}return a}({environment:t,rootPagePointer:p,inMemoryRecordCache:o});return l.default.measure(g,{environment:t,data:{status:m?"v2":"v1"}}),h}},35026:(e,t,o)=>{o.d(t,{EE:()=>T,N:()=>P,P4:()=>M,Pl:()=>I,Ps:()=>D,Q2:()=>w,Yz:()=>A,l6:()=>S,si:()=>C,vs:()=>_});o(57658),o(30541);var n=o(15145),r=o(41432),i=o(42875),a=o(15157),s=o(72126),l=o(69246),c=o(21202),d=o(70279),p=o(29369),u=o(64684),m=o(70203),g=o(97880),h=o(35661),f=o(13105),y=o(75770);const v=new Set([r.Ti.page,r.Ti.collectionView,r.Ti.collectionViewPage,r.Ti.alias]),b=new Set([r.Ti.factory]);function S(e){const{allSharedPages:t,state:o,intl:n,teamStore:r}=e,{query:a,filter:s}=o;return t.map((e=>{if(!e.isDefined())return;const t=e.getLastEditedTime()||e.getCreatedTime();if(!t)return;const o=e.getLastEditedByPointer()??e.getCreatedByPointer(),c=e.getParentId();if(r){if("owned"===s&&c!==r.id)return;if("shared"===s&&c===r.id)return}return(0,l.fY)({block:e.getModel(),query:a,getRecordModel:e.getRecordModel,userTimeZone:(0,i.r)(),intl:n})?{blockId:e.id,timestamp:t,authorPointer:o}:void 0})).filter(g.$K)}function _(e){const{sharedPageItems:t}=e;return s.MR(t,(e=>{let{timestamp:t}=e;return t})).reverse()}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;const n=[],r=new Set,i=[e];for(;i.length>0;){const a=i.shift();if(r.has(a.id))continue;r.add(a.id);const s=x(a,e,t,o);n.push(...s.outlinerItems),i.unshift(...s.subtree)}return n}const k=new f.P({debugName:"getOutlinerItemsStoresInSubtreePageMentions",memoizeRecursion:!1,deepEquals:!1,compute(e){var t;const o=null===(t=e.getTitleStore())||void 0===t?void 0:t.getValue(),n=m.cCA(o);return e.getRecordStoreArray(e,n).filter((t=>t.getParentId()===e.id)).concat(e.getContentStores())}});function x(e,t,o,n){var i;const a=e.getType();if(a&&o.has(a)||(null===(i=e.getModel())||void 0===i||null===(i=i.getAliasTargetPointer())||void 0===i?void 0:i.table)===d.x_)return{outlinerItems:[],subtree:[]};if(a&&e!==t&&n.has(a))return{outlinerItems:[e],subtree:[]};const s=e.getType()===r.Ti.transclusionReference?e.getTransclusionReferenceTargetStore():e;if(!s)return{outlinerItems:[],subtree:[]};return{outlinerItems:[],subtree:k.getStateFor(s)}}function I(e){let{environment:t,draggingStores:o,parentStore:n,currentSpaceStore:r}=e;if(!t.currentUser.id)return!1;if(!o.every((e=>e.isNavigableBlock())))return!1;if(!(0,y.lQ)({environment:t,blocks:o}))return!1;if((null==n?void 0:n.table)===p.e0){return C({environment:t,teamStore:h.zX.createChildStore(r,{table:p.e0,id:n.id,spaceId:r.id})})}return!0}function C(e){let{environment:t,teamStore:o}=e;const n=t.currentUser.id;if(!o.isDefined())return!1;return!(o.getDisableTeamPageEdits()&&n&&!(0,u.pd)({membership:o.getMembers()},n))&&o.canAddOrRemoveTopLevelPages()}function T(e){let{typeWithTeam:t,sidebarState:o,currentSpaceViewStore:n,environment:r}=e;switch(t.type){case"team":return t.teamStore.getTeamPagesStores();case"bookmarks":return n.getBookmarkedPages();case"workspace":return n.getWorkspacePages();case"shared":return o.visibleSharedPagesStores;case"private":return n.getPrivatePages(r);default:(0,g.t1)(t)}}function M(e){let{typeWithTeam:t,currentSpaceStore:o,currentSpaceViewStore:n}=e;switch(t.type){case"team":return t.teamStore.getTeamPagesStore();case"bookmarks":return n.getBookmarkedPagesStore();case"workspace":return o.getPagesStore();case"shared":return n.getSharedPagesStore();case"private":return n.getPrivatePagesStore();default:(0,g.t1)(t)}}function P(e){switch(e){case"bookmarks":return n.tY.SidebarBookmark;case"workspace":return n.tY.SidebarWorkspace;case"shared":return n.tY.SidebarShared;case"private":return n.tY.SidebarPrivate;case"team":return n.tY.SidebarTeam;case"teamSidebar":case"teamBrowserSearch":case"teamBrowserUnjoinedTeams":case"teamBrowserJoinedTeams":return n.tY.SidebarTeamBrowser;case l.g$:return n.tY.SidebarPublicPageTemplateIncludes;default:(0,g.t1)(e)}}function A(e){return w(h.G.createChildStore(e,{table:c.iU,id:e.id}),b,v)}function D(e){const{store:t,toOpen:o,environment:n,isTopLevelItem:r}=e;r&&a.Z.set({userId:n.currentUser.id,key:`Outliner-${t.id}`,value:o})}},78873:(e,t,o)=>{o.d(t,{E:()=>s,c:()=>l});var n=o(54642),r=o(97799),i=o(69503),a=o(92083);function s(e){const{environment:t,onSubmit:o,onCancel:n}=e;t.device.isMobile?r.Z.setState({open:!0}):a.Z.setState({open:!0,openedFrom:"login",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0}),i.Z.setState({open:!0,setNewPassword:!0,password:"",repeatPassword:"",isSet:!1,onSubmit:o,onCancel:n})}async function l(e){const{environment:t,userEmail:o}=e,r=await n.getLoginOptions(t,{email:o});if("failed"===r.type)return{error:r.error};const i=r.data;return{value:{isSamlEnforced:"required"===i.samlSignIn,didLogInWithSaml:"available"===i.samlSignIn&&i.hasAccount&&"saml"===i.lastLoginMethod,hasPassword:"required"!==i.samlSignIn&&i.hasAccount&&i.passwordSignIn}}}},98165:(e,t,o)=>{o.d(t,{D0:()=>G,Dg:()=>N,Eb:()=>D,KU:()=>Z,Om:()=>R,Pj:()=>O,RC:()=>$,VP:()=>L,_A:()=>V,e3:()=>W,fJ:()=>A,fl:()=>q,n3:()=>H,oZ:()=>K,qA:()=>P,s:()=>B,u3:()=>j,uJ:()=>E,wf:()=>F,yI:()=>z});o(57658);var n=o(41432),r=o(72126),i=o(63306),a=o(27006),s=o(73360),l=o(74446),c=o(45953),d=o(606),p=o(98963),u=o(18844),m=o(21202),g=o(6287),h=o(70279),f=o(33709),y=o(91644),v=o(15047),b=o(29369),S=o(97880),_=o(80444),w=o(35661),k=o(13105),x=o(65598);function I(e,t){const{table:o,id:n,spaceId:r}=t,i=r||e.pointer.spaceId;if(o===g.v)return w.NW.createChildStore(e,{table:g.v,id:n});if(o===v.bx)return w.H2.createChildStore(e,{table:v.bx,id:n});if(o===m.iU)return w.G.createChildStore(e,{table:m.iU,id:n});if(o===h.x_){if(i)return w.T5.createChildStore(e,{table:h.x_,id:n,spaceId:i})}else if(o===f.qF){if(i)return w.jQ.createChildStore(e,{table:f.qF,id:n,spaceId:i})}else if(o===b.e0){if(i)return w.zX.createChildStore(e,{table:b.e0,id:n,spaceId:i})}else if(o===u.Xj){if(i)return w.zq.createChildStore(e,{table:u.Xj,id:n,spaceId:i})}else if(o===p.cv&&i)return w.Mz.createChildStore(e,{table:p.cv,id:n,spaceId:i})}function C(e){const t=_.default.state.mainEditorCurrentBlockStore;return t?t.inMemoryRecordCache!==e.inMemoryRecordCache?e:t:e}function T(e){const t=C(e);return((o=e)instanceof w.G||o instanceof w.H2||o instanceof w.NW||o instanceof w.T5||o instanceof w.jQ||o instanceof w.zX||o instanceof w.zq||o instanceof w.Mz)&&e.getRecordStoreUIParent()===t?e:I(t,e.pointer);var o}const M=new k.P({debugName:"getPathStores",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){const o=e.getValue();if(!o||!(0,s.oK)(o))return[e];const n=d.dr.getParentPointerFromRecordWithParent(o),r=I(C(e),n);return r?[e].concat(t(r)):[e]}}),P=function(e){const t=T(e);return t?M.getStateFor(t):[]};function A(e){return r.oA(P(e).map((e=>{if("space"===e.table){if(!(0,x.Mm)(e))return;return function(e){const{pointer:t}=e,o=(0,w.Vh)(e,t,"permissions").getValue(),n=(0,w.Vh)(e,t,"permission_groups").getValue();return{table:t.table,value:{id:t.id,permissions:o,permission_groups:n}}}(e)}if("block"===e.table){const{pointer:t}=e,o=(0,w.Vh)(e,t,"permissions").getValue(),n=(0,w.Vh)(e,t,"alive").getValue(),r=(0,w.Vh)(e,t,"parent_id").getValue(),i=(0,w.Vh)(e,t,"type").getValue();if(void 0!==n&&void 0!==r&&void 0!==i)return{table:t.table,value:{id:t.id,permissions:o,alive:n,parent_id:r,type:i}}}else if(e.table===b.e0){const{pointer:t}=e,o=(0,w.Vh)(e,t,"permissions").getValue(),n=(0,w.Vh)(e,t,"membership").getValue(),r=(0,w.Vh)(e,t,"settings").getValue();if(!r)return;return{table:t.table,value:{id:t.id,permissions:o||[],membership:n||[],settings:r,is_default:e.isDefault()}}}})))}function D(e){const{store:t,teamPermissionItems:o}=e,n=c.Ao.create(),r=O(t)||_.default.state.currentSpaceStore;return r&&o.forEach((e=>{const t=w.zX.createChildStore(r,{table:b.e0,id:e.team_id,spaceId:r.id}),o=(0,w.Vh)(t,t.pointer,"membership").getValue();n.set({id:t.id,table:b.e0,spaceId:r.id},{membership:o,is_default:t.isDefault()})})),n}async function B(e){const t=[];return await i.ne(e.pointer,l.zF.fromMonomorphicFunctionUnsafe((async o=>{let n;if(o.table===g.v?n=w.NW.createChildStore(e,o):o.table===v.bx?n=w.H2.createChildStore(e,o):o.table===m.iU?n=w.G.createChildStore(e,o):o.table===h.x_?n=w.T5.createChildStore(e,o):o.table===f.qF&&(n=w.jQ.createChildStore(e,o)),n)return t.push(n),await n.load(),n.getValue()}))),t}const R=function(e){const t=w.t1.fromV1(e);if(t instanceof w.G||t instanceof w.NW){const e=t.getParentTable(),o=t.getParentId();if(e&&o){if(e===g.v)return w.NW.createChildStore(t,{table:g.v,id:o});if(e===v.bx)return w.H2.createChildStore(t,{table:v.bx,id:o});if(e===m.iU)return w.G.createChildStore(t,{table:m.iU,id:o});if(e===h.x_)return w.T5.createChildStore(t,{table:h.x_,id:o,spaceId:t.getSpaceId()});if(e===b.e0)return w.zX.createChildStore(t,{table:b.e0,id:o});if(e===u.Xj)return w.zq.createChildStore(t,{table:u.Xj,id:o,spaceId:t.getSpaceId()});if(e===y.AT)return w.Vf.createChildStore(t,{table:y.AT,id:o,spaceId:t.getSpaceId()});(0,S.t1)(e)}}},E=function(e){return P(e).filter((e=>{if(!e.canRead())return!1;if(e instanceof w.G){const t=e.getType();return t&&(0,n.S9)(t)}return e instanceof w.zX}))},F=function(e){const t=P(e).find((e=>{let t;return(e instanceof w.G||e instanceof w.NW)&&(t=e.getAlive()),!1===t}));return Boolean(t)},N=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const o=E(e)[t];return o instanceof w.zX?N(o,t+1):o},j=function(e){const t=E(e);return t[t.length-1]},O=function(e){return P(e).find((e=>e.table===v.bx))},L=function(e){const t=P(e);return U(t)},U=function(e){return e.find((e=>e.table===b.e0))},Z=e=>e.find((e=>e.table===b.e0)),V=function(e){return P(e).find((e=>{var t;return e.table===m.iU&&(null===(t=e.getCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())}))},q=function(e){for(const t of e)if((t instanceof w.G||t instanceof w.NW)&&(!t.isDefined()||!t.getAlive()))return!1;return!0},z=function(e){for(const t of e)if(t instanceof w.G||t instanceof w.NW){if(!t.isDefined())continue;if(!t.getAlive())return!0}return!1};function W(e){for(const t of e)if(t instanceof w.G){if(!t.isDefined())continue;const e=t.getMovedStore().getValue();if(void 0!==e)return{store:t,moved:e}}}function H(e){return"block"===e.table||"space"===e.table||"collection"===e.table||"comment"===e.table||"discussion"===e.table}const G=function(e){const t=P(e).find((e=>{if(e.table===b.e0)return Boolean(e.getArchivedBy())}));return Boolean(t)};function K(e){const t=P(e);for(const o of t)if(o.table===v.bx)return o.getSettings().space_request}function $(e){const{environment:t,store:o}=e,n=t.currentUser.id;if(!n)return!1;const r=P(o);if(!r.every((e=>Boolean(e.isReady()))))return;if(!!r.some((e=>Boolean(e instanceof w.G&&!e.isDefined()))))return!1;return!r.some((e=>{if(e instanceof w.G){const t=(e.getPermissionItemsStore().getValue()||[]).find((e=>(0,a.$D)(e)||(0,a.hV)(e)||(0,a.ix)(e)||(0,a.RI)(e)||(0,a.ZQ)(e)||(0,a.FB)(e)||(0,a.jg)(e)&&e.user_id!==n));return Boolean(t)}return e instanceof w.zX}))}},85957:(e,t,o)=>{o.d(t,{PQ:()=>d,Tx:()=>s,mH:()=>l,wq:()=>c});var n=o(24646),r=o(4926),i=o(88923),a=o(27724);function s(){return i.default.isCenterPeekOpen()||a.default.isInPeekRenderer()}function l(){const e=i.default.state;return e.open&&(s()||e.isOpening)}function c(e){return Boolean(e.findRecordStoreUIAncestor((e=>e===i.default.peekTarget.state)).ancestor)}function d(e){const t=r.Z.state;return i.default.isSidePeekOpen()?(0,n.vJ)(e):i.default.isCenterPeekOpen()?Math.min(e.WindowSizeStore.state.width-2*i.PeekModeOuterPadding,i.CenterPeekModeOuterWidth+t):0}},67669:(e,t,o)=>{o.d(t,{BZ:()=>N,Dt:()=>Z,IJ:()=>I,JI:()=>P,KE:()=>j,Kz:()=>R,Oc:()=>T,S4:()=>C,U7:()=>L,UK:()=>M,WE:()=>V,YF:()=>F,YO:()=>x,Z9:()=>B,dA:()=>D,mU:()=>U,r_:()=>E,su:()=>O,uY:()=>q,yi:()=>A,zT:()=>W});o(67635),o(57658);var n=o(66897),r=o(72126),i=o(63306),a=o(26825),s=o(27006),l=o(4615),c=o(21202),d=o(29369),p=o(19889),u=o(47425),m=o(64684),g=o(97880),h=o(80444),f=o(83212),y=o(35661),v=o(78291),b=o(88893),S=o(98165),_=o(65598),w=o(38755),k=o(95697);function x(e){const t=S.fJ(e),o=a.KJ(t);return a.YO(o)}function I(e,t){const{id:o}=e.currentUser;if((0,w.C)()&&(0,w.Fn)(e))return;let r;if(o){const e=t.getRecordValue({table:p.KJ,id:o});e&&(r=(0,n.dp)(e))}const i=S.qA(t).map((e=>e.getModel())).filter(g.$K);return a.IJ({actor:r,ancestors:i})}function C(e){return x(e).map((e=>{let{permissionItem:t}=e;return t})).some((t=>s.$D(t)&&s.YX(t.role)&&(void 0===t.allow_duplicate||!0===t.allow_duplicate)&&(!e.isTypedCollectionViewBlock()||e.isCollectionViewPageWithContent())))}function T(e){return x(e).map((e=>{let{permissionItem:t}=e;return t})).some((e=>s.$D(e)))}function M(e){return x(e).map((e=>{let{permissionItem:t}=e;return t})).some((e=>s.ix(e)))}async function P(e){const{currentUserRootStore:t}=h.default.state;if(!t)return!1;if(!(0,l.e)(e))return!1;const o=y.G.createChildStore(t,{table:c.iU,id:e});return await o.load(),T(o)}function A(e,t){let o;if(o=t instanceof y.H2?(0,w.jv)(t):x(t).map((e=>{let{permissionItem:t}=e;return t})),1===o.length){const[t]=o;return"user_permission"===t.type&&s.zz(t.role)&&t.user_id===e.currentUser.id}return!1}function D(e,t){const{data:o}=v.default.state;if(!o)return!1;if(Boolean(o&&b.YK(o)))return!1;const n=b.ND(o).map((e=>e.userId)),r=b.hn(o).map((e=>e.userId)),i=new Set([...n,...t].filter((e=>!r.includes(e)))),a=(0,u.tP)("free");return i.size>Math.max(a,n.length)}function B(){const{data:e}=v.default.state;if(!e)return!1;if(Boolean(e&&b.YK(e)))return!0;const t=b.ND(e).map((e=>e.userId)),o=(0,u.tP)("free");return t.length<o}function R(e){const{environment:t,store:o,permissionItems:n}=e;if(o instanceof y.H2)return!1;const{data:r}=v.default.state;if(!r)return!1;return D(0,n.filter(s.jg).filter((e=>"none"!==e.role)).map((e=>e.user_id)))}function E(e){return{editor:"Full access",read_and_write:"Can edit",comment_only:"Can comment",reader:"Can read",none:"No access"}[e]}function F(e){return!!e&&(e.hasPublicPermission&&"edit"!==e.permission)}function N(e){return!!e&&(e.hasPublicPermission&&"view"===e.permission)}function j(e){let{environment:t,block:o}=e;const n=o.getParentStore();if(!n)return!1;return!F(S.n3(n)&&f.Z.getMode(t,n))&&n.canEdit()}function O(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;const o=e.find((e=>"user_permission"===e.type&&e.user_id===t));return o&&o.role||"none"}function L(){const{currentSpaceStore:e}=h.default.state;return"enterprise"===(null==e?void 0:e.getSubscriptionTier())}function U(e,t){const o=new Set;var n;(0,_.Y)(e)?null===(n=e.getPermissionItems())||void 0===n||n.forEach((e=>{s.jg(e)&&o.add(e.user_id)})):e.getPermissionItems().forEach((e=>{s.jg(e)&&o.add(e.user_id)}));return t.filter((e=>"existingUser"!==e.type||!o.has(e.value.id)))}function Z(e){let{userId:t,store:o}=e;return V({userId:t,store:o})[0]}function V(e){let{userId:t,store:o}=e;const n=i.DW(o.pointer,o.getRecordModel),l=S.Pj(o)||h.default.state.currentSpaceStore,c=l&&l.isDefined()&&!n.findLast(a.zX)?[...n,l.getModel()]:n,d=x(o),u=S.VP(o),m=d.filter((e=>{let{permissionItem:t}=e;return(s.zU(t)||s.LW(t))&&t.team_id!==(null==u?void 0:u.id)})).map((e=>e.permissionItem)),g=S.Eb({store:o,teamPermissionItems:m}),f=a.J3({explicitTeamsRecordMap:g}),y=a.qY({actorPointer:{table:p.KJ,id:t},ancestors:c,permissionsContext:f}).map((e=>e.permissionItem));if(0===y.length)return[{type:"user_permission",role:"none",user_id:t}];const v=r.oA(y.map((e=>e.role))),b=a.nl(...v);return y.filter((e=>e.role===b)).sort(z)}function q(e){let{userId:t,store:o}=e;const n=i.DW(o.pointer,o.getRecordModel),r=S.Pj(o)||h.default.state.currentSpaceStore,l=r&&r.isDefined()&&!n.findLast(a.zX)?[...n,r.getModel()]:n,u=x(o),g=S.VP(o),f=u.filter((e=>{let{permissionItem:t}=e;return(s.zU(t)||s.LW(t))&&t.team_id!==(null==g?void 0:g.id)})).map((e=>e.permissionItem)),y=S.Eb({store:o,teamPermissionItems:f}),_=a.J3({explicitTeamsRecordMap:y}),w=a.qY({actorPointer:{table:p.KJ,id:t},ancestors:l,permissionsContext:_}),I=[...w];w.find((e=>"user_permission"===e.permissionItem.type))||I.push({permissionItem:{type:"user_permission",role:"none",user_id:t},from:{table:c.iU,blockId:o.id}});const{data:C}=v.default.state,T=new Set(C?b.ND(C).map((e=>e.userId)):[]);if(null!=T&&T.has(t))return I.sort(((e,t)=>z(e.permissionItem,t.permissionItem))).reverse().sort(((e,t)=>s.xm[t.permissionItem.role??"none"]-s.xm[e.permissionItem.role??"none"]));!w.find((e=>"explicit_team_permission"===e.permissionItem.type&&e.permissionItem.team_id===(null==g?void 0:g.id)))&&g&&(0,k.AL)({teamStore:g,spaceStore:r,userId:t})&&I.push({permissionItem:{type:"explicit_team_permission",role:"none",team_id:g.id},from:{table:d.e0,teamId:g.id}});!w.find((e=>"explicit_team_owner_permission"===e.permissionItem.type&&e.permissionItem.team_id===(null==g?void 0:g.id)))&&g&&(0,m.pd)({membership:g.getMembers()},t)&&I.push({permissionItem:{type:"explicit_team_owner_permission",role:"none",team_id:g.id},from:{table:d.e0,teamId:g.id}});return w.find((e=>"space_permission"===e.permissionItem.type))||I.push({permissionItem:{type:"space_permission",role:"none"},from:{table:c.iU,blockId:o.id}}),I.sort(((e,t)=>z(e.permissionItem,t.permissionItem))).reverse().sort(((e,t)=>s.xm[t.permissionItem.role??"none"]-s.xm[e.permissionItem.role??"none"]))}function z(e,t){const o=s.jg(e),n=s.jg(t);if(o||n)return o&&n?0:o?-1:1;const r=s.hV(e),i=s.hV(t);if(r||i)return r&&i?0:r?-1:1;const a=s.Lq(e),l=s.Lq(t);return a||l?a&&l?0:a?-1:1:0}function W(e){const{botStore:t,addPermission:o}=e,n=o?a.uH(t.getCapabilities()):"none",r=t.getParentId(),i=t.getParentTable();let s={type:"bot_permission",bot_id:t.id,role:n};return r&&i&&(s={type:"bot_permission",bot_id:t.id,role:n,parent_id:r,parent_table:i}),s}},45101:(e,t,o)=>{o.d(t,{Aw:()=>I,Bu:()=>P,DF:()=>A,Ji:()=>O,NN:()=>M,Nd:()=>C,OA:()=>F,ZK:()=>j,Zp:()=>D,a_:()=>E,cm:()=>T,fR:()=>Z,gQ:()=>L,t0:()=>U,xT:()=>R,z5:()=>B});o(57658),o(67294);var n=o(15070),r=o(8848),i=o(5366),a=o(27006),s=o(4615),l=o(21202),c=o(15047),d=o(97880),p=o(82990),u=o(7928),m=o(50906),g=o(47307),h=o(80444),f=o(29677),y=o(78291),v=o(88893),b=o(35057),S=o(28020),_=o(33929),w=o(65598),k=o(16639),x=o(85893);async function I(e){let{environment:t,permissionsInviteStoreState:o,from:n}=e;const r=(0,x.jsx)(i.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Discard changes?"}),a=(0,x.jsx)(i.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.confirmationButton.label",defaultMessage:"Yes"}),s=(0,x.jsx)(i.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.cancelButton.label",defaultMessage:"Cancel"});if(o.inviteTargets.length>0){const e=await g.confirmUserAction({message:r,acceptLabel:a,cancelLabel:s});return m.q_n(t,{...E(t,o),from:n,discard_changes:e}),!e}return!1}const C=e=>{const{target:t,permissionsInviteStore:o}=e;return o.state.inviteTargets.find((e=>"newUser"===t.type?"newUser"===e.type&&t.value.email===e.value.email:e.type===t.type&&e.value.id===t.value.id))},T=e=>{const{targetStore:t,permissionsInviteStore:o,userTarget:n}=e;return!!C({permissionsInviteStore:o,target:n})||"existingUser"===n.type&&D({target:n,store:t})},M=e=>{const{targetStore:t,permissionsInviteStore:o,currentInviteActors:r}=e;if(!r)return{inviteUsers:[],inviteGroups:[],inviteBots:[]};const i=r.inviteUsers.filter((e=>!T({targetStore:t,permissionsInviteStore:o,userTarget:e})));return{inviteBots:r.inviteBots.filter((e=>!(!e.value.alive||C({permissionsInviteStore:o,target:e})||!(0,n.oA)(e.value)&&!(0,n.c9)(e.value))&&!D({target:e,store:t}))),inviteGroups:r.inviteGroups.filter((e=>!C({permissionsInviteStore:o,target:e})&&!D({target:e,store:t}))),inviteUsers:i,importedContacts:r.importedContacts}},P=(e,t)=>{if(!e||!t||0===e.length||0===t.length)return t;const o=new Set(e.map((e=>e.value.email.toLowerCase())));return t.filter((e=>!o.has(e.value.email.toLowerCase())))},A=e=>{const{intl:t,target:o}=e;switch(o.type){case"newUser":return o.value.email;case"existingUser":return(0,u.Nz)(t,o.value);case"bot":return(0,n.Mh)(o.value);case"group":return(0,k.kF)({intl:t,group:o.value});default:(0,d.t1)(o)}},D=e=>{const{target:t,store:o}=e;return!!o.isDefined()&&((0,w.Y)(o)?o.getMembers().filter((e=>{switch(t.type){case"existingUser":return"user"===e.entity_type&&t.value.id===e.user_id;case"group":return"group"===e.entity_type&&t.value.id===e.group_id}})).length>0:o.getPermissionItems().some((e=>{switch(t.type){case"existingUser":return(0,a.jg)(e)&&e.user_id===t.value.id;case"bot":return(0,a.FB)(e)&&e.bot_id===t.value.id;case"group":return(0,a.hV)(e)&&e.group_id===t.value.id;case"newUser":return!1;default:return(0,d.t1)(t)}})))};function B(e){const{environment:t,permissionsInviteStore:o,store:n,renderInShareModal:r}=e;o.setState({modalOpen:!r,tokenQuery:"",inviteTargets:[],inviteRole:R(e),isInviteTargetsEmpty:!0,table:(0,w.Mm)(n)?c.bx:l.iU,flowId:(0,s.ZP)(),inputFocus:"invitee",emailMessage:""}),(0,w.Mm)(n)?m.$zQ(t):m.Mqg(t,{...E(t,e.permissionsInviteStore.state)})}function R(e){const{store:t,isSubscribed:o}=e;return(0,w.Mm)(t)?o?"read_and_write":"editor":(0,b.Mk)()?"editor":"read_and_write"}function E(e,t){var o;const{isInviteTargetsEmpty:n,inviteRole:r,flowId:i}=t,a=(0,S.np)(),s=null==a?void 0:a.getRole(),l=null===(o=h.default.state.currentSpaceStore)||void 0===o?void 0:o.getRole(),{inviteTargets:c,emailMessage:d}=t,p=(0,b.zt)(),u={invite_flow_id:i,user_count:0,is_bot:!1,invite_message_length:(null==d?void 0:d.length)??0,...s&&{page_current_user_role:s},...l&&{space_role:l},...p&&{subscription_tier:p}};if(n)return u;if(0===c.length)return u;if(function(e){return e.length>0&&"bot"===e[0].type}(c))return{...u,is_bot:!0};const m=c.filter(f.cl).length,g=c.filter(f.fZ).length+m;return{...u,role:r,user_count:g,new_user_count:m}}function F(e){return"newUser"===e.type||"existingUser"===e.type&&("none"===e.spaceRole||"not_in_space"===e.spaceRole)}const N=(0,i.defineMessages)({workspaceOwnerTooltip:{id:"inviteUserModal.userRole.workspaceOwnerBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a workspace owner in this workspace"},workspaceOwnerBadge:{id:"inviteUserModal.userRole.workspaceOwnerBadge.label",defaultMessage:"Workspace Owner"},adminTooltip:{id:"inviteUserModal.userRole.adminBadge.tooltip",defaultMessage:"{ userNameAndEmail} is an admin in this workspace"},adminBadge:{id:"inviteUserModal.userRole.adminBadge.label",defaultMessage:"Admin"},membershipAdminTooltip:{id:"inviteUserModal.userRole.membershipAdminBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a membership admin in this workspace"},membershipAdminBadge:{id:"inviteUserModal.userRole.membershipAdminBadge.label",defaultMessage:"Membership admin"},memberTooltip:{id:"inviteUserModal.userRole.memberBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a member in this workspace"},memberBadge:{id:"inviteUserModal.userRole.memberBadge.label",defaultMessage:"Member"},guestTooltip:{id:"inviteUserModal.userRole.guest.tooltip",defaultMessage:"{ userNameAndEmail} is a guest in this workspace"},guestBadge:{id:"inviteUserModal.userRole.guestBadge.label",defaultMessage:"Guest"}});function j(e){const{environment:t,customStyle:o}=e,{device:n}=t;return{display:"inline-flex",height:18,textTransform:"uppercase",fontSize:10,marginBottom:2,fontWeight:p.Z.fontWeight.medium,letterSpacing:1,color:r.ZP.uiLightGray,border:`1px solid ${r.ZP.uiLightGray}`,minWidth:70,alignItems:"center",justifyContent:"center",paddingTop:n.isAndroid?2:1,paddingBottom:1,paddingLeft:3,paddingRight:3,borderRadius:4,...o}}function O(e){const{role:t,intl:o,nameOrEmail:n}=e,r=n||o.formatMessage({id:"userTypeTooltip.generalPerson",defaultMessage:"This person"});switch(t){case"editor":return{tooltip:o.formatMessage(N.workspaceOwnerTooltip,{userNameAndEmail:r}),userRoleBadge:o.formatMessage(N.workspaceOwnerBadge)};case"membership_admin":return{tooltip:o.formatMessage(N.membershipAdminTooltip,{userNameAndEmail:r}),userRoleBadge:o.formatMessage(N.membershipAdminBadge)};case"read_and_write":return{tooltip:o.formatMessage(N.memberTooltip,{userNameAndEmail:r}),userRoleBadge:o.formatMessage(N.memberBadge)};case"none":return{tooltip:o.formatMessage(N.guestTooltip,{userNameAndEmail:r}),userRoleBadge:o.formatMessage(N.guestBadge)};default:(0,d.t1)(t)}}function L(e){return F(e)?"rgba(246, 192, 80, 0.26)":void 0}function U(e){var t;const{inviteTargets:o,recordStore:n,canEditSpaceMembership:r}=e;if(0===o.length)return null;if(!n)return null;const{inviteTargetGuests:a,inviteTargetMembers:s}=function(e){const t=[],o=[];return e.forEach((e=>{F(e)?t.push(e):o.push(e)})),{inviteTargetGuests:t,inviteTargetMembers:o}}(o),l=r?[...s,...a]:s,c=r?[]:a,d=_.default.getIntl(),p=(0,w.OY)(n)?null===(t=n.getBlockTitleStore())||void 0===t?void 0:t.getValue():n.getName();return r||0===c.length?(0,x.jsx)(i.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.usersAddedMessage",defaultMessage:"{numberOfTargets, plural, one {Added {targetName} to {recordName}} other {Added {numberOfTargets} people to {recordName}}}",values:{numberOfTargets:l.length,targetName:A({intl:d,target:l[0]}),recordName:p}}):0===l.length?(0,x.jsx)(i.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.inviteRequestedMessage",defaultMessage:"{numberOfTargets, plural, one {Requested {targetName} for approval} other {Requested {numberOfTargets} invites for approval}}",values:{numberOfTargets:c.length,targetName:A({intl:d,target:c[0]})}}):(0,x.jsx)(i.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.userAddedAndRequestedText",defaultMessage:"{numberOfAddedTargets, plural, one {Added {addedTargetName}} other {Added {numberOfAddedTargets} people}} & {numberOfRequestedTargets, plural, one {requested {requestedTargetName} for approval} other {requested {numberOfRequestedTargets} people for approval}}",values:{numberOfAddedTargets:l.length,addedTargetName:A({intl:d,target:l[0]}),numberOfRequestedTargets:c.length,requestedTargetName:A({intl:d,target:c[0]})}})}function Z(e){if("existingUser"!==e.type)return;const{data:t}=y.default.state,o=(t?v.CM(t):[]).find((t=>t.userId===e.value.id));return o?o.role:"not_in_space"}},13273:(e,t,o)=>{o.d(t,{Xt:()=>i,al:()=>l,jM:()=>s,yT:()=>a});var n=o(43250),r=o(62619);function i(e){const{menuElement:t,clickedElement:o}=e;return t!==o&&!t.contains(o)&&(!o.classList.contains("notion-link")&&!(o.closest(`.${n.mJW}`)&&!o.closest(`.${n.p1Q}`)&&!o.closest(`.${n.Nn$}`)&&!o.closest(`.${n.fHd}`)))}function a(e){if((0,r.sh)(e,(e=>e.classList&&(e.classList.contains(n.p1Q)||e.classList.contains(n.Nn$)||e.classList.contains(n.fHd)))))return!1;const t=(0,r.sh)(e,(e=>e.classList&&e.classList.contains(n.mJW)));return Boolean(t)}function s(e){const t=(0,r.sh)(e,(e=>e.classList&&e.classList.contains(n.Dkf)));return Boolean(t)}function l(e){const t=(0,r.sh)(e,(e=>e.classList&&e.classList.contains(n.RIA)));return Boolean(t)}},17504:(e,t,o)=>{o.d(t,{V:()=>i,Z:()=>a});var n=o(74948),r=o(12534);const i=e=>{(0,r.ZP)({event:e,context:r.Af.SidebarMouseMove,callback:()=>{n.close()}})},a=function(e){return e({onMouseMove:i})}},55227:(e,t,o)=>{o.d(t,{g7:()=>a,kF:()=>l});o(57658);var n=o(72126),r=o(70203),i=o(62619);function a(e){let t="";const o=document.createElement("div");o.innerHTML=e;const r=i.kd(o);for(const i of r){const e=n.YU(i.data);if(null!==i.parentElement&&i.parentElement!==o){t+=`<span class="${s({parent:i.parentElement,root:o}).join(" ")}">${e}</span>`}else t+=e}return t}function s(e){const{parent:t,root:o}=e,n=new Set;let r=t;for(;r&&r!==o;)r.classList.forEach((e=>{n.add(e)})),r=r.parentElement??void 0;return Array.from(n)}function l(e,t){const o={text:c(e),syntax:c(t)},n=p(d(o.text,o.syntax)),i={text:0,syntax:0},a={text:0,syntax:0},s=[],l=e.map(r.WiV).join("");for(const[r,c]of n){const e=r+c,n=t[i.syntax],d={value:l.substring(r,e),textTokenIndex:i.text,classNames:(u=n,u&&u[1])};s.push(d);const p=o.text[i.text],m=o.syntax[i.syntax];e>=a.text+p&&(i.text+=1,a.text+=p),e>=a.syntax+m&&(i.syntax+=1,a.syntax+=m)}var u;return s}const c=e=>e.map((e=>e[0].length)),d=(e,t)=>{const o=e.slice(),n=t.slice(),r=[];let i=0,a=0;for(;i<o.length&&a<n.length;){const e=o[i],t=n[a];e===t?(r.push(e),i+=1,a+=1):e<t?(r.push(e),i+=1,n[a]-=e):(r.push(t),o[i]-=t,a+=1)}return r},p=e=>{let t=0;return e.reduce(((e,o)=>(e.push([t,o]),t+=o,e)),[])}},70219:(e,t,o)=>{o.d(t,{b:()=>i});var n=o(95477),r=o(81236);function i(e){return t=>{const{RouterStore:o}=e;if("page"!==o.state.route.name||!o.state.route.requestedOnPublicDomain)return;const i=r.Z.getPublicSpaceData(e,t),a=(null==i?void 0:i.domain)||o.state.route;return`${window.location.protocol}//${a}.${n.default.publicDomainName}`}}},58239:(e,t,o)=>{o.d(t,{ZT:()=>c,lX:()=>a,rq:()=>s});var n=o(15157),r=o(21202),i=o(15047);async function a(e){let{currentUserId:t,spaceStore:o}=e;const r=n.Z.get({userId:t,key:l(o.id)});return p(o,o.loadRecordModel,r)}function s(e){let{currentUserId:t,spaceId:o,value:r}=e;n.Z.set({userId:t,key:l(o),value:r})}const l=function(e){return`quickAddParent3:${e}`};function c(e){let{currentUserId:t,spaceId:o,parent:r,databaseType:i}=e;n.Z.set({userId:t,key:d(o,i),value:r})}const d=function(e,t){return`quickAddTypedParent:${e}:${t||"default"}`};async function p(e,t,o){let n;if(o)if("page"===o.type){await t({table:r.iU,id:o.id})&&(n=o)}else if("space"===o.type){await t({table:i.bx,id:o.id})&&(n=o)}return n||{type:"space-private-pages",spaceId:e.id}}},15447:(e,t,o)=>{o.d(t,{Od:()=>g,Wk:()=>y,X4:()=>p,_5:()=>f,_k:()=>h,h_:()=>m,rw:()=>u});o(57658);var n=o(14577),r=o(72126),i=o(54642),a=o(18245),s=o(80444),l=o(77080),c=o(69327),d=o(29026);const p=new n.Z((()=>{const{currentSpaceStore:e}=s.default.state;if(!e)return[];return c.Z.getWithoutSubscribing(e.id).slice(0,1e3).filter((e=>!e.store.pathIsDead()))}),{debugName:"recentAlivePagesStore"});function u(e,t){if("object"==typeof t&&t){const{spaceId:e,blockId:o,visitedAt:n}=t.userPageVisit||{};if(!e||!o||!n)return;!function(e){let{spaceId:t,pageId:o,visitedAt:n}=e;const r=c.Z.getWithoutSubscribing(t),i=function(e){let{newRecentPage:t,currentRecentPages:o}=e;const n=o.filter((e=>e.pageId!==t.pageId)),r=n;let i=0;for(;i<n.length;i++)if(t.visitedAt>=n[i].visitedAt){r.splice(i,0,t);break}i===n.length&&r.push(t);return r}({newRecentPage:{pageId:o,visitedAt:n},currentRecentPages:r});c.Z.set(t,i),p.recompute()}({spaceId:e,pageId:o,visitedAt:n})}}async function m(e){let{environment:t,userId:o,spaceId:n}=e;const s=l.default.getGroup("search-more-recent-pages-in-local"),d="lazy-";let u;s.startsWith(d)&&(u=r.o5(s.slice(d.length))||void 0);const m=s.startsWith(d),g=a.default.mark("load_global_recent_pages_initial_load"),h=a.default.mark("load_global_recent_pages");async function f(e,r){const l=await i.getRecentPageVisits(t,{userId:o,spaceId:n,limit:e},o);"success"===l.type&&(a.default.measure(r,{environment:t,data:{experiment_group:s}}),c.Z.set(n,l.data.pages.map((e=>({pageId:e.id,visitedAt:e.visitedAt}))))),p.recompute()}m?(f(u,h),await f(void 0,g)):await f(u,h)}async function g(e,t){var o,n;let{environment:r,userId:a,spaceId:s}=t;if(c.Z.getWithoutSubscribing(s).length>1e3)return!1;const l=await i.getRecentPageVisits(r,{userId:a,spaceId:s,beforeTimestamp:e,limit:d.Xv},a);if("success"!==l.type||l.data.pages.length<=0)return!1;const u=l.data.pages.map((e=>({pageId:e.id,visitedAt:e.visitedAt}))),m=null===(o=c.Z.get(s))||void 0===o?void 0:o.length;c.Z.mergeRecentPages(u,s);const g=null===(n=c.Z.get(s))||void 0===n?void 0:n.length;return p.recompute(),m!==g}const h=["Today","Yesterday","Past Week","Past 30 Days","Older"];function f(e){const t=Date.now(),o=864e5,n=t-e,r=new Date(e).getDay(),i=new Date(t).getDay(),a=new Date(t);a.setDate(a.getDate()-1);const s=a.getDay();return r===i&&n<=o?"Today":r===s&&n<=1728e5?"Yesterday":n<=6048e5?"Past Week":n<=2592e6?"Past 30 Days":"Older"}function y(e){return null==e?void 0:e.map((e=>({visitedAt:e.visitedAt,pageId:e.pageId}))).sort(((e,t)=>t.visitedAt-e.visitedAt)).slice(0,50)}},44133:(e,t,o)=>{o.r(t),o.d(t,{getDebugSourcesForIdsInOperations:()=>c,setBlockIdDebugSource:()=>s,setupRecordCacheDebugging:()=>a});var n=o(39593);let r=!1;const i=new(o.n(n)())({max:1e4});function a(e){e.isMobile||(r=!0)}function s(e,t){r&&(i.has(e)||i.set(e,t))}const l=/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/g;function c(e,t){const o={blocks:{},isIdSourceCacheFull:i.itemCount===i.max},n=JSON.stringify(t),r=new Set(Array.from(n.matchAll(l)).map((e=>e[0])));for(const s of r){var a;let t=!1;const n={},r=i.get(s);r&&(t=!0,n.debugSource=r);const l=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:{table:"block",id:s},userId:e.currentUser.id});null!=l&&null!==(a=l.value)&&void 0!==a&&a.type&&(t=!0,n.blockType=l.value.type),t&&(o.blocks[s]=n)}return o}},65598:(e,t,o)=>{o.d(t,{D4:()=>O,GP:()=>z,HK:()=>L,M1:()=>Y,MF:()=>T,MI:()=>I,Mm:()=>G,No:()=>W,OY:()=>S,Oh:()=>$,PF:()=>F,SJ:()=>k,Xp:()=>E,Y:()=>b,ak:()=>j,al:()=>A,bB:()=>R,bQ:()=>V,dv:()=>P,dz:()=>Q,ig:()=>Z,le:()=>U,mY:()=>B,p9:()=>N,sl:()=>H,vV:()=>D,x8:()=>w,yJ:()=>_,zP:()=>q});var n=o(92595),r=o(68626),i=o(72126),a=o(606),s=o(70921),l=o(21202),c=o(70279),d=o(33709),p=o(15047),u=o(29369),m=o(97880),g=o(34047),h=o(35661),f=o(13105),y=o(98165);const v=128;function b(e){return e.table===u.e0}function S(e){return e.table===l.iU}function _(e){return A(e,{recursivelyLoadAllDiscussions:!1}).filter(g.De)}function w(e){return(0,h.Vh)(e,e.pointer,"discussions")}function k(e){let t=0;return e.findRecordStoreUIAncestor((o=>(o!==e&&e.id&&o.id===e.id&&o.table===e.table&&i.Xy(e.path,o.path)&&t++,!1))),t>1}const x=new f.P({debugName:"recursiveChildBlocks",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){if(k(e))return[];return e.getContentStores().map((e=>{switch(e.getType()){case"page":return;case"transclusion_reference":return e.getTransclusionReferenceTargetStore();default:return e}})).filter(m.$K).flatMap((e=>[e,...t(e)]))}});function I(e){return x.getStateFor(e)}const C=new f.P({debugName:"recursiveWihTransclusionChildBlocks",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){if(k(e))return[];return e.getContentStores().map((e=>{switch(e.getType()){case"page":return;default:return e}})).filter(m.$K).flatMap((e=>[e,...t(e)]))}});function T(e){return C.getStateFor(e)}const M=new f.P({debugName:"loadedDiscussionStores",memoizeRecursion:!1,deepEquals:!1,compute:function(e){const t=w(e),o=((null==t?void 0:t.getValue())||[]).map((t=>h.t1.createChildStore(e,a.dr.fromPointerLike({table:d.qF,id:t,spaceId:e.pointer.spaceId}))));return o.reverse(),o}});function P(e){return e.table===c.x_}function A(e,t){const o=t.excludeSelf?[]:[e],n=null!=t&&t.recursivelyLoadAllDiscussions?[...o,...x.getStateFor(e)]:o,r=new Set;return n.flatMap(M.getStateFor).filter((e=>!!(null!=t&&t.includeLoadingDiscussions||e.isDefined())&&(!r.has(e.id)&&(r.add(e.id),!0))))}function D(e,t){return R(A(e,t)).unresolved}function B(e,t){return R(A(e,t)).resolved}function R(e){const t=e.filter((e=>e.isDefined())),[o,n]=i.uK(t,(e=>e.getResolved()));return{resolved:o,unresolved:n}}function E(e,t){return(Array.isArray(e)?e:D(e,t)).reduce(((e,o)=>{const n=o.getValue();return n?t.onlyIncludeBlockLevelDiscussions&&!(0,g.De)(o)?e:e+(n.comments||[]).length:e}),0)}function F(e){if("text"!==e.getType())return!1;const t=e.getBlockTitleStore().getValue();return(!t||!t.length)&&(!e.hasContent()&&0===function(e,t){return D(e,t).length}(e,{recursivelyLoadAllDiscussions:!1}))}function N(e){return(0,h.Vh)(e,e.pointer,"properties")}function j(e){return(0,h.Vh)(e,e.pointer,"comments")}function O(e){if(!e)return[];const t=j(e);return(t.getValue()||[]).map((e=>h.T5.createChildStore(t,{table:c.x_,id:e,spaceId:t.pointer.spaceId})))}function L(e){if(e.isDefined())return h.t1.createChildStore(e,e.getParentPointer())}function U(e){const t=Z(e);return(t.getValue()||[]).map((o=>h.G.createChildStore(t,a.dr.fromPointerLike({table:l.iU,id:o,spaceId:e.pointer.spaceId}))))}function Z(e){return(0,h.Vh)(e,e.pointer,"content")}function V(e){return(0,h.Vh)(e,e.pointer,"last_edited_time")}function q(e){return(0,h.Vh)(e,e.pointer,"text")}function z(e){if(e.isDefined())return h.t1.createChildStore(e,e.getParentPointer())}function W(e,t,o){return h.t1.createChildStore(e,{table:s.TY,id:t,spaceId:o})}function H(e){if(e.isDefined())return W(e,e.getActivityId(),e.getSpaceId())}function G(e){return e.table===p.bx}(0,n.exposeDebugValue)("getDiscussionStores",A);const K=i.P2((e=>{r.log(e)}),500),$=function(e){let t=e,o=0;for(;t;){if(!t.isReady())return!1;if(o>=v)return K({level:"error",from:"recordStoreHelpers",type:"areAncestorsLoaded",data:{message:"max depth reached",miscDataToConvertToString:{maxDepth:v,id:e.id,table:e.table,currentStoreId:t.id,currentTable:t.table}}}),!1;o+=1,t=(0,y.Om)(t)}return!0};async function Y(e){let t=e,o=0;for(;t;){if(t.isReady()||await t.load(),o>=v)return K({level:"error",from:"recordStoreHelpers",type:"loadAncestors",data:{message:"max depth reached",miscDataToConvertToString:{maxDepth:v,id:e.id,table:e.table,currentStoreId:t.id,currentTable:t.table}}}),!1;o+=1,t=(0,y.Om)(t)}}function Q(e){return e.table===l.iU&&i.Xy(e.path,["content"])}},37034:(e,t,o)=>{o.d(t,{NO:()=>m,V:()=>g,vU:()=>h});var n=o(17215),r=o(42875),i=o(60310),a=o(82883),s=o(13493),l=o(35661),c=o(28020),d=o(52821),p=o(78316),u=o(38755);function m(e,t){if(e.isDefined())return e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,r.r)(),intl:t})}function g(e,t,o){if((0,c.qG)(e.id))return t.formatMessage(i.CN.myTasks);if(e instanceof l.zX)return e.getName();if(e instanceof l.H2)return(0,u.rn)(o,e);if(e instanceof l.Xr){const t=e.getName();if(t)return t;const o=e.getType();return o?d.Bh[o]:void 0}if("none"===e.getRole())return n.x(t);if(!e.isDefined())return;const s=e instanceof l.G?e.getTitleValue():e.getName();return(0,a.X)({textValue:s,getRecordModel:e.getRecordModel,userTimeZone:(0,r.r)(),intl:t})}function h(e){const{environment:t,intl:o,untitledFallback:r,store:i}=e,a=r?o.formatMessage(r):function(e,t){if(e.table===s.n){const o=e.getType();if(o&&"page"!==o&&p.b1[o])return t.formatMessage(p.b1[o])}return n.Q2(t)}(i,o);return g(i,o,t)||m(i,o)||a}},42937:(e,t,o)=>{o.d(t,{Bq:()=>w,Gt:()=>f,K9:()=>S,OH:()=>v,Tq:()=>g,W3:()=>m,cn:()=>k,dH:()=>p,g3:()=>b,l7:()=>u,nB:()=>h,qi:()=>y,uM:()=>_,vi:()=>x});var n=o(42773),r=o(59341),i=o(41898),a=o(97880),s=o(5366),l=o(75081);const c=(0,s.defineMessages)({dependenciesPropertySelectDefaultOptionCaption:{id:"database.viewSettings.relationFeatures.dependencies.propertySelectPopup.default.caption",defaultMessage:"This property will be used for dependencies in new views, and will set date shifting behavior across all views."},deleteDependenciesAcceptModalTitle:{id:"collectionSettings.relationFeatures.deleteDependenciesAcceptModal.title",defaultMessage:"Turn off dependencies?"},dependenciesMenuTitle:{id:"database.viewSettings.dependenciesTab.title",defaultMessage:"Dependencies"},dateShiftingSectionCaption:{id:"collectionSettings.dependenciesView.dateShiftingSection.caption",defaultMessage:"Automatic date shifting"},datePropertyPickerTitle:{id:"database.viewSettings.relationFeatures.datePropertyPicker.title",defaultMessage:"Shift using"},startDate:{id:"database.viewSettings.relationFeatures.datePropertyPicker.startDate",defaultMessage:"Start date"},endDate:{id:"database.viewSettings.relationFeatures.datePropertyPicker.endDate",defaultMessage:"End date"},advancedSettings:{id:"database.viewSettings.dependenciesAdvancedSettingsTab.title",defaultMessage:"Advanced settings"},newDateProperty:{id:"collectionSettings.dependenciesFeature.newDateProperty.name",defaultMessage:"Date"},doNotShiftButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.doNotShift.label",defaultMessage:"Do not automatically shift"},consumeGapButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.consumeGap.label",defaultMessage:"Shift only when dates overlap"},avoidWeekendsSwitcherTitle:{id:"collectionSettings.dependenciesView.dateShiftingSection.avoidWeekends.switcher.title",defaultMessage:"Avoid weekends"},hideDependenciesInView:{id:"CollectionSettingsViewRelationFeatures.hideDependenciesInView",defaultMessage:"Hide dependencies in view"},showDependenciesInView:{id:"CollectionSettingsViewRelationFeatures.showDependenciesInView",defaultMessage:"Show dependencies in view"},turnOnDependenciesButton:{id:"collectionSettings.dependenciesView.turnOnDependenciesButton.label",defaultMessage:"Turn on dependencies"},turnOffDependenciesButton:{id:"database.viewSettings.relationsPropertyTab.removeDependenciesButton.title",defaultMessage:"Turn off dependencies"},dateShiftSuccess:{id:"collectionDateActions.dateShiftSuccess",defaultMessage:"Shifted the dates of {numDependenciesUpdated, plural, one {1 dependent {item}} other {{numDependenciesUpdated} dependent {items}}}"},dateShiftSomeNotUpdatedDueToPermissions:{id:"collectionDateActions.dateShiftSomeNotUpdatedDueToPermissions",defaultMessage:"Shifted the dates of {numDependenciesUpdated, plural, one {1 dependent {item}} other {{numDependenciesUpdated} dependent {items}}}. Others could not be shifted because you do not have permission"},dateShiftAllNotUpdatedDueToPermissions:{id:"collectionDateActions.dateShiftAllNotUpdatedDueToPermissions",defaultMessage:"The dates of dependent {items} could not be shifted because you do not have permission"},shiftingNotApplicableNoShiftingMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicableNoShiftingMessage",defaultMessage:"The dates of dependent {items} in this view will not automatically shift. To change the date shifting behavior, update the default relation property in Advanced settings."},shiftingNotApplicableConsumeGapMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicableConsumeGapMessage",defaultMessage:"The dates of dependent {items} in this view will shift when {item} dates overlap. To change the date shifting behavior, update the default relation property in Advanced settings."},shiftingNotApplicablePreserveGapMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicablePreserveGapMessage",defaultMessage:"The dates of dependent {items} in this view will shift maintaining the time between {items}. To change the date shifting behavior, update the default relation property in Advanced settings."},preserveGapButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.preserveGap.label",defaultMessage:"Shift & maintain time between {items}"},avoidWeekendsSwitcherCaption:{id:"collectionSettings.dependenciesView.dateShiftingSection.avoidWeekends.switcher.description",defaultMessage:"Prevent shifted {items} from starting or ending on weekends"},dependenciesMenuDescription:{id:"database.viewSettings.relationsPropertyTab.dependencies.description",defaultMessage:"Use dependencies to show {items} that are blocking â€” or blocked by â€” other {items}."},dependenciesPropertyPickerCaption:{id:"database.viewSettings.relationsPropertyTab.dependencies.relationPropertyPicker.caption",defaultMessage:"Choose the relation property that represents the {items} that are blocked. We use â€œBlockingâ€ as our default."}}),d=(0,s.defineMessages)({hideSubitemsInView:{id:"CollectionSettingsViewRelationFeatures.hideSubitemsInView",defaultMessage:"Hide sub-{items} in view"},showSubitemsInView:{id:"CollectionSettingsViewRelationFeatures.showSubitemsInView",defaultMessage:"Show sub-{items} in view"},turnOnSubItemsButton:{id:"collectionSettings.subitemsView.turnOnSubitemsButton.label",defaultMessage:"Turn on sub-{items}"},turnOffSubItemsButton:{id:"database.viewSettings.relationsPropertyTab.removeSubItemsButton.title",defaultMessage:"Turn off sub-{items}"},subItemsMenuTitle:{id:"database.viewSettings.subItemsTab.title",defaultMessage:"Sub-{items}"},subItemsMenuDescription:{id:"database.viewSettings.relationsPropertyTab.subitems.description",defaultMessage:"Use sub-{items} to break large {items} into smaller, more manageable chunks."},deleteSubItemsAcceptModalTitle:{id:"collectionSettings.relationFeatures.deleteSubItemsAcceptModal.title",defaultMessage:"Turn off sub-{items}?"},subItemsPropertyPickerCaption:{id:"database.viewSettings.relationsPropertyTab.subitems.relationPropertyPicker.caption",defaultMessage:"Choose the relation property that represents the sub-{items}. We use â€œSub-{item}â€ as our default."},subItemsPropertySelectDefaultOptionCaption:{id:"database.viewSettings.relationFeatures.subitems.propertySelectPopup.default.caption",defaultMessage:"This property will be used for sub-{items} in new views."},toggleNestingOnTitleMenuItemTooltip:{id:"database.viewSettings.relationFeatures.subitems.toggleNestingOnTitleMenuItemTooltip.default.caption",defaultMessage:"Whether nesting and the toggle button should always be on the title column or the left-most column. Only relevant for table views"}}),p=(0,s.defineMessages)({relationFeatureOnMessage:{id:"database.viewSettings.mainTab.feature.on",defaultMessage:"On"},relationFeatureOffMessage:{id:"database.viewSettings.mainTab.feature.off",defaultMessage:"Off"},relationFeatureHiddenMessage:{id:"database.viewSettings.mainTab.relationFeatureHidden",defaultMessage:"Hidden"},turnOffAndDelete:{id:"collectionSettings.relationFeatures.turnOffFeatureAllViewsButton.label",defaultMessage:"Turn off and delete"},turnOffFeature:{id:"collectionSettings.relationFeatures.turnOffFeatureWithoutDeleteButton.label",defaultMessage:"Turn off feature"},turnOffFeatureDeletedProperties:{id:"collectionSettings.relationFeatures.turnOffFeature.deletedProperties.description",defaultMessage:"This will also delete the properties <span>{propertyName}</span> and <span>{inversePropertyName}</span>."},...c,...d});function u(e){return"consume_gap"===e?i.d:"preserve_gap"===e?n.$:r.H}function m(e){let t;return t="consume_gap"===e.dateShiftingMode?p.consumeGapButton:"preserve_gap"===e.dateShiftingMode?p.preserveGapButton:p.doNotShiftButton,{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function g(e){let t;return"timeline_arrows_by"===e.feature?t=p.turnOnDependenciesButton:"subitem"===e.feature?t=p.turnOnSubItemsButton:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function h(e){let t;return"timeline_arrows_by"===e.feature?t=p.turnOffDependenciesButton:"subitem"===e.feature?t=p.turnOffSubItemsButton:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function f(e){let t;return"timeline_arrows_by"===e.feature?t=p.dependenciesMenuTitle:"subitem"===e.feature?t=p.subItemsMenuTitle:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function y(e){let t;return"timeline_arrows_by"===e.feature?t=p.dependenciesMenuDescription:"subitem"===e.feature?t=p.subItemsMenuDescription:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function v(e){let t;return"timeline_arrows_by"===e.feature?t=p.deleteDependenciesAcceptModalTitle:"subitem"===e.feature?t=p.deleteSubItemsAcceptModalTitle:(0,a.t1)(e.feature),{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function b(e){let t;return"timeline_arrows_by"===e.feature?t=p.dependenciesPropertyPickerCaption:"subitem"===e.feature?t=p.subItemsPropertyPickerCaption:(0,a.t1)(e.feature),{...t,values:{item:(0,l.sN)(e.databaseType,!0),items:(0,l.Q_)(e.databaseType,!0)}}}function S(e){let t;return"timeline_arrows_by"===e.feature?t=p.dependenciesPropertySelectDefaultOptionCaption:"subitem"===e.feature?t=p.subItemsPropertySelectDefaultOptionCaption:(0,a.t1)(e.feature),{...t,values:{item:(0,l.sN)(e.databaseType,!0),items:(0,l.Q_)(e.databaseType,!0)}}}function _(e){let t;return(0,a.$K)(e.currentDateShiftConfig)?"preserve_gap"===e.currentDateShiftConfig.mode?t=p.shiftingNotApplicablePreserveGapMessage:"consume_gap"===e.currentDateShiftConfig.mode?t=p.shiftingNotApplicableConsumeGapMessage:(0,a.t1)(e.currentDateShiftConfig.mode):t=p.shiftingNotApplicableNoShiftingMessage,{...t,values:{items:(0,l.Q_)(e.databaseType,!0)}}}function w(e){return{...p.avoidWeekendsSwitcherCaption,values:{items:(0,l.Q_)(e,!0)}}}function k(e){const{feature:t,isOn:o,databaseType:n}=e;let r;return"timeline_arrows_by"===t?r=o?p.hideDependenciesInView:p.showDependenciesInView:"subitem"===t?r=o?p.hideSubitemsInView:p.showSubitemsInView:(0,a.t1)(t),{...r,values:{items:(0,l.Q_)(n,!0)}}}function x(e){const t={numDependenciesUpdated:e.result.numDependenciesUpdated,item:(0,l.sN)(e.databaseType,!0),items:(0,l.Q_)(e.databaseType,!0)};return e.result.numCouldNotUpdateDueToPermissions>0?e.result.numDependenciesUpdated>0?{message:{...p.dateShiftSomeNotUpdatedDueToPermissions,values:t},canUndo:!0}:{message:{...p.dateShiftAllNotUpdatedDueToPermissions,values:{}},canUndo:!1}:e.result.numDependenciesUpdated>0?{message:{...p.dateShiftSuccess,values:t},canUndo:!0}:void 0}},29376:(e,t,o)=>{o.d(t,{BI:()=>b,KV:()=>h,Mu:()=>g,NA:()=>M,ND:()=>P,OP:()=>f,Pi:()=>y,U1:()=>C,ZI:()=>I,aI:()=>k,gO:()=>B,gZ:()=>_,ke:()=>A,m8:()=>x,ny:()=>S,pR:()=>v,rj:()=>w,uJ:()=>D});o(57658);var n=o(99036),r=o(95200),i=o(77657),a=o(6695),s=o(42875),l=o(22808),c=o(59753),d=o(97880),p=o(35661),u=(o(65742),o(78316)),m=o(75081);const g=32;function h(e,t){return e.normalizedSchemaStore.state[t]}function f(e,t,o){const r=h(e,t);if(!r||"relation"!==r.type||!r.property)return!1;const i=e.collectionStore(),a=o.getSchema();return n.$u({propertySchema:r,sourceCollectionId:null==i?void 0:i.id,property:t,targetCollectionSchema:a})}function y(e){const t=(0,d.qP)(e).find((e=>{let[t,o]=e;if(o&&(0,n.NK)(o))return o.connectedRelation.integration_id===i.U9}));if(t&&t[1]&&(0,n.NK)(t[1]))return t[1]}function v(e){return Boolean(y(e))}function b(e,t){if(!e)return!1;const o=e[t];return Boolean(o&&(0,n.NK)(o)&&o.connectedRelation.integration_id===i.U9)}function S(e,t){if("relation"!==(null==t?void 0:t.type))return;const o=null==t?void 0:t.collection_pointer,n=e.collectionViewBlockStore();return o&&n?p.NW.createChildStore(n,o):void 0}function _(e){return u.eD({collectionStore:e,collectionViewBlockStore:e.getParentBlockStore(),checkNavigableAncestorLocked:!1})}function w(e){const{inverseName:t,collectionStore:o,propertySchema:n,intl:r,targetCollectionStore:i,from:a}=e;return t||(o.isDefined()&&n?k(r,{sourceCollection:o.getModel(),isSelfRelation:o.id===i.id,targetCollectionStore:i,createUnique:!0,from:a}):"")}function k(e,t){var o;const{sourceCollection:n,isSelfRelation:i,targetCollectionStore:a,createUnique:d,from:p}=t,u=c.kk.fromCollection(n),g=e.formatMessage({id:"relationHelpers.autoInverseRelation.untitledDatabase",defaultMessage:"Untitled Database"}),h=null===(o=u.getRenderIcon({}))||void 0===o?void 0:o.icon,f=u.getRenderTitle({getRecordModel:a.getRecordModel,userTimeZone:(0,s.r)(),intl:e})||g,y=u.getDatabaseType();let v;if(i)if("subitem"===p){const t=(0,m.sN)(y,!0);v=e.formatMessage({defaultMessage:"Parent {item}",id:"relationHelpers.autoSelfRelationInverseToggle.typedName"},{item:t})}else v="timeline_arrows_by"===p?e.formatMessage({defaultMessage:"Blocked by",id:"relationHelpers.autoSelfRelationInverseArrow.name"},{sourceCollectionName:f}):e.formatMessage({defaultMessage:"Related back to {sourceCollectionName}",id:"relationHelpers.autoSelfRelationInverse.name"},{sourceCollectionName:f});else v=h&&(0,l.Z)(h)?e.formatMessage({defaultMessage:"{sourceCollectionIcon} {sourceCollectionName}",id:"relationHelpers.autoInverseRelationWithIcon.name"},{sourceCollectionIcon:h,sourceCollectionName:f}):e.formatMessage({defaultMessage:"{sourceCollectionName}",id:"relationHelpers.autoInverseRelationSimple.name"},{sourceCollectionName:f});const b=a.getSchema();return b&&d?(0,r.Z)(v,(e=>!Object.values(b).find((t=>Boolean(t&&t.name===e))))):v}function x(e,t){var o,n;const{targetCollectionStore:i,isSelfRelation:a,sourceSchema:c,createUnique:d,from:p}=t,u=null===(o=i.getModel())||void 0===o||null===(o=o.getRenderIcon({}))||void 0===o?void 0:o.icon,g=e.formatMessage({id:"relationHelpers.autoInverseRelation.untitledDatabase",defaultMessage:"Untitled Database"}),h=(null===(n=i.getModel())||void 0===n?void 0:n.getRenderTitle({getRecordModel:i.getRecordModel,userTimeZone:(0,s.r)(),intl:e}))||g,f=i.getDatabaseType();let y;if(a)if("subitem"===p){const t=(0,m.sN)(f,!0);y=e.formatMessage({defaultMessage:"Sub-{item}",id:"relationHelpers.autoSelfRelationNest.typedName"},{item:t})}else y="timeline_arrows_by"===p?e.formatMessage({defaultMessage:"Blocking",id:"relationHelpers.autoSelfRelationTimelineArrow.name"},{targetCollectionName:h}):e.formatMessage({defaultMessage:"Related {targetCollectionName}",id:"relationHelpers.autoSelfRelation.name"},{targetCollectionName:h});else y=u&&(0,l.Z)(u)?e.formatMessage({defaultMessage:"{targetCollectionIcon} {targetCollectionName}",id:"relationHelpers.autoRelationWithIcon.name"},{targetCollectionIcon:u,targetCollectionName:h}):e.formatMessage({defaultMessage:"{targetCollectionName}",id:"relationHelpers.autoRelation.name"},{targetCollectionName:h});const v=Object.values(c);return d?(0,r.Z)(y,(e=>!v.find((t=>Boolean(t&&t.name===e))))):y}function I(e){const t=a.iB(e.getFormat(),e.getSchema(),void 0,a.j5.Relation);return t?t.collection_relation_options??{}:{}}function C(e){var t;const{collectionStore:o,property:n}=e;return(null===(t=I(o)[n])||void 0===t?void 0:t.related_properties)??[]}function T(e,t){return Object.entries(t).map((o=>{let[r,i]=o;if(!i||!(0,n.p_)(i))return;const a=(0,n.j0)(i),s=e.collectionStore();if(!a||a.id!==(null==s?void 0:s.pointer.id)||!s||!f(e,r,s))return;const l=i.property;if(!l)return;const c=t[l];if(!c||"relation"!==c.type)return;const d=(0,n.j0)(c);return d&&d.id===(null==s?void 0:s.pointer.id)?{propertyID:r,inversePropertyID:l}:void 0})).filter(d.$K)}function M(e,t){return T(e,t).map((e=>e.propertyID))}function P(e,t){const o=T(e,t),n=new Set,r=[];for(const{propertyID:i,inversePropertyID:a}of o)n.has(i)||n.has(a)||(r.push([i,a]),n.add(i),n.add(a));return r}function A(e,t){const o=(0,n.j0)(e);if(!o)return;const r=p.NW.createChildStore(t,o);return r?null==r?void 0:r.getFormat().app_config_uri:void 0}function D(e,t){const o=(0,n.j0)(e);if(!o)return;const r=p.NW.createChildStore(t,o);return r?null==r?void 0:r.getSchema():void 0}function B(e,t){const o=(0,n.j0)(e);if(!o)return;const r=p.NW.createChildStore(t,o);return r||void 0}},77546:(e,t,o)=>{o.d(t,{Ez:()=>u,Gf:()=>h,Oc:()=>c,SD:()=>i,VW:()=>a,Wr:()=>d,eA:()=>g,hI:()=>l,xH:()=>s});o(57658);var n=o(69454);const r={auto:!0,scroll:!0};function i(e){return e&&e instanceof HTMLElement?e:e&&e.parentElement?e.parentElement:void 0}function a(e){const t=i(e);if(t)return m(t,"vertical")}function s(e){const t=i(e);if(t)return m(t,"horizontal")}function l(e){let t=e;const o=[];do{const e=window.getComputedStyle(t);e&&(e.overflow&&r[e.overflow]||e.overflowY&&r[e.overflowY]||e.overflowX&&r[e.overflowX])&&o.push(t),t=t.parentElement}while(t);return o}function c(e){const{el:t,windowHeight:o}=e,r=e.minEdgeDist??8,i=a(t);if(!i||!i.getBoundingClientRect)return;const s=t.getBoundingClientRect(),l=i.getBoundingClientRect(),c=o-n.Z.estimatedNativeWebBottomOverlap(),d=Math.min(l.bottom,c);s.top<l.top?i.scrollTop=i.scrollTop-(l.top-s.top)-r:s.bottom>d&&(i.scrollTop=i.scrollTop+(s.bottom-d)+r)}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{edgeDist:0,animate:!1};const o=a(e),{animate:n,edgeDist:r}=t;if(!o||!o.getBoundingClientRect)return;const i=e.getBoundingClientRect(),s=o.getBoundingClientRect();if(n){const e=500,t=o.scrollTop-(s.top-i.top)-r,n=o.scrollTop,a=t-n,l=16;let c=0;const d=()=>{var t,r,i;c+=l,o.scrollTop=(t=c,r=n,i=a,(t/=e/2)<1?i/2*t*t+r:-i/2*(--t*(t-2)-1)+r),c<e&&requestAnimationFrame(d)};d()}else o.scrollTop=o.scrollTop-(s.top-i.top)-r}function p(e){return e&&e.overflowY&&r[e.overflowY]}function u(e){if(!e)return;let t=e;if(t)do{const e=t.parentElement&&window.getComputedStyle(t.parentElement);if(e&&p(e))return t;t=t.parentElement||void 0}while(t);return document.body}function m(e,t){if(!e)return;let o=e;if(o)do{const e=window.getComputedStyle(o);if(o.classList&&o.classList.contains("notion-scroller")&&o.classList.contains(t)||p(e))return o;o=o.parentElement||void 0}while(o);return document.body}function g(e){return e.device.isDesktop&&!e.device.isSafari}function h(e){return e.device.isDesktop}},45010:(e,t,o)=>{o.d(t,{Z:()=>n});const n={}},59139:(e,t,o)=>{o.d(t,{XP:()=>r,rd:()=>i});var n=o(77080);function r(){return!1}function i(e){return"on"===n.default.getGroup("search-intent-based-grouping-n-side-peek")||function(e){return"quickSearch"===e.RouterStore.state.route.name}(e)}},48141:(e,t,o)=>{o.d(t,{gC:()=>Ce,zD:()=>Ie,oO:()=>Re,p6:()=>_e,_Q:()=>xe,De:()=>ve,pG:()=>Ee,dy:()=>ze,Y_:()=>qe,hb:()=>Ae,MQ:()=>Le,bC:()=>Oe,b9:()=>De,IV:()=>Ne,MS:()=>Te,FN:()=>be,VA:()=>Se,VD:()=>ye,g8:()=>je,Nu:()=>Fe,iA:()=>Ve,YB:()=>Be,AX:()=>Ue});o(57658);var n=o(41432),r=o(80951),i=o(59753),a=o(21202),s=o(6287),l=o(70203),c=o(97880);const d={indexTimeMs:!0,title:!0,children_contents:!0,children_ids:!0,children_permissions:!0,children_fractional_index:!0,children_types:!0,alive:!0,created_by_id:!0,created_by_table:!0,created_time:!0,format:!0,id:!0,is_template:!0,last_edited_by_id:!0,last_edited_time:!0,parent_table:!0,permissions:!0,space_id:!0,team_id:!0,team_name:!0,team_is_archived:!0,auto_increment_id:!0,type:!0,version:!0,ancestors:!0,audience:!0,db_schema_source_partition:!0,depth:!0,is_path_alive:!0,is_top_level_page:!0,parent_id:!0,path_text:!0,search_permissions:!0,inherited_permissions:!0,parent_page_id:!0,collection_id:!0,parent_collection_id:!0,page_views:!0,unique_page_views:!0,collection_properties:!0,children_last_edited_times:!0,mentions_dictionary:!0},{audience:p,...u}=((0,c.QS)(d),d);(0,c.QS)(u);function m(e){const{getRecordValue:t,blockValue:o}=e;let c="";const d={user:new Map},p=i.kk.fromBlock(o),u=i.om.fromGetRecordValueFn(t);if(p.isCollectionView()){const e=function(e){const{getRecordModel:t,model:o}=e,n=o.getRenderFormatPointer(t);if(!n)return;const i=t(n);if(!i)return;if(i.table===a.iU)return(0,r.wS)(i,"title")||[];if(i.table===s.v)return i.getNormalizedName()}({model:p,getRecordModel:u});e&&e.length>0&&(c=l.Qh7(e,u,d).text)}else if(p.isType("file")){c=`${l.Qh7(p.getProperty("title"),u,d).text} ${l.Qh7(p.getProperty("caption"),u,d).text}`}else if(p.isType("bookmark")){c=`${l.Qh7(p.getProperty("title"),u,d).text} ${l.Qh7(p.getProperty("description"),u,d).text} ${l.Qh7(p.getProperty("caption"),u,d).text}`}else if(p.isType(n.Ok)){const e=p.getProperty("caption");c=l.Qh7(e,u,d).text}else if(p.isType(n.Ti.tableRow)){const e=function(e){const{blockModel:t,getRecordModel:o}=e,n=o({table:a.iU,id:t.getParentId(),spaceId:t.getSpaceId()});return null==n?void 0:n.getFormatValue("table_block_column_order")}({blockModel:p,getRecordModel:u});if(e){c=e.map((e=>l.Qh7(p.getProperty(e),u,d).text)).join(" ")}}else{const e=(0,r.wS)(o,"title");c=l.Qh7(e,u,d).text}return{text:c.trim()||void 0,mentions:d}}var g=o(40506),h=o(7057),f=o(53877),y=o(58573),v=o(42875),b=o(72126),S=o(58203),_=o(63306),w=o(4615),k=o(73360),x=o(74446),I=o(45953),C=o(33361),T=o(92338),M=o(5366),P=o(54642),A=o(80444),D=o(61738),B=o(42198);const R=e=>{let{result:t}=e;return{name:"IS_EXACT_MATCH",value:t.relevanceResult.matchMetadata.isExactIdMatch?1:0}},E=e=>{let{result:t}=e;return{name:"IS_PREFIX_MATCH",value:t.relevanceResult.matchMetadata.isPrefixMatch?1:0}},F=e=>{let{result:t}=e;return{name:"IS_WORD_PREFIX_MATCH",value:t.relevanceResult.matchMetadata.isWordPrefixMatch?1:0}},N=e=>{let{result:t}=e;return{name:"IS_SUBSTRING_MATCH",value:t.relevanceResult.matchMetadata.isSubstringMatch?1:0}},j=e=>{let{result:t}=e;return{name:"IS_WORD_PREFIX_MATCH",value:t.relevanceResult.matchMetadata.isFuzzyMatch?1:0}},O=e=>{let{result:t}=e;return{name:"IS_FRECENT_PAGE",value:t.relevanceResult.localSource.has("frecencyStore")?1:0}},L=e=>{let{result:t}=e;return{name:"IS_BOOKMARKED_PAGE",value:t.relevanceResult.localSource.has("bookmarkedPage")?1:0}},U=e=>{let{result:t}=e;return{name:"IS_TEAM_PAGE",value:t.relevanceResult.localSource.has("teamPage")?1:0}},Z=e=>{var t;let{result:o,featureExtractor:n}=e;const r=null===(t=n.frecencyStore)||void 0===t?void 0:t.getFrecencyScore(o.blockModel.id);return{name:"FRECENCY_SCORE",value:r||0}},V=e=>{let{result:t,featureExtractor:o}=e;const[n,r]=o.getFrecencyScoreBounds();return{name:"FRECENCY_SCORE_SCALED",value:o.minMaxScale(Z({result:t,featureExtractor:o}).value,n,r)}},q=e=>{let{result:t}=e;return{name:"LEXICAL_MATCH_SCORE",value:t.relevanceResult.score}},z={name:"CLIENT_FEATURESET_V1",features:[R,E,F,N,e=>{let{result:t}=e;return{name:"IS_IN_ORDER_TOKEN_MATCH",value:t.relevanceResult.matchMetadata.isInOrderTokenMatch?1:0}},j,e=>{let{result:t}=e;return{name:"IS_RECENT_VISIT_BY_ME",value:t.relevanceResult.localSource.has("recentVisit")?1:0}},O,L,e=>{let{result:t}=e;return{name:"IS_FROM_DEFAULT_RECORD_CACHE",value:t.relevanceResult.localSource.has("defaultRecordCache")?1:0}},U,V,e=>{let{result:t,featureExtractor:o}=e;const[n,r]=o.getLexicalMatchScoreBounds();return{name:"LEXICAL_MATCH_SCORE_SCALED",value:o.minMaxScale(q({result:t,featureExtractor:o}).value,n,r)}}]},W={name:"CLIENT_FEATURESET_V2_RAW",features:[R,E,F,N,j,O,L,U,V,e=>{let{result:t}=e;return{name:"IS_RECENT_VISIT_BY_ME",value:t.relevanceResult.localSource.has("recentVisit")?1:0}},e=>{let{result:t}=e;return{name:"TIME_SINCE_LAST_VIEWED_BY_ME",value:t.timeSinceLastViewedMs??-1}},e=>{let{result:t,featureExtractor:o}=e;return{name:"IS_SIMILAR_USER_1D_RECENT_PAGE",value:B.default.isSimilarUsersRecentPages({userId:o.userId,spaceId:o.spaceId,pageId:t.blockModel.id})?1:0}},e=>{let{result:t,featureExtractor:o}=e;return{name:"NUM_SIMILAR_USERS_VIEWED_PAGE",value:B.default.getNumSimilarUsersVisitedPage({userId:o.userId,spaceId:o.spaceId,pageId:t.blockModel.id})||0}},e=>{let{result:t,featureExtractor:o}=e;return{name:"PAGE_MOST_SIMILAR_VIEWER_SIMILARITY",value:B.default.getHighestViewerSimilarityScoreForPage({userId:o.userId,spaceId:o.spaceId,pageId:t.blockModel.id})||0}},e=>{let{result:t,featureExtractor:o}=e;const n=B.default.getSimilarUsersMostRecentVisitTimeForPage({userId:o.userId,spaceId:o.spaceId,pageId:t.blockModel.id});return{name:"TIME_SINCE_SIM_USER_VISIT",value:n?o.currentTimeMs-n:-1}},e=>{let{result:t,featureExtractor:o}=e;return{name:"IS_TOP_PAGES_7D_PAGE_VIEWS",value:B.default.isTopPages7dPageView({userId:o.userId,spaceId:o.spaceId,pageId:t.blockModel.id})?1:0}},e=>{let{result:t,featureExtractor:o}=e;return{name:"PAGE_AUTHORITY_V1",value:B.default.getPageAuthorityV1ForPage({userId:o.userId,spaceId:o.spaceId,pageId:t.blockModel.id})||0}},e=>{let{result:t,featureExtractor:o}=e;return{name:"TIME_SINCE_LAST_EDIT",value:o.currentTimeMs-t.blockModel.last_edited_time}},e=>{let{result:t,featureExtractor:o}=e;return{name:"IS_LAST_EDITED_BY_ME",value:o.userId&&t.blockModel.last_edited_by_id===o.userId?1:0}},e=>{let{result:t}=e;return{name:"IS_LAST_EDITED_BY_ME_WITHIN_12H",value:t.relevanceResult.localSource.has("defaultRecordCache")?1:0}},e=>{let{result:t,featureExtractor:o}=e;return{name:"TIME_SINCE_LAST_EDITED_BY_ME",value:B.default.getUserLastEditedTimeForPage({userId:o.userId,spaceId:o.spaceId,pageId:t.blockModel.id})??-1}},e=>{let{result:t,featureExtractor:o}=e;return{name:"TIME_SINCE_SIM_USER_LAST_EDIT",value:B.default.getSimilarUserLastEditedTimeForPage({userId:o.userId,spaceId:o.spaceId,pageId:t.blockModel.id})??-1}},q,Z]};function H(e){let t=0,o=0;for(const n of e)n<t&&(t=n),n>o&&(o=n);return[t,o]}class G{constructor(e,t,o){var n;this.featuresets=void 0,this.frecencyStore=void 0,this.results=void 0,this.resultsFeatureMetadata={},this.userId=void 0,this.spaceId=void 0,this.currentTimeMs=void 0,this.frecencyStore=D.Z.lazyFrecencyStore.get(t.currentUser.id),this.featuresets=e,this.results=o,this.userId=t.currentUser.id,this.spaceId=null===(n=A.default.state.currentSpaceStore)||void 0===n?void 0:n.id,this.currentTimeMs=Date.now()}minMaxScale(e,t,o){return t===o?0:(e-t)/(o-t)}getFrecencyScoreBounds(){if(!this.resultsFeatureMetadata.minFrecencyScore||!this.resultsFeatureMetadata.maxFrecencyScore){const e=this.results.map((e=>Z({result:e,featureExtractor:this}).value||0)),[t,o]=H(e);this.resultsFeatureMetadata.minFrecencyScore=t,this.resultsFeatureMetadata.maxFrecencyScore=o}return[this.resultsFeatureMetadata.minFrecencyScore,this.resultsFeatureMetadata.maxFrecencyScore]}getLexicalMatchScoreBounds(){if(!this.resultsFeatureMetadata.minLexicalMatchScore||!this.resultsFeatureMetadata.maxLexicalMatchScore){const e=this.results.map((e=>q({result:e,featureExtractor:this}).value||0)),[t,o]=H(e);this.resultsFeatureMetadata.minLexicalMatchScore=t,this.resultsFeatureMetadata.maxLexicalMatchScore=o}return[this.resultsFeatureMetadata.minLexicalMatchScore,this.resultsFeatureMetadata.maxLexicalMatchScore]}extractFeatureGroup(e){const t=[];for(const o of this.featuresets){const n={groupName:o.name,features:[]};for(const t of o.features)n.features.push(t({result:e,featureExtractor:this}));t.push(n)}return t}}var K=o(77080),$=o(29026);o(21703);class Y{constructor(e){let{name:t,weights:o,intercept:n,featureset:r}=e;if(this.weights=void 0,this.intercept=void 0,this.featureset=void 0,this.name=void 0,this.score=e=>{const t=function(e){const{result:t,groupName:o}=e;return t.featureGroups.find((e=>e.groupName===o))}({result:e,groupName:this.featureset.name});if(!t)throw new Error(`[Model: ${this.name}] Feature group ${this.featureset.name} not found`);const{groupName:o,features:n}=t;if(o!==this.featureset.name)throw new Error(`[Model: ${this.name}] Feature group name does not match model`);if(n.length!==this.weights.length)throw new Error(`[Model: ${this.name}] Feature weights do not match feature count`);let r=this.intercept;return n.forEach(((e,t)=>{const o=this.weights[t];r+=o*e.value})),r},o.length!==r.features.length)throw new Error(`[Model: ${t}] Feature weights do not match feature count`);this.weights=o,this.intercept=n,this.featureset=r,this.name=t}}const Q=new Y({name:"ridge_regression_v1",weights:[.07338547745990809,-.5187934622823605,.2580923407555247,.02348953943987908,.6274337942627901,.03317934430846847,0,-.3511876522594548,-.6273845571398535,-.045037288133869424,.20767101148186384,8.619648989831271,-1.2158798461014042],intercept:1.5427965680658178,featureset:z}),J=new Y({name:"logistic_regression_v1",weights:[0,.591755530784604,-1.2417186349959148,.31667280869910813,-1.0465382148354145,2.6692070654927273,-.25984857199808187,-.8346114640363157,.12435852022293091,-.006220960322605889,.1653145505065149,105.87044316084274,.3404653043307269],intercept:-.15561962,featureset:z}),X=new Y({name:"svc_v1",weights:[0,.285388028,-.587419463,.160194857,-.50486014,.676207274,-.121528628,-.403215103,.0743405796,.00540581964,.0816730306,24.5922097,.931615053],intercept:-.07565408,featureset:z});function ee(e){const{sort:t,currentUserId:o,unsorted:n}=e,r=K.default.getEligibleGroup({experimentId:"search-client-ltr-v0"});return r&&"control"!==r?function(e){const{unsorted:t}=e,o=function(e){switch(e){case"logreg":return J;case"ridgereg":return Q;case"svc":return X;default:(0,c.t1)(e)}}(e.clientLtrGroup);return t.map((e=>({result:e,score:o.score(e)}))).sort(((e,t)=>t.score-e.score)).map((e=>e.result))}({unsorted:n,clientLtrGroup:r}):Be({sort:t,currentUserId:o,unsorted:n,batchSize:$.Xv})}var te=o(69327),oe=o(35661),ne=o(26842),re=o(88893),ie=o(24215),ae=o(28020),se=o(43250),le=o(45950),ce=o(98165),de=o(67669),pe=o(15447),ue=o(38755),me=o(95697);function ge(e){return Boolean(e&&e.length>0)}function he(e){return Boolean(e.starting||e.ending)}function fe(e){return Boolean(e)}const ye={requireEditPermissions:fe,isDeletedOnly:fe,excludeTemplates:fe,navigableBlockContentOnly:fe,ancestors:ge,parentId:function(e){return void 0!==e},createdBy:ge,editedBy:ge,lastEditedTime:he,createdTime:he,isAdminModeDeletedPageSearch:fe,blockTypes:function(e){return Boolean(e&&e.length>0)},inTeams:function(e){return ge(T.iY(e))},includePublicPagesWithoutExplicitAccess:fe,audience:function(e){return Boolean(e)},dev_excludedPages:ge,dev_excludedTeams:ge,databaseType:ge};function ve(e){return e?{requireEditPermissions:ye.requireEditPermissions(e.requireEditPermissions),isDeletedOnly:ye.isDeletedOnly(e.isDeletedOnly),excludeTemplates:ye.excludeTemplates(e.excludeTemplates),navigableBlockContentOnly:ye.navigableBlockContentOnly(e.navigableBlockContentOnly),ancestors:ye.ancestors(e.ancestors),parentId:ye.parentId(e.parentId),createdBy:ye.createdBy(e.createdBy),editedBy:ye.editedBy(e.editedBy),createdTime:ye.createdTime(e.createdTime),lastEditedTime:ye.lastEditedTime(e.lastEditedTime),blockTypes:ye.blockTypes(e.blockTypes),inTeams:ye.inTeams(e.inTeams),dev_excludedPages:ye.dev_excludedPages(e.dev_excludedPages),dev_excludedTeams:ye.dev_excludedTeams(e.dev_excludedTeams)}:{requireEditPermissions:!1,isDeletedOnly:!1,excludeTemplates:!1,navigableBlockContentOnly:!1,ancestors:!1,parentId:!1,createdBy:!1,editedBy:!1,createdTime:!1,lastEditedTime:!1,blockTypes:!1,inTeams:!1,dev_excludedPages:!1,dev_excludedTeams:!1}}function be(e){const t=ve(e);return Object.values(t).some((e=>Boolean(e)))}function Se(e){const t=ve(e),{navigableBlockContentOnly:o,...n}=t;return Object.values(n).some((e=>Boolean(e)))}function _e(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g.sF;const n=f.OQ.notionDateToLuxon(e,{locale:t.locale});return(0,h.Cp)(n,o)}function we(e,t){const o=f.OQ.notionDateTimeToLuxon(e,t.locale);return(0,h.ZW)(o,"medium_with_time")}const ke=(0,M.defineMessages)({startAndEnd:{defaultMessage:"{startDate} - {endDate}",id:"searchHelpers.betweenStartAndEndDates"},afterStart:{defaultMessage:"After {startDate}",id:"searchHelpers.afterStartDate"},beforeEnd:{defaultMessage:"Before {endDate}",id:"searchHelpers.beforeEndDate"}});function xe(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g.sF,n="",r="";return e.starting&&(n="date"===e.starting.type?_e(e.starting,t,o):we(e.starting,t)),e.ending&&(r="date"===e.ending.type?_e(e.ending,t,o):we(e.ending,t)),n&&r?t.formatMessage(ke.startAndEnd,{startDate:n,endDate:r}):n?t.formatMessage(ke.afterStart,{startDate:n}):t.formatMessage(ke.beforeEnd,{endDate:r})}function Ie(e){return Boolean(e.target&&e.target instanceof HTMLElement&&e.target.classList.contains("rdp-day"))}function Ce(e){const{input:t,spaceId:o,publicAccessPermissionAncestorBlockId:n,searchSessionId:r,searchSessionFlowNumber:i,source:a,forcedClusterPattern:s,searchExperimentOverrides:l,recentPagesForBoosting:c,forcedBlockIds:d,excludedBlockIds:p}=e,{query:u,limit:m,debug:g}=t;return o?{type:T.n8.BlocksInSpace,query:u.text.trim(),spaceId:o,limit:m,filters:u.filters,sort:u.sort,source:a||"quick_find",debug:g,searchExperimentOverrides:l,searchSessionId:r,searchSessionFlowNumber:i,forcedClusterPattern:s,recentPagesForBoosting:(0,pe.Wk)(c),forcedBlockIds:d,excludedBlockIds:p}:n?{type:T.n8.BlocksInAncestor,query:u.text.trim(),ancestorId:n,filters:u.filters,sort:u.sort,limit:m,source:a||"quick_find_public",debug:g,searchExperimentOverrides:l,searchSessionId:r,searchSessionFlowNumber:i,forcedClusterPattern:s,forcedBlockIds:d,excludedBlockIds:p}:void 0}function Te(e){const{environment:t}=e,o=Ce(e);return!!o&&P.search(t,o)}class Me{constructor(e){this.startingTimestamp=void 0,this.endingTimestamp=void 0,this.startingTimestamp=e.starting&&f.uO(e.starting,(0,v.r)()),this.endingTimestamp=e.ending&&f.uO(e.ending,(0,v.r)())}matches(e){return void 0!==e&&(!(void 0!==this.startingTimestamp&&e<this.startingTimestamp)&&!(void 0!==this.endingTimestamp&&e>this.endingTimestamp))}}class Pe{constructor(e){this.filters=void 0,this.activeFilters=void 0,this.ancestorFilterIds=void 0,this.parentFilterId=void 0,this.createdTimeMatcher=void 0,this.lastEditedTimeMatcher=void 0,this.teamFilterIds=void 0,this.dev_notInTeamFilterIds=void 0,this.dev_notInPagesFilterIds=void 0,this.filters=e,this.activeFilters=ve(e),this.ancestorFilterIds=new Set(e.ancestors),this.parentFilterId=e.parentId,this.createdTimeMatcher=new Me(e.createdTime),this.lastEditedTimeMatcher=new Me(e.lastEditedTime),this.teamFilterIds=new Set(T.iY(e.inTeams)??[]),this.dev_notInTeamFilterIds=new Set(e.dev_excludedTeams),this.dev_notInPagesFilterIds=new Set(e.dev_excludedPages)}matches(e){let{blockModel:t,path:o}=e;if(!Boolean(this.activeFilters.isDeletedOnly)!==t.alive)return!1;if(this.activeFilters.excludeTemplates&&t.is_template)return!1;if(this.activeFilters.editedBy){const e=t.last_edited_by_id||t.last_edited_by;if(!e||!this.filters.editedBy.includes(e))return!1}if(this.activeFilters.createdBy){const e=t.created_by_id||t.created_by;if(!e||!this.filters.createdBy.includes(e))return!1}if(this.activeFilters.ancestors&&!o.some((e=>{let{value:t}=e;return this.ancestorFilterIds.has(t.id)})))return!1;if(this.activeFilters.parentId){if(o.length<2)return!1;const[e,{value:{id:t}}]=o;return this.parentFilterId===t}if(this.activeFilters.lastEditedTime&&!this.lastEditedTimeMatcher.matches(t.last_edited_time))return!1;if(this.activeFilters.createdTime&&!this.createdTimeMatcher.matches(t.created_time))return!1;if(this.activeFilters.inTeams){var n;const e=ce.KU(o),t=null==e||null===(n=e.value)||void 0===n?void 0:n.id;if(!t||!this.teamFilterIds.has(t))return!1}return!0}}async function Ae(e){const{environment:t,currentSpaceStore:o,currentSpaceViewStore:r,excludeCurrentPage:s}=e,{id:l}=o,c=new Map,d=new Set;function p(e,t){var o;c.has(e)?null===(o=c.get(e))||void 0===o||o.add(t):c.set(e,new Set([t]))}const u=new Map,g=(new Date).getTime();if(r)for(const n of r.getBookmarkedPageIds())p(n,"bookmarkedPage");const h=te.Z.get(l);h&&h.forEach(((e,t)=>{let{pageId:o,visitedAt:n}=e;p(o,"recentVisit"),d.add(o),u.set(o,{index:t,timeSinceLastViewed:g-n})}));const f=(0,ue.ns)(t,o);for(const n of f)p(n,"spacePage");const y=(0,me.xo)();for(const n of y)p(n,"teamPage");const v=t.currentUser.id;if(r){for(const{id:o}of(0,ue.KA)(t,r))p(o,"sharedPage");const e=g-432e5;t.defaultRecordCache.inMemoryRecordCache.forEachRecord(v,(t=>{let{model:r}=t;if(r.table===a.iU&&l===o.id){const{id:t,last_edited_time:o,last_edited_by_id:i,type:a}=r;(0,n.S9)(a)&&i===v&&o&&o>e&&(p(t,"defaultRecordCache"),d.add(t))}}))}const w=D.Z.getVisitedIds(v);for(const n of w)p(n,"frecencyStore"),d.add(n);const T=v?K.default.getEligibleGroup({experimentId:"search-new-local-recall-v1"}):void 0,M="on"===K.default.getEligibleGroup({experimentId:"search-no-local-recent-records-invalidations"}),P=Boolean(T&&"control"!==T||M);if(T){const e=B.default.getUserSignals({spaceId:l,userId:v});var A;if("sim_user_visits"===T)null==e||null===(A=e.similarUserRecentPages)||void 0===A||A.pagesMetadata.forEach(((e,t)=>{p(t,"similarUser1dRecentPages"),d.add(t)}));else if("popular_pages"===T){var R;null==e||null===(R=e.topPages7dPageView)||void 0===R||R.forEach(((e,t)=>{p(t,"topPages7dPageView"),d.add(t)}))}else if("user_edits"===T){var E;null==e||null===(E=e.editedPages1d)||void 0===E||E.forEach(((e,t)=>{p(t,"editedPages1d"),d.add(t)}))}else if("sim_user_edits"===T){var F;null==e||null===(F=e.similarUsersEditedPages1d)||void 0===F||F.forEach(((e,t)=>{p(t,"similarUsersEditedPages1d"),d.add(t)}))}}if(s){const e=(0,ae.np)();e&&c.delete(e.id)}const N=I.PF.create();await(0,C.uf)({recordPointers:Array.from(c.keys()).map((e=>({table:a.iU,id:e}))),recordMap:N,loadRecordModel:e=>(0,le.Ye)({environment:t,pointer:e}),recurFn:e=>b.oA([(0,k.tz)(e)&&e.getParentPointer(),e.table===a.iU&&e.getCollectionPointer()])});const j=x.mF.fromRecordMapWithRole(N),O=new Array;for(const[n,b]of c.entries()){const e={table:a.iU,id:n};let t,r;if(P&&d.has(n))t=oe.t1.createChildStore(o,e),r=t.getModel();else{const t=j(e);r=t?i.kk.fromValue(a.iU,t):void 0}if(!r)continue;const s=(0,_.Wq)(e,N);if(0===s.length)continue;if(r.getSpaceId()!==o.id)continue;const l=(0,S.$B)(m({blockValue:r,getRecordValue:j}).text);if(!l)continue;if(!b)continue;const c=ce.KU(s);if(c&&Boolean(c.value.archived_by))continue;const p=l.substring(0,1e3).trim(),g=u.get(n);O.push({blockModel:r,text:p,path:s,source:b,indexInRecentPages:g?g.index:void 0,timeSinceLastViewedMs:g?g.timeSinceLastViewed:void 0,blockStore:t})}return{spaceId:o.id,blocks:O,recordMap:N}}function De(e){if(e&&!e.error)return e.value}function Be(e){let{sort:t,unsorted:o,batchSize:n,currentUserId:r}=e;const i=Date.now();if("relevance"!==t.field)return o;const a=b.yo(o,n).map((e=>D.Z.sortFrecencyHighToLow({items:e,now:i,currentUserId:r,recordFrecency:!0})));return b.xH(a)}function Re(e){const{localResults:t,serverResults:o}=e;if(t||o){if(t&&o){const e=new Set(t.map((e=>e.id)));function n(e){return(null==e?void 0:e.sources)??[]}return t.map((e=>{const t=(r=e.id,null==o?void 0:o.find((e=>e.id===r)));var r;const i=(null==(a=t)?void 0:a.originalPosition)??e.originalPosition;var a;const s=[...new Set([...e.badges??[],...(null==t?void 0:t.badges)??[]])];return{...e,originalPosition:i,serverEventProperties:(null==t?void 0:t.serverEventProperties)??e.serverEventProperties,sources:[...e.sources,...n(t)],badges:s}})).concat(o.filter((t=>!e.has(t.id))))}return t??o}}function Ee(e){var t,o,n;const{globalFocusedIndexStore:r,searchActionsStore:i,searchResultStore:a}=e,s=Re({localResults:null===(t=a.state.localResults)||void 0===t?void 0:t.results,serverResults:null===(o=a.state.serverResults)||void 0===o?void 0:o.results}),l=r.state;if(void 0===l)return;const c=i.state.length,d=l<c&&i.state[l];if(d&&"assistant"===d.type)return{type:d.type};const p=l-c;if(!s||s.length<=0||p<0)return;const u=null===(n=s[p])||void 0===n?void 0:n.store;return u?{type:"page_result",value:u}:void 0}function Fe(e){const{existingResults:t,newPageResults:o}=e;if(void 0!==t||void 0!==o){if(t&&o){const e=[...t.results],n=new Set(t.results.map((e=>e.id)));return e.push(...o.results.filter((e=>!(e.sources.includes(T.vp.ElasticsearchRandom)&&e.originalPosition<t.results.length)&&!n.has(e.id)))),{...o,results:e,total:o.total}}return t??o}}function Ne(e){const{intentBasedGrouping:t,localResults:o,serverResults:n}=e,r=Re({localResults:o,serverResults:n})??[],i=r.filter((e=>e.sources.includes(T.vp.ElasticsearchUniqueID))),a=r.filter((e=>!e.sources.includes(T.vp.ElasticsearchUniqueID)));return t?{type:"intent-based-grouping",sections:{uniqueIdSearchResults:i,jumpBackInSearchResults:a.filter((e=>e.sources.includes(T.vp.Local))),serverOnlySearchResults:a.filter((e=>!e.sources.includes(T.vp.Local)))},allSearchResults:r}:i.length>0?{type:"unique-id",sections:{uniqueIdSearchResults:i,nonUniqueIdSearchResults:a},allSearchResults:r}:{type:"all",sections:{allSearchResults:r},allSearchResults:r}}function je(e,t,o){const n=o??(e.device.isMobile?2:3);return t.slice(0,n)}function Oe(e){const{mainEditorCurrentBlockStore:t}=A.default.state,o=t&&de.IJ(e,t);return{hasPublicAccessPermission:Boolean(o),publicAccessPermissionAncestorBlockId:(null==o?void 0:o.from.table)===a.iU?null==o?void 0:o.from.blockId:void 0}}function Le(e){let{environment:t,searchResultsSection:o,modalBodyMenu:n,searchFilterMenu:r}=e;if(!o)return 0;let i=0;if(t.device.isMobile){const e=null==n?void 0:n.getNode(),t=null==r?void 0:r.getNode();if(e instanceof Element&&t instanceof Element){const o=e.getElementsByClassName(se.GZn)[0];o instanceof Element&&(i=o.clientHeight-t.clientHeight+o.scrollTop)}}else i=o.getBoundingClientRect().height+o.scrollTop;let a=0,s=0;const l=o.getElementsByClassName(se.ulv);for(let c=0;c<l.length;c++){const e=l[c];if(!(i-s>e.clientHeight/2))return a;a+=1,s+=e.clientHeight}return a}function Ue(e){if(void 0===e)return[];return e.map((e=>({id:e.id,score:e.score,sources:e.sources,spaceId:e.spaceId})))}function Ze(e,t){let{source:o,indexInRecentPages:n,timeSinceLastViewedMs:r}=t;return{...e,personalizationBoost:function(e){return e.has("recentVisit")||e.has("frecencyStore")||e.has("bookmarkedPage")||e.has("defaultRecordCache")?1.25:e.has("teamPage")?1.1:1}(o),localSource:o,indexInRecentPages:n,timeSinceLastViewedMs:r}}function Ve(e){let{query:t,localCachedPages:o,userId:n,includeRecordMap:r,environment:i,applyRecallScoreThreshold:a,canUseLtr:s}=e;const l=o.blocks,{query:c,limit:d}=t,{filters:p,sort:u}=c,m=r??!0,g=new Pe(p);let h=function(e,t,o){const n=t.text.trim(),r=(0,w.nv)(n);return b.oA(e.map((e=>{let t;if(t=r.includes(e.blockModel.id)?{rendered:"",score:y.$r,matchMetadata:{isExactIdMatch:!0}}:(0,y.C6)(n,e.text,{pre:T.Um,post:T.dK,ignoreFuzzyFallback:o}),t)return{...e,relevanceResult:Ze(t,e)}})))}(l.filter((e=>g.matches(e))),c,a);if(a&&(h=h.filter((e=>e.relevanceResult.score>=y.T6))),0===h.length)return;const f=function(e,t){const{field:o}=e,n="relevance"===o||"desc"===e.direction?-1:1;switch(o){case"lastEdited":case"scroll":return b.MR(t,(e=>{let{blockModel:t}=e;return n*(t.last_edited_time||0)}));case"created":return b.MR(t,(e=>{let{blockModel:t}=e;return n*(t.created_time||0)}));default:return b.MR(t,(e=>{let{relevanceResult:t}=e;return n*t.score}))}}(u,h);s&&(0,ie.j)(i,"search_local_recall_results",{num_visible_members:(0,re.qX)(),results:f.map((e=>({id:e.blockModel.id,localSource:[...e.relevanceResult.localSource]})))});const v=f;let S;if("relevance"!==u.field)S=We({results:v});else if(t.query.text.length>1&&s){S=ee({sort:u,unsorted:We({results:v,featureExtractor:new G([z,W],i,v)}),currentUserId:n})}else S=Be({sort:u,currentUserId:n,unsorted:We({results:v}),batchSize:$.Xv});return S=S.slice(0,d),{total:h.length,results:S,recordMap:m?o.recordMap.toJson({allowVersionDowngrade:!1}):{},trackEventProperties:{}}}function qe(e){let{query:t,localCachedPages:o,parentStore:n,isOnline:r,environment:i,shouldLimitLocalResultsWhenOnline:s,applyScoreThresholdWhenOnline:l,maxLocalResultsOverride:c,canUseLtr:d}=e;const p=Ve({query:t,localCachedPages:o,userId:i.currentUser.id,environment:i,applyRecallScoreThreshold:r&&l,canUseLtr:d});if(!p)return;if(0===p.results.length)return{error:T.Ix.NoResults};let u=p.results.map(((e,t)=>({...e,originalPosition:t,store:ne.G.createChildStore(n,{table:a.iU,id:e.id}),serverEventProperties:void 0})));const m=u.length;return r&&s&&(u=je(i,u,c)),0===u.length?{error:T.Ix.NoResults}:{value:{total:m,results:u,debugInfo:void 0}}}function ze(e){var t;if(void 0!==(null==e?void 0:e.highlightBlockId)&&void 0===(null===(t=e.highlight)||void 0===t?void 0:t.title))return e.highlightBlockId}function We(e){const{results:t,featureExtractor:o}=e;return t.map((e=>({id:e.blockModel.id,score:e.relevanceResult.score,localSource:e.relevanceResult.localSource,indexInRecentPages:e.relevanceResult.indexInRecentPages,timeSinceLastViewedMs:e.relevanceResult.timeSinceLastViewedMs,personalizationBoost:e.relevanceResult.personalizationBoost,highlight:{text:e.relevanceResult.rendered},spaceId:e.blockModel.space_id,sources:[T.vp.Local],featureGroups:(null==o?void 0:o.extractFeatureGroup(e))||[]})))}},69645:(e,t,o)=>{o.d(t,{Bj:()=>f,D_:()=>b,Ib:()=>h,dq:()=>y,kC:()=>v,v5:()=>g});o(57658);var n=o(55010),r=o(45060),i=o(21202),a=o(95371),s=o(374),l=o(97880),c=o(94419),d=o(95802),p=o(27724),u=o(28020),m=o(62619);function g(e,t){return(0,a.DY)(t,(t=>t.value.store===e))}function h(e,t){const o=g(e,[t]);if(o&&o.length>0)return o[o.length-1]}function f(e){const t=e.container??p.default.getCurrentDefaultContainer();if(!t)return new a.DG([]);const o=[];d.C.forEach((n=>{const r=n.getNode(),i=n.props.store;if(!r)return;if(n.getContextSelectableContainer()!==t)return;(n.props.canSelect||e.includeNonSelectableListContainer&&n.props.isListContainer)&&o.push({node:r,store:i,component:n})}));var r;return(r=o,(0,a.Yc)({values:r,compareOrder:(e,t)=>(0,n.Z)(e.node,t.node),isAncestor:(e,t)=>m.r3(e.node,t.node)}))||new a.DG([])}function y(e){const t=e.root||(0,u.RM)();if(t){const o=f(e);return new a.mp({store:t,node:void 0,component:void 0},o.children)}}function v(e){const{rootStore:t,root:o,target:n}=e,r=(0,a.DY)(o.children,(e=>e===n));if(void 0===r)return;const i=[t];let s=t;for(const a of r){const e=a.value.store;if(!e)return;const t=s.getTransclusionReferenceTargetStore()??s;let o=t.getContentStores();const n=t.getAutomationStore();if(n){const e=n.getActionStores();o=o.concat(e.flatMap((e=>e.getBlockStores())))}const r=o.find((t=>t.id===e.id));if(!r)return;i.push(r),s=r}return i}function b(e){const{transaction:t,treeOperation:o,deleteFrom:n,observer:r}=e;switch(o.operation){case"delete":{var a;const e=null===(a=o.deleteFromParent.value.store)||void 0===a?void 0:a.getContentStore(),s=o.deletingChildren.map((e=>e.value.store)).filter(l.$K);for(const a of s){const s=a.getRecordStoreUIParent(),l=s&&s.table===i.iU&&1===s.path.length&&"content"===s.path[0]&&s,d="record-store-parent"===n&&l||e;if(d){const e={parent:d,childToRemove:a,transaction:t};c.Od(e),null==r||r.onRemove(o,e)}}return}case"insert":{var d,p;const e=null===(d=o.insertIntoParent.value.store)||void 0===d?void 0:d.getContentStore(),n=null===(p=o.adjacentSibling)||void 0===p?void 0:p.value.store,r=o.insertChildren.map((e=>e.value.store));("listAfter"===o.direction&&n||"listBefore"===o.direction&&!n)&&r.reverse();for(const i of r)if(e&&i)if("listAfter"===o.direction){const o={insert:i,parent:e,transaction:t,after:n};c.BE(o)}else{const o={insert:i,parent:e,transaction:t,before:n};c.Vt(o)}return}case"move":for(const e of(0,s.Z)(o))b({transaction:t,treeOperation:e,deleteFrom:n,observer:void 0});return void(null==r||r.onMove(o));default:(0,l.t1)(o)}}!function(){const{span:e,object:t,div:o,CONTAINER_STYLE:n}=r.TI;(0,r.Rw)({canFormat:e=>Boolean(e&&e instanceof a.mp),header:(r,i)=>e(n,e({},t(r,{useDefaultFormatter:!0})),o({},t(r.value.store)),r.children.length?o({},t(r.children)):void 0),hasBody:(e,t)=>!1,body:e=>null})}()},73959:(e,t,o)=>{o.d(t,{J2:()=>m,Mn:()=>p,iZ:()=>f,mh:()=>g,sQ:()=>u,sY:()=>y,x7:()=>h});var n=o(41432),r=o(41662),i=o(80444),a=o(55367),s=o(88923),l=o(35661),c=o(27724),d=o(98165);function p(e){return!e.isPhone}function u(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t&&e instanceof l.G)return e;let o=e;for(;;){if(o=o.getRecordStoreUIParent(),!o)return;if(o&&o instanceof l.G&&o!==e)return o}}function m(e){const t=u(e);if(t)return d.Dg(t)}function g(e){const t=e.getType(),o=e.getModel(),i=e.getProperties();if(t&&o)return t&&(0,n.XD)(t)&&"factory"!==t&&!(0,n.S9)(t)?e.getBlockTitleStore():o.isInlineCollectionView()?e.getTitleStore():o.isType(n.oe)&&i&&i.caption?e.getCaptionStore():t===n.Ti.table?r.g$.getCellTextStore({simpleTableStore:e,rowIndex:0,columnIndex:0}):void 0}function h(e){const t=u(e);if(t)return t&&(t===i.default.state.mainEditorCurrentBlockStore||s.default.state.open&&t===s.default.state.target)}function f(e){const{stores:t,phase:o}=c.default.state;return 1===t.length&&t[0]===e&&o===c.SelectionPhase.Editing}function y(e){const{stores:t,phase:o}=c.default.state,n=new Set(t.map((e=>e.id))),r=d.qA(e),i=n.has(e.id),s=r.some((e=>n.has(e.id))),l=i||s;return!(o!==c.SelectionPhase.Selected||!l||a.ZP.state.isDragging)}},89014:(e,t,o)=>{o.d(t,{u:()=>i,x:()=>r});const n=new Map;function r(e){return n.get(e)}function i(e,t){n.set(e,t)}},41984:(e,t,o)=>{o.d(t,{Z:()=>r});var n=o(6287);const r=function(e){return!(e.getParentTable()===n.v)||e.isTemplate()}},28187:(e,t,o)=>{o.d(t,{F6:()=>m,Jk:()=>d,SG:()=>u,kC:()=>g});o(57658);var n=o(77657),r=o(63787),i=o(90965),a=(o(95477),o(80444)),s=o(77080),l=o(35661),c=o(98165);const d=function(e){const t=c.qA(e),o=[];for(const n of t)"block"===n.table&&o.push({blockStore:n,slackIntegrationStore:(0,l.Kv)(e,{table:r.s,id:n.id})});for(const{blockStore:n,slackIntegrationStore:r}of o)if(r.isReady()){if(r.getKeyStore("enabled").getValue())return{blockStore:n,slackIntegrationStore:r}}return{blockStore:e,slackIntegrationStore:(0,l.Kv)(e,{table:r.s,id:e.id})}};function p(){var e;const t=null===(e=a.default.state.currentSpaceStore)||void 0===e?void 0:e.getBotSettingsStore().getValue();return(0,i.hU)({spaceBotSettings:t,integrationId:n.nO,env:"production"})}function u(){return s.default.checkGate("legacy_slack_notifications")}function m(){return!!p()&&"on"===s.default.getGroup("notion-to-slack")}function g(){return!!p()&&"on"===s.default.getGroup("notion-mentions-to-slack")}},38755:(e,t,o)=>{o.d(t,{C:()=>se,CV:()=>oe,Cx:()=>te,Fn:()=>ae,G$:()=>U,Ib:()=>pe,KA:()=>W,MC:()=>V,Q6:()=>ge,Q9:()=>ce,TC:()=>ie,Wd:()=>G,XD:()=>Q,cD:()=>ue,cJ:()=>J,di:()=>ne,g4:()=>ee,iX:()=>H,j9:()=>le,jv:()=>$,k0:()=>q,kt:()=>me,lQ:()=>re,ns:()=>Y,rg:()=>L,rn:()=>K,w3:()=>X,ww:()=>de});o(21703);var n=o(14577),r=o(15145),i=o(44317),a=o(72126),s=o(62193),l=o(21202),c=o(15047),d=o(77858),p=o(19889),u=o(66079),m=o(28182),g=o(9852),h=o(90965),f=o(97880),y=o(3297),v=o(94273),b=o(40277),S=o(12321),_=o(65452),w=o(95477),k=o(94841),x=o(88310),I=o(80444),C=o(92425),T=o(77080),M=o(81236),P=o(35661),A=o(13105),D=o(29226),B=o(88893),R=o(84210),E=o(33929),F=o(98165),N=o(67669),j=o(65598),O=o(95697);async function L(e,t){return(await async function(e,t){const o=e.currentUser.id,n=t.getSpaceStore();if(await t.load(),n&&o){var r;t.hasRemoteSharedPages()||await _.l({environment:e,spaceId:n.id,userId:o});const i=C.Z.getSharedPagesState({spaceId:n.id,userId:o}),a=(i&&i.currentPageIds?i.currentPageIds:[]).map((e=>P.G.createChildStore(n,{table:l.iU,id:e,spaceId:n.id})));await Promise.all([n.load(),Promise.all(t.getBookmarkedPageStores().map((e=>e.load()))),Promise.all(Q(e,n).map((e=>e.load()))),Promise.all(t.getSharedPageStores().map((e=>e.load()))),Promise.all(a.map((e=>e.load())))]);return[...t.getBookmarkedPages(),...t.getWorkspacePages(),...W(e,t),...t.getPrivatePages(e),...(null===(r=t.getTeamsStores())||void 0===r||null===(r=r[0])||void 0===r?void 0:r.getTeamPageStores())||[],...a].filter((t=>!(0,N.IJ)(e,t)))}}(e,t)??[])[0]}const U=7,Z=new s.Uw;function V(e){return Z.memo((()=>new n.Z((()=>q(e)),{debugName:"sharedPageContextStore"})),[e.environment,e.spaceViewStore,e.userSettingsStore])}function q(e){const{environment:t,spaceViewStore:o,userSettingsStore:n}=e,r=o.getSpaceId(),i=W(t,o),a=new Set(i.map((e=>{let{id:t}=e;return t})));if(!r)return{allSharedPagesStores:i,visibleSharedPagesStores:i};if(!n.hasUserPinnedToOutliner({type:"shared",spaceId:r}))return{allSharedPagesStores:i,visibleSharedPagesStores:i.slice(0,U)};return{allSharedPagesStores:i,visibleSharedPagesStores:o.getPinnedSharedPages().filter((e=>{let{id:t}=e;return a.has(t)}))}}const z=new s.Uw;function W(e,t){const o=e.currentUser.id,n=t.getSpaceStore();if(n&&o){const r=C.Z.getSharedPagesState({spaceId:n.id,userId:o}),i=r&&r.currentPageIds?r.currentPageIds:[],s=z.memo((()=>function(e,t){return new A.P({debugName:"isValidSharedRemotePage",memoizeRecursion:!1,deepEquals:!1,compute:function(o){if(!e.currentUser.id)return!1;const n=(0,F.u3)(o);let r=!1;return n&&((0,j.OY)(n)?r=!(0,O.bq)()&&e.currentUser.id&&t.isDefined()&&o.hasSpacePermission()?(0,h.kC)(t.getPermissionItems(),e.currentUser.id):n.id!==o.id&&n.canRead():(0,j.Y)(n)&&(r=(0,O.zz)({teamStore:n,spaceStore:t,userId:e.currentUser.id})&&n.canRead())),!(!((0,j.Oh)(o)&&o.canRead()&&o.isNavigableBlock()&&o.isSharedPage(t,e))||(0,F.wf)(o)||r)}})}(e,n)),[e,n]),c=a.oA(i.map((e=>{const t=P.G.createChildStore(n.getPagesStore(),{table:l.iU,id:e,spaceId:n.id});if(s.getStateFor(t))return t}))),d=new Set(c.map((e=>e.id)));let p;const u=t.getSharedPageStores(),m=0===u.length;if(m){p=Q(e,n).filter((e=>{d.has(e.id)}))}else p=u.filter((e=>!(0,F.wf)(e)&&d.has(e.id)));(0,x.As)({use_legacy_shared_pages_ordering:m&&p.length>0});const g=[...p,...c];return a.mN(g,(e=>e.id))}return[]}async function H(e){const{disableRedirectUrl:t,environment:o}=e;await S.w();const{id:n}=o.currentUser,{url:i,spaceId:s,route:l}=await v.Ie(o),c=s?X(s):void 0,d=function(e){const{environment:t,lastVisitedUrl:o,lastVisitedSpaceView:n}=e,i=ee(t,n);switch(i){case"last_visited_page":return o?{url:o,isPersonalHomeUrl:!1}:void 0;case"first_page":return;case"personal_home":if(!n)return;const e=k.Al(n);if(!e)return;return{url:(0,R.ZP)({store:e,preferPublicLink:!1,pageVisitSource:r.tY.DefaultHome}),isPersonalHomeUrl:!0};default:(0,f.t1)(i)}}({environment:o,lastVisitedUrl:i,lastVisitedSpaceView:c}),h=null==d?void 0:d.url,_=y.qd(n),w=b.th(n),x=g.getOauthAuthorizationParams();if(!n)throw new Error("User not logged in.");const I=new P.U6(o,{table:p.KJ,id:n}),C=new P.r9(o,{table:u.dx,id:n}),T=new P.vO(o,{table:m.Sr,id:n}),[M,A]=await Promise.all([I.awaitNonNullValue(),C.awaitNonNullValue(),T.awaitNonNullValue()]),D=!!M&&Boolean(M.onboarding_completed),B=!!M&&Boolean(M.mobile_onboarding_completed),E=function(e,t){const o=(0,u.ao)(e);return o&&o.length>0?P.V9.createChildStore(t,o[0]):void 0}(A,C);E&&await E.load();const F=E?E.getSpaceStore():void 0;if(l&&!t){const e=await b.Jv({environment:o,request:{type:"block-space",...l}}).next();if(e.value){const t=e.value,o="page"===l.name?l.blockId:void 0,n=["read_and_write","comment_only","reader"].includes(t.publicAccessRole);if(t&&!a.xb(t)&&(t.canJoinSpace||t.userHasExplicitAccess||!n))return{userStore:I,userSettingsStore:T,userRootStore:C,firstSpace:F,firstSpaceView:E,lastVisitedSpaceView:c,redirectUrl:h,forkPageBlockId:_,publicAccessPageId:w,oauthAuthorizationParams:x,redirectPageId:o,hasExplicitAccessToRedirectPage:t.userHasExplicitAccess,redirectSpaceName:t.spaceName,redirectSpaceId:t.spaceId,canJoinRedirectSpace:t.canJoinSpace,onboardingCompleted:D,mobileOnboardingCompleted:B,isPersonalHomeRedirect:(null==d?void 0:d.isPersonalHomeUrl)??!1}}}return{userStore:I,userSettingsStore:T,userRootStore:C,firstSpace:F,firstSpaceView:E,lastVisitedSpaceView:c,forkPageBlockId:_,publicAccessPageId:w,oauthAuthorizationParams:x,redirectUrl:void 0,redirectPageId:void 0,hasExplicitAccessToRedirectPage:void 0,redirectSpaceId:void 0,canJoinRedirectSpace:void 0,onboardingCompleted:D,mobileOnboardingCompleted:B,redirectSpaceName:void 0,isPersonalHomeRedirect:!1}}function G(e,t){return P.t1.fromV1(t).getIcon()}function K(e,t){const o=t.getName(),n=E.default.getIntl().formatMessage({defaultMessage:"Untitled workspace",id:"spaceHelpers.getSpaceName.untitledWorkspace.name"});if(o)return o||n;{const o=M.Z.getPublicSpaceData(e,t.id);if(o)return o.name||n}return n}function $(e){return function(e){return(0,P.Vh)(e,{table:c.bx,id:e.id},"permissions")}(e).getValue()||[]}function Y(e,t){const o=e.currentUser.id,n=t.getPagesStore().getValue();if(n&&o){const e=D.Z.getSpaceInaccessiblePages(t.id,o);return e?n.filter((t=>!e.has(t))):n}return[]}function Q(e,t){const o=t.getPagesStore();return Y(e,t).map((e=>P.G.createChildStore(o,{table:l.iU,id:e})))}function J(e,t,o){const n=M.Z.getPublicSpaceData(e,t),r=!Boolean(null==n?void 0:n.domainIsAutogenerated),i=a.oA([r&&(null==n?void 0:n.domain),"invite",o]).join("/");return`${w.default.domainBaseUrl}/${i}`}function X(e){const{currentUserRootStore:t}=I.default.state;return null==t?void 0:t.getSpaceViewStores().find((t=>t.getSpaceId()===e))}function ee(e,t){var o,n;if(null!==(o=e.mobileNative)&&void 0!==o&&o.supportsNativeHomeOnPhone())return"last_visited_page";const r=(null==t||null===(n=t.getSettings())||void 0===n?void 0:n.on_app_start)||d.DB[0];return(0,O.QI)("dev_or_beta")||"personal_home"!==r?r:"first_page"}function te(e){return!!e&&!e.canRead()}function oe(e){return!!e&&e.getZeroRetentionEnabled()}function ne(e,t){const o=(0,B.CM)(t)||[],n=e.currentUser.id;for(const r of o)if(r.userId===n&&"none"===r.role&&r.isTeamGuest)return!0;return!1}function re(e){return!!e&&e.canAdmin()}function ie(e){let{spaceStore:t,groupId:o}=e;return((null==t?void 0:t.getPermissionGroups())||[]).find((e=>e.id===o))}function ae(e){const t=I.default.state.currentSpaceStore,o=e.currentUser.id;return!(null==t||!t.isDefined()||!o)&&(0,h.wv)({permissions:t.getPermissionItems()},o)}function se(){const e=I.default.state.currentSpaceStore;return!(null==e||!e.isDefined())&&"enterprise"===e.getSubscriptionTier()}function le(e){const t=e.getSubscriptionTier();return"plus"===t||"business"===t||"enterprise"===t}function ce(e){const t=function(e){const t=null==e?void 0:e.getCreatedTime();return t?(0,i.O5)(t):null}(e);return null!==t&&t<=7}function de(e){return(0,f.lm)(e)&&"none"!==e.role?e.planType:void 0}function pe(e){return(0,f.lm)(e)&&"none"!==e.role?e.createdTime:void 0}function ue(e){return(0,f.lm)(e)&&"none"!==e.role?e.subscriptionTier:void 0}function me(e){return T.default.checkGate("guest_invite_requests")&&(null==e?void 0:e.getEnableGuestInviteRequest())}function ge(e){return Boolean(me(e))&&!Boolean(null==e?void 0:e.canAdmin())}},16639:(e,t,o)=>{o.d(t,{N5:()=>u,kF:()=>c,kQ:()=>d,rm:()=>p});var n=o(72126),r=o(27006),i=o(19889),a=o(5366),s=o(20454);const l=(0,a.defineMessages)({untitledGroupName:{defaultMessage:"Untitled",id:"spaceBasicSettings.spacePermissionsSettings.groupsTab.defaultNewGroupName"}});function c(e){const{intl:t,group:o}=e;return o.name||t.formatMessage(l.untitledGroupName)}function d(e){const{group:t,spaceStore:o}=e,n=t.user_ids||[];if(!o)return[];const r=o.getPermissionItems();return n.filter((e=>Boolean(r.find((t=>"user_permission"===t.type&&t.user_id===e)))))}function p(e){const{group:t,spaceStore:o,limit:r}=e,a=d({group:t,spaceStore:o}),l=a.length;if(!o)return{countRemainingUsers:0,totalNumberMembers:l,limitedUserStores:[]};const c=r?a.slice(0,r):a;return{limitedUserStores:n.oA(a.map((e=>s.U.createChildStore(o,{table:i.KJ,id:e})))),countRemainingUsers:a.length-c.length,totalNumberMembers:l}}function u(e){let{userStores:t,spaceStore:o,intl:i}=e;return n.MR(t,(e=>e.getSearchName(i))).sort(((e,t)=>{var n,i;if(!o)return 0;const a=o.getPermissionItems(),s=null===(n=a.find((t=>"user_permission"===t.type&&t.user_id===e.id)))||void 0===n?void 0:n.role,l=null===(i=a.find((e=>"user_permission"===e.type&&e.user_id===t.id)))||void 0===i?void 0:i.role;return s&&l?r.Av.indexOf(l)-r.Av.indexOf(s):0}))}},15517:(e,t,o)=>{o.d(t,{ZL:()=>p,lr:()=>l,mn:()=>d,sK:()=>s});var n=o(68626),r=o(15157),i=o(63143),a=o(61738);async function s(){if("storage"in navigator&&"estimate"in navigator.storage){const{quota:e,usage:t}=await navigator.storage.estimate();if("number"==typeof e&&"number"==typeof t)return{quota:e,usage:t}}if("webkitPersistentStorage"in navigator){const e=navigator.webkitPersistentStorage;if("queryUsageAndQuota"in e)return new Promise((t=>{e.queryUsageAndQuota(((e,o)=>{t("number"==typeof o&&"number"==typeof e?{usage:e,quota:o}:void 0)}),(()=>t(void 0)))}))}}async function l(){if(navigator.storage&&navigator.storage.persist)try{const e=await navigator.storage.persist();return n.clientLogglyEnvironmentData.isPersistent=e,e}catch(e){console.trace("Persistence is disabled",e)}}const c=15*i.js;function d(e){const{quota:t,usage:o}=e;return o/t<=.9&&t>=c}function p(e){e?(a.Z.clearForUser(e),r.Z.clearStorageForUser(e)):localStorage.clear()}},75024:(e,t,o)=>{o.d(t,{Dp:()=>s,jy:()=>d,mK:()=>i,pd:()=>l,wK:()=>c,yv:()=>a});var n=o(97880),r=o(82990);const i={listStyleType:"none",padding:0,margin:0};r.Z.fontWeight.regular;function a(e,t){const o="UIRegular"===t?r.Z.fontSize.UIRegular:"UISmall"===t?r.Z.fontSize.UISmall:(0,n.t1)(t);return e.device.isMobile?o.mobile:o.desktop}function s(e,t){const o="UIRegular"===t?r.Z.lineHeight.UIRegular:"UISmall"===t?r.Z.lineHeight.UISmall:(0,n.t1)(t);return e.device.isMobile?o.mobile:o.desktop}function l(e){return{display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical",WebkitLineClamp:e}}function c(e){let{topLeft:t,topRight:o,bottomLeft:n,bottomRight:r}=e;return[t,o,r,n].map((e=>e?`${e}px`:"0")).join(" ")}const d={position:"absolute",overflow:"hidden",clip:"rect(1px, 1px, 1px, 1px)",whiteSpace:"nowrap",height:1,width:1}},52315:(e,t,o)=>{o.d(t,{b:()=>n,r:()=>r});const n=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.isReady())return!1;if(o[e.id])return!0;if(o[e.id]=!0,i(e,t))return!0;const r=e.getContentStores();let a=!0;for(const i of r)n(i,!1,o)||(a=!1);return a};async function r(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(await e.load(),o[e.id])return;if(o[e.id]=!0,i(e,t))return;const n=e.getContentStores();await Promise.all(n.map((e=>r(e,!1,o))))}function i(e,t){return!(!e.isPageBlock()||t)||!!e.isCollectionView()}},32363:(e,t,o)=>{o.d(t,{ni:()=>p,wY:()=>c});o(67294);var n=o(5366),r=o(97880),i=o(44876),a=o(30874),s=o(33929),l=o(85893);function c(e,t){const o=function(e,t){if(!e)return;const o=(0,i.ny)({url:e,integrations:a.Z.integrations.state,currentSpaceId:t});if("success"!==o.type)return;return o.integration.name}(e),s=function(e,t){if(!e)return;const o=(0,i.ny)({url:e,integrations:a.Z.integrations.state,currentSpaceId:t});if("success"!==o.type)return;if(!o.pattern.collectionItemType)return;switch(o.pattern.collectionItemType){case"project":return(0,l.jsx)(n.FormattedMessage,{defaultMessage:"Project",id:"syncedCollectionIndicators.project.label"});case"pull_request":return(0,l.jsx)(n.FormattedMessage,{defaultMessage:"Pull Requests",id:"syncedCollectionIndicators.pullRequests.label"});case"issue":return(0,l.jsx)(n.FormattedMessage,{defaultMessage:"Issues",id:"syncedCollectionIndicators.issues.label"});case"calendar":return(0,l.jsx)(n.FormattedMessage,{defaultMessage:"Calendar",id:"syncedCollectionIndicators.calendar.label"});case"release":return(0,l.jsx)(n.FormattedMessage,{defaultMessage:"Releases",id:"syncedCollectionIndicators.releases.label"});default:(0,r.t1)(o.pattern.collectionItemType)}}(e,t);return s?o?(0,l.jsx)(n.FormattedMessage,{id:"syncedCollectionIndicators.originalUrlWithIntegration",defaultMessage:"{collectionType} in {integrationName}",values:{integrationName:o,collectionType:s}}):(0,l.jsx)("span",{children:o}):(0,l.jsx)(n.FormattedMessage,{defaultMessage:"Link to original url",id:"syncedCollectionIndicators.originalUrl"})}const d=(0,n.defineMessages)({github_pull:{defaultMessage:"Oauth Pull Request",id:"syncedCollectionIndicators.oauthGithubPullRequest.label"},github_issue:{defaultMessage:"Oauth Issue",id:"syncedCollectionIndicators.oauthGithubIssue.label"},Event:{defaultMessage:"Event",id:"syncedCollectionIndicators.event.label"},figma_file:{defaultMessage:"File",id:"syncedCollectionIndicators.figmaFile.label"},google_drive_file:{defaultMessage:"File",id:"syncedCollectionIndicators.googleDriveFile.label"},zendesk_ticket:{defaultMessage:"Ticket",id:"syncedCollectionIndicators.zendeskTicket.label"}});function p(e){const{pattern:t,integration:o}=e;return`${o.name} ${function(e){switch(e.name){case"Event":return s.default.formatMessage(d.Event);case"figma_file":return s.default.formatMessage(d.figma_file);case"github_pull":return s.default.formatMessage(d.github_pull);case"github_issue":return s.default.formatMessage(d.github_issue);case"google_drive_file":return s.default.formatMessage(d.google_drive_file);case"zendesk_ticket":return s.default.formatMessage(d.zendesk_ticket);default:return e.name}}(t)}`}},40150:(e,t,o)=>{o.d(t,{AV:()=>u,Xx:()=>f,_n:()=>h,bp:()=>d,bu:()=>g,f2:()=>y,iZ:()=>w,lO:()=>b,lZ:()=>v,mH:()=>p,oc:()=>_,tA:()=>m,vg:()=>S});var n=o(8848),r=o(51454),i=o(92650),a=o(24646),s=o(27724),l=o(78316),c=o(77181);function d(e,t){return e.col===t.col&&e.row===t.row}const p="text/_notion-table",u=function(e){return{minCol:Math.min(e.start.col,e.end.col),maxCol:Math.max(e.start.col,e.end.col),minRow:Math.min(e.start.row,e.end.row),maxRow:Math.max(e.start.row,e.end.row)}},m=14,g=32,h=-8,f=g+h,y=e=>{let{columnIndex:t,titleColumnIndex:o,indentLevel:n,shouldShowBulkActionsToolbar:r,isSubitemToggleOnTitleColumn:i}=e;const a=0===t&&r?f:0;return v({columnIndex:t,titleColumnIndex:o,indentLevel:n,isSubitemToggleOnTitleColumn:i})+a},v=e=>{let{columnIndex:t,titleColumnIndex:o,indentLevel:n,isSubitemToggleOnTitleColumn:r}=e;return b({columnIndex:t,titleColumnIndex:o,isSubitemToggleOnTitleColumn:r})&&n>0?c.Hw*n+c.gY:0},b=e=>{let{columnIndex:t,titleColumnIndex:o,isSubitemToggleOnTitleColumn:n}=e;return n?t===o:0===t},S=e=>{let{collectionViewBlockId:t}=e;const o=s.default.state.stores;return 0!==o.length&&!(0,l.v_)(o,t)};function _(e){const{environment:t,collectionContextStore:o,isMobile:i,stickyLeft:s,theme:l}=e;if(i)return{};const c=o.collectionViewBlockStore(),d=null==c?void 0:c.getParentBlockStore();let p;const u=o.isInPeekRenderer.state;if("dark"===l.mode&&u&&(p=l.peekModalBackground),d&&!o.isFullScreen.state&&(null==c||!c.isRootOrDirectChild())){var m;const e=null===(m=d.getModel())||void 0===m?void 0:m.getFormat().block_color;e&&(p=(0,n.fi)(e,l).background)}const g=o.frozoneStore.state.scrollerLeftOffset??0,h=(0,a.Wk)(t),f=Math.max(h-g,0),y=w(t,o)?f:0;return{background:p||l.contentBackground,position:"sticky",left:(s||0)+y,zIndex:r.I5}}function w(e,t){const o=t.collectionViewBlockStore();return!!o&&(o.isRootOrDirectChild()&&(0,i.fg)(e,o)&&!(0,l._5)(o)&&!o.isCollectionViewPageWithContent())}},78122:(e,t,o)=>{o.d(t,{A8:()=>p,Bj:()=>v,Bt:()=>_,Fy:()=>h,T0:()=>m,Xg:()=>S,ZH:()=>u,hC:()=>b,hL:()=>y,iT:()=>g,wG:()=>f});o(67294);var n=o(72126),r=o(5366),i=o(97880),a=o(86080),s=o(47307),l=o(64369),c=o(95697),d=o(85893);async function p(e){let{isCurrentUser:t,teamName:o,memberName:n}=e;return await s.confirmUserAction({message:t?(0,d.jsx)(r.FormattedMessage,{defaultMessage:"Are you sure you want to leave {teamName}?",id:"teamActions.leaveTeam.confirmDialogMessage.removingYourself",values:{teamName:o}}):(0,d.jsx)(r.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogMessage.removingSomeoneElse",defaultMessage:"Are you sure you want to remove {memberName} from {teamName}?",values:{memberName:n,teamName:o}}),description:t?(0,d.jsx)(r.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogDescription.removingYourself",defaultMessage:"You'll no longer see this teamspace in your sidebar and you may lose permissions to the teamspace's pages."}):(0,d.jsx)(r.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogDescription.removingSomeoneElse",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),acceptLabel:t?(0,d.jsx)(r.FormattedMessage,{defaultMessage:"Leave Teamspace",id:"teamActions.leaveTeam.confirmDialogAcceptLabel.removingYourself"}):(0,d.jsx)(r.FormattedMessage,{defaultMessage:"Remove",id:"teamActions.leaveTeam.confirmDialogAcceptLabel"}),cancelLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogCancelLabel.removingSomeoneElse",defaultMessage:"Cancel"})})}function u(){s.showMessage({message:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.leaveTeam.onlyTeamMemberLeftDialogMessage",defaultMessage:"Invite another teamspace owner to leave this teamspace"})})}function m(e){s.showMessage({message:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.leaveTeam.userMembershipFromGroupDialogMessage",defaultMessage:"You can't leave this teamspace because you're a member of {groupNames}.",values:{groupNames:n.oA(e.map((e=>`"${e.name}"`))).join(", ")}})})}function g(e){var t;let{group:o,onAccept:n}=e;s.showDialog({message:o.name?(0,d.jsx)(r.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.title",defaultMessage:"Are you sure you want to remove {groupName}?",values:{groupName:o.name}}):(0,d.jsx)(r.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.title.noGroupName",defaultMessage:"Are you sure you want to remove this group?"}),description:(0,d.jsx)(r.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.description",defaultMessage:"{numGroupMembers} {numGroupMembers, plural, one {member} other {members}} from this group will be removed from this teamspace.",values:{numGroupMembers:(null===(t=o.user_ids)||void 0===t?void 0:t.length)||0}}),showCancel:!0,keepFocus:!1,handleCancel:s.dismissDialog,items:[{label:(0,d.jsx)(r.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.confirmationButton",defaultMessage:"Remove group"}),color:"red",onAccept:n}]})}async function h(e,t){return await a.b({message:(0,d.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,d.jsx)(r.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogTitle",defaultMessage:"Are you sure you want to archive this teamspace?"}),(0,d.jsx)(l.Z,{isMultiline:!0,style:{marginTop:8},children:t?(0,d.jsx)(r.FormattedMessage,{id:"teamActions.archiveTeam.transitionToZeroTeams.confirmDialogDescription",defaultMessage:'This is your last default teamspace. Archiving will remove the "Teamspaces" section in your sidebar. Type the teamspace name to confirm.'}):(0,d.jsx)(r.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogDescription",defaultMessage:"Archiving this teamspace will remove access and hide it in the sidebar for all teamspace members. Type the teamspace name to confirm."})})]}),acceptLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogAcceptLabel",defaultMessage:"Archive teamspace"}),requiredInputValue:e})}async function f(e){return await s.confirmUserAction({message:(0,d.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogTitle",defaultMessage:'Would you like to move pages under {teamName} to the "Private" and "Shared" sections in your sidebar?',values:{teamName:e}})}),acceptLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogAcceptLabel",defaultMessage:"Move pages"}),cancelLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogCancelLabel",defaultMessage:"Proceed without moving pages"})})}async function y(e){let{teamName:t,currentIsDefault:o,accessLevel:n,isDefault:a,numberOfTeamGuests:l}=e;const c=(0,d.jsx)("div",{style:{marginTop:8},children:(0,d.jsx)(r.FormattedMessage,{id:"teamActions.confirmTeamAccessDialog.disableDefaultTeamLabel",defaultMessage:"{teamName} will also no longer be a default teamspace and auto-add workspace members.",values:{teamName:t}})});let p,u;return"private"===n?(p=(0,d.jsx)(r.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} private?",id:"teamActions.confirmTeamAccessChangeDialog.privateTeam.titleWithName",values:{teamName:t}}),u=(0,d.jsxs)("div",{children:[(0,d.jsx)(r.FormattedMessage,{id:"teamActions.teamScreen.privateTeam.description",defaultMessage:"Only members will be able to see the teamspace and its content."}),o&&c]})):a?l>0?(p=(0,d.jsx)(r.FormattedMessage,{id:"teamActions.confirmTeamAccessChangeDialog.defaultTeamWithGuests.titleWithName",defaultMessage:"Are you sure you want to make {teamName} a default teamspace?",values:{teamName:t}}),u=(0,d.jsx)(r.FormattedMessage,{id:"teamActions.teamScreen.defaultTeamWithGuests.description",defaultMessage:"Everyone in the workspace and future workspace members will be added to this teamspace. Additionally, {numberOfTeamGuests} teamspace guests will be removed.",values:{numberOfTeamGuests:l}})):(p=(0,d.jsx)(r.FormattedMessage,{id:"teamActions.confirmTeamAccessChangeDialog.defaultTeam.titleWithName",defaultMessage:"Are you sure you want to make {teamName} a default teamspace?",values:{teamName:t}}),u=(0,d.jsx)(r.FormattedMessage,{id:"teamActions.teamScreen.defaultTeam.description",defaultMessage:"Everyone in the workspace and future workspace members will be added to this teamspace."})):"open"===n?(p=(0,d.jsx)(r.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} open?",id:"teamActions.confirmTeamAccessChangeDialog.openTeam.titleWithName",values:{teamName:t}}),u=(0,d.jsxs)("div",{children:[!o&&(0,d.jsx)(r.FormattedMessage,{id:"teamActions.teamScreen.openTeam.description",defaultMessage:"Everyone in the workspace will have access to the teamspace and its content."}),o&&c]})):"closed"===n?(p=(0,d.jsx)(r.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} closed?",id:"teamActions.confirmTeamAccessChangeDialog.closedTeam.titleWithName",values:{teamName:t}}),u=(0,d.jsxs)("div",{children:[(0,d.jsx)(r.FormattedMessage,{id:"teamActions.teamScreen.closedTeam.description",defaultMessage:"The teamspace will still be discoverable, but joining will be invite-only."}),o&&c]})):(0,i.t1)(n),await s.confirmUserAction({message:p,description:u})}async function v(e){let t;switch(e){case"disable_guests":t=(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.disableGuests.confirmationTitle",defaultMessage:"Are you sure? All page guests in this teamspace will be removed."});break;case"disable_public_access":t=(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.disablePublicPages.confirmationTitle",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this teamspace."});break;case"disable_export":case"disable_team_page_edits":return!0;default:(0,i.t1)(e)}return await s.confirmUserAction({message:t})}async function b(e){let t;switch(e){case"disable_guests":t=(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.disableGuestsOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow guests on this teamspace? By default, guests are not allowed on teamspaces in this workspace."});break;case"disable_public_access":t=(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.disablePublicPagesOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow teamspace pages to be made public? By default, pages in this workspace cannot be made public."});break;case"disable_export":t=(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.disableExportOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow teamspace pages to be exported? By default, pages in this workspace cannot be exported."});break;case"disable_team_page_edits":return!0;default:(0,i.t1)(e)}return await s.confirmUserAction({message:t,acceptLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.workspaceSettingOverride.confirmationButtonLabel",defaultMessage:"Override workspace setting"})})}async function S(e){let{environment:t,spaceStore:o,teamName:n}=e;const i=t.currentUser.id;if(!i||!o)return!0;return!(await(0,c.F0)({environment:t,spaceStore:o,currentUserId:i})).some((e=>{var t;return(null===(t=e.getName())||void 0===t?void 0:t.trim())===n.trim()}))||await s.confirmUserAction({message:(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.confirmDuplicateTeamName.message",defaultMessage:"A teamspace with the same name already exists. Are you sure you want to name this teamspace â€œ{teamName}â€?",values:{teamName:n}}),cancelLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.confirmDuplicateTeamName.cancelLabel",defaultMessage:"Cancel"})})}async function _(){return await s.confirmUserAction({message:(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.setTeamPermissions.ClearCustomTeamPermissionsDialogMessage",defaultMessage:"Raising the permission level for all teamspace members will remove some custom permissions. Are you sure you want to proceed?"}),cancelLabel:(0,d.jsx)(r.FormattedMessage,{id:"teamSettings.setTeamPermissions.cancelLabel",defaultMessage:"Cancel"})})}},21115:(e,t,o)=>{o.d(t,{$$:()=>p,CC:()=>h,JB:()=>f,K9:()=>m,Ke:()=>y,_t:()=>d,e6:()=>u,zs:()=>g});var n=o(5366),r=o(64964),i=o(1310),a=o(19306),s=o(33929);const l=(0,n.defineMessages)({leftTeam:{id:"teamPermissionsActions.leftTeam",defaultMessage:"Left {teamName}"},leftTeamNoName:{id:"teamPermissionsActions.leftTeamNoName",defaultMessage:"Left team"},leftYetStillInTeam:{id:"teamPermissionsActions.leftYetStillInTeam",defaultMessage:"You are still in {hasTeamName, select, true {{teamName}} other {the team}} because you are a member of the following groups: {groupsString}"},removedYetStillInTeam:{id:"teamPermissionsActions.removedYetStillInTeam",defaultMessage:"{hasMemberName, select, true {{memberName}} other {The removed user}} is still in {hasTeamName, select, true {{teamName}} other {the team}} because they are a member of the following groups: {groupsString}"},joinedTeam:{id:"teamPermissionsActions.joinedTeam",defaultMessage:"Joined {teamName}"},joinedTeamUsingAdminPrivileges:{id:"teamPermissionsActions.joinedTeamUsingAdminPrivileges",defaultMessage:"Joined {teamName} using admin privileges"},upgradedSelfToOwner:{id:"teamPermissionsActions.upgradedSelfToOwnerUsingAdminPrivileges",defaultMessage:"Became owner of {teamName} using admin privileges"},archivedTeam:{id:"teamPermissionsActions.archivedTeam",defaultMessage:"Archived {teamName}"},restoredTeam:{id:"teamPermissionsActions.restoredTeam",defaultMessage:"Restored {teamName}"},restoredTeamNoName:{id:"teamPermissionsActions.restoredTeamNoName",defaultMessage:"Restored team"},duplicatedTeam:{id:"teamPermissionsActions.duplicatedTeam",defaultMessage:"Duplicated {teamName}"},duplicatedTeamNoName:{id:"teamPermissionsActions.duplicatedTeamNoName",defaultMessage:"Duplicated teamspace"}}),c=(e,t,o)=>{const n=s.default.formatMessage(e,{...t});r.oV({label:n,durationMs:o})},d=e=>c(l.upgradedSelfToOwner,{teamName:e}),p=e=>{let{teamName:t,usingAdminPrivileges:o}=e;return c(o?l.joinedTeamUsingAdminPrivileges:l.joinedTeam,{teamName:t})},u=e=>e?c(l.leftTeam,{teamName:e}):c(l.leftTeamNoName),m=(e,t)=>{const o=(0,a.W)(t.flatMap((e=>e.name||[])));c(l.leftYetStillInTeam,{hasTeamName:void 0!==e,teamName:e,groupsString:o},i.JY)},g=(e,t,o)=>{const n=(0,a.W)(o.flatMap((e=>e.name||[])));c(l.removedYetStillInTeam,{hasMemberName:void 0!==e,hasTeamName:void 0!==t,memberName:e,teamName:t,groupsString:n},i.JY)},h=e=>c(l.archivedTeam,{teamName:e}),f=e=>e?c(l.restoredTeam,{teamName:e}):c(l.restoredTeamNoName),y=e=>e?c(l.duplicatedTeam,{teamName:e}):c(l.duplicatedTeamNoName)},95697:(e,t,o)=>{o.d(t,{q9:()=>le,$r:()=>ie,ZN:()=>ae,oI:()=>j,Xq:()=>K,KP:()=>re,W8:()=>ce,Pr:()=>$,qX:()=>Z,F0:()=>W,sj:()=>V,tu:()=>ge,wP:()=>ue,Mf:()=>q,xo:()=>ne,tO:()=>te,xf:()=>oe,ku:()=>N,AL:()=>X,QI:()=>F,U2:()=>de,zz:()=>ee,bq:()=>U,Hu:()=>G,tV:()=>pe,C2:()=>H,dY:()=>me,$:()=>Q,Gc:()=>L,OX:()=>J});o(57658);var n=o(480),r=o(86628),i=o(14577),a=o(29477);const s=Symbol("unset");class l{constructor(e){this.timeoutMs=void 0,this.fetch=void 0,this.useLastValue=void 0,this.promise=void 0,this.lastFetched=void 0,this.lastValue=void 0,this.changeTrigger=a.UZ();const{timeoutMs:t,fetch:o,useLastValue:n}=e;this.timeoutMs=t,this.fetch=o,this.promise=void 0,this.useLastValue=n,this.lastValue=s}async getWithState(){if(this.isReady()&&this.lastValue!==s)return{value:this.lastValue,state:"cached"};if(this.promise)return{value:await this.promise,state:"cached"};this.promise=this.fetch().catch((e=>{if(this.useLastValue&&this.lastValue!==s)return this.lastValue;throw e}));try{const e=await this.promise;return this.lastFetched=Date.now(),e!==this.lastValue&&(this.changeTrigger.resolve(e),this.changeTrigger=a.UZ()),this.lastValue=e,{value:e,state:"fetched"}}finally{this.promise=void 0}}async get(){const{value:e}=await this.getWithState();return e}isReady(){const e=Date.now();return Boolean(this.lastFetched&&this.lastValue!==s&&this.lastFetched>e-this.timeoutMs)}waitUntilChange(){return this.changeTrigger.promise}}var c=o(68626),d=o(72126),p=o(5366),u=o(26825),m=o(27006),g=o(45953),h=o(29369),f=o(19889),y=o(64684),v=o(97880),b=o(54642),S=o(95477),_=o(38676),w=o(80444),k=o(77080),x=o(45483),I=o(35661),C=o(78291),T=o(30397),M=o(88893),P=o(60396),A=o(28020),D=o(4708),B=o(15010),R=o(67669),E=o(38755);function F(e){const{currentSpaceStore:t}=w.default.state;if((0,E.Cx)(t))return!1;switch(e){case"dev_only":return k.default.checkGate("sidebar_home_gate");case"beta_only":return k.default.checkGate("sidebar_home_beta_gate");case"dev_or_beta":return k.default.checkGate("sidebar_home_gate")||k.default.checkGate("sidebar_home_beta_gate");default:(0,v.t1)(e)}}function N(){return k.default.checkGate("sidebar_pages_hide_toggles")}function j(){return S.default.isAdminMode||!1}const O=d.HP((()=>new i.Z((()=>{const{currentSpaceStore:e}=w.default.state;return!!e&&e.isTeamsEnabled()}),{debugName:"teamsEnabledStore"})));function L(){return(0,r.VK)((()=>O().state),[])}function U(){return O().state}async function Z(e){let{environment:t,spaceStore:o,includeArchived:n=!1,currentUserId:r}=e;const i=await b.getTeams(t,{spaceId:o.id,includeArchived:n},r);return"failed"===i.type?(c.rateLimitedLog({from:"teamsHelpers",level:"error",type:"getTeamsFailed"}),[]):i.data.teamIds.map((e=>I.zX.createChildStore(o,{table:h.e0,id:e})))}async function V(e){let{spaceStore:t,currentUserId:o,includeArchived:n,minRoleOnTeamStores:r,environment:i}=e;if(!t||!o)return[];const a=await b.getAllTeamsInSpaceForAdmin(i,{spaceId:t.id,includeArchived:n},o);if("failed"===a.type)return[];const s=a.data.teamIds.map((e=>I.zX.createChildStore(t,{table:h.e0,id:e}))),l=[],c=[];for(const m of s){const e=m.getRole()??"none";(0,u.gr)(e,r)?c.push(m.id):l.push(m)}const d=g.Ak.create(a.data.recordMap);P.Z.initialize({environment:i,userId:o,spaceId:t.id,teamIds:a.data.teamIds,getRecordWithRole:e=>({role:r,value:d.getValue(e)})});const p=c.map((e=>P.Z.createTeamStoreFromCache({environment:i,teamId:e,spaceId:t.id,userId:o}))).filter(v.$K);return[...l,...p]}function q(e){return T.Z.state.teams.filter((t=>t.getMembers().some((t=>"user"===t.entity_type&&t.user_id===e))))}const z=new Map;async function W(e){let{environment:t,spaceStore:o,includeArchived:n=!1,currentUserId:r}=e;const i=`${o.id}:${n}`,a=z.get(i);if(a)return a.get();const s=new l({timeoutMs:3e4,fetch:async()=>Z({environment:t,spaceStore:o,includeArchived:n,currentUserId:r}),useLastValue:!0});return z.set(i,s),s.get()}function H(e){return!!e&&"private"===(0,y.B5)(e)}function G(e){return e&&(0,y.jI)(e)}function K(e){let{environment:t,spaceStore:o}=e;return!!o&&(!(0,E.Cx)(o)&&((0,E.Fn)(t)||!o.getDisableTeamCreation()))}function $(e){const t=(0,R.YO)(e).map((e=>e.permissionItem)),o=t.find(m.ix),n=(null==o?void 0:o.role)??"none",r=(0,M.Io)().reduce(((e,t)=>(e.add(t.userId),e)),new Set),i=t.filter((e=>!(!(0,m.jg)(e)||!r.has(e.user_id))||!!(0,m.hV)(e))),a=function(e){if(0===e.length)return;return e.reduce(((e,t)=>(0,u.SL)(t,e)?t:e),e[0])}(i.map((e=>e.role)))??"read_and_write";return{accessLevel:"none"===n?"private":"closed",spacePermissionRole:n,teamPermissionRole:(0,u.nl)(a,n),members:i.map((e=>{const{type:t}=e;return"user_permission"===t?{entity_type:"user",type:"member",user_id:e.user_id}:"group_permission"===t?{entity_type:"group",type:"member",group_id:e.group_id}:void(0,v.t1)(t)}))}}function Y(e){let{environment:t,currentSpaceStore:o,subscriptionData:n}=e;return!!o&&(!t.device.isMobile&&!o.isTeamsEnabled()&&!(0,M.wY)(n)&&(0,E.lQ)(o))}function Q(e){const{currentSpaceStore:t}=w.default.state;return Y({environment:e,currentSpaceStore:t,subscriptionData:C.default.state.data})}function J(){const e=(0,n.O7)();return(0,r.VK)((()=>{const{currentSpaceStore:t}=w.default.state,o=C.default.state.data;return Y({environment:e,currentSpaceStore:t,subscriptionData:o})}),[e])}function X(e){let{teamStore:t,spaceStore:o,userId:n}=e;return!!(t.isDefined()&&null!=o&&o.isDefined()&&n)&&(0,y.AL)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:o.getPermissionItems(),permission_groups:o.getPermissionGroups()},userId:n})}function ee(e){let{teamStore:t,spaceStore:o,userId:n}=e;return!(!t.isDefined()||!n)&&(0,y.zz)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:(null==o?void 0:o.getPermissionItems())||[],permission_groups:(null==o?void 0:o.getPermissionGroups())||[]},userId:n})}function te(e){let{teamStore:t,spaceStore:o}=e;return o?(0,y.tO)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:o.getPermissionItems(),permission_groups:o.getPermissionGroups()}}):[]}function oe(e){let{teamStore:t,spaceStore:o}=e;return o?(0,y.xf)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:o.getPermissionItems(),permission_groups:o.getPermissionGroups()}}):[]}function ne(){return T.Z.state.teams.flatMap((e=>e.getTeamPages()))}function re(e,t){return e.isDefault()?-1:t.isDefault()?1:0}const ie=["owner","member"],ae=["owner","member","team_level_guest"],se=(0,p.defineMessages)({ownerLabel:{id:"teamPermissionsMenu.ownerItem.label",defaultMessage:"Teamspace owner"},ownerCaption:{id:"teamPermissionsMenu.ownerItem.caption",defaultMessage:"Can edit teamspace settings and full access to teamspace pages."},memberLabel:{id:"teamPermissionsMenu.memberItem.label",defaultMessage:"Teamspace member"},memberCaption:{id:"teamPermissionsMenu.memberItem.caption",defaultMessage:"Cannot edit teamspace settings and can access teamspace pages."},guestLabel:{id:"teamPermissionsMenu.guestItem.label",defaultMessage:"Teamspace guest"},guestCaption:{id:"teamPermissionsMenu.guestItem.caption",defaultMessage:"Only has access to invited teamspaces."}}),le={owner:{label:se.ownerLabel,caption:se.ownerCaption},member:{label:se.memberLabel,caption:se.memberCaption},team_level_guest:{label:se.guestLabel,caption:se.guestCaption}};function ce(e){return`${S.default.domainBaseUrl}/team/${e}/join`}function de(e){var t;return!(null===(t=e.getSettings())||void 0===t||!t.disable_invite_link)}function pe(e){const t=[],o=[];for(const n of e)n.isDefined()&&(void 0===n.getArchivedBy()?o.push(n):t.push(n));return{archivedTeams:t,unarchivedTeams:o}}function ue(e){const t=(0,B.WD)(e);if(!t)return!1;const o=t.getKeyStore("settings").getKeyStore("seen_team_add_app_template_tooltip_at").getValue();return void 0!==o&&o>0}function me(e){let{environment:t,teamId:o}=e;const n=Boolean(_.gV.state);return(0,D.B9)()&&w.default.state.inAppCalloutStore.canShow("team_add_app_template_tooltip")&&!ue(t)&&0===x.Z.state.openModals.size&&n&&function(e){var t;let{environment:o,teamId:n}=e;const r=((null===(t=(0,A.k_)(o).getState())||void 0===t?void 0:t.userJoinedTeamsStores)??[]).find((e=>{const t=e.getTeamPagesStores().filter((e=>{var t;return Boolean(null===(t=e.getCollectionStore())||void 0===t?void 0:t.getDatabaseType())}));return e.canAddOrRemoveTopLevelPages()&&t.length<2}));return!!r&&r.id===n}({environment:t,teamId:o})}function ge(e){let{currentUserStore:t,currentSpaceStore:o,teamStore:n,members:r}=e;return d.oA(r.map((e=>{const{entity_type:r}=e;return"user"===r?function(e){let{currentUserStore:t,teamStore:o,member:n}=e;if(!t)return;const r=he({teamStore:o,member:n}),i=I.U6.createChildStore(t,{table:f.KJ,id:n.user_id});return{type:"user",memberInfo:n,permissionItem:{type:"user_permission",user_id:n.user_id,role:r},userStore:i}}({currentUserStore:t,teamStore:n,member:e}):"group"===r?function(e){let{currentSpaceStore:t,teamStore:o,member:n}=e;const r=(0,E.TC)({spaceStore:t,groupId:n.group_id});if(!r)return;const i=he({teamStore:o,member:n});return{type:"group",memberInfo:n,permissionItem:{type:"group_permission",group_id:r.id,role:i},permissionGroup:r}}({currentSpaceStore:o,teamStore:n,member:e}):void(0,v.t1)(r)})))}function he(e){let{teamStore:t,member:o}=e;const n=t.getPermissionItems();if(!n)return"none";const r=function(e){let{permissions:t,member:o}=e;const n=null==t?void 0:t.find((e=>(0,m.hV)(e)&&"group"===o.entity_type&&e.group_id===o.group_id||(0,m.jg)(e)&&"user"===o.entity_type&&o.user_id===e.user_id));return null==n?void 0:n.role}({permissions:n,member:o});return r||(0,y.xC)({id:t.id,permissions:t.getPermissionItems()})}},60846:(e,t,o)=>{o.d(t,{D$:()=>l,JZ:()=>c,NL:()=>s,UZ:()=>d});o(21703);var n=o(52027),r=o.n(n),i=o(15095);const a=new(r()),{DIFF_DELETE:s,DIFF_INSERT:l,DIFF_EQUAL:c}=r(),d=function(e,t){const o=p(e,{count:0,encoding:{},decoding:{}}),n=o.encodedString,r=p(t,o.cypher),i=r.encodedString,s=r.cypher;return function(e,t){return e.map((e=>{let[o,n]=e;return[o,u(n,t)]}))}(a.diff_main(n,i),s).filter((e=>{let[t,o]=e;return""!==o}))};function p(e,t){const o=i.p4(e).map((e=>{const o=t.encoding[e];if(o)return o;{const o=String.fromCharCode(t.count);return t.count++,t.encoding[e]=o,t.decoding[o]=e,o}}));if(t.count>65535)throw new Error("This string has way too many different characters.");const n=o.join("");return{cypher:t,encodedString:n}}function u(e,t){return e.split("").map((e=>t.decoding[e])).join("")}},31352:(e,t,o)=>{o.d(t,{O2:()=>a,Ye:()=>c,ug:()=>s,zK:()=>l});var n=o(15095),r=o(72126),i=o(70203);function a(e,t,o){const a=e.getValue(),s=i.eeV(t),l=i.eeV(a);if(0===s.length&&0===l.length)return""===o?{filter:{startIndex:0,endIndex:0}}:void 0;const c=r.d9(s).reverse(),d=r.d9(l).reverse(),p=l.findIndex(((e,t)=>e!==s[t])),u=d.findIndex(((e,t)=>e!==c[t]));if(-1===p||-1===u)return;const m=n.p4(o),g={filter:{startIndex:p+(m.length>0?1:0),endIndex:p+l.length-s.length}};if(m.length>0){const e=g.filter.startIndex-m.length,t=g.filter.startIndex;l.slice(e,t).join("")===o&&(g.prefix={startIndex:e,endIndex:t})}return g}function s(e,t){if(!t)return;const o=e.getValue();return i.eeV(o).slice(t.filter.startIndex,t.filter.endIndex).join("")}function l(e,t,o){return s(e,a(e,t,o?"@":""))}function c(e,t,o,n,a){if(void 0===e)return!0;if(t&&0===o&&n>3)return!0;if(1===e.length){const t=r.Z$(e);if(t){if(/\s/g.test(t)){const e=a.getValue();if(e&&1===e.length){const t=i.QaF(e);return!(2===t.length&&t.startsWith("/"))}}}}else if(e.length>=2){return e.endsWith("  ")}return!1}},89224:(e,t,o)=>{o.r(t),o.d(t,{areRangesEqual:()=>B,clear:()=>_,containerOffsetIsBetweenNodes:()=>A,get:()=>f,getIncompleteDOMEndpoint:()=>b,getRect:()=>w,getSelectionRect:()=>k,isExpanded:()=>C,isMouseRightClicking:()=>U,isMouseSelecting:()=>L,rangeFromContainerOffsets:()=>T,rangeFromPoint:()=>x,rangeToContainerOffsets:()=>P,resetMouseRightClicking:()=>Z,selectionIsBackwards:()=>N,set:()=>y,setDOMEndpoint:()=>S,setOnNode:()=>I,snapContainerOffsetToNode:()=>D,startListeners:()=>F,toStaticRange:()=>M});o(21703);var n=o(55010),r=o(45060),i=o(1302),a=o(92595),s=o(7406),l=o(68626),c=o(72126),d=o(15723);new WeakMap;let p;const u=c.HP((()=>window.__isElectron?m:()=>window))();function m(){return!p||window.document.hasFocus()?(g("getWindow(): Returning main window because it has focus."),window):p?(g("getWindow(): Returning focused child window."),p):(g("getWindow(): Returning main window because nothing has focus"),window)}function g(){false}var h=o(73744);const f=function(){const e=u().getSelection();if(e&&e.rangeCount>0){return e.getRangeAt(0)}},y=function(e,t){v.reset();const o=window.getSelection();if(o){if(!(t.isFirefox&&parseFloat(t.browserVersion)<92))try{return function(e,t){const{focus:o,anchor:n}=P(t);e.collapse(n.container,n.offset),e.extend(o.container,o.offset)}(o,e)}catch(n){l.log({from:"textSelection",type:"textSelectionSet",level:"error",error:(0,s.tg)(n)})}return function(e,t){const o=document.createRange();o.setStart(t.startContainer,t.startOffset),o.setEnd(t.endContainer,t.endOffset),e.removeAllRanges(),e.addRange(o)}(o,e)}};const v=new class{constructor(e){this.state=void 0,this.debugName=e,(0,a.exposeDebugInstance)("endpointLatch",this)}complete(e){if(this.state&&this.state.endpoint!==e.endpoint&&this.state.onlyIfEqual===e.onlyIfEqual){const t="start"===this.state.endpoint?this.state:e,o="end"===this.state.endpoint?this.state:e;return this.state=void 0,{start:t,end:o}}if(this.state){let t=`${this.debugName}: cannot complete latch:`;const o=this.state.endpoint===e.endpoint,n=this.state.onlyIfEqual!==e.onlyIfEqual;o&&(t+=` same endpoint ${e.endpoint}`),n&&(t+=" different tokens"),l.log({level:"warning",from:"EndpointLatch",type:"cannotCompleteLatch",data:{name:this.debugName,message:t,miscDataToConvertToString:{sameEndpoint:o,differentTokens:n}}})}this.state=e}reset(){this.state&&(l.log({level:"warning",from:"EndpointLatch",type:"resetPartialLatch",data:{name:this.debugName,message:`reset latch with endpoint ${this.state.endpoint}`}}),this.state=void 0)}}("domSelection");function b(){return v.state}function S(e,t){const o=v.complete(e);if(!o)return;const{start:n,end:r}=o,i=T({start:n.position,end:r.position});y(i,t)}function _(e){v.reset();const t=window.getSelection();t&&(e.device.isMobile&&e.device.isAndroid?t.collapse(null,void 0):t.removeAllRanges())}const w=function(e){if(e){if(e.collapsed&&e.getClientRects){const t=c.Go(e.getClientRects()[0]);if(!c.xb(t))return t}else if(e.getBoundingClientRect){const t=c.Go(e.getBoundingClientRect());if(!c.xb(t))return t}if(e.startContainer.nodeType===Node.ELEMENT_NODE){if(0===e.startOffset){const t=e.startContainer.getBoundingClientRect();return new d.iL(t.left,t.top,0,t.height)}const t=e.startContainer.childNodes[e.startOffset-1];if(t&&t.nodeType===Node.ELEMENT_NODE){const e=t.getBoundingClientRect();return new d.iL(e.left,e.top,0,e.height)}const o=e.startContainer.childNodes[e.startOffset];if(o&&o.nodeType===Node.ELEMENT_NODE){const e=o.getBoundingClientRect();return new d.iL(e.left,e.top,0,e.height)}}}};function k(){const e=f();if(e)return w(e)}const x=function(e,t){if(document.caretRangeFromPoint){return document.caretRangeFromPoint(e,t)??void 0}if(document.caretPositionFromPoint){const o=document.caretPositionFromPoint(e,t),n=document.createRange();return n.setStart(o.offsetNode,o.offset),n.setEnd(o.offsetNode,o.offset),n}throw new Error("Browser does not support method caretRangeFromPoint or caretPositionFromPoint")};function I(e,t){const o=document.createRange();o.selectNode(e),y(o,t)}function C(e){return Boolean(e&&!e.collapsed)}function T(e){const{start:t,end:o}=e,n=document.createRange();if(t.container)try{n.setStart(t.container,t.offset)}catch(r){console.info(r)}if(o.container)try{n.setEnd(o.container,o.offset)}catch(r){console.info(r)}return n}function M(e){if(!e)return;const{startContainer:t,startOffset:o,endContainer:n,endOffset:r,collapsed:i}=e;return{startContainer:t,startOffset:o,endContainer:n,endOffset:r,collapsed:i}}function P(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N();const o={container:e.startContainer,offset:e.startOffset},n={container:e.endContainer,offset:e.endOffset},[r,i]=t?[o,n]:[n,o];return{start:o,end:n,focus:r,anchor:i}}function A(e,t,o){if(!t&&!o)return!1;if(!t&&o){const t=document.createRange();return t.selectNode(o),-1===t.comparePoint(e.container,e.offset)}if(t&&!o){const o=document.createRange();return o.selectNode(t),1===o.comparePoint(e.container,e.offset)}if(t&&o){const n=document.createRange();return n.setStartAfter(t),n.setEndBefore(o),0===n.comparePoint(e.container,e.offset)}return!1}function D(e){const{nodesInDomOrder:t,containerOffset:o,snapTowards:n}=e;for(let r=0;r<=t.length;r++){const e=t[r-1],i=t[r];if(A(o,null==e?void 0:e.node,null==i?void 0:i.node))return"start"===n?e:i}}function B(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset&&e.collapsed===t.collapsed}const R=new class{constructor(){this.currentHasNonEmptySelection=!1,this.currentIsBackwards=void 0,this.mouseDownSelection=void 0}selectionIsBackwards(){return Boolean(this.currentHasNonEmptySelection&&this.currentIsBackwards)}updateSelectionDirection(e,t){if(!e||!t||t.collapsed)return this.currentHasNonEmptySelection=!1,void(this.currentIsBackwards=void 0);if(this.currentHasNonEmptySelection=!0,void 0===this.currentIsBackwards){const o=1===t.startContainer.childNodes.length&&t.startContainer.childNodes[0].TEXT_NODE&&t.startContainer.childNodes[0]===e.startContainer;if(e.startContainer===t.startContainer||o)this.currentIsBackwards=t.startOffset<e.startOffset;else{const o=(0,n.Z)(t.startContainer,e.startContainer);this.currentIsBackwards=-1===o}}}startListeners(){window.addEventListener("mousedown",(()=>{i.default.afterNextFlush((()=>{this.mouseDownSelection=f()}))})),window.addEventListener("mouseup",(()=>{i.default.afterNextFlush((()=>{const e=f();this.updateSelectionDirection(this.mouseDownSelection,e)}))})),window.addEventListener("keydown",(()=>{const e=f();i.default.afterNextFlush((()=>{const t=f();this.updateSelectionDirection(e,t)}))}))}},E=new class{constructor(){this.mouseDown=!1,this.keysDown=0,this.wasBackwards=!1,this.device=void 0,this.debugDrawRects=()=>{const e=f();if(C(e)){const{focus:t,anchor:o}=P(e,this.wasBackwards),n=T({start:t,end:t}),i=w(n);i&&(0,r.yX)(i,"FOCUS","red");const a=T({start:o,end:o}),s=w(a);s&&(0,r.yX)(s,"ANCHOR","blue")}},this.handleSelectionChange=()=>{var e;(this.mouseDown||this.keysDown||null!==(e=this.device)&&void 0!==e&&e.isAndroid)&&(this.wasBackwards=function(){const e=window.getSelection();if(!e)return!1;const{focusNode:t,focusOffset:o,anchorNode:r,anchorOffset:i}=e;if(t===r)return o<i;return-1===(0,n.Z)(t,r)}())},this.handleKeyDown=()=>{this.keysDown++},this.handleKeyUp=()=>{this.keysDown--},this.handleMouseDown=()=>{this.mouseDown=!0},this.handleMouseUp=()=>{this.mouseDown=!1}}startListeners(e){return this.device=e,document.addEventListener("selectionchange",this.handleSelectionChange),window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("mousedown",this.handleMouseDown),window.addEventListener("mouseup",this.handleMouseUp),()=>{document.removeEventListener("selectionchange",this.handleSelectionChange),window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp),window.removeEventListener("mousedown",this.handleMouseDown),window.removeEventListener("mouseup",this.handleMouseUp)}}};function F(e){R.startListeners(),E.startListeners(e)}function N(){return R.currentIsBackwards||E.wasBackwards}(0,a.exposeDebugGetter)("selectionIsBackwards",N);let j=!1,O=!1;function L(){return j}function U(){return O}function Z(){return O=!1}(0,h.lj)(window,"mousedown",(e=>{0===e.button?j=!0:2===e.button&&(O=!0)}),!0),(0,h.lj)(window,"mouseup",(e=>{0===e.button?j=!1:2===e.button&&(O=!1)}),!0)},89086:(e,t,o)=>{o.d(t,{Gq:()=>Q,HE:()=>J,J5:()=>Y,J6:()=>C,J_:()=>N,Ld:()=>k,Ov:()=>O,P2:()=>D,Q3:()=>W,Rb:()=>b,Rw:()=>R,ST:()=>A,ZZ:()=>$,a6:()=>x,bj:()=>P,dQ:()=>X,e7:()=>E,fM:()=>G,fu:()=>F,fx:()=>z,hn:()=>V,iB:()=>j,k2:()=>I,lV:()=>K,mK:()=>Z,oc:()=>w,qh:()=>H,td:()=>v,wd:()=>S,x0:()=>B,yR:()=>L,yj:()=>M});o(57658);var n=o(55010),r=o(15095),i=o(72126),a=o(70203),s=o(95371),l=o(28685),c=o(95802),d=o(15723),p=o(50628),u=o(27724),m=o(24666),g=o(68056),h=o(45162),f=o(69645);const y="data-text-edit-side";function v(e){return{[y]:e}}function b(e){if(e instanceof HTMLElement){const t=e.closest("[data-text-edit-side]"),o=null==t?void 0:t.getAttribute(y);if("start"===o||"end"===o)return o}}function S(e){return e.startIndex===e.endIndex}function _(e){const{startIndex:t}=e;let o;return o=S(e)&&t>0?[t-1]:function(e){return i.w6(e.startIndex,e.endIndex)}(e),o}function w(e,t){const o=a.lzi(t),n=o.map((e=>r.p4(a.WiV(e))));return e.map((e=>{let t=0;const r=n.findIndex((o=>(t+=o.length,t>e))),i=o[r];return i?a.hDy(i):[]}))}function k(e){if("editing"===m.default.state.mode)return x(e,m.default.state.multiSelection,m.default.state.forceExtendAnnotations)}function x(e,t,o){return I([e],t,o)[e]}function I(e,t,o){const n={};if(0===e.length)return n;if((0,g.iG)(t)){for(const t of e){const e=o[t];if(null!=e&&e.extend){const o=e.annotation;n[t]=o}}return n}const r=new Set(e);let i=!0;const s=(0,h.L5)(t);for(const{store:l,selection:c}of s){const e=l.getValue(),t=a.Ulv(e,c),{tokensInsideRange:o}=a.xrQ(e,t.startIndex,t.endIndex);for(const s of o){const e=a.hDy(s);for(const t of r){const o=e.find((e=>a.J7s(e)===t));if(i&&o)n[t]=o;else if(o);else if(delete n[t],r.delete(t),0===r.size)return n}i=!1}}return n}function C(e){const t=m.default.state;if("editing"!==t.mode)return!1;const{multiSelection:o}=t;if((0,g.iG)(o))return!1;const n=(0,h.L5)(o);for(const{store:i,selection:s}of n){const t=i.getValue();if(!t)continue;const o=a.lzi(t);let n=0;for(const i of o){const t=r.p4(a.WiV(i));if(n>=s.startIndex&&n<s.endIndex||n<s.startIndex&&n+t.length>s.startIndex){if(a.hDy(i).some((t=>a.J7s(t)===e)))return!0}n+=t.length}}return!1}function T(e,t,o){const n=[],r=e[0]||[];for(const i of r){const e=a.J7s(i);if(!a.aLA[e])if(a.k87[e]||a.S_n[e]){A(t,o.startIndex,e)&&n.push(i)}else n.push(i)}return n}function M(e,t){const o=_(e),n=t.getValue()||[];return T(w(o,n),n,e)}function P(){const e=m.default.state;if("editing"!==e.mode)return[];const{multiSelection:t,forceExtendAnnotations:o}=e,n=(0,h.L5)(t);if(0===n.length)return[];const{store:r,selection:s}=n[0],l=r.getValue()||[];let c=T(w(_(s),l),l,s);return i.M6(o,((e,t)=>{e&&(e.extend?c.push(e.annotation):c=c.filter((e=>a.J7s(e)!==t)))})),c}function A(e,t,o){const n=a.b1T(e,t),r=a.hDy(n);return Boolean(r.find((e=>a.J7s(e)===o)))}function D(e){const t=B(e);if(t)return{startIndex:0,endIndex:t.endIndex}}function B(e){const t=l.E.findEditableWithStore(e);if(t)return t.props.getEndSelection?t.props.getEndSelection():void 0;{const t=a.eeV(e.getValue());return{startIndex:t.length,endIndex:t.length}}}function R(e){return 0===e.startIndex&&0===e.endIndex}function E(e,t){return e.store===t&&0===e.index}function F(e,t){return!e&&!t||e&&t&&(e.startIndex===t.startIndex||!e.startIndex&&!t.startIndex)&&(e.endIndex===t.endIndex||!e.endIndex&&!t.endIndex)}function N(e,t){return F(t,B(e))}function j(e,t){var o;return e.store===t&&e.index===(null===(o=B(t))||void 0===o?void 0:o.endIndex)}function O(){const e=u.default.getCurrentDefaultContainer();return l.E.getMembersByDOMOrder({filter:t=>{const o=t.getContextClosestSelectable();if(!o)return!1;const n=o.getContextSelectableContainer();return n&&n===e}})}function L(e){const t=e.getNode(),o=t?u.default.getDefaultContainerFromTarget(t):u.default.getCurrentDefaultContainer();return l.E.getMembersByDOMOrder({filter:e=>{const t=e.getContextClosestSelectable();if(!t)return!1;const n=t.getContextSelectableContainer();return n&&n===o}})}function U(e){return O().filter((e=>!e.props.disabled)).map((e=>e.props.store))}function Z(e){const t=U(),o=t.indexOf(e);return-1===o?null:t[o-1]}function V(e){const t=U(),o=t.indexOf(e);return-1===o?null:t[o+1]}function q(e){const t=[];for(const o of e){const e=i.cx(t,(e=>{const t=e[0];return d.Kr(o.rect,t.rect)}));e>=0?t[e].push(o):t.push([o])}return t}function z(e,t,o){const{selectableRectMap:r}=p.Z.state,a=o?u.default.getDefaultContainerFromTarget(o):void 0,s=u.default.getCurrentDefaultContainer(),l=a||s,d=c.C.getMembersByDOMOrder({filter:e=>e.props.canSelect&&e.props.canEditText&&e.getContextSelectableContainer()===l}),m=[];for(const n of d){const e=r.get(n);e&&m.push({selectable:n,rect:e})}const g=m.filter((e=>{let{rect:o}=e;return o.top<=t}));g.reverse();const h=q(g),f=i.UI(h,(e=>e.sort(((e,t)=>-1*(0,n.Z)(e.selectable.getNode(),t.selectable.getNode())))[0])),y=i.F(f,(t=>{let{rect:o}=t;return Math.min(Math.abs(o.left-e),Math.abs(o.right-e))}));if(y)return y;const v=q(m.filter((e=>e.rect.bottom>=t&&g.indexOf(e)<0))),b=i.UI(v,(e=>e.sort(((e,t)=>(0,n.Z)(e.selectable.getNode(),t.selectable.getNode())))[0])),S=i.F(b,(t=>{let{rect:o}=t;return Math.min(Math.abs(o.left-e),Math.abs(o.right-e))}));return S||void 0}function W(e,t){const{selectableRectMap:o}=p.Z.state,n=c.C.getMembersByDOMOrder({filter:e=>e.getContextSelectableContainer()===t});for(let r=n.length-1;r>=0;r--){const t=o.get(n[r]);if(t&&t.bottom>e)return!1}return!0}function H(e,t){const o=(0,f.dq)({includeNonSelectableListContainer:!0});if(!o)return!1;const n=i.Z$((0,s.DY)([o],(e=>e.value.component===t)));if(!n)return!1;const{selectableRectMap:r}=p.Z.state;return!(0,s.Yz)(n,(o=>{const n=o.component&&r.get(o.component);return!!(n&&e<=n.bottom&&o.component!==t)}))}function G(e,t,o){const n=e.getValue(),s=[],l=o?a.Jcv(n):a.QaF(n),{startIndex:c,endIndex:d}=t,p=r.p4(l),u=i.tP(p,0,c),m=i.qr(u,(e=>"\n"===e));m>=0?s.push(m):s.push(0);for(let r=c;r<d;r++){"\n"===p[r]&&s.push(r)}return s}function K(e){const{multiSelection:t}=e;return(0,h.L5)(t).map((e=>{let{store:t,selection:o}=e;const n=a.lzi(t.getValue()),r=a.Ulv(n,o),{tokensInsideRange:i}=a.xrQ(n,r.startIndex,r.endIndex);return a.QaF(i)})).join("\n\n")}function $(e){const t=m.default.state;return"empty"!==t.mode&&Boolean((0,h.r)(t.multiSelection,e))}function Y(e){const t=m.default.state;return"editing"===t.mode&&(t.multiSelection.start.store===e&&(t.multiSelection.end.store===e?"contains-selection":"contains-selection-start"))}function Q(e){const t=m.default.state;if("editing"!==t.mode)return!1;const{start:o,end:n}=t.multiSelection;return o.store===e||n.store===e}function J(e){const t=m.default.state;if("empty"===t.mode)return;const o=(0,g.QY)(t.multiSelection);if(o)return o.store===e?{type:"contain",selection:a.Ulv(e.getValue(),o.selection)}:void 0;const{start:n,end:r}=t.multiSelection;if(n.store===e){const t=a.eeV(e.getValue()).length;return{type:"start",index:Math.min(n.index,t)}}if(r.store===e){const t=a.eeV(e.getValue()).length;return{type:"end",index:Math.min(r.index,t)}}}function X(e){if(!(0,g.iG)(e))return!1;const{store:t,index:o}=e.start;return 0===o||"\n"===a.eeV(t.getValue())[o-1]}},17311:(e,t,o)=>{o.d(t,{Z:()=>n});const n={unit:8,borderRadius:4,card:{desktop:{small:{width:180,height:100},medium:{width:260,height:148},large:{width:320,height:180}},mobile:{width:"100%"}},vertical:{micro:2,tiny:4,small:8,medium:12,large:24},horizontal:{micro:2,tiny:4,small:8,medium:12,large:24}}},16402:(e,t,o)=>{o.d(t,{IS:()=>c,gs:()=>u,hH:()=>d,uy:()=>p});var n=o(44317),r=o(63143),i=o(5366),a=o(33929);const s=(0,i.defineMessages)({year:{id:"timeUtils.durationDescriptor.year",defaultMessage:"{numYears, plural, one {{numYears} year ago} other {{numYears} years ago}}"},day:{id:"timeUtils.durationDescriptor.day",defaultMessage:"{numDays, plural, one {{numDays} day ago} other {{numDays} days ago}}"},hour:{id:"timeUtils.durationDescriptor.hour",defaultMessage:"{numHours, plural, one {{numHours} hour ago} other {{numHours} hours ago}}"},minute:{id:"timeUtils.durationDescriptor.minute",defaultMessage:"{numMinutes, plural, one {{numMinutes} minute ago} other {{numMinutes} minutes ago}}"},second:{id:"timeUtils.durationDescriptor.second",defaultMessage:"Just now"}}),l=(0,i.defineMessages)({year:{id:"timeUtils.durationDescriptor.compactYear",defaultMessage:"{numYears}y ago"},day:{id:"timeUtils.durationDescriptor.compactDay",defaultMessage:"{numDays}d ago"},hour:{id:"timeUtils.durationDescriptor.compactHour",defaultMessage:"{numHours}h ago"},minute:{id:"timeUtils.durationDescriptor.compactMinute",defaultMessage:"{numMinutes}m ago"},second:{id:"timeUtils.durationDescriptor.compactSecond",defaultMessage:"Just now"}});function c(e){let{useCompactFormat:t,useLowercase:o,roundDownYears:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=t?l:s,c=new Date(e),d=a.default.getIntl().locale,p=new Date,u=+p-e;if(u>=r._I&&n){const e=Math.floor(u/r._I);return a.default.formatMessage(i.year,{numYears:e})}if(c.getFullYear()!==p.getFullYear())return c.toLocaleDateString(d,{year:"numeric",month:"short",day:"numeric"});const m=Math.floor(u/r.A0);if(m>=3)return c.toLocaleDateString(d,{month:"short",day:"numeric"});if(m>=1)return a.default.formatMessage(i.day,{numDays:m});const g=Math.floor(u/r.U6);if(g>=1)return a.default.formatMessage(i.hour,{numHours:g});const h=Math.floor(u/r.hM);return h>=1?a.default.formatMessage(i.minute,{numMinutes:h}):o?a.default.formatMessage(i.second).toLocaleLowerCase():a.default.formatMessage(i.second)}function d(e,t){const o=t-e,i=Math.floor(o/r._I),s=Math.floor(o/r.A0),l=Math.floor(o/r.U6),c=Math.floor(o/r.hM),d=Math.floor(o/r.C0);return i>=1?a.default.formatMessage(n.eG.year,{numYears:i}):s>=1?a.default.formatMessage(n.eG.day,{numDays:s}):l>=1?a.default.formatMessage(n.eG.hour,{numHours:l}):c>=1?a.default.formatMessage(n.eG.minute,{numMinutes:c}):a.default.formatMessage(n.eG.second,{numSeconds:d})}function p(e,t){return new Date(e).toLocaleDateString(a.default.getIntl().locale,{month:"long",year:"numeric",day:"2-digit",hour:"numeric",minute:"2-digit",second:t?void 0:"2-digit"})}function u(e){return new Date(e).toLocaleDateString(a.default.getIntl().locale,{month:"short",year:"numeric",day:"numeric"})}},35328:(e,t,o)=>{o.d(t,{BX:()=>m,JO:()=>d,_A:()=>c,fn:()=>g,ih:()=>l,m1:()=>u,tZ:()=>p,th:()=>h});var n=o(41432),r=o(72126),i=o(29373),a=o(27724),s=o(45131);function l(e){return Boolean(n.ZY[e])}function c(e,t){return Boolean("toggle"===e||n.wZ[e]&&(null==t?void 0:t.toggleable))}function d(e){return Boolean(n.wZ[e])}function p(e){return n.ZY[e]}function u(e){return n.wZ[e]}function m(e){return"toggle"===e.getType()||g(e)}function g(e){const t=e.getType(),o=e.getFormat();return Boolean(void 0!==t&&(0,n.eJ)(t,o))}function h(e){const t=e.props.store;let o;o=r.q9(a.default.state.stores,t)?a.default.state.stores:[t];const n=!(s.Z.isOpen(t.id)&&!e.props.hideContent);for(const r of o)i.rd({blockId:r.id,state:n,currentUserId:e.environment.currentUser.id})}},99341:(e,t,o)=>{o.d(t,{JG:()=>a,Vm:()=>i,_V:()=>l,jQ:()=>s});o(57658);var n=o(72126),r=o(33317);function i(e,t){let{allowSquashing:o}=t;if(0===e.length)return{squashedTasks:[]};const i={squashedTasks:[],userId:e[0].userId};function a(e){var t,a;const s=n.Z$(i.squashedTasks),l=s?s.task:void 0,c=Boolean((null===(t=e.debug)||void 0===t?void 0:t.userFlow)||(null==l||null===(a=l.debug)||void 0===a?void 0:a.userFlow));s&&l&&o&&!c&&function(e,t){function o(e){const t=e.operations.map((e=>e.pointer));return n.sv(t,n.Xy)}const r=o(e),i=o(t);return 1===r.length&&1===i.length&&n.Xy(r,i)}(l,e)?(l.operations=(0,r.Iw)([...l.operations,...e.operations]),s.subTasks.push(e)):i.squashedTasks.push({task:{...e},subTasks:[e]})}for(const r of e){if(i.userId!==r.userId)return i;if(JSON.stringify(n.VS(i.squashedTasks,(e=>e.task.operations))).length>=l)return 0===i.squashedTasks.length&&a(r),i;a(r)}return i}function a(e){const{transaction:t,timestamp:o,callback:n}=e;return{id:t.id,userId:t.userId,spaceId:t.spaceId,debug:{userAction:t.getUserActionForAnalyticsPurposesOnly(),userFlow:t.getUserFlowForAnalyticsPurposesOnly()},timestamp:o,operations:t.operations,callback:n,useSudoMode:t.useSudoMode}}function s(e){const t=a({transaction:e,timestamp:Date.now(),callback:void 0});return JSON.stringify(t).length>l}const l=1e5},64856:(e,t,o)=>{o.d(t,{AK:()=>a,IJ:()=>c,W$:()=>i,Xv:()=>s,ox:()=>l,wF:()=>d});var n=o(72126),r=o(9163);function i(e,t){return a(d(e,t))}function a(e){return void 0!==e&&(e===r.FW||e===r.lR)}function s(e,t){if(a(t))return;const o=r.eU[e],n=o.steps.findIndex((e=>e.id===t));return-1===n?o.steps[0].id:n===o.steps.length-1?r.FW:o.steps[n+1].id}function l(e,t){const o=d(e,t);if(o&&!a(o))return s(t,o)}function c(e,t){const o=d(e,t);if(o)return function(e,t){const o=r.eU[e];var i;if(a(t))return null===(i=(0,n.Z$)(o.steps))||void 0===i?void 0:i.id;const s=o.steps.findIndex((e=>e.id===t));return-1!==s&&0!==s?o.steps[s-1].id:void 0}(t,o)}function d(e,t){var o;if(!e)return;const n=((null===(o=e.getSettings())||void 0===o?void 0:o.tutorials)||{})[t];return void 0===n?r.eU[t].steps[0].id:n}},66638:(e,t,o)=>{o.d(t,{u:()=>a});var n=o(18245),r=o(88923),i=o(94134);function a(e){const{environment:t,type:o,blockStore:a,store:s,isInCollectionView:l}=e,c=n.default.mark(o),d=null==a?void 0:a.getType();n.default.measureAfterNextFlush(c,{environment:t,getData:()=>{const e=null==a?void 0:a.getType(),t=a&&"properties"===s.path[0]&&"title"===s.path[1],o=a&&"properties"===s.path[0]&&"caption"===s.path[1];return{table:s.table,block_property:t?"title":o?"caption":void 0,block_type:e,block_type_initial:e!==d?d:void 0,peek_mode:r.default.state.mode,is_in_collection_view:l,profiling_tool:i.getProfilingToolForSession()}}})}},83089:(e,t,o)=>{function n(e){const{unicode:t,fallback:o}=e;try{return t()}catch(n){return o}}o.d(t,{D_:()=>i,Ff:()=>r,V9:()=>n});const r=n({unicode:()=>/\p{L}/u,fallback:/[a-zA-Z]/});function i(e){return r.test(e)}},36867:(e,t,o)=>{o.d(t,{_:()=>a,g:()=>s});var n=o(7057),r=o(15157);const i="userSessionCount";function a(e){const t=c(e);if(!t)return void l({userId:e,count:1});const{count:o,updatedAt:r}=t;(0,n.$6)(r,!0)!==(0,n.$6)(Date.now(),!0)&&l({userId:e,count:o+1})}function s(e){if(!e)return 0;const t=c(e);return(null==t?void 0:t.count)||0}function l(e){let{userId:t,count:o}=e;const n={count:o,updatedAt:Date.now()};r.Z.set({userId:t,key:i,value:n})}function c(e){return r.Z.get({userId:e,key:i})}},85644:(e,t,o)=>{o.d(t,{AY:()=>a,iL:()=>i,zg:()=>r});var n=o(77080);function r(e){return i()&&e.isType("page")&&!e.isLocked()&&!e.isCollectionView()&&!e.isInsideCollection()&&!e.isAssociatedCollectionAPageTree()&&e.canEdit()}function i(){return n.default.checkGate("wiki_database")}function a(e){var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())??!1}},73819:(e,t,o)=>{o.d(t,{ez:()=>u,rv:()=>m});var n=o(67294),r=o(60177),i=o(64338),a=(o(480),o(97511),o(33125)),s=o(86628),l=o(24405),c=o(8848),d=(o(92650),o(67669),o(65598)),p=o(58202);o(99757);function u(e,t,o,s){const l=(0,r.Dl)();(0,i.q7)(null==l?void 0:l.domLock),(0,n.useImperativeHandle)(t,(()=>o),[o]),(0,a.c)(p.R,(()=>o),[o]);return e&&!(0,d.SJ)(e)?s:null}function m(e){const t=(0,l.Fg)();return(0,s.VK)((()=>{const o=e.getFormat().block_color||"default";return(0,c.fi)(o,t)}),[e,t])}},63474:(e,t,o)=>{o.d(t,{D:()=>a});var n=o(67294),r=o(480),i=o(24215);function a(){const e=(0,r.O7)();return(0,n.useMemo)((()=>(0,i.mc)(e)),[e])}},84398:(e,t,o)=>{o.d(t,{$:()=>a});var n=o(67294),r=o(26263),i=o(480);function a(e,t){const{cacheFallback:o,isMockTextStore:a,isTemporaryData:s,overrideDefaultRecordCache:l}=t??{},c=(0,i.O7)(),{inMemoryRecordCache:d}=c.defaultRecordCache,p=(0,n.useMemo)((()=>{const t=new r.Z({isTemporaryData:Boolean(s),name:e});return t.isMockTextStore=Boolean(a),o&&t.addCacheFallback(o),l&&d.addCacheOverride(t),t}),[o,d,a,s,e,l]);return(0,n.useEffect)((()=>function(){o&&p.removeCacheFallback(o),l&&d.removeCacheOverride(p)}),[o,d,p,l]),p}},2991:(e,t,o)=>{o.d(t,{Kd:()=>l,MH:()=>s});var n=o(67294),r=o(72126),i=o(24990),a=o(77907);const s=r.IH((async function(){const e=await a.deps.emojiData.loader();i.Z.setState(e)}));function l(){return window.__c={n:"LoadAndCacheEmojiData"},(0,n.useEffect)((()=>{s()}),[]),null}},35630:(e,t,o)=>{o.d(t,{AS:()=>s,iP:()=>l});var n=o(67294),r=o(480),i=o(86628);const a=(0,n.createContext)(void 0);function s(e){const t=(0,i.VK)((()=>e.state.height),[e]),o=(0,n.useContext)(a)||window;return o!==window?o.innerHeight:t}function l(){const{WindowSizeStore:e}=(0,r.O7)();return(0,i.VK)((()=>{const{width:t,height:o}=e.state;return{width:t,height:o}}),[e])}},5659:(e,t,o)=>{o.d(t,{A:()=>s});var n=o(92595),r=o(55652),i=o(4408),a=o(45950);const s=(0,n.exposeDebugValue)("offlineDebugger",new class{constructor(){var e=this;this.enableLogging=!1,this.operationLatency={},this.log=function(t){if(e.enableLogging){for(var o=arguments.length,n=new Array(o>1?o-1:0),r=1;r<o;r++)n[r-1]=arguments[r];console.groupCollapsed(t,...n),console.trace(),console.groupEnd()}},this.generateLocalRecordMap=a.yY,this.getLocalRecord=a.Ye,this.getLocalBlocksWithParent=a.Dx}async measure(e,t,o){var n=this;const i=`OFFLINE: ${e}:`;return this.operationLatency[e]||(this.operationLatency[e]=new r.s((function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n.log(i,...t)}))),this.operationLatency[e].measureErrors(t,"hit","miss",o)}trace(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];this.log("OFFLINE:",...t)}debug(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];this.log("OFFLINE:",...t)}traceMiss(e,t){for(var o=arguments.length,n=new Array(o>2?o-2:0),r=2;r<o;r++)n[r-2]=arguments[r];this.trace(`missed: record ${e}:${t}`,...n)}clearMemory(){i.LK(window.__console.environment)}})},76856:(e,t,o)=>{function n(e,t,o,n,r){const i="y"===r?"scrollTop":"scrollLeft",a=e[i],s=t-a,l=+new Date;let c=!0,d=null;const p=()=>{if(!c)return;window.requestAnimationFrame(p);const r=+new Date,u=Math.floor(function(e,t,o,n){return(e/=n/2)<1?o/2*e*e+t:-o/2*(--e*(e-2)-1)+t}(r-l,a,s,o));d?d===e[i]?(e[i]=u,d=e[i]):c=!1:(e[i]=u,d=e[i]),r>l+o&&(e[i]=t,c=!1,n&&n())};window.requestAnimationFrame(p)}o.d(t,{Z:()=>n})},75233:(e,t,o)=>{o.d(t,{Z:()=>r});o(21703);var n=o(26263);const r=new class{constructor(){this.pendingEvictions=void 0,this.environmentProvider=void 0,this.environmentProvider=()=>{throw new Error("Environment not ready")},this.pendingEvictions=new Map}getPendingEvictionCount(){return this.pendingEvictions.size}updateEnvironment(e){this.environmentProvider=()=>e}addToPendingEvictions(e,t){const o=(0,n.R)(e),r={...e,timestamp:t};this.pendingEvictions.set(o,r)}removeFromPendingEvictions(e){this.pendingEvictions.delete((0,n.R)(e))}forEachPendingEviction(e){for(const{pointer:t,userId:o,timestamp:n}of this.pendingEvictions.values())e({userId:o,pointer:t,timestamp:n,environment:this.environmentProvider()})}}},79420:(e,t,o)=>{o.d(t,{Z:()=>i});o(21703);var n=o(26263),r=o(21202);const i=new class{constructor(){this.subscribedRecords=void 0,this.pendingUnsubscribeRecords=void 0,this.environmentProvider=void 0,this.environmentProvider=()=>{throw new Error("Environment not ready")},this.subscribedRecords=new Map,this.pendingUnsubscribeRecords=new Map}getPendingUnsubscribeCount(){return this.pendingUnsubscribeRecords.size}updateEnvironment(e){this.environmentProvider=()=>e}getSubscriptionForRecord(e){return this.subscribedRecords.get((0,n.R)(e))}isSubscribedToRecord(e){const t=this.subscribedRecords.get((0,n.R)(e));return Boolean(t)}addToSubscribedRecords(e){const t=(0,n.R)(e),o={...e};this.subscribedRecords.set(t,o)}removeFromSubscribedRecords(e){const t=(0,n.R)(e);this.subscribedRecords.delete(t)}addToPendingUnsubscribeRecords(e,t){const o=(0,n.R)(e),r={...e,timestamp:t};this.pendingUnsubscribeRecords.set(o,r)}removeFromPendingUnsubscribeRecords(e){this.pendingUnsubscribeRecords.delete((0,n.R)(e))}forEachPendingUnsubscribeRecord(e){for(const{pointer:t,userId:o,timestamp:n}of this.pendingUnsubscribeRecords.values())e({userId:o,pointer:t,timestamp:n,environment:this.environmentProvider()})}reset(){this.subscribedRecords=new Map,this.pendingUnsubscribeRecords=new Map}safelyGetEnvironment(){try{return this.environmentProvider()}catch(e){return}}getSubscribedBlockDebuggingData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.safelyGetEnvironment();if(!t)return;const o={loadedBlockTypes:{},loaded:0,notLoaded:0};for(const[n,i]of this.subscribedRecords.entries())if((e||!this.pendingUnsubscribeRecords.has(n))&&i.pointer.table===r.iU){const e=t.defaultRecordCache.inMemoryRecordCache.getRecord(i);if(e&&e.value){const t=e.value.type;t in o.loadedBlockTypes||(o.loadedBlockTypes[t]=0),o.loadedBlockTypes[t]+=1,o.loaded+=1}else o.notLoaded+=1}return o}}},32223:(e,t,o)=>{o.r(t),o.d(t,{isConnected:()=>i.Mb,isConnecting:()=>i.J9,onMobileNativeReceiveRawMessageStoreMessage:()=>i.tD,onMobileNativeUpdateMessageStoreState:()=>i.Ce,resetRecordSubscriptions:()=>a,updateEnvironment:()=>s});var n=o(75233),r=o(79420),i=o(88536);function a(){r.Z.reset()}function s(e){r.Z.updateEnvironment(e),n.Z.updateEnvironment(e)}},88536:(e,t,o)=>{o.d(t,{vj:()=>Be,mb:()=>j,cO:()=>Pe,C$:()=>O,EM:()=>fe,ZN:()=>ye,Tm:()=>he,Mb:()=>ce,J9:()=>de,id:()=>pe,Ap:()=>De,tD:()=>Ce,Ce:()=>Ie,eg:()=>Re,Tg:()=>we,Ji:()=>Me,Ld:()=>Fe,hd:()=>Ee,r1:()=>je,L4:()=>Te,g4:()=>ue});o(21703);var n=o(40682),r=o(68626),i=(o(57658),o(7406)),a=o(29477),s=o(21051);const l=class{constructor(e){this.performRequests=void 0,this.batchSize=void 0,this.maxWorkers=void 0,this.maxDelayMs=void 0,this.timeSource=void 0,this.queue=[],this.workerTasks=new Map,this.nextWorkerId=0,this.currentWorkers=0,this.requestsRunning=0,this.awaitingTimeout=!1,this.dequeue=async()=>{if(this.currentWorkers>=this.maxWorkers||0===this.queue.length)return;const e=this.nextWorkerId;this.nextWorkerId++,this.currentWorkers++;const t=this.queue.splice(0,this.batchSize),o=t.map((e=>e[0]));let n,r;this.workerTasks.set(e,t),this.requestsRunning+=t.length;try{n=await this.performRequests(o)}catch(a){r=(0,i.tg)(a)}try{if(r)for(let e=0;e<t.length;e++){t[e][1].reject(r)}else if(n)for(let e=0;e<t.length;e++){const o=t[e],r=n[e];o[1].resolve(r)}}catch(a){}this.currentWorkers--,this.workerTasks.delete(e),this.requestsRunning-=t.length,this.dequeueAfterFilledBatchOrTimeout()};const{performRequests:t,batchSize:o,maxWorkers:n,maxDelayMs:r}=e;this.performRequests=t,this.batchSize=o,this.maxWorkers=n,this.maxDelayMs=r,this.timeSource=s.O}getStats(){return{queue:this.queue.length,running:this.requestsRunning,workers:this.currentWorkers}}updateTimeSource(e){this.timeSource=e}updateBatchSize(e){this.batchSize=e}updateMaxDelayMs(e){this.maxDelayMs=e}updateMaxWorkers(e){this.maxWorkers=e,this.dequeueAfterFilledBatchOrTimeout()}enqueue(e){const t=a.UZ();return this.queue.push([e,t]),this.dequeueAfterFilledBatchOrTimeout(),(0,n.m)({promise:t.promise,canCancel:()=>this.queue.some((e=>e[1]===t)),cancel:e=>{const o=this.queue.findIndex((e=>e[1]===t));o>=0&&(this.queue.splice(o,1),t.reject(e))}})}dequeueAfterFilledBatchOrTimeout(){this.queue.length>=this.batchSize?this.dequeue():this.awaitingTimeout||(this.awaitingTimeout=!0,this.timeSource.setTimeout((()=>{this.awaitingTimeout=!1,this.dequeue()}),this.maxDelayMs))}cancel(){const e=this.workerTasks,t=this.queue;this.workerTasks=new Map,this.queue=[];for(const o of e.values())for(const e of o)e[1].reject(new Error("CanceledTask."));for(const o of t)o[1].reject(new Error("CanceledTask."))}};var c=o(72126),d=o(91155),p=o(77897),u=o(75189),m=o(44615),g=o(4615),h=o(12139),f=o(63143),y=o(36054),v=o(95477),b=o(18245),S=o(5162),_=o(88632);const w=window.location.host.endsWith(v.default.publicDomainName);var k=o(1302),x=o(24215),I=o(77080);function C(e,t){k.default.afterNextFlush((()=>{I.default.checkGate("message_store_client_send_request_metric_enabled")&&x.j(e,"message_store.client.send_request",t)}))}const T=async()=>o.e(7168).then(o.bind(o,14854)),M=!1,P=90*f.C0,A=.5*f.C0,D=30*f.C0,B=10*f.C0,R={versions:!0,collection:!0,activity:!0,notification:!0,teams_in_space:!0,user_page_visit:!0,backlinks:!0,user_content:!0,page_visit:!0,user_shared_pages_in_space:!0,presence:!0,user_joined_teams_in_space:!0,teams_migration_completed_in_space:!0,diagnosticPing:!0,_other:!0};function E(e){const t=e.indexOf("/");if(-1===t)return"_other";const o=e.substring(0,t);return o in R?o:"_other"}function F(e,t){var o;const n=E(t),r=null===(o=(0,m.pz)(t))||void 0===o?void 0:o.table,i=e[n];if(i){if(r){const e=i[r];if(!e)return void Ye(`Warning: "${n}.${r}" has no existing counters!`);i[r]=e-1}i._total-=1,e._total-=1}else Ye(`Warning: "${n}" has no existing counters!`)}function N(e){return{_id:e,charactersSent:0,requestsSent:0,requestsTimedOut:0,responsesReceivedWithoutHandlers:0,successfulResponsesReceived:0,unsuccessfulResponsesReceived:0,invalidMessagesReceived:0,notificationsReceived:0,messagesReceived:0}}function j(){return{...re}}function O(e){const t=re;if(e._id===t._id)return{charactersSent:t.charactersSent-e.charactersSent,requestsSent:t.requestsSent-e.requestsSent,requestsTimedOut:t.requestsTimedOut-e.requestsTimedOut,responsesReceivedWithoutHandlers:t.responsesReceivedWithoutHandlers-e.responsesReceivedWithoutHandlers,successfulResponsesReceived:t.successfulResponsesReceived-e.successfulResponsesReceived,unsuccessfulResponsesReceived:t.unsuccessfulResponsesReceived-e.unsuccessfulResponsesReceived,invalidMessagesReceived:t.invalidMessagesReceived-e.invalidMessagesReceived,notificationsReceived:t.notificationsReceived-e.notificationsReceived,messagesReceived:t.messagesReceived-e.messagesReceived}}const L=new Map,U=new Map;class Z extends Map{isCancelable(e){return Boolean(this.getCancelable(e))}getCancelable(e){const t=this.get(e);if(null!=t&&t.canCancel())return t}}const V=new Z,q=new Z,z=new Map,W=new Map,H=Date.now();let G={_total:0};const K="messageStoreInternals",$=new r.BatchedLogger({from:K,type:"BulkDebug",level:"info",maxLength:250,logToConsole:M});let Y,Q,J,X,ee=0,te=0,oe=0,ne=0,re=N(0),ie=0,ae=s.O,se=!1,le="uninitialized";function ce(){return"open"===le}function de(){return"uninitialized"===le||"opening"===le}const pe=!0;function ue(e,t){let o=W.get(e);o||(o={},W.set(e,o)),Object.assign(o,t)}function me(e){$.log({level:"info",from:K,type:e})}function ge(){Q=function(e){var t;const o=null==e||null===(t=e.socket)||void 0===t||null===(t=t.transport)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.transport;if("websocket"===o||"polling"===o)return o}(this),me(`ping:${Q}`),Y=Date.now(),Ye(`Incoming primus ping received from server via ${Q}.`)}function he(){return G}function fe(){return{...Oe.getStats(),batchSubscribeQueue:Ue.getStats(),batchUnsubscribeQueue:Ze.getStats()}}function ye(e){const{lastOfflineTimestamp:t}=_.Z.getState(),o=fe(),{batchSubscribeQueue:n,batchUnsubscribeQueue:r}=o;return{currentConnectionCounters:re,timeSinceLastIncomingPing:Y&&e-Y,lastIncomingPingTransportType:Q,timeSinceLastResponseReceived:J&&e-J,timeSinceLastReadyStateChange:X&&e-X,timeSinceLastOffline:t&&e-t,largestMessageSize:ie||void 0,messageStoreRequestsQueued:o.queue,messageStoreRequestsRunning:o.running,batchSubscribeQueue:n,batchUnsubscribeQueue:r,messageStoreConnectionState:le,uptime:e-H,subscriptionCounters:G,primusEndEventsReceived:te,primusErrorEventsReceived:oe,connectionResetsDueToFailedRequests:ne}}function ve(e){switch($.log({level:"info",from:K,type:"readyStateChange",data:{message:e}}),X=Date.now(),e){case"end":le="closed";break;case"open":le="open";break;case"opening":le="opening"}}const be=c.HP((e=>async function(e){if(w)return;if(Ke(e))return void r.log({level:"warning",from:K,type:"CreatePrimusClientCalledForNativeMessageStoreClient"});ee+=1;const{createClient:t}=await T(),o=t({minReconnectDelayMs:4*f.C0,maxReconnectDelayMs:8*f.C0});return o.on("data",He),o.on("open",(()=>{me("open"),Se(e)})),o.on("reconnected",(e=>{xe(),$.log({level:"info",from:K,type:"reconnected",data:{message:`Reconnected in ${null==e?void 0:e.duration} ms`}})})),o.on("reconnect",(()=>{me("reconnect")})),o.on("reconnect scheduled",(e=>{$.log({level:"info",from:K,type:"reconnect scheduled",data:{message:`Reconnecting in ${null==e?void 0:e.scheduled} ms, attempt ${null==e?void 0:e.attempt} of ${null==e?void 0:e.retries}`}})})),o.on("reconnect timeout",(()=>{me("reconnect timeout")})),o.on("reconnect failed",(()=>{me("reconnect failed")})),o.on("timeout",(()=>{me("timeout")})),o.on("destroy",(()=>{me("destroy")})),o.on("close",(()=>{me("close")})),o.on("online",(()=>{me("online")})),o.on("offline",(()=>{me("offline")})),o.on("error",(e=>{let t;t="TransportError"===e.type?{level:"info",from:K,type:"primusTransportError",error:(0,d.Ui)(e)}:{level:"error",from:K,type:"unknownPrimusError",error:(0,d.Ui)(e)};(0,p.lB)(1)&&r.rateLimitedLog(t),$.log(t),oe+=1})),o.on("incoming::ping",ge),o.on("readyStateChange",ve),o.on("end",(()=>{me("end"),o.off("readyStateChange",ve),te+=1,async function(e,t){var o,n;r.log({level:"info",from:K,type:"messageStoreEnd",error:{message:`SocketId: ${null==e||null===(o=e.socket)||void 0===o?void 0:o.id} Query:${null==e||null===(n=e.transport)||void 0===n?void 0:n.query}`}}),ke(),ae.setTimeout((()=>{void 0!==e&&e.destroy()}),0);const i=await be(t);if(e!==i)return;be.cache.clear(),ae.setTimeout((()=>{be(t)}),2*f.C0)}(o,e)})),window.__primusClient=o,o}(e)),(function(){return"primus"}));function Se(e){re=N(re._id+1),L.forEach(((t,o)=>{const n=U.get(o);Ae(o,n?n.version:-1,e).catch((e=>{r.log({level:"warning",from:K,type:"ReconnectSubscriptionError",error:(0,d.Ui)(e)})}))}))}let _e;function we(e){if(_e)throw new Error("Having more than one onRestartMessageStoreConnectionHandler is not currently supported");_e=e}function ke(){var e;se=!1,Ue.cancel(),Ze.cancel(),function(){for(const e of z.values())window.clearTimeout(e.timeout);z.clear()}(),V.clear(),q.clear(),Ve.cancel(),Oe.cancel(),W.clear(),G={_total:0},null===(e=_e)||void 0===e||e()}function xe(){ke()}function Ie(e,t){if(!Ke(t))return;Ye("onMobileNativeUpdateMessageStoreState",e);const o=!("open"===le)&&"open"===e;o&&xe(),ve(e),o&&Se(t)}function Ce(e,t){if(!Ke(t))return;const o=JSON.parse(e);Ye("onMobileNativeReceiveRawMessageStoreMessage",o),ce()||Ie("open",t),He(o)}async function Te(e){var t;const{key:o,field:n,updates:r,ttl:i,environment:a}=e;await(null===(t=We({method:"updateField",request:{key:o,field:n,updates:r,ttl:i},environment:a}))||void 0===t?void 0:t.response)}async function Me(e){var t;const{key:o,field:n,value:r,ttl:i,environment:a}=e;await(null===(t=We({method:"setField",request:{key:o,field:n,value:r,ttl:i},environment:a}))||void 0===t?void 0:t.response)}async function Pe(e){if(w)return{type:"messageStoreDisabled"};const t=(0,g.ZP)(),{environment:o}=e,n=(0,m.JK)(t),r="diagnosticPing",i=a.UZ(),s=e.logToConsole??M,l={};function c(e,t){l[e]=t,s&&console.log(`diagnosticPing ${e}=${t}`)}const d=await a.aM(async function(){var e;const a=performance.now();await Fe(n,((e,t)=>{t&&i.resolve(performance.now())}),r,o);const s=performance.now(),d=s-a;c("registerSubscriptionResponseMs",d);const p=await(null===(e=We({method:"diagnosticPing",request:{id:t},environment:o,onRequestSent:()=>{c("diagnosticPingEnqueuedMs",performance.now()-s)}}))||void 0===e?void 0:e.response);if(!p)return{type:"canceled",key:n,...l};const u=function(e){const t=l[e];if(void 0===t)throw new Error(`Assertion failure, expected timing for "${e}" to be defined`);return t}("diagnosticPingEnqueuedMs"),m=p.setValueTime;c("diagnosticPingServerSideSetValueMs",m);const g=performance.now()-s;c("diagnosticPingResponseMs",g);const h=await i.promise-s;c("diagnosticPingNotificationMs",h);const f=performance.now();await je(n,r,o);const y=performance.now();return{type:"success",key:n,registerSubscriptionResponseMs:d,diagnosticPingEnqueuedMs:u,diagnosticPingServerSideSetValueMs:m,diagnosticPingResponseMs:g,diagnosticPingNotificationMs:h,unregisterSubscriptionResponseMs:y-f,totalMs:y-a}}().catch((e=>(h.rn(e,{from:K,type:"diagnosticPingError",data:{key:n}}),{type:"error",key:n,...l}))),D);return d.timeout?{type:"timeout",key:n,...l}:d.result}async function Ae(e,t,o){pe&&ue(e,{latestRegisterSubscriptionRequestTimestamp:Date.now()}),function(e,t){var o;const n=E(t),r=null===(o=(0,m.pz)(t))||void 0===o?void 0:o.table;let i=e[n];if(i||(i={_total:0},e[n]=i),r){const e=i[r]||0;i[r]=e+1}i._total+=1,e._total+=1}(G,e);const n=q.getCancelable(e);if(n)n.cancel(new Error("Cancelled by sendRegisterSubscription()"));else{const n={key:e,version:t},r=Ue.enqueueCancelable({request:n,environment:o});if(r){V.set(e,r.asyncQueuePromise);try{await r.response}finally{V.delete(e)}}}pe&&ue(e,{latestRegisterSubscriptionResponseTimestamp:Date.now()})}function De(e){return V.isCancelable(e)}function Be(e,t){const o=V.getCancelable(e);if(!o)throw new Error(`Assertion failure, subscription request for key ${e} does not exist or is not cancelable`);Ne(e,t)&&(F(G,e),o.cancel(new Error("Cancelled by cancelRegisterSubscription()")),pe&&W.delete(e))}async function Re(e,t,o){var n;await(null===(n=We({method:"registerOnDisconnect",request:{disconnectId:e,operations:t},environment:o}))||void 0===n?void 0:n.response)}async function Ee(e,t){var o;await(null===(o=We({method:"unregisterOnDisconnect",request:{disconnectId:e},environment:t}))||void 0===o?void 0:o.response)}async function Fe(e,t,o,n){if(w)return;let r=L.get(e);if(!r||0===r.length)return r=[{listener:t,listenerId:o}],L.set(e,r),void(ce()?await Ae(e,-1,n):"uninitialized"!==le||Ke(n)||await be(n));if(r.find((e=>e.listenerId===o)))r=[...r.filter((e=>e.listenerId!==o)),{listener:t,listenerId:o}],L.set(e,r);else{r=[...r,{listener:t,listenerId:o}],L.set(e,r);const n=U.get(e);n&&t(e,n.value,n.passThroughData)}}function Ne(e,t){if(w)return!1;const o=L.get(e);if(!o)return!1;const n=o.filter((e=>e.listenerId!==t));return n.length!==o.length&&(0===n.length?(L.delete(e),U.delete(e),!0):(L.set(e,n),!1))}async function je(e,t,o){Ne(e,t)&&ce()&&await async function(e,t){pe&&ue(e,{latestUnregisterSubscriptionRequestTimestamp:Date.now()}),F(G,e);const o=V.getCancelable(e);if(o)o.cancel(new Error("Cancelled by sendUnregisterSubscription()"));else{const o={key:e},n=Ze.enqueueCancelable({request:o,environment:t});if(n){q.set(e,n.asyncQueuePromise);try{await n.response}finally{q.delete(e)}}}pe&&W.delete(e)}(e,o)}const Oe=new n.z(20);class Le{constructor(e,t){this.queue=void 0,this.wrappedPerformRequests=async e=>{const t=e[0].environment;Ye(`Sending a batch of ${e.length} ${this.methodName} requests.`);const o=this.performRequests(t,e.map((e=>e.request)));if(!o)throw new Error("MessageStore is disabled.");const n=await o;if(!n)throw new Error("Request cancelled.");return n},this.methodName=e,this.performRequests=t,this.queue=new l({performRequests:this.wrappedPerformRequests,batchSize:250,maxDelayMs:A,maxWorkers:1})}updateTimeSource(e){this.queue.updateTimeSource(e)}getStats(){return this.queue.getStats()}cancel(){this.queue.cancel()}enqueueCancelable(e){if(w)return;const t=this.queue.enqueue(e),o=t.catch((e=>{Ye(`enqueueCancelable() for ${this.methodName} cancelled (${e.message})`)}));return{asyncQueuePromise:t,response:o}}}const Ue=new Le("registerSubscription",((e,t)=>Ve.enqueue((async()=>{var o;const n=We({method:"registerBatchSubscriptions",request:{subscriptions:t},environment:e});return null===(o=await(null==n?void 0:n.response))||void 0===o?void 0:o.responses})))),Ze=new Le("unregisterSubscription",((e,t)=>Ve.enqueue((async()=>{var o;const n=We({method:"unregisterBatchSubscriptions",request:{keys:t.map((e=>e.key))},environment:e});return null===(o=await(null==n?void 0:n.response))||void 0===o?void 0:o.keys.map((e=>({key:e})))})))),Ve=new n.z(1);let qe;function ze(){if(!qe)return;const{totalRequests:e,requestCounts:t,startTime:o}=qe;Ye("checkRequestThroughputForBurstWarning requestCounts =",t),e>3e3&&r.log({level:"warning",from:K,type:"BurstThroughputExceeded",data:{time:Date.now()-o,totalRequests:e,requestCounts:t}}),qe=void 0}function We(e){if(w)return;const{method:t,request:o,environment:n}=e,r=b.default.mark("message_store.client.send_request.in_queue_time");C(n,{status:"enqueued",endpoint:t}),pe&&function(e){qe||(qe={startTime:Date.now(),totalRequests:0,requestCounts:{}},ae.setTimeout(ze,B)),qe.totalRequests+=1,qe.requestCounts[e]=(qe.requestCounts[e]||0)+1}(t);const i=Oe.enqueue((()=>{var i;const s=(0,g.ZP)();!function(e,t){k.default.afterNextFlush((()=>{I.default.checkGate("message_store_client_send_request_metric_enabled")&&(x.j(e,"message_store.client.send_request.queue_running_size",{value:t.running}),x.j(e,"message_store.client.send_request.queue_backup_size",{value:t.queue}))}))}(n,Oe.getStats());const l=b.default.mark("message_store.client.send_request.round_trip_time");b.default.measure(r,{environment:n,data:{endpoint:t}});const c=a.UZ(),d=Date.now(),p=pe?window.setTimeout((()=>{"open"===le&&(re.requestsTimedOut+=1,$.log({level:"info",from:K,type:"requestTimeout",data:{requestId:s,time:Date.now()-d}}))}),P):void 0;z.set(s,{resolve:c.resolve,reject:c.reject,timeout:p,sendTime:d}),$.log({level:"info",from:K,type:"requestSent",data:{requestId:s,method:t}});const u={type:`${v.default.messageStore.api}/${t}`,requestId:s,...o};return re.requestsSent+=1,async function(e){const{message:t,environment:o}=e,n=Ge(o),r=JSON.stringify(t);re.charactersSent+=r.length,ie<r.length&&(ie=r.length);if(n)n(r);else{const e=await be(o);null==e||e.write(t)}}({message:u,environment:n}),null===(i=e.onRequestSent)||void 0===i||i.call(e),c.promise.then((e=>{b.default.measure(l,{environment:n,data:{endpoint:t}}),C(n,{status:"success",endpoint:t})})).catch((e=>{const o=Oe.getStats();C(n,{status:"failure",endpoint:t,queue_running_size:o.running,queue_backup_size:o.queue})})),c.promise}));return{response:i.catch((e=>{e instanceof $e&&!Ke(n)&&!se?(se=!0,ne+=1,me("connectionResetDueToFailedRequest"),be(n).then((e=>{null==e||e.end()})),Ye(`sendRequest() for ${t} returned server error (${e.message}), resetting connection`,o)):Ye(`sendRequest() cancelled or errored for ${t} (${e.message})`,o)})),asyncQueuePromise:i}}function He(e){re.messagesReceived+=1;const t=(0,y.Gu)(u.yx,e);if(t)return re.invalidMessagesReceived+=1,void r.rateLimitedLog({level:"warning",from:K,type:"ValidationError",data:{miscDataToConvertToString:e},error:(0,d.Ui)(t)});const o=e;if("response"===o.type){var n;const{requestId:e,status:t,result:r}=o,i=z.get(e);if(z.delete(e),$.log({level:"info",from:K,type:"responseReceived",data:{requestId:e,response:t,time:i&&Date.now()-i.sendTime,internalProcessingTimeMs:null===(n=o.result)||void 0===n?void 0:n.internalProcessingTimeMs}}),!i)return void(re.responsesReceivedWithoutHandlers+=1);J=Date.now(),window.clearTimeout(i.timeout),"ok"===t?(re.successfulResponsesReceived+=1,i.resolve(r)):(re.unsuccessfulResponsesReceived+=1,i.reject(new $e(r)))}else{re.notificationsReceived+=1;const{key:e,value:t,version:n,passThroughData:a}=o,s=L.get(e);if(!s)return;U.set(e,{version:n,value:t,passThroughData:a});for(const{listener:o}of s)try{o(e,t,a)}catch(i){r.log({level:"warning",from:K,type:"ListenerError",error:(0,d.Ui)(i)})}}}function Ge(e){var t;if((0,S.Y)("supportsNativeMessageStore"))return e&&(null===(t=e.mobileNative)||void 0===t?void 0:t.api.sendRawMessageStoreMessage)}function Ke(e){return Boolean(Ge(e))}class $e extends Error{constructor(e){super(e),this.name="FailedMessageStoreRequestError"}}function Ye(){}},2688:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(41641),r=o(88536);const i=new class{constructor(){this.subscriptionCount=0}addListener(e,t,o,i){if((0,n.Z)(e))return this.subscriptionCount+=1,o||(o=`subscription:${this.subscriptionCount}`),r.Ld(e,t,o,i),{key:e,subscriptionId:o}}removeListener(e,t){let{key:o,subscriptionId:i}=e;(0,n.Z)(o)&&r.r1(o,i,t)}async updateField(e,t,o,n,i){await r.L4({key:e,field:t,updates:o,ttl:n,environment:i})}async setField(e,t,o,n,i){await r.Ji({key:e,field:t,value:o,ttl:n,environment:i})}async onDisconnect(e,t,o,n){const i=`${o}/${e}`;await r.eg(i,t,n)}async clearOnDisconnect(e,t,o){const n=`${t}/${e}`;await r.hd(n,o)}}},84709:(e,t,o)=>{o.r(t),o.d(t,{subscribe:()=>w,unsubscribe:()=>T,unsubscribeAfterDelay:()=>A,unsubscribeForAllUsers:()=>I});o(21703);var n=o(1302),r=o(92595),i=o(68626),a=o(44615),s=o(63143),l=o(41641),c=o(4408),d=(o(95477),o(5315)),p=(o(57658),o(77897),o(29477),o(4615),o(50906),o(54642),o(79420)),u=o(88536);const m=60*s.C0,g=15*s.C0;s.C0;class h{constructor(e){this.map=new Map,this.timeoutMs=e}set(e){const{key:t,onTimeout:o,onClear:n,value:r}=e;this.clear(t);const i=window.setTimeout((()=>{this.map.delete(t),null==o||o()}),this.timeoutMs);this.map.set(t,{timeout:i,value:r,onClear:n})}get(e){var t;return null===(t=this.map.get(e))||void 0===t?void 0:t.value}clear(e){const t=this.map.get(e);var o;void 0!==t&&(window.clearTimeout(t.timeout),this.map.delete(e),null===(o=t.onClear)||void 0===o||o.call(t))}has(e){return this.map.has(e)}}const f=new h(m),y=new h(g);var v=o(75233),b=o(2688);const S="recordSubscriptionActions";function _(e,t,o){const n=a.pz(t);if(!n)return void i.rateLimitedLog({level:"warning",from:"handleRemoteVersionUpdate",type:"ValidationError",data:{key:t,miscDataToConvertToString:{version:o}}});if(null!==o&&"number"!=typeof o)return void i.rateLimitedLog({level:"warning",from:"handleRemoteVersionUpdate",type:"ValidationError",data:{key:t,miscDataToConvertToString:{pointer:n,version:o}}});const r=[void 0,...e.currentUser.loggedInUserIds];u.id&&((0,u.g4)(t,{latestUpdateTimestamp:Date.now()}),function(e){const t=f.get(e);t&&(t.latestUpdate=Date.now()),y.clear(e)}(t));for(const i of r){if(p.Z.getSubscriptionForRecord({userId:i,pointer:n})){const t=e.defaultRecordCache.inMemoryRecordCache.getVersion({pointer:n,userId:i}),r=d.transactionQueue.isPendingTransactionForRecord(n);(null===o||o>t)&&!r&&c.bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:n,userId:i})}}}function w(e){const{pointer:t,userId:o,environment:r}=e,i={pointer:t,userId:o};k(t)||(p.Z.removeFromPendingUnsubscribeRecords(i),v.Z.removeFromPendingEvictions(i),p.Z.isSubscribedToRecord(i)||(p.Z.addToSubscribedRecords(i),n.default.afterNextFlush((()=>{const n=r.defaultRecordCache.inMemoryRecordCache.getRecord(i);n?x({record:n,...e}):c.bG({environment:r,inMemoryRecordCache:r.defaultRecordCache.inMemoryRecordCache,userId:o,pointer:t}).then((t=>{x({record:t,...e})}))}))))}function k(e){return!e.id||!e.table||("emptyDroppableKey"===e.id||"placeholder"===e.id)}function x(e){const{environment:t,pointer:o,userId:n,record:r}=e,s={pointer:o,userId:n};if(!p.Z.isSubscribedToRecord(s))return;const c=a.ZS(o);(0,l.Z)(c)&&(o.id&&o.table?b.Z.addListener(c,((e,o)=>_(t,e,o)),S,t):i.rateLimitedLog({level:"warning",from:"recordSubscriptionActions:subscribe",type:"KeyValidationError",data:{pointer:o,miscDataToConvertToString:{record:r,key:s,versionsKey:c}}}))}function I(e){for(const t of e.environment.currentUser.loggedInUserIds)T({...e,userId:t})}function C(e){const{pointer:t}=e;if(k(t))return!1;if(!p.Z.isSubscribedToRecord(e))return!1;p.Z.removeFromSubscribedRecords(e);const o=a.ZS(t);return!!(0,l.Z)(o)&&(!(!t.id||!t.table)||(i.rateLimitedLog({level:"warning",from:"recordSubscriptionActions:unsubscribe",type:"KeyValidationError",data:{pointer:t,miscDataToConvertToString:{versionsKey:o}}}),!1))}function T(e){const{environment:t}=e;C(e)&&b.Z.removeListener({key:a.ZS(e.pointer),subscriptionId:S},t)}const M=2*s.hM,P=M;function A(e){const{pointer:t,environment:o,userId:n}=e;if(k(t))return;if(o.defaultRecordCache.inMemoryRecordCache.hasListener(t))return;const r=a.ZS(t);if((0,u.Ap)(r)){const e={pointer:t,userId:n};return v.Z.addToPendingEvictions(e,Date.now()+P),void(C(e)&&(0,u.vj)(r,S))}p.Z.addToPendingUnsubscribeRecords(e,Date.now()+M)}function D(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];p.Z.forEachPendingUnsubscribeRecord((o=>{let{pointer:n,userId:r,timestamp:i,environment:a}=o;if(i<e){p.Z.removeFromPendingUnsubscribeRecords({pointer:n,userId:r});const e={pointer:n,userId:r};t&&console.log("Unsubscribing and evicting",JSON.stringify(n)),a.defaultRecordCache.inMemoryRecordCache.deleteRecord(e),T({pointer:n,userId:r,environment:a})}})),v.Z.forEachPendingEviction((o=>{let{pointer:n,userId:r,timestamp:i,environment:a}=o;if(i<e){v.Z.removeFromPendingEvictions({pointer:n,userId:r});const e={pointer:n,userId:r};t&&console.log("Evicting",JSON.stringify(n)),a.defaultRecordCache.inMemoryRecordCache.deleteRecord(e)}}))}setInterval((()=>{D(Date.now())}),1e4),(0,r.exposeDebugValue)("forceUnsubscribeAndEvictPendingRecords",(()=>{D(1/0,!0)})),setTimeout((()=>{(0,u.Tg)((()=>{p.Z.forEachPendingUnsubscribeRecord((e=>{let{pointer:t,userId:o,timestamp:n,environment:r}=e;p.Z.removeFromPendingUnsubscribeRecords({pointer:t,userId:o});const i={pointer:t,userId:o};v.Z.addToPendingEvictions(i,n),T({pointer:t,userId:o,environment:r})}))}))}),0)},91948:(e,t,o)=>{o.d(t,{Z:()=>s});o(67294);var n=o(86628),r=o(85248),i=o(17294),a=o(85893);function s(e){let{targetRecordId:t,style:o}=e;window.__c={n:"MoveOrDuplicateProgress"};const s=(0,n.VK)((()=>i.Z.state[t]),[t]);if(!s)return null;const{taskStatus:l,completeBlocks:c,totalBlocks:d}=s,p=(()=>{switch(l){case"not_started":case"failure":return;case"success":return 100;case"in_progress":if("number"!=typeof c||"number"!=typeof d)return;if(0===d)return;const e=c/d;return 1===e?99:Math.round(100*e)}})();return"number"!=typeof p?null:(0,a.jsx)(r.k,{percentage:p,style:o})}},98110:(e,t,o)=>{o.d(t,{Z:()=>m});var n=o(67294),r=o(480),i=o(86628),a=o(15145),s=o(5366),l=o(75018),c=o(6854),d=o(73744),p=o(35683),u=o(85893);function m(e){window.__c={n:"MoveToSnackbarButtons"};const t=(0,r.O7)(),o=(0,i.VK)((()=>!t.device.isPhone),[t]);return(0,u.jsxs)(u.Fragment,{children:[o&&(0,u.jsx)(g,{...e}),(0,u.jsx)(c.ow,{onUndo:void 0})]})}function g(e){let{moveToLocation:t,movedItems:o}=e;window.__c={n:"MoveToVisitButton"};const i=(0,r.O7)(),m=(0,n.useCallback)((e=>{var n;if(t)switch(t.type){case"moveToBlock":l.navigateToBlock({environment:i,openInNew:d.DJ(e),store:t.blockStore,scrollToBlockId:null===(n=o[0])||void 0===n?void 0:n.id,visitType:p.vu.Link,pageVisitSource:a.tY.Move})}}),[i,t,o]);return t&&"moveToBlock"===t.type?(0,u.jsx)(c.Pn,{onClick:m,children:(0,u.jsx)(s.FormattedMessage,{defaultMessage:"Visit",id:"moveToHelpers.afterMoveToast.viewButton"})}):null}},55081:(e,t,o)=>{o.d(t,{EV:()=>Z,Ex:()=>j,I1:()=>L,Mf:()=>O,Qt:()=>q,VW:()=>V,lp:()=>U,xN:()=>N,yH:()=>F,zJ:()=>R});o(67294);var n=o(79946),r=o(7406),i=o(68626),a=o(59730),s=o(15157),l=o(89101),c=o(15047),d=o(77858),p=o(19889),u=o(5366),m=o(50906),g=o(47307),h=o(94273),f=o(92625),y=o(97977),v=o(9953),b=o(75018),S=o(70782),_=o(64369),w=o(33954),k=o(24608),x=o(33929),I=o(38755),C=o(77907),T=o(74948),M=o(80444),P=o(35661),A=o(10929),D=o(75538),B=o(85893);async function R(e,t){if(!e.currentUser.id)return!1;const o=E(e);return!!A.BB(o)||(t||(t=new P.U6(e,{table:p.KJ,id:e.currentUser.id}),await t.awaitNonNullValue()),!t.getOnboardingCompleted())}function E(e){return{...s.Z.get({userId:e.currentUser.id,key:D.onboardingPreferenceKey}),currentUserId:e.currentUser.id}}async function F(e,t){const{state:o}=D.default;if(o.isLoading||o.isOnboarding||!e.currentUser.id)return;const n=E(e);if(!n.isOnboarding)return;if(A.NT(n)&&t&&(null==t?void 0:t.id)!==n.spaceViewId)return;const{flow:r}=n,a="desktop_join_or_create_space"===r||"mobile_join_or_create_space"===r,s=await A.dD({environment:e,disableRedirects:a});s&&(n.onboardingData=s),D.default.setState(n);const{spaceId:l}=n;if(l&&(e.device.isMobileNative&&i.log({level:"info",from:"onboardingActions",type:"SpaceSwitchingDebug",data:{message:"onboardingActions.restoreOnboardingState setting space",spaceId:l}}),M.default.setState({...M.default.state,currentSpaceStore:new P.H2(e,{table:c.bx,id:l})})),n.isOnboarding&&"spaceViewId"in n&&n.spaceViewId){const t=new P.V9(e,{table:d.zU,id:n.spaceViewId});M.default.setState({...M.default.state,currentSpaceViewStore:t})}z(e,n)}async function N(e){await L(e,{type:"create-or-join"})}const j=function(e){const{userStore:t,transaction:o}=e;v.sW({store:t,data:{onboarding_completed:!0},transaction:o})},O=function(e){const{userStore:t,transaction:o}=e;v.sW({store:t,data:{mobile_onboarding_completed:!0},transaction:o})};async function L(e,t){try{b.navigate({environment:e,url:l._j.onboarding});const o=await A.dD({environment:e,disableRedirects:Boolean(t.disableRedirectUrl)||"create-or-join"===t.type}),r=A.Pn(o),i=await C.deps.onboardingStateActions.loader(),a=await i.getInitialState(e,t,o,r);if(a&&a.isOnboarding){"invalid"===r.type&&(a.stage="error"),D.default.setState(a);const t=A.jn(a);m.NGq(e,t),m.y6P(e,t),z(e,a),a.isNewUser&&(n.I$(),n.j(e.device,{facebook:{eventName:"CompleteRegistration"},google:{eventName:"registration"}}))}}catch(o){const t=(0,r.tg)(o);!function(e,t,o){D.default.setState({...D.default.state,isLoading:!1}),m.GkL(e,{...A.jn(D.default.state),errorMessage:t.message}),i.log({level:"error",from:"onboardingActions",type:"handleError",error:{message:`Found onboarding error: ${t.message}`}});const n=o?async()=>await y.actuallyLogoutAndDeleteAllLocalData({environment:e}):void 0;g.showMessage({message:t.message,onAccept:n})}(e,t,"WorkspaceCreationError"===t.name&&(0,a.Zw)(t)&&t.data.newUser)}}async function U(e,t){if(t.isOnboarding)try{const o=await C.deps.onboardingStateActions.loader(),n=await o.updateAndGetNextState(t,e);m.y6P(e,A.jn(n)),D.default.setState(n),n.isOnboarding&&z(e,n)}catch(o){Z(e,(0,r.tg)(o))}}async function Z(e,t){if(D.default.setState({...D.default.state,isLoading:!1}),i.log({level:"error",from:"onboardingActions",type:"handleOnboardingError",error:{message:`Found onboarding error: ${t.message}`,stack:String(t.stack)}}),f.x(),t instanceof k.Gg&&(0,a.Rp)(t.data.responseBody)&&"UnauthorizedError"===t.data.responseBody.name)return void m.hov(e,{...A.jn(D.default.state),errorMessage:t.message,debugMessage:"UnauthorizedError"});let o;if(t instanceof k.Gg){var n;const e=null==t||null===(n=t.data)||void 0===n||null===(n=n.responseBody)||void 0===n?void 0:n.clientData;e&&(o=(0,w.XN)(x.default.getIntl(),e))}m.hov(e,{...A.jn(D.default.state),errorMessage:t.message,debugMessage:o||"undefined"});await g.confirmUserAction({message:(0,B.jsxs)("div",{children:[(0,B.jsx)(_.Z,{style:{fontSize:17,fontWeight:500,lineHeight:"24px",paddingBottom:8},children:(0,B.jsx)(u.FormattedMessage,{defaultMessage:"Oops, something went wrong.",id:"onboardingActions.onboardingErrorDialog.message"})}),(0,B.jsx)("div",{children:o??t.message})]}),acceptLabel:(0,B.jsx)(u.FormattedMessage,{defaultMessage:"Start over",id:"onboardingActions.onboardingErrorDialog.startOverButton.label"}),cancelLabel:(0,B.jsx)(u.FormattedMessage,{defaultMessage:"Close",id:"onboardingActions.onboardingErrorDialog.closeButton.label"})})&&function(e,t){const o=D.default.state;A.n0(o)?L(e,{type:"new-user",disableRedirectUrl:!0}):A.y7(o)?L(e,{type:"create-or-join",disableRedirectUrl:!0}):e.device.isMobile?L(e,{type:"mobile-onboarding",disableRedirectUrl:!0}):i.log({level:"error",from:"onboardingActions",type:"handleOnboardingError",error:{message:`Could not redirect onboarding: ${t.message}`,stack:String(t.stack)}})}(e,t)}async function V(e){const{state:t}=D.default;if(A.n0(t)){if(!(await g.confirmUserAction({message:(0,B.jsxs)("div",{style:{display:"block"},children:[(0,B.jsx)("div",{style:{fontWeight:600},children:(0,B.jsx)(u.FormattedMessage,{defaultMessage:"Cancel new account setup?",id:"onboardingActions.closeOnboardingDialog.newUser.title"})}),(0,B.jsx)("div",{children:(0,B.jsx)(u.FormattedMessage,{defaultMessage:"You'll be taken back to the Notion home page.",id:"onboardingActions.closeOnboardingDialog.newUser.subtitle"})})]}),acceptLabel:(0,B.jsx)(u.FormattedMessage,{defaultMessage:"Return to home page",id:"onboardingActions.closeOnboardingDialog.newUser.confirmCloseButton.label"}),cancelLabel:(0,B.jsx)(u.FormattedMessage,{defaultMessage:"Continue setup",id:"onboardingActions.closeOnboardingDialog.newUser.continueButton.label"})})))return;m.BLZ(e,A.jn(t)),await y.actuallyLogoutAndDeleteAllLocalData({environment:e})}else{if(!(await g.confirmUserAction({message:(0,B.jsxs)("div",{style:{display:"block"},children:[(0,B.jsxs)("div",{style:{fontWeight:600},children:[" ",(0,B.jsx)(u.FormattedMessage,{defaultMessage:"Cancel new workspace setup?",id:"onboardingActions.closeOnboardingDialog.existingUser.title"})]}),(0,B.jsx)("div",{style:{wordBreak:"keep-all"},children:(0,B.jsx)(u.FormattedMessage,{defaultMessage:"You'll be taken back to your previous workspace.",id:"onboardingActions.closeOnboardingDialog.existingUser.subtitle"})})]}),acceptLabel:(0,B.jsx)(u.FormattedMessage,{defaultMessage:"Back to previous workspace",id:"onboardingActions.closeOnboardingDialog.existingUser.confirmCloseButton.label"}),cancelLabel:(0,B.jsx)(u.FormattedMessage,{defaultMessage:"Continue setup",id:"onboardingActions.closeOnboardingDialog.existingUser.continueButton.label"})})))return;m.BLZ(e,A.jn(t));const{mainEditorCurrentBlockStore:n}=M.default.state,r=null==n?void 0:n.getSpaceId(),a=r&&(0,I.w3)(r);if(a){const t=a.getSpaceStore();e.device.isMobileNative&&i.log({level:"info",from:"onboardingActions",type:"SpaceSwitchingDebug",data:{message:"onboardingActions.handleCloseOnboarding set space",spaceId:null==t?void 0:t.id}}),M.default.setState({...M.default.state,currentSpaceStore:t,currentSpaceViewStore:a})}const{url:s,userId:l}=h.Vr(e);let c=e;if(l&&l!==e.currentUser.id&&(c=await S.x({environment:e,newCurrentUserId:l})),s){var o;T.close();const e=()=>{const e={isOnboarding:!1,isLoading:!1,currentUserId:l};D.default.setState(e)};b.navigate({environment:c,url:s}),null!==(o=c.mobileNative)&&void 0!==o&&o.supportsNativeHomeOnPhone()?b.navigateToHomeTab(c,e):e()}}}function q(e){const{state:t}=D.default;m.J7i(e,A.jn(t)),D.default.setState({isOnboarding:!1,isLoading:!1,currentUserId:e.currentUser.id})}function z(e,t){if(!t.isOnboarding)return;if(t.isOnboarding){const o=[...t.historicalStages||[],{stageName:t.stage,stageNumber:t.stageNumber,timestamp:Date.now()}];D.default.setState({...t,historicalStages:o.length>20?[{stageName:"truncated",stageNumber:-1,timestamp:Date.now()}]:o}),m.o7O(e,"onboarding_stage",{...A.jn(t),historical_stages:o})}}},10929:(e,t,o)=>{o.d(t,{$U:()=>Q,At:()=>$,BB:()=>N,Bu:()=>O,Fz:()=>de,NT:()=>j,Pn:()=>H,SN:()=>Y,Vb:()=>ce,WX:()=>J,Wf:()=>K,YH:()=>re,_J:()=>G,bM:()=>le,bN:()=>X,bm:()=>se,dD:()=>U,eW:()=>F,ey:()=>q,fz:()=>R,iF:()=>Z,jF:()=>V,jn:()=>W,lr:()=>L,n0:()=>B,og:()=>oe,pd:()=>ie,rT:()=>te,tq:()=>ne,tr:()=>A,uO:()=>ae,vA:()=>ee,y7:()=>D});var n=o(8848),r=o(80994),i=o(33728),a=o(68626),s=o(72126),l=o(15047),c=o(60949),d=o(97880),p=o(82990),u=o(5366),m=o(50906),g=o(54642),h=o(97977),f=o(76464),y=o(9953),v=o(29974),b=o(97627),S=o(39699),_=o(37181),w=o(24215),k=o(4708),x=o(33929),I=o(38755),C=o(80444),T=o(77080),M=o(35661),P=o(75538);function A(e,t){return`/tutorial/${e}${"dark"===t.state.mode?"-dark":""}.png`}function D(e){return e.isOnboarding&&("desktop_join_or_create_space"===e.flow||"mobile_join_or_create_space"===e.flow)}function B(e){return e.isOnboarding&&("desktop_cold_start"===e.flow||"mobile_cold_start"===e.flow||"desktop_joinable_spaces"===e.flow||"mobile_joinable_spaces"===e.flow||"desktop_redirect"===e.flow||"mobile_redirect"===e.flow)}function R(e){const{state:t}=e;return B(t)}const E=(0,u.defineMessages)({personalWorkspaceName:{defaultMessage:"{userName}'s Notion",id:"onboardingHelpers.personalWorkspaceName"}});function F(e,t){return t.formatMessage(E.personalWorkspaceName,{userName:e.trim()})}function N(e){return e.isOnboarding&&Boolean(P.InAppOnboardingStages.find((t=>t===e.stage)))}function j(e){return e.isOnboarding&&(Boolean(P.InAppOnboardingStages.find((t=>t===e.stage)))||"invite"===e.stage)}function O(e){return e.isOnboarding&&"template_optout"===e.stage}function L(e){const t=e.userStore.getEmail();if(t&&e.isUserDomainJoinable)return(0,i.Gd)(t)}async function U(e){P.default.setState({...P.default.state,isLoading:!0});const{disableRedirects:t,environment:o}=e;a.log({level:"info",from:"onboardingHelpers",type:"loadOnboardingData",data:{message:"initializeOnboardingDataLoad"}});const[n,i,s,l,c,p,u]=await Promise.all([g.getJoinableSpaces(o,{}),(0,I.iX)({environment:o,disableRedirectUrl:t}),g.isUserDomainJoinable(o,{}),g.isEmailEducation(o,{}),g.validateUserCanCreateWorkspace(o,{}),g.getVerifiedEmailDomain(o,{}),g.getGeoIpLocation(o,{})]);a.log({level:"info",from:"onboardingHelpers",type:"loadOnboardingData",data:{message:"completedOnboardingDataLoad",miscDataToConvertToString:{joinableSpacesResponseType:n.type,joinableSpacesResponseStatus:n.status,userRedirectDataId:i.userRootStore.id,isUserDomainJoinableResponseType:s.type,isUserDomainJoinableResponseStatus:s.status,validateUserCanCreateWorkspaceStatus:c.status}}}),P.default.setState({...P.default.state,isLoading:!1});const m={isUserDomainJoinable:"success"===s.type&&s.data.isJoinable,isEducationPlanEligible:"success"===l.type&&l.data.isEligible,canUserCreateSpace:"success"!==c.type||c.data.canUserCreateSpace,isUserUsingVerifiedDomain:"success"===p.type&&(0,d.$K)(p.data.id),...i,countryCode:"success"===u.type&&(0,r.GC)(u.data.countryCodeFromIp)?u.data.countryCodeFromIp:void 0};return"success"===n.type?{joinableSpaceData:n.data,...m}:{joinableSpaceData:{results:[]},...m}}async function Z(e){const t=await g.getGeoIpLocation(e,{});return"success"===t.type&&(0,r.GC)(t.data.countryCodeFromIp)?t.data.countryCodeFromIp:void 0}function V(e){if(D(e)){const{userRootStore:t}=e.onboardingData;if("timed_trial_upsell"===e.stage)return!1;const o=t.getSpaceViewPointers();if(o)return o.length>0}return!1}function q(e){const{onboardingData:t,isNewUserFlow:o}=e,{userRootStore:n}=t,{results:r}=t.joinableSpaceData,i=n.getSpaceViewStores().map((e=>e.getSpaceId()));return o?r:r.filter((e=>i.indexOf(e.id)<0))}function z(e){return e.isOnboarding&&"profile"!==e.stage&&"error"!==e.stage}function W(e){var t,o,n,r,i;const{currentUserSettingsStore:a,currentSpaceStore:s}=C.default.state;return{flow_name:e.isOnboarding?e.flow:"not_defined",flow_id:e.isOnboarding?e.flowId:void 0,stage:e.isOnboarding?e.stage:"not_defined",initial_workspace_type:z(e)?e.spaceJoinOrCreate:void 0,is_new_onboarding:te(e),is_create_or_join:D(e),stage_number:e.isOnboarding?e.stageNumber:void 0,num_of_joinable_spaces:e.isOnboarding&&"workspace_choose"===e.stage?(null===(t=e.joinableSpaces)||void 0===t?void 0:t.length)||0:void 0,historical_stages:e.isOnboarding?e.historicalStages:void 0,selectedPresets:e.isOnboarding&&"workspace_setup"===e.stage?e.selectedPresets:void 0,user_persona:null==a||null===(o=a.getSettings())||void 0===o?void 0:o.persona,user_team_role:null==a||null===(n=a.getSettings())||void 0===n?void 0:n.team_role,user_use_cases:null==a||null===(r=a.getSettings())||void 0===r?void 0:r.use_cases,user_company_size:null==a||null===(i=a.getSettings())||void 0===i?void 0:i.company_size,plan_type:null==s?void 0:s.getPlanType(),plan_selection:"planSelection"in e?e.planSelection:void 0}}function H(e){const{redirectSpaceId:t,redirectPageId:o,forkPageBlockId:n,hasExplicitAccessToRedirectPage:r,canJoinRedirectSpace:i,publicAccessPageId:a,oauthAuthorizationParams:s}=e;return s?{type:"oauth_authorization_redirect",...s}:n?{type:"fork_page",pageId:n}:!a||r||i?!t||r||i?t&&o&&r&&!i?{type:"guest_redirect",pageId:o,spaceId:t}:t&&o&&i?{type:"redirect_page",pageId:o,spaceId:t}:t&&i?{type:"redirect_space",spaceId:t}:{type:"getting_started_page"}:{type:"invalid"}:{type:"public_access_page_redirect",pageId:a}}async function G(e,t){const{onboardingData:o,name:n,profilePhoto:r,password:i,emailOptIn:a}=e,s=o.userStore;w.Zf(t,{email_optin_product_tips_and_news:a,email_optin_resources_and_events:a,email_optin_notion_for_startups:a}),S.createAndCommit({userAction:"onboardingHelpers.setProfileData",environment:t,perform:e=>{const t={...r&&{profile_photo:r}};t.name=n,y.sW({store:s,data:t,transaction:e})}});const l=await h.shouldCreatePassword(t)&&!ee();i&&l&&await g.setPassword(t,{newPassword:i,sendEmail:!1})}function K(e,t){const{userPersona:o,onboardingData:n,userTeamRole:r}=t;S.createAndCommit({userAction:"onboardingHelpers.setUserPersona",environment:e,perform:e=>{const t={persona:o,team_role:r};_.d2({userSettingsStore:n.userSettingsStore,data:t,transaction:e})}})}function $(e){if(!T.default.checkGate("survey_data_writes"))return;const{environment:t,state:o,spaceStore:n,spaceViewStore:r}=e,i=(new Date).getTime();if(r){const e=c.Dh({maybeFunction:o.userPersona,guessedFunctionVersion:4,maybeRole:o.userRole,guessedRoleVersion:2,collectedFrom:"onboarding",collectedAt:i});void 0!==e&&b.Q1(t,e,r)}if(n){const e=c.K0({maybeIntent:o.planSelection,guessedIntentVersion:1,maybeCompanySize:o.companySize,guessedCompanySizeVersion:2,maybeUseCases:o.useCases,guessedUseCasesVersion:3,collectedFrom:"onboarding",collectedAt:i});void 0!==e&&v.wg(t,e,n)}}async function Y(e,t){const{spaceId:o,onboardingData:n}=e;if(!o)return;const r=M.H2.createChildStore(n.userRootStore,{table:l.bx,id:o});await async function(e,t,o){t.isChecked&&t.joinableUserEmailDomain&&await v.$F({environment:e,emailDomains:[t.joinableUserEmailDomain],spaceStore:o})}(t,e,r);const{emails:i}=e,a=s.jj(i).map((e=>({type:"newUser",value:{email:e},source:"email"})));i.length>0&&(await f.n_({environment:t,store:r,inviteTargets:a,inviteRole:"editor",isOnboarding:!0,invite:{inviteOrigin:"onboarding_invite"}}),m.qJp(t,{...W(e),emails:e.emails,auto_join_space:e.isChecked,is_bulk_invite:e.isBulkInvite}))}function Q(e){const{userStore:t}=e,o=x.default.getIntl(),n=t.getFullName(o),r=t.getProfilePhoto()||null;if(n)return{name:n,profilePhoto:r,password:null,prefilled:!0,userPersona:"unfilled",userTeamRole:"unfilled"}}const J="inviteCode";function X(e){return(e.isBulkInvite?e.emailTokens:e.emailInputs.filter((e=>""!==e.sanitizedEmail))).length>0}function ee(){var e;const{currentUserSettingsStore:t}=C.default.state;return t&&t.isReady()&&"email-password"===(null===(e=t.getSettings())||void 0===e?void 0:e.mobile_ads_signup_variant)}function te(e){return e.isOnboarding&&e.isNewUser}function oe(e){return e.device.isMobileBrowser}function ne(e,t){const{redirectData:o,onboardingData:n}=t;if("redirect_page"===o.type||"redirect_space"===o.type){const{spaceId:t}=o,r=M.H2.createChildStore(n.userRootStore,{table:l.bx,id:t});return(0,k.g4)(e,{spaceStore:r})}}const re={fontSize:12,color:n.ZP.mediumTextColor,fontWeight:p.Z.fontWeight.medium,lineHeight:"135%",marginTop:20,marginBottom:4},ie={marginTop:14,marginBottom:14},ae={marginTop:8,marginBottom:8};function se(e){return{color:e.mediumTextColor}}const le={width:60},ce={marginTop:14,marginBottom:8,fontSize:16,fontWeight:600},de={boxShadow:`0 0 0 1px ${n.ZP.red}`}},75538:(e,t,o)=>{o.r(t),o.d(t,{InAppOnboardingStages:()=>a,default:()=>c,onboardingPreferenceKey:()=>s});var n=o(14577),r=o(49085),i=o(15157);const a=["template_optout","workspace_setup"],s="lastOnboardingStateKeyV1";class l extends r.default{setState(e){super.setState(e),function(e){if(e.isOnboarding)if("profile"===e.stage){const{onboardingData:t,isLoading:o,password:n,passwordErrorData:r,currentUserId:a,...l}=e;i.Z.set({userId:a,key:s,value:l})}else{const{onboardingData:t,isLoading:o,currentUserId:n,...r}=e;delete r.password,i.Z.set({userId:n,key:s,value:r})}else{const{currentUserId:t,...o}=e;i.Z.set({userId:t,key:s,value:o})}}(e)}constructor(){super(),this.isOnboarding=new n.Z((()=>this.state.isOnboarding),{debugName:"isOnboarding"});const e={isOnboarding:!1,isLoading:!1,currentUserId:void 0};super.setState(e)}}const c=new l},77282:(e,t,o)=>{o.d(t,{Z:()=>m});var n=o(16691),r=o(11799),i=o(82798),a=o(41432),s=o(33147),l=o(72126),c=o(97880);class d extends s.Z{constructor(e){super(),this.blocks=void 0,this.liveBlocks=void 0,this.rootBlock=void 0,this.detachedRootBlocks=void 0,this.blocks=new Map,this.liveBlocks=new Map,this.rootBlock=this.createBlock(e,"page"),this.detachedRootBlocks=new Map}hasBlock(e){return this.blocks.has(e)}getBlock(e){return(0,i.TO)(this.blocks.get(e))}createBlock(e,t){(0,i.T)(!this.hasBlock(e.id));const o=new p(e,this,t);return this.blocks.set(o.getId(),o),o.hasLiveReference()&&this.addLiveBlock(o),o}removeBlock(e){(0,i.T)(this.hasBlock(e)),(0,i.T)(!this.liveBlocks.has(e),"Should not be possible to remove a live block."),this.blocks.delete(e)}getLiveBlocks(){return[...this.liveBlocks.values()]}addLiveBlock(e){(0,i.T)(!this.liveBlocks.has(e.getId())),this.liveBlocks.set(e.getId(),e),this.emit({type:"add_block",blockStore:e.blockStore})}removeLiveBlock(e){this.liveBlocks.delete(e.getId()),this.emit({type:"remove_block",blockId:e.getId()})}destroy(){for(const e of this.blocks.values())e.destroy();this.blocks.clear(),this.liveBlocks.clear(),this.detachedRootBlocks.clear()}}class p{constructor(e,t,o){this.tracker=void 0,this.blockStore=void 0,this.liveReferences=void 0,this.detachedReferences=void 0,this.childBlocks=void 0,this.contentStoreListener=void 0,this.tracker=t,this.blockStore=e,this.liveReferences=new Set,this.detachedReferences=new Set,"page"===o||o.hasLiveReference()?this.liveReferences.add(o):this.detachedReferences.add(o),this.childBlocks=new Map,this.contentStoreListener=()=>this.handleContentStoreChange(),this.blockStore.getKeyStore("type").addListener(this.contentStoreListener),this.blockStore.getContentStore().addListener(this.contentStoreListener),this.blockStore.getFormatStore().getKeyStore("transclusion_reference_pointer").addListener(this.contentStoreListener),this.handleContentStoreChange()}handleContentStoreChange(){const e=[...this.childBlocks.keys()],t=new Map,o=this.blockStore.getType();if(this.liveReferences.has("page")||o&&!(0,a.S9)(o)){const e=new Set(this.blockStore.getRenderableContentIds()),o=this.blockStore.getContentStores();for(const r of o)e.has(r.id)&&t.set(r.id,r);const n=function(e){const t=e.getType();if(!t)return[];switch(t){case"transclusion_reference":const o=e.getTransclusionReferenceTargetStore();return o?[o]:[];case"text":case"page":case"personal_home_page":case"bulleted_list":case"numbered_list":case"toggle":case"quote":case"factory":case"button":case"to_do":case"column_list":case"column":case"embed":case"framer":case"tweet":case"gist":case"drive":case"audio":case"maps":case"invision":case"mixpanel":case"image":case"video":case"file":case"bookmark":case"equation":case"code":case"header":case"sub_header":case"sub_sub_header":case"collection_view":case"collection_view_page":case"breadcrumb":case"copy_indicator":case"divider":case"link_to_page":case"link_to_collection":case"figma":case"loom":case"typeform":case"codepen":case"pdf":case"callout":case"table_of_contents":case"whimsical":case"miro":case"abstract":case"sketch":case"excalidraw":case"replit":case"alias":case"transclusion_container":case"external_object_instance":case"table":case"table_row":case"tab":case"external_object_instance_page":case"hex":case"deepnote":case"ai_block":case"drawing":return[];default:(0,c.t1)(t)}}(this.blockStore);for(const r of n)t.set(r.id,r)}const n=[...t.keys()],r=l.e5(n,e),s=l.e5(e,n);for(const a of r)if(this.tracker.hasBlock(a)){const e=this.tracker.getBlock(a);e.addReference(this),this.childBlocks.set(a,e)}else{const e=this.tracker.createBlock((0,i.TO)(t.get(a)),this);this.childBlocks.set(a,e)}for(const a of s){const e=(0,i.TO)(this.childBlocks.get(a));this.childBlocks.delete(a),e.removeReference(this)}}getId(){return this.blockStore.id}hasLiveReference(){return this.liveReferences.size>0}addReference(e){e.hasLiveReference()?this.addLiveReference(e):this.addDetachedReference(e)}addLiveReference(e){if((0,i.T)(!this.liveReferences.has(e)),this.liveReferences.add(e),1===this.liveReferences.size){this.tracker.addLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}}addDetachedReference(e){this.detachedReferences.add(e)}removeReference(e){e.hasLiveReference()?this.removeLiveReference(e):this.removeDetachedReference(e)}removeLiveReference(e){if(this.liveReferences.delete(e),this.detachedReferences.add("detached"),this.tracker.detachedRootBlocks.set(this.getId(),this),0===this.liveReferences.size){this.tracker.removeLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}return this}removeDetachedReference(e){if(this.detachedReferences.delete(e),0===this.liveReferences.size&&0===this.detachedReferences.size){for(const[e,t]of this.childBlocks.entries())this.childBlocks.delete(e),t.removeReference(this);this.tracker.removeBlock(this.getId()),this.destroy()}}updateReference(e){const t=this.hasLiveReference();this.liveReferences.has(e)&&!e.hasLiveReference()?(this.liveReferences.delete(e),this.detachedReferences.add(e)):this.detachedReferences.has(e)&&e.hasLiveReference()&&(this.liveReferences.add(e),this.detachedReferences.delete(e));const o=this.hasLiveReference();if(t!==o){o?this.tracker.addLiveBlock(this):this.tracker.removeLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}return this}destroy(){this.contentStoreListener&&(this.blockStore.getKeyStore("type").addListener(this.contentStoreListener),this.blockStore.getContentStore().removeListener(this.contentStoreListener),this.blockStore.getFormatStore().getKeyStore("transclusion_reference_pointer").removeListener(this.contentStoreListener),this.contentStoreListener=void 0)}}class u{constructor(e){this.blockTextInstanceMap=void 0,this.textInstanceBlockMap=void 0,this.blockTextClocksListenerMap=void 0,this.blockTextInstanceMap=new Map,this.textInstanceBlockMap=new Map,this.blockTextClocksListenerMap=new Map,e.addListener((e=>this.handlePageEvent(e)));for(const{blockStore:t}of e.getLiveBlocks())this.addBlock(t)}handlePageEvent(e){const t=e.type;switch(t){case"add_block":this.addBlock(e.blockStore);break;case"remove_block":this.removeBlock(e.blockId);break;default:(0,c.t1)(t)}}addBlock(e){const t=e.id,o=e=>{this.handleTextClocksChange(t,e.getValue())};e.getSerializedTextClocksStore().addListener(o),this.blockTextClocksListenerMap.set(t,{blockStore:e,textClocksListener:o});const n=e.getSerializedTextClocksStore().getValue();this.handleTextClocksChange(t,n)}removeBlock(e){this.removeMappingForBlock(e);const{blockStore:t,textClocksListener:o}=(0,i.TO)(this.blockTextClocksListenerMap.get(e));t.getSerializedTextClocksStore().removeListener(o),this.blockTextClocksListenerMap.delete(e)}handleTextClocksChange(e,t){this.removeMappingForBlock(e);const o=t?Object.keys(t):[];for(const n of o)this.addBlockTextInstanceMapping(e,n)}removeMappingForBlock(e){const t=this.blockTextInstanceMap.get(e);if(t)for(const o of t)this.removeBlockTextInstanceMapping(e,o)}addBlockTextInstanceMapping(e,t){const o=this.blockTextInstanceMap.get(e)??new Set;o.add(t),this.blockTextInstanceMap.set(e,o);const n=this.textInstanceBlockMap.get(t)??new Set;n.add(e),this.textInstanceBlockMap.set(t,n)}removeBlockTextInstanceMapping(e,t){const o=(0,i.TO)(this.blockTextInstanceMap.get(e));o.delete(t),0===o.size&&this.blockTextInstanceMap.delete(e);const n=(0,i.TO)(this.textInstanceBlockMap.get(t));n.delete(e),0===n.size&&this.textInstanceBlockMap.delete(t)}getTextInstanceIdsForBlock(e){return this.blockTextInstanceMap.has(e)?[...(0,i.TO)(this.blockTextInstanceMap.get(e))]:[]}getBlockIdsForTextInstance(e){return this.textInstanceBlockMap.has(e)?[...(0,i.TO)(this.textInstanceBlockMap.get(e))]:[]}getBlockStoreForTextInstanceItemId(e,t,o){const n=this.getBlockIdsForTextInstance(e);for(const r of n){const n=(0,i.TO)(this.blockTextClocksListenerMap.get(r)).blockStore;if((0,i.TO)(n.getTextSliceTree()).findTextSliceTreeContainingItemWithId(e,t,o))return n}}destroy(){for(const e of this.blockTextClocksListenerMap.keys())this.removeBlock(e)}}const m=new class{constructor(){this.pageInfoMap=new r.Z({getKey:e=>(0,n.dn)(e)})}trackPage(e){if(this.pageInfoMap.has(e.pointer))return void(0,i.TO)(this.pageInfoMap.get(e.pointer)).count++;const t=new d(e),o=e.useCrdt()?new u(t):void 0;this.pageInfoMap.set(e.pointer,{pageBlockTracker:t,pageTextInstanceTracker:o,count:1})}untrackPage(e){const t=e.pointer,o=(0,i.TO)(this.pageInfoMap.get(t));var n;(o.count--,0===o.count)&&(o.pageBlockTracker.destroy(),null===(n=o.pageTextInstanceTracker)||void 0===n||n.destroy(),this.pageInfoMap.delete(t))}getPageTextInstanceTrackerForPage(e){const t=this.pageInfoMap.get(e);return null==t?void 0:t.pageTextInstanceTracker}getBlockStoreForTextInstanceItemId(e,t,o){for(const r of this.pageInfoMap.values()){var n;const i=null===(n=r.pageTextInstanceTracker)||void 0===n?void 0:n.getBlockStoreForTextInstanceItemId(e,t,o);if(i)return i}}}},18245:(e,t,o)=>{o.r(t),o.d(t,{NotionPerformanceClass_TEST_ONLY:()=>S,default:()=>b});o(57658);var n=o(1302),r=o(5809),i=o(68626),a=(o(72126),o(77897)),s=o(12139),l=o(97880),c=o(24215),d=o(53410),p=o(94134),u=o(77080),m=o(85844),g=o(50112),h=o(50906);const f=Object.entries(g.N);const y=new Set(["navigation_page_render","navigation_database_render","typing_lag"]);class v{constructor(){this.startTimesByMetricName={},this.lastVisibilityChange=0,m.Z.addListener((()=>{this.lastVisibilityChange=performance.now()}))}mark(e){const t=performance.mark(e).startTime,o="sentry"===p.getProfilingToolForSession()&&y.has(e)?s.Yr({name:e}):void 0;return this.startTimesByMetricName[e]={startTime:t,sentryTransaction:o},{metricName:e,startTime:t,sentryTransaction:o}}markAllOf(e){if(0===e.length)return;const t=performance.now();for(const o of e)this.startTimesByMetricName[o]={startTime:t,sentryTransaction:"sentry"===p.getProfilingToolForSession()&&y.has(o)?s.Yr({name:o}):void 0}}markEitherOf(e){if(0===e.length)return;const t=performance.now();for(const o of e)this.startTimesByMetricName[o]={startTime:t,sentryTransaction:"sentry"===p.getProfilingToolForSession()&&y.has(o)?s.Yr({name:o}):void 0,allMetricNamesMarked:e}}measure(e,t){this._measure(e,t)}measureAfterNextFlush(e,t){n.default.afterNextFlush((()=>{const o="getData"in t?t.getData():void 0;"getData"in t&&void 0===o||this._measure(e,{...t,data:o})}))}measureFromAppStart(e,t){const o="object"==typeof e?e.metricName:e,n=r.$();"number"==typeof n&&this.measure({metricName:o,startTime:n,..."object"==typeof e?{endTime:e.endTime}:{}},t)}measureFromAppStartAfterNextFlush(e,t){const o="object"==typeof e?e.metricName:e;n.default.afterNextFlush((()=>{const n="getData"in t?t.getData():void 0;if("getData"in t&&void 0===n)return;const i=r.$();"number"==typeof i&&this._measure({metricName:o,startTime:i,..."object"==typeof e?{endTime:e.endTime}:{}},{...t,data:n})}))}_measure(e,t){if("object"==typeof e){const{startTime:o,endTime:n,metricName:r,sentryTransaction:i}=e;this.startTimesByMetricName[r]=void 0;const a=this.getDuration({metricName:r,startTime:o,endTime:n});i&&i.finish(n),this.trackDuration({metricName:r,startTime:o,duration:a,options:t})}else if("string"==typeof e){const o=e,n=this.startTimesByMetricName[o];if(!n)return;const{startTime:r,allMetricNamesMarked:i,sentryTransaction:a}=n;if(i)for(const e of i)this.startTimesByMetricName[e]=void 0;else this.startTimesByMetricName[o]=void 0;const s=this.getDuration({metricName:o,startTime:r});a&&a.finish(),this.trackDuration({metricName:o,startTime:r,duration:s,options:t})}else(0,l.t1)(e)}getDuration(e){const{metricName:t,startTime:o,endTime:n}=e;try{return performance.measure(t,{start:o,..."number"==typeof n?{end:n}:{}}).duration}catch(r){return"number"==typeof n?n-o:performance.now()-o}}async trackDuration(e){const{metricName:t,duration:o,startTime:n,options:r}=e,{environment:s,data:l,preboot:p}=r;if(!document.hidden&&!("number"==typeof this.lastVisibilityChange&&n<this.lastVisibilityChange)&&await this.getSamplingDecision(t,r)){if(s.device.isElectron&&d.C&&d.C.windowIsVisible){if(!(await d.C.windowIsVisible()))return}"navigation_database_render"===t&&o>=6e4&&i.log({level:"info",from:"collections",type:"navigationPageRenderSlow",error:{message:`Got a slow navigation page render that took: ${o/1e3}s`},data:{miscDataToConvertToString:l}}),c.j(s,t,{time:o,...l},{preboot:p}),function(e,t,o){if(!("memory"in(window.performance||{})))return;const n=Math.random();f.forEach((r=>{let[i,s]=r;if(!(i in window.performance.memory))return;const l=u.default.getConfigKey("event_trail_events",s),c=l&&"sampleRatesByMetric"in l&&"object"==typeof l.sampleRatesByMetric&&l.sampleRatesByMetric[t]||0;(0,a.aw)(c,(()=>n))&&h.Z41(e,{type:s,bytes:window.performance.memory[i],data:{collected_during:t,...o}})}))}(s,t,l)}}async getSamplingDecision(e,t){const{shouldSendIfStatsigNotInitialized:o}=t;await n.default.afterNextFlush();const r=u.default.getConfigKey("event_trail_events",e);if("object"==typeof r&&"number"==typeof r.sampleRate)return(0,a.aw)(r.sampleRate);const i=u.default.getConfigKey("event_trail_events","defaultSampleRate");return"number"==typeof i?(0,a.aw)(i):!!o}}const b=new v;class S extends v{}},30806:(e,t,o)=>{o.d(t,{$X:()=>r,Ay:()=>l,BX:()=>s,cY:()=>a,lj:()=>i});var n=o(24215);function r(e){let{environment:t,from:o}=e;(0,n.j)(t,"open_home",{from:o})}function i(e){let{environment:t}=e;(0,n.j)(t,"open_home_more_menu",{})}function a(e){const{environment:t,show:o,feature:r,from:i}=e;(0,n.j)(t,"toggle_home_feature",{show:o,feature:r,from:i})}function s(e){let{environment:t,oldValue:o,newValue:r,from:i}=e;(0,n.j)(t,"change_start_page",{old_value:o,new_value:r,from:i})}function l(e){let{environment:t,index:o,teamId:r}=e;(0,n.j)(t,"change_home_trending_source",{source_type:r?"team":"space",selected_index:o,selected_team_id:r})}},46837:(e,t,o)=>{o.d(t,{Z:()=>m});var n=o(67294),r=o(480),i=o(86628),a=o(24405),s=o(56996),l=o(5366),c=o(76798),d=o(75024),p=o(85893);function u(e){let{style:t}=e;window.__c={n:"PersonalHomeBreadcrumb"};const o=(0,r.O7)(),n=(0,i.VK)((()=>{var e;return(null===(e=o.mobileNative)||void 0===e?void 0:e.supportsNativeHomeOnPhone())??!1}),[o.mobileNative]),u=(0,a.yK)((()=>({container:{display:"flex",alignItems:"center",lineHeight:1.2,paddingRight:4,fontSize:(0,d.yv)(o,"UIRegular"),width:"100%",maxWidth:n?"100%":void 0,...t},homeIcon:{width:20,height:20,marginRight:4}})),[o,t,n]),m=(0,c.E)({shouldWrap:!1}).root,g=(0,p.jsxs)(p.Fragment,{children:[(0,s.z)(u.homeIcon),(0,p.jsx)("div",{style:m,children:(0,p.jsx)(l.FormattedMessage,{id:"personalHomeBreadcrumb.homeBreadcrumb",defaultMessage:"Home"})})]});return n?(0,p.jsx)("div",{style:u.container,className:"notranslate",children:g}):(0,p.jsx)("div",{style:u.container,className:"notranslate shadow-cursor-breadcrumb",children:g})}const m=n.memo(u)},14654:(e,t,o)=>{o.d(t,{ib:()=>s,t3:()=>l});var n=o(15145),r=o(97880),i=o(80444),a=o(94841);function s(e){let{blockOrCollectionId:t}=e;const o=l({blockOrCollectionId:t});switch(o){case"home":return n.tY.PersonalHomePage;case"home_tile_recents":return n.tY.PersonalHomeTileRecents;case"home_tile_trending":return n.tY.PersonalHomeTileTrending;case"home_tile_tips":return n.tY.PersonalHomeTileTips;case"home_tile_tasks":return n.tY.PersonalHomeTileTasks;case"home_tasks":return n.tY.PersonalHomePageTasks;case"home_tile_similar_users":return n.tY.PersonalHomeTileSimilarUsers;case"home_unknown":return n.tY.PersonalHomeUnknown;case"home_tile_notes":return n.tY.PersonalHomeNotes;case void 0:return;default:(0,r.t1)(o)}}function l(e){let{blockOrCollectionId:t}=e;const o=(0,a.G)({blockOrCollectionId:t}),{mainEditorCurrentBlockStore:n}=i.default.state;if(o)switch(o){case"main":return"home";case"myTasksAssignedToMeCollectionView":case"myTasks":return(0,a.WE)(n)?"home_tile_tasks":"home_tasks";case"trendingCollectionView":return"home_tile_trending";case"similarUsersCollectionView":return"home_tile_similar_users";case"trending":case"trendingCollection":case"myTasks":case"similarUsers":case"similarUsersCollection":return"home_unknown";default:(0,r.t1)(o)}}},94841:(e,t,o)=>{o.d(t,{A5:()=>I,Al:()=>b,Ep:()=>S,G:()=>f,J2:()=>_,Kj:()=>y,Vj:()=>w,WB:()=>T,WE:()=>v,h5:()=>x,jX:()=>C,pr:()=>k});var n=o(77840),r=o(60310),i=o(72126),a=o(21202),s=o(6287),l=o(13493),c=o(97880),d=o(95697),p=o(80444),u=o(88923),m=o(35661);const g=(0,i.HP)(((e,t)=>r.hH({userId:e,spaceId:t})),(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return JSON.stringify(t)})),h=(0,i.HP)(((e,t,o)=>{if(!e||!t||!o)return;const[n]=(0,c.qP)(g(t,o)).find((t=>{let[o,n]=t;return n===e}))??[];return n}),(function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return JSON.stringify(t)}));function f(e){var t,o;let{blockOrCollectionId:n}=e;const r=null===(t=p.default.state.currentUserStore)||void 0===t?void 0:t.id,i=null===(o=p.default.state.currentSpaceStore)||void 0===o?void 0:o.id;if(r&&i&&n)return h(n,r,i)}function y(e){return(0,c.$K)(f({blockOrCollectionId:e}))}function v(e){return!!e&&"main"===f({blockOrCollectionId:e.id})}function b(e){var t,o;const n=null===(t=p.default.state.currentUserStore)||void 0===t?void 0:t.id,r=null===(o=p.default.state.currentSpaceStore)||void 0===o?void 0:o.id;if(!n||!r)return;const i=g(n,r).main,s=e.getSpaceStore();return i&&s?m.G.createChildStore(s,{table:a.iU,id:i,spaceId:s.id}):void 0}function S(e){var t,o;const n=null===(t=p.default.state.currentUserStore)||void 0===t?void 0:t.id,r=null===(o=p.default.state.currentSpaceStore)||void 0===o?void 0:o.id;if(n&&r)return g(n,r)[e]}function _(e){const t=p.default.state.currentSpaceStore;if(!t)return;const o=t.id;switch(e){case"main":case"myTasks":case"trending":case"similarUsers":const n=S(e);return n?m.G.createChildStore(t,{table:a.iU,id:n,spaceId:o}):void 0;case"myTasksAssignedToMeCollectionView":case"similarUsersCollectionView":case"trendingCollectionView":const r=S(e);return r?m.Xr.createChildStore(t,{table:l.n,id:r,spaceId:o}):void 0;case"trendingCollection":case"similarUsersCollection":const i=S(e);return i?m.NW.createChildStore(t,{table:s.v,id:i,spaceId:o}):void 0;default:(0,c.t1)(e)}}function w(){return{list_properties:[{width:200,visible:!0,property:n.Es.DueDate},{width:200,visible:!0,property:n.Es.Status,statusShowAs:"select"},{width:200,visible:!0,property:n.Es.Location},{visible:!1,property:n.Es.Assign,width:200},{visible:!1,property:n.Es.Reporter,width:200},{visible:!1,property:n.Es.CreatedTime,width:200},{visible:!1,property:n.Es.LastEditedTime,width:200},{visible:!1,property:n.Es.LastEditedBy,width:200}],collection_group_by:void 0,collection_peek_mode:u.PeekModeCenter,inline_collection_first_load_limit:{type:"load_limit",limit:20}}}function k(e){if(!(0,d.QI)("beta_only"))return!1;if(e.device.isMobile)return!1;const{currentUserSettingsStore:t}=p.default.state;if(!t||!t.isReady())return!1;const o=t.getSettings();return!!o&&!0!==o.seen_personal_home}const x="https://www.notion.so/notion/Sidebar-Home-Beta-Program-3819c5f8551141c3952f1031ab4f9034",I=16,C=44,T=270-C},58299:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(76796);class r extends n.B{findBlockPropertyValue(e,t){return this.find((o=>o.getProps().store===e&&o.getProps().property===t))}findBlockPropertyValueByBlockId(e,t){return this.find((o=>o.getProps().store.id===e&&o.getProps().property===t))}getRect(e,t){const o=this.findBlockPropertyValue(e,t);if(o){const e=o.getNode();if(e&&e instanceof Element)return e.getBoundingClientRect()}}}const i=new r},58202:(e,t,o)=>{o.d(t,{R:()=>s});var n=o(35431),r=o(92595),i=o(53223);class a extends n.Z{findBlockFromStore(e){return this.find((t=>t.getBlockStore()===e))}findAllBlocksFromStore(e){return this.filter((t=>t.getBlockStore()===e))}findBlockFromStoreWithMethod(e,t){return this.find((o=>o.getBlockStore()===e&&"function"==typeof o[t]))}findBlockFromId(e){return this.find((t=>{const o=t.getBlockStore();return o&&o.id===e}))}findNodeFromStore(e){const t=this.findBlockFromStore(e);if(t)return t.getNode()}getRect(e){const t=this.findNodeFromStore(e);if(t&&t instanceof Element)return t.getBoundingClientRect()}findCollectionViewBlockFromStore(e){return this.find((t=>t.getBlockStore()===e&&(0,i.w)(t)))}findCollectionViewBlockFromId(e){return this.find((t=>{var o;return Boolean((null===(o=t.getBlockStore())||void 0===o?void 0:o.id)===e&&(0,i.w)(t))}))}}const s=new a;(0,r.exposeDebugValue)("GlobalBlockRegistry",s)},89574:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(35431);class r extends n.Z{}const i=new r},46351:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(35431);class r extends n.Z{}const i=new r},47372:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(35431);class r extends n.Z{}const i=new r},27406:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(35431),r=o(92595);class i extends n.Z{constructor(){super(...arguments),this.isDropTargetForKey=(e,t)=>e.props.dropTargetKey===t}findDropTargetFromKey(e){return this.find((t=>this.isDropTargetForKey(t,e)))}findDropTargetsFromKey(e){return this.filter((t=>this.isDropTargetForKey(t,e)))}}const a=new i;(0,r.exposeDebugValue)("GlobalDropTargetRegistry",a);const s=a},28685:(e,t,o)=>{o.d(t,{E:()=>i});var n=o(35431);class r extends n.Z{findEditableWithinSelectable(e){return this.find((t=>t.getContextClosestSelectable()===e))}findEditableWithStore(e){return this.find((t=>t.props.store===e))}findNodeFromStore(e){const t=this.findEditableWithStore(e);if(t)return t.getNode()}findStoreFromNode(e){const t=this.find((t=>t.getNode()===e));if(t)return t.props.store}}const i=new r},3994:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(35431);class r extends n.Z{shouldPreventMobileAutoScroll(e){const t=this.find((t=>t.props.capture&&!(t.props.allowMobileAutoScroll&&e.device.isMobile)));return Boolean(t)}}const i=new r},75987:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(35431);class r extends n.Z{isInlineAutocompleteOpen(){const e=this.find((e=>e.props.isOpen));return Boolean(e)}}const i=new r},81844:(e,t,o)=>{o.d(t,{Z:()=>i});o(57658);var n=o(35431);class r extends n.Z{findOutlinerItemFromStore(e){if(e)return this.find((t=>t.store===e))}findOutlinerItemsFromId(e){const t=[];return this.forEach((o=>{o.store.id===e&&t.push(o)})),t}}const i=new r},49427:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(35431),r=o(82136);class i extends n.Z{isBlockInFrame(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>e.props.context===r.S.Frame&&e.props.store===t)))}}const a=new i},64815:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(35431);class r extends n.Z{}const i=new r},16339:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(35431);class r extends n.Z{}const i=new r},95802:(e,t,o)=>{o.d(t,{C:()=>c});var n=o(35431),r=o(92595),i=o(72126),a=o(28685),s=o(27724);class l extends n.Z{getMembersByDOMOrder(e){let{filter:t}=e;return super.getMembersByDOMOrder({filter:e=>!e.props.isHoverMenu&&t(e)})}findSelectableFromStore(e){return this.find((t=>t.props.store===e))}findScrollToSelectableFromStore(e){return this.find((t=>t.props.store===e&&t.props.canSelect&&!t.props.disableScrollToReveal&&t.getContextSelectableContainer()===s.default.getCurrentDefaultContainer()))}findScrollToSelectablesFromIds(e){return this.filter((t=>e.includes(t.props.store.id)&&t.props.canSelect&&!t.props.disableScrollToReveal&&t.getContextSelectableContainer()===s.default.getCurrentDefaultContainer()))}findSelectablesFromStore(e){return this.filter((t=>t.props.store===e))}findNodeFromStore(e){const t=this.findSelectableFromStore(e);if(t)return t.getNode()}getRectFromStore(e){const t=this.findNodeFromStore(e);if(t&&t instanceof Element)return t.getBoundingClientRect()}findEditableStoreWithin(e){const t=this.findSelectableFromStore(e);if(t){const e=a.E.findEditableWithinSelectable(t);if(e)return e.props.store}}findSelectablesFromIds(e){const t=s.default.getCurrentDefaultContainer(),o=this.getMembersByDOMOrder({filter:()=>!0});return i.oA(e.map((e=>o.find((o=>{const n=o.props.store,r=o.getContextSelectableContainer();return Boolean(n&&n.id===e&&r===t)})))))}findAllSelectablesFromIds(e){const t=s.default.getCurrentDefaultContainer(),o=this.getMembersByDOMOrder({filter:()=>!0});return i.xH(e.map((e=>o.filter((o=>{const n=o.props.store,r=o.getContextSelectableContainer();return Boolean(n&&n.id===e&&r===t)})))))}findNodeFromBlockId(e){var t;const o=this.findSelectablesFromIds([e]);return null==o||null===(t=o[0])||void 0===t?void 0:t.getNode()}findSelectableFromChildNode(e){const t=this.getMembersByDOMOrder({filter:t=>{var o;return null===(o=t.getNode())||void 0===o?void 0:o.contains(e)}});return t[t.length-1]}}const c=new l;(0,r.exposeDebugValue)("GlobalSelectableRegistry",c)},28578:(e,t,o)=>{o.d(t,{Sw:()=>l,T5:()=>s,XF:()=>i,ZP:()=>d,wV:()=>a});var n=o(49085),r=o(4615);let i=function(e){return e.Share="share",e.Publish="publish",e}({}),a=function(e){return e.MainShareMenu="mainShareMenu",e.Invite="invite",e.Publish="publish",e}({}),s=function(e){return e.Notion="notion",e.Slack="slack",e}({}),l=function(e){return e.Search="search",e.Message="message",e}({});class c extends n.default{getInitialState(){return{sessionId:(0,r.ZP)(),display:a.MainShareMenu,tab:i.Share}}}const d=new c},74948:(e,t,o)=>{o.r(t),o.d(t,{OnlyOneSidebarVisibleWidthThreshold:()=>$,SidePeekCloseLeftSidebarFrameWidthThreshold:()=>Y,bookmarkPage:()=>se,cancelSidebarInitialRenderLog:()=>ke,close:()=>J,handleSidebarButtonClick:()=>ee,initialize:()=>be,leaveBlocks:()=>ae,newPageMessages:()=>me,open:()=>Q,pinSharedPage:()=>ce,quickAddPage:()=>ue,setExpand:()=>X,setPeekWidth:()=>ie,setUpdateExpand:()=>te,setUpdateSidebarCommentsMode:()=>_e,setUpdateSidebarTab:()=>Se,setUpdateWidth:()=>re,setWidth:()=>ne,toggleBothSidebars:()=>we,toggleLeftSidebarByWindowSize:()=>oe,unbookmarkPage:()=>le,unpinSharedPage:()=>de});var n=o(1302),r=o(15145),i=o(23867),a=o(54153),s=o(5366),l=o(50906),c=o(54642),d=o(54564),p=o(98834),u=o(94419),m=o(11302),g=o(17659),h=o(89858),f=o(99553),y=o(9953),v=o(75018),b=o(39699),S=o(1742),_=o(37181),w=o(75770),k=o(58239),x=o(45010),I=o(38755),C=o(18245),T=o(5162),M=o(80444),P=o(8949),A=o(66949),D=o(77080),B=o(3418),R=o(475),E=o(42330),F=o(45325),N=o(79689),j=o(88923),O=o(24864),L=o(35661),U=o(69784),Z=o(82187),V=o(62820),q=o(34583),z=o(24646),W=o(38676),H=o(97852),G=o(36896),K=o(36391);const $=1024,Y=430;function Q(){W.TC.state||U.Z.state.isActive||A.Z.isOpen()||F.ZP.isOpen()||F.ZP.isTransitioningOpenState()||W.TC.setState(!0)}function J(){!W.TC.state||R.Z.state.open||V.Z.state.open||G.Z.state.open||H.Z.state.open||P.Z.state.isActive||Z.Z.state.clonedBlockStore||W.cY.state.isResizing||!(0,N.c)()||B.Z.state.namedOpenPopups.has("team_more_actions")||B.Z.state.namedOpenPopups.has("teams_heading_actions")||(W.Ic.setState(0),W.TC.setState(!1))}function X(e){if((0,T.Y)("supportsNativeHome"))return;const t=C.default.mark("sidebar.toggle_expanded_lag");W.gV.setState(e.isExpanded),ye(),j.default.setSidebarExpandedStoreState(e.isExpanded),e.isExpanded&&e.environment.WindowSizeStore.state.width<$&&(0,z.Sx)(e.environment)&&te({environment:e.environment,isExpanded:!1,from:"close_for_space"}),e.isExpanded&&(0,z.$3)(e.environment)<Y&&f.xv(e.environment,"sidebar_expand"),e.isExpanded?l.LMg(e.environment):l.QdK(e.environment),C.default.measureAfterNextFlush(t,{environment:e.environment,getData:()=>({is_expanded:e.isExpanded,from:e.from})})}function ee(e,t,o,n){const i=j.default.state.open,{currentTab:a}=K.ZP.state,s=a!==o||a===o&&!(0,z.Sx)(e);K.ZP.setState({...K.ZP.state,currentTab:o}),i?(v.navigateToBlock({environment:e,store:t,pageVisitSource:r.tY.Expand}),te({environment:e,isExpanded:!0,from:n})):te({environment:e,isExpanded:s,from:n})}function te(e){var t;const{isExpanded:o,environment:n,from:r}=e;if(o||d.LZ(),o){n.WindowSizeStore.state.width<$&&(0,z.in)(n)&&X({environment:n,isExpanded:!1,from:`set_update_expand_${e.from}`}),F.ZP.isOpen()&&g.qQ({open:!1,environment:n});const t=K.ZP.state.currentTab,o={origin:j.default.state.open?"peek_view":"page",from:r};t===K.gY.Comments?l.v$O(n,o):t===K.gY.Updates&&l.phe(n,o)}K.ZP.setState({...K.ZP.state,expanded:o,mouseEntered:!!o||K.ZP.state.mouseEntered,openedOnBlockId:j.default.state.open&&j.default.state.target.id||(null===(t=M.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id),canRender:!0}),ve()}function oe(e){j.default.state.savedSidebarExpandedStoreState&&!W.gV.state&&function(e){if(W.gV.state||!j.default.state.savedSidebarExpandedStoreState)return;j.default.isSidePeekOpen()&&(0,z.$3)(e)-(0,z.qG)(e)>=Y&&W.gV.setState(!0)}(e),W.gV.state&&function(e){const t=W.gV.state&&0===(0,z.Wk)(e)?e.WindowSizeStore.state.width-W.GZ.state-(0,z.ll)(e,!1):(0,z.$3)(e);j.default.isSidePeekOpen()&&j.default.state.savedSidebarExpandedStoreState&&W.gV.state&&t<Y&&(W.gV.setState(!1),j.default.setSidebarExpandedStoreState(!0))}(e)}function ne(e){W.GZ.setState(e.width),(0,z.$3)(e.environment)<Y&&f.xv(e.environment,"sidebar_expand"),ye()}function re(e){K.ZP.setState({...K.ZP.state,width:e.width}),ve()}function ie(e){j.default.state.open&&j.default.isSidePeekOpen()&&(j.default.setSidePeekWidth(e.width,e.environment.WindowSizeStore.state.width),function(){const{preferredSidePeekWidth:e}=j.default.state,t={width:e};a.Z.set(fe,t)}(),oe(e.environment))}async function ae(e){const{blocks:t,transaction:o,environment:n}=e,{currentSpaceViewStore:r}=M.default.state;if(r)for(const i of t)u.Od({parent:r.getSharedPagesStore(),childToRemove:i,transaction:o});v.navigateAwayIfCurrentPage({environment:n,blocks:t}),await Promise.all(t.map((e=>c.leaveBlock(n,{block:{id:e.id,spaceId:(0,i.C)(e.pointer.spaceId)}}))))}const se=function(e){const{store:t,spaceViewStore:o,transaction:n}=e,r=o.getBookmarkedPagesStore(),i=L.G.createChildStore(r,t.pointer);D.default.checkGate("append_favorites")?u.R3({parent:r,append:i,transaction:n}):u.Ce({parent:r,prepend:i,transaction:n})},le=function(e){const{store:t,spaceViewStore:o,transaction:n}=e,r=o.getBookmarkedPagesStore(),i=L.G.createChildStore(r,t.pointer);u.Od({parent:r,childToRemove:i,transaction:n})},ce=function(e){const{store:t,spaceViewStore:o,transaction:n}=e;pe(e);const r=o.getSharedPagesStore(),i=L.G.createChildStore(r,t.pointer);u.Ce({parent:r,prepend:i,transaction:n})},de=function(e){const{store:t,spaceViewStore:o,transaction:n}=e;pe(e);const r=o.getSharedPagesStore(),i=L.G.createChildStore(r,t.pointer);u.Od({parent:r,childToRemove:i,transaction:n})};function pe(e){const{environment:t,spaceViewStore:o,userSettingsStore:n,transaction:r}=e,i=o.getSpaceId();if(!i||n.hasUserPinnedToOutliner({spaceId:i,type:"shared"}))return;const{visibleSharedPagesStores:a}=(0,I.k0)({environment:t,spaceViewStore:o,userSettingsStore:n}),s=a.map((e=>{let{id:t}=e;return t}));y.sW({store:o,data:{shared_pages:s},transaction:r}),_.Nb({userSettingsStore:n,spaceId:i,type:"shared",transaction:r})}async function ue(e){const{from:t,environment:o,redirect:i}=e,{currentSpaceStore:a,currentSpaceViewStore:s}=M.default.state,c=new S.sA(o,"quickAddPage");if(!(q.M_(o)&&a&&a.canEdit()&&s))return void c.fail("invalid_state");E.ZP.setState({...E.ZP.state,lastPageId:M.default.state.mainEditorCurrentBlockStore?M.default.state.mainEditorCurrentBlockStore.id:void 0});const d=await async function(e){const{newPageTracker:t,quickAddParentOverride:o,environment:n}=e,{currentSpaceStore:r}=M.default.state;if(!r)return void t.fail("invalid_state");const i=o||await(0,k.lX)({spaceStore:r,currentUserId:n.currentUser.id}),a=w.uw(i);if("space-private-pages"===i.type||a.canAdmin()){return(await b.createAndCommitAsync({environment:n,userAction:"sidebarActions.quickAddPage.directMoveToAdd",waitForServerCommit:!1,perform:async e=>{const o=y.j4({environment:n,type:"page",inMemoryRecordCache:n.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:r.id,tracker:t,useCrdt:!1}),a=await m.Ws({environment:n,targets:[o],value:i,transaction:e});if(a&&"collection"===a.table){const t=a.getDefaultTemplatePageStore();t&&p.ob({title:"template",environment:n,store:o,templateStore:t,isKeyboard:!1,isCreateIn:!1,transaction:e,from:"sidebar_actions"})}return{createdPage:o}}})).performResult.createdPage}if(!a.canAdmin()&&a.canEdit()){const{performResult:{createdPage:e}}=await b.createAndCommitAsync({environment:n,userAction:"sidebarActions.quickAddPage.moveToAdd",waitForServerCommit:!1,perform:async e=>{const o=y.j4({environment:n,type:"page",inMemoryRecordCache:n.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:r.id,useCrdt:!1});return t.track(o.pointer,e),await m.Ws({environment:n,targets:[o],value:{type:"space-private-pages",spaceId:r.id},transaction:e}),{createdPage:o}}});return await b.createAndCommitAsync({environment:n,userAction:"sidebarActions.quickAddPage.moveToMove",waitForServerCommit:!1,perform:async t=>{const o=await m.kj({environment:n,targets:[e],value:i,transaction:t});if(o&&"collection"===o.table){const r=o.getDefaultTemplatePageStore();r&&p.ob({title:"template",environment:n,store:e,templateStore:r,isKeyboard:!1,isCreateIn:!1,transaction:t,from:"sidebar_actions"})}}}),e}t.fail("invalid_state")}({...e,newPageTracker:c});return d?(o.device.isMobile?(v.navigateToBlock({environment:o,store:d,showMoveTo:!0,saveParent:!0,redirect:i,pageVisitSource:r.tY.SidebarQuickAdd}),J()):v.peekBlock({environment:o,store:d,showMoveTo:!0,saveParent:!0,peekMode:void 0,resultsStore:void 0,collectionContextStore:void 0,pageVisitSource:r.tY.SidebarQuickAdd}),h.Eo({environment:o,spaceViewStore:s,type:"private",newIsHidden:!1,outlinerToggleButtonStore:O.Z,shouldPersistToggleState:!0}),l.W2j(o,{from:t,type:"page",new_page_id:d.id}),n.default.afterNextFlush((()=>{x.Z.SidebarScroller&&x.Z.SidebarScroller.scrollToBottom()})),d):void 0}const me=(0,s.defineMessages)({label:{id:"sidebar.newPage.button",defaultMessage:"New page"},tooltip:{id:"sidebar.newPage.tooltip",defaultMessage:"Create a new page"}}),ge="sidebar",he="updateSidebar",fe="sidePeek";function ye(){const e={expanded:W.gV.state,width:W.GZ.state};a.Z.set(ge,e)}function ve(){const{expanded:e,width:t,openedOnBlockId:o,commentsMode:n,currentTab:r,currentSubTab:i}=K.ZP.state,s={expanded:e,width:t,openedOnBlockId:o,commentsMode:n,currentTab:r,currentSubTab:i};a.Z.set(he,s)}function be(){const e=a.Z.get(ge),t=a.Z.get(he),o=a.Z.get(fe);if((0,T.Y)("supportsNativeHome")?(W.gV.setState(!1),W.GZ.setState(0)):e&&(void 0!==e.expanded&&W.gV.setState(e.expanded),void 0!==e.width&&e.width>=W.nP&&W.GZ.setState(e.width)),t){const e=t.width&&t.width>=K.AO?t.width:K.AO;K.ZP.setState({...K.ZP.state,...t,width:e}),window.innerWidth<$&&W.gV.setState(!1)}o&&j.default.setSidePeekWidth(o.width,window.innerWidth)}function Se(e){K.ZP.setState({...K.ZP.state,currentTab:e})}function _e(e){K.ZP.setState({...K.ZP.state,commentsMode:e}),ve()}function we(e){(0,z.Sx)(e)||W.gV.state?(X({environment:e,isExpanded:!1,from:"toggle_both_sidebars"}),te({environment:e,isExpanded:!1,from:"keyboard_default"})):(te({environment:e,isExpanded:!0,from:"keyboard_default"}),X({environment:e,isExpanded:!0,from:"toggle_both_sidebars"}))}function ke(){W.Yr.setState(!1)}},24646:(e,t,o)=>{o.d(t,{$3:()=>S,Bb:()=>M,GD:()=>D,J5:()=>v,Jr:()=>h,Nc:()=>m,Sx:()=>b,U8:()=>P,Wk:()=>w,YR:()=>I,_c:()=>g,em:()=>T,in:()=>f,js:()=>C,ll:()=>k,qG:()=>_,vG:()=>B,vJ:()=>x,vK:()=>y,wE:()=>A});var n=o(5366),r=o(28020),i=o(4708),a=o(38755),s=o(80444),l=o(45325),c=o(88923),d=o(38676),p=o(36391),u=o(21853);const m=800;function g(e){return!1}function h(e){return!!e.device.isDesktop||!!e.device.isTablet&&e.WindowSizeStore.isLandscape()}function f(e){return((0,i.GH)()||e.currentUser.isLoggedIn())&&d.gV.state}function y(e){return b(e)&&p.ZP.state.currentTab===p.gY.Comments}function v(e){return b(e)&&p.ZP.state.currentTab===p.gY.Updates}function b(e){var t;return(null===(t=s.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id)===p.ZP.state.openedOnBlockId&&(e.currentUser.isLoggedIn()&&!e.device.isMobile&&p.ZP.state.expanded||u.Z.state.open)}function S(e){return e.WindowSizeStore.state.width-w(e)-k(e,!1)}function _(e){const{isDesktop:t,isMobile:o,isTablet:n}=e.device,{WindowSizeStore:r}=e,i=r.isLandscape(),a=o&&!n&&i;return t?d.GZ.state:n||a?Math.min(320,.87*e.WindowSizeStore.state.width):.87*e.WindowSizeStore.state.width}function w(e){const{shouldShowSidebar:t}=(0,r.h1)(e),o=f(e);return t&&o&&h(e)?_(e)+l.ZP.getPanelWidthReturnZeroForClosingState():t&&!o&&l.ZP.isOpen()?l.ZP.getPanelWidthReturnZeroForClosingState():0}function k(e,t){return t&&c.default.state.open?0:function(e){0;if(e.device.isMobile)return 0;if(x(e)>0)return 0;return b(e)?p.ZP.state.width:0}(e)+x(e)}function x(e){return c.default.isSidePeekOpen()?c.default.getSidePeekWidth(e.WindowSizeStore.state.width):0}function I(e){return e.device.isAndroid&&!e.device.isTablet||e.device.isTablet&&e.WindowSizeStore.isPortrait()}const C=(0,n.defineMessages)({createOrJoinWorkspace:{defaultMessage:"Create or join workspace",id:"sidebarSwitcher.createOrJoinWorkspaceButton.prompt"},personalPlan:{defaultMessage:"Personal Plan",id:"sidebarSwitcher.personalPlan.label"},proPlan:{defaultMessage:"Personal Pro Plan",id:"sidebarSwitcher.proPlan.label"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"educationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"sidebarSwitcher.educationPlusPlan.label"},freePlan:{defaultMessage:"Free Plan",id:"sidebarSwitcher.freePlan.label"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"sidebarSwitcher.enterprisePlan.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"sidebarSwitcher.legacyPlan.label"},workspaceSubtitleWithMembers:{id:"sidebarSwitcher.workspaceSubtitleWithMembers.label",defaultMessage:"{planType} Â· {numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}}"},workspaceSubtitleWithoutMembers:{id:"sidebarSwitcher.workspaceSubtitleWithoutMembers.label",defaultMessage:"{planType}"}});function T(e){switch(e){case"team_free":case"personal_free":case"free":return C.freePlan;case"personal":return C.plusPlan;case"student":return C.educationPlusPlan;case"plus":return C.plusPlan;case"business":return C.businessPlan;case"enterprise":return C.enterprisePlan;default:return C.legacyPlan}}function M(e){return e.canRead()&&"copy_indicator"!==e.getType()}function P(e){let{isElectronMac:t,isExpanded:o,isFullScreenDesktop:n}=e;return t&&o&&!n}function A(e){let{isElectronMac:t,isExpanded:o,isFullScreenDesktop:n,isShowingTabBar:r}=e;return!r&&P({isElectronMac:t,isExpanded:o,isFullScreenDesktop:n})}function D(e){let{isElectronMac:t,isExpanded:o,isFullScreenDesktop:n,isShowingTabBar:r}=e;return o&&!r&&!A({isElectronMac:t,isExpanded:o,isFullScreenDesktop:n,isShowingTabBar:r})}function B(e){var t;let{environment:o}=e;const n=null===(t=(0,r.k_)(o).state)||void 0===t?void 0:t.showTeamSection,i=s.default.state.currentSpaceStore,l=o.device.isMobile;return!(!n||!i||l)&&!(0,a.Cx)(i)}},88310:(e,t,o)=>{o.d(t,{$L:()=>s,As:()=>c,hV:()=>d,ls:()=>p});var n=o(5809),r=o(72126),i=o(83055);const a={};function s(e){void 0===a[e]&&(a[e]=performance.now())}const l={};function c(e){Object.assign(l,e)}function d(){return l}function p(){const{app_start_to_main_start:e,main_start_to_prefetch_initiated:t,prefetch_initiated_to_render_start:o,render_start_to_render_end:s}=(0,i.IN)().sub_metrics,l=(0,n.$)(),c={app_start_to_await_get_spaces_start:u(l,a.await_get_spaces_start),app_start_to_await_get_spaces_end:u(l,a.await_get_spaces_end),app_start_to_browser_repaint_start:u(l,a.browser_repaint_start),app_start_to_browser_repaint_end:u(l,a.browser_repaint_end)},d=r.GM({app_start_to_main_start:e,main_start_to_prefetch_initiated:t,prefetch_initiated_to_render_start:o,render_start_to_render_end:s,...c},r.o8),p=[e,t,o,s];return p.some(r.o8)||(d.app_start_to_render_end=r.Sm(p)),d}function u(e,t){return void 0===e||void 0===t?void 0:t-e}},68418:(e,t,o)=>{o.d(t,{F:()=>i,Z:()=>s});var n=o(49085),r=o(4615);let i=function(e){return e[e.Team=0]="Team",e[e.Members=1]="Members",e}({});class a extends n.default{getInitialState(){return{open:!1,screen:i.Team,description:"",accessLevel:"open",isDefault:!1,name:"",icon:void 0,flowId:(0,r.ZP)(),pageNumber:1,onClose:void 0}}}const s=new a},97799:(e,t,o)=>{o.d(t,{Y:()=>r,Z:()=>i});var n=o(61766);let r=function(e){return e.Updates="updates",e.Home="home",e}({});const i=new n.Z},55521:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{touching:!1,swiping:!1}}}const i=new r},19034:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(80444);class i extends n.default{getInitialState(){return{results:[]}}getUnreadCountForCurrentSpace(){const{currentSpaceStore:e}=r.default.state,{results:t}=this.state;if(e){const o=t.find((t=>t.spaceId===e.id));if(o)return o.unread}return{mentions:0,following:0,highPriority:0}}getUnreadMentionsCountForOtherSpaces(){const{currentSpaceStore:e}=r.default.state,t=e&&e.id,{results:o}=this.state;let n=0;for(const r of o)r.spaceId!==t&&(n+=r.unread.mentions);return n}getTotalUnreadMentionsCount(){const{results:e}=this.state;let t=0;for(const o of e)t+=o.unread.mentions;return t}}const a=new i},38676:(e,t,o)=>{o.d(t,{GZ:()=>i,H3:()=>m,Ic:()=>l,TC:()=>a,Yr:()=>h,cY:()=>u,ck:()=>c,gV:()=>d,kx:()=>s,nP:()=>g,xH:()=>p});var n=o(49085),r=o(77794);const i=n.default.createValue(240),a=n.default.createValue(!1),s=n.default.createValue(!1),l=n.default.createValue(0),c=n.default.createValue(0),d=n.default.createValue(!0),p=n.default.createValue(!1),u=n.default.createValue({isResizing:!1,isResizerHovered:!1}),m=new r.E,g=220,h=n.default.createValue(!0)},97852:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61766).Z)},78861:(e,t,o)=>{o.d(t,{Z:()=>p});var n=o(49085),r=o(72126),i=o(19889),a=o(66079),s=o(63143),l=o(81236),c=o(35661);class d extends n.default{getInitialState(){return{createType:void 0}}getUserIds(e){return e.currentUser.loggedInUserIds}getAllSpaceViewStores(e){return this.getUserIds(e).reduce(((t,o)=>[...t,...this.getSpaceViewStores(e,o)]),[])}hasAtLeastOneTeamPlan(e){return this.getAllSpaceViewStores(e).map((e=>{const t=e.getSpaceStore();if(t)return t.getPlanType()})).some((e=>"team"===e))}getSpaceViewStores(e,t){const o=new c.r9(e,{table:a.dx,id:t},{userId:t}).getSpaceViewStores();return r.mN(o,(e=>e.isDefined()&&e.getSpaceId())).filter((t=>Boolean(t.isDefined())&&Boolean(t.getAlive())&&!this.isSpaceDeleted(e,t)))}isSpaceDeleted(e,t){const o=t.getSpaceId()||"",n=l.Z.getPublicSpaceData(e,o);return(0,s.z4)(n)}getUserEmailAddress(e,t){return new c.U6(e,{table:i.KJ,id:t},{userId:t}).getEmail()}}const p=new d},55838:(e,t,o)=>{o.d(t,{Z:()=>a,a:()=>r});var n=o(49085);let r=function(e){return e[e.General=0]="General",e[e.Members=1]="Members",e[e.Security=2]="Security",e}({});class i extends n.default{getInitialState(){return{open:!1,limitMembers:!0,memberFilterQuery:"",tab:void 0}}getTeamStore(){return this.state.open?this.state.viewingUnjoinedPrivateTeamAsEnterpriseAdmin?this.state.unjoinedPrivateTeamStore:this.state.teamStore:void 0}}const a=new i},36896:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61766).Z)},44604:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{constructor(){super(...arguments),this.loadMoreOffset=200,this.startLimit=20,this.limitIncrement=20}getInitialState(){return{filter:"",currentTab:"all_pages",loading:!0,limit:this.startLimit,excludePages:new Set}}}const i=new r},36391:(e,t,o)=>{o.d(t,{AO:()=>l,F7:()=>i,ZP:()=>p,gY:()=>a,uF:()=>s});var n=o(49085),r=o(92595);let i=function(e){return e[e.Resolved=0]="Resolved",e[e.Unresolved=1]="Unresolved",e}({}),a=function(e){return e[e.Comments=0]="Comments",e[e.Updates=1]="Updates",e}({}),s=function(e){return e[e.Updates=0]="Updates",e[e.Analytics=1]="Analytics",e}({});const l=385;class c extends n.default{getInitialState(){return{width:l,expanded:!1,isResizerHovered:!1,isResizing:!1,mouseEntered:!1,currentTab:a.Comments,currentSubTab:s.Updates,commentsMode:i.Unresolved,isAnimating:!1,canRender:!0}}}const d=new c;(0,r.exposeDebugValue)("UpdateSidebarStore",d);const p=d},21853:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61766).Z)},98794:(e,t,o)=>{o.r(t),o.d(t,{annotateSimpleTableSelection:()=>ee,appendRow:()=>me,cancelReorder:()=>Ie,clearHover:()=>re,clearSelectedCell:()=>Ee,clearSelection:()=>G,clearSelectionContents:()=>Fe,completeReorder:()=>Ce,continueReorder:()=>xe,contractColumns:()=>Me,contractRows:()=>De,deleteColumns:()=>Te,deleteRows:()=>Ae,duplicateColumns:()=>ge,duplicateRows:()=>he,expandCellSelection:()=>z,extendColumns:()=>ae,extendRows:()=>pe,fitToPage:()=>Ve,handleDelete:()=>Q,handleDuplicate:()=>X,handleKeypress:()=>J,handleLeftRightKey:()=>K,handleUpDownKey:()=>Y,hoverCell:()=>te,hoverResizer:()=>ne,hoverRowColumn:()=>oe,insertColumnLeft:()=>ie,insertColumnRight:()=>se,insertRow:()=>ue,insertRowAbove:()=>ce,insertRowBelow:()=>de,messages:()=>L,resizeColumn:()=>Se,selectCell:()=>V,selectCellAndSetCursor:()=>W,selectColumn:()=>Z,selectMultiCell:()=>q,selectRow:()=>U,setColor:()=>Ze,setResizing:()=>ve,showResizeBar:()=>ye,startReorder:()=>ke,toggleHeaderColumn:()=>Ue,toggleHeaderRow:()=>Le,turnIntoCollection:()=>je,turnIntoSimpleTable:()=>Oe,updateCellSelectionFromTextSelection:()=>H,updateColumnSelectionOnResize:()=>we,updateRowSelectionOnResize:()=>_e});o(57658),o(21703);var n=o(1302),r=o(41432),i=o(90559),a=o(99036),s=o(80951),l=o(4615),c=o(71644),d=o(21202),p=o(6287),u=o(13493),m=o(23867),g=o(70203),h=o(63143),f=o(5366),y=o(54532),v=o(96802),b=o(94419),S=o(19785),_=o(9953),w=o(24677),k=o(97444),x=o(98104),I=o(39699),C=o(95477),T=o(14976),M=o(33929),P=o(65598),A=o(22294),D=o(35661),B=o(27724),R=o(24666),E=o(27534),F=o(84139),N=o(64359),j=o(5676),O=o(63208);const L=(0,f.defineMessages)({turnIntoCollectionTitle:{defaultMessage:"Title",id:"simpleTableActions.collectionTitle"},turnIntoCollectionColumnTitle:{defaultMessage:"Column {columnIndex}",id:"simpleTableActions.collectionColumnTitle"}});function U(e){const{environment:t,index:o,simpleTableStore:n}=e,r=E.getNumberOfRows(n);if(0===r)return G(),void x.ZH(t);const i=(0,h.uZ)(o,0,r-1);O.Z.setState({isActive:!0,simpleTableStore:n,selection:{start:{col:0,row:i},end:{col:E.getNumberOfColumns(n)-1,row:i},type:"row"}}),w.Z5({environment:t,stores:[n],phase:B.SelectionPhase.Editing}),x.ZH(t)}function Z(e){const{environment:t,index:o,simpleTableStore:n}=e,r=E.getNumberOfColumns(n);if(0===r)return G(),void x.ZH(t);const i=(0,h.uZ)(o,0,r-1);O.Z.setState({isActive:!0,simpleTableStore:n,selection:{start:{col:i,row:0},end:{col:i,row:E.getNumberOfRows(n)-1},type:"column"}}),w.Z5({environment:t,stores:[n],phase:B.SelectionPhase.Editing}),x.ZH(t)}function V(e){const{environment:t,rowIndex:o,columnIndex:n,simpleTableStore:r}=e;O.Z.setState({isActive:!0,simpleTableStore:r,selection:{start:{col:n,row:o},end:{col:n,row:o},type:"cell"}}),w.Z5({environment:t,stores:[r],phase:B.SelectionPhase.Editing})}function q(e){const{environment:t,start:o,end:n,simpleTableStore:r}=e;O.Z.setState({isActive:!0,simpleTableStore:r,selection:{start:o,end:n,type:"cell"}}),w.Z5({environment:t,stores:[r],phase:B.SelectionPhase.Editing}),x.ZH(t)}function z(e){const{environment:t,rowIndex:o,columnIndex:n,simpleTableStore:r}=e;q({environment:t,start:O.Z.state.isActive?O.Z.state.selection.start:{col:n,row:o},end:{col:n,row:o},simpleTableStore:r})}function W(e){V(e);const t=E.getCellTextStore(e);t&&x.NX({store:t})}function H(){if("editing"!==R.default.state.mode)return;const e=E.getSimpleTableCellFromTextSelection();if(!e)return void G();const{columnIndex:t,rowIndex:o,simpleTableStore:n}=e.props,r=O.Z.state;if(r.isActive){const{start:e,end:i}=r.selection;!(e.col===i.col&&e.row===i.row)||e.col===t&&e.row===o&&r.simpleTableStore===n||V({environment:n.environment,rowIndex:o,columnIndex:t,simpleTableStore:n})}else V({environment:n.environment,rowIndex:o,columnIndex:t,simpleTableStore:n})}function G(){O.Z.setState({isActive:!1})}function K(e){const{environment:t,direction:o,bypassExistingTextSelection:n,expandSelection:r}=e;if(!n&&E.getSimpleTableCellFromTextSelection())return;const i=O.Z.state;if(i.isActive){const{selection:e,simpleTableStore:a}=i;if(r){const{rowIndex:n,columnIndex:r}=$({selection:e,simpleTableStore:a,direction:o,wrapRow:!1});return void z({environment:t,rowIndex:n,columnIndex:r,simpleTableStore:a})}if(E.isColumnSelected({selection:e,columnIndex:e.start.col,simpleTableStore:a})){const{columnIndex:n}=$({selection:e,simpleTableStore:a,direction:o,wrapRow:!1});Z({environment:t,index:n,simpleTableStore:a})}else{const r="editing"===R.default.state.mode;n&&x.ZH(t);const{rowIndex:i,columnIndex:s}=$({selection:e,simpleTableStore:a,direction:o,wrapRow:!0});if(r)return void W({environment:t,rowIndex:i,columnIndex:s,simpleTableStore:a});V({environment:t,rowIndex:i,columnIndex:s,simpleTableStore:a})}}A.Z.setKeyboardMode(!0)}function $(e){const{selection:t,simpleTableStore:o,direction:n,wrapRow:r}=e,i=E.getNumberOfColumns(o)-1,a=E.getNumberOfRows(o)-1,{col:s,row:l}=t.end;return"right"===n?s===i&&l===a?{columnIndex:i,rowIndex:a}:s===i?r?{columnIndex:0,rowIndex:l+1}:{columnIndex:s,rowIndex:l}:{columnIndex:s+1,rowIndex:l}:0===s&&0===l?{columnIndex:0,rowIndex:0}:0===s?r?{columnIndex:i,rowIndex:l-1}:{columnIndex:s,rowIndex:l}:{columnIndex:s-1,rowIndex:l}}function Y(e){const{environment:t,direction:o,bypassExistingTextSelection:n,expandSelection:r}=e;if(!n&&E.getSimpleTableCellFromTextSelection())return;const i=O.Z.state;if(i.isActive){const{selection:e,simpleTableStore:a}=i,{rowIndex:s,columnIndex:l}=function(e){const{selection:t,simpleTableStore:o,direction:n}=e,r=E.getNumberOfRows(o)-1,{col:i,row:a}=t.end,s="down"===n?Math.min(r,a+1):Math.max(0,a-1);return{columnIndex:i,rowIndex:s}}({selection:e,simpleTableStore:a,direction:o});if(r)return void z({environment:t,rowIndex:s,columnIndex:l,simpleTableStore:a});E.isRowSelected({selection:e,rowIndex:e.start.row,simpleTableStore:a})?U({environment:t,index:s,simpleTableStore:a}):(n&&x.ZH(t),V({environment:t,rowIndex:s,columnIndex:l,simpleTableStore:a}))}A.Z.setKeyboardMode(!0)}function Q(e){if(E.getSimpleTableCellFromTextSelection())return;const t=O.Z.state;if(!t.isActive)return;const{environment:o,transaction:n}=e,{selection:r,simpleTableStore:i}=t;if(E.isColumnSelected({selection:r,columnIndex:r.start.col,simpleTableStore:i}))Fe(e),Pe({index:r.start.col,simpleTableStore:i,transaction:n}),Z({environment:o,index:r.start.col,simpleTableStore:i});else if(E.isRowSelected({selection:r,rowIndex:r.start.row,simpleTableStore:i})){Be({rowID:i.getRenderableContentIds()[r.start.row],simpleTableStore:i,transaction:n}),U({environment:o,index:r.start.row,simpleTableStore:i})}else E.isSingleCellSelected(r)?Ee({environment:o,transaction:n}):Fe({environment:o,transaction:n})}function J(e){if(E.getSimpleTableCellFromTextSelection())return;const t=O.Z.state;if(!t.isActive)return;const{selection:o,simpleTableStore:n}=t,r=n.getContentStores()[o.end.row],i=E.getColumnOrder(n);if(!i)return;const{environment:a,transaction:s,key:l}=e,c=r.getPropertyStore(i[o.end.col]);if(l&&1===l.length){const e=c.getValue(),t=g.TPx(l);k.sO({environment:a,store:c,value:e?e.concat(t):t,transaction:s}),x.NX({store:c})}}function X(e){if(E.getSimpleTableCellFromTextSelection())return;const t=O.Z.state;if(!t.isActive)return;const{environment:o,transaction:n}=e,{selection:r,simpleTableStore:i}=t;E.isColumnSelected({selection:r,columnIndex:r.start.col,simpleTableStore:i})?ge({transaction:n}):E.isRowSelected({selection:r,rowIndex:r.start.row,simpleTableStore:i})&&he({environment:o,transaction:n})}function ee(e){const{simpleTableStore:t,annotation:o}=e,n=O.Z.state;if(!n.isActive||n.simpleTableStore!==t)return;const{selection:r}=n,i=[],a=Math.min(r.start.row,r.end.row),s=Math.max(r.start.row,r.end.row),l=Math.min(r.start.col,r.end.col),c=Math.max(r.start.col,r.end.col);for(let u=a;u<=s;u++)for(let e=l;e<=c;e++){const o=E.getCellTextStore({simpleTableStore:t,rowIndex:u,columnIndex:e}),n=null==o?void 0:o.getValue();o&&n&&i.push({textStore:o,textValue:n})}const d=g.J7s(o),p=i.every((e=>{let{textValue:t}=e;return t.every((e=>g.hDy(e).some((e=>g.J7s(e)===d))))}));for(const{textStore:u}of i)k.QT({...e,textStore:u,action:p?"removeAnnotationType":"annotate"})}function te(e){if(be())return;const{x:t,y:o,simpleTableStore:n}=e;N.Z.setState({isActive:!0,simpleTableStore:n,hover:{x:t,y:o,showResizer:!1,resizing:!1,type:"cell"}})}function oe(e){if(be())return;const{type:t,simpleTableStore:o,index:n}=e;N.Z.setState({isActive:!0,simpleTableStore:o,hover:{type:t,index:n}})}function ne(e){const{simpleTableStore:t,resizer:o}=e;N.Z.setState({isActive:!0,simpleTableStore:t,hover:{type:"resizer",resizer:o}})}function re(){be()||N.Z.setState({isActive:!1})}function ie(e){const t=O.Z.state;if(!t.isActive)return;const{selection:o,simpleTableStore:n}=t,{environment:r,transaction:i}=e;le({index:o.start.col,simpleTableStore:n,transaction:i}),W({environment:r,rowIndex:0,columnIndex:o.start.col,simpleTableStore:n})}function ae(e){const{count:t,simpleTableStore:o,transaction:n}=e;if(t<1)return;const r=E.getNumberOfColumns(o);for(let i=0;i<t;i++)le({index:r+i,simpleTableStore:o,transaction:n})}function se(e){const t=O.Z.state;if(!t.isActive)return;const{selection:o,simpleTableStore:n}=t,{environment:r,transaction:i}=e;le({index:o.end.col+1,simpleTableStore:n,transaction:i}),W({environment:r,rowIndex:0,columnIndex:o.end.col+1,simpleTableStore:n})}function le(e){const{index:t,simpleTableStore:o,transaction:n,columnID:r,format:i}=e,a=E.getColumnOrder(o)||[],s=E.getColumnFormat(o),l=r||(0,c.ZP)(),d=[...a.slice(0,t),l,...a.slice(t)],p=i?{...s,[l]:i}:s;v.FH({stores:[o],update:{table_block_column_order:d,table_block_column_format:p},transaction:n})}function ce(e){const t=O.Z.state;if(!t.isActive)return;const{selection:o,simpleTableStore:n}=t,{environment:r,transaction:i}=e;ue({environment:r,index:o.start.row,simpleTableStore:n,transaction:i}),W({environment:r,rowIndex:o.start.row,columnIndex:0,simpleTableStore:n})}function de(e){const t=O.Z.state;if(!t.isActive)return;const{selection:o,simpleTableStore:n}=t,{environment:r,transaction:i}=e;ue({environment:r,index:o.end.row+1,simpleTableStore:n,transaction:i}),W({environment:r,rowIndex:o.end.row+1,columnIndex:0,simpleTableStore:n})}function pe(e){const{environment:t,count:o,simpleTableStore:n,transaction:r}=e;if(o<1)return;const i=E.getNumberOfRows(n);for(let a=0;a<o;a++)ue({environment:t,index:i+a,simpleTableStore:n,transaction:r})}function ue(e){const{environment:t,index:o,simpleTableStore:n,transaction:r}=e,i=n.getContentStore();if(!(0,P.dz)(i))throw new Error("Block has an invalid parent.");const a=_.j4({environment:t,type:"table_row",properties:{},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:r,spaceId:n.pointer.spaceId,useCrdt:n.useCrdt()}),s=D.G.createChildStore(i,a.pointer);if(o<=0)S.SH({parentStore:i,childStore:s,transaction:r});else{const e=n.getContentStores();S.jG({parentStore:i,childStore:s,transaction:r,after:e[o-1].id})}return s}function me(e){const{environment:t,simpleTableStore:o,transaction:n}=e,r=o.getContentStore();if(!(0,P.dz)(r))throw new Error("Block has an invalid parent.");const i=_.j4({environment:t,type:"table_row",properties:{},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:n,spaceId:o.pointer.spaceId,useCrdt:o.useCrdt()}),a=D.G.createChildStore(r,i.pointer);return S.jG({parentStore:r,childStore:a,transaction:n}),a}function ge(e){const t=O.Z.state;if(!t.isActive)return;const{selection:o,simpleTableStore:n}=t,r=E.getColumnOrder(n),i=E.getColumnFormat(n);if(!r)return;const a=r.slice(o.start.col,o.end.col+1);if(!a)return;const s=[],{transaction:l}=e;for(let d=o.start.col;d<=o.end.col;d++){const e=a[d-o.start.col],t=(0,c.ZP)();s.push(t),le({index:o.end.col+1,simpleTableStore:n,transaction:l,columnID:t,format:i?i[e]:void 0})}for(const c of n.getContentStores())fe({rowStore:c,columnIDs:a,newColumnIDs:s,transaction:l})}function he(e){const t=O.Z.state;if(!t.isActive)return;const{selection:o,simpleTableStore:n}=t,r=n.getRenderableContentIds(),{environment:i,transaction:a}=e;for(let s=o.start.row;s<=o.end.row;s++){const e=D.G.createChildStore(n,{table:d.iU,id:r[s]}),[t]=y.Qi({environment:i,stores:[e],addCopyName:!1,transaction:a,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,targetSpaceId:(0,m.C)(e.pointer.spaceId),baseUrl:C.default.domainBaseUrl,publicDomainName:C.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:n.useCrdt()}),o=t[0];b.BE({parent:n.getContentStore(),insert:o,after:e,transaction:a})}}function fe(e){const{rowStore:t,columnIDs:o,newColumnIDs:n,transaction:r}=e,i=t.getPropertiesStore(),a={...i.getValue(),...(0,h.m8)(n.map(((e,n)=>[e,t.getPropertyValue(o[n])])))};_.sO({store:i,value:a,transaction:r})}function ye(e){const t=N.Z.state;if(!t.isActive)return;const{hover:o}=t;"cell"===o.type&&N.Z.setState({...t,hover:{...o,showResizer:e}})}function ve(e){const t=N.Z.state;if(!t.isActive)return;const{hover:o}=t;"cell"===o.type&&N.Z.setState({...t,hover:{...o,resizing:e}})}function be(){const e=N.Z.state;return e.isActive&&"resizing"in e.hover&&e.hover.resizing}function Se(e){const{tableBlockColumnFormat:t,simpleTableStore:o,transaction:n}=e;v.FH({stores:[o],update:{table_block_column_format:t},transaction:n})}function _e(e){const t=O.Z.state;if(!t.isActive||"row"!==t.selection.type)return;const{selection:o}=t;O.Z.setState({...t,selection:{...o,end:{col:e,row:o.end.row}}})}function we(e){const t=O.Z.state;if(!t.isActive||"column"!==t.selection.type)return;const{selection:o}=t;O.Z.setState({...t,selection:{...o,end:{col:o.end.col,row:e}}})}function ke(e){const{environment:t,simpleTableStore:o,id:n,index:r,type:i,rowStore:a,theme:s,selectorStartPx:l,mouseOffsetPx:c}=e;let d=[];"column"===i?(Z({environment:t,index:r,simpleTableStore:o}),d=F.Z.findCellsInColumnFromStore(o,n)):(U({environment:t,index:r,simpleTableStore:o}),d=F.Z.findCellsInRowFromStore(a));const p=E.cloneCellsForDragOverlay({cells:d,type:i,theme:s});j.Z.setState({isActive:!0,simpleTableStore:o,source:{id:n,type:i,index:r,draggedCells:p,selectorStartPx:l,mouseOffsetPx:c},destIndex:r,selectorDragPx:l,moved:!1})}function xe(e){const{destIndex:t,selectorDragPx:o}=e,n=j.Z.state;n.isActive&&j.Z.setState({...n,destIndex:t,selectorDragPx:o,moved:!0})}function Ie(){j.Z.reset()}function Ce(e){const{event:t,environment:o,format:r,simpleTableStore:i,transaction:a,type:s,onNoChange:l}=e,c=j.Z.state;if(!c.isActive)return;const{source:d,destIndex:p}=c;d.type===s&&c.simpleTableStore===i&&("column"===s?function(e){const{environment:t,columnOrder:o,source:r,destIndex:i,simpleTableStore:a,transaction:s}=e;if(!o)return;G();const l=[...o.slice(0,r.index),...o.slice(r.index+1)],c=[...l.slice(0,i),r.id,...l.slice(i)];v.FH({stores:[a],update:{table_block_column_order:c},transaction:s}),n.default.afterNextFlush((()=>{Z({environment:t,index:i,simpleTableStore:a})}))}({environment:o,columnOrder:r.table_block_column_order,source:d,destIndex:p,simpleTableStore:i,transaction:a}):function(e){const{environment:t,source:o,destIndex:r,simpleTableStore:i,transaction:a}=e,s=i.getRenderableContentIds(),l=r>o.index?r:r-1;let c=r>0?s[l]:void 0;c===o.id&&(c=s[l+1]);G();const d=i.getContentStores().find((e=>e.id===o.id)),p=i.getContentStores().find((e=>e.id===c));if(d){const e=i;p?S.jG({parentStore:e,after:p.id,childStore:d,transaction:a}):S.SH({parentStore:e,childStore:d,transaction:a}),n.default.afterNextFlush((()=>{U({environment:t,index:r,simpleTableStore:i})}))}}({environment:o,source:d,destIndex:p,simpleTableStore:i,transaction:a}),d.index===p&&(null==l||l(t)))}function Te(e){const t=O.Z.state;if(!t.isActive)return;Fe(e);const{selection:o,simpleTableStore:n}=t,{environment:r,transaction:i}=e;for(let a=o.start.col;a<=o.end.col;a++)Pe({index:a,simpleTableStore:n,transaction:i});Z({environment:r,index:o.start.col,simpleTableStore:n})}function Me(e){const{simpleTableStore:t,columnOrder:o,transaction:n}=e;v.FH({stores:[t],update:{table_block_column_order:o},transaction:n})}function Pe(e){const{index:t,simpleTableStore:o,transaction:n}=e,r=E.getColumnOrder(o);if(!r||1===r.length)return;const i=[...r.slice(0,t),...r.slice(t+1)];v.FH({stores:[o],update:{table_block_column_order:i},transaction:n})}function Ae(e){const t=O.Z.state;if(!t.isActive)return;const{selection:o,simpleTableStore:n}=t,r=n.getRenderableContentIds(),{environment:i,transaction:a}=e;for(let s=o.start.row;s<=o.end.row;s++)Be({rowID:r[s],simpleTableStore:n,transaction:a});U({environment:i,index:o.start.row,simpleTableStore:n})}function De(e){const{simpleTableStore:t,numRowsToDelete:o,transaction:n}=e,r=t.getRenderableContentIds();for(let i=r.length-o;i<r.length;i++)Be({rowID:r[i],simpleTableStore:t,transaction:n})}function Be(e){const{rowID:t,simpleTableStore:o,transaction:n}=e,r=o.getContentStore();if(!(0,P.dz)(r))throw new Error("Block has an invalid parent.");if(E.getNumberOfRows(o)<=1)return;const i={table:d.iU,id:t};Re({rowStore:D.G.createChildStore(r,i),simpleTableStore:o,transaction:n})}function Re(e){const{rowStore:t,simpleTableStore:o,transaction:n}=e,r=o.getContentStore();S.hr({parentStore:r,childStore:t,transaction:n})}function Ee(e){const t=O.Z.state;if(!t.isActive)return;const{selection:o}=t;if(!E.isSingleCellSelected(o))return;const{environment:n,transaction:r}=e;Fe({environment:n,transaction:r})}function Fe(e){const t=O.Z.state;if(!t.isActive)return;const{selection:o,simpleTableStore:n}=t,r=E.getColumnOrder(n);if(!r)return;const i=n.getContentStores(),{environment:a,transaction:s}=e,l=Math.min(o.start.row,o.end.row),c=Math.max(o.start.row,o.end.row),d=Math.min(o.start.col,o.end.col),p=Math.max(o.start.col,o.end.col);for(let u=l;u<=c;u++)Ne({rowStore:i[u],startIndex:d,endIndex:p,columnOrder:r,transaction:s});x.ZH(a)}function Ne(e){const{rowStore:t,startIndex:o,endIndex:n,columnOrder:r,transaction:i}=e,a=r.slice(o,n+1);if(!a)return;const s=t.getPropertiesStore(),l=(0,h.m8)(Object.entries(s.getValue()||{}).filter((e=>{let[t,o]=e;return!a.includes(t)})));_.sO({store:s,value:l,transaction:i})}function je(e){const{simpleTableStore:t,transaction:o}=e,n=E.getColumnOrder(t)||[],i=E.getColumnFormat(t)||{},{headerRow:s}=E.getHeadersEnabled(t),c=t.getContentStores();if(!n.length)return;const m=n[0],g=t.getSpaceId(),f=(0,l.ZP)(),y=(0,l.ZP)(),v=s?c[0]:void 0,b=(0,h.m8)(n.map(((e,t)=>function(e){const{columnID:t,columnIndex:o,titleColumnID:n,headerRowStore:r}=e;let i=t,a="text",s=L.turnIntoCollectionColumnTitle;t===n&&(i="title",a="title",s=L.turnIntoCollectionTitle);const l=M.default.getIntl();return[i,{name:r?T.Xh(r.getPropertyValue(t),r):l.formatMessage(s,{columnIndex:o}),type:a}]}({columnID:e,columnIndex:t,titleColumnID:m,headerRowStore:v})))),S={id:f,version:0,parent_table:d.iU,parent_id:t.id,space_id:g,name:void 0,schema:b,alive:!0},w={table:p.v,id:f,spaceId:g};I.applyOperation({store:(0,D.Kv)(t,w),operation:{pointer:w,command:"set",path:[],args:S},transaction:o}),_.sW({store:t,data:{type:r.Ti.collectionView,collection_id:f,format:{collection_pointer:{table:p.v,id:f,spaceId:g}},view_ids:[y],content:[]},transaction:o}),c.map(((e,n)=>{if(s&&0===n)return void Re({rowStore:e,simpleTableStore:t,transaction:o});const i=e.getProperties();_.sW({store:e,data:{type:r.Ti.page,parent_id:f,parent_table:p.v,properties:{...i,title:i[m],[m]:void 0}},transaction:o})}));const k={id:y,version:0,type:"table",name:void 0,parent_id:t.id,parent_table:"block",space_id:g,format:{table_properties:n.map((e=>({visible:!0,property:e===m?"title":e,width:i&&e in i?i[e].width:void 0})))},page_sort:c.map((e=>e.id)).slice(0,a.gq),alive:!0},x={table:u.n,id:y,spaceId:g};I.applyOperation({store:(0,D.Kv)(t,x),operation:{pointer:x,command:"set",path:[],args:k},transaction:o})}function Oe(e){var t;const{environment:o,collectionViewBlockStore:n,pageStores:a,transaction:l}=e,p=n.getCollectionViewSourceCollectionStore();if(!p)return;if(a.length>E.simpleTableTransformPageLimit||a.some((e=>e.hasContent())))return;const[u]=n.getCollectionViewStores(),m=p.getSchema(),g=(u.getFormat().table_properties||[]).filter((e=>e.visible&&e.property in m));if(!g)return;const f=n.getContentStore(),y=(0,c.ZP)();_.sW({store:n,data:{type:r.Ti.table,format:{table_block_column_order:g.map((e=>"title"===e.property?y:e.property)),table_block_column_format:(0,h.m8)(g.map((e=>["title"===e.property?y:e.property,{width:e.width}]))),table_block_column_header:!0}},transaction:l});const v=_.j4({environment:o,type:"table_row",properties:(0,h.m8)(g.map((e=>{const t=e.property,o=t in m?m[t]:void 0;return["title"===t?y:t,o?[[o.name]]:[]]}))),inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache,transaction:l,spaceId:n.pointer.spaceId,useCrdt:n.useCrdt()}),b=D.G.createChildStore(f,v.pointer);S.SH({parentStore:f,childStore:b,transaction:l});const w=(0,i.$z)(m),k=w.length>0?null===(t=p.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey():void 0;a.map(((e,t)=>{const o=D.G.createChildStore(f,e.pointer),a=e.getProperties(),c=w.reduce((function(e,t){const o=(0,i.wf)(k,s.ah(a[t]));return e[t]=[[o]],e}),{});_.sW({store:o,data:{type:r.Ti.tableRow,parent_id:n.id,parent_table:d.iU,properties:{...a,...c,title:void 0,[y]:a.title}},transaction:l}),S.jG({parentStore:f,childStore:o,transaction:l})})),_.sW({store:p,data:{alive:!1},transaction:l}),_.sW({store:u,data:{alive:!1},transaction:l})}function Le(e){const{simpleTableStore:t,transaction:o}=e,n=t.getFormat(),r=!Boolean(n.table_block_column_header);v.FH({stores:[t],update:{table_block_column_header:r},transaction:o})}function Ue(e){const{simpleTableStore:t,transaction:o}=e,n=t.getFormat(),r=!Boolean(n.table_block_row_header);v.FH({stores:[t],update:{table_block_row_header:r},transaction:o})}function Ze(e,t,o){const n=O.Z.state;if(!n.isActive)return;const{selection:r,simpleTableStore:i}=n;if("row"===r.type){const e=i.getContentStores()[r.start.row];v.FH({stores:[e],update:{block_color:"default"===t?void 0:t},transaction:o})}if("column"===r.type){const e=E.getColumnOrder(i),n=E.getColumnFormat(i)||{};if(!e)return;const a=e[r.start.col];a in n?n[a].color=t:n[a]={color:t},v.FH({stores:[i],update:{table_block_column_format:n},transaction:o})}B.default.state.phase!==B.SelectionPhase.Selected||e.device.isMobile||w.ZH(e)}function Ve(e){const{simpleTableStore:t,parentWidth:o,transaction:n}=e,r=E.getColumnOrder(t);if(!r)return;const i=E.getColumnFormat(t),a=(o-18)/r.length,s=(0,h.m8)(r.map((e=>[e,{width:a,color:i&&i[e]?i[e].color:void 0}])));v.FH({stores:[t],update:{table_block_column_format:s},transaction:n})}},27534:(e,t,o)=>{o.r(t),o.d(t,{blockSelectionInSimpleTable:()=>C,cloneCellsForDragOverlay:()=>B,columnsHaveData:()=>j,getCellTextStore:()=>D,getColumnFormat:()=>x,getColumnOrder:()=>_,getHeadersEnabled:()=>I,getNextEditableStoreForSimpleTable:()=>V,getNumberOfColumns:()=>w,getNumberOfRows:()=>k,getNumberOfUnresolvedComments:()=>F,getPagesInCollectionForSimpleTableTransform:()=>U,getPreviousEditableStoreForSimpleTable:()=>Z,getSimpleTableCellFromTextSelection:()=>A,getTableResizeState:()=>R,isColumnSelected:()=>T,isPropertyTypeConvertableToSimpleTable:()=>O,isRowSelected:()=>M,isSingleCellSelected:()=>P,renderCellValueForActivity:()=>E,rowsHaveData:()=>N,simpleTableTransformPageLimit:()=>L});var n=o(8848),r=o(42875),i=o(29477),a=o(21202),s=o(23867),l=o(97880),c=o(54642),d=o(42239),p=o(60682),u=o(43250),m=o(14976),g=o(65598),h=o(89086),f=o(24646),y=o(35661),v=o(24666),b=o(84139),S=o(29574);function _(e){var t;return null===(t=e.getFormat())||void 0===t?void 0:t.table_block_column_order}function w(e){var t;return(null===(t=_(e))||void 0===t?void 0:t.length)||0}function k(e){return e.getContentLength()}function x(e){var t;return null===(t=e.getFormat())||void 0===t?void 0:t.table_block_column_format}function I(e){var t,o;return{headerColumn:null==e||null===(t=e.getFormat())||void 0===t?void 0:t.table_block_row_header,headerRow:null==e||null===(o=e.getFormat())||void 0===o?void 0:o.table_block_column_header}}function C(e){const t=["table","table_row"];return e.map((e=>e.getType())).some((e=>e&&t.includes(e)))}function T(e){const{selection:t,columnIndex:o,simpleTableStore:n}=e,r=t.start.col<=o&&o<=t.end.col;return"column"===t.type&&r&&0===t.start.row&&t.end.row===k(n)-1}function M(e){const{selection:t,rowIndex:o,simpleTableStore:n}=e,r=t.start.row<=o&&o<=t.end.row;return"row"===t.type&&r&&0===t.start.col&&t.end.col===w(n)-1}function P(e){return e.start.col===e.end.col&&e.start.row===e.end.row}function A(){const e="editing"===v.default.state.mode&&v.default.state.multiSelection;if(e)return b.Z.findCellFromTextStore(e.start.store)}function D(e){const{simpleTableStore:t,rowIndex:o,columnIndex:n}=e,r=t.getContentStores()[o];if(!r)return;const i=_(t);if(!i)return;const a=i[n];return a?r.getPropertyStore(a):void 0}function B(e){const{cells:t,type:o,theme:r}=e;return t.map((e=>function(e){const{cell:t,type:o,theme:r}=e;if(!t.getNode())return;const i=d.eN(t.getNode()),a=i.cloned.querySelector(`.${u.Apy}`),s=i.cloned.querySelector(`.${u.f0e}`);"column"===o?(a&&(a.style.left="calc(50% - 15px)",a.style.fill=n.ZP.white,a.style.background=r.simpleTableSelectionBorder),s&&(s.style.visibility="hidden")):(s&&(s.style.top="calc(50% - 15px)",s.style.left="-7px",s.style.fill=n.ZP.white,s.style.background=r.simpleTableSelectionBorder),a&&(a.style.visibility="hidden"));return{cloned:i.cloned,rect:DOMRect.fromRect(i.rect)}}({cell:e,type:o,theme:r}))).filter(l.$K)}function R(e,t){const o=S.Z.state;if(o.isActive&&o.simpleTableStore===e&&(!t||o.resize===t))return o}function E(e){const{environment:t,cellValue:o,spaceId:n,parentStore:r,theme:i}=e;return m.IY({environment:t,textValue:o?{value:o,spaceId:n}:void 0,parentStore:r,disableStyleAnnotations:!0,disableDateStyleAnnotations:!0,disableHover:!0,disabled:!0,theme:i,emojiType:(0,p.e_)(t),katex:t.KatexStore.getKatex(),formulaValueTypes:[]})}function F(e){const{simpleTableStore:t,environment:o,includeInline:n}=e;return g.Xp(t,{recursivelyLoadAllDiscussions:n,onlyIncludeBlockLevelDiscussions:(0,f.Sx)(o)})}function N(e){const{simpleTableStore:t,lastN:o}=e,n=t.getContentStores(),r=_(t);if(!n||!r)return!1;for(let i=n.length-1;i>Math.max(n.length-1-o,0);i--){const e=n[i].getProperties();if(e&&r.some((t=>t in e&&e[t])))return!0}return!1}function j(e){const{simpleTableStore:t,lastN:o}=e,n=t.getContentStores(),r=_(t);if(!n||!r)return!1;const i=r.slice(-o);return n.some((e=>{const t=e.getProperties();return t&&i.some((e=>e in t&&t[e]))}))}const O={title:!0,text:!0,url:!0,email:!0,person:!0,number:!0,date:!0,phone_number:!0,select:!0,multi_select:!0,status:!0,auto_increment_id:!0,file:!1,checkbox:!1,relation:!1,rollup:!1,formula:!1,created_by:!1,created_time:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,button:!1,location:!1,verification:!1},L=200;async function U(e){const{environment:t,collectionViewBlockStore:o}=e,n=o.getCollectionViewSourceCollectionStore();if(!n)return[];const[l]=o.getCollectionViewStores(),d={source:{type:"collection",id:n.id,spaceId:(0,s.C)(n.pointer.spaceId)},collectionView:{id:l.id,spaceId:(0,s.C)(l.pointer.spaceId)},loader:{type:"reducer",reducers:{results:{type:"results",limit:L+1,loadContentCover:!1}},searchQuery:void 0,userId:t.currentUser.id,userTimeZone:(0,r.r)()}},p=c.queryCollection(t,d,void 0,{src:"simple_tbl_transform"}),u=await(0,i.OI)(1e4,[p]);if(!u.timeout){const{result:e}=u;if("success"===e.type){const t=e.data.result.reducerResults.results;return(t&&"results"===t.type?t.blockIds:[]).map((e=>y.G.createChildStore(n,{id:e,table:a.iU})))}}return[]}function Z(e){let t;if(0===e.props.rowIndex){const o=D({simpleTableStore:e.props.simpleTableStore,rowIndex:0,columnIndex:0});o&&(t=(0,h.mK)(o))}else t=D({simpleTableStore:e.props.simpleTableStore,rowIndex:e.props.rowIndex-1,columnIndex:e.props.columnIndex});return t}function V(e){let t;const o=k(e.props.simpleTableStore);if(e.props.rowIndex===o-1){const n=w(e.props.simpleTableStore),r=D({simpleTableStore:e.props.simpleTableStore,rowIndex:o-1,columnIndex:n-1});r&&(t=(0,h.hn)(r))}else t=D({simpleTableStore:e.props.simpleTableStore,rowIndex:e.props.rowIndex+1,columnIndex:e.props.columnIndex});return t}},41662:(e,t,o)=>{o.d(t,{Wv:()=>it,fZ:()=>Ze,HM:()=>r,g$:()=>n});var n=o(27534),r=o(98794),i=o(45697),a=o.n(i),s=o(67294),l=o(83355),c=o(1302),d=o(12137),p=o(52989),u=o(61045),m=o(2834),g=o(23864),h=o(68709),f=o(53336),y=o(79954),v=o(43250),b=o(78316),S=o(12534),_=o(38755),w=o(24646),k=o(34859),x=o(77794);var I=o(49085);class C extends I.default{getInitialState(){return{}}setTemporaryFormat(e){this.update((t=>({...t,temporaryFormat:e})))}updateColumnOrder(e){this.update((t=>({...t,temporaryFormat:{...t.temporaryFormat,table_block_column_order:e}})))}}const T=C;var M=o(64359),P=o(5676),A=o(63208),D=o(13991),B=o(480),R=o(86628),E=o(24405),F=o(8848),N=o(55631),j=o(42853),O=o(77734),L=o(73599),U=o(82990),Z=o(51454),V=o(5366),q=o(39699),z=o(13966),W=o(23063),H=o(64921),G=o(52275),K=o(31945),$=o(78140),Y=o(32163),Q=o(72495),J=o(24006),X=o(26388),ee=o(87279),te=o(95802),oe=o(22294),ne=o(27724),re=o(29574),ie=o(85893);function ae(e){var t;window.__c={n:"ActionBarContent"};const{simpleTableStore:o,rootSizeObserver:n,offset:i,hoverSizeObserver:a}=e,s=(0,B.O7)(),l=(0,E.Fg)(),c=(0,R.VK)((()=>te.C.findScrollToSelectableFromStore(o)),[o]),d=null==c||null===(t=c.getNode())||void 0===t?void 0:t.getBoundingClientRect(),p=(0,R.VK)((()=>n.rect.state.width),[n]),u=(0,R.VK)((()=>a.rect.state.width),[a]),m=(0,R.VK)((()=>Math.min((null==d?void 0:d.width)||0,p,u)+i),[d,p,u,i]);return d?(0,ie.jsx)("div",{style:{width:0,position:"absolute",left:m,zIndex:Z.t8},onMouseDown:S.$0,children:(0,ie.jsx)("div",{style:{position:"relative"},children:(0,ie.jsxs)("div",{style:le(l),children:[(0,ie.jsx)(X.Z,{placement:X.Z.Placement.Top,render:e=>(0,ie.jsx)(H.Z,{...e,style:ce(l),onClick:()=>{q.createAndCommit({userAction:"SimpleTableActionBar.ActionBarContent",environment:s,perform:e=>{r.fitToPage({simpleTableStore:o,parentWidth:a.rect.state.width,transaction:e})}})},children:(0,N.n)({width:20,fill:l.regularIconColor})}),renderTooltip:()=>(0,ie.jsx)(V.FormattedMessage,{defaultMessage:"Fit table to page width",id:"simpleTable.actionBar.fitToPage"})}),(0,ie.jsx)(K.ZP,{popupType:K.Z4.Popup,originGap:4,renderOrigin:e=>(0,ie.jsxs)(H.Z,{style:ce(l),...e,children:[(0,ie.jsx)(V.FormattedMessage,{id:"simpleTable.actionBar.options",defaultMessage:"Options"}),(0,j.i)({width:10,fill:l.mediumIconColor,marginLeft:4})]}),render:()=>(0,ie.jsx)(se,{simpleTableStore:o})}),(0,ie.jsx)(z.Z,{store:o,fadeIn:!1,style:{display:"flex",justifyContent:"center",alignSelf:"center",width:30,height:void 0,padding:"9px 8px"},iconStyle:{fill:l.regularTextColor}})]})})}):null}function se(e){window.__c={n:"OptionsMenu"};const{simpleTableStore:t}=e,o=(0,B.O7)(),i=(0,E.Fg)(),a=[{key:"header column",action:()=>{q.createAndCommit({userAction:"SimpleTableActionBar.menuItems",environment:o,perform:e=>{r.toggleHeaderColumn({simpleTableStore:t,transaction:e})}})},render:e=>(0,ie.jsx)(G.Z,{...e,icon:(0,O.s)({width:16,fill:i.regularIconColor}),title:(0,ie.jsx)(V.FormattedMessage,{id:"SimpleTableActionBar.action.rowHeader.title",defaultMessage:"Header column"}),right:(0,ie.jsx)(J.Z,{on:n.getHeadersEnabled(t).headerColumn||!1,onClick:e.onClick})})},{key:"header row",action:()=>{q.createAndCommit({userAction:"SimpleTableActionBar.menuItems",environment:o,perform:e=>{r.toggleHeaderRow({simpleTableStore:t,transaction:e})}})},render:e=>(0,ie.jsx)(G.Z,{...e,icon:(0,L.f)({width:16,fill:i.regularIconColor}),title:(0,ie.jsx)(V.FormattedMessage,{id:"action.columnHeader.title",defaultMessage:"Header row"}),right:(0,ie.jsx)(J.Z,{on:n.getHeadersEnabled(t).headerRow||!1,onClick:e.onClick})})}];return(0,ie.jsx)($.Z,{menuType:ee.og.Popup,width:240,maxHeight:o.device.isMobile?70:void 0,children:(0,ie.jsx)(Y.Z,{type:Y.i.Vertical,sections:[{key:"appearance section",render:e=>(0,ie.jsx)(Q.Z,{...e}),items:a}],initialFocus:void 0})})}function le(e){return{position:"absolute",top:-40,right:0,borderRadius:4,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:U.Z.getCompositeFontFamily(D.SP).sans,background:e.popoverBackground,boxShadow:e.mediumBoxShadow}}function ce(e){return{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${F.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${e.regularDividerColor}`}}const de=function(e){window.__c={n:"SimpleTableActionBar"};const{disabled:t,canEdit:o,simpleTableStore:n}=e,r=(0,R.VK)((()=>{const e=A.Z.state,t=M.Z.state,o=re.Z.state,r=oe.Z.state,i=ne.default.state,a=e.isActive&&e.simpleTableStore===n,s=1===i.stores.length&&i.stores[0]===n,l=t.isActive&&t.simpleTableStore===n&&"cell"===t.hover.type&&t.hover.resizing,c=o.isActive&&o.simpleTableStore===n;return(a||s)&&!l&&!c&&!r.isKeyboardMode}),[n]);return t||!o?null:(0,ie.jsx)(W.Z,{isVisible:r,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:y.Z.opacitySpringConfig},render:()=>(0,ie.jsx)(ae,{...e})})};var pe=o(78429),ue=o(14871),me=o(80402),ge=o(97444),he=o(98104),fe=o(65187),ye=o(68056),ve=o(77907),be=o(24666),Se=o(84139),_e=o(6695),we=o(72126),ke=o(6685),xe=o(89224);class Ie extends l.Z{constructor(){super(...arguments),this.simpleTableFormat=void 0,this.handleDragStart=e=>{const{simpleTableStore:t,columnID:o,getWidth:i}=this.props;e.preventDefault();const a=n.getColumnFormat(t);this.simpleTableFormat=a&&o in a?a[o]:{},this.simpleTableFormat.width=i(),r.setResizing(!0)},this.handleDragMove=e=>{const t=this.getNewFormat(e);t&&this.props.onTemporaryResize(t)},this.handleDragEnd=e=>{const t=this.getNewFormat(e);t&&this.props.onAccept(t),r.setResizing(!1)},this.handleDragCancel=()=>{this.props.onCancel(),this.simpleTableFormat=void 0,r.setResizing(!1)},this.handleDoubleClick=()=>{const e=Se.Z.findCellsInColumnFromStore(this.props.simpleTableStore,this.props.columnId),t=we.oA(e.map((e=>{var t;const o=null===(t=e.node)||void 0===t?void 0:t.querySelector(`.${v.Iiy}`);if(o)return function(e){const t=window.getComputedStyle(e),o=e.cloneNode(!0),n=o;n.id="notion-table-cell-shadow",Array.from(t).forEach((e=>n.style.setProperty(e,t.getPropertyValue(e),t.getPropertyPriority(e)))),n.style.opacity="0",n.style.width="100%",n.style.pointerEvents="none",document.body.appendChild(o);const r=n.querySelector(`.${v.qnV}`);if(!r)return void n.remove();r.style.width="",r.style.display="inline-block";const i=window.document.createRange();i.selectNode(r);const a=xe.getRect(i);return n.remove(),null!=a&&a.width?a.width+je:void 0}(o)})));q.createAndCommit({userAction:"SimpleTableColumnResizer.handleDoubleClick",environment:this.environment,perform:e=>{r.resizeColumn({tableBlockColumnFormat:{...this.getCurrentFormat().table_block_column_format,[this.props.columnId]:{width:Math.max(...t)}},simpleTableStore:this.props.simpleTableStore,transaction:e})}})},this.showResizeBar=this.createComputedStore((()=>{const{columnIndex:e,simpleTableStore:t}=this.props,o=M.Z.state;return!!o.isActive&&(o.simpleTableStore===t&&("cell"===o.hover.type&&(!this.isTableResizing.state&&(o.hover.x===e&&(o.hover.showResizer||o.hover.resizing)))))}),!0),this.isTableResizing=this.createComputedStore((()=>Boolean(n.getTableResizeState(this.props.simpleTableStore))),!0)}renderComponent(){return(0,ie.jsx)("div",{style:{position:"absolute",right:0,width:0,top:0,flexGrow:0,height:"100%",zIndex:1},onMouseMove:()=>r.showResizeBar(!0),onMouseLeave:()=>r.showResizeBar(!1),children:(0,ie.jsx)(ke.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>(0,ie.jsx)("div",{style:this.getInnerStyle(),onDoubleClick:this.handleDoubleClick,...e})})})}getCurrentFormat(){const{format:e,formatStore:t}=this.props,{temporaryFormat:o}=t.state;return o||e}getNewFormat(e){if(this.simpleTableFormat&&this.simpleTableFormat.width){const t=Math.max(this.simpleTableFormat.width+e.diffX,_e.lw);return{...this.simpleTableFormat,width:t}}}getInnerStyle(){return{position:"absolute",width:3,marginLeft:-1,marginTop:-1,height:"calc(100% + 2px)",transition:"background 150ms ease 50ms",cursor:this.isTableResizing.state?void 0:"col-resize",background:this.showResizeBar.state?this.theme.simpleTableSelectionBorder:F.ZP.blueWithAlpha(0)}}}Ie.displayName="SimpleTableColumnResizer";const Ce=Ie;const Te=function(e){window.__c={n:"SimpleTableReorderDropZone"};const{rowIndex:t,columnIndex:o,simpleTableStore:n}=e,r=(0,R.VK)((()=>{const e=P.Z.state;if(e.isActive&&e.simpleTableStore===n&&e.moved&&e.source.index!==e.destIndex)return{destIndex:e.destIndex,sourceIndex:e.source.index,type:e.source.type}}),[n],{useDeepEqual:!0}),{destIndex:i,sourceIndex:a,type:s}=r||{destIndex:0,sourceIndex:0},l=(0,E.yK)((e=>({sharedStyle:{position:"absolute",flexGrow:0,zIndex:2,background:e.simpleTableSelectionBorder},rowStyle:{top:a>i?0:void 0,bottom:a<i?0:void 0,left:-1,width:"calc(100% + 2px)",height:3},columnStyle:{top:-1,left:a>i?0:void 0,right:a<i?0:void 0,width:3,height:"calc(100% + 2px)"}})),[a,i]);return r?"row"===s&&i===t?(0,ie.jsx)("div",{style:{...l.sharedStyle,...l.rowStyle}}):"column"===s&&i===o?(0,ie.jsx)("div",{style:{...l.sharedStyle,...l.columnStyle}}):null:null};var Me=o(12217),Pe=o(97880),Ae=o(6404),De=o(8949),Be=o(35431);class Re extends Be.Z{findSelectorsOfTypeFromStore(e,t){return this.filter((o=>o.props.simpleTableStore===t&&o.props.type===e))}}const Ee=new Re;class Fe extends l.Z{constructor(){super(...arguments),this.dragPosition=void 0,this.node=void 0,this.handleDragStart=e=>{var t;const{type:o}=this.props;e.preventDefault();const n=null===(t=this.node)||void 0===t?void 0:t.parentNode;if(!(n&&n instanceof Element))return;const i=n.getBoundingClientRect();this.dragPosition="column"===o?i.x:i.y;const a="column"===o?e.startX-i.x:e.startY-i.y;r.startReorder({...this.props,environment:this.environment,theme:this.theme,selectorStartPx:this.dragPosition,mouseOffsetPx:a})},this.handleDragMove=e=>{const{type:t}=this.props;if(!this.dragPosition)return;const o=P.Z.state;if(!o.isActive)return;const n="column"===t?e.diffX:e.diffY;if(0!==n){const e=this.dragPosition+n,t=this.getDestIndex({delta:n,selectorDragPx:e+o.source.mouseOffsetPx});r.continueReorder({destIndex:t,selectorDragPx:e})}},this.handleDragEnd=e=>{const{isMobile:t}=this.environment.device,{simpleTableStore:o,type:n,format:i}=this.props;q.createAndCommit({userAction:"SimpleTableRowColumnSelector.handleDragEnd",environment:this.environment,perform:a=>{r.completeReorder({event:e,environment:this.environment,simpleTableStore:o,transaction:a,format:i,type:n,onNoChange:t?void 0:this.handleDragNoChange})}}),this.clearDragState()},this.handleDragCancel=()=>{this.clearDragState()},this.clearDragState=()=>{this.dragPosition=void 0,r.cancelReorder()},this.handleDragNoChange=e=>{Ae.Qn({environment:this.environment,stores:[this.props.simpleTableStore],left:e.startX,top:e.startY,showInput:!0,actionSectionGroupKey:"simple_table",analyticsFrom:"simple_table_menu"})},this.onSelectorClick=e=>{const{type:t,index:o,simpleTableStore:n}=this.props,{isMobile:i}=this.environment.device;De.Z.state.isActive||Ae.Qn({environment:this.environment,stores:[this.props.simpleTableStore],left:e.clientX,top:e.clientY,showInput:!0,actionSectionGroupKey:"simple_table",analyticsFrom:"simple_table_menu"}),i&&("column"===t?r.selectColumn({environment:this.environment,index:o,simpleTableStore:n}):r.selectRow({environment:this.environment,index:o,simpleTableStore:n}))},this.handleMouseEnter=()=>{const{simpleTableStore:e,type:t,index:o}=this.props;r.hoverRowColumn({type:t,simpleTableStore:e,index:o})},this.handleMouseLeave=()=>{r.clearHover()},this.shouldShow=this.createComputedStore((()=>{const{isMobile:e}=this.environment.device;if(e)return this.shouldShowMobile();const{isKeyboardMode:t}=oe.Z.state;if(t)return!1;const{simpleTableStore:o,type:r,index:i}=this.props;if(P.Z.state.isActive)return!1;const a=M.Z.state;if(!a.isActive)return!1;if(a.simpleTableStore!==o)return!1;if(n.getTableResizeState(o))return!1;const s=ne.default.state;if(s.stores[0]===o&&s.phase===ne.SelectionPhase.Selected)return!1;const l=a.hover;return"cell"!==l.type?l.type===r&&l.index===i:"column"===r?l.x===i:"row"===r&&l.y===i}),!0),this.isDragging=this.createComputedStore((()=>P.Z.state.isActive),!0)}get registries(){return[Ee]}didMountOrUpdate(){this.node=this.getNode()}renderComponent(){const{isSelected:e}=this.props,t=e||this.shouldShow.state;return(0,ie.jsx)(ke.Z,{allowDragWhileTextEditing:!0,onDraggableDragStart:t?this.handleDragStart:void 0,onDraggableDragMove:t?this.handleDragMove:void 0,onDraggableDragEnd:t?this.handleDragEnd:void 0,onDraggableDragCancel:t?this.handleDragCancel:void 0,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>this.renderButton(e)})}renderButton(e){const{type:t,isSelected:o}=this.props;return(0,ie.jsx)(H.Z,{className:"column"===t?v.Apy:v.f0e,style:this.getStyle(),hoveredStyle:o?this.getSelectedStyle():{background:this.theme.whiteButtonHoveredBackground},pressedStyle:this.getSelectedStyle(!0),onClick:this.onSelectorClick,onTouchStart:this.handleMouseEnter,onTouchEnd:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,...e,disallowTabbing:!0,children:(0,Me.D)({fill:o?F.ZP.white:void 0,width:14,height:14,transform:"column"===t?"rotate(90deg)":void 0})})}shouldShowMobile(){const e=A.Z.state;if(!e.isActive)return!1;const{simpleTableStore:t,type:o,index:r}=this.props;if(e.simpleTableStore!==t)return!1;const{selection:i}=e;if(n.isSingleCellSelected(i)){if("column"===o)return i.start.col===r;if("row"===o)return i.start.row===r}return!1}getDestIndex(e){const{delta:t,selectorDragPx:o}=e,{simpleTableStore:n,type:r}=this.props,i=Ee.findSelectorsOfTypeFromStore(r,n);if(t>0){const e=i.map((e=>{var t;const o=null===(t=e.node)||void 0===t?void 0:t.parentNode;if(!(o&&o instanceof Element))return;const n=o.getBoundingClientRect();return"column"===r?null==n?void 0:n.x:null==n?void 0:n.y})).filter(Pe.$K);e.sort(((e,t)=>e-t));for(let t=e.length-1;t>=0;t--)if(o>e[t])return t;return 0}const a=i.map((e=>{var t;const o=null===(t=e.node)||void 0===t?void 0:t.parentNode;if(!(o&&o instanceof Element))return;const n=o.getBoundingClientRect();return"column"===r?n.x+n.width:n.y+n.height})).filter(Pe.$K);return a.sort(((e,t)=>e-t)),a.filter(Pe.$K).findIndex((e=>o<e))}getStyle(){const{type:e,isSelected:t}=this.props,o=t||this.shouldShow.state,n={opacity:o?1:0,pointerEvents:o?void 0:"none",transition:"opacity 150ms ease",fill:this.theme.lightIconColor,position:"absolute",display:"flex",alignItems:"center",cursor:this.isDragging.state?"grab":"pointer",justifyContent:"center",borderRadius:4,background:this.theme.whiteButtonBackground,boxShadow:t?void 0:this.theme.lightBoxShadow,zIndex:4};return"column"===e?{...n,...this.getSelectedStyle(),top:-8,left:"calc(50% - 13px)",height:16,width:26,padding:"2px 4px"}:{...n,...this.getSelectedStyle(),top:"calc(50% - 13px)",left:-8,width:16,height:26,padding:"4px 2px"}}getSelectedStyle(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{isSelected:t}=this.props;return t||e?{background:this.theme.simpleTableSelectionBorder}:void 0}}Fe.displayName="SimpleTableRowColumnSelector";const Ne=Fe,je=1;class Oe extends l.Z{constructor(){super(...arguments),this.node=void 0,this.editor=null,this.handleCellClick=e=>{const{columnIndex:t,simpleTableStore:o,rowIndex:n,disabled:i,canEdit:a}=this.props;i||(0,S.ZP)({event:e,context:S.Af.EditorClick,callback:()=>{a&&e.shiftKey?r.expandCellSelection({environment:this.environment,rowIndex:n,columnIndex:t,simpleTableStore:o}):a?r.selectCellAndSetCursor({environment:this.environment,rowIndex:n,columnIndex:t,simpleTableStore:o}):r.selectCell({environment:this.environment,rowIndex:n,columnIndex:t,simpleTableStore:o})}})},this.handleContextMenuClick=e=>{const{columnIndex:t,simpleTableStore:o,rowIndex:n,disabled:i}=this.props;i||(0,S.ZP)({event:e,context:S.Af.EditorContextMenu,callback:()=>{r.selectCell({environment:this.environment,rowIndex:n,columnIndex:t,simpleTableStore:o})}})},this.handleTextClick=e=>{const{rowIndex:t,columnIndex:o,simpleTableStore:n,disabled:i,canEdit:a}=this.props;i||a&&e.shiftKey&&r.expandCellSelection({environment:this.environment,rowIndex:t,columnIndex:o,simpleTableStore:n})},this.handleMouseEnter=()=>{const{rowIndex:e,columnIndex:t,simpleTableStore:o,disabled:n}=this.props;n||r.hoverCell({x:t,y:e,simpleTableStore:o})},this.handleMouseLeave=()=>{this.props.disabled||r.clearHover()},this.handleTemporaryColumnResize=e=>{const{formatStore:t}=this.props;t.setTemporaryFormat(this.getNewFormat(e))},this.handleColumnResizeAccept=e=>{const{simpleTableStore:t,formatStore:o}=this.props,n=this.getCurrentFormat().table_block_column_format;q.createAndCommit({userAction:"SimpleTableCell.handleColumnResizeAccept",environment:this.environment,perform:e=>{r.resizeColumn({tableBlockColumnFormat:n||{},simpleTableStore:t,transaction:e})}}),o.setTemporaryFormat(void 0)},this.handleTemporaryColumnResizeCancel=()=>{const{formatStore:e}=this.props;e.setTemporaryFormat(void 0)},this.handleEnter=e=>{if(e.preventDefault(),this.editor&&this.editor.isComposing())return;"editing"===be.default.state.mode&&r.handleUpDownKey({environment:this.environment,direction:"down",bypassExistingTextSelection:!0})},this.handleTab=e=>{e.preventDefault(),r.handleLeftRightKey({environment:this.environment,direction:"right",bypassExistingTextSelection:!0})},this.handleUntab=e=>{e.preventDefault(),r.handleLeftRightKey({environment:this.environment,direction:"left",bypassExistingTextSelection:!0})},this.handleEsc=e=>{this.props.disabled||(e.preventDefault(),he.ZH(this.environment))},this.handleCut=e=>{const{disabled:t,canEdit:o}=this.props;if(t||!o)return;this.handleCopy(e);const n="editing"===be.default.state.mode&&be.default.state.multiSelection,i=this.environment;n&&!(0,ye.iG)(n)?q.createAndCommit({userAction:"SimpleTableCell.handleCut",environment:i,perform:e=>{ge.pz({environment:i,multiSelection:n,transaction:e})}}):q.createAndCommit({userAction:"SimpleTableCell.handleCut",environment:i,perform:e=>{r.clearSelectedCell({environment:i,transaction:e})}})},this.handleCopy=e=>{const{markdownLinkifyIt:t,exportJsxRenderer:o}=this.props,r=A.Z.state;if(!r.isActive)return;const{selection:i,simpleTableStore:a}=r,s=n.getColumnOrder(a);if(!s)return;ue.JG({environment:this.environment,event:e,markdownLinkifyIt:t});const l="editing"===be.default.state.mode&&be.default.state.multiSelection;l&&!(0,ye.iG)(l)||me.qn({environment:this.environment,simpleTableStore:a,selection:i,currentRows:a.getContentStores(),columnOrder:s,event:e,exportJsxRenderer:o})},this.isInDragSource=this.createComputedStore((()=>{const{store:e,columnID:t,simpleTableStore:o}=this.props;if(!e)return!1;const n=P.Z.state;if(!n.isActive||n.simpleTableStore!==o||!n.moved)return!1;const{type:r,id:i}=n.source;return"column"===r?i===t:i===e.id}),!0)}get registries(){return[Se.Z]}didMountOrUpdate(){this.node=this.getNode()}renderComponent(){const{columnID:e,columnIndex:t,simpleTableStore:o,rowIndex:n,textStore:r,store:i,format:a,disabled:s,canEdit:l,legacyTransclusionParent:c}=this.props,{device:d}=this.environment,p=!s&&l,u=(0,ie.jsxs)(ie.Fragment,{children:[this.isInDragSource.state&&(0,ie.jsx)("div",{style:{width:"100%",height:"100%",...this.getColorStyle()}}),(0,ie.jsxs)("div",{className:v.Iiy,style:{visibility:this.isInDragSource.state?"hidden":void 0},children:[i&&0===n&&p&&(0,ie.jsx)(Ne,{index:t,type:"column",simpleTableStore:o,isSelected:this.isColumnSelected(),id:e,format:a,rowStore:i}),i&&0===t&&p&&(0,ie.jsx)(Ne,{index:n,type:"row",simpleTableStore:o,isSelected:this.isRowSelected(),id:i.id,format:a,rowStore:i}),r?(0,ie.jsx)(fe.Z,{ref:e=>{this.editor=e},disabled:s,store:r,disableSlashCommands:!0,onClick:this.handleTextClick,onEnter:this.handleEnter,onTab:this.handleTab,onUntab:this.handleUntab,onEsc:this.handleEsc,onCut:this.handleCut,onCopy:this.handleCopy,style:{padding:"7px 9px",backgroundColor:"transparent",fontSize:14,lineHeight:"20px"},pasteBehavior:"inline",className:v.qnV,disableDrag:!0,legacyTransclusionParent:c}):(0,ie.jsx)("div",{style:{padding:"7px 9px",backgroundColor:"transparent",fontSize:14,lineHeight:"20px"},children:"Â "}),!d.isMobile&&p&&(0,ie.jsx)(Ce,{format:this.props.format,formatStore:this.props.formatStore,columnId:this.getColumnID(),columnIndex:t,columnID:e,simpleTableStore:o,getWidth:()=>{var e;return(null===(e=this.node)||void 0===e?void 0:e.getBoundingClientRect().width)||0},onTemporaryResize:this.handleTemporaryColumnResize,onAccept:this.handleColumnResizeAccept,onCancel:this.handleTemporaryColumnResizeCancel}),!d.isMobile&&p&&(0,ie.jsx)(Te,{simpleTableStore:o,rowIndex:n,columnIndex:t})]})]}),m={style:this.getStyle(),onClick:this.handleCellClick,onContextMenu:this.handleContextMenuClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},{headerColumn:g,headerRow:h}=this.getHeadersEnabled();return h&&0===n?(0,ie.jsx)("th",{scope:"col",...m,children:u}):g&&0===t?(0,ie.jsx)("th",{scope:"row",...m,children:u}):(0,ie.jsx)("td",{...m,children:u})}getColumnID(){return this.props.columnID}isColumnSelected(){const{columnIndex:e,simpleTableStore:t,selection:o}=this.props;return!!o&&n.isColumnSelected({selection:o,columnIndex:e,simpleTableStore:t})}isRowSelected(){const{rowIndex:e,simpleTableStore:t,selection:o}=this.props;return!!o&&n.isRowSelected({selection:o,rowIndex:e,simpleTableStore:t})}getCurrentFormat(){const{format:e}=this.props,{temporaryFormat:t}=this.props.formatStore.state;return t||e}getNewFormat(e){const{columnID:t}=this.props,o={[t]:e},n=this.getCurrentFormat();return{...n,table_block_column_format:{...n.table_block_column_format,...o}}}getHeadersEnabled(){const{simpleTableStore:e}=this.props;return n.getHeadersEnabled(e)}getColorStyle(){var e;const{simpleTableStore:t,rowIndex:o,columnIndex:r,columnID:i}=this.props,{headerColumn:a,headerRow:s}=this.getHeadersEnabled();let l=(null===(e=this.props.store)||void 0===e?void 0:e.getFormat().block_color)||"default";const c=n.getColumnFormat(t);if(c&&i in c){var d;const e=null===(d=c[i])||void 0===d?void 0:d.color;e&&(l=e)}return 0===o&&s||0===r&&a?"default"!==l?{...(0,F.fi)(l,this.theme),fontWeight:U.Z.fontWeight.medium}:{background:this.theme.tableHeaderRowColumnBackground,fontWeight:U.Z.fontWeight.medium}:(0,F.fi)(l,this.theme)}getStyle(){return{...this.getColorStyle(),border:`${je}px solid ${this.theme.tableDividerColor}`,position:"relative",verticalAlign:"top",textAlign:"start",...this.getWidths(),minHeight:32}}getWidths(){var e;const{columnID:t}=this.props,o=this.getCurrentFormat().table_block_column_format;return o&&null!==(e=o[t])&&void 0!==e&&e.width?{minWidth:o[t].width,maxWidth:o[t].width}:{minWidth:120,maxWidth:240}}}function Le(e){window.__c={n:"SimpleTableCellWithDeps"};const{value:t}=(0,ve.useDependency)(ve.deps.exportJsxRenderer),{value:o}=(0,ve.useDependency)(ve.deps.markdownLinkifyIt),{value:n}=(0,ve.useDependency)(ve.deps.tinyMceMicrosoftWordPasteFilter);return(0,ie.jsx)(Oe,{...e,exportJsxRenderer:t,markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n})}Oe.displayName="SimpleTableCell";class Ue extends m.Z{constructor(){super(...arguments),this.isLegacyTransclusionStore=this.createComputedStore((()=>Boolean(this.props.rowStore)&&this.props.rowStore.getParentId()!==this.props.store.id)),this.styleStore=this.createComputedStore((()=>(0,pe.H)()&&this.isLegacyTransclusionStore.state?{border:"3px dashed deeppink"}:{}))}renderPersisted(){const{columnOrder:e,store:t,rowIndex:o,rowStore:n,selection:r,formatStore:i,disabled:a}=this.props;return e?(0,ie.jsx)("tr",{className:v.M_0,style:this.styleStore.state,children:e.map(((e,s)=>(0,ie.jsx)(Le,{disabled:a,canEdit:this.canEdit(),columnID:e,columnIndex:s,rowIndex:o,store:n,simpleTableStore:t,selection:r,formatStore:i,format:t.getFormat(),textStore:null==n?void 0:n.getPropertyStore(e),legacyTransclusionParent:this.isLegacyTransclusionStore.state?this.props.store:void 0},e)))}):null}}const Ze=Ue;var Ve=o(8958),qe=o(40150),ze=o(55367),We=o(24677),He=o(3386),Ge=o(52689);function Ke(e){window.__c={n:"SimpleTableKeyboardArea"};const{store:t,children:o,selection:i,disabled:a,canEdit:l}=e,c=(0,B.O7)(),d=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),r.handleLeftRightKey({environment:c,direction:"left",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),p=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),r.handleLeftRightKey({environment:c,direction:"right",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),u=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),r.handleUpDownKey({environment:c,direction:"up",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),m=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),r.handleUpDownKey({environment:c,direction:"down",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),g=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault();const t=A.Z.state;if(t.isActive){const{selection:e,simpleTableStore:o}=t;n.isSingleCellSelected(e)&&r.selectCellAndSetCursor({environment:c,rowIndex:e.start.row,columnIndex:e.start.col,simpleTableStore:o})}}),[c]),h=(0,s.useCallback)((e=>{var t;null===(t=e.preventDefault)||void 0===t||t.call(e);const o=A.Z.state;if(!o.isActive)return;const{selection:i,simpleTableStore:a}=o;n.isSingleCellSelected(i)&&i.end.row===n.getNumberOfRows(a)-1&&q.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleShiftEnter",environment:c,perform:e=>{const t=i.end.row+1;r.insertRow({environment:c,transaction:e,index:t,simpleTableStore:a}),r.selectCellAndSetCursor({environment:c,rowIndex:t,columnIndex:i.start.col,simpleTableStore:a})}})}),[c]),f=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault();const o=A.Z.state;if(!o.isActive)return;const{selection:i,simpleTableStore:a}=o;n.getSimpleTableCellFromTextSelection()?he.ZH(c):n.isSingleCellSelected(i)?r.selectRow({environment:c,index:i.start.row,simpleTableStore:a}):(r.clearSelection(),We.Z5({environment:c,stores:[t]}))}),[c,t]),y=(0,s.useCallback)((e=>{q.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleDelete",environment:c,perform:e=>{r.handleDelete({environment:c,transaction:e})}})}),[c]),v=(0,s.useCallback)((e=>{!e.key||e.metaKey||e.ctrlKey||(oe.Z.setKeyboardMode(!0),q.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleKeypress",environment:c,perform:t=>{r.handleKeypress({environment:c,transaction:t,key:e.key})}}))}),[c]),{value:b}=(0,ve.useDependency)(ve.deps.exportJsxRenderer),S=(0,s.useCallback)((e=>{const t=A.Z.state;if(!t.isActive)return;const{selection:o,simpleTableStore:r}=t,i=n.getColumnOrder(r);i&&me.qn({environment:c,simpleTableStore:r,selection:o,currentRows:r.getContentStores(),columnOrder:i,event:e,exportJsxRenderer:b})}),[c,b]),_=(0,s.useCallback)((e=>{!a&&l&&(S(e),q.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleCut",environment:c,perform:e=>{r.clearSelectionContents({environment:c,transaction:e})}}))}),[c,a,l,S]),{value:w}=(0,ve.useDependency)(ve.deps.markdownLinkifyIt),{value:k}=(0,ve.useDependency)(ve.deps.tinyMceMicrosoftWordPasteFilter),x=(0,s.useCallback)((e=>{if(a||!l)return;const t=A.Z.state;if(!t.isActive)return;const{selection:o,simpleTableStore:r}=t,i=n.getColumnOrder(r);i&&q.createAndCommit({userAction:"SimpleTableSelectionOverlay.handlePaste",environment:c,perform:t=>{me.j0({environment:c,simpleTableStore:r,selection:o,currentRows:r.getContentStores(),columnOrder:i,event:e,transaction:t,markdownLinkifyIt:w,tinyMceMicrosoftWordPasteFilter:k})}})}),[c,a,l,w,k]),I=(0,s.useCallback)((e=>{e.preventDefault(),q.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleDuplicate",environment:c,perform:e=>{r.handleDuplicate({environment:c,transaction:e})}})}),[c]),C=(0,s.useCallback)(((e,o)=>{!a&&l&&(o.preventDefault(),q.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleAnnotation",environment:c,perform:o=>{r.annotateSimpleTableSelection({environment:c,simpleTableStore:t,annotation:e,transaction:o})}}))}),[c,a,l,t]),T=(0,s.useCallback)((e=>C(["h",Ge.Z.state.color],e)),[C]),M=(0,s.useCallback)((e=>C(["b"],e)),[C]),P=(0,s.useCallback)((e=>C(["i"],e)),[C]),D=(0,s.useCallback)((e=>C(["s"],e)),[C]),R=(0,s.useCallback)((e=>C(["_"],e)),[C]),E=(0,s.useCallback)((e=>C(["c"],e)),[C]);return(0,ie.jsx)(He.Z,{capture:Boolean(i)&&!a&&l,onLeft:d,onRight:p,onUntab:d,onTab:p,onUp:u,onDown:m,onEnter:g,onShiftEnter:h,onEsc:f,onDelete:y,onBackspace:y,onKeypress:v,onCut:_,onCopy:S,onPaste:x,onDuplicate:I,onToggleHighlight:T,onToggleBold:M,onToggleItalics:P,onToggleStrike:D,onToggleUnderline:R,onToggleCode:E,children:o})}var $e=o(6740),Ye=o(47453),Qe=o(71644);const Je=(0,V.defineMessages)({tooltipContent:{id:"simpleTable.resizer.dimensions",defaultMessage:"{num_columns} Ã— {num_rows}"}});class Xe extends l.Z{constructor(){super(...arguments),this.tooltipOrigin=s.createRef(),this.storeTypes={focusStore:I.default.createClass(!1)},this.renderTooltip=()=>{const{store:e,intl:t,type:o}=this.props;if(!this.isResizing.state){const e=this.theme.regularInvertedTextColor,t=t=>(0,ie.jsx)("b",{style:{color:e},children:t});return(0,ie.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",color:this.theme.mediumInvertedTextColor},children:[(0,ie.jsxs)("div",{children:["row"===o&&(0,ie.jsx)(V.FormattedMessage,{id:"simpleTable.resizer.tooltipRow",defaultMessage:"<b>Click</b> to add a new row",values:{b:t}}),"column"===o&&(0,ie.jsx)(V.FormattedMessage,{id:"simpleTable.resizer.tooltipColumn",defaultMessage:"<b>Click</b> to add a new column",values:{b:t}}),"corner"===o&&(0,ie.jsx)(V.FormattedMessage,{id:"simpleTable.resizer.tooltipCorner",defaultMessage:"<b>Click</b> to add a new row and column",values:{b:t}})]}),(0,ie.jsxs)("div",{children:["row"===o&&(0,ie.jsx)(V.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleRow",defaultMessage:"<b>Drag</b> to quickly add or remove rows",values:{b:t}}),"column"===o&&(0,ie.jsx)(V.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleColumn",defaultMessage:"<b>Drag</b> to quickly add or remove columns",values:{b:t}}),"corner"===o&&(0,ie.jsx)(V.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleCorner",defaultMessage:"<b>Drag</b> to quickly add or remove rows and columns",values:{b:t}})]})]})}const r=this.columnOrder.state||[],i=n.getNumberOfRows(e),a=this.numTempRows.state,s=t.formatMessage(Je.tooltipContent,{num_columns:r.length,num_rows:i+a});return(0,ie.jsx)("div",{children:s})},this.handleResizeClick=()=>{const{store:e,type:t}=this.props;q.createAndCommit({userAction:"SimpleTableResizer.handleResizeClick",environment:this.environment,perform:o=>{"row"!==t&&r.extendColumns({count:1,simpleTableStore:e,transaction:o}),"column"!==t&&r.extendRows({environment:this.environment,count:1,simpleTableStore:e,transaction:o})}})},this.handleDragStart=e=>{var t;e.preventDefault();const{formatStore:o,store:n,type:r}=this.props,i=null===(t=this.tooltipOrigin.current)||void 0===t?void 0:t.getBoundingClientRect();re.Z.setState({isActive:!0,simpleTableStore:n,resize:r,rowsDelta:0,columnsDelta:0,tooltipOriginRect:i}),o.setTemporaryFormat(n.getFormat())},this.handleDragMove=e=>{var t;const{store:o,type:i,formatStore:a}=this.props,s=n.getTableResizeState(o,i);if(!s)return;const l=null===(t=this.tooltipOrigin.current)||void 0===t?void 0:t.getBoundingClientRect();if("row"!==i){const t=e.diffX>0?Math.ceil((e.diffX-30)/120):Math.floor((e.diffX+30)/120);if(t<0&&n.columnsHaveData({simpleTableStore:o,lastN:Math.abs(t)}))return;re.Z.setState({...s,columnsDelta:t,tooltipOriginRect:l});const i=this.getNewColumnOrder(t);a.updateColumnOrder(i),r.updateRowSelectionOnResize(i.length-1)}if("column"!==i){const t=e.diffY>0?Math.ceil((e.diffY-8)/32):Math.max(-(n.getNumberOfRows(o)-1),Math.floor((e.diffY+8)/32));if(t<0&&n.rowsHaveData({simpleTableStore:o,lastN:Math.abs(t)}))return;re.Z.setState({...s,rowsDelta:t,tooltipOriginRect:l}),r.updateColumnSelectionOnResize(n.getNumberOfRows(o)+t-1)}},this.handleDragEnd=e=>{const{store:t,type:o}=this.props,i=this.columnOrder.state,a=this.numTempRows.state,s=n.getNumberOfColumns(t);q.createAndCommit({userAction:"SimpleTableResizer.handleDragEnd",environment:this.environment,perform:e=>{"row"!==o&&i&&(i.length>s?r.extendColumns({count:i.length-s,simpleTableStore:t,transaction:e}):i.length<s&&r.contractColumns({simpleTableStore:t,columnOrder:i,transaction:e})),"column"!==o&&(a>0?r.extendRows({environment:this.environment,count:a,simpleTableStore:t,transaction:e}):a<0&&r.contractRows({numRowsToDelete:Math.abs(a),simpleTableStore:t,transaction:e}))}}),this.clearResizeState()},this.handleDragCancel=()=>{this.clearResizeState()},this.handleMouseEnter=()=>{const{store:e,type:t}=this.props;r.hoverResizer({simpleTableStore:e,resizer:t})},this.handleMouseLeave=()=>{r.clearHover()},this.handleFocus=e=>{const t=e.target;t instanceof HTMLElement&&(0,$e.E)(t)&&this.stores.focusStore.setState(!0)},this.handleBlur=()=>{this.stores.focusStore.setState(!1)},this.isResizing=this.createComputedStore((()=>{const{store:e,type:t}=this.props;return Boolean(n.getTableResizeState(e,t))}),!0),this.tooltipOriginRect=this.createComputedStore((()=>{const{store:e,type:t}=this.props,o=n.getTableResizeState(e,t);return null==o?void 0:o.tooltipOriginRect}),!0),this.columnOrder=this.createComputedStore((()=>{const{store:e,formatStore:t}=this.props,o=e.getFormat(),{temporaryFormat:n}=t.state;return(n||o).table_block_column_order})),this.numTempRows=this.createComputedStore((()=>{const e=n.getTableResizeState(this.props.store);return e?e.rowsDelta:0})),this.isVisible=this.createComputedStore((()=>{const{type:e,store:t}=this.props,o=M.Z.state,r=n.getTableResizeState(t,e),i=this.stores.focusStore.state;return!oe.Z.state.isKeyboardMode&&(this.isHoverVisible(o)||Boolean(r))||i}),!0)}renderComponent(){return(0,ie.jsx)("div",{style:this.getOuterStyle(),onFocus:this.handleFocus,onBlur:this.handleBlur,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,ref:this.tooltipOrigin,children:(0,ie.jsx)(ke.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>(0,ie.jsx)("div",{style:this.getInnerStyle(),...e,children:(0,ie.jsx)(X.Z,{renderTooltip:this.renderTooltip,placement:X.Z.Placement.Bottom,delayThreshold:0,originRect:this.tooltipOriginRect.state,forceVisibleState:!0===this.isResizing.state||void 0,render:e=>(0,ie.jsx)(H.Z,{onClick:this.handleResizeClick,style:this.getButtonStyle(!0),hoveredStyle:this.getButtonStyle(!0),...e,children:(0,ie.jsx)("div",{style:this.getStyle(),children:(0,Ye.R)({width:12,height:12,fill:this.isResizing.state?F.ZP.white:this.theme.mediumIconColor,padding:"auto"})})})})})})})}clearResizeState(){this.props.formatStore.reset(),re.Z.reset()}getNewColumnOrder(e){const{store:t}=this.props,o=this.columnOrder.state||[],r=n.getColumnOrder(t)||[];if(e>0){const t=e-(o.length-r.length);if(t>0){const e=[...Array(t).keys()].map((e=>(0,Qe.ZP)()));return[...o,...e]}return o.slice(0,o.length+t)}return r.slice(0,Math.max(1,r.length-Math.abs(e)))}isHoverVisible(e){const{type:t,store:o}=this.props;if(!e.isActive||e.simpleTableStore!==o)return!1;const{hover:r}=e;if("cell"===r.type){const e=r.y===n.getNumberOfRows(o)-1,i=r.x===n.getNumberOfColumns(o)-1;return"row"===t?e:("column"===t||e)&&i}return"resizer"===r.type&&r.resizer===t}getOuterStyle(){const{type:e}=this.props,t={position:"absolute",display:"flex"};return"row"===e?{...t,flexDirection:"row",bottom:-18,left:0,right:0}:"column"===e?{...t,right:-18,top:0,bottom:0}:{...t,bottom:-18,right:-18}}getInnerStyle(){const{type:e}=this.props,t=this.isVisible.state;return{display:"flex",flexDirection:"row"===e?"row":void 0,width:"100%",height:"100%",opacity:t?1:0,pointerEvents:t?void 0:"none",transition:"opacity 150ms ease 50ms"}}getButtonStyle(e){const{type:t}=this.props,o=e?16:20,n="100%";return"column"===t?{flex:1,width:o,height:n,cursor:"col-resize",borderRadius:4,overflow:"hidden"}:"row"===t?{flex:1,width:n,height:o,cursor:"row-resize",borderRadius:4,overflow:"hidden"}:{flex:1,width:o,height:o,cursor:"nwse-resize",borderRadius:"50%",overflow:"hidden"}}getStyle(){return{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:this.isResizing.state?this.theme.simpleTableSelectionBorder:this.theme.lightDividerColor}}}Xe.displayName="SimpleTableResizer";const et=(0,V.injectIntl)(Xe);function tt(e){window.__c={n:"SimpleTableSelectionDragHandle"};const{position:t,onDraggableDragStart:o,onDraggableDragMove:n,onDraggableDragEnd:r,onDraggableDragCancel:i}=e,a=(0,B.Fy)().isMobile?26:9,s=(0,E.yK)((e=>({tapArea:{position:"absolute",top:"top-left"===t?-a/2:void 0,left:"top-left"===t?-a/2:void 0,bottom:"bottom-right"===t?-a/2:void 0,right:"bottom-right"===t?-a/2:void 0,width:a,height:a,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",pointerEvents:"auto",cursor:"nwse-resize",zIndex:10},dragHandle:{width:9,height:9,border:`2px solid ${F.ZP.blueWithAlpha(.57)}`,background:e.contentBackground,borderRadius:"50%"}})),[t,a]);return(0,ie.jsx)(ke.Z,{allowDragWhileTextEditing:!0,onDraggableDragStart:o,onDraggableDragMove:n,onDraggableDragEnd:r,onDraggableDragCancel:i,render:e=>(0,ie.jsx)("div",{...e,style:s.tapArea,children:(0,ie.jsx)("div",{style:s.dragHandle})})})}class ot extends l.Z{constructor(){super(...arguments),this.tableElement=null,this.observer=void 0,this.handleObserverChange=()=>{var e,t;null===(e=this.selectionStartRectStore)||void 0===e||e.enqueueRecompute(),null===(t=this.selectionEndRectStore)||void 0===t||t.enqueueRecompute()},this.dragSelectAnchor=void 0,this.handleDragStart=e=>{this.props.canEdit&&(e.shiftKey&&this.props.selection?this.dragSelectAnchor=this.props.selection.start:this.dragSelectAnchor=this.getClosestTableCellPosition(e.startX,e.startY))},this.handleDragMove=e=>{if(!this.props.canEdit||!this.dragSelectAnchor)return;const t=this.dragSelectAnchor,o=this.getClosestTableCellPosition(e.currentX,e.currentY);(0,qe.bp)(t,o)?r.selectCell({environment:this.environment,rowIndex:t.row,columnIndex:t.col,simpleTableStore:this.props.store}):r.selectMultiCell({environment:this.environment,start:t,end:o,simpleTableStore:this.props.store})},this.dragHandleSelectAnchor=void 0,this.handleTopLeftDragHandleDragStart=()=>this.handleDragHandleDragStart("top-left"),this.handleBottomRightDragHandleDragStart=()=>this.handleDragHandleDragStart("bottom-right"),this.handleDragHandleDragMove=e=>{if(!this.dragHandleSelectAnchor)return;const t=this.getClosestTableCellPosition(e.currentX,e.currentY);r.selectMultiCell({environment:this.environment,start:this.dragHandleSelectAnchor,end:t,simpleTableStore:this.props.store})},this.selectionStartRectStore=this.createComputedStore((()=>{const{selection:e}=this.props;if(e)return this.getCellRect(e.start)}),!0),this.selectionEndRectStore=this.createComputedStore((()=>{const{selection:e}=this.props;if(e)return this.getCellRect(e.end)}),!0),this.canShowTableResizers=this.createComputedStore((()=>{const{disabled:e,canEdit:t}=this.props,{device:o}=this.environment;return!(e||!t||o.isMobile)&&!(ze.ZP.state.isDragging||this.isColumnResizing()||this.isReordering())}),!0),this.isColumnResizing=()=>{const{store:e}=this.props,t=M.Z.state;return!!t.isActive&&(t.simpleTableStore===e&&("cell"===t.hover.type&&t.hover.resizing))},this.isReordering=()=>{const{store:e}=this.props,t=P.Z.state;return t.isActive&&t.simpleTableStore===e},this.dragState=this.createComputedStore((()=>{const e=P.Z.state;if(!e.isActive)return;if(e.simpleTableStore!==this.props.store)return;if(!this.tableElement)return;const{source:t,selectorDragPx:o,moved:n}=e;if(t.selectorStartPx===o&&!n)return;if(!t.draggedCells[0])return;const r=t.draggedCells[0].rect,i=this.tableElement.getBoundingClientRect(),a="column"===t.type?0:(0,d.Z)(o-i.top,-8,i.height-32);return{left:"column"===t.type?(0,d.Z)(o-i.left,-r.width/3,i.width-2/3*r.width):0,top:a,draggedCells:t.draggedCells,type:t.type}}),!0)}renderComponent(){const{children:e,store:t,selection:o,formatStore:n,disabled:r,canEdit:i}=this.props,a=this.canShowTableResizers.state;return(0,ie.jsx)(Ke,{store:t,selection:o,disabled:r,canEdit:i,children:(0,ie.jsx)(ke.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,render:r=>(0,ie.jsxs)("div",{style:{position:o||a?"relative":void 0},...r,children:[e,this.shouldRenderOverlay()&&(0,ie.jsxs)("div",{style:{position:"absolute",top:0,left:0,pointerEvents:"none"},children:[this.renderDragOverlay(),this.renderSelectionOverlay()]}),a&&(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(et,{store:t,type:"column",formatStore:n},"column"),(0,ie.jsx)(et,{store:t,type:"row",formatStore:n},"row"),(0,ie.jsx)(et,{store:t,type:"corner",formatStore:n},"corner")]})]})})})}shouldRenderOverlay(){const e=this.selectionStartRectStore.state,t=this.selectionEndRectStore.state,o=this.dragState.state;return!this.props.disabled&&(e&&t||o)}renderSelectionOverlay(){const e=this.selectionStartRectStore.state,t=this.selectionEndRectStore.state;if(!e||!t)return;const o=Math.min(e.left,t.left),n=Math.min(e.top,t.top),r=Math.max(e.right,t.right),i=Math.max(e.top+e.height,t.top+t.height),a=this.dragState.state,s={position:"absolute",left:a&&"column"===a.type?a.left:o+1.5,top:a&&"row"===a.type?a.top:n+1.5,width:r-o-3,height:i-n-3};return(0,ie.jsxs)("div",{className:v.y4j,children:[(0,ie.jsx)("div",{style:{...s,zIndex:a?4:2,backgroundColor:a?this.theme.contentBackground:void 0,opacity:a?.9:void 0,boxShadow:a?this.theme.mediumBoxShadow:void 0,borderRadius:2}}),(0,ie.jsx)("div",{style:{...s,border:`solid ${this.theme.simpleTableSelectionBorder}`,borderWidth:2,borderRadius:2,zIndex:a?5:3},children:this.props.canEdit&&(0,ie.jsxs)(ie.Fragment,{children:[!this.environment.device.isMobile&&(0,ie.jsx)(tt,{position:"top-left",onDraggableDragStart:this.handleTopLeftDragHandleDragStart,onDraggableDragMove:this.handleDragHandleDragMove}),(0,ie.jsx)(tt,{position:"bottom-right",onDraggableDragStart:this.handleBottomRightDragHandleDragStart,onDraggableDragMove:this.handleDragHandleDragMove})]})})]})}renderDragOverlay(){const e=this.dragState.state;if(!e)return;if(!this.tableElement)return;const t=this.tableElement.getBoundingClientRect(),{draggedCells:o,type:n,left:r,top:i}=e;for(const a of o)a.rect="column"===n?new DOMRect(0,a.rect.top-t.top,a.rect.width,a.rect.height):new DOMRect(a.rect.left-t.left,0,a.rect.width,a.rect.height);return(0,ie.jsx)("div",{style:{position:"absolute",left:r,top:i,zIndex:5},children:(0,ie.jsx)(Ve.Z,{store:this.props.store,ghostElement:o,opacity:.9},"simple_table_drag")})}didMount(){this.tableElement=this.getNode(),this.tableElement?this.observer||(this.observer=new MutationObserver(this.handleObserverChange),this.observer.observe(this.tableElement,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):this.observer&&(this.observer.disconnect(),this.observer=void 0)}handleDragHandleDragStart(e){if(!this.props.selection)return;const{start:t,end:o}=this.props.selection;this.dragHandleSelectAnchor={col:"top-left"===e?Math.max(t.col,o.col):Math.min(t.col,o.col),row:"top-left"===e?Math.max(t.row,o.row):Math.min(t.row,o.row)}}getClosestTableCellPosition(e,t){return{col:this.getClosestColumnIndex(e),row:this.getClosestRowIndex(t)}}getClosestColumnIndex(e){const t=Se.Z.findCellsInRowFromStore(void 0,this.props.store,0).sort(((e,t)=>e.props.columnIndex-t.props.columnIndex));for(let o=0;o<t.length;o++){if(e<=t[o].getNode().getBoundingClientRect().right)return o}return t.length-1}getClosestRowIndex(e){const t=Se.Z.findCellsInColumnFromStore(this.props.store,0).sort(((e,t)=>e.props.rowIndex-t.props.rowIndex));for(let o=0;o<t.length;o++){if(e<=t[o].getNode().getBoundingClientRect().bottom)return o}return t.length-1}getCellRect(e){if(!this.tableElement)return;const{store:t,columnOrder:o}=this.props,n=t.getContentStores()[e.row],r=Se.Z.findCellsInRowFromStore(n,t,e.row);if(!o)return;const i=(a=r,s=o[e.col],null===(l=a.find((e=>e.getColumnID()===s)))||void 0===l||null===(l=l.node)||void 0===l?void 0:l.getBoundingClientRect());var a,s,l;if(!i)return;const c=this.tableElement.getBoundingClientRect(),d=i.top-c.top,p=i.left-c.left,u=i.width,m=function(e){return Math.max(...e.map((e=>{var t;return(null===(t=e.node)||void 0===t||null===(t=t.getBoundingClientRect())||void 0===t?void 0:t.height)||0})))}(r);return new DOMRect(p-2,d-2,u+4,m+4)}}ot.displayName="SimpleTableSelectionOverlay";const nt=ot;class rt extends m.Z{constructor(){super(...arguments),this.storeTypes={formatStore:T},this.rootSizeObserver=new x.E,this.hoverSizeObserver=new x.E,this.nodeRef=s.createRef(),this.handleMount=e=>{e&&this.rootSizeObserver.observe(e)},this.handleHoverMount=e=>{const t=null==e?void 0:e.getNode();t&&this.hoverSizeObserver.observe(t)},this.handleRootMouseDown=e=>{const{device:t}=this.environment;t.isMobile||(0,S.ZP)({event:e,context:S.Af.EditorMouseDown,callback:()=>{e.preventDefault(),p.AI({environment:this.environment,target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!0})}})},this.getSelectableStyle=this.createComputedStore((()=>{const{device:e}=this.environment,t={width:"100%",position:"relative",alignSelf:"center"};return(e.isMobile||this.isInColumnList()||!this.isRootOrDirectChild())&&(t.maxWidth=this.numberOfComments.state?"calc(100% - 40px)":"100%"),t})),this.columnOrder=this.createComputedStore((()=>{const{store:e}=this.props,t=e.getFormat(),{temporaryFormat:o}=this.stores.formatStore.state;return(o||t).table_block_column_order})),this.simpleTableSelection=this.createComputedStore((()=>{const e=A.Z.state,{store:t}=this.props;if(e.isActive&&e.simpleTableStore===t){var o;const r=(null===(o=this.columnOrder.state)||void 0===o?void 0:o.length)||n.getNumberOfColumns(t),i=n.getNumberOfRows(t)+this.numTempRows.state,{selection:a}=e;return{start:{col:(0,d.Z)(a.start.col,0,r-1),row:(0,d.Z)(a.start.row,0,i-1)},end:{col:(0,d.Z)(a.end.col,0,r-1),row:(0,d.Z)(a.end.row,0,i-1)},type:a.type}}}),!0),this.numTempRows=this.createComputedStore((()=>{const e=n.getTableResizeState(this.props.store);return e?e.rowsDelta:0})),this.resizeCursor=this.createComputedStore((()=>{const{store:e}=this.props,t=M.Z.state;if(t.isActive&&t.simpleTableStore===e){const{hover:e}=t;if("cell"===e.type&&e.resizing)return"col-resize"}const o=n.getTableResizeState(e);if(o){if("column"===o.resize)return"col-resize";if("row"===o.resize)return"row-resize";if("corner"===o.resize)return"nwse-resize"}const r=P.Z.state;if(r.isActive&&r.simpleTableStore===e)return"grab"})),this.numberOfBlockComments=this.createComputedStore((()=>n.getNumberOfUnresolvedComments({simpleTableStore:this.props.store,environment:this.environment,includeInline:!1})),!0),this.numberOfComments=this.createComputedStore((()=>n.getNumberOfUnresolvedComments({simpleTableStore:this.props.store,environment:this.environment,includeInline:!0})),!0)}willUnmount(){this.rootSizeObserver.destroy(),this.hoverSizeObserver.destroy()}renderPersisted(){var e,t;const{store:o,disabled:n,disableHoverMenu:r}=this.props,i=this.numberOfComments.state,a=this.numberOfBlockComments.state,s=i>0&&0===a,l=(0,ie.jsx)(g.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store,recursivelyLoadAllDiscussions:!this.marginCommentsVisible.state,hideIfSidebarOrMarginCommentsVisible:s}),c=Boolean(l)&&i>0||this.isInColumnList(),d=(0,ie.jsx)(f.Z,{type:k.Z.X,preventType:u.Q7(this.environment),style:{flexGrow:1,marginLeft:-8},showLeftRightOverlay:!0,leftOverlayStyle:{left:c?-8:-8-((null===(e=this.getLeftRightPadding())||void 0===e?void 0:e.paddingLeft)||0),top:8,bottom:18},rightOverlayStyle:{top:8,bottom:18},children:this.renderContent(c)}),p=(0,_.Fn)(this.environment),m=!n&&("comment_only"===this.props.store.getRole()||"comment"===(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state.permission))&&this.environment.currentUser.isLoggedIn();return(0,ie.jsxs)(h.p,{allowSelectionWithin:!0,style:this.getStyle(),ref:this.handleMount,onMouseDown:this.handleRootMouseDown,children:[c?(0,ie.jsx)(y.Z,{store:o,shouldShowHoverMenu:!r&&(this.canEdit()||p),shouldShowCommentMenu:m,style:this.getSelectableStyle.state,analyticsName:"page_content",ref:this.handleHoverMount,children:d}):d,l,(0,ie.jsx)(de,{disabled:n,canEdit:this.canEdit(),simpleTableStore:o,rootSizeObserver:this.rootSizeObserver,offset:c?0:this.getOffset()||0,hoverSizeObserver:this.hoverSizeObserver})]})}renderContent(e){var t;const{store:o,disabled:r,disableHoverMenu:i}=this.props,a=o.getContentStores(),s=this.columnOrder.state;if(!s)return;const l=this.numTempRows.state,c=l<0?a.length+l:a.length,d=this.simpleTableSelection.state,{device:p}=this.environment,u=!p.isPhone,m=!r&&("comment_only"===this.props.store.getRole()||"comment"===(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state.permission))&&this.environment.currentUser.isLoggedIn(),g=(0,ie.jsx)("div",{style:{display:"flex"},children:(0,ie.jsx)("div",{style:{paddingTop:8,paddingLeft:8,paddingBottom:18,paddingRight:18},children:(0,ie.jsx)(y.Z,{store:o,shouldShowHalo:!0,canSelect:!0,canDropLeft:u,canDropRight:u,canDropAbove:!1,canDropBelow:!1,aboveDropZoneMargin:4,belowDropZoneMargin:4,analyticsName:"page_content",shouldShowDropZone:!0,style:{position:"relative"},className:v.OE$,shouldShowCommentMenu:m,nodeRef:this.nodeRef??void 0,children:(0,ie.jsx)(nt,{store:o,selection:d,columnOrder:s,formatStore:this.stores.formatStore,disabled:r,canEdit:this.canEdit(),children:(0,ie.jsx)("table",{children:(0,ie.jsxs)("tbody",{ref:this.nodeRef,children:[a.slice(0,c).map(((e,t)=>(0,ie.jsx)(Ze,{rowIndex:t,rowStore:e,store:o,disabled:r,columnOrder:s,selection:d,formatStore:this.stores.formatStore},e.id))),l>0&&[...Array(l).keys()].map(((e,t)=>(0,ie.jsx)(Ze,{rowIndex:n.getNumberOfRows(o)+t,store:o,rowStore:void 0,disabled:r,columnOrder:s,selection:d,formatStore:this.stores.formatStore},t)))]})})})})})}),h=(0,_.Fn)(this.environment);return(0,ie.jsx)("div",{className:v.fOh,style:{cursor:this.resizeCursor.state,...e?{paddingRight:20}:this.getLeftRightPadding()},children:e?g:(0,ie.jsx)(y.Z,{store:o,shouldShowCommentMenu:m,shouldShowHoverMenu:!i&&(this.canEdit()||h),style:this.getSelectableStyle.state,analyticsName:"page_content",ref:this.handleHoverMount,children:g})})}handleCreated(){c.default.afterNextFlush((()=>{r.selectCellAndSetCursor({environment:this.environment,rowIndex:0,columnIndex:0,simpleTableStore:this.props.store})}))}getStyle(){const{store:e}=this.props;return{...this.getBlockColorStyle(),...this.props.style,position:"relative",display:"flex",...(0,b.Ks)(e)&&{width:(0,w.$3)(this.environment),position:"sticky",left:0}}}isInColumnList(){return this.context.isInColumnList}getLeftRightPadding(){const{store:e}=this.props;return(0,b.Bs)({environment:this.environment,store:e,isFullScreen:!1,sizeObserver:this.rootSizeObserver})}getOffset(){var e;return null===(e=this.getLeftRightPadding())||void 0===e?void 0:e.paddingLeft}}rt.contextTypes={...l.w,isInColumnList:a().any};const it=rt},84139:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(35431);class r extends n.Z{findCellsInRowFromStore(e,t,o){return this.filter((n=>{const{store:r,simpleTableStore:i,rowIndex:a}=n.props;return e?r===e:i===t&&a===o}))}findCellsInColumnFromStore(e,t){return this.filter((o=>o.props.simpleTableStore===e&&("number"==typeof t&&o.props.columnIndex===t||"string"==typeof t&&o.props.columnID===t)))}findCellFromTextStore(e){return this.find((t=>t.props.textStore===e))}findCellFromElement(e,t){return this.find((o=>o.props.simpleTableStore===t&&o.getNode()===e))}}const i=new r},64359:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(72126);class i extends n.default{getInitialState(){return{isActive:!1}}cloneState(){return r.d9(this.state)}}const a=new i},5676:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(72126);class i extends n.default{getInitialState(){return{isActive:!1}}cloneState(){return r.d9(this.state)}}const a=new i},29574:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(72126);class i extends n.default{getInitialState(){return{isActive:!1}}cloneState(){return r.d9(this.state)}}const a=new i},63208:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(72126);class i extends n.default{getInitialState(){return{isActive:!1}}cloneState(){return r.d9(this.state)}}const a=new i},84693:(e,t,o)=>{o.d(t,{Y3:()=>j,y6:()=>T,G$:()=>O,lR:()=>F,GF:()=>N,Q6:()=>E});o(21703),o(57658);var n=o(72126),r=o(73360),i=o(606),a=o(21202),s=o(80873),l=o(97664),c=o(20985),d=o(97880);const p={table:a.iU,recordColumnTypes:{id:s.Z.UUID,space_id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,type:s.Z.String,properties:s.Z.JSON,content:s.Z.StringArray,discussions:s.Z.StringArray,view_ids:s.Z.StringArray,collection_id:s.Z.UUID,permissions:s.Z.JSON,created_time:s.Z.Number,last_edited_time:s.Z.Number,copied_from:s.Z.UUID,file_ids:s.Z.StringArray,ignore_block_count:s.Z.Boolean,is_template:s.Z.Boolean,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,moved:s.Z.JSON,format:s.Z.JSON,created_by:s.Z.UUID,last_edited_by:s.Z.UUID,created_by_table:s.Z.String,created_by_id:s.Z.UUID,last_edited_by_table:s.Z.String,last_edited_by_id:s.Z.UUID,content_classification:s.Z.String},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_last_access_timestamp:s.Z.Number,meta_role:s.Z.String}};const u={table:o(6287).v,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,name:s.Z.JSON,description:s.Z.JSON,icon:s.Z.String,cover:s.Z.String,schema:s.Z.JSON,format:s.Z.JSON,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,file_ids:s.Z.StringArray,template_pages:s.Z.StringArray,copied_from:s.Z.UUID,migrated:s.Z.Boolean,space_id:s.Z.UUID,deleted_schema:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const m={table:o(13493).n,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,type:s.Z.String,name:s.Z.String,page_sort:s.Z.UUIDArray,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,format:s.Z.JSON,query2:s.Z.JSON,space_id:s.Z.UUID},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const g={table:o(70279).x_,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,parent_id:s.Z.UUID,parent_table:s.Z.String,text:s.Z.JSON,created_time:s.Z.Number,last_edited_time:s.Z.Number,alive:s.Z.Boolean,created_by_table:s.Z.String,created_by_id:s.Z.UUID,space_id:s.Z.UUID,content:s.Z.UUIDArray,reactions:s.Z.UUIDArray},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const h={table:o(33709).qF,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,parent_id:s.Z.UUID,parent_table:s.Z.String,context:s.Z.JSON,resolved:s.Z.Boolean,comments:s.Z.StringArray,space_id:s.Z.UUID},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const f={table:o(65311).uX,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,user_id:s.Z.UUID,activity_id:s.Z.UUID,received:s.Z.Boolean,read:s.Z.Boolean,visited:s.Z.Boolean,emailed:s.Z.Boolean,invalid:s.Z.Boolean,space_id:s.Z.UUID,navigable_block_id:s.Z.UUID,collection_id:s.Z.UUID,type:s.Z.String,end_time:s.Z.String,channel:s.Z.String,archived_at:s.Z.Number},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const y={table:o(19889).KJ,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,email:s.Z.String,given_name:s.Z.String,family_name:s.Z.String,profile_photo:s.Z.String,onboarding_completed:s.Z.Boolean,mobile_onboarding_completed:s.Z.Boolean,clipper_onboarding_completed:s.Z.Boolean,reverify:s.Z.Boolean,name:s.Z.String,is_banned:s.Z.Boolean,suspended_time:s.Z.Number},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const v={table:o(80396).yo,recordColumnTypes:{id:s.Z.UUID,space_id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,created_time:s.Z.Number,parent_id:s.Z.UUID,parent_table:s.Z.String,icon:s.Z.String,actors:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const b={table:o(15047).bx,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,name:s.Z.String,permissions:s.Z.JSON,permission_groups:s.Z.JSON,email_domains:s.Z.StringArray,pages:s.Z.StringArray,icon:s.Z.String,disable_public_access:s.Z.Boolean,disable_public_access_requests:s.Z.Boolean,disable_guests:s.Z.Boolean,disable_move_to_space:s.Z.Boolean,disable_export:s.Z.Boolean,disable_space_page_edits:s.Z.Boolean,beta_enabled:s.Z.Boolean,created_time:s.Z.Number,last_edited_time:s.Z.Number,deleted_by:s.Z.UUID,created_by_table:s.Z.String,created_by_id:s.Z.UUID,last_edited_by_table:s.Z.String,last_edited_by_id:s.Z.UUID,admin_disable_public_access:s.Z.Boolean,space_pages:s.Z.UUIDArray,plan_type:s.Z.String,invite_link_enabled:s.Z.Boolean,initial_use_cases:s.Z.String,public_home_page:s.Z.String,bot_settings:s.Z.JSON,settings:s.Z.JSON,subscription_tier:s.Z.String,disable_team_creation:s.Z.Boolean,overdue_subscription:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const S={table:o(77858).zU,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,space_id:s.Z.UUID,bookmarked_pages:s.Z.StringArray,shared_pages:s.Z.StringArray,visited_templates:s.Z.StringArray,sidebar_hidden_templates:s.Z.StringArray,notify_mobile:s.Z.Boolean,notify_desktop:s.Z.Boolean,notify_email:s.Z.Boolean,notify_email_always:s.Z.Boolean,created_getting_started:s.Z.Boolean,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,created_onboarding_templates:s.Z.Boolean,private_pages:s.Z.UUIDArray,joined:s.Z.Boolean,joined_teams:s.Z.UUIDArray,settings:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const _={table:o(29369).e0,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,space_id:s.Z.UUID,name:s.Z.String,description:s.Z.String,icon:s.Z.String,created_time:s.Z.Number,created_by_table:s.Z.String,created_by_id:s.Z.UUID,last_edited_time:s.Z.Number,last_edited_by_table:s.Z.String,last_edited_by_id:s.Z.UUID,archived_by:s.Z.UUID,archived_at:s.Z.Number,team_pages:s.Z.UUIDArray,pinned_pages:s.Z.UUIDArray,parent_id:s.Z.UUID,parent_table:s.Z.String,settings:s.Z.JSON,is_default:s.Z.Boolean,membership:s.Z.JSON,permissions:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const w={table:o(66079).dx,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,space_views:s.Z.StringArray,space_view_pointers:s.Z.JSON,left_spaces:s.Z.StringArray,deleted_email:s.Z.String},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const k={table:o(28182).Sr,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,settings:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}},x=[p,b,S,w,y,m,u,_,k,f,g,h,v],I=new Set(x.map((e=>e.table))),C=Object.keys({record_table:!0,record_id:!0,record_value:!0,space_id:!0,timestamp:!0,parent_table:!0,parent_id:!0,importance:!0,user_id:!0});async function T(e,t){await(0,l.G$)({connection:e,statements:[{sql:"\n\t\t\t\tUPDATE records SET user_id = ? WHERE user_id is null\n\t\t\t\t",args:[t]}],queryName:"backfillRecordsWithUserId"})}function M(e){const t=n.vM(e.records,(e=>e.pointer.table)),o=[];return Object.entries(t).forEach((t=>{let[r,i]=t;const a=x.find((e=>e.table===r));if(!a)return;const s=Object.keys(a.recordColumnTypes),c=Object.keys(a.metaColumnTypes),d=s.concat(c);n.yo(i,Math.floor(l.mz/d.length)).forEach((t=>{const i=`(${d.join(",")})`,a=Array(t.length).fill(`(${"?, ".repeat(d.length-1)}?)`).join(",");let l;l=e.maybeStaleRecords&&d.includes("version")?`INSERT INTO ${r} ${i} VALUES ${a}`.concat("ON CONFLICT (id, meta_user_id) DO UPDATE SET").concat("\n").concat(d.map((e=>`${e} = excluded.${e}`)).join(",")).concat("\n").concat(`WHERE excluded.version > ${r}.version`):`INSERT OR REPLACE INTO ${r} ${i} VALUES ${a}`;const p=n.xH(t.map((e=>{let{value:t,timestamp:o,userId:n}=e;if(!t)return[];const r=t.value;if(!r)return[];const i=s.map((e=>function(e){if(null==e)return null;if("string"==typeof e||"number"==typeof e)return e;if("boolean"==typeof e)return e?1:0;return JSON.stringify(e)}(r[e]))),a=c.map((e=>{switch(e){case"meta_user_id":return n;case"meta_role":return t.role;case"meta_last_access_timestamp":return o;default:throw new Error(`Unknown meta column ${e}`)}}));return i.concat(a)})));o.push({sql:l,args:p})}))})),o}function P(e){const[t,o]=n.uK(e.records,(e=>L(e))),i=M({records:t,maybeStaleRecords:e.maybeStaleRecords}),a=function(e){const{records:t,maybeStaleRecords:o}=e;return n.yo(t,Math.floor(l.mz/C.length)).map((e=>{let t=`\n\t\t\tINSERT INTO records\n\t\t\t(\n\t\t\t\trecord_table,\n\t\t\t\trecord_id,\n\t\t\t\trecord_value,\n\t\t\t\ttimestamp,\n\t\t\t\tparent_table,\n\t\t\t\tparent_id,\n\t\t\t\timportance,\n\t\t\t\tuser_id,\n\t\t\t\tspace_id\n\t\t\t)\n\t\t\tVALUES ${Array(e.length).fill("(?, ?, ?, ?, ?, ?, ?, ?, ?)").join(",")}`;return t=o?t.concat("\n\t\t\t\tON CONFLICT (record_table, record_id, user_id) DO UPDATE SET\n\t\t\t\t\trecord_value =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.record_value\n\t\t\t\t\t\tELSE records.record_value\n\t\t\t\t\t\tEND,\n\t\t\t\t\ttimestamp =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.timestamp\n\t\t\t\t\t\tELSE records.timestamp\n\t\t\t\t\t\tEND,\n\t\t\t\t\tparent_table =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.parent_table\n\t\t\t\t\t\tELSE records.parent_table\n\t\t\t\t\t\tEND,\n\t\t\t\t\tparent_id =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.parent_id\n\t\t\t\t\t\tELSE records.parent_id\n\t\t\t\t\t\tEND,\n\t\t\t\t\timportance =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.importance\n\t\t\t\t\t\tELSE records.importance\n\t\t\t\t\t\tEND,\n\t\t\t\t\tuser_id =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.user_id\n\t\t\t\t\t\tELSE excluded.user_id\n\t\t\t\t\t\tEND,\n\t\t\t\t\t-- space_id never changes.\n\t\t\t\t\tspace_id = COALESCE(records.space_id, excluded.space_id)"):t.concat("\n\t\t\t\tON CONFLICT (record_table, record_id, user_id) DO UPDATE SET\n\t\t\t\t\trecord_value = excluded.record_value,\n\t\t\t\t\ttimestamp = excluded.timestamp,\n\t\t\t\t\tparent_table = excluded.parent_table,\n\t\t\t\t\tparent_id = excluded.parent_id,\n\t\t\t\t\timportance = excluded.importance,\n\t\t\t\t\tuser_id = excluded.user_id,\n\t\t\t\t\t-- space_id never changes.\n\t\t\t\t\tspace_id = COALESCE(records.space_id, excluded.space_id)"),{sql:t,args:n.xH(e.map((e=>{let{pointer:t,value:o,timestamp:n,importance:i,userId:a}=e,s=null,c=null;return o&&o.value&&(0,r.oK)(o.value)&&(s=o.value.parent_id,c=o.value.parent_table),[t.table,t.id,(0,l.gI)(o),n,c,s,"number"==typeof i?i:null,a,t.spaceId||null]})))}}))}({records:o,maybeStaleRecords:e.maybeStaleRecords});return[...A(t),...D(o.filter((e=>I.has(e.pointer.table)))),...i,...a]}function A(e){return n.yo(e,Math.floor(l.mz/(2*e.length))).map((e=>{const t=c.i6` OR `.joins(e.map((e=>c.i6`(records.record_id = ${e.pointer.id} AND records.user_id = ${e.userId})`)));return c.i6`DELETE FROM records WHERE ${t}`.asWrite()}))}function D(e){const t=n.vM(e,(e=>e.pointer.table)),o=[];return Object.entries(t).forEach((e=>{let[t,r]=e;n.yo(r,Math.floor(l.mz/(2*r.length))).forEach((e=>{const n=c.i6` OR `.joins(e.map((e=>c.i6`(id = ${e.pointer.id} AND meta_user_id = ${e.userId})`)));o.push(c.i6`DELETE FROM ${(0,c.k5)(t)} WHERE ${n}`.asWrite())}))})),o}async function B(e,t){if(0===t.length)return[];const o=n.vM(t,(e=>e.pointer.table)),r=[];Object.entries(o).forEach((t=>{let[o,a]=t;const s=x.find((e=>e.table===o));if(!s)return;const c=Array(a.length).fill("(id = ? AND meta_user_id = ?)").join(" OR "),d=n.VS(a,(e=>{let{pointer:{table:t,id:o},userId:n}=e;return[o,n]}));r.push(new Promise((async t=>{const[n]=await(0,l.G$)({connection:e,statements:[{sql:`\n\t\t\t\tSELECT * FROM ${o}\n\t\t\t\tWHERE ${c}`,args:d,getData:!0}],queryName:"getRecordsFromSeparateTables"});t(n.data.map((e=>function(e,t,o){return{pointer:i.dr.fromPointerLike({table:e,id:t.id,spaceId:t.space_id||void 0}),value:{role:t.meta_role,value:R(t,o)},timestamp:t.meta_last_access_timestamp,importance:0,userId:t.meta_user_id}}(o,e,s))))})))}));const a=await Promise.all(r);return n.xH(a)}function R(e,t){const o={};return Object.keys(t.recordColumnTypes).forEach((n=>{const r=t.recordColumnTypes[n];if(null!==e[n])switch(r){case s.Z.UUID:case s.Z.String:case s.Z.Number:o[n]=e[n];break;case s.Z.StringArray:case s.Z.JSON:o[n]=JSON.parse(e[n]);break;case s.Z.XML:o[n]=e[n];break;case s.Z.UUIDArray:o[n]=JSON.parse(e[n]);break;case s.Z.Boolean:o[n]=1===e[n];break;case s.Z.CIDR:o[n]=e[n];break;default:(0,d.t1)(r)}})),o}async function E(e,t){const[o,r]=n.uK(t,(e=>I.has(e.pointer.table))),a=await B(e,o),s=new Set(a.map((e=>i.P2.toKey({pointer:e.pointer,userId:e.userId})))),c=o.filter((e=>!s.has(i.P2.toKey(e)))),d=(await async function(e,t){if(0===t.length)return[];const o=Array(t.length).fill("(record_table = ? AND record_id = ? AND user_id = ?)").join(" OR "),r=n.VS(t,(e=>{let{pointer:{table:t,id:o},userId:n}=e;return[t,o,n]})),[a]=await(0,l.G$)({connection:e,statements:[{sql:`\n\t\t\t\tSELECT * FROM records\n\t\t\t\tWHERE ${o}`,args:r,getData:!0}],queryName:"getRecordsFromRecordsTable"});return a.data.map((e=>({pointer:i.dr.fromPointerLike({table:e.record_table,id:e.record_id,spaceId:e.space_id||void 0}),value:JSON.parse(e.record_value),timestamp:e.timestamp,importance:"number"==typeof e.importance?e.importance:void 0,userId:e.user_id})))}(e,r.concat(c))).filter((e=>!L(e)));return a.concat(d)}async function F(e,t){const o=c.i6`
  SELECT * FROM block
  WHERE parent_table = ${t.parent.table}
  AND parent_id = ${t.parent.id}
  AND meta_user_id = ${t.userId}
  `.asRead(),n=c.i6`
  UPDATE block
  SET meta_last_access_timestamp = ${t.timestamp}
  WHERE parent_table = ${t.parent.table}
  AND parent_id = ${t.parent.id}
  AND meta_user_id = ${t.userId}
  `.asWrite(),[r]=await(0,l.G$)({connection:e,statements:[o,n],queryName:"getBlocksWithParent"});return r.data.map((e=>({pointer:i.dr.fromPointerLike({table:a.iU,id:e.id,spaceId:e.space_id||void 0}),value:{role:e.meta_role,value:R(e,p)},userId:t.userId})))}async function N(e,t){const o=c.i6`
    WITH RECURSIVE page_blocks AS (
      SELECT * FROM block
      WHERE id = ${t.page.id}
      AND meta_user_id = ${t.userId}

      UNION

      SELECT block.*
      FROM
        block INDEXED BY block_parent_id,
        page_blocks
      WHERE
      (
        page_blocks.id = ${t.page.id}
        OR page_blocks.type NOT IN ('page', 'toggle')
      )
      AND block.parent_table = 'block'
      AND block.parent_id = page_blocks.id
      AND block.meta_user_id = ${t.userId}
    )
    SELECT * FROM page_blocks
    `,n=await o.all(e,"getPageBlocksByParent");return 0===n.length?[]:n.map((e=>({pointer:i.dr.fromPointerLike({table:a.iU,id:e.id,spaceId:e.space_id||void 0}),value:{role:e.meta_role,value:R(e,p)},userId:t.userId})))}async function j(e,t,o){const n=o.filter((e=>"set"===e.type&&!e.maybeStaleRecord)),r=o.filter((e=>"set"===e.type&&e.maybeStaleRecord)),i=o.filter((e=>{let{type:t}=e;return"access"===t})),s=o.filter((e=>{let{type:t}=e;return"delete"===t})),d=[];if(i.forEach((e=>{const t=e.record.pointer.table;L(e.record)?t===a.iU&&d.push(c.i6`
	        UPDATE block
	        SET meta_last_access_timestamp = ${e.record.timestamp}
	        WHERE id = ${e.record.pointer.id}
	        AND meta_user_id = ${e.record.userId}
	        `.asWrite()):d.push({sql:"UPDATE records\n          SET timestamp = ?\n          WHERE record_table = ?\n          AND record_id = ?\n          AND user_id = ?",args:[e.record.timestamp,t,e.record.pointer.id,e.record.userId]})})),n.length>0||r.length>0){if(n.length>0){const e=n.map((e=>e.record));d.push(...P({records:e,maybeStaleRecords:!1}))}if(r.length>0){const e=r.map((e=>e.record));d.push(...P({records:e,maybeStaleRecords:!0}))}d.push(c.i6`
			DELETE FROM records
			WHERE rowid IN (
				SELECT rowid FROM records
				ORDER BY importance DESC, timestamp DESC
				LIMIT -1
				OFFSET ${t}
			)
			`.asWrite()),d.push(c.i6`
			DELETE FROM block
			WHERE rowid in (
				SELECT rowid FROM block
				ORDER BY meta_last_access_timestamp DESC
				LIMIT -1
				OFFSET ${t}
			)
			`.asWrite())}if(s.length>0){const e=s.map((e=>e.record));d.push(...function(e){const t=D(e.filter((e=>I.has(e.pointer.table)))),o=A(e);return t.concat(o)}(e))}0!==d.length&&await(0,l.G$)({connection:e,statements:d,queryName:"applyRecordCacheOperations"})}async function O(e){await async function(e){const t=[];I.forEach((e=>{t.push(c.i6`DELETE FROM ${(0,c.k5)(e)}`.asWrite())})),await(0,l.G$)({connection:e,statements:t,queryName:"deleteAllCachedRecordsFromSeparateTables"})}(e),await async function(e){await(0,l.sf)({connection:e,sql:"DELETE FROM records",queryName:"deleteAllCachedRecordsFromRecordsTable"})}(e)}function L(e){return I.has(e.pointer.table)&&void 0!==e.value&&void 0!==e.value.value}},4023:(e,t,o)=>{o.d(t,{u:()=>n,v:()=>r});let n=function(e){return e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Center=4]="Center",e}({}),r=function(e){return e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.End=2]="End",e}({})},70726:(e,t,o)=>{o.d(t,{Z:()=>r});var n=function(e){return e[e.Preview=0]="Preview",e[e.Mention=1]="Mention",e[e.Link=2]="Link",e}(n||{});const r=n},34859:(e,t,o)=>{o.d(t,{Z:()=>r});var n=function(e){return e[e.All=0]="All",e[e.X=1]="X",e[e.Y=2]="Y",e[e.None=3]="None",e}(n||{});const r=n},83960:(e,t,o)=>{o.d(t,{T:()=>n,l:()=>r});const n={localLanguagePreferenceKey:"CodeBlockDefaultLanguage",localCodeWrapPreferenceKey:"CodeBlockDefaultCodeWrap",defaultLanguage:"JavaScript",defaultCodePreviewFormat:"code"},r={localSizePreferenceKey:"QuoteBlockDefaultSize"}},96198:(e,t,o)=>{o.d(t,{O:()=>n});const n=44},15723:(e,t,o)=>{o.d(t,{Ep:()=>a,Kr:()=>d,MU:()=>m,aP:()=>l,bM:()=>i,dQ:()=>p,iL:()=>r,jn:()=>u,kK:()=>c,uh:()=>s});var n=o(72126);class r{static from(e){return new r(e.left,e.top,e.width,e.height)}constructor(e,t,o,n){this.x=e,this.y=t,this.width=o,this.height=n,this.top=this.height<0?this.y+this.height:this.y,this.bottom=this.height<0?this.y:this.y+this.height,this.left=this.width<0?this.x+this.width:this.x,this.right=this.width<0?this.x:this.x+this.width}toJSON(){return{...this}}}const i=new r(0,0,0,0);function a(e){return Boolean(e&&(n.hj(e.top)||n.hj(e.left)))}function s(e,t,o){return e.left<=t&&t<=e.right&&e.top<=o&&o<=e.bottom}function l(e,t){return e.left<=t.left&&e.right>=t.right&&e.top<=t.top&&e.bottom>=t.bottom}function c(e,t){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)}function d(e,t){return!(e.right<=t.left||t.right<=e.left)}function p(e,t){return!(e.bottom<=t.top||t.bottom<=e.top)}function u(e,t){return new r(e.left-t,e.top-t,e.width+2*t,e.height+2*t)}function m(e){const t=e.top+e.height/2,o=e.left+e.width/2;return new r(o,t,0,0)}},12252:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(72126);class i extends n.default{constructor(){super(...arguments),this.pause=()=>{this.setState({active:!1,onActive:[]})},this.resume=()=>{this.state.onActive.map((e=>e())),this.setState({active:!0,onActive:[]})}}getInitialState(){return{active:!0,onActive:[]}}whenActive(e){this.state.active?e():this.setState({...this.state,onActive:r.jj([...this.state.onActive,e])})}}const a=new i},51214:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{}}isGeneratingAtAll(){return Object.values(this.state).some((e=>!0===e))}isGeneratingFor(e){return Boolean(this.state[e])}setIsGeneratingFor(e){this.update((t=>({...t,[e]:!0})))}setGenerationCompleteFor(e){this.update((t=>({...t,[e]:!1})))}}const i=new r},58455:(e,t,o)=>{o.r(t),o.d(t,{default:()=>s});var n=o(49085),r=o(4615),i=o(95477);class a extends n.default{constructor(){super(...arguments),this.verboseAnalytics=i.default.isAdminMode||false}getInitialState(){return{isLoaded:!1,isLoggingEnabled:!1,isAmplitudeEnabled:!1,isSegmentEnabled:!1,isZendeskEnabled:!1,isIntercomEnabled:!1,intercomAppId:void 0,intercomUserHash:void 0,noIntercomUserId:!1,isSprigEnabled:!1,zendeskToken:void 0}}shouldRefresh(e){return!this.state.isLoaded||Boolean(e)!==Boolean(this.state.user_id)||Boolean(e&&this.state.user_id&&(0,r.cj)(this.state.user_id)!==(0,r.cj)(e))}}const s=new a},51:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{}}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state.publicPageData)))}}const i=new r},80444:(e,t,o)=>{o.r(t),o.d(t,{default:()=>m});var n=o(49085),r=o(72126),i=o(59753),a=o(74446);o(7406);const s={wiki_promo:0,ai_qna_alpha:0,ai_qna_beta_waitlist:0,enterprise_launch_promo:0,tasks_migration_modal:0,better_template_initialization:1,pm_intro_tooltip:2,pm_intro_sidebar_notif:2,customer_io:2,share_button_tooltip:2,add_icon_tooltip:2,persona_collection:2,add_on_discount_popup:2,team_add_app_template_tooltip:2,ai_onboarding_tooltip:2,share_menu_tutorial:2};class l extends n.default{getInitialState(){return{activeCallouts:new Set}}updateCalloutStatus(e){let{calloutId:t,visible:o}=e;const{activeCallouts:n}=this.state;if(o){const e=new Set(n).add(t);for(const o of n){s[t]<s[o]&&e.delete(o)}this.setState({activeCallouts:e})}else{const e=new Set(n);e.delete(t);this.setState({activeCallouts:e})}}canShow(e){const{activeCallouts:t}=this.state;if(t.has(e))return!0;for(const o of t){if(s[o]<=s[e])return!1}return!0}}const c=l;var d=o(30539),p=o(89523);class u extends n.default{getInitialState(){return{initialized:!1,renderPhase:"booting",pageVisitStore:new d.Z,presenceStore:new p.Z,inAppCalloutStore:new c}}getCurrentBlockModelFn(){const{mainEditorCurrentBlockStore:e}=this.state,t=a.mF.tryUntilFound(...r.oA([e&&e.getRecordValue]));return i.om.fromGetRecordValueFn(t)}waitUntilRendered(){return this.waitUntil((()=>"rendered"===this.state.renderPhase))}}u.sidebarIsExpandedPreferenceKey="sidebarIsExpanded";const m=new u},92425:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{}}getSharedPagesState(e){const{userId:t,spaceId:o}=e;let n=this.state[t];n||(n={},this.state[t]=n);return n[o]}setSharedPagesState(e){const{userId:t,spaceId:o,state:n}=e;let r=this.state[t];r||(r={},this.state[t]=r),r[o]=n,this.emit()}}const i=new r},21273:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085),r=o(38823),i=o(45433);o(95477);class a extends n.default{getInitialState(){return new r.m({getEligibleGroup:()=>"control",isAiEnabled:()=>!1})}isAiEnabled(){return this.state.isAiEnabled()}isAssistantEnabled(){return this.state.isAssistantEnabled()}isMobileWebExperienceEnabled(){return this.modeIsAtMost("development")}isQnAOnlyEnabled(){return this.state.isQnAOnlyEnabled()}isAssistant2Enabled(){return this.isAssistantEnabled()&&!1}shouldShowQnaInSearchOnly(){return this.modeIsAtMost("beta")}shouldShowSearchMenuItemAskAI(){return this.modeIsAtMost("beta")}shouldShowAssistantInCorner(){return this.modeIsAtMost("beta")}isShowingAssistantInsteadOfHelpCenterInBottomRight(){return this.modeIsAtMost("beta")}showAiQnaOnboardingModalForAlphaLaunch(){return this.modeIsAtMost("beta")}showSearchAiFeatures(){return this.modeIsAtMost("beta")}allowWikiSkillCreation(e){return e===i.FF&&this.modeIsAtMost("development")}allowTaskSkillCreation(e){return e===i.TZ&&this.modeIsAtMost("ai_team")}allowCustomSkillCreation(){return this.modeIsAtMost("ai_team")}canViewMoreSkills(e){const t=this.allowWikiSkillCreation(e),o=this.allowTaskSkillCreation(e),n=this.allowCustomSkillCreation();return t||o||n}shouldShowAISections(){return this.modeIsAtMost("ai_team")}shouldAttributeChangesToAI(){return this.modeIsAtMost("ai_team")}getMode(){return this.state.getMode()}isMode(e){return this.state.isMode(e)}modeIsAtMost(e){return this.state.modeIsAtMost(e)}}const s=new a},98180:(e,t,o)=>{o.d(t,{Z:()=>l});o(21703);var n=o(49085),r=o(92595);const i=10*o(63143).hM;class a extends n.default{getInitialState(){return{activeAiSessionId:void 0,sessions:{},lastSessionInitializedUnixEpochTime:Date.now()}}clearAllSessions(){this.reset()}getActiveSessionId(){return this.state.activeAiSessionId}getActiveSession(){const e=this.state.activeAiSessionId;if(e)return this.state.sessions[e]}getActiveAssistantRuntimeStore(){var e;return null===(e=this.getActiveSession())||void 0===e?void 0:e.assistantRuntimeStore}getActiveAssistantRuntimeState(){var e;return null===(e=this.getActiveAssistantRuntimeStore())||void 0===e?void 0:e.state}getActiveAssistantConfigurationStore(){var e;return null===(e=this.getActiveSession())||void 0===e?void 0:e.assistantConfigurationStore}getActiveAssistantConfigurationState(){var e;return null===(e=this.getActiveAssistantConfigurationStore())||void 0===e?void 0:e.state}getSessionContext(e){return this.state.sessions[e]}getSessionContextOrThrow(e){const t=this.getSessionContext(e);if(!t)throw new Error("No assistant context for given session");return t}setNewActiveSession(e){const{sessionId:t,context:o}=e;this.update((e=>({...e,activeAiSessionId:t,sessions:{...e.sessions,[t]:o},lastSessionInitializedUnixEpochTime:Date.now()})))}addNewSession(e){const{sessionId:t,context:o}=e;this.update((e=>({...e,sessions:{...e.sessions,[t]:o}})))}endCurrentSession(){this.update((e=>({...e,activeAiSessionId:void 0})))}setLastSessionInitializedUnixEpochTime(){this.update((e=>({...e,lastSessionInitializedUnixEpochTime:Date.now()})))}wasActiveSessionLastOpenedOutsideOfHistorySavedWindow(){const e=this.state.lastSessionInitializedUnixEpochTime;return!e||Date.now()-e>=i}}const s=new a,l=s;(0,r.exposeDebugValue)("AssistantRegistryStore",s),(0,r.exposeDebugValue)("getTranscript",(()=>{var e;const t=(null===(e=s.getActiveSession())||void 0===e||null===(e=e.assistantRuntimeStore.state)||void 0===e?void 0:e.evaluator.getTranscript())??[];return JSON.stringify(t)}))},82375:(e,t,o)=>{o.d(t,{BJ:()=>s,Hl:()=>l,Of:()=>i,Pl:()=>c,zZ:()=>a});o(21703);var n=o(49085),r=o(92595);const i=(0,o(97880).AO)((e=>"string"==typeof e.inferenceId?{true:e}:{false:e}));function a(e){const{store:t,step:o}=e;if(!t.state)throw new Error("No state");const n=t.state.sampledSteps.map((e=>e.id===o.id?o:e));t.setState({...t.state,sampledSteps:n})}class s extends n.default{getInitialState(){}getCombinedSteps(){var e,t;return[...(null===(e=this.state)||void 0===e?void 0:e.clientSteps)||[],...(null===(t=this.state)||void 0===t?void 0:t.temporaryClientSteps)||[]]}}const l=n.default.createValue(void 0),c=n.default.createValue(void 0);(0,r.exposeDebugValue)("labelingSlackModeStore",c)},58454:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085),r=o(92595);class i extends n.default{getInitialState(){return{open:!1}}}const a=new i;(0,r.exposeDebugValue)("AutomationModalStore",a);const s=a},8297:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{banners:[]}}}const i=r},24229:(e,t,o)=>{o.d(t,{Z:()=>d,u:()=>s});var n=o(49085),r=o(92595),i=o(49427),a=o(15723);let s=function(e){return e[e.Open=0]="Open",e[e.Resolved=1]="Resolved",e[e.NewThread=2]="NewThread",e}({});class l extends n.default{getInitialState(){return{open:!1,rect:a.bM,recursivelyLoadAllDiscussions:!1}}getFramePageFirstSelectedDiscussionId(){var e;return this.state.open&&i.Z.isBlockInFrame(this.state.blockStore)?null===(e=this.state.discussionIds)||void 0===e?void 0:e[0]:void 0}}const c=new l;(0,r.exposeDebugValue)("BlockDiscussionMenuStore",c);const d=c},8949:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isActive:!1}}}const i=new r},61207:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},58484:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isOpen:!1}}}const i=r},68859:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{dragging:!1}}}const i=r},61766:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=r},17746:(e,t,o)=>{o.d(t,{Z:()=>s,t:()=>i});var n=o(49085),r=o(15157);let i=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class a extends n.default{getInitialState(){return{dayStoreMap:new Map,isDragging:!1,startingMonth:0}}static getLocalViewPreferenceKey(e){return`CalendarView:${e}`}static getLocalPreferences(e){let{collectionViewId:t,currentUserId:o}=e;return r.Z.get({userId:o,key:a.getLocalViewPreferenceKey(t)})}static getLocalDateRangeStart(e){let{collectionViewId:t,currentUserId:o}=e;const n=this.getLocalPreferences({collectionViewId:t,currentUserId:o});return n&&n.dateRangeStart?n.dateRangeStart:Date.now()}static setLocalDateRangeStart(e){let{collectionViewId:t,dateRangeStart:o,currentUserId:n}=e;const i=this.getLocalPreferences({collectionViewId:t,currentUserId:n})||{},s=a.getLocalViewPreferenceKey(t),l={...i,dateRangeStart:o};r.Z.set({userId:n,key:s,value:l})}}const s=a},4926:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o(49085).default.createValue(0)},87143:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{active:!1,stringValue:""}}}const i=new r},886:(e,t,o)=>{o.d(t,{Z:()=>j});o(57658);var n=o(14577),r=o(49085),i=o(41432),a=o(76205),s=o(30823),l=o(14714),c=o(99036),d=o(43690),p=o(10070),u=o(8848),m=o(45433),g=o(33147),h=o(6695),f=o(72126),y=o(23014),v=o(21202),b=o(6287),S=o(97880),_=o(45264),w=o(28020),k=o(97004),x=o(81849),I=o(65742),C=o(78316),T=o(77181),M=o(33929),P=o(98165),A=o(94841),D=o(35661);class B extends r.default{constructor(e){super(),this.collectionContextStore=e}getInitialState(){return new Map}getGroupState(e){const t=Array.isArray(e)?e:void 0!==e?[e]:[],o=(0,l.KW)(t),i=this.state.get(o);if(i)return i;const a=function(e,t){const o=r.default.createValue(void 0),i=e.collectionViewBlockStore();if(!i)return;let a;t.length>0?(a=i.clone(),a.setRecordStoreUIParent(i)):a=i;const s=C.bd(e),l=new n.Z((()=>{const e=o.state;return(e&&"results"===e.type?e.blockIds:[]).map((e=>D.G.createChildStore(a,{id:e,table:v.iU})))}),{debugName:"resultsStore"});return{groupsPointer:t,groupUiParentStore:a,reducerResultStore:o,resultsStore:l,currentLimit:r.default.createValue(s),toggleStateStore:r.default.createValue(!1)}}(this.collectionContextStore,t);return a?(this.state.set(o,a),this.emit(),a):void 0}getAllGroupStates(){return[...this.state.values()]}anyGroupHasResults(){for(const e of this.state.values())if(e.reducerResultStore.state)return!0;return!1}anyGroupHasNonEmptyResults(){for(const t of this.state.values()){var e;if(null!==(e=t.reducerResultStore.state)&&void 0!==e&&null!==(e=e.blockIds)&&void 0!==e&&e.length)return!0}return!1}anySpecifiedGroupHasResults(e){for(const t of e){const e=this.getGroupState(t);if(null!=e&&e.reducerResultStore.state)return!0}return!1}resetAllLimits(){const e=C.bd(this.collectionContextStore);for(const t of this.state.values())t.currentLimit.setState(e)}setLimitIfGreater(e,t){const o=this.getGroupState(e),n=null==o?void 0:o.currentLimit;n&&t>n.state&&n.setState(t)}incrementLimit(e){const{isFullScreen:t,currentResultCount:o,groupsPointer:n,incrementLimitsInRelatedGroups:r}=e,i=this.collectionContextStore.collectionViewStore();if(!i)return;const a=this.getGroupState(n);if(!a)return;const s=r?[...this.state.values()].filter((e=>1===n.length?1===e.groupsPointer.length:2===n.length&&(0,l.ZH)(n[0],e.groupsPointer[0]))):[a];for(const l of s){const e=l.currentLimit,n=e.state+C.NG({collectionViewStore:i,isFullScreen:t,currentResultCount:o});e.setState(n)}}}class R extends r.default{getInitialState(){return{hasLocalUpdates:!1,blockIds:new Set}}addLocalChange(e){const t=this.state.blockIds.size;for(const o of e)this.state.blockIds.add(o);t!==this.state.blockIds.size&&(this.state.hasLocalUpdates=!0,this.emit())}resetWithRemote(){const e=this.getInitialState();for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];e.blockIds=new Set(...o),this.setState(e)}}var E=o(77080),F=o(83212);class N{static getLocalViewPreferenceKey(e){return`${N.PREFERENCE_KEY_PREFIX}${e}`}constructor(e){this.context=r.default.createValue(void 0),this.reducers=r.default.createValue({}),this.reducerDependencies=new Map,this.resultSet=new R,this.remoteResult=r.default.createValue(void 0),this.remoteCollectionIds=r.default.createValue([]),this.lastRemoteRequest=r.default.createValue(void 0),this.searchOpen=r.default.createValue(!1),this.searchQuery=r.default.createValue(""),this.isLoading=r.default.createValue(!1),this.isLoaded=r.default.createValue(!1),this.loadingDetails=r.default.createValue({type:"load_general"}),this.wasCreatedThisSession=r.default.createValue(!1),this.isFullScreen=r.default.createValue(!1),this.isRootChild=r.default.createValue(!1),this.isInPeekRenderer=r.default.createValue(!1),this.relativeVariables=r.default.createValue({}),this.groupsStore=new B(this),this.groupsLimit=r.default.createValue(x.XD),this.boardColumnsLimit=r.default.createValue(x.XD),this.settingsStore=r.default.createValue({open:!1,stack:[]}),this.filtersBarOpen=r.default.createValue(void 0),this.temporaryState=r.default.createValue({}),this.filterBarItemSettingsStoreMap=new Map,this.frozoneStore=r.default.createValue({isScrolled:!1,scrollerWidth:void 0,scrollerLeftOffset:void 0,frozenIndex:void 0,tryShowHiddenFrozenColumn:!1}),this.filterBarSortSettingsStore=r.default.createValue({open:!1,stack:[]}),this.filterBarCombinatorFilterSettingsState=r.default.createValue({open:!1,stack:[]}),this.filterOptionsItemSettingsStoreMap=new Map,this.filterOptionsCombinatorFilterSettingsState=r.default.createValue({open:!1,stack:[]}),this.dateRangeStart=r.default.createValue(Date.now()),this.dateRangeEnd=r.default.createValue(Date.now()),this.calendarByMenuOpen=r.default.createValue(!1),this.timelineByMenuOpen=r.default.createValue(!1),this.subitemExpandedStore=r.default.createValue(new Map),this.numberChildrenReceived=r.default.createValue(0),this.numberChildrenUnfurled=r.default.createValue(0),this.renderEmitter=new g.Z,this.remoteRequestStoreCallback=void 0,this.localResultStoreCallback=void 0,this.updateCounter=0,this.isClientModeEnabled=r.default.createValue(!1),this.isViewSpecificClientModeEnabled=r.default.createValue(!1),this.asyncAggregationStatus=r.default.createValue({calculating:!1,aggregation:void 0,changingType:!1}),this.collectionStoresStore=new n.Z((()=>{const e=this.collectionViewBlockStore();if(!e)return[];const t=this.collectionStore();return t?[t]:this.remoteCollectionIds.state.map((t=>D.NW.createChildStore(e,{table:b.v,id:t})))}),{debugName:"collectionStoresStore"}),this.localResultStore=new n.Z((()=>_.pi(this.environment,this)),{useDeepEqual:!0,debugName:"localResultStore"}),this.isEmptyStore=new n.Z((()=>{const e=this.reducers.state;if(this.isLoading.state||this.shouldShowSpinner.state||f.xb(e))return;const t=this.localResultStore.state,o=this.remoteResult.state,n=this.wasCreatedThisSession.state;if(!t&&o&&0===this.collectionStoresStore.state.length)return!0;if(!t||"reducer"!==t.type||!o||"reducer"!==o.type)return;const r=Object.values(t.reducerResults).filter((e=>"results"===e.type)),i=Object.values(o.reducerResults).filter((e=>"results"===e.type));return!n&&0===i.length||0===r.length?void 0:r.every((e=>"results"===e.type&&0===e.blockIds.length))}),{debugName:"isEmptyStore"}),this.remoteRequestStore=new n.Z((()=>_.oh(this.environment,this)),{debugName:"remoteRequestStore"}),this.normalizedFormatStore=new n.Z((()=>{const e=this.collectionViewBlockStore(),t=this.collectionViewStore();if(!e||!t)return{};const o=t.getType(),n=this.normalizedQueryStore.state;if(!o||!n)return{};const r=this.normalizedSchemaStore.state,i=h.iB(t.getFormat(),r,t.getQueryStore().getValue(),h.Dg(o));return(0,w.$A)(e.id,this.isInPeekRenderer.state)?{...i,...(0,A.Vj)()}:i}),{useDeepEqual:!0,debugName:"normalizedFormatStore"}),this.normalizedSchemaStore=new n.Z((()=>{const e=this.context.state;switch(null==e?void 0:e.type){case"collectionTypedView":const t=e.databaseType===m.iS?(0,m.uV)(M.default.getIntl()):{};if(!this.collectionViewBlockStore())return t;const o=this.collectionStoresStore.state;if(0===o.length)return t;const n=(0,p.jf)({schemas:[...o.map((e=>{const t=e.getPropertyMapping(),o=e.getSchema();return p.aQ.toViewSchema(o,t)})),t],onlyPropertyIds:Object.keys(t)});return n.error?t:n.value;case"collectionVirtualView":case"collectionView":case"collectionPage":case"collectionViewBlock":case void 0:const r=this.collectionStore();return r?r.getSchema():c.Kc(M.default.getIntl());default:(0,S.t1)(e)}}),{useDeepEqual:!0,debugName:"normalizedSchemaStore"}),this.normalizedDeletedSchemaStore=new n.Z((()=>{const e=this.collectionStore();return e?e.getDeletedSchema():c.Kc(M.default.getIntl())}),{useDeepEqual:!0,debugName:"normalizedDeletedSchemaStore"}),this.normalizedQueryStore=new n.Z((()=>{const e=this.collectionViewStore();if(e){const t=e.getType();if(t){const o=this.normalizedSchemaStore.state;return(0,d.Qo)({type:t,query2:e.getQueryStore().getValue()},o)}}}),{useDeepEqual:!0,debugName:"normalizedQueryStore"}),this.subitemTreeStore=new n.Z((()=>(0,T.yr)(this,this.environment.currentUser.id)),{debugName:"subitemTreeStore"}),this.shouldShowSpinner=new n.Z((()=>{var e,t,o,n;if(!this.isLoading.state)return!1;const r=null===(e=this.lastRemoteRequest.state)||void 0===e?void 0:e.loader,i=null===(t=this.remoteRequestStore.state)||void 0===t?void 0:t.loader;if(!f.Xy(null==r?void 0:r.filter,null==i?void 0:i.filter))return!0;if(!f.Xy(null==r?void 0:r.sort,null==i?void 0:i.sort))return!0;if(!f.Xy(null==r?void 0:r.searchQuery,null==i?void 0:i.searchQuery))return!0;if(!f.Xy(null===(o=this.lastRemoteRequest.state)||void 0===o?void 0:o.source,null===(n=this.remoteRequestStore.state)||void 0===n?void 0:n.source))return!0;const a=(null==r?void 0:r.reducers)||{},s=(null==i?void 0:i.reducers)||{};for(const l in s){const e=s[l],t=a[l];if(!f.Xy(e,t))return!0}return!1}),{debugName:"shouldShowSpinner"}),this.shouldShowSource=new n.Z((()=>{const e=this.collectionViewBlockStore(),t=this.collectionViewStore(),o=this.collectionStore();if(!e||!t||!o)return!1;return!(e.getCollectionViewSourceCollectionStore()&&this.isFullScreen.state||t.getFormat().hide_linked_collection_name)}),{debugName:"shouldShowSource"}),this.permissionScopes=new n.Z((()=>{const e=this.collectionStore(),t=this.collectionViewStore(),o=this.collectionViewBlockStore(),n=this.isFullScreen.state,r=C.eD({collectionStore:e,collectionViewBlockStore:o,checkNavigableAncestorLocked:!n}),i=Boolean(null==o?void 0:o.isLocked()),a=Boolean(null==e?void 0:e.isSyncedCollection());if(!t||!o)return{canConfigureCollection:r,canConfigureBlock:Boolean((null==o?void 0:o.canEditCollection())&&!o.isLocked()),canEditContent:Boolean((null==o?void 0:o.canEditCollection())||(null==o?void 0:o.canEditContentOnly())),isLocked:i,isSyncedCollection:a};const s=!n&&o.isNavigableAncestorLocked(),l=Boolean(o.inMemoryRecordCache.snapshotData),c=F.Z.getMode(this.environment,o);if(s||l||"comment"===(null==c?void 0:c.permission)||"view"===(null==c?void 0:c.permission))return{canConfigureCollection:r,canConfigureBlock:!1,canEditContent:!1,isLocked:i,isSyncedCollection:a};const d=o.canEditCollection();return{canConfigureCollection:r,canConfigureBlock:Boolean(d&&!i),canEditContent:Boolean(e&&e.canEdit()),isLocked:i,isSyncedCollection:a}}),{debugName:"permissionScopes"}),this.filtersBarOpenStore=new n.Z((()=>{if(this.environment.device.isPhone)return!0;const e=this.filtersBarOpen.state;if(void 0!==e)return e;return this.currentPropertyFiltersStore.state.some((e=>{const t=e.filter;return(0,a.Oo)(t)}))||(0,k.Nq)(this)}),{debugName:"filtersBarOpenStore"}),this.localStateDiffStore=new n.Z((()=>(0,k.Zh)(this,"normalized")),{useDeepEqual:!0,debugName:"localStateDiffStore"}),this.currentCombinatorFilterStore=new n.Z((()=>{var e;const t=this.temporaryState.state.combinatorFilter;return t?t.value:null===(e=this.normalizedQueryStore.state)||void 0===e?void 0:e.filter}),{useDeepEqual:!0,debugName:"currentCombinatorFilterStore"}),this.currentSubitemFormatStore=new n.Z((()=>{var e,t;const o=E.default.checkGate("collection_level_subitems_setting");if(o&&"flattened"===(null===(e=this.collectionViewStore())||void 0===e?void 0:e.getFormat().subitem_display_mode))return;const n=o?(0,T.wf)(this):(0,T.T6)(this),r=null===(t=this.collectionViewStore())||void 0===t?void 0:t.getType(),i=(0,k.RL)({collectionContextStore:this,applySubitemFilter:!1}),s=(0,a.kk)(i);return s&&(0,a.SH)(s,(e=>!!(0,a.aN)(e)&&(e.property===(null==n?void 0:n.property)||e.property===(null==n?void 0:n.inverse))))&&r&&!(0,T.Av)(r)?void 0:n}),{useDeepEqual:!0,debugName:"currentSubitemFormatStore"}),this.currentArrowsByFormatStore=new n.Z((()=>(0,I.H5)(this)),{useDeepEqual:!0,debugName:"currentArrowsByFormatStore"}),this.currentPropertyFiltersStore=new n.Z((()=>{const e=this.normalizedSchemaStore.state,t=this.temporaryState.state.propertyFilters;return(t?t.value||[]:this.normalizedFormatStore.state.property_filters||[]).map((t=>{const o=(0,d.dN)(t.filter,e),n=this.collectionViewBlockStore();if(e[t.filter.property]&&o&&(0,a.J5)(e,t.filter.property,o.filter,null==n?void 0:n.getRecordModel))return o&&{id:t.id,filter:o}})).filter(S.$K)}),{useDeepEqual:!0,debugName:"currentPropertyFiltersStore"}),this.currentSortsStore=new n.Z((()=>{var e;const t=this.temporaryState.state.sorts;return t?t.value||[]:(null===(e=this.normalizedQueryStore.state)||void 0===e?void 0:e.sort)||[]}),{useDeepEqual:!0,debugName:"currentSortsStore"}),this.blockIsPrivateStore=new n.Z((()=>{const e=this.collectionViewBlockStore();if(e)return(0,P.RC)({environment:this.environment,store:e})}),{debugName:"blockIsPrivateStore"}),this.inheritedBlockColorStore=new n.Z((()=>{const e=this.collectionViewBlockStore(),{ThemeModeStore:t}=this.environment;if(!e)return;const o=e.findRecordStoreUIAncestor((e=>Boolean(e instanceof D.G&&e.getRecordStoreUIParent()&&e.getFormat().block_color&&!e.isCollectionView()))).ancestor;if(o&&o instanceof D.G){const e=o.getType(),n=o.getFormat().block_color;if(n){const o=(0,u.gh)({theme:t.state});return e===i.Ti.callout?(0,u.x7)(n,o):(0,u.fi)(n,o)}}}),{useDeepEqual:!0,debugName:"inheritedBlockColorStore"}),this.defaultPageTemplateStore=new n.Z((()=>{var e,t;const o=this.collectionStore(),n=this.collectionViewStore(),r=f.oA([null==n||null===(e=n.getFormat())||void 0===e?void 0:e.collection_view_default_template,null==o||null===(t=o.getFormat())||void 0===t?void 0:t.collection_default_template]),i=null==o?void 0:o.getTemplatePageStores();for(const a of r){if("empty"===a)return;const e=null==i?void 0:i.find((e=>e.id===a.template_page_id));if(null!=e&&e.getAlive())return e}}),{debugName:"defaultPageTemplateStore"}),this.relativeVariableStore=new n.Z((()=>{const e=this.context.state;if(!e)return;const t=e.collectionViewBlockStore;if(!t)return;const o={},n=this.relativeVariables.state;return Object.entries(n).map((e=>{let[n,r]=e;const i=D.NW.createChildStore(t,{id:n,table:b.v}),l=i.getSchema(),c=null==i?void 0:i.getFormat().app_config_uri;c&&(0,y.oN)(l,c)&&(o[n]={},Object.entries(r).map((e=>{var t;let[r,d]=e;const p=D.G.createChildStore(i,{id:d,table:v.iU});if((null===(t=p.getAssociatedCollectionStore())||void 0===t?void 0:t.id)!==n)return;const u=y.qB[c][r].reducer,m=u.getProperty(),g=l[m],h=p.getPropertyValue(m),f=u.getPropertyFilter(l,r);(0,a.CA)({filter:f,filterType:"status",relativeVariableValues:void 0})((0,s.yK)({propertySchema:g,propertyValue:h}))&&(o[n][r]=d)})))})),o}),{useDeepEqual:!0,debugName:"relativeVariableStore"}),this.aliveAutomationCount=new n.Z((()=>{const e=this.collectionStore();if(!e)return 0;const t=e.getAutomationStores();let o=0;for(const n of t)(n.isTriggerType("notification_event")||n.isTriggerType("event"))&&n.getAlive()&&(o+=1);return o}),{debugName:"aliceAutomationCount"}),this.aliveSlackAutomationCount=new n.Z((()=>{const e=this.collectionStore();if(!e)return 0;const t=e.getAutomationStores();let o=0;for(const n of t)n.isTriggerType("notification_event")&&n.getAlive()&&(o+=1);return o}),{debugName:"aliveSlackAutomationCount"}),this.getCompleteSprintButtonContext=new n.Z((()=>{var e,t;const o=this.collectionViewBlockStore();if(!o)return;if((null===(e=this.collectionViewStore())||void 0===e?void 0:e.getFormatStore().getKeyStore("app_config_uri").getValue())!==m.g3)return;const n=this.collectionStore(),r=null==n?void 0:n.getSchemaStore().getKeyStore(m.Es.TaskToSprintRelation).getValue();if(!r)return;if("relation"!==r.type)return;const i=r.collection_pointer;if(!n||!i)return;const a=this.getAutomationCollectionValue(n),s=D.NW.createChildStore(o,i),l=this.getAutomationCollectionValue(s);if(!n.canEdit()||!s.canEdit())return;const c=null==l||null===(t=l.format)||void 0===t?void 0:t.app_config_uri,d=s.getSchema();return c&&y.qB[c]&&(0,y.oN)(d,c)&&a&&l?{blockStore:o,taskCollectionStore:n,taskCollectionValue:a,sprintCollectionStore:s,sprintCollectionValue:l,sprintCollectionSchema:d}:void 0}),{useDeepEqual:!0,debugName:"getCompleteSprintButtonContext"}),this.getSprintSettingsContext=new n.Z((()=>{const e=this.collectionViewBlockStore();if(!e)return;if(this.databaseType!==m.p$&&this.databaseType!==m.iS)return;const t=this.collectionStore();let o;this.databaseType===m.p$?o=m.b0.SprintToTaskRelation:this.databaseType===m.iS?o=m.Es.TaskToSprintRelation:(0,S.t1)(this.databaseType);const n=null==t?void 0:t.getSchemaStore().getKeyStore(o).getValue();if(!n||"relation"!==n.type)return;const r=n.collection_pointer;if(!t||!r)return;const i=D.NW.createChildStore(e,r);let a,s;return this.databaseType===m.p$?(s=t,a=i):this.databaseType===m.iS?(a=t,s=i):(0,S.t1)(this.databaseType),{taskCollectionStore:a,sprintCollectionStore:s}}),{useDeepEqual:!0,debugName:"getSprintSettingsContext"}),this.initialDatabaseItemsVisibleTracker=void 0,this.onItemMount=()=>{var e;null===(e=this.initialDatabaseItemsVisibleTracker)||void 0===e||e.handleItemMount()},this.environment=e}setContext(e){this.context.setState(e)}get contextType(){var e;return null===(e=this.context.state)||void 0===e?void 0:e.type}get databaseType(){const e=this.context.state;if(e){if("collectionTypedView"===e.type)return e.databaseType;if("collectionView"===e.type){const t=e.collectionStore;return null==t?void 0:t.getDatabaseType()}}}collectionViewStore(){const e=this.context.state,t=null==e?void 0:e.type;if(t)switch(t){case"collectionTypedView":case"collectionView":case"collectionVirtualView":return e.collectionViewStore;case"collectionPage":case"collectionViewBlock":return;default:(0,S.t1)(t)}}collectionStore(){const e=this.context.state;if(e&&"collectionTypedView"!==e.type)return"collectionVirtualView"===e.type||"collectionView"===(null==e?void 0:e.type)||"collectionPage"===(null==e?void 0:e.type)?e.collectionStore:void("collectionViewBlock"!==(null==e?void 0:e.type)&&(0,S.t1)(e))}hasSingleCollection(){switch(this.contextType){case"collectionTypedView":case"collectionVirtualView":return!1;case"collectionPage":case"collectionViewBlock":case"collectionView":case void 0:return!0;default:(0,S.t1)(this.contextType)}}collectionViewBlockStore(){const e=this.context.state;return null==e?void 0:e.collectionViewBlockStore}formatStore(){const e=this.context.state;if(e)return"collectionPage"===e.type?e.collectionStore:"collectionView"===e.type||"collectionTypedView"===e.type||"collectionVirtualView"===e.type?e.collectionViewStore:void("collectionViewBlock"!==e.type&&(0,S.t1)(e))}getPropertyFormatKey(){const e=this.context.state;if("collectionPage"===(null==e?void 0:e.type))return"collection_page_properties";if("collectionView"===(null==e?void 0:e.type)||"collectionTypedView"===(null==e?void 0:e.type)){const t=e.collectionViewStore.getType();if(!t)return;return h.oz(t)}}getPropertyFormat(e){var t;const o=null===(t=this.formatStore())||void 0===t?void 0:t.getFormat(),n=null==this?void 0:this.getPropertyFormatKey();if(!o||!n)return;return(o[n]??[]).find((t=>t.property===e))}createUpdateCounter(){return this.updateCounter++,this.updateCounter}shouldUpdate(e){return this.updateCounter===e}getCurrentUserId(){return this.environment.currentUser.id}getViewType(){const e=this.collectionViewStore();if(null!=e&&e.isDefined())return e.getType();const t=this.context.state;return"collectionPage"===(null==t?void 0:t.type)?"page":void 0}currentViewHasSort(){const e=this.normalizedQueryStore.state;return Boolean(e&&e.sort&&e.sort.length>0)}resetLoadingState(){this.isLoading.setState(!1),this.loadingDetails.reset()}getCollectionViewBlockSourceState(){const e=this.collectionViewBlockStore();if(!e)return"uninitialized";if(e.getCollectionViewSourceCollectionStore())return"source";return e.getCollectionViewStores().some((e=>Boolean(e.getCollectionStore())))?"linked":"uninitialized"}getFilterBarItemSettingsStore(e){let t=this.filterBarItemSettingsStoreMap.get(e.id);return t||(t=r.default.createValue({open:!1,stack:[]}),this.filterBarItemSettingsStoreMap.set(e.id,t)),t}getFilterOptionsItemSettingsStore(e){let t=this.filterOptionsItemSettingsStoreMap.get(e.id);return t||(t=r.default.createValue({open:!1,stack:[]}),this.filterOptionsItemSettingsStoreMap.set(e.id,t)),t}viewIsFlushToTopbar(){if(!this.collectionStore())return!1;if(this.shouldShowSource.state)return!1;if(this.filtersBarOpenStore.state)return!1;return void 0===this.getCompleteSprintButtonContext.state}shouldAllowNewItemCreation(e){const t=this.permissionScopes.state,o="collectionTypedView"===this.contextType;return!t.isSyncedCollection&&(t.canEditContent||o&&(null==e?void 0:e.overrideAllowForTypedViews))}getAutomationCollectionValue(e){if(e.isDefined())return{id:e.id,space_id:e.getSpaceId(),schema:e.getSchema(),format:e.getFormat()}}getPageVisitSourceOverride(){var e;switch(null===(e=this.context.state)||void 0===e?void 0:e.type){case"collectionTypedView":case"collectionVirtualView":return this.context.state.pageVisitSourceOverride;case"collectionPage":case"collectionView":case"collectionViewBlock":case void 0:return;default:(0,S.t1)(this.context.state)}}resultsInViewOrder(e){var t,o;const n=this.collectionViewBlockStore(),r=this.collectionStore();if(!n||!r)return[];const i=this.normalizedFormatStore.state,a="board"===this.getViewType()?{groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}:{groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},s=this.normalizedSchemaStore.state,c=i[a.groupByKey],d=(0,S.$K)(c)?(0,l.Qq)({schema:s,groupBy:c}):[],p=Object.values((null===(t=this.localResultStore.state)||void 0===t?void 0:t.reducerResults)??{}).find((e=>"groups"===e.type)),u=(0,x.Cz)({getRecordModel:n.getRecordModel,schema:s,groupBy:c,formatGroups:i[a.groupsFormatKey]??[],schemaGroups:d,reducerResults:(null==p?void 0:p.results)??[],relativeVariableResult:this.relativeVariableStore.state,viewAppConfigUri:null===(o=this.collectionViewStore())||void 0===o?void 0:o.getFormat().app_config_uri});let m;if(0===u.length){const e=this.localResultStore.state;if(e){const t=Object.values(e.reducerResults).find((e=>"results"===e.type));m=((null==t?void 0:t.blockIds)??[]).map((e=>D.G.createChildStore(r,{table:"block",id:e})))}else m=[]}else{m=[];for(const e of u){const t=this.groupsStore.getGroupState(e),o=null==t?void 0:t.resultsStore.state;m.push(...o??[])}}m=f.mN(m,(e=>e.id));const g=e||5;let h;if(this.currentSubitemFormatStore.state){h=[];const e=this.subitemTreeStore.state;for(const t of m){if(h.length>=g)break;const o=e.children.find((e=>e.value.store.id===t.id));if(o){const e=[];(0,T.yU)({results:e,tree:o}),h.push(...e)}}}else h=m;return h.slice(0,g)}}N.PREFERENCE_KEY_PREFIX="CollectionView:",N.incrementScrollOffset=600;const j=N},58421:(e,t,o)=>{o.d(t,{n:()=>r});var n=o(72126);function r(e){const t=e.state;return n.Z$(t.stack)}},6776:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(72126);class i extends n.default{getInitialState(){return{editMode:void 0,store:void 0}}cloneState(){return r.d9(this.state)}}const a=new i},19511:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(72126);class i extends n.default{getInitialState(){return{isActive:!1}}cloneState(){return r.d9(this.state)}}const a=new i},16772:(e,t,o)=>{o.r(t),o.d(t,{default:()=>a});o(21703);var n=o(49085),r=o(12139);class i extends n.default{constructor(){super(...arguments),this.lastUpdater=0}getInitialState(){return{type:"closed"}}setState(e){if("completionPopup"===this.state.type&&"results"===this.state.stage&&("completionPopup"!==e.type||"results"!==e.stage)){const{inMemoryRecordCache:e,context:t}=this.state;if(e.cacheUsingThisInstanceAsAnOverride){const o=`CompletionsStore transitioning away from completionPopup results while inMemoryRecord cache is still overriding ${e.cacheUsingThisInstanceAsAnOverride===t.currentPage.inMemoryRecordCache?"page's in-memory cache":"an unknown cache"}!`;r.rn(new Error(o),{from:"CompletionsStore",type:"dangerousStateTransition"})}}super.setState(e)}createUpdater(){const e=++this.lastUpdater;return t=>{if(e===this.lastUpdater)return t()}}invalidateLastUpdater(){this.lastUpdater+=1}resetStore(e){const{environment:t}=e;this.invalidateLastUpdater();const o=this.state;"completionPopup"===o.type&&("initialPromptForAIBlock"!==o.stage&&"initialPrompt"!==o.stage&&t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(o.inMemoryRecordCache),this.setState({type:"closed"}))}getExistingSessionId(){return"closed"!==this.state.type?this.state.sessionId:void 0}isEditingEmptyBlock(){var e;const t=this.state;return Boolean("completionPopup"===t.type&&"initialPrompt"===t.stage&&"cursor"===t.context.type&&(null===(e=t.context.currentBlock)||void 0===e?void 0:e.isEmptyEditableBlock()))}}const a=new i},72371:(e,t,o)=>{o.d(t,{Z:()=>l});var n=o(14577),r=o(49085),i=o(92595);class a extends r.default{constructor(){super(...arguments),this.integrations=new n.Z((()=>{const e=this.state;return e.loaded?e.integrations:[]}),{debugName:"ComplianceIntegrationStore.integrations"}),this.webhookSubscriptions=new n.Z((()=>{const e=this.state;return e.loaded?e.webhookSubscriptions:[]}),{debugName:"ComplianceIntegrationStore.webhookSubscriptions"})}getInitialState(){return{loaded:!1,loading:!1}}}const s=new a;(0,i.exposeDebugValue)("ComplianceIntegrationStore",s);const l=s},81700:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},80641:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{bypassedPageIds:new Set}}bypassedPage(e){return this.state.bypassedPageIds.has(e)}bypassPage(e){this.state.bypassedPageIds.add(e),this.emit()}}const i=new r},61893:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085),r=o(86658),i=o(12955);class a extends n.default{getInitialState(){return{permission:r.UE}}getId(){return this.getState().id}getPermission(){return this.getState().permission}setPermission(e){this.setState({...this.state,permission:e})}async setCookieConsent(e,t){this.setState(t),await(0,i.setCookieConsentCookie)(e,t)}clearCookieConsent(){this.reset(),(0,i.removeCookieConsentCookie)()}}const s=new a},45293:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},56681:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{pageId:void 0,lastInteractionTimes:{}}}}const i=new r},28748:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},82246:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61364).Z)},55367:(e,t,o)=>{o.d(t,{Dl:()=>i,ZP:()=>s,vh:()=>r});var n=o(49085);let r=function(e){return e[e.Above=0]="Above",e[e.Below=1]="Below",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Onto=4]="Onto",e}({}),i=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}({});class a extends n.default{getInitialState(){return{isDragging:!1}}}const s=new a},45452:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isDragging:!1,willDrag:!1}}}const i=r},10084:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(72126);class i extends n.default{getInitialState(){return{initiator:"none",dragging:!1,waiting:!1}}hasDragged(){return this.state.dragging&&!r.Xy(this.state.startingPoint,this.state.currentPoint)}}const a=i},80796:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{initiator:"none",isDragging:!1,disableVerticalEdgeScroll:!1,disableHorizontalEdgeScroll:!1}}}const i=new r},12211:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085),r=o(92595);class i extends n.default{getInitialState(){return{dropTargetRectMap:new Map}}}const a=new i;(0,r.exposeDebugValue)("GlobalDropTargetRectStore",a);const s=a},24042:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isTabsFeatureEnabled:!1}}}const i=new r},64233:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},66949:(e,t,o)=>{o.d(t,{P:()=>i,Z:()=>l});var n=o(49085),r=o(92595);let i=function(e){return e.Forward="Forward",e.Backward="Backward",e}({});class a extends n.default{getInitialState(){return{open:!1}}isOpen(){if(this.state.open){this.state;return!0}return!1}}const s=new a;r.exposeDebugValue("EquationAnnotationStore",s);const l=s},77080:(e,t,o)=>{o.r(t),o.d(t,{default:()=>v,localExperimentsV2Key:()=>f});var n=o(14577),r=o(49085);var i=o(12174),a=o(68626),s=o(15157),l=o(72126),c=o(97715),d=o(34886),p=o(97880),u=o(95477),m=o(64496),g=o(80444),h=o(7339);const f="experimentsSettingsV2";class y extends r.default{getInitialState(){return{isLoaded:!1}}updateState(e,t){!e.test&&this.state.isLoaded&&this.state.test||(this.setState(e),(0,m._3)(t)||s.Z.set({userId:e.userId,key:f,value:e}))}setState(e){super.setState(e)}getExperimentsForCurrentSpace(){if(!this.state.isLoaded)return[];if(this.state.test)return this.state.experiments;const e=g.default.state.currentSpaceStore;return e&&this.state.experimentsBySpace[e.id]||this.state.experimentsWithoutSpace}getGroup(e){if(i.TS.has(e))return c.Le;let t;if(this.state.isLoaded){const o=this.getExperimentsForCurrentSpace().find((t=>t.experimentId===e));if(!o)return c.Le;t=o.group}return t||c.Le}getExperimentsMap(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{e[t.experimentId]=t.group})),e}getExperiments(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{e[t.experimentId]=t})),Object.values(e)}getUsedNonControlExperimentsMap(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{"control"!==t.group&&(0,i.DP)(t.experimentId)&&(e[t.experimentId]=t.group)})),e}getAcceptLanguageHeader(){if(this.state.isLoaded)return this.state.acceptLanguageHeader}}const v=new class extends y{constructor(){super(),this.statsigExposureCacheForAnalytics={},this.computedStoreMap=new Map,this.isStatsigEnabled()&&h.C.addListener((()=>{this.recomputeAllGroupStores()}))}isStatsigEnabled(){var e;return Boolean(null===(e=u.default.statsig)||void 0===e?void 0:e.apiKey)}isStatsigEnabledAndInitialized(){return this.isStatsigEnabled()&&h.C.isInitialized()}isLoaded(){return this.state.isLoaded}getGroup(e,t){if(!(0,i.YY)(e)){return this.createComputedGroupStore(`group-${e}`,(()=>super.getGroup(e))).state.group||c.Le}return this.getEligibleGroup({experimentId:e,defaultGroup:c.Le,disableExposureLogging:null==t?void 0:t.disableExposureLogging})}getEligibleGroup(e){const{experimentId:t,defaultGroup:o,parameter:n=h.Z,disableExposureLogging:r=!1}=e,i=n===h.Z;this.state.isLoaded;const a=`eligible-group-${t}-${n}`;return this.createComputedGroupStore(a,(()=>{if(!this.isStatsigEnabledAndInitialized())return;const e=this.validateGroupIsString(h.C.getGroup(t,r));return void 0!==e&&(this.statsigExposureCacheForAnalytics[`statsig-${t}`]=e),i?e:h.C.getGroup(t,r,n,o)})).state.group??o}manuallyLogExperimentExposure(e){h.C.manuallyLogExperimentExposure(e)}checkGate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=this.getFeatureGateOverrideForBrowserTest(e);if((0,p.$K)(o))return o;const n=this.getFeatureGateOverrideForUnitTest(e);if((0,p.$K)(n))return n;return this.createComputedGateStore(e,(()=>{if(!this.isStatsigEnabledAndInitialized())return!1;const o=h.C.checkGate(e,t);return this.statsigExposureCacheForAnalytics[`statsig-${e}`]=o,o})).state.gate}getConfigKey(e,t,o){const n=i.LI[e][t];return this.createComputedDynamicConfigKeyStore(e,t,(()=>{var r;return this.isStatsigEnabledAndInitialized()&&(null===(r=h.C.getConfig(e,o))||void 0===r?void 0:r.get(String(t),n))||n})).state.value}logEvent(e,t,o){return this.isStatsigEnabledAndInitialized()?h.C.logEvent(e,t,(0,d.R)(o)):(a.log({level:"error",from:"ExperimentStore.ts",type:"statsigIsNotInitialized",data:{miscDataToConvertToString:{eventName:e,value:t,metadata:(0,d.R)(o),isStatsigEnabled:this.isStatsigEnabled(),isInitialized:h.C.isInitialized()}}}),!1)}getExperimentsMap(){return{...super.getExperimentsMap(),...this.statsigExposureCacheForAnalytics}}getStatsigExperimentsMap(){return this.statsigExposureCacheForAnalytics}updateState(e,t){(void 0===e.userId||this.state.isLoaded&&this.state.userId!==e.userId)&&(this.statsigExposureCacheForAnalytics={}),super.updateState(e,t)}reset(){super.reset(),this.statsigExposureCacheForAnalytics={},this.recomputeAllGroupStores()}async waitUntilStatsigReady(){this.isStatsigEnabled()&&await h.C.waitUntil((()=>h.C.state.ready))}createComputedGroupStore(e,t){return this.createComputedStore(e,(()=>({group:t(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedGateStore(e,t){return this.createComputedStore(`gate-${e}`,(()=>({gate:t(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedDynamicConfigKeyStore(e,t,o){return this.createComputedStore(`config-${e}-${String(t)}`,(()=>({value:o(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedStore(e,t){const o=(new Date).getMinutes();let r=this.computedStoreMap.get(e);return r?r.state.lastUpdatedMinute!==o&&r.setShouldRecompute():(r=new n.Z(t,{debugName:`ExperimentStore.${e}`}),r.addListener(l.yR),this.computedStoreMap.set(e,r)),r}recomputeAllGroupStores(){this.computedStoreMap.forEach((e=>{e.enqueueRecompute()}))}getFeatureGateOverrideForBrowserTest(e){}getFeatureGateOverrideForUnitTest(e){}validateGroupIsString(e){return"string"==typeof e?e:void 0}}},30874:(e,t,o)=>{o.d(t,{Z:()=>p});var n=o(14577),r=o(49085),i=o(92595),a=o(45953),s=o(77420),l=o(9844);class c extends r.default{constructor(){super(...arguments),this.integrations=new n.Z((()=>{const e=this.state;return e.loaded?e.integrations:[]}),{debugName:"ExternalIntegrationStore.integrations"}),this.bots=new n.Z((()=>{const e=this.state;return e.loaded?e.bots:[]}),{debugName:"ExternalIntegrationStore.bots"}),this.externalAuthentications=new n.Z((()=>{const e=this.state;return e.loaded?e.externalAuthentications:[]}),{debugName:"ExternalIntegrationStore.externalAuthentications"}),this.completeSlackAuthentications=new n.Z((()=>{const e=this.state;return e.loaded?e.completeSlackAuthentications:[]}),{debugName:"ExternalIntegrationStore.completeSlackAuthentications"})}getInitialState(){return{loaded:!1,loading:!1}}getIntegrationsAsRecordMap(){const e=a.Ak.create();return this.integrations.state.forEach((t=>e.setValue({table:l.K2,id:t.id},t))),e}getBotsAsRecordMap(){const e=a.Ak.create();return this.bots.state.forEach((t=>e.setValue({table:s.cZ,id:t.id},t))),e}}const d=new c;(0,i.exposeDebugValue)("ExternalIntegrationStore",d);const p=d},79167:(e,t,o)=>{o.d(t,{Z:()=>h});var n=o(49085),r=o(41432),i=o(77657),a=o(72126),s=o(45953),l=o(21202),c=o(77420),d=o(6287),p=o(97880),u=o(63143),m=o(30874);class g extends n.default{getInitialState(){return{externalObjectInstanceBlockPointersMap:{},externalCollectionInstancePointersMap:{}}}addFromRecordMapWithRoleJson(e){this.addFromRecordMapWithRole(s.PF.create(e))}addFromRecordMapWithRole(e){const t=e.getByTable(d.v).filter((e=>{var t;let{value:o}=e;return null==o||null===(t=o.value)||void 0===t||null===(t=t.format)||void 0===t?void 0:t.external_object_id})).map((e=>{let{value:t}=e;return(null==t?void 0:t.value)&&{id:t.value.id,table:d.v,spaceId:t.value.space_id}})).filter(p.$K),o=m.Z.getBotsAsRecordMap(),n=e.getByTable(l.iU).filter((e=>{let{value:t}=e;if(!(t&&t.value&&t.value.format&&t.value.format.external_object_id))return!1;if(t.value.type!==r.Ti.externalObjectInstancePage&&t.value.type!==r.Ti.externalObjectInstance)return!1;const n=t.value.format.bot_id;if(!n)return!1;if(!0===m.Z.state.loaded){const e=o.getValue({table:c.cZ,id:n});if(e&&e.integration_id&&e.integration_id===i.U9)return!1}return!0})).map((e=>{let{value:t}=e;return null==t?void 0:t.value})).filter(p.$K),s=a.oA(n.map((e=>{if(e.type===r.Ti.externalObjectInstancePage&&e.parent_table===d.v)return{id:e.parent_id,table:e.parent_table,spaceId:e.space_id}}))),g=(0,u.m8)(n.map((e=>{const t={id:e.id,table:l.iU,spaceId:e.space_id};return[e.id,t]}))),h=(0,u.m8)([...t,...s].map((e=>[e.id,e])));this.setState({externalObjectInstanceBlockPointersMap:{...this.state.externalObjectInstanceBlockPointersMap,...g},externalCollectionInstancePointersMap:{...this.state.externalCollectionInstancePointersMap,...h}})}reset(){this.setState({externalObjectInstanceBlockPointersMap:{},externalCollectionInstancePointersMap:{}})}isEmpty(){return 0===Object.keys(this.state.externalCollectionInstancePointersMap).length&&0===Object.keys(this.state.externalObjectInstanceBlockPointersMap).length}}const h=new g},83279:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isLoading:!1,progressPercent:0}}}const i=r},69316:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1,findQuery:""}}}const i=new r},89256:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},73329:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(8297).Z)},17903:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(92595);const r=new(o(45589).Z);(0,n.exposeDebugValue)("FrameScrollerStore",r);const i=r},61738:(e,t,o)=>{o.d(t,{Z:()=>c});var n=o(97880);var r=o(92595),i=o(35683),a=o(80444);const s=new class{constructor(){this.frecencyStore=void 0,this.spaceId=void 0,this.userId=void 0}get(e){const{currentSpaceStore:t}=a.default.state,o=t&&t.id;return void 0===o||void 0===e?(this.userId=void 0,this.spaceId=void 0,void(this.frecencyStore=void 0)):(this.spaceId===o&&this.userId===e||(this.spaceId=o,this.userId=e,this.frecencyStore=new i._R({store:localStorage,prefix:`BlockFrecency:${e}:${o}`,maxBlocks:100,maxStoredVisits:10,version:i.uP}),this.frecencyStore.initialize()),this.frecencyStore)}};const l={lazyFrecencyStore:s,recordVisit:e=>{const{id:t,type:o,timestampForTestingOnly:r,currentUserId:i,systemBlockType:a}=e;if(function(e){switch(e){case"home_main":case"home_trending":case"home_similar_users":case"home_my_tasks":return!0;case void 0:return!1;default:(0,n.t1)(e)}}(a))return;const l=s.get(i);return l?l.recordVisit({id:t,type:o,timestampForTestingOnly:r}):void 0},sortFrecencyHighToLow:function(e){const{currentUserId:t,items:o,now:n,recordFrecency:r}=e,i=s.get(t);return i?i.sortFrecencyHighToLow({items:o,now:n,recordFrecency:r}):o},getVisitedIds:e=>{const t=s.get(e);return t?t.getVisitedIds():[]},clearForUser:function(e){for(let t=0;t<localStorage.length;t++){const o=localStorage.key(t);o&&o.startsWith(`BlockFrecency:${e}`)&&localStorage.removeItem(o)}}};(0,r.exposeDebugValue)("FrecencyStore",l);const c=l},38302:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085),r=o(92595);class i extends n.default{getInitialState(){return{isOpen:!1,backgroundAnimationComplete:!0,fullscreenNodeAnimationComplete:!0,startScrollTop:0,skipAnimations:!1,isSaving:!1,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}}}}const a=new i;(0,r.exposeDebugValue)("GlobalFullScreenStore",a);const s=a},81258:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61766).Z)},73796:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},27411:(e,t,o)=>{o.r(t),o.d(t,{GlobalFileUploadStore:()=>r,default:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{}}getKeyState(e){return this.state[e]}setKeyState(e,t){const o=this.state;let n;if(t){var r;const a=t.file.type.indexOf("image")>=0;var i;if(t.file!==(null===(r=o[e])||void 0===r?void 0:r.file)&&a)n=null===(i=o[e])||void 0===i?void 0:i.dataURL,t.dataURL=URL.createObjectURL(t.file);o[e]={...t,dataURL:t.dataURL}}else{var a;n=null===(a=o[e])||void 0===a?void 0:a.dataURL,delete o[e]}if(n){const e=n;setTimeout((()=>{URL.revokeObjectURL(e)}),1e3)}this.emit()}isUploading(){const e=this.state,t=Object.keys(e);for(const o of t){if(e[o])return!0}return!1}getBlockKey(e){return e}}const i=new r},96049:(e,t,o)=>{o.d(t,{Z:()=>l});var n=o(14577),r=o(55367),i=o(80796),a=o(69784),s=o(59238);const l=new n.Z((()=>i.Z.state.isDragging||r.ZP.state.isDragging||s.Z.state.isDragging||a.Z.state.isActive),{debugName:"GlobalIsDraggingStore"})},45483:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085),r=o(92595);class i extends n.default{getInitialState(){return{openModals:new Set}}}const a=new i,s=a;(0,r.exposeDebugValue)("GlobalModalStore",a)},3418:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{openPopups:new Set,namedOpenPopups:new Set}}hasOpenPopups(){const{openPopups:e,namedOpenPopups:t}=this.getState();return e.size>0||t.size>0}hasOpenMobileSlideUps(){const{openPopups:e,namedOpenPopups:t}=this.getState();if(t.size>0)return!0;for(const o of e){if(o.props.hidesMobileNativeBottomBar)return!0;if(o.isSlideUp(o.props)&&!o.props.preventSlideUpTransition)return!0}return!1}hasOpenMouseCapturePopup(){const{openPopups:e}=this.state;return e.size>0&&Array.from(e.values()).some((e=>!e.props.disableMouseCapture))}closeAll(){for(const o of this.state.openPopups){var e,t;null===(e=(t=o.props).onDismiss)||void 0===e||e.call(t,null)}}addNamedPopup(e){this.state.namedOpenPopups.add(e),this.emit()}removeNamedPopup(e){this.state.namedOpenPopups.delete(e),this.emit()}}const i=new r},69327:(e,t,o)=>{o.d(t,{Z:()=>g});var n=o(18466),r=o(49085),i=o(72126),a=o(44615),s=o(21202),l=o(63143),c=o(15447),d=o(2688),p=o(80444),u=o(35661);class m extends r.default{constructor(){super(...arguments),this.userPageVisitListenerReference=void 0,this.recentPageRefreshTimer=void 0,this.isInitialized=!1,this.reinitializeState=async(e,t,o)=>{this.cleanup(e),await(0,c.h_)({environment:e,userId:t,spaceId:o}),this.isInitialized=!0;const n=5*l.hM;this.recentPageRefreshTimer=window.setTimeout((()=>{(0,c.h_)({environment:e,userId:t,spaceId:o})}),n),this.userPageVisitListenerReference=d.Z.addListener((0,a.Ns)(t),i.P2(((e,o)=>(0,c.rw)(t,o)),100),void 0,e)}}getInitialState(){return{recentPages:new Map}}cleanup(e){this.userPageVisitListenerReference&&(d.Z.removeListener(this.userPageVisitListenerReference,e),this.userPageVisitListenerReference=void 0),this.recentPageRefreshTimer&&(clearTimeout(this.recentPageRefreshTimer),this.recentPageRefreshTimer=void 0)}getRecentPagesWithStores(e,t){const o=p.default.state.currentSpaceStore;return o?t.map((t=>({...t,store:u.G.createChildStore(o.getPagesStore(),{table:s.iU,id:t.pageId,spaceId:e})}))):[]}set(e,t){const o=this.getRecentPagesWithStores(e,t);this.update((t=>(t.recentPages.set(e,o),t))),this.emit()}get(e){return this.state.recentPages.get(e)}getWithoutSubscribing(e){return n.Z.withListenerIgnored((()=>this.get(e)))||[]}mergeRecentPages(e,t){const o=this.getRecentPagesWithStores(t,e),n=(this.state.recentPages.get(t)??[]).concat(o),r=i.mN(n,"pageId");this.set(t,r)}}const g=new m},7844:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},475:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61766).Z)},52689:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085),r=o(54153);const i="currentHighlightColor";class a extends n.default{getInitialState(){return{color:Boolean(localStorage)&&r.Z.get(i)||"yellow_background"}}setHighlightColor(e){r.Z.set(i,e),this.setState({color:e})}}const s=new a},42653:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isPinned:!1}}}const i=new r},20144:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{}}}const i=new r},65686:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(34859);class i extends n.default{getInitialState(){return{capturingAreas:new Set}}getPreventScrollType(){let e=!1,t=!1,o=!1;return this.state.capturingAreas.forEach((n=>{n.props.preventType===r.Z.All?e=!0:n.props.preventType===r.Z.X?t=!0:n.props.preventType===r.Z.Y&&(o=!0)})),e||t&&o?r.Z.All:t?r.Z.X:o?r.Z.Y:r.Z.None}}const a=new i},41577:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{loaded:!1,error:!1}}}const i=r},94416:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},95424:(e,t,o)=>{o.d(t,{H:()=>a});var n=o(92595),r=o(54153),i=o(63143);class a{static getNumber(e){const t=r.Z.get(e);if("number"==typeof t&&!isNaN(t))return t}static getLatest(){return this.getNumber(this.LAST_TIMEOUT_STORAGE_KEY)}static trackPersistently(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();r.Z.set(this.LAST_TIMEOUT_STORAGE_KEY,e);const t=this.getTotal()??0;r.Z.set(this.TOTAL_TIMEOUTS_STORAGE_KEY,t+1)}static getTotal(){return this.getNumber(this.TOTAL_TIMEOUTS_STORAGE_KEY)}static clear(){r.Z.remove(this.LAST_TIMEOUT_STORAGE_KEY),r.Z.remove(this.TOTAL_TIMEOUTS_STORAGE_KEY)}static hasOccurredRecently(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();const t=this.getLatest();return"number"==typeof t&&e-t<this.RECENT_TIME_WINDOW_MS}}a.LAST_TIMEOUT_STORAGE_KEY="latestNotionTransactionTimeout",a.TOTAL_TIMEOUTS_STORAGE_KEY="totalNotionTransactionTimeouts",a.RECENT_TIME_WINDOW_MS=7*i.A0,(0,n.exposeDebugValue)("IndexedDBTimeoutTracker",a)},96826:(e,t,o)=>{o.d(t,{Z:()=>k});var n,r=o(54064),i=o(68626),a=o(72126),s=o(91155),l=o(29477),c=o(606),d=o(12139),p=o(63143),u=(o(95477),o(21830)),m=o(15517),g=o(2414),h=o(63037),f=o(88632),y=o(77080),v=o(99757),b=o(26634),S=o(9425);class _{constructor(e){this.debug=!1,this.shouldStopLooping=!1,this.attemptedToClaimSessions=!1,this.isProcessingTask=!1,this.lastTaskTimestamp=0,this.events=new r.Z,this.waiter=void 0,this.transactionBackoffController=new g.h(b._W),this.retryReasonCounters={_total:0},this.errorCounts={},this.startTime=Date.now(),this.disableStorageManagerEstimate=!1,this.dependencies=void 0,this.transactionStore=void 0,this.sessionId=void 0,this.debugLogger=void 0,this.enableHeartbeatTimeout=void 0;const{dependencies:t,transactionStore:o,sessionId:n,debugLogger:a,enableHeartbeatTimeout:s}=e;this.dependencies=t,this.transactionStore=o,this.sessionId=n,this.debugLogger=a,this.enableHeartbeatTimeout=s,i.clientLogglyEnvironmentData.idbSessionId=this.sessionId,this.disableStorageManagerEstimate=y.default.checkGate("disable_storage_manager_estimate",!0),this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"createdIndexedDBTransactionQueue",data:{sessionId:this.sessionId}})}startLoop(){setTimeout((()=>{this.heartbeatLoop()}),1),setTimeout((()=>{this.txLoop()}),1),setTimeout((()=>{this.healthcheckLoop()}),1)}stopLoop(){this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"stopLoop",data:{message:"Stopping loop."}}),this.shouldStopLooping=!0}hasAttemptedToClaimSessions(){return this.attemptedToClaimSessions}logEmptyTaskForDebugging(e){this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"logEmptyTaskForDebugging",data:{message:`Task created by ${e} was empty.`}})}async enqueueTask(e){const t=await this.transactionStore.saveTask(this.sessionId,e,this.getIndexedDBTimeoutMs());if(this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp),t.error)throw this.incrementErrors(t.error,"enqueueTask"),this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"enqueueTask",error:(0,s.Ui)(t.error)}),t.error;this.clearErrors("enqueueTask"),this.getWaitable(!1).trigger()}unpause(){this.transactionBackoffController.reset(),this.getWaitable(!1).trigger()}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return!!this.transactionStore&&this.transactionStore.hasTasks()}async hasTasksForUser(e){const t=await this.transactionStore.hasTasksForUser(e,this.getIndexedDBTimeoutMs());return t.error?(this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.hasTasksForUser",error:(0,s.Ui)(t.error)}),!1):t.value}async anySessionHasTasks(){const e=await this.transactionStore.anySessionHasTasks(this.getIndexedDBTimeoutMs());return e.error?(this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.anySessionHasTasks",error:(0,s.Ui)(e.error)}),!1):e.value}async drain(){return this.hasTasks()||this.isProcessingTask?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return this.hasTask((t=>t.operations.some((t=>(0,c.qo)(t.pointer,e)))))}async reset(){await this.transactionStore.reset()}async clearForUser(e){await this.transactionStore.clearTasksForUser(e)}async checkObjectStores(){return await this.transactionStore.checkObjectStores()}async getTotalNumberOfTasks(){const e=await this.transactionStore.getTotalNumberOfTasks(this.getIndexedDBTimeoutMs());return e.error?(i.log({level:"error",from:"IndexedDBTransactionQueue",type:"getTotalNumberOfTasks",error:(0,s.Ui)(e.error)}),0):e.value}startSyncing(){f.Z.setState({...f.Z.state,syncing:!0})}updateDependencies(e){this.dependencies=e}DEV_ONLY_deadlockDb(e){return this.transactionStore.DEV_ONLY_deadlockDb(e)}debugLog(){if(this.debug){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];console.log("IndexedDBTransactionQueue:",...t)}}async wait(e,t){await this.getWaitable(!1).wait(e,t),this.getWaitable(!0)}async txLoop(){for(;!this.shouldStopLooping;)try{await this.txLoopIteration(),this.clearErrors("txLoop")}catch(e){this.incrementErrors(e,"txLoop"),(0,h.Os)(this.retryReasonCounters,"txLoopException"),this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"txLoopIteration",error:(0,s.Ui)(e)}),d.IE(e),await l.Vs(15e3)}}async txLoopIteration(){const e=await this.getTasks();if(!e)return this.events.emit("drain"),void(await this.wait(...this.getMinMaxLoopDelay(!1)));const{tasks:t,sessionId:o}=e;if(0===t.length){const e=await this.transactionStore.deleteSession({currentSessionId:this.sessionId,sessionId:o});return void(e.error&&(this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.deleteSession",data:{sessionId:o},error:(0,s.Ui)(e.error)})))}this.startSyncing(),this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSubmitTransactionAttempt",data:{message:`for session ${o}: attempt submitTransaction with ${t.length} tasks`,sessionId:o,taskIds:w(t)}}),await this.useSaveTransactionsApi(t,o);const n=this.hasTasks();n||(this.doneSyncing(),this.events.emit("drain")),await this.wait(...this.getMinMaxLoopDelay(n))}getMinMaxLoopDelay(e){const[t,o]=(0,S.Z)()?[h.xd,h.CE]:[h.V_,h.Ud];return Boolean(e)?[t,t]:[t,o]}async useSaveTransactionsApi(e,t){const o=await this.dependencies.handleSaveTransactions(e);if(o.error){const{savedTasks:e,failedTasks:n,message:r,retryDelay:a,retryReason:l}=o.error;l?(0,h.Os)(this.retryReasonCounters,l):this.retryReasonCounters={_total:0},e.length>0&&(this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handlePartialSaveTransactionsSuccess",data:{message:`for session ${t}: will delete ${e.length} saved tasks`,taskIds:w(e),sessionId:t}}),await this.cleanupTasks(e,void 0)),n.length>0?(this.debugLogger.flush(),i.log({level:"warning",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsError",data:{message:`for session ${t}: ${r}`,taskIds:w(n),sessionId:t},error:(0,s.Ui)(o.error)}),await this.cleanupTasks(n,o.error)):this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsRetryableError",data:{message:`for session ${t}: ${r}`,sessionId:t}}),a>0?await this.transactionBackoffController.backOffOnFailure(a-h.V_,o.error.retryReason):this.transactionBackoffController.reset()}else{const e=o.value;this.retryReasonCounters={_total:0},this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsSuccess",data:{message:`for session ${t}: will delete ${e.length} saved tasks`,taskIds:w(e),sessionId:t}}),await this.cleanupTasks(e,void 0),this.transactionBackoffController.reset()}}incrementErrors(e,t){this.debugLog("incrementErrors",e,t),void 0===this.errorCounts[t]?this.errorCounts[t]=1:this.errorCounts[t]+=1;const o=a.Fp(Object.values(this.errorCounts))||0;this.errorCounts[t]===_.maxErrors+1&&(this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:`maxErrors.${t}`,error:(0,s.Ui)(e)})),o>_.maxErrors&&v.Z.setState({...v.Z.state,transactionQueueError:e}),e.type===u.vZ&&this.events.emit("timeout")}clearErrors(e){this.errorCounts[e]&&delete this.errorCounts[e];(a.Fp(Object.values(this.errorCounts))||0)<=_.maxErrors&&v.Z.setState({...v.Z.state,transactionQueueError:void 0})}async heartbeatLoop(){for(;!this.shouldStopLooping;)try{await this.heartbeat(),await l.Vs(_.heartbeatInterval)}catch(e){this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"heartbeatLoopIteration",error:(0,s.Ui)(e)}),await l.Vs(_.heartbeatInterval)}}async heartbeat(){const e=this.enableHeartbeatTimeout?this.getIndexedDBTimeoutMs():void 0;{this.debugLog("heartbeat");const t=await this.transactionStore.heartbeat({currentSessionId:this.sessionId,isActive:!0,timeoutMs:e});if(t.error)return this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.heartbeat",error:(0,s.Ui)(t.error)}),void this.incrementErrors(t.error,"heartbeat");this.clearErrors("heartbeat")}{const t=Date.now()-_.claimSessionDelay,o=await this.transactionStore.claimSessions({currentSessionId:this.sessionId,staleSessionTimeoutMs:t,transactionTimeoutMs:e});if(o.error)return this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.claimSessions",error:(0,s.Ui)(o.error)}),void(o.error.type===u.vZ&&this.incrementErrors(o.error,"claimSessions"));this.clearErrors("claimSessions"),this.attemptedToClaimSessions=!0}this.checkStorageQuota()}async checkStorageQuota(){if(this.disableStorageManagerEstimate)return;const e=await(0,m.sK)();e&&(i.clientLogglyEnvironmentData.storageQuotaEstimate=e.quota,i.clientLogglyEnvironmentData.storageUsageEstimate=e.usage,v.Z.setState({...v.Z.state,storageUsageEstimate:e}))}doneSyncing(){f.Z.setState({...f.Z.state,syncing:!1})}hasTask(e){return this.transactionStore.hasTask(e)}async getTasks(){const e="on"===this.dependencies.getExperimentGroup("sort_indexeddb_tasks_by_index"),t=await this.transactionStore.getTasks(this.sessionId,e);if(t.error)throw t.error;return t.value}async cleanupTasks(e,t){for(const r of e)if(r.callback)try{r.callback(t)}catch(n){this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"cleanupTask",data:{taskId:r.id},error:(0,s.Ui)(n)})}const o=await this.transactionStore.deleteTasks(e);o.error&&(this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.deleteTasks",error:(0,s.Ui)(o.error)}))}getWaitable(e){return this.waiter&&!e||(this.waiter=new l.a6),this.waiter}async healthcheckLoop(){for(;!this.shouldStopLooping;){try{var e;const t=await this.transactionStore.getTotalNumberOfTasks(_.defaultIndexedDBTimeoutMs),o={queue_type:"IndexedDBTransactionQueue",uptime:Date.now()-this.startTime,queue_size:t.error?void 0:t.value,error_type:null===(e=t.error)||void 0===e?void 0:e.type,is_considered_online:f.Z.state.online,retry_reasons:this.retryReasonCounters};(o.queue_size&&o.queue_size>_.transactionSizeHealthcheckThreshold||o.error_type)&&(this.debugLogger.flush(),i.log({level:"info",from:"IndexedDBTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:o}}),this.dependencies.handleHealthcheck(o))}catch(t){this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(t)}),d.IE(t)}await l.Vs(_.healthcheckInterval)}}getIndexedDBTimeoutMs(){if("on"===this.dependencies.getExperimentGroup("indexeddb-transaction-timeout-v2"))return _.defaultIndexedDBTimeoutMs}}function w(e){return e.map((e=>{var t;return null!==(t=e.debug)&&void 0!==t&&t.userAction?`${e.id} (${e.debug.userAction})`:e.id}))}n=_,_.heartbeatInterval=2.5*p.C0,_.claimSessionDelay=5*n.heartbeatInterval,_.healthcheckInterval=15*p.hM,_.transactionSizeHealthcheckThreshold=1e3,_.defaultIndexedDBTimeoutMs=180*p.C0,_.maxErrors=5;const k=_},50619:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(68626),r=o(82798),i=o(96826),a=o(99757);class s{constructor(e,t){this.activeQueue=void 0,this.inMemoryTransactionQueue=void 0,this.handleIndexedDbTimeout=()=>{const e=(0,r.R9)(this.activeQueue,i.Z);e.hasTasks()||(e.stopLoop(),e.events.removeListener("timeout",this.handleIndexedDbTimeout),a.Z.reset(),this.inMemoryTransactionQueue.startLoop(),this.activeQueue=this.inMemoryTransactionQueue,n.log({level:"warning",from:"IndexedDBWithInMemoryFallbackTransactionQueue",type:"handleIndexedDbTimeout",data:{message:"IndexedDB timeout occurred while the transaction queue is empty. Switching over to InMemoryTransactionQueue."}}))},this.activeQueue=e,this.inMemoryTransactionQueue=t,e.events.addListener("timeout",this.handleIndexedDbTimeout)}startLoop(){this.activeQueue.startLoop()}logEmptyTaskForDebugging(e){var t,o;null===(t=(o=this.activeQueue).logEmptyTaskForDebugging)||void 0===t||t.call(o,e)}enqueueTask(e){return this.activeQueue.enqueueTask(e)}unpause(){this.activeQueue.unpause()}pause(){this.activeQueue.pause()}getLastTaskTimestamp(){return this.activeQueue.getLastTaskTimestamp()}hasTasks(){return this.activeQueue.hasTasks()}anySessionHasTasks(){return this.activeQueue.anySessionHasTasks()}getTotalNumberOfTasks(){return this.activeQueue.getTotalNumberOfTasks()}hasTasksForUser(e){return this.activeQueue.hasTasksForUser(e)}drain(){return this.activeQueue.drain()}awaitRecordTransaction(e){return this.activeQueue.awaitRecordTransaction(e)}isPendingTransactionForRecord(e){return this.activeQueue.isPendingTransactionForRecord(e)}reset(){return this.activeQueue.reset()}clearForUser(e){return this.activeQueue.clearForUser(e)}updateDependencies(e){this.activeQueue.updateDependencies(e),this.inMemoryTransactionQueue!==this.activeQueue&&this.inMemoryTransactionQueue.updateDependencies(e)}getIndexedDBTransactionQueue(){if(this.activeQueue instanceof i.Z)return this.activeQueue}}},64113:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{focused:!1}}}const i=r},33846:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{inputValue:"",focus:!1}}}const i=r},48863:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},22294:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isEnabled:!0,isKeyboardMode:!1}}setEnabled(e){this.setState({...this.state,isEnabled:e})}setKeyboardMode(e){this.state.isEnabled&&this.setState({isEnabled:!0,isKeyboardMode:e})}}const i=new r},23178:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},23883:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{limitParents:new WeakMap}}setLimitParents(e,t){this.state.limitParents.set(e,t),this.emit()}removeLimitParents(e){this.state.limitParents.delete(e),this.emit()}}const i=new r},31104:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},37598:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{}}getEditedBlocksForCollection(e){const t=this.state[e];if(t)return t;{const t=new Set;return this.state[e]=t,t}}setEditedBlock(e,t){this.getEditedBlocksForCollection(e).add(t),this.emit()}}const i=new r},84166:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{}const i=new r},91390:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isActive:!1}}}const i=new r},19111:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(72087);class i extends n.default{getInitialState(){return{open:!1,userRequestStore:new r.Z,botRequestStore:new r.Z,pageRequestStore:new r.Z,mentionTypes:{page:!1,createPage:!1,user:!1,bot:!1,date:!1,reminder:!1,templateVariable:!1,group:!1}}}}const a=new i},29798:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{focus:{section:void 0,indexLocal:void 0,indexGlobal:void 0,isInitialized:!1}}}setState(e){super.setState({...e,focus:{...e.focus,isInitialized:!0}})}update(e){this.setState(e({...this.state}))}unsetFocus(){this.setState({...this.state,focus:{section:void 0,indexLocal:void 0,indexGlobal:void 0}})}}const i=r},69454:(e,t,o)=>{o.d(t,{Z:()=>c,i:()=>s});var n=o(49085),r=o(72126),i=o(5162),a=o(3418);let s=function(e){return e[e.willHide=0]="willHide",e[e.hidden=1]="hidden",e[e.willShow=2]="willShow",e[e.shown=3]="shown",e}({});class l extends n.default{constructor(){var e;super(...arguments),e=this,this.updateKeyboardPhaseDebounced=r.Ds(((e,t)=>{this.setState({...this.state,phase:e,estimatedKeyboardWebViewOverlap:t})}),300),this.updateKeyboardPhase=(e,t,o)=>{const{device:n,RouterStore:r}=e,i="page"===r.state.route.name,a=n.isAndroid&&n.isMobileNative;i&&a?this.updateKeyboardPhaseDebounced(t,o):this.setState({...this.state,phase:t,estimatedKeyboardWebViewOverlap:o})},this.updateShouldResizeWebview=function(t,o){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"v2";const{mobileNative:r}=t;switch(n){case"v1":const t=null==r?void 0:r.api.setShouldResizeWebView;t&&t(o);break;case"v2":const n=null==r?void 0:r.api.setShouldResizeWebViewV2;(0,i.Y)("supportsWebViewResizingOnSelection")&&n&&(e.setState({...e.state,shouldResizeWebView:o}),n(o).then((t=>{t.length>0&&e.setState({...e.state,shouldResizeWebView:t[0]})})))}},this.estimatedNativeWebBottomOverlap=e=>{if((0,i.Y)("supportsNativeBottomBarOverlappingWebView")){const t=a.Z.hasOpenMobileSlideUps()?0:((null==e?void 0:e.WindowSizeStore.state.paddingBottom)??0)+48;return Math.max(this.estimatedKeyboardWebViewOverlap(),t)}return this.estimatedKeyboardWebViewOverlap()},this.estimatedKeyboardWebViewOverlap=()=>(0,i.Y)("supportsFixedSizeWebView")?(0,i.Y)("supportsWebViewResizingOnSelection")&&this.state.shouldResizeWebView?0:this.state.estimatedKeyboardWebViewOverlap:this.state.phase!==s.willShow||(0,i.Y)("supportsWebViewResizingOnKeyboardWillShow")?0:this.state.estimatedKeyboardWebViewOverlap}getInitialState(){return{phase:s.hidden,estimatedKeyboardWebViewOverlap:0,shouldResizeWebView:!1}}async onShow(e){await this.waitUntil((()=>this.state.phase===s.shown)),e()}async onHide(e){await this.waitUntil((()=>this.state.phase===s.hidden)),e()}}const c=new l},31792:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{mouseEntered:!1,mousePressed:!1}}enter(){this.setState({...this.state,mouseEntered:!0})}exit(){this.setState({...this.state,mouseEntered:!1})}}const i=r},17294:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{}}}const i=new r},42330:(e,t,o)=>{o.d(t,{ZP:()=>s,o1:()=>r,rJ:()=>a});var n=o(49085);const r=["page","space","team","space-private-pages"];class i extends n.default{getInitialState(){return{isOpen:!1,lastPageId:void 0}}getVariant(){if(this.state.isOpen)return this.state.variant}getTargetsDatabaseType(){if(this.state.isOpen)return a(this.state.targets)}}function a(e){var t;if(0===e.length)return;const o=null===(t=e[0].getAssociatedCollectionStore())||void 0===t?void 0:t.getDatabaseType();if(o){for(const t of e){var n;if(o!==(null===(n=t.getAssociatedCollectionStore())||void 0===n?void 0:n.getDatabaseType()))return}return o}}const s=new i},5315:(e,t,o)=>{o.r(t),o.d(t,{TEST_ONLY__setTransactionQueue:()=>ue,isIndexedDbGracefulFallbackToInMemoryEnabled:()=>le,setupTransactionQueue:()=>pe,transactionQueue:()=>de});o(57658),o(21703);var n=o(36769),r=o(7406),i=o(68626),a=o(72126),s=o(91155),l=o(29477),c=o(4615),d=o(63143),p=o(482),u=o(97880),m=o(99757),g=o(21830);const h="Transaction",f="bySessionId",y="byTimestamp",v="byId",b="byUserId",S="Session",_="bySessionId",w="byUpdatedAt",k="byOwnerSessionId";const x=45*d.C0;class I{constructor(e,t){this.db=void 0,this.debugLogger=void 0,this.runOptimizedScans=!0,this.activeTasks=new Map,this.ownedSessionIds=new Set,this.db=new g.pz(t,"TransactionStore",2,{upgrade(e,t,o,n){if(t<1&&function(e){const t=e.createObjectStore(S,{keyPath:u.MN("index"),autoIncrement:!0});t.createIndex(w,u.MN("updatedAt"),{unique:!1}),t.createIndex(k,u.MN("ownerSessionId"),{unique:!1}),t.createIndex(_,u.MN("sessionId"),{unique:!0});const o=e.createObjectStore(h,{keyPath:u.MN("index"),autoIncrement:!0});o.createIndex(y,u.MN("timestamp"),{unique:!1}),o.createIndex(f,[u.MN("sessionId"),u.MN("timestamp")],{unique:!1}),o.createIndex(v,u.MN("id"),{unique:!0})}(e),t<2){n.objectStore(h).createIndex(b,u.MN("userId"))}}}),this.debugLogger=e,this.runOptimizedScans=!t.device.isEdgeHTML}async DEV_ONLY_deadlockDb(e){throw new Error("This function is only available in development builds.")}async heartbeat(e){const{currentSessionId:t,isActive:o,timeoutMs:n}=e,r=o?[S,h]:[S],a=await this.db.startTransaction({storeNames:r,mode:"readwrite",name:"IndexedDBTransactionStore.heartbeat",timeoutMs:n},(async(e,n)=>{const r=new Set,a=e.objectStore(S);let l=await a.index(k).openCursor(t);n("Obtained session cursor.");let c=0;for(;l;){c+=1;const e=l.value;e.sessionId!==t&&r.add(e.sessionId);const o={...e,updatedAt:Date.now()};l.update(o),l=await l.continue()}if(n(`Finished processing ${c} sessions.`),o){const t=e.objectStore(h).index(v),o=Date.now()-x;n(`Processing ${this.activeTasks.size} active tasks.`),this.activeTasks.forEach((async e=>{if(e.timestamp>=o)return;if(!(await t.get(e.id))){if(e.callback)try{e.callback(void 0)}catch(n){this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionStore",type:"activeTaskGarbageCollectCleanupError",error:(0,s.Ui)(n)})}this.debugLogger.flush(),i.log({level:"warning",from:"IndexedDBTransactionStore",type:"activeTaskGarbageCollect",data:{miscDataToConvertToString:{task:e,expireTime:o}}}),this.activeTasks.delete(e.id)}}))}return{value:r}}));return a.error?a:(this.ownedSessionIds=a.value,{value:void 0})}async claimSessions(e){const{currentSessionId:t,staleSessionTimeoutMs:o,transactionTimeoutMs:n}=e,r=await this.db.startTransaction({storeNames:[S],mode:"readwrite",name:"IndexedDBTransactionStore.claimSessions",timeoutMs:n},(async(e,n)=>{const r=[],i=e.objectStore(S);let a=await i.index(w).openCursor(IDBKeyRange.upperBound(o));for(n("Obtained session cursor.");a;){const e=a.value,o={...e,ownerSessionId:t,updatedAt:Date.now()};r.push(e.sessionId),n(`Taking ownership of session ${e.sessionId}.`);const i=Date.now()-e.updatedAt;this.debugLogger.log({from:"IndexedDBTransactionStore",level:"debug",type:"claimSession",data:{message:`claimed ${e.sessionId} updated ${i}ms ago`,sessionId:e.sessionId,sinceLastUpdate:i}}),a.update(o),a=await a.continue()}return{value:r}}));if(r.error)return r;for(const i of r.value)this.ownedSessionIds.add(i);return{value:void 0}}getTasks(e,t){return this.db.startTransaction({storeNames:[S,h],mode:"readonly",name:"IndexedDBTransactionStore.getTasks",timeoutMs:void 0},(async(o,n)=>{let r;const i=[],a=o.objectStore(S);let s=await a.index(k).openCursor(e);for(n("Obtained session cursor.");s;){const e=s.value;i.push(e),s=await s.continue()}if(n(`Found ${i.length} owned sessions.`),0===i.length)return{value:void 0};i.sort(((e,t)=>e.index-t.index));const l=i[0].sessionId,c=[];let d=await this.createTransactionCursor(o,l);for(;d;){const e=d.value;(0,p.d)(e.operations);const t=this.activeTasks.get(e.id);e.sessionId===l&&c.push({...e,callback:t&&t.callback}),d=await d.continue()}return n(`Found ${c.length} tasks.`),r={sessionId:l,tasks:c},t?r.tasks.sort(((e,t)=>e.index&&t.index?e.index-t.index:e.timestamp-t.timestamp)):r.tasks.sort(((e,t)=>e.timestamp-t.timestamp)),{value:r}}))}saveTask(e,t,o){const n={id:t.id,userId:t.userId,spaceId:t.spaceId,sessionId:e,timestamp:t.timestamp,debug:t.debug,operations:t.operations,useSudoMode:t.useSudoMode};return m.Z.setOrIncTotal(this.activeTasks.size+1),this.activeTasks.set(n.id,t),this.db.startTransaction({storeNames:[S,h],mode:"readwrite",name:"IndexedDBTransactionStore.saveTask",timeoutMs:o},(async(t,o)=>{const i=t.objectStore(S),a=await i.index(_).get(e);if(o("Obtained session cursor."),!a){const t={sessionId:e,updatedAt:Date.now(),ownerSessionId:e};o(`Adding session ${t.sessionId}.`);try{await i.add(t)}catch(s){throw(0,g.XH)((0,r.tg)(s),`session ${t.sessionId}`)}}try{await t.objectStore(h).add(n)}catch(s){throw(0,g.XH)((0,r.tg)(s),`task ${n.id}`)}return this.debugLogger.log({from:"IndexedDBTransactionStore",type:"saveTask",level:"debug",data:{message:`create task ${n.id} in ${a?"existing":"NEW"} session ${e}`,sessionId:e,taskId:n.id,isNewSession:!Boolean(a)}}),{value:void 0}}))}async deleteSession(e){const{currentSessionId:t,sessionId:o}=e,n=await this.db.startTransaction({storeNames:[S,h],mode:"readwrite",name:"IndexedDBTransactionStore.deleteSession",timeoutMs:void 0},(async(e,n)=>{let r=await this.createTransactionCursor(e,o);for(n("Obtained transaction cursor.");r;){if(r.value.sessionId===o)return{value:`Attempt to delete non-empty session: has task ${r.value.id}`,abort:!0};r=await r.continue()}const i=e.objectStore(S),a=await i.index(_).get(o);if(!a)return{value:"Session is missing",abort:!0};const s=a;return s.ownerSessionId!==t?{value:`Attempt to delete another tab's session: owned by ${s.ownerSessionId}`,abort:!0}:(i.delete(s.index),{value:void 0})}));return n.error?n:n.value?{error:{type:"LogicalError",message:n.value,userDetails:"Could not perform an operation due to a logical error."}}:{value:void 0}}hasTasks(){return this.activeTasks.size>0||this.ownedSessionIds.size>0}getTotalNumberOfTasks(e){return this.db.startTransaction({storeNames:[h],mode:"readonly",name:"IndexedDBTransactionStore.getTotalNumberOfTasks",timeoutMs:e},(async e=>{const t=e.objectStore(h);return{value:await t.count()}}))}getTotalNumberOfTasksForUser(e,t){return this.db.startTransaction({storeNames:[h],mode:"readonly",name:"IndexedDBTransactionStore.getTotalNumberOfTasksForUser",timeoutMs:t},(async t=>{const o=t.objectStore(h).index(b);return{value:await o.count(e)}}))}async anySessionHasTasks(e){const t=await this.getTotalNumberOfTasks(e);return t.error?t:{value:t.value>0}}async hasTasksForUser(e,t){const o=await this.getTotalNumberOfTasksForUser(e,t);return o.error?o:{value:o.value>0}}hasTask(e){for(const[,t]of this.activeTasks)if(e(t))return!0;return!1}async deleteTasks(e){const t=await this.db.startTransaction({storeNames:[h,S],mode:"readwrite",name:"IndexedDBTransactionStore.deleteTasks",timeoutMs:void 0},(async(t,o)=>{const n=[],r=[],a=new Set,s=t.objectStore(h),l=s.index(v),c=t.objectStore(S);await(0,g.qv)(e.map((0,g.zp)((async e=>{n.push(e.id);const t=await l.openCursor(e.id);if(o(`Obtained transaction cursor for task ${e.id}.`),t){a.add(t.value.sessionId),await t.delete(),o(`Deleted task ${e.id}.`);const n=String(e.id);this.debugLogger.log({from:"IndexedDBTransactionStore",type:"deleteTasksDeleteTask",level:"debug",data:{message:`delete task ${e.id}`,taskId:n}})}else this.debugLogger.flush(),i.log({from:"IndexedDBTransactionStore",type:"deleteTasksTaskNotExist",level:"warning",data:{message:`could not delete task not stored in indexeddb ${e.id}`,taskId:e.id}})}))));const d=s.index(f);return a.forEach((async e=>{let o=0;if(this.runOptimizedScans)o=await d.count(this.getTransactionRange(e));else{let n=await this.createTransactionCursor(t,e);for(;n;){if(n.value.sessionId===e){o++;break}n=await n.continue()}}if(0===o){const t=await c.index(_).openCursor(e);t&&(r.push(t.value.sessionId),t.delete(),this.debugLogger.log({from:"IndexedDBTransactionStore",type:"deleteTasksDeleteSession",level:"debug",data:{message:`delete empty session ${e}`,sessionId:e}}))}})),{value:{deletedTaskIds:n,deletedSessionIds:r}}}));if(t.error)return t;const{deletedTaskIds:o,deletedSessionIds:n}=t.value;for(const r of o)this.activeTasks.delete(r);for(const r of n)this.ownedSessionIds.delete(r);return m.Z.updateRemaining(this.activeTasks.size),{value:void 0}}async checkObjectStores(){const e="IndexedDBTransactionStore.checkObjectStores",t=this.db.startTransaction({storeNames:["Session"],mode:"readonly",name:`${e}: read from Session object store`,timeoutMs:void 0},(async()=>Promise.resolve({value:"created IndexedDB transaction"}))),o=this.db.startTransaction({storeNames:["Transaction"],mode:"readonly",name:`${e}: read from Transaction object store`,timeoutMs:void 0},(async()=>Promise.resolve({value:"created IndexedDB transaction"}))),[n,r]=await Promise.all([t,o]);return{session:n,transaction:r}}async reset(){await this.db.reset(),this.activeTasks.clear(),this.ownedSessionIds.clear(),m.Z.updateRemaining(0)}async clearTasksForUser(e){const t=await this.db.startTransaction({storeNames:[h],mode:"readwrite",name:"IndexedDBTransactionStore.clearTasksForUser",timeoutMs:void 0},(async(t,o)=>{const n=[],r=t.objectStore(h);let i=await r.index(b).openCursor(IDBKeyRange.only(e));for(o("Obtained transaction cursor.");i;)n.push(i.value.id),await i.delete(),i=await i.continue();return{value:{deletedTaskIds:n}}}));if(t.error)return t;const{deletedTaskIds:o}=t.value;for(const n of o)this.activeTasks.delete(n);m.Z.updateRemaining(this.activeTasks.size)}getTransactionRange(e){return IDBKeyRange.bound([e,0],[e,Number.MAX_VALUE],!0,!0)}createTransactionCursor(e,t){const o=e.objectStore("Transaction");return this.runOptimizedScans?o.index(f).openCursor(this.getTransactionRange(t),"next"):o.openCursor()}}var C=o(15517),T=o(97448),M=o(54064),P=o(606),A=o(12139),D=o(63037),B=o(88632),R=o(26634),E=o(97664),F=o(20985);async function N(e,t){await F.i6`
		INSERT OR REPLACE INTO transactions (
		    id,
		    user_id,
		    space_id,
		    operations,
		    timestamp,
			debug
		)
		VALUES (
		    ${t.id},
		    ${t.userId||null},
		    ${t.spaceId||null},
		    ${JSON.stringify(t.operations)},
		    ${t.timestamp},
			${t.debug?JSON.stringify(t.debug):null}
		)
	`.run(e)}function j(e){try{const t=JSON.parse(e);if(!Array.isArray(t))throw new Error(`JSON value is not an array: ${t}`);return t}catch(t){return i.log({from:"sqliteTransactionStorage",level:"error",type:"safeParseArray",error:(0,s.Ui)(t)}),[]}}async function O(e){return(await(0,E.gU)({connection:e,sql:"SELECT COUNT(*) AS count FROM transactions"}))[0].count}async function L(e,t){return(await(0,E.gU)({connection:e,sql:"SELECT COUNT(*) AS count FROM transactions WHERE user_id = ?",args:[t]}))[0].count}async function U(e){await F.i6`DELETE FROM transactions`.run(e)}async function Z(e,t){const[o]=await(0,E.G$)({connection:e,statements:[{sql:"SELECT * FROM transactions WHERE user_id = ?",args:[t],getData:!0},{sql:"DELETE FROM transactions WHERE user_id = ?",args:[t]}],queryName:"deleteTransactionsForUser"});return o.data.map((e=>e.id))}const V="NativeBackedTransactionQueue";class q{constructor(e,t,o){this.lastTaskTimestamp=0,this.tasks=new Map,this.sessionId="00000000-0000-0000-0000-000000000000",this.events=new M.Z,this.retryReasonCounters={_total:0},this.startTime=Date.now(),this.debugLogger=new i.BatchedLogger({from:V,type:"BulkDebug",level:"info",maxLength:250}),this.connection=e,this.dependencies=t,i.log({from:V,level:"debug",type:"NativeBackedTransactionQueueCreated"}),o.subscribeToUpdateTransactionState((e=>this.updateTransactionState(e)))}async enqueueTask(e){this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp);const t=0===this.tasks.size;var o;(this.tasks.set(e.id,{...e,sessionId:this.sessionId}),this.hasTooManyOperations(e))&&i.log({from:V,type:"enqueueTask",level:"warning",data:{message:`enqueing task with operation count > ${q.operationCountWarningThreshold}`,sessionId:this.sessionId,taskId:e.id,isNewSession:t,userAction:null===(o=e.debug)||void 0===o?void 0:o.userAction,miscDataToConvertToString:{operationsCount:e.operations.length}}});const n=JSON.stringify(e.operations).length;var r;this.stringifiedOperationSizeIsTooLarge(n)&&i.log({from:V,type:"enqueueTask",level:"warning",data:{message:`enqueing task with stringified operation count > ${q.stringifiedOperationSizeByteThreshold} bytes`,sessionId:this.sessionId,taskId:e.id,isNewSession:t,userAction:null===(r=e.debug)||void 0===r?void 0:r.userAction,miscDataToConvertToString:{operationsCount:e.operations.length,stringifiedOperationsSize:n}}});await N(this.connection,e),this.debugLogger.log({from:V,type:"enqueueTask",level:"debug",data:{message:`save task ${e.id} in memory (${this.tasks.size} total now)`,sessionId:this.sessionId,taskId:e.id,isNewSession:t}})}startLoop(){this.dependencies.timeSource.setTimeout((()=>this.healthcheckLoop()),1)}unpause(){}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return this.tasks.size>0}async hasTasksForUser(e){return await L(this.connection,e)>0}async getTotalNumberOfTasks(){return await O(this.connection)}async anySessionHasTasks(){return await this.getTotalNumberOfTasks()>0}async reset(){await U(this.connection),this.tasks.clear()}async clearForUser(e){const t=await Z(this.connection,e);for(const o of t)this.tasks.delete(o)}updateDependencies(e){this.dependencies=e}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return Array.from(this.tasks.values()).some((t=>t.operations.some((t=>(0,P.qo)(t.pointer,e)))))}hasTooManyOperations(e){return e.operations.length>=q.operationCountWarningThreshold}stringifiedOperationSizeIsTooLarge(e){return e>=q.stringifiedOperationSizeByteThreshold}async drain(){return this.tasks.size>0?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async healthcheckLoop(){for(;;){try{const e=await this.getTotalNumberOfTasks();e>q.transactionSizeHealthcheckThreshold&&(this.debugLogger.flush(),i.log({level:"info",from:"NativeBackedSqliteTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:{queueSize:e}}}),this.dependencies.handleHealthcheck({queue_type:"NativeBackedSqliteTransactionQueue",uptime:Date.now()-this.startTime,queue_size:e,error_type:void 0,is_considered_online:B.Z.state.online,retry_reasons:this.retryReasonCounters}))}catch(e){this.debugLogger.flush(),i.log({level:"error",from:"NativeBackedSqliteTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(e)}),A.IE(e)}await l.Vs(q.healthcheckInterval,this.dependencies.timeSource)}}updateTransactionState(e){(e.syncing||this.hasTasks())&&B.Z.setState({...B.Z.state,syncing:!0});let t=[],o=[];if(e.saveTransactionResult)if(e.saveTransactionResult.error){const{retryReason:n}=e.saveTransactionResult.error;n?(0,D.Os)(this.retryReasonCounters,n):this.retryReasonCounters={_total:0},t=e.saveTransactionResult.error.savedTasks.map((e=>this.tasks.get(e.id))).filter(u.$K),o=e.saveTransactionResult.error.failedTasks.map((e=>this.tasks.get(e.id))).filter(u.$K),(0,R.o)({backoffEstimate:void 0,retryReason:n})}else this.retryReasonCounters={_total:0},t=e.saveTransactionResult.value.map((e=>this.tasks.get(e.id))).filter(u.$K),o=[],(0,R.Om)();t.forEach((e=>{if(e.callback)try{e.callback(void 0)}catch(t){this.debugLogger.flush(),i.log({level:"error",from:"NativeBackedTransactionQueue",type:"updateTransactionStateSavedTask",data:{taskId:e.id},error:(0,s.Ui)(t)})}this.tasks.delete(e.id)})),o.forEach((e=>{if(e.callback)try{e.callback(new Error(`Failed to save transaction with id: ${e.id}`))}catch(t){this.debugLogger.flush(),i.log({level:"error",from:"NativeBackedTransactionQueue",type:"updateTransactionStateFailedTask",data:{taskId:e.id},error:(0,s.Ui)(t)})}this.tasks.delete(e.id),this.dependencies.rollbackTask(e)})),e.syncing||this.hasTasks()||(B.Z.setState({...B.Z.state,syncing:!1}),this.events.emit("drain"))}}q.healthcheckInterval=5*d.hM,q.transactionSizeHealthcheckThreshold=1e3,q.operationCountWarningThreshold=500,q.stringifiedOperationSizeByteThreshold=1e5;var z=o(2414),W=o(9425);const H="SqliteTransactionQueue";class G{constructor(e,t){this.isProcessingTask=!1,this.lastTaskTimestamp=0,this.tasks=new Map,this.events=new M.Z,this.waiter=void 0,this.transactionBackoffController=new z.h(R._W),this.sessionId="00000000-0000-0000-0000-000000000000",this.debugLogger=new i.BatchedLogger({from:H,type:"BulkDebug",level:"info",maxLength:250}),this.connection=e,this.dependencies=t,i.log({from:H,level:"debug",type:"SqliteTransactionQueueCreated"})}startLoop(){this.dependencies.timeSource.setTimeout((()=>this.txLoop()),1),this.dependencies.timeSource.setTimeout((()=>this.healthcheckLoop()),1)}async enqueueTask(e){this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp);const t=0===this.tasks.size;this.tasks.set(e.id,{...e,sessionId:this.sessionId}),await N(this.connection,e),this.debugLogger.log({from:H,type:"saveTask",level:"debug",data:{message:`save task ${e.id} in memory (${this.tasks.size} total now)`,sessionId:this.sessionId,taskId:e.id,isNewSession:t}}),this.getWaitable(!1).trigger()}unpause(){this.transactionBackoffController.reset(),this.getWaitable(!1).trigger()}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return this.tasks.size>0}async hasTasksForUser(e){return await L(this.connection,e)>0}async getTotalNumberOfTasks(){return await O(this.connection)}async anySessionHasTasks(){return await this.getTotalNumberOfTasks()>0}async drain(){return this.hasTasks()||this.isProcessingTask?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return Array.from(this.tasks.values()).some((t=>t.operations.some((t=>(0,P.qo)(t.pointer,e)))))}async reset(){await U(this.connection),this.tasks.clear()}async clearForUser(e){const t=await Z(this.connection,e);for(const o of t)this.tasks.delete(o)}updateDependencies(e){this.dependencies=e}async txLoop(){for(;;)try{await this.txLoopIteration()}catch(e){this.debugLogger.flush(),i.log({level:"error",from:H,type:"txLoopIteration",error:(0,s.Ui)(e)}),A.IE(e),await l.Vs(15e3)}}async txLoopIteration(){const e=this.hasTasks();e||(this.doneSyncing(),this.events.emit("drain"));const[t,o]=(0,W.Z)()?[D.xd,D.CE]:[D.V_,D.Ud];await this.wait(t,e?t:o);const n=await async function(e){return(await(0,E.gU)({connection:e,sql:"SELECT * FROM transactions"})).map((e=>({id:e.id,userId:e.user_id||void 0,spaceId:e.space_id||void 0,debug:void 0,operations:j(e.operations),timestamp:e.timestamp})))}(this.connection);for(const i of n)(0,p.d)(i.operations);const r=Array.from(n).sort(((e,t)=>e.timestamp-t.timestamp)).map((e=>{const t=this.tasks.get(e.id);if(t){return{...t,...e,callback:t.callback}}return e}));0!==r.length&&(this.startSyncing(),await this.useSaveTransactionsApi(r))}async useSaveTransactionsApi(e){const t=await this.dependencies.handleSaveTransactions(e);if(t.error){const{savedTasks:e,failedTasks:o,message:n,retryDelay:r}=t.error;e.length>0&&(this.debugLogger.log({level:"debug",from:H,type:"handlePartialSaveTransactionsSuccess",data:{message:`will delete ${e.length} saved tasks`,taskIds:e.map((e=>e.id))}}),await this.cleanupTasks(e,void 0)),o.length>0?(this.debugLogger.flush(),i.log({level:"warning",from:H,type:"handleSaveTransactionsError",data:{message:n,taskIds:o.map((e=>e.id))},error:(0,s.Ui)(t.error)}),await this.cleanupTasks(o,t.error)):this.debugLogger.log({level:"debug",from:H,type:"handleSaveTransactionsRetryableError",data:{message:n},error:(0,s.Ui)(t.error)}),r>0?await this.transactionBackoffController.backOffOnFailure(r-D.V_,t.error.retryReason):this.transactionBackoffController.reset()}else{const e=t.value;this.debugLogger.log({level:"debug",from:H,type:"handleSaveTransactionsSuccess",data:{message:`will delete ${e.length} saved tasks`,taskIds:e.map((e=>e.id))}}),await this.cleanupTasks(e,void 0),this.transactionBackoffController.reset()}}async cleanupTasks(e,t){for(const n of e)if(n.callback)try{n.callback(t)}catch(o){this.debugLogger.flush(),i.log({level:"error",from:"SQLiteTransactionQueue",type:"cleanupTask",data:{taskId:n.id},error:(0,s.Ui)(o)})}for(const n of e)this.debugLogger.log({from:H,type:"deleteTasksDeleteTask",level:"debug",data:{message:`delete task ${n.id}`,taskId:n.id}}),this.tasks.delete(n.id);await async function(e,t){const o=a.yo(t,E.mz).map((e=>{const t=F.i6`,`.joins(e.map((e=>F.i6`${e}`)));return F.i6`DELETE FROM transactions WHERE id in (${t})`.asWrite()}));await(0,E.G$)({connection:e,statements:o,queryName:"removeTransactions"})}(this.connection,e.map((e=>e.id)))}getWaitable(e){return this.waiter&&!e||(this.waiter=new l.a6(this.dependencies.timeSource)),this.waiter}async wait(e,t){await this.getWaitable(!1).wait(e,t),this.getWaitable(!0)}startSyncing(){B.Z.setState({...B.Z.state,syncing:!0})}doneSyncing(){B.Z.setState({...B.Z.state,syncing:!1})}async healthcheckLoop(){for(;;){const e=await this.getTotalNumberOfTasks();e>G.transactionSizeHealthcheckThreshold&&(this.debugLogger.flush(),i.log({level:"info",from:"SqliteTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:{queueSize:e}}})),await l.Vs(G.healthcheckInterval,this.dependencies.timeSource)}}}G.healthcheckInterval=15*d.hM,G.transactionSizeHealthcheckThreshold=1e3;var K=o(5162),$=o(77080),Y=o(95424),Q=o(82798),J=o(96826);class X{constructor(e,t){this.activeQueue=void 0,this.inMemoryTransactionQueue=void 0,this.indexedDBDrainListener=void 0,this.debugLogger=void 0,this.activeQueue=e,this.inMemoryTransactionQueue=t,this.indexedDBDrainListener=()=>this.handleIndexedDBQueueDrain(),this.debugLogger=new i.BatchedLogger({from:"IndexedDBToInMemoryTransactionQueue",type:"BulkDebug",level:"info",maxLength:250}),setTimeout((()=>{this.activeQueue instanceof J.Z&&(this.debugLogger.log({level:"error",from:"IndexedDBToInMemoryTransactionQueue",type:"constructor",data:{message:"IndexedDBTransactionQueue has not drained after 5 minutes."}}),this.debugLogger.flush())}),5*d.hM)}startLoop(){if(this.activeQueue instanceof J.Z){this.activeQueue.events.addListener("drain",this.indexedDBDrainListener)}this.activeQueue.startLoop()}handleIndexedDBQueueDrain(){const e=(0,Q.R9)(this.activeQueue,J.Z);e.hasAttemptedToClaimSessions()&&(e.stopLoop(),e.events.removeListener("drain",this.indexedDBDrainListener),this.inMemoryTransactionQueue.startLoop(),this.activeQueue=this.inMemoryTransactionQueue,this.debugLogger.log({level:"info",from:"IndexedDBToInMemoryTransactionQueue",type:"constructor",data:{message:"Switching over from IndexedDBTransactionQueue to InMemoryTransactionQueue."}}))}logEmptyTaskForDebugging(e){var t,o;null===(t=(o=this.activeQueue).logEmptyTaskForDebugging)||void 0===t||t.call(o,e)}enqueueTask(e){return this.activeQueue.enqueueTask(e)}unpause(){this.activeQueue.unpause()}pause(){this.activeQueue.pause()}getLastTaskTimestamp(){return this.activeQueue.getLastTaskTimestamp()}hasTasks(){return this.activeQueue.hasTasks()}anySessionHasTasks(){return this.activeQueue.anySessionHasTasks()}getTotalNumberOfTasks(){return this.activeQueue.getTotalNumberOfTasks()}hasTasksForUser(e){return this.activeQueue.hasTasksForUser(e)}drain(){return this.activeQueue.drain()}awaitRecordTransaction(e){return this.activeQueue.awaitRecordTransaction(e)}isPendingTransactionForRecord(e){return this.activeQueue.isPendingTransactionForRecord(e)}reset(){return this.activeQueue.reset()}clearForUser(e){return this.activeQueue.clearForUser(e)}updateDependencies(e){this.activeQueue.updateDependencies(e),this.inMemoryTransactionQueue!==this.activeQueue&&this.inMemoryTransactionQueue.updateDependencies(e)}}var ee=o(50619);const te="InMemoryTransactionQueue";class oe{constructor(e){this.isProcessingTask=!1,this.lastTaskTimestamp=0,this.tasks=new Map,this.events=new M.Z,this.waiter=void 0,this.transactionBackoffController=new z.h(R._W),this.sessionId="00000000-0000-0000-0000-000000000000",this.retryReasonCounters={_total:0},this.startTime=Date.now(),this.debugLogger=new i.BatchedLogger({from:te,type:"BulkDebug",level:"info",maxLength:250}),this.dependencies=e}startLoop(){setTimeout((()=>this.txLoop()),1),setTimeout((()=>this.healthcheckLoop()),1)}enqueueTask(e){this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp);const t=0===this.tasks.size;return this.tasks.set(e.id,{...e,sessionId:this.sessionId}),m.Z.setOrIncTotal(this.tasks.size),this.debugLogger.log({from:te,type:"saveTask",level:"debug",data:{message:`save task ${e.id} in memory (${this.tasks.size} total now)`,sessionId:this.sessionId,taskId:e.id,isNewSession:t}}),this.getWaitable(!1).trigger(),Promise.resolve()}unpause(){this.transactionBackoffController.reset(),this.getWaitable(!1).trigger()}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return this.tasks.size>0}async hasTasksForUser(e){return Promise.resolve(Array.from(this.tasks.values()).some((t=>t.userId===e)))}updateDependencies(e){this.dependencies=e}async getTotalNumberOfTasks(){return Promise.resolve(this.tasks.size)}async anySessionHasTasks(){return Promise.resolve(this.hasTasks())}async drain(){return this.hasTasks()||this.isProcessingTask?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return Array.from(this.tasks.values()).some((t=>t.operations.some((t=>(0,P.qo)(t.pointer,e)))))}async reset(){return this.tasks=new Map,m.Z.updateRemaining(0),Promise.resolve()}async clearForUser(e){const t=Array.from(this.tasks.values()).filter((t=>t.userId===e));for(const o of t)this.tasks.delete(o.id);return m.Z.updateRemaining(this.tasks.size),Promise.resolve()}async txLoop(){for(;;)try{await this.txLoopIteration()}catch(e){(0,D.Os)(this.retryReasonCounters,"txLoopException"),this.debugLogger.flush(),i.log({level:"error",from:te,type:"txLoopIteration",error:(0,s.Ui)(e)}),A.IE(e),await l.Vs(15e3)}}async txLoopIteration(){const e=this.hasTasks();e||(this.doneSyncing(),this.events.emit("drain"));const[t,o]=(0,W.Z)()?[D.xd,D.CE]:[D.V_,D.Ud];await this.wait(t,e?t:o);const n=Array.from(this.tasks.values()),r=Array.from(n).sort(((e,t)=>e.timestamp-t.timestamp));if(0===r.length)return;const a=[];for(let i=0;i<r.length;i++)r[i]!==n[i]&&a.push(i);a.length>0&&i.log({from:te,level:"warning",type:"TasksNotOrdered",data:{miscDataToConvertToString:{unsortedTaskIds:n.map((e=>e.id)),mismatch:a},taskIds:r.map((e=>e.id))}}),this.startSyncing(),await this.useSaveTransactionsApi(r)}async useSaveTransactionsApi(e){const t=await this.dependencies.handleSaveTransactions(e);if(t.error){const{savedTasks:e,failedTasks:n,message:r,retryDelay:a,retryReason:l}=t.error;var o;if(l?(0,D.Os)(this.retryReasonCounters,l):this.retryReasonCounters={_total:0},e.length>0&&(this.debugLogger.log({level:"debug",from:te,type:"handlePartialSaveTransactionsSuccess",data:{message:`will delete ${e.length} saved tasks`,taskIds:e.map((e=>e.id))}}),await this.cleanupTasks(e,void 0)),n.length>0?(this.debugLogger.flush(),i.log({level:"warning",from:te,type:"handleSaveTransactionsError",data:{message:r,taskIds:n.map((e=>e.id))},error:(0,s.Ui)(t.error)}),await this.cleanupTasks(n,t.error)):this.debugLogger.log({level:"debug",from:te,type:"handleSaveTransactionsRetryableError",data:{message:r}}),a>0)await this.transactionBackoffController.backOffOnFailure(a-D.V_,null===(o=t.error)||void 0===o?void 0:o.retryReason);else this.transactionBackoffController.reset()}else{const e=t.value;this.retryReasonCounters={_total:0},this.debugLogger.log({level:"debug",from:te,type:"handleSaveTransactionsSuccess",data:{message:`will clean up ${e.length} submitted tasks`,taskIds:e.map((e=>e.id))}}),this.transactionBackoffController.reset(),await this.cleanupTasks(e,void 0)}}async cleanupTasks(e,t){for(const n of e)if(n.callback)try{n.callback(t)}catch(o){this.debugLogger.flush(),i.log({level:"error",from:"InMemoryTransactionQueue",type:"cleanupTask",data:{taskId:n.id},error:(0,s.Ui)(o)})}for(const n of e)this.debugLogger.log({from:te,type:"deleteTasksDeleteTask",level:"debug",data:{message:`delete task ${n.id}`,taskId:n.id}}),this.tasks.delete(n.id);return m.Z.updateRemaining(this.tasks.size),Promise.resolve()}getWaitable(e){return this.waiter&&!e||(this.waiter=new l.a6),this.waiter}async wait(e,t){await this.getWaitable(!1).wait(e,t),this.getWaitable(!0)}startSyncing(){B.Z.setState({...B.Z.state,syncing:!0})}doneSyncing(){B.Z.setState({...B.Z.state,syncing:!1})}async healthcheckLoop(){for(;;){try{const e=await this.getTotalNumberOfTasks();if(e>oe.transactionSizeHealthcheckThreshold){const t={queue_type:"InMemoryTransactionQueue",uptime:Date.now()-this.startTime,queue_size:e,error_type:void 0,is_considered_online:B.Z.state.online,retry_reasons:this.retryReasonCounters};this.debugLogger.flush(),i.log({level:"info",from:"InMemoryTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:{queueSize:e}}}),this.dependencies.handleHealthcheck(t)}}catch(e){this.debugLogger.flush(),i.log({level:"error",from:"InMemoryTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(e)}),A.IE(e)}await l.Vs(oe.healthcheckInterval)}}}oe.healthcheckInterval=15*d.hM,oe.transactionSizeHealthcheckThreshold=1e3;const ne=oe;var re=o(68026);const ie="FeatureFlagTransactionQueue",ae="00000000-0000-0000-0000-000000000000";async function se(e){if(!window.indexedDB)return{available:!1,message:"The IndexedDB API is missing or disabled on this platform."};if(e.device.isFirefox){const e="FirefoxFeatureCheck";if(!(await new Promise((t=>{const o=window.indexedDB.open(e);o.onerror=()=>t(!1),o.onsuccess=()=>{t(!0),window.indexedDB.deleteDatabase(e)}}))))return{available:!1,message:"IndexedDB is disabled in Firefox Private Browsing."}}if(e.device.isChrome&&parseInt(e.device.browserVersion,10)>=99){const e="Chrome99FeatureCheck";let o=!1;try{if(o=await new Promise((t=>{const o=window.indexedDB.open(e);o.onerror=()=>t(!1),o.onsuccess=()=>{t(!0),window.indexedDB.deleteDatabase(e)}})),!o)return{available:!1,message:"IndexedDB is unstable in Chrome 99."}}catch(t){return{available:!1,message:(0,r.tg)(t).message}}}return le()&&Y.H.hasOccurredRecently()?{available:!1,message:"A NotionTransactionTimeout has happened recently, avoiding use of IndexedDB.",previousTimeouts:Y.H.getTotal()}:{available:!0}}const le=a.HP((()=>"on"===(0,T.fastGetGroup)("indexeddb_graceful_fallback_to_in_memory_queue")));async function ce(e){const t=new re.TransactionQueueDependenciesImpl(e);async function o(){const o=await se(e);if(!o.available)return i.log({from:ie,level:"warning",type:"preferIndexedDBUnavailable",data:{previousTimeouts:o.previousTimeouts,miscDataToConvertToString:{message:o.message,userAgent:navigator.userAgent}}}),n();i.log({from:ie,type:"preferIndexedDB",level:"info"});const r=function(e,t){const o="react-native"===e.device.platform?ae:(0,c.ZP)(),n=new i.BatchedLogger({from:"IndexedDBTransactionQueue",type:"BulkDebug",level:"info",maxLength:250}),r=new I(n,e);return new J.Z({dependencies:t,transactionStore:r,sessionId:o,debugLogger:n,enableHeartbeatTimeout:le()})}(e,t),l=await(0,C.sK)();if(l&&!(0,C.mn)(l)){let e=!1;try{e=await r.anySessionHasTasks(),i.log({from:ie,type:"indexedDBStorageVeryFull",level:"warning",data:{storage:{hasTasks:e,...l}}})}catch(d){i.log({from:ie,level:"error",type:"indexedDBStorageReadError",data:{storage:l},error:(0,s.Ui)(d)})}if(!e)return new ne(t)}if(e.device.isFirefox)try{const e=await r.checkObjectStores(),o=a.oA([e.transaction,e.session].map((e=>e.error)));if(o.length>0){const n=[];return e.transaction.error&&n.push("Transaction"),e.session.error&&n.push("Session"),i.log({from:ie,level:"error",type:"FirefoxHealthCheckFailed",error:{miscErrorString:(0,s.LK)(o)},data:{message:`Can't read ${n}. Using InMemoryTransactionQueue instead.`}}),new ne(t)}}catch(d){return i.log({from:ie,level:"error",type:"indexedDBHealthCheckError",error:(0,s.Ui)(d)}),new ne(t)}return le()?(r.events.addListener("timeout",(()=>{Y.H.trackPersistently()})),new ee.Z(r,new ne(t))):r}function n(){return i.log({from:ie,type:"preferInMemory",level:"info"}),new ne(t)}const{device:r,mobileNative:p}=e;if(r.isBrowser&&r.isDesktop){if(r.isChrome||r.isFirefox)return o();if(r.isSafari){if(parseInt(r.browserVersion,10)<17)return o();const e=(0,T.fastGetGroup)("safari_17_transaction_queue")??$.default.getGroup("safari_17_transaction_queue");if("force_in_memory"===e)return i.log({from:ie,type:"Safari17.forceInMemoryTransactionQueue",level:"info"}),n();const t=await o();if(t instanceof J.Z){if("prefer_indexed_db"===e)return i.log({from:ie,type:"Safari17.usingIndexedDBTransactionQueue",level:"info"}),t;if((await l.OI(15*d.C0,[t.anySessionHasTasks()])).result)return i.log({from:ie,type:"Safari17.usingIndexedDBToInMemoryTransactionQueue",level:"info"}),new X(t,n())}return i.log({from:ie,type:"Safari17.usingInMemoryTransactionQueue",level:"info"}),n()}return n()}return r.isBrowser&&r.isMobile?n():r.isElectron?o():r.isMobileNative&&p&&p.sqliteConnection?(0,K.Y)("supportsNativeTransactionQueue")?new q(p.sqliteConnection,t,p):new G(p.sqliteConnection,t):n()}(0,n.exposeDebugEnvironmentValue)("getIndexedDBAvailability",(e=>()=>se(e)));let de=new class{constructor(e,t){this.getActiveQueueName=void 0,this.queues=void 0,this.createQueues=void 0,this.getActiveQueueName=e,this.createQueues=t}getQueues(){const e=this.queues?this.queues:this.createQueues();return this.queues=e,e}applyToAllQueues(e){return Object.values(this.getQueues()).map(e)}applyToActiveQueue(e){return e(this.getQueues()[this.getActiveQueueName()])}startLoop(){this.applyToAllQueues((e=>e.startLoop()))}enqueueTask(e){return this.applyToActiveQueue((t=>t.enqueueTask(e)))}unpause(){this.applyToAllQueues((e=>e.unpause()))}pause(){this.applyToAllQueues((e=>e.pause()))}getLastTaskTimestamp(){return this.applyToActiveQueue((e=>e.getLastTaskTimestamp()))}hasTasks(){return this.applyToAllQueues((e=>e.hasTasks())).some(Boolean)}async hasTasksForUser(e){return(await Promise.all(this.applyToAllQueues((t=>t.hasTasksForUser(e))))).some((e=>e))}updateDependencies(e){this.applyToAllQueues((t=>t.updateDependencies(e)))}async anySessionHasTasks(){for(const e of this.applyToAllQueues((e=>e.anySessionHasTasks())))if(await e)return!0;return!1}async getTotalNumberOfTasks(){return a.Sm(await Promise.all(this.applyToAllQueues((e=>e.getTotalNumberOfTasks()))))}async drain(){await Promise.all(this.applyToAllQueues((e=>e.drain())))}awaitRecordTransaction(e){return this.applyToActiveQueue((t=>t.awaitRecordTransaction(e)))}isPendingTransactionForRecord(e){return this.applyToAllQueues((t=>t.isPendingTransactionForRecord(e))).some(Boolean)}async reset(){await Promise.all(this.applyToAllQueues((e=>e.reset())))}async clearForUser(e){await Promise.all(this.applyToAllQueues((t=>t.clearForUser(e))))}}((()=>"error"),(()=>{throw new Error("Need to await setupTransactionQueue")}));const pe=async e=>(de=await ce(e),de),ue=e=>{de=e}},45325:(e,t,o)=>{o.d(t,{ZP:()=>s,ez:()=>i});var n=o(49085),r=o(97880);const i=["mentions","archive","allPages"];class a extends n.default{getInitialState(){return{openState:"closed",currentTab:i[0],filter:"readAndUnread",width:390,isResizerHovered:!1,isResizing:!1,discussionIdToExpansionStartPointMap:{}}}isOpen(){const{openState:e}=this.state;switch(e){case"open":case"opening":return!0;case"closed":case"closing":return!1;default:(0,r.t1)(e)}}isTransitioningOpenState(){const{openState:e}=this.state;switch(e){case"opening":case"closing":return!0;case"open":case"closed":return!1;default:(0,r.t1)(e)}}getPanelWidth(){return"closed"===this.state.openState?0:this.state.width}getPanelWidthReturnZeroForClosingState(){return this.isOpen()?this.state.width:0}}const s=new a},45946:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(53809),r=o(30548);const i=new n.D({key:"openInDesktopApp",namespace:r.$p,important:!0,trackingType:"necessary"})},64970:(e,t,o)=>{o.d(t,{m:()=>n});const n=o(49085).default.createValue(!1)},70704:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isHidden:!1}}}const i=r},79689:(e,t,o)=>{o.d(t,{L:()=>i,c:()=>a});var n=o(49085);const r=new Map;function i(e){const t="shared"===e.type?e.type:`${e.type}${e.teamId}${e.teamOutlinerType}`,o=r.get(t);if(o)return o;{const e=n.default.createValue(!1);return r.set(t,e),e}}function a(){const e=Array.from(r.entries());return 0===e.length||e.every((e=>!e[1].state))}},61364:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{constructor(){super(...arguments),this.containerDomNode=n.default.createValue(null)}getInitialState(){return{overlays:new Set}}}const i=r},19671:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(58484).Z)},93220:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{ready:!1,initialRequestCompleted:!1,loading:!1,endOfResultsReached:!1,error:void 0,currentCursor:void 0,currentChunkNumber:void 0}}}const i=r},85526:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{forceShowProperties:!1}}}const i=new r},94896:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{pages:new Set}}setStatus(e,t){t?this.state.pages.add(e):this.state.pages.delete(e),this.emit()}}const i=new r},82136:(e,t,o)=>{o.d(t,{S:()=>r,Z:()=>a});var n=o(49085);let r=function(e){return e[e.Frame=0]="Frame",e[e.PeekView=1]="PeekView",e[e.InAppTemplatePreview=2]="InAppTemplatePreview",e[e.CollectionPageView=3]="CollectionPageView",e}({});class i extends n.default{getInitialState(){return{forceDiscussionOpen:!1}}}const a=i},85844:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isVisible:!0}}}const i=new r},72014:(e,t,o)=>{o.d(t,{$g:()=>a,jx:()=>s});var n=o(49085),r=o(4615);class i extends n.default{getInitialState(){}initializeNewPageVisitId(){this.setState((0,r.ZP)())}getCurrentPageVisitId(){return this.getState()}}const a=new i,s=new i},30539:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{pageId:void 0,lastViewTime:void 0,lastExitTime:void 0,omittedUserIds:[]}}}const i=r},69503:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1,hasPassword:!1}}isSetNewPasswordModal(){const e=this.state;return!0===e.setNewPassword&&!1===e.isSet}isPasswordSetModal(){const e=this.state;return!0===e.setNewPassword&&!0===e.isSet}isRemovePasswordModal(){const e=this.state;return!0===e.removePassword&&!1===e.isSuccess}isRemovePasswordSuccessModal(){const e=this.state;return!0===e.removePassword&&!0===e.isSuccess}isVerifyIdentityWithMfaModal(){return!0===this.state.verifyIdentity}isPasswordModalClosed(){return!this.state.open}}const i=new r},91551:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(8297).Z)},13023:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(58484).Z)},88923:(e,t,o)=>{o.r(t),o.d(t,{CenterPeekModeOuterWidth:()=>c,PeekModeCenter:()=>i,PeekModeOuterPadding:()=>l,PeekModePadding:()=>s,PeekModeSide:()=>a,default:()=>y,getPeekModeFromCollectionPeekModeFormat:()=>p,getPeekModeFromUrlParam:()=>d,getUrlParamFromPeekMode:()=>u,sidePeekInitialMaxWidth:()=>m,sidePeekMinWidth:()=>h,sidePeekNoColumnWidth:()=>g});var n=o(14577),r=o(49085);const i="center_peek",a="side_peek",s={horizontal:{center_peek:126,side_peek:48}},l=72,c=708+2*s.horizontal[i];function d(e){switch(e){case"s":return a;case"c":return i}}function p(e){switch(e){case"side_peek":return a;case"center_peek":return i}}function u(e){switch(e){case a:return"s";case i:return"c"}}const m=980,g=640,h=430;class f extends r.default{constructor(){super(...arguments),this.isSidePeekOpening=new n.Z((()=>this.state.open&&this.isSidePeekOpen()&&this.state.isOpening),{debugName:"isSidePeekOpening"}),this.isSidePeekClosing=new n.Z((()=>this.state.open&&this.state.isClosing),{debugName:"isSidePeekClosing"}),this.peekTarget=new n.Z((()=>this.state.open?this.state.target:void 0),{debugName:"peekTarget"})}getInitialState(){return{open:!1,mode:i,preferredSidePeekWidth:0,savedSidebarExpandedStoreState:!1}}getCollectionModeFormat(){switch(this.state.mode){case a:return"side_peek";case i:return"center_peek"}}getPeekMode(){return this.state.open?this.state.mode:a}getPeekModeWidth(e){return this.isCenterPeekOpen()?c:this.getSidePeekWidth(e)}getSidePeekWidth(e){const t=Math.min(e/2,m),o=this.state.preferredSidePeekWidth||t;return Math.min(Math.max(o,h),e)}setSidePeekWidth(e,t){const o=Math.min(Math.max(e,h),t);this.setState({...this.state,preferredSidePeekWidth:o})}isCenterPeekOpen(){return this.state.open&&this.state.mode===i}isSidePeekOpen(){return this.state.open&&this.state.mode===a&&!this.state.isClosing}setSidebarExpandedStoreState(e){this.setState({...this.state,savedSidebarExpandedStoreState:e})}}const y=new f},98452:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61766).Z)},99332:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61766).Z)},24612:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61766).Z)},42057:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(92595),r=o(45589);const i=(0,n.exposeDebugValue)("PeekViewScrollerStore",new r.Z)},29677:(e,t,o)=>{o.d(t,{Db:()=>a,cl:()=>r,fZ:()=>n,ow:()=>i});o(49085),o(21202);function n(e){return"existingUser"===e.type}function r(e){return"newUser"===e.type}function i(e){const t=e.inviteTargets[0];return!(!t||"bot"!==t.type)}function a(e){return e.inviteTargets.every((e=>"existingUser"===e.type||"newUser"===e.type||"group"===e.type))}},31194:(e,t,o)=>{o.d(t,{FJ:()=>m,Iw:()=>p,ZP:()=>h,lU:()=>u});var n=o(49085),r=o(4023),i=o(15723);const{Top:a,Bottom:s,Left:l,Right:c,Center:d}=r.u,p=r.u,u=r.v,m=e=>{switch(e){case a:return s;case s:return a;case l:return c;case c:return l;case d:return d}};class g extends n.default{getInitialState(){return{open:!1,placementFlipped:!1,offsetX:0,offsetY:0,originRect:i.bM}}}const h=g},89523:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isActive:!1,userId:void 0}}isReady(){return Boolean(this.state.remotePresenceData)}}r.presentMaxActivityAge=6e4;const i=r},24864:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(70704).Z)},83212:(e,t,o)=>{o.d(t,{Z:()=>l,m:()=>a});var n=o(49085),r=o(27006),i=o(67669);const a={disabled:{hasPublicPermission:!1},view:{hasPublicPermission:!0,permission:"view"},comment:{hasPublicPermission:!0,permission:"comment"},edit:{hasPublicPermission:!0,permission:"edit"}};Object.freeze(a),Object.freeze(a.disabled),Object.freeze(a.view),Object.freeze(a.comment),Object.freeze(a.edit);class s extends n.default{getInitialState(){return{editing:!1,commenting:!1}}getMode(e,t){const o=this.getModeType(e,t)||"disabled";return a[o]}getModeType(e,t){if(!t.isDefaultRecordCache()||!(0,i.IJ)(e,t))return;const o=t.getRole(),n=!o||(0,r.J5)(o),a=!o||(0,r.RF)(o),s=e.currentUser.isLoggedIn();return n&&s&&this.state.editing?"edit":a&&s?"comment":"view"}}const l=new s},81236:(e,t,o)=>{o.d(t,{Z:()=>l});o(84633);var n=o(49085),r=o(92595),i=o(15157);class a extends n.default{constructor(){var e;super(...arguments),e=this,this.fetchSpaceIds=new Set,this.fetchedSpaceIds=new Set,this.fetch=async function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await Promise.resolve().then(o.bind(o,54642)),a=t.currentUser.id,s=Array.from(e.fetchSpaceIds.values());try{if(s.length>0){if(!n){for(const t of s){const o=i.Z.get({userId:a,key:e.getLocalKey(t)});o&&(e.setPublicSpaceData(t,o),e.fetchSpaceIds.delete(t),e.fetchedSpaceIds.add(t))}e.setState({...e.state,fetching:!1})}const o=await r.getPublicSpaceData(t,{type:"space-ids",spaceIds:s});"success"===o.type&&o.data.results.forEach(((t,o)=>{if(t){const n=s[o];e.setPublicSpaceData(n,t),i.Z.set({userId:a,key:e.getLocalKey(n),value:t}),e.fetchSpaceIds.delete(n),e.fetchedSpaceIds.add(n)}}))}}finally{e.setState({...e.state,fetching:!1})}}}getInitialState(){return{publicSpaceDataMap:{},fetching:!1}}getPublicSpaceData(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return o&&(this.fetchSpaceIds.delete(t),this.fetchedSpaceIds.delete(t)),this.fetchSpaceIds.has(t)||this.fetchedSpaceIds.has(t)||(this.fetchSpaceIds.add(t),this.setState({...this.state,fetching:!0}),setImmediate((()=>this.fetch(e,o)))),this.state.publicSpaceDataMap[t]}async awaitPublicSpaceData(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.getPublicSpaceData(e,t,o),await this.waitUntil((()=>Boolean(this.state.publicSpaceDataMap[t])&&!this.state.fetching)),this.state.publicSpaceDataMap[t]}setPublicSpaceData(e,t){this.state.publicSpaceDataMap[e]=t||null,this.emit()}TEST_ONLY__setPublicSpaceData(e,t){this.fetchedSpaceIds.add(e),this.state.publicSpaceDataMap[e]=t||null,this.emit()}getLocalKey(e){return`${a.localKeyPrefix}:${e}`}}a.localKeyPrefix="PublicSpaceData";const s=new a;r.exposeDebugValue("PublicSpaceDataStore",s);const l=s},69784:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isActive:!1}}}const i=new r},13105:(e,t,o)=>{o.d(t,{P:()=>i});var n=o(14577),r=o(92595);class i{constructor(e){this.memo=new WeakMap,this.debugName=void 0,this.hits=0,this.misses=0,this.getStateFor=e=>this.computeMemo(e),this.computeMemo=e=>{let t=this.memo.get(e);return t?this.hits++:(this.misses++,t=new n.Z((()=>this.options.compute(e,this.options.memoizeRecursion?this.computeMemo:this.computeNonMemo)),{debugName:this.debugName}),this.memo.set(e,t)),t.getState()},this.computeNonMemo=e=>this.options.compute(e,this.computeNonMemo),this.options=e,this.debugName=`RecursiveComputedStore.${e.debugName}`,(0,r.exposeDebugInstance)(this.debugName,this)}}},64951:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{}}isActive(){return Boolean(this.state.blockStore)}}const i=new r},82187:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{}}isActive(){return Boolean(this.state.clonedBlockStore)}}const i=new r},72087:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{ready:!1,loading:!1}}}const i=r},91681:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isResizing:!1}}}const i=new r},76967:(e,t,o)=>{o.r(t),o.d(t,{default:()=>a,groupIntervalMs:()=>r});var n=o(49085);const r=700;class i extends n.default{getInitialState(){return{type:"legacy",undoStack:[],redoStack:[]}}}const a=new i},49557:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(92595);class i extends n.default{getInitialState(){return{isActive:!1,isAnimatingClosed:!1,top:0,left:0}}}const a=(0,r.exposeDebugValue)("RichTextMenuStore",new i)},4935:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61766).Z)},45589:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isScrolling:!1,scrollTop:0,scrollHeight:0,scrollLeft:0,scrollWidth:0,clientWidth:0}}}const i=r},32470:(e,t,o)=>{o.d(t,{BJ:()=>m,ZP:()=>f,gq:()=>h,lO:()=>g,v_:()=>u});var n=o(49085),r=o(15157),i=o(72126),a=o(53772),s=o(95477);const l="SearchDebugStorePersistenceKey";class c extends n.default{setState(e){super.setState(e),function(e){let{newState:t,key:o}=e;r.Z.set({userId:"global",key:o,value:t})}({newState:e,key:this.getPersistenceKey()})}setStateWithoutPersisting(e){super.setState(e)}reloadFromDisk(){const e=r.Z.get({userId:"global",key:this.getPersistenceKey()});super.setState({...this.getInitialState(),...e})}}class d extends c{constructor(e){super(),this.column=void 0,this.getPersistenceKey=()=>`SearchDebugStorePersistenceKey:${this.column}`,this.updateForcedClusterPattern=e=>{this.setState({...this.state,forcedClusterPattern:e})},this.updateForcedBlockIds=e=>{this.setState({...this.state,forcedBlockIds:e})},this.column=e}getInitialState(){return{forcedClusterPattern:void 0,forcedBlockIds:void 0,searchExperimentOverrides:{},visible:!0}}hasDebugOverrides(){return!i.xb(this.state.forcedClusterPattern)||!i.xb(this.state.searchExperimentOverrides)||!i.xb(this.state.forcedBlockIds)}}const p=new class extends c{constructor(){super(...arguments),this.getPersistenceKey=()=>l}getInitialState(){return{showDebugInfo:!1,debug:void 0}}getDebugLevel(){return this.state.debug??(this.state.showDebugInfo?"explain":void 0)}},u=new d("left"),m=new d("right");function g(){p.reloadFromDisk(),u.reloadFromDisk(),m.reloadFromDisk()}function h(e){let{device:t}=e;return(0,a.x)(s.default)&&!t.isMobile&&(u.hasDebugOverrides()||m.hasDebugOverrides()||u.state.forcedClusterPattern||m.state.forcedClusterPattern)&&m.state.visible}const f=p},55320:(e,t,o)=>{o.r(t),o.d(t,{default:()=>l});var n=o(49085),r=o(94804),i=o(59139),a=o(77080);class s extends n.default{getInitialState(){return{open:!1,openAsPage:!1,openedTimeMs:void 0,sessionId:void 0,isPublicPageSearch:!1,shouldSidePeekOpen:!1}}closeAndResetMetricsState(){this.update((e=>({...e,open:!1,openAsPage:!1,openedTimeMs:void 0,sessionId:void 0})))}isOpen(){return this.state.open||this.state.openAsPage}setShouldSidePeekOpenToDefault(e){const t=()=>{if(e.device.isMobile)return!1;const t=e.currentUser.id;if(!(0,i.rd)(e)||!t)return!1;return!a.default.checkGate("search_toggle_side_peek")||(0,r.w8)(t)};this.update((e=>({...e,shouldSidePeekOpen:t()})))}}const l=new s},87956:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){}}const i=new r},29026:(e,t,o)=>{o.d(t,{Xv:()=>l,ZP:()=>p});var n=o(49085),r=o(15157),i=o(94804),a=o(92338),s=o(80444);const l=20;let c=function(e){return e.Default="Default",e.Results="Results",e}({});class d extends n.default{constructor(){super(...arguments),this.resetQuery=e=>{let{resetFilters:t}=e;this.setState({...this.state,query:{...this.state.query,text:"",...t&&{filters:(0,a.u4)()}},limit:l,source:"quick_find_input_change"})},this.resetFilters=()=>{this.update((e=>({...e,query:{...e.query,filters:(0,a.u4)()}})))},this.updateFilters=e=>{const t=this.state.query.filters,o=(0,a.jl)(t,e);this.setState({...this.state,query:{...this.state.query,filters:o},limit:l,source:"quick_find_filters"})},this.expandFilterBar=()=>{this.updateFilterBarVisibilityState(!0)},this.collapseFilterBar=()=>{this.updateFilterBarVisibilityState(!1)},this.updateFilterBarVisibilityState=e=>{var t;const o=null===(t=s.default.state.currentUserStore)||void 0===t?void 0:t.id;o&&(r.Z.set({userId:o,key:i.rE,value:e}),this.update((t=>({...t,showFilterBar:e}))))},this.updateQueryText=e=>{this.setState({...this.state,query:{...this.state.query,text:e},limit:l,source:"quick_find_input_change"})}}getInitialState(){return{mode:"search",isSidePeekPanelOpen:!1,isDebugSidebarOpen:!1,showFilterBar:!0,query:{text:"",filters:(0,a.u4)(),sort:{field:"relevance"}},limit:l,source:"quick_find",hasScrolled:!1,filterState:{filterOrder:["workspaceSwitcher","titleToggle","personFilter","teamsFilter","pageFilter","dateFilter","dev_notInPageFilter","dev_notInTeamFilter"]}}}updateFilterState(e){this.setState({...this.state,filterState:e})}hasQuery(){return Boolean(this.state.query.text)}isDebugSidebarOpen(){return this.state.isDebugSidebarOpen}}d.Mode=c;const p=new d},86486:(e,t,o)=>{o.r(t),o.d(t,{default:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isOpen:!1}}}const i=new r},50628:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085),r=o(92595);class i extends n.default{getInitialState(){return{selectableRectMap:new Map,selectableContainerRectMap:new Map,selectableElementRectMap:new Map,lastUpdate:0}}hasBeenUpdatedSince(e){return this.state.lastUpdate>e}}const a=new i;(0,r.exposeDebugValue)("SelectableRectStore",a);const s=a},27724:(e,t,o)=>{o.r(t),o.d(t,{SelectionPhase:()=>c,default:()=>p});var n=o(49085),r=o(97880),i=o(16339),a=o(95802),s=o(88923),l=o(35661);let c=function(e){return e[e.Selected=0]="Selected",e[e.Editing=1]="Editing",e}({});class d extends n.default{getInitialState(){return{stores:[],phase:c.Selected}}cloneState(){return{stores:[...this.state.stores],phase:this.state.phase}}getEditing(){if(this.state.phase===c.Editing)return this.state.stores[0]}isSelected(){return this.state.stores.length>0&&this.state.phase===c.Selected}getNodes(){return this.state.stores.map((e=>a.C.findNodeFromStore(e)||void 0)).filter(r.$K)}getCurrentRootStore(){var e,t;const o=null===(e=this.getCurrentDefaultContainer())||void 0===e?void 0:e.props.store;return o&&o instanceof l.G?o:null===(t=this.getDefaultContainer())||void 0===t||null===(t=t.props)||void 0===t?void 0:t.store}getCurrentRecordCache(){const e=this.getCurrentRootStore();if(e)return e.inMemoryRecordCache}getDefaultContainerFromTarget(e){return i.Z.find((t=>{const o=t.getNode();return Boolean(o&&o.contains(e))}))}getCurrentDefaultContainer(){const e=this.state.anchorContainer;return e||this.getDefaultContainer()}getDefaultContainer(){const e=this.state.defaultContainerStack;if(e&&e.length>0)return e[e.length-1]}isInPeekRenderer(){if(this.state.anchorContainer)return Boolean(this.state.anchorContainer.isPeekRenderer());{var e;const t=Boolean(null===(e=this.state.anchor)||void 0===e?void 0:e.isPageBlock()),o=s.default.state.open&&this.state.anchor===s.default.state.target;return t&&o}}}const p=new d},77794:(e,t,o)=>{o.d(t,{E:()=>a});var n=o(49085),r=o(72126),i=o(15723);class a{constructor(e){this.rect=n.default.createValue(i.bM),this.el=void 0,this.resizeObserver=void 0,this.options=void 0,this.recomputeThrottled=void 0,this.recompute=()=>{var e;const t=(null===(e=this.el)||void 0===e?void 0:e.getBoundingClientRect())??i.bM;return this.rect.setState(t),t},this.options=e||{},this.options.throttleMs&&(this.recomputeThrottled=r.P2(this.recompute,this.options.throttleMs))}observe(e){this.el=e,"undefined"!=typeof ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.getRecomputeFn()),this.resizeObserver.observe(this.el)),this.recompute()}destroy(){this.resizeObserver&&this.resizeObserver.disconnect()}getRecomputeFn(){return this.recomputeThrottled||this.recompute}}},10743:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},1310:(e,t,o)=>{o.d(t,{JY:()=>i,Ty:()=>r,ZP:()=>s});var n=o(49085);const r=5e3,i=1e4;class a extends n.default{getInitialState(){return{currentItem:void 0,shouldReset:!0}}}const s=new a},64404:(e,t,o)=>{o.d(t,{Q:()=>r,Z:()=>a});var n=o(49085);let r=function(e){return e.Members="members",e.Groups="groups",e.Guests="guests",e.Reprovisioning="reprovisioning",e.Requests="requests",e}({});class i extends n.default{getInitialState(){return{currentTab:r.Members,limitMembers:!0,limitGuests:!0,limitTeamGuests:!0,membersFilter:"",guestsFilter:"",teamGuestsFilter:"",groupsFilter:"",groupNameInputValue:"",upsellModalOpen:!1,sorts:{members:{group:"members",by:"role",asc:!1},guests:void 0,team_guests:void 0}}}}const a=i},92083:(e,t,o)=>{o.d(t,{R:()=>r,Z:()=>a});var n=o(49085);let r=function(e){return e[e.OpenInDesktopApp=0]="OpenInDesktopApp",e[e.TwoStepVerification=1]="TwoStepVerification",e}({});class i extends n.default{getInitialState(){return{open:!1,currentTab:"settings",defaultSubtab:void 0,highlightedSetting:void 0,openedFrom:void 0}}}const a=new i},27242:(e,t,o)=>{o.d(t,{U:()=>r,Z:()=>a});var n=o(49085);let r=function(e){return e.CurrentSpace="current-space",e.TargetSpace="domain-claim-upgrade-team-plan-workspace",e}({});class i extends n.default{getInitialState(){return{open:!1,type:r.CurrentSpace}}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}closeWithFailure(){this.setState({open:!1,succeeded:!1})}open(e){const{subscriptionTier:t,addOnFeature:o,billingInterval:n,coupon:i,isTrial:a,sessionId:s}=e;this.setState({open:!0,temporaryBillingInterval:n,temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,subscriptionTier:t,vatApplicable:!1,calculatingTax:!1,payButtonState:"enabled",type:r.CurrentSpace,addOnFeature:o,onlyShowAddOn:void 0!==o,sessionId:s,coupon:i,isTrial:a})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}}const a=new i},9209:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},78291:(e,t,o)=>{o.r(t),o.d(t,{default:()=>a});o(21703),o(30120);var n=o(49085),r=o(47425);o(95477);class i extends n.default{getInitialState(){return{}}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state.data)))}getSubscriptionTier(){var e;return(0,r.O9)(null===(e=this.state.data)||void 0===e?void 0:e.subscriptionTier)}setTestClockSeconds(e){throw new Error("Cannot set test clock time in production")}}const a=new i},99757:(e,t,o)=>{o.d(t,{Z:()=>l,n:()=>s});var n=o(14577),r=o(49085);class i extends r.default{constructor(){super(...arguments),this.updateRemaining=e=>{this.state.remainingPending!==e&&(0===e?this.setState({...this.state,totalPending:0,remainingPending:0}):this.setState({...this.state,remainingPending:e}))}}getInitialState(){return{totalPending:0,remainingPending:0,transactionQueueError:void 0,storageUsageEstimate:void 0,connectionError:void 0}}percentComplete(e){if(this.state.totalPending>0){const t=1-this.state.remainingPending/this.state.totalPending;return e.formatNumber(t,{style:"percent",maximumFractionDigits:0})}return e.formatNumber(1,{style:"percent"})}setOrIncTotal(e){this.state.totalPending>e?this.setState({...this.state,totalPending:this.state.totalPending+1}):this.setState({...this.state,totalPending:e})}}const a=new i,s=new n.Z((()=>Boolean(a.state.transactionQueueError)),{debugName:"transactionQueueUnhealthyStore"}),l=a},26634:(e,t,o)=>{o.d(t,{Om:()=>r,_W:()=>a,o:()=>i});var n=o(99757);function r(){n.Z.setState({...n.Z.state,connectionError:void 0})}function i(e){const{connectionError:t}=n.Z.state,o=Date.now(),r=void 0===e.backoffEstimate?void 0:e.backoffEstimate+o;n.Z.setState({...n.Z.state,connectionError:{startTime:(null==t?void 0:t.startTime)??o,numAttempts:t?t.numAttempts+1:1,approximateBackoffDelayEndTime:r,retryReason:e.retryReason??(null==t?void 0:t.retryReason)}})}const a={onReset:r,onBackoff(e,t){i({backoffEstimate:e,retryReason:t})}}},29370:(e,t,o)=>{o.d(t,{N:()=>i,Z:()=>s});var n=o(49085),r=o(72126);function i(e,t){return e.collectionViewBlockStore===t.collectionViewBlockStore&&r.Xy(e.groupFormat,t.groupFormat)}class a extends n.default{getInitialState(){return{isActive:!1}}cloneState(){return r.d9(this.state)}}const s=new a},42185:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o(49085).default.createValue(void 0)},30397:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{teams:[],lastEmitData:{value:"no value saved yet",spaceId:void 0,userId:void 0}}}shouldRefetchTeamsInSpace(e){let{currentUserId:t,currentSpaceId:o,emitValue:n}=e;const{spaceId:r,userId:i,value:a}=this.state.lastEmitData;return o!==r||(t!==i||n!==a)}}const i=new r},24666:(e,t,o)=>{o.r(t),o.d(t,{TextSelectionStore:()=>l,default:()=>c});var n=o(14577),r=o(49085),i=o(72126),a=o(62965),s=o(68056);class l extends r.default{constructor(){super(...arguments),this.isEditingStore=new n.Z((()=>"editing"===this.state.mode),{debugName:"isEditingStore"}),this.isExpandedStore=new n.Z((()=>"empty"!==this.state.mode&&!(0,s.iG)(this.state.multiSelection)),{debugName:"isExpandedStore"})}getInitialState(){return{mode:"empty"}}setState(e){if("empty"===e.mode||"empty"===this.instanceState.mode)return super.setState(e);if(!(0,a.Z)(this.instanceState,e)){const{savedSelectionXPosition:t,...o}=this.instanceState,{savedSelectionXPosition:n,...r}=e;this.instanceState=e,(0,a.Z)(o,r)||this.emit()}}cloneState(){return"editing"===this.state.mode?{mode:"editing",multiSelection:(0,s.k_)(this.state.multiSelection),savedSelectionXPosition:this.state.savedSelectionXPosition,forceExtendAnnotations:i.Xh(this.state.forceExtendAnnotations)}:"readOnly"===this.state.mode?{mode:"readOnly",multiSelection:(0,s.k_)(this.state.multiSelection),savedSelectionXPosition:this.state.savedSelectionXPosition}:{mode:"empty"}}isEmptySelection(){if("empty"===this.state.mode)return!0;const{multiSelection:e}=this.state;return(0,s.iG)(e)}isEditingComment(){return"editing"===this.state.mode&&("comment"===this.state.multiSelection.start.store.table||"comment"===this.state.multiSelection.end.store.table)}isEditingCaption(){return"editing"===this.state.mode&&(i.Xy(this.state.multiSelection.start.store.path,["properties","caption"])||i.Xy(this.state.multiSelection.end.store.path,["properties","caption"]))}hasSelection(){return"empty"!==this.state.mode}isEditingEmptyBlock(){return!("empty"===this.state.mode||!this.isEmptySelection())&&!this.state.multiSelection.start.store.isDefined()}}const c=new l},45131:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{}}setOpen(e,t){this.setState({...this.state,[e]:t})}toggle(e){this.setState({...this.state,[e]:!this.isOpen(e)})}isOpen(e){return!!this.state[e]}}const i=new r},48588:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085),r=o(92595);class i extends n.default{getInitialState(){}}const a=new i;(0,r.exposeDebugValue)("TokenHoverStore",a);const s=a},58948:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{focused:!1,hovered:!1}}}const i=r},16194:(e,t,o)=>{o.d(t,{Z:()=>n});const n=o(49085).default.createValue(!1)},52258:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61766).Z)},66708:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61766).Z)},77503:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61766).Z)},59238:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{isDragging:!1}}}const i=new r},68026:(e,t,o)=>{o.r(t),o.d(t,{TransactionQueueDependenciesImpl:()=>F});var n=o(68626),r=o(91155),i=o(21051),a=o(50906),s=(o(21703),o(57658),o(92595)),l=o(59730),c=o(72126),d=o(4615),p=o(97880),u=o(5366),m=o(54642),g=o(47307),h=o(77080),f=o(56518),y=o(33954),v=o(24608),b=o(33929),S=o(44133),_=o(482),w=o(4408);async function k(e,t){const o=c.mN(t.operations.flatMap((e=>[e.pointer,...(0,_.S)(e)?e.additionalUpdatedPointers??[]:[]])),(e=>e.id));await Promise.all(o.map((o=>w.HB({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:o,userId:t.userId}))))}var x=o(99341);let I=0;const C=(0,u.defineMessages)({requestTooLarge:{id:"transactionHelpers.requestTooLargeError.message",defaultMessage:"Sorry, that request was too large."},requestTooLargeTryImportInstead:{id:"transactionHelpers.requestTooLargeError.message.tryImportInstead",defaultMessage:"Sorry, that request was too large. Try import instead?"}});let T=!1;(0,s.exposeDebugValue)("toggleTransactionQueue",(()=>{T=!T,console.info(T?"Transactions paused":"Transactions resumed")}));class M extends Error{constructor(e){super(e.message),this.retryDelay=void 0,this.retryReason=void 0,this.savedTasks=void 0,this.failedTasks=void 0,this.clientData=void 0,this.name="HandleSaveTransactionsError",this.retryDelay=e.retryDelay,this.retryReason=e.retryReason,this.savedTasks=e.savedTasks,this.failedTasks=e.failedTasks,this.clientData=e.clientData}}function P(e){if(1===e.subTasks.length)return e.task.debug;const t=new Map;for(const n of e.subTasks){var o;const e=null===(o=n.debug)||void 0===o?void 0:o.userAction;if(e){const o=t.get(e)??0;t.set(e,o+1)}}return{...e.task.debug,squashedUserActions:Object.fromEntries(t)}}async function A(e){if(T)return{value:[]};const{environment:t,tasks:o}=e,i=function(e,t){const o=new Set(t.map((e=>e.timestamp))),n=t.length-o.size;return n>0&&a.LAz(e,{collision_count:n}),n}(t,o),{userId:s,squashedTasks:u}=x.Vm(o,{allowSquashing:!0}),_=u.map((e=>({id:e.task.id,spaceId:e.task.spaceId,debug:P(e),operations:e.task.operations,inSudoMode:e.task.useSudoMode}))),w=(0,d.ZP)(),k=h.default.checkGate("client_http_gzip")?"gzip":void 0,A=await m.saveTransactions(t,{requestId:w,transactions:_},s,void 0,void 0,void 0,k);if("success"===A.type)return I=0,{value:u.flatMap((e=>e.subTasks))};const F="Notion is unavailable, please try again later."===A.error.message;if(!F&&!A.error.data.offline||Math.random()<.01){const e=[...new Set(_.map((e=>e.spaceId??"NO_SPACE_ID")))];n.log({level:"error",from:"transactionActions",type:"ClientTransactionError",error:{miscErrorString:(0,r.LK)(A)},data:{requestId:w,miscDataToConvertToString:{transactions:_},userId:t.currentUser.id,spaceIds:e}})}if(413===A.status){let e,o,r=0;u.forEach((t=>{var n,i;null!==(n=t.task.debug)&&void 0!==n&&n.userAction&&(e=t.task.debug.userAction),null!==(i=t.task.debug)&&void 0!==i&&i.userFlow&&(o=t.task.debug.userFlow),r+=t.subTasks.length})),n.log({level:"error",from:"transactionActions",type:"ClientTransaction413Error",data:{totalTaskCount:r,userId:t.currentUser.id,requestId:w,userAction:e,userFlow:o}});const i=JSON.stringify(_);a.F4S(t,{totalTaskCount:r,payloadLength:i.length,userAction:e});const s=Math.ceil(i.length/x._V);for(let a=0;a<s;a++)n.log({level:"error",from:"transactionActions",type:"ClientTransaction413ErrorRecovery",data:{userId:t.currentUser.id,totalTaskCount:r,requestId:w,miscDataToConvertToString:{chunkTotal:s,chunkIndex:a,operationChunk:i.slice(a*x._V,(a+1)*x._V)}}});g.showErrorMessage(b.default.formatMessage(e===f.xF?C.requestTooLargeTryImportInstead:C.requestTooLarge))}const N=e=>{const o=I;if(e.failedTasks.length>0&&(I+=1),!F&&!A.error.data.offline){var s,l;const c=e.failedTasks.length>0?e.failedTasks[0]:void 0;c&&"space_not_found_in_record_path"===(null===(s=e.clientData)||void 0===s?void 0:s.type)&&n.log({level:"error",from:"transactionActions",type:"ClientTransactionSpaceNotFoundError",error:(0,r.Ui)(e),data:{userId:t.currentUser.id,requestId:w,miscDataToConvertToString:(0,S.getDebugSourcesForIdsInOperations)(t,c.operations)}}),a.mcx(t,{status:A.status,message:(0,v.pO)(A),previous_consecutive_rollbacks:o,saved_tasks:e.savedTasks.length,failed_tasks:e.failedTasks.length,first_failed_task_user_action:null==c||null===(l=c.debug)||void 0===l?void 0:l.userAction,will_retry:e.retryDelay>0,retry_reason:e.retryReason,timestamp_collision_count:i})}return{error:e}};if((0,l.Rp)(A.body)){if((0,l.oE)(A.body.clientData)){const{errors:e}=A.body.clientData,o=e[0],n=u.findIndex((e=>e.task.id===o.id));if(n<0)return B(t,w,o),N(new M({message:o.name,clientData:o.clientData,retryDelay:0,retryReason:void 0,savedTasks:[],failedTasks:[]}));const r=u.slice(0,n),i=r.flatMap((e=>e.subTasks)),a=[],s=[],l=[];let c=n,d=0,m=0;for(const p of e){const e=u[c];p.id===e.task.id?(p.retryable?(s.push({error:p,squashedTask:e}),m+=1):(d+=1,await D(t,e.task,w),e.subTasks.forEach((e=>a.push(e))),l.push({error:p,squashedTask:e})),c++):B(t,w,p)}const g=[`${r.length} successful`,d>0?`${d} failed unretryable (data loss)`:void 0,m>0?`${m} retryable`:void 0].filter(p.$K).join(", "),h=[`API error for ${u.length} transactions: ${g}.`,R(l,"unretryable"),R(s,"retryable")].filter(p.$K).join(" ");let f,y=0;return s.length>0&&(y=2e3,f=s[0].error.name),N(new M({savedTasks:i,failedTasks:a,message:h,retryDelay:y,retryReason:f,clientData:o.clientData}))}if(c.q9(E,A.status))return await Promise.all(u.map((e=>D(t,e.task,w)))),N(new M({savedTasks:[],failedTasks:u.flatMap((e=>e.subTasks)),message:(0,y.wf)(b.default.getIntl(),A),retryDelay:0,retryReason:void 0}))}let j=`http${A.status}`;return A.error.data.offline?j="offline":F&&(j="notionUnavailable"),N(new M({savedTasks:[],failedTasks:[],message:(0,y.wf)(b.default.getIntl(),A),retryDelay:5e3,retryReason:j}))}async function D(e,t,o){try{await k(e,t)}catch(i){n.log({level:"error",from:"transactionActions",type:"ClientTransactionCleanupError",error:(0,r.Ui)(i),data:{userId:e.currentUser.id,requestId:o}})}}function B(e,t,o){n.log({level:"error",from:"transactionActions",type:"ClientTransactionNotFoundError",error:(0,r.Ui)(o),data:{userId:e.currentUser.id,requestId:t}})}function R(e,t){if(e.length>0){var o;const{error:n,squashedTask:{task:r}}=e[0];return`First ${t} error: ${n.name} for transaction ${r.id} created by ${null===(o=r.debug)||void 0===o?void 0:o.userAction}.`}}const E=[400,413];class F{constructor(e){this.timeSource=i.O,this.environment=e}getExperimentGroup(e){return h.default.getGroup(e)}handleSaveTransactions(e){return A({environment:this.environment,tasks:e})}handleHealthcheck(e){a.h23(this.environment,e)}async rollbackTask(e){try{await k(this.environment,e)}catch(t){n.log({level:"error",from:"TransactionQueueDependencies",type:"ClientTransactionCleanupError",error:(0,r.Ui)(t),data:{userId:this.environment.currentUser.id}})}}}},9425:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(88893),r=o(77080),i=o(78291);function a(){const{data:e}=i.default.state;return!(!e||(0,n.CM)(e).length>1)&&r.default.checkGate("optimize_single_workspace")}},1634:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},80064:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},40671:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{updatingUrls:new Set}}add(e){this.state.updatingUrls.add(e),this.emit()}delete(e){this.state.updatingUrls.delete(e),this.emit()}}const i=new r},85703:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{}}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state.data)))}}const i=new r},62820:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(61766).Z)},4761:(e,t,o)=>{o.d(t,{ZP:()=>l,g0:()=>a,n_:()=>c});var n=o(49085),r=o(4615),i=o(97880);function a(e){return"mentions"===e||"allPages"!==e&&"archive"!==e&&void(0,i.t1)(e)}class s extends n.default{getInitialState(){return{currentTab:"mentions",isCurrentTabEmpty:!0,containsBothReadAndUnreadNotifications:!1,containsUnreadNotifications:!1,loadingId:void 0,sessionId:void 0,showOnlyUnreadNotifications:!1,unreadNotificationIds:[]}}startSession(){let{forceRestart:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(void 0===this.state.sessionId||e)&&this.setState({...this.state,sessionId:(0,r.ZP)()})}endSession(){this.setState({...this.state,sessionId:void 0})}startLoading(){const e=Math.random().toString();return this.setState({...this.state,loadingId:e}),e}endLoading(e){e===this.state.loadingId&&this.setState({...this.state,loadingId:void 0})}isFilteredToUnreadOnly(){if("mentions"===this.state.currentTab)return this.state.showOnlyUnreadNotifications}}const l=new s,c=n.default.createValue(!0)},29226:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(49085),r=o(29477);class i extends n.default{getInitialState(){return{readyPromise:(0,r.UZ)(),localSpaceInaccessiblePages:void 0,remoteSpaceInaccessiblePages:void 0}}getSpaceInaccessiblePages(e,t){const o=this.state;return o.remoteSpaceInaccessiblePages&&o.remoteSpaceInaccessiblePages[t]?o.remoteSpaceInaccessiblePages[t][e]:o.localSpaceInaccessiblePages&&o.localSpaceInaccessiblePages[t]?o.localSpaceInaccessiblePages[t][e]:void 0}}const a=new i},28209:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{userHomePageId:void 0,personalHomePageId:void 0}}}const i=new r},33759:(e,t,o)=>{o.d(t,{Z:()=>n});const n=new(o(85974).Z)},89403:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{}}}const i=new r},85974:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{loginType:"email",email:"",password:"",hasAccount:!1,showPassword:!1,signUpLinkSent:!1,hiddenPasscode:!1,forceAdminSamlLogin:!1}}isGoogle(){return"google"===this.state.loginType}isEmail(){return"email"===this.state.loginType}isReverifying(){return"reverify"===this.state.loginType}isTemporaryPasscode(){return"temporary"===this.state.loginType}isExclusiveLoginLinkTemporaryPasscode(){return"temporary"===this.state.loginType&&Boolean(this.state.hiddenPasscode)}isPassword(){return"password"===this.state.loginType}isForgotPassword(){return"forgot"===this.state.loginType}isPasswordResetSent(){return"reset"===this.state.loginType}isSaml(){return"saml"===this.state.loginType}isMfa(){return"mfa"===this.state.loginType}}const i=r},7339:(e,t,o)=>{o.d(t,{C:()=>_,Z:()=>v});o(21703);var n=o(30120),r=o(41351),i=o.n(r),a=o(49085),s=o(7406),l=o(68626),c=o(91155),d=o(90965),p=o(34886),u=o(97880),m=o(24215),g=o(12955),h=o(97448),f=o(35057),y=o(80444);const v="group";class b extends a.default{constructor(){super(...arguments),this.environment=void 0}getInitialState(){return{currentUserId:void 0,currentSpaceId:void 0,ready:!1}}isInitialized(){return h.StatsigInitializer.isComplete}async initialize(e){const t=Date.now();this.environment=e;const{userId:o,spaceId:n}=S(e);if(this.isInitialized()&&void 0!==o)await this.updateUserAndSpace(e);else try{this.setStateBeforeInitOrUpdate(o,n),await this.confirmInitializeDidSucceed(),await this.updateStatsigUserWithAllKnownFields({environment:e,stage:"initialize"}),this.setStateAfterInitOrUpdate(o,n),this.trackMetric("statsig_client_init_success")}catch(r){this.logError("initialize",r,{nextUserId:o}),this.trackMetric("statsig_client_init_error")}finally{this.trackMetric("statsig_client_init_duration",{time:Date.now()-t})}}async updateUserAndSpace(e){const{userId:t,spaceId:o}=S(e);this.state.currentUserId===t&&this.state.currentSpaceId===o||(this.setStateBeforeInitOrUpdate(t,o),await this.updateStatsigUserWithAllKnownFields({environment:e,stage:"updateUserAndSpace"}),this.setStateAfterInitOrUpdate(t,o))}async confirmInitializeDidSucceed(){if(!h.StatsigInitializer.initializePromise)throw new Error("`statsig.initialize` was not called on app bootstrap");if(await h.StatsigInitializer.initializePromise,h.StatsigInitializer.error)throw h.StatsigInitializer.error}async updateStatsigUserWithAllKnownFields(e){let{environment:t,stage:o}=e;const n=Date.now();try{const e=await this.createStatsigUser(t);await i().updateUser(e),this.trackMetric("statsig_client_update_user_success")}catch(r){this.logError("updateUser",r,{nextUserId:t.currentUser.id,err:(0,s.tg)(r).message,stage:o}),this.trackMetric("statsig_client_update_user_error")}finally{this.trackMetric("statsig_client_update_user_duration",{time:Date.now()-n})}}setStateBeforeInitOrUpdate(e,t){super.setState({currentUserId:e,currentSpaceId:t,ready:!1})}setStateAfterInitOrUpdate(e,t){const{currentSpaceId:o,currentUserId:n}=super.getState();o===t&&n===e&&super.setState({currentUserId:e,currentSpaceId:t,ready:!0})}getGroup(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v,n=arguments.length>3?arguments[3]:void 0;const r=Date.now();if(!this.isInitialized())return;let a;try{return a=t?i().getExperimentWithExposureLoggingDisabled(e):i().getExperiment(e),this.trackMetric("statsig_client_get_group_success",{experiment_id:e}),a.get(o,n)}catch(s){this.trackMetric("statsig_client_get_group_error",{experiment_id:e}),this.logError("getGroup",s,{experimentId:e,expConfig:JSON.stringify(a)})}finally{this.trackMetric("statsig_client_get_group_duration",{time:Date.now()-r})}}manuallyLogExperimentExposure(e){i().manuallyLogExperimentExposure(e)}checkGate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=Date.now();if(!this.isInitialized())return!1;let n;try{return n=t?i().checkGateWithExposureLoggingDisabled(e):i().checkGate(e),this.trackMetric("statsig_client_check_gate_success",{gate_name:e}),n}catch(r){const t=r instanceof Error?r.message:void 0;return this.logError("checkGate",r,{gateName:e,...t&&{errorMessage:t}}),this.trackMetric("statsig_client_check_gate_error",{gate_name:e}),!1}finally{this.trackMetric("statsig_client_check_gate_duration",{time:Date.now()-o})}}getConfig(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o=Date.now();if(!this.isInitialized())return;let n;try{return n=t?i().getConfig(e):i().getConfigWithExposureLoggingDisabled(e),this.trackMetric("statsig_client_get_config_success",{config_name:e}),n}catch(r){const t=r instanceof Error?r.message:void 0;return this.logError("getConfig",r,{dynamicConfigName:e,...t&&{errorMessage:t}}),void this.trackMetric("statsig_client_get_config_error",{config_name:e})}finally{this.trackMetric("statsig_client_get_config_duration",{time:Date.now()-o})}}logEvent(e,t,o){const n=Date.now();if(!this.isInitialized())return!1;try{return i().logEvent(e,t,o),this.trackMetric("statsig_client_log_event_success",{event_name:e}),!0}catch(r){const n=r instanceof Error?r.message:void 0;return this.logError("logEvent",r,{eventName:e,value:String(t),...o,...n&&{errorMessage:n}}),this.trackMetric("statsig_client_log_event_error",{event_name:e}),!1}finally{this.trackMetric("statsig_client_log_event_duration",{time:Date.now()-n})}}getLocalOverride(e){if(!this.isInitialized())return;const t=i().getAllOverrides().configs[e];return null==t?void 0:t[v]}updateLocalOverrideConfig(e,t){this.isInitialized()&&(i().overrideConfig(e,{[v]:t}),super.emit())}updateLocalOverrideGate(e,t){this.isInitialized()&&(i().overrideGate(e,"true"===t),super.emit())}removeAllLocalOverrides(){if(!this.isInitialized())return;const e=i().getAllOverrides();(0,u.Yd)(e.configs).forEach((e=>i().removeConfigOverride(e))),(0,u.Yd)(e.gates).forEach((e=>i().removeGateOverride(e))),super.emit()}async createStatsigUser(e){var t,o,r,i,a,s,l;const{device:c}=e,{currentUserSettingsStore:u,currentSpaceStore:m}=y.default.getState(),{userId:v,userEmail:b,spaceId:_}=S(e),w=await g.getExperimentDeviceId(e);return(0,h.createStatsigUser)({userId:v,device:c,spaceId:_,userEmail:b,deviceId:w,locale:null==u||null===(t=u.getSettings())||void 0===t?void 0:t.preferred_locale,spaceMemberCount:(0,p.F)((0,d.t5)(null==m?void 0:m.getPermissionItems())),spaceCreatedTime:null==m?void 0:m.getCreatedTime(),spaceCreatedDate:null!=m&&m.getCreatedTime()?n.ou.fromMillis(null==m?void 0:m.getCreatedTime()).toFormat("yyyy-MM-dd"):void 0,subscriptionTier:(0,f.zt)(),planType:null==m?void 0:m.getPlanType(),signupTime:null==u||null===(o=u.getSettings())||void 0===o?void 0:o.signup_time,domainType:null==u||null===(r=u.getSettings())||void 0===r?void 0:r.domain_type,persona:null==u||null===(i=u.getSettings())||void 0===i?void 0:i.persona,teamRole:null==u||null===(a=u.getSettings())||void 0===a?void 0:a.team_role,useCases:null==u||null===(s=u.getSettings())||void 0===s?void 0:s.use_cases,companySize:null==u||null===(l=u.getSettings())||void 0===l?void 0:l.company_size})}logError(e,t,o){l.log({level:"error",from:"statsig",type:e,error:(0,c.Ui)(t),data:{miscDataToConvertToString:{...o,...this.state}}})}trackMetric(e,t){this.environment&&e.endsWith("_error")&&m.j(this.environment,e,t)}}function S(e){const{currentUser:t}=e,{currentSpaceStore:o,currentUserStore:n}=y.default.getState(),r=t.id,i=null==n?void 0:n.getEmail();return{userId:r,spaceId:null==o?void 0:o.id,userEmail:i}}const _=new b},22616:(e,t,o)=>{o.d(t,{Z:()=>s,y:()=>l});o(21703);var n=o(64793),r=o(12139),i=o(54642),a=o(33493);async function s(e){const{environment:t,spaceId:o}=e;if("init"!==a.Z.state.status)return;a.Z.didStartLoading();const s=await i.listPrices(t,{spaceId:o,clientVersion:t.device.version});if("success"!==s.type)return void a.Z.resetExceptSelectedCurrencyCode();const l=s.data.prices;l&&0!==l.length||r.IE(new Error("Received empty price list")),a.Z.setPrices(l.map((e=>new n.t(e))))}function l(e){a.Z.availableCurrencyCodes.includes(e)&&a.Z.update((t=>({...t,selectedCurrencyCode:e})))}},34583:(e,t,o)=>{o.d(t,{$B:()=>Q,EO:()=>W,Fp:()=>ie,I0:()=>re,M_:()=>ne,Mg:()=>V,OR:()=>J,TV:()=>q,Xb:()=>ae,bi:()=>X,px:()=>ee,r7:()=>Y,y3:()=>z,zb:()=>te});o(21703);var n=o(30120),r=(o(67294),o(41892),o(68626)),i=(o(65454),o(15157)),a=o(4615),s=o(26929),l=o(2438),c=o(5366),d=o(50906),p=o(54642),u=o(35253),m=o(47307),g=o(92625),h=o(97977),f=o(84254),y=o(91754),v=(o(95477),o(15010)),b=o(33929),S=o(78873),_=o(95697),w=o(80444),k=o(73329),x=o(5315),I=o(81236),C=o(35661),T=o(92083),M=o(27242),P=o(9209),A=o(78291),D=o(85703),B=o(28517),R=o(42198),E=o(70060),F=o(88893),N=o(35057),j=o(62142),O=o(33493),L=o(85893);let U;const Z=(0,c.defineMessages)({updatingSubscription:{id:"subscriptionSettings.updatingSubscriptionMessage",defaultMessage:"Updating your subscriptionâ€¦"},updatingPaymentMethod:{id:"subscriptionSettings.updatingPaymentMethodMessage",defaultMessage:"Updating your payment methodâ€¦"},verifyingEligibility:{id:"subscriptionSettings.verifyingEligibilityMessage",defaultMessage:"Verifying eligibilityâ€¦"},personalFree:{id:"subscriptionSettings.personalFreeMessage",defaultMessage:"You are now subscribed to Notionâ€™s Personal Pro Plan for free."},educationPlusFree:{id:"subscriptionSettings.educationPlusFreeMessage",defaultMessage:"You are now subscribed to Notion's Education plan for free"}});async function V(e){const{environment:t,spaceStore:o,plan:n,billingEmail:r,paymentData:i,vatId:a,coupon:s,customerName:c,businessName:h,addressLine1:f,addressZip:y,addressCity:b,addressState:S,addressCountry:_,promoCodeId:w,from:x,addOns:I,useTestClock:C,sessionId:T,inAppOffer:M,isTrial:P}=e,{data:D}=A.default.state,B=H(t,D),R=null==D?void 0:D.addOns;if(!D)throw new Error("Subscription data not loaded.");u.Js({bannerStore:k.Z}),g.j({message:Z.updatingSubscription});const E=await p.updateSubscription(t,{spaceId:o.id,plan:n,billingEmail:r,stripeToken:se(i),paymentMethodId:le(i),vatId:a,coupon:s,customerName:c,businessName:h,addressLine1:f,addressZip:y,addressCity:b,addressState:S,addressCountry:_,promoCodeId:w,addOns:I,useTestClock:C,modalSessionId:T,inAppOffer:M,isTrial:P,clientVersion:t.device.version});let N,j,O;const L=n?(0,l.qH)(n):void 0;if("failed"===E.type)m.showError(E);else{const e=F.XX(D);if(e){const o=Boolean(n&&n!==e.plan);j=e.plan?(0,l.qH)(e.plan):void 0,O=e.currencyCode;const i={...o?{plan_changed:o,plan_current:n,plan_old:e.plan,currency_code:O}:{plan_changed:o},billing_email_changed:Boolean(r&&r!==e.billingEmail),billing_address_changed:!1};N=G(D,e),d.wlq(t,i)}else n&&d.k6o(t,{plan:n,credit_amount:0});await $({environment:t,spaceStore:o,newDefaultTeamId:E.data.newDefaultTeamId});const{data:i}=A.default.state;if(!i)throw new Error("Subscription data not loaded.");d._jH(t,{from:x,action:"update",spaceId:o.id,oldSubscriptionTier:B,newSubscriptionTier:H(t,i),oldCurrency:O,newCurrency:"currencyCode"in i?i.currencyCode:void 0,oldPriceId:N,newPriceId:n,oldAddOns:null==R?void 0:R.map((e=>e.feature)),newAddOns:i.addOns.map((e=>e.feature)),oldBillingInterval:j,newBillingInterval:L??j,addressCountry:_,creditAmount:0,isProfessionalTeamUser:(0,v.QZ)(),planType:o.getPlanType(),isTrial:P})}if(g.x(),"failed"===E.type)throw new Error("An error occurred while updating subscription");return E.data}async function q(e){const{environment:t,spaceStore:o,paymentMethodId:n}=e;g.j({message:Z.updatingPaymentMethod});const r=await p.updatePaymentMethod(t,{spaceId:o.id,paymentMethodId:n});if(g.x(),"failed"!==r.type)return await X(t),r.data;m.showError(r)}async function z(e){const{environment:t,spaceStore:o,address:n}=e;u.Js({bannerStore:k.Z}),g.j({message:Z.updatingSubscription});const r=await p.updateSubscription(t,{spaceId:o.id,customerName:n.name,businessName:n.businessName,addressLine1:n.addressLine1,addressLine2:n.addressLine2,addressZip:n.zipCode,addressCity:n.city,addressState:n.state,addressCountry:n.country});if("failed"===r.type)throw g.x(),m.showError(r),r.error;d.wlq(t,{billing_email_changed:!1,plan_changed:!1,billing_address_changed:!0}),await X(t),await ee(t),g.x()}async function W(e){const{environment:t,spaceStore:o,planType:n,from:r}=e,{data:i}=A.default.state;if(!i)throw new Error("Subscription data not loaded.");const a=H(t,i),s=i.addOns,c=F.XX(i),u=null==c?void 0:c.plan,g=u?(0,l.qH)(u):void 0,h=await p.cancelSubscription(t,{spaceId:o.id,planType:n,cancelImmediately:e.cancelImmediately});"failed"===h.type&&m.showError(h);const f=F.XX(i);let y;"subscribed_admin"===i.type&&f&&(y=!0,d.rxu(t,{plan:f.plan})),await $({environment:t,spaceStore:o,newDefaultTeamId:"success"===h.type?h.data.newDefaultTeamId:void 0});const{data:b}=A.default.state;if(!b)throw new Error("Subscription data not loaded.");return d._jH(t,{from:r,action:"cancel",spaceId:o.id,oldSubscriptionTier:a,newSubscriptionTier:H(t,b),oldPriceId:G(i,f),oldCurrency:K(i),newCurrency:K(b),oldAddOns:s.map((e=>e.feature)),oldBillingInterval:g,newBillingInterval:void 0,isCancelSubscription:y,isProfessionalTeamUser:(0,v.QZ)()}),!0}function H(e,t){const o=(0,N.zt)();if(!t)return o;return(0,F.DH)(t)?"free":o}function G(e,t){if(!e)return;return(0,F.DH)(e)||null==t?void 0:t.plan}function K(e){if(e)return"currencyCode"in e?e.currencyCode:void 0}async function $(e){let{environment:t,newDefaultTeamId:o,spaceStore:n}=e;if(await X(t),await ee(t),O.Z.reset(),(0,_.bq)()&&t.currentUser.id&&void 0!==o){await B.m({userId:t.currentUser.id,spaceId:n.id,environment:t});const e=C.zX.createChildStore(n,{table:"team",id:o,spaceId:n.id});await e.load()}}async function Y(e){const{environment:t,spaceStore:o,code:n}=e;g.j({message:Z.verifyingEligibility});const{data:r}=A.default.state;if(!r)throw new Error("Subscription data not loaded.");const i=await p.updateSubscriptionToEducationPlan(t,{spaceId:o.id,code:n});"failed"===i.type?m.showError(i):i.data.isEligible?oe(r,t):P.Z.setState({open:!0,handlePromoCode:async e=>{g.j({message:Z.updatingSubscription});const n=await p.updateSubscriptionToEducationPlan(t,{spaceId:o.id,code:e});"failed"===n.type?m.showError(n):n.data.isEligible?oe(r,t):m.showErrorMessage((0,L.jsx)(c.FormattedMessage,{id:"subscriptionSettings.invalidPromoCodeError.message",defaultMessage:"This promo code is not valid."})),g.x()}}),g.x()}function Q(){U&&U.close()}async function J(e){const{environment:t,spaceId:o,isNewlyCreatedSpace:n}=e,r=A.default.state.spaceId;if(!t.currentUser.isLoggedIn()||r&&r===o)await A.default.waitUntilLoaded();else if(A.default.setState({...A.default.state,spaceId:o}),D.Z.setState({...D.Z.state,spaceId:o}),n){const e={type:"unsubscribed_admin",users:[],bots:[],joinedMemberIds:[],blockUsage:0,hasPaidNonzero:!1,accountBalance:0,timelineViewUsage:0,inviteLinkCode:"",userSimilarity:{},spaceUsers:[],members:[],customerData:void 0,revenueCatEnabled:!1,addOns:[],currencyCode:void 0};A.default.setState({...A.default.state,data:e}),X(t)}else X(t),ee(t)}async function X(e){const{spaceId:t}=A.default.state,o=e.currentUser.id;if(!t)throw new Error("No spaceId.");{const n=`SubscriptionData:${t}:v2`,a=i.Z.get({userId:o,key:n});a&&A.default.setState({spaceId:t,data:a}),await async function(e){let{environment:t,spaceId:o,currentUserId:n,localKey:a}=e;n&&R.default.initializeAndLoadAllUserSignals({environment:t,userId:n,spaceId:o});await x.transactionQueue.drain();const[s,l]=await Promise.all([p.getSubscriptionData(t,{spaceId:o}),p.getVisibleUsers(t,{spaceId:o})]);if("success"===s.type&&"success"===l.type){const e={...s.data,...l.data};i.Z.set({userId:n,key:a,value:e}),A.default.state.spaceId===o&&(A.default.setState({spaceId:o,data:e}),F.YK(e)&&d.jw0(t))}else r.log({level:"error",from:"subscriptionActions",type:"fetchSubscriptionDataFailed",data:{miscDataToConvertToString:{getSubscriptionDataResponseType:s.type,getSubscriptionDataResponseStatus:s.status,getVisibleUserResponseType:l.type,getVisibleUserResponseStatus:l.status}}});await Promise.all([I.Z.awaitPublicSpaceData(t,o,!0),f.updateAiEligibility(t,o)])}({environment:e,spaceId:t,currentUserId:o,localKey:n})}}async function ee(e){const{spaceId:t}=A.default.state,o=e.currentUser.id;if(!t)throw new Error("No spaceId.");{const n=`UpcomingInvoiceData:${t}:v2`,a=i.Z.get({userId:o,key:n});a&&D.Z.setState({spaceId:t,data:a}),await x.transactionQueue.drain();const s=await p.getInvoiceData(e,{spaceId:t,type:"upcoming"});if("success"===s.type){const{data:e}=s;i.Z.set({userId:o,key:n,value:e.invoiceData}),D.Z.state.spaceId===t&&D.Z.setState({spaceId:t,data:e.invoiceData})}else r.log({level:"error",from:"subscriptionActions",type:"fetchUpcomingInvoiceCall",data:{miscDataToConvertToString:{upcomingInvoiceResponse:s}}})}}async function te(e,t){const o=w.default.state.currentSpaceStore;if(!o)return;const n=await p.getBillingHistory(e,{spaceId:o.id,limit:t.state.billingEventsLimit});"success"===n.type&&t.update((e=>({...e,billingEvents:n.data.events})))}async function oe(e,t){await X(t),ee(t),O.Z.reset();const o=()=>{m.showMessage({message:b.default.formatMessage(Z.educationPlusFree)}),T.Z.setState({...T.Z.state,currentTab:"billing",defaultSubtab:void 0});const o=F.XX(e);d.jhO(t,{plan:"student_free",old_plan:o?o.plan:void 0})};await h.shouldCreatePassword(t)?S.E({environment:t,onSubmit:o,onCancel:o}):o()}function ne(e){const{data:t}=A.default.state;if(e.device.isMobileNative)return!0;if(t){if((0,E.du)())return!0;if(F.Ln(e,t))return d.ljn(e),function(e){if((0,E.du)())return;u.Bw({id:"SubscriptionEditingBlocker",bannerStore:k.Z,styleKey:y.v.Red,contentKey:"over_free_block_limit"})}(),!1;F.XZ(e,t)&&d.z2b(e)}if((0,E.e0)()){var o,r;const e=null===(o=w.default.state.currentSpaceStore)||void 0===o?void 0:o.getOverdueSubscription(),t=F.aS(A.default.state.data),i=null==t||null===(r=t.testClock)||void 0===r?void 0:r.frozen_time,a=i?n.ou.fromSeconds(i):n.ou.now(),{paymentStatus:l}=(0,s.cS)({now:a,overdueSubscription:e});if("unpaid"===l)return!1}return u.qL({bannerStore:k.Z,id:"SubscriptionEditingBlocker"}),!0}function re(e,t){const{subscriptionTier:o,from:n,addOnFeature:r,coupon:i,isTrial:s}=t,l=(0,a.ZP)();d.Lc3(e,{subscriptionTier:o,from:n,addOnFeature:r,currency_code:O.Z.state.selectedCurrencyCode,isTrial:s,modal_id:l});const c=r||s||!E.F4()?"month":"year";M.Z.open({subscriptionTier:o,billingInterval:c,addOnFeature:r,coupon:i,isTrial:s,sessionId:l})}function ie(e){const t=M.Z.state;t.open&&(d.LYj(e,{modal_id:t.sessionId}),M.Z.setState({open:!1}))}function ae(e){j.Z.open(e)}function se(e){return"stripeToken"===(null==e?void 0:e.type)?e.value:void 0}function le(e){return"paymentMethodId"===(null==e?void 0:e.type)?e.value:void 0}},64891:(e,t,o)=>{o.d(t,{LZ:()=>T,Mg:()=>I,OT:()=>x,Zo:()=>M,af:()=>_,bX:()=>k,cM:()=>w,y5:()=>C});var n=o(4615),r=o(3791),i=o(97880),a=o(50906),s=o(54642),l=o(47307),c=o(92625),d=o(91376),p=o(64964),u=o(65544),m=o(80444),g=o(40670),h=o(35057),f=o(87598),y=o(33493),v=o(25692),b=o(22616),S=o(34583);function _(e){const{environment:t,from:o,view:r,temporarySubscriptionTier:i,temporaryBillingInterval:s,billingInterval:l,addOnFeature:c,pageSection:d,onSuccess:p}=e,m=(0,n.ZP)();a.YTO(t,{from:o,pageSection:d,view:r,modal_id:m,currency_code:y.Z.selectedCurrencyCode}),v.Z.setState({open:!0,modalId:m,view:r,subscriptionTier:(0,h.zt)(),temporarySubscriptionTier:i,billingInterval:l,temporaryBillingInterval:s,calculatingTax:!1,isExpandedView:!1,addOnFeature:c,onSuccess:p}),u.SP(t)}function w(e){const t=v.Z.state;t.open&&(a.q7Y(e,{state:t}),v.Z.setState({open:!1}))}function k(e){const t=v.Z.state;t.open&&(a.y$F(e,{state:t}),v.Z.setState({...t,isExpandedView:!0}))}function x(e){const t=v.Z.state;t.open&&(a.k1K(e,{state:t}),v.Z.setState({...t,isExpandedView:!1}))}async function I(e,t){const o=v.Z.state;if(!o.open)return;a.ndA(e,{state:o});const{view:n,subscriptionTier:s,temporarySubscriptionTier:l,temporaryBillingInterval:c,billingInterval:d,addOnFeature:u,onSuccess:h}=o;let f;switch(n){case"add_ons":if(await async function(e){const{environment:t,addOnFeature:o,billingInterval:n,inAppOffer:i}=e,a=m.default.state.currentSpaceStore;if(!a||!o||!n)return;const s=(0,r.aG)({addOnFeature:o,addOnTier:"base",addOnBillingInterval:n,addOnPricingModel:"standard",addOnPricingVariant:"retail",currencyCode:y.Z.selectedCurrencyCode,isCancellation:!1});await S.Mg({environment:t,from:"space_settings-billing_tab",spaceStore:a,addOns:s,inAppOffer:i})}({environment:e,addOnFeature:u,billingInterval:d,inAppOffer:t}),w(e),u){const e=g.mV({type:"purchaseAddOn",addOnFeature:u});e&&p.oV(e)}break;case"billing_interval":if(!c)return;c!==d&&await async function(e){const{environment:t,tier:o,newInterval:n}=e,r=m.default.state.currentSpaceStore,{prices:i,selectedCurrencyCode:a}=y.Z,s=i.find((e=>e.product===o&&e.billingInterval===n&&e.currencyCode===a));if(!r||!s)return;await S.Mg({environment:t,from:"space_settings-billing_tab",spaceStore:r,plan:s.externalId})}({environment:e,tier:s,newInterval:c}),w(e),f=g.mV({type:"billingInterval",billingInterval:c}),f&&p.oV(f);break;case"plans":if(!l||!d)return;await async function(e){const{environment:t,tier:o,billingInterval:n}=e,r=m.default.state.currentSpaceStore,{prices:i,selectedCurrencyCode:a}=y.Z,s=i.find((e=>e.product===o&&e.billingInterval===n&&e.currencyCode===a));if(!r||!s)return;await S.Mg({environment:t,from:"space_settings-plans_tab",spaceStore:r,plan:s.externalId})}({environment:e,tier:l,billingInterval:d}),w(e),f=g.mV({type:"upgradePlan",newTier:l}),f&&p.oV(f);break;case"default":w(e);break;default:(0,i.t1)(n)}null==h||h()}async function C(e){const{environment:t,customerData:o}=e;if(o.willCancelAt){const e=m.default.state.currentSpaceStore;if(e)return await S.Mg({environment:t,from:"space_settings-billing_tab",spaceStore:e}),void p.oV({label:(0,g.UW)()})}const n=(0,g.dY)(o);if(!n)return l.showErrorMessage((0,g.JC)());if(!(0,g.bM)(o))return l.showErrorMessage((0,g.iS)());const r=await s.releaseSubscriptionSchedule(t,{id:n});if("success"===r.type&&r.data.subscriptionSchedule)return p.oV({label:(0,g.UW)()}),await S.bi(t);l.showErrorMessage((0,g.js)())}async function T(e){const{environment:t,customerData:o}=e,n=(0,r.Xi)(o.addOns),i=("interval"in o?o.interval:void 0)||n;if(!i)return;const a=m.default.state.currentSpaceStore;if(!a)return;await b.Z({environment:t,spaceId:a.id});const{prices:s,selectedCurrencyCode:c}=y.Z;let d,p;if((0,r.de)(o.addOns)&&(d=(0,r.aG)({addOnFeature:"ai",addOnTier:"base",addOnBillingInterval:i,addOnPricingModel:"standard",addOnPricingVariant:"retail",currencyCode:c,isCancellation:!1})),!(0,h.QM)()){const e=(0,h.zt)(),t=s.find((t=>t.product===e&&t.billingInterval===i&&t.currencyCode===c));p=null==t?void 0:t.externalId}if(!p&&!d)return l.showErrorMessage((0,g.js)());await S.Mg({environment:t,spaceStore:a,from:"space_settings-billing_tab",addOns:d,plan:p})}async function M(e){const t=m.default.state.currentSpaceStore;t&&(c.j({message:f.z.cancellingTrial}),await S.EO({environment:e,spaceStore:t,planType:t.getPlanType()??"personal",from:"space_settings-plans_tab"}),c.x(),d.r$({currentTab:"billing"}))}},40670:(e,t,o)=>{o.d(t,{A0:()=>O,JC:()=>w,Tg:()=>F,UW:()=>k,Z_:()=>N,bM:()=>C,dA:()=>I,dY:()=>x,iS:()=>_,js:()=>S,mV:()=>U,n8:()=>E,rO:()=>j});o(57658),o(67294);var n=o(13991),r=o(7057),i=o(36591),a=o(5366),s=o(3791),l=o(47425),c=o(97880),d=o(33929),p=o(88893),u=o(35057),m=o(85893);const g=(0,a.defineMessages)({cancellationError:{id:"midtermSubscriptionHelpers.cancellationFailed",defaultMessage:"There was an error attempting to cancel your pending changes. Please try again."},unableToCancelError:{id:"midtermSubscriptionHelpers.unableToCancel",defaultMessage:"We cannot cancel your scheduled changes right now. Please contact support for more help."},cancellationSuccess:{id:"midtermSubscriptionHelpers.cancellationSucceeded",defaultMessage:"Pending changes have been canceled"},invalidSubscriptionId:{id:"midtermSubscriptionHelpers.invalidSubscriptionId",defaultMessage:"Unable to cancel your pending changes. Something was wrong with your pending subscription changes."}});function h(e){return(0,l.QM)(e)?"free":(0,l.iJ)(e)?"education":(0,l.Aw)(e)?"singlePlayerPlus":(0,l.eR)(e)?"plus":(0,l.NG)(e)?"business":(0,p.gG)(e)?"enterprise":"legacy"}const f=(0,a.defineMessages)({personalFreePlan:{defaultMessage:"Personal Plan",id:"personalFreePlan.title"},personalFree:{defaultMessage:"Personal",id:"personalFree.title"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},freePlan:{defaultMessage:"Free Plan",id:"freePlan.title"},free:{defaultMessage:"Free",id:"free.title"},personalPlan:{defaultMessage:"Personal Pro Plan",id:"personalPlan.label"},personal:{defaultMessage:"Personal Pro",id:"personal.label"},singlePlayerPlusPlan:{defaultMessage:"Plus Plan with a 1-member limit",id:"singlePlayerPlusPlan.title"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"personalEducationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"educationPlusPlan.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},team:{defaultMessage:"Team",id:"team.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},plus:{defaultMessage:"Plus",id:"plus.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},business:{id:"business.title",defaultMessage:"Business"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"enterprisePlan.label"},enterprise:{defaultMessage:"Enterprise",id:"enterprise.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"legacyPlan.label"}}),y={free:{planTitle:f.freePlan},singlePlayerPlus:{planTitle:f.plusPlan},education:{planTitle:f.educationPlusPlan},plus:{planTitle:f.plusPlan},business:{planTitle:f.businessPlan},enterprise:{planTitle:f.enterprisePlan},legacy:{planTitle:f.legacyPlan}},v=(0,a.defineMessages)({notionAI:{defaultMessage:"Notion AI",id:"notionAI.title"},removeAI:{defaultMessage:"Remove AI",id:"notionAI.remove.title"}}),b=(0,a.defineMessages)({month:{defaultMessage:"Monthly billing",id:"billingInterval.monthly"},year:{defaultMessage:"Annual billing",id:"billingInterval.annual"}});function S(){return d.default.formatMessage(g.cancellationError)}function _(){return d.default.formatMessage(g.unableToCancelError)}function w(){return d.default.formatMessage(g.invalidSubscriptionId)}function k(){return d.default.formatMessage(g.cancellationSuccess)}function x(e){var t;return null===(t=e.schedule)||void 0===t?void 0:t.id}function I(e){return e.willCancelAt}function C(e){var t;const o=null===(t=e.schedule)||void 0===t?void 0:t.status;return"not_started"===o||"active"===o}const T={personal_monthly_5:"personal",personal_yearly_48:"personal",team_monthly_10:"plus",team_yearly_96:"plus",business_monthly:"business",business_yearly:"business",enterprise_monthly_25:"enterprise",enterprise_yearly_240:"enterprise"};function M(e){for(const t of e)if(t.plan in T)return T[t.plan]}function P(e){for(const o of e)try{const e=(0,s.PG)(o.plan);if(e)return e}catch(t){}}function A(e){for(const t of e)return t.billingInterval}function D(e){var t;if(e.willCancelAt)return{oldTier:u.zt(),newTier:"free",oldAddOn:null===(t=e.addOns[0])||void 0===t?void 0:t.feature,newAddOn:void 0,oldInterval:e.interval,newInterval:void 0,phaseOneEndDate:e.willCancelAt,phaseTwoEndDate:NaN};const o=e.schedule;if(!o)return;const n=o.phases;if(!n)return;const r=n[0],i=n[1];if(!r)return;const a=[],s=[];for(const l of r.items)a.push({billingInterval:l.billing_interval,plan:l.plan});if(i)for(const l of i.items)s.push({billingInterval:l.billing_interval,plan:l.plan});return{oldTier:u.zt(),newTier:M(s),oldAddOn:P(a),newAddOn:P(s),oldInterval:A(a),newInterval:A(s),phaseOneEndDate:1e3*r.end_date,phaseTwoEndDate:1e3*(null==i?void 0:i.end_date)}}function B(e,t){const o=h(e),n=d.default.formatMessage(y[o].planTitle);if(!t)return"";const r=h(t);return`${n} â†’ ${d.default.formatMessage(y[r].planTitle)}`}function R(e,t){return`${d.default.formatMessage(e?v.notionAI:v.removeAI)} â†’ ${d.default.formatMessage(t?v.notionAI:v.removeAI)}`}function E(e){const t=[];return u.QM()||t.push(B(u.zt(),"free")),(0,s.de)(e.addOns)&&t.push(R("ai",void 0)),{cancelledChanges:t}}function F(e){const t=D(e),o=[];if(!t)return{scheduledChanges:o,periodEndDate:0};const{newTier:n,oldTier:r,oldAddOn:i,newAddOn:a,oldInterval:s,newInterval:l,phaseOneEndDate:c}=t;return r!==n&&o.push(B(r,n)),i!==a&&o.push(R(i,a)),s!==l&&o.push(function(e,t){return e&&t?`${d.default.formatMessage("month"===e?b.month:b.year)} â†’ ${d.default.formatMessage("month"===t?b.month:b.year)}`:""}(s,l)),{scheduledChanges:o,periodEndDate:c}}function N(e,t,o){return"billing_interval"===e&&"year"===t&&"month"===o}function j(e,t,o){return"plans"===e||"add_ons"===e||"billing_interval"===e&&"month"===t&&"year"===o}function O(e){if(e.willCancelAt)return!0;const t=D(e),{oldAddOn:o,newAddOn:n}=t||{};return"ai"===o&&!n}function L(e){return(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,i.e)({width:12}),e.children]})}function U(e){const{type:t}=e;switch(t){case"upgradePlan":return function(e){const{newTier:t}=e;switch(t){case"plus":return{label:(0,m.jsx)(L,{children:(0,m.jsx)(a.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.plus",defaultMessage:"You have successfully upgraded to the Plus plan"})})};case"business":return{label:(0,m.jsx)(L,{children:(0,m.jsx)(a.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.business",defaultMessage:"You have successfully upgraded to the Business plan"})})};case"enterprise":return{label:(0,m.jsx)(L,{children:(0,m.jsx)(a.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.enterprise",defaultMessage:"You have successfully upgraded to the Enterprise plan"})})};case"student":return{label:(0,m.jsx)(L,{children:(0,m.jsx)(a.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.student",defaultMessage:"You have successfully upgraded to the Student plan"})})};case"free":case"personal":case"personal_free":case"team_free":return;default:(0,c.t1)(t)}}(e);case"downgradePlan":return function(e){const{newTier:t}=e,o=(0,r.Yx)(e.effectiveDateEpochMs,"medium",n.SP);switch(t){case"plus":return{label:(0,m.jsx)(a.FormattedMessage,{id:"midtermChangeHelpers.snackbar.downgradePlan.plus",defaultMessage:"Downgrade to Plus plan will be effective {date}.",values:{date:o}})};case"business":return{label:(0,m.jsx)(a.FormattedMessage,{id:"midtermChangeHelpers.snackbar.downgradePlan.business",defaultMessage:"Downgrade to Business plan will be effective {date}.",values:{date:o}})};case"free":return{label:(0,m.jsx)(a.FormattedMessage,{id:"midtermChangeHelpers.snackbar.downgradePlan.free",defaultMessage:"Downgrade to Free plan will be effective {date}.",values:{date:o}})};case"enterprise":case"personal":case"personal_free":case"student":case"team_free":return;default:(0,c.t1)(t)}}(e);case"purchaseAddOn":return function(e){const{addOnFeature:t}=e;switch(t){case"ai":return{label:(0,m.jsx)(L,{children:(0,m.jsx)(a.FormattedMessage,{id:"midtermChangeHelpers.snackbar.purchaseAddOn.ai",defaultMessage:"You have successfully added Notion AI"})})};default:(0,c.t1)(t)}}(e);case"removeAddOn":return function(e){const{addOnFeature:t}=e;switch(t){case"ai":return{label:(0,m.jsx)(a.FormattedMessage,{id:"midtermChangeHelpers.snackbar.removeAddOn.ai",defaultMessage:"AI will be removed effective {effectiveDate}",values:{effectiveDate:(0,r.Yx)(e.effectiveDateEpochMs,"medium",n.SP)}})};default:(0,c.t1)(t)}}(e);case"billingInterval":return function(e){const{billingInterval:t,effectiveDateEpochMs:o}=e,i=o?(0,r.Yx)(o,"medium",n.SP):void 0;return i?{label:(0,m.jsx)(a.FormattedMessage,{id:"midtermChangeHelpers.snackbar.billingInterval.future",defaultMessage:"{billingInterval, select, year {Yearly} other {Monthly}} billling will be effective {date}",values:{billingInterval:t,date:i}})}:{label:(0,m.jsx)(L,{children:(0,m.jsx)(a.FormattedMessage,{id:"midtermChangeHelpers.snackbar.billingInterval.success",defaultMessage:"You have successfully changed to {billingInterval, select, year {yearly} other {monthly}} billing",values:{billingInterval:t}})})}}(e);default:(0,c.t1)(t)}}},70060:(e,t,o)=>{o.d(t,{F4:()=>S,G2:()=>k,IC:()=>_,KC:()=>u,R$:()=>T,U0:()=>C,Xg:()=>g,Z$:()=>x,bI:()=>I,bQ:()=>P,du:()=>h,e0:()=>w,fQ:()=>y,fX:()=>M,fw:()=>f,lF:()=>p,oP:()=>v,px:()=>b});var n=o(44317),r=o(3791),i=o(47425),a=o(80444),s=o(77080),l=o(78291),c=o(88893),d=o(35057);function p(){return s.default.getEligibleGroup({experimentId:"block_limit_cta_earlier",defaultGroup:"unassigned"})}function u(){return s.default.getEligibleGroup({experimentId:"block_limit_increase"})}function m(){const{currentSpaceStore:e}=a.default.state,t=null==e?void 0:e.getSettings().first_invited_member_time;return t?(0,n.O5)(t):null}function g(){return s.default.getEligibleGroup({experimentId:"block_limit_cta_earlier",defaultGroup:"unassigned",disableExposureLogging:!0})}function h(){const e=m();return null!==e&&(!(null!==e&&e>7)&&"on"===s.default.getEligibleGroup({experimentId:"block_limit_delay",defaultGroup:"control"}))}function f(){var e;const t=null===(e=a.default.state.currentSpaceStore)||void 0===e?void 0:e.getSettings();return null!=t&&t.seen_block_limit_reduction_v2&&"on"===s.default.getEligibleGroup({experimentId:"block_limit_reduction"})?"decrease":null!=t&&t.seen_block_limit_increase&&"on"===s.default.getEligibleGroup({experimentId:"block_limit_increase"})?"increase":"normal"}function y(){const e=m();return null!==e&&7-e>0?7-e:-1}function v(){return Boolean("on"===s.default.getGroup("churn_nudge"))}function b(e,t){var o;if(e.device.isMobile)return!1;const{data:n}=l.default.state;if(!n)return!1;if(("subscribed_admin"===n.type||"unsubscribed_admin"===n.type)&&null!==(o=n.customerData)&&void 0!==o&&o.stripe&&Boolean(n.customerData.stripe.promo))return!1;const r=t??(0,d.zt)();return!!((0,i.mq)(r)&&(0,c.su)(n)<100&&Boolean("on"===s.default.getGroup("largesse")))}function S(){return Boolean("on"===s.default.getGroup("subscription_default_annual"))}function _(){const e=s.default.getGroup("subscription_payment_status");return Boolean("on"===e||"message_only"===e)}function w(){return Boolean("on"===s.default.getGroup("subscription_payment_status"))}function k(){return Boolean(s.default.checkGate("test_clocks"))}function x(){return Boolean("unassigned"===s.default.getEligibleGroup({experimentId:"tt_me_pregunto",defaultGroup:"unassigned"}))}function I(){return Boolean("on"===s.default.getEligibleGroup({experimentId:"tt_me_pregunto",defaultGroup:"unassigned"}))}function C(e){var t;if(!(0,d.QM)())return!1;if((0,r.E3)(e.addOns))return!1;const o=null===(t=a.default.state.currentSpaceStore)||void 0===t?void 0:t.getSettings();return null!=o&&o.exposed_to_timed_trials_in_onboarding?I():Boolean("on"===s.default.getGroup("tt_pp"))}function T(){return Boolean("on"===s.default.getGroup("upsell_colors"))}function M(){return Boolean(s.default.checkGate("advanced_security_in_enterprise"))}function P(){return Boolean("on"===s.default.getGroup("mobile_web_subscriptions"))}},88893:(e,t,o)=>{o.d(t,{A7:()=>ee,Bu:()=>M,CM:()=>ne,DH:()=>C,Et:()=>j,Fu:()=>le,GD:()=>Z,GJ:()=>w,Gh:()=>F,He:()=>ue,Io:()=>oe,Ln:()=>ae,Lz:()=>L,M9:()=>V,MM:()=>N,Md:()=>U,ND:()=>$,NM:()=>H,NW:()=>z,Ns:()=>te,Q6:()=>re,Tj:()=>b,XX:()=>S,XZ:()=>E,YK:()=>T,_9:()=>ie,aS:()=>_,cA:()=>G,f3:()=>pe,gG:()=>x,hn:()=>Q,lk:()=>Y,m_:()=>se,o9:()=>ce,qF:()=>P,qX:()=>X,qb:()=>R,su:()=>J,t1:()=>me,uN:()=>W,uo:()=>B,wY:()=>I,wl:()=>k,xR:()=>O,y$:()=>de,ye:()=>D,zl:()=>K});o(57658),o(67294);var n=o(72126),r=o(5366),i=o(27006),a=o(31919),s=o(2438),l=o(47425),c=o(97880),d=o(95477),p=o(52533),u=o(80444),m=o(81236),g=(o(27242),o(78291)),h=o(70060),f=o(33941),y=o(35057),v=o(85893);const b=.9;function S(e){if(e&&"subscribed_admin"===e.type&&function(e){return void 0!==e.billing}(e.customerData.stripe))return e.customerData.stripe}function _(e){var t;if(e&&("subscribed_admin"===e.type||"unsubscribed_admin"===e.type))return null===(t=e.customerData)||void 0===t?void 0:t.stripe}function w(e){return!!e&&("subscribed_admin"===e.type||"unsubscribed_admin"===e.type)}function k(e){return e&&function(e){const t=S(e);if(t)return t.productId}(e)===d.default.pricing.student.productId}function x(e){return e.startsWith("enterprise")}function I(e){return Boolean(e&&"subscribed_admin"===e.type&&e.customerData&&"revenueCat"===e.customerData.activeSubscriptionPlatform&&e.customerData.revenueCat&&!0===e.customerData.revenueCat.isSubscribed)}function C(e){const t=S(e);return t&&"number"==typeof t.canceledAt&&"number"==typeof t.willCancelAt}function T(e){return Boolean(e&&"unsubscribed_admin"!==e.type&&"unsubscribed_member"!==e.type&&"unsubscribed_guest"!==e.type)}function M(e){return!T(e)}function P(e){return!ge(e,["personal","student","personal_free"])}function A(e){return(0,y.QM)()}function D(){return(0,y.mq)()}function B(e){return ge(e,["personal_free","personal","free"])}function R(e,t){return t===(0,y.zt)()}function E(e,t){const o=(0,h.Xg)();let n=.75;return"25"===o?n=.25:"50"===o&&(n=.5),K(e,t)>=n}async function F(e){const{environment:t,userRootStore:o}=e;if(!o)return;const r=o.getAdminSpaceIds().map((async e=>{const o=await m.Z.awaitPublicSpaceData(t,e);return o&&o.productId})),i=await Promise.all(r);return n.oA(i)}function N(e){var t;const o="subscribed_admin"===(null==e?void 0:e.type)||"unsubscribed_admin"===(null==e?void 0:e.type)?null===(t=e.customerData)||void 0===t?void 0:t.stripe:void 0;return Boolean(null==o?void 0:o.paymentMethodType)}function j(e){const t=S(e);return"unsubscribed_admin"===e.type||"unsubscribed_member"===e.type?e.accountBalance:t?t.accountBalance:0}function O(e){const{environment:t,userRootStore:o}=e;if(!o)return;const r=o.getAdminSpaceIds().map((e=>{const o=m.Z.getPublicSpaceData(t,e);return o&&o.productId}));return n.oA(r)}function L(e,t){const o=J(t)>1;return M(t)&&A()&&o?t.blockUsage:0}function U(e,t){const{currentUserStore:o}=u.default.state,n=S(t),r=null!=o&&o.isDefined()?o.getEmail():void 0;return e.temporaryBillingEmail||("subscribed_admin"===t.type&&n?n.billingEmail:void 0)||r}function Z(e){return e||"year"}function V(e){return!!(0,y.QM)()&&((0,p.S$)({environment:e})?"personal":"plus")}function q(e){const{memberCount:t,subscriptionTier:o,addOnFeature:n,isAddOnFeature:r,billingInterval:i,coupon:a}=e,s=function(e){const{subscriptionTier:t,addOnFeature:o,isAddOnFeature:n}=e;if(!d.default.pricing)return;if(n&&void 0!==o)return d.default.pricing[o].productId;const r=d.default.pricing[t];if("productId"in r)return r.productId}({subscriptionTier:o,addOnFeature:n,isAddOnFeature:r});let l,c,p;return s===d.default.pricing.ai.productId?(l=d.default.pricing.ai.yearlyPricePerMember,c=d.default.pricing.ai.monthlyPricePerMember,"ai_fifty_percent"===a&&(l-=4800,c-=500),p="year"===i?l*t:c*t):s===d.default.pricing.personal.productId?(l=d.default.pricing.personal.yearlyPrice,c=d.default.pricing.personal.monthlyPrice,p="year"===i?l:c):s===d.default.pricing.plus.productId?(l=d.default.pricing.plus.yearlyPricePerMember,c=d.default.pricing.plus.monthlyPricePerMember,p="year"===i?l*t:c*t):s===d.default.pricing.business.productId?(l=d.default.pricing.business.yearlyPricePerMember,c=d.default.pricing.business.monthlyPricePerMember,p="year"===i?l*t:c*t):(l=d.default.pricing.enterprise.yearlyPricePerMember,c=d.default.pricing.enterprise.monthlyPricePerMember,p="year"===i?l*t:c*t),{yearlyUnitPrice:l,monthlyUnitPrice:c,planAmount:p}}function z(e){const t=g.default.state.data;return e===d.default.pricing.personal.productId||I(t)?"personal":e===d.default.pricing.student.productId?"personal_education":e===d.default.pricing.plus.productId?"plus":e===d.default.pricing.business.productId?"business":e===d.default.pricing.enterprise.productId?"enterprise":e===d.default.pricing.ai.productId?"ai":"legacy"}function W(e){const{subscriptionTier:t,currencyCode:o,promo:n,data:i,onlyShowAddOn:l,calculatingTax:c,taxAmount:d,addOnFeature:p,billingInterval:u,coupon:m}=e,g=J(i),h=Math.min(0,j(i));let f=0,y=0,b=0;const S=void 0!==p;if(!l){const e=q({subscriptionTier:t,memberCount:g,isAddOnFeature:!1,billingInterval:u});f+=e.yearlyUnitPrice,y+=e.monthlyUnitPrice,b+=e.planAmount}if(S){const e=q({subscriptionTier:t,memberCount:g,isAddOnFeature:!0,addOnFeature:p,billingInterval:u,coupon:m});f+=e.yearlyUnitPrice,y+=e.monthlyUnitPrice,b+=e.planAmount}const _=(0,s.uN)(b,n),w=a.n.fromValue({amount:b-_.amount+h+(d&&!c?d:0),currencyCode:o}).zeroIfNegative(),k=[{type:"standard",name:(0,v.jsx)(r.FormattedMessage,{id:"subscriptionHelpers.lineItems.subTotal",defaultMessage:"Subtotal"}),price:a.n.fromValue({amount:b,currencyCode:o})}];return k.push({type:c?"calculating":"standard",name:(0,v.jsx)(r.FormattedMessage,{id:"subscriptionHelpers.lineItems.taxIfApplicable.title",defaultMessage:"Tax if applicable"}),price:a.n.fromValue({amount:b,currencyCode:o})}),0!==_.amount&&k.push({type:"promotion",name:(0,v.jsx)(r.FormattedMessage,{id:"subscriptionHelpers.lineItems.promo",defaultMessage:"Coupon"}),price:a.n.fromValue({amount:_.amount,currencyCode:o}),subtitle:_.monthsRemaining?(0,v.jsx)(r.FormattedMessage,{id:"subscriptionHelpers.lineItems.promo.subtitle",defaultMessage:"Valid for {durationInMonths} months",values:{durationInMonths:_.monthsRemaining}}):void 0}),h<0&&k.push({type:"promotion",name:(0,v.jsx)(r.FormattedMessage,{id:"subscriptionHelpers.lineItems.balance",defaultMessage:"Balance"}),price:a.n.fromValue({amount:-h,currencyCode:o})}),{yearlyUnitPrice:f,monthlyUnitPrice:y,planAmount:b,payAmount:w,accountBalance:h,lineItems:k,promoInfo:_}}function H(e){return"bots"in e?e.bots:[]}function G(e,t){if((0,h.du)()&&ae(e,t)){const e=(0,h.fQ)(),t=(()=>{switch(e){case 0:return(0,v.jsx)(r.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimitToday",defaultMessage:"to upgrade today"});default:return(0,v.jsx)(r.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimitNumDays",defaultMessage:"{remainingDays, plural, one {1 day to upgrade} other {{remainingDays} days to upgrade}}",values:{remainingDays:e}})}})();return(0,v.jsx)(r.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimit",defaultMessage:"You've hit Notion's trial block limit, and you have {remainingDaysMessage} before we limit new content creation.",values:{remainingDaysMessage:t}})}return(0,v.jsx)(r.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.reachedFreeBlockLimit",defaultMessage:"This workspace has used {usedBlocks} of its {freeBlockLimit} block storage limit ({utilizationPercentage}).",values:{usedBlocks:L(0,t),freeBlockLimit:(0,l.v5)((0,h.fw)()),utilizationPercentage:(0,v.jsx)(r.FormattedNumber,{value:K(e,t),style:"percent",maximumSignificantDigits:2,maximumFractionDigits:0})}})}function K(e,t){return L(0,t)/(0,l.v5)((0,h.fw)())}function $(e){return ne(e).filter((e=>!(0,i.Jy)(e.role)))}function Y(e){return $(e).length}function Q(e){return ne(e).filter((e=>(0,i.Jy)(e.role)))}function J(e){return Q(e).length}function X(){const{data:e}=g.default.state;return e?J(e):1}function ee(){const{data:e}=g.default.state;return e?$(e):[]}function te(){const e=X();return e<=99?"SMB":e<=1999?"Mid-Market":"Enterprise"}function oe(){const{data:e}=g.default.state;return e?Q(e):[]}function ne(e){return"visibleUsers"in e?e.visibleUsers:e.users}function re(e){return Boolean(e&&"subscribed_admin"===e.type&&e.customerData&&e.customerData.stripe.isSubscribed&&("enterprise_free"===e.customerData.stripe.plan||"business_sales_assisted"===e.customerData.stripe.plan))}function ie(e){return"unsubscribed_member"===e.type||"unsubscribed_admin"===e.type||"subscribed_member"===e.type||"subscribed_admin"===e.type||"subscribed_membership_admin"===e.type}function ae(e,t){return L(0,t)>=(0,l.v5)((0,h.fw)())}function se(e){return l.wP(e)?"setup_enterprise_trial":l.NG(e)?"setup_business_trial":void 0}function le(e){return!1}function ce(e){return l.QM(e)}function de(e){return!A()}function pe(e){return!A()}function ue(){return l.hf((0,y.zt)())}function me(e,t){switch(e){case"personal_free":case"team_free":case"free":return t.formatMessage(f.a.free);case"personal":return t.formatMessage(f.a.personal);case"student":return t.formatMessage(f.a.educationPlan);case"plus":return t.formatMessage(f.a.plusPlan);case"business":return t.formatMessage(f.a.business);case"enterprise":return t.formatMessage(f.a.enterprise);default:(0,c.t1)(e)}}function ge(e,t){const o=(0,y.zt)();return!!o&&t.includes(o)}},33941:(e,t,o)=>{o.d(t,{a:()=>n});const n=(0,o(5366).defineMessages)({ai:{defaultMessage:"AI",id:"ai.title"},personalFreePlan:{defaultMessage:"Personal Plan",id:"personalFreePlan.title"},personalFree:{defaultMessage:"Personal",id:"personalFree.title"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},freePlan:{defaultMessage:"Free Plan",id:"freePlan.title"},free:{defaultMessage:"Free",id:"free.title"},personalPlan:{defaultMessage:"Personal Pro Plan",id:"personalPlan.label"},personal:{defaultMessage:"Personal Pro",id:"personal.label"},singlePlayerPlusPlan:{defaultMessage:"Plus Plan with a 1-member limit",id:"singlePlayerPlusPlan.title"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"personalEducationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"educationPlusPlan.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},team:{defaultMessage:"Team",id:"team.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},plus:{defaultMessage:"Plus",id:"plus.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},business:{id:"business.title",defaultMessage:"Business"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"enterprisePlan.label"},enterprise:{defaultMessage:"Enterprise",id:"enterprise.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"legacyPlan.label"}})},35057:(e,t,o)=>{o.d(t,{Aw:()=>u,Mk:()=>d,QM:()=>c,Rs:()=>s,iJ:()=>m,mq:()=>p,p4:()=>g,sX:()=>a,wP:()=>l,zt:()=>i});var n=o(47425),r=o(78291);function i(){return r.default.getSubscriptionTier()}function a(){return n.sX(i())}function s(){return n.Rs(i())}function l(){return n.wP(i())}function c(){return n.QM(i())}function d(){return n.Mk(i())}function p(){return n.mq(i())}function u(){return n.Aw(i())}function m(){return n.iJ(i())}function g(e){return n.eZ(i(),e)}},87598:(e,t,o)=>{o.d(t,{z:()=>n});const n=(0,o(5366).defineMessages)({cancellingTrial:{defaultMessage:"Cancelling your trial.",id:"cancelTrial.error.message"},cancellationConfirmationMessage:{defaultMessage:"Are you sure you want to cancel your trial?",id:"cancelTrial.confirmation.message"},yes:{defaultMessage:"Yes, cancel my trial",id:"cancelTrial.yes.confirmation.message"}})},28956:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){}}const i=new r},63423:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},62142:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(49085),r=o(4615),i=o(27242);class a extends n.default{getInitialState(){return{open:!1,succeeded:!1}}close(){this.setState({open:!1,succeeded:!1})}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}open(e){this.setState({open:!0,temporaryBillingInterval:"month",temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,vatApplicable:!1,calculatingTax:!1,payButtonState:"disabled",subscriptionTier:"enterprise",targetPlan:void 0,targetSpace:e,totalUpgradeCost:void 0,onlyShowAddOn:!1,sessionId:(0,r.ZP)(),type:i.U.TargetSpace})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}}const s=new a},33493:(e,t,o)=>{o.d(t,{Z:()=>d});o(21703);var n=o(49085),r=o(92595),i=o(64793),a=o(12139),s=o(80444),l=o(22616);class c extends n.default{constructor(){var e;let t,o;super(),e=this;const n=()=>{if("ready"!==this.state.status)return;const e=this.state.prices.map((e=>{const t=Math.floor(100*Math.random()),o=Math.floor(e.unitAmount.amount/100);return new i.t({external_id:e.externalId,product:e.product,billing_interval:e.billingInterval,currency:e.currencyCode,state:e.state,regions:e.regions,unit_amount:100*o+t})}));this.setPrices(e)};(0,r.exposeDebugValue)("randomizePrices",(function(){let r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if("ready"!==e.state.status)return;const i=Boolean(o);r!==i&&(o&&(clearInterval(o),o=void 0),r?(t=e.state.prices,o=setInterval(n,1e3),n()):t&&e.setPrices(t))}))}getInitialState(){return{status:"init",prices:[],availableCurrencyCodes:["USD"],selectedCurrencyCode:void 0}}resetExceptSelectedCurrencyCode(){this.update((e=>({...this.getInitialState(),selectedCurrencyCode:e.selectedCurrencyCode})))}waitUntilReady(){return this.waitUntil((()=>"ready"===this.state.status))}setPrices(e){this.update((t=>{const o=Array.from(new Set(e.map((e=>e.currencyCode))));o.sort();const n=t.selectedCurrencyCode&&o.includes(t.selectedCurrencyCode)?t.selectedCurrencyCode:o.find((e=>"USD"!==e))??"USD";return{...t,status:"ready",prices:e,availableCurrencyCodes:o,selectedCurrencyCode:n}}))}didStartLoading(){this.update((e=>({...e,status:"loading"})))}getPrice(e,t){const{status:o,selectedCurrencyCode:n}=this.state;if("init"===o){var r;const t=null===(r=s.default.state.currentSpaceStore)||void 0===r?void 0:r.id;t&&l.Z({environment:e,spaceId:t})}if("ready"!==o)return{isLoaded:!1,result:void 0};const i=this.state.prices,c=i.filter((e=>e.currencyCode===n)),d=c.find(t);return d||a.IE(new Error("No matching price found in PriceStore.getPrice"),{extra:{allPriceCount:i.length,selectedCurrencyCode:n,selectedCurrencyPriceCount:c.length}}),{isLoaded:!0,result:d}}get selectedCurrencyCode(){return this.state.selectedCurrencyCode??"USD"}get availableCurrencyCodes(){return this.state.availableCurrencyCodes}get prices(){return this.state.prices}}const d=new c},25692:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},99334:(e,t,o)=>{let n;function r(e){n=e}function i(){return n}o.d(t,{$:()=>r,K:()=>i})},9867:(e,t,o)=>{o.d(t,{wT:()=>re,aQ:()=>fe,ED:()=>ke,mX:()=>Y,w6:()=>de,Ui:()=>be,Xy:()=>xe,Uj:()=>ce,Cj:()=>le,um:()=>ae,s:()=>me,Dv:()=>ue,lo:()=>ne,tn:()=>we,hI:()=>_e,mN:()=>he,WO:()=>ge,X0:()=>ee,YH:()=>ye,JX:()=>Se,Ju:()=>te,$J:()=>$,jg:()=>oe,xI:()=>K,lH:()=>H,fs:()=>z,$x:()=>W,d:()=>ve,W8:()=>J,Ce:()=>Q,RF:()=>pe});o(21703),o(57658);var n=o(15145),r=o(5220),i=o(68626),a=o(91155),s=o(27006),l=o(15047),c=o(29369),d=o(19889),p=o(90965),u=o(64684),m=o(97880),g=o(63143),h=o(50906),f=o(54642),y=o(47307),v=o(76464),b=o(9953),S=o(75018),_=o(29974),w=o(150),k=o(39699),x=o(65452),I=o(28020),C=o(33929),T=o(45010),M=o(78122),P=o(21115),A=o(27406),D=o(68418),B=o(38676),R=o(55838),E=o(80444),F=o(3418),N=o(35661),j=o(42185),O=o(30397),L=o(34583),U=o(35057),Z=o(30297),V=o(60396),q=o(36225);function z(e){const{store:t,update:o,transaction:n}=e;b.sW({store:t,data:(0,g.Q2)(o),transaction:n})}function W(e){let{environment:t,store:o,update:n,transaction:r}=e;const i=function(e){let{store:t,update:o}=e;const n=t.getSettingsStore().getValue();if(!n)return{};const r={};for(const i in o)r[i]=n[i];return r}({store:o,update:n});b.sW({store:o.getSettingsStore(),data:(0,g.Q2)(n),transaction:r}),h.ORE(t,{store:o,old_settings:i,updated_settings:n})}async function H(e){let{environment:t,spaceValue:o,addedStores:n,removedStores:r,createNewTeamFlowId:i,from:a}=e;const s=t.currentUser.id;if(!s||n.some((e=>!e.isDefined())))return!1;if(!(0,p.wv)(o,s))throw new Error("Only admins can update default teams");const{performResult:{results:l},serverCommitResult:c}=k.createAndCommit({environment:t,userAction:"teamActions.updateDefaultTeams",perform:e=>{const o=[];for(const r of n){const n=G({environment:t,transaction:e,teamStore:r,isDefault:!0,from:a,createNewTeamFlowId:i});o.push(n)}for(const n of r){const r=G({environment:t,transaction:e,teamStore:n,isDefault:!1,from:a,createNewTeamFlowId:i});o.push(r)}return{results:o}}});return await c,await L.bi(t),l.every((e=>e))}function G(e){let{environment:t,transaction:o,teamStore:n,isDefault:r,from:i,createNewTeamFlowId:a}=e;return n.isDefault()===r||(b.sW({store:n,data:{is_default:r},transaction:o}),o.postSubmitCallbacks.push((e=>{e||h.cXp(t,{store:n,is_default_team:r,create_new_team_flow_id:a,from:i})}))),!0}function K(e){var t;const{environment:o,teamStore:n,newRole:r,transaction:i,permissionsToClear:a}=e,l=a.map((e=>({...e,role:"none"}))),c=(null===(t=n.getTeamPermission())||void 0===t?void 0:t.role)??"none",d={type:"explicit_team_permission",team_id:n.id,role:r};l.push(d),v.ep({environment:o,store:n,permissionItems:l,transaction:i}),n.isDefault()&&v.ep({environment:o,store:n,permissionItems:[{type:"space_permission",role:r}],transaction:i}),(0,s.J5)(c)||!(0,s.J5)(r)||n.getDisableTeamPageEdits()||W({environment:o,store:n,update:{disable_team_page_edits:!0},transaction:i})}function $(e){const{environment:t,teamStore:o,newRole:n,transaction:r,permissionsToClear:i}=e,a=i.map((e=>({...e,role:"none"}))),s={type:"explicit_team_guest_permission",team_id:o.id,role:n};a.push(s),v.ep({environment:t,store:o,permissionItems:a,transaction:r})}function Y(e){let{userId:t,teamStore:o,transaction:n,environment:r,permissionRole:i}=e;const a=o.getMembershipDefinedOnTeam(),s=a.find((e=>"user"===e.entity_type&&e.user_id===t));if(!s)throw new Error("Specified user is not on the team");if("member"===s.type)return!1;if(!o.isDefined())return!1;const l=o.getPermissionItems(),c=o.id;if(i&&(0,u.bk)({teamValue:{id:c,permissions:l},permissionRole:i}))throw new Error("Cannot set member's permission to be lower than default team permission.");if(!(0,u.XO)({membership:a}).includes(t))throw new Error("Specified user is not an owner of the team");let d=!1;if(a.length>0){const e=a.filter((e=>!("user"===e.entity_type&&e.user_id===t)));d=a.length!==e.length;const i=[{entity_type:"user",type:"member",user_id:t},...e];k.applyOperation({store:o,operation:{pointer:o.pointer,path:["membership"],command:"set",args:i},transaction:n}),h.PdU(r,{store:o,permission_user_id:t,team_role:"member"})}let p=i||"none";const m=(0,u.xC)({id:c,permissions:l});m&&i===m&&(p="none");const g={type:"user_permission",role:p,user_id:t};return v.ep({environment:r,store:o,permissionItems:[g],transaction:n,skipAnalytics:d})}function Q(e){let{environment:t,userId:o,teamStore:n,spaceStore:r,transaction:i,newTeamRole:a}=e;if(!n.isDefined())return!1;const s=n.getMembers().find((e=>"user"===e.entity_type&&e.user_id===o));return!!s&&(s.type!==a&&(k.applyOperation({store:n,operation:{pointer:n.pointer,path:["membership"],command:"setTeamMembershipItem",args:{entity_type:"user",type:a,user_id:o}},transaction:i}),v.ep({environment:t,store:r,permissionItems:[{type:"user_permission",role:"read_and_write",user_id:o}],transaction:i}),ee({environment:t,memberInfo:s,teamStore:n,transaction:i}),!0))}function J(e){let{environment:t,userId:o,teamStore:n,transaction:r}=e;const i=n.getMembers().find((e=>"user"===e.entity_type&&e.user_id===o));if(!i)throw new Error("Specified user is not on the team");if("owner"===i.type)return!1;if(!n.isDefined())return!1;const a=n.getMembershipDefinedOnTeam().filter((e=>!("user"===e.entity_type&&e.user_id===o))),s=[{entity_type:"user",type:"owner",user_id:o},...a];return k.applyOperation({store:n,operation:{pointer:n.pointer,path:["membership"],command:"set",args:s},transaction:r}),h.PdU(t,{store:n,permission_user_id:o,team_role:"owner"}),ee({environment:t,memberInfo:i,teamStore:n,transaction:r}),!0}function X(e){let{memberInfo:t,newRole:o}=e;return"user"===t.entity_type?{type:"user_permission",user_id:t.user_id,role:o}:{type:"group_permission",group_id:t.group_id,role:o}}function ee(e){let{environment:t,memberInfo:o,teamStore:n,transaction:r}=e;return!!n.getPermissionItems()&&(v.ep({environment:t,store:n,permissionItems:[X({memberInfo:o,newRole:"none"})],transaction:r}),!0)}async function te(e){let{store:t,environment:o,accessLevel:n,teamName:r,from:i,isDefault:a}=e;const{currentSpaceStore:s}=E.default.getState();if(!s)throw new Error("currentSpaceStore does not exist");const l=t.isDefault()??!1,c=t.getTeamAccessLevel(),d=(0,u.Hf)({membership:t.getRawMembership()}).length;if(n===c&&a===l)return!1;if(!(await M.hL({teamName:r,accessLevel:n,currentIsDefault:l,isDefault:a,numberOfTeamGuests:d})))return!1;const p=t.getPermissionItems(),m=t.getSettingsStore().getValue();if(!m||!p)return!1;const g=(0,u.AW)({teamValue:{id:t.id,permissions:p,settings:m},accessLevel:n,isDefault:a}),{performResult:{result:f}}=k.createAndCommit({userAction:"teamActions.setTeamAccessLevel",environment:o,perform:e=>{G({environment:o,transaction:e,teamStore:t,isDefault:"invite_only"!==g.settings.space_member_join_access&&a,from:i,createNewTeamFlowId:void 0});const n=v.ep({environment:o,store:t,permissionItems:g.permissions,transaction:e});return b.sW({store:t.getSettingsStore(),data:g.settings,transaction:e}),{result:n}}});return f&&h.BWF(o,{store:t,old_access_level:c,new_access_level:n,from:i}),f}function oe(e){let{memberInfo:t,teamStore:o,transaction:n,environment:r,permissionRole:i}=e;if("owner"===t.type)return Y({userId:t.user_id,teamStore:o,transaction:n,environment:r,permissionRole:i});if(!o.isDefined())return!1;const a=o.id,s=o.getPermissionItems(),l=o.getMembers();if(i&&(0,u.bk)({teamValue:{id:a,permissions:s},permissionRole:i}))throw new Error("Cannot set member's permission to be lower than default team permission.");const c=(0,u.hY)({membership:l});if("user"===t.entity_type&&!c.find((e=>"user"===e.entity_type&&e.user_id===t.user_id))||"group"===t.entity_type&&!c.find((e=>"group"===e.entity_type&&e.group_id===t.group_id)))throw new Error("Specified memberInfo not found on team");let d=i||"none";const p=(0,u.xC)({id:a,permissions:s});return p&&i===p&&(d="none"),v.ep({environment:r,store:o,permissionItems:[X({memberInfo:t,newRole:d})],transaction:n})}function ne(e,t){D.Z.setState({...D.Z.state,open:!0,from:e}),D.Z.state.onClose=null==t?void 0:t.onClose}async function re(e){let{environment:t,currentSpaceStore:o,teamStore:n,from:r,action:i}=e;const a=t.currentUser.id;if(!a||!o||!(0,Z.o)({userId:a,spaceStore:o,entrypoint:r}))return!1;if(!(await async function(e){return!q.Z.state.open&&await new Promise((t=>{q.Z.setState({open:!0,type:e,onAccept:()=>t(!0),onCancel:()=>t(!1)})}))}(i)))return!1;const s=await f.setAdminPrivilegedTeamMembership(t,{spaceId:o.id,teamId:n.id,teamRole:ie(i)});if("failed"===s.type)return xe(s),!1;switch(i){case"joinTeamAsOwner":case"joinClosedOrPrivateTeamAsMember":se({environment:t,teamStore:n,from:r,newRole:"joinTeamAsOwner"===i?"owner":"member",usingAdminPrivileges:!0,andNavigateToTeamHome:!1});break;case"upgradeToOwner":h.PdU(t,{permission_user_id:a,team_role:"owner",store:n});const e=n.getName();e&&(0,P._t)(e);break;default:(0,m.t1)(i)}return!0}function ie(e){switch(e){case"joinTeamAsOwner":case"upgradeToOwner":return"owner";case"joinClosedOrPrivateTeamAsMember":return"member";default:(0,m.t1)(e)}}async function ae(e){let{environment:t,currentSpaceStore:o,teamStore:n,from:r,andNavigateToTeamHome:i}=e;const a=t.currentUser.id;if(!a)return!1;const s=await f.updateTeamMembers(t,{spaceId:o.id,teamId:n.id,newMembersOrGuestsToAdd:[{type:"member",entity_type:"user",user_id:a}]});return"failed"===s.type?(xe(s),!1):(se({environment:t,teamStore:n,from:r,newRole:"member",usingAdminPrivileges:!1,andNavigateToTeamHome:i}),!0)}function se(e){let{environment:t,teamStore:o,from:n,newRole:r,usingAdminPrivileges:i,andNavigateToTeamHome:a}=e;const s=t.currentUser.id,l=E.default.state.currentSpaceStore,c=E.default.state.currentSpaceViewStore;if(!s||!l||!c)return!1;!function(e){var t;let{environment:o,currentSpaceViewStore:n,teamId:r}=e;const i=null===(t=(0,I.k_)(o).state)||void 0===t?void 0:t.userJoinedTeamsStores;if(!i||!n)return!1;const a=[...i.map((e=>{let{id:t}=e;return t})).filter((e=>e!==r)),r];w.Ct({environment:o,currentSpaceViewStore:n,orderedTeamIds:a,userAction:"TeamBrowserOutliner",isExplicitUserAction:!1})}({environment:t,currentSpaceViewStore:c,teamId:o.id}),h.UD9(t,{store:o,joined_role:r,from:n}),x.l({environment:t,userId:s,spaceId:l.id});const d=o.getName();a?(_e({environment:t,teamStore:o,shouldScroll:!1}),d&&new Promise((e=>setTimeout(e,500))).then((()=>{(0,P.$$)({teamName:d,usingAdminPrivileges:i})}))):d&&(0,P.$$)({teamName:d,usingAdminPrivileges:i})}async function le(e){let{environment:t,teamId:o,spaceId:n,teamMemberInfos:r,isSettingDefaultTeam:i,inviterId:a}=e;const s=t.currentUser.id;if(!n||!s)return!1;return"failed"!==(await f.updateTeamMembers(t,{spaceId:n,teamId:o,newMembersOrGuestsToAdd:r,isSettingDefaultTeam:i,addNewMembersToSpace:!1},a)).type}async function ce(e){let{environment:t,teamStore:o,teamMemberInfos:n,isSettingDefaultTeam:r,createNewTeamFlowId:i}=e;const a=o.getSpaceId();if(!a)return!1;const s=t.currentUser.id;if(!a||!s)return!1;if("failed"===(await f.updateTeamMembers(t,{spaceId:a,teamId:o.id,newMembersOrGuestsToAdd:n,isSettingDefaultTeam:r,addNewMembersToSpace:(0,U.Mk)()},s)).type)return!1;if(!r){const e=n.flatMap((e=>"user"!==e.entity_type?[]:e.user_id)),r=e.length,a=n.filter((e=>"group"===e.entity_type)).length;r>0&&h.ixp(t,{store:o,num_members_invited:r,create_new_team_flow_id:i,members_invited:e}),a>0&&h.$1W(t,{store:o,num_groups_invited:a,create_new_team_flow_id:i})}return!0}function de(e){switch(e){case"team_browser":case"duplicate_team":case"create_team_from_page":case"permission_item":case"teams_dropdown_for_team_guest":case"teams_dropdown_for_team_member":case"teams_dropdown_for_group":case"teamSidebar":case"teamBrowserSearch":case"teamBrowserUnjoinedTeams":case"teamBrowserJoinedTeams":case"team_breadcrumb_popup":case"team_menu_header":case"sidebar_team_modal":case"team_invite_link":return!1;case"manage_teams_table":return!0;default:(0,m.t1)(e)}}function pe(e){let{environment:t,teamId:o,tab:n,from:r,buttonPopupStore:i}=e;const a=E.default.state.currentSpaceStore;if(!a)return;const s=N.zX.createChildStore(a,{table:c.e0,id:o});if(s.canRead())R.Z.update((e=>({...e,open:!0,tab:n,teamStore:s,viewingUnjoinedPrivateTeamAsEnterpriseAdmin:!1})));else{const e=ue({environment:t,spaceStore:a,teamId:o,from:r});if(!e)return;R.Z.update((t=>({...t,open:!0,tab:n,unjoinedPrivateTeamStore:e,viewingUnjoinedPrivateTeamAsEnterpriseAdmin:!0})))}i&&(F.Z.removeNamedPopup("team_more_actions"),i.setState({...i.state,open:!1}))}function ue(e){var t;let{environment:o,spaceStore:n,teamId:i,from:a}=e;if(!de(a))return;const s=n.getModel(),l=null===(t=E.default.state.currentUserStore)||void 0===t?void 0:t.id;if(!(0,r.H)({spaceModel:s,userId:l}))return;const c=V.Z.createTeamStoreFromCache({environment:o,teamId:i,spaceId:n.id,userId:l}),d=null==c?void 0:c.getModel();return null!=c&&c.canRead()&&d&&(0,u.Ei)({userId:l,teamModel:d,spaceModel:s})?c:void 0}async function me(e){let{environment:t,teamStore:o,currentSpaceStore:n,from:r}=e;const i=t.currentUser.id;return!!i&&await ge({environment:t,teamStore:o,currentSpaceStore:n,userId:i,from:r})}async function ge(e){let{environment:t,teamStore:o,currentSpaceStore:n,userId:r,from:i}=e;const a=o.getSpaceId();if(!(o.isDefined()&&null!=n&&n.isDefined()&&t.currentUser.id&&a))return!1;const s=o.getMembers(),l=(0,u.XO)({membership:s}),c=l.some((e=>e===r));if(c&&1===l.length)return M.ZH(),!1;const p=(0,u.x4)({members:s,groups:n.getPermissionGroups()}).filter((e=>{var t;return null===(t=e.user_ids)||void 0===t?void 0:t.includes(r)}));if(!o.getMembers().find((e=>"user"===e.entity_type&&e.user_id===r)))return M.T0(p),!1;const m=N.t1.createChildStore(o,{table:d.KJ,id:r}),g=r===t.currentUser.id,y=o.getName()??"",v=m.getDisplayName(C.default.getIntl());if(!(await M.A8({isCurrentUser:g,teamName:y,memberName:v})))return!1;const b=[{entity_type:"user",type:c?"owner":"member",user_id:r}],S=await f.updateTeamMembers(t,{spaceId:a,teamId:o.id,existingMembersOrGuestsToRemove:b});return"failed"===S.type?(xe(S),!1):(h.$aC(t,{store:o,is_leaving_team:g,num_members_removed:b.length,from:i}),p.length>0?g?(0,P.K9)(y,p):(0,P.zs)(v,y,p):g&&(0,P.e6)(y),x.l({environment:t,userId:r,spaceId:a}),!0)}function he(e){let{environment:t,teamStore:o,group:n}=e;const r=o.getSpaceId();if(!r)return;const i=o.getMembers().find((e=>"group"===e.entity_type&&e.group_id===n.id));i&&M.iT({group:n,onAccept:async()=>{const e=[i],n=await f.updateTeamMembers(t,{spaceId:r,teamId:o.id,existingMembersOrGuestsToRemove:e});"failed"!==n.type?h.miu(t,{store:o,num_groups_removed:e.length}):xe(n)}})}async function fe(e){const{currentSpaceStore:t}=E.default.getState();if(!t)throw new Error("currentSpaceStore does not exist");const{environment:o,teamStore:n,from:r}=e,i=o.currentUser.id,a=n.getName()||"",c=t.getSettingsStore();if(!i)return;const d=O.Z.state.teams.map((e=>({membership:e.getMembers(),id:e.id,archived_by:e.getArchivedBy(),is_default:e.isDefault()}))),p=(0,u.wN)({spaceValue:{permissions:t.getPermissionItems(),permission_groups:t.getPermissionGroups()},teamsInSpace:d,currentUserId:i});if(await M.Fy(a,p)){if(p){const e=await M.wG(a);k.createAndCommit({userAction:"teamsHelpers.archiveLastTeam",environment:o,perform:o=>{if(z({store:n,update:{archived_by:i,archived_at:Date.now()},transaction:o}),b.sW({store:c,data:{is_teams_enabled:!1},transaction:o}),_.oy({planType:"personal",spaceStore:t,transaction:o}),e){const e=n.getTeamPagesStores()??[];for(const n of e){const e=n.getRole();if(!e)continue;const r={type:"user_permission",user_id:i,role:e},a=[...n.getPermissionItems().filter((e=>!s.fG(e)&&!s.Le(e)&&!s.ix(e))),r];b.sW({store:n,data:{parent_id:t.id,parent_table:l.bx,permissions:a},transaction:o})}b.sW({store:n,data:{team_pages:[]},transaction:o})}}}),h.mFL(o,{store:n,from:r})}else k.createAndCommit({userAction:"teamsHelpers.archiveTeam",environment:o,perform:e=>{z({store:n,update:{archived_by:i,archived_at:Date.now()},transaction:e})}});h.Gpy(o,{store:n,from:r}),R.Z.setState({open:!1,limitMembers:!0,memberFilterQuery:"",tab:void 0}),(0,P.CC)(a)}}function ye(e){let{environment:t,teamStore:o,teamName:n,from:r}=e;k.createAndCommit({userAction:"teamsHelpers.restoreArchivedTeam",environment:t,perform:e=>{z({store:o,update:{archived_by:void 0,archived_at:void 0},transaction:e})}}),h.IWJ(t,{store:o,from:r}),(0,P.JB)(n)}async function ve(e){let{settingName:t,newTeamSettingValue:o,spaceSettingValue:n,environment:r,store:i}=e;let a=!0;return"disable"===n&&"allow"===o?a=await M.hC(t):"disable"===o&&(a=await M.Bj(t)),!!a&&(k.createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:r,perform:e=>{W({environment:r,store:i,update:{[t]:"disable"===o},transaction:e})}}),!0)}function be(e){return`TeamToggle_${e.id}`}function Se(e){let{teamStore:t,environment:o}=e;if(o.device.isMobile)return;const n=be(t),r=A.Z.findDropTargetFromKey(n);if(r){const e=r.getNode();if(!(e instanceof HTMLElement))return;if(T.Z.SidebarScroller){var i;const o=(null===(i=T.Z.SidebarScroller.scrollerEl())||void 0===i?void 0:i.offsetTop)||0;T.Z.SidebarScroller.scrollTo(e.offsetTop-o,0,{animate:!0}),j.Z.setState(t.id),setTimeout((()=>{j.Z.state===t.id&&j.Z.setState(void 0)}),1500)}}}function _e(e){const{environment:t,teamStore:o,shouldScroll:r}=e;r&&Se({teamStore:o,environment:t});const i=o.getTeamPagesStores();!i||i.length<1||(S.navigateToBlock({environment:t,store:i[0],pageVisitSource:n.tY.JoinTeam}),h.SJp(t,{store:o}))}function we(e,t){let{from:o}=t;h.piC(e,{from:o}),B.kx.setState(!B.kx.state)}function ke(e){let{environment:t,from:o,teamStore:n}=e;const{state:r}=D.Z;var i,a;(h.Prc(t,{screen:r.screen,team_id:r.teamId,team_has_icon:Boolean(r.icon),team_has_name:Boolean(r.name),team_has_description:Boolean(r.description),team_access_level:r.accessLevel,flow_id:r.flowId,from:o,store:n}),r.teamId)&&(null===(i=(a=D.Z.state).onClose)||void 0===i||i.call(a,r.teamId));D.Z.reset()}function xe(e){y.showError(e),i.log({level:"error",from:"teamActions",type:"TeamApiError",error:(0,a.Ui)(e.error),data:{miscDataToConvertToString:{body:e.body,status:e.status}}})}},73292:(e,t,o)=>{o.d(t,{RW:()=>s,k7:()=>a,oO:()=>l});var n=o(15157),r=o(50906),i=o(70704);function a(e){const{environment:t,spaceViewStore:o,teamStore:i,outlinerToggleButtonStore:a,newIsHidden:l,shouldPersistToggleState:c,isExplicitUserAction:d}=e;a.setState({...a.state,isHidden:l}),d&&r.MRb(t,{store:i,is_toggled:!l,outliner_type:e.teamOutlinerType}),c&&n.Z.set({userId:o.environment.currentUser.id,key:s(o,i.id),value:l})}function s(e,t){return`Team_Outliner_Item_${e.id}:${t}`}function l(e){let{oldState:t,teamIds:o,spaceId:r,userId:a}=e;return o.reduce(((e,o)=>{if(o in e)return e;if(o in t)return e[o]=t[o],e;const l=s({id:r},o),c=n.Z.get({userId:a,key:l});return e[o]=new i.Z,e[o].setState({isHidden:c??!1}),e}),{})}},28517:(e,t,o)=>{o.d(t,{I:()=>s,m:()=>l});o(21703);var n=o(72126),r=o(54642),i=o(95697),a=o(69911);async function s(e){let{environment:t,spaceId:o,userId:n}=e;if(!t.currentUser.loggedInUserIds.includes(n))throw new Error("Must be logged in user.");(0,i.bq)()&&(a.Z.getUserJoinedTeamsState({userId:n,spaceId:o})||await l({environment:t,spaceId:o,userId:n}))}async function l(e){var t;let{environment:o,spaceId:i,userId:s,emitValue:l}=e;if(!o.currentUser.loggedInUserIds.includes(s))throw new Error("Must be logged in user.");a.Z.setHasFetched({userId:s,spaceId:i});const c=await r.getTeams(o,{spaceId:i,onlyJoined:!0},s);if("failed"===c.type)return;const d=c.data.teamIds,p=(null===(t=a.Z.getUserJoinedTeamsState({userId:s,spaceId:i}))||void 0===t?void 0:t.joinedTeamsIds)||[];d.length===p.length&&0===n.e5(d,p).length&&0===n.e5(p,d).length||a.Z.setUserJoinedTeamsState({userId:s,spaceId:i,state:{joinedTeamsIds:d,lastEmitValue:l}})}},74016:(e,t,o)=>{o.d(t,{p:()=>m});o(67294);var n=o(480),r=o(86628),i=o(24405),a=o(79362),s=o(22808),l=o(31278),c=o(38755),d=o(80444),p=o(35661),u=o(85893);function m(e){window.__c={n:"TeamSpaceIcon"};const{store:t,size:o=16,style:m,disabled:g=!1,onChange:h=(()=>{})}=e,f=(0,n.O7)(),{name:y,icon:v}=(0,r.VK)((()=>{const o=d.default.state.currentSpaceStore;return t?t instanceof p.zX?{name:t.getName(),icon:e.icon??t.getIcon()}:{name:(0,c.rn)(f,t),icon:e.icon??(0,c.Wd)(f,t)}:{name:o&&`team-icon-${o.id}`,icon:e.icon}}),[t,f,e.icon]),b=(0,i.yK)((e=>({backgroundContainer:{background:v&&(0,a.V2)(v.icon)?(0,a.Pk)(v.icon,e.mode):e.regularDividerColor,width:o,height:o}})),[v,o]),S=v&&v.icon&&((0,a.V2)(v.icon)||(0,s.Z)(v.icon)),_=e.iconLoggingData||t&&{recordTable:t.table,source:"team_settings"};return(0,u.jsx)(l.Z,{title:y,icon:v,size:S?.9*o:o,emojiSize:S?.78*o:o,isEmptyPage:!1,style:S?{...m,...b.backgroundContainer}:m,isLarge:!0,largeIcon:!0,iconLoggingData:_,...g?{disabled:!0}:{disabled:!1,onChange:h,bucket:"public"}})}},30297:(e,t,o)=>{o.d(t,{o:()=>l,r:()=>c});var n=o(480),r=o(86628),i=o(5220),a=o(80444),s=o(9867);function l(e){let{entrypoint:t,userId:o,spaceStore:n}=e;return(0,i.H)({spaceModel:null==n?void 0:n.getModel(),userId:o})&&s.w6(t)}function c(e){const t=(0,n.O7)().currentUser.id;return(0,r.VK)((()=>{const{currentSpaceStore:o}=a.default.state;return l({entrypoint:e,spaceStore:o,userId:t})}),[t,e])}},60396:(e,t,o)=>{o.d(t,{Z:()=>c});var n=o(26263),r=o(49085),i=o(29369),a=o(97880),s=o(20431);class l extends r.default{getInitialState(){return{initialized:!1}}createTeamStoreFromCache(e){let{environment:t,teamId:o,spaceId:n,userId:r}=e;if(this.state.initialized&&n&&r&&this.state.spaceId===n&&this.state.userId===r)return new s.z(t,{table:i.e0,id:o},{inMemoryRecordCache:this.state.inMemoryCache})}initialize(e){let{environment:t,userId:o,spaceId:r,teamIds:s,getRecordWithRole:l}=e;const c=new n.Z({name:"GlobalEnterpriseAdminTeamsStore"});for(const n of s){const e={table:i.e0,id:n};c.setRecord({pointer:e,userId:o},l(e))}return this.setState({initialized:!0,spaceId:r,userId:o,inMemoryCache:c}),s.map((e=>this.createTeamStoreFromCache({environment:t,teamId:e,spaceId:r,userId:o}))).filter(a.$K)}}const c=new l},36225:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{open:!1}}}const i=new r},75769:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{hasShownTooltip:!1}}hasShownTootlip(e){return this.state.hasShownTooltip&&this.state.teamId===e}}const i=new r},69911:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{joinedTeamsStates:{},hasFetched:new Set}}getKey(e){let{userId:t,spaceId:o}=e;return`${t}:${o}`}getUserJoinedTeamsState(e){let{userId:t,spaceId:o}=e;const n=this.getKey({userId:t,spaceId:o});return this.state.joinedTeamsStates[n]}setUserJoinedTeamsState(e){let{userId:t,spaceId:o,state:n}=e;const r=this.getKey({userId:t,spaceId:o});this.state.joinedTeamsStates[r]=n,this.emit()}getHasFetched(e){let{userId:t,spaceId:o}=e;const n=this.getKey({userId:t,spaceId:o});return this.state.hasFetched.has(n)}setHasFetched(e){let{userId:t,spaceId:o}=e;const n=this.getKey({userId:t,spaceId:o});this.state.hasFetched.add(n)}}const i=new r},29949:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(49085);class r extends n.default{getInitialState(){return{status:"closed"}}open(e){const{analyticsFrom:t,cloneTo:o,selectedTemplate:n,selectedTeam:r}=e;this.setState({...this.state,status:"opening",analyticsFrom:t,cloneTo:o,selectedTemplate:n,selectedTeam:r})}}const i=new r},24161:(e,t,o)=>{o.d(t,{N:()=>a,v:()=>i});var n=o(97880);const r={invertedInsertText:!0,invertedDeleteText:!0,invertedMoveTextSlice:!0,invertedAddAnnotation:!0,invertedRemoveAnnotation:!0};function i(e){return Boolean(r[e.command])}function a(e){const{pointer:t,invertedCrdtOperation:o}=e,r=o.type;switch(r){case"invertedInsertText":return{command:"invertedInsertText",pointer:t,path:[],args:o};case"invertedDeleteText":return{command:"invertedDeleteText",pointer:t,path:[],args:o};case"invertedAddAnnotation":return{command:"invertedAddAnnotation",pointer:t,path:[],args:o};case"invertedRemoveAnnotation":return{command:"invertedRemoveAnnotation",pointer:t,path:[],args:o};default:(0,n.t1)(r)}}},60027:(e,t,o)=>{o.d(t,{T:()=>h,n:()=>f});o(67294);var n=o(68626),r=o(5366),i=o(50906),a=o(54642),s=o(47307),l=o(80444),c=o(78291),d=o(22616),p=o(34583),u=o(33493),m=o(22500),g=o(85893);async function h(e){const{environment:t,stripe:o,elements:a}=e;if(!c.default.state.data)return void n.log({level:"error",from:"trialUpsellActions",type:"StripeError",error:{miscDataString:"Unable to get subscription data."}});if(!a||!o)return void n.log({level:"error",from:"trialUpsellActions",type:"StripeError",error:{miscDataString:"Stripe elements not initialized when user tried to upgrade"}});const{error:h}=await a.submit();if(h)return void i.iL9(t,{error:"could not submit form",error_type:"payment_method"});const f=await o.createPaymentMethod({elements:a});if(f.error)return void i.iL9(t,{error:f.error.message,error_type:"payment_method"});if(!f.paymentMethod)return void i.iL9(t,{error:"could not create token",error_type:"payment_method"});const y={type:"paymentMethodId",value:f.paymentMethod.id};return await async function(e){var t;const{environment:o,paymentData:n,stripe:a,subscriptionTier:c}=e,m=l.default.state.currentSpaceStore;m&&await d.Z({environment:o,spaceId:m.id});const{status:h,prices:f,selectedCurrencyCode:y}=u.Z.state;if(!m||"ready"!==h)return;const v="month",b=null===(t=f.find((e=>e.product===c&&e.billingInterval===v&&e.currencyCode===y)))||void 0===t?void 0:t.externalId;try{const e=await p.Mg({environment:o,spaceStore:m,plan:b,paymentData:n,from:"onboarding",isTrial:!0}),t=e.paymentIntentClientSecret,i=e.paymentIntentStatus;if(t&&"requires_action"===i){const{error:e}=await a.handleNextAction({clientSecret:t});e&&(await p.EO({environment:o,spaceStore:m,planType:m.getPlanType()??"personal",from:"subscription_upgrade_onboarding_failed_payment"}),s.showErrorMessage((0,g.jsx)(r.FormattedMessage,{id:"subscription.upgrade.payment_failed",defaultMessage:"Your payment could not be processed. Please provide an alternate payment method or you will lose access to Notion."})))}return"success"}catch{return void i.BgI(o)}}({environment:t,paymentData:y,stripe:o,subscriptionTier:(0,m.Hy)()})}async function f(e){const t=await a.getExternalOrgData(e,{});if("failed"===t.type)return!1;const o=t.data;return"company_employee_count"in o&&parseInt(o.company_employee_count)>99}},39343:(e,t,o)=>{o.d(t,{Fk:()=>a,nx:()=>s});var n=o(30120),r=o(13991),i=o(7057);function a(e){return!(null==e||!e.trialEnd)&&e.trialEnd>=n.ou.now().toSeconds()}function s(e){const t=function(e){if(!a(e))return;const t=1e3*(null==e?void 0:e.trialEnd);return null!=e&&e.periodEnd&&e.periodEnd>=n.ou.now().toSeconds()&&e.periodEnd<t?e.periodEnd:t}(e);return t?(0,i.Yx)(t,"long",r.SP):void 0}},22500:(e,t,o)=>{o.d(t,{Hy:()=>c,XG:()=>l,zQ:()=>s});var n=o(47425),r=o(53809),i=o(30548);const a=new r.D({key:"trialUpsell",namespace:i.$p,important:!1,trackingType:"preference"});function s(e){a.setState(e)}function l(){a.setState(void 0)}function c(){const e=a.getState();return e&&(0,n.mq)(e)&&(0,n.NG)(e)?"business":"plus"}},42198:(e,t,o)=>{o.r(t),o.d(t,{default:()=>m});var n=o(49085),r=o(72126),i=o(63143),a=o(77080),s=(o(57658),o(97880)),l=o(54642),c=o(98730);async function d(e){const{spaceId:t,userId:o,environment:n}=e,r=await l.getUserSignals(n,{spaceId:t,signals:[{name:"similarUserRecentPages",includeRecords:!0},{name:"topPages7dPageView",includeRecords:!0},{name:"editedPages1d",includeRecords:!0},{name:"similarUsersEditedPages1d",includeRecords:!0}]});if("success"===r.type){const e={};r.data.signals.forEach((t=>{if("error"===t.status)return;const o=t.name;"similarUserRecentPages"===o?e[o]=function(e){const t=new Map,o=new Map;return e.forEach((e=>{let{userId:t,similarity:n}=e;o.set(t,n)})),e.forEach((e=>{const{userId:n,similarity:r}=e;e.recentPages.forEach((i=>{let{visitedAt:a,pageId:s}=i;const l=t.get(s);if(l){l.userIds.push(n),l.mostRecentlyVisitedAt<a&&(l.mostRecentlyVisitedUser=e.userId,l.mostRecentlyVisitedAt=a);const t=o.get(l.mostSimilarUser);t&&t<r&&(l.mostSimilarUser=n)}else t.set(s,{userIds:[n],mostRecentlyVisitedUser:n,mostRecentlyVisitedAt:a,mostSimilarUser:n})}))})),{pagesMetadata:t,userSimilarityScores:o}}(t.data):"topPages7dPageView"===o?e[o]=function(e){const t=new Map;return e.forEach((e=>{t.set(e.pageId,e.pageAuthorityV1)})),t}(t.data):"editedPages1d"===o||"similarUsersEditedPages1d"===o?e[o]=function(e){const t=new Map;return e.forEach((e=>{t.set(e.pageId,e.editedAt)})),t}(t.data):(0,s.t1)(o)})),m.update((n=>({...n,userSignals:n.userSignals.set(m.getKey(t,o),e)}))),c.S(n)}}const p=5*i.hM;class u extends n.default{constructor(){super(...arguments),this.refreshTimer=void 0,this.getKeyMemoized=(0,r.HP)(this.getKey)}getInitialState(){return{userSignals:new Map}}getKey(e,t){return`${e}:${t}`}getUserSignals(e){let{spaceId:t,userId:o}=e;if(!t||!o)return;const n=this.getKeyMemoized(t,o),r=this.state.userSignals.get(n);return r||void 0}initializeAndLoadAllUserSignals(e){this.refreshTimer&&window.clearTimeout(this.refreshTimer);a.default.getEligibleGroup({experimentId:"search-new-local-recall-v1"})&&(d(e),this.refreshTimer=window.setTimeout((()=>{d(e)}),p))}isSimilarUsersRecentPages(e){var t;const{userId:o,spaceId:n,pageId:r}=e;return null===(t=this.getUserSignals({userId:o,spaceId:n}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t?void 0:t.has(r)}getNumSimilarUsersVisitedPage(e){var t;const{userId:o,spaceId:n,pageId:r}=e;return null===(t=this.getUserSignals({userId:o,spaceId:n}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(r))||void 0===t||null===(t=t.userIds)||void 0===t?void 0:t.length}getSimilarUsersMostRecentVisitTimeForPage(e){var t;const{userId:o,spaceId:n,pageId:r}=e;return null===(t=this.getUserSignals({userId:o,spaceId:n}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(r))||void 0===t?void 0:t.mostRecentlyVisitedAt}getHighestViewerSimilarityScoreForPage(e){var t,o;const{userId:n,spaceId:r,pageId:i}=e,a=this.getUserSignals({userId:n,spaceId:r}),s=null==a||null===(t=a.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(i))||void 0===t?void 0:t.mostSimilarUser;if(s)return null==a||null===(o=a.similarUserRecentPages)||void 0===o||null===(o=o.userSimilarityScores)||void 0===o?void 0:o.get(s)}isTopPages7dPageView(e){var t;const{userId:o,spaceId:n,pageId:r}=e;return null===(t=this.getUserSignals({userId:o,spaceId:n}))||void 0===t||null===(t=t.topPages7dPageView)||void 0===t?void 0:t.has(r)}getPageAuthorityV1ForPage(e){var t;const{userId:o,spaceId:n,pageId:r}=e;return null===(t=this.getUserSignals({userId:o,spaceId:n}))||void 0===t||null===(t=t.topPages7dPageView)||void 0===t?void 0:t.get(r)}isRecentlyEdited(e){var t;const{userId:o,spaceId:n,pageId:r}=e;return null===(t=this.getUserSignals({userId:o,spaceId:n}))||void 0===t||null===(t=t.editedPages1d)||void 0===t?void 0:t.has(r)}getUserLastEditedTimeForPage(e){var t;const{userId:o,spaceId:n,pageId:r}=e;return null===(t=this.getUserSignals({userId:o,spaceId:n}))||void 0===t||null===(t=t.editedPages1d)||void 0===t?void 0:t.get(r)}isSimilarUsersRecentlyEdited(e){var t;const{userId:o,spaceId:n,pageId:r}=e;return null===(t=this.getUserSignals({userId:o,spaceId:n}))||void 0===t||null===(t=t.similarUsersEditedPages1d)||void 0===t?void 0:t.has(r)}getSimilarUserLastEditedTimeForPage(e){var t;const{userId:o,spaceId:n,pageId:r}=e;return null===(t=this.getUserSignals({userId:o,spaceId:n}))||void 0===t||null===(t=t.similarUsersEditedPages1d)||void 0===t?void 0:t.get(r)}}const m=new u},28084:(e,t,o)=>{o.d(t,{Z:()=>i});o(21703),o(57658);var n=o(7406),r=o(29477);const i=class{constructor(e){this.performRequests=void 0,this.batchSize=void 0,this.maxWorkers=void 0,this.requestDelayMs=void 0,this.requestTimeoutMs=void 0,this.queue=[],this.currentWorkers=0,this.currentSetTimeouts=0,this.dequeue=async()=>{if(this.currentSetTimeouts=0,this.currentWorkers>=this.maxWorkers||0===this.queue.length)return;this.currentWorkers++;const e=this.queue.splice(0,this.batchSize),t=e.map((e=>e.request));let o,i;try{if(this.requestTimeoutMs){const e=await r.OI(this.requestTimeoutMs,[this.performRequests(t)]);if(e.timeout)throw new Error("Timed out.");o=e.result}else o=await this.performRequests(t)}catch(a){i=(0,n.tg)(a)}try{if(i)for(let t=0;t<e.length;t++){e[t].deferred.reject(i)}else if(o)for(let t=0;t<e.length;t++){const n=e[t],r=o[t];n.deferred.resolve(r)}}catch(s){}this.currentWorkers--,this.queue.length>=this.batchSize?this.dequeue():this.dequeueAfterTimeout()};const{performRequests:t,batchSize:o,maxWorkers:i,requestDelayMs:a,requestTimeoutMs:s}=e;this.performRequests=t,this.batchSize=o,this.maxWorkers=i,this.requestDelayMs=a||0,this.requestTimeoutMs=s}getQueueSize(){return this.queue.length}updateBatchSize(e){this.batchSize=e}updateRequestDelayMs(e){this.requestDelayMs=e}updateMaxWorkers(e){this.maxWorkers=e,this.dequeueAfterTimeout()}enqueue(e){const t=r.UZ();return this.queue.push({request:e,deferred:t}),this.dequeueAfterTimeout(),t.promise}dequeueAfterTimeout(){this.currentSetTimeouts<this.maxWorkers&&(this.currentSetTimeouts++,setTimeout(this.dequeue,this.requestDelayMs))}}},54064:(e,t,o)=>{o.d(t,{Z:()=>n});const n=class{constructor(){this.listeners={}}addListener(e,t){let o=this.listeners[e];o||(o=new Set,this.listeners[e]=o),o.add(t)}addOnceListener(e,t){var o=this;const n=function(){o.removeListener(e,n),t(...arguments)};this.addListener(e,n)}removeListener(e,t){const o=this.listeners[e];o&&(o.delete(t),0===o.size&&delete this.listeners[e])}emit(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];const r=this.listeners[e];r&&r.forEach((e=>e(...o)))}listenerCount(e){const t=this.listeners[e];return t?t.size:0}}},55652:(e,t,o)=>{o.d(t,{s:()=>r});o(57658);var n=o(97880);class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};this.buckets={},this.count=0,this.total=0,this.unique=0,this.startedAt=new Map,this.logger=e}async measureErrors(e,t,o,n){const r=`${e} ${++this.unique}`;this.start(r);try{const e=await n();return this.end(r,t),e}catch(i){throw this.end(r,o,i),i}}get average(){return Math.floor(this.total/this.count)}get summary(){const e=[];e.push(`avg ${this.average}ms for ${this.count} calls`);for(const[t,o]of(0,n.qP)(this.buckets)){if(!o)continue;const n=Math.floor(o.total/o.count),r=(o.count/this.count*100).toFixed(2);e.push(`[${t}: ${r}% avg ${n}ms]`)}return e.join(" ")}start(e){this.startedAt.set(e,"object"==typeof performance?performance.now():Date.now())}end(e,t){const o=this.startedAt.get(e);if(!o)return;this.startedAt.delete(e);const n=("object"==typeof performance?performance.now():Date.now())-o;this.count++,this.total=this.total+n;let r=this.buckets[t];r||(r={count:0,total:0},this.buckets[t]=r),r.count++,r.total=r.total+n;for(var i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];this.logger(`end ${e} ${t}: ${n}ms`,...a)}}},15157:(e,t,o)=>{o.d(t,{Z:()=>r});var n=o(30548);const r=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new n.ZP(e,t,"necessary")}get(e){let{userId:t,key:o}=e;return this.localStorageStore.get(this.makeUserKey(t,o))}set(e){let{userId:t,key:o,value:n}=e;return this.localStorageStore.set(this.makeUserKey(t,o),n)}remove(e){let{userId:t,key:o}=e;return this.localStorageStore.remove(this.makeUserKey(t,o))}clearStorageForUser(e){this.localStorageStore.scan((t=>{t.startsWith(e)&&this.remove({userId:e,key:t})}))}scan(e){this.localStorageStore.scan(e)}makeUserKey(e,t){return`${e||"guest"}:${t}`}}(n.TA,!1)},75189:(e,t,o)=>{o.d(t,{uP:()=>P,yx:()=>M});var n=o(74487);const r=n.union([n.number(),n.string(),n.boolean(),n.isNull(),n.array(n.string())]),i=n.undefinable(r),a=n.union([r,n.record(n.string(),r)]),s=n.union([i,n.record(n.string(),i)]),l=n.union([s,n.record(n.string(),s)]),c=l,d=n.without(n.without(n.nonEmpty(n.string()),"{"),"}");n.object({required:{key:d,value:a,ttl:n.undefinable(n.number())},optional:{}}),n.object({required:{key:d,value:s,version:n.number()},optional:{}}),n.object({required:{key:d,value:n.number(),ttl:n.undefinable(n.number())},optional:{}}),n.object({required:{key:d,value:n.number(),version:n.number()},optional:{}}),n.object({required:{key:d,amount:n.number(),ttl:n.undefinable(n.number())},optional:{passThroughData:c}}),n.object({required:{key:d,value:n.number(),version:n.number()},optional:{}}),n.object({required:{key:d,field:n.string(),value:s,ttl:n.undefinable(n.number())},optional:{}}),n.object({required:{key:d,field:n.string(),value:l,version:n.number()},optional:{}}),n.object({required:{id:n.string()},optional:{}}),n.object({required:{setValueTime:n.number()},optional:{}}),n.object({required:{key:d,field:n.string(),updates:n.record(n.string(),i),ttl:n.undefinable(n.number())},optional:{}}),n.object({required:{key:d,field:n.string(),value:l,version:n.number()},optional:{}});const p=n.object({required:{blockId:n.string(),userId:n.string(),spaceId:n.string(),operation:n.literal("logPageExit"),pageVisitId:n.undefinable(n.string()),ts:n.number()},optional:{}}),u=(n.object({required:{},optional:{}}),n.object({required:{key:d},optional:{}}),n.object({required:{key:d,value:s,version:n.number()},optional:{}}),n.object({required:{operation:n.literal("setValue"),key:d,value:n.string(),ttl:n.undefinable(n.number())},optional:{}})),m=n.object({required:{operation:n.literal("setValue"),key:d,value:s,version:n.number()},optional:{}}),g=n.object({required:{operation:n.literal("increment"),key:d,amount:n.number(),ttl:n.undefinable(n.number())},optional:{passThroughData:c}}),h=n.object({required:{operation:n.literal("increment"),key:d,value:n.number(),version:n.number()},optional:{}}),f=n.object({required:{operation:n.literal("setIfGreater"),key:d,value:n.number(),ttl:n.undefinable(n.number())},optional:{}}),y=n.object({required:{operation:n.literal("setIfGreater"),key:d,value:n.number(),version:n.number()},optional:{}}),v=n.object({required:{operation:n.literal("setField"),key:d,field:n.string(),value:s,ttl:n.undefinable(n.number())},optional:{}}),b=n.object({required:{operation:n.literal("setField"),key:d,field:n.string(),value:l,version:n.number()},optional:{}}),S=n.object({required:{operation:n.literal("updateField"),key:d,field:n.string(),updates:n.record(n.string(),i),ttl:n.undefinable(n.number())},optional:{}}),_=n.object({required:{operation:n.literal("updateField"),key:d,field:n.string(),value:l,version:n.number()},optional:{}}),w=n.object({required:{operation:n.literal("logPageExit"),spaceId:n.string(),userId:n.string(),blockId:n.string(),pageVisitId:n.undefinable(n.string())},optional:{}}),k=n.object({required:{operation:n.literal("logPageExit")},optional:{}}),x={setValue:u,increment:g,setIfGreater:f,setField:v,updateField:S,logPageExit:w},I=n.union(Object.values(x)),C={setValue:m,increment:h,setIfGreater:y,setField:b,updateField:_,logPageExit:k},T=n.union(Object.values(C)),M=(n.object({required:{operations:n.array(I)},optional:{}}),n.object({required:{responses:n.array(T)},optional:{}}),n.object({required:{subscriptions:n.array(n.object({required:{key:d,version:n.number()},optional:{}}))},optional:{}}),n.object({required:{responses:n.array(n.object({required:{key:d,wasNotified:n.boolean()},optional:{}})),internalProcessingTimeMs:n.number()},optional:{}}),n.object({required:{key:d,version:n.number()},optional:{}}),n.object({required:{key:d,wasNotified:n.boolean()},optional:{}}),n.object({required:{keys:n.array(d)},optional:{}}),n.object({required:{keys:n.array(d),internalProcessingTimeMs:n.number()},optional:{}}),n.object({required:{key:d},optional:{}}),n.object({required:{key:d},optional:{}}),n.object({required:{disconnectId:n.string(),operations:n.array(I)},optional:{}}),n.object({required:{disconnectId:n.string(),hadDisconnect:n.boolean()},optional:{}}),n.object({required:{disconnectId:n.string()},optional:{}}),n.object({required:{disconnectId:n.string(),wasRemoved:n.boolean()},optional:{}}),n.union([n.object({required:{type:n.literal("notification"),key:d,value:l,version:n.number()},optional:{passThroughData:c}}),n.object({required:{type:n.literal("response"),status:n.literals("ok","error"),requestId:n.string(),result:n.any()},optional:{}})])),P=n.object({required:{userId:n.string(),present:n.boolean()},optional:{activityTimestamp:n.number(),blockId:n.union([n.isNull(),n.string()])}});n.object({required:{max_records:n.number()},optional:{}}),n.object({required:{values:n.array(p)},optional:{}}),n.object({required:{last_length:n.number(),new_length:n.number(),added:n.boolean()},optional:{}})},11799:(e,t,o)=>{o.d(t,{Z:()=>c});var n=o(67266),r=o.n(n),i=o(72126);let a;const s=new WeakMap;function l(e){let t=s.get(e);return void 0!==t||(t=r()(e),s.set(e,t)),t}a=Symbol.iterator;class c{constructor(){let{getKey:e=l,from:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.map=new Map,this.getKey=void 0,this.getKey=e,t)for(const[o,n]of t)this.set(o,n)}get size(){return this.map.size}set(e,t){return this.map.set(this.getKey(e),[e,t])}get(e){const t=this.map.get(this.getKey(e));if(t)return t[1]}has(e){return this.map.has(this.getKey(e))}delete(e){return this.map.delete(this.getKey(e))}*entries(){for(const e of this.map.values())yield e}[a](){return this.entries()}*keys(){for(const e of this.map.keys())yield JSON.parse(e)}*values(){for(const[e,t]of this.map.values())yield t}valuesArray(){return Array.from(this.values())}compactedValuesArray(){return i.oA(Array.from(this.values()))}}},27731:(e,t,o)=>{o.d(t,{Z:()=>r});class n{constructor(){this.stiffness=50,this.damping=10,this.precision=.001,this.currentValue=0,this.endValue=0,this.velocity=0}isAtRest(){return Math.abs(this.endValue-this.currentValue)<=this.precision}setEndValue(e){this.endValue=e;const t=this.isAtRest();return t&&this.setAtRest(),t}jumpToEnd(){this.currentValue=this.endValue}step(e){let t=e;do{let e;t>n.timestep?(t-=n.timestep,e=n.timestep):(e=t,t=0);const[o,r]=this.rk4(this.currentValue,this.velocity,e);this.velocity=r,this.currentValue=o}while(t>0);const o=this.isAtRest();return o&&this.setAtRest(),o}setAtRest(){this.currentValue=this.endValue,this.velocity=0}rk4(e,t,o){var n=e,r=t,i=this.computeAccel(n,r,0),a=e+.5*r*o,s=t+.5*i*o,l=this.computeAccel(a,s,o/2),c=e+.5*s*o,d=t+.5*l*o,p=this.computeAccel(c,d,o/2),u=e+d*o,m=t+p*o;return[e+o/6*(r+2*s+2*d+m),t+o/6*(i+2*l+2*p+this.computeAccel(u,m,o))]}computeAccel(e,t,o){return this.stiffness*n.stiffnessMultiplier*(this.endValue-e)-this.damping*n.dampingMultiplier*t}}n.stiffnessMultiplier=1e-5,n.dampingMultiplier=.005,n.timestep=1e3/60;const r=n},95371:(e,t,o)=>{o.d(t,{CY:()=>m,DG:()=>r,DY:()=>c,MW:()=>s,Sr:()=>d,Xf:()=>p,YL:()=>u,Yc:()=>l,Yz:()=>a,lj:()=>g,mp:()=>i,qF:()=>y,si:()=>h,ub:()=>f});o(57658);var n=o(97880);class r{constructor(e){this.children=e}map(e){const t=this.children.map((t=>t.map(e)));return new r(t)}toString(){return`DetachedTreeRoots([${this.children}])`}}class i{constructor(e,t){this.value=e,this.children=t}map(e){return s(this,(t=>({value:e(t.value),children:t.children})))}toString(){return`Tree(${this.value}, [${this.children}])`}}function a(e,t){return t(e.value)||e.children.some((e=>a(e,t)))}function s(e,t){const o=t(e);if(!o)return;const{value:r,children:a}=o,l=a?a.map((e=>s(e,t))).filter(n.$K):[];return new i(r,l)}function l(e){const{values:t,isAncestor:o,compareOrder:n}=e;if(0===t.length)return;const a=(e,t)=>{for(const n of e)if(o(n.value,t))return void a(n.children,t);e.push(new i(t,[]))},s=t.slice().sort(n),l=[];for(const r of s)a(l,r);return new r(l)}function c(e,t){for(const o of e){if(t(o))return[o];{const e=c(o.children,t);if(e)return[o,...e]}}}function d(e,t){if(t&&t.length>0){const o=t[t.length-1],n=t[t.length-2]||e,r=n.children.findIndex((e=>e===o));if(r>0)return{prev:n.children[r-1]};if(n!==e)return{parent:n}}return{}}function p(e,t){if(t&&t.length>0){const o=t[t.length-1],n=t[t.length-2]||e,r=n.children.findIndex((e=>e===o));return r<n.children.length-1?{next:n.children[r+1]}:p(e,t.slice(0,t.length-1))}return{}}function u(e,t){if(t&&t.length>0){const o=t[t.length-1],n=t[t.length-2]||e,r=n.children.findIndex((e=>e===o));if(r>0){return{prev:m(n.children[r-1])}}if(n!==e)return{parent:n}}return{}}function m(e){for(;e.children.length>0;)e=e.children[e.children.length-1];return e}function g(e,t){if(t&&t.length>0){const o=t[t.length-1];if(o.children.length>0){return{next:o.children[0]}}const{next:n}=p(e,t);return{next:n}}return{}}function h(e){if(e&&e.length>0){const t=e[e.length-1];if(t.children.length>0)return t.children[0]}}function f(e){if(e&&e.length>1)return e[e.length-2]}function y(e,t){if(0===e.length||0===t.length)return-1;for(let o=Math.min(e.length,t.length)-1;o>-1;o--){if(e[o]===t[o])return o}return-1}},39721:(e,t,o)=>{o.d(t,{F:()=>a,o:()=>s});o(21703),o(57658);var n=o(95371),r=o(73597),i=o(97880);const a={applyMutable:function(e,t){const o=(0,n.DY)(e.children,(e=>e===t.target));if(void 0===o)return!1;if(0===o.length)throw new Error("findPathInTree: empty path");const r=1===o.length?e.children:o[o.length-2].children,a=r.indexOf(t.target);if(-1===a)throw new Error("findPathInTree: cannot find node");switch(t.operation){case"indentSelf":return function(e,t){if(0===t)return!1;const o=e[t],n=e[t-1];return e.splice(t,1),n.children.push(o,...o.children),o.children=[],!0}(r,a);case"indentSelfAndSubtree":return function(e,t){if(0===t)return!1;const o=e[t],n=e[t-1];return e.splice(t,1),n.children.push(o),!0}(r,a);case"unindentSelf":{if(1===o.length)return!1;const t=2===o.length?e.children:o[o.length-3].children,n=o[o.length-2],r=t.indexOf(n);if(-1===r)throw new Error("findPathInTree: cannot find node");return function(e,t,o){const n=e[t],r=n.children[o];return n.children.splice(o,1),e.splice(t+1,0,r),!0}(t,r,a)}case"unindentSelfAndUpdateSiblings":{if(1===o.length)return!1;const t=2===o.length?e.children:o[o.length-3].children,n=o[o.length-2],r=t.indexOf(n);if(-1===r)throw new Error("findPathInTree: cannot find node");return function(e,t,o){const n=e[t],r=n.children[o],i=n.children.splice(o+1,n.children.length-o-1);return r.children.push(...i),n.children.splice(o,1),e.splice(t+1,0,r),!0}(t,r,a)}default:(0,i.t1)(t.operation)}}};const s={getIndentOperationsFromTreeRange:(e,t)=>"indent"===t?function(e){const t=[];for(const o of(0,r.bu)(e))t.push({operation:"indentSelf",target:o});return t}(e):"indentSelfAndSubtree"===t?function(e){const t=[];for(const o of(0,r.bu)(e))t.push({operation:"indentSelfAndSubtree",target:o});return t}(e):"unindent"===t?function(e){const t=[];for(const o of(0,r.bu)(e))t.push({operation:"unindentSelfAndUpdateSiblings",target:o});return t.reverse()}(e):"unindentSelf"===t?function(e){const t=[];for(const o of(0,r.bu)(e))t.push({operation:"unindentSelf",target:o});return t.reverse()}(e):void(0,i.t1)(t)}},73597:(e,t,o)=>{o.d(t,{JK:()=>r,bu:()=>a,tL:()=>i});o(21703);var n=o(97880);function*r(e){yield e;for(const t of e.children)yield*r(t)}function*i(e){for(let t=e.startPath.length-1;t>=0;t--){const o=e.getStartBoundary(t);if(!o)throw new Error("Start boundary must be defined");t===e.startPath.length-1?yield o.parent:yield*o.childrenInsideRange}}function*a(e){for(const{position:t,tree:o}of function*(e){for(let t=e.startPath.length-1;t>=0;t--){const o=e.getStartBoundary(t);if(o&&(t===e.startPath.length-1&&(yield{position:"start",tree:o.parent}),t>0))for(const e of o.childrenInsideRange)yield{position:"within",tree:e}}for(let t=0;t<e.endPath.length;t++){const o=e.getEndBoundary(t);if(o)for(const t of o.childrenInsideRange)e.isInEndPath(t)?yield{position:"endPath",tree:t}:yield{position:"within",tree:t}}}(e))switch(t){case"start":case"endPath":yield o;break;case"within":yield*r(o);break;default:(0,n.t1)(t)}}},374:(e,t,o)=>{o.d(t,{Z:()=>r,f:()=>i});var n=o(97880);function r(e){return[{operation:"delete",deleteFromParent:e.moveFromParent,deletingChildren:e.movingChildren,debug:e.debug},{operation:"insert",insertIntoParent:e.moveToParent,insertChildren:e.movingChildren,adjacentSibling:e.moveToAdjacentSibling,direction:e.moveToDirection,debug:e.debug}]}const i={applyMutable:function(e){switch(e.operation){case"delete":return a(e);case"insert":return s(e);case"move":const[t,o]=r(e),i=a(t),l=s(o);return i||l;default:(0,n.t1)(e)}}};function a(e){const{deleteFromParent:t,deletingChildren:o}=e;if(0===o.length)return!1;const n=new Set(o),r=t.children.filter((e=>!n.has(e)));return r.length!==t.children.length&&(t.children=r,!0)}function s(e){const{direction:t,insertChildren:o,insertIntoParent:r,adjacentSibling:i}=e;if(0===o.length)return!1;const a=i?r.children.indexOf(i):-1,s=(()=>{switch(t){case"listBefore":return Math.max(0,a);case"listAfter":return-1===a?r.children.length:a+1;default:(0,n.t1)(t)}})();return r.children.splice(s,0,...o),!0}},70842:(e,t,o)=>{o.d(t,{T:()=>r});o(21703),o(57658);var n=o(95371);class r{constructor(e,t,o){if(this.maxDepth=void 0,this.start=void 0,this.end=void 0,this.startPathSet=void 0,this.endPathSet=void 0,this.isInStartPath=e=>this.startPathSet.has(e),this.isInEndPath=e=>this.endPathSet.has(e),this.commonAncestor=e,this.startPath=t,this.endPath=o,0===this.startPath.length||0===this.endPath.length)throw new Error(`Cannot create TreeRange with empty path: ${this.startPath} ${this.endPath}`);this.start=this.startPath[this.startPath.length-1],this.end=this.endPath[this.endPath.length-1],this.startPathSet=new Set(t),this.endPathSet=new Set(o),this.maxDepth=Math.max(this.startPath.length,this.endPath.length)}static fromNearestCommonAncestor(e,t){const o=(0,n.qF)(e,t);if(!(o<0))return new this(e[o],e.slice(o),t.slice(o))}getStartBoundary(e){if(e>=this.startPath.length||e<0)return;const t=this.startPath[e];if(0===e&&this.startPath.length<=1&&this.endPath.length<=1)return{parentType:"commonAncestor",parent:t,childrenBeforeRange:[],childrenInsideRange:[],childrenAfterRange:t.children.slice()};const o=t.children.findIndex(this.isInStartPath)+1,n=t.children.findIndex(this.isInEndPath),r=t.children.slice(0,o),i=t.children.slice(o,-1===n?void 0:n+1),a=-1===n?[]:t.children.slice(n+1);return 0===e?{parentType:"commonAncestor",parent:t,childrenBeforeRange:r,childrenInsideRange:i,childrenAfterRange:a}:{parentType:"startPath",parent:t,childrenBeforeRange:r,childrenInsideRange:i}}getEndBoundary(e){if(e>=this.endPath.length||e<0)return;if(0===e)return this.getStartBoundary(0);const t=this.endPath[e],o=t.children.findIndex(this.isInStartPath)+1,n=t.children.findIndex(this.isInEndPath)+1,r=t.children.slice(o,n),i=t.children.slice(n);return{parentType:"endPath",parent:t,childrenInsideRange:r,childrenAfterRange:i}}getAnalagousNodesAtOffset(e){const t=this.startPath.length-1-e,o=this.endPath.length-1-e;return{start:this.getStartBoundary(t),end:this.getEndBoundary(o)}}*iterateAnalogousNodes(){for(let e=0;e<this.maxDepth;e++)yield this.getAnalagousNodesAtOffset(e)}getDeletionAtOffset(e){const{start:t,end:o}=this.getAnalagousNodesAtOffset(e),n=[];t&&t.childrenInsideRange.length>0&&n.push({operation:"delete",deleteFromParent:t.parent,deletingChildren:t.childrenInsideRange});const r=(null==t?void 0:t.parent)||this.commonAncestor;if(r&&o&&o.parent!==this.commonAncestor&&o.parent!==r&&o.childrenAfterRange.length>0){const e=r.children.find(this.isInStartPath);n.push({operation:"move",moveFromParent:o.parent,movingChildren:o.childrenAfterRange,moveToParent:r,moveToAdjacentSibling:e,moveToDirection:e?"listAfter":"listBefore"})}return n}*iterateDeletion(){for(let e=0;e<this.maxDepth;e++)yield*this.getDeletionAtOffset(e)}getInsertionAtOffset(e,t,o){const n=Math.max(0,e.length-1-t),r=e[n],i=e[n+1],{start:a,end:s}=this.getAnalagousNodesAtOffset(t),l=[];if(a&&a.childrenInsideRange.length>0){const e=o.get(r)||i;l.push({operation:"move",moveFromParent:a.parent,movingChildren:a.childrenInsideRange,moveToParent:r,moveToAdjacentSibling:e,moveToDirection:e?"listAfter":"listBefore"});const t=a.childrenInsideRange[a.childrenInsideRange.length-1];o.set(r,t)}const c=this.startPath.length-1-t,d=Math.min(c,this.endPath.length-1),p=this.getEndBoundary(d);if(p&&p.parent!==this.commonAncestor&&r!==e[0]){const e=r.children.indexOf(i)+1,t=r.children.slice(e);if(t.length){const e=0===p.childrenInsideRange.length&&p.childrenAfterRange.length>0,o=e?p.childrenAfterRange[0]:p.childrenInsideRange[p.childrenInsideRange.length-1];l.push({operation:"move",moveFromParent:r,movingChildren:t,moveToParent:p.parent,moveToAdjacentSibling:o,moveToDirection:e?"listBefore":"listAfter"})}}return s&&s.parent!==this.commonAncestor&&s.childrenAfterRange.length>0&&l.push({operation:"delete",deleteFromParent:s.parent,deletingChildren:s.childrenAfterRange}),l}*iterateInsertionAt(e){const t=new Map,o=[];for(let n=0;n<this.maxDepth;n++)o.push(...this.getInsertionAtOffset(e,n,t));yield*o}}},66504:(e,t,o)=>{o.d(t,{I:()=>a,o:()=>s});var n=o(45953),r=o(97880);let i;const a="guest";i=Symbol.iterator;class s{constructor(e){this.data=void 0,this.data=e??{}}getUserRecordMap(e){const t=e??a;let o=this.data[t];return o||(o=n.PF.create(),this.data[t]=o),o}getValue(e){return this.getUserRecordMap(e.userId).getValue(e.pointer)}getRole(e){return this.getUserRecordMap(e.userId).getRole(e.pointer)}setValueAndRole(e,t,o){return this.getUserRecordMap(e.userId).setValueAndRole(e.pointer,t,o),this}setModelAndRole(e,t,o){return this.getUserRecordMap(e.userId).setModelAndRole(e.pointer,t,o),this}delete(e){this.getUserRecordMap(e.userId).delete(e.pointer)}*[i](){for(const[e,t]of(0,r.qP)(this.data))for(const{pointer:o,model:n,role:r}of t)void 0!==n&&(yield{pointer:o,model:n,role:r,userId:e===a?void 0:e})}}},40902:(e,t,o)=>{o.d(t,{B9:()=>A,BX:()=>I,Dn:()=>C,Fb:()=>j,KN:()=>L,OC:()=>w,OS:()=>T,Yr:()=>M,Z3:()=>R,fc:()=>E,gg:()=>B,hY:()=>N,j4:()=>D,lv:()=>F,md:()=>O,n_:()=>U,tR:()=>_});o(57658);var n=o(41432),r=o(99036),i=(o(80951),o(72126)),a=o(59753),s=o(27006),l=o(4615),c=o(70921),d=o(21202),p=o(6287),u=(o(13493),o(33709)),m=o(65311),g=o(15047),h=o(29369),f=o(19889),y=o(99108),v=o(70203),b=o(97880),S=o(63143);S.hM;function _(e,t){const o=a.kk.fromValue(c.TY,t),{edits:n,index:r}=e,s=[...o&&o.getEdits()||[],...n],m=y.VR(s),f=m[0],v=f&&f.timestamp.toString()||o&&o.start_time||n[0].timestamp,b=i.Z$(m),S=b&&b.timestamp.toString()||o&&o.end_time||v,_=k(n[0]),w=function(e){const{space_id:t,navigable_block_id:o,collection_id:n,collection_row_id:r,top_level_block_id:i,discussion_id:a,team_id:s}=e;return o?{parent_table:d.iU,parent_id:o}:i?{parent_table:d.iU,parent_id:i}:r?{parent_table:d.iU,parent_id:r}:a?{parent_table:u.qF,parent_id:a}:n?{parent_table:p.v,parent_id:n}:s?{parent_table:h.e0,parent_id:s}:{parent_table:g.bx,parent_id:t}}(n[0]);return{type:c.L8[n[0].type],index:r,start_time:v.toString(),end_time:S.toString(),edits:m.slice(0,1e3),invalid:x(m),shard_id:(0,l.bm)(_.space_id),context_id:c.rH(_),..._,...w}}function w(e){if("collection-changed"===e.type&&e.collection_data){if(!e.collection_data.before&&!e.collection_data.after)return!1;if(!e.collection_data.before||!e.collection_data.after)return!0;return C(e.collection_data.before.description,e.collection_data.after.description)}if("collection-created"===e.type&&e.collection_data){const t=e.collection_data.description;return Boolean(t)}return!1}function k(e){return S.ei(e,c.uJ)}function x(e){if(0===y.hI(e).length)return!0;{const t=e[0];if("mention-deleted"===t.type)return!0;if("mention-created"===t.type){if(t.authors&&t.authors.some((e=>e.table===f.KJ&&e.id===t.mentioned_user_id)))return!0}else if(e.every((e=>"comment-deleted"===e.type)))return!0}return!1}function I(e,t){return function(e){const t=a.kk.fromValue(c.TY,e),o=t&&t.getEdits()||[];return S.cf(i.xH(o.map((e=>e.authors||[]))))}(a.kk.fromValue(c.TY,e)).some((e=>e.table===f.KJ&&e.id===t))}function C(e,t){const o=v.OAI(e||[]),n=v.OAI(t||[]);return!i.Xy(o,n)}function T(e){const{before:t,after:o,schema:n}=e,i=[];return(n?Object.keys(n):r.qF).forEach((e=>{C(t&&t.properties&&t.properties[e],o&&o.properties&&o.properties[e])&&i.push(e)})),i}function M(e){const{before:t,after:o}=e,n=[];return new Set((0,b.Yd)(t.properties||{}).concat((0,b.Yd)(o.properties||{}))).forEach((e=>{C(t&&t.properties&&t.properties[e],o&&o.properties&&o.properties[e])&&n.push(e)})),n}const P=["page_icon","is_placeholder"];function A(e){const{before:t,after:o}=e,n=[];return P.forEach((e=>{(t.format&&t.format[e])!==(o.format&&o.format[e])&&n.push(e)})),n}function D(e){const{before:t,after:o,property:n}=e;return C(t&&t.properties&&t.properties[n],o&&o.properties&&o.properties[n])}function B(e){return T(e).length>0}function R(e){return e.after.type===n.Ti.tableRow&&M(e).length>0}function E(e){return A(e).length>0}function F(e){const{before:t,after:o}=e,n=a.kk.fromBlock(t),r=a.kk.fromBlock(o),i=n.type,s=r.type,l=n.isNavigableBlock()&&r.isNavigableBlock();return i&&s&&i!==s&&!l}function N(e){const{activity:t,getRecordModel:o,baseUrl:n,pageVisitSource:r}=e;if(t.isType("top-level-block-created")||t.isType("top-level-block-deleted")){const e=o(t.getTopLevelBlockPointer());if(e)return e.getRenderUrl({getRecordModel:o,baseUrl:n,pageVisitSource:r})}else if(t.isType("commented")){const e=o(t.getDiscussionPointer());if(e){const t=o(e.getParentPointer());if(t)return t.getRenderUrl({getRecordModel:o,baseUrl:n,discussionId:e.id,pageVisitSource:r})}}else if(t.isType("collection-row-created")||t.isType("collection-row-deleted")){const e=o(t.getCollectionRowPointer());if(e)return e.getRenderUrl({getRecordModel:o,baseUrl:n,pageVisitSource:r})}else if(t.isType("permissions-edited")){const e=t.getNavigableBlockPointer();if(e){const t=o(e);if(t)return t.getRenderUrl({getRecordModel:o,baseUrl:n,pageVisitSource:r})}else{const e=o(t.getSpacePointer());if(e)return e.getRenderUrl({baseUrl:n})}}else if(t.isType("block-edited")){const e=o(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:o,baseUrl:n,pageVisitSource:r})}else if(t.isType("user-mentioned")){const e=o(t.getMentionedBlockPointer());if(e)return e.getRenderUrl({getRecordModel:o,baseUrl:n,pageVisitSource:r})}else if(t.isType("reminder")){const e=o(t.getReminderBlockPointer());if(e)return e.getRenderUrl({getRecordModel:o,baseUrl:n,pageVisitSource:r})}else if(t.isType("user-invited")){const e=t.getNavigableBlockPointer();if(e){const t=o(e);if(t)return t.getRenderUrl({getRecordModel:o,baseUrl:n,pageVisitSource:r})}else{const e=o(t.getSpacePointer());if(e)return e.getRenderUrl({baseUrl:n})}}return n||"/"}function j(e){switch(e){case"top-level-block-created":return"activity_top_level_block_created";case"top-level-block-deleted":return"activity_top_level_block_deleted";case"collection-row-created":return"activity_collection_row_created";case"collection-row-deleted":return"activity_collection_row_deleted";case"block-edited":return"activity_block_edited";case"block-property-edited":return"activity_block_property_edited";case"permissions-edited":return"activity_permissions_edited";case"user-mentioned":return"activity_mention";case"commented":return"activity_comment";case"user-invited":return"activity_invited";case"collection-edited":return"collection_edited";case"collection-view-edited":return"collection_view_edited";case"collection-property-edited":return"collection_property_edited";case"reminder":return"activity_reminder";case"permission-group-edited":return"activity_permission_group_edited";case"page-locked":return"activity_page_locked";case"page-unlocked":return"activity_page_unlocked";case"email-edited":return"activity_email_edited";case"access-requested":return"activity_access_requested";case"access-request-resolved":return"activity_access_request_resolved";case"page-deleted":return"activity_page_deleted";case"page-restored":return"activity_page_restored";case"page-permanently-deleted":return"activity_page_permanently_deleted";case"team-membership-edited":return"activity_team_membership_edited";case"private-content-transferred":return"activity_private_content_transferred";case"permission-group-mentioned":return"activity_permission_group_mentioned";case"verification-expired":return"activity_verification_expired";case"export-completed":return"activity_export_completed"}}function O(e){const t=[],o=[],n=[];return e.forEach((e=>{!function(e){if("permission-created"===e.type){const t=e.permission_data;if("user_permission"===t.type&&s.YX(t.role)&&e.authors&&1===e.authors.length&&e.authors[0].table===f.KJ&&e.authors[0].id===t.user_id)return!0}return!1}(e)?"permission-restriction-created"===e.type||"permission-restriction-deleted"===e.type?o.push(e):n.push(e):t.push(e)})),{autojoinEdits:t,inheritanceEdits:o,otherEdits:n}}function L(e){return"commented"===e||"following"===m.hE[e]}function U(e){return"mentions"===m.hE[e]}},19234:(e,t,o)=>{o.d(t,{A:()=>i});o(72126);const n=/^\d{5}(-\d{4})?$/,r=/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ] ?\d[ABCEGHJKLMNPRSTVWXYZ]\d$/i;function i(e){if(!e.country)return!1;switch(e.country){case"US":return n.test(e.zipCode);case"CA":return r.test(e.zipCode);default:return!0}}},28410:(e,t,o)=>{o.d(t,{Th:()=>n,jQ:()=>a});const n=12e3,r=["openai-1.1","openai-2","openai-4","openai-5","openai-6"];const i=["anthropic-1","anthropic-2","anthropic-qa-alpha","anthropic-3"];function a(e){return i.includes(e)}},79946:(e,t,o)=>{o.d(t,{iI:()=>S,HR:()=>w,SY:()=>b,Q3:()=>_,rQ:()=>g,xx:()=>v,j:()=>h,VT:()=>C,dG:()=>k,k3:()=>B,PL:()=>P,L1:()=>T,Dq:()=>D,I$:()=>I,T1:()=>x,tO:()=>M,kd:()=>A});o(57658);var n=o(29450),r=o(68626),i=o(91155),a=o(54153),s=o(46637),l=o(97880),c=o(64002);let d,p,u=[],m="/";function g(e,t){p=!["staging","production"].includes(t.env),(0,n.hasPermissionForTrackingTypeBrowser)("targeting")&&(e.isNative||e.doNotTrackEnabled||(m=function(e){if(e.isLocalhost)return"http://localhost:3000";return"https://aif.notion.so"}(t),function(e){if(!m)return;const t=document.createElement("iframe");t.setAttribute("sandbox","allow-scripts allow-same-origin"),t.setAttribute("style","position: absolute; opacity: 0; width: 1px; height: 1px; top: 0; left: 0; border: none; display: block; z-index: -1;"),t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex","-1"),t.setAttribute("referrerpolicy","no-referrer"),t.setAttribute("src",e.aif.url),document.body.appendChild(t),t.addEventListener("load",(()=>{d=t;for(const e of u)y(t,e);u=[]}))}(t)))}function h(e,t){if((0,n.hasPermissionForTrackingTypeBrowser)("targeting"))if(e.isNative||e.doNotTrackEnabled)f(t)&&r.log({level:"info",from:"adAnalyticsHelpers",type:"analyticsTrackSignupDoNotTrackEnabled"});else try{d?y(d,t):u.push(t)}catch(o){r.log({level:"error",from:"adAnalyticsHelpers",type:"analyticsTrack",error:(0,i.Ui)(o)})}}function f(e){var t,o;return"CompleteRegistration"===(null===(t=e.facebook)||void 0===t?void 0:t.eventName)||"registration"===(null===(o=e.google)||void 0===o?void 0:o.eventName)}function y(e,t){f(t)&&r.log({level:"info",from:"adAnalyticsHelpers",type:"analyticsTrackSignupIFramePostCall"}),e.contentWindow&&e.contentWindow.postMessage(t,m)}function v(e){if("facebook"===e.type){const t=`fb.1.${Date.now()}.${e.id}`;s.Z.set("adClick",{type:"facebook",id:t})}else"google"===e.type?s.Z.set("adClick",{type:"google",id:e.id}):(0,l.t1)(e)}function b(){return s.Z.get("adClick")}function S(){s.Z.remove("adClick")}function _(){return s.Z.get("fbp")}function w(){a.Z.remove("fbp")}function k(e){const{eventType:t,source:o,eventData:n}=e;if(p)console.debug(`track GTM event:%c ${t}`,"font-weight: bold;",n);else if("front"===o){(window.dataLayer=window.dataLayer||[]).push({event:t,data:n})}else{const e={google:{eventName:"custom",data:{event:t,data:n}}};d&&d.contentWindow?d.contentWindow.postMessage(e,m):u.push(e)}}function x(){k({eventType:"sign_up_flow_start",source:"client"})}function I(){k({eventType:"sign_up_flow_complete",source:"client"})}function C(e){let{planType:t,subscriptionTier:o,domainType:n}=e;t&&"team"===t?k({eventType:"create_space",source:"client",eventData:{planType:t}}):o&&k({eventType:"create_space",source:"client",eventData:{subscriptionTier:o,domainType:n}})}function T(e){let{planType:t,subscriptionTier:o}=e;k({eventType:"professional_workspace_created",source:"client",eventData:{planType:t,subscriptionTier:o}})}function M(e){let{planType:t,subscriptionTier:o}=e;k({eventType:"team_workspace_created",source:"client",eventData:{planType:t,subscriptionTier:o}})}function P(){k({eventType:"onboarding_complete",source:"client"})}function A(e,t){k({eventType:"workspace_first_invite_sent",source:"client",eventData:{subscriptionTier:e,domainType:t}})}function D(){k({eventType:"professional_workspace_first_invite_sent",source:"client"})}function B(e,t){var o;const n=(0,c.DP)(null===(o=document.location)||void 0===o?void 0:o.href),r=null==n?void 0:n.get("cid"),i=null==n?void 0:n.get("metadata_cid");var a;i&&h(e,{metadataio:{eventName:"sign_up",data:{email:t,cid:r,mcid:i,url:null===(a=document.location)||void 0===a?void 0:a.href}}})}},93214:(e,t,o)=>{o.d(t,{LC:()=>r,np:()=>i});let n;function r(){return n}function i(e){if(n)return;const t=new URL(e).searchParams.get("tid");t&&(n=t)}},82813:(e,t,o)=>{o.d(t,{e:()=>r});var n=o(97880);function r(e,t){const{notificationId:o,activityId:r,sessionId:i,from:a,alreadyRead:s}=t,l=function(e){const{alreadyRead:t,from:o}=e;switch(o){case"mark_as_unread":return t?"unread":"no_change";case"read_on_page":case"email":case"mark_as_read":case"add_reaction":case"title":case"body":case"frame":case"archive":case"unarchive":case"open_reply_menu":case"mark_all_as_read":return t?"no_change":"read";default:return(0,n.t1)(o)}}({alreadyRead:s,from:a});if("no_change"===l)return;const c={notificationId:o,activityId:r,sessionId:i,from:a,target:l};e.trackEvent({eventName:"mark_notification_as_read",properties:c})}},5809:(e,t,o)=>{o.d(t,{$:()=>r});o(21703);var n=o(12139);function r(){if(!0===window.__mobileAppBackgroundLaunch)return;const e=window.__webStartTime;if("number"==typeof e)return e;{const e=new Error("App Start Time not found. It should be in index.html.");n.IE(e)}}},189:(e,t,o)=>{o.d(t,{Tc:()=>d,oU:()=>l,yM:()=>c});o(57658),o(21703);var n=o(67266),r=o.n(n),i=o(72126),a=o(97880);const s=/^\d+$/,l=(0,a.AO)((e=>s.test(e)?{true:e}:{false:e})),c=(0,a.AO)((e=>s.test(e)?{false:e}:{true:e}));class d{generateSerializedKey(e){return r()(e)}deserializeKey(e){return JSON.parse(e)}constructor(e){if(this.counter=0,this.keyToCounterMap=new Map,this.counterToKeyMap=new Map,e){const t=[];for(const{key:n,counter:r}of e.keyMap)this.keyToCounterMap.set(this.generateSerializedKey(n),r),this.counterToKeyMap.set(r,n),t.push(parseInt(r));const o=i.Fp(t);this.counter="number"==typeof o?o+1:0}}serialize(){return{keyMap:Array.from(this.counterToKeyMap.entries()).map((e=>{let[t,o]=e;return{key:i.Xh(o),counter:t}}))}}mapKeyToCounter(e){const t=this.generateSerializedKey(e);if(!this.keyToCounterMap.has(t)){const o=this.counter.toString();this.keyToCounterMap.set(t,o),this.counterToKeyMap.set(o,e),this.counter++}return this.keyToCounterMap.get(t)}mapNodeKeyToCounter(e){if("block"===e.type){const t={...e},o=this.mapNodeAttributesKeyToCounter(e.attributes);t.attributes=o;const n=e.text.map((e=>this.mapNodeKeyToCounter(e)));t.text=n;const r=e.children.map((e=>{const o=this.mapNodeKeyToCounter(e);return o.parent=t,o}));t.children=r;const i={};for(const[e,l]of Object.entries(t.properties))i[e]=this.mapNodeKeyToCounter(l);t.properties=i;const a={};for(const[e,l]of Object.entries(t.schemas))a[e]=this.mapNodeKeyToCounter(l);t.schemas=a;const s=this.mapKeyToCounter({key:e.schemaId,type:"block"});return t.schemaId=s,t}if("property"===e.type||"schema"===e.type||"inline"===e.type){const t={...e};return t.attributes=this.mapNodeAttributesKeyToCounter(t.attributes),t.children=t.children.map((e=>this.mapNodeKeyToCounter(e))),t}if("text"===e.type)return{...e};throw new Error(`Unknown node type ${e}`)}mapNodeAttributesKeyToCounter(e){if(!e)return e;const t={...e};for(const[o,n]of Object.entries(d.attributesToMap)){if(!n)continue;const e=t[o];e&&(t[o]="href"===o?e:this.mapKeyToCounter({type:"block",key:e}))}return t}doesIdMapperContainMappedKey(e){return this.counterToKeyMap.has(e)}mapCounterToKey(e){const t=this.counterToKeyMap.get(e);if(!t)throw new Error(`Tried to map invalid id: ${e}`);if(!c(t.key))throw new Error("Expected a block id");return t}mapNodeCounterToKey(e){const t={...e};if("block"===t.type)return t.attributes=this.mapNodeAttributesCounterToKey(t.attributes),t.children=t.children.map((e=>{const o=this.mapNodeCounterToKey(e);return o.parent=t,o})),t.properties=this.mapNodePropertiesOrSchemasCounterToKey(t.properties),t.schemas=this.mapNodePropertiesOrSchemasCounterToKey(t.schemas),t;if("property"===t.type||"schema"===t.type||"inline"===t.type){t.attributes=this.mapNodeAttributesCounterToKey(t.attributes);const e=t.children;return t.children=e.map((e=>this.mapNodeCounterToKey(e))),t}if("text"===t.type)return t;if("move"===t.type)return t.attributes=this.mapNodeAttributesCounterToKey(t.attributes),t;throw new Error(`Unknown node type: ${t}`)}static blockKeyToHref(e){return`/${e.key.split("/")[0].replaceAll("-","")}`}static hrefToBlockId(e){var t;const o=null===(t=e.match(/\/(.+)/))||void 0===t?void 0:t[1];return o&&function(e){if(32!==e.length||!/^[a-f0-9]*$/g.test(e))return;return[e.substring(0,8),e.substring(8,12),e.substring(12,16),e.substring(16,20),e.substring(20,32)].join("-")}(o)}mapNodeAttributesCounterToKey(e){if(!e)return e;const t={...e};for(const[o,n]of Object.entries(d.attributesToMap)){if(!n)continue;const e=t[o];if(e){if(!l(e))continue;if("href"===o){if(this.counterToKeyMap.get(e)){const n=this.mapCounterToKey(e);if("block"===n.type)t[o]=d.blockKeyToHref(n);else{if("url"!==n.type&&"slack-message"!==n.type&&"slack-thread"!==n.type)throw new Error(`Invalid URL type: ${n.type}`);t[o]=n.key}}}else t[o]=this.mapCounterToKey(e).key}}return t}mapNodePropertiesOrSchemasCounterToKey(e){const t={};for(const[o,n]of Object.entries(e))n&&(t[o]=this.mapNodeCounterToKey(n));return t}mapBlockNodeCounterToKey(e){const t={...e,text:e.text.map((e=>this.mapNodeCounterToKey(e))),children:e.children.map((e=>this.mapNodeCounterToKey(e))),attributes:this.mapNodeAttributesCounterToKey(e.attributes),properties:this.mapNodePropertiesOrSchemasCounterToKey(e.properties),schemas:this.mapNodePropertiesOrSchemasCounterToKey(e.schemas),schemaId:this.mapCounterToKey(e.schemaId).key};let o=t;const n=new Set;for(;o.parent&&!n.has(o.attributes.id);)n.add(o.attributes.id),o.parent=this.mapNodeCounterToKey(o.parent),o=o.parent;return t}mapAssistantOperationCounterToKey(e){if("createBlock"===e.command){const t=e.blockNode;return{...e,blockNode:this.mapBlockNodeCounterToKey(t),databaseId:e.databaseId?this.mapCounterToKey(e.databaseId).key:void 0}}if("removeBlock"===e.command)return{...e,parentId:this.mapCounterToKey(e.parentId).key,removeBlockNode:this.mapBlockNodeCounterToKey(e.removeBlockNode)};if("setBlockParent"===e.command)return{...e,blockNode:this.mapBlockNodeCounterToKey(e.blockNode),parentId:this.mapCounterToKey(e.parentId).key};if("insertBlockBefore"===e.command)return{...e,parentId:this.mapCounterToKey(e.parentId).key,insertBlockNode:this.mapBlockNodeCounterToKey(e.insertBlockNode),beforeId:e.beforeId?this.mapCounterToKey(e.beforeId).key:void 0};if("insertBlockAfter"===e.command)return{...e,parentId:this.mapCounterToKey(e.parentId).key,insertBlockNode:this.mapBlockNodeCounterToKey(e.insertBlockNode),afterId:e.afterId?this.mapCounterToKey(e.afterId).key:void 0};if("setBlockText"===e.command)return{...e,blockNode:this.mapBlockNodeCounterToKey(e.blockNode),text:e.text?e.text.map((e=>this.mapNodeCounterToKey(e))):void 0};if("setBlockAttribute"===e.command){const t={[e.attribute]:e.value},o=this.mapNodeAttributesCounterToKey(t);return{...e,blockNode:this.mapBlockNodeCounterToKey(e.blockNode),attribute:Object.keys(o)[0],value:Object.values(o)[0]}}return"setBlockTagName"===e.command?{...e,blockNode:this.mapBlockNodeCounterToKey(e.blockNode)}:"setBlockProperty"===e.command?{...e,blockNode:this.mapBlockNodeCounterToKey(e.blockNode),parentBlockId:e.parentBlockId?this.mapCounterToKey(e.parentBlockId).key:void 0,property:this.mapNodeCounterToKey(e.property)}:"insertOrMoveTableColumns"===e.command?{...e,blockNode:this.mapBlockNodeCounterToKey(e.blockNode),insertOrMoves:e.insertOrMoves.map((e=>this.mapNodeCounterToKey(e)))}:"removeTableColumn"===e.command?{...e,blockNode:this.mapBlockNodeCounterToKey(e.blockNode)}:void(0,a.t1)(e)}}d.attributesToMap={id:!0,"page-id":!0,"database-id":!0,"person-id":!0,"person-name":!1,href:!0,language:!1,category:!1,option:!1,format:!1,number:!1,date:!1,time:!1,"start-date":!1,"start-time":!1,"end-date":!1,"end-time":!1,"synced-property-name":!1,"synced-block-id":!0}},22828:(e,t,o)=>{o.d(t,{B9:()=>p,DY:()=>g,Db:()=>S,Dt:()=>d,EH:()=>C,EO:()=>y,FI:()=>s,Ii:()=>_,JZ:()=>a,O7:()=>b,OX:()=>f,SF:()=>w,WH:()=>m,d4:()=>c,eL:()=>l,en:()=>I,kj:()=>h,qf:()=>v,uY:()=>k,vQ:()=>u,wh:()=>x});o(21703);var n=o(97880);class r extends Error{constructor(e,t){super(t),this.type=e}}class i extends r{}class a extends i{constructor(e){super("unexpected_attributes",1===e.attributeNames.length?`Unexpected attribute for <${e.tagName}> tag: ${e.attributeNames[0]}`:`Unexpected attributes for <${e.tagName}> tag: ${e.attributeNames.join(", ")}`)}}class s extends i{constructor(e){super("missing_attribute",`The <${e.tagName}> tag is missing a ${e.attributeName} attribute. It should be specified as <${e.tagName} ${e.attributeName}="...">`)}}class l extends i{constructor(e){super("bad_attribute",`Attempted to set attribute ${e.attributeName} on a <${e.tagName}> tag to a value that is not allowed: ${e.receivedValue}`)}}class c extends i{constructor(e){const{tagName:t,unexpectedNode:o}=e;super("disallowed_child",o?"text"===o.type?`Text is not allowed inside a <${t}> tag`:`A <${o.tagName}> tag is not allowed inside a <${t}> tag`:`Encountered an invalid child inside a <${t}> tag`),this.tagName=void 0,this.unexpectedNode=void 0,this.tagName=t,this.unexpectedNode=o}}class d extends i{constructor(e){const{tagName:t,unexpectedNode:o,conditionName:n,cause:r}=e;super("disallowed_child_in_condition",o?"text"===o.type?`Text is not allowed inside a <${t}> tag with a ${n} condition`:`A <${o.tagName}> tag is not allowed inside a <${t}> tag with a ${n} condition`:`Encountered an invalid child inside a <${t}> tag with a ${n} condition`),this.cause=void 0,this.cause=r}}class p extends i{constructor(e){super("expected_tag_name",`Expected a <${e}> tag`)}}class u extends i{constructor(e){let t;(0,n.$K)(e.unexpectedNode)?"text"===e.unexpectedNode.type?t=`Text is not supported as a child for a ${e.nodeType} node`:"element"===e.unexpectedNode.type?t=`Unsupported ${e.nodeType} tag name: ${e.unexpectedNode.tagName}`:(0,n.t1)(e.unexpectedNode):t=`Unexpected value for a ${e.nodeType} node`,super("unsupported_node",t)}}class m extends i{constructor(e){super("unmapped_id",`Expected counter ID, received ${e}`)}}class g extends i{constructor(e){super("out_of_order_node",`Encountered a ${e.foundNodeType} after a ${e.incorrectlyAfterType}. You should ensure that any ${e.foundNodeType}s come before ${e.incorrectlyAfterType}s.`)}}class h extends i{constructor(){super("synced_block_invalid_children","Cannot include content when writing a <synced-block-reference> tag")}}class f extends i{constructor(){super("must_provide_id","Block node is missing an id attribute")}}class y extends i{constructor(){super("cannot_provide_id","When creating new blocks, do not provide an id attribute.")}}class v extends i{constructor(){super("cannot_append_to_multiple_properties","Cannot append to multiple properties. Use multiple calls to <insert-inside> instead.")}}class b extends i{constructor(){super("cannot_remove_from_multiple_properties","Cannot remove from multiple properties. Use multiple calls to <delete> instead.")}}class S extends i{constructor(){super("move_disallowed","A <move> tag is not allowed in this context")}}class _ extends i{constructor(){super("set_attribute_without_key","<set-attribute> is missing an attribute to set")}}class w extends i{constructor(){super("set_attribute_too_many_keys","<set-attribute> has too many attributes. You can only set one attribute at a time.")}}class k extends i{constructor(e){super("invalid_query_condition",`<${e.tagName}> condition operator must be ${e.allowedOperators.map((e=>`"${e}"`)).join(" or ")}, not "${e.inputCondition}"`)}}class x extends i{constructor(e){super("children_required",`<${e.tagName}> must have children`)}}class I extends i{constructor(e){super("only_one_child_allowed",`Only one ${e} element is allowed`)}}class C extends i{constructor(e){super("unknown_api",`Unknown API: ${e}`)}}},46964:(e,t,o)=>{o.d(t,{Cl:()=>h,J7:()=>m,Jo:()=>d,R4:()=>p,Rg:()=>g,k5:()=>f,rr:()=>c});o(57658),o(21703),o(33728),o(58573);var n=o(72126),r=o(97880),i=(o(7928),o(189)),a=o(78395),s=o(95940),l=o(39040);function c(e){const t=[],o=/<\/?([a-zA-Z0-9_-]+)(?:\s[^>]*)?>/g;let n,r=e.replace(/<[^>]+$/,"").replace(/<[^>]+\/$/,"");for(;n=o.exec(r);){const e=n[1],o=n[0];o.startsWith("</")?t.length>0&&t[t.length-1]===e&&t.pop():o.endsWith("/>")||t.push(e)}for(;t.length;)r+=`</${t.pop()}>`;return r}function d(e){return e.replace(/[<>]/g,(e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";default:throw new Error(`Invalid match: "${e}"`)}}))}function p(e){const t=u(),o=new Map;let n=e.replace(/<(\/?)([\w-]+)\b[^>]*?(\/?)>/gi,((e,n,r)=>{if(t.includes(r.toLowerCase())){const t=`â–¦${o.size}`;return o.set(t,e),t}return e}));return n=d(n),o.forEach(((e,t)=>{n=n.replace(t,e)})),n}const u=n.HP((()=>[...a.YK,...Object.keys(s.pX),...Object.keys(s.t),...Object.keys(s.ZK),...Object.keys(s.WC),...Object.keys(s.Se)]));function m(e){const{pageObservations:t}=e,o=[];function n(e){const t=/(page-id|database-id)="([^"]*)"/g;let n=null;for(;null!==(n=t.exec(e.value));)"database-id"===n[1]&&o.push(n[2])}for(const r of t)n(r);return o}function g(e){const t=[],o=[...e];let n;for(;n=o.pop();)if("child-page"===n.tagName){for(const e of Object.values(n.properties))if("property-relation"===e.tagName){const o=e.attributes["database-id"];if((0,r.$K)(o)){if(!(0,i.oU)(o))throw new Error("Expected database id to be mapped");t.push(o)}}}else if("child-database"===n.tagName){for(const e of Object.values(n.schemas))if("schema-property-relation"===e.tagName){const o=e.attributes["database-id"];if(!(0,i.oU)(o))throw new Error("Expected database id to be mapped");t.push(o)}}else o.push(...n.children);return t}function h(e){const t=[],o=[e];let n;for(;n=o.pop();){if("synced-block-reference"===n.tagName){if(!n.attributes["synced-block-id"])throw new Error("Synced block reference missing synced-block-id");t.push(n.attributes["synced-block-id"])}o.push(...n.children)}return t}function f(e){return(0,l.P)(e).map(y).map(a.KT).join("")}function y(e){return"element"===e.type?"chat"===e.tagName?{...e,attributes:{},children:e.children?e.children.map(y):void 0}:{...e,children:e.children?e.children.map(y):void 0}:{...e}}},94568:(e,t,o)=>{o.d(t,{If:()=>c,OU:()=>d,Ox:()=>a,TM:()=>l,vj:()=>i,y3:()=>s});var n=o(21202),r=o(70203);const i="5ee0e0b5-7f0a-4788-a438-f37644514636",a="[zf`",s="0ab77975-f984-4c43-95cc-bcdc2c41b326",l="70f46cce-b6c2-4f4c-848a-c04c9b50a0bc";function c(e){for(const o of e.currentPageAncestors){if(o.table===n.iU&&"0ab77975-f984-4c43-95cc-bcdc2c41b326"===o.value.parent_id)return o.value.id;if(o.table===n.iU){var t;const e=(0,r.QaF)(null===(t=o.value)||void 0===t||null===(t=t.properties)||void 0===t?void 0:t.gXoN).trim();if(e)return e}}}function d(e){const t=e.match(/test\+(.*)@makenotion.com/);if(t)return decodeURIComponent(t[1])}},78395:(e,t,o)=>{o.d(t,{C1:()=>c,DA:()=>_,Ex:()=>h,KT:()=>K,NW:()=>m,SV:()=>v,YK:()=>S,Z3:()=>d,ds:()=>W,p1:()=>G,qK:()=>b,ry:()=>z,sk:()=>f});o(21703),o(57658);var n=o(30120),r=o(72126),i=(o(80),o(189)),a=o(95940),s=o(50715),l=o(25211);o(31734);const c=11;class d extends Error{constructor(){super("XML evaluator method not implemented."),this.name="XmlEvaluatorStateNotImplementedError"}}function p(e){return new Error(`Block with id ${e} not found.`)}function u(e){var t;const o=e.children??[];return{type:"block",tagName:e.tagName,parent:null===(t=e.parent)||void 0===t?void 0:t.attributes.id,attributes:{...e.attributes},children:o.map((e=>e.attributes.id)),text:r.Xh(e.text),properties:r.Xh(e.properties),schemas:r.Xh(e.schemas),schemaId:e.schemaId,persisted:e.persisted}}class m{constructor(e){this.context=void 0,this.selection=void 0,this.schemaIdMap=void 0,this.blockIdMap=void 0,this.loadedPageIds=void 0,this.peopleIdMap=void 0,this.idMapper=void 0,this.inheritPropsFromClonedParent=e=>{for(const t of e.getLoadedPageIds())this.markPageAsLoaded(t);this.selection=r.Xh(e.getAssistantSelectionIfExists()),this.blockIdMap=e.cloneBlockIdMap(),this.schemaIdMap=e.cloneSchemaIdMap();for(const[t,o]of e.peopleIdMap.entries())this.peopleIdMap.set(t,{...o});this.context=e.getContext(),this.idMapper=e.getIdMapper()},this.getIdMapper=()=>this.idMapper,this.getBlockIdMap_DO_NOT_USE=()=>this.blockIdMap,this.setIdMapper=e=>{this.idMapper=e},this.setPeopleIdMap=e=>{this.peopleIdMap=e},this.getContext=()=>this.context,this.getValueFromContext=e=>this.context[e],this.getLoadedPageIds=()=>this.loadedPageIds,this.getAssistantSelectionIfExists=()=>this.selection,this.setAssistantSelection=e=>{this.selection=e},this.getBlockFromBlockIdMap=e=>{const t=this.blockIdMap.get(e);if(!t)throw p(e);return t},this.getBlockFromBlockIdMapIfExists=e=>this.blockIdMap.get(e),this.getPageOrChildPageFromBlockIdMapIfExists=e=>{for(const t of this.blockIdMap.values())if("page"===t.tagName&&t.attributes.id===e||"child-page"===t.tagName&&t.attributes["page-id"]===e)return t},this.doesBlockIdMapHaveBlock=e=>this.blockIdMap.has(e),this.setBlockIdMapForBlock=(e,t)=>{this.blockIdMap.set(e,t)},this.findDatabaseNodeFromBlockIdMap=e=>[...this.blockIdMap.values()].find((t=>"child-database"===t.tagName||"link-database"===t.tagName?t.attributes["database-id"]===e:"database"===t.tagName&&t.attributes.id===e)),this.clearBlockIdMap=()=>{this.blockIdMap=new Map},this.getPageIdToBlockIdMap=()=>{const e=new Map;for(const[t,o]of this.blockIdMap.entries())if("child-page"===o.tagName){const n=o.attributes["page-id"];if(!n||!(0,i.oU)(n))throw new Error("Expected page id to have been mapped");e.set(n,t)}return e},this.getSchemaFromSchemaIdMap=e=>{const t=this.schemaIdMap.get(e);if(!t)throw p(e);return t},this.setSchemaIdMapForSchema=(e,t)=>{this.schemaIdMap.set(e,t)},this.cloneSchemaIdMap=()=>{const e=new Map;for(const[t,o]of this.schemaIdMap.entries())e.set(t,r.Xh(o));return e},this.markPageAsLoaded=e=>{this.loadedPageIds=Array.from(new Set([...this.loadedPageIds,e]))},this.overwriteSchemaIdMap=e=>{this.schemaIdMap=e},this.appendNewSearchPeopleResult=e=>{for(const t of e)this.peopleIdMap.set(t.id,t)},this.getSerializedState=()=>({version:c,context:this.getContext(),selection:this.getAssistantSelectionIfExists(),loadedPageIds:[...this.loadedPageIds],idMapper:this.getIdMapper().serialize(),schemaIdMap:Object.fromEntries(this.schemaIdMap),blockIdMap:this.replaceCircularReferencesInBlockIdMap(),peopleIdMap:Object.fromEntries(this.peopleIdMap)}),this.setContext=e=>{this.context=e},this.replaceCircularReferencesInBlockIdMap=()=>{const e={};for(const[t,o]of this.blockIdMap.entries()){const n=u(o);e[t]=n}return e},this.lazyCloneAndAssignBlock=e=>{const{block:t,oldMap:o,newMap:n}=e,i=n.get(t.attributes.id);if(i)return i;const a={type:"block",tagName:t.tagName,attributes:{...t.attributes},persisted:t.persisted,parent:void 0,children:[],text:r.Xh(t.text),properties:r.Xh(t.properties),schemas:r.Xh(t.schemas),schemaId:t.schemaId};n.set(t.attributes.id,a);const s=t.children;return a.children=s.map((e=>this.lazyCloneAndAssignBlock({block:e,oldMap:o,newMap:n}))),t.parent&&(a.parent=this.lazyCloneAndAssignBlock({block:t.parent,oldMap:o,newMap:n})),a},this.cloneBlockIdMap=()=>{const e=new Map;for(const t of this.blockIdMap.keys())this.lazyCloneAndAssignBlock({block:this.blockIdMap.get(t),oldMap:this.blockIdMap,newMap:e});return e},this.context=e,this.selection=void 0,this.schemaIdMap=new Map,this.blockIdMap=new Map,this.loadedPageIds=[],this.peopleIdMap=new Map,this.idMapper=new i.Tc,this.clone=this.clone.bind(this),this.parse=this.parse.bind(this),this.addOperation=this.addOperation.bind(this),this.randomID=this.randomID.bind(this),this.loadPage=this.loadPage.bind(this),this.search=this.search.bind(this),this.queryDatabase=this.queryDatabase.bind(this),this.chat=this.chat.bind(this),this.chatMd=this.chatMd.bind(this),this.think=this.think.bind(this),this.searchPeople=this.searchPeople.bind(this)}}const g={"load-page":async function(e){const{state:t,observationNode:o}=e,{id:n}=o.attributes,{pageBlockNode:i,relatedNodes:a,context:s}=await t.loadPage(n);t.markPageAsLoaded(n);const l=[i],c=[];let d;for(;d=l.pop();)c.includes(d.attributes.id)||(t.setSchemaIdMapForSchema(d.schemaId,d.schemas),t.setBlockIdMapForBlock(d.attributes.id,d),l.push(...d.children),c.push(d.attributes.id));const p=[];for(const{blockId:r,node:u,shouldShowObservation:m}of a)t.setBlockIdMapForBlock(r,u),t.setSchemaIdMapForSchema(u.schemaId,u.schemas),m&&p.push(u);return r.mN([i,...p],(e=>e.attributes.id)).map((e=>s?{type:"observation",observationType:"instructionsPage",pageId:e.attributes.id,context:s,value:G({node:e,state:t,ignoreSelection:!1})}:{type:"observation",observationType:"page",pageId:e.attributes.id,value:G({node:e,state:t,ignoreSelection:!1})}))},"query-database":async function(e){const{state:t,observationNode:o}=e,n=o.query.databaseId,r=t.findDatabaseNodeFromBlockIdMap(n);if(!r)throw new Error(`Database not found: ${n}`);V(o.query.filter,r),function(e,t){for(const o of e){if(!t.schemas[o.propertyName])throw new Error(`<sort> property name "${o.propertyName}" not found in database "${t.attributes.id}"`)}}(o.query.sorts,r),function(e,t){if(!e)return;const o=e.attributes.name,n=t.schemas[o];if(!n)throw new Error(`<${e.tagName}> property name "${o}" does not exist in database`);const{propertyTagName:r}=a.WC[n.tagName];if(e.tagName!==`aggregation-${r}`)throw new Error(`Filter for property name "${o}" must be <aggregation-${r}>, not <${e.tagName}>`)}(o.query.aggregation,r);const i=await t.queryDatabase({databaseId:n,filter:o.query.filter,sorts:o.query.sorts,search:o.query.search,aggregation:o.query.aggregation});for(const a of i.results){const e=a.attributes.id;t.doesBlockIdMapHaveBlock(e)||t.setBlockIdMapForBlock(e,a)}for(const a of i.dependentAssistantBlockNodes)t.setBlockIdMapForBlock(a.attributes.id,a),t.setSchemaIdMapForSchema(a.schemaId,a.schemas);const s=function(e){const{requestAggregation:t,state:o,queryDatabaseResult:n}=e,r=n.results.map((e=>({type:"text",value:G({node:e,state:o,ignoreSelection:!1})}))),i=n.aggregation&&t?[{type:"element",tagName:"aggregation-result",attributes:{name:t.attributes.name,aggregation:t.attributes.aggregation},children:[{type:"text",value:q(n.aggregation)}]}]:[];return{type:"element",tagName:"query-database-results",attributes:{"current-results":n.results.length.toString(),"total-results":n.total.toString()},children:[...r,...i]}}({state:t,requestAggregation:o.query.aggregation,queryDatabaseResult:i});return[{type:"observation",observationType:"queryDatabase",value:K(s)}]},search:async function(e){const{state:t,observationNode:o}=e,{question:n,keywords:r,lookback:i}=o.attributes,a=await t.search({question:n,keywords:r,lookback:i,questionIntl:o.attributes["question-intl"]}),s={type:"element",tagName:"search-results",attributes:{"current-results":a.length.toString()},children:a.map((e=>{const{id:t,title:o,path:n,text:r,lastEdited:i}=e;return{type:"element",tagName:"page-result",attributes:{id:t,title:o,path:n,"last-edited-datetime":i},children:[{type:"text",value:r}]}}))};return[{type:"observation",observationType:"search",value:K(s)}]},"search-people":async function(e){const{state:t,observationNode:o}=e,{search:n}=o.attributes,r=await t.searchPeople(n),i=K({type:"element",tagName:"search-people-results",attributes:{"current-results":r.results.length.toString(),"total-results":r.total.toString()},children:r.results.map((e=>{const{id:t,name:o,email:n}=e;return{type:"element",tagName:"person",attributes:{"person-id":t},children:[{type:"element",tagName:"property-text",attributes:{name:"Name"},children:[{type:"text",value:o}]},{type:"element",tagName:"property-email",attributes:{name:"Email"},children:[{type:"text",value:n}]}]}}))});return t.appendNewSearchPeopleResult(r.results),[{type:"observation",observationType:"searchPeople",value:i}]}},h=e=>e.tagName in g;function f(e,t){return"load-page"===e.tagName||"query-database"===e.tagName||"search"===e.tagName||"search-people"===e.tagName?g[e.tagName]({observationNode:e,state:t}):void(0,s.t1)(e)}const y={"insert-before":function(e){const{state:t,effectNode:o}=e,{id:n}=o.attributes,r=t.getBlockFromBlockIdMap(n);if(!r.parent)throw new Error(`Block with id ${n} has no parent.`);if("block"===o.insertType){const e=r.parent,n=e.children.findIndex((e=>e.attributes.id===r.attributes.id)),i=k({parent:e,children:o.children,state:t});if(n<0)throw new Error("Cannot insert before without parent.");const{parentForOperation:a}=C({parent:e,index:n,insert:i,state:t});for(const o of i)t.addOperation({command:"insertBlockBefore",parentId:a.attributes.id,insertBlockNode:o,beforeId:r.attributes.id})}else if("table"===o.insertType){const{name:e}=o.attributes;if("table"!==r.tagName)throw new Error("<insert-before> with name attribute only works on tables.");const n=Number(e);if(!Number.isInteger(n)||n<1)throw new Error(`Invalid column index: ${n}.`);for(const t of r.children){if(!t.properties[e])throw new Error(`Property ${e} does not exist on table row.`)}P({tableBlockNode:r,children:o.children,atZeroBasedIndex:n-1,state:t})}else(0,s.t1)(o)},"insert-after":function(e){const{state:t,effectNode:o}=e,{id:n}=o.attributes,r=t.getBlockFromBlockIdMap(n);if(!r.parent)throw new Error(`Block with id ${n} has no parent.`);if("block"===o.insertType){const e=r.parent,n=e.children.findIndex((e=>e.attributes.id===r.attributes.id)),i=k({parent:e,children:o.children,state:t});if(n<0)throw new Error("Cannot insert after without parent.");const{parentForOperation:a}=C({parent:e,index:n+1,insert:i,state:t}),s=[...i].reverse();for(const o of s)t.addOperation({command:"insertBlockAfter",parentId:a.attributes.id,insertBlockNode:o,afterId:r.attributes.id})}else if("table"===o.insertType){const{name:e}=o.attributes;if("table"!==r.tagName)throw new Error("<insert-after> with name attribute only works on tables.");const n=Number(e);if(!Number.isInteger(n)||n<1)throw new Error(`Invalid column index: ${n}.`);for(const t of r.children){if(!t.properties[e])throw new Error(`Property ${e} does not exist on table row.`)}P({tableBlockNode:r,children:o.children,atZeroBasedIndex:n,state:t})}else(0,s.t1)(o)},"insert-inside":function(e){const{state:t,effectNode:o}=e,n=o.attributes.id;if("block"===o.insertType){const e=t.findDatabaseNodeFromBlockIdMap(n);if(e){const r=k({parent:void 0,children:o.children,state:t,databaseId:e.attributes.id});for(const e of r)x({block:e,state:t,databaseId:n}),t.addOperation({command:"setBlockParent",parentId:n,blockNode:e})}else{const e=t.getBlockFromBlockIdMap(n),r=k({parent:e,children:o.children,state:t}),i=e.children.length,{parentForOperation:a}=C({parent:e,index:i+1,insert:r,state:t});for(const o of r)t.addOperation({command:"insertBlockAfter",parentId:a.attributes.id,insertBlockNode:o})}}else if("property"===o.insertType){const e=t.getBlockFromBlockIdMap(n);if("child-page"!==e.tagName&&"page"!==e.tagName)throw new Error("You can only append to properties on a page object.");const r=o.children[0];switch(r.tagName){case"property-relation":!function(e){var t;const{parentBlock:o,relationPropertyName:n,relationPropertyUpdates:r,state:i}=e,a=O({propertyChild:r,parentBlock:o,propertyName:n,action:"append",state:i}),s=o.properties[n];if("property-relation"!==s.tagName)throw new Error("Invalid property child when setting relation");for(const l of a){const e={type:"inline",tagName:"mention-page",attributes:{"page-id":l},children:[]};s.children.push(e)}i.addOperation({command:"setBlockProperty",blockNode:o,parentBlockId:null===(t=o.parent)||void 0===t?void 0:t.attributes.id,property:s})}({parentBlock:e,relationPropertyName:r.attributes.name,relationPropertyUpdates:r,state:t});break;case"property-person":T({parentBlock:e,personPropertyUpdate:r,state:t,action:"append"});break;case"property-multi-select":M({parentBlock:e,multiSelectPropertyName:r.attributes.name,multiSelectPropertyUpdates:r,state:t,action:"append"});break;default:throw new Error("Invalid child tag for insert-inside")}}else(0,s.t1)(o)},delete:function(e){const{state:t,effectNode:o}=e,n=o.attributes.id;if("property"===o.deleteType){const e=t.getBlockFromBlockIdMap(n);if("child-page"!==e.tagName)throw new Error("Cannot call delete on a non-database child-page.");const[r]=o.children;switch(r.tagName){case"property-relation":!function(e){var t;let{parentBlock:o,relationPropertyName:n,relationPropertyUpdates:r,state:a}=e;const s=new Set(O({propertyChild:r,parentBlock:o,propertyName:n,action:"delete",state:a})),l=o.properties[n];if("property-relation"!==l.tagName)throw new Error("Invalid property child when setting relation");const c=l.children.filter((e=>{const t=e.attributes["page-id"];if(!(0,i.oU)(t))throw new Error("Expected id to have been mapped");return!s.has(t)})),d={...l,children:c};o.properties[n]=d,a.addOperation({command:"setBlockProperty",blockNode:o,parentBlockId:null===(t=o.parent)||void 0===t?void 0:t.attributes.id,property:d})}({parentBlock:e,relationPropertyName:r.attributes.name,relationPropertyUpdates:r,state:t});break;case"property-person":T({parentBlock:e,personPropertyUpdate:r,state:t,action:"delete"});break;case"property-multi-select":M({parentBlock:e,multiSelectPropertyName:r.attributes.name,multiSelectPropertyUpdates:r,state:t,action:"delete"});break;default:(0,s.t1)(r)}}else if("block"===o.deleteType){A({remove:[t.getBlockFromBlockIdMap(n)],state:t})}else if("table-column"===o.deleteType){const e=t.getBlockFromBlockIdMap(n);if("table"!==e.tagName)throw new Error("<delete> with name attribute can only be used on <table> blocks.");const r=o.attributes.name,i=Number(r);for(const t of e.children){const e=t.properties;if(1===Object.keys(e).length)throw new Error(`Cannot delete property ${r} from row because it is the last property.`);if(!e[r])throw new Error(`Cannot delete property ${r} from row because it does not exist.`);delete e[r];let o=i;for(;e[o+1];)e[o+1].attributes.name=o.toString(),o++}t.addOperation({command:"removeTableColumn",blockNode:e,columnIndex:i-1})}else(0,s.t1)(o)},"set-title":function(e){const{state:t,effectNode:o}=e,n=o.attributes.id,r=t.getBlockFromBlockIdMap(n);if(!a.pX[r.tagName].title&&"page"!==r.tagName)throw new Error(`Block with id ${n} is a <${r.tagName}>, which does not allow title.`);const i=o.children;t.addOperation({command:"setBlockText",blockNode:r,text:i});let s=!1;for(const a of Object.values(r.properties))"property-title"===a.tagName&&(a.children=i.filter(l.A3),s=!0);s||(r.text=i)},"set-attribute":function(e){const{state:t,effectNode:o}=e,{id:n,key:r,value:i}=o.attributes,s=t.getBlockFromBlockIdMap(n),l=Object.fromEntries(Object.entries(a.pX[s.tagName].attributes).map((e=>{let[t,{values:o}]=e;return[t,o]})))[r];if(!l)throw new Error(`Attempted to set an attribute that is not allowed: ${r}.`);if(!0!==l&&!l.includes(i))throw new Error(`Attempted to set attribute ${r} to value that is not allowed: ${i}.`);t.addOperation({command:"setBlockAttribute",blockNode:s,attribute:r,value:i}),s.attributes[r]=i},"set-tag-name":function(e){const{state:t,effectNode:o}=e,{id:n,newTagName:r}=o.attributes,i=t.getBlockFromBlockIdMap(n);i.tagName=r,t.addOperation({command:"setBlockTagName",blockNode:i,tagName:r})},"set-property":function(e){const{state:t,effectNode:o}=e,n=o.attributes.id,r=o.children;for(const a of r){const e=t.getBlockFromBlockIdMap(n),o=a.attributes.name,r=e.properties[o];if(!r)throw new Error(`Cannot set property on block: ${o}.`);if(r.tagName!==a.tagName)throw new Error(`Attempted to set a property to a different tag name: ${e.properties[o].tagName} -> ${a.tagName}.`);var i;if("property-relation"===a.tagName)w({block:e,propertyName:o,state:t,newPropertyValue:a});else"property-select"===a.tagName||"property-multi-select"===a.tagName||"property-status"===a.tagName?j({newPropertyValue:a,parentBlock:e,propertyName:o,state:t}):"property-number"===a.tagName?B({newPropertyValue:a}):"property-date"===a.tagName&&N({newPropertyValue:a}),e.properties[o]=a,t.addOperation({command:"setBlockProperty",blockNode:e,parentBlockId:null===(i=e.parent)||void 0===i?void 0:i.attributes.id,property:a})}},chat:function(e){const{state:t,effectNode:o}=e,n=k({parent:void 0,children:o.children,state:t}),r=n.map((e=>e.attributes.id)),i=[...n,...n.flatMap((e=>(0,l.$1)(e)))].map((e=>({command:"createBlock",blockNode:e})));t.chat(r,i,o.actionButtons)},"chat-md":function(e){const{state:t,effectNode:o}=e,n=["â°","Â¹","Â²","Â³","â´","âµ","â¶","â·","â¸","â¹"];let r=o.text;const i=/\[([0-9])\]/g;let a,s=1;for(;null!==(a=i.exec(o.text));)r=r.replace(a[0],`[${n[s]}](${t.getIdMapper().mapCounterToKey(a[1]).key.replaceAll("-","")})`),s++;t.chatMd(r)},"persist-blocks":function(e){const{state:t,effectNode:o}=e,n=k({parent:void 0,children:o.children,state:t});for(const r of n)x({block:r,state:t})}},v=e=>e.tagName in y;function b(e,t){"chat"===e.tagName||"insert-after"===e.tagName||"delete"===e.tagName||"insert-before"===e.tagName||"insert-inside"===e.tagName||"persist-blocks"===e.tagName||"set-attribute"===e.tagName||"set-property"===e.tagName||"set-tag-name"===e.tagName||"set-title"===e.tagName||"chat-md"===e.tagName?y[e.tagName]({effectNode:e,state:t}):(0,s.t1)(e)}const S=["load-page","query-database","search","search-people","chat","insert-before","insert-after","insert-inside","delete","set-title","set-attribute","set-tag-name","set-property"],_=["search","chat"];function w(e){var t;const{block:o,propertyName:n,state:r,newPropertyValue:i}=e;O({propertyChild:i,parentBlock:o,propertyName:n,state:r,action:"overwrite"}),o.properties[n]=i,r.addOperation({command:"setBlockProperty",blockNode:o,parentBlockId:null===(t=o.parent)||void 0===t?void 0:t.attributes.id,property:i})}function k(e){const{state:t,children:o,databaseId:n,parent:r}=e;return o.map((e=>U({state:t,parsedBlock:e,parent:r,databaseId:n})))}function x(e){const{block:t,state:o,databaseId:n}=e;if(!t.persisted){o.addOperation({command:"createBlock",blockNode:t,databaseId:n});for(const e of t.children)x({block:e,state:o});t.persisted=!0}}function I(e){const{parent:t,state:o}=e;if("synced-block-reference"===t.tagName){if(!t.attributes["synced-block-id"])throw new Error("Synced block reference missing synced-block-id!");return o.getBlockFromBlockIdMap(t.attributes["synced-block-id"])}return t}function C(e){const{parent:t,index:o,insert:n,state:r}=e,i=Array.isArray(n)?n:[n],s=I({parent:t,state:r}),l=a.pX[s.tagName].content,c=i.map((e=>e.tagName));for(const a of c)if(!l.includes(a))throw new Error(`Encountered a block node in a block that doesn't allow content: ${a} inside ${t.tagName}.`);for(let a=i.length-1;a>=0;a--){const e=i[a];if("block"!==e.type)throw new Error("Cannot insert a non-block node.");e.parent=s,s.children.splice(o,0,e),x({block:e,state:r})}return{parentForOperation:s}}function T(e){var t;const{parentBlock:o,personPropertyUpdate:n,state:i,action:a}=e,l=n.attributes.name,c=o.properties[l];if("property-person"!==c.tagName)throw new Error("Invalid property child when appending to person property");const d=function(e){const{propertyChild:t,parentBlock:o,propertyName:n,state:i,action:a}=e,l=t.children.map((e=>e.attributes["person-id"])),c=i.getSchemaFromSchemaIdMap(o.schemaId);if(!c[n])throw new Error("Invalid schema for person property");if("property-person"!==c[n].type)throw new Error("Invalid property schema for property person");const d=c[n].limit;switch(a){case"overwrite":if(l.length>1&&"1"===d)throw new Error("Tried to set too many people for person property with limit 1");return l;case"append":{const e=o.properties[n].children.map((e=>e.attributes["person-id"])),t=r.jj([...l,...e]);if(t.length>1&&"1"===d)throw new Error("Tried to set too many people for person property with limit 1");return t}case"delete":{const e=o.properties[n].children.map((e=>e.attributes["person-id"]));return r.e5(e,l)}default:(0,s.t1)(a)}}({propertyChild:n,parentBlock:o,propertyName:l,state:i,action:a}),p=[];for(const r of d){const e={type:"inline",tagName:"mention-person",attributes:{"person-id":r,"person-name":void 0},children:[]};p.push(e)}c.children=p,i.addOperation({command:"setBlockProperty",blockNode:o,parentBlockId:null===(t=o.parent)||void 0===t?void 0:t.attributes.id,property:c})}function M(e){var t;let{parentBlock:o,multiSelectPropertyName:n,multiSelectPropertyUpdates:i,state:a,action:l}=e;const c=function(e){const{propertyChild:t,parentBlock:o,propertyName:n,action:i}=e,a=t.children.map((e=>e.attributes.option));switch(i){case"overwrite":return a;case"append":{const e=o.properties[n].children.map((e=>e.attributes.option));return r.jj([...a,...e])}case"delete":{const e=o.properties[n].children.map((e=>e.attributes.option));return r.e5(e,a)}default:(0,s.t1)(i)}}({propertyChild:i,parentBlock:o,propertyName:n,action:l}),d=[];for(const r of c){const e={type:"inline",tagName:"option",attributes:{option:r},children:[]};d.push(e)}const p=o.properties[n];if("property-multi-select"!==p.tagName)throw new Error("Invalid property child when updating multi-select");p.children=d,j({state:a,propertyName:n,newPropertyValue:p,parentBlock:o}),a.addOperation({command:"setBlockProperty",blockNode:o,parentBlockId:null===(t=o.parent)||void 0===t?void 0:t.attributes.id,property:p})}function P(e){let{tableBlockNode:t,children:o,atZeroBasedIndex:n,state:r}=e,i=n+1;const a=[];for(const l of o){if("move"===l.type){const e=l.attributes.name;if(!e)throw new Error("<move> inside <insert-X> with name attribute requires name attribute.");for(const o of t.children){if(!o.properties[e])throw new Error(`Property ${e} does not exist on table row.`)}if(a.includes(e))throw new Error(`Cannot move property ${e} more than once.`);a.push(e)}else if("schema"===l.type){if(l.attributes.name!==i.toString())throw new Error("<insert-X> with name attribute requires properties to be in order.")}else(0,s.t1)(l);i++}for(const l of t.children){const e=Object.values(l.properties).filter((e=>!a.includes(e.attributes.name))).sort(((e,t)=>Number(e.attributes.name)-Number(t.attributes.name))),t=e.map((e=>Number(e.attributes.name))),r=t.indexOf(Math.max(...t.filter((e=>e<n+1))))+1,i=Object.fromEntries([...e.slice(0,r),...o.map((e=>{if("move"===e.type)return l.properties[e.attributes.name];if("schema"===e.type){return{type:"property",tagName:"property-text",attributes:{name:e.attributes.name},children:[]}}(0,s.t1)(e)})),...e.slice(r)].map(((e,t)=>{const o=t+1;return[o,{...e,attributes:{...e.attributes,name:o.toString()}}]})));l.properties=i}r.addOperation({command:"insertOrMoveTableColumns",blockNode:t,atIndex:n,insertOrMoves:o})}function A(e){const{remove:t,state:o}=e;for(const n of t){if(!n.parent)throw new Error(`Cannot remove block without parent: ${n.attributes.id}.`);const e=I({parent:n.parent,state:o}),t=e.children.findIndex((e=>e.attributes.id===n.attributes.id));if(t<0)throw new Error(`Cannot remove block without parent: ${n.attributes.id}.`);o.addOperation({command:"removeBlock",parentId:e.attributes.id,removeBlockNode:n}),n.parent.children.splice(t,1),n.parent=void 0}}const D=/^\s*[+-]?(\d+|\d*\.\d+|\d+\.\d*)([Ee][+-]?\d+)?\s*$/;function B(e){const{newPropertyValue:t}=e;if(t.attributes.number&&!D.test(t.attributes.number))throw new Error("Invalid value for number property")}const R=/\d{4}-\d{2}-\d{2}/,E=/\d{2}:\d{2}/;function F(e){const{date:t,time:o}=e;if(!R.test(t))throw new Error("Invalid date for date property: incorrect format");if(o&&!E.test(o))throw new Error("Invalid time for date property: incorrect format");let r;const i=e.timeZone?{zone:e.timeZone}:void 0;if(r=o?n.ou.fromFormat(`${t}T${o}`,"yyyy-MM-dd'T'HH:mm",i):n.ou.fromFormat(`${t}`,"yyyy-MM-dd"),!r.isValid)throw new Error("Invalid date for date property");return r}function N(e){const{newPropertyValue:t}=e;if(t.children.length>1)throw new Error("Invalid value for date property. Expected only 1 child.");const[o]=t.children;if("mention-date"===o.tagName)F({date:o.attributes.date});else if("mention-datetime"===o.tagName)F({date:o.attributes.date,time:o.attributes.time});else if("mention-date-range"===o.tagName){const e=F({date:o.attributes["start-date"]}),t=F({date:o.attributes["end-date"]});if(e.valueOf()>t.valueOf())throw new Error("Invalid date range: start must be before end")}else if("mention-datetime-range"===o.tagName){const e=F({date:o.attributes["start-date"],time:o.attributes["start-time"]}),t=F({date:o.attributes["end-date"],time:o.attributes["end-time"]});if(e.valueOf()>t.valueOf())throw new Error("Invalid date range: start must be before end")}else(0,s.t1)(o)}function j(e){const{newPropertyValue:t,parentBlock:o,propertyName:n,state:r}=e,i=r.getSchemaFromSchemaIdMap(o.schemaId)[n];if(!i||i.tagName!==`schema-${t.tagName}`)throw new Error("Invalid schema for block");const a=new Set;for(const s of i.children)if("schema-option"===s.tagName&&a.add(s.attributes.option),"schema-option-category"===s.tagName)for(const e of s.children)a.add(e.attributes.option);for(const s of t.children)if(!a.has(s.attributes.option))throw new Error("Invalid option value");if("property-multi-select"!==t.tagName&&t.children.length>1)throw new Error("Invalid option value: limited to 1 option")}function O(e){const{propertyChild:t,parentBlock:o,propertyName:n,state:r,action:a}=e,l=t.children.map((e=>{const t=e.attributes["page-id"];if(!(0,i.oU)(t))throw new Error("Expected id to have been mapped");return t}));if("page"!==o.tagName&&"child-page"!==o.tagName)throw new Error("Attempted to set relation property on a block that isn't a pag");const c=o.properties[n];if(!c)throw new Error(`There is no relation property named ${n}`);if("property-relation"!==c.tagName)throw new Error(`The ${n} property is not a relation`);const d=c.attributes["database-id"];if(!d)throw new Error("Attempted to set relation property on a page that's not in a database");const p=r.getBlockFromBlockIdMap(d),u=r.getSchemaFromSchemaIdMap(o.schemaId)[n];if(!u||"schema-property-relation"!==u.tagName)throw new Error("Invalid schema for block");if("database"!==p.tagName)throw new Error("Invalid database id for relation property");const m=r.getPageIdToBlockIdMap();for(const i of l){const e=m.get(i);if(!e)throw new Error(`Invalid page id: ${i}`);if(r.getBlockFromBlockIdMap(e).schemaId!==p.schemaId)throw new Error("Invalid page id for relation")}const g=r.getSchemaFromSchemaIdMap(o.schemaId)[n].attributes;if((0,s.qg)(g,"synced-property-name")&&g["synced-property-name"]){const e=g["synced-property-name"],t=r.getSchemaFromSchemaIdMap(p.schemaId);if(!(0,s.qg)(t,e))throw new Error("Synced property name invalid for foreign table")}switch(a){case"overwrite":if("1"===u.attributes.limit&&l.length>1)throw new Error("Too many mentioned page ids for a relation field with limit 1");return l;case"append":{const e=o.properties[n];if("property-relation"!==e.tagName)throw new Error("Invalid property child when setting relation");const t=new Set(e.children.map((e=>e.attributes["page-id"])));if(l.forEach(t.add,t),t.size>1&&"1"===u.attributes.limit)throw new Error(`Too many mentioned page ids for a relation field with limit ${u.attributes.limit}`);return l}case"delete":{const e=o.properties[n];if("property-relation"!==e.tagName)throw new Error("Invalid property child when setting relation");const t=new Set(e.children.map((e=>e.attributes["page-id"])));for(const o of l)if(!t.has(o))throw new Error("Attempting to delete pageId not contained in relation.");return l}default:(0,s.t1)(a)}}function L(e){const{parsedBlock:t,persisted:o,parent:n,databaseId:r}=e;return(0,a.x)(t.tagName),{tagName:t.tagName,type:"block",persisted:o,attributes:t.attributes,text:t.text,properties:t.properties,schemas:t.schemas,children:[],parent:n,schemaId:r??t.attributes.id}}function U(e){const{state:t,parsedBlock:o,parent:n,databaseId:r}=e;if("move"===o.type){const e=t.getBlockFromBlockIdMap(o.attributes.id);return A({remove:[e],state:t}),e}const i=L({parsedBlock:o,persisted:!1,parent:n,databaseId:r});for(const a of o.children)i.children.push(U({state:t,parsedBlock:a,parent:i,databaseId:r}));return t.setBlockIdMapForBlock(i.attributes.id,i),t.setSchemaIdMapForSchema(i.schemaId,i.schemas),i}function Z(e,t){const o=e.propertyName,n=t.schemas[o];if(!n)throw new Error(`<filter-${e.propertyTagName}> property name "${o}" does not exist in database`);const{propertyTagName:r}=a.WC[n.tagName];if(e.propertyTagName!==r)throw new Error(`Filter for property name "${o}" must be <filter-${r}>, not <filter-${e.propertyTagName}>`);if("schema-property-select"===n.tagName||"schema-property-multi-select"===n.tagName){if("property-select"!==e.propertyTagName&&"property-multi-select"!==e.propertyTagName)throw new Error("Unexpected filter type");for(const t of e.children)if(!n.children.find((e=>e.attributes.option===t.attributes.option)))throw new Error(`<filter-${e.propertyTagName}> has invalid option: ${t.attributes.option}`)}if("schema-property-status"===n.tagName){if("property-status"!==e.propertyTagName)throw new Error("Unexpected filter type");for(const t of e.children)if("option-category"===t.tagName){if(!n.children.find((e=>e.attributes.category===t.attributes.category)))throw new Error(`<filter-${e.propertyTagName}> has invalid category: ${t.attributes.category}`)}else if("option"===t.tagName){if(!n.children.flatMap((e=>e.children)).find((e=>e.attributes.option===t.attributes.option)))throw new Error(`<filter-${e.propertyTagName}> has invalid option: ${t.attributes.option}`)}else(0,s.t1)(t)}}function V(e,t){for(const o of e.filters)"any"===o.operator||"all"===o.operator?V(o,t):Z(o,t)}function q(e){if("string"==typeof e)return e;if("number"==typeof e)return e.toString();if(void 0===e)return"undefined";if("date"===e.type)return e.start_date;if("datetime"===e.type)return F({date:e.start_date,time:e.start_time,timeZone:e.time_zone}).toISO();if("daterange"===e.type)return`${e.start_date}/${e.end_date}`;if("datetimerange"===e.type){return`${F({date:e.start_date,time:e.start_time,timeZone:e.time_zone}).toISO()}/${F({date:e.end_date,time:e.end_time,timeZone:e.time_zone}).toISO()}`}(0,s.t1)(e)}const z="\x3c!--<selection>--\x3e",W="\x3c!--</selection>--\x3e";function H(e){const{node:t,state:o,ignoreSelection:n,path:r,onlyAllowPropertyTypes:i}=e;if(r.includes(t))throw new Error("Circular reference detected!");const l=[...r,t],c=[];if("text"===t.type)for(const a of t.value)c.push(a);else{var d;const e=null!=o&&o.getValueFromContext("instructions-page-id")&&(null===(d=t.attributes)||void 0===d?void 0:d.id)===(null==o?void 0:o.getValueFromContext("instructions-page-id"))?"instructions-page":t.tagName;let r="";r+=`<${e}`;for(const[o,n]of Object.entries(t.attributes||{}))void 0!==n&&(r+=` ${o}="${n}"`);const p=`</${e}>`;if("block"===t.type){const e=null==o?void 0:o.getAssistantSelectionIfExists(),a="block"===t.type&&"block"===(null==e?void 0:e.type)&&e.blockIds.includes(t.attributes.id);!n&&a&&c.push(z);if(0===t.text.length&&0===Object.values(t.properties).length&&0===Object.values(t.schemas).length&&0===t.children.length)c.push(`${r}/>`);else{c.push(`${r}>`);const e=[];if(t.text)for(const r of t.text){const t=H({node:r,state:o,ignoreSelection:n,path:l,onlyAllowPropertyTypes:i});for(const o of t)e.push(o)}let a,s;const d=null==o?void 0:o.getAssistantSelectionIfExists();"text"===(null==d?void 0:d.type)&&d.start.blockId===t.attributes.id&&(a=d.start.index),"text"===(null==d?void 0:d.type)&&d.end.blockId===t.attributes.id&&(s=d.end.index);for(let t=0;t<e.length;t++){const o=e[t];let r="";n||t!==a||(r+=z),n||t!==s||(r+=W),r+=o,c.push(r)}n||a!==e.length||c.push(z),n||s!==e.length||c.push(W);for(const r of Object.values(t.properties))i&&!i.includes(r.tagName)||c.push(...H({node:r,state:o,ignoreSelection:n,path:l,onlyAllowPropertyTypes:i}));for(const r of Object.values(t.schemas))c.push(...H({node:r,state:o,ignoreSelection:n,path:l,onlyAllowPropertyTypes:i}));if(t.children)for(const r of t.children){const e=H({node:r,state:o,ignoreSelection:n,path:l,onlyAllowPropertyTypes:i});for(const t of e)c.push(t)}c.push(p)}!n&&a&&c.push(W)}else{if(0===t.children.length)c.push(`${r}/>`);else{const e=[];if(t.children)for(const r of t.children){const t=H({node:r,state:o,ignoreSelection:n,path:l,onlyAllowPropertyTypes:i});for(const o of t)e.push(o)}if(e.length<=1||(0,s.qg)(a.t,t.tagName)&&a.t[t.tagName].isToken)c.push(`${r}>${e.join("")}${p}`);else for(let t=0;t<e.length;t++){const o=e[t];0===t?c.push(`${r}>${o}`):t===e.length-1?c.push(o+p):c.push(o)}}}}return c}function G(e){const{node:t,state:o,ignoreSelection:n,onlyAllowPropertyTypes:r}=e;return H({node:t,state:o,ignoreSelection:n,path:[],onlyAllowPropertyTypes:r}).join("")}function K(e){let t="";if("text"===e.type)t+=e.value;else{t+=`<${e.tagName}`;for(const[o,n]of Object.entries(e.attributes||{}))t+=` ${o}="${n}"`;if(e.children&&e.children.length>0){t+=">";for(const o of e.children)t+=K(o);t+=`</${e.tagName}>`}else t+="/>"}return t}},95940:(e,t,o)=>{o.d(t,{B5:()=>l,CC:()=>y,Se:()=>_,WC:()=>u,ZK:()=>d,c8:()=>g,dn:()=>i,eT:()=>r,pX:()=>x,t:()=>c,v:()=>I,x:()=>C,yD:()=>a,zh:()=>s});o(97880);var n=o(50715);const r={default:"default",gray:"gray",brown:"brown",orange:"orange",yellow:"yellow",teal:"green",blue:"blue",purple:"purple",pink:"pink",red:"red",gray_background:"gray-background",brown_background:"brown-background",orange_background:"orange-background",yellow_background:"yellow-background",teal_background:"green-background",blue_background:"blue-background",purple_background:"purple-background",pink_background:"pink-background",red_background:"red-background"},i=Object.fromEntries(Object.entries(r).map((e=>{let[t,o]=e;return[o,t]}))),a=Object.values(r),s=["mention-page","mention-database","mention-person","mention-assistant","mention-date","mention-datetime","mention-date-range","mention-datetime-range"],l=["b","i","code","s","u","a","h",...s],c={b:{attributes:{},inline:l,text:!0,isToken:!1},i:{attributes:{},inline:l,text:!0,isToken:!1},code:{attributes:{},inline:l,text:!0,isToken:!1},s:{attributes:{},inline:l,text:!0,isToken:!1},u:{attributes:{},inline:l,text:!0,isToken:!1},a:{attributes:{href:{required:!0,values:!0,description:"link URL. Do not link to any URLs that are not already in the current context."}},inline:l,text:!0,isToken:!1},h:{attributes:{color:{required:!0,values:a,description:"text color"}},inline:l,text:!0,isToken:!1},"mention-page":{attributes:{"page-id":{required:!0,values:!0,description:"ID of page"}},inline:[],text:!0,isToken:!0},"mention-database":{attributes:{"database-id":{required:!0,values:!0,description:"ID of database"}},inline:[],text:!0,isToken:!0},"mention-person":{attributes:{"person-id":{required:!0,values:!0,description:"ID of person"},"person-name":{required:!1,values:!0,description:"Name of person"}},inline:[],text:!0,isToken:!0},"mention-assistant":{attributes:{},inline:[],text:!0,isToken:!0},"mention-date":{attributes:{date:{required:!0,values:!0,description:"Date in ISO 8601 (YYYY-MM-DD) format"}},inline:[],text:!1,isToken:!1},"mention-datetime":{attributes:{date:{required:!0,values:!0,description:"Date in ISO 8601 (YYYY-MM-DD) format"},time:{required:!0,values:!0,description:"Time in ISO 8601 (HH:MM) format"}},inline:[],text:!1,isToken:!1},"mention-date-range":{attributes:{"start-date":{required:!0,values:!0,description:"Start date in ISO 8601 (YYYY-MM-DD) format"},"end-date":{required:!0,values:!0,description:"End date in ISO 8601 (YYYY-MM-DD) format"}},inline:[],text:!1,isToken:!1},"mention-datetime-range":{attributes:{"start-date":{required:!0,values:!0,description:"Start date in ISO 8601 (YYYY-MM-DD) format"},"end-date":{required:!0,values:!0,description:"End date in ISO 8601 (YYYY-MM-DD) format"},"start-time":{required:!0,values:!0,description:"Start time in ISO 8601 (HH:MM) format"},"end-time":{required:!0,values:!0,description:"End time in ISO 8601 (HH:MM) format"}},inline:[],text:!1,isToken:!1},option:{attributes:{option:{values:!0,description:"Option name",required:!0}},inline:[],text:!1,isToken:!1},"option-category":{attributes:{category:{values:!0,description:"Status category",required:!0}},inline:[],text:!1,isToken:!1},"schema-option":{attributes:{option:{values:!0,description:"Option name",required:!0}},inline:[],text:!1,isToken:!1},"schema-option-category":{attributes:{category:{values:!0,description:"Status category",required:!0}},inline:["schema-option"],text:!1,isToken:!1}},d={"property-title":{text:!0,inline:s,attributes:{}},"property-text":{text:!0,inline:l,attributes:{}},"property-url":{text:!0,inline:[],attributes:{}},"property-email":{text:!0,inline:[],attributes:{}},"property-phone-number":{text:!0,inline:[],attributes:{}},"property-person":{text:!1,inline:["mention-person"],attributes:{}},"property-date":{text:!1,inline:["mention-date","mention-date-range","mention-datetime","mention-datetime-range"],attributes:{}},"property-created-time":{text:!1,inline:["mention-date","mention-datetime"],attributes:{}},"property-last-edited-time":{text:!1,inline:["mention-date","mention-datetime"],attributes:{}},"property-created-by":{text:!1,inline:["mention-person"],attributes:{}},"property-last-edited-by":{text:!1,inline:["mention-person"],attributes:{}},"property-checkbox":{text:!1,inline:[],attributes:{checked:{values:["true","false"],description:'checked state, either "true" or "false"',required:!0}}},"property-select":{text:!1,inline:["option"],attributes:{}},"property-multi-select":{text:!1,inline:["option"],attributes:{}},"property-relation":{text:!1,inline:["mention-page"],attributes:{"database-id":{values:!0,description:"The database ID the relation points to",required:!1}}},"property-status":{text:!1,inline:["option"],attributes:{}},"property-number":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!1}}}},p=(0,n.Yd)(d),u={"schema-property-title":{propertyTagName:"property-title",inline:[],attributes:{}},"schema-property-text":{propertyTagName:"property-text",inline:[],attributes:{}},"schema-property-url":{propertyTagName:"property-url",inline:[],attributes:{}},"schema-property-email":{propertyTagName:"property-email",inline:[],attributes:{}},"schema-property-phone-number":{propertyTagName:"property-phone-number",inline:[],attributes:{}},"schema-property-person":{propertyTagName:"property-person",inline:[],attributes:{limit:{values:["1","Infinity"],description:"The number of options that can be added",required:!0}}},"schema-property-date":{propertyTagName:"property-date",inline:[],attributes:{}},"schema-property-created-time":{propertyTagName:"property-created-time",inline:[],attributes:{}},"schema-property-last-edited-time":{propertyTagName:"property-last-edited-time",inline:[],attributes:{}},"schema-property-created-by":{propertyTagName:"property-created-by",inline:[],attributes:{}},"schema-property-last-edited-by":{propertyTagName:"property-last-edited-by",inline:[],attributes:{}},"schema-property-checkbox":{propertyTagName:"property-checkbox",inline:[],attributes:{}},"schema-property-select":{propertyTagName:"property-select",inline:["schema-option"],attributes:{}},"schema-property-multi-select":{propertyTagName:"property-multi-select",inline:["schema-option"],attributes:{}},"schema-property-relation":{propertyTagName:"property-relation",inline:["mention-page"],attributes:{limit:{values:["1","Infinity"],description:"The number of options that can be added",required:!0},"database-id":{values:!0,description:"The database ID the relation points to",required:!0},"synced-property-name":{required:!1,values:!0,description:"The symmetric relation property name in the database this relation points to"}}},"schema-property-status":{propertyTagName:"property-status",inline:["schema-option-category"],attributes:{}},"schema-property-number":{propertyTagName:"property-number",inline:[],attributes:{format:{values:!0,description:"Number format",required:!1}}}},m={is:{text:!1,inline:["mention-date"],attributes:{}},">":{text:!1,inline:["mention-date"],attributes:{}},"<":{text:!1,inline:["mention-date"],attributes:{}},"â‰¥":{text:!1,inline:["mention-date"],attributes:{}},"â‰¤":{text:!1,inline:["mention-date"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},g={"property-title":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-text":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-url":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-email":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-phone-number":{is:{text:!0,inline:[],attributes:{}},contains:{text:!0,inline:[],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-person":{contains:{text:!1,inline:["mention-person"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-date":m,"property-created-time":m,"property-last-edited-time":m,"property-created-by":{contains:{text:!1,inline:["mention-person"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-last-edited-by":{contains:{text:!1,inline:["mention-person"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-checkbox":{is:{text:!1,inline:[],attributes:{checked:{values:["true","false"],description:'checked state, either "true" or "false"',required:!0}}}},"property-select":{is:{text:!1,inline:["option"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-multi-select":{contains:{text:!1,inline:["option"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-relation":{contains:{text:!1,inline:["mention-page"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-status":{is:{text:!1,inline:["option","option-category"],attributes:{}},"is empty":{text:!1,inline:[],attributes:{}}},"property-number":{is:{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},">":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},"<":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},"â‰¥":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},"â‰¤":{text:!1,inline:[],attributes:{number:{values:!0,description:"value",required:!0}}},"is empty":{text:!1,inline:[],attributes:{}}}},h=["Count all"],f=["Count values","Count unique values","Count empty","Count not empty","Percent empty","Percent not empty","Show unique values"],y={"Count all":"count","Count values":"count_values","Count unique values":"unique","Count empty":"empty","Count not empty":"not_empty","Percent empty":"percent_empty","Percent not empty":"percent_not_empty","Show unique values":"show_unique","Count checked":"checked","Count unchecked":"unchecked","Percent checked":"percent_checked","Percent unchecked":"percent_unchecked","Count per group":"count_per_group","Percent per group":"percent_per_group",Sum:"sum",Average:"average",Median:"median",Min:"min",Max:"max",Range:"range","Earliest date":"earliest_date","Latest date":"latest_date","Date range":"date_range"},v={basic:[...h,...f],date:[...h,...f,"Earliest date","Latest date","Date range"],status:[...h,...f,"Count per group","Percent per group"],number:[...h,...f,"Sum","Average","Median","Min","Max","Range"],checkbox:[...h,"Count checked","Count unchecked","Percent checked","Percent unchecked"]};function b(e){return`the name of the ${e} property being aggregated`}function S(e){return`the method of aggregation for the ${e} property`}const _={"aggregation-property-title":{attributes:{name:{required:!0,values:!0,description:b("title")},aggregation:{values:v.basic,required:!0,description:S("title")}}},"aggregation-property-text":{attributes:{name:{required:!0,values:!0,description:b("text")},aggregation:{values:v.basic,required:!0,description:S("text")}}},"aggregation-property-url":{attributes:{name:{required:!0,values:!0,description:b("url")},aggregation:{values:v.basic,required:!0,description:S("url")}}},"aggregation-property-email":{attributes:{name:{required:!0,values:!0,description:b("email")},aggregation:{values:v.basic,required:!0,description:S("email")}}},"aggregation-property-phone-number":{attributes:{name:{required:!0,values:!0,description:b("phone_number")},aggregation:{values:v.basic,required:!0,description:S("phone_number")}}},"aggregation-property-date":{attributes:{name:{values:!0,required:!0,description:b("date")},aggregation:{values:v.date,required:!0,description:S("date")}}},"aggregation-property-created-time":{attributes:{name:{values:!0,required:!0,description:b("created-time")},aggregation:{values:v.date,required:!0,description:S("created-time")}}},"aggregation-property-last-edited-time":{attributes:{name:{values:!0,required:!0,description:b("last-edited-time")},aggregation:{values:v.date,required:!0,description:S("last-edited-time")}}},"aggregation-property-person":{attributes:{name:{values:!0,required:!0,description:b("person")},aggregation:{values:v.basic,required:!0,description:S("person")}}},"aggregation-property-created-by":{attributes:{name:{values:!0,required:!0,description:b("created-by")},aggregation:{values:v.basic,required:!0,description:S("created-by")}}},"aggregation-property-last-edited-by":{attributes:{name:{values:!0,required:!0,description:b("last-edited-by")},aggregation:{values:v.basic,required:!0,description:S("last-edited-by")}}},"aggregation-property-checkbox":{attributes:{name:{values:!0,required:!0,description:b("checkbox")},aggregation:{values:v.checkbox,required:!0,description:S("checkbox")}}},"aggregation-property-select":{attributes:{name:{values:!0,required:!0,description:b("select")},aggregation:{values:v.basic,required:!0,description:S("select")}}},"aggregation-property-multi-select":{attributes:{name:{values:!0,required:!0,description:b("multi-select")},aggregation:{values:v.basic,required:!0,description:S("multi-select")}}},"aggregation-property-relation":{attributes:{name:{values:!0,required:!0,description:b("relation")},aggregation:{values:v.basic,required:!0,description:S("relation")}}},"aggregation-property-number":{attributes:{name:{values:!0,required:!0,description:b("number")},aggregation:{values:v.number,required:!0,description:S("number")}}},"aggregation-property-status":{attributes:{name:{values:!0,required:!0,description:b("status")},aggregation:{values:v.status,required:!0,description:S("status")},group:{values:!0,required:!0,description:"then name of the status group being aggregated when aggregation is 'Count per group' or 'Percent per group'. For other aggregations, just provide any group name."}}}},w=["hr","embed","h1","h2","h3","database","math-block","code-block","child-page","link-page","child-database","link-database","text","page","synced-block","synced-block-reference","uli","oli","toggle","quote","callout","todo","columns","table"],k={required:!1,values:a,description:"color for the block"},x={hr:{title:!1,content:[],attributes:{},properties:[],schemas:[]},embed:{title:!1,content:[],attributes:{color:k},properties:[],schemas:[]},h1:{title:!0,content:[],attributes:{color:k},properties:[],schemas:[]},h2:{title:!0,content:[],attributes:{color:k},properties:[],schemas:[]},h3:{title:!0,content:[],attributes:{color:k},properties:[],schemas:[]},database:{title:!1,content:[],attributes:{},properties:["property-title"],schemas:p},"math-block":{title:!0,content:[],attributes:{},properties:[],schemas:[]},"code-block":{title:!0,content:[],attributes:{language:{required:!0,values:!0,description:"language of code"}},properties:[],schemas:[]},"child-page":{title:!1,content:[],attributes:{"page-id":{required:!0,values:!0,description:"ID of page, to be used in <load-page>"},"database-id":{required:!1,values:!0,description:"The ID of the database this page is within, if there is one"}},properties:p,schemas:[]},"link-page":{title:!1,content:[],attributes:{"page-id":{required:!0,values:!0,description:"ID of page, to be used in <load-page>"},"database-id":{required:!1,values:!0,description:"The ID of the database this page is within, if there is one"}},properties:p,schemas:[]},"child-database":{title:!1,content:[],attributes:{"database-id":{required:!0,values:!0,description:"ID of database. Make sure to use the value of this attribute as the id in query-database."}},properties:["property-title"],schemas:p},"link-database":{title:!1,content:[],attributes:{"database-id":{required:!0,values:!0,description:"ID of database"}},properties:["property-title"],schemas:p},text:{title:!0,content:w,attributes:{color:k},properties:[],schemas:[]},page:{title:!1,content:w,attributes:{"database-id":{required:!1,values:!0,description:"ID of the database this page belongs to. Use this to look up the schema for the page"}},properties:p,schemas:[]},uli:{title:!0,content:w,attributes:{color:k},properties:[],schemas:[]},oli:{title:!0,content:w,attributes:{color:k},properties:[],schemas:[]},toggle:{title:!0,content:w,attributes:{color:k},properties:[],schemas:[]},quote:{title:!0,content:w,attributes:{color:k},properties:[],schemas:[]},todo:{title:!0,content:w,attributes:{checked:{required:!0,values:["true","false"],description:'checked state, either "true" or "false"'},color:k},properties:[],schemas:[]},callout:{title:!0,content:w,attributes:{color:k},properties:[],schemas:[]},"synced-block":{title:!1,content:w,attributes:{},properties:[],schemas:[]},"synced-block-reference":{title:!1,content:w,attributes:{"synced-block-id":{required:!0,values:!0,description:"The ID of the <synced-block> node that this references"}},properties:[],schemas:[]},columns:{title:!1,content:["column"],attributes:{},properties:[],schemas:[]},column:{title:!1,content:w,attributes:{},properties:[],schemas:[]},table:{title:!1,content:["tr"],attributes:{"header-row":{required:!1,values:["true","false"],description:'whether first <tr> is row header, either "true" or "false"'},"header-column":{required:!1,values:["true","false"],description:'whether first <td> in every <tr> is column header, either "true" or "false"'}},properties:[],schemas:["property-text"]},tr:{title:!1,content:[],attributes:{},properties:["property-text"],schemas:[]},"ai-block":{title:!0,content:w,attributes:{},properties:["property-text"],schemas:[]}},I=Object.freeze((0,n.Yd)({text:!0,toggle:!0,quote:!0,embed:!0,callout:!0,uli:!0,oli:!0,todo:!0,h1:!0,h2:!0,h3:!0}));const C=(0,n.AO)((e=>"synced-block-reference"===e||"ai-block"===e?{true:e}:{false:e}))},88891:(e,t,o)=>{o.d(t,{ND:()=>f,hl:()=>y,rn:()=>w});o(21703),o(57658);var n=o(41432),r=o(99036),i=o(38297),a=o(32056),s=o(482),l=o(71644),c=o(98459),d=o(21202),p=o(19889),u=o(97880),m=o(189),g=o(95940),h=o(24993);function f(e){const{assistantOperation:t,actorPointer:o,getRecordValue:a,spaceId:p,getCitationNumberForPage:m}=e,g=Date.now(),f={last_edited_by_table:o.table,last_edited_by_id:o.id,last_edited_time:g},y={created_by_table:o.table,created_by_id:o.id,created_time:g,...f};if("createBlock"===t.command){const e=[],o=h.BO[t.blockNode.tagName];if(!o)throw new Error(`Unknown block type: ${t.blockNode.tagName}`);const i={},u={};if(t.blockNode.attributes)for(const[n,r]of Object.entries(t.blockNode.attributes)){const e=k[n];if(e){const t=e(r,{spaceId:p});Object.assign(i,t.properties),Object.assign(u,t.format)}}const g=t.blockNode.properties.Title?t.blockNode.properties.Title.children:t.blockNode.text,_={};if(t.databaseId){const e={table:d.iU,id:t.databaseId},o=a(e);if(!o)throw new Error("No collection view block");const n=(0,c.Bq)({table:d.iU,value:o});if(!n)throw new Error("No collection pointer");const i=a(n);if(!i)throw new Error("No collection");const s=(0,r.oC)(i);for(const[r,a]of Object.entries(t.blockNode.properties)){const e=Object.entries(s).find((e=>{let[,t]=e;return(null==t?void 0:t.name)===r}));if(!e)throw new Error(`Property not found: ${r}`);const[t]=e;_[t]=(0,h.Yt)({type:"property",property:a,nodes:a.children})||[]}}if(e.push({pointer:{table:d.iU,id:S(t.blockNode.attributes.id)},command:"set",path:[],args:{type:o,properties:{title:(null==g?void 0:g.length)>0?(0,h.Yt)({type:"text",nodes:g,getCitationNumberForPage:m}):void 0,...i,..._},content:t.blockNode.children.length>0?t.blockNode.children.map((e=>S(e.attributes.id))):void 0,...t.blockNode.parent&&{parent_id:S(t.blockNode.parent.attributes.id),parent_table:d.iU,alive:!0},...y,format:u}}),"tr"===t.blockNode.tagName){var v,b;const o=t.blockNode.attributes.id,r=null===(v=t.blockNode.parent)||void 0===v?void 0:v.attributes.id;if(!r)throw new Error(`Parent not found: ${r}.`);const i={table:d.iU,id:S(o)},c={table:d.iU,id:S(r)},p=a(c);if(!p)throw new Error(`Parent block not found: ${r}.`);if(p.type!==n.Ti.table)throw new Error("Parent block is not of type table.");let u=(null===(b=p.format)||void 0===b?void 0:b.table_block_column_order)||[];const m=Object.values(t.blockNode.properties).sort(((e,t)=>parseInt(e.attributes.name)-parseInt(t.attributes.name)));if(u.length>0&&u.length!==m.length)throw new Error("Table already has wrong number of columns for row.");for(const e of m)if(m.indexOf(e)+1!==parseInt(e.attributes.name))throw new Error("Table row properties are not in order.");0===u.length&&(u=m.map((()=>(0,l.ZP)())),e.push(s.op.set({pointer:c,path:["format","table_block_column_order"],args:u}),s.op.update({pointer:c,path:[],args:f})));const g=Object.fromEntries(m.map(((e,t)=>[u[t],e.children.length>0?(0,h.Yt)({type:"property",nodes:e.children,property:e}):void 0])));e.push(s.op.update({pointer:i,path:["properties"],args:g}))}return e}if("removeBlock"===t.command)return[{pointer:{table:d.iU,id:S(t.parentId)},command:"listRemove",path:["content"],args:{id:S(t.removeBlockNode.attributes.id)}},s.op.update({pointer:{table:d.iU,id:S(t.parentId)},path:[],args:f}),{pointer:{table:d.iU,id:S(t.removeBlockNode.attributes.id)},command:"update",path:[],args:{parent_id:S(t.parentId),parent_table:d.iU,alive:!1,...f}}];if("insertBlockBefore"===t.command)return[{pointer:{table:d.iU,id:S(t.parentId)},command:"listBefore",path:["content"],args:{id:S(t.insertBlockNode.attributes.id),before:t.beforeId?S(t.beforeId):void 0}},s.op.update({pointer:{table:d.iU,id:S(t.parentId)},path:[],args:f}),{pointer:{table:d.iU,id:S(t.insertBlockNode.attributes.id)},command:"update",path:[],args:{parent_id:S(t.parentId),parent_table:d.iU,alive:!0,...f}}];if("insertBlockAfter"===t.command)return[{pointer:{table:d.iU,id:S(t.parentId)},command:"listAfter",path:["content"],args:{id:S(t.insertBlockNode.attributes.id),after:t.afterId?S(t.afterId):void 0}},s.op.update({pointer:{table:d.iU,id:S(t.parentId)},path:[],args:f}),{pointer:{table:d.iU,id:S(t.insertBlockNode.attributes.id)},command:"update",path:[],args:{parent_id:S(t.parentId),parent_table:d.iU,alive:!0,...f}}];if("setBlockText"===t.command)return[{pointer:{table:d.iU,id:S(t.blockNode.attributes.id)},command:"update",path:["properties"],args:{title:t.text&&t.text.length>0?(0,h.Yt)({type:"text",nodes:t.text}):void 0}},s.op.update({pointer:{table:d.iU,id:S(t.blockNode.attributes.id)},path:[],args:f})];if("setBlockAttribute"===t.command){const e=k[t.attribute];if(e){const o=e(t.value,{spaceId:p}),n={table:d.iU,id:S(t.blockNode.attributes.id)};return[...o.properties?[s.op.update({pointer:n,path:["properties"],args:o.properties})]:[],...o.format?[s.op.update({pointer:n,path:["format"],args:o.format})]:[],s.op.update({pointer:n,path:[],args:f})]}return[]}if("setBlockTagName"===t.command){const e=h.BO[t.tagName];if(!e)throw new Error(`Unknown tag name: ${t.tagName}`);return[{pointer:{table:d.iU,id:S(t.blockNode.attributes.id)},command:"update",path:[],args:{type:e,...f}}]}if("setBlockProperty"===t.command){const{blockNode:e,property:o,parentBlockId:c}=t,p={table:d.iU,id:S(e.attributes.id)},u=c?{table:d.iU,id:S(c)}:void 0,m=a(p),g=u?a(u):void 0;if(!m)throw new Error(`Block not found: ${e.attributes.id}.`);if("property-title"===o.tagName)return[{pointer:{table:d.iU,id:S(t.blockNode.attributes.id)},command:"update",path:["properties"],args:{title:(0,h.Yt)({type:"text",nodes:o.children})}},s.op.update({pointer:{table:d.iU,id:S(t.blockNode.attributes.id)},path:[],args:f})];if(m.type===n.Ti.tableRow){var _;if(!u||!g)throw new Error(`Block not found: ${c}.`);if(g.type!==n.Ti.table)throw new Error("Parent block is not of type table.");const e=Number(o.attributes.name);if(!Number.isInteger(e)||e<1)throw new Error(`Invalid column index: ${e}.`);const t=(null===(_=g.format)||void 0===_?void 0:_.table_block_column_order)||[];if(e>t.length+1)throw new Error(`Column index too high: ${e}.`);const r=t[e-1];let i;r?i=r:(i=(0,l.ZP)(),t.push((0,l.ZP)()));const a=[s.op.set({pointer:p,path:["properties",i],args:o.children.length>0?(0,h.Yt)({type:"text",nodes:o.children})||[]:void 0}),s.op.update({pointer:p,path:[],args:f})];return r||a.push(s.op.set({pointer:u,path:["format","table_block_column_order"],args:t}),s.op.update({pointer:u,path:[],args:f})),a}{const e=(0,i.ky)({getRecordValue:a,block:m});if(!e)throw new Error("Block is not in a database.");const n=o.attributes.name,l=(0,r.oC)(e),c=Object.entries(l).find((e=>{let[,t]=e;return(null==t?void 0:t.name)===n}));if(!c)throw new Error(`Property not found: ${n}`);const[p]=c,u=(0,h.Yt)({type:"property",property:o,nodes:o.children});return[{pointer:{table:d.iU,id:S(t.blockNode.attributes.id)},command:"update",path:["properties"],args:{[p]:u}},s.op.update({pointer:{table:d.iU,id:S(t.blockNode.attributes.id)},path:[],args:f})]}}if("insertOrMoveTableColumns"===t.command){var w;const{blockNode:e,atIndex:o,insertOrMoves:r}=t,i={table:d.iU,id:S(e.attributes.id)},c=a(i);if(!c)throw new Error(`Block not found: ${e.attributes.id}.`);if(c.type!==n.Ti.table)throw new Error("Block is not of type table.");const p=(null===(w=c.format)||void 0===w?void 0:w.table_block_column_order)||[],m=r.map((e=>{if("schema"===e.type){return(0,l.ZP)()}if("move"===e.type){const t=p[Number(e.attributes.name)-1];if(!t)throw new Error(`Invalid column index: ${e.attributes.name}.`);return t}(0,u.t1)(e)})),g=[...p.slice(0,o).filter((e=>!m.includes(e))),...m,...p.slice(o).filter((e=>!m.includes(e)))];return[s.op.set({pointer:i,path:["format","table_block_column_order"],args:g}),s.op.update({pointer:i,path:[],args:f})]}if("removeTableColumn"===t.command){var x;const{blockNode:e,columnIndex:o}=t,r={table:d.iU,id:S(e.attributes.id)},i=a(r);if(!i)throw new Error(`Block not found: ${e.attributes.id}.`);if(i.type!==n.Ti.table)throw new Error("Block is not of type table.");const l=(null===(x=i.format)||void 0===x?void 0:x.table_block_column_order)||[],c=l[o];if(!c)throw new Error(`Invalid column index: ${o}.`);const p=[...l.slice(0,o),...l.slice(o+1)];return[s.op.set({pointer:r,path:["format","table_block_column_order"],args:p}),s.op.update({pointer:r,path:[],args:f}),...(i.content||[]).flatMap((e=>{const t={table:d.iU,id:e},o=a(t);return o&&o.type===n.Ti.tableRow?[s.op.set({pointer:t,path:["properties",c],args:void 0}),s.op.update({pointer:t,path:[],args:f})]:[]}))]}if("setBlockParent"===t.command){const e={table:d.iU,id:t.parentId};let o;const n=a(e);return n&&(o=(0,c.Bq)({table:d.iU,value:n})),[{pointer:{table:d.iU,id:S(t.blockNode.attributes.id)},command:"update",path:[],args:{...o?{parent_id:S(o.id),parent_table:o.table}:{parent_id:S(e.id),parent_table:e.table},alive:!0,...f}}]}(0,u.t1)(t)}function y(e){let{assistantDatabaseQuery:t,idMapper:o,spaceId:n,getRecordValue:i}=e;const a={databaseId:S(o.mapCounterToKey(t.databaseId).key),filter:t.filter,sorts:t.sorts},s={table:d.iU,id:a.databaseId,spaceId:n},p=i(s);if(!p)throw new Error("No collection view block");const u=(0,c.Bq)({table:d.iU,value:p});if(!u)throw new Error("No collection pointer");const m=i(u);if(!m)throw new Error("No collection");const g=(0,r.oC)(m);return{collectionViewBlockPointer:s,collectionPointer:{spaceId:s.spaceId,...u},filter:v({groupFilter:a.filter,schema:g,idMapper:o}),sort:a.sorts.map((e=>{const t=Object.keys(g).find((t=>{var o;return(0,l.j5)(t)&&(null===(o=g[t])||void 0===o?void 0:o.name)===e.propertyName}));if(!t)throw new Error(`Invalid property name: ${e.propertyName}.`);return{property:t,direction:e.direction}})),aggregation:b({collectionSchema:g,aggregationRequest:t.aggregation}),vectorSearch:t.search,limit:10}}function v(e){const{groupFilter:t,schema:o,idMapper:n}=e;return{operator:{any:"or",all:"and"}[t.operator],filters:t.filters.map((e=>{const{operator:t}=e;return"any"===t||"all"===t?v({groupFilter:e,schema:o,idMapper:n}):"is"===t||"contains"===t||">"===t||"<"===t||"â‰¥"===t||"â‰¤"===t||"is empty"===t?function(e){const{filter:t,schema:o,idMapper:n}=e,{propertyTagName:r,operator:i,not:s,attributes:c,children:d,propertyName:g}=t,h=Object.keys(o).find((e=>{var t;return(0,l.j5)(e)&&(null===(t=o[e])||void 0===t?void 0:t.name)===g}));if(!h)throw new Error(`Invalid property name: ${g}.`);if("property-title"===r||"property-text"===r||"property-url"===r||"property-email"===r||"property-phone-number"===r){const e={empty:s?"is_not_empty":"is_empty",is:s?"string_is_not":"string_is",contains:s?"string_does_not_contain":"string_contains"};return{property:h,filter:"is empty"!==i&&(0,u.Of)(d)?{operator:e[i],value:{type:"exact",value:d[0].value}}:{operator:e.empty}}}if("property-person"===r||"property-created-by"===r||"property-last-edited-by"===r){const e={empty:s?"is_not_empty":"is_empty",contains:s?"person_does_not_contain":"person_contains"};return{property:h,filter:(0,u.Of)(d)?{operator:e[i],value:d.map((e=>{const t=e.attributes["person-id"];if(!(0,m.oU)(t))throw new Error("Invalid person id");return{type:"exact",value:{table:p.KJ,id:n.mapCounterToKey(t).key}}}))}:{operator:e.empty}}}if("property-relation"===r){const e={empty:s?"is_not_empty":"is_empty",contains:s?"relation_does_not_contain":"relation_contains"};return{property:h,filter:(0,u.Of)(d)?{operator:e[i],value:d.map((e=>{const t=e.attributes["page-id"];return{type:"exact",value:n.mapCounterToKey(t).key}}))}:{operator:e.empty}}}if("property-date"===r||"property-created-time"===r||"property-last-edited-time"===r){if("is"===i&&!0===s)throw new Error("Data filter does not support 'is not' operator");const e={empty:s?"is_not_empty":"is_empty",is:"date_is",">":s?"date_is_on_or_before":"date_is_after","<":s?"date_is_on_or_after":"date_is_before","â‰¥":s?"date_is_before":"date_is_on_or_after","â‰¤":s?"date_is_after":"date_is_on_or_before"};if("is empty"===i)return{property:h,filter:{operator:e.empty}};let t;const o=d[0];if("mention-date"!==o.tagName)throw new Error("Invalid mention date in filter. This should never happen");return t={type:"date",start_date:o.attributes.date},{property:h,filter:{operator:e[i],value:{type:"exact",value:t}}}}if("property-checkbox"===r)return{property:h,filter:{operator:{is:s?"checkbox_is_not":"checkbox_is"}[i],value:{type:"exact",value:{true:!0,false:!1}[c.checked]}}};if("property-select"===r){const e={empty:s?"is_not_empty":"is_empty",is:s?"enum_is_not":"enum_is"};return{property:h,filter:(0,u.Of)(d)?{operator:e[i],value:d.map((e=>({type:"exact",value:e.attributes.option})))}:{operator:e.empty}}}if("property-multi-select"===r){const e={empty:s?"is_not_empty":"is_empty",contains:s?"enum_does_not_contain":"enum_contains"};return{property:h,filter:(0,u.Of)(d)?{operator:e[i],value:d.map((e=>({type:"exact",value:e.attributes.option})))}:{operator:e.empty}}}if("property-status"===r){const e={empty:s?"is_not_empty":"is_empty",is:s?"status_is_not":"status_is"};return{property:h,filter:(0,u.Of)(d)?{operator:e[i],value:d.map((e=>"option-category"===e.tagName?{type:"is_group",value:e.attributes.category}:"option"===e.tagName?{type:"is_option",value:e.attributes.option}:(0,u.t1)(e)))}:{operator:e.empty}}}if("property-number"===r){const e={empty:s?"is_not_empty":"is_empty",is:s?"number_does_not_equal":"number_equals",">":s?"number_less_than_or_equal_to":"number_greater_than","<":s?"number_greater_than_or_equal_to":"number_less_than","â‰¥":s?"number_less_than":"number_greater_than_or_equal_to","â‰¤":s?"number_greater_than":"number_less_than_or_equal_to"};if("is empty"===i)return{property:h,filter:{operator:e.empty}};const t=o[h];if(!t||"number"!==t.type)throw new Error("Invalid property type");const n=a.p3(c.number);if("number"!=typeof n)throw new Error("Invalid number");const r={property:h,filter:{operator:e[i],value:{type:"exact",value:n}}},l={property:h,filter:{operator:"is_empty"}};return!s||">"!==i&&"<"!==i&&"â‰¥"!==i&&"â‰¤"!==i?r:{operator:"or",filters:[r,l]}}(0,u.t1)(r)}({filter:e,schema:o,idMapper:n}):void(0,u.t1)(t)}))}}function b(e){const{collectionSchema:t,aggregationRequest:o}=e;if(!o)return;const n=Object.entries(t).find((e=>{let[,t]=e;return t&&t.name===o.attributes.name}));if(!n)return;const r=n[0];return"aggregation-property-status"===o.tagName?{property:r,aggregator:"Count per group"===o.attributes.aggregation||"Percent per group"===o.attributes.aggregation?{operator:g.CC[o.attributes.aggregation],groupName:o.attributes.group}:g.CC[o.attributes.aggregation]}:{property:r,aggregator:g.CC[o.attributes.aggregation]}}function S(e){return e.split("/")[0]}const _=(0,u.AO)((e=>"updatedPage"===e.type?{true:e}:{false:e}));function w(e){const t=[];for(const o of e)if("createBlock"===o.command||"insertBlockAfter"===o.command||"insertBlockBefore"===o.command){const e="createBlock"===o.command?o.blockNode:o.insertBlockNode,n=[];for(const t of e.children)n.push(t.attributes.id);const r=Object.values(e.properties).filter((e=>"property-title"!==e.tagName)).map((e=>e.attributes.name));if(I(e)){const o=t.find((t=>"updatedPage"===t.type&&t.pageId===e.attributes.id));if(o){o.didCreatePage=!0;for(const e of n)o.insertedBlockIds.add(e);for(const e of r)o.updatedPropertyNames.add(e)}else t.push({type:"updatedPage",pageId:e.attributes.id,didCreatePage:!0,updatedTitle:!1,updatedPropertyNames:new Set(r),insertedBlockIds:new Set(n),updatedBlockIds:new Set,removedBlockIds:new Set})}else{const o=x(e);if(!o)throw new Error(`No ancestor page found for block: ${e.attributes.id}`);const n=t.find((e=>"updatedPage"===e.type&&e.pageId===o.attributes.id));n?n.insertedBlockIds.add(e.attributes.id):t.push({type:"updatedPage",pageId:o.attributes.id,didCreatePage:!1,updatedTitle:!1,updatedPropertyNames:new Set,insertedBlockIds:new Set([e.attributes.id]),updatedBlockIds:new Set,removedBlockIds:new Set})}}else if("setBlockParent"===o.command){const e=t.filter(_).find((e=>e.pageId===o.blockNode.attributes.id));e?e.parentId=o.parentId:t.push({type:"updatedPage",pageId:o.blockNode.attributes.id,didCreatePage:!1,updatedTitle:!1,updatedPropertyNames:new Set,insertedBlockIds:new Set,updatedBlockIds:new Set,removedBlockIds:new Set})}else if("removeBlock"===o.command)if(I(o.removeBlockNode)){t.find((e=>"removedPage"===e.type&&e.pageId===o.removeBlockNode.attributes.id))||t.push({type:"removedPage",pageId:o.removeBlockNode.attributes.id})}else{const e=x(o.removeBlockNode);if(!e)throw new Error(`No ancestor page found for block: ${o.removeBlockNode.attributes.id}`);const n=t.find((t=>"updatedPage"===t.type&&t.pageId===e.attributes.id));n?n.removedBlockIds.add(o.removeBlockNode.attributes.id):t.push({type:"updatedPage",pageId:e.attributes.id,didCreatePage:!1,updatedTitle:!1,updatedPropertyNames:new Set,insertedBlockIds:new Set,updatedBlockIds:new Set,removedBlockIds:new Set([o.removeBlockNode.attributes.id])})}else if("setBlockAttribute"===o.command||"setBlockTagName"===o.command||"setBlockText"===o.command||"setBlockProperty"===o.command||"insertOrMoveTableColumns"===o.command||"removeTableColumn"===o.command)if(I(o.blockNode)){const e=t.find((e=>"updatedPage"===e.type&&e.pageId===o.blockNode.attributes.id)),n="setBlockText"===o.command,r="setBlockProperty"===o.command?o.property.attributes.name:void 0;e?(n&&(e.updatedTitle=!0),r&&e.updatedPropertyNames.add(r)):t.push({type:"updatedPage",pageId:S(o.blockNode.attributes.id),didCreatePage:!1,updatedTitle:n,updatedPropertyNames:r?new Set([r]):new Set,insertedBlockIds:new Set,updatedBlockIds:new Set,removedBlockIds:new Set})}else{const e=x(o.blockNode);if(!e)throw new Error(`No ancestor page found for block: ${o.blockNode.attributes.id}`);const n=t.find((t=>"updatedPage"===t.type&&t.pageId===e.attributes.id));n?n.updatedBlockIds.add(o.blockNode.attributes.id):t.push({type:"updatedPage",pageId:e.attributes.id,didCreatePage:!1,updatedTitle:!1,updatedPropertyNames:new Set,insertedBlockIds:new Set,updatedBlockIds:new Set([o.blockNode.attributes.id]),removedBlockIds:new Set})}else(0,u.t1)(o);return t}const k={checked:e=>({properties:{checked:"true"===e?r.cd:void 0}}),color:e=>{if(!e)return{};const t=g.dn[e];if(!t)throw new Error(`Unrecognized assistant color: ${e}`);return{format:{block_color:t}}},"synced-block-id":(e,t)=>{let{spaceId:o}=t;return e?{format:{transclusion_reference_pointer:{id:e,table:d.iU,spaceId:o}}}:{}}};function x(e){let t=e;for(;t;){if(I(t))return t;t=t.parent}}function I(e){return"page"===e.tagName||"database"===e.tagName||"child-page"===e.tagName||"child-database"===e.tagName}},50715:(e,t,o)=>{o.d(t,{AO:()=>s,Yd:()=>r,kI:()=>a,qg:()=>n,t1:()=>i});o(21703);const n=(e,t)=>t in e,r=Object.keys;Object.entries;function i(e){throw new Error(`Expected value to never occur: ${JSON.stringify(e)}`)}const a=(e,t)=>e.includes(t),s=e=>t=>"true"in e(t)},25211:(e,t,o)=>{o.d(t,{$1:()=>l,A3:()=>s,J:()=>a,VZ:()=>i});o(57658);var n=o(95940),r=o(50715);function i(e){return e.replace(/<think>[\s\S]*?<\/think>/g,"")}function a(e){const t=/<think>([\s\S]*?)<\/think>/g;let o;const n=[];for(;null!==(o=t.exec(e));)n.push(o[1]);return n.join("\n")}function s(e){return"text"===e.type||("inline"===e.type?(0,r.kI)(n.zh,e.tagName):void(0,r.t1)(e))}function l(e){const t=[];for(const o of e.children)t.push(o),t.push(...l(o));return t}},24993:(e,t,o)=>{o.d(t,{BO:()=>F,Cr:()=>B,EK:()=>C,IT:()=>I,Yt:()=>R,gu:()=>M});o(21703),o(57658);var n=o(30120),r=o(17215),i=o(41432),a=o(99036),s=o(80951),l=o(6695),c=o(38297),d=o(42875),p=o(72126),u=o(59753),m=o(32056),g=o(71644),h=o(45953),f=o(21202),y=o(6287),v=o(19889),b=o(70203),S=o(97880),_=o(63143),w=o(46964),k=o(189),x=o(95940);async function I(e){const{pointer:t,intl:o}=e,n=await M({pointer:t,loadRecordModel:"loadRecordValue"in e?u.s8.fromLoadRecordValueFn(e.loadRecordValue):e.loadRecordModel,rootPointer:t,parentPointer:void 0,intl:o});if(!n)throw new Error("Failed to build XML node");return n}async function C(e){const{intl:t,textValue:o,allowsText:n,allowedTagNames:a,loadRecordModel:s}=e,l=[],c=h.Ak.create(),d=b.lzi(o).flatMap((e=>b.hDy(e)));await Promise.all(d.map((async e=>{if(b.STW(e)){const t={table:f.iU,id:b.TOT(e)},o=await s(t);c.setModel(t,o);const n=null==o?void 0:o.getCollectionPointer();n&&c.setModel(n,await s(n))}else if(b.IWo(e)){const t={table:v.KJ,id:b.zEN(e)};c.setModel(t,await s(t))}})));const p=u.om.fromRecordMap(c);for(const u of b.lzi(o)){let e=l,o=!1;const s=b.hDy(u);for(const n of s){b.ZAl(n)&&(o=!0);const s=b.J7s(n),l=O[s];if(!(0,S.DE)(a,l))continue;let c;if("a"===l){if(!b.j0F(n))throw new Error("Unexpected annotation for link annotation");c={type:"inline",tagName:l,attributes:{href:b.zW$(n)},children:[]}}else if("mention-page"===l){var m;if(!b.STW(n))throw new Error("Unexpected annotation for page annotation");const e=b.TOT(n),o=p({table:f.iU,id:e}),a=null==o?void 0:o.getCollectionPointer(),s=o?a&&(null===(m=p(a))||void 0===m?void 0:m.getName())||(null==o?void 0:o.getProperty("title")):b.TPx(r.x(t)),d=[{type:"text",value:(0,w.Jo)(b.QaF(s))}];c=o&&(0,i.dM)(o.type)?{type:"inline",tagName:"mention-database",attributes:{"database-id":e},children:d}:{type:"inline",tagName:l,attributes:{"page-id":e},children:d}}else if("mention-person"===l){if(!b.IWo(n))throw new Error("Unexpected annotation for user annotation");const e=b.zEN(n),o=p({table:v.KJ,id:e});c={type:"inline",tagName:l,attributes:{"person-id":e,"person-name":null==o?void 0:o.getDisplayName(t)},children:[]}}else if("mention-date"===l){if(!b.fpG(n))throw new Error("Unexpected annotation for date annotation");const e=b.zyO(n);let t,o;"date"===e.type?(t="mention-date",o={date:e.start_date}):"datetime"===e.type?(t="mention-datetime",o={date:e.start_date,time:e.start_time}):"daterange"===e.type?(t="mention-date-range",o={"start-date":e.start_date,"end-date":e.end_date}):(t="mention-datetime-range",o={"start-date":e.start_date,"start-time":e.start_time,"end-date":e.end_date,"end-time":e.end_time}),c={type:"inline",tagName:t,attributes:o,children:[]}}else if("h"===l){if(!b.LAI(n))throw new Error("Unexpected annotation for highlight annotation");c={type:"inline",tagName:l,attributes:{color:x.eT[b.zIN(n)]},children:[]}}else c={type:"inline",tagName:l,attributes:{},children:[]};e.push(c),e=c.children}if(!o&&n){const t=b.WiV(u);e.push({type:"text",value:(0,w.Jo)(t)})}}return l}function T(e){const{tagName:t,blockId:o,schemaId:n,attributes:r}=e;return(0,x.x)(t),{type:"block",tagName:t,text:[],attributes:{id:o,...r},properties:{},schemas:{},children:[],parent:void 0,persisted:!0,schemaId:n}}async function M(e){const{pointer:t,loadRecordModel:o,rootPointer:n,parentPointer:r,intl:a}=e,s=await o(t);if(!s)return;if(!function(e){const t=E[e];return(0,S.qg)(x.pX,t)}(s.type))return;const l=t.table===n.table&&t.id===n.id&&t.spaceId===n.spaceId;let d,p=t;const u=(null==r?void 0:r.id)??n.id;if(s.isType(i.Ti.page)){var m;const e=null===(m=await(0,c.Rd)({block:s,loadRecordModel:o}))||void 0===m?void 0:m.getParentId();if(l){const t=await(0,c.Rd)({block:s,loadRecordModel:o});let n;n=t&&t.parent_table!==y.v?t.parent_id:s.id,d=T({tagName:E[s.type],blockId:s.id,attributes:e?{"database-id":e}:{},schemaId:n})}else d=T({tagName:"child-page",blockId:`${s.id}/${(null==r?void 0:r.id)||n.id}`,attributes:{"page-id":s.id,"database-id":e},schemaId:u});await A({node:d,block:s,loadRecordModel:o,intl:a})}else if(s.type===i.Ti.collectionView||s.type===i.Ti.collectionViewPage){const e=s.id;d=T(l?{tagName:E[s.type],blockId:s.id,schemaId:e,attributes:{}}:{tagName:"child-database",blockId:`${s.id}/${(null==r?void 0:r.id)||n.id}`,schemaId:e,attributes:{"database-id":s.id}}),await A({node:d,block:s,loadRecordModel:o,intl:a})}else if(s.type===i.Ti.alias){const e=s.getFormatValue("alias_pointer");if(!e||e.table!==f.iU)return;const t=await o(e);if(!t)return;if(t.type===i.Ti.collectionView||t.type===i.Ti.collectionViewPage)d=T({tagName:"link-database",blockId:s.id,schemaId:u,attributes:{"database-id":t.id}});else{var g;const e=null===(g=await(0,c.Rd)({block:s,loadRecordModel:o}))||void 0===g?void 0:g.getParentId();d=T({tagName:"link-page",blockId:s.id,schemaId:u,attributes:{"page-id":t.id,...e?{"database-id":e}:{}}})}await A({node:d,block:t,loadRecordModel:o,intl:a})}else if(s.type===i.Ti.table){const e=s.getFormatValue("table_block_row_header"),t=s.getFormatValue("table_block_column_header");d=T({tagName:E[s.type],blockId:s.id,schemaId:u,attributes:{...e?{"header-row":"true"}:{},...t?{"header-column":"true"}:{}}})}else if(s.type===i.Ti.tableRow){if(s.parent_table!==f.iU)return;const e=await o({table:s.parent_table,id:s.parent_id,spaceId:s.space_id});if(!e||e.type!==i.Ti.table)return;d=T({tagName:E[s.type],blockId:s.id,schemaId:u,attributes:{}});const t=e.getFormatValue("table_block_column_order")||[];for(const n of t){const e=(t.indexOf(n)+1).toString(),r={type:"property",tagName:"property-text",attributes:{name:e},children:await C({textValue:s.getProperty(n),allowsText:x.ZK["property-text"].text,allowedTagNames:x.ZK["property-text"].inline,loadRecordModel:o,intl:a})};d.properties[e]=r}}else if(s.isType(i.Ti.transclusionReference)){const e=s.getTransclusionReferenceTargetPointer();if(!e)return;d=T({tagName:E[s.type],blockId:s.id,schemaId:u,attributes:{"synced-block-id":e.id}}),p=e}else d=T({tagName:E[s.type],blockId:s.id,schemaId:u,attributes:{}}),await A({block:s,node:d,loadRecordModel:o,intl:a});if((0,S.DE)(x.v,d.tagName)){const e=s.getFormatValue("block_color");e&&(d.attributes.color=x.eT[e])}if(l||!(0,i.S9)(s.type)){let e;if(s.isType(i.Ti.transclusionReference)){e=[];const t=s.getTransclusionReferenceTargetPointer();if(t){const n=await o(t);n&&(e=n.getRenderableContentIds())}}else e=s.getRenderableContentIds();const t=(await Promise.all(e.map((e=>M({pointer:{table:"block",id:e},loadRecordModel:o,rootPointer:n,parentPointer:p,intl:a}))))).filter(S.$K);d.children.push(...t)}return d}function P(e){const t=e.getNormalizedSchema(),o=["title",...(l.iB(e.getFormat()||{},t,void 0,l.j5.Page).collection_page_properties||[]).map((e=>{let{property:t}=e;return t}))];return Object.entries(t).sort(((e,t)=>{let[n]=e,[r]=t;return o.indexOf(n)-o.indexOf(r)}))}async function A(e){const{block:t,node:o,loadRecordModel:r,intl:l}=e,d=t.getCollectionPointer(),p=d&&await r(d);p&&await async function(e){let{collectionPointedTo:t,node:o,intl:n,loadRecordModel:r}=e;for(const[s,l]of P(t)){if(!(0,g.j5)(s)||!l)continue;const e=`schema-${N[l.type]}`;if((0,S.qg)(x.WC,e))switch(e){case"schema-property-title":case"schema-property-text":case"schema-property-url":case"schema-property-email":case"schema-property-phone-number":case"schema-property-checkbox":case"schema-property-created-time":case"schema-property-created-by":case"schema-property-last-edited-by":case"schema-property-last-edited-time":{const t={type:"schema",tagName:e,attributes:{name:l.name},children:[]};o.schemas[l.name]=t;break}case"schema-property-date":{const t={type:"schema",tagName:e,attributes:{name:l.name},children:[]};o.schemas[l.name]=t;break}case"schema-property-number":{if("number"!==l.type)throw new Error(`Unexpected property schema type ${l.type}`);const t={type:"schema",tagName:e,attributes:{name:l.name,format:l.number_format||"number"},children:[]};o.schemas[l.name]=t;break}case"schema-property-person":{if("person"!==l.type)throw new Error(`Unexpected property schema type ${l.type}`);const t=1===l.limit?"1":"Infinity",n={type:"schema",tagName:e,attributes:{name:l.name,limit:t},children:[]};o.schemas[l.name]=n;break}case"schema-property-multi-select":case"schema-property-select":{if("select"!==l.type&&"multi_select"!==l.type)throw new Error(`Unexpected property schema type ${l.type}`);const t={type:"schema",tagName:e,attributes:{name:l.name},children:(l.options||[]).map((e=>({type:"inline",tagName:"schema-option",attributes:{option:e.value},children:[]})))};o.schemas[l.name]=t;break}case"schema-property-relation":{var i;if("relation"!==l.type)throw new Error(`Unexpected property schema type ${l.type}`);const t=1===l.limit?"1":"Infinity",n=(0,a.F0)(l);if(!n)throw new Error("Cannot link to relation without table pointer");if(l.connectedRelation)break;const s=await r({id:n,table:y.v});if(!s)break;const c=s.getNormalizedSchema(),d=l.property&&(0,S.qg)(c,l.property)?(null===(i=c[l.property])||void 0===i?void 0:i.name)??void 0:void 0,p=s.parent_id,u={type:"schema",tagName:e,attributes:{name:l.name,limit:t,"database-id":p,"synced-property-name":d},children:[]};o.schemas[l.name]=u;break}case"schema-property-status":{if("status"!==l.type)throw new Error(`Unexpected property schema type ${l.type}`);const t={type:"schema",tagName:e,attributes:{name:l.name},children:(l.groups||[]).map((e=>({type:"inline",tagName:"schema-option-category",attributes:{category:e.name},children:(e.optionIds||[]).flatMap((e=>{var t;const o=null===(t=l.options)||void 0===t?void 0:t.find((t=>t.id===e));return o?{type:"inline",tagName:"schema-option",attributes:{option:o.value},children:[]}:[]}))})))};o.schemas[l.name]=t;break}default:(0,S.t1)(e)}}}({collectionPointedTo:p,node:o,intl:l,loadRecordModel:r});const h=await(0,c.Rd)({block:t,loadRecordModel:r}),f=h?P(h):(0,i.S9)(t.type)?(0,S.qP)({title:a.Kc(l).title}):void 0;if(f)await async function(e){let{propertySchemaByIdEntries:t,block:o,node:r,intl:i,collectionPointedTo:l,loadRecordModel:c}=e;const d=new Map;await Promise.all(t.map((async e=>{let[t,r]=e;if(!(0,g.j5)(t)||!r)return;const p=N[r.type];if(!(0,S.qg)(x.ZK,p))return;const h="title"===t&&(null==l?void 0:l.getName())||o.getProperty(t);switch(p){case"property-title":{const e={type:"property",tagName:p,attributes:{name:r.name},children:await C({textValue:h,allowsText:x.ZK[p].text,allowedTagNames:x.ZK[p].inline,loadRecordModel:c,intl:i})};d.set(t,e);break}case"property-text":{const e={type:"property",tagName:p,attributes:{name:r.name},children:await C({textValue:h,allowsText:x.ZK[p].text,allowedTagNames:x.ZK[p].inline,loadRecordModel:c,intl:i})};d.set(t,e);break}case"property-url":{const e={type:"property",tagName:p,attributes:{name:r.name},children:await C({textValue:s.iD(s.zB(h)),allowsText:x.ZK[p].text,allowedTagNames:x.ZK[p].inline,loadRecordModel:c,intl:i})};d.set(t,e);break}case"property-email":case"property-phone-number":{const e={type:"property",tagName:p,attributes:{name:r.name},children:await C({textValue:h,allowsText:x.ZK[p].text,allowedTagNames:x.ZK[p].inline,loadRecordModel:c,intl:i})};d.set(t,e);break}case"property-person":{const e=u.kk.fromBlock(o),n={type:"property",tagName:p,attributes:{name:r.name},children:await C({textValue:s.C1(s.DW({textValue:h,propertySchema:r,blockCreatorPointer:e.getCreatedByPointer()})),allowsText:x.ZK[p].text,allowedTagNames:x.ZK[p].inline,loadRecordModel:c,intl:i})};d.set(t,n);break}case"property-created-by":case"property-last-edited-by":{let e;e="property-created-by"===p?o.getCreatedByPointer():o.getLastEditedByPointer();const n={type:"property",tagName:p,attributes:{name:r.name},children:await C({textValue:s.C1(e?[e]:[]),allowsText:x.ZK[p].text,allowedTagNames:x.ZK[p].inline,loadRecordModel:c,intl:i})};d.set(t,n);break}case"property-relation":{if("relation"!==r.type)throw new Error("Invalid type for property-relation");const e=(0,a.F0)(r);if(!e)throw new Error("Invalid database id for property-relation");const o=await c({table:y.v,id:e});if(!o)break;if(r.connectedRelation)break;const n=o.parent_id,l=await s.Pd({relationValue:(0,s.rq)(h),loadRecordModel:c,limit:10,propertySchema:r}),u={type:"property",tagName:p,attributes:{name:r.name,"database-id":n},children:await C({textValue:(0,s.ow)(l),allowsText:x.ZK[p].text,allowedTagNames:x.ZK[p].inline,loadRecordModel:c,intl:i})};d.set(t,u);break}case"property-date":{const e={type:"property",tagName:p,attributes:{name:r.name},children:await C({textValue:h,allowsText:x.ZK[p].text,allowedTagNames:x.ZK[p].inline,loadRecordModel:c,intl:i})};d.set(t,e);break}case"property-created-time":case"property-last-edited-time":{const e=n.ou.fromMillis(o[j[p]]),a={type:"property",tagName:p,attributes:{name:r.name},children:await C({textValue:s.d7({type:"datetime",start_date:e.toISODate(),start_time:e.toFormat("HH:mm"),time_zone:"UTC"}),allowsText:x.ZK[p].text,allowedTagNames:x.ZK[p].inline,loadRecordModel:c,intl:i})};d.set(t,a);break}case"property-checkbox":{const e={type:"property",tagName:p,attributes:{name:r.name,checked:s.Ml(h)?"true":"false"},children:await C({textValue:h,allowsText:x.ZK[p].text,allowedTagNames:x.ZK[p].inline,loadRecordModel:c,intl:i})};d.set(t,e);break}case"property-select":case"property-multi-select":case"property-status":{let e;if("select"===r.type){const t=s.Sj(h,r.options||[]);e=void 0!==t?[t]:[]}else if("multi_select"===r.type)e=s.uP(h,r.options||[]);else{if("status"!==r.type)throw new Error("Unexpected property schema type");{const t=s.ZG(h,r);e=void 0!==t?[t]:[]}}const o={type:"property",tagName:p,attributes:{name:r.name},children:e.map((e=>({type:"inline",tagName:"option",attributes:{option:e},children:[]})))};d.set(t,o);break}case"property-number":{if("number"!==r.type)throw new Error("Unexpected property schema type");const e=m.uf(s.VY(h),r.number_format,i),o={type:"property",tagName:p,attributes:{name:r.name,number:e},children:await C({textValue:h,allowsText:x.ZK[p].text,allowedTagNames:x.ZK[p].inline,loadRecordModel:c,intl:i})};d.set(t,o);break}default:(0,S.t1)(p)}})));for(const[n,a]of t){if(!a)continue;const e=d.get(n);e&&(r.properties[a.name]=e)}}({propertySchemaByIdEntries:f,block:t,node:o,intl:l,loadRecordModel:r,collectionPointedTo:p});else for(const n of a.qF){const e=t.getProperty(n);if(e)if("title"===n)o.text.push(...await C({textValue:e,allowsText:!0,allowedTagNames:(0,S.Yd)(x.t),loadRecordModel:r,intl:l}));else{const t=D(n,e);t&&(o.attributes[n]=t)}}}function D(e,t){if("checked"===e)return b.QaF(t)===a.bx?"true":"false"}function B(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{pageIdOrder:t}=e,o=new Map;if((0,S.$K)(t))for(let n=0;n<t.length;n++)o.set(t[n],n+1);return e=>{const t=o.get(e);if((0,S.$K)(t))return t;const n=[...o.values()],r=n.length>0?Math.max(...n)+1:1;return o.set(e,r),r}}function R(e){if("text"===e.type){const{nodes:t,getCitationNumberForPage:o}=e,n=t.flatMap((e=>{if("inline"===e.type){const t=function(e){if("mention-date"===e||"mention-datetime"===e||"mention-date-range"===e||"mention-datetime-range"===e)return"d";if("mention-database"===e)return"p";return V[e]}(e.tagName);if(!t)throw new Error(`Unknown inline element: ${e.tagName}`);const n=e.children;let r;if((0,S.qg)(L,t)){const o={node:e};r=L[t](o)}else{if(!Z(t))throw new Error(`Unsupported annotation type: ${t}`);r=[t]}const i=R({type:"text",nodes:n})||[];if(b.ZAl(r))return[b.V3y(b.qyI,[r])];if(b.j0F(r)&&(0,S.$K)(r[1])&&(0,S.$K)(o)&&0===b.VrM(i)){const e=k.Tc.hrefToBlockId(b.zW$(r));if(e){const t=o(e);return[b.YCD(b.hNu({href:r[1],number:t,blockId:e}))]}}return i.map((e=>b.V3y(b.WiV(e),[r,...b.hDy(e)])))}if("text"===e.type)return[b.V3y(e.value,[])];(0,S.t1)(e)}));return b.Zxt(n)}{const{property:t,nodes:o}=e;if("property-title"===t.tagName||"property-text"===t.tagName||"property-url"===t.tagName||"property-email"===t.tagName||"property-phone-number"===t.tagName)return R({type:"text",nodes:o});if("property-person"===t.tagName){const e=p.oA(o.map((e=>"inline"===e.type&&"mention-person"===e.tagName?e.attributes["person-id"]:void 0)));return s.C1(e.map((e=>({table:v.KJ,id:e}))))}if("property-relation"===t.tagName){const e=p.oA(o.map((e=>{if("inline"===e.type&&"mention-page"===e.tagName)return e.attributes["page-id"]})));return(0,s.ow)(e.map((e=>({table:f.iU,id:e}))))}if("property-date"===t.tagName){if(1!==o.length)throw new Error("Date property XML definition is invalid - should only have 1 mention");const e=o[0];if("inline"!==e.type)throw new Error("Date property XML definition should only have inline children");if("mention-date"===e.tagName)return s.d7({type:"date",start_date:e.attributes.date});if("mention-date-range"===e.tagName)return s.d7({type:"daterange",start_date:e.attributes["start-date"],end_date:e.attributes["end-date"]});if("mention-datetime"===e.tagName)return s.d7({type:"datetime",start_date:e.attributes.date,start_time:e.attributes.time,time_zone:null});if("mention-datetime-range"===e.tagName)return s.d7({type:"datetimerange",start_date:e.attributes["start-date"],end_date:e.attributes["end-date"],start_time:e.attributes["start-time"],end_time:e.attributes["end-time"],time_zone:null});throw new Error("Date property XML mention option is invalid")}if("property-checkbox"===t.tagName)return"true"===t.attributes.checked?a.cd:a.XT;if("property-select"===t.tagName||"property-status"===t.tagName){const e=p.oA(o.map((e=>"inline"===e.type&&"option"===e.tagName?e.attributes.option:void 0)))[0];return s.O2(e)}if("property-multi-select"===t.tagName){const e=p.oA(o.map((e=>"inline"===e.type&&"option"===e.tagName?e.attributes.option:void 0)));return s.zq(e)}if("property-number"===t.tagName){const e=t.attributes.number,o=e?m.p3(e):void 0;return s.eP(o)}if("property-created-time"===t.tagName||"property-last-edited-time"===t.tagName||"property-created-by"===t.tagName||"property-last-edited-by"===t.tagName)throw new Error(`You should not manually edit metadata of type ${t.tagName}.`);(0,S.t1)(t)}}const E={text:"text",page:"page",bulleted_list:"uli",numbered_list:"oli",toggle:"toggle",quote:"quote",factory:"factory",button:"button",to_do:"todo",column_list:"columns",column:"column",embed:"embed",framer:"embed",tweet:"embed",gist:"embed",drive:"embed",figma:"embed",loom:"embed",typeform:"embed",codepen:"embed",audio:"embed",maps:"embed",invision:"embed",image:"embed",pdf:"embed",video:"embed",file:"embed",bookmark:"embed",equation:"math-block",code:"code-block",header:"h1",sub_header:"h2",sub_sub_header:"h3",collection_view:"database",collection_view_page:"database",breadcrumb:"breadcrumb",copy_indicator:"copy_indicator",link_to_page:"link_to_page",link_to_collection:"link_to_collection",alias:"link-page",transclusion_container:"synced-block",transclusion_reference:"synced-block-reference",divider:"hr",callout:"callout",table_of_contents:"tableofcontents",whimsical:"embed",miro:"embed",abstract:"embed",sketch:"embed",excalidraw:"embed",replit:"embed",hex:"embed",deepnote:"embed",mixpanel:"embed",external_object_instance:"embed",external_object_instance_page:"embed",table:"table",table_row:"tr",tab:"tab",ai_block:"ai-block",drawing:"drawing",personal_home_page:"personalhomepage"},F={...(0,_.m8)((0,S.qP)(E).map((e=>{let[t,o]=e;return[o,t]}))),"child-page":"page","child-database":"page","link-page":"alias","link-database":"alias"},N={title:"property-title",text:"property-text",url:"property-url",email:"property-email",phone_number:"property-phone-number",checkbox:"property-checkbox",person:"property-person",created_by:"property-created-by",last_edited_by:"property-last-edited-by",file:"property-file",select:"property-select",multi_select:"property-multi-select",status:"property-status",number:"property-number",date:"property-date",created_time:"property-created-time",last_edited_time:"property-last-edited-time",last_visited_time:"property-last-visited-time",formula:"property-formula",rollup:"property-rollup",button:"property-button",auto_increment_id:"property-id",location:"property-location",verification:"property-verification",relation:"property-relation"},j=p.U_(N),O={b:"b",i:"i",s:"s",c:"code","~":"~",_:"u","+":"+","-":"-",z:"z",u:"mention-person",r:"r",p:"mention-page",pt:"pt",d:"mention-date",eoi:"eoi",tv:"tv",cm:"cm",m:"m",a:"a",h:"h",e:"e",et:"et",xt:"xt",st:"st",fpp:"fpp",fv:"fv",g:"group",mark:"find-highlight",ci:"ci"},L={u:e=>{let{node:t}=e;if(!t.attributes["person-id"])throw new Error(`Missing attribute person-id for inline element ${t.tagName}`);return["u",t.attributes["person-id"]]},p:e=>{let{node:t}=e;if(!t.attributes["page-id"])throw new Error(`Missing attribute page-id for inline element ${t.tagName}`);return["p",t.attributes["page-id"]]},d:e=>{let{node:t}=e;return"mention-date-range"===t.tagName?["d",{start_date:t.attributes["start-date"],end_date:t.attributes["end-date"],type:"daterange"}]:"mention-date"===t.tagName?["d",{start_date:t.attributes.date,type:"date"}]:"mention-datetime"===t.tagName?["d",{start_date:t.attributes.date,start_time:t.attributes.time,time_zone:(0,d.r)(),type:"datetime"}]:"mention-datetime-range"===t.tagName?["d",{start_date:t.attributes["start-date"],start_time:t.attributes["start-time"],end_date:t.attributes["end-date"],end_time:t.attributes["end-time"],time_zone:(0,d.r)(),type:"datetimerange"}]:void(0,S.t1)(t)},a:e=>{let{node:t}=e;if(!t.attributes.href)throw new Error(`Missing attribute href for inline element ${t.tagName}`);return["a",t.attributes.href]},h:e=>{let{node:t}=e;if(!t.attributes.color)throw new Error(`Missing color attribute for inline element ${t.tagName}`);if(!x.yD.includes(t.attributes.color))throw new Error(`Bad color attribute for inline element: ${t.attributes.color}`);return["h",x.dn[t.attributes.color]]}},U={[b.GKr.Bold]:!0,[b.GKr.Italic]:!0,[b.GKr.Strike]:!0,[b.GKr.Code]:!0,[b.GKr.FormulaError]:!0,[b.GKr.Underline]:!0,[b.GKr.Inserted]:!0,[b.GKr.Deleted]:!0,[b.GKr.TemporaryComment]:!0,[b.GKr.TemporaryPage]:!0,[b.GKr.TemporaryEquation]:!0,[b.GKr.TemporarySelection]:!0,[b.GKr.TemporaryFindHighlight]:!0},Z=(0,S.AO)((e=>(0,S.qg)(U,e)?{true:e}:{false:e})),V=(0,_.Jd)(O)},39040:(e,t,o)=>{o.d(t,{P:()=>r});var n=o(90698);function r(e){return(0,n.parse)(e).childNodes.map(i)}function i(e){return e.nodeType===n.NodeType.TEXT_NODE?{type:"text",value:e.textContent}:{type:"element",tagName:e.tagName.toLowerCase(),attributes:e.attributes,children:e.childNodes.map(i)}}},31734:(e,t,o)=>{o.d(t,{Y:()=>v,a:()=>y});o(57658);var n=o(72126),r=o(80),i=o(149),a=o(97880),s=o(22828),l=o(189),c=o(95940),d=o(90629),p=o(88974),u=o(35746),m=o(33925),g=o(84112);function h(e){const t=(0,a.Xc)(c.pX,((o,n)=>function(e,t,o){const n=c.pX[e],{allowMove:h,persisted:y}=t;let v=(0,g.hc)(e);return"page"===e&&(v=r.p.choice([v,(0,g.hc)("instructions-page")])),r.p.mapResult(v,(v=>{const b=(0,g.jg)({inputAttributes:v.attributes,definitions:{...n.attributes,id:{required:!1,values:!0}},tagName:e,validateRequiredAttributes:!1});if(i.x.isFail(b))return b;if("synced-block-reference"===e&&!y&&v.children&&v.children.length>0)return{error:new s.kj};let S;if(t.persisted){if(!b.value.id)return{error:new s.OX};if(!(0,l.oU)(b.value.id))return{error:new s.WH(b.value.id)};S=b.value.id}else{if(b.value.id)return{error:new s.EO};S=t.allocateIdFn()}const _=[];n.title&&_.push((0,d.I8)({inlineNodesAllowed:c.B5,textAllowed:!0,parentTagName:e}));const w=n.schemas.map((e=>`schema-${e}`));_.push(...(0,a.qP)(m.m).filter((e=>{let[t]=e;return w.includes(t)})).map((e=>{let[,t]=e;return t}))),_.push(h?p.U:f);const k=[...n.properties];_.push(...(0,a.qP)(u.l).filter((e=>{let[t]=e;return(0,a.DE)(k,t)})).map((e=>{let[,t]=e;return t})));for(const e of n.content)_.push(o(e));const x=(0,r.w6)((0,g.Lf)(e,_),v.children??[]);if(i.x.isFail(x))return x;const I=(0,g._e)([["inline or text node",(0,a.AO)((e=>"text"===e.type||"inline"===e.type?{true:e}:{false:e}))],["property node",(0,a.AO)((e=>"property"===e.type?{true:e}:{false:e}))],["schema node",(0,a.AO)((e=>"schema"===e.type?{true:e}:{false:e}))],["block node",(0,a.AO)((e=>"block"===e.type||"move"===e.type?{true:e}:{false:e}))]],x.value);if(i.x.isFail(I))return{error:new s.DY({foundNodeType:I.error.incorrectLabel,incorrectlyAfterType:I.error.lastLabel})};const[C,T,M,P]=I.value;return{value:{type:"block",tagName:e,attributes:{...b.value,id:S},persisted:y,text:C,children:P,properties:Object.fromEntries(T.map((e=>[e.attributes.name,e]))),schemas:Object.fromEntries(M.map((e=>[e.attributes.name,e])))}}}))}(n,e,(e=>t[e]))));return t}const f=r.p.mapResult((0,g.hc)("move"),(()=>({error:new s.Db}))),y=e=>r.p.choice([...Object.values(h(e)),...e.allowMove?[]:[f],r.p.fail((e=>new s.vQ({nodeType:"block",unexpectedNode:n.Ps(e)})))]),v=e=>r.p.choice([...Object.values(h(e)),p.U,r.p.fail((e=>new s.vQ({nodeType:"block",unexpectedNode:n.Ps(e)})))])},90629:(e,t,o)=>{o.d(t,{I8:()=>u});o(57658),o(21703);var n=o(72126),r=o(80),i=o(149),a=o(97880),s=o(22828),l=o(95940),c=o(84112);const d=r.p.map(c.oT,(e=>({type:"text",value:e.value})));const p=(0,a.Xc)(l.t,((e,t)=>function(e){const t=l.t[e];return r.p.mapResult((0,c.hc)(e),(o=>{const n=(0,c.jg)({inputAttributes:o.attributes,definitions:t.attributes,tagName:e});if(i.x.isFail(n))return n;const a=(0,r.w6)(r.p.manyTill(u({inlineNodesAllowed:t.inline,textAllowed:t.text,parentTagName:e}),r.p.eof()),o.children??[]);if(i.x.isFail(a))return a;const s=a.value;return{value:{type:"inline",tagName:e,attributes:n.value,children:s}}}))}(t)));r.p.choice([...Object.values(p),r.p.fail((e=>new s.vQ({nodeType:"inline",unexpectedNode:n.Ps(e)})))]);function u(e){const{inlineNodesAllowed:t,textAllowed:o,parentTagName:n}=e,i=[...t],l=[];for(const[r,s]of(0,a.qP)(p))(0,a.DE)(i,r)&&l.push(s);return r.p.choice([...l,...o?[d]:[],r.p.fail((e=>e.length>0?new s.d4({tagName:n,unexpectedNode:e[0]}):new Error("No inline or text node")))])}},88974:(e,t,o)=>{o.d(t,{U:()=>i,x:()=>a});var n=o(80),r=o(84112);const i=n.p.map((0,r.MD)({tagName:"move",attributeDefinitions:{id:{required:!0,values:!0}}}),(e=>{let{attributes:t}=e;return{type:"move",tagName:"move",attributes:t,children:[]}})),a=n.p.map((0,r.MD)({tagName:"move",attributeDefinitions:{id:{required:!0,values:!0},name:{required:!0,values:!0}}}),(e=>{let{attributes:t}=e;return{type:"move",tagName:"move",attributes:t,children:[]}}))},35746:(e,t,o)=>{o.d(t,{R:()=>u,l:()=>p});var n=o(72126),r=o(80),i=o(149),a=o(97880),s=o(22828),l=o(95940),c=o(90629),d=o(84112);const p=(0,a.Xc)(l.ZK,((e,t)=>function(e){const t=l.ZK[e];return r.p.mapResult((0,d.hc)(e),(o=>{const n=(0,d.jg)({inputAttributes:o.attributes,definitions:{...t.attributes,name:{required:!0,values:!0}},tagName:e});if(i.x.isFail(n))return n;const a=(0,r.w6)(r.p.manyTill((0,c.I8)({inlineNodesAllowed:t.inline,textAllowed:t.text,parentTagName:e}),r.p.eof()),o.children??[]);if(i.x.isFail(a))return a;const s=a.value;return{value:{type:"property",tagName:e,attributes:n.value,children:s}}}))}(t))),u=r.p.choice([...Object.values(p),r.p.fail((e=>new s.vQ({nodeType:"property",unexpectedNode:n.Ps(e)})))])},33925:(e,t,o)=>{o.d(t,{m:()=>p});var n=o(72126),r=o(80),i=o(149),a=o(97880),s=o(22828),l=o(95940),c=o(90629),d=o(84112);const p=(0,a.Xc)(l.WC,((e,t)=>function(e){const t=l.WC[e];return r.p.mapResult((0,d.hc)(e),(o=>{const n=(0,d.jg)({inputAttributes:o.attributes,definitions:{...t.attributes,name:{required:!0,values:!0}},tagName:e});if(i.x.isFail(n))return n;const a=(0,r.w6)(r.p.manyTill((0,c.I8)({inlineNodesAllowed:t.inline,textAllowed:!1,parentTagName:e}),r.p.eof()),o.children??[]);if(i.x.isFail(a))return a;const s=a.value;return{value:{type:"schema",tagName:e,attributes:n.value,children:s}}}))}(t)));r.p.choice([...Object.values(p),r.p.fail((e=>new s.vQ({nodeType:"schema",unexpectedNode:n.Ps(e)})))])},84112:(e,t,o)=>{o.d(t,{Lf:()=>g,MD:()=>f,_e:()=>m,hc:()=>d,jg:()=>u,oT:()=>p,xB:()=>h});o(21703),o(57658),o(52262);var n=o(72126),r=o(80),i=o(149),a=o(97880),s=o(22828),l=o(189);const c=r.p.satisfy((0,a.AO)((e=>"element"===e.type?{true:e}:{false:e}))),d=e=>r.p.describe(r.p.filter(c,(t=>t.tagName===e)),(()=>new s.B9(e))),p=r.p.satisfy((0,a.AO)((e=>"text"===e.type?{true:e}:{false:e})));function u(e){const{inputAttributes:t={},definitions:o,tagName:r,validateRequiredAttributes:i=!0}=e,c=Object.keys(t),d=Object.keys(o),p=n.e5(c,d);if(p.length>0)return{error:new s.JZ({attributeNames:p,tagName:r})};if(i)for(const[n,a]of Object.entries(o))if(a.required&&!c.includes(n))return{error:new s.FI({attributeName:n,tagName:r})};for(const[n,u]of Object.entries(t)){const e=o[n];if((0,a.$K)(e.mappingMode))if("counter"===e.mappingMode){if(!(0,l.oU)(u))return{error:new s.WH(u)}}else(0,a.t1)(e.mappingMode);if(!0!==e.values&&!e.values.includes(u))return{error:new s.eL({attributeName:n,receivedValue:u,tagName:r})}}return{value:t}}function m(e,t){if(0===e.length)throw new Error("Must provide at least 1 label and type guard");const o=[...e],n=[[]];for(const i of t){const[t,a]=o[0];if(!a(i)){for(;o.length>0;){o.shift();const e=o[0];if(n.push([]),e&&e[1](i))break}if(0===o.length){var r;const o=null===(r=e.find((e=>{let[,t]=e;return t(i)})))||void 0===r?void 0:r[0];if(!o)throw new Error(`Item did not match any type guards: ${JSON.stringify(i)}`);return{error:{incorrectLabel:o,lastLabel:t}}}}n.at(-1).push(i)}for(;n.length<e.length;)n.push([]);return{value:n}}function g(e,t){return r.p.manyTill(r.p.choice([...t,r.p.fail((t=>new s.d4({tagName:e,unexpectedNode:n.Ps(t)})))]),r.p.eof())}function h(e){return e.children&&e.children.length>0?{error:new s.d4({tagName:e.tagName,unexpectedNode:e.children[0]})}:{value:void 0}}function f(e){const{tagName:t,attributeDefinitions:o}=e;return r.p.mapResult(d(t),(e=>{const n=u({tagName:t,inputAttributes:e.attributes,definitions:o});if(i.x.isFail(n))return n;const r=h(e);return i.x.isFail(r)?r:{value:{attributes:n.value}}}))}},38823:(e,t,o)=>{o.d(t,{m:()=>r});var n=o(12174);class r{constructor(e){this.getEligibleGroup=void 0,this.isAiEnabledFn=void 0,this.getEligibleGroup=e.getEligibleGroup,this.isAiEnabledFn=e.isAiEnabled}isAiEnabled(){return this.isAiEnabledFn()}isAssistantEnabled(){return this.modeIsAtMost("development")}isQnAOnlyEnabled(){return this.isMode("canary")||this.isMode("alpha")||this.isMode("beta")}getMode(){return this.isAiEnabledFn()?this.getEligibleGroup("assistant_variant")??"control":"control"}isMode(e){return this.getMode()===e}modeIsAtMost(e){const t=["control",...n.KM],o=this.getMode();return t.indexOf(e)<=t.indexOf(o)}}},63362:(e,t,o)=>{function n(e,t){e.trackEvent({eventName:"automation_triggered",properties:t})}function r(e,t){e.trackEvent({eventName:"add_automation_step",properties:t})}function i(e,t){e.trackEvent({eventName:"delete_automation_step",properties:t})}function a(e,t){e.trackEvent({eventName:"click_configure_button",properties:t})}function s(e,t){e.trackEvent({eventName:"click_configure_button_done",properties:t})}function l(e,t){e.trackEvent({eventName:"click_automation_modal_option",properties:t})}function c(e,t){e.trackEvent({eventName:"automation_execution_success",properties:t})}function d(e,t){e.trackEvent({eventName:"automation_execution_fail",properties:t})}function p(e,t){e.trackEvent({eventName:"automation_create",properties:t})}function u(e,t){e.trackEvent({eventName:"automation_update",properties:t})}function m(e,t){e.trackEvent({eventName:"automation_delete",properties:t})}function g(e,t){e.trackEvent({eventName:"automation_enable",properties:t})}function h(e,t){e.trackEvent({eventName:"automation_disable",properties:t})}function f(e,t){e.trackEvent({eventName:"automation_trigger_create",properties:t})}function y(e,t){e.trackEvent({eventName:"automation_trigger_delete",properties:t})}function v(e,t){e.trackEvent({eventName:"automation_action_create",properties:t})}function b(e,t){e.trackEvent({eventName:"automation_action_delete",properties:t})}function S(e,t){e.trackEvent({eventName:"automation_configure_view",properties:t})}function _(e,t){e.trackEvent({eventName:"automation_configure_view",properties:t})}function w(e,t){e.trackEvent({eventName:"automation_learn_click",properties:t})}o.d(t,{A2:()=>v,By:()=>d,Cz:()=>c,Ey:()=>y,OK:()=>b,Rt:()=>g,T0:()=>p,W5:()=>l,ai:()=>h,co:()=>i,d:()=>_,eI:()=>r,lN:()=>s,nC:()=>S,nK:()=>f,qu:()=>w,r4:()=>u,rg:()=>n,uO:()=>m,yK:()=>a})},3865:(e,t,o)=>{o.d(t,{AQ:()=>x,SF:()=>S,TX:()=>R,Vd:()=>v,XO:()=>f,Ym:()=>M,_X:()=>P,bD:()=>D,cO:()=>_,g9:()=>w,gq:()=>h,n6:()=>C,nl:()=>y,rX:()=>T,vp:()=>I});o(57658);var n=o(5366),r=o(81730),i=o(23290),a=o(99036),s=o(6695),l=o(78106),c=o(76218),d=o(72126),p=o(482),u=o(149),m=o(97880);const g=(0,n.defineMessages)({slackAutomationDefaultName:{id:"automationStore.slackAutomation.defaultName",defaultMessage:"{hasCreatorName, select, true {{creatorName}'s notifications} other {Notifications}}"},automationDefaultName:{id:"automatonStore.automation.defaultName",defaultMessage:"{hasCreatorName, select, true {{creatorName}'s automation} other {Automation}}"}});function h(e,t){return e.formatMessage(g.slackAutomationDefaultName,{hasCreatorName:Boolean(t),creatorName:t})}function f(e,t){return e.formatMessage(g.automationDefaultName,{hasCreatorName:Boolean(t),creatorName:t})}function y(e){return"notification_event"===e.trigger.type}function v(e){return"event"===e.trigger.type}(0,m.AO)((e=>(0,m.$K)(e)&&(0,m.$K)(e.target)&&(0,m.$K)(e.external_bot_id)?{true:{external_bot_id:e.external_bot_id,target:e.target}}:{false:e}));const b={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function S(e){return Boolean(b[e.type]&&!(0,a.NK)(e)&&(!(0,a.qQ)(e)||void 0===(0,a.q3)(e)))}function _(e){const{collectionFormat:t,collectionSchema:o,filter:n,sort:r,sourcePropertyIds:i}=e,a=(i??(0,m.Yd)(o)).filter(((e,t,r)=>{const i=o[e];return!(!i||!S(i))&&(!n||n([e,i],t,o))}));if(0===a.length)return[];if(!t||!1===r)return a;const l=(0,s.iB)(t,o,void 0,s.j5.Page).collection_page_properties||[];return d.MR(a,(e=>l.findIndex((t=>t.property===e))))}async function w(e){const{config:t,collectionPointer:o,collectionSchema:n,actionId:a,context:s,getCurrentPropertyValue:d}=e,p={};for(const g of t.properties||[]){var m;const e=null===(m=t.values)||void 0===m?void 0:m[g],h=null==n?void 0:n[g];if(!h||!S(h))continue;const f=(0,c.H0)(o,g,h);if(!f)return{error:new r.Ox({actionId:a,property:g,collectionPointer:o})};const y=await(0,c.OH)({value:(null==e?void 0:e.value)||{type:"simple",value:void 0},context:{...s,returnType:f},executeFormula:s.executeContextualFormula});if(u.x.isFail(y))return{error:new r.x6({actionId:a,cause:y.error})};const v=(0,l.bw)({result:y.value,action:(0,i.o9)(e),currentPropertyValue:null==d?void 0:d(g),propertySchema:h});p[g]=v}return{value:p}}function k(e,t){"replace"===e.type?t(e.value):"keep"===e.type||(0,m.t1)(e)}function x(e){const{pointer:t,target:o,visitor:n}=e,r=[];return k(n.visitVariableOutsideOfFormula(o.id),(e=>{(0,m.$K)(e)?r.push(p.op.update({pointer:t,path:["config","target"],args:{id:e}})):r.push(p.op.update({pointer:t,path:["config"],args:{target:null}}))})),r}function I(e){const{pointer:t,config:{properties:o,values:n},visitor:r}=e;if(!o||!n)return[];const i=[];for(const a of o){const e=n[a];null!=e&&e.value&&k(r.visitFormula(e.value),(o=>{i.push(p.op.update({pointer:t,path:["config","values"],args:{[a]:o?{...e,value:o}:null}}))}))}return i}function C(e){const{fieldName:t,pointer:o,config:n,visitor:r}=e,i=[],a=n[t];return a&&k(r.visitFormula(a),(e=>{i.push(p.op.update({pointer:o,path:["config"],args:{[t]:e??null}}))})),i}function T(e){const{formulaValueTypes:t,minimumRole:o,targetId:n}=e,r=(0,l.vx)(t,n);if(r){const e=r.type;if("array"===e.type&&"block"===e.of.type&&e.of.collection)return[{type:"record_permission",pointer:e.of.collection,minimumRole:o??"reader"}]}return[]}const M={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1};function P(e){const{collectionFormat:t,collectionSchema:o,filter:n,sort:r}=e,i=(0,m.Yd)(o).filter(((e,t,r)=>{var i;const s=o[e];return!(!s||!M[s.type])&&((!(0,a.qQ)(s)||null===(i=(0,a.q3)(s))||void 0===i||!i.auto_update_on_edit)&&(!n||n([e,s],t,o)))}));if(0===i.length)return[];if(!t||!1===r)return i;const l=(0,s.iB)(t,o,void 0,s.j5.Page).collection_page_properties||[];return d.MR(i,(e=>l.findIndex((t=>t.property===e))))}const A={checkbox:!0,multi_select:!0,select:!0,status:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,email:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,number:!1,person:!1,phone_number:!1,relation:!1,rollup:!1,text:!1,title:!1,url:!1,verification:!1};function D(e){return A[e.type]}const B={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function R(e){return B[e.type]}},48777:(e,t,o)=>{o.d(t,{L:()=>w,Y:()=>S});o(57658),o(21703);var n=o(3865),r=o(41432),i=o(84116),a=o(78106),s=o(79317),l=o(47453),c=o(5366),d=o(482),p=o(63306),u=o(4615),m=o(149),g=o(18844),h=o(21202),f=o(6287),y=o(97880),v=o(81730);const b=(0,c.defineMessages)({createPage:{id:"automations.actions.createPage",defaultMessage:"Add page toâ€¦"},createPageDefaultVariableName:{id:"automations.actions.createPageDefaultVariableName",defaultMessage:"New page added"},createPageVariableNameWithDatabase:{id:"automations.actions.createPageVariableNameWithDatabase",defaultMessage:"New page added in {databaseName}"},createPageVariableNameWithDatabaseAndStepNumber:{id:"automations.actions.createPageVariableNameWithDatabaseAndStepNumber",defaultMessage:"New page added in {databaseName} from step {stepNumber}"},createPageDescription:{id:"automations.actions.createPageDescription",defaultMessage:"Adds a new page to a database."}}),S={relation:!0,person:!0,multi_select:!0,title:!1,text:!1,url:!1,email:!1,phone_number:!1,checkbox:!1,created_by:!1,last_edited_by:!1,file:!1,select:!1,status:!1,number:!1,date:!1,created_time:!1,last_edited_time:!1,last_visited_time:!1,formula:!1,rollup:!1,button:!1,auto_increment_id:!1,location:!1,verification:!1},_=new Set(["button","event","recurrence"]),w={type:"create_page",display:{icon:l.R,name:b.createPage,description:b.createPageDescription,hasSideEffects:!0},isAvailableForContext:async e=>{let t=e.automation.getTriggerType();return"notification_event"===t&&(t="event"),"event"===t?await e.checkSubscribed():_.has(t)},getDependencies:(e,t)=>{const o=[],n=t.getConfig();return null!=n&&n.collection&&(o.push({type:"record_permission",pointer:n.collection,minimumRole:"content_only_editor"},{type:"collection_default_template_record_permission",pointer:n.collection,minimumRole:"reader"}),null!=n&&n.template_page_id&&o.push({type:"record_permission",pointer:{table:h.iU,id:n.template_page_id},minimumRole:"reader"})),o},typecheck:(e,t)=>{const o=t.getConfig();if(null==o||!o.collection)return{value:{validationFailures:[{type:"missing_required_config",actionType:"create_page",key:"collection"}]}};const n=e.getRecordModel(o.collection);if(!n)return{value:{validationFailures:[{type:"missing_required_config",actionType:"create_page",key:"collection"}]}};if(!o.collection.spaceId)return{error:new v.MO("Collection missing space ID")};if(o.template_page_id){const t=e.getRecordModel({id:o.template_page_id,table:h.iU});if(!t)return{value:{validationFailures:[{type:"invalid_optional_config",actionType:"create_page",key:"template"}]}};if(t.getParentId()!==o.collection.id)return{value:{validationFailures:[{type:"invalid_optional_config",actionType:"create_page",key:"template"}]}}}let r=!1,s=!1;for(const i of e.automationModel.getActionIds()){if(i===t.id)continue;const n=e.getRecordModel({id:i,spaceId:e.automationModel.getSpaceId(),table:g.Xj});var l;if("create_page"===(null==n?void 0:n.type))r=!0,(null===(l=n.getConfig())||void 0===l||null===(l=l.collection)||void 0===l?void 0:l.id)===o.collection.id&&(s=!0)}const c=(0,a.Kd)({source:"action",action_id:t.id,action_output_type:"page"}),d=e.automationModel.getActionIds().indexOf(t.id)??-1,p=n.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:e.userTimeZone,intl:e.intl}),u=s?e.intl.formatMessage(b.createPageVariableNameWithDatabaseAndStepNumber,{databaseName:p,stepNumber:d+1}):r?e.intl.formatMessage(b.createPageVariableNameWithDatabase,{databaseName:p}):e.intl.formatMessage(b.createPageDefaultVariableName);return{value:{valueTypes:[{kind:i.yp.ContextValue,id:c,name:u,type:{type:"block",collection:o.collection}}]}}},execute:async(e,t)=>{const o=t.getConfig();if(null==o||!o.collection)return{value:{values:[]}};if(!o.collection.spaceId)return{error:new v.mK({pointer:o.collection,actionId:t.id})};const l=await e.loadRecordModel(o.collection);if(!l)return{value:{values:[]}};const c=l.getSpaceShardedPointer(),p=l.getNormalizedSchema();let g,b,S;if(p){const r=await(0,n.g9)({config:o,collectionPointer:c,collectionSchema:p,actionId:t.id,context:e});if(m.x.isFail(r))return r;g=r.value}else g={};if(o.template_page_id){const t={id:o.template_page_id,spaceId:o.collection.spaceId,table:h.iU};k({getRecordModel:(await e.handleDataRequest({recordPointers:[t]})).getRecordModel,pointer:t})&&(b=o.template_page_id)}if(!(0,y.$K)(b)){const t=(await e.handleDataRequest({recordPointers:[o.collection]})).getRecordModel(o.collection),n=null==t?void 0:t.getDefaultTemplatePagePointer();if(n){k({getRecordModel:(await e.handleDataRequest({recordPointers:[n]})).getRecordModel,pointer:n})&&(b=n.id)}}const _=[];if(b){const t=await e.executeEffectMap.initializeTemplateInDatabase({templateId:b,collection:o.collection,propertyUpdates:g});if(m.x.isFail(t))return t;S=t.value.pageId}else{S=(0,u.ZP)();const t={created_time:Date.now(),last_edited_time:Date.now(),id:S,type:r.Ti.page,version:0,parent_id:o.collection.id,parent_table:f.v,alive:!0,space_id:o.collection.spaceId,properties:g,...e.author?{created_by_table:e.author.table}:{},...e.author?{created_by_id:e.author.id}:{}};_.push(d.op.set({pointer:{table:h.iU,id:t.id,spaceId:t.space_id},path:[],args:t})),e.author&&_.push(d.op.update({pointer:{table:h.iU,id:S,spaceId:c.spaceId},path:[],args:{last_edited_time:Date.now(),last_edited_by_table:e.author.table,last_edited_by_id:e.author.id}}))}const w=l.isPageTreeCollection(),x=l.getRootPagePointer();if(w&&x){const e=(0,s.A6)(x.table,h.iU);if(!e)throw new Error(`Could not find child path for parent table ${x.table} and child table ${h.iU}`);_.push({pointer:x,path:e,command:"insertChildrenAfter",args:{ids:[S]}})}if(_.length>0){const o=await e.executeEffectMap.saveTransaction({actionId:t.id,info:{type:"create_page",collection:c,pageId:S},operations:_});if(o.error)return o}const I=(0,a.Kd)({source:"action",action_id:t.id,action_output_type:"page"});return{value:{values:[{kind:i.yp.ContextValue,id:I,value:{type:"block",value:{table:h.iU,id:S,spaceId:c.spaceId}}}]}}},acceptFormulaVisitor:e=>{const{action:t,visitor:o}=e,r=t.getConfig();return r?(0,n.vp)({pointer:t.pointer,config:r,visitor:o}):[]}};function k(e){const{getRecordModel:t,pointer:o}=e,n=p.DW(o,t);return p.Zg(n)}},83372:(e,t,o)=>{o.d(t,{z:()=>pe,P:()=>ue});var n=o(23290),r=(o(57658),o(45433)),i=o(40506),a=o(45953),s=o(81491),l=o(149),c=o(98963),d=o(81730),p=o(30120),u=o(41432),m=o(72126),g=o(59753),h=o(5366),f=o(482),y=o(4615),v=o(23014),b=o(21202),S=o(6287),_=o(70203),w=o(97880);async function k(e){const{completeSprintAction:t,completeSprintExecutionContext:o}=e,n=await async function(e){const{sprintCollectionSchema:t,sprintCollectionPointer:o}=e.sprintCollectionContext,{context:n,action:i}=e.automationContext,a=v.qB[r.p$].current.reducer.getCombinatorFilter(t);return await C((()=>n.executeEffectMap.queryCollection({actionId:i.id,collection:o,filter:a,limit:1})),e)}(o);if(l.x.isFail(n))return n;const i=n.value.blockIds[0],a=await async function(e){const{sprintCollectionSchema:t,sprintCollectionPointer:o}=e.sprintCollectionContext,{context:n,action:i}=e.automationContext,a=v.qB[r.p$].next.reducer.getCombinatorFilter(t);return await C((()=>n.executeEffectMap.queryCollection({actionId:i.id,collection:o,filter:a,limit:1})),e)}(o);if(l.x.isFail(a))return a;const s=m.Ps(a.value.blockIds);let c,p;if(s)p=s,c=1;else{const e=await async function(e){const{completeSprintExecutionContext:t,currentSprintPageId:o}=e,{sprintStatusNextOptionName:n,sprintStatusPropertyId:r,sprintCollectionPointer:i}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{recordMap:l,spaceId:c}=t,p={id:o,table:b.iU,spaceId:c},m=l.getModel(p);if(!m)return{error:new d.Do({actionId:s.id,pointer:p})};const h=F({intl:a.intl,userTimeZone:a.userTimeZone,getRecordModel:g.om.fromRecordMap(l),incrementSprintIdAmount:1,sourceSprintPageModel:m}),v=(0,y.ZP)(),w={created_time:Date.now(),last_edited_time:Date.now(),id:v,type:u.Ti.page,version:0,parent_id:i.id,parent_table:S.v,alive:!0,space_id:c,properties:{title:(0,_.TPx)(h),[r]:[[n]]},...a.author?{created_by_table:a.author.table}:{},...a.author?{created_by_id:a.author.id}:{}},k=[f.op.set({pointer:{id:v,table:b.iU,spaceId:c},path:[],args:w})];return await M((()=>a.executeEffectMap.saveTransaction({actionId:s.id,operations:k,info:{type:"create_page",collection:i,pageId:v}})),{completeSprintExecutionContext:t,blockValue:w})}({completeSprintExecutionContext:o,currentSprintPageId:i});if(l.x.isFail(e))return e;p=e.value.blockId,c=2}const h=await x(o);if(l.x.isFail(h))return h;const w=h.value.blockIds[0],k=await async function(e){const{sprintUniqueIdPropertyId:t,sprintCollectionPointer:o}=e.sprintCollectionContext,{context:n,action:r}=e.automationContext;return await C((()=>n.executeEffectMap.queryCollection({actionId:r.id,collection:o,sort:[{property:t,direction:"descending"}],limit:1})),e)}(o);if(l.x.isFail(k))return k;const I=k.value.blockIds[0];if("complete_sprint_and_move_incomplete_tasks_to_next_sprint"===t){const e=await B({completeSprintExecutionContext:o,nextSprintPageId:p});if(l.x.isFail(e))return e}else if("complete_sprint_and_move_incomplete_tasks_to_backlog"===t){const e=await R(o);if(l.x.isFail(e))return e}const E=await A({completeSprintExecutionContext:o,currentSprintPageId:i});if(l.x.isFail(E))return E;const N=await D({completeSprintExecutionContext:o,nextSprintPageId:p});if(l.x.isFail(N))return N;const j=await P({completeSprintExecutionContext:o,nextFutureSprintPageId:w});if(l.x.isFail(j))return j;const O=await T({completeSprintExecutionContext:o,sprintPageWithLargestUniqueId:I,incrementFutureSprintIdAmount:c});return l.x.isFail(O)?O:{value:{}}}async function x(e){const{sprintUniqueIdPropertyId:t,sprintStatusPropertyId:o,sprintStatusFutureOptionName:n,sprintCollectionPointer:r}=e.sprintCollectionContext,{context:i,action:a}=e.automationContext,s={operator:"and",filters:[{property:o,filter:{operator:"status_is",value:{type:"is_option",value:n}}}]};return await C((()=>i.executeEffectMap.queryCollection({actionId:a.id,collection:r,filter:s,sort:[{property:t,direction:"ascending"}],limit:1})),e)}async function I(e){const{taskStatusPropertyId:t,taskStatusCompleteGroupName:o,taskSprintRelationPropertyId:n,taskCollectionPointer:r}=e.taskCollectionContext,{context:i,action:a}=e.automationContext,s={operator:"and",filters:[{property:t,filter:{operator:"status_is_not",value:{type:"is_group",value:o}}},{filter:{operator:"relation_contains",value:{type:"relative",value:{type:"builtin",variable:"current"}}},property:n}]};return await C((()=>i.executeEffectMap.queryCollection({actionId:a.id,collection:r,filter:s})),e)}async function C(e,t){const{spaceId:o,recordMap:n}=t,{context:r}=t.automationContext,i=await e();if(l.x.isFail(i))return i;const a=i.value;if(a.recordMap)n.assign(a.recordMap.toRecordMap());else{const e=a.blockIds.map((e=>({id:e,table:b.iU,spaceId:o}))),t=await r.loadRecordModel(e);n.assign(t)}return{value:{blockIds:a.blockIds}}}async function T(e){const{completeSprintExecutionContext:t,sprintPageWithLargestUniqueId:o,incrementFutureSprintIdAmount:n}=e,{sprintStatusFutureOptionName:r,sprintStatusPropertyId:i,sprintCollectionPointer:a}=t.sprintCollectionContext,{context:s,action:l}=t.automationContext,{recordMap:c,spaceId:p}=t,m={id:o,table:b.iU,spaceId:p},h=c.getModel(m);if(!h)return{error:new d.Do({actionId:l.id,pointer:m})};const v=F({intl:s.intl,userTimeZone:s.userTimeZone,getRecordModel:g.om.fromRecordMap(c),incrementSprintIdAmount:n,sourceSprintPageModel:h}),w=(0,y.ZP)(),k={created_time:Date.now(),last_edited_time:Date.now(),id:w,type:u.Ti.page,version:0,parent_id:a.id,parent_table:S.v,alive:!0,space_id:p,properties:{title:(0,_.TPx)(v),[i]:[[r]]},...s.author?{created_by_table:s.author.table}:{},...s.author?{created_by_id:s.author.id}:{}},x=[f.op.set({pointer:{id:w,table:b.iU,spaceId:p},path:[],args:k})];return await M((()=>s.executeEffectMap.saveTransaction({actionId:l.id,operations:x,info:{type:"create_page",collection:a,pageId:w}})),{completeSprintExecutionContext:t,blockValue:k})}async function M(e,t){const{completeSprintExecutionContext:o,blockValue:n}=t,{recordMap:r}=o,i=await e();return l.x.isFail(i)?i:(r.setValue({id:n.id,table:b.iU,spaceId:n.space_id},n),{value:{blockId:n.id}})}async function P(e){const{completeSprintExecutionContext:t,nextFutureSprintPageId:o}=e,{sprintStatusNextOptionName:n,sprintStatusPropertyId:r,sprintCollectionPointer:i}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{recordMap:c,spaceId:p}=t,u=await x(t);if(l.x.isFail(u))return u;const m={id:o,table:b.iU,spaceId:p},g=c.getModel(m);if(!g)return{error:new d.Do({actionId:s.id,pointer:m})};c.addModel(g);const h=[f.op.update({pointer:g.pointer,path:["properties"],args:{[r]:[[n]]}})];return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:h,info:{type:"update_pages",collection:i,editedProperties:[{id:r,type:"status"}],pageIds:[o]}})}async function A(e){const{completeSprintExecutionContext:t,currentSprintPageId:o}=e,{sprintStatusPastOptionName:n,sprintStatusPropertyId:r,sprintCollectionPointer:i}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{spaceId:l}=t,c=[f.op.update({pointer:{id:o,table:b.iU,spaceId:l},path:["properties"],args:{[r]:[[n]]}})];return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:c,info:{type:"update_pages",collection:i,editedProperties:[{id:r,type:"status"}],pageIds:[o]}})}async function D(e){const{completeSprintExecutionContext:t,nextSprintPageId:o}=e,{sprintStatusCurrentOptionName:n,sprintStatusPropertyId:r,sprintCollectionPointer:i,nextSprintDateRange:a,sprintDatePropertyId:s}=t.sprintCollectionContext,{context:l,action:c}=t.automationContext,{spaceId:d}=t,p=[f.op.update({pointer:{id:o,table:b.iU,spaceId:d},path:["properties"],args:{[r]:[[n]],[s]:[(0,_.YCD)(["d",a])]}})];return await l.executeEffectMap.saveTransaction({actionId:c.id,operations:p,info:{type:"update_pages",collection:i,editedProperties:[{id:r,type:"status"}],pageIds:[o]}})}async function B(e){const{completeSprintExecutionContext:t,nextSprintPageId:o}=e,{taskSprintRelationPropertyId:n,taskCollectionPointer:r}=t.taskCollectionContext,{context:i,action:a}=t.automationContext,{spaceId:s}=t,c=await I(t);if(l.x.isFail(c))return c;const d=c.value.blockIds,p=d.map((e=>f.op.update({pointer:{id:e,table:b.iU,spaceId:s},path:["properties"],args:{[n]:[(0,_.YCD)((0,_.$0A)(o,s))]}})));return await i.executeEffectMap.saveTransaction({actionId:a.id,operations:p,info:{type:"update_pages",collection:r,editedProperties:[{id:n,type:"relation"}],pageIds:d}})}async function R(e){const{taskSprintRelationPropertyId:t,taskCollectionPointer:o}=e.taskCollectionContext,{context:n,action:r}=e.automationContext,{spaceId:i}=e,a=await I(e);if(l.x.isFail(a))return a;const s=a.value.blockIds,c=s.map((e=>f.op.update({pointer:{id:e,table:b.iU,spaceId:i},path:["properties"],args:{[t]:void 0}})));return await n.executeEffectMap.saveTransaction({actionId:r.id,operations:c,info:{type:"update_pages",collection:o,editedProperties:[{id:t,type:"relation"}],pageIds:s}})}const E=(0,h.defineMessages)({defaultSprintName:{id:"completeSprint.newSprint.defaultName",defaultMessage:"Sprint"},sprintNameWithId:{id:"completeSprint.newSprintWithId.name",defaultMessage:"Sprint {sprintId}"}});function F(e){const{intl:t,userTimeZone:o,getRecordModel:n,sourceSprintPageModel:r,incrementSprintIdAmount:i}=e,a=r.getRenderTitle({intl:t,userTimeZone:o,getRecordModel:n}),s=m.Z$(null==a?void 0:a.trim().split(" "));let l;if(s){const e=parseInt(s);isNaN(e)||(l=e+i)}return void 0!==l?t.formatMessage(E.sprintNameWithId,{sprintId:l}):t.formatMessage(E.defaultSprintName)}const N={type:"complete_sprint",isAvailableForContext:async e=>Promise.resolve("recurrence"===e.automation.getTriggerType()),getDependencies:(e,t)=>{const o=t.getConfig(),n=[];return null!=o&&o.sprint_collection&&n.push({type:"record_permission",pointer:o.sprint_collection,minimumRole:"editor"}),null!=o&&o.task_collection&&n.push({type:"record_permission",pointer:o.task_collection,minimumRole:"editor"}),n},typecheck:(e,t)=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var o,n,u,m,g,h,f,y,v,b;const S=t.getConfig();if(!S)return{error:new d.Qq({actionId:t.id})};const _=a.Ak.create(),x=await e.loadRecordModel(S.sprint_collection);if(!x)return{error:new d.Do({actionId:t.id,pointer:S.sprint_collection})};_.addModel(x);const I=x.getNormalizedSchema(),C=null===(o=x.getFormat())||void 0===o||null===(o=o.app_uri_map)||void 0===o?void 0:o[r.b0.StatusV2];if(!C)return{error:new d.Ox({actionId:t.id,collectionPointer:S.task_collection,property:r.b0.StatusV2})};const T=null===(n=x.getFormat())||void 0===n||null===(n=n.app_uri_map)||void 0===n?void 0:n[r.b0.UniqueId];if(!T)return{error:new d.Ox({actionId:t.id,collectionPointer:S.task_collection,property:r.b0.UniqueId})};const M=null===(u=x.getFormat())||void 0===u||null===(u=u.app_uri_map)||void 0===u?void 0:u[r.b0.Dates];if(!M)return{error:new d.Ox({actionId:t.id,collectionPointer:S.task_collection,property:r.b0.Dates})};const P=I[C];if(!P||"status"!==P.type)return{error:new d.Ox({actionId:t.id,collectionPointer:S.task_collection,property:r.b0.StatusV2})};const A=null===(m=P.options)||void 0===m||null===(m=m.find((e=>e.id===r.J1)))||void 0===m?void 0:m.value,D=null===(g=P.options)||void 0===g||null===(g=g.find((e=>e.id===r.SF)))||void 0===g?void 0:g.value,B=null===(h=P.options)||void 0===h||null===(h=h.find((e=>e.id===r.YE)))||void 0===h?void 0:h.value,R=null===(f=P.options)||void 0===f||null===(f=f.find((e=>e.id===r.eH)))||void 0===f?void 0:f.value;if(!(A&&D&&B&&R))return{error:new d.fH("invalid_property_schema",`Could not find required options for ${r.b0.StatusV2}.`)};const E={id:e.automationModel.id,table:c.cv,spaceId:x.id},F=await e.loadRecordModel(E);if(!F||!F.isType("recurrence"))return{error:new d.Do({actionId:t.id,pointer:E})};const N=F.getTrigger().recurrence,j=(0,s.getRecurrenceAfter)({recurrence:N,afterDate:(0,i.Io)(new Date(Date.now()))});if(!j)return{error:new d.EP({actionId:t.id,message:"Expected to receive a nextSprintStartDate"})};const O=function(e){const{nextSprintStartDate:t,recurrence:o}=e,n=o.frequency,r=p.ou.fromJSDate(t).toUTC().setZone("local",{keepLocalTime:!0});let i;"day"===n?i={days:o.interval}:"week"===n?i={weeks:o.interval}:"month"===n?i={month:o.interval}:"year"===n?i={year:o.interval}:(0,w.t1)(n);const a=r.plus(i),s=e=>e.toISODate();return{type:"daterange",start_date:s(r),end_date:s(a)}}({nextSprintStartDate:j,recurrence:N}),L=await e.loadRecordModel(S.task_collection);if(!L)return{error:new d.Do({actionId:t.id,pointer:S.task_collection})};_.addModel(L);const U=null===(y=L.getFormat())||void 0===y||null===(y=y.app_uri_map)||void 0===y?void 0:y[r.Es.Status];if(!U)return{error:new d.Ox({actionId:t.id,collectionPointer:S.task_collection,property:r.Es.Status})};const Z=null===(v=L.getFormat())||void 0===v||null===(v=v.app_uri_map)||void 0===v?void 0:v[r.Es.TaskToSprintRelation];if(!Z)return{error:new d.Ox({actionId:t.id,collectionPointer:S.task_collection,property:r.Es.TaskToSprintRelation})};const V=L.getNormalizedSchema(),q=V[U];if(!q||"status"!==q.type)return{error:new d.Ox({actionId:t.id,collectionPointer:S.task_collection,property:r.Es.Status})};const z=null===(b=q.groups)||void 0===b||null===(b=b.find((e=>e.id===r.uS)))||void 0===b?void 0:b.name;if(!z)return{error:new d.fH("invalid_property_schema",`Could not find required group for ${r.Es.Status}.`)};const W={spaceId:x.space_id,automationContext:{action:t,context:e},sprintCollectionContext:{sprintCollectionPointer:S.sprint_collection,sprintCollectionSchema:I,nextSprintDateRange:O,sprintDatePropertyId:M,sprintStatusCurrentOptionName:D,sprintStatusFutureOptionName:R,sprintStatusNextOptionName:B,sprintStatusPastOptionName:A,sprintStatusPropertyId:C,sprintStatusPropertySchema:P,sprintUniqueIdPropertyId:T},taskCollectionContext:{taskCollectionPointer:S.task_collection,taskCollectionSchema:V,taskSprintRelationPropertyId:Z,taskStatusCompleteGroupName:z,taskStatusPropertyId:U,taskStatusPropertySchema:q},recordMap:_},H=await k({completeSprintAction:S.complete_sprint_action,completeSprintExecutionContext:W});return l.x.isFail(H)?H:{value:{values:[]}}},acceptFormulaVisitor:e=>[]};var j=o(48777),O=o(88437);const L=(0,h.defineMessages)({duplicateBlocks:{id:"automations.actions.duplicateBlocks",defaultMessage:"Insert blocks"},duplicateBlocksDescription:{id:"automations.actions.duplicateBlocksDescription",defaultMessage:"Insert text or blocks on this page."}}),U={type:"duplicate_blocks",display:{icon:O.a,name:L.duplicateBlocks,description:L.duplicateBlocksDescription,hasSideEffects:!0},isAvailableForContext:async e=>Promise.resolve("button_block"===e.contextType),getDependencies:(e,t)=>[{type:"record_permission",pointer:e.automationModel.getParentPointer(),minimumRole:"content_only_editor"}],typecheck:()=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var o;const n=m.Ps(t.getBlocks()??[]),r=(null===(o=t.getConfig())||void 0===o?void 0:o.insertion_point)??g.IN.DEFAULT_INSERTION_POINT;return(0,w.$K)(n)&&await e.executeEffectMap.duplicateBlockChildren({blockPointer:{table:b.iU,id:n,spaceId:e.automationModel.getSpaceId()},insertionPoint:r}),{value:{values:[]}}},acceptFormulaVisitor:e=>[]};var Z=o(3865),V=o(78106),q=o(76218),z=o(84169);const W=(0,h.defineMessages)({modalConfirmation:{id:"automations.actions.modalConfirmation",defaultMessage:"Show confirmation"},modalConfirmationDescription:{id:"automations.actions.modalConfirmationDescription",defaultMessage:"Shows a confirmation window before proceeding."}}),H={type:"modal_confirmation",display:{icon:z.m,name:W.modalConfirmation,description:W.modalConfirmationDescription,hasSideEffects:!1},isAvailableForContext:async e=>Promise.resolve("button"===e.automation.getTriggerType()),getDependencies:(e,t)=>[],typecheck:()=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var o,n,r;const i=t.getConfig();let a=[];if(null!=i&&i.text){const o=await(0,q.OH)({value:i.text,context:{...e,returnType:{type:"text"}},executeFormula:e.executeContextualFormula});if(l.x.isFail(o))return{error:new d.x6({actionId:t.id,cause:o.error})};a=(0,V.j4)(o.value)}(0,_.VrM)(a)>c.tb&&(a=(0,_.Zdj)(a,c.tb),a.push((0,_.V3y)("â€¦")));return"cancel"===await e.executeEffectMap.displayModal({format:{icon:null===(o=e.automationModel.getProperties())||void 0===o?void 0:o.icon,text:a,continueButtonText:(null==i||null===(n=i.continue_button)||void 0===n?void 0:n.text)??"",cancelButtonText:(null==i||null===(r=i.cancel_button)||void 0===r?void 0:r.text)??""}})?{error:new d.nQ}:{value:{values:[]}}},acceptFormulaVisitor:e=>{const{action:t,visitor:o}=e,n=t.getConfig();return n?(0,Z.n6)({fieldName:"text",config:n,pointer:t.pointer,visitor:o}):[]}};var G=o(9999);const K=(0,h.defineMessages)({openPage:{id:"automations.actions.openPage",defaultMessage:"Open page"},openPageDescription:{id:"automations.actions.openPageDescription",defaultMessage:"Opens a specified page."}}),$={type:"open_page",display:{icon:G.J,name:K.openPage,description:K.openPageDescription,hasSideEffects:!1},isAvailableForContext:async e=>Promise.resolve("button"===e.automation.getTriggerType()),getDependencies:(e,t)=>{var o,n;const r=t.getConfig();return"page"===(null==r||null===(o=r.target)||void 0===o?void 0:o.type)?[{type:"record_permission",pointer:null==r?void 0:r.target.page,minimumRole:"reader"}]:"variable"===(null==r||null===(n=r.target)||void 0===n?void 0:n.type)?[{id:r.target.id,minimumRole:"reader",type:"formula_value_permission"}]:[]},typecheck:(e,t)=>{const o=t.getConfig();return null!=o&&o.target?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_config",actionType:"open_page",key:"target"}]}}},execute:(e,t)=>{const o=t.getConfig();if(null==o||!o.target)return{error:new d.mK({pointer:null==o?void 0:o.target,actionId:t.id})};let n;if("page"===o.target.type)n=o.target.page;else if("variable"===o.target.type){const r=(0,V.dh)(e.values,o.target.id);if(!r)return{error:new d.Hb({actionId:t.id,source:"action",variable:r})};if("block"===r.value.type)n=r.value.value;else{if("array"!==r.value.type)return{error:new d.Hb({actionId:t.id,source:"action",variable:r.value})};{const e=r.value.values[0];if(!e||"block"!==e.type)return{error:new d.Hb({actionId:t.id,source:"action",variable:r.value})};n=e.value}}}else(0,w.t1)(o.target);return e.executeEffectMap.navigateToPage({actionId:t.id,page:n,openIn:t.getOpenPageIn()}),{value:{values:[]}}},acceptFormulaVisitor:e=>{var t;const{action:o,visitor:n}=e,r=o.getConfig();if(!r)return[];const i=[];return"variable"===(null==r||null===(t=r.target)||void 0===t?void 0:t.type)&&i.push(...(0,Z.AQ)({pointer:o.pointer,target:r.target,visitor:n})),i}};var Y=o(84116),Q=o(49019);const J=(0,h.defineMessages)({queryCollection:{id:"automations.actions.queryCollection",defaultMessage:"Get pages"},queryCollectionDescription:{id:"automations.actions.queryCollectionDescription",defaultMessage:"Get a list of pages from a database with optional filters and sorts, to be used in a subsequent automation step."},queryCollectionPages:{id:"automations.actions.queryCollectionPages",defaultMessage:"Pages from step {stepNumber}"}}),X={type:"query_collection",display:{icon:Q.e,name:J.queryCollection,description:J.queryCollectionDescription,hasSideEffects:!1},isAvailableForContext:async()=>Promise.resolve(!1),getDependencies:(e,t)=>{const o=t.getConfig();return null!=o&&o.collection?[{type:"record_permission",pointer:null==o?void 0:o.collection,minimumRole:"reader"}]:[]},typecheck:(e,t)=>{const o=t.getConfig();if(null==o||!o.collection)return{value:{valueTypes:[]}};const n=(0,V.Kd)({source:"action",action_id:t.id,action_output_type:"pages"}),r=e.automationModel.getActionIds().indexOf(t.id)??-1;return{value:{valueTypes:[{kind:Y.yp.ContextValue,id:n,name:e.intl.formatMessage(J.queryCollectionPages,{stepNumber:r+1}),type:{type:"array",of:{type:"block",collection:o.collection}}}]}}},execute:async(e,t)=>{const o=t.getConfig();if(null==o||!o.collection)return{value:{values:[]}};if(null==o||!o.collection.spaceId)return{error:new d.mK({pointer:null==o?void 0:o.collection,actionId:t.id})};const n={table:S.v,id:null==o?void 0:o.collection.id,spaceId:null==o?void 0:o.collection.spaceId},r=await e.executeEffectMap.queryCollection({actionId:t.id,collection:n,filter:null==o?void 0:o.filter,sort:null==o?void 0:o.sort,limit:null==o?void 0:o.limit});if(r.error)return r;const i=(0,V.Kd)({source:"action",action_id:t.id,action_output_type:"pages"});return{value:{values:[{kind:Y.yp.ContextValue,id:i,value:{type:"array",values:r.value.blockIds.map((e=>({type:"block",value:{table:b.iU,id:e,spaceId:n.spaceId}})))}}]}}},acceptFormulaVisitor:e=>[]};var ee=o(24600),te=o(77420);const oe=(0,h.defineMessages)({slackNotification:{defaultMessage:"Send Slack notification toâ€¦",id:"automations.actions.slackNotification"},slackNotificationDescription:{defaultMessage:"Sends a Slack notification to a user or channel.",id:"automations.actions.slackNotificationDescription"}}),ne={type:"slack_notification",display:{icon:ee.P,name:oe.slackNotification,description:oe.slackNotificationDescription,hasSideEffects:!1},isAvailableForContext:async e=>{const t=e.automationActions.filter((e=>e.isType("slack_notification"))),o="canAddAction"===e.checkType?t.length<1:t.length<=1;return Promise.resolve("event"===e.contextType&&o)},getDependencies:(e,t)=>{const o=t.getConfig();return null!=o&&o.external_bot_id?[{minimumRole:"editor",pointer:{id:o.external_bot_id,table:te.cZ},type:"record_permission"}]:[]},typecheck:(e,t)=>{const o=t.getConfig();if(null==o||!o.external_bot_id)return{value:{validationFailures:[{type:"missing_required_config",actionType:"slack_notification",key:"external_bot_id"}]}};return e.getRecordModel({id:o.external_bot_id,table:te.cZ})?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_value",actionType:"slack_notification",key:"external_bot_id"}]}}},execute:(e,t)=>({value:{values:[]}}),acceptFormulaVisitor:e=>[]};var re=o(38297),ie=o(25651);const ae=(0,h.defineMessages)({updatePages:{id:"automations.actions.updatePages",defaultMessage:"Edit pages inâ€¦"},updatePagesDescription:{id:"automations.actions.updatePagesDescription",defaultMessage:"Edits the properties of specified pages in a database."}}),se=new Set(["button","event"]);async function le(e){const{pointer:t,context:o,actionId:n}=e,r=await o.loadRecordModel(t);if(!r)return{error:new d.Do({pointer:t,actionId:n})};const i=await(0,re.Rd)({block:r,loadRecordModel:o.loadRecordModel});return i?{value:i.getSpaceShardedPointer()}:{error:new d.Do({pointer:t,actionId:n})}}const ce={type:"update_pages",display:{icon:ie.R,name:ae.updatePages,description:ae.updatePagesDescription,hasSideEffects:!0},isAvailableForContext:async e=>{let t=e.automation.getTriggerType();if("notification_event"===t&&(t="event"),"event"===t){if(!(await e.checkSubscribed()))return!1;const t=e.automationActions.filter((e=>{var t;return e.isType("update_pages")&&"collection"===(null===(t=e.getConfig())||void 0===t||null===(t=t.target)||void 0===t?void 0:t.type)}));return"canAddAction"===e.checkType?t.length<5:t.length<=5}return se.has(t)},getDependencies:(e,t)=>{var o,n;const r=t.getConfig();return"collection"===(null==r||null===(o=r.target)||void 0===o?void 0:o.type)?[{type:"record_permission",pointer:null==r?void 0:r.target.collection,minimumRole:"content_only_editor"}]:"variable"===(null==r||null===(n=r.target)||void 0===n?void 0:n.type)?[{id:r.target.id,minimumRole:"read_and_write",type:"formula_value_permission"}]:[]},typecheck:(e,t)=>{const o=t.getConfig();return null!=o&&o.target?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_config",actionType:"update_pages",key:"target"}]}}},execute:async(e,t)=>{const o=t.getConfig();if(null==o||!o.target)return{error:new d.mK({pointer:null==o?void 0:o.target,actionId:t.id})};let n,r,i,a=e.loadRecordModel;if("collection"===(null==o?void 0:o.target.type)){const s=await a(o.target.collection);if(!s)return{error:new d.Do({pointer:o.target.collection,actionId:t.id})};const c=await e.executeEffectMap.queryCollection({actionId:t.id,collection:o.target.collection,filter:o.target.filter,limit:o.target.limit,sort:o.target.sort});if(l.x.isFail(c))return c;i=c.value.blockIds,n=s.getNormalizedSchema(),r=o.target.collection,c.value.recordMap&&(a=g.s8.tryUntilFound(a,g.s8.fromRecordMapWithRole(c.value.recordMap)))}else if("variable"===o.target.type){const s=(0,V.dh)(e.values,o.target.id);if(!s)return{error:new d.L({actionId:t.id,contextValueId:o.target.id})};if("block"===s.value.type){let o=await le({pointer:s.value.value,context:e,actionId:t.id});if(l.x.isFail(o)){const t=function(e){var t;const{actionModels:o,contextValue:n}=e,r=(0,V.MY)(n.id);if("action"!==r.source)return{error:new d.Hb({source:"global",variable:n.value})};const i=o.find((e=>e.id===r.action_id));if(!i||"create_page"!==i.getType())return{error:new d.Hb({actionId:r.action_id,source:"action",variable:n.value})};const a=null===(t=i.getConfig())||void 0===t?void 0:t.collection;return a?{value:a}:{error:new d.Hb({actionId:r.action_id,source:"action",variable:n.value})}}({actionModels:e.actionModels,contextValue:s});if(l.x.isFail(t))return o;o=t}i=[s.value.value.id],r=o.value;const a=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:r});if(l.x.isFail(a))return a;n=a.value.collectionSchema}else{if("array"!==s.value.type)return{error:new d.Hb({actionId:t.id,source:"action",variable:s.value})};{const o=s.value.values[0];if(!o||"block"!==o.type)return{error:new d.Hb({actionId:t.id,source:"action",variable:o})};const c=await a(o.value),p=c?await(0,re.Rd)({block:c,loadRecordModel:a}):void 0;if(!p)return{error:new d.Do({pointer:o.value,actionId:t.id})};const u=p.getSpaceShardedPointer();i=m.oA(s.value.values.map((e=>"block"===e.type?e.value.id:void 0)));const g=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:u});if(l.x.isFail(g))return g;n=g.value.collectionSchema,r=u}}}else if("page"===o.target.type){const a=o.target.page,s=await le({pointer:a,context:e,actionId:t.id});if(l.x.isFail(s))return s;i=[a.id],r=s.value;const c=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:r});if(l.x.isFail(c))return c;n=c.value.collectionSchema}else(0,w.t1)(o.target);const s=[];for(const c of i){const i=await a({table:b.iU,id:c,spaceId:r.spaceId});let d;if(n){const a=null==i?void 0:i.getProperties(),s=await(0,Z.g9)({config:o,collectionPointer:r,collectionSchema:n,actionId:t.id,context:e,getCurrentPropertyValue:e=>null==a?void 0:a[e]});if(l.x.isFail(s))return s;d=s.value}else d={};s.push({pointer:{table:b.iU,id:c,spaceId:r.spaceId},command:"update",path:["properties"],args:d}),e.author&&s.push(f.op.update({pointer:{table:b.iU,id:c,spaceId:r.spaceId},path:[],args:{last_edited_time:Date.now(),last_edited_by_table:e.author.table,last_edited_by_id:e.author.id}}))}if(s.length>0){const a=(o.properties??[]).map((e=>{var t;const o=null===(t=n)||void 0===t?void 0:t[e];if(o)return{id:e,type:o.type}})).filter(w.$K),c=await e.executeEffectMap.saveTransaction({actionId:t.id,info:{type:"update_pages",pageIds:i,collection:r,editedProperties:a},operations:s});if(l.x.isFail(c))return c}return{value:{values:[]}}},acceptFormulaVisitor:e=>{var t;const{action:o,visitor:n}=e,r=o.getConfig();if(!r)return[];const i=[];if("variable"===(null==r||null===(t=r.target)||void 0===t?void 0:t.type)){const e=(0,Z.AQ)({pointer:o.pointer,target:r.target,visitor:n});i.push(...e)}return i.push(...(0,Z.vp)({pointer:o.pointer,config:r,visitor:n})),i}},de={query_collection:X,create_page:j.L,update_pages:ce,open_page:$,slack_notification:ne,duplicate_blocks:U,modal_confirmation:H,complete_sprint:N};function pe(e){return de[e]}function ue(e){return(0,n.FP)(e).map((e=>pe(e)))}},81730:(e,t,o)=>{o.d(t,{Do:()=>a,EP:()=>h,Hb:()=>s,L:()=>u,MO:()=>n,Ox:()=>c,Pn:()=>l,Qq:()=>g,fH:()=>r,iR:()=>d,mK:()=>i,nQ:()=>m,x6:()=>p});o(21703);class n extends Error{}class r extends Error{constructor(e,t){super(t),this.type=e}}class i extends r{constructor(e){super("invalid_record_pointer","Invalid record pointer"),this.data=e}}class a extends r{constructor(e){super("invalid_record","Invalid record"),this.data=e}}class s extends r{constructor(e){super("invalid_variable_type","Invalid variable type"),this.data=e}}class l extends r{constructor(e){super(e.type,e.message),this.data=e}}class c extends r{constructor(e){super("invalid_property_schema","Invalid property schema"),this.data=e}}class d extends r{constructor(e){super("unsupported_context","Unsupported context"),this.data=e}}class p extends r{constructor(e){super("formula_execution_failed","Formula execution failed"),this.data=e}}class u extends r{constructor(e){super("missing_context_value","Missing context value"),this.data=e}}class m extends r{constructor(){super("user_cancelled","User cancelled")}}class g extends r{constructor(e){super("missing_action_config","Missing automation action config"),this.data=e}}class h extends r{constructor(e){super("misc",e.message),this.data=e}}Error},94412:(e,t,o)=>{o.d(t,{X:()=>i,e:()=>a});var n=o(59753),r=o(18844);class i{constructor(e){this.triggerType=void 0,this.actions=void 0,this.spaceId=void 0,this.parentPointer=void 0,this.triggerType=e.triggerType,this.actions=e.actions,this.spaceId=e.spaceId,this.parentPointer=e.parentPointer}get id(){return"structured-automation-id"}getSpaceId(){return this.spaceId}getActionIds(){return this.actions.map((e=>e.id))}getProperties(){}getTriggerType(){return this.triggerType}getParentPointer(){return this.parentPointer}}class a{constructor(e,t){this.underlying=e,this.spaceId=t}get id(){return this.underlying.id}get pointer(){return{id:this.underlying.id,table:r.Xj,spaceId:this.spaceId}}getType(){return this.underlying.type}getConfig(){return this.underlying.config}getBlocks(){return this.underlying.blocks??[]}getOpenPageIn(){var e;return(null===(e=this.underlying.config)||void 0===e?void 0:e.open_in)??n.th.DEFAULT_PEEK_MODE_FORMAT}}},10450:(e,t,o)=>{o.d(t,{E$:()=>b,J0:()=>d,dG:()=>f,io:()=>v,rb:()=>y,zW:()=>h});var n=o(5366),r=o(53877),i=o(84116),a=o(78106),s=o(72126),l=o(19889);const c=(0,n.defineMessages)({buttonPage:{id:"automations.triggers.button.page.label",defaultMessage:"This page"},currentUser:{id:"automations.triggers.currentUser.label",defaultMessage:"Person who clicked button"},now:{id:"automations.triggers.now.label",defaultMessage:"Now"},today:{id:"automations.triggers.today.label",defaultMessage:"Today"}});function d(){return(0,a.Kd)({source:"global",global:"button_page"})}function p(){return(0,a.Kd)({source:"global",global:"current_user"})}function u(){return(0,a.Kd)({source:"global",global:"now"})}function m(){return(0,a.Kd)({source:"global",global:"today"})}function g(e){const{blockPointer:t,currentUserId:o}=e,n=d(),a=p(),s=u(),c=m();return{value:{values:[{kind:i.yp.ContextValue,id:n,value:{type:"block",value:t}},{kind:i.yp.ContextValue,id:a,value:{type:"person",value:{table:l.KJ,id:o}}},{kind:i.yp.ContextValue,id:s,value:{type:"date",value:(0,r.CQ)(Date.now(),e.userTimeZone)}},{kind:i.yp.ContextValue,id:c,value:{type:"date",value:(0,r.hT)(Date.now(),e.userTimeZone)}}]}}}function h(e){const{collectionPointer:t}=e,o=d(),n=p(),r=u(),a=m();return{value:{valueTypes:[{kind:i.yp.ContextValue,id:o,name:e.intl.formatMessage(c.buttonPage),type:{type:"block",collection:t}},{kind:i.yp.ContextValue,id:n,name:e.intl.formatMessage(c.currentUser),type:{type:"person"}},{kind:i.yp.ContextValue,id:r,name:e.intl.formatMessage(c.now),type:{type:"date"}},{kind:i.yp.ContextValue,id:a,name:e.intl.formatMessage(c.today),type:{type:"date"}}]}}}function f(e){return g(e)}function y(e){const t=p(),o=u(),n=m(),r=d(),a={kind:i.yp.ContextValue,id:t,name:e.intl.formatMessage(c.currentUser),type:{type:"person"}},l={kind:i.yp.ContextValue,id:o,name:e.intl.formatMessage(c.now),type:{type:"date"}},g={kind:i.yp.ContextValue,id:n,name:e.intl.formatMessage(c.today),type:{type:"date"}},h=e.collectionPointer?{kind:i.yp.ContextValue,id:r,name:e.intl.formatMessage(c.buttonPage),type:{type:"block",collection:e.collectionPointer}}:void 0;return{value:{valueTypes:s.oA([a,l,g,h])}}}function v(e){const{currentUserId:t,pagePointer:o}=e,n=p(),a=u(),s=m(),c=d();return{value:{values:[{kind:i.yp.ContextValue,id:n,value:{type:"person",value:{table:l.KJ,id:t}}},{kind:i.yp.ContextValue,id:a,value:{type:"date",value:(0,r.CQ)(Date.now(),e.userTimeZone)}},{kind:i.yp.ContextValue,id:s,value:{type:"date",value:(0,r.hT)(Date.now(),e.userTimeZone)}},{kind:i.yp.ContextValue,id:c,value:{type:"block",value:o}}]}}}function b(e){const t=u(),o=m(),n=d(),r={kind:i.yp.ContextValue,id:n,name:e.intl.formatMessage(c.buttonPage),type:{type:"block",collection:e.collectionPointer}};return{value:{valueTypes:[{kind:i.yp.ContextValue,id:t,name:e.intl.formatMessage(c.now),type:{type:"date"}},{kind:i.yp.ContextValue,id:o,name:e.intl.formatMessage(c.today),type:{type:"date"}},r]}}}},23290:(e,t,o)=>{o.d(t,{E2:()=>a,FP:()=>r,Gl:()=>d,Xp:()=>p,lK:()=>i,o9:()=>s,ss:()=>c,xZ:()=>l});const n={duplicate_blocks:{display:!0},create_page:{display:!0},modal_confirmation:{display:!0},open_page:{display:!0},query_collection:{display:!0},slack_notification:{display:!0},update_pages:{display:!0},complete_sprint:{display:!1}};function r(e){return Object.entries(n).filter((t=>{let[o,n]=t;return n[e]})).map((e=>{let[t]=e;return t}))}function i(e,t){return n[e][t]}const a=["replace","append","remove"];function s(e){return(null==e?void 0:e.action)||"replace"}const l=100,c=50,d={recurrence:{min:1,max:1},notification_event:{min:1,max:1},button:{min:0,max:"default_bound"},event:{min:1,max:"default_bound"}};function p(e){return i(e.type,"display")}},36576:(e,t,o)=>{o.d(t,{sU:()=>x,xU:()=>b});o(57658);var n=o(41432),r=o(99036),i=o(14215),a=o(38297),s=o(72126),l=o(59753),c=o(63306),d=o(26825),p=o(606),u=o(21202),m=o(70279),g=o(33709),h=o(23867),f=o(62965),y=o(70203),v=o(97880);async function b(e){const{loadRecordValue:t,operationPointers:o,getInitialRecordModel:n,getFinalRecordModel:r}=e,a=[],c=[];return await Promise.all(o.map((async e=>{if((0,p.$O)(e,u.iU)){const o=n.getRecordValue(e),d=r.getRecordValue(e),p=null==d?void 0:d.space_id,m={...e,spaceId:(0,h.C)(p)},g=(0,i.E)(S(o),S(d));if(await Promise.all([...g.deleted.map((async o=>{await async function(e){const t=e.getInitialRecordModel.getRecordValue({table:u.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0;const o=e.getFinalRecordModel.getRecordValue({table:u.iU,id:e.blockId});if(o&&o.parent_id!==e.parentId)return!0;if(!o){const t=await e.loadRecordValue({table:u.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0}return!1}({loadRecordValue:t,blockId:o,parentId:e.id,getInitialRecordModel:n,getFinalRecordModel:r})&&c.push({block_id:o,mentioned_from:{type:"reference",parent_block_id:e.id,parent_pointer:m}})})),...g.created.map((async o=>{await async function(e){const t=e.getFinalRecordModel.getRecordValue({table:u.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0;if(!t){const t=await e.loadRecordValue({table:u.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0}return!1}({loadRecordValue:t,blockId:o,parentId:e.id,getFinalRecordModel:r})&&a.push({block_id:o,mentioned_from:{type:"reference",parent_block_id:e.id,parent_pointer:m}})}))]),o&&d&&o.parent_id!==d.parent_id){if(o.parent_table===u.iU){let n=r.getRecordValue({table:u.iU,id:o.parent_id,spaceId:o.space_id});n||(n=await t({table:u.iU,id:o.parent_id,spaceId:o.space_id})),n&&n.content&&n.content.includes(e.id)&&a.push({block_id:e.id,mentioned_from:{type:"reference",parent_block_id:(0,v.xL)(o.parent_id),parent_pointer:m}})}if(d.parent_table===u.iU){let o=r.getRecordValue({table:u.iU,id:d.parent_id,spaceId:d.space_id});o||(o=await t({table:u.iU,id:d.parent_id})),o&&o.content&&!o.content.includes(e.id)&&a.push({block_id:e.id,mentioned_from:{type:"reference",parent_block_id:(0,v.xL)(d.parent_id),parent_pointer:{id:d.parent_id,table:u.iU,spaceId:d.space_id}}})}}let f;if(o&&(f=l.kk.fromBlock(o).getCollectionPointer()),(!o||!f)&&d){const e=l.kk.fromBlock(d).getCollectionPointer();if(e){let o=r.getRecordValue(e);o||(o=await t(e)),o&&o.parent_id!==d.id&&a.push({block_id:(0,v.xL)(o.parent_id),mentioned_from:{type:"collection_reference",block_id:d.id,pointer:{id:d.id,spaceId:d.space_id,table:u.iU}}})}}const y=(0,i.N)(w(o),w(d),_);for(const{blockId:t,propertyId:n}of y.created)a.push({block_id:t,mentioned_from:{type:"property_mention",block_id:e.id,property_id:n,pointer:m}});for(const{blockId:t,propertyId:n}of y.deleted)c.push({block_id:t,mentioned_from:{type:"property_mention",block_id:e.id,property_id:n,pointer:m}});const b=I(o),k=I(d);b&&!s.Xy(b,k)&&c.push({block_id:b.id,mentioned_from:{type:"alias",pointer:m}}),k&&!s.Xy(b,k)&&a.push({block_id:k.id,mentioned_from:{type:"alias",pointer:m}});const x=C(o),T=C(d);x&&!s.Xy(x,T)&&c.push({block_id:x.id,mentioned_from:{type:"transclusion_reference",pointer:m}}),T&&!s.Xy(x,T)&&a.push({block_id:T.id,mentioned_from:{type:"transclusion_reference",pointer:m}})}else if((0,p.$O)(e,m.x_)){const t=n.getRecordValue(e),o=r.getRecordValue(e),s=null==o?void 0:o.space_id,l={...e,spaceId:(0,h.C)(s)},d=(0,i.E)(k(t),k(o));for(const n of d.created)a.push({block_id:n,mentioned_from:{type:"comment_mention",comment_id:e.id,pointer:l}});for(const n of d.deleted)c.push({block_id:n,mentioned_from:{type:"comment_mention",comment_id:e.id,pointer:l}})}}))),{createdBacklinks:a,deletedBacklinks:c}}function S(e){const t=l.kk.fromValue(u.iU,e);return t?t.getContentIds():[]}function _(e){return`${e.blockId}${e.propertyId}`}function w(e){const t=l.kk.fromValue(u.iU,e),o=[];if(!t)return o;const n=t.getProperties();if(!n)return o;for(const r in n){const e=y.jDe(t.getProperty(r));for(const t of e)o.push({propertyId:r,blockId:t})}return o}function k(e){const t=l.kk.fromValue(m.x_,e);return t&&t.alive?y.jDe(t.getText()):[]}function x(e){window.__c={n:"filterBacklinksToHide"};const{actor:t,blockId:o,backlinks:i,getRecordModel:p}=e,y=(0,c.DW)({table:u.iU,id:o},p),b=s.Z$(y),S=y[0];if(!b||"block"!==S.table)return[];const _=(0,d.IJ)({actor:t,ancestors:y});return i.filter((e=>{const o=function(e){var t,o,n,r;return"comment_mention"===e.mentioned_from.type?{table:m.x_,id:e.mentioned_from.comment_id,spaceId:(0,h.C)(null===(t=e.mentioned_from.pointer)||void 0===t?void 0:t.spaceId)}:"reference"===e.mentioned_from.type?{table:u.iU,id:e.mentioned_from.parent_block_id,spaceId:(0,h.C)(null===(o=e.mentioned_from.parent_pointer)||void 0===o?void 0:o.spaceId)}:"property_mention"===e.mentioned_from.type?{table:u.iU,id:e.mentioned_from.block_id,spaceId:(0,h.C)(null===(n=e.mentioned_from.pointer)||void 0===n?void 0:n.spaceId)}:"collection_reference"===e.mentioned_from.type?{table:u.iU,id:e.mentioned_from.block_id,spaceId:(0,h.C)(null===(r=e.mentioned_from.pointer)||void 0===r?void 0:r.spaceId)}:"alias"===e.mentioned_from.type||"transclusion_reference"===e.mentioned_from.type?e.mentioned_from.pointer:void(0,v.t1)(e.mentioned_from)}(e),i=(0,c.DW)(o,p);if(!(0,c.Zg)(i))return!1;const s=(0,d.IJ)({actor:t,ancestors:i});if(s){if(!_)return!1;if(!(0,f.Z)(s.from,_.from))return!1}if(i.some((e=>e.table===g.qF&&e.resolved)))return!1;if("property_mention"===e.mentioned_from.type){var y;const t=p({table:u.iU,id:e.mentioned_from.block_id,spaceId:(0,h.C)(null===(y=e.mentioned_from.pointer)||void 0===y?void 0:y.spaceId)});if(!t)return!1;const o=(0,a.ky)({block:t,getRecordModel:p});if(o){const t=l.kk.fromCollection(o);if("title"!==e.mentioned_from.property_id){const n=r.oC(o),i=e.mentioned_from.property_id,s=n[i];if(!s)return!1;if("relation"===s.type){const e=(0,a.ky)({block:S,getRecordModel:p}),o=r.F0(s);if(!e||e.id!==o)return!1;if(r.EY({...t.pointer,propertyId:i,propertySchema:s},e))return!1}else if("title"!==s.type&&"text"!==s.type)return!1}}else if("title"===e.mentioned_from.property_id){if(!(0,n.XD)(t.type))return!1}else{if("caption"!==e.mentioned_from.property_id)return!1;if(!l.kk.fromBlock(t).isType(n.oe))return!1}}const b=(0,c.zN)(i)[0],w=(0,c.uJ)({table:u.iU,id:e.block_id},p)[1];return!b||!w||b.id!==w.id}))}function I(e){const t=l.kk.fromValue(u.iU,e);if(t&&"alias"===t.type)return t.getAliasTargetPointer()}function C(e){const t=l.kk.fromValue(u.iU,e);if(t&&"transclusion_reference"===t.type)return t.getTransclusionReferenceTargetPointer()}},49271:(e,t,o)=>{o.d(t,{N7:()=>i,ZD:()=>a});var n=o(8848),r=o(82990);function i(e){return{color:n.ZP.defaultText,fill:"currentColor",lineHeight:1.5,fontFamily:r.Z.getCompositeFontFamily(e).sans}}const a={paddingTop:3,paddingBottom:3,paddingLeft:2,paddingRight:2}},14248:(e,t,o)=>{o.d(t,{Ko:()=>C,ND:()=>D,RA:()=>x,WL:()=>A,Xq:()=>j,hz:()=>O,r9:()=>Z,wg:()=>L,zk:()=>I});o(57658);var n=o(76205),r=o(30823),i=o(14714),a=o(99036),s=o(80951),l=o(40506),c=o(53877),d=o(76725),p=o(72126),u=o(59753),m=o(33317),g=o(4615),h=o(74446),f=o(606),y=o(21202),v=o(19889),b=o(70203),S=o(97880);function _(e){const t=[],o=[];for(const[n,r]of Object.entries(e))r&&((0,a.S4)(n)||("person"===r.type?t.push(n):"date"===r.type&&o.push(n)));return{date:o,person:t}}const w=b.V3y(", ");function k(e,t){const o={command:"update",args:t,pointer:{table:y.iU,id:e.id},path:["properties"]};return u.kk.fromValue(e.table,(0,m.lK)(o,e.__IM_SORRY__getValue()))}function x(e){const{block:t,schema:o,propertyMapping:r,filter:i,userFilterContext:a,groupsPointer:s,relativeVariableResult:l,getRecordModel:c,intl:d,resultCache:m}=e,{userId:g,userTimeZone:f,userStartOfWeek:v}=a;let b=t;const S=u.om.tryUntilFound(u.om.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:o}=e;if(t===y.iU&&o===b.id)return b}),h.mF.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:o}=e;if(t===y.iU&&o===b.id)return b.__IM_SORRY__getValue()}))),c),_={};for(const n of s)Object.assign(_,B({block:b,getRecordModel:S,schema:o,propertyMapping:r,group:n,intl:d,userFilterContext:a,relativeVariableResult:l,resultCache:m})),b=k(t,_);if(i){const e=F({block:b,schema:o,filter:i,propertyMapping:r,userFilterContext:a,relativeVariableResult:l,getRecordModel:c,intl:d,resultCache:m}),n="failsFilter"===e.type||"coercedByFilter"===e.type?e.update??{}:{};Object.assign(_,n),b=k(t,_)}for(const n of s)Object.assign(_,B({block:b,getRecordModel:S,schema:o,propertyMapping:r,group:n,intl:d,userFilterContext:a,relativeVariableResult:l,resultCache:m})),b=k(t,_);const w=k(b,_),x=p.yW(s.map((e=>{const t=I({group:e,schema:o,timeZone:f}),r=t?(0,n.q)({context:{schema:o,userId:g,userTimeZone:f,userStartOfWeek:v,relativeVariableResult:l,intl:d},filter:t}):void 0;return Boolean(r&&r({block:w,getRecordModel:c,propertyMapping:void 0,resultCache:m}))}))),C=i?(0,n.q)({filter:i,context:{schema:o,userId:g,userTimeZone:f,userStartOfWeek:v,relativeVariableResult:l,intl:d}}):void 0,T=!C||C({block:w,getRecordModel:c,propertyMapping:void 0,resultCache:m});return{coercionSucceeded:x&&T,update:_}}function I(e){const t=C(e);return t?(0,n.vA)(t)?t:{operator:"and",filters:[t]}:void 0}function C(e){const{schema:t,group:o,timeZone:n}=e,r=o.property,a=t[r];if(!a)return;const s=o.value;if((0,i.LG)(a)&&s.type===a.type){if(void 0===s.value)return{property:r,filter:{operator:"is_empty"}};if("select"===a.type)return"string"==typeof s.value?{property:r,filter:{operator:"enum_is",value:{type:"exact",value:s.value}}}:void 0;if("status"===a.type)return void 0!==s.value&&"status"===s.type?{property:r,filter:{operator:"status_is",value:"by_group"===s.value.type?{type:"is_group",value:s.value.group}:{type:"is_option",value:s.value.option}}}:void 0;if((0,i.pd)(a.type))return"object"==typeof s.value&&s.type===a.type?{property:r,filter:{operator:"person_contains",value:{type:"exact",value:s.value}}}:void 0;if("relation"===a.type)return"object"==typeof s.value&&"relation"===s.type?function(e,t){if((0,i.RA)(t.value))return{property:e,filter:{operator:"relation_contains",value:{type:"exact",value:t.value.id}}};if((0,i.t2)(t.value))return{property:e,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"builtin",variable:t.value.value.variable}}}}}(r,s):void 0;if("location"===a.type)return"object"==typeof s.value&&"location"===s.type?{property:r,filter:{operator:"location_is",value:{type:"exact",value:s.value.id}}}:void 0;if("multi_select"===a.type)return"string"==typeof s.value?{property:r,filter:{operator:"enum_contains",value:{type:"exact",value:s.value}}}:void 0;if((0,i.A1)(a.type)){if(s.type!==a.type)return;return T(s.value,o.property,n)}if((0,i.HB)(a.type)){if(s.type!==a.type)return;return M(s.value,o.property)}if("number"===a.type){if("number"!==s.type)return;return P(s.value,o.property)}if("checkbox"===a.type){if("checkbox"!==s.type)return;return{property:r,filter:{operator:"checkbox_is",value:{type:"exact",value:s.value}}}}if("formula"===a.type){if("formula"!==s.type)return;const e=s.value;if(void 0===e.value)return;if((0,i.R7)(e))return M(e.value,o.property);if("number"===e.type)return P(e.value,o.property);if("checkbox"===e.type)return{property:r,filter:{operator:"checkbox_is",value:{type:"exact",value:e.value}}};if((0,i.Mc)(e))return T(e.value,o.property,n);if((0,i.q6)(e))return function(e,t){return{property:e,filter:{operator:"person_contains",value:{type:"exact",value:t.value}}}}(o.property,e);if((0,i.tL)(e))return(0,i.RA)(e.value)?{property:r,filter:{operator:"relation_contains",value:{type:"exact",value:e.value.id}}}:void 0;(0,S.t1)(e)}(0,S.t1)(a.type)}}function T(e,t,o){const n=(0,i.Hk)(e,o);return{property:t,filter:{operator:"date_is_within",value:{type:"exact",value:c.OQ.toPersistedDateRange(n,o)}}}}function M(e,t){if("alphabet_prefix"===e.type){const o=e.value;return isNaN(parseInt(o))?{operator:"or",filters:[{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value.toUpperCase()}}},{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value.toLowerCase()}}}]}:{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value}}}}return"other"===e.type?{property:t,filter:{operator:"string_has_no_alphabet_prefix"}}:"exact"===e.type?{property:t,filter:{operator:"string_is",value:{type:"exact",value:e.value}}}:void(0,S.t1)(e)}function P(e,t){if("range"===e.type){const{start:o,end:n}=e;return{operator:"and",filters:[{property:t,filter:{operator:"number_greater_than_or_equal_to",value:{type:"exact",value:o}}},{property:t,filter:{operator:"number_less_than",value:{type:"exact",value:n}}}]}}if("out_of_range"===e.type){const{start:o,end:n}=e;return{operator:"or",filters:[{property:t,filter:{operator:"number_less_than",value:{type:"exact",value:o}}},{property:t,filter:{operator:"number_greater_than_or_equal_to",value:{type:"exact",value:n}}}]}}(0,S.t1)(e)}function A(e,t){const o=e.property,n=null==t?void 0:t[o];if(null!=n&&n.derived_property_record_metadata)return!1;if(n&&s.A0(n))return!1;const r=e.value;return!r.value||("select"===r.type||"multi_select"===r.type||"status"===r.type||"person"===r.type||"checkbox"===r.type||"relation"===r.type||"date"===r.type||"number"===r.type||((0,i.R7)(r)?"exact"===r.value.type:"formula"!==r.type&&"created_by"!==r.type&&"last_edited_by"!==r.type&&"created_time"!==r.type&&"last_edited_time"!==r.type&&"location"!==r.type&&"last_visited_time"!==r.type&&void(0,S.t1)(r.type)))}function D(e){const{schema:t,group:o,block:n,resultCache:r}=e;if(!A(o,t))return{};const a=function(e){const{schema:t,group:o}=e,n=o.property,r=t[n];if(!r)return;const a=o.value;return(0,i.LG)(r)&&a.type===r.type&&void 0!==a.value?"person"===r.type?"object"==typeof a.value&&"person"===a.type?{property:n,filter:{operator:"person_does_not_contain",value:{type:"exact",value:a.value}}}:void 0:"relation"===r.type?"relation"===a.type&&(0,i.RA)(a.value)?{property:n,filter:{operator:"relation_does_not_contain",value:{type:"exact",value:a.value.id}}}:"relation"===a.type&&(0,i.t2)(a.value)?{property:n,filter:{operator:"relation_does_not_contain",value:{type:"relative",value:{type:"builtin",variable:a.value.value.variable}}}}:void 0:"location"===r.type?"object"==typeof a.value&&"location"===a.type?{property:n,filter:{operator:"location_is_not",value:{type:"exact",value:a.value.id}}}:void 0:"multi_select"===r.type?"string"==typeof a.value?{property:n,filter:{operator:"enum_does_not_contain",value:{type:"exact",value:a.value}}}:void 0:void("select"!==r.type&&"status"!==r.type&&"checkbox"!==r.type&&"date"!==r.type&&"text"!==r.type&&"title"!==r.type&&"url"!==r.type&&"email"!==r.type&&"phone_number"!==r.type&&"number"!==r.type&&"formula"!==r.type&&"created_by"!==r.type&&"last_edited_by"!==r.type&&"created_time"!==r.type&&"last_edited_time"!==r.type&&"last_visited_time"!==r.type&&(0,S.t1)(r)):void 0}({schema:t,group:o});if(!a)return{};const s=N({...e,property:a.property,filter:a.filter,schema:t,block:n,resultCache:r});return("failsFilter"===s.type||"coercedByFilter"===s.type)&&s.update||{}}function B(e){const{schema:t,group:o,block:r,userFilterContext:i}=e,{userTimeZone:a}=i;if(!A(o,t))return{};const s=C({schema:t,group:o,timeZone:a});if(!s||!(0,n.aN)(s))return{};const l=N({...e,property:s.property,filter:s.filter,schema:t,block:r});return("failsFilter"===l.type||"coercedByFilter"===l.type)&&l.update||{}}function R(e){const{dateValue:t,timestamp:o,userTimeZone:n}=e;if("date"===t.type)return{...c.hT(o,n),reminder:t.reminder};if("datetime"===t.type)return{...c.CQ(o,n),reminder:t.reminder};if("daterange"===t.type){const e=c.DF(l.Nh(t),n).valueOf(),r=c.DF(l.v3(t),n).valueOf()-e;return{...c.fZ(o,o+r,n),reminder:t.reminder}}if("datetimerange"===t.type){const e=c.Sy(l.C1(t)).valueOf(),r=c.Sy(l.C1(t)).valueOf()-e;return{...c.iC(o,o+r,n),reminder:t.reminder}}(0,S.t1)(t)}const E={text:function(e){const{filter:t,value:o}=e;if("is_empty"===t.operator)return{type:"text",value:void 0};if("is_not_empty"===t.operator)return;if("string_has_no_alphabet_prefix"===t.operator)return;const n=(t.value.value||"").trim();return"string_is_not"===t.operator||"string_does_not_contain"===t.operator?{type:"text",value:void 0}:"string_is"===t.operator?{type:"text",value:n}:"string_contains"===t.operator||"string_ends_with"===t.operator?{type:"text",value:(o.value||"")+n}:"string_starts_with"===t.operator?{type:"text",value:n+(o.value||"")}:void(0,S.t1)(t.operator)},checkbox:function(e){const{filter:t}=e,o=t.value;return"checkbox_is"===t.operator?{type:"checkbox",value:Boolean(o.value)}:"checkbox_is_not"===t.operator?{type:"checkbox",value:!Boolean(o.value)}:void(0,S.t1)(t.operator)},select:function(e){var t;const{filter:o,propertySchema:r}=e;if("is_empty"===o.operator)return{type:"select",value:void 0};if("is_not_empty"===o.operator)return{type:"select",value:r.options&&r.options.length>0?r.options[0].value:void 0};const i=null===(t=(0,n.mg)(o)[0])||void 0===t?void 0:t.value;return void 0!==i?"enum_is"===o.operator?{type:"select",value:i}:"enum_is_not"===o.operator?{type:"select",value:void 0}:void(0,S.t1)(o.operator):void 0},multi_select:function(e){var t;const{filter:o,propertySchema:r,value:i}=e;if("is_empty"===o.operator)return{type:"multi_select",value:void 0};if("is_not_empty"===o.operator)return{type:"multi_select",value:r.options&&r.options.length>0?[r.options[0].value]:void 0};const a=null===(t=(0,n.qC)(o)[0])||void 0===t?void 0:t.value;if(void 0===a)return;const s=i.value||[];return"enum_contains"===o.operator?{type:"multi_select",value:[...s,a]}:"enum_does_not_contain"===o.operator?{type:"multi_select",value:s.filter((e=>e!==a))}:void(0,S.t1)(o.operator)},status:function(e){const{filter:t,propertySchema:o}=e,r=o.groups??[],i=o.options??[];if("is_empty"===t.operator)return{type:"status",option:void 0,group:void 0};if("is_not_empty"===t.operator)return{type:"status",option:o.options&&o.options.length>0?o.options[0].value:void 0,group:o.groups&&o.groups.length>0?o.groups[0].name:void 0};const a=(0,n.wB)(t);if(0===a.length)return;const s=r.map((e=>{const t=i.filter((t=>{var o;return null===(o=e.optionIds)||void 0===o?void 0:o.includes(t.id)}));return{group:e,groupOptions:t}}));if("status_is"===t.operator){const{type:e,value:t}=a[0];if("is_group"===e){var l;const e=r.findIndex((e=>e.name===t)),o=e>=0?s[e]:void 0;return{type:"status",group:null==o?void 0:o.group.name,option:null==o||null===(l=o.groupOptions[0])||void 0===l?void 0:l.value}}if("is_option"===e){const e=i.find((e=>e.value===t)),o=e&&r.find((t=>{var o;return null===(o=t.optionIds)||void 0===o?void 0:o.includes(e.id)}));return{type:"status",group:null==o?void 0:o.name,option:null==e?void 0:e.value}}(0,S.t1)(e)}if("status_is_not"===t.operator)return{type:"status",group:void 0,option:void 0};(0,S.t1)(t.operator)},relation:function(e){var t;const{filter:o,value:r,propertySchema:i,relativeVariableResult:a}=e;if("is_empty"===o.operator)return{type:"relation",value:void 0};if("is_not_empty"===o.operator)return;const s=(0,n.YO)(o),l=null===(t=s[0])||void 0===t?void 0:t.type;let c;var d;if("exact"===l)c=null===(d=s[0])||void 0===d?void 0:d.value;else if("relative"===l){var p,u;const e=null===(p=i.collection_pointer)||void 0===p?void 0:p.id;if(!e||!a)return;c=a[e][null===(u=s[0])||void 0===u?void 0:u.value.variable]}if(void 0===c)return;const m=r.value||[];return"relation_contains"===o.operator?{type:"relation",value:[...m,{id:c,table:y.iU,spaceId:0!==m.length?m[0].spaceId:void 0}]}:"relation_does_not_contain"===o.operator?{type:"relation",value:m.filter((e=>e.id!==c))}:void(0,S.t1)(o.operator)},person:function(e){const{filter:t,userFilterContext:o,value:r}=e,{userId:i}=o;if("is_empty"===t.operator)return{type:"person",value:void 0};if("is_not_empty"===t.operator)return i?{type:"person",value:[{table:v.KJ,id:i}]}:void 0;const a=(0,n.R8)(t)[0];if(!a)return;const s=(0,n.l$)({operatorValue:a,userId:i});if(void 0===s)return;const l=r.value||[];return"person_contains"===t.operator?{type:"person",value:[...l,s]}:"person_does_not_contain"===t.operator?{type:"person",value:l.filter((e=>!p.Xy(e,s)))}:void(0,S.t1)(t.operator)},number:function(e){const{filter:t}=e;if("is_empty"===t.operator)return{type:"number",value:void 0};if("is_not_empty"===t.operator)return{type:"number",value:0};const o=t.value.value;return void 0===o||p.i2(o)?void 0:"number_equals"===t.operator||"number_greater_than_or_equal_to"===t.operator||"number_less_than_or_equal_to"===t.operator?{type:"number",value:o}:"number_less_than"===t.operator?{type:"number",value:o-1}:"number_greater_than"===t.operator?{type:"number",value:o+1}:"number_does_not_equal"===t.operator?{type:"number",value:void 0}:void(0,S.t1)(t.operator)},date:function(e){const{filter:t,userFilterContext:o,value:r}=e,{userTimeZone:i,userStartOfWeek:a}=o;if("is_empty"===t.operator)return{type:"date",value:void 0};if("is_not_empty"===t.operator)return{type:"date",value:c.Lg(i)};const s=r.value;if((0,n.TQ)(t)){const e=(0,n.sw)({operatorValue:t.value,userTimeZone:i,userStartOfWeek:a});if(void 0===s){const t=c.Lg(i),o=c.NK(t,i).start.valueOf();return void 0!==e.start&&void 0!==e.end&&o>=e.start&&o<=e.end?{type:"date",value:t}:void 0!==e.start?{type:"date",value:c.hT(e.start,i)}:void 0!==e.end?{type:"date",value:c.hT(e.end,i)}:void 0}const o=c.NK(s,i).start.valueOf();return void 0!==e.end&&o>e.end?{type:"date",value:R({dateValue:s,timestamp:e.end,userTimeZone:i})}:void 0!==e.start&&o<e.start?{type:"date",value:R({dateValue:s,timestamp:e.start,userTimeZone:i})}:void 0}const l=t.value,d=(0,n.og)({operatorValue:l,userTimeZone:i});if(void 0!==d){if("date_is"===t.operator||"date_is_on_or_before"===t.operator||"date_is_on_or_after"===t.operator)return s?{type:"date",value:R({dateValue:s,timestamp:d,userTimeZone:i})}:{type:"date",value:c.hT(d,i)};if("date_is_before"===t.operator){const e=c.Xz({date:d,daysToAdd:-1});return s?{type:"date",value:R({dateValue:s,timestamp:e,userTimeZone:i})}:{type:"date",value:c.hT(e,i)}}if("date_is_after"===t.operator){const e=c.Xz({date:d,daysToAdd:1});return s?{type:"date",value:R({dateValue:s,timestamp:e,userTimeZone:i})}:{type:"date",value:c.hT(e,i)}}(0,S.t1)(t.operator)}},file:function(e){const{filter:t}=e;if("is_empty"===t.operator)return{type:"file",value:void 0};"is_not_empty"!==t.operator&&(0,S.t1)(t)},location:()=>{},verification:function(e){const{filter:t}=e;if("verification_is"===t.operator)return{type:"verification",value:void 0};"verification_is_not"!==t.operator&&(0,S.t1)(t.operator)}};function F(e){const{filter:t,block:o,schema:r,propertyMapping:i,userFilterContext:a,relativeVariableResult:s,getRecordModel:l,intl:c,resultCache:d}=e,{userId:p,userTimeZone:m,userStartOfWeek:g}=a,f=t.filters||[];if(0===f.length)return{type:"passesFilter"};if((0,n.q)({context:{schema:r,userId:p,userTimeZone:m,userStartOfWeek:g,relativeVariableResult:s,intl:c},filter:t})({block:o,getRecordModel:l,propertyMapping:void 0,resultCache:d}))return{type:"passesFilter"};if("or"===t.operator){const e=f.map((e=>(0,n.aN)(e)?N({intl:c,block:o,schema:r,propertyMapping:i,property:e.property,filter:e.filter,userFilterContext:a,getRecordModel:l,relativeVariableResult:s,resultCache:d}):(0,n.Mm)(e)?{type:"failsFilter"}:(0,n.vA)(e)?F({filter:e,intl:c,block:o,schema:r,propertyMapping:i,userFilterContext:a,relativeVariableResult:s,getRecordModel:l,resultCache:d}):void(0,S.t1)(e)));if(e.some((e=>"passesFilter"===e.type)))return{type:"passesFilter"};const t=e.find((e=>"coercedByFilter"===e.type));return t||(e.find((e=>"failsFilter"===e.type))||{type:"failsFilter"})}const v=[...f];v.reverse();let b="passesFilter";const _={};let w=o;const x=u.om.tryUntilFound(u.om.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:o}=e;if(t===y.iU&&o===w.id)return w}),h.mF.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:o}=e;if(t===y.iU&&o===w.id)return w.__IM_SORRY__getValue()}))),l);for(const u of v){if((0,n.Mm)(u))continue;const e=(0,n.aN)(u)?N({intl:c,block:w,schema:r,propertyMapping:i,property:u.property,filter:u.filter,userFilterContext:a,getRecordModel:x,relativeVariableResult:s,resultCache:d}):F({filter:u,intl:c,block:w,schema:r,propertyMapping:i,userFilterContext:a,relativeVariableResult:s,getRecordModel:x,resultCache:d});"coercedByFilter"===e.type&&"passesFilter"===b&&(b="coercedByFilter"),"failsFilter"===e.type&&(b="failsFilter"),("coercedByFilter"===e.type||"failsFilter"===e.type&&e.update)&&(Object.assign(_,e.update),w=k(o,_))}return"passesFilter"===b?{type:b}:{type:b,update:_}}function N(e){const{filter:t,block:o,property:i,schema:a,propertyMapping:l,userFilterContext:c,getRecordModel:d,relativeVariableResult:p,intl:u,resultCache:m}=e,{userId:g,userTimeZone:h,userStartOfWeek:f}=c;if((0,n.Y1)({context:{schema:a,userId:g,userTimeZone:h,userStartOfWeek:f,relativeVariableResult:p,intl:u},filter:t,property:i,depth:0})({block:o,getRecordModel:d,propertyMapping:l,resultCache:m}))return{type:"passesFilter"};if((0,n.a_)(t))return{type:"failsFilter"};const y=a[i];if(!y)return{type:"failsFilter"};if(!(0,r.BJ)(y))return{type:"failsFilter"};const v=(0,r.vc)(y.type),b=(0,r.ML)({filterValueType:v,block:o,propertyValue:s.wS(o,i,d),propertySchema:y,getRecordModel:d,collectionRequestContext:{userId:g,userTimeZone:h,intl:u,depth:0,visitedProperties:new Set,resultCache:new Map}}),S=(0,E[v])({filter:t,value:b,propertySchema:y,userFilterContext:c,relativeVariableResult:p});if(void 0===S)return{type:"failsFilter"};const _=(0,r.qg)({propertyType:y.type,filterValue:S});return{type:"coercedByFilter",update:{[(null==l?void 0:l[i])??i]:_}}}function j(e){const{blockProperties:t,oldSchema:o,newSchema:n}=e,r=Object.keys(o),i=Object.keys(n),a={propertyUpdate:function(e){const{blockProperties:t,oldSchema:o,newSchema:n}=e,r={},i=null==t?void 0:t.title,a=b.lcG(i),[s]=b.nai(i),{person:[l],date:[c]}=_(n),{person:[p],date:[u]}=_(o);if(l&&(null==t||!t[l])&&!p&&a.length>0){const e=Array.from(new Set(a));r[l]=(0,d.Z)(e.map((e=>b.YCD(b.tEo(e)))),(()=>w))}return!c||null!=t&&t[c]||u||!s||(r[c]=[b.YCD(b.pZr(s))]),r}({blockProperties:t,oldSchema:o,newSchema:n}),newSchema:n},s=["relation","auto_increment_id","verification"];for(const l of r){const e=o[l],r=null==t?void 0:t[l];if(e&&!s.includes(e.type)&&r){const r=i.find((e=>l===e))||i.find((t=>{const o=n[t];return Boolean(e&&o&&e.name.trim().toLowerCase()===o.name.trim().toLowerCase()&&e.type===o.type)}));if(r&&a.propertyUpdate)r!==l&&(a.propertyUpdate[r]=t[l]||null,a.propertyUpdate[l]=null);else{const e=(0,g.ZP)(),n=o[l];a.newSchema={...a.newSchema,[e]:n},a.propertyUpdate&&(a.propertyUpdate[e]=t[l]||null,a.propertyUpdate[l]=null)}}}return a}function O(e){const{block:t,schema:o,property:n,oldValue:r,newValue:a}=e;if(void 0===r.value)return{};if(void 0===a.value)return{};const l=t.getProperties();if(!l)return{};const c=l[n];if(!c)return{};const d=o[n];if(!d)return{};if(!(0,i.LG)(d))return{};if("status"===d.type||"select"===d.type||"multi_select"===d.type||"checkbox"===d.type)return function(e){const{propertySchema:t,property:o,oldValue:n,newValue:r,propertyValue:a}=e;if(void 0===n.value)return{};if(void 0===r.value)return{};if(!(0,i.LG)(t))return{};if("select"===t.type){if("select"!==n.type||"select"!==r.type)return{};if(void 0===r.value)return{};const e=s.Ak(a);return 0===e.length&&void 0===n.value||e.some((e=>(e||"").trim().toLowerCase()===(n.value||"").trim().toLowerCase()))?{[o]:s.O2(r.value)}:{}}if("multi_select"===t.type){if("multi_select"!==n.type||"multi_select"!==r.type)return{};if(void 0===r.value)return{};const e=s.Ak(a);if(!e.some((e=>e.trim().toLowerCase()===(n.value||"").trim().toLowerCase())))return{};const t=r.value,i=e.map((e=>e.trim().toLowerCase()===(n.value||"").trim().toLowerCase()?t:e));return{[o]:s.zq(i)}}if("status"===t.type){const e=t.groups??[],i=t.options??[];if("checkbox"===n.type&&"status"===r.type){if(s.Ml(a)!==n.value)return{};let t;if("by_group"===r.value.type){const o=r.value.group,n=e.find((e=>e.name===o)),a=i.find((e=>{var t;return e.id===(null==n||null===(t=n.optionIds)||void 0===t?void 0:t[0])}));t=null==a?void 0:a.value}else t=r.value.option;if(t)return{[o]:s.Is(t)}}var l;return"status"===n.type&&"status"===r.type?"by_option"!==n.value.type||"by_option"!==r.value.type||(null===(l=s.Ak(a))||void 0===l?void 0:l[0])!==n.value.option?{}:{[o]:s.Is(r.value.option)}:{}}if("checkbox"===t.type)return"status"!==n.type||"checkbox"!==r.type||"by_option"!==n.value.type?{}:s.Ak(a).includes(n.value.option)?{[o]:s._I(r.value)}:{};(0,S.t1)(t)}({propertySchema:d,property:n,propertyValue:c,oldValue:r,newValue:a});if("person"===d.type){if("person"!==r.type||"person"!==a.type)return{};if(void 0===r.value)return{};if(void 0===a.value)return{};const e=a.value,o=r.value,i=u.kk.fromBlock(t),l=s.DW({textValue:c,propertySchema:d,blockCreatorPointer:i.getCreatedByPointer()});if(!l.some((e=>p.Xy(e,o))))return{};const m=l.map((t=>p.Xy(t,o)?e:t));return{[n]:s.C1(m)}}if("relation"===d.type){if("relation"!==r.type||"relation"!==a.type||void 0===r.value||void 0===a.value)return{};if((0,i.t2)(r.value)||(0,i.t2)(a.value))return{};const e=a.value,t=r.value,o=s.rq(c);if(!o.some((e=>(0,f.qo)(e,t))))return{};const l=o.map((o=>(0,f.qo)(o,t)?e:o));return{[n]:s.ow(l)}}if((0,i.HB)(d.type)){if(r.type!==d.type||a.type!==d.type||void 0===r.value||void 0===a.value||"exact"!==r.value.type||"exact"!==a.value.type)return{};return b.QaF(c)!==r.value.value?{}:{[n]:(0,b.TPx)(a.value.value)}}if("date"===d.type||"number"===d.type||"formula"===d.type||"created_by"===d.type||"last_edited_by"===d.type||"created_time"===d.type||"last_edited_time"===d.type||"location"===d.type||"last_visited_time"===d.type)return{};(0,S.t1)(d.type)}function L(e){const{block:t,schema:o,property:r,value:a,timeZone:s,intl:l,getRecordModel:d,resultCache:p}=e,u=o[r];if(!u||!(0,i.LG)(u)||t.is_template)return!1;const m=C({schema:o,group:{property:r,value:a},timeZone:s});if(!m)return!1;return(0,n.q)({filter:{operator:"and",filters:[m]},context:{schema:o,intl:l,userId:void 0,userTimeZone:"UTC",userStartOfWeek:(0,c.aN)(),relativeVariableResult:void 0}})({block:t,getRecordModel:d,propertyMapping:void 0,resultCache:p})}const U={Todo:"To-do","To-do":"To-do","To do":"To-do","Not started":"To-do",Backlog:"To-do",Incomplete:"To-do",Waiting:"To-do","On hold":"To-do",Later:"To-do",Blocked:"To-do","In progress":"In progress",Building:"In progress",Designing:"In progress",Research:"In progress",Scoping:"In progress",Planning:"In progress","Needs review":"In progress",Reviewed:"In progress",Review:"In progress",Pending:"In progress",Recurring:"In progress","Review needed":"In progress","Edits needed":"In progress",Editing:"In progress",Complete:"Complete",Completed:"Complete",Done:"Complete",Finished:"Complete",Archive:"Complete",Archived:"Complete",Deleted:"Complete",Published:"Complete",Reverted:"Complete"};function Z(e,t){var o,n;const r=(0,a.I4)(e),i=r.groups??[],s=r.options??[],l=p.Cw(U,((e,t)=>t.toLowerCase())),c=new Set,d=new Set;for(const a of t){const e=s.findIndex((e=>e.value.toLowerCase()===a.value.toLowerCase()));if(e>-1){const t=s[e];if(!c.has(t.id)){d.add(a.id),c.add(t.id),s[e]={...a,id:t.id};continue}}const t=l[a.value.toLowerCase()],o=i.find((e=>e.name===t));var u;if(o)null===(u=o.optionIds)||void 0===u||u.push(a.id),d.add(a.id)}for(const[a,p]of i.entries()){var m;const e=null===(m=p.optionIds)||void 0===m?void 0:m.some((e=>d.has(e)));p.optionIds=(p.optionIds??[]).filter((t=>!(!d.has(t)&&!c.has(t))||!e))}null==i||null===(o=i[0].optionIds)||void 0===o||o.push(...t.filter((e=>!d.has(e.id))).map((e=>e.id)));const g=[...s,...t],h=[];for(const a of i)for(const e of a.optionIds??[]){const t=g.find((t=>t.id===e));t&&h.push(t)}const f=null===(n=h.find((e=>{var t;return(null===(t=r.groups)||void 0===t||null===(t=t[0].optionIds)||void 0===t?void 0:t[0])===e.id})))||void 0===n?void 0:n.value;return{type:"status",name:e,groups:i,options:h,defaultOption:f}}},34296:(e,t,o)=>{o.d(t,{S:()=>n});let n=function(e){return e[e.Source=0]="Source",e[e.Relation=1]="Relation",e[e.Automation=2]="Automation",e}({})},63144:(e,t,o)=>{o.d(t,{P:()=>r});var n=o(72126);function r(e,t){return t.getAlive()!==e.getAlive()||!n.Xy(t.getText(),e.getText())||!n.Xy(t.getContent(),e.getContent())}},94919:(e,t,o)=>{o.d(t,{W:()=>i});o(67294);var n=o(31919),r=o(85893);function i(e){const{cost:t,intl:o}=e,i=e.trailingZeroDisplay??"auto",a=e.currencySign??"accounting",s=n.n.fromValue(t);let l=o.formatNumber(s.amount/Math.pow(10,s.currencyValue.minorUnitDigits),{style:"currency",currency:s.currencyCode,currencyDisplay:"symbol",currencySign:a});return"stripIfInteger"===i&&(l=l.replace(new RegExp(`[.,]0{${s.currencyValue.minorUnitDigits}}(\\s+.*)?$`),"$1")),(0,r.jsx)(r.Fragment,{children:l})}},1274:(e,t,o)=>{o.d(t,{IC:()=>c,bM:()=>p,fz:()=>d,o0:()=>u});o(57658);var n=o(21202),r=o(77420),i=o(6287),a=o(13493),s=o(15047),l=o(97880);function c(e){const{targetTriggerType:t,targetParentPointer:o,targetSpaceId:n}=e;return"notification_event"===t||"event"===t?[{pointer:o,minimumRequiredRole:"editor"},{pointer:{id:n,table:s.bx},minimumRequiredRole:"read_and_write"}]:"recurrence"===t||"button"===t?[{pointer:o,minimumRequiredRole:"read_and_write"}]:void(0,l.t1)(t)}function d(e){const{automationValue:t,actionValues:o}=e,n=o.flatMap((e=>u(e))).filter(l.$K);return"notification_event"===t.trigger.type||"event"===t.trigger.type?(n.push({pointer:{id:t.parent_id,table:t.parent_table,spaceId:t.space_id},minimumRequiredRole:"editor"},{pointer:{id:t.space_id,table:s.bx},minimumRequiredRole:"read_and_write"}),(0,l.$K)(t.trigger.event.source)&&(t.trigger.event.source.type===a.n||t.trigger.event.source.type===i.v?n.push({pointer:t.trigger.event.source.pointer,minimumRequiredRole:"reader"}):"filter"===t.trigger.event.source.type||(0,l.t1)(t.trigger.event.source))):"recurrence"===t.trigger.type||"button"===t.trigger.type?n.push({pointer:{id:t.parent_id,table:t.parent_table,spaceId:t.space_id},minimumRequiredRole:"read_and_write"}):(0,l.t1)(t.trigger),n}function p(e){return"notification_event"===e.trigger.type||"event"===e.trigger.type?[{pointer:{id:e.parent_id,table:e.parent_table,spaceId:e.space_id},minimumRequiredRole:"editor"},{pointer:{id:e.space_id,table:s.bx},minimumRequiredRole:"read_and_write"}]:"recurrence"===e.trigger.type||"button"===e.trigger.type?[{pointer:{id:e.parent_id,table:e.parent_table,spaceId:e.space_id},minimumRequiredRole:"read_and_write"}]:void(0,l.t1)(e.trigger)}function u(e){if("create_page"===e.type){var t,o;const r=[];var i,a;if(null!==(t=e.config)&&void 0!==t&&t.collection)r.push({pointer:null===(i=e.config)||void 0===i?void 0:i.collection,minimumRequiredRole:"content_only_editor"});if(null!==(o=e.config)&&void 0!==o&&o.template_page_id)r.push({pointer:{id:null===(a=e.config)||void 0===a?void 0:a.template_page_id,table:n.iU,spaceId:e.space_id},minimumRequiredRole:"reader"});return r}var s,c;if("query_collection"===e.type){if(null!==(s=e.config)&&void 0!==s&&s.collection)return[{pointer:null===(c=e.config)||void 0===c?void 0:c.collection,minimumRequiredRole:"content_only_editor"}]}else if("update_pages"===e.type){var d;const t=null===(d=e.config)||void 0===d?void 0:d.target;if(!t)return[];if("collection"===t.type)return[{pointer:t.collection,minimumRequiredRole:"content_only_editor"}];if("page"===t.type)return[{pointer:t.page,minimumRequiredRole:"content_only_editor"}];if("variable"===t.type)return[];(0,l.t1)(t)}else if("open_page"===e.type){var p;const t=null===(p=e.config)||void 0===p?void 0:p.target;if(!t)return[];if("page"===t.type)return[{pointer:t.page,minimumRequiredRole:"reader"}];if("variable"===t.type)return[];(0,l.t1)(t)}else if("slack_notification"===e.type){var u;if(null!==(u=e.config)&&void 0!==u&&u.external_bot_id)return[{pointer:{id:e.config.external_bot_id,table:r.cZ},minimumRequiredRole:"editor"}]}else{if("duplicate_blocks"===e.type)return[];if("modal_confirmation"===e.type)return[];if("complete_sprint"===e.type){var m,g;const t=[];return null!==(m=e.config)&&void 0!==m&&m.sprint_collection&&t.push({pointer:e.config.sprint_collection,minimumRequiredRole:"editor"}),null!==(g=e.config)&&void 0!==g&&g.task_collection&&t.push({pointer:e.config.task_collection,minimumRequiredRole:"editor"}),t}(0,l.t1)(e)}}},86658:(e,t,o)=>{o.d(t,{Fd:()=>c,G_:()=>l,UE:()=>d,cW:()=>p,fV:()=>i,ze:()=>a});o(67294);var n=o(5366),r=o(85893);const i="v8",a=(0,n.defineMessages)({cookieSettingsLabel:{id:"cookieConsent.settings.label",defaultMessage:"Cookie settings"},customizeCookiesHeader:{id:"cookieConsent.customizeCookies.header",defaultMessage:"Customize cookies"},trackingTypeNecessaryTitle:{id:"cookieConsent.trackingTypeNecessary.title",defaultMessage:"Strictly necessary"},trackingTypeNecessaryCaption:{id:"cookieConsent.trackingTypeNecessary.caption",defaultMessage:"Essential for the site to function. Always On."},trackingTypePreferenceTitle:{id:"cookieConsent.trackingTypePreference.title",defaultMessage:"Functional"},trackingTypePreferenceCaption:{id:"cookieConsent.trackingTypePreference.caption",defaultMessage:"Used to remember preference selections and provide enhanced features."},trackingTypePerformanceTitle:{id:"cookieConsent.trackingTypePerformance.title",defaultMessage:"Analytics"},trackingTypePerformanceCaption:{id:"cookieConsent.trackingTypePerformance.caption",defaultMessage:"Used to measure usage and improve your experience."},trackingTypeTargetingTitle:{id:"cookieConsent.trackingTypeTargeting.title",defaultMessage:"Marketing"},trackingTypeTargetingCaption:{id:"cookieConsent.trackingTypeTargeting.caption",defaultMessage:"Used for targeted advertising."},trackingTypeTargetingSubtitleiOS:{id:"cookieConsent.trackingTypeTargeting.subtitleiOS",defaultMessage:"Not collected nor used within the iOS app"},cookieDismissButtonLabel:{id:"cookieConsent.dismissButton.label",defaultMessage:"Done"},acceptAllButtonLabel:{id:"cookieConsent.acceptAllButton.label",defaultMessage:"Accept all"},rejectAllButtonLabel:{id:"cookieConsent.rejectAllButton.label",defaultMessage:"Reject all"},moreOptionsButtonLabel:{id:"cookieConsent.moreOptionsButton.label",defaultMessage:"More options"},reloadAfterSaveMessage:{id:"cookieConsent.reloadAfterSave.message",defaultMessage:"Notion will now reload to apply your cookie preferences. Click okay to continue."}}),s=(0,n.defineMessages)({banner:{id:"cookieConsent.bannerDisclaimer.message",defaultMessage:"Notion uses cookies to offer you a better experience. See<cookielink>Cookie Notice</cookielink>for details."},settings:{id:"cookieConsent.settingsDisclaimer.message",defaultMessage:"Customize cookies. See<cookielink>Cookie Notice</cookielink>for details."},snackbar:{id:"cookieConsent.snackbarDisclaimer.message",defaultMessage:"Notion uses cookies. See<cookielink>Cookie Notice</cookielink>for details."}});function l(e,t){switch(e){case"necessary":return{title:a.trackingTypeNecessaryTitle,caption:a.trackingTypeNecessaryCaption};case"preference":return{title:a.trackingTypePreferenceTitle,caption:a.trackingTypePreferenceCaption};case"performance":return{title:a.trackingTypePerformanceTitle,caption:a.trackingTypePerformanceCaption};case"targeting":const e=t?a.trackingTypeTargetingSubtitleiOS:void 0;return{title:a.trackingTypeTargetingTitle,subtitle:e,caption:a.trackingTypeTargetingCaption}}}function c(e,t){return(0,r.jsx)(n.FormattedMessage,{...s[t],values:{cookielink:t=>(0,r.jsxs)(r.Fragment,{children:["Â ",e("https://www.notion.so/Cookie-Notice-bc186044eed5488a8387a9e94b14e58c",t),"Â "]})}})}const d={necessary:!0,performance:!0,preference:!0,targeting:!0},p={necessary:!0,performance:!1,preference:!1,targeting:!1}},57081:(e,t,o)=>{o.d(t,{Z:()=>l});var n=o(72126),r=o(70203),i=o(97880),a=o(82798),s=o(59579);class l{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.ops=e,function(e){for(let t=1;t<e.length;t++)(0,a.T)((0,s.$)(e[t-1].id,e[t].id)<0)}(e)}add(e){const t=this.findInsertionIndex(e.id);this.ops.splice(t,0,e)}findInsertionIndex(e){const t=this.ops.findIndex((t=>(0,s.$)(t.id,e)>0));return t>=0?t:this.ops.length}getOps(){return this.ops}getResolvedAnnotations(){const e=new Map;for(const t of this.ops){const o=t.type;"addAnnotation"===o?e.set(r.XSJ(t.annotation),t.annotation):"removeAnnotation"===o?e.delete(r.XSJ(t.annotationKey)):(0,i.t1)(o)}return[...e.values()]}containsOpId(e){return this.ops.some((t=>n.Xy(t.id,e)))}clone(){return new l([...this.ops])}equals(e){return n.Xy(this.ops,e.ops)}static equals(e,t){return e===t||(void 0===e||void 0===t?e===t:e.equals(t))}}},43993:(e,t,o)=>{o.d(t,{JE:()=>u,Jy:()=>c,KH:()=>p,vM:()=>d});var n=o(72126),r=o(70203),i=o(97880),a=o(82798),s=o(57081);class l{constructor(e){this.prev=void 0,this.next=void 0,this.annotationOpSetBefore=void 0,this.annotationOpSetAfter=void 0,this.id=e}startsWithId(e){return this.containsId(e)}endsWithId(e){return this.containsId(e)}containsId(e){return n.Xy(this.id,e)}getAnnotationOpSetForAnchor(e){return"before"===e?this.annotationOpSetBefore:"after"===e?this.annotationOpSetAfter:void(0,i.t1)(e)}maybeCreateAnnotationOpSetForAnchor(e,t){var o;if("before"===e)this.annotationOpSetBefore??=(null==t||null===(o=t.opSet)||void 0===o?void 0:o.clone())??new s.Z;else if("after"===e){var n;this.annotationOpSetAfter??=(null==t||null===(n=t.opSet)||void 0===n?void 0:n.clone())??new s.Z}else(0,i.t1)(e)}copyAnnotationOpSetTo(e){this.annotationOpSetBefore&&(e.annotationOpSetBefore=this.annotationOpSetBefore.clone()),this.annotationOpSetAfter&&(e.annotationOpSetAfter=this.annotationOpSetAfter.clone())}equals(e){return typeof this==typeof e&&s.Z.equals(this.annotationOpSetBefore,e.annotationOpSetBefore)&&s.Z.equals(this.annotationOpSetAfter,e.annotationOpSetAfter)}toString(){return`[${this.className}]`}}class c extends l{constructor(e,t,o,n){super(e),this.className="TextItem",this.deleted=!1,this.id=e,this.originId=t,this.content=o,this.length=n,this.verifyValueAndLength()}verifyValueAndLength(){(0,a.T)(!this.content||this.content.length===this.length,"TextItem content length must match item length"),(0,a.T)(this.length>0,"TextItem must have nonzero length"),(0,a.T)(!this.content||!(0,r.XoU)(this.content),"TextItem must not contain disallowed characters")}getStartId(){return this.id}getEndId(){const e=this.id;return[e[0],e[1]+this.length-1]}startsWithId(e){return n.Xy(this.getStartId(),e)}endsWithId(e){return n.Xy(this.getEndId(),e)}containsId(e){return"start"!==e&&"end"!==e&&this.id[0]===e[0]&&this.id[1]<=e[1]&&e[1]<=this.id[1]+this.length-1}getDefinedContent(){return(0,a.TO)(this.content)}isDeleted(){return this.deleted}setDeleted(){this.deleted=!0,this.content=void 0}splitBeforeId(e){return this.split(e,"before")}splitAfterId(e){return this.split(e,"after")}split(e,t){var o;(0,a.T)(this.length>1),(0,a.T)(this.containsId(e));const n=e[1]-this.id[1]+("after"===t?1:0);(0,a.T)(0<n&&n<this.length);const r=[this.id[0],this.id[1]+n],i=[this.id[0],this.id[1]+n-1],s=this.deleted?c.createDeleted(r,i,this.length-n):c.create(r,i,this.getDefinedContent().slice(n));this.annotationOpSetAfter&&(s.annotationOpSetAfter=this.annotationOpSetAfter.clone());const l=this.next;return this.next=s,s.prev=this,l&&(s.next=l,l.prev=s),this.content=null===(o=this.content)||void 0===o?void 0:o.slice(0,n),this.length=n,this.verifyValueAndLength(),this.annotationOpSetAfter=void 0,this.next=s,s}maybeMergeWithNext(){const e=this.next;if(!(e instanceof c))return!1;const t=this.getEndId(),o=e.getStartId();return!(!n.Xy(t,e.originId)||t[0]!==o[0]||t[1]!==o[1]-1||this.deleted!==e.deleted||void 0!==this.annotationOpSetAfter||void 0!==e.annotationOpSetBefore)&&(this.content&&e.content&&(this.content+=e.content),this.length+=e.length,this.verifyValueAndLength(),e.annotationOpSetAfter&&(this.annotationOpSetAfter=e.annotationOpSetAfter.clone()),this.next=e.next,e.next&&(e.next.prev=this),e.prev=void 0,e.next=void 0,!0)}getLength(){return this.length}clone(){const e=this.deleted?c.createDeleted(this.id,this.originId,this.length):c.create(this.id,this.originId,this.getDefinedContent());return this.copyAnnotationOpSetTo(e),e}equals(e){return super.equals(e)&&e instanceof c&&n.Xy(this.id,e.id)&&n.Xy(this.originId,e.originId)&&this.deleted===e.deleted&&this.content===e.content&&this.length===e.length}static create(e,t,o){return new c(e,t,o,o.length)}static createDeleted(e,t,o){const n=new c(e,t,void 0,o);return n.setDeleted(),n}toString(){return this.deleted?`[${this.className} (deleted)]`:`[${this.className} ${this.content}]`}}class d extends l{constructor(){super("start"),this.className="StartItem"}clone(){const e=new d;return this.copyAnnotationOpSetTo(e),e}equals(e){return super.equals(e)&&e instanceof d}}class p extends l{constructor(){super("end"),this.className="EndItem",this.originId="start"}clone(){const e=new p;return this.copyAnnotationOpSetTo(e),e}equals(e){return super.equals(e)&&e instanceof p}}class u extends l{constructor(e,t){super(e),this.className="SplitItem",this.id=e,this.originId=t}clone(){const e=new u(this.id,this.originId);return this.copyAnnotationOpSetTo(e),e}equals(e){return super.equals(e)&&e instanceof u&&n.Xy(this.id,e.id)&&n.Xy(this.originId,e.originId)}}},19056:(e,t,o)=>{o.d(t,{Z:()=>i});var n=o(82798);class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.value=e}get(){return this.value}set(e){this.value=e}}class i{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.valueHolder=void 0,this.valueHolder="number"==typeof e?new r(e):e,(0,n.T)(this.valueHolder.get()>=0)}reserveTicks(e){(0,n.T)(e>0);const t=this.valueHolder.get(),o=t+1;return this.valueHolder.set(t+e),o}maybeUpdateClock(e){return e>this.valueHolder.get()&&(this.valueHolder.set(e),!0)}getValue(){return this.valueHolder.get()}}},69920:(e,t,o)=>{o.d(t,{Z:()=>b,G:()=>h});o(21703),o(52262),o(24506),o(57658);var n=o(67266),r=o.n(n),i=o(72126),a=o(4615),s=o(70203),l=o(97880),c=o(82798),d=o(59579),p=o(43993),u=o(52136),m=o(19056);function g(e){switch(e.type){case"insertText":return e.id[1]+e.content.length-1;case"splitText":case"addAnnotation":case"removeAnnotation":return e.id[1]}}const h=(0,l.AO)((e=>e instanceof p.vM||e instanceof p.JE?{true:e}:{false:e})),f=(0,l.AO)((e=>e instanceof p.KH||e instanceof p.JE?{true:e}:{false:e})),y=(0,l.AO)((e=>e instanceof p.Jy?{true:e}:{false:e})),v=(0,l.AO)((e=>"end"===e?{false:e}:{true:e}));class b{constructor(e,t,o){this.textInstanceId=void 0,this.opClock=void 0,this.startItem=void 0,this.endItem=void 0,this.visibleCount=void 0,this.textInstanceId=e,this.opClock=t,this.startItem=o,this.endItem=(0,c.Fb)(u.s(o),f),this.visibleCount=u.TS(o),(0,c.T)(this.startItem!==this.endItem)}getStartItem(){return this.startItem}getEndItem(){return this.endItem}getVisibleCount(){return this.visibleCount}applyOperation(e){switch(e.type){case"insertText":this.applyInsertTextOperation(e);break;case"deleteText":this.applyDeleteTextOperation(e);break;case"splitText":this.applySplitTextOperation(e);break;case"addAnnotation":case"removeAnnotation":this.applyAnnotationOperation(e);break;default:(0,l.t1)(e)}}applyInsertTextOperation(e){const t=p.Jy.create(e.id,e.originId,e.content);this.integrateItem(t),this.opClock.maybeUpdateClock(g(e)),this.validateContent()}applyDeleteTextOperation(e){for(const t of e.ids){const e=(0,c.TO)(this.getItemWithOnlyId(t));if(!(e instanceof p.Jy))throw new Error("Cannot delete item");e.isDeleted()||(e.setDeleted(),this.visibleCount-=e.getLength(),e.prev instanceof p.Jy&&e.prev.maybeMergeWithNext(),e.maybeMergeWithNext())}this.validateContent()}applySplitTextOperation(e){const t=new p.JE(e.id,e.originId);this.integrateItem(t),this.opClock.maybeUpdateClock(g(e))}integrateItem(e){(0,c.T)(!this.containsOpId(e.id),`Already contains ID: ${e.id}`);const t=(0,c.TO)(this.getItemEndingWithId(e.originId));let o=t;for(;o.next&&!((0,d.D)(e.id,o.next.id)>0);)o=o.next;const n=o.next;if(o.next=e,e.prev=o,n&&(e.next=n,n.prev=e),e instanceof p.Jy&&(this.visibleCount+=e.getLength()),e instanceof p.JE){this.validateNotEndingWithHighSurrogate(t,"Cannot split content between a surrogate pair");const o=this.getPreceedingAnnotationOpSet({id:e.id,anchor:"before"});o&&e.maybeCreateAnnotationOpSetForAnchor("before",{opSet:o})}o instanceof p.Jy&&o.maybeMergeWithNext()}validateContent(){(0,c.T)(!s.PM3(this.getText()),"Content must not contain unpaired surrogates")}validateNotEndingWithHighSurrogate(e,t){if(!(e instanceof p.Jy)||e.isDeleted())return;const o=e.getDefinedContent().at(-1);o&&(0,c.T)("high"!==s.kG3(o),t)}applyAnnotationOperation(e){(0,c.T)(!this.containsOpId(e.id),`Already contains ID: ${e.id}`);const t=(0,c.TO)("before"===e.start.anchor?this.getItemStartingWithId(e.start.id):this.getItemEndingWithId(e.start.id)),o=(0,c.TO)("before"===e.end.anchor?this.getItemStartingWithId(e.end.id,{includeEndItem:!0}):this.getItemEndingWithId(e.end.id,{includeEndItem:!0}));let n=this.getPreceedingAnnotationOpSet(e.start);t.maybeCreateAnnotationOpSetForAnchor(e.start.anchor,{opSet:n});const r=this.iterateItemAnnotationOpSets({direction:"forward",from:e.start,to:e.end,includeSplitCharacters:!0});for(const{item:i,anchor:a}of r){i instanceof p.JE&&i.maybeCreateAnnotationOpSetForAnchor(a,{opSet:n});const t=(0,c.TO)(i.getAnnotationOpSetForAnchor(a));n=t.clone(),t.add(e)}o.maybeCreateAnnotationOpSetForAnchor(e.end.anchor,{opSet:n}),this.opClock.maybeUpdateClock(g(e))}getPreceedingAnnotationOpSet(e){const t=this.iterateItemAnnotationOpSets({direction:"backward",from:e});for(const{annotationOpSet:o}of t)return(0,c.TO)(o)}*iterateItems(e){yield*u.Hi(this.startItem,e)}*iterateItemAnnotationOpSets(e){const{direction:t,from:o,includeSplitCharacters:n}=e,r=e.to??("forward"===t?{id:this.endItem.id,anchor:"after"}:{id:this.startItem.id,anchor:"before"});let i=(0,c.TO)(this.getItemContainingId(o.id));(0,c.T)("before"===o.anchor?i.startsWithId(o.id):i.endsWithId(o.id));let a=o.anchor;for(;i;){if(i.containsId(r.id)&&a===r.anchor)return void(0,c.T)("before"===r.anchor?i.startsWithId(r.id):i.endsWithId(r.id));const e=i.getAnnotationOpSetForAnchor(a);switch(e?yield{item:i,anchor:a,annotationOpSet:e}:n&&i instanceof p.JE&&("forward"===t&&"before"===a||"backward"===t&&"after"===a)&&(yield{item:i,anchor:a,annotationOpSet:void 0}),t){case"forward":i="before"===a?i:i.next,a="before"===a?"after":"before";break;case"backward":i="after"===a?i:i.prev,a="after"===a?"before":"after";break;default:(0,l.t1)(t)}}}getItemStartingWithId(e,t){return this.getItem(e,{...t,shouldStartWithId:!0})}getItemEndingWithId(e,t){return this.getItem(e,{...t,shouldEndWithId:!0})}getItemWithOnlyId(e){return this.getItem(e,{shouldStartWithId:!0,shouldEndWithId:!0})}getItemContainingId(e,t){return this.getItem(e,t)}containsItemWithId(e,t){return Boolean(this.getItemContainingId(e,t))}getItem(e,t){const o=this.iterateItems({includeDeleted:!0,includeEndItem:null==t?void 0:t.includeEndItem});for(const n of o){if(n instanceof p.Jy&&n.containsId(e)){if("start"===e||"end"===e)continue;let o=n;return null!=t&&t.shouldStartWithId&&!o.startsWithId(e)&&(o=o.splitBeforeId(e)),null!=t&&t.shouldEndWithId&&!o.endsWithId(e)&&o.splitAfterId(e),o}if(n.containsId(e))return n}}findIndexOfItemId(e,t){const o=null==t?void 0:t.includeEndItem;let n=0;for(const r of this.iterateItems({includeDeleted:!0,includeEndItem:o}))if(r instanceof p.Jy){if(Array.isArray(e)&&r.containsId(e)){if(r.isDeleted())return n;const t=r.id[1];return n+(e[1]-t)}r.isDeleted()||(n+=r.getLength())}else if(r.containsId(e))return n}getItemIdsInRange(e,t){(0,c.T)(e<=t),(0,c.T)(0<=e&&t<this.visibleCount);const o=[];let n=-1;for(const r of this.iterateItems({includeDeleted:!1})){if(!(r instanceof p.Jy))continue;const i=n+1,a=i+r.getLength()-1;if(a<e){n=a;continue}if(t<i)break;const s=Math.max(0,e-i),l=Math.min(a-i,t-i),[c,d]=r.id;for(let e=s;e<l+1;e++)o.push([c,d+e]);n=a}return(0,c.T)(o.length===t-e+1),o}getItemIdAtIndex(e){return this.getItemIdsInRange(e,e)[0]}getItemIdBeforeIndex(e){const t=this.getItemIdAtIndex(e),o=(0,c.Fb)((0,c.TO)(this.getItemContainingId(t)),y);if(!o.startsWithId(t))return[t[0],t[1]-1];const n=(0,c.TO)(o.prev);return n instanceof p.Jy?n.getEndId():n.id}getItemIdAfterIndex(e){const t=this.getItemIdAtIndex(e);return this.getItemIdAfterItem(t)}getItemIdAfterItem(e){if("start"===e){(0,c.R9)(this.getStartItem(),p.vM);return(0,c.TO)(this.getStartItem().next).id}const t=(0,c.Fb)((0,c.TO)(this.getItemContainingId(e)),y);if(!t.endsWithId(e))return[e[0],e[1]+1];const o=(0,c.TO)(t.next);return o instanceof p.Jy?o.getStartId():o.id}getOriginItemIdForInsertionIndex(e){let t;if((0,c.T)(0<=e&&e<=this.visibleCount),e===this.visibleCount)t=this.getEndItem();else{const o=this.getItemIdAtIndex(e),n=(0,c.Fb)((0,c.TO)(this.getItemContainingId(o)),y);if(!n.startsWithId(o))return[o[0],o[1]-1];t=n}for(;t.prev;){const e=t.prev;if(e instanceof p.Jy&&!e.isDeleted())return e.getEndId();if(e instanceof p.KH)throw new Error("Unexpected");if(e.getAnnotationOpSetForAnchor("after"))return e instanceof p.Jy?e.getEndId():(0,c.Fb)(e.id,v);t=t.prev}return(0,c.Fb)((0,c.Fb)(t,h).id,v)}isLastOriginItemId(e){return i.Xy(this.getOriginItemIdForInsertionIndex(this.visibleCount),e)}containsOpId(e){for(const n of this.iterateItems({includeDeleted:!0,includeEndItem:!0})){var t,o;if(n.containsId(e))return!0;if(null!==(t=n.getAnnotationOpSetForAnchor("before"))&&void 0!==t&&t.containsOpId(e))return!0;if(null!==(o=n.getAnnotationOpSetForAnchor("after"))&&void 0!==o&&o.containsOpId(e))return!0}return!1}getTextValue(){const e=[];let t;for(const r of this.iterateItems({includeDeleted:!0})){var o,n;t=(null===(o=r.getAnnotationOpSetForAnchor("before"))||void 0===o?void 0:o.getResolvedAnnotations())??t,r instanceof p.Jy&&r.getLength()&&!r.isDeleted()&&(t?(t.length?e.push([r.getDefinedContent(),t]):e.push([r.getDefinedContent()]),t=void 0):e.length?(0,c.TO)(e.at(-1))[0]+=r.getDefinedContent():e.push([r.getDefinedContent()])),t=(null===(n=r.getAnnotationOpSetForAnchor("after"))||void 0===n?void 0:n.getResolvedAnnotations())??t}return e}getText(){const e=[];for(const t of this.iterateItems())t instanceof p.Jy&&e.push(t.getDefinedContent());return e.join("")}getSliceStartKey(){return`${this.textInstanceId},${r()(this.startItem.id)}`}getSliceKey(){return`${this.textInstanceId},${r()(this.startItem.id)},${r()(this.endItem.id)}`}static combineSlices(e){(0,c.T)(e.length>0);const{textInstanceId:t,opClock:o}=(0,c.TO)(e[0]),n=o.getValue(),i=new Map;for(const d of e){(0,c.T)(d.textInstanceId===t),(0,c.T)(d.opClock.getValue()===n);const e=r()(d.getStartItem().id);(0,c.T)(!i.has(e)),i.set(e,d)}const a=(0,c.TO)(i.get(r()("start")));i.delete(r()("start"));const s=a.startItem;let l=a.endItem;for(;"end"!==l.id;){const e=r()(l.id),t=(0,c.TO)(i.get(e));i.delete(e);const o=(0,c.TO)(t.startItem.next);l.next=o,o.prev=l,l=t.endItem}return(0,c.T)(0===i.size),new b(t,o,s)}splitIntoSlices(){const e=u.Eg(this.startItem);this.endItem=(0,c.Fb)(u.s(this.startItem),f),this.visibleCount=u.TS(this.startItem),(0,c.T)(this.startItem!==this.endItem);const t=[this];for(let o=1;o<e.length;o++)t.push(new b(this.textInstanceId,this.opClock,(0,c.Fb)(e[o],h)));return t}equals(e){if(this===e)return!0;if(this.textInstanceId!==e.textInstanceId)return!1;const t=[...this.iterateItems({includeDeleted:!0,includeEndItem:!0})],o=[...e.iterateItems({includeDeleted:!0,includeEndItem:!0})];if(t.length!==o.length)return!1;for(let n=0;n<t.length;n++){const e=o[n];if(!t[n].equals(e))return!1}return!0}static createEmpty(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZP)(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new m.Z;const o=new p.vM,n=new p.KH;return o.next=n,n.prev=o,new b(e,t,o)}}},46227:(e,t,o)=>{o.d(t,{Z:()=>u,w:()=>p});o(57658),o(52262),o(24506),o(21703),o(30541);var n=o(15095),r=o(72126),i=o(4615),a=o(70203),s=o(97880),l=o(82798),c=o(69920);const d={type:"contains",includeEndItem:!1},p=(0,i.ZP)();class u{constructor(e,t){this.parent=void 0,this.children=[],this.sessionId=e,this.textSlice=t}insertText(e,t){return this.insertTextValue(e,[[t]]),this}insertTextValue(e,t){const o=this.getOperationsForInsertTextValue(e,t).operations;for(const n of o){const e=n.type;"insertText"===e?this.applyInsertTextOperation(n):"addAnnotation"===e?this.applyAnnotationOperation(n):(0,s.t1)(e)}return this}findIndexOfItemId(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d,n=0;for(const r of this.iterateTextSliceTrees()){const i=r.getTextSlice();if(i.textInstanceId===e)switch(o.type){case"contains":const e=i.findIndexOfItemId(t,o);if(void 0!==e)return n+e;break;case"start":if(i.getStartItem().startsWithId(t))return n;break;case"end":if(i.getEndItem().endsWithId(t))return n+i.getVisibleCount();break;default:(0,s.t1)(o)}n+=i.getVisibleCount()}}getOperationsForInsertTextValue(e,t){const o=a.QaF(t),{operation:r,invertedOperation:i}=this.getOperationForInsertText(e,o),s=new n.W3(a.eeV(t)),{textSliceTree:l}=this.getTextSliceTreeAndOriginItemIdForInsertionIndex(e,"nodeWithContent"),{textSlice:c}=l,d=a.Sfs({textValue:t,startIndex:0,endIndex:o.length}).map((e=>{let{startIndex:t,endIndex:o,annotation:n}=e;const i=s.getStringStartIndex(t),l=s.getStringEndIndex(o-1),d=[this.sessionId,r.id[1]+i],p=a.J7s(n);let u,m;return a.$z2(p)?(u="before",m=l+1<s.getStringLength()?[this.sessionId,r.id[1]+l+1]:c.getItemIdAfterItem(r.originId)):(u="after",m=[this.sessionId,r.id[1]+l]),{type:"addAnnotation",textInstanceId:r.textInstanceId,id:[this.sessionId,c.opClock.reserveTicks(1)],start:{id:d,anchor:"before"},end:{id:m,anchor:u},annotation:n}}));return{operations:[r,...d],invertedOperations:[i]}}getOperationForInsertText(e,t){(0,l.T)(t.length>0);const{textSliceTree:o,originId:n}=this.getTextSliceTreeAndOriginItemIdForInsertionIndex(e,"nodeWithContent"),{textSlice:r}=o,i={type:"insertText",textInstanceId:r.textInstanceId,id:[this.sessionId,r.opClock.reserveTicks(t.length)],originId:n,content:t};return{operation:i,invertedOperation:{type:"invertedInsertText",textInstanceId:r.textInstanceId,startId:i.id,endId:[i.id[0],i.id[1]+t.length-1]}}}applyInsertTextOperation(e){(0,l.TO)(this.findTextSliceContainingItemWithId(e.textInstanceId,e.originId)).applyInsertTextOperation(e)}deleteText(e,t){return this.getOperationsForDeleteText(e,t).operations.forEach((e=>this.applyDeleteOperation(e))),this}getOperationsForDeleteText(e,t){(0,l.T)(e<=t);const o=[];for(const{textSliceTree:n,textSliceStartIndex:a,textSliceEndIndex:l}of this.getTextSliceTreesInRange(e,t)){const{textSlice:r}=n,i=r.getItemIdsInRange(Math.max(0,e-a),Math.min(l-a,t-a));o.push({type:"deleteText",textInstanceId:r.textInstanceId,ids:i})}(0,l.T)(o.length>0);const r=(0,l.TO)(o.at(-1)),i=(0,l.TO)(r.ids.at(-1)),s=this.getTextValue(),c=new n.nV(a.eeV(s)),d=a.KU1(s,c.getGraphemeIndex(e),c.getGraphemeIndex(t)+1);return{operations:o,invertedOperations:[{type:"invertedDeleteText",textInstanceId:r.textInstanceId,originId:i,textValue:d}]}}applyDeleteOperation(e){(0,l.TO)(this.findTextSliceContainingItemWithId(e.textInstanceId,(0,l.TO)(e.ids[0]))).applyDeleteTextOperation(e)}addAnnotation(e,t,o){return this.getOperationsForAddAnnotation(e,t,o).operations.forEach((e=>this.applyAnnotationOperation(e))),this}removeAnnotation(e,t,o){return this.getOperationsForRemoveAnnotation(e,t,o).operations.forEach((e=>this.applyAnnotationOperation(e))),this}getOperationsForAddAnnotation(e,t,o){(0,l.T)(e<=t);const n=a.J7s(o),r=a.$z2(n),i=this.getTextSliceSpansForAnnotationOperation(e,t,r,!1).map((e=>{let{textSlice:t,start:n,end:r}=e;return{type:"addAnnotation",textInstanceId:t.textInstanceId,id:[this.sessionId,t.opClock.reserveTicks(1)],start:n,end:r,annotation:o}}));(0,l.T)(i.length>0);const{textSliceTree:s,opId:c}=this.getTextSliceTreeAndItemIdForIndex(e),{textSliceTree:d,opId:p}=this.getTextSliceTreeAndItemIdForIndex(t);return{operations:i,invertedOperations:[{type:"invertedAddAnnotation",startTextInstanceId:s.textSlice.textInstanceId,startId:c,endTextInstanceId:d.textSlice.textInstanceId,endId:p,annotationKey:a.c14(o)}]}}getOperationsForRemoveAnnotation(e,t,o){(0,l.T)(e<=t);const i=a.JA7(o),s=a.$z2(i),c=this.getTextSliceSpansForAnnotationOperation(e,t,s,!0).map((e=>{let{textSlice:t,start:n,end:r}=e;return{type:"removeAnnotation",textInstanceId:t.textInstanceId,id:[this.sessionId,t.opClock.reserveTicks(1)],start:n,end:r,annotationKey:o}}));(0,l.T)(c.length>0);const{textSliceTree:d,opId:p}=this.getTextSliceTreeAndItemIdForIndex(e),{textSliceTree:u,opId:m}=this.getTextSliceTreeAndItemIdForIndex(t),g=this.getTextValue(),h=new n.nV(a.eeV(g)),f=a.Sfs({textValue:g,startIndex:h.getGraphemeIndex(e),endIndex:h.getGraphemeIndex(t)+1,annotationType:a.JA7(o)}).find((e=>{let{annotation:t}=e;return r.Xy(a.c14(t),o)}));return{operations:c,invertedOperations:f?[{type:"invertedRemoveAnnotation",startTextInstanceId:d.textSlice.textInstanceId,startId:p,endTextInstanceId:u.textSlice.textInstanceId,endId:m,annotation:f.annotation}]:[]}}getTextSliceSpansForAnnotationOperation(e,t,o,n){(0,l.T)(0<=e&&e<=t&&t<this.getVisibleCount(),`Invalid range: [${e}, ${t}]`);const r=[];for(const{textSliceTree:i,textSliceStartIndex:a,textSliceEndIndex:s}of this.getTextSliceTreesInRange(e,t)){const{textSlice:l}=i;let c,d;c=e<a?{id:l.getStartItem().id,anchor:"after"}:n&&!o?{id:l.getItemIdBeforeIndex(e-a),anchor:"after"}:{id:l.getItemIdAtIndex(e-a),anchor:"before"},d=s<t?{id:l.getEndItem().id,anchor:"before"}:n||o?{id:l.getItemIdAfterIndex(t-a),anchor:"before"}:{id:l.getItemIdAtIndex(t-a),anchor:"after"},r.push({textSlice:l,start:c,end:d})}return r}applyAnnotationOperation(e){(0,l.TO)(this.findTextSliceContainingItemWithId(e.textInstanceId,e.start.id)).applyAnnotationOperation(e)}splitAtIndex(e){const t=this.getOperationsForSplitAtIndex(e),o=t.type;switch(o){case"splitNodeEnd":{const{newTextSliceTree:e,textSliceTreesToMove:o}=t;e.detachFromParent();for(const t of o)t.detachFromParent(),e.appendChild(t);return e}case"splitWithinNode":{const{splitOp:e,textSliceTreesToMove:o}=t,n=this.applySplitOperation(e);n.detachFromParent();for(const t of o)t.detachFromParent(),n.appendChild(t);return n}default:(0,s.t1)(o)}}getOperationsForSplitAtIndex(e){const{textSliceTree:t,originId:o}=this.getTextSliceTreeAndOriginItemIdForInsertionIndex(e,"firstNode"),{textSlice:n}=t;if(n.isLastOriginItemId(o)){const e=this.getNextTextSliceTree(t);if(e)return{type:"splitNodeEnd",previousTextSliceTree:t,newTextSliceTree:e,textSliceTreesToMove:this.getFollowingTopLevelTextSliceTrees(e)}}return{type:"splitWithinNode",splitOp:{type:"splitText",textInstanceId:n.textInstanceId,id:[this.sessionId,n.opClock.reserveTicks(1)],originId:o},textSliceTreeToSplit:t,textSliceTreesToMove:this.getFollowingTopLevelTextSliceTrees(t)}}applySplitOperation(e){const t=(0,l.TO)(this.findTextSliceTreeContainingItemWithId(e.textInstanceId,e.originId));t.textSlice.applySplitTextOperation(e);const o=t.textSlice.splitIntoSlices();(0,l.T)(2===o.length);const n=(0,l.T)(o[1]),r=new u(this.sessionId,n);for(;t.children.length;){const e=t.children[0];e.detachFromParent(),r.appendChild(e)}return t.appendChild(r),r}getTextValue(){const e=[];for(const t of this.iterateTextSliceTrees())e.push(...t.textSlice.getTextValue());return a.Zxt(e)}getText(){return a.QaF(this.getTextValue())}detachFromParent(){var e;null===(e=this.parent)||void 0===e||e.removeChild(this)}getTextSlice(){return this.textSlice}replaceTextSlice(e){(0,l.T)(e.textInstanceId===this.textSlice.textInstanceId&&e.opClock===this.textSlice.opClock),this.textSlice=e}removeChild(e){const t=this.children.indexOf(e);return(0,l.T)(-1!==t),this.children.splice(t,1),e.parent=void 0,this}appendChild(e){if((0,l.T)(void 0===e.parent),e.parent=this,this.children.push(e),e.hasCycle())throw e.detachFromParent(),new Error("Appending child resulted in a cycle");return this}hasCycle(){const e=new Set;let t=this;for(;t;){if(e.has(t))return!0;e.add(t),t=t.parent}return!1}getTextSliceTreeAndOriginItemIdForInsertionIndex(e,t){let o,n;if(0===e)if("firstNode"===t)o=this,n=0;else if("nodeWithContent"===t){let e;for(const t of this.iterateTextSliceTrees())if(e=t,t.textSlice.getVisibleCount()>0)break;o=(0,l.TO)(e),n=0}else(0,s.t1)(t);else{const t=(0,l.TO)(this.getTextSliceTreesInRange(e-1,e-1)[0]);o=t.textSliceTree,n=e-t.textSliceStartIndex}return{textSliceTree:o,originId:o.textSlice.getOriginItemIdForInsertionIndex(n)}}getTextSliceTreeAndItemIdForIndex(e){const{textSliceTree:t,textSliceStartIndex:o}=(0,l.TO)(this.getTextSliceTreesInRange(e,e)[0]),n=e-o;return{textSliceTree:t,opId:t.textSlice.getItemIdAtIndex(n)}}findTextSliceContainingItemWithId(e,t,o){var n;return null===(n=this.findTextSliceTreeContainingItemWithId(e,t,o))||void 0===n?void 0:n.textSlice}findTextSliceTreeBeforeTextSliceStartingWithItemId(e,t){let o;for(const n of this.iterateTextSliceTrees()){const{textSlice:r}=n;if(r.textInstanceId===e&&r.getStartItem().startsWithId(t))return o;o=n}}findTextSliceTreeContainingItemWithId(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d;for(const n of this.iterateTextSliceTrees(e))switch(o.type){case"contains":if(n.textSlice.containsItemWithId(t,o))return n;break;case"start":if(n.textSlice.getStartItem().startsWithId(t))return n;break;case"end":if(n.textSlice.getEndItem().endsWithId(t))return n;break;default:(0,s.t1)(o)}}getTextSliceTreesInRange(e,t){const o=[];(0,l.T)(0<=e&&e<=t&&t<this.getVisibleCount(),`Invalid range: [${e}, ${t}]`);let n=-1;for(const r of this.iterateTextSliceTrees()){const{textSlice:i}=r;if(0===i.getVisibleCount())continue;const a=n+1,s=a+i.getVisibleCount()-1;if(s<e)n=s;else{if(t<a)break;o.push({textSliceTree:r,textSliceStartIndex:a,textSliceEndIndex:s}),n=s}}return o}getNextTextSliceTree(e){let t;for(const o of this.iterateTextSliceTrees()){if(t===e)return o;t=o}}getFollowingTopLevelTextSliceTrees(e){const t=[this];for(;t.length;){const o=(0,l.TO)(t.shift());if(o===e)return[...t];t.unshift(...o.children)}return[]}getLastTextSliceTreeInPreOrderTraversal(){let e=this;for(const t of this.iterateTextSliceTrees())e=t;return e}getVisibleCount(){let e=0;for(const t of this.iterateTextSliceTrees())e+=t.textSlice.getVisibleCount();return e}*iterateTextSliceTrees(e){e&&this.textSlice.textInstanceId!==e||(yield this);for(const t of this.children)yield*t.iterateTextSliceTrees(e)}equals(e){if(this===e)return!0;const t=[...this.iterateTextSliceTrees()],o=[...e.iterateTextSliceTrees()];if(t.length!==o.length)return!1;for(let n=0;n<t.length;n++){const e=t[n],r=o[n];if(!e.textSlice.equals(r.textSlice))return!1;const i=e.children,a=r.children;if(i.length!==a.length)return!1;for(let t=0;t<i.length;t++){const e=i[t],o=a[t];if(e.textSlice.getSliceKey()!==o.textSlice.getSliceKey())return!1}}return!0}static createEmpty(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZP)();return new u(arguments.length>1&&void 0!==arguments[1]?arguments[1]:p,c.Z.createEmpty(e))}}},97531:(e,t,o)=>{o.d(t,{K:()=>i});var n=o(68955),r=o(46227);function i(e,t){const o=e,i=r.Z.createEmpty(o);return t&&i.insertTextValue(0,t),{use_crdt:!0,text_slice_tree:n.Z.serialize(i),text_clocks:n.Z.serializeClocks(i)}}},59579:(e,t,o)=>{o.d(t,{$:()=>i,D:()=>a});var n=o(82798);function r(e,t){return e[1]<t[1]?-1:e[1]>t[1]?1:e[0]<t[0]?-1:e[0]>t[0]?1:0}function i(e,t){const o=r(e,t);return(0,n.T)(0!==o,`Expected IDs to be distinct: ${e}`),o}function a(e,t){const o=function(e,t){return"start"===e?"start"===t?0:-1:"end"===e?"start"===t?1:"end"===t?0:-1:"start"===t||"end"===t?1:r(e,t)}(e,t);return(0,n.T)(0!==o,`Expected IDs to be distinct: ${e}`),o}},52136:(e,t,o)=>{o.d(t,{AB:()=>l,Eg:()=>s,Hi:()=>r,TS:()=>a,s:()=>i});o(57658);var n=o(43993);function*r(e,t){let o=e;for(;o;){let e=!0;(null==t||!t.includeDeleted)&&o instanceof n.Jy&&o.isDeleted()?e=!1:null!=t&&t.includeEndItem||o.next||(e=!1),e&&(yield o),o=o.next}}function i(e){let t=e;for(const o of r(e,{includeDeleted:!0,includeEndItem:!0}))t=o;return t}function a(e){let t=0;for(const o of r(e,{includeDeleted:!1}))o instanceof n.Jy&&(t+=o.getLength());return t}function s(e){const t=[e];let o=e.next;for(;o;)if(o instanceof n.JE&&o.next){const e=o.clone(),n=o.next;e.next=n,n.prev=e,e.prev=void 0,o.next=void 0,t.push(e),o=e.next}else o=o.next;return t}function l(e){for(let t=1;t<e.length;t++)e[t].prev=e[t-1],e[t-1].next=e[t]}},47247:(e,t,o)=>{o.d(t,{Z:()=>p});o(57658);var n=o(82798),r=o(52136),i=o(69920),a=o(97880),s=o(43993),l=o(57081);class c{static serialize(e){return[...e.getOps()]}static deserialize(e){return new l.Z(e)}}class d{static serialize(e){let t;e instanceof s.vM?t=d.serializeStartItem(e):e instanceof s.KH?t=d.serializeEndItem(e):e instanceof s.JE?t=d.serializeSplitItem(e):e instanceof s.Jy?t=d.serializeTextItem(e):(0,a.t1)(e);const o=e.getAnnotationOpSetForAnchor("before");o&&(t.annotationOpsBefore=c.serialize(o));const n=e.getAnnotationOpSetForAnchor("after");return n&&(t.annotationOpsAfter=c.serialize(n)),t}static serializeStartItem(e){return{type:"start"}}static serializeEndItem(e){return{type:"end"}}static serializeSplitItem(e){return{type:"split",id:e.id,originId:e.originId}}static serializeTextItem(e){return e.isDeleted()?{type:"text",id:e.id,originId:e.originId,deleted:!0,length:e.getLength()}:{type:"text",id:e.id,originId:e.originId,deleted:!1,content:e.getDefinedContent()}}static deserialize(e){let t;const o=e.type;switch(o){case"start":t=d.deserializeStartItem(e);break;case"end":t=d.deserializeEndItem(e);break;case"split":t=d.deserializeSplitItem(e);break;case"text":t=d.deserializeTextItem(e);break;default:(0,a.t1)(o)}return e.annotationOpsBefore&&t.maybeCreateAnnotationOpSetForAnchor("before",{opSet:c.deserialize(e.annotationOpsBefore)}),e.annotationOpsAfter&&t.maybeCreateAnnotationOpSetForAnchor("after",{opSet:c.deserialize(e.annotationOpsAfter)}),t}static deserializeStartItem(e){return new s.vM}static deserializeEndItem(e){return new s.KH}static deserializeSplitItem(e){return new s.JE(e.id,e.originId)}static deserializeTextItem(e){return e.deleted?s.Jy.createDeleted(e.id,e.originId,e.length):s.Jy.create(e.id,e.originId,e.content)}}class p{static serialize(e){const t=[];for(const o of e.iterateItems({includeDeleted:!0,includeEndItem:!0}))t.push(d.serialize(o));return{textInstanceId:e.textInstanceId,items:t}}static deserialize(e,t){const o=[];for(const n of e.items)o.push(d.deserialize(n));r.AB(o);const a=(0,n.Fb)(o[0],i.G);return new i.Z(e.textInstanceId,t,a)}}},68955:(e,t,o)=>{o.d(t,{Z:()=>s});var n=o(82798),r=o(19056),i=o(46227),a=o(47247);class s{static serialize(e){const t={};for(const o of e.iterateTextSliceTrees()){const e=o.getTextSlice(),n=o.children;t[e.getSliceKey()]={textSlice:a.Z.serialize(e),childKeys:n.map((e=>e.getTextSlice().getSliceKey()))}}return{root:e.getTextSlice().getSliceKey(),nodes:t}}static serializeClocks(e){const t={};for(const o of e.iterateTextSliceTrees()){const{textInstanceId:e,opClock:r}=o.getTextSlice();t[e]?(0,n.T)(t[e]===r.getValue()):t[e]=r.getValue()}return t}static deserialize(e,t,o){const n=t.root,r=t.nodes;return s.deserializeHelper(e,n,r,o)}static deserializeTreeAndClocks(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.w;const n=s.deserializeClocks(t);return{textSliceTree:s.deserialize(o,e,n),opClockMap:n}}static deserializeHelper(e,t,o,r){const{textSlice:l,childKeys:c=[]}=(0,n.TO)(o[t]),d=(0,n.TO)(r[l.textInstanceId]),p=a.Z.deserialize(l,d),u=new i.Z(e,p);for(const n of c){const t=s.deserializeHelper(e,n,o,r);u.appendChild(t)}return u}static deserializeClocks(e){const t={};for(const[o,n]of Object.entries(e))t[o]=new r.Z(n);return t}}},52936:(e,t,o)=>{o.d(t,{Bp:()=>m,yu:()=>h});o(57658),o(21703);var n=o(30120),r=o(80951),i=o(40506),a=o(53877),s=o(21768),l=o(482),c=o(27006),d=o(149),p=o(21202),u=o(97880);const m=["consume_gap","preserve_gap"];class g{constructor(){this.operations=[],this.numDependenciesUpdated=0,this.numCouldNotUpdateDueToPermissions=0}push(e){this.operations.push(...e.operations),this.numDependenciesUpdated+=e.numDependenciesUpdated,this.numCouldNotUpdateDueToPermissions+=e.numCouldNotUpdateDueToPermissions}pushUpdatedBlockDates(e,t){for(const[o,n]of e)this.operations.push(...t.toOperations(n,{id:o,table:p.iU}));this.numDependenciesUpdated+=e.size}}function h(e){const{block:t,options:o,blockingPropertyId:i,blockedByPropertyId:a,timeZone:s,locale:l,collectionSchema:c,getRecordRole:p,getRecordValue:m,dateProperty:h,endDateProperty:b}=e,S=function(e){return t=>{let{oldDateValue:o,newDateValue:r,dependencyDateValue:i}=t;const a=Boolean(e.avoid_weekends),s=e.mode;if(!s)return;const l=i.getStart(),c=r.getStart(),d=r.getEnd();let p;if("consume_gap"===s){if(d.valueOf()>=l.valueOf()){if(a)return k({dateShiftMode:s,newDateData:n.Xp.fromDateTimes(c,d),dependencyDateValue:i});p=d.plus(i.nudgeForDate("start"))}}else if("preserve_gap"===s)if(o){const e=o.getStart(),t=o.getEnd();if(a)return k({dateShiftMode:s,oldDateData:n.Xp.fromDateTimes(e,t),newDateData:n.Xp.fromDateTimes(c,d),dependencyDateValue:i});const r=d.diff(t);p=l.plus(r)}else d.valueOf()>=l.valueOf()&&(p=d.plus(i.nudgeForDate("start")));else(0,u.t1)(s);return p&&i.changeBoundary({type:"start",newValue:p})}}(o),_=function(e){return t=>{let{oldDateValue:o,newDateValue:r,dependencyDateValue:i}=t;const a=Boolean(e.avoid_weekends),s=e.mode;if(!s)return;const l=i.getEnd(),c=r.getStart(),d=r.getEnd();let p;if("consume_gap"===s){if(c.valueOf()<=l.valueOf()&&(p=c.minus(i.nudgeForDate("end")),a))return w({dateShiftMode:s,newDateData:n.Xp.fromDateTimes(c,d),dependencyDateValue:i})}else if("preserve_gap"===s)if(o){const e=o.getStart(),t=o.getEnd();if(a)return w({dateShiftMode:s,oldDateData:n.Xp.fromDateTimes(e,t),newDateData:n.Xp.fromDateTimes(c,d),dependencyDateValue:i});const r=e.diff(c);p=l.minus(r)}else c.valueOf()<=l.valueOf()&&(p=c.minus(i.nudgeForDate("end")));else(0,u.t1)(s);return p&&i.changeBoundary({type:"end",newValue:p})}}(o),x={timeZone:s,locale:l};let I,M;if((0,u.$K)(b)){const e=new T({convertArgs:x,startPropertyId:h.id,endPropertyId:b.id});I=e;const o=e.getFromBlock(t),n=(0,r.Gl)(h.newValue)??(null==o?void 0:o.startValue),i=(0,r.Gl)(b.newValue)??(null==o?void 0:o.endValue);if(!(0,u.$K)(n))return new g;M=new A({convertArgs:x,startValue:n,endValue:i})}else{I=new C({convertArgs:x,propertyId:h.id});const e=(0,r.Gl)(h.newValue);if(!(0,u.$K)(e))return new g;M=new P({convertArgs:x,value:e})}const D={startingBlock:t,startingNewDateValue:M,context:{collectionSchema:c,getRecordRole:p,getRecordValue:m,accessor:I}};if("consume_gap"===o.mode){const e=new g,t=v({...D,dependencyPropertyId:i,dateAdjuster:S,dateRangeIsFurtherThan:(e,t)=>e.getStart().valueOf()>t.getStart().valueOf()});if(d.x.isFail(t))return new g;e.push(t.value);const o=v({...D,dependencyPropertyId:a,dateAdjuster:_,dateRangeIsFurtherThan:(e,t)=>e.getEnd().valueOf()<t.getEnd().valueOf()});return d.x.isFail(o)?new g:(e.push(o.value),e)}if("preserve_gap"===o.mode)return function(e){const{startingBlock:t,startingNewDateValue:o,forwardConfig:n,backwardConfig:r,context:i}=e,{accessor:a}=i,s=new Set,l=[{block:t,newDateValue:o}],c=new Map,d=new g;for(;;){const e=l.shift();if(!e)break;const{block:o,newDateValue:p}=e;if(s.has(o.id))continue;s.add(o.id);const u=a.getFromBlock(o);for(const{dependencyPropertyId:a,dateAdjuster:s}of[n,r]){const e=y(i,o,a);for(const o of e)o.id!==t.id&&f({context:i,adjust:e=>s({oldDateValue:u,newDateValue:p,dependencyDateValue:e}),result:d,dependencyPointer:o,onDateUpdated:(e,t)=>{c.has(o.id)||c.set(o.id,t),l.push({block:e,newDateValue:t})}})}}return d.pushUpdatedBlockDates(c,a),d}({...D,forwardConfig:{dependencyPropertyId:i,dateAdjuster:S},backwardConfig:{dependencyPropertyId:a,dateAdjuster:_}});(0,u.t1)(o.mode)}function f(e){const{result:t,dependencyPointer:o,context:n,adjust:r,onDateUpdated:i}=e,{accessor:a,getRecordValue:s,getRecordRole:l}=n,d=l(o);if(d&&!(0,c.J5)(d))return void t.numCouldNotUpdateDueToPermissions++;const p=s(o);if(!p)return;const u=a.getFromBlock(p);if(!u)return;const m=r(u);m&&!m.equals(u)&&i(p,m)}function y(e,t,o){var n;const i=e.collectionSchema[o];return i&&"relation"===i.type?(0,r.j$)({propertySchema:i,getRecordModel:s.o.fromGetRecordValueFn(e.getRecordValue),relationValue:(0,r.rq)(null===(n=t.properties)||void 0===n?void 0:n[o])}):[]}function v(e){const{startingBlock:t,startingNewDateValue:o,context:n,dateAdjuster:r,dateRangeIsFurtherThan:i,dependencyPropertyId:a}=e,{accessor:s}=n,l=new Set,c=[{block:t,newDateValue:o,path:[]}],d=new Map,p=new g;for(;;){const e=c.shift();if(!e)break;const{block:t,newDateValue:o,path:u}=e;if(u.includes(t.id))return{error:"cycle_detected"};if(l.has(t.id))continue;l.add(t.id);const m=s.getFromBlock(t),g=[...u,t.id],h=y(n,t,a);for(const a of h)f({context:n,adjust:e=>r({oldDateValue:m,newDateValue:o,dependencyDateValue:e}),result:p,dependencyPointer:a,onDateUpdated:(e,t)=>{const o=d.get(a.id);o&&!i(t,o)||d.set(a.id,t),c.push({block:e,newDateValue:t,path:g})}})}return p.pushUpdatedBlockDates(d,s),{value:p}}function b(e){const{inputDate:t,dateShiftDirection:o}=e;return 6===t.weekday?t.plus({days:"right"===o?2:-1}):7===t.weekday?t.plus({days:"right"===o?1:-2}):t}function S(e,t){let o,n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=0;if(e.valueOf()>t.valueOf())o=t,n=e;else{if(!(e.valueOf()<t.valueOf()))return 0;o=e,n=t}for(r&&(o=o.plus({days:1}),n=n.minus({days:1}));o.valueOf()<=n.valueOf();)_(o)||i++,o=o.plus({days:1});return i}function _(e){return 6===e.weekday||7===e.weekday}function w(e){const{newDateData:t,dependencyDateValue:o,dateShiftMode:n}=e,r=o.getStart(),i=o.getEnd(),a=S(r,i);let s=b({inputDate:t.start.minus({days:1}),dateShiftDirection:"left"});if("preserve_gap"===n){const o=S(e.oldDateData.start,i,!0);for(let e=S(t.start,s,!0);e<o;e++)s=s.minus({days:1}),_(s)&&(s=b({inputDate:s,dateShiftDirection:"left"}))}let l=s,c=1;for(;c<a;)l=l.minus({days:1}),_(l)||c++;return o.changeBoundaries({newStart:l,newEnd:s})}function k(e){const{dependencyDateValue:t,newDateData:o,dateShiftMode:n}=e,r=t.getStart(),i=S(r,t.getEnd());let a=b({inputDate:o.end.plus({days:1}),dateShiftDirection:"right"});if("preserve_gap"===n){const t=S(e.oldDateData.end,r,!0);for(let e=S(o.end,a,!0);e<t;e++)a=a.plus({days:1}),_(a)&&(a=b({inputDate:a,dateShiftDirection:"right"}))}let s=a,l=1;for(;l<i;)s=s.plus({days:1}),_(s)||l++;return t.changeBoundaries({newStart:a,newEnd:s})}function x(e,t){if(!(e instanceof t))throw new Error(`Expected ShiftableDate to be of type ${t}`)}class I{constructor(e){this.convertArgs=e}}class C extends I{constructor(e){super(e.convertArgs),this.propertyId=void 0,this.propertyId=e.propertyId}getFromBlock(e){var t;const o=(0,r.Gl)(null===(t=e.properties)||void 0===t?void 0:t[this.propertyId]);return o?new P({value:o,convertArgs:this.convertArgs}):void 0}toOperations(e,t){return x(e,P),[l.op.update({pointer:t,path:["properties"],args:{[this.propertyId]:(0,r.d7)(e.value)}})]}}class T extends I{constructor(e){super(e.convertArgs),this.startPropertyId=void 0,this.endPropertyId=void 0,this.startPropertyId=e.startPropertyId,this.endPropertyId=e.endPropertyId}getFromBlock(e){var t;const o=(0,r.Gl)(null===(t=e.properties)||void 0===t?void 0:t[this.startPropertyId]);if((0,u.$K)(o)){var n;const t=(0,r.Gl)(null===(n=e.properties)||void 0===n?void 0:n[this.endPropertyId]);return new A({startValue:o,endValue:t,convertArgs:this.convertArgs})}}toOperations(e,t){return x(e,A),[l.op.update({pointer:t,path:["properties"],args:{[this.startPropertyId]:(0,r.d7)(e.startValue),...e.endValue?{[this.endPropertyId]:(0,r.d7)(e.endValue)}:{}}})]}}class M{constructor(e){this.convertArgs=e}toLuxon(e){return a.OQ.notionDateOrDateTimeToLuxon(e,this.convertArgs)}}class P extends M{constructor(e){super(e.convertArgs),this.value=void 0,this.value=e.value}getStart(){return this.toLuxon(i.Ws(this.value))}getEnd(){return this.toLuxon(i.S$(this.value))}nudgeForDate(e){return"date"===this.value.type||"daterange"===this.value.type?{days:1}:"datetime"===this.value.type?{minutes:1}:"datetimerange"===this.value.type?{}:void(0,u.t1)(this.value)}equals(e){return x(e,P),i.AP(this.value,e.value)}changeBoundary(e){let t;if("daterange"===this.value.type||"datetimerange"===this.value.type){const o=a.NK(this.value,this.convertArgs.timeZone,this.convertArgs.locale),n=o.end.diff(o.start);t=("daterange"===this.value.type?a.OQ.toPersistedDateRange:a.OQ.toPersistedDateTimeRange)("start"===e.type?{start:e.newValue,end:e.newValue.plus(n)}:{start:e.newValue.minus(n),end:e.newValue},this.convertArgs.timeZone)}else if("date"===this.value.type||"datetime"===this.value.type){t=("date"===this.value.type?a.OQ.toPersistedDate:a.OQ.toPersistedDateTime)(e.newValue.valueOf(),this.convertArgs.timeZone)}else(0,u.t1)(this.value);return new P({value:t,convertArgs:this.convertArgs})}changeBoundaries(e){const{newStart:t,newEnd:o}=e;return new P({value:a.OQ.toPersistedDateWithType({start:t,end:o},this.value.type,this.convertArgs.timeZone),convertArgs:this.convertArgs})}}class A extends M{getMergedValue(){if(this._mergedValue===A.MergedValueNotCalculated){const e=a.rH(this.startValue,this.endValue);this._mergedValue=e?a.Qq(e):void 0}return this._mergedValue}constructor(e){super(e.convertArgs),this.startValue=void 0,this.endValue=void 0,this._mergedValue=void 0,this.startValue=e.startValue,this.endValue=e.endValue}getStart(){return this.toLuxon(i.Ws(this.getMergedValue()??this.startValue))}getEnd(){return this.toLuxon(i.S$(this.getMergedValue()??this.endValue??this.startValue))}equals(e){return x(e,A),i.AP(this.startValue,e.startValue)&&((0,u.$K)(this.endValue)?(0,u.$K)(e.endValue)&&i.AP(this.endValue,e.endValue):!(0,u.$K)(e.endValue))}nudgeForDate(e){const t="start"===e?this.startValue:this.endValue??this.startValue;return"date"===t.type?{days:1}:"datetime"===t.type||"datetimerange"===t.type||"daterange"===t.type?{}:void(0,u.t1)(t)}toPersistedDateDiscardingRange(e,t){return void 0===t||"date"===t||"daterange"===t?a.OQ.toPersistedDate(e.valueOf(),this.convertArgs.timeZone):"datetime"===t||"datetimerange"===t?a.OQ.toPersistedDateTime(e.valueOf(),this.convertArgs.timeZone):void(0,u.t1)(t)}changeBoundary(e){var t,o;const n=this.getEnd().diff(this.getStart());return new A({convertArgs:this.convertArgs,..."start"===e.type?{startValue:this.toPersistedDateDiscardingRange(e.newValue,this.startValue.type),endValue:this.toPersistedDateDiscardingRange(e.newValue.plus(n),null===(t=this.endValue)||void 0===t?void 0:t.type)}:{startValue:this.toPersistedDateDiscardingRange(e.newValue.minus(n),this.startValue.type),endValue:this.toPersistedDateDiscardingRange(e.newValue,null===(o=this.endValue)||void 0===o?void 0:o.type)}})}changeBoundaries(e){var t;const{newStart:o,newEnd:n}=e;return new A({startValue:this.toPersistedDateDiscardingRange(o,this.startValue.type),endValue:this.toPersistedDateDiscardingRange(n,null===(t=this.endValue)||void 0===t?void 0:t.type),convertArgs:this.convertArgs})}}A.MergedValueNotCalculated=Symbol("Merged value not calculated yet")},44317:(e,t,o)=>{o.d(t,{Ct:()=>a,O5:()=>s,eG:()=>i});var n=o(5366),r=o(63143);const i=(0,n.defineMessages)({year:{id:"timeUtils.durationDescriptor.intervalYear",defaultMessage:"{numYears, plural, one {1 year} other {{numYears} years}}"},day:{id:"timeUtils.durationDescriptor.intervalDay",defaultMessage:"{numDays, plural, one {1 day} other {{numDays} days}}"},hour:{id:"timeUtils.durationDescriptor.intervalHour",defaultMessage:"{numHours, plural, one {1 hour} other {{numHours} hours}}"},minute:{id:"timeUtils.durationDescriptor.intervalMinute",defaultMessage:"{numMinutes, plural, one {1 minute} other {{numMinutes} minutes}}"},second:{id:"timeUtils.durationDescriptor.intervalSecond",defaultMessage:"{numSeconds, plural, one {1 second} other {{numSeconds} seconds}}"}});function a(e,t){const o=Math.floor(e/r._I),n=Math.floor(e/r.A0),a=Math.floor(e/r.U6),s=Math.floor(e/r.hM),l=Math.floor(e/r.C0);return o>=1?t.formatMessage(i.year,{numYears:o}):n>=1?t.formatMessage(i.day,{numDays:n}):a>=1?t.formatMessage(i.hour,{numHours:a}):s>=1?t.formatMessage(i.minute,{numMinutes:s}):t.formatMessage(i.second,{numSeconds:l})}function s(e){return Math.floor((Date.now()-e)/864e5)}},14215:(e,t,o)=>{o.d(t,{E:()=>n,N:()=>r});o(57658),o(21703);function n(e,t){const o=new Set(e),n=new Set,r=new Array,i=new Array;for(const a of t)n.add(a),o.has(a)||i.push(a);for(const a of e)n.has(a)||r.push(a);return{created:i,deleted:r}}function r(e,t,o){const n=new Map,r=new Map,i=new Array,a=new Array;for(const s of e)n.set(o(s),s);for(const s of t){const e=o(s);r.set(e,s),n.has(e)||a.push(e)}for(const s of e){const e=o(s);r.has(e)||i.push(e)}return{created:a.map((e=>{const t=r.get(e);if(!t)throw new Error("After map did not contain value.");return t})),deleted:i.map((e=>{const t=n.get(e);if(!t)throw new Error("Before map did not contain value.");return t}))}}},93824:(e,t,o)=>{o.d(t,{q:()=>r});o(57658);var n=o(35311);function r(e,t){const o=n.create({arrays:{detectMove:!1,includeValueOnMove:!0}}).diff(e,t);if(!o)return{beforeOps:{},removeOps:new Set};let r=[],i=[];for(const n in o)"_t"!==n&&("_"===n[0]?r.push(parseInt(n.slice(1),10)):1===o[n].length&&i.push({index:parseInt(n,10),value:o[n][0]}));const a={},s=new Set,l=[...e];r=r.sort(((e,t)=>e-t));for(let n=r.length-1;n>=0;n--){const e=r[n],t=l.splice(e,1)[0];s.add(t)}i=i.sort(((e,t)=>e.index-t.index));for(let n=0;n<i.length;n++){const e=i[n];a[e.value]=l[e.index],l.splice(e.index,0,e.value)}return{beforeOps:a,removeOps:s}}},76837:(e,t,o)=>{o.d(t,{t1:()=>te,tV:()=>ee,PZ:()=>Y,nM:()=>W,eb:()=>K});o(57658),o(21703);var n=o(3865),r=o(83372),i=o(41432),a=o(76205),s=o(14714),l=o(99036),c=o(1274),d=o(68955),p=o(46227);o(45433);const u="415fc269-e68f-4da0-b3e3-b1273b741a7f";o(42509);var m=o(89789),g=o(59753),h=(o(482),o(4615)),f=o(98963),y=o(18844),v=o(21202),b=o(70203);function S(e){var t;const{blockValue:o,factoryButtonDeprecationContext:n,source:r}=e,i=function(e){return g.kk.fromValue(v.iU,e).getCreatedByPointer()??{id:m.P_.id,table:m.P_.table}}(o),a=o.space_id,s=(0,h.ZP)(),l=(0,h.ZP)(),c=n.isRootBlockFactoryBlock&&n.isCurrentBlockRootBlock?n.rootTextContainerId:(0,h.ZP)(),d=function(e){const{automationActionId:t,textContainerBlockId:o,creatorPointer:n,originalBlockValue:r,spaceId:i,blockContent:a}=e;return{table:v.iU,value:{id:o,space_id:i,alive:!0,parent_table:y.Xj,parent_id:t,type:"text",version:0,content:a,created_time:r.created_time,created_by_table:n.table,created_by_id:n.id}}}({automationActionId:l,textContainerBlockId:c,creatorPointer:i,originalBlockValue:o,blockContent:"duplication"===r?null===(t=o.content)||void 0===t?void 0:t.map((t=>e.pointerMapper({id:t,table:v.iU}).id)):o.content,spaceId:a}),p=function(e){const{automationId:t,automationActionId:o,spaceId:n,textContainerBlockId:r}=e;return{table:y.Xj,value:{id:o,space_id:n,alive:!0,parent_table:f.cv,parent_id:t,type:"duplicate_blocks",blocks:[r],version:0,config:void 0}}}({automationActionId:l,automationId:s,creatorPointer:i,originalBlockValue:o,spaceId:a,textContainerBlockId:c});return{textContainerBlock:d,automation:function(e){var t;const{creatorPointer:o,automationActionId:n,originalBlockValue:r,spaceId:i,automationId:a}=e,s=(0,h.ZP)(),l=Date.now();return{table:f.cv,value:{id:a,space_id:i,alive:!0,trigger:{id:s,type:"button"},parent_id:r.id,parent_table:v.iU,action_ids:[n],status:"active",properties:{name:(0,b.QaF)(null===(t=r.properties)||void 0===t?void 0:t.title)},created_by_id:o.id,created_by_table:o.table,created_time:r.created_time??l,last_edited_time:r.last_edited_time??l,version:0,last_edited_by_id:r.last_edited_by_id??o.id,last_edited_by_table:r.last_edited_by_table??o.table}}}({automationActionId:l,automationId:s,creatorPointer:i,originalBlockValue:o,spaceId:a}),automationAction:p}}var _=o(6695),w=o(78106),k=o(76218),x=o(59730),I=o(64572),C=o(72126),T=o(33317),M=o(63306),P=o(26825),A=o(27006),D=o(71644),B=o(74446),R=o(45953),E=o(606),F=o(77420),N=o(6287),j=o(13493),O=o(70279),L=o(33709),U=o(80396),Z=o(23867),V=o(91644),q=o(97880),z=o(63143);function W(e){const t=K([b.V3y(e)]);return b.QaF(t)}function H(e){if(e.length<3||!e.startsWith("(")||!e.endsWith(")"))return;const t=e.substring(1,e.length-1),o=parseInt(t);return!Number.isNaN(o)&&o>0&&function(e){return Boolean(e.match(/^[1-9][0-9]*$/))}(t)?o:void 0}function G(e){const t=e=>`(${e})`,{title:o,digit:n}=function(e){const t=e.trimEnd(),o=t.split(" "),n=H(o[o.length-1]);let r=t;if(void 0!==n){const e=o.slice(0,o.length-1).join(" ");r=e.length>0?e:void 0}return{title:r,digit:n}}(e[0]),r=void 0===o?"":`${o.trimEnd()} `,i=t(void 0===n?1:n+1);return b.V3y(`${r}${i}`)}function K(e){const t=b.QaF(e);if(0===t.trim().length||void 0===e)return[b.V3y(t)];const o=e[e.length-1];if(b.QJH(o)){return[...e.slice(0,e.length-1),G(o)]}return[...e,G([""])]}function $(e){return(t=e.table)===v.iU||t===N.v||t===j.n||t===L.qF||t===O.x_||t===U.yo||t===f.cv||t===y.Xj||t===V.AT;var t}function Y(e){const{sourceBlockId:t,targetBlockPointer:o,recordMap:n,options:r,baseUrl:i,publicDomainName:a,actor:s,getRecordRole:l}=e,c=e.recordPointerMap||R.Ao.create();for(const{pointer:g}of n){const e=g.id===t?o:c.get(g)||{spaceId:o.spaceId,table:g.table,id:(0,h.ZP)()};c.set(g,e)}const d=R.Ak.create(),p=e=>{let{requested:t}=e;return c.get(t)},u=n.getModel({id:t,table:v.iU}),m=u?function(e){const t="duplication",o=new Map;let n;return"factory"===e.type?(n={type:t,isRootBlockFactoryBlock:!0,isCurrentBlockRootBlock:!1,factoryBlockIdToNewTextContainerIdMap:o,rootTextContainerId:(0,h.ZP)()},n.factoryBlockIdToNewTextContainerIdMap.set(e.id,{id:n.rootTextContainerId,table:v.iU})):n={type:t,isRootBlockFactoryBlock:!1,factoryBlockIdToNewTextContainerIdMap:o},n}(u):void 0;for(const{pointer:g,model:h}of n){if(void 0===h)continue;if(!$(h))continue;if(!(null!=r&&r.duplicateDiscussions||g.table!==L.qF&&g.table!==O.x_&&g.table!==U.yo))continue;const e=Boolean((null==r?void 0:r.resolveTemplateVariables)&&ne({rootSourceBlockIds:[t],childSourcePointer:g,getSourceRecordValue:B.mF.fromRecordMap(n)}))?{...r,resolveTemplateVariables:!1}:r;null!=m&&m.isRootBlockFactoryBlock&&(m.isCurrentBlockRootBlock=h.id===t);const{duplicateRecord:c,additionalRecords:u}=J({table:h.table,record:h.__IM_SORRY__getValue(),mapper:p,options:e,rewiredUriMap:{},typedCollectionViewBlocks:[],originOptions:{baseUrl:i,publicDomainName:a},actor:s,getRecordRole:l,factoryButtonDeprecationContext:m});if(void 0!==c){if(h.table===v.iU&&c.id===o.id){const e=c;delete e.parent_id,delete e.parent_table,delete e.alive}Q({duplicateRecordMap:d,duplicateRecordResult:{duplicateRecord:c,additionalRecords:u,duplicateRecordTable:h.table}})}}return{duplicateRecordMap:d,originalToDuplicate:c}}function Q(e){const{duplicateRecordResult:t,duplicateRecordMap:o}=e,{additionalRecords:n,duplicateRecord:r,duplicateRecordTable:i}=t;o.setValue(E.dr.fromPointerLike({table:i,id:r.id}),r);for(const a of n)o.setValue(E.dr.fromPointerLike({id:a.value.id,table:a.table}),a.value)}function J(e){const{table:t,record:o,mapper:a,options:c,originOptions:m,actor:I,helperRecordMap:M,getRecordRole:W,rewiredUriMap:H,typedCollectionViewBlocks:G,factoryButtonDeprecationContext:K}=e,$=C.Xh(o),Y=a({requested:E.dr.fromPointerLike({table:t,id:o.id,spaceId:o.space_id}),requester:E.dr.fromPointerLike({table:t,id:o.id})});if(void 0===Y)throw new x.D3(`Failed to duplicate record ${o.id}`);$.id=Y.id,$.space_id=(0,Z.C)(Y.spaceId);const Q=[];if(t===v.iU){const e=$,{additionalRecords:t}=function(e){var t,o,n,r,a,s;const{originalBlock:l,duplicateBlock:c,mapper:m,options:y,originOptions:w,rewiredUriMap:k,typedCollectionViewBlocks:x,actor:I,helperRecordMap:T,factoryButtonDeprecationContext:M}=e,D={table:v.iU,id:l.id,spaceId:l.space_id};null!==(t=l.format)&&void 0!==t&&t.app_config_uri&&null!==(o=c.format)&&void 0!==o&&o.app_config_uri&&((0,_.iA)(l.format.app_config_uri)?c.format.app_config_uri=void 0:((0,i.dM)(c.type)&&x.push(c.id),k[l.id]=c.id));const B=[];if(null!==(n=c.format)&&void 0!==n&&n.use_crdt&&(0,i.h5)(c.type)){if(c.format.text_slice_tree&&c.format.text_clocks){const{textSliceTree:e}=d.Z.deserializeTreeAndClocks(c.format.text_slice_tree,c.format.text_clocks);c.properties={...c.properties,title:e.getTextValue()}}const{use_crdt:e,text_slice_tree:t,text_clocks:o,...n}=c.format;c.format=n}if("factory"===c.type&&M){const{automation:e,automationAction:t,textContainerBlock:o}=S({blockValue:c,source:"duplication",pointerMapper:e=>m({requested:e,requester:D})??e,factoryButtonDeprecationContext:M});B.push(e,t,o),M.factoryBlockIdToNewTextContainerIdMap.set(l.id,{id:o.value.id,table:v.iU});const n=c;n.type="button",n.content=[],n.format={...n.format,automation_id:e.value.id}}(0,h.e)(l.id)&&(c.format||(c.format={}),c.format.copied_from_pointer={table:v.iU,id:l.id,spaceId:l.space_id},c.copied_from=l.id);const R=(l.parent_table===v.iU?null==M?void 0:M.factoryBlockIdToNewTextContainerIdMap.get(l.parent_id):void 0)??m({requested:{table:c.parent_table,id:c.parent_id,spaceId:c.space_id},requester:D});R&&(c.parent_id=R.id);const O=c;if(O.content){var U;if(O.content=O.content.map((e=>{var t;return(null===(t=m({requested:{table:v.iU,id:e},requester:D}))||void 0===t?void 0:t.id)||e})),c.space_id===u&&null!==(U=c.properties)&&void 0!==U&&U.title){var V,W,H;const e=(0,b.lzi)(null===(V=c.properties)||void 0===V?void 0:V.title);e&&e.length>0&&e[0].length>0&&null!==(W=e[0][0])&&void 0!==W&&null!==(W=W.trim())&&void 0!==W&&W.startsWith("ðŸŽ²")&&null!==(H=e[0][0])&&void 0!==H&&null!==(H=H.trim())&&void 0!==H&&H.endsWith("ðŸŽ²")&&(O.content=C.TV(O.content))}}null!==(r=c.format)&&void 0!==r&&r.ai_instructions_page_pointer&&(c.format.ai_instructions_page_pointer=m({requested:c.format.ai_instructions_page_pointer,requester:D}));null!==(a=c.format)&&void 0!==a&&a.ai_skill_pointer&&(c.format.ai_skill_pointer=m({requested:c.format.ai_skill_pointer,requester:D}));const G=c;G.view_ids&&(G.view_ids=G.view_ids.map((e=>{var t;return(null===(t=m({requested:{table:j.n,id:e,spaceId:G.space_id},requester:D}))||void 0===t?void 0:t.id)||e})));const K=g.kk.fromBlock(G).getCollectionPointer();if(K){var $;if(null==T||null===($=T.getValue(K))||void 0===$||null===($=$.format)||void 0===$?void 0:$.bot_id)G.collection_id=K.id,G.format={...G.format,collection_pointer:K};else{const e=m({requested:K,requester:D})||K;if(e.table!==N.v)throw new Error(`Collection pointer for duplicate collection is invalid: ${JSON.stringify(e)}`);G.collection_id=e.id,G.format={...G.format,collection_pointer:e}}}c.discussions&&(y.duplicateDiscussions?c.discussions=c.discussions.map((e=>{var t;return(null===(t=m({requested:E.dr.fromPointerLike({table:L.qF,id:e,spaceId:c.space_id}),requester:D}))||void 0===t?void 0:t.id)||e})):delete c.discussions);if(c.permissions){var Y;if(y.duplicatePermissions)c.permissions=function(e){const{block:t,targetSpaceSettings:o,targetTeamSettings:n}=e;return(t.permissions||[]).filter((e=>!(0,A.FB)(e)&&(!(0,A.hV)(e)&&((!(!n&&o.disablePublicAccess||n&&n.disable_public_access)||!(0,A.$D)(e))&&!((!n&&o.disableGuests||n&&n.disable_guests)&&(0,A.jg)(e)&&!(0,P.N0)({spacePermissions:o.permissions||[],userId:e.user_id,botId:void 0}))))))}({block:c,targetSpaceSettings:y.duplicatePermissions.targetSpaceSettings,targetTeamSettings:null===(Y=y.duplicatePermissions)||void 0===Y?void 0:Y.targetTeamSettings});else delete c.permissions}c.content_classification&&delete c.content_classification;c.moved&&delete c.moved;c.properties||(c.properties={});for(const i in c.properties){const e=y.duplicateDiscussions?c.properties[i]:b.OAI(c.properties[i]);c.properties[i]=e}c.ignore_block_count&&delete c.ignore_block_count;if(c.properties)for(const i of Object.keys(c.properties)){const e=c.properties[i];e&&(c.properties[i]=oe({...w,text:{value:e,spaceId:(0,Z.C)(c.space_id)},mapper:m,requester:D,resolveTemplateVariables:y.resolveTemplateVariables||!1}))}if("transclusion_reference"===c.type&&y.deepCopyTransclusionContainers){const e=c;if(e.format&&e.format.transclusion_reference_pointer){const t=e.format.transclusion_reference_pointer,o=m({requested:t,requester:D});o&&(e.format.transclusion_reference_pointer=o)}}if("transclusion_container"===c.type&&!y.deepCopyTransclusionContainers){const e=c;e.type="transclusion_reference",e.content=void 0;const t=e.format||{};t.transclusion_reference_pointer=D,e.format=t}if("alias"===c.type&&c.format&&c.format.alias_pointer){const e=c.format.alias_pointer,t=m({requested:e,requester:D});t&&(c.format.alias_pointer=t)}c.type===i.Ti.externalObjectInstancePage&&(c.type=i.Ti.externalObjectInstance);if(c.type===i.Ti.externalObjectInstance){var Q,J,X;if(null!==(Q=c.format)&&void 0!==Q&&Q.related_external_object_uris_to_instance_ids&&(c.format.related_external_object_uris_to_instance_ids=(0,z.m8)((0,q.qP)(c.format.related_external_object_uris_to_instance_ids).map((e=>{var t;let[o,n]=e;return[o,(null===(t=m({requested:{table:v.iU,id:n,spaceId:G.space_id},requester:D}))||void 0===t?void 0:t.id)||n]})))),y.convertExternalObjectInstancesToPlaceholders&&(null===(J=c.format)||void 0===J||!J.is_placeholder)&&null!==(X=c.format)&&void 0!==X&&X.bot_id){const e=null==T?void 0:T.getValue({table:F.cZ,id:c.format.bot_id}),t=null==e?void 0:e.integration_id;if(t){const e={is_placeholder:!0,integration_id:t};c.format=e}}}c.file_ids&&function(e){var t;const o=JSON.stringify(e.properties);e.file_ids=null==e||null===(t=e.file_ids)||void 0===t?void 0:t.filter((t=>{var n,r,i,a,s,l;return!(null===(n=e.format)||void 0===n||!n.display_source||-1===(null===(r=e.format)||void 0===r||null===(r=r.display_source)||void 0===r?void 0:r.indexOf(t)))||(!(null===(i=e.format)||void 0===i||!i.page_cover||-1===(null===(a=e.format)||void 0===a||null===(a=a.page_cover)||void 0===a?void 0:a.indexOf(t)))||(!(null===(s=e.format)||void 0===s||!s.page_icon||-1===(null===(l=e.format)||void 0===l||null===(l=l.page_icon)||void 0===l?void 0:l.indexOf(t)))||-1!==o.indexOf(t)))}))}(c);if(null!==(s=c.format)&&void 0!==s&&s.automation_id){const e=m({requested:{table:f.cv,id:c.format.automation_id,spaceId:c.space_id},requester:D});e&&(c.format.automation_id=e.id)}"collection"===l.parent_table&&l.type===i.Ti.copyIndicator&&c.properties&&(0,q.Yd)(c.properties).length>0&&(c.type=i.Ti.page);if(y.blocksShouldUseCrdt&&(c.format={...c.format,use_crdt:!0},(0,i.h5)(c.type))){var ee;const e=p.Z.createEmpty(c.id);null!==(ee=c.properties.title)&&void 0!==ee&&ee.length&&e.insertTextValue(0,c.properties.title),c.format={...c.format,text_slice_tree:d.Z.serialize(e),text_clocks:d.Z.serializeClocks(e)}}if(!y.preserveSourceMetadataTimestamps){const e=Date.now();c.created_time=e,c.last_edited_time=e}I&&(c.last_edited_by_id=I.id,c.last_edited_by_table=I.table,c.created_by_id=I.id,c.created_by_table=I.table);return{duplicateRecord:c,additionalRecords:B}}({originalBlock:o,duplicateBlock:e,mapper:a,options:c??{},rewiredUriMap:H,typedCollectionViewBlocks:G,originOptions:m,actor:I,helperRecordMap:M,factoryButtonDeprecationContext:K});Q.push(...t)}else if(t===N.v){!function(e,t,o,n,r){var i,a,s,c;const d={table:N.v,id:e.id,spaceId:e.space_id};null!==(i=e.format)&&void 0!==i&&i.app_config_uri&&(r[e.id]=t.id);if((0,h.e)(e.id)){if(t.format||(t.format={}),t.format.copied_from_pointer={table:N.v,id:e.id,spaceId:e.space_id},void 0!==t.format.collection_default_template&&"empty"!==t.format.collection_default_template){const e=o({requested:{table:v.iU,id:t.format.collection_default_template.template_page_id},requester:d});e&&(t.format.collection_default_template={template_page_id:e.id})}t.copied_from=e.id}const p=o({requested:{table:t.parent_table,id:t.parent_id},requester:d});p&&(t.parent_id=p.id);const u=l.oC(t);for(const g in u){const e=u[g];if(e&&"relation"===e.type&&l.j0(e)){const t=o({requested:l.j0(e),requester:d});t?(e.collection_id=t.id,e.collection_pointer={id:t.id,table:N.v,spaceId:(0,Z.C)(t.spaceId)}):e.property&&(e.property=(0,D.ZP)())}e&&"title"===e.type&&t.name&&(t.name=oe({...n,text:{value:t.name,spaceId:t.space_id},mapper:o,requester:d,resolveTemplateVariables:!1}))}t.description&&(t.description=oe({...n,text:{value:t.description,spaceId:t.space_id},mapper:o,requester:d,resolveTemplateVariables:!1}));for(const l in u){const e=u[l];if(!e||"formula"!==e.type||"v2"!==e.version||!e.formula2)continue;const t=(0,w.Wo)(e.formula2.code,o,d);e.formula2.code=t}t.template_pages&&(t.template_pages=t.template_pages.map((e=>{var t;return(null===(t=o({requested:{table:v.iU,id:e},requester:d}))||void 0===t?void 0:t.id)||e})));if(null!==(a=t.format)&&void 0!==a&&a.collection_mode&&"page_tree"===t.format.collection_mode.type){var m;const e=t.format.collection_mode.root_page_pointer,n=(null===(m=o({requested:E.dr.fromPointerLike({table:"block",id:e.id,spaceId:t.space_id}),requester:d}))||void 0===m?void 0:m.id)||e.id;t.format.collection_mode={type:"page_tree",root_page_pointer:{id:n,table:"block",spaceId:t.space_id}}}null!==(s=t.format)&&void 0!==s&&s.related_external_object_uris_to_instance_ids&&(t.format.related_external_object_uris_to_instance_ids=(0,z.m8)((0,q.qP)(t.format.related_external_object_uris_to_instance_ids).map((e=>{var n;let[r,i]=e;return[r,(null===(n=o({requested:{table:N.v,id:i,spaceId:t.space_id},requester:d}))||void 0===n?void 0:n.id)||i]}))));delete t.deleted_schema,null!==(c=t.format)&&void 0!==c&&c.automation_ids&&(t.format.automation_ids=t.format.automation_ids.map((e=>{var n;return null===(n=o({requested:{id:e,table:f.cv,spaceId:t.space_id},requester:d}))||void 0===n?void 0:n.id})).filter(q.$K))}(o,$,a,m,H)}else if(t===j.n){!function(e,t,o,n){var r,i,a,l,c,d;const p={table:j.n,id:e.id,spaceId:e.space_id};null!==(r=e.format)&&void 0!==r&&r.app_config_uri&&null!==(i=t.format)&&void 0!==i&&i.app_config_uri&&((0,_.iA)(e.format.app_config_uri)?t.format.app_config_uri=void 0:n[e.id]=t.id);const u=null===(a=t.format)||void 0===a?void 0:a.collection_pointer;if(u){const e=o({requested:u,requester:p})||u;t.format={...t.format,collection_pointer:e}}if(t.format){var m;const e=null===(m=t.format.collection_groups)||void 0===m?void 0:m.map((e=>{if("relation"===e.value.type&&(0,s.RA)(e.value.value)&&e.value.value){return{...e,value:{type:"relation",value:o({requested:e.value.value,requester:p})}}}return e}));if(t.format.collection_groups=e,void 0!==t.format.collection_view_default_template&&"empty"!==t.format.collection_view_default_template){const e=o({requested:{table:v.iU,id:t.format.collection_view_default_template.template_page_id},requester:p});e&&(t.format.collection_view_default_template={template_page_id:e.id})}}const g=o({requested:{table:t.parent_table,id:t.parent_id,spaceId:t.space_id},requester:p});g&&(t.parent_id=g.id);t.page_sort&&(t.page_sort=t.page_sort.map((e=>{var n;return(null===(n=o({requested:{table:v.iU,id:e,spaceId:t.space_id},requester:p}))||void 0===n?void 0:n.id)||e})));if("page"===t.type&&null!==(l=t.format)&&void 0!==l&&l.page_pointer){var h;const e=t.format.page_pointer,n=(null===(h=o({requested:E.dr.fromPointerLike({table:"block",id:e.id,spaceId:t.space_id}),requester:p}))||void 0===h?void 0:h.id)||e.id;t.format.page_pointer={table:"block",id:n,spaceId:t.space_id}}if(null!==(c=t.format)&&void 0!==c&&c.property_filters){const e=t.format.property_filters;for(const t of e)t.filter&&X(t.filter,(e=>{var t;return null===(t=o({requested:e,requester:p}))||void 0===t?void 0:t.id}))}if(null!==(d=t.format)&&void 0!==d&&d.filters2){const e=t.format.filters2;for(const t of e)t.filter&&X(t.filter,(e=>{var t;return null===(t=o({requested:e,requester:p}))||void 0===t?void 0:t.id}))}const f=t.query2;f&&f.filter&&X(f.filter,(e=>{var t;return null===(t=o({requested:e,requester:p}))||void 0===t?void 0:t.id}))}(o,$,a,H)}else t===L.qF?function(e,t,o,n){const r={table:L.qF,id:e.id,spaceId:e.space_id},i=o({requested:{table:t.parent_table,id:t.parent_id,spaceId:t.space_id},requester:r});i&&(t.parent_id=i.id);t.comments&&(t.comments=t.comments.map((e=>{var n;return(null===(n=o({requested:{table:O.x_,id:e,spaceId:t.space_id},requester:r}))||void 0===n?void 0:n.id)||e})));t.context&&(t.context=oe({...n,text:{value:t.context,spaceId:t.space_id},mapper:o,requester:r,resolveTemplateVariables:!1}))}(o,$,a,m):t===O.x_?function(e,t,o,n){const r={table:O.x_,id:e.id,spaceId:e.space_id},i=o({requested:E.dr.fromPointerLike({table:t.parent_table,id:t.parent_id,spaceId:t.space_id}),requester:r});i&&(t.parent_id=i.id);t.text&&(t.text=oe({...n,text:{value:t.text,spaceId:t.space_id},mapper:o,requester:r,resolveTemplateVariables:!1}));if(t.content)for(const[s,l]of t.content.entries()){var a;const e=(null===(a=o({requested:E.dr.fromPointerLike({table:v.iU,id:l,spaceId:t.space_id}),requester:r}))||void 0===a?void 0:a.id)??l;t.content[s]=e}}(o,$,a,m):t===U.yo?function(e,t,o,n){const r={table:U.yo,id:e.id,spaceId:e.space_id},i=o({requested:E.dr.fromPointerLike({table:t.parent_table,id:t.parent_id,spaceId:t.space_id}),requester:r});i&&(t.parent_id=i.id)}(o,$,a):t===f.cv?function(e){const{original:t,duplicate:o,mapper:r,originOptions:i,options:a,actor:s}=e,l={table:f.cv,id:t.id,spaceId:t.space_id},c=r({requested:E.dr.fromPointerLike({table:o.parent_table,id:o.parent_id,spaceId:o.space_id}),requester:l}),d=(null==c?void 0:c.id)||o.parent_id,p=(o.action_ids??[]).map((e=>{var t;return(null===(t=r({requested:E.dr.fromPointerLike({table:y.Xj,id:e,spaceId:o.space_id}),requester:l}))||void 0===t?void 0:t.id)??e}));ee({duplicate:o,newParentId:d,newActionIds:p,originOptions:i,options:a,actor:s}),(0,n.Vd)(o)&&function(e){const{duplicate:t,mapper:o,requester:n}=e,r=t.trigger.event.source;if(!(0,q.$K)(r))throw new Error("Duplicated automation is missing trigger source - undefined");if("collection"===r.type){const e=o({requested:r.pointer,requester:n});if(!e)throw new Error("Duplicated automation is missing trigger source - Collection");if(e.table!==N.v)throw new Error(`Duplicated automation has mismatch trigger target. Wanted: Collection, got ${e.table}`);if(void 0!==e.spaceId&&e.spaceId!==t.space_id)throw new Error(`Duplicated automation has mismatch workspace id. Wanted: ${t.space_id}, got ${e.spaceId}`);r.pointer={...e,spaceId:t.space_id}}else if("collection_view"===r.type){const e=o({requested:r.pointer,requester:n});if(!e)throw new Error("Duplicated automation is missing trigger source - Collection View");if(e.table!==j.n)throw new Error(`Duplicated automation has mismatch trigger target. Wanted: Collection View, got ${e.table}`);if(void 0!==e.spaceId&&e.spaceId!==t.space_id)throw new Error(`Duplicated automation has mismatch workspace id. Wanted: ${t.space_id}, got ${e.spaceId}`);r.pointer={...e,spaceId:t.space_id}}else"filter"===r.type||(0,q.t1)(r)}({duplicate:o,mapper:r,requester:l})}({original:o,duplicate:$,mapper:a,originOptions:m,options:c??{},actor:I}):t===y.Xj?function(e){const{original:t,duplicate:o,mapper:n,getRecordRole:i,options:a,originOptions:s}=e,l=t.space_id!==o.space_id,c={table:y.Xj,id:t.id,spaceId:t.space_id},d=n({requested:E.dr.fromPointerLike({table:o.parent_table,id:o.parent_id,spaceId:o.space_id}),requester:c});let p=i;(function(e){const{automationAction:t,mapper:o,options:n}=e;if(!t.config)return;const r=(e,t)=>({spaceId:t.spaceId,...o({id:t.id,table:t.table,spaceId:t.spaceId}),table:e});if("create_page"===t.type){if(t.config.collection&&(t.config.collection=r(N.v,t.config.collection)),t.config.template_page_id){(null==n?void 0:n.isTemplateInstantiation)&&n.sourceBlockIds.has(t.config.template_page_id)||(t.config.template_page_id=r(v.iU,{id:t.config.template_page_id,table:v.iU,spaceId:t.space_id}).id)}}else if("query_collection"===t.type)t.config.collection&&(t.config.collection=r(N.v,t.config.collection));else if("update_pages"===t.type){const e=t.config.target;e&&("collection"===e.type?(e.collection=r(N.v,e.collection),e.filter&&X(e.filter,(e=>{var t;return null===(t=o(e))||void 0===t?void 0:t.id}))):"variable"===e.type||("page"===e.type?e.page=r(v.iU,e.page):(0,q.t1)(e)))}else if("open_page"===t.type){const e=t.config.target;e&&("page"===e.type?e.page=r(v.iU,e.page):"variable"===e.type||(0,q.t1)(e))}else"complete_sprint"===t.type||"duplicate_blocks"===t.type||"modal_confirmation"===t.type||"slack_notification"===t.type||(0,q.t1)(t)})({automationAction:o,mapper:e=>{const t=n({requester:c,requested:e});return t?(p=B.DH.tryUntilFound(B.DH.constantForPointer(t,"editor"),p),t):l?(p=B.DH.tryUntilFound(B.DH.constantForPointer(e,"none"),p),e):e},options:a.resolveAutomationConfig}),function(e){const{automationAction:t,requester:o,mapper:n,originOptions:i}=e,a=(0,r.z)(t.type);function s(e){const r=(0,w.MY)(e);if("action"===r.source){var i;const e=(null===(i=n({requester:o,requested:{id:r.action_id,table:y.Xj,spaceId:t.space_id}}))||void 0===i?void 0:i.id)??r.action_id;return(0,w.Kd)({...r,action_id:e})}if("global"===r.source)return e;(0,q.t1)(r)}const l=g.kk.fromValue(y.Xj,t),c=a.acceptFormulaVisitor({action:l,visitor:{visitFormula:e=>{const r=(0,k.Zw)(e,s);let a;return a=r.value?{...r,value:oe({...i,text:{value:r.value,spaceId:t.space_id},mapper:n,requester:o,resolveTemplateVariables:!1})}:r,{type:"replace",value:a}},visitVariableOutsideOfFormula:e=>({type:"replace",value:s(e)})}}),d=R.Ak.create();d.setValue(l.pointer,t),(0,T.FS)({recordMap:d,operations:c,updateOnly:!1});const p=d.getValue(l.pointer);if(!p)throw new Error("Updated automation action not found in record map");t.config=p.config}({automationAction:o,mapper:n,requester:c,originOptions:s});const u=(null==d?void 0:d.id)??o.parent_id;te({original:t,duplicate:o,newParentId:u,getRecordRole:p});const m=(o.blocks??[]).map((e=>{var t;return null===(t=n({requested:E.dr.fromPointerLike({table:v.iU,id:e,spaceId:o.space_id}),requester:c}))||void 0===t?void 0:t.id})).filter(q.$K);o.blocks=m.length>0?m:void 0}({original:o,duplicate:$,mapper:a,getRecordRole:W,options:c??{},originOptions:m}):t===V.AT?function(e){let{original:t,duplicate:o,mapper:n,originOptions:r}=e;const i={table:V.AT,id:t.id,spaceId:t.space_id},a=n({requested:E.dr.fromPointerLike({table:o.parent_table,id:o.parent_id,spaceId:o.space_id}),requester:i});a&&(o.parent_id=a.id)}({original:o,duplicate:$,mapper:a,originOptions:m}):(0,q.t1)(t);return{duplicateRecord:$,additionalRecords:Q}}function X(e,t){if(a.vA(e)){(e.filters||[]).forEach((e=>X(e,t)))}if(a.aN(e)){if(a.e(e.filter)){const o=e.filter;if("relation_contains"===o.operator||"relation_does_not_contain"===o.operator)if(Array.isArray(o.value)){const e=o.value.map((e=>{const o=e.type;if("exact"===o){const o=e.value;return{type:"exact",value:o&&t({table:v.iU,id:o})||o}}if("relative"===o)return e;(0,q.t1)(o)}));o.value=e}else{const e=o.value.type;if("exact"===e){const e=o.value.value;o.value.value=e&&t({table:v.iU,id:e})||e}else{if("relative"===e)return;(0,q.t1)(e)}}}if(a.a_(e.filter)){const o=e.filter.subfilter;if(a.e(o)){const e=o;if("relation_contains"===e.operator||"relation_does_not_contain"===e.operator)if(Array.isArray(e.value)){const o=e.value.map((e=>{const o=e.type;if("exact"===o){const o=e.value;return{type:"exact",value:o&&t({table:v.iU,id:o})||o}}if("relative"===o)return e;(0,q.t1)(o)}));e.value=o}else{const o=e.value.type;if("exact"===o){const o=e.value.value;e.value.value=o&&t({table:v.iU,id:o})||o}else{if("relative"===o)return;(0,q.t1)(o)}}}}}}function ee(e){const{duplicate:t,newParentId:o,newActionIds:n,actor:r,options:i}=e;t.parent_id=o,t.action_ids=n;const a=Date.now();t.created_time=a,t.last_edited_time=a,r&&(t.last_edited_by_id=r.id,t.last_edited_by_table=r.table,t.created_by_id=r.id,t.created_by_table=r.table),"recurrence"===t.trigger.type&&i.shouldDisableRecurrenceAutomation&&(t.status="disabled")}function te(e){const{original:t,duplicate:o,newParentId:n,getRecordRole:r}=e;o.parent_id=n,t.space_id!==o.space_id&&"slack_notification"===o.type&&(o.config={});const i=(0,c.o0)(o);if(i){i.some((e=>{const t=r(e.pointer);return!t||!(0,P.yY)(t,e.minimumRequiredRole)}))&&(o.config={})}}function oe(e){const{text:t,mapper:o,requester:n,resolveTemplateVariables:r,baseUrl:i,publicDomainName:a}=e;if(void 0!==t)return t.value.map((e=>function(e){const{token:t,mapper:o,requester:n,resolveTemplateVariables:r,baseUrl:i,publicDomainName:a}=e;let s;const l=b.hDy(t.token).map((e=>{if(b.STW(e)){const t=b.yrl(e);if(t){const e=o({requested:t,requester:n});if(e)return b.$0A(e.id,e.spaceId)}}if(b.j0F(e)){const t=b.zW$(e),r=(0,I.A5)({url:t,baseUrl:i,publicDomainName:a});if(r){const e=o({requested:{table:v.iU,id:r,spaceId:(0,Z.C)(void 0)},requester:n});if(e)return b.edl((0,I.nR)({pageId:e.id}))}}if(b.nSN(e)){const t=b.frW(e);if(t){const e=o({requested:{table:v.iU,id:t,spaceId:(0,Z.C)(void 0)},requester:n});if(e)return b.x36(e.id)}}if(b.xw5(e)){const r=b.h19(e),i=o({requested:{table:L.qF,id:r,spaceId:t.spaceId},requester:n});if(i)return b.jw(i.id)}if(b.aq(e)&&r){const t=b.x5L(e,r);if(t&&b.IWo(t)&&r){const e=b.zEN(t);if(e===r.currentUserId){if(s)return;s=e}}return t}if(b.IWo(e)&&r){const t=b.zEN(e);if(t===r.currentUserId){if(s)return;s=t}}return e})).filter(q.$K);return b.V3y(b.WiV(t.token),l)}({token:{token:e,spaceId:t.spaceId},mapper:o,requester:n,resolveTemplateVariables:r,baseUrl:i,publicDomainName:a})))}function ne(e){const{rootSourceBlockIds:t,childSourcePointer:o,getSourceRecordValue:n}=e;for(const r of(0,M.BW)(o,n))if(re({rootSourceBlockIds:t,recordWithTable:r}))return!0;return!1}function re(e){const{recordWithTable:t,rootSourceBlockIds:o}=e;if(t.table!==v.iU)return t.table===y.Xj;if(o.includes(t.value.id))return!1;if(g.kk.fromBlock(t.value).isTemplateVariableContainerBlock())return!0}},5220:(e,t,o)=>{o.d(t,{H:()=>a});var n=o(59730),r=o(90965),i=o(47425);function a(e){let{spaceModel:t,userId:o}=e;if(!t||!o)return!1;return void 0===function(e){const{spaceModel:t,userId:o}=e;if(!(0,r.wv)({permissions:t.getPermissionItems()},o))return new n.XV("You do not have permissions to this feature in the requested space.",{type:"generic_insufficient_permissions"});if(!(0,i.wP)(t.getSubscriptionTier()))return new n.XV("The feature is not available on your current plan type.",{type:"generic_insufficient_plan_type"})}({spaceModel:t,userId:o})}},55632:(e,t,o)=>{o.d(t,{HX:()=>y,fK:()=>f,$A:()=>h,Jq:()=>v,j2:()=>u,Pv:()=>b,j:()=>S});var n=o(15145),r=o(29450);var i=o(68626),a=o(72126),s=o(91155),l=o(4615);var c=o(64002);const d=new n.nY((async e=>{const{config:t,deviceId:r,disableCookies:i}=e,a=await o.e(9543).then(o.t.bind(o,16791,23));return await new Promise((e=>{const o=t.amplitude&&t.amplitude.apiKey;if(!o)return e(void 0);const s=new URL(t.domainBaseUrl),d=`${s.host}${t.api.http}/teV1`;let p=!0;"http:"===s.protocol&&(p=!1);const u=r?(0,l.XR)(r):void 0;a.getInstance("eventTrailApi").init(o,"",{apiEndpoint:d,forceHttps:p,includeReferrer:!0,includeUtm:!0,includeFbclid:!0,includeGclid:!0,unsetParamsReferrerOnNewSession:!1,saveParamsReferrerOncePerSession:!1,storage:i?"none":"",saveEvents:!i,deviceId:u},(o=>{o&&o.setVersionName((t.env,"2023092001")),e(o),function(){const e=(0,c.gy)(window.location.href);if(!e)return;const t={utm_campaign:e.searchParams.get("utm_campaign")||n.cL,utm_content:e.searchParams.get("utm_content")||n.cL,utm_medium:e.searchParams.get("utm_medium")||n.cL,utm_source:e.searchParams.get("utm_source")||n.cL,utm_term:e.searchParams.get("utm_term")||n.cL};f({traits:(0,n.bt)({...t})})}()}))}))}));function p(e,t,o){return function(n,r,l){if(200===n&&"success"===r)return;const c=a.CE(t,"experiments"),d={data:{responseBody:r,eventName:e,eventData:c,groupData:o},statusCode:n,message:null==l?void 0:l.reason};i.log({level:"error",from:"eventTrailApiHelpers",type:"trackFailure",error:(0,s.Ui)(d)})}}async function u(e){const{config:t,isEnabled:o,deviceId:n}=e,a=!(0,r.hasPermissionForThirdPartyServiceBrowser)("amplitude");try{await d.load({config:t,isEnabled:o,deviceId:n,disableCookies:a})}catch(l){i.log({level:"error",from:"eventTrailApiHelpers",type:"initialize",error:(0,s.Ui)(l)})}}function m(e,t){const o=new e.Identify;if(t)for(const n of Object.keys(t)){const e=t[n];void 0!==e&&(Array.isArray(e)?o.append(n,e):o.set(n,e))}return o}function g(e,t,o){const n=t.userPropertiesOperations||{};o.logEvent(e,n,void 0,p(e,n))}async function h(e){const{userId:t,traits:o,spaceIds:n}=e,r=await d.getInstance();if(!r)return;r.setUserId((0,l.XR)(t));const i=m(r,o);n&&i.set("workspace",a.jj(n)),g("$identify_user",i,r)}async function f(e){const{traits:t}=e,o=await d.getInstance();if(!o)return;const n=new o.Identify;for(const r of t)"set"===r.operation?n.set(r.name,r.value):"setOnce"===r.operation&&n.setOnce(r.name,r.value);g("$identify_device",n,o)}async function y(){const e=await d.getInstance();null==e||e.setUserId(null)}async function v(e){const{spaceId:t,spaceData:o}=e;if(!t)return;const n=await d.getInstance();if(!n)return;const r=a.d9(o),i=Object.entries(r).filter((e=>{let[t,o]=e;return Array.isArray(o)}));i.forEach((e=>{let[t,o]=e;return delete r[t]}));var s=m(n,r);i.forEach((e=>{let[t,o]=e;return s=s.set(t,o)})),n.groupIdentify("workspace",t,s)}async function b(e){const t=await d.getInstance();t&&t.setDeviceId((0,l.XR)(e))}async function S(e){const{eventName:t,eventData:o,spaceId:n}=e,r=await d.getInstance();if(r)if(n){const e={workspace:n};r.logEventWithGroups(t,o,e,void 0,p(t,o,e))}else r.logEvent(t,o,void 0,p(t,o))}},12174:(e,t,o)=>{o.d(t,{DP:()=>h,KM:()=>u,LI:()=>_,TS:()=>f,XY:()=>v,YY:()=>k,_n:()=>x,b2:()=>b,dn:()=>S,g6:()=>r,l4:()=>y,nb:()=>I});var n=o(97880);const r={"search-vectors":["log-norm","min-max-norm","cohere-snippets"],"vector-search-vanilla-ltr":["on","force-disable"],"search-no-local-blending":["on"],"search-debug-only-no-recent-boosting":["on"],"search-clear-results-on-query-change":["on"],"search-shorten-inactive-timer":["0","10","30","60","90"],"search-use-qwak":["on","on:tensorops_dev_xgboost:50","on:tensorops_dev_xgboost:100","on:tensorops_dev_xgboost:200","on:tensorops_dev_playground:50","on:tensorops_dev_playground:100","on:tensorops_dev_playground:200","on:xgboost2ndcg_new:50","on:xgboost2ndcg_new_2:50"],"search-debug-only-force-random-sample":["on"],"search-debug-force-shuffle":["2","5","10"],"search-debug-force-log-signals":["on"],"search-more-recent-pages-in-local":["lazy-100","lazy-200","lazy-500","lazy-1000"],"search-intent-based-grouping-n-side-peek":["on"],"search-results-new-utilities":["on"],"search-includes-current-page-in-local-search":["on"],"search-client-ltr-v0":["ridgereg","logreg","svc"],"search-new-local-recall-v1":["popular_pages","sim_user_visits","user_edits","sim_user_edits"],"search-block-text-queries":["v2"],"search-no-local-recent-records-invalidations":["on"],"search-query-expansion":["prefix-completion","word-splitting","spell-correction","all"],"search-recall-phase-boosts":["ss_unique_balanced_0_1_5","mm_unique_balanced_noneg","mm_unique_balanced_1","mm_unique_balanced_f1"]},i={teams_invite_link:["on"],team_invite_link_ms2:["on"],expandable_permission_items:["on"]},a={simplified_email_subject_line:["on"],improved_product_notif_email_and_settings:["on"],mobile_push_notification_v2:["on"],mobile_push_notification_v2_actions:["on"],inbox_2_0:["on"]},s={new_page_suggested_templates:["variant_1","variant_2","variant_3","variant_4"],acquisition_global_holdout_aa_testing:["on"],acq_simplify_enterprise_joiner_onboarding_flow_v1:["on"],page_invite_message:["control","variant_1","variant_2"],invitation_email_final_reminder:["on"],onboarding_invite_skip_button:["on"],share_modal_placeholder:["on"],share_modal_pending_invite_status_ui:["on"],invitation_modal_guest_vs_member_tag:["on"],invite_email_quotes:["on"],share_modal_guest_member_confirmation:["v1","v2"],page_invitation_email_selfserve_exp:["v1","v2","v3","v4"],space_invitation_email_selfserve_exp:["v1","v2","v3","v4"],persona_survey_joiner:["banner_only","banner_with_survey"],share_modal_autofill_email:["control","v1"],humanize_page_invite_joiner_email_copy:["on"],persona_template_truncation:["on"],acq_person_property_invite_v1:["on"],rename_general_teamspace:["on"],simplify_template_options:["v1","v2"],block_names_in_six_dot_menu:["on"],team_land_getting_started:["on"],delay_invite_your_team_email:["on"],team_sidebar_tour:["on"]},l={in_app_contact_sales_cta_billing:["on"]},c={block_limit_cta_earlier:["25","50"],block_limit_increase:["on"],block_limit_reduction:["on"],churn_nudge:["on"],largesse:["on"],mobile_web_subscriptions:["on"],quick_workspace_creation:["on"],subscription_payment_status:["message_only","on"],subscription_default_annual:["on"],subscription_elements:["payment_and_address","payment"],tt_me_pregunto:["on"],tt_pp:["on"],upsell_colors:["on"]},d={csv_adaptiveschema:["on"],csv_column_limit:["on"]},p={log_in_from_template_duplication:["on"],template_duplication_topbar:["on","variant_2"],public_page_template_sidebar:["on"]},u=["beta","alpha","canary","development","ai_team"],m={assistant_variant:u,qna_answer_using:["anthropic-qa-alpha","anthropic-1","openai-2","openai-5","openai-6"]},g={"indexeddb-transaction-timeout-v2":["on"],"product-page-length":["no-demo","short-scroll","shortest-scroll"],"remove-profile-photo-string":["on"],"heath-ceramics":["on"],csat:["on"],"template-checklist":["on"],mermaid:["on"],polyglot:["on"],rc:["on"],"ios-json-bridge-v2":["on"],"clear-record-cache-on-login":["on"],"await-update-user-id":["on"],aloha:["on"],"multi-select-new-page-view-block-layout":["on"],"embed-previews":["on"],"beta-developers-external":["on"],"db-sync":["on"],janus:["on"],"mobile-drag-delay":["1000","600","700","800","900","1100","1200","1300","1400","1500"],"android-context-menu":["on"],"mobile-bottom-bar-ios-v4":["on"],"lucy-in-the-sky-with-tab-blocks":["on"],"messagestore-ios-v3":["on"],"home-ios":["on"],"home-ipad":["on"],"home-android":["on"],"txnqueue-ios-v6":["on"],"onboarding-emails":["generic","meeting-notes-focused"],patchExternalCollection:["on"],"emoji-apple-spritesheets":["enabled"],"default-new-page-property-to-hide-when-empty":["on"],"android-background-bridge-message-parsing":["on"],"columns-full-width":["on"],"notion-to-slack":["on"],"notion-mentions-to-slack":["on"],slash_menu_spaces_preceding:["on"],geo_ip_lookup_database:["on"],database_sync_for_google_calendar:["on"],database_sync_for_gitlab:["on"],database_sync_for_asana:["on"],enforce_enterprise_tier_for_scim:["on"],collections_workspace_client_mode:["on_200","on_500","on_1000"],...r,...i,...a,...s,...l,...c,...p,...d,"newer-primus":["on"],sort_indexeddb_tasks_by_index:["on"],marketing_home_page_hero_signup:["test","focus","work"],marketing_home_hero_text:["V1","V2","V3"],above_the_fold_product:["V1","V2","V3","V4"],marketing_contact_3_new_fields:["test"],template_gallery_web:["on"],invite_members_from_share_menu:["on"],try_notion_cta:["V1","V2","V3","V4","V5"],statsig_space_id_debug:["on"],enforce_write_once_permissions_for_block_updates:["on"],"contextual-invite-on-select-focus":["on"],integration_discovery:["top_left_sidebar","bottom_right_button"],zendesk:["on"],relations_sections:["on"],collection_table_drag_and_fill:["on"],collection_client_refetch_throttle_time_ms:["2000","3000","5000"],collections_loading_state:["on"],highlight_legacy_transclusions:["on"],lightbox_v2:["on"],user_similarity_debugging:["on"],log_iframely_results:["on"],iframely_switch:["on"],prompt_work_account_sidebar:["on"],request_membership:["on"],parallel_confluence_importer:["on"],parallel_confluence_importer_via_api:["on"],special_case_confluence_file_size:["on"],confluence_dynamic_batch_size_temp:["on"],confluence_server_allow_requests:["on"],confluence_logs:["on"],confluence_api_v2:["on"],send_notification_for_transfer_content:["on"],use_inert_html_attribute:["on"],box_file_picker:["on"],guest_membership_request:["on"],link_preview_resizing:["on"],link_preview_resizing_api:["on"],google_external_integration_file_picker:["on"],enable_google_drive_external_integration:["on"],import_slack_contacts:["on"],my_home:["on"],show_instruction_on_auth_popup_blocked:["on"],block_property_router:["on","on_v2"],teamspace_guests:["on"],asana_max_task_limit:["on"],better_asana_importer:["on"],monday_importer:["on"],generic_importer:["on"],special_case_generic_file_size:["on"],asana_to_single_team_space:["on"],learn_notion_three_steps:["on"],state_manangement_in_asana_importer:["on"],android_3rd_party_login_with_external_browser:["on"],ios_3rd_party_login_with_external_browser:["on"],block_limit_delay:["on"],asana_import_by_batch:["on"],intro_share_tooltip_condition:["d3","b200"],ignore_non_renderable_blocks_in_export:["on"],prioritize_slash_menu_block_placeholder:["on"],joiner_subject_line_v2:["variant_1","variant_2","variant_3"],joiner_email_illustration:["joiner_email_illustration_on"],joiner_email_facepile:["on"],slash_menu_tooltip:["on"],redirect_after_passcode_sent:["with_gmail_cta","without_gmail_cta"],wiki_education_convert_modal:["bottom_right"],full_access_privacy_selector:["on"],avoid_empty_eoip_creation_unfurl_collection:["on"],local_currency_first_experiment:["on"],mobile_voice_input:["web_system_api","native_system_api","third_party_whisper","third_party_deepgram"],page_tree_query:["cte","cte_and_dark_read_v1","v1_and_dark_read_cte"],block_property_item_indexing:["on"],random_house:["on"],...m,export_comments:["on"],safari_17_transaction_queue:["force_in_memory","prefer_indexed_db"],indexeddb_graceful_fallback_to_in_memory_queue:["on"],ai_writer_autofill_gpt_4:["on"]};function h(e){return Boolean(g[e])}const f=new Set([]),y=["log_iframely_results","iframely_switch","database_sync_for_google_calendar","database_sync_for_gitlab","database_sync_for_asana","enforce_enterprise_tier_for_scim","slash_menu_spaces_preceding","geo_ip_lookup_database","sort_indexeddb_tasks_by_index","marketing_contact_3_new_fields","marketing_home_page_hero_signup","marketing_home_hero_text","above_the_fold_product","invite_members_from_share_menu","try_notion_cta","contextual-invite-on-select-focus","enforce_write_once_permissions_for_block_updates","integration_discovery",...(0,n.Yd)(i),"zendesk","highlight_legacy_transclusions","lightbox_v2","relations_sections","collection_table_drag_and_fill","prompt_work_account_sidebar","request_membership","special_case_confluence_file_size","special_case_generic_file_size","confluence_dynamic_batch_size_temp","confluence_server_allow_requests","confluence_logs","user_similarity_debugging","send_notification_for_transfer_content","use_inert_html_attribute","box_file_picker","google_external_integration_file_picker","guest_membership_request","link_preview_resizing","link_preview_resizing_api","enable_google_drive_external_integration","import_slack_contacts","show_instruction_on_auth_popup_blocked","parallel_confluence_importer","parallel_confluence_importer_via_api","confluence_api_v2",...(0,n.Yd)(r),...(0,n.Yd)(s),...(0,n.Yd)(l),"block_property_router",...(0,n.Yd)(c),...(0,n.Yd)(p),...(0,n.Yd)(d),"teamspace_guests","asana_max_task_limit","better_asana_importer","monday_importer","generic_importer","asana_to_single_team_space","state_manangement_in_asana_importer",...(0,n.Yd)(a),"learn_notion_three_steps","android_3rd_party_login_with_external_browser","ios_3rd_party_login_with_external_browser","collection_client_refetch_throttle_time_ms","block_limit_delay","asana_import_by_batch","intro_share_tooltip_condition","ignore_non_renderable_blocks_in_export","prioritize_slash_menu_block_placeholder","joiner_subject_line_v2","joiner_email_illustration","joiner_email_facepile","slash_menu_tooltip","redirect_after_passcode_sent","wiki_education_convert_modal","full_access_privacy_selector","avoid_empty_eoip_creation_unfurl_collection","local_currency_first_experiment","collections_workspace_client_mode","collections_loading_state","mobile_voice_input","page_tree_query","block_property_item_indexing","random_house",...(0,n.Yd)(m),"export_comments","safari_17_transaction_queue","indexeddb_graceful_fallback_to_in_memory_queue","ai_writer_autofill_gpt_4"],v=[...y].sort(),b=["polyglot","enforce_write_once_permissions_for_space_updates","collections_service_bulk_source_fetching","person_vote","allow_dead_space_views_when_joining_space","throw_on_changing_unmanaged_scim_user","log_all_headers_for_unknown_scim_idp","enable_get_private_page_info_endpoint","wiki_database","log_saml_response_on_error","wiki_query_killswitch","default_person_property","connected_relation","enable_search_team_filter","expiring_public_links","enable_property_view_icons","enable_emoji_icon_color_picker","collection_dependencies","relation_left_properties","button_property","text_selection_completions","new_page_completions","completions_chat","database_sync_ugc","triage_notification_can_read","admin_content_search_tab","model-2","model-3","model-4","model-5","japan_full_launch","event_trail_router_v2","ai_waitlist_in_app_popup","model-2-space","model-3-space","model-4-space","model-5-space","public_api_dev_mode","optimize_single_workspace","enabled_bev_default_audience_filter","sprig","ai_multi_level_undo","ai_favorites","autoretry_file_uploads","audit_log_enterprise_cache_check","enable_secure_file_url_for_user","jit_onboarding_improvements","prevent_saml_guest_login","saml_hide_onboarding_password","free_tier_sync_database","developer_integration_form_redesign","return_scim_errors_to_client","use_secure_file_url_for_audit_log","use_secure_file_url_for_space_export","use_secure_file_url_for_block_export","return_404_on_scim_get_for_user_not_in_workspace","client-performance-profiler","react_18_concurrent_rendering","customerio","dev_only_show_updates_filters","property_updates_notifications","product_notif_email_improvements","enable_notifications_processor","sidebar_pages_hide_toggles","prefetch_spaces","sidebar_home_gate","sidebar_home_beta_gate","home_show_tips","team_add_app_template_tooltip","new_share_menu_tooltip","optimize_fetch_user_content_emit","load_cached_page_chunk_no_space","send_reminder_log_debugging","collections_relation_picker_require_edit_perms","typed_db_creation","proj_management_sprints_upgrade","proj_management_tooltip_tour","unique_id","formulas_dark_read","db_view_scrolling_refactor","sync_collection_relation_as_admin","collections_bulk_relation_sync_queue_enabled","property_descriptions","collection_subitem_nested_operations","collection_level_subitems_setting","duplicate_collection_schema","webhooks_beta","public_api_developer_survey","e_discovery","add_comments_on_blocks","install_dlp_integrations","public_api_use_secure_file_proxy","webhooks_enable_nightfall","advanced_security_in_enterprise","deny_multiplayer_personal_plan_upgrade","enable_midterm_subscription_changes","estudiantes","test_clocks","upgrade_modal_ai_option","in_app_template_gallery","template_submission_form","layout_collection_view_page","layout_main_frame_page","layout_toggles","remove_legacy_editor_styling","csv_validation_errors_fix","card_details_unified","trello_pagination_enabled","trello_media_queue","enable_text_crdt_server","enable_text_crdt_client","block_attribution","space_consolidation_ga","desktop_app_login_with_email_redirect","ai_property_autofill_v2","desktop_app_signup_hide_passcode","ios_app_signup_hide_passcode","better_asana_import_task_dependency","user_data_consent_admin_bypass","goodbye_credits","link_preview_auth_with_server_integration","formulas_prototype","formula_buttons","ai_onboarding_logging","enable_deleted_page_indicator","onetrust_onboarding_checkbox","forethought","survey_data_writes","typed_db_improvements_property_restrictions","typed_db_improvements_announcement","enable_refetch_eoi_blocks_on_retry","adding_extra_logs_in_eoi_retry_fg","snapshot_optional_collection_rollback_enabled","prevent_login_with_temporary_password","saml_throw_on_temporary_password_use_case_mismatch","saml_enforced_disallow_send_temporary_password","audit_log_aes_event_read","audit_log_permanently_deleted_filter_enable","audit_log_event_name_column","guest_invite_requests","drawing_block","log_identify_cross_domain_device_ids","duplcate_template_tracking_serverside","disable_ai_big_red_button","ai_data_sharing","convert_cut_paste_to_move","text_align","enable_giphy_feature_gate","dependency_date_shifting_by_space","admin_content_search_only_search_titles","legacy_slack_notifications","overlay_trap_focus","mobile_better_filing_eligibility","server_dispatch_recents_background_fetch","client_handle_query_collection_locally","onetrust_onboarding_unsub_link","experimental_non_page_block_links","google_drive_connected_relation","figma_connected_relation","zendesk_connected_relation","cron_connected_relation","zendesk_ai_enabled","toggleable_transcript","use_assembly","transcript_feedback_button","space_for_ai_tooltip_enabled","log_page_exit_events_to_analytics","export_collections_v1","use_new_export_notification","message_store_client_send_request_metric_enabled","template_gallery_web","response_size_instrumentation","append_favorites","permanently_delete_tree","collection_properties_select_auto_sort_options","collection_typed_db_duplication","support_synced_database_automations","template-variable-properties","template_contentful_sync_job","mobile_bridge_performance_logging","ai_source_picker","client_http_gzip","is_visibility_enabled_for_db_sync","disable_poll_jobs_for_collection_entities","export_new_structure","embed_block_fallback","automation_update_pages_batching","topbar_connection_indicator_v2","delete_kvs","force_kvs_break","add_ai_summary_button_transcript","enable_guest_export","animated_use_css_transition","perform_get_latest_activity_queries_sequentially","autofill_translate","scim_post_user_version_conflict","collections_view_specific_client_mode_enabled","autofill_tags","autotag_ambient_trigger","dark_fetch_autotag","typed_move_to_improved_search","typed_move_to_improved_default_results","first_party_links","search_index_collection_ranking_features","ios_enable_prefetching","hide_orphan_blocks","restore_private_pages","wiki_perf_improvement_local_enabled","show_keep_existing_guests_modal","export_content_analytics_stream","export_admin_content_search_stream","export_puppeteer_upgrade","affiliates_s2s_routing","meeting_notes_transcript_consumer_setup","meeting_notes_transcript_new_consumer","meeting_notes_formatting_fix","enable_external_integration_auth_strict_access","student_form","native-find-in-page","assistant-labeler-mode","vector_db_search","vector-search-live-indexing","embeddings-enabled-for-spaceid","qna-slack-workspaces","vector-spans-instead-of-load-page","people_profile_popup","collection_split_aggregation_v2","search_modal_qna","send_student_form_error_messages","recurrence_queue_task_improvements","enterprise_launch_modal","quick_search","share_modal_invalid_invite_tokens","search_toggle_side_peek","update_space_permissions_if_no_records","improved_asana_importer_screens","disable_storage_manager_estimate","recurring_sprints","two_way_property_clear_on_delete","toc_nested_headings","use_new_undo_redo_behavior","inline_mention_invites","qna_nov_9_rollout","derived_property_sync_processor","organization_audit_logs"],S=[...b].sort(),_={event_trail_events:{},event_trail_routing:{},collection_request_settings:{clientFormulaTimeoutMs:3e5},sentry:{errorsSampleRate:0,"tracesSampleRate-v0":0,"replaysSessionSampleRate-v0":0,"replaysOnErrorSampleRate-v0":0,profilesSessionSampleRate:0,profilesSampleRate:0},gtm_ai_favorites:{space_id:void 0,collection_id:void 0},palette:{"sessionSampleRate-v4":0,pageLoadSampleIntervalMs:10,interactionSampleIntervalMs:10,maxBufferSize:1e5},permanently_delete_tree_queue_task_override:{queue_task_kill_switch_on:!1,task_delay_override_seconds:void 0,elastic_search_request_batch_size:200,s3_request_batch_size:200,redis_read_batch_size:1e4,tree_iteration_batch_size:1e4,tree_iteration_max_buffer_size:5e4,s3_isolation_project_done:!1},education_free_submit_form_config:{},notion_people_block_id:{data:{}},template_ids_to_use_duplicate_block:{data:[]},csv_limits:{maxRows:1e5,maxColumns:500}},w=new Set(y);function k(e){return w.has(e)}function x(e){return g[e]}const I="_unassigned_"},64962:(e,t,o)=>{o.d(t,{O:()=>F});o(57658);var n=o(66897),r=o(15145),i=o(15070),a=o(90559),s=o(35011),l=o(80951),c=o(34299),d=o(56373),p=o(1800),u=o(40506),m=o(7057),g=o(53877),h=o(61075),f=o(64572),y=o(72126),v=o(25718),b=o(59753),S=o(63306),_=o(21202),w=o(77420),k=o(6287),x=o(19889),I=o(70203),C=o(7928),T=o(63143),M=o(4308);const P=m.ZV;function A(e){return(0,h.hJ)({...e,fromString:e=>e}).join("")}function D(e){const{textValue:t}=e;if(t){const o=[];for(const n of t)I.QJH(n)||o.push(A({...e,textValue:[n]}));return o.join(", ")}return""}const B={[I.GKr.Page]:e=>{let{annotation:t,exportArgs:o}=e;const{getExportedPathToPage:n}=o,r=I.TOT(t),i=(0,h.Ho)({intl:o.intl,blockId:r,getRecordValue:o.getRecordValue,userTimeZone:o.userTimeZone}),a=n({toPageId:r});if(i&&a)return`${i} (${a})`},[I.GKr.Comment]:e=>{let{annotation:t,exportArgs:o}=e;const{getRecordValue:n,baseUrl:i}=o,a=b.om.fromGetRecordValueFn(n),s=I.$WM(t);if(!s)return;const l=a(s);if(!l)return;const c=l.getParentId(),d=l.getParentPointer(),u=(0,S.el)((0,S.DW)(d,n));if(!u)return;const m=a(d);let g;if(m){const e=a(m.getParentPointer());g=e&&"table_row"===e.getType()?e.getParentId():m.getParentId()}return(0,p.Z)({pageId:u.id,scrollToBlockId:g,pageValue:u,baseUrl:i,discussionId:c,pageVisitSource:r.tY.Export})},[I.GKr.Link]:e=>{let{annotation:t,exportArgs:o}=e;const{getExportedPathToFile:n,getExportedPathToPage:r,navigableBlockId:i,baseUrl:a,publicDomainName:s}=o,l=I.zW$(t),c=(0,f.A5)({url:l,baseUrl:a,publicDomainName:s});return c?r({toPageId:c}):n({fromBlockId:i,toFileURI:l})},[I.GKr.User]:e=>{let{annotation:t,exportArgs:o}=e;const{intl:n}=o,r=I.zEN(t),i=o.getRecordValue({table:x.KJ,id:r});if(i)return`@${(0,C.Nz)(n,i)}`},[I.GKr.Bot]:e=>{let{annotation:t,exportArgs:o}=e;const n=I._Rq(t),r=o.getRecordValue({table:w.cZ,id:n});if(r)return`@${(0,i.Mh)(r)}`},[I.GKr.Group]:e=>{let{annotation:t,exportArgs:o}=e;const n=(0,h.kF)({annotation:t,exportArgs:o});if(n)return n},[I.GKr.ExternalObjectInstance]:e=>{var t;let{annotation:o,exportArgs:n}=e;const r=I.frW(o);return null===(t=n.getRecordValue({table:_.iU,id:r,spaceId:n.root.spaceId}))||void 0===t||null===(t=t.format)||void 0===t?void 0:t.original_url},[I.GKr.Date]:e=>{let{annotation:t,exportArgs:o}=e;const{date_format:n,time_format:r,...i}=I.zyO(t);return`@${(0,m.ZV)({value:i,date_format:n,time_format:r,userTimeZone:o.userTimeZone,allowRelativeDates:!1,intl:o.intl})}`},[I.GKr.Equation]:e=>{let{annotation:t,exportArgs:o}=e;const n=(0,v.dx)(t),r=(0,v.wB)(t,o.getExportedPathToPage,o);return`${n}${I.xey(t)}${r}`},[I.GKr.Bold]:h.Hf,[I.GKr.Italic]:h.Hf,[I.GKr.Strike]:h.Hf,[I.GKr.Code]:h.Hf,[I.GKr.Highlight]:h.Hf,[I.GKr.Discussion]:h.Hf,[I.GKr.Underline]:h.Hf,[I.GKr.Inserted]:h.Hf,[I.GKr.Deleted]:h.Hf,[I.GKr.TemporaryComment]:h.Hf,[I.GKr.TemporaryEquation]:h.Hf,[I.GKr.TemporaryPage]:h.Hf,[I.GKr.TemporaryInput]:h.Hf,[I.GKr.TemporarySelection]:h.Hf,[I.GKr.TemporaryFindHighlight]:h.Hf,[I.GKr.TemplateVariable]:h.Hf,[I.GKr.FormulaPageProperty]:h.Hf,[I.GKr.FormulaContextValue]:h.Hf,[I.GKr.FormulaError]:h.Hf,[I.GKr.Citation]:h.Hf},R=()=>{},E=()=>Promise.resolve(void 0),F={blockRenderers:{text:R,header:R,sub_header:R,sub_sub_header:R,quote:R,bulleted_list:R,toggle:R,to_do:R,numbered_list:R,code:R,page:R,image:R,video:R,embed:R,bookmark:R,file:R,tweet:R,maps:R,gist:R,framer:R,invision:R,mixpanel:R,drive:R,figma:R,loom:R,pdf:R,typeform:R,codepen:R,audio:R,divider:R,equation:R,collection_view:R,collection_view_page:R,column_list:R,column:R,factory:R,copy_indicator:R,breadcrumb:R,link_to_collection:R,link_to_page:R,table_of_contents:R,callout:R,whimsical:R,miro:R,abstract:R,sketch:R,excalidraw:R,replit:R,alias:R,transclusion_container:R,transclusion_reference:R,external_object_instance:R,table:R,table_row:R,tab:R,hex:R,deepnote:R,external_object_instance_page:R,button:R,ai_block:R,drawing:R,personal_home_page:R},asyncBlockRenderers:{text:E,header:E,sub_header:E,sub_sub_header:E,quote:E,bulleted_list:E,toggle:E,to_do:E,numbered_list:E,code:E,page:E,image:E,video:E,embed:E,bookmark:E,file:E,tweet:E,maps:E,gist:E,framer:E,invision:E,mixpanel:E,drive:E,figma:E,loom:E,pdf:E,typeform:E,codepen:E,audio:E,divider:E,equation:E,collection_view:E,collection_view_page:E,column_list:E,column:E,factory:E,copy_indicator:E,breadcrumb:E,link_to_collection:E,link_to_page:E,table_of_contents:E,callout:E,whimsical:E,miro:E,abstract:E,sketch:E,excalidraw:E,replit:E,alias:E,transclusion_container:E,transclusion_reference:E,external_object_instance:E,table:E,table_row:E,tab:E,hex:E,deepnote:E,external_object_instance_page:E,button:E,ai_block:E,drawing:E,personal_home_page:E},annotationRenderers:B,propertyRenderers:{title:e=>A(e),text:A,select:e=>{const{textValue:t,propertySchema:o}=e,n=o.options||[];return l.Sj(t,n)},multi_select:e=>{const{textValue:t,propertySchema:o}=e,n=o.options||[],r=l.uP(t,n);return r.sort(),r.join(", ")},status:e=>{const{textValue:t,propertySchema:o}=e;return l.ZG(t,o)},relation:e=>{const{textValue:t,propertySchema:o,exportArgs:n}=e;if("relation"!==o.type)return;const r=l.j$({relationValue:l.rq(t),getRecordModel:b.om.fromGetRecordValueFn(n.getRecordValue),propertySchema:o}),i=l.ow(r);return D({...e,textValue:i})},rollup:e=>{const t=e.exportArgs.getRecordValue,o=b.kk.fromValue(_.iU,e.block),n=b.om.fromGetRecordValueFn(t);return c.kJ({...e,block:o,getRecordModel:n,collectionRequestContext:{userId:void 0,userTimeZone:e.exportArgs.userTimeZone,depth:0,intl:e.exportArgs.intl,visitedProperties:new Set,resultCache:e.exportArgs.resultCache}})},url:e=>{let{textValue:t}=e;return l.zB(t)},email:e=>{let{textValue:t}=e;return l.zB(t)},phone_number:e=>{let{textValue:t}=e;return l.zB(t)},checkbox:e=>{let{textValue:t}=e;return l.Ml(t)?"Yes":"No"},person:e=>{let{textValue:t,exportArgs:o,propertySchema:n,block:r}=e;const{intl:i}=o,a=b.kk.fromBlock(r),s=l.DW({textValue:t,propertySchema:n,blockCreatorPointer:a.getCreatedByPointer()});return y.oA(s.map((e=>{const t=o.getRecordValue(e),n=t&&b.kk.fromValue(e.table,t);return null==n?void 0:n.getDisplayName(i)}))).join(", ")},number:e=>{let{textValue:t}=e;const o=l.VY(t);if(void 0!==o)return o.toString()},date:e=>{let{textValue:t,propertySchema:o,...n}=e;const r=n.exportArgs.userTimeZone,i=l.Gl(t),{date_format:a,time_format:s}=o;if(i)return(0,m.ZV)({allowRelativeDates:!1,value:i,date_format:a,time_format:s,userTimeZone:r,intl:n.exportArgs.intl})},file:D,formula:e=>{const{property:t,schema:o,block:n,exportArgs:r}=e,{userTimeZone:i,getRecordValue:a,intl:l,resultCache:c}=r,d=(0,s.py)({schema:o,property:t,blockModel:b.kk.fromBlock(n),getRecordModel:b.om.fromGetRecordValueFn(a),intl:l,userTimeZone:i,depth:0,resultCache:c});return"boolean"==typeof d?d?"Yes":"No":(0,T.hj)(d)?d.toString():(0,u.U3)(d)?P({value:d,userTimeZone:i,allowRelativeDates:!1,intl:r.intl}):d},created_time:e=>{const{block:t,exportArgs:o}=e,{userTimeZone:n}=o;if(t.created_time)return P({allowRelativeDates:!1,value:(0,g.CQ)(t.created_time,n),userTimeZone:n,intl:o.intl})},last_edited_time:e=>{const{block:t,exportArgs:o}=e,{userTimeZone:n}=o;if(t.last_edited_time)return P({allowRelativeDates:!1,value:(0,g.CQ)(t.last_edited_time,n),userTimeZone:n,intl:o.intl})},created_by:e=>{const{block:t,exportArgs:o}=e,{getRecordValue:r,intl:i}=o;if(t.created_by_table&&t.created_by_id){const e=(0,n.Hl)({getRecordValue:r,pointer:{table:t.created_by_table,id:t.created_by_id,spaceId:t.space_id}});if(e.asActor)return(0,n.$4)(i,e)}},last_edited_by:e=>{const{block:t,exportArgs:o}=e,{getRecordValue:r,intl:i}=o;if(t.last_edited_by_table&&t.last_edited_by_id){const e=(0,n.Hl)({getRecordValue:r,pointer:{table:t.last_edited_by_table,id:t.last_edited_by_id,spaceId:t.space_id}});if(e.asActor)return(0,n.$4)(i,e)}},button:e=>"",auto_increment_id:e=>{let{textValue:t,block:o,exportArgs:n}=e;const r=l.ah(t),{getRecordValue:i}=n;if(void 0!==r){const e=b.kk.fromBlock(o),t=e.getParentTable();if(t!==k.v)return;const n=i((0,d.We)({spaceId:e.getSpaceId(),parentTable:t,parentId:e.getParentId()}));return(0,a.wf)(null==n?void 0:n.record_key,r)}},last_visited_time:e=>"",location:e=>"",verification:e=>{let{textValue:t,exportArgs:o}=e;const n=l._w(t);if(!n)return"";const r=M.WN(n);return o.intl.formatMessage(M.A3(r.type))}}}},42509:(e,t,o)=>{o.d(t,{Ev:()=>l,Gq:()=>s,OY:()=>p,hD:()=>c});var n=o(21202),r=o(6287),i=o(97880);(0,i.AO)((e=>e&&e.parent_table===n.iU&&a(e)&&e.format&&e.format.original_url&&!e.format.is_placeholder?{true:e}:{false:e})),(0,i.AO)((e=>{var t,o;return e&&e.parent_table===n.iU&&a(e)&&e.format&&void 0===e.format.original_url&&null!==(t=e.format)&&void 0!==t&&t.external_object_id&&null!==(o=e.format)&&void 0!==o&&o.uri&&!e.format.is_placeholder?{true:e}:{false:e}}));const a=(0,i.AO)((e=>d(e)&&"external_object_instance"===e.type?{true:e}:{false:e})),s=((0,i.AO)((e=>d(e)&&"external_object_instance_page"===e.type?{true:e}:{false:e})),(0,i.AO)((e=>e&&e.parent_table===r.v&&d(e)&&"external_object_instance_page"===e.type?{true:e}:{false:e})),(0,i.AO)((e=>{var t;return d(e)?{false:e}:e.parent_table===n.iU&&null!==(t=e.format)&&void 0!==t&&t.original_url&&e.format.external_object_id?{true:e}:{false:e}}))),l=(0,i.AO)((e=>{var t;return d(e)?{false:e}:e.parent_table===n.iU&&null!==(t=e.format)&&void 0!==t&&t.original_url&&!e.format.external_object_id?{true:e}:{false:e}})),c=((0,i.AO)((e=>{var t;return!e||d(e)?{false:e}:e.parent_table===r.v&&null!==(t=e.format)&&void 0!==t&&t.external_object_id?{true:e}:{false:e}})),(0,i.AO)((e=>{var t,o;return!e||d(e)?{false:e}:null!=e&&null!==(t=e.format)&&void 0!==t&&t.original_url||null!=e&&null!==(o=e.format)&&void 0!==o&&o.external_object_id||p(e)||u(e)||m(e)?{true:e}:{false:e}}))),d=(0,i.AO)((e=>"type"in e&&e.type?{true:e}:{false:e})),p=((0,i.AO)((e=>void 0===e.format?{true:e}:{false:e})),(0,i.AO)((e=>{var t;return null!==(t=e.format)&&void 0!==t&&t.is_placeholder?{true:e}:{false:e}})),(0,i.AO)((e=>{var t,o;return!e||d(e)?{false:e}:null!==(t=e.format)&&void 0!==t&&t.is_placeholder&&null!==(o=e.format)&&void 0!==o&&o.integration_id?{true:e}:{false:e}}))),u=(0,i.AO)((e=>d(e)?{false:e}:e.parent_table===r.v&&e.format&&e.format.uri&&void 0===e.format.external_object_id&&e.format.integration_id?{true:e}:{false:e})),m=(0,i.AO)((e=>d(e)?{false:e}:e.parent_table===r.v&&e.format&&e.format.uri&&void 0===e.format.external_object_id&&void 0===e.format.integration_id?{true:e}:{false:e}))},76218:(e,t,o)=>{o.d(t,{A6:()=>d,Ck:()=>m,H0:()=>g,OH:()=>b,S3:()=>f,UB:()=>y,YD:()=>c,Zw:()=>v,iC:()=>p,qW:()=>h});o(57658);var n=o(76725),r=o(72126),i=o(6287),a=o(23867),s=o(70203),l=o(97880);function c(e){if(void 0!==e)return[u(e)]}function d(e){const t=e||[],o=[];for(const n of t){const e=(0,s.hDy)(n),t=(0,s.hH9)(e)||(0,s.V8Y)(e)||(0,s.sP4)(e)||(0,s.K9C)(e);t&&o.push(t);const r=(0,s.WiV)(n).split(",");for(const n of r){const e=n.trim(),t=e.indexOf('"'),r=e.lastIndexOf('"');if(t>=0&&r>=0){const n=e.slice(t+1,r);n.length>0&&o.push(n)}else"true"===e?o.push(!0):"false"===e&&o.push(!1)}}return o}function p(e){const t=r.mN(e,(e=>JSON.stringify(e)));if(0!==t.length)return(0,s.Zxt)([["["],...(0,n.Z)(t.map(u),(()=>[", "])),["]"]])}function u(e){return"string"==typeof e?[`"${e}"`]:"boolean"==typeof e?[`${e}`]:(0,s.YCD)(e)}function m(e,t){return e.filter((e=>JSON.stringify(e)!==JSON.stringify(t)))}function g(e,t,o){const n=h(e,t,o);if(n)return function(e){if("text"===e.type)return e;if("number"===e.type)return e;if("checkbox"===e.type)return e;if("date"===e.type)return e;if("block_array"===e.type)return{type:"array",of:{type:"block",collection:e.collection}};if("person_array"===e.type)return{type:"array",of:{type:"person"}};if("select"===e.type)return{type:"select",collection:e.collection,property:e.property};if("select_array"===e.type)return{type:"array",of:{type:"select",collection:e.collection,property:e.property}};(0,l.t1)(e)}(n)}function h(e,t,o){if("text"===o.type||"url"===o.type||"email"===o.type||"phone_number"===o.type||"title"===o.type)return{type:"text"};if("checkbox"===o.type)return{type:"checkbox"};if("multi_select"===o.type)return{type:"select_array",collection:e,property:t};if("select"===o.type||"status"===o.type)return{type:"select",collection:e,property:t};if("person"===o.type)return{type:"person_array"};if("number"===o.type||"auto_increment_id"===o.type)return{type:"number"};if("date"===o.type)return{type:"date"};if("relation"===o.type){if(o.collection_pointer)return{type:"block_array",collection:{table:i.v,id:o.collection_pointer.id,spaceId:(0,a.C)(o.collection_pointer.spaceId)}};if(o.collection_id)return{type:"block_array",collection:{table:i.v,id:o.collection_id,spaceId:e.spaceId}}}else{if("formula"===o.type||"rollup"===o.type||"last_edited_by"===o.type||"last_edited_time"===o.type||"button"===o.type||"created_time"===o.type||"created_by"===o.type||"file"===o.type||"location"===o.type||"verification"===o.type||"last_visited_time"===o.type)return;(0,l.t1)(o)}}function f(e){return"string"!=typeof e&&"boolean"!=typeof e}function y(e){return(e.value??[]).map((e=>{if(!(0,s.km_)(e))return;const t=(0,s.sP4)(e[1]);if(!t)return;return(0,s.vmO)(t).id})).filter(l.$K)}function v(e,t){return{...e,value:e.value?e.value.map((e=>{if(!(0,s.km_)(e))return e;const o=r.Xh(e);for(const n of o[1])(0,s.wjk)(n)&&(n[1].id=t(n[1].id));return o})):void 0}}async function b(e){const{value:t,context:o,executeFormula:n}=e,{returnType:r}=o,i=t.value;if("simple"===t.type){if("number"===r.type){const e=(0,s.QaF)(i),t=parseFloat(e);return isNaN(t)?{value:{type:"undefined"}}:{value:{type:"number",value:t}}}if("text"===r.type)return{value:{type:"text",value:i||[]}};if("checkbox"===r.type){return{value:{type:"checkbox",value:"true"===(0,s.QaF)(i)}}}return n(o,i)}return"formula"===t.type?n(o,i):(0,l.t1)(t.type)}},5773:(e,t,o)=>{o.d(t,{ZP:()=>c,jy:()=>d,xN:()=>l});o(57658);var n=o(80951),r=o(43593),i=o(70203),a=o(97880);const s=["source"];function l(e,t,o){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;const c=[],u=[];if(e.properties){const r=Object.keys(e.properties);for(const m of r){const r=e.properties[m],g=r?n.g(r):void 0;if(l){const e=p(g,t,o,i,a);if(e&&e.length>0&&s.includes(m)){const t={pointer:l,path:["properties",m],command:"set",args:e};u.push(t)}}const h=d(g,[t,o],i,a);c.push(...h)}}if(e.format){const{page_cover:n,page_icon:s}=e.format;if(n){const e=(0,r.mV)(n,[t,o],i,a);e&&c.push(e)}if(s){const e=(0,r.mV)(s,[t,o],i,a);e&&c.push(e)}}return{files:c,operations:u}}function c(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;const a=l(e,t,o,n,r,i);return a.files}function d(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return void 0===e?[]:e.map((e=>(0,r.mV)(e.url,t,o,n))).filter(a.$K)}function p(e,t,o){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=arguments.length>4?arguments[4]:void 0;if(void 0===e)return;const l=e.map((e=>(0,r.Wv)(e.url,t,o,n,s))).filter(a.$K);return l&&l.length>0?[i.V3y(l[0].link)]:void 0}},89789:(e,t,o)=>{o.d(t,{GR:()=>s,P_:()=>a});var n=o(66897),r=o(77420),i=o(19889);const a=(0,n.dp)(i.s$),s=((0,n.dp)(i.el),(0,n.dp)(i.T0));(0,n.dp)(i.fs),(0,n.D$)(r._H)},79317:(e,t,o)=>{o.d(t,{T1:()=>L,A6:()=>j,Wr:()=>N,rb:()=>O});var n={};o.r(n),o.d(n,{derivePrimitiveOperations:()=>p,getAdditionalRelatedPointers:()=>u,invert:()=>m});var r={};o.r(r),o.d(r,{derivePrimitiveOperations:()=>f,getAdditionalRelatedPointers:()=>y,getOperationToAddChildBackToOldParent:()=>b,invert:()=>v});var i={};o.r(i),o.d(i,{derivePrimitiveOperations:()=>S,getAdditionalRelatedPointers:()=>_,invert:()=>w});var a={};o.r(a),o.d(a,{derivePrimitiveOperations:()=>D,getAdditionalRelatedPointers:()=>B,invert:()=>R});var s=o(90559),l=o(80951),c=o(38297),d=o(6287);function p(e,t){const{collectionId:o,spaceId:n}=e.args,r=t(e.pointer);if(!r)return[];if(r.is_template)return[];const i=(0,c.ky)({block:r,getRecordValue:t});if((null==i?void 0:i.id)===o){const r=(0,s.Y7)({spaceId:n,parentTable:d.v,parentId:o}),i=t(r),a=t({table:d.v,id:o,spaceId:n});if(a&&i&&i.alive)return(0,s.FT)(a).flatMap((t=>[{pointer:e.pointer,command:"set",path:["properties",t],args:(0,l.e7)(i.next_value)},{pointer:r,command:"set",path:["next_value"],args:i.next_value+1}]))}return[]}function u(e){const{collectionId:t,spaceId:o}=e.args;return[(0,s.Y7)({spaceId:o,parentTable:d.v,parentId:t})]}function m(e,t){return[]}o(21703),o(57658);var g=o(72126),h=o(73360);const f=function(e,t){const o=[];o.push({...e,command:"insertChildrenBefore"===e.command?"listBeforeMulti":"listAfterMulti",args:{...e.args}});const n=N(e.pointer.table,e.path);if(!n)throw new Error(`Unsupported operation table and operation path ${JSON.stringify(e)} `);return e.args.ids.forEach((r=>{const i={id:r,table:n,spaceId:e.pointer.spaceId};o.push({command:"update",pointer:i,path:[],args:{parent_table:e.pointer.table,parent_id:e.pointer.id,alive:!0}});const a=t(i);if(a&&a.parent_id&&a.parent_table&&a.parent_id!==e.pointer.id){const e=j(a.parent_table,n);e?o.push({command:"listRemove",pointer:{id:a.parent_id,table:a.parent_table,spaceId:a.space_id},path:e,args:{id:a.id}}):function(e){if(!e)throw new Error("Assertion failed in insertChildrenOperationHelper")}(a.parent_table===d.v)}})),o},y=function(e){const t=N(e.pointer.table,e.path);if(!t)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return e.args.ids.map((o=>({id:o,table:t,spaceId:e.pointer.spaceId})))},v=function(e,t){const o=N(e.pointer.table,e.path);if(!o)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return e.args.ids.flatMap((n=>{const r={id:n,table:o,spaceId:e.pointer.spaceId},i=t(r);if(i&&i.parent_table&&i.parent_id){if(j(i.parent_table,o)){const o=t({id:i.parent_id,table:i.parent_table,spaceId:i.space_id});if(o){const e=b(h.mk.create(i.parent_table,o),i.parent_table,r);return e?[e]:[]}return[{command:"removeChild",pointer:e.pointer,path:e.path,args:{id:n}}]}return[{command:"setParent",pointer:r,path:[],args:{parentId:i.parent_id,parentTable:i.parent_table}}]}return[{command:"removeChild",pointer:e.pointer,path:e.path,args:{id:n}}]}))},b=function(e,t,o){const n=j(e.table,o.table);if(!n)return{command:"setParent",pointer:o,path:[],args:{parentId:e.value.id,parentTable:t}};const r=g.U2(e.value,n);if(!r)return;const i=r.indexOf(o.id);if(-1===i)return;const a={id:e.value.id,table:t,spaceId:o.spaceId};if(0===i){return{command:"insertChildrenBefore",pointer:a,path:n,args:{ids:[o.id]}}}return{command:"insertChildrenAfter",pointer:a,path:n,args:{ids:[o.id],after:r[i-1]}}},S=function(e){const t=[];t.push({...e,command:"listRemove"});const o=N(e.pointer.table,e.path);if(!o)throw new Error(`invalid operation ${JSON.stringify(e)}`);return t.push({command:"set",path:["alive"],args:!1,pointer:{table:o,spaceId:e.pointer.spaceId,id:e.args.id}}),t},_=function(e){const t=N(e.pointer.table,e.path);if(!t)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return[{id:e.args.id,table:t,spaceId:e.pointer.spaceId}]},w=function(e,t){const o=t(e.pointer);if(!o)return[];const n=N(e.pointer.table,e.path);if(!n)throw new Error(`Invalid operation ${JSON.stringify(e)}`);const r=b(h.mk.create(e.pointer.table,o),e.pointer.table,{id:e.args.id,table:n,spaceId:e.pointer.spaceId});return r?[r]:[]};var k=o(98963),x=o(18844),I=o(21202),C=o(70279),T=o(33709),M=o(91644),P=o(15047),A=o(29369);const D=function(e,t){const o=[{command:"update",pointer:e.pointer,path:[],args:{parent_table:e.args.parentTable,parent_id:e.args.parentId,alive:!0}}],n=t(e.pointer);if(n&&n.parent_id&&n.parent_table){const t=j(n.parent_table,e.pointer.table);t&&o.push({command:"listRemove",pointer:{id:n.parent_id,table:n.parent_table,spaceId:n.space_id},path:t,args:{id:e.pointer.id}})}return o},B=function(e){return[]},R=function(e,t){const o=t(e.pointer);if(!o||!o.parent_id||!o.parent_table)return[{command:"set",pointer:e.pointer,path:["alive"],args:!1}];if(o.parent_id===e.args.parentId&&o.parent_table===e.args.parentTable)return[];const n=o.parent_table;if(j(n,e.pointer.table)){const n=t({id:o.parent_id,table:o.parent_table,spaceId:o.space_id});if(n){const t=b(h.mk.create(o.parent_table,n),o.parent_table,e.pointer);if(t)return[t]}return[]}return[{command:"setParent",pointer:e.pointer,path:[],args:{parentId:o.parent_id,parentTable:o.parent_table}}]},E={insertChildrenAfter:r,insertChildrenBefore:r,setParent:a,removeChild:i,assignAutoIncrementId:n},F={[I.iU]:[{childTable:I.iU,childPath:["content"]},{childTable:T.qF,childPath:["discussions"]}],[P.bx]:[{childTable:I.iU,childPath:["pages"]}],[T.qF]:[{childTable:C.x_,childPath:["comments"]}],[C.x_]:[{childTable:I.iU,childPath:["content"]}],[A.e0]:[{childTable:I.iU,childPath:["team_pages"]}],[k.cv]:[{childTable:x.Xj,childPath:["action_ids"]}],[x.Xj]:[{childTable:I.iU,childPath:["blocks"]}],[M.AT]:[]},N=function(e,t){var o;const n=F[e];if(n)return null===(o=n.find((e=>{let{childPath:o}=e;return g.Xy(o,t)})))||void 0===o?void 0:o.childTable},j=function(e,t){var o;const n=F[e];if(n)return null===(o=n.find((e=>t===e.childTable)))||void 0===o?void 0:o.childPath},O=(e,t)=>E[e.command].invert(e,t),L=(e,t)=>E[e.command].derivePrimitiveOperations(e,t)},19531:(e,t,o)=>{o.d(t,{$O:()=>Xe,KD:()=>ie,xR:()=>et,RE:()=>tt});o(57658),o(30541);var n=o(30120),r=o(41432),i=o(99036),a=o(80951),s=o(5366),l=o(84795),c=o(68626),d=o(5773),p=o(59730),u=o(30845),m=o(72126),g=o(32056),h=o(482),f=o(21202),y=o(6287),v=o(13493),b=o(70203),S=o(63143);const _="PartialMatch",w="FullMatch",k="ColumnCategory",x=(0,s.defineMessages)({titleColumnName:{id:"database.titleColumn.name",defaultMessage:"Title"},genericColumnName:{id:"database.genericColumn.name",defaultMessage:"Column {columnNumber}"}});function I(e){const{table:t,intl:o,randomShortID:n,isPhoneNumber:r,useCsvAdaptiveSchema:s}=e,l=function(e,t,o,n){var r;let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0;const l=(e=e.filter((e=>e.some((e=>Boolean((e.text||"").trim())))))).length>0?e[0].length:0,c=e.map(((e,t)=>({row:e,rowIndex:t}))).filter((e=>{let{row:t}=e;return t.length!==l}));if(c.length>0){const e=c[0];throw new p.p8("CsvImportError",{data:{},clientData:{type:"csv_import_inconsistent_columns",messageValues:{numTitleColumns:l,numBadRows:c.length,firstBadRowIndex:e.rowIndex+1,firstBadRow:JSON.stringify(e.row.map((e=>e.text))),firstBadRowLength:e.row.length}}})}const d=null===(r=e[0])||void 0===r?void 0:r.length;null==s||s.set(k,W(d));let u=[];1===e.length?u=e[0].map(((e,o)=>t.formatMessage(x.genericColumnName,{columnNumber:o+1}))):e.length>1&&(u=e[0].map((e=>e.text)),e.shift());const g=e,h=z(n),f=m.oA(m.Ri(g).map((e=>e.length&&e[0].columnType?e[0].columnType:H(t,e.map((e=>null==e?void 0:e.text)),o,h,i,s)))),y=u.map((()=>!1));for(let a=0;a<u.length;a++)if("text"===f[a].schema.type)for(let e=0;e<g.length;e++){const t=g[e][a].textValue;if(t)for(const o of t)if(b.AJd(o)){y[a]=!0,e=g.length;break}}let v=!0;const S={title:{type:"title",name:t.formatMessage(x.titleColumnName)}};u.forEach(((e,t)=>{const n=f[t];if(n)if("text"===n.schema.type&&v&&!y[t]){v=!1,n.id="title",n.schema={type:"title",name:e};const t=S.title;t&&(t.name=e)}else{const t=o();n.id=t,S[t]={name:e,...n.schema}}}));const _=g.map((e=>{const t={};return f.forEach(((o,n)=>{if(o){const{id:r,schema:i,coerce:s}=o,{type:l}=i;if(r){const o=e[n]||"";t[r]="url"===l?a.iD(o.text):"date"===l?a.d7(s(o.text)):"text"===l?o.textValue||b.TPx(s(o.text)):"file"===l?o.textValue||[]:b.TPx(s(o.text))}}})),t}));return{schema:S,types:f,pages:_}}(t,o,n,r,s,e.csvEvalContext);return function(e){const{actor:t,blockType:o,rootId:n,parentId:r,parentTable:a,spaceId:s,name:l,format:c,ignoreBlockCount:p,randomID:u,pages:g,schema:h,columnIds:S,secureFileS3Url:_,secureFileS3UrlV2:w}=e,k=u(),x=u(),I=Date.now(),C=[],T={id:k,version:0,parent_table:f.iU,parent_id:n,space_id:s,name:b.TPx(l),schema:h,alive:!0,format:{collection_page_properties:m.oA(S.map((e=>{if(e)return{visible:!0,property:e}})))}};C.push({pointer:{table:y.v,id:k,spaceId:s},command:"set",path:[],args:T});const M={id:n,version:0,type:o,collection_id:k,format:{collection_pointer:{table:y.v,id:k,spaceId:s}},view_ids:[x],alive:!0,created_by_table:t.table,created_by_id:t.id,created_time:I,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:I,parent_id:r,parent_table:a,space_id:s};C.push({pointer:{table:f.iU,id:n,spaceId:s},command:"update",path:[],args:M});const P=function(e){const{actor:t,collectionId:o,spaceId:n,pages:r,ignoreBlockCount:i,secureFileS3Url:a,secureFileS3UrlV2:s,randomID:l}=e,c=Date.now();return r.map((e=>{const r=l(),p={id:r,version:0,parent_id:o,parent_table:y.v,space_id:n,type:"page",created_by_table:t.table,created_by_id:t.id,created_time:c,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:c,properties:e,...i?{ignore_block_count:!0}:void 0,alive:!0};if(a&&s){const e=(0,d.ZP)(p,a,s);e.length>0&&(p.file_ids=e.map((e=>e.id)))}return{id:r,operation:{pointer:{table:f.iU,id:r,spaceId:n},command:"set",path:[],args:p}}}))}({actor:t,collectionId:k,secureFileS3Url:_,secureFileS3UrlV2:w,spaceId:s,pages:g,ignoreBlockCount:p,randomID:u});P.forEach((e=>{let{operation:t}=e;return C.push(t)}));const A={id:x,version:0,type:"table",name:"Show All",parent_id:n,parent_table:"block",space_id:s,format:{table_properties:m.oA(S.map((e=>{if(e)return{visible:!0,property:e}}))),...c},page_sort:P.map((e=>e.id)).slice(0,i.gq),alive:!0};return C.push({pointer:{table:v.n,id:x,spaceId:s},command:"set",path:[],args:A}),{operations:C}}({...l,columnIds:l.types.map((e=>e.id)),...e})}const C=["yes","Yes","true","True","checked"],T=["no","No","false","False","unchecked"];function M(e){return C.some((t=>e===t))||T.some((t=>e===t))}function P(e,t){return e.length===t.length}function A(e,t){if(t.every(M))return{schema:{type:"checkbox"},validate:M,coerce:e=>C.some((t=>e===t))?i.bx:i.HC}}const D=function(e,t){const o=t.map(g._g),n=o[0];if(n&&o.every((e=>Boolean(e&&e.format===n.format))))return{schema:{type:"number",number_format:n.format},validate(e){const t=g._g(e);return!S.z4(t)&&t.format===n.format},coerce(e){const t=g._g(e);return`${t?t.value:void 0}`}}},B=function(e,t){if(parseInt(t)&&t.length<=6)return!1;const o=l.parseFreeformDateString(t,e);return Boolean(o)};function R(e,t){const o=t.filter((t=>B(e,t)));if(o.length>=t.length/2)return{schema:{type:"date"},validate:t=>B(e,t),coerce:t=>l.parseFreeformDateString(t,e),isFullMatch:P(t,o)}}const E=function(e){return e.length<320&&e.includes("@")&&u.B(e,"email")},F=function(e,t){const o=t.filter(E);if(o.length>=t.length/2)return{schema:{type:"email"},validate:E,coerce:m.yR,isFullMatch:P(t,o)}},N=function(e){return e.length<320&&u.B(e,"url")},j=function(e,t){const o=t.filter(N);if(o.length>=t.length/2)return{schema:{type:"url"},validate:N,coerce:m.yR,isFullMatch:P(t,o)}},O=function(e,t){return!String(t).match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)&&e(String(t))},L=function(e,t,o){const n=O.bind(null,e),r=o.filter(n);if(r.length>=o.length/2)return{schema:{type:"phone_number"},validate:n,coerce:m.yR,isFullMatch:P(o,r)}},U=function(e,t,o){const n=[];t.forEach((e=>e.split(",").forEach((e=>n.push(e.trim())))));const r=new Set(n);if(a=r.size,s=n.length,l=t.length,s>l&&Z(a,s)){return{schema:{type:"multi_select",options:Array.from(r).map(((e,t)=>({id:o(),value:e,color:(0,i.TL)([])})))},validate:e=>r.has(e),coerce:m.yR}}var a,s,l},Z=function(e,t){return e>0&&e**2<t},V=function(e,t,o){const n=new Set(t);if(Z(n.size,t.length)){return{schema:{type:"select",options:Array.from(n).map(((e,t)=>({id:o(),value:e,color:(0,i.TL)([])})))},validate:e=>n.has(e),coerce:m.yR}}},q=function(e,t){return{schema:{type:"text"},validate:m._z,coerce:m.yR}};function z(e){return[{test:L.bind(null,e),sampledSchemaIsComplete:!0},{test:D,sampledSchemaIsComplete:!0},{test:F,sampledSchemaIsComplete:!0},{test:j,sampledSchemaIsComplete:!0},{test:R,sampledSchemaIsComplete:!0},{test:A,sampledSchemaIsComplete:!1},{test:U,sampledSchemaIsComplete:!1},{test:V,sampledSchemaIsComplete:!1},{test:q,sampledSchemaIsComplete:!0}]}const W=function(e){return e<50?"lessthan50":e<100?"lessthan100":e<500?"lessthan500":e<1e3?"lessthan1000":e<5e3?"lessthan5000":"greaterthan5000"},H=function(e,t,o,n,r,i){const a=t.filter((e=>Boolean(e)));if(0===a.length)return q();if(r)for(const s of n){const t=s.test(e,a,o);if(t){let e=t;if(!1===t.isFullMatch){c.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Partial column type match detected, setting data type as string",columnType:t.schema.type,matchType:"Partial"}}),e=q();const o=(null==i?void 0:i.get(_))||0;null==i||i.set(_,o+1)}else c.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Complete column type match detected",columnType:t.schema.type,matchType:"Full"}});const o=(null==i?void 0:i.get(w))||0;return null==i||i.set(w,o+1),e}}else{const t=a.filter((e=>!m.xb(e))).slice(0,100);for(const r of n){const n=r.test(e,t,o);if(n){const s=r.sampledSchemaIsComplete||t.length===a.length?n:r.test(e,a,o);if(s){if(!1===s.isFullMatch){c.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Partial column type match detected, Potential data loss due to parsing failures",columnType:s.schema.type,matchType:"Partial"}});const e=(null==i?void 0:i.get(_))||0;null==i||i.set(_,e+1)}else{const e=(null==i?void 0:i.get(w))||0;null==i||i.set(w,e+1)}return s}}}}return q()};var G=o(53877),K=o(95538),$=o(15095),Y=o(43593),Q=o(19233),J=o(4615),X=o(33709);const ee=o(60809),te={a:!0,strong:!0,em:!0,code:!0,del:!0,s:!0,span:!0,time:!0},oe={meta:!0,style:!0,script:!0,head:!0,title:!0},ne="sourceCode";function re(e){if(!e)return;const t=parseInt(e);return isNaN(t)?void 0:t}const ie={[b.GKr.Page]:"data-notion-page-id",spaceId:"data-notion-space-id",[b.GKr.Highlight]:"data-notion-highlight",[b.GKr.User]:"data-notion-user-id",[b.GKr.Discussion]:"data-notion-block-discussion-id",[b.GKr.Equation]:"data-notion-inline-equation",[r.Ti.code]:"data-notion-code-syntax",[r.Ti.callout]:"data-notion-callout",calloutIcon:"data-notion-callout-icon",calloutBackground:"data-notion-callout-background",[r.Ti.tableOfContents]:"data-notion-toc",[r.Ti.file]:"data-notion-file",fileAlias:"data-notion-file-alias",[r.Ti.columnList]:"data-notion-column-list",[r.Ti.column]:"data-notion-column-ratio",[r.Ti.video]:"data-notion-video",[r.Ti.audio]:"data-notion-audio",[r.Ti.pdf]:"data-notion-pdf",[r.Ti.equation]:"data-notion-equation",dateFormat:"data-notion-date-format"};function ae(e,t){return t&&t.nodeType===e.Node.ELEMENT_NODE}const se=function(e,t){return e.nodeType===t.Node.TEXT_NODE||e instanceof t.Element&&te[e.tagName.toLowerCase()]},le=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t.push(e);for(const o of $.p4(e.childNodes))le(o,t);return t},ce=function(e){const t=[];if(!e.parentNode)return t;let o=e.parentNode;for(;o;)t.push(o),o=o.parentNode||void 0;return t};function de(e,t){return ce(e).filter((e=>e instanceof t.Element&&("ul"===e.tagName.toLowerCase()||"ol"===e.tagName.toLowerCase()))).length}const pe=["â€¢","â—¦","â–ª"],ue=["h1","h2","h3","h4","h5","h6"].map((e=>`${e}:not(:first-child)`)).join(", "),me=function(e){const{node:t,window:o,stripText:r,timeZone:i}=e;if(!r){for(const e of Array.from(t.querySelectorAll("p:not(:first-child)")))e.prepend("\n");for(const e of Array.from(t.querySelectorAll(ue)))e.prepend("\n");for(const e of Array.from(t.querySelectorAll("ul > li"))){const t=de(e,o)-1,n=pe[t%pe.length],r="    ".repeat(t);e.prepend(`\n${r}${n} `)}for(const e of Array.from(t.querySelectorAll("ol"))){const t=de(e,o),n="    ".repeat(t);for(let o=0;o<e.children.length;o+=1){e.children[o].prepend(`\n${n}${o+1}. `)}}for(const e of Array.from(t.querySelectorAll("pre")))e.parentNode&&e.parentNode.insertBefore(o.document.createTextNode("\n\n"),e)}const a=[],s=le(t).filter((e=>e.nodeType===o.Node.TEXT_NODE&&(!r||!/^( |\t)*(\n)+( |\t)*$/.test(e.data))));let l=!0;s.forEach(((e,c)=>{let d=e.data;r&&(d=d.replace(/\[ \] /g,""),d=d.replace(/\[x\] /g,""),d=d.replace(/^[\-\*\â€¢]\s?/g,""),d=d.replace(/(\s)+/g,"$1")),t.hasAttribute("confluenceTabSpaces")||0!==c||(d=d.trimStart()),c===s.length-1&&l&&(d=d.trimEnd());const p=[],u=ce(e);let m;!r&&u.some((e=>e instanceof o.Element&&("h1"===e.tagName.toLowerCase()||"h2"===e.tagName.toLowerCase()||"h3"===e.tagName.toLowerCase()||"h4"===e.tagName.toLowerCase()||"h5"===e.tagName.toLowerCase()||"h6"===e.tagName.toLowerCase())))&&p.push([b.GKr.Bold]),u.some((e=>e instanceof o.Element&&"strong"===e.tagName.toLowerCase()))&&p.push([b.GKr.Bold]),u.some((e=>e instanceof o.Element&&"em"===e.tagName.toLowerCase()))&&p.push([b.GKr.Italic]),u.some((e=>e instanceof o.Element&&"u"===e.tagName.toLowerCase()))&&p.push([b.GKr.Underline]),u.some((e=>e instanceof o.Element&&("code"===e.tagName.toLowerCase()||"pre"===e.tagName.toLowerCase())))&&p.push([b.GKr.Code]),u.some((e=>e instanceof o.Element&&("del"===e.tagName.toLowerCase()||"strike"===e.tagName.toLowerCase()||"s"===e.tagName.toLowerCase())))&&p.push([b.GKr.Strike]);const g=u.find((e=>{var t;return e instanceof o.Element&&(e.hasAttribute(ie[b.GKr.Highlight])||(null===(t=e.parentElement)||void 0===t?void 0:t.hasAttribute(ie[b.GKr.Highlight])))}));if(g&&g instanceof o.Element){var h;const e=g.getAttribute(ie[b.GKr.Highlight]),t=null===(h=g.parentElement)||void 0===h?void 0:h.getAttribute(ie[b.GKr.Highlight]),o=rt(e&&"undefined"!==e?e||"":t||"");o&&p.push([b.GKr.Highlight,o])}const f=u.find((e=>e instanceof o.Element&&"a"===e.tagName.toLowerCase()));if(f){const e=f.getAttribute(ie[b.GKr.Page]),t=f.getAttribute("notionUserId")||f.getAttribute(ie[b.GKr.User]),o=f.getAttribute(ie.spaceId),n=f.getAttribute(ie[b.GKr.Comment]);"string"==typeof e&&(0,J.e)(e)&&"string"==typeof o&&(0,J.e)(o)?m=b.$0A(e,o):f.href?p.push(b.edl(f.href)):"string"==typeof t&&(0,J.e)(t)?(m=b.tEo(t),f.getAttribute("notionUserId")&&c===s.length-2&&(l=!1)):n&&o&&(0,J.e)(n)&&(0,J.e)(o)&&(m=b.mfJ(n,o))}const y=u.find((e=>!!(e instanceof o.Element&&e.getAttribute(ie[b.GKr.Discussion]))));if(y){const e=y.getAttribute(ie[b.GKr.Discussion]);e&&p.push(b.jw(e))}const v=u.find((e=>e instanceof o.Element&&"sub"===e.tagName.toLowerCase()));let S;"true"===(null==v?void 0:v.getAttribute("confluenceProcessableEquation"))&&(S=`_{${v.textContent}}`);const _=u.find((e=>e instanceof o.Element&&"sup"===e.tagName.toLowerCase()));let w;"true"===(null==_?void 0:_.getAttribute("confluenceProcessableEquation"))&&(w=`^{${_.textContent}}`);const k=u.find((e=>e instanceof o.Element&&e.hasAttribute(ie[b.GKr.Equation])));let x;null!=k&&k.textContent&&(x=k.textContent);const I=u.find((e=>e instanceof o.Element&&"time"===e.tagName.toLowerCase()));if(I){const e=I.getAttribute("datetime");if(e){const t={...function(e,t){const o=n.ou.fromISO(e),r=o.toMillis();return r===o.startOf("day").toMillis()?G.OQ.toPersistedDate(r,t):G.OQ.toPersistedDateTime(r,t)}(e,i)};"relative"===I.getAttribute(ie.dateFormat)&&(t.date_format="relative"),m=b.pZr(t)}}m?a.push(b.YCD(m,p)):S?a.push(b.qZ6(S,p)):w?a.push(b.qZ6(w,p)):x?a.push(b.qZ6(x,p)):a.push(b.V3y(d,p))}));return b.Zdj(a,1e5)};const ge=function(e){const t=["img[src]","a[download]",`a[${ie[r.Ti.file]}]`,`audio[${ie[r.Ti.audio]}]`,`video[${ie[r.Ti.video]}]`],o=e.querySelectorAll(t.join(","));return $.p4(o)};function he(e){const{actor:t,parentId:o,parentTable:n,spaceId:r,node:i,allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:p,intl:u,randomID:m,randomShortID:g,isPhoneNumber:h}=e;return Oe({actor:t,parentId:o,parentTable:n,spaceId:r,nodes:ge(i),allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:p,intl:u,randomID:m,randomShortID:g,isPhoneNumber:h})}function fe(e){const{actor:t,parentId:o,parentTable:n,spaceId:r,node:i,type:a,allOperations:s,window:l,ignoreBlockCount:c,stripText:d,randomID:p}=e,u=p(),m={id:u,version:0,type:a,properties:{title:me({node:i,window:l,stripText:d})},parent_id:o,parent_table:n,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!c||void 0};return s.push({pointer:{table:f.iU,id:u,spaceId:r},command:"set",path:[],args:m}),je({node:i,spaceId:r,blockId:u,allOperations:s}),u}function ye(e){const{actor:t,parentId:o,parentTable:n,spaceId:i,node:a,tableData:s,allOperations:l,ignoreBlockCount:c,intl:d,secureFileS3Url:p,secureFileS3UrlV2:u,randomID:m,randomShortID:g,isPhoneNumber:y,tableType:v}=e,b=m();if("table"===v){const{operations:e}=function(e){const{actor:t,parentId:o,tableId:n,parentTable:i,spaceId:a,ignoreBlockCount:s,randomID:l,randomShortID:c,table:d}=e,p=Date.now(),u=[],m=d.length?d[0].map((e=>c())):[],g=d.map((e=>l()));u.push(h.op.update({pointer:{id:n,table:f.iU,spaceId:a},path:[],args:{id:n,type:r.Ti.table,content:g,format:{table_block_column_order:m},properties:{},parent_id:o,space_id:a,parent_table:i,created_by_table:t.table,created_by_id:t.id,created_time:p,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:p,alive:!0,ignore_block_count:!!s||void 0}}));const y=g.map(((e,o)=>{const i=S.m8(m.flatMap(((e,t)=>{var n;const r=null===(n=d[o])||void 0===n||null===(n=n[t])||void 0===n?void 0:n.textValue;return r?[[e,r]]:[]})));return h.op.set({pointer:{id:e,table:f.iU,spaceId:a},path:[],args:{id:e,version:0,type:r.Ti.tableRow,parent_id:n,parent_table:f.iU,alive:!0,space_id:a,properties:i,created_by_table:t.table,created_by_id:t.id,created_time:p,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:p}})}));return u.push(...y),{operations:u}}({actor:t,tableId:b,parentId:o,parentTable:n,spaceId:i,table:s,ignoreBlockCount:c,randomID:m,randomShortID:g});l.push(...e),je({node:a,spaceId:i,blockId:b,allOperations:l})}else if("collection"===v){const{operations:e}=I({actor:t,blockType:"collection_view",rootId:b,parentId:o,parentTable:n,spaceId:i,name:"",format:{table_wrap:!0},table:s,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:c,intl:d,randomID:m,randomShortID:g,isPhoneNumber:y});l.push(...e)}return b}function ve(e){const{actor:t,parentId:o,parentTable:n,spaceId:i,allOperations:a,ignoreBlockCount:s,randomID:l}=e,c=l(),d={id:c,version:0,type:r.Ti.divider,parent_id:o,parent_table:n,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!s||void 0};return a.push({pointer:{table:f.iU,id:c,spaceId:i},command:"set",path:[],args:d}),c}function be(e){const{actor:t,parentId:o,parentTable:n,spaceId:i,source:a,allOperations:s,secureFileS3Url:l,secureFileS3UrlV2:c,ignoreBlockCount:p,randomID:u,fallbackWidth:m}=e;let g;"image"===a.type&&a.width?g=Math.min(a.width,700):m&&(g=Math.min(m,700));const h=u(),y={id:h,version:0,type:r.Ti.image,properties:{source:b.TPx(a.url)},format:{block_width:g},parent_id:o,parent_table:n,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0},v=(0,d.ZP)(y,l,c);return y.file_ids=v.map((e=>e.id)),s.push({pointer:{table:f.iU,id:h,spaceId:i},command:"set",path:[],args:y}),h}function Se(e){const{actor:t,parentId:o,parentTable:n,spaceId:r,node:i,sourceUrl:a,allOperations:s,ignoreBlockCount:l,randomID:c}=e,d=re(i.getAttribute("height")),p=re(i.getAttribute("width")),u=c();let m;try{m=new URL(a)}catch(h){m=a}const g={id:u,version:0,type:K.Dz({url:a,baseUrl:m instanceof URL?m.origin:m,publicDomainName:""}),properties:{source:b.TPx(a)},format:{block_width:p,block_height:d,block_full_width:!1,block_page_width:!(p||d),block_preserve_scale:!0},parent_id:o,parent_table:n,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0};return s.push({pointer:{table:f.iU,id:u,spaceId:r},command:"set",path:[],args:g}),u}function _e(e){const{actor:t,parentId:o,parentTable:n,spaceId:r,source:i,allOperations:s,secureFileS3Url:l,secureFileS3UrlV2:c,ignoreBlockCount:p,randomID:u}=e,m=u(),g=K.Dz({url:i.url,baseUrl:i.url,publicDomainName:""}),h={id:m,version:0,type:"embed"===g?"file":g,properties:{title:b.TPx((0,Y.w2)(i.url)),source:a.iD(i.url)},format:{block_width:"image"===i.type&&i.width?Math.min(i.width,700):void 0},parent_id:o,parent_table:n,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0},y=(0,d.ZP)(h,l,c);return h.file_ids=y.map((e=>e.id)),s.push({pointer:{table:f.iU,id:m,spaceId:r},command:"set",path:[],args:h}),m}function we(e){return"#text"===e.nodeName?e.textContent?e.textContent:"":Array.from(e.childNodes).map((e=>{const t=e.nodeName.toLowerCase();return"br"===t?"\n":"div"===t?`${we(e)}\n`:we(e)})).map((e=>e.split("\n").map((e=>e.trimRight())).join("\n"))).join("")}function ke(e){const{actor:t,parentId:o,parentTable:n,spaceId:i,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:p,ignoreBlockCount:u,intl:m,randomID:g,randomShortID:h,isPhoneNumber:y}=e,v=g(),b=a.getAttribute(ie.calloutBackground),S=b?rt(b):void 0,_=a.getAttribute(ie.calloutIcon),w=_&&_.match(ee())?_:void 0,{title:k,children:x}=function(e){const{node:t,window:o}=e,n=$.p4(t.childNodes),[r,...i]=n;if(!r)return{title:[]};return(e=>t=>!!(ae(e,t)&&t instanceof e.HTMLParagraphElement))(o)(r)?{title:me({node:r,window:o,stripText:!1}),children:i}:se(r,o)?{title:me({node:t,window:o,stripText:!1}),children:void 0}:{title:[],children:n}}({node:a,window:c}),I=Array.isArray(x)?Oe({actor:t,parentId:v,parentTable:f.iU,spaceId:i,nodes:x,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:p,ignoreBlockCount:u,intl:m,randomID:g,randomShortID:h,isPhoneNumber:y}):[],C={id:v,version:0,type:r.Ti.callout,content:I,properties:{title:k},format:{block_color:S,page_icon:w},parent_id:o,parent_table:n,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!u||void 0};return s.push({pointer:{table:f.iU,id:v,spaceId:i},command:"set",path:[],args:C}),je({node:a,spaceId:i,blockId:v,allOperations:s}),v}function xe(e){const{actor:t,parentId:o,parentTable:n,spaceId:i,importFileMap:a,node:s,allOperations:l,secureFileS3Url:c,secureFileS3UrlV2:p,ignoreBlockCount:u,randomID:m}=e,g=s.getAttribute(ie.fileAlias)||"",h=s.getAttribute(ie[r.Ti.file])||"",y=a[h]?a[h].url:h,v=m(),S={alive:!0,created_by_id:t.id,created_by_table:t.table,created_time:Date.now(),id:v,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),parent_id:o,parent_table:n,space_id:i,properties:{source:b.TPx(y),title:b.TPx(g)},type:r.Ti.file,version:0,ignore_block_count:!!u||void 0},_=(0,d.ZP)(S,c,p);return S.file_ids=_.map((e=>e.id)),l.push({pointer:{table:f.iU,id:v,spaceId:i},command:"set",path:[],args:S}),v}const Ie=/language-(\w+)/;function Ce(e){let t=null;return null==e||e.forEach(((e,o,n)=>{if(t)return;if(Q.Y.hasOwnProperty(e))return void(t=e);const r=e.match(Ie);r&&r.length>1&&Q.Y.hasOwnProperty(r[1])&&(t=r[1])})),t}function Te(e){const{actor:t,parentId:o,parentTable:n,spaceId:i,node:a,allOperations:s,ignoreBlockCount:l,randomID:c}=e,d=c();let p=a.getAttribute(ie[r.Ti.code]);if(!p){var u;p=Ce(null===(u=a.querySelector("code"))||void 0===u||null===(u=u.parentElement)||void 0===u?void 0:u.classList)}if(!p){var m;p=Ce(null===(m=a.querySelector("code"))||void 0===m?void 0:m.classList)}const g=p&&Q.Y[p]?Q.Y[p]:"Plain Text",h={id:d,version:0,type:r.Ti.code,properties:{title:b.TPx(we(a)),language:b.TPx(g)},format:{code_wrap:!0},parent_id:o,parent_table:n,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0};return s.push({pointer:{table:f.iU,id:d,spaceId:i},command:"set",path:[],args:h}),je({node:a,spaceId:i,blockId:d,allOperations:s}),d}function Me(e){const{actor:t,parentId:o,parentTable:n,spaceId:i,node:a,allOperations:s,ignoreBlockCount:l,randomID:c}=e,d=c(),p={id:d,version:0,type:r.Ti.equation,properties:{title:b.TPx(we(a))},parent_id:o,parent_table:n,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0};return s.push({pointer:{table:f.iU,id:d,spaceId:i},command:"set",path:[],args:p}),d}function Pe(e){const{actor:t,parentId:o,parentTable:n,spaceId:i,allOperations:a,ignoreBlockCount:s,randomID:l}=e,c=l(),d={id:c,version:0,type:r.Ti.tableOfContents,format:{block_color:"gray"},parent_id:o,parent_table:n,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!s||void 0};return a.push({pointer:{table:f.iU,id:c,spaceId:i},command:"set",path:[],args:d}),c}function Ae(e){const{actor:t,parentId:o,parentTable:n,spaceId:i,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:p,ignoreBlockCount:u,intl:m,randomID:g,randomShortID:h,isPhoneNumber:y}=e,v=g(),[S,..._]=$.p4(a.childNodes),w=Oe({actor:t,parentId:v,parentTable:f.iU,spaceId:i,nodes:_,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:p,ignoreBlockCount:u,intl:m,randomID:g,randomShortID:h,isPhoneNumber:y}),k={id:v,version:0,type:r.Ti.quote,properties:{title:b.TPx(null!=S&&S.textContent?S.textContent.trim():"")},content:w,parent_id:o,parent_table:n,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!u||void 0};return s.push({pointer:{table:f.iU,id:v,spaceId:i},command:"set",path:[],args:k}),je({node:a,spaceId:i,blockId:v,allOperations:s}),v}function De(e){const{actor:t,parentId:o,parentTable:n,spaceId:i,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:p,ignoreBlockCount:u,intl:m,randomID:g,randomShortID:h,isPhoneNumber:y}=e,v=g(),S=a.querySelector("summary"),_=$.p4(a.childNodes).filter((e=>e!==S)),w=S&&S.textContent&&me({node:S,window:c,stripText:!1}),k=Oe({actor:t,parentId:v,parentTable:f.iU,spaceId:i,nodes:_,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:p,ignoreBlockCount:u,intl:m,randomID:g,randomShortID:h,isPhoneNumber:y}),x={id:v,version:0,type:r.Ti.toggle,content:k,properties:{title:w||b.TPx("")},parent_id:o,parent_table:n,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!u||void 0};return s.push({pointer:{table:f.iU,id:v,spaceId:i},command:"set",path:[],args:x}),v}function Be(e){const{actor:t,parentId:o,parentTable:n,spaceId:i,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:p,ignoreBlockCount:u,intl:m,randomID:g,randomShortID:h,isPhoneNumber:y}=e,v=g(),b=$.p4(a.children).filter((e=>e.hasAttribute(ie[r.Ti.column]))).slice(0,8).map((e=>function(e){const{actor:t,parentId:o,parentTable:n,spaceId:i,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:p,ignoreBlockCount:u,intl:m,randomID:g,randomShortID:h,isPhoneNumber:y}=e,v=g(),b=a.getAttribute(ie[r.Ti.column]);let S;if(null!==b){const e=parseFloat(b);!Number.isNaN(e)&&e>0&&e<=1&&(S=e)}const _=Oe({actor:t,parentId:v,parentTable:f.iU,spaceId:i,nodes:$.p4(a.children),allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:p,ignoreBlockCount:u,intl:m,randomID:g,randomShortID:h,isPhoneNumber:y}),w={id:v,version:0,type:r.Ti.column,format:{column_ratio:S},content:_,parent_id:o,parent_table:n,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!u||void 0};return s.push({pointer:{table:f.iU,id:v,spaceId:i},command:"set",path:[],args:w}),v}({actor:t,parentId:v,parentTable:f.iU,spaceId:i,node:e,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:p,ignoreBlockCount:u,intl:m,randomID:g,randomShortID:h,isPhoneNumber:y}))),S={id:v,version:0,type:r.Ti.columnList,content:b,parent_id:o,parent_table:n,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!u||void 0};return s.push({pointer:{table:f.iU,id:v,spaceId:i},command:"set",path:[],args:S}),v}const Re=/^\[x\].*/,Ee=/^\[ \].*/,Fe=/^[-\*\â€¢].*/;function Ne(e){const{actor:t,parentId:o,parentTable:n,spaceId:a,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:y,isPhoneNumber:v}=e,S=h(),_=d.document.createElement("span"),w=[];$.p4(s.childNodes).forEach(((e,t)=>{0===t&&We(e,d)?w.push(e):0===t&&!(Ve(e,d)||qe(e,d)||ze(e,d))||se(e,d)?(_.appendChild(e),e instanceof d.Element&&ge(e).forEach((e=>w.push(e)))):w.push(e)}));const k=Oe({actor:t,parentId:S,parentTable:"block",spaceId:a,nodes:w,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:y,isPhoneNumber:v}),x=Re.test(_.textContent||""),I=Ee.test(_.textContent||"");let C;C=x||I?r.Ti.toDo:s.parentNode instanceof d.Element&&"ol"===s.parentNode.tagName.toLowerCase()?r.Ti.numberedList:r.Ti.bulletedList;let T=!1;C===r.Ti.toDo&&x&&(T=!0);const M={id:S,version:0,type:C,content:k,properties:{title:me({node:_,window:d,stripText:!0}),checked:T?b.TPx(i.bx):void 0},parent_id:o,parent_table:n,space_id:a,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!m||void 0};return l.push({pointer:{table:f.iU,id:S,spaceId:a},command:"set",path:[],args:M}),je({node:_,spaceId:a,blockId:S,allOperations:l}),S}function je(e){const{node:t,spaceId:o,blockId:n,allOperations:r}=e,i=Array.from(t.querySelectorAll(`span[${ie[b.GKr.Discussion]}]`));for(const a of i){const e=a.getAttribute(ie[b.GKr.Discussion]);if(e){const t={id:e,parent_id:n,parent_table:f.iU,resolved:!1,context:[[a.innerHTML,[[b.GKr.Discussion,e]]]],space_id:o,version:0};r.push({pointer:{table:X.qF,id:e,spaceId:o},command:"set",path:[],args:t},{pointer:{table:f.iU,id:n,spaceId:o},command:"listAfter",path:["discussions"],args:{id:e}})}}}function Oe(e){const{actor:t,parentId:o,parentTable:n,spaceId:r,nodes:i,allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:p,intl:u,randomID:g,randomShortID:h,isPhoneNumber:f}=e;return m.G0(...i.map((e=>Le({actor:t,parentId:o,parentTable:n,spaceId:r,node:e,allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:p,intl:u,randomID:g,randomShortID:h,isPhoneNumber:f}))))}function Le(e){const{actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v}=e;if(s&&s instanceof d.Element){const e=s.tagName.toLowerCase();if("h1"===e)return[fe({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,type:r.Ti.header,allOperations:l,window:d,ignoreBlockCount:g,stripText:!0,randomID:f}),...he({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v})];if("h2"===e)return[fe({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,type:r.Ti.subHeader,allOperations:l,window:d,ignoreBlockCount:g,stripText:!0,randomID:f}),...he({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v})];if("hr"===e)return[ve({actor:t,parentId:o,parentTable:n,spaceId:i,allOperations:l,ignoreBlockCount:g,randomID:f})];if("h"===e[0])return[fe({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,type:r.Ti.subSubHeader,allOperations:l,window:d,ignoreBlockCount:g,stripText:!0,randomID:f}),...he({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v})];if("pre"===e||"code"===e||"div"===e&&s.className===ne)return[Te({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,ignoreBlockCount:g,randomID:f}),...he({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v})];if(s.hasAttribute(ie[r.Ti.callout]))return[ke({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v})];if("blockquote"===e)return[Ae({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v})];if("details"===e)return[De({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v})];if("table"===e){const{tableData:e,tableFiles:b}=function(e){const{node:t,window:o,importFileMap:n,intl:i}=e,s=[],l=[],c=Array.from(t.querySelectorAll("tr")).filter((e=>e.closest("table")===t));for(const d of c){const e=[],t=[],c=Array.from(d.querySelectorAll("td, th")).filter((e=>e.closest("tr")===d));for(const i of c){const a=(i.textContent||"").trim(),s=Ue(i.getAttribute("rowspan"),1);e.push({text:a,textValue:me({node:i,window:o,stripText:!1}),rowSpan:s});const l=Ue(i.getAttribute("colspan"),1);for(let t=1;t<l;t++)e.push({text:"",rowSpan:s});const c=ge(i);if(c.length){const e=m.oA(c.flatMap((e=>{var t;const o=e.getAttribute("src")||e.getAttribute(ie[r.Ti.file])||e.getAttribute(ie[r.Ti.audio])||e.getAttribute(ie[r.Ti.video]),i=e.getAttribute(ie.fileAlias);return o?{name:i||o,url:(null===(t=n[o])||void 0===t?void 0:t.url)||o}:void 0})));t.push(...e)}}e.length&&l.push(e);const p=a.CC(t);s.push({text:i.formatMessage({id:"htmlHelpers.table.fileColumnName",defaultMessage:"Files"}),textValue:p})}for(let r=0;r<l.length;r++){const e=l[r];for(let t=0;t<e.length;t++){const o=e[t].rowSpan;if(o>1)for(let e=1;e<o&&!(r+e>=l.length);e++){l[r+e].splice(t,0,{text:"",rowSpan:1})}}}return{tableData:l,tableFiles:s}}({node:s,window:d,importFileMap:c,intl:h});if(b.some((e=>{var t;return null===(t=e.textValue)||void 0===t?void 0:t.length})))for(let t=0;t<e.length;t++)e[t].push({text:b[t].text,textValue:b[t].textValue,columnType:{schema:{type:"file"},validate:m._z,coerce:m.yR}});let S="table";return b.some((e=>{var t;return null===(t=e.textValue)||void 0===t?void 0:t.length}))&&(S="collection"),0===m.Ar(e).length?[]:[ye({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,tableData:e,allOperations:l,ignoreBlockCount:g,secureFileS3Url:p,secureFileS3UrlV2:u,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v,tableType:S})]}if("div"===e&&s.hasAttribute(ie[r.Ti.columnList]))return[Be({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v})];if("nav"===e&&s.hasAttribute(ie[r.Ti.tableOfContents]))return[Pe({actor:t,parentId:o,parentTable:n,spaceId:i,allOperations:l,ignoreBlockCount:g,randomID:f}),...he({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v})];if("ul"===e||"ol"===e)return m.G0(...m.UI(s.children,(e=>Le({actor:t,parentId:o,parentTable:n,spaceId:i,node:e,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v}))));if("li"===e||Re.test(s.textContent||"")||Ee.test(s.textContent||"")||Fe.test(s.textContent||""))return[Ne({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v})];if("img"===e){const e=s.getAttribute("src");if(e)return[be({actor:t,parentId:o,parentTable:n,spaceId:i,source:c[e]||{type:"unknown",url:e},allOperations:l,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,randomID:f,fallbackWidth:s instanceof d.HTMLImageElement?s.width:void 0})]}if("a"===e&&s.getAttribute(ie[r.Ti.file]))return[xe({actor:t,parentId:o,parentTable:n,spaceId:i,importFileMap:c,node:s,allOperations:l,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,randomID:f})];if("a"===e&&0===$.p4(s.childNodes).length){const e=s.getAttribute("href");if(s.hasAttribute("download")&&e)return[_e({actor:t,parentId:o,parentTable:n,spaceId:i,source:c[e]||{type:"unknown",url:e},allOperations:l,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,randomID:f})]}if("video"===e){const e=s.querySelector("source");if(e){const r=e.getAttribute("src");if(r&&K.xL({url:r}))return[_e({actor:t,parentId:o,parentTable:n,spaceId:i,source:{type:"unknown",url:r},allOperations:l,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,randomID:f})]}}if("audio"===e){const e=s.querySelector("source");if(e){const r=e.getAttribute("src");if(r&&K._c({url:r}))return[_e({actor:t,parentId:o,parentTable:n,spaceId:i,source:{type:"unknown",url:r},allOperations:l,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,randomID:f})]}}if("iframe"===e){const e=s.getAttribute("src");if(e)return[Se({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,sourceUrl:e,allOperations:l,ignoreBlockCount:g,randomID:f})]}return"p"===e&&s.getAttribute("confluenceNewLine")?[fe({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,type:r.Ti.text,allOperations:l,window:d,ignoreBlockCount:g,stripText:!0,randomID:f})]:s.hasAttribute(ie[r.Ti.equation])?[Me({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,ignoreBlockCount:g,randomID:f})]:[.../^\s*$/g.test(s.textContent||"")?[]:[fe({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,type:r.Ti.text,allOperations:l,window:d,ignoreBlockCount:g,stripText:!1,randomID:f})],...he({actor:t,parentId:o,parentTable:n,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:p,secureFileS3UrlV2:u,ignoreBlockCount:g,intl:h,randomID:f,randomShortID:y,isPhoneNumber:v})]}return[]}function Ue(e,t){const o=null!==e?parseInt(e,10):t;return isFinite(o)?o:t}const Ze=function(e){if(e&&-1!==e.indexOf("em"))return parseInt(e)},Ve=function(e,t){return e instanceof t.Element&&"img"===e.tagName.toLowerCase()},qe=function(e,t){return e instanceof t.Element&&"video"===e.tagName.toLowerCase()},ze=function(e,t){return e instanceof t.Element&&"audio"===e.tagName.toLowerCase()},We=function(e,t){return e instanceof t.Element&&"a"===e.tagName.toLowerCase()&&e.hasAttribute(ie[r.Ti.file])},He=function(e,t,o){const n=o.document.createElement(t);for(;e.firstChild;)n.appendChild(e.firstChild);for(let r=e.attributes.length-1;r>=0;--r){const t=e.attributes[r];n.setAttribute(t.name,t.value)}return e.parentNode&&e.parentNode.replaceChild(n,e),n},Ge=function(e,t,o){const n=o.document.createElement(t);for(;e.firstChild;)n.appendChild(e.firstChild);e.appendChild(n)},Ke=function(e){const t=[];let o=e;for(;e.firstChild;){const n=e.firstChild;t.push(n),e.parentNode&&e.parentNode.insertBefore(n,o.nextSibling),o=n}const n=e.parentNode;return n&&(n.removeChild(e),n.normalize()),t};function $e(e,t){!function(e,t){const o=Array.from(e.querySelectorAll("p"));for(const n of o){let e=n.firstChild,o=0;for(;e&&o<1e4;){let r=!1;if(e instanceof t.Element&&null!==e.textContent&&!e.textContent.trim()){const t=Array.from(e.querySelectorAll("br"));if(t.length>0){for(const o of t)n.insertBefore(o,e);r=!0}}const i=e.nextSibling;r&&n.removeChild(e),e=i,o+=1}}}(e,t);const o=Array.from(e.querySelectorAll("p"));for(let n=0;n<1e4;n++){const e=o.shift();if(!e||!e.parentNode)return;const n=e.querySelector("br");if(!n)continue;if(n.parentElement!==e)continue;const r=t.document.createElement("p");e.parentNode.insertBefore(r,e.nextSibling);let i=n.nextSibling;for(;i;){const e=i.nextSibling;r.appendChild(i),i=e}e.removeChild(n),o.unshift(r)}}function Ye(e){const t=e.match(/^([0-9]+)px$/i);if(t)return parseInt(t[1])}const Qe=function(e){const{rootNode:t,window:o,isInlineContent:n,emojiData:r}=e;!function(e){const{rootNode:t,window:o,emojiData:{emojiByName:n}}=e,r=Array.from(t.querySelectorAll("img[data-stringify-emoji]"));for(const i of r){const e=i.getAttribute("data-stringify-emoji")||"",t=e.match(/^:(.+):$/);if(!t||!i.parentNode)continue;const r=n[t[1]]||e;i.parentNode.replaceChild(o.document.createTextNode(r),i)}}({rootNode:t,window:o,emojiData:r}),t.normalize(),$e(t,o);const i=$.p4(t.childNodes);for(;i.length>0;){let e=i.shift();if(e instanceof o.Element&&e.parentNode&&"google-sheets-html-origin"===e.tagName.toLowerCase()){const t=$.p4(e.childNodes);for(const o of t)e.parentNode.insertBefore(o,e);i.unshift(...t),e.remove()}else if(e&&e.parentNode&&3===e.nodeType&&/^( |\t)*(\n)+( |\t)*$/.test(e.data))e.parentNode.removeChild(e);else if(e&&e instanceof o.Element&&e.parentNode&&oe[e.tagName.toLowerCase()])e.parentNode.removeChild(e);else{if(e instanceof o.HTMLElement){const t=(a=e.style.fontSize||void 0)&&-1!==a.indexOf("px")||a&&-1!==a.indexOf("pt")?parseInt(a):void 0,n=Ze(e.style.fontSize||void 0);(t&&t>=24||n&&n>2)&&(e=He(e,"h1",o))}if(e instanceof o.HTMLElement&&("line-through"===e.style.textDecoration&&Ge(e,"del",o),"italic"===e.style.fontStyle&&Ge(e,"em",o),("bold"===e.style.fontWeight||e.style.fontWeight&&parseInt(e.style.fontWeight)>=500)&&Ge(e,"strong",o)),e instanceof o.HTMLImageElement){const t=Ye(e.style.width);!e.width&&t&&(e.width=t)}if(e instanceof o.HTMLElement&&("b"===e.tagName.toLowerCase()?e=He(e,"strong",o):"i"===e.tagName.toLowerCase()&&(e=He(e,"em",o))),e instanceof o.HTMLElement&&"strong"===e.tagName.toLowerCase()&&"normal"===e.style.fontWeight&&(e=He(e,"span",o)),e instanceof o.HTMLElement&&("section"===e.tagName.toLowerCase()||"article"===e.tagName.toLowerCase())&&(e=He(e,"div",o)),e instanceof o.HTMLElement&&"div"===e.tagName.toLowerCase()&&"inline"===e.style.display&&(e=He(e,"span",o)),e instanceof o.HTMLElement&&"input"===e.tagName.toLowerCase()&&"checkbox"===e.type){const t=e.checked,n=e.parentNode,r=o.document.createElement("span");r.textContent=`[${t?"x":" "}] `,n&&(n.insertBefore(r,e),n.removeChild(e)),i.push(r)}else{if(e instanceof o.HTMLElement&&"table"===e.tagName.toLowerCase()){const t=Array.from(e.querySelectorAll("tr")).map((e=>e.querySelectorAll("td, th")));if(t.every((e=>1===e.length))){const n=o.document.createDocumentFragment();for(const e of t){const t=e[0],r=t.childNodes.length;for(let e=0;e<r;e+=1){const o=t.childNodes[e];o&&(n.appendChild(o),i.push(o))}n.appendChild(o.document.createElement("hr"))}e.parentNode&&e.parentNode.replaceChild(n,e)}}if(e instanceof o.HTMLElement&&("ul"===e.tagName.toLowerCase()||"ol"===e.tagName.toLowerCase())&&e.parentNode instanceof o.HTMLElement&&("ul"===e.parentNode.tagName.toLowerCase()||"ol"===e.parentNode.tagName.toLowerCase())&&e.previousSibling instanceof o.HTMLElement&&"li"===e.previousSibling.tagName.toLowerCase()&&e.previousSibling.appendChild(e),e instanceof o.Element&&(e.removeAttribute("style"),e.removeAttribute("dir")),e instanceof o.Element&&"span"===e.tagName.toLowerCase()){(e.hasAttribute(ie[b.GKr.Highlight])||e.hasAttribute(ie[b.GKr.Discussion])||e.hasAttribute(ie[b.GKr.Equation])?Array.from(e.children):Ke(e)).forEach((e=>i.push(e)))}else if(e){$.p4(e.childNodes).forEach((e=>i.push(e)))}}}}var a;for($.p4(t.childNodes).forEach((e=>i.push(e)));i.length>0;){const e=i.shift();if(e)if(Je(e,o)&&m.yW(e.childNodes,(e=>e instanceof o.Element&&"h1"===e.tagName.toLowerCase()))){const t=o.document.createElement("h1");m.S6(e.childNodes,(e=>{m.S6(e.childNodes,(e=>{e&&t.appendChild(e)}))}));const n=e.parentNode;if(n){if("td"===e.tagName.toLowerCase()||"th"===e.tagName.toLowerCase()){const r=o.document.createElement(e.tagName.toLowerCase());r.appendChild(t),n.insertBefore(r,e)}else n.insertBefore(t,e);n.removeChild(e)}i.push(t)}else if(Je(e,o)&&m.yW(e.childNodes,(e=>e instanceof o.Element&&"h2"===e.tagName.toLowerCase()))){const t=o.document.createElement("h2");m.S6(e.childNodes,(e=>{m.S6(e.childNodes,(e=>{e&&t.appendChild(e)}))}));const n=e.parentNode;if(n){if("td"===e.tagName.toLowerCase()||"th"===e.tagName.toLowerCase()){const r=o.document.createElement(e.tagName.toLowerCase());r.appendChild(t),n.insertBefore(r,e)}else n.insertBefore(t,e);n.removeChild(e)}i.push(t)}else if(e instanceof o.HTMLElement&&("div"===e.tagName.toLowerCase()||"span"===e.tagName.toLowerCase())&&e.parentNode&&0===e.childNodes.length)e.parentNode.removeChild(e);else if(!Je(e,o)||"p"!==e.tagName.toLowerCase()&&"div"!==e.tagName.toLowerCase()&&"figure"!==e.tagName.toLowerCase()||!$.p4(e.childNodes).some((e=>e instanceof o.Element&&("p"===e.tagName.toLowerCase()||"div"===e.tagName.toLowerCase()||"img"===e.tagName.toLowerCase()||"ul"===e.tagName.toLowerCase()||"table"===e.tagName.toLowerCase()||"hr"===e.tagName.toLowerCase()||"video"===e.tagName.toLowerCase())))){if(e&&e.childNodes){$.p4(e.childNodes).forEach((e=>i.push(e)))}}else{Ke(e).forEach((e=>i.push(e)))}}t.normalize(),n||$.p4(t.childNodes).forEach((e=>{if(3===e.nodeType){const n=o.document.createElement("p");t.insertBefore(n,e),n.appendChild(e)}}))};function Je(e,t){return e instanceof t.Element&&(0!==e.childNodes.length&&!(e.hasAttribute(ie[r.Ti.columnList])||e.hasAttribute(ie[r.Ti.column])||e.hasAttribute(ie[r.Ti.callout])))}function Xe(e){const{actor:t,parentId:o,spaceId:n,parentTable:r,rootNode:i,importFileMap:a,window:s,secureFileS3Url:l,secureFileS3UrlV2:c,ignoreBlockCount:d,intl:p,randomID:u,randomShortID:m,isPhoneNumber:g,emojiData:h}=e;Qe({rootNode:i,window:s,isInlineContent:!1,emojiData:h});const f=[];return{allOperations:f,rootContentIds:Oe({actor:t,parentId:o,parentTable:r,spaceId:n,nodes:$.p4(i.children),allOperations:f,importFileMap:a,window:s,secureFileS3Url:l,secureFileS3UrlV2:c,ignoreBlockCount:d,intl:p,randomID:u,randomShortID:m,isPhoneNumber:g})}}const et=function(e){const{node:t,window:o,stripText:n,emojiData:r}=e;return Qe({rootNode:t,window:o,isInlineContent:!0,emojiData:r}),me({node:t,window:o,stripText:n})};function tt(e){const{node:t,window:o,emojiData:n}=e;return Qe({rootNode:t,window:o,isInlineContent:!1,emojiData:n}),nt(t,o)}const ot=new Set(["span","div","p"]);function nt(e,t){const o=e.tagName.toLowerCase();if(!ot.has(o))return!0;if("div"===o&&(e.className===ne||e.hasAttribute(ie[r.Ti.columnList])))return!0;for(const n of Array.from(e.childNodes))if(ae(t,n)&&nt(n,t))return!0;return!1}function rt(e){if("default"===e||"gray"===e||"brown"===e||"orange"===e||"yellow"===e||"teal"===e||"blue"===e||"purple"===e||"pink"===e||"red"===e||"gray_background"===e||"brown_background"===e||"orange_background"===e||"yellow_background"===e||"teal_background"===e||"blue_background"===e||"purple_background"===e||"pink_background"===e||"red_background"===e)return e}},45208:(e,t,o)=>{o.d(t,{f:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("abstract",{viewBox:"0 0 32 32",svg:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 16C0 3.199 3.199 0 16 0s16 3.199 16 16-3.199 16-16 16S0 28.801 0 16zm9.976 7.71a6.128 6.128 0 003.398 1.043 6.14 6.14 0 006.146-6.127 6.126 6.126 0 10-9.544 5.085zm11.521.79h3.004v-17H7.499v2.997h13.998V24.5zm-5-5.874a3.123 3.123 0 11-6.246 0 3.123 3.123 0 016.246 0z"})})},30579:(e,t,o)=>{o.d(t,{p:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("aiChangeTone",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M10.0371 1.67969L14.0293 5.67188C15.2529 4.46875 15.3486 2.82812 14.1113 1.59766C12.8809 0.374023 11.2471 0.456055 10.0371 1.67969ZM8.16406 14.9482C8.58105 14.9482 8.90918 14.627 8.90918 14.21L8.92285 9.26758L10.9189 7.41504C11.7256 7.49023 12.5527 7.15527 13.25 6.44434L9.26465 2.45215C8.55371 3.15625 8.23242 3.96973 8.31445 4.7832L1.97754 11.5918C1.69043 11.8994 1.66992 12.2822 2.00488 12.6719L1.08203 13.8408C0.958984 13.998 0.972656 14.2236 1.12988 14.3809L1.32812 14.5859C1.48535 14.7432 1.7041 14.7568 1.88184 14.6201L3.04395 13.6973C3.42676 14.0391 3.81641 14.0117 4.11719 13.7314L7.42578 10.6621V14.21C7.42578 14.627 7.75391 14.9482 8.16406 14.9482ZM2.90723 12.1934L8.7793 6.03418C8.88867 6.21191 9.01855 6.37598 9.16895 6.5332C9.32617 6.69727 9.49023 6.83398 9.6543 6.94336L3.51562 12.8086L2.90723 12.1934Z"})})},41886:(e,t,o)=>{o.d(t,{y:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("aiExplainThis",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M7.61035 10.7373C8.19824 10.7373 8.55371 10.4229 8.64941 9.89648C8.64941 9.84863 8.66309 9.78027 8.66309 9.73242C8.74512 9.01465 9.0459 8.69336 10.1807 7.98926C11.4248 7.20312 12.0947 6.31445 12.0947 5.01562C12.0947 2.89648 10.3652 1.61816 7.95898 1.61816C6.1748 1.61816 4.73926 2.35645 4.14453 3.55957C3.98047 3.88086 3.90527 4.21582 3.90527 4.53027C3.89844 5.15234 4.30176 5.56934 4.96484 5.56934C5.46387 5.56934 5.86719 5.30957 6.05176 4.8584C6.36621 3.92188 7.00195 3.55273 7.84961 3.55273C8.85449 3.55273 9.64062 4.14746 9.64062 5.0498C9.64062 5.9043 9.17578 6.3418 8.13672 6.99805C7.15918 7.63379 6.49609 8.33105 6.49609 9.39062V9.64355C6.49609 10.293 6.93359 10.7373 7.61035 10.7373ZM7.6377 14.6611C8.39648 14.6611 9.01855 14.0732 9.01855 13.3281C9.01855 12.5898 8.39648 12.002 7.6377 12.002C6.87207 12.002 6.25684 12.5898 6.25684 13.3281C6.25684 14.0732 6.87207 14.6611 7.6377 14.6611Z"})})},27245:(e,t,o)=>{o.d(t,{U:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("aiFixSpellingGrammar",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M6.6123 14.2646C7.07715 14.2646 7.43945 14.0869 7.68555 13.7109L14.0566 3.96973C14.2344 3.69629 14.3096 3.44336 14.3096 3.2041C14.3096 2.56152 13.8311 2.09668 13.1748 2.09668C12.7236 2.09668 12.4434 2.26074 12.1699 2.69141L6.57812 11.5098L3.74121 7.98926C3.48828 7.68848 3.21484 7.55176 2.83203 7.55176C2.16895 7.55176 1.69043 8.02344 1.69043 8.66602C1.69043 8.95312 1.7793 9.20605 2.02539 9.48633L5.55273 13.7588C5.84668 14.1074 6.1748 14.2646 6.6123 14.2646Z"})})},52897:(e,t,o)=>{o.d(t,{d:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("aiImproveWriting",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8.84082 0.982422C8.84082 0.524414 8.45801 0.134766 8 0.134766C7.54199 0.134766 7.15234 0.524414 7.15234 0.982422V3.06738C7.15234 3.52539 7.54199 3.9082 8 3.9082C8.45801 3.9082 8.84082 3.52539 8.84082 3.06738V0.982422ZM10.9463 3.9082C10.6318 4.22949 10.6318 4.77637 10.96 5.10449C11.2744 5.41895 11.8281 5.41895 12.1494 5.09082L13.5781 3.66211C13.8994 3.34766 13.8926 2.79395 13.5645 2.46582C13.25 2.14453 12.6963 2.1582 12.375 2.47949L10.9463 3.9082ZM3.84375 5.09082C4.16504 5.41895 4.71875 5.41895 5.0332 5.10449C5.36133 4.77637 5.36133 4.22949 5.04688 3.9082L3.625 2.47949C3.30371 2.1582 2.75 2.14453 2.43555 2.46582C2.10742 2.78711 2.10742 3.34082 2.42188 3.65527L3.84375 5.09082ZM13.3047 14.9277C13.7148 15.3447 14.4121 15.3379 14.8154 14.9277C15.2188 14.5107 15.2188 13.834 14.8154 13.417L8.32812 6.88184C7.91797 6.47168 7.2207 6.47168 6.81738 6.88184C6.40723 7.29883 6.41406 7.97559 6.81738 8.38574L13.3047 14.9277ZM0.931641 7.19629C0.473633 7.19629 0.0908203 7.5791 0.0908203 8.03711C0.0908203 8.49512 0.473633 8.87793 0.931641 8.87793H3.0166C3.47461 8.87793 3.86426 8.49512 3.86426 8.03711C3.86426 7.5791 3.47461 7.19629 3.0166 7.19629H0.931641ZM15.0615 8.87793C15.5195 8.87793 15.9092 8.49512 15.9092 8.03711C15.9092 7.5791 15.5195 7.19629 15.0615 7.19629H12.9834C12.5254 7.19629 12.1357 7.5791 12.1357 8.03711C12.1357 8.49512 12.5254 8.87793 12.9834 8.87793H15.0615ZM9.62695 10.1357L7.49414 7.99609C7.32324 7.83203 7.26172 7.62012 7.43262 7.45605C7.58301 7.30566 7.80176 7.36035 7.97266 7.53125L10.0918 9.65723L9.62695 10.1357ZM2.42188 12.3984C2.10059 12.7197 2.09375 13.2734 2.4082 13.5879C2.72949 13.916 3.2832 13.9229 3.60449 13.6084L5.0332 12.1797C5.35449 11.8584 5.36133 11.3115 5.04688 10.9902C4.72559 10.6689 4.17188 10.6621 3.85059 10.9766L2.42188 12.3984ZM8.84082 13.0137C8.84082 12.5557 8.45801 12.166 8 12.166C7.54199 12.166 7.15234 12.5557 7.15234 13.0137V15.0918C7.15234 15.5498 7.54199 15.9395 8 15.9395C8.45801 15.9395 8.84082 15.5498 8.84082 15.0918V13.0137Z"})})},7500:(e,t,o)=>{o.d(t,{H:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("aiMakeLonger",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M1.45117 3.38184H14.542C14.9795 3.38184 15.3281 3.00586 15.3281 2.5752C15.3281 2.13086 14.9863 1.77539 14.542 1.77539H1.45117C1.00684 1.77539 0.665039 2.14453 0.665039 2.5752C0.665039 2.99902 1.01367 3.38184 1.45117 3.38184ZM1.45117 6.96387H14.542C14.9795 6.96387 15.3281 6.58789 15.3281 6.15723C15.3281 5.71973 14.9863 5.35742 14.542 5.35742H1.45117C1.00684 5.35742 0.665039 5.72656 0.665039 6.15723C0.665039 6.58105 1.01367 6.96387 1.45117 6.96387ZM1.45117 10.5527H14.542C14.9795 10.5527 15.3281 10.1768 15.3281 9.74609C15.3281 9.30176 14.9863 8.94629 14.542 8.94629H1.45117C1.00684 8.94629 0.665039 9.31543 0.665039 9.74609C0.665039 10.1699 1.01367 10.5527 1.45117 10.5527ZM1.45117 14.1348H8.44434C8.88184 14.1348 9.23047 13.7588 9.23047 13.3281C9.23047 12.8906 8.88867 12.5283 8.44434 12.5283H1.45117C1.00684 12.5283 0.665039 12.8975 0.665039 13.3281C0.665039 13.752 1.01367 14.1348 1.45117 14.1348Z"})})},31157:(e,t,o)=>{o.d(t,{f:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("aiMakeShorter",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M1.4502 7.01221H14.541C14.9785 7.01221 15.3271 6.63623 15.3271 6.20557C15.3271 5.76123 14.9854 5.40576 14.541 5.40576H1.4502C1.00586 5.40576 0.664062 5.7749 0.664062 6.20557C0.664062 6.62939 1.0127 7.01221 1.4502 7.01221ZM1.4502 10.5942H8.44336C8.88086 10.5942 9.22949 10.2183 9.22949 9.7876C9.22949 9.3501 8.8877 8.98779 8.44336 8.98779H1.4502C1.00586 8.98779 0.664062 9.35693 0.664062 9.7876C0.664062 10.2114 1.0127 10.5942 1.4502 10.5942Z"})})},9999:(e,t,o)=>{o.d(t,{J:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("alias",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M13.1475 10.5869V3.72363C13.1475 3.25195 12.833 2.93066 12.3477 2.93066H5.48438C5.02637 2.93066 4.70508 3.27246 4.70508 3.67578C4.70508 4.07227 5.05371 4.40039 5.46387 4.40039H7.89746L10.8438 4.30469L9.59961 5.39844L3.08496 11.9199C2.92773 12.0771 2.8457 12.2686 2.8457 12.46C2.8457 12.8564 3.20801 13.2256 3.61816 13.2256C3.80957 13.2256 3.99414 13.1504 4.15137 12.9932L10.6729 6.47168L11.7803 5.22754L11.6641 8.05762V10.6074C11.6641 11.0176 11.9922 11.373 12.4023 11.373C12.8057 11.373 13.1475 11.0312 13.1475 10.5869Z"})})},82477:(e,t,o)=>{o.d(t,{L:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("alignCenter",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zm-8.736 10.34h4.738c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.656-1.905-1.922-1.905H5.704c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.843-.28-.843-.85V5.78c0-.568.298-.85.843-.85h4.452c.539 0 .843.282.843.85v4.44c0 .568-.304.85-.697.85H5.774z"})})},70622:(e,t,o)=>{o.d(t,{$:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("alignLeft",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zM3.372 12.218H8.11c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.657-1.905-1.922-1.905H3.372c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.844-.28-.844-.85V5.78c0-.568.3-.85.844-.85h4.451c.54 0 .844.282.844.85v4.44c0 .568-.305.85-.697.85H3.442z"})})},53376:(e,t,o)=>{o.d(t,{g:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("alignRight",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zm-6.408 10.34h4.738c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.657-1.905-1.922-1.905H8.032c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.844-.28-.844-.85V5.78c0-.568.3-.85.844-.85h4.451c.54 0 .844.282.844.85v4.44c0 .568-.305.85-.697.85H8.102z"})})},33907:(e,t,o)=>{o.d(t,{n:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("arrowRight",{viewBox:"0 0 30 30",svg:(0,r.jsx)("polygon",{points:"1 14 25.188 14 16.594 5.406 18 4 29 15 18 26 16.594 24.594 25.188 16 1 16"})})},55631:(e,t,o)=>{o.d(t,{n:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("arrowsOut",{viewBox:"0 0 30 30",svg:(0,r.jsx)("path",{d:"M7.09101 20.6434C7.50813 20.2263 7.49239 19.6124 7.07527 19.1953L6.41418 18.5342L3.51009 15.9449L7.75998 16.0551L12.6237 16.0709C12.8992 16.0787 13.1353 15.9685 13.3242 15.7797C13.7728 15.3311 13.8121 14.7093 13.3714 14.2686C13.1589 14.0561 12.8992 13.938 12.6159 13.938L7.75998 13.9459L3.51009 14.0561L6.42205 11.4589L7.07527 10.8057C7.49239 10.3886 7.52387 9.77473 7.09888 9.34974C6.6739 8.92476 6.06002 8.9405 5.63503 9.36548L1.2671 13.7334C0.464339 14.5362 0.464339 15.4649 1.2671 16.2676L5.63503 20.6356C6.04428 21.0448 6.6739 21.0605 7.09101 20.6434ZM24.3739 20.6592L28.7418 16.2912C29.5446 15.4885 29.5524 14.5519 28.7497 13.7492L24.3818 9.38123C23.9725 8.97198 23.3429 8.95624 22.9179 9.38123C22.5087 9.79047 22.5165 10.4122 22.9336 10.8293L23.5947 11.4904L26.5067 14.0718L22.2489 13.9695L17.3931 13.9459C17.1176 13.938 16.8736 14.0561 16.6847 14.245C16.244 14.6857 16.1968 15.3153 16.6375 15.7561C16.85 15.9685 17.1176 16.0787 17.4009 16.0787L22.2489 16.0787L26.5067 15.9607L23.5947 18.5578L22.9336 19.2189C22.5165 19.636 22.485 20.2499 22.91 20.6749C23.335 21.0999 23.9568 21.0763 24.3739 20.6592Z"})})},25879:(e,t,o)=>{o.d(t,{b:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("assistBrainstormIdeas",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M3.37915 4.3186C3.37915 6.77734 4.81616 7.63428 5.17212 11.7607C5.20508 12.2024 5.48853 12.4661 5.93018 12.4661H10.0632C10.5049 12.4661 10.7883 12.2024 10.8213 11.7607C11.1772 7.63428 12.6208 6.78394 12.6208 4.3186C12.6208 1.88623 10.5444 0.0471191 7.99341 0.0471191C5.44897 0.0471191 3.37915 1.87964 3.37915 4.3186ZM4.80957 4.3186C4.80957 2.64429 6.27295 1.47754 7.99341 1.47754C9.72046 1.47754 11.1904 2.64429 11.1904 4.3186C11.1904 5.95337 10.0369 6.46753 9.50952 11.0356H6.48389C5.95654 6.46753 4.80957 5.95337 4.80957 4.3186ZM5.8313 14.1799H10.1621C10.439 14.1799 10.6565 13.9492 10.6565 13.6921C10.6565 13.4285 10.439 13.2043 10.1621 13.2043H5.8313C5.55444 13.2043 5.33691 13.4285 5.33691 13.6921C5.33691 13.9492 5.55444 14.1799 5.8313 14.1799ZM7.99341 16.2168C9.08105 16.2168 9.90503 15.7026 9.97754 14.9182H5.99609C6.06201 15.7026 6.91235 16.2168 7.99341 16.2168Z"})})},12970:(e,t,o)=>{o.d(t,{O:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("assistFindActionItems",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M3.15503 7.44971C4.80298 7.44971 6.16748 6.0918 6.16748 4.43726C6.16748 2.78271 4.80957 1.41821 3.15503 1.41821C1.4939 1.41821 0.135986 2.78271 0.135986 4.43726C0.135986 6.0918 1.4939 7.44971 3.15503 7.44971ZM2.79248 6.06543C2.63428 6.06543 2.50903 5.97974 2.40356 5.85449L1.66528 4.97778C1.58618 4.87891 1.55322 4.7998 1.55322 4.68774C1.55322 4.45044 1.7312 4.27246 1.95532 4.27246C2.10034 4.27246 2.18604 4.33179 2.28491 4.45044L2.78589 5.0437L3.95264 3.17822C4.05151 3.02002 4.17017 2.94751 4.32178 2.94751C4.55249 2.94751 4.74365 3.1189 4.74365 3.33643C4.74365 3.42871 4.71729 3.5144 4.64478 3.62646L3.18799 5.84131C3.0957 5.97974 2.95068 6.06543 2.79248 6.06543ZM8.47461 5.16235H15.1257C15.5278 5.16235 15.8574 4.84595 15.8574 4.43726C15.8574 4.03516 15.5278 3.71216 15.1257 3.71216H8.47461C8.07251 3.71216 7.74951 4.03516 7.74951 4.43726C7.74951 4.84595 8.07251 5.16235 8.47461 5.16235ZM3.15503 15.0566C4.80957 15.0566 6.16748 13.6921 6.16748 12.0376C6.16748 10.3831 4.80957 9.01855 3.15503 9.01855C1.4939 9.01855 0.135986 10.3831 0.135986 12.0376C0.135986 13.6921 1.4939 15.0566 3.15503 15.0566ZM3.15503 13.6592C2.27173 13.6592 1.53345 12.9209 1.53345 12.0376C1.53345 11.1543 2.27173 10.416 3.15503 10.416C4.03833 10.416 4.77661 11.1543 4.77661 12.0376C4.77661 12.9209 4.03833 13.6592 3.15503 13.6592ZM8.47461 12.7957H15.1257C15.5278 12.7957 15.8574 12.4727 15.8574 12.0706C15.8574 11.6685 15.5278 11.3455 15.1257 11.3455H8.47461C8.07251 11.3455 7.74951 11.6685 7.74951 12.0706C7.74951 12.4727 8.07251 12.7957 8.47461 12.7957Z"})})},12436:(e,t,o)=>{o.d(t,{l:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("audio",{viewBox:"0 0 26 23",svg:(0,r.jsx)("path",{d:"M0 6.06667V16.4667H5.2L12.1333 22.5333V0L5.2 6.06667H0ZM4.33333 14.7333H1.73333V7.8H4.33333V14.7333ZM6.06667 7.61193L10.4 3.8194V18.7139L6.06667 14.9214V7.61193ZM19.0667 11.2667C19.0667 8.84433 17.6445 6.76087 15.5931 5.78847L14.586 7.24447C16.1928 7.87627 17.3333 9.43453 17.3333 11.2684C17.3333 13.1023 16.1928 14.6588 14.586 15.2923L15.5931 16.7483C17.6445 15.7725 19.0667 13.689 19.0667 11.2667ZM19.5607 0.0563333L18.5718 1.48287C21.9709 3.42247 24.2658 7.07373 24.2658 11.2667C24.2658 15.4596 21.9709 19.1109 18.5727 21.0505L19.5615 22.477C23.4087 20.2193 26 16.0507 26 11.2667C26 6.48267 23.4087 2.314 19.5607 0.0563333ZM22.5333 11.2667C22.5333 7.6648 20.5339 4.53093 17.5855 2.9094L16.5915 4.34547C19.0918 5.64547 20.8 8.25413 20.8 11.2649C20.8 14.2757 19.0901 16.8844 16.5915 18.1844L17.5855 19.6205C20.5339 18.0015 22.5333 14.8685 22.5333 11.2667Z"})})},83096:(e,t,o)=>{o.d(t,{Q:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("book",{viewBox:"0 0 30 30",svg:(0,r.jsx)("path",{d:"M27,23V1H7C4.791,1,3,2.791,3,5v20c0,2.209,1.791,4,4,4h20v-2h-1v-4H27z M21,3v6l-1-1.333L19,9V3H21z M20,11l3,4V3h2v18H9V3 h8v12L20,11z M5,5c0-1.103,0.896-2,2-2v18c-0.729,0-1.411,0.195-2,0.537V5z M24,27H7c-1.104,0-2-0.896-2-2s0.896-2,2-2h17V27z"})})},49089:(e,t,o)=>{o.d(t,{o:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("caption",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.87 8.975h6.74c1.119 0 1.775-.65 1.775-1.904V2.444c0-1.254-.656-1.904-1.922-1.904H2.871C1.605.54.949 1.19.949 2.444V7.07c0 1.254.656 1.904 1.922 1.904zm.07-1.148c-.544 0-.843-.282-.843-.85v-4.44c0-.568.299-.849.844-.849h6.451c.54 0 .844.281.844.85v4.44c0 .567-.305.849-.697.849H2.94zm-1.39 4.386h12.893a.604.604 0 00.608-.601.604.604 0 00-.608-.602H1.55a.598.598 0 00-.601.602c0 .335.266.601.601.601zm8.49 3.247H1.55a.598.598 0 01-.601-.601c0-.335.266-.602.601-.602h8.49c.336 0 .609.267.609.602a.604.604 0 01-.608.601z"})})},36591:(e,t,o)=>{o.d(t,{e:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("check",{viewBox:"0 0 14 14",svg:(0,r.jsx)("polygon",{points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})})},22225:(e,t,o)=>{o.d(t,{g:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("checkPartial",{viewBox:"0 0 14 14",svg:(0,r.jsx)("rect",{x:"1.75",y:"6.125",width:"10.5",height:"1.75"})})},72261:(e,t,o)=>{o.d(t,{v:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("checkboxCircle",{viewBox:"0 0 22 23",svg:(0,r.jsx)("circle",{cx:"11",cy:"11.5",r:"10",stroke:"#E2E1DE",strokeWidth:"2"})})},65628:(e,t,o)=>{o.d(t,{z:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("checkboxSquare",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M1.5,1.5 L1.5,14.5 L14.5,14.5 L14.5,1.5 L1.5,1.5 Z M0,0 L16,0 L16,16 L0,16 L0,0 Z"})})},42853:(e,t,o)=>{o.d(t,{i:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("chevronDown",{viewBox:"0 0 30 30",svg:(0,r.jsx)("polygon",{points:"15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "})})},17693:(e,t,o)=>{o.d(t,{A:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("chevronDownRoundedThick",{viewBox:"0 0 12 12",svg:(0,r.jsx)("path",{d:"M6.02734 8.80274C6.27148 8.80274 6.47168 8.71484 6.66211 8.51465L10.2803 4.82324C10.4268 4.67676 10.5 4.49609 10.5 4.28125C10.5 3.85156 10.1484 3.5 9.72363 3.5C9.50879 3.5 9.30859 3.58789 9.15234 3.74902L6.03223 6.9668L2.90722 3.74902C2.74609 3.58789 2.55078 3.5 2.33105 3.5C1.90137 3.5 1.55469 3.85156 1.55469 4.28125C1.55469 4.49609 1.62793 4.67676 1.77441 4.82324L5.39258 8.51465C5.58789 8.71973 5.78808 8.80274 6.02734 8.80274Z"})})},5257:(e,t,o)=>{o.d(t,{o:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("chevronRight",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M12.375 8.06445C12.375 7.83203 12.2861 7.63379 12.1084 7.45605L6.77637 2.24023C6.62598 2.08984 6.44141 2.01465 6.22266 2.01465C5.77832 2.01465 5.42285 2.35645 5.42285 2.80078C5.42285 3.01953 5.51172 3.21777 5.66211 3.375L10.4746 8.06445L5.66211 12.7539C5.51855 12.9043 5.42285 13.1025 5.42285 13.3213C5.42285 13.7725 5.77832 14.1143 6.22266 14.1143C6.44141 14.1143 6.62598 14.0391 6.77637 13.8887L12.1084 8.67285C12.293 8.49512 12.375 8.29688 12.375 8.06445Z"})})},53465:(e,t,o)=>{o.d(t,{X:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("clearInput",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M7.993 15.528a7.273 7.273 0 01-2.923-.593A7.633 7.633 0 012.653 13.3a7.797 7.797 0 01-1.633-2.417 7.273 7.273 0 01-.593-2.922c0-1.035.198-2.01.593-2.922A7.758 7.758 0 015.063.99 7.273 7.273 0 017.985.395a7.29 7.29 0 012.93.593 7.733 7.733 0 012.417 1.64 7.647 7.647 0 011.64 2.41c.396.914.594 1.888.594 2.923 0 1.035-.198 2.01-.593 2.922a7.735 7.735 0 01-4.058 4.05 7.272 7.272 0 01-2.922.594zM5.59 11.06c.2 0 .371-.066.513-.198L8 8.951l1.904 1.911a.675.675 0 00.498.198.667.667 0 00.491-.198.67.67 0 00.205-.49.64.64 0 00-.205-.491L8.981 7.969l1.92-1.911a.686.686 0 00.204-.491.646.646 0 00-.205-.484.646.646 0 00-.483-.205.67.67 0 00-.49.205L8 6.995 6.081 5.083a.696.696 0 00-.49-.19.682.682 0 00-.491.198.651.651 0 00-.198.49c0 .181.068.342.205.484l1.912 1.904-1.912 1.92a.646.646 0 00-.205.483c0 .19.066.354.198.49.136.132.3.198.49.198z"})})},19525:(e,t,o)=>{o.d(t,{b:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("closeThick",{viewBox:"0 0 8 8",svg:(0,r.jsx)("polygon",{points:"8 1.01818182 6.98181818 0 4 2.98181818 1.01818182 0 0 1.01818182 2.98181818 4 0 6.98181818 1.01818182 8 4 5.01818182 6.98181818 8 8 6.98181818 5.01818182 4"})})},3124:(e,t,o)=>{o.d(t,{_:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("codeOnly",{viewBox:"0 0 24 20",svg:(0,r.jsx)("path",{d:"M8.093 13.62c.458.123.875-.123 1.011-.58l3.364-11.533c.13-.43-.082-.855-.54-.978-.451-.123-.848.075-.998.581L7.58 12.595c-.137.465.041.895.513 1.025zM.115 7.064c0 .233.103.472.301.643l4.423 3.992c.362.328.848.322 1.148-.02.308-.342.267-.834-.082-1.149L2.077 7.064l3.828-3.472c.349-.315.39-.8.082-1.142-.3-.342-.786-.348-1.148-.02L.416 6.415a.879.879 0 00-.3.65zm19.763 0a.878.878 0 00-.3-.649L15.153 2.43c-.362-.328-.847-.322-1.148.02-.308.342-.267.827.082 1.142l3.828 3.472-3.828 3.466c-.349.315-.39.807-.082 1.149.3.341.786.348 1.148.02l4.423-3.992c.198-.17.3-.41.3-.643z"})})},5049:(e,t,o)=>{o.d(t,{s:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("codePreviewOnly",{viewBox:"0 0 24 20",svg:(0,r.jsx)("path",{d:"M2.608 11.906h1.21v1.032c0 1.463.766 2.215 2.243 2.215h9.33c1.477 0 2.243-.758 2.243-2.215V6.444c0-1.463-.766-2.221-2.242-2.221H14.12V3.197c0-1.463-.772-2.221-2.242-2.221h-9.27C1.132.976.366 1.734.366 3.197v6.494c0 1.457.766 2.215 2.242 2.215zm.082-1.34c-.635 0-.984-.328-.984-.99v-6.27c0-.662.349-.99.984-.99h9.106c.629 0 .984.328.984.99v.917H6.06c-1.476 0-2.242.758-2.242 2.221v4.122H2.69zm3.453 3.254c-.636 0-.985-.335-.985-.998V6.561c0-.664.349-.998.985-.998h9.167c.628 0 .984.334.984.998v6.261c0 .663-.356.998-.984.998H6.143zm2.713-1.77c0 .307.335.437.595.287l3.972-2.324a.372.372 0 00-.007-.643L9.451 7.046c-.26-.15-.595-.027-.595.287v4.717z"})})},43661:(e,t,o)=>{o.d(t,{O:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("codepen",{viewBox:"0 0 40 40",svg:(0,r.jsx)("path",{d:"M39.9834,13.7071 C39.8236,12.6665 38.6647,12.1063 37.8655,11.586 C36.4269,10.6255 35.0283,9.70502 33.5897,8.74452 C30.1931,6.46334 26.7564,4.18216 23.3598,1.90098 C22.5606,1.38071 21.7613,0.820424 20.9621,0.300155 C20.4027,-0.100052 19.6434,-0.100052 19.044,0.300155 C16.7663,1.82094 14.4485,3.38175 12.1708,4.90253 L2.10066,11.626 C1.22152,12.1863 0.0626603,12.7466 0.0226996,13.9472 C-0.0172612,15.2679 0.0226996,16.6286 0.0226996,17.9493 L0.0226996,24.3526 C0.0226996,25.5132 -0.217065,26.8739 0.861875,27.5943 C3.41936,29.3552 6.01681,31.036 8.61426,32.7569 C11.8111,34.878 15.008,37.0391 18.2048,39.1602 C19.084,39.7606 19.9631,40.4009 21.0421,39.6805 C21.9611,39.0802 22.8403,38.4799 23.7594,37.8796 C27.3159,35.5184 30.8724,33.1171 34.4289,30.7559 L38.385,28.1145 C38.6248,27.9544 38.9045,27.7944 39.1443,27.5943 C39.7037,27.1941 39.9435,26.6338 39.9435,25.9534 L39.9435,14.9477 C39.9834,14.5075 40.0234,14.1073 39.9834,13.7071 C39.9834,13.7871 39.9834,13.6671 39.9834,13.7071 Z M21.7214,4.94255 L35.1882,13.9472 L29.194,17.9893 L21.7214,12.9867 L21.7214,4.94255 Z M18.2848,4.94255 L18.2848,12.9467 L10.8521,17.9493 L4.81799,13.9472 L18.2848,4.94255 Z M3.45932,17.1489 L7.73512,20.0304 L3.45932,22.9118 L3.45932,17.1489 Z M18.2848,35.1182 L4.81799,26.1135 L10.8121,22.0714 L18.2448,27.074 L18.2448,35.1182 L18.2848,35.1182 Z M20.0031,24.1125 L13.929,20.0304 L20.0031,15.9482 L26.0771,20.0304 L20.0031,24.1125 Z M21.7214,35.1182 L21.7214,27.114 L29.1541,22.1114 L35.1482,26.1535 L21.7214,35.1182 Z M36.5468,22.9118 L32.271,20.0304 L36.5868,17.1489 L36.5468,22.9118 Z"})})},35013:(e,t,o)=>{o.d(t,{i:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("collectionBoard",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.39697 14.4634H13.5964C15.0532 14.4634 15.8311 13.6921 15.8311 12.2485V4.24609C15.8311 2.80249 15.0532 2.03125 13.5964 2.03125H2.39697C0.940186 2.03125 0.162354 2.7959 0.162354 4.24609V12.2485C0.162354 13.6987 0.940186 14.4634 2.39697 14.4634ZM2.52222 12.9934C1.94214 12.9934 1.63232 12.7034 1.63232 12.0969V4.39771C1.63232 3.79126 1.94214 3.50122 2.52222 3.50122H4.92822V12.9934H2.52222ZM6.34546 12.9934V3.50122H9.64795V12.9934H6.34546ZM13.4712 3.50122C14.0447 3.50122 14.3611 3.79126 14.3611 4.39771V12.0969C14.3611 12.7034 14.0447 12.9934 13.4712 12.9934H11.0652V3.50122H13.4712Z"})})},21321:(e,t,o)=>{o.d(t,{N:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("collectionCalendar",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M3.29688 14.4561H12.7031C14.1797 14.4561 14.9453 13.6904 14.9453 12.2344V3.91504C14.9453 2.45215 14.1797 1.69336 12.7031 1.69336H3.29688C1.82031 1.69336 1.05469 2.45215 1.05469 3.91504V12.2344C1.05469 13.6973 1.82031 14.4561 3.29688 14.4561ZM3.27637 13.1162C2.70898 13.1162 2.39453 12.8154 2.39453 12.2207V5.9043C2.39453 5.30273 2.70898 5.00879 3.27637 5.00879H12.71C13.2842 5.00879 13.6055 5.30273 13.6055 5.9043V12.2207C13.6055 12.8154 13.2842 13.1162 12.71 13.1162H3.27637ZM6.68066 7.38086H7.08398C7.33008 7.38086 7.41211 7.30566 7.41211 7.05957V6.66309C7.41211 6.41699 7.33008 6.3418 7.08398 6.3418H6.68066C6.44141 6.3418 6.35938 6.41699 6.35938 6.66309V7.05957C6.35938 7.30566 6.44141 7.38086 6.68066 7.38086ZM8.92285 7.38086H9.31934C9.56543 7.38086 9.64746 7.30566 9.64746 7.05957V6.66309C9.64746 6.41699 9.56543 6.3418 9.31934 6.3418H8.92285C8.67676 6.3418 8.59473 6.41699 8.59473 6.66309V7.05957C8.59473 7.30566 8.67676 7.38086 8.92285 7.38086ZM11.1582 7.38086H11.5547C11.8008 7.38086 11.8828 7.30566 11.8828 7.05957V6.66309C11.8828 6.41699 11.8008 6.3418 11.5547 6.3418H11.1582C10.9121 6.3418 10.8301 6.41699 10.8301 6.66309V7.05957C10.8301 7.30566 10.9121 7.38086 11.1582 7.38086ZM4.44531 9.58203H4.84863C5.09473 9.58203 5.17676 9.50684 5.17676 9.26074V8.86426C5.17676 8.61816 5.09473 8.54297 4.84863 8.54297H4.44531C4.20605 8.54297 4.12402 8.61816 4.12402 8.86426V9.26074C4.12402 9.50684 4.20605 9.58203 4.44531 9.58203ZM6.68066 9.58203H7.08398C7.33008 9.58203 7.41211 9.50684 7.41211 9.26074V8.86426C7.41211 8.61816 7.33008 8.54297 7.08398 8.54297H6.68066C6.44141 8.54297 6.35938 8.61816 6.35938 8.86426V9.26074C6.35938 9.50684 6.44141 9.58203 6.68066 9.58203ZM8.92285 9.58203H9.31934C9.56543 9.58203 9.64746 9.50684 9.64746 9.26074V8.86426C9.64746 8.61816 9.56543 8.54297 9.31934 8.54297H8.92285C8.67676 8.54297 8.59473 8.61816 8.59473 8.86426V9.26074C8.59473 9.50684 8.67676 9.58203 8.92285 9.58203ZM11.1582 9.58203H11.5547C11.8008 9.58203 11.8828 9.50684 11.8828 9.26074V8.86426C11.8828 8.61816 11.8008 8.54297 11.5547 8.54297H11.1582C10.9121 8.54297 10.8301 8.61816 10.8301 8.86426V9.26074C10.8301 9.50684 10.9121 9.58203 11.1582 9.58203ZM4.44531 11.7832H4.84863C5.09473 11.7832 5.17676 11.708 5.17676 11.4619V11.0654C5.17676 10.8193 5.09473 10.7441 4.84863 10.7441H4.44531C4.20605 10.7441 4.12402 10.8193 4.12402 11.0654V11.4619C4.12402 11.708 4.20605 11.7832 4.44531 11.7832ZM6.68066 11.7832H7.08398C7.33008 11.7832 7.41211 11.708 7.41211 11.4619V11.0654C7.41211 10.8193 7.33008 10.7441 7.08398 10.7441H6.68066C6.44141 10.7441 6.35938 10.8193 6.35938 11.0654V11.4619C6.35938 11.708 6.44141 11.7832 6.68066 11.7832ZM8.92285 11.7832H9.31934C9.56543 11.7832 9.64746 11.708 9.64746 11.4619V11.0654C9.64746 10.8193 9.56543 10.7441 9.31934 10.7441H8.92285C8.67676 10.7441 8.59473 10.8193 8.59473 11.0654V11.4619C8.59473 11.708 8.67676 11.7832 8.92285 11.7832Z"})})},69628:(e,t,o)=>{o.d(t,{n:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("collectionGallery",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.0542 7.75952H5.96973C7.00464 7.75952 7.50562 7.25854 7.50562 6.19727V3.58691C7.50562 2.53223 7.00464 2.03125 5.96973 2.03125H2.0542C1.01929 2.03125 0.518311 2.53223 0.518311 3.58691V6.19727C0.518311 7.25854 1.01929 7.75952 2.0542 7.75952ZM10.0303 7.75952H13.9392C14.9741 7.75952 15.4751 7.25854 15.4751 6.19727V3.58691C15.4751 2.53223 14.9741 2.03125 13.9392 2.03125H10.0303C8.98877 2.03125 8.48779 2.53223 8.48779 3.58691V6.19727C8.48779 7.25854 8.98877 7.75952 10.0303 7.75952ZM2.06079 6.55322C1.83008 6.55322 1.71802 6.44116 1.71802 6.20386V3.58032C1.71802 3.34961 1.83008 3.23755 2.06079 3.23755H5.96313C6.18726 3.23755 6.30591 3.34961 6.30591 3.58032V6.20386C6.30591 6.44116 6.18726 6.55322 5.96313 6.55322H2.06079ZM10.0369 6.55322C9.79956 6.55322 9.69409 6.44116 9.69409 6.20386V3.58032C9.69409 3.34961 9.79956 3.23755 10.0369 3.23755H13.9392C14.1633 3.23755 14.2754 3.34961 14.2754 3.58032V6.20386C14.2754 6.44116 14.1633 6.55322 13.9392 6.55322H10.0369ZM2.0542 14.4634H5.96973C7.00464 14.4634 7.50562 13.969 7.50562 12.9077V10.2974C7.50562 9.24268 7.00464 8.7417 5.96973 8.7417H2.0542C1.01929 8.7417 0.518311 9.24268 0.518311 10.2974V12.9077C0.518311 13.969 1.01929 14.4634 2.0542 14.4634ZM10.0303 14.4634H13.9392C14.9741 14.4634 15.4751 13.969 15.4751 12.9077V10.2974C15.4751 9.24268 14.9741 8.7417 13.9392 8.7417H10.0303C8.98877 8.7417 8.48779 9.24268 8.48779 10.2974V12.9077C8.48779 13.969 8.98877 14.4634 10.0303 14.4634ZM2.06079 13.2637C1.83008 13.2637 1.71802 13.1516 1.71802 12.9143V10.2974C1.71802 10.0601 1.83008 9.94141 2.06079 9.94141H5.96313C6.18726 9.94141 6.30591 10.0601 6.30591 10.2974V12.9143C6.30591 13.1516 6.18726 13.2637 5.96313 13.2637H2.06079ZM10.0369 13.2637C9.79956 13.2637 9.69409 13.1516 9.69409 12.9143V10.2974C9.69409 10.0601 9.79956 9.94141 10.0369 9.94141H13.9392C14.1633 9.94141 14.2754 10.0601 14.2754 10.2974V12.9143C14.2754 13.1516 14.1633 13.2637 13.9392 13.2637H10.0369Z"})})},17948:(e,t,o)=>{o.d(t,{O:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("collectionList",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.08716 5.15576C2.64087 5.15576 3.08911 4.70752 3.08911 4.15381C3.08911 3.6001 2.64087 3.15186 2.08716 3.15186C1.53345 3.15186 1.08521 3.6001 1.08521 4.15381C1.08521 4.70752 1.53345 5.15576 2.08716 5.15576ZM5.29736 4.85254H14.2161C14.605 4.85254 14.9148 4.54272 14.9148 4.15381C14.9148 3.76489 14.605 3.45508 14.2161 3.45508H5.29736C4.90845 3.45508 4.59863 3.7583 4.59863 4.15381C4.59863 4.54272 4.90186 4.85254 5.29736 4.85254ZM2.08716 9.24927C2.64087 9.24927 3.08911 8.80103 3.08911 8.24731C3.08911 7.6936 2.64087 7.24536 2.08716 7.24536C1.53345 7.24536 1.08521 7.6936 1.08521 8.24731C1.08521 8.80103 1.53345 9.24927 2.08716 9.24927ZM5.29736 8.94604H14.2161C14.605 8.94604 14.9148 8.64282 14.9148 8.24731C14.9148 7.8584 14.605 7.54858 14.2161 7.54858H5.29736C4.90845 7.54858 4.59863 7.8584 4.59863 8.24731C4.59863 8.63623 4.90186 8.94604 5.29736 8.94604ZM2.08716 13.3428C2.64087 13.3428 3.08911 12.8945 3.08911 12.3408C3.08911 11.7937 2.64087 11.3389 2.08716 11.3389C1.53345 11.3389 1.08521 11.7937 1.08521 12.3408C1.08521 12.8945 1.53345 13.3428 2.08716 13.3428ZM5.29736 13.0396H14.2161C14.605 13.0396 14.9148 12.7363 14.9148 12.3408C14.9148 11.9519 14.605 11.6487 14.2161 11.6487H5.29736C4.90845 11.6487 4.59863 11.9519 4.59863 12.3408C4.59863 12.7297 4.90186 13.0396 5.29736 13.0396Z"})})},49019:(e,t,o)=>{o.d(t,{e:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("collectionSearch",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M0 6.35938C0 9.86719 2.85156 12.7188 6.35938 12.7188C7.66406 12.7188 8.85938 12.3203 9.85938 11.6406L13.4531 15.2344C13.6719 15.4609 13.9766 15.5625 14.2812 15.5625C14.9453 15.5625 15.4219 15.0625 15.4219 14.4141C15.4219 14.1016 15.3125 13.8125 15.1016 13.5938L11.5312 10.0156C12.2734 8.99219 12.7188 7.72656 12.7188 6.35938C12.7188 2.85156 9.86719 0 6.35938 0C2.85156 0 0 2.85156 0 6.35938ZM1.65625 6.35938C1.65625 3.76562 3.75781 1.65625 6.35938 1.65625C8.95312 1.65625 11.0625 3.76562 11.0625 6.35938C11.0625 8.95312 8.95312 11.0625 6.35938 11.0625C3.75781 11.0625 1.65625 8.95312 1.65625 6.35938Z"})})},10405:(e,t,o)=>{o.d(t,{_:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("collectionTimeline",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.5964 14.4634H2.39697C0.940186 14.4634 0.162354 13.6987 0.162354 12.2485V4.24609C0.162354 2.7959 0.940186 2.03125 2.39697 2.03125H13.5964C15.0532 2.03125 15.8311 2.80249 15.8311 4.24609V12.2485C15.8311 13.6921 15.0532 14.4634 13.5964 14.4634ZM1.63232 12.0969C1.63232 12.7034 1.94214 12.9934 2.52222 12.9934H13.4712C14.0447 12.9934 14.3611 12.7034 14.3611 12.0969V4.39771C14.3611 3.79126 14.0447 3.50122 13.4712 3.50122H2.52222C1.94214 3.50122 1.63232 3.79126 1.63232 4.39771V12.0969ZM8.92711 6.13826H2.71776C2.44986 6.13826 2.23645 5.91123 2.23645 5.64787C2.23645 5.37997 2.44986 5.15747 2.71776 5.15747H8.92711C9.19955 5.15747 9.40842 5.37542 9.40842 5.64787C9.40842 5.91577 9.19955 6.13826 8.92711 6.13826ZM11.3757 8.49036H4.75992C4.49201 8.49036 4.2786 8.26332 4.2786 7.99996C4.2786 7.73206 4.49201 7.50957 4.75992 7.50957H11.3757C11.6482 7.50957 11.857 7.72752 11.857 7.99996C11.857 8.26332 11.6482 8.49036 11.3757 8.49036ZM13.2822 10.8424H8.24608C7.97818 10.8424 7.76477 10.6109 7.76477 10.352C7.76477 10.0841 7.97818 9.85711 8.24608 9.85711H13.2822C13.5547 9.85711 13.7636 10.0796 13.7636 10.352C13.7636 10.6154 13.5547 10.8424 13.2822 10.8424Z"})})},70037:(e,t,o)=>{o.d(t,{h:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("commentAlert",{viewBox:"0 0 34 28",svg:(0,r.jsx)("path",{d:"M8.99023 25.3516C9.55957 25.3516 9.94629 25.1582 10.6338 24.5566L14.2324 21.3232C15.0059 22.1719 16.1768 22.6338 17.6699 22.6338H21.376L24.9639 25.7061C25.6191 26.2646 25.9736 26.5547 26.4893 26.5547C27.2305 26.5547 27.6494 26.0283 27.6494 25.2119V22.6338H28.1006C30.7969 22.6338 32.5908 21.001 32.5908 18.1973V11.8486C32.5908 9.03418 30.7969 7.40137 28.1006 7.40137H26.4141V6.58496C26.4141 3.67383 24.6846 1.97656 21.7627 1.97656H6.39062C3.58691 1.97656 1.73926 3.67383 1.73926 6.58496V16.4785C1.73926 19.4004 3.58691 21.0869 6.39062 21.0869H7.80859V24.0303C7.80859 24.8574 8.22754 25.3516 8.99023 25.3516ZM9.43066 20.3672C9.43066 19.7549 9.06543 19.4756 8.59277 19.4756H6.49805C4.59668 19.4756 3.46875 18.4336 3.46875 16.4355V6.64941C3.46875 4.65137 4.59668 3.59863 6.49805 3.59863H21.6553C23.5566 3.59863 24.6846 4.65137 24.6846 6.64941V7.40137H17.6699C14.8555 7.40137 13.1904 9.03418 13.1904 11.8486V18.1973C13.1904 18.7773 13.2549 19.3037 13.3945 19.7764L9.43066 23.4395V20.3672ZM26.0381 24.6104L22.5898 21.5166C22.1602 21.1406 21.9023 21.0117 21.3115 21.0117H17.7773C15.9834 21.0117 14.9092 20.0449 14.9092 18.1436L14.9199 11.9023C14.9199 10.0117 15.9834 9.02344 17.7773 9.02344H28.0039C29.7871 9.02344 30.8613 10.0117 30.8613 11.9023V18.1436C30.8613 20.0449 29.7871 21.0117 28.0039 21.0117H26.8652C26.4033 21.0117 26.0381 21.291 26.0381 21.8926V24.6104ZM22.9014 16.3389C23.3955 16.3389 23.6641 16.0596 23.6855 15.5225L23.8359 11.7734C23.8574 11.2148 23.4277 10.8174 22.8906 10.8174C22.3428 10.8174 21.9346 11.2041 21.9561 11.7627L22.0957 15.5225C22.1172 16.0488 22.3857 16.3389 22.9014 16.3389ZM22.8906 19.6045C23.4814 19.6045 23.9971 19.1318 23.9971 18.541C23.9971 17.9395 23.4922 17.4775 22.8906 17.4775C22.2891 17.4775 21.7842 17.9502 21.7842 18.541C21.7842 19.1318 22.2998 19.6045 22.8906 19.6045Z"})})},25654:(e,t,o)=>{o.d(t,{m:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("compass",{viewBox:"0 0 30 30",svg:(0,r.jsx)("path",{d:"M18,4.361V3c0-1.657-1.343-3-3-3s-3,1.343-3,3v1.361C6.27,5.718,2,10.854,2,17c0,7.18,5.82,13,13,13s13-5.82,13-13 C28,10.854,23.73,5.718,18,4.361z M14,3c0-0.552,0.448-1,1-1s1,0.448,1,1v1.051C15.669,4.025,15.338,4,15,4s-0.669,0.025-1,0.051V3z M16,27.949V26h-2v1.949C8.724,27.474,4.526,23.276,4.051,18H6v-2H4.051C4.526,10.724,8.724,6.526,14,6.051V8h2V6.051 c5.276,0.476,9.474,4.673,9.949,9.949H24v2h1.949C25.474,23.276,21.276,27.474,16,27.949z M8,24l10-4l4-10l-10,4L8,24z M18.41,13.59 l-1.949,4.871L11.59,20.41l1.949-4.871L18.41,13.59z"})})},75553:(e,t,o)=>{o.d(t,{U:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("copy",{viewBox:"0 0 14 16",svg:(0,r.jsx)("path",{d:"M2.404 15.322h5.701c1.26 0 1.887-.662 1.887-1.927V12.38h1.154c1.254 0 1.91-.662 1.91-1.928V5.555c0-.774-.158-1.266-.626-1.74L9.512.837C9.066.387 8.545.21 7.865.21H5.463c-1.254 0-1.91.662-1.91 1.928v1.084H2.404c-1.254 0-1.91.668-1.91 1.933v8.239c0 1.265.656 1.927 1.91 1.927zm7.588-6.62c0-.792-.1-1.161-.592-1.665L6.225 3.814c-.452-.462-.844-.58-1.5-.591V2.215c0-.533.28-.832.843-.832h2.38v2.883c0 .726.386 1.113 1.107 1.113h2.83v4.998c0 .539-.276.832-.844.832H9.992V8.701zm-.79-4.29c-.206 0-.288-.088-.288-.287V1.594l2.771 2.818H9.201zM2.503 14.15c-.563 0-.844-.293-.844-.832V5.232c0-.539.281-.837.85-.837h1.91v3.187c0 .85.416 1.26 1.26 1.26h3.14v4.476c0 .54-.28.832-.843.832H2.504zM5.79 7.816c-.24 0-.346-.105-.346-.345V4.547l3.223 3.27H5.791z"})})},86215:(e,t,o)=>{o.d(t,{u:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("cornerResize",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{fillRule:"evenodd",strokeWidth:"1.5",d:"M 14 0C 12.8955 0 12 0.895447 12 2L 12 12L 2 12C 0.895508 12 0 12.8954 0 14C 0 15.1046 0.895508 16 2 16L 14 16C 15.1045 16 16 15.1046 16 14L 16 2C 16 0.895447 15.1045 0 14 0Z"})})},42773:(e,t,o)=>{o.d(t,{$:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("dateInterval",{viewBox:"0 0 20 20",svg:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("path",{d:"M4.345 10.359l1.832 1.36c.191.146.378.182.56.11.183-.074.274-.226.274-.459v-.847H8.96a.52.52 0 00.54-.533.513.513 0 00-.157-.376.521.521 0 00-.383-.158H7.01V8.63c0-.246-.093-.4-.28-.465-.186-.068-.371-.034-.553.103L4.345 9.64a.43.43 0 00-.185.362c0 .146.062.264.185.356zm11.31 0l-1.832 1.36c-.191.146-.378.182-.56.11-.183-.074-.274-.226-.274-.459v-.847H11.04a.533.533 0 01-.383-.15.521.521 0 01-.157-.383c0-.146.052-.272.157-.376a.521.521 0 01.383-.158h1.95V8.63c0-.246.093-.4.28-.465.186-.068.371-.034.553.103l1.832 1.374a.43.43 0 01.185.362.423.423 0 01-.185.356zM3.378 15.16c.183 0 .33-.051.445-.16a.553.553 0 00.17-.42V5.449a.592.592 0 00-.17-.438.601.601 0 00-.445-.17.592.592 0 00-.437.17.592.592 0 00-.171.438v9.132c0 .173.057.31.17.42s.26.16.438.16zm13.24 0c.183 0 .33-.051.445-.16a.552.552 0 00.17-.42V5.447a.592.592 0 00-.17-.437.6.6 0 00-.445-.17.592.592 0 00-.437.17.593.593 0 00-.171.437v9.132c0 .173.057.31.17.42.115.11.26.16.438.16z"})})})},90827:(e,t,o)=>{o.d(t,{N:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("deepnote",{viewBox:"0 0 92 92",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{fill:"#fff",d:"M0 0h92v92H0z"}),(0,r.jsx)("path",{fill:"#0265B4",fillRule:"evenodd",d:"M20 73h22.153l12.461-4.673-4.673-18.346-14.365 1.558L20 73z",clipRule:"evenodd"}),(0,r.jsx)("path",{fill:"#002868",fillRule:"evenodd",d:"M42.153 73s7.004-3.695 8.3-10.242c1.296-6.546-5.1-11.22-14.876-11.22 0-.172 8.582-12.114 8.582-12.114l20.84.605-4.622 24.407-8.628 6.74L42.153 73z",clipRule:"evenodd"}),(0,r.jsx)("path",{fill:"#3793EF",fillRule:"evenodd",d:"M20 44.615l17.307-25.614s.424.004 1.385 0c6.784-.03 34.268 1.315 34.268 25.467 0 27.57-30.807 28.53-30.807 28.53s12.865-2.463 12.865-14.687-11.619-13.696-19.095-13.696H20z",clipRule:"evenodd"})]})})},56666:(e,t,o)=>{o.d(t,{o:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("dots",{viewBox:"0 0 13 3",svg:(0,r.jsxs)("g",{children:[(0,r.jsx)("path",{d:"M3,1.5A1.5,1.5,0,1,1,1.5,0,1.5,1.5,0,0,1,3,1.5Z"}),(0,r.jsx)("path",{d:"M8,1.5A1.5,1.5,0,1,1,6.5,0,1.5,1.5,0,0,1,8,1.5Z"}),(0,r.jsx)("path",{d:"M13,1.5A1.5,1.5,0,1,1,11.5,0,1.5,1.5,0,0,1,13,1.5Z"})]})})},64330:(e,t,o)=>{o.d(t,{a:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("download",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8.215 15.126c3.862 0 7.061-3.192 7.061-7.062 0-3.862-3.199-7.061-7.068-7.061-3.862 0-7.055 3.2-7.055 7.061 0 3.87 3.2 7.062 7.062 7.062zm0-1.388a5.654 5.654 0 01-5.667-5.674 5.642 5.642 0 015.66-5.667 5.66 5.66 0 015.68 5.667 5.66 5.66 0 01-5.673 5.674zm0-9.174c-.342 0-.602.247-.602.588v3.234l.062 1.401-.622-.766-.766-.8a.557.557 0 00-.41-.177.54.54 0 00-.56.547c0 .164.054.3.163.41l2.256 2.283c.15.157.294.226.479.226.191 0 .335-.075.485-.226l2.256-2.283a.557.557 0 00.164-.41.539.539 0 00-.56-.547.523.523 0 00-.41.178l-.766.793-.622.779.054-1.408V5.152c0-.341-.253-.588-.601-.588z"})})},12217:(e,t,o)=>{o.d(t,{D:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("dragHandle",{viewBox:"0 0 10 10",svg:(0,r.jsx)("path",{d:"M3,2 C2.44771525,2 2,1.55228475 2,1 C2,0.44771525 2.44771525,0 3,0 C3.55228475,0 4,0.44771525 4,1 C4,1.55228475 3.55228475,2 3,2 Z M3,6 C2.44771525,6 2,5.55228475 2,5 C2,4.44771525 2.44771525,4 3,4 C3.55228475,4 4,4.44771525 4,5 C4,5.55228475 3.55228475,6 3,6 Z M3,10 C2.44771525,10 2,9.55228475 2,9 C2,8.44771525 2.44771525,8 3,8 C3.55228475,8 4,8.44771525 4,9 C4,9.55228475 3.55228475,10 3,10 Z M7,2 C6.44771525,2 6,1.55228475 6,1 C6,0.44771525 6.44771525,0 7,0 C7.55228475,0 8,0.44771525 8,1 C8,1.55228475 7.55228475,2 7,2 Z M7,6 C6.44771525,6 6,5.55228475 6,5 C6,4.44771525 6.44771525,4 7,4 C7.55228475,4 8,4.44771525 8,5 C8,5.55228475 7.55228475,6 7,6 Z M7,10 C6.44771525,10 6,9.55228475 6,9 C6,8.44771525 6.44771525,8 7,8 C7.55228475,8 8,8.44771525 8,9 C8,9.55228475 7.55228475,10 7,10 Z"})})},88437:(e,t,o)=>{o.d(t,{a:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("duplicate",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.83887 12.1523H4.00098V13.1846C4.00098 14.6406 4.75977 15.3994 6.24316 15.3994H13.1611C14.6377 15.3994 15.4033 14.6406 15.4033 13.1846V6.21191C15.4033 4.75586 14.6377 3.99707 13.1611 3.99707H11.999V2.96484C11.999 1.50879 11.2334 0.75 9.75684 0.75H2.83887C1.3623 0.75 0.59668 1.50195 0.59668 2.96484V9.93066C0.59668 11.3936 1.3623 12.1523 2.83887 12.1523ZM2.9209 10.8125C2.28516 10.8125 1.93652 10.4844 1.93652 9.82129V3.08105C1.93652 2.41797 2.28516 2.08301 2.9209 2.08301H9.68164C10.3105 2.08301 10.666 2.41797 10.666 3.08105V3.99707H6.24316C4.75977 3.99707 4.00098 4.75586 4.00098 6.21191V10.8125H2.9209ZM6.31836 14.0596C5.68262 14.0596 5.34082 13.7314 5.34082 13.0684V6.32812C5.34082 5.66504 5.68262 5.33691 6.31836 5.33691H13.0791C13.708 5.33691 14.0635 5.66504 14.0635 6.32812V13.0684C14.0635 13.7314 13.708 14.0596 13.0791 14.0596H6.31836Z"})})},75e3:(e,t,o)=>{o.d(t,{U:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("enter",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M5.38965 14.1667C5.81812 14.1667 6.10156 13.8767 6.10156 13.468C6.10156 13.2571 6.01587 13.0989 5.89062 12.967L4.18994 11.3125L3.02979 10.3369L4.55908 10.4028H12.7922C14.4402 10.4028 15.1389 9.65796 15.1389 8.04297V4.13403C15.1389 2.48608 14.4402 1.78735 12.7922 1.78735H9.13379C8.70532 1.78735 8.4021 2.11035 8.4021 2.50586C8.4021 2.90137 8.69873 3.22437 9.13379 3.22437H12.7593C13.4316 3.22437 13.7151 3.50781 13.7151 4.17358V7.99683C13.7151 8.67578 13.425 8.95923 12.7593 8.95923H4.55908L3.02979 9.03174L4.18994 8.04956L5.89062 6.39502C6.01587 6.26978 6.10156 6.11157 6.10156 5.89404C6.10156 5.48535 5.81812 5.19531 5.38965 5.19531C5.21167 5.19531 5.01392 5.27441 4.8689 5.41943L1.08521 9.1438C0.933594 9.28882 0.854492 9.48657 0.854492 9.68433C0.854492 9.87549 0.933594 10.0732 1.08521 10.2183L4.8689 13.9492C5.01392 14.0876 5.21167 14.1667 5.38965 14.1667Z"})})},56185:(e,t,o)=>{o.d(t,{F:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("excalidraw",{viewBox:"0 0 32 32",svg:(0,r.jsxs)("g",{children:[(0,r.jsx)("path",{d:"m14.2933 1.41174c-.8308.66246-2.1108 1.78526-3.1214 2.75088l-.7972.75228.146.98807c.0786.53895.2246 1.59439.3144 2.33544.101.74105.2021 1.43719.2358 1.53825.0449.13473 0 .2021-.1235.2021-.2134 0-.2246-.05614.3593 1.79654.2133.7073.4154 1.3586.4379 1.4259.0224.0786.1122.1123.2133.0786.1011-.0449.1572-.1347.1235-.2133-.0337-.0898.0225-.1797.1123-.2133.1235-.045.1123-.1348-.0786-.4604-.3032-.5053-1.0779-4.81685-1.1228-6.20913-.0337-.98807-.0337-.9993.3817-1.5607.4043-.55018 1.3362-1.38105 2.7734-2.43649.4042-.30316.8084-.64.9207-.75228.1684-.20211.247-.14597 1.6617 1.35859.8197.86456 1.7292 1.75158 2.0211 1.97614l.5389.40422-.4154.87579c-.2246.47157-1.134 2.29052-2.0323 4.01966-1.8751 3.6379-1.4933 3.2898-3.6716 3.3235l-1.4147.0112-.4716.539c-.494.5726-.5614.7859-.3256 1.1452.0898.1235.1572.3257.1572.4492 0 .2021.0786.2358.5277.2582.2807.0112.539.0449.5726.0786.0337.0337.0786.7298.1123 1.5495l.0449 1.4821-.7522 1.6168c-1.2464 2.6948-1.74039 3.9299-1.74039 4.3341 0 .2133.04491.3929.08982.3929.11227 0 .11227-.0112 4.68207-9.5438 2.1221-4.4239 4.132-8.5895 4.4688-9.27441.3369-.68491.64-1.31369.6625-1.40351.0224-.10105-.7523-.87579-1.9874-1.96491-1.1116-.98807-2.0884-1.88632-2.1782-1.98737-.2583-.314389-.64-.213336-1.325.33684zm.3818 12.91226c-.5165.9993-.539 1.0106-1.9537 1.0779-1.2463.0674-1.2688.0562-1.2688-.1796 0-.1348-.0449-.3144-.101-.4042-.0674-.1011-.0225-.2807.1347-.5278l.247-.3817h1.1228c.6176-.0112 1.325-.0562 1.572-.1011s.4603-.0673.4828-.0561c.0224.0112-.0898.2695-.2358.5726zm-.9432 1.7965c-.0898.2358-.3256.7298-.5165 1.1004-.3143.6287-.348.6512-.4266.393-.0449-.1572-.0786-.6176-.0898-1.033-.0113-.8197-.0337-.8084.9094-.8646l.3032-.0112z"}),(0,r.jsx)("path",{d:"m14.6302 4.08401c-.2021.14597-.2583.29193-.2583.66246 0 .43789.0337.50526.3369.62877s.3817.11228.7298-.12351c.4604-.31439.4716-.39298.1348-.89824-.292-.4379-.5839-.51649-.9432-.26948zm.64.40421c.1796.31439.0674.55018-.2695.55018-.3031 0-.4379-.30316-.2695-.60632.1348-.24701.393-.22456.539.05614z"}),(0,r.jsx)("path",{d:"m21.6702 6.61034c0 .05614-.0674.11228-.146.11228-.0674 0-.2582.31439-.4042.69614-.4491 1.16772-4.9404 10.04914-4.9516 9.76844 0-.146-.0673-.247-.1796-.247-.1572 0-.1797.0898-.1123.5277.0674.5053.0224.6175-1.5719 3.7165-.8983 1.7628-1.8639 3.6042-2.1446 4.0982-.2919.5165-.5165 1.0779-.5389 1.3137-.0337.4042.0112.4604.988 1.3025.5614.494 1.28 1.1115 1.5944 1.3922 1.4147 1.2913 2.0772 1.8078 2.2569 1.7741.2694-.0449 4.435-4.4127 4.4463-4.6597 0-.1122-.2021-1.8189-.4492-3.7951-.4266-3.3684-.8308-7.3094-.7859-7.6912.0337-.2358-.1348-1.4259-.2583-1.9424-.101-.4043-.0561-.5727.7523-2.4141.4716-1.0891 1.0891-2.42524 1.3586-2.96419.2583-.53894.4828-1.01052.4828-1.04421 0-.03368-.0786-.05614-.1684-.05614s-.1684.04492-.1684.11228zm-2.5825 8.38736c.1235.786.3705 2.6723.5502 4.1881.3481 2.7845.7523 5.8723.8646 6.6582.0673.393.0224.4716-.7074 1.28-1.2688 1.426-2.6162 2.8295-3.0765 3.1888l-.4267.3368-2.1894-2.0435c-2.0211-1.8638-2.1895-2.0547-2.066-2.2793.0674-.1235.64-1.1677 1.2688-2.3129.6287-1.1453 1.4596-2.6723 1.8414-3.3909.3929-.7299.7522-1.3586.8196-1.3923.0786-.0449.1011 1.0891.0786 3.5032-.0449 3.6042-.0337 3.6154.3256 3.5368.0449 0 .0786-1.819.0786-4.0309v-4.0196l1.179-2.3579c.6512-1.3025 1.1901-2.3467 1.2126-2.3355.0225.0113.1347.6737.247 1.4709z"})]})})},37240:(e,t,o)=>{o.d(t,{s:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("expand",{viewBox:"-1 -1 9 11",svg:(0,r.jsx)("path",{id:"path0_stroke",d:"M 3.5 0L 3.98809 -0.569442L 3.5 -0.987808L 3.01191 -0.569442L 3.5 0ZM 3.5 9L 3.01191 9.56944L 3.5 9.98781L 3.98809 9.56944L 3.5 9ZM 0.488094 3.56944L 3.98809 0.569442L 3.01191 -0.569442L -0.488094 2.43056L 0.488094 3.56944ZM 3.01191 0.569442L 6.51191 3.56944L 7.48809 2.43056L 3.98809 -0.569442L 3.01191 0.569442ZM -0.488094 6.56944L 3.01191 9.56944L 3.98809 8.43056L 0.488094 5.43056L -0.488094 6.56944ZM 3.98809 9.56944L 7.48809 6.56944L 6.51191 5.43056L 3.01191 8.43056L 3.98809 9.56944Z"})})},13797:(e,t,o)=>{o.d(t,{F:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("factoryBlockSettings",{viewBox:"0 0 24 24",svg:(0,r.jsx)("path",{d:"M12,8c-2.209,0-4,1.791-4,4s1.791,4,4,4s4-1.791,4-4S14.209,8,12,8z M12,14c-1.104,0-2-0.896-2-2s0.896-2,2-2s2,0.896,2,2 S13.104,14,12,14z M24,15V9h-3.523c-0.105-0.299-0.227-0.589-0.361-0.872l2.491-2.492l-4.243-4.243l-2.491,2.491 C15.59,3.75,15.299,3.629,15,3.523V0H9v3.523C8.701,3.629,8.411,3.75,8.128,3.885L5.636,1.394L1.394,5.636l2.491,2.492 C3.75,8.411,3.629,8.701,3.523,9H0v6h3.523c0.106,0.299,0.227,0.589,0.362,0.872l-2.492,2.491l4.243,4.243l2.492-2.491 C8.411,20.25,8.701,20.371,9,20.477V24h6v-3.523c0.299-0.105,0.59-0.227,0.872-0.361l2.491,2.491l4.243-4.243l-2.491-2.491 c0.135-0.283,0.256-0.573,0.361-0.872H24z M19.778,18.363l-1.415,1.415l-2.077-2.077c-0.896,0.502-2.271,1.049-3.286,1.363V22h-2 v-2.936c-1.016-0.314-2.391-0.861-3.286-1.363l-2.078,2.077l-1.415-1.415L6.3,16.285C5.781,15.359,5.234,13.953,4.936,13H2v-2h2.936 C5.234,10.047,5.781,8.641,6.3,7.714L4.222,5.636l1.415-1.415l2.078,2.077C8.609,5.797,9.984,5.25,11,4.936V2h2v2.936 c1.016,0.314,2.391,0.861,3.286,1.363l2.077-2.077l1.415,1.415L17.7,7.714c0.519,0.926,1.065,2.333,1.364,3.286H22v2h-2.936 c-0.299,0.953-0.846,2.359-1.364,3.285L19.778,18.363z"})})},71441:(e,t,o)=>{o.d(t,{O:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("figma",{viewBox:"0 0 36 55",svg:(0,r.jsx)("path",{d:"M19.5,27.5 C19.5,23.08142 23.08142,19.5 27.5,19.5 C31.9186,19.5 35.5,23.08142 35.5,27.5 C35.5,31.9186 31.9186,35.5 27.5,35.5 C23.08142,35.5 19.5,31.9186 19.5,27.5 Z M0.5,46.5 C0.5,42.08142 4.08142,38.5 8.5,38.5 L16.5,38.5 L16.5,46.5 C16.5,50.9186 12.9186,54.5 8.5,54.5 C4.08142,54.5 0.5,50.9186 0.5,46.5 Z M19.5,16.5 L19.5,0.5 L27.5,0.5 C31.9186,0.5 35.5,4.08142 35.5,8.5 C35.5,12.9186 31.9186,16.5 27.5,16.5 L19.5,16.5 Z M8.5,16.5 C4.08142,16.5 0.5,12.9186 0.5,8.5 C0.5,4.08142 4.08142,0.5 8.5,0.5 L16.5,0.5 L16.5,16.5 L8.5,16.5 Z M8.5,35.5 C4.08142,35.5 0.5,31.9186 0.5,27.5 C0.5,23.08142 4.08142,19.5 8.5,19.5 L16.5,19.5 L16.5,35.5 L8.5,35.5 Z"})})},50066:(e,t,o)=>{o.d(t,{R:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("file",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M4.35645 15.4678H11.6367C13.0996 15.4678 13.8584 14.6953 13.8584 13.2256V7.02539C13.8584 6.0752 13.7354 5.6377 13.1406 5.03613L9.55176 1.38574C8.97754 0.804688 8.50586 0.667969 7.65137 0.667969H4.35645C2.89355 0.667969 2.13477 1.44043 2.13477 2.91016V13.2256C2.13477 14.7021 2.89355 15.4678 4.35645 15.4678ZM4.46582 14.1279C3.80273 14.1279 3.47461 13.7793 3.47461 13.1436V2.99219C3.47461 2.36328 3.80273 2.00781 4.46582 2.00781H7.37793V5.75391C7.37793 6.73145 7.86328 7.20312 8.83398 7.20312H12.5186V13.1436C12.5186 13.7793 12.1836 14.1279 11.5205 14.1279H4.46582ZM8.95703 6.02734C8.67676 6.02734 8.56055 5.9043 8.56055 5.62402V2.19238L12.334 6.02734H8.95703ZM8.59473 12.7266V10.6279L8.54004 9.56152L9.06641 10.1152L9.59277 10.6484C9.68848 10.7646 9.8457 10.833 9.98926 10.833C10.2969 10.833 10.5293 10.6143 10.5293 10.3066C10.5293 10.1357 10.4678 10.0127 10.3379 9.90332L8.45117 8.16699C8.29395 8.02344 8.16406 7.96191 7.99316 7.96191C7.8291 7.96191 7.69922 8.02344 7.54199 8.16699L5.65527 9.90332C5.52539 10.0127 5.46387 10.1357 5.46387 10.3066C5.46387 10.6143 5.68945 10.833 6.00391 10.833C6.14746 10.833 6.29785 10.7646 6.40039 10.6484L6.92676 10.1152L7.45312 9.56152L7.39844 10.6279V12.7266C7.39844 13.0547 7.67188 13.3008 7.99316 13.3008C8.32129 13.3008 8.59473 13.0547 8.59473 12.7266Z"})})},60997:(e,t,o)=>{o.d(t,{B:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("framer",{viewBox:"0 0 32 32",svg:(0,r.jsx)("g",{children:(0,r.jsx)("path",{d:"m9 6h14v7h-7zm0 7h7l7 7h-14zm0 7h7v7z"})})})},80750:(e,t,o)=>{o.d(t,{l:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("genericError",{viewBox:"0 0 32 32",svg:(0,r.jsx)("path",{d:"M16.0242 29.0485c7.1251 0 13.0243-5.8992 13.0243-13.0243C29.0485 8.91198 23.1365 3 16.0115 3 8.89922 3 3 8.91198 3 16.0242c0 7.1251 5.91198 13.0243 13.0242 13.0243zm-.0127-11.1089c-.6768 0-1.0471-.3959-1.0726-1.0726l-.1788-6.3078c-.0255-.70232.5108-1.20031 1.2386-1.20031.7151 0 1.2769.51076 1.2514 1.21301l-.1916 6.2951c-.0255.6895-.3958 1.0726-1.047 1.0726zm0 4.6989c-.7406 0-1.4301-.5874-1.4301-1.379 0-.7917.6767-1.3791 1.4301-1.3791.7533 0 1.4301.5746 1.4301 1.3791 0 .8044-.6895 1.379-1.4301 1.379z"})})},84869:(e,t,o)=>{o.d(t,{c:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("googleDrive",{viewBox:"0 0 512 512",svg:(0,r.jsxs)("g",{children:[" ",(0,r.jsx)("path",{d:"M175.5,44.9c2.6,0,4.5,0,6.5,0c50.5,0,101,0.1,151.5-0.2c5.5,0,8.5,2,11,6.4c10.7,19,21.5,38,32.3,56.9   c13.2,23.2,26.5,46.4,39.8,69.5c14.8,25.9,29.8,51.6,44.6,77.5c11.9,20.7,23.6,41.6,35.4,62.4c1.5,2.6,5,5.2,3.5,7.8  c-0.8,1.4-5.6,0.6-8.5,0.6c-28.8-0.3-57.6-0.4-86.4-1.2c-19.7-0.6-39.3-0.3-58.9-0.8c-5.6-0.1-11.3-0.6-16.9-0.7   c-2.3,0-3.1-1.2-4-2.9c-9.7-17.9-19.4-35.7-29.2-53.6c-10.4-19.1-20.8-38.2-31.3-57.4c-11.5-21.2-23-42.4-34.5-63.5   c-11.6-21.3-23.3-42.6-34.9-64C188.7,69.7,182.3,57.6,175.5,44.9z"})," ",(0,r.jsx)("path",{d:"M97.1,474c1.6-6.5,5.5-10.8,8.3-15.6c14.5-25.3,29.3-50.3,43.9-75.5c8.6-14.9,17.1-29.8,25.5-44.8   c1.4-2.5,3.1-3.2,5.6-3.2c27.6,0.4,55.3,0.3,82.9,1.3c16.7,0.6,33.3,0.4,49.9,0.8c20.1,0.4,40.3,0.2,60.4,1.2  c13.8,0.6,27.6,0.4,41.4,0.7c29.3,0.5,58.6,0.8,87.9,1.2c1.4,0,3.2-0.7,4,1.1c0.5,1.3-0.4,2.4-1.2,3.6   c-10.4,16.3-20.8,32.7-31.2,49.1c-10.6,16.7-21.1,33.5-31.6,50.2c-5.3,8.4-10.6,16.7-15.6,25.2c-2.3,3.9-4.9,6.2-9.8,5.7   c-5.4-0.6-11-0.7-16.4-0.7c-99.3-0.1-198.6-0.2-297.9-0.3C101.3,474,99.4,474,97.1,474z"})," ",(0,r.jsx)("path",{d:"M9.8,326.3c1.1-5.3,4.5-9.5,7.1-14c14.3-25.7,28.9-51.2,43.3-76.8c9.7-17.1,19.5-34.3,29.2-51.4   c12.9-22.8,25.7-45.7,38.6-68.5c10.7-18.9,21.6-37.8,32.4-56.7c4.7-8.2,5.1-8.4,9.3-0.6c8.3,15.6,16.7,31.1,24.8,46.8  c6.1,11.9,12.6,23.7,18.9,35.5c7.2,13.6,14.5,27.2,21.7,40.7c2.2,4.2,4.3,8.6,6.8,12.7c1.3,2.1,0.9,3.4-0.3,5.4   c-16.2,27.3-32.2,54.7-48.4,81.9c-14,23.6-28.3,47-42.3,70.6c-16.4,27.5-32.6,55.1-49,82.6c-6.6,11.2-13.3,22.4-20,33.6   c-0.6,1.1-0.8,2.8-2.5,2.7c-1.6-0.1-2-1.7-2.6-2.8c-3.7-7.6-7.3-15.2-10.9-22.8c-6.9-14.7-13.9-29.3-20.9-44   c-9-18.8-18-37.5-27-56.3c-2.3-4.8-4.5-9.6-6.8-14.3C10.6,329.2,9.7,328,9.8,326.3z"})," "]})})},59341:(e,t,o)=>{o.d(t,{H:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("hand",{viewBox:"0 0 28 28",svg:(0,r.jsx)("path",{d:"M13.6572 23.1553C16.918 23.1553 19.1943 21.415 20.416 17.9873L21.9893 13.584C22.1035 13.2588 22.1562 12.9512 22.1562 12.6611C22.1562 11.6592 21.4092 10.9209 20.416 10.9209C19.7832 10.9209 19.2119 11.2812 18.9131 11.9668L18.4385 13.1182C18.4209 13.1533 18.4033 13.1709 18.3682 13.1709C18.3242 13.1709 18.3066 13.1445 18.3066 13.1006V6.35059C18.3066 5.23438 17.5771 4.51367 16.4961 4.51367C16.1621 4.51367 15.8545 4.61914 15.6172 4.82129C15.4414 3.93359 14.8174 3.38867 13.9121 3.38867C13.0332 3.38867 12.3916 3.94238 12.207 4.80371C11.9873 4.61035 11.7061 4.51367 11.4072 4.51367C10.3965 4.51367 9.70215 5.2168 9.70215 6.2627V7.08008C9.48242 6.86914 9.16602 6.75488 8.83203 6.75488C7.82129 6.75488 7.10938 7.51074 7.10938 8.58301V16.2822C7.10938 20.5361 9.72852 23.1553 13.6572 23.1553ZM13.6133 21.6523C10.4668 21.6523 8.54199 19.6484 8.54199 16.124V8.75C8.54199 8.41602 8.75293 8.1875 9.06934 8.1875C9.39453 8.1875 9.62305 8.41602 9.62305 8.75V13.2764C9.62305 13.6543 9.93066 13.918 10.2822 13.918C10.6426 13.918 10.9502 13.6543 10.9502 13.2764V6.48242C10.9502 6.14844 11.1611 5.91992 11.4863 5.91992C11.8027 5.91992 12.04 6.14844 12.04 6.48242V12.8105C12.04 13.1885 12.3389 13.4609 12.6904 13.4609C13.0508 13.4609 13.3584 13.1885 13.3584 12.8105V5.36621C13.3584 5.04102 13.5869 4.79492 13.9033 4.79492C14.2197 4.79492 14.4482 5.04102 14.4482 5.36621V12.7051C14.4482 13.0654 14.7383 13.3467 15.0986 13.3467C15.4678 13.3467 15.7666 13.0654 15.7666 12.7051V6.48242C15.7666 6.14844 15.9863 5.91992 16.3115 5.91992C16.6279 5.91992 16.8564 6.14844 16.8564 6.48242V15.2451C16.8564 15.7549 17.1816 16.0449 17.6035 16.0361C17.9551 16.0361 18.2715 15.8779 18.4824 15.4121L19.748 12.5732C19.8975 12.2305 20.1963 12.125 20.4688 12.2217C20.7676 12.3359 20.8643 12.626 20.7236 13.0039L19.0889 17.5127C17.999 20.501 16.1621 21.6523 13.6133 21.6523Z"})})},84169:(e,t,o)=>{o.d(t,{m:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("help",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.667 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM7.84277 9.4248C8.21875 9.4248 8.45801 9.21289 8.47852 8.93262C8.47852 8.90527 8.47852 8.87109 8.47852 8.85059C8.49902 8.49512 8.74512 8.25586 9.18945 7.96875C9.85938 7.52441 10.2969 7.13477 10.2969 6.3418C10.2969 5.2002 9.27148 4.55078 8.06152 4.55078C6.89258 4.55078 6.09277 5.08398 5.88086 5.72656C5.83984 5.84277 5.81934 5.95898 5.81934 6.08203C5.81934 6.41016 6.0791 6.61523 6.35254 6.61523C6.60547 6.61523 6.76953 6.5127 6.90625 6.32812L7.01562 6.19141C7.24121 5.81543 7.56934 5.61719 7.97949 5.61719C8.5332 5.61719 8.90918 5.94531 8.90918 6.41016C8.90918 6.84082 8.62207 7.05273 8.04102 7.45605C7.55566 7.79102 7.2002 8.14648 7.2002 8.76855V8.84375C7.2002 9.22656 7.43262 9.4248 7.84277 9.4248ZM7.83594 11.5234C8.27344 11.5234 8.63574 11.2021 8.63574 10.7715C8.63574 10.3408 8.27344 10.0264 7.83594 10.0264C7.3916 10.0264 7.03613 10.3477 7.03613 10.7715C7.03613 11.2021 7.39844 11.5234 7.83594 11.5234Z"})})},74155:(e,t,o)=>{o.d(t,{u:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("helpButtonGuide",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8 2.77344C7.39844 2.0625 6.05859 1.42676 4.48633 1.42676C2.3877 1.42676 0.692383 2.51367 0.241211 3.5459V13.8066C0.241211 14.4766 0.678711 14.7363 1.16406 14.7363C1.52637 14.7363 1.73145 14.627 1.96387 14.4561C2.42871 14.0801 3.1875 13.6426 4.48633 13.6426C5.79199 13.6426 6.68066 14.0801 7.07715 14.415C7.2959 14.5791 7.54883 14.7363 8 14.7363C8.45117 14.7363 8.69727 14.5654 8.92285 14.415C9.34668 14.1006 10.208 13.6426 11.5137 13.6426C12.8125 13.6426 13.585 14.0869 14.0361 14.4561C14.2686 14.627 14.4736 14.7363 14.8359 14.7363C15.3213 14.7363 15.7588 14.4766 15.7588 13.8066V3.5459C15.3076 2.51367 13.6191 1.42676 11.5137 1.42676C9.94141 1.42676 8.6084 2.0625 8 2.77344ZM1.72461 4.01758C1.90918 3.56641 2.9209 2.80078 4.48633 2.80078C6.05176 2.80078 7.09766 3.57324 7.26172 4.01758V13.0342C6.55762 12.5283 5.55273 12.2549 4.48633 12.2549C3.41309 12.2549 2.41504 12.5283 1.72461 13.0547V4.01758ZM14.2754 4.01758V13.0547C13.585 12.5283 12.5869 12.2549 11.5137 12.2549C10.4473 12.2549 9.44238 12.5283 8.73828 13.0342V4.01758C8.90234 3.57324 9.94824 2.80078 11.5137 2.80078C13.0791 2.80078 14.0908 3.56641 14.2754 4.01758Z"})})},64258:(e,t,o)=>{o.d(t,{p:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("hex",{viewBox:"0 0 92 92",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{fill:"#fff",d:"M0 0h92v92H0z"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.8 34v8.368h-2.4V34H15v24h8.4V46h2.4v12h8.4V34h-8.4Zm10.7995 24h19.2v-9.6h-8.4v6h-2.4V46h10.8V34h-19.2v24Zm8.4-15.6v-4.8h2.4v4.8h-2.4Zm24.0007 0V34h8.4v6l-3.6 4.2 3.6 4.2V58h-8.4V45.968h-2.4V58h-8.4v-9.6l3.6-4.2-3.6-4.2v-6h8.4v8.4h2.4Z",fill:"#473982"})]})})},37250:(e,t,o)=>{o.d(t,{D:()=>a});var n=o(67294),r=o(45238),i=o(85893);const a=(0,r.I)("imageError",{viewBox:"0 0 32 32",svg:(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("path",{d:"M6.39515 31.0485c3.44161 0 6.29115-2.8495 6.29115-6.2911 0-3.4355-2.8557-6.2912-6.29732-6.2912-3.43544 0-6.28495 2.8557-6.28495 6.2912 0 3.4416 2.85568 6.2911 6.29112 6.2911zm-.00617-5.366c-.32689 0-.50575-.1912-.51809-.5181l-.08635-3.0468c-.01233-.3393.24671-.5798.59828-.5798.34539 0 .61677.2467.60444.5859l-.09252 3.0407c-.01233.3331-.1912.5181-.50576.5181zm0 2.2698c-.35773 0-.69078-.2838-.69078-.6662s.32689-.6661.69078-.6661c.3639 0 .69079.2776.69079.6661 0 .3886-.33305.6662-.69079.6662z"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 17.5539V3h26v26H12.6862c.4113-.6095.7364-1.282.9578-2H28v-4H13.7749c-.1687-.7106-.4373-1.3825-.7902-2H28V5H6v12.1798c-.69548.0352-1.36626.164-2 .3741zM11.3329 19c-.6875-.5905-1.48192-1.0601-2.35027-1.3757L13 12l2 1 5-5 6 11H11.3329zM12 9c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm3.395 6.434l-1.76-.881L11.887 17h10.744l-3.107-5.695-4.129 4.129z"})]})})},44495:(e,t,o)=>{o.d(t,{D:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("info",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M7.97266 14.9453C11.7871 14.9453 14.9453 11.7803 14.9453 7.97266C14.9453 4.1582 11.7803 1 7.96582 1C4.1582 1 1 4.1582 1 7.97266C1 11.7803 4.16504 14.9453 7.97266 14.9453ZM7.97266 13.7832C4.74609 13.7832 2.16895 11.1992 2.16895 7.97266C2.16895 4.74609 4.73926 2.16211 7.96582 2.16211C11.1924 2.16211 13.7764 4.74609 13.7832 7.97266C13.79 11.1992 11.1992 13.7832 7.97266 13.7832ZM7.91113 5.53906C8.41016 5.53906 8.7998 5.14258 8.7998 4.64355C8.7998 4.14453 8.41016 3.74805 7.91113 3.74805C7.41895 3.74805 7.02246 4.14453 7.02246 4.64355C7.02246 5.14258 7.41895 5.53906 7.91113 5.53906ZM6.77637 11.7324H9.55859C9.83887 11.7324 10.0576 11.5273 10.0576 11.2471C10.0576 10.9805 9.83887 10.7686 9.55859 10.7686H8.71094V7.28906C8.71094 6.91992 8.52637 6.67383 8.17773 6.67383H6.89258C6.6123 6.67383 6.39355 6.88574 6.39355 7.15234C6.39355 7.43262 6.6123 7.6377 6.89258 7.6377H7.62402V10.7686H6.77637C6.49609 10.7686 6.27734 10.9805 6.27734 11.2471C6.27734 11.5273 6.49609 11.7324 6.77637 11.7324Z"})})},48964:(e,t,o)=>{o.d(t,{v:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("invision",{viewBox:"0 0 215 182",svg:(0,r.jsxs)("g",{stroke:"none",strokeWidth:"1",children:[" ",(0,r.jsxs)("g",{transform:"translate(0.000000, -222.000000)",children:[" ",(0,r.jsxs)("g",{children:[" ",(0,r.jsx)("path",{d:"M98.9196618,401.249534 L67.23738,401.249534 C69.0283748,394.069758 70.787323,387.019973 72.4415558,380.387695 C68.8636285,384.425558 65.4170469,389.032134 61.2582199,392.866884 C50.6503674,402.647395 38.1012175,405.941417 24.0797327,402.23079 C13.9819165,399.55829 7.92421985,391.917675 6.61663119,381.562133 C5.46837247,372.464529 7.41824578,363.782628 9.57890401,355.080416 C13.7219334,338.391847 17.8017725,321.687933 21.9028255,304.989434 C22.0454551,304.409889 22.1339216,303.817254 22.2995706,302.96283 L-0.0003,302.96283 C2.30975824,294.403698 4.53721769,286.151943 6.78995327,277.806756 L60.5229552,277.806756 C60.3491817,278.642223 60.2273147,279.357627 60.0512844,280.059943 C53.0231647,308.023022 45.9535198,335.97572 39.0057421,363.95911 C38.1427426,367.435481 37.6331576,371.059899 37.479244,374.638277 C37.2535643,379.877659 40.2013936,382.783512 45.4935844,382.824134 C53.5440336,382.885068 60.4588621,379.769784 66.3955944,374.554776 C72.743064,368.979131 77.1564578,362.201967 79.1663619,353.808936 C83.0828089,337.452117 87.2971531,321.167064 91.379249,304.850416 C91.5232327,304.276286 91.5715282,303.678686 91.6933952,302.909569 L69.2513464,302.909569 C69.6155936,301.479211 69.9089773,300.269116 70.2316994,299.067145 C71.9843286,292.540938 73.758623,286.020597 75.4882328,279.488522 C75.7789084,278.389461 76.0555918,277.645621 77.5008451,277.651037 C92.8448135,277.709714 108.18833,277.692562 123.531847,277.702492 C123.75166,277.702492 123.97102,277.781931 124.411096,277.867238 C122.458966,286.803255 120.511801,295.717606 118.565087,304.631958 C118.656261,304.671226 118.747887,304.710043 118.838611,304.749311 C120.277996,302.605804 121.639297,300.404524 123.17076,298.328721 C129.752485,289.408051 137.659853,281.997178 148.043831,277.728671 C168.022811,269.515732 188.005402,280.685076 192.142563,302.283534 C193.975534,311.851454 193.064691,321.305631 190.553778,330.628914 C187.175803,343.16994 183.622249,355.664024 180.318748,368.224458 C179.661569,370.722733 179.467484,373.448493 179.624106,376.035235 C179.988804,382.073072 185.463796,384.737899 190.442292,381.268749 C192.360119,379.932273 194.120421,378.060937 195.308399,376.052387 C197.438816,372.450086 199.08989,368.563429 200.922861,364.787355 C201.278532,364.054347 201.552056,363.281168 201.937066,362.346854 C206.06836,363.936993 210.106223,365.491476 214.381049,367.137584 C210.178891,380.337594 205.268551,393.058261 192.248181,399.864312 C181.021966,405.732889 169.389528,405.395272 158.535233,398.5987 C151.013326,393.889214 148.484358,386.186312 148.027131,377.697592 C147.620005,370.133709 149.656088,362.968376 151.693976,355.800786 C154.30148,346.629159 157.031754,337.485517 159.315182,328.232646 C160.272516,324.353211 160.657977,320.20973 160.534756,316.210233 C160.26394,307.425422 153.949871,301.479211 145.147908,301.094201 C135.701404,300.681207 128.636273,304.704626 123.601357,312.562796 C119.514296,318.940958 117.721496,326.162711 115.917863,333.384916 C110.367494,355.603993 104.804488,377.819911 99.2455434,400.036731 C99.157077,400.390597 99.0564238,400.741303 98.9196618,401.249534 Z M28.7006165,241.023028 C28.6658618,230.356047 37.1446512,221.982425 47.9637399,222.000028 C58.6717942,222.017631 67.1365914,230.335285 67.169992,240.873176 C67.2033927,251.467488 58.5991253,259.984192 47.8874602,259.958916 C37.2349231,259.934091 28.7349198,251.545573 28.7006165,241.023028 Z"})," "]})," "]})," "]})})},90199:(e,t,o)=>{o.d(t,{b:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("locked",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M4.79395 14.7227H11.1992C12.252 14.7227 12.7783 14.1963 12.7783 13.0479V8.20801C12.7783 7.19629 12.3682 6.66992 11.541 6.56055V4.96094C11.541 2.36328 9.81152 1.1123 7.99316 1.1123C6.18164 1.1123 4.45215 2.36328 4.45215 4.96094V6.56055C3.625 6.66992 3.21484 7.19629 3.21484 8.20801V13.0479C3.21484 14.1963 3.73438 14.7227 4.79395 14.7227ZM5.75098 4.83105C5.75098 3.22461 6.76953 2.35645 7.99316 2.35645C9.2168 2.35645 10.2422 3.22461 10.2422 4.83105V6.54004H5.75098V4.83105ZM4.99219 13.5059C4.69141 13.5059 4.54102 13.3623 4.54102 13V8.25586C4.54102 7.89355 4.69141 7.76367 4.99219 7.76367H11.0078C11.3086 7.76367 11.4521 7.89355 11.4521 8.25586V13C11.4521 13.3623 11.3086 13.5059 11.0078 13.5059H4.99219Z"})})},97485:(e,t,o)=>{o.d(t,{p:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("loom",{viewBox:"0 0 190 190",svg:(0,r.jsx)("path",{d:"M189.611 84.2622H134.166L182.184 56.539L171.639 38.2692L123.621 65.9923L151.338 17.9781L133.068 7.42678L105.351 55.4409V0H84.2598V55.4462L56.5322 7.42678L38.2681 17.9728L65.9904 65.987L17.9723 38.2692L7.42658 56.5337L55.4447 84.2569H0V105.349H55.4394L7.42658 133.072L17.9723 151.342L65.9851 123.624L38.2628 171.638L56.5322 182.184L84.2545 134.165V189.611H105.346V134.17L133.063 182.184L151.332 171.638L123.61 123.619L171.628 151.342L182.174 133.072L134.161 105.354H189.6V84.2622H189.611ZM94.8055 123.491C78.9021 123.491 66.0116 110.601 66.0116 94.6968C66.0116 78.7929 78.9021 65.9021 94.8055 65.9021C110.709 65.9021 123.599 78.7929 123.599 94.6968C123.599 110.601 110.709 123.491 94.8055 123.491Z"})})},81822:(e,t,o)=>{o.d(t,{h:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("maps",{viewBox:"0 0 160 164",svg:(0,r.jsxs)("g",{children:[" ",(0,r.jsx)("polyline",{points:"16 163.155 76.159 103 136.314 163.155 16 163.155"})," ",(0,r.jsx)("path",{d:"M91.1523093,12 C89.1061243,15.5558234 87.6020864,19.4206238 86.7688642,23.441 C84.8448642,33.084 86.5958642,43.241 91.3038642,51.836 C91.8382207,52.8588753 92.3925227,53.8704894 92.9644441,54.8718184 L0,147.839 L0,24.942 C0,17.799 5.796,12 12.942,12 L91.1523093,12 L91.1523093,12 Z M27.8186945,28.8787927 C20.9826945,31.9947927 15.9026945,38.8067927 15.1686945,46.3227927 C13.7376945,56.9777927 21.5856945,67.7337927 32.0706945,69.9057927 C40.5536945,71.9007927 50.5746945,68.4527927 54.8196945,60.5497927 C57.5256945,56.1347927 57.8816945,50.7917927 57.3626945,45.7587927 C50.5816945,45.0857927 43.5296945,45.6577927 36.6486945,45.4797927 C36.5946945,48.0237927 36.6096945,50.5677927 36.7256945,53.1037927 C40.8396945,53.0417927 44.9526945,53.0807927 49.0736945,53.0727927 C47.8296945,58.9497927 41.9446945,62.9007927 36.0456945,62.2127927 C27.0296945,62.0967927 20.6586945,51.4727927 24.4936945,43.3927927 C27.4236945,35.1807927 39.1766945,32.2347927 45.4326945,38.4437927 C47.4426945,36.5027927 49.4526945,34.5547927 51.4096945,32.5597927 C45.1536945,26.7907927 35.5196945,25.3527927 27.8186945,28.8787927 Z"})," ",(0,r.jsx)("path",{d:"M124.80036,20.6120969 C120.325021,21.6105482 116.569675,25.5689693 116.191987,30.2012296 C115.721991,34.5142624 118.24735,38.8911407 122.112695,40.7949674 C126.304191,43.0118678 131.806442,42.332644 135.307176,39.1288306 C138.574835,36.2380909 139.764822,31.2458343 138.057917,27.2058756 C136.037937,22.1505427 130.041845,19.2713414 124.80036,20.6120969 Z M129.322621,0 C138.754833,0.539994477 147.978584,5.14840888 153.696218,12.7298698 C157.440026,17.5182824 159.529236,23.4620677 160,29.4989291 L160,31.7396754 C159.779233,43.4418634 152.290848,53.047919 145.807068,62.1501336 C138.528681,72.435413 131.801058,83.6445291 129.937231,96.3213226 C129.438005,98.4697621 129.034302,102.445875 127.470333,102.445875 C124.80036,102.3677 123.210376,86.842958 120.185792,80.3707165 C116.755058,72.8300244 111.978183,66.0154787 107.125156,59.3463161 C104.17134,55.3471262 101.384446,51.2079378 99.0798538,46.7964445 C95.4583524,40.1849736 94.1114431,32.3719766 95.591428,24.9543602 C96.8052617,19.097497 99.8698458,13.6698602 104.112879,9.47298004 C109.830513,3.88303721 117.561972,0.499225663 125.538045,0 L129.322621,0 Z"})," ",(0,r.jsx)("path",{d:"M151.652474,72 L151.652474,148.672145 C135.535571,132.464045 127.553192,124.419378 127.705338,124.538145 C131.041338,123.277145 130.263338,119.369145 130.912338,116.576145 C133.335338,100.096145 142.081338,85.5241452 151.543338,72.1531452 C151.579693,72.102109 151.616072,72.0510607 151.652474,72 Z"})," ",(0,r.jsx)("path",{d:"M106.040648,74 L92,88.0399478 L125.952845,121.992793 C123.906994,113.374953 121.723258,103.970177 117.61803,95.9459594 C114.174293,88.3766869 110.811044,80.7912134 106.040648,74 Z"})," "]})})},15289:(e,t,o)=>{o.d(t,{M:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("miro",{viewBox:"0 0 32 32",svg:(0,r.jsx)("path",{d:"M13.75 20.895l1.761.359v-7.82l-1.76.344v7.117zm4.604-4.28v4.28l1.761.359V16.88c0-.993.56-1.441 1.432-1.607l1.015-.186v-1.835l-1.015.164c-1.935.44-3.193 1.073-3.193 3.197zm-7.446-.256c0-2.313-1.539-3.085-2.777-3.068-.984.014-1.785.423-2.265 1.047-.478-.685-1.325-1.068-2.016-1.068-.85 0-1.597.373-2.09.97v-.806L0 13.778v7.117l1.76.359v-4.895c0-.776.568-1.328 1.418-1.328.836 0 1.403.552 1.403 1.328v4.536l1.76.359v-4.895c0-.776.568-1.328 1.404-1.328.835 0 1.402.552 1.402 1.328v4.536l1.76.359v-4.895h.001zm17.176 5.059c2.356 0 3.916-1.636 3.916-4.081 0-2.446-1.56-4.067-3.916-4.067-2.446 0-4.082 1.62-4.082 4.067 0 2.445 1.636 4.08 4.082 4.08zm0-1.65c-1.366 0-2.281-.976-2.281-2.431 0-1.456.915-2.416 2.281-2.416 1.275 0 2.115.96 2.115 2.416 0 1.455-.84 2.43-2.115 2.43zm-13.416-7.552c.641 0 1.065-.445 1.065-1.11S15.31 10 14.668 10c-.665 0-1.11.44-1.11 1.106 0 .665.445 1.11 1.11 1.11"})})},78810:(e,t,o)=>{o.d(t,{n:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("mixpanel",{viewBox:"0 0 101 106",svg:(0,r.jsx)("g",{children:(0,r.jsx)("path",{d:"M31.008 41.412h13.385c-3.342-2.09-4.593-5.021-6.272-10.454l-5.022-18.613C30.803 3.982 28.918.005 19.714.005H.484v5.022H3.21c5.639 0 6.273 2.091 7.952 8.364l4.387 16.315c2.297 7.952 5.861 11.706 15.476 11.706h-.016zm30.968 0h13.37c9.614 0 12.956-3.77 15.27-11.706l4.387-16.315c1.679-6.273 2.502-8.364 7.952-8.364h2.724V.006H86.655c-9.41 0-11.294 3.77-13.385 12.34l-5.02 18.611c-1.68 5.639-2.93 8.363-6.273 10.454zM44.393 58.963h17.584l-.001-17.55H44.393v17.55zM.484 100.369h19.23c9.204 0 11.088-3.976 13.385-12.34l5.022-18.611c1.679-5.434 2.93-8.364 6.272-10.455H31.008c-9.615 0-13.179 3.77-15.475 11.706l-4.388 16.315c-1.68 6.273-2.297 8.364-7.952 8.364H.484v5.021zm86.14 0h19.023v-5.021h-2.724c-5.433 0-6.273-2.091-7.952-8.364L90.583 70.67c-2.296-7.952-5.639-11.706-15.27-11.706H61.976c3.343 2.091 4.546 4.816 6.225 10.455l5.022 18.612c2.09 8.57 3.975 12.339 13.385 12.339h.015z"})})})},41898:(e,t,o)=>{o.d(t,{d:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("overlap",{viewBox:"0 0 20 20",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M4.917 14.496h1.729v-1.1H4.93c-.342 0-.604-.091-.786-.274-.182-.182-.273-.45-.273-.806V5.52c0-.356.09-.625.273-.807.182-.182.444-.273.786-.273h6.83c.336 0 .596.09.779.273.186.182.28.451.28.807v1.497h1.1V5.459c0-.702-.18-1.23-.54-1.586-.355-.355-.888-.533-1.6-.533H4.918c-.716 0-1.254.178-1.614.533-.355.351-.533.88-.533 1.586v6.918c0 .707.178 1.237.533 1.593.36.35.898.526 1.614.526zm3.315 3.165h6.863c.711 0 1.244-.177 1.6-.533.36-.355.54-.884.54-1.586V8.624c0-.702-.18-1.23-.54-1.586-.356-.355-.889-.533-1.6-.533H8.232c-.716 0-1.253.178-1.613.533-.356.351-.534.88-.534 1.586v6.918c0 .707.178 1.235.534 1.586.36.356.897.533 1.613.533zm.014-1.1c-.342 0-.604-.091-.787-.274-.182-.182-.273-.45-.273-.806V8.686c0-.356.091-.625.273-.807.183-.182.445-.273.787-.273h6.829c.337 0 .597.09.779.273.187.182.28.451.28.807v6.795c0 .355-.093.624-.28.806-.182.183-.442.274-.78.274H8.247z"}),(0,r.jsx)("path",{d:"M13.976 12.448l-1.832 1.36c-.192.147-.379.183-.561.11-.182-.073-.273-.225-.273-.458v-.848H9.7a.533.533 0 01-.383-.15.521.521 0 01-.157-.383c0-.145.053-.27.157-.376s.233-.157.383-.157h1.61v-.827c0-.246.093-.401.28-.465.187-.068.371-.034.554.103l1.832 1.374a.43.43 0 01.184.362.423.423 0 01-.184.356z"})]})})},87292:(e,t,o)=>{o.d(t,{B:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("pdf",{viewBox:"0 0 42 42",svg:(0,r.jsx)("path",{d:"M6,3 L36,3 C37.6569,3 39,4.34326 39,6 L39,36 C39,37.6567 37.6569,39 36,39 L6,39 C4.34314,39 3,37.6567 3,36 L3,6 C3,4.34326 4.34314,3 6,3 Z M12.3916324,17.6692964 C12.6740492,17.8831067 12.8153869,18.2406755 12.8153869,18.7423682 C12.8153869,19.2441828 12.6740492,19.6106452 12.3916324,19.8417552 C12.1138709,20.0728653 11.7225736,20.188603 11.21787,20.188603 L9.22452987,20.188603 L9.22452987,17.3486418 L11.21787,17.3486418 C11.7225736,17.3486418 12.1138709,17.4553642 12.3916324,17.6692964 Z M14.0168221,21.143866 C14.6280786,20.6727524 14.9336421,19.8679485 14.9336421,18.7293325 C14.9336421,17.6868398 14.6280786,16.9167572 14.0168221,16.4194503 C13.4056949,15.9221434 12.5861173,15.6734899 11.5582184,15.6734899 L7.09921423,15.6734899 L7.09921423,25.3187101 L9.22452987,25.3187101 L9.22452987,21.8505974 L11.3983891,21.8505974 C12.5328408,21.8505974 13.4056949,21.6151015 14.0168221,21.143866 Z M19.3259732,23.6435582 L19.3259732,17.3486418 L21.2984941,17.3486418 C22.2709182,17.3486418 22.9191579,17.6125239 23.243213,18.14041 C23.5719234,18.6639102 23.7364079,19.4164494 23.7364079,20.3979056 C23.7364079,21.1091447 23.6275275,21.7218239 23.4098958,22.2366742 C23.0117451,23.1745156 22.3079014,23.6435582 21.2984941,23.6435582 L19.3259732,23.6435582 Z M23.243213,15.8829144 C22.8219155,15.7520698 22.294065,15.6821398 21.6596618,15.6734899 L17.2493564,15.6734899 L17.2493564,25.3187101 L21.6596618,25.3187101 C23.2062299,25.3187101 24.3498627,24.718823 25.0906895,23.5191705 C25.6371608,22.6293298 25.9102672,21.5431004 25.9102672,20.2604823 C25.9102672,19.7546473 25.845482,19.2221317 25.7157824,18.6639102 C25.586212,18.1055668 25.343106,17.5863307 24.9865936,17.1065672 C24.5420199,16.513137 23.9608931,16.1053745 23.243213,15.8829144 Z M35.4978258,15.6865256 L28.2398178,15.6865256 L28.2398178,25.3187101 L30.3650558,25.3187101 L30.3650558,21.2748324 L34.8587673,21.2748324 L34.8587673,19.5996805 L30.3650558,19.5996805 L30.3650558,17.3814139 L35.4978258,17.3814139 L35.4978258,15.6865256 Z"})})},17683:(e,t,o)=>{o.d(t,{Q:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("peekModeCenter",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM4.33594 11.0654H11.6504C12.0742 11.0654 12.2588 10.8809 12.2588 10.4502V5.69238C12.2588 5.25488 12.0742 5.07715 11.6504 5.07715H4.33594C3.91211 5.07715 3.72754 5.25488 3.72754 5.69238V10.4502C3.72754 10.8809 3.91211 11.0654 4.33594 11.0654Z"})})},31490:(e,t,o)=>{o.d(t,{M:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("peekModeFull",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM2.77734 12.1113H13.2158C13.5645 12.1113 13.7559 11.9131 13.7559 11.5645V4.57812C13.7559 4.22949 13.5645 4.02441 13.2158 4.02441H2.77734C2.42871 4.02441 2.2373 4.22949 2.2373 4.57812V11.5645C2.2373 11.9131 2.42871 12.1113 2.77734 12.1113Z"})})},32240:(e,t,o)=>{o.d(t,{y:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("peekModeSide",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM8.51953 12.1113H13.2158C13.5986 12.1113 13.7559 11.9541 13.7559 11.5645V4.57812C13.7559 4.18848 13.5986 4.02441 13.2158 4.02441H8.51953C8.13672 4.02441 7.98633 4.18848 7.98633 4.57812V11.5645C7.98633 11.9541 8.13672 12.1113 8.51953 12.1113Z"})})},25651:(e,t,o)=>{o.d(t,{R:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("pencil",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M3.926 13.307H14.11c.183 0 .34-.066.472-.199a.644.644 0 00.198-.471.652.652 0 00-.198-.479.644.644 0 00-.472-.198H5.272l-1.346 1.347zm-.704-.636l7.683-7.684-1.312-1.319-7.69 7.684-.67 1.606c-.037.1-.017.191.06.273.083.082.174.105.274.069l1.655-.63zm8.34-8.326l.738-.732c.182-.187.278-.376.287-.567.009-.192-.068-.374-.232-.547l-.267-.267c-.169-.168-.351-.246-.547-.232-.196.014-.385.11-.567.287l-.739.732 1.327 1.326z"})})},44597:(e,t,o)=>{o.d(t,{U:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("picture",{viewBox:"0 0 30 30",svg:(0,r.jsx)("path",{d:"M1,4v22h28V4H1z M27,24H3V6h24V24z M18,10l-5,6l-2-2l-6,8h20L18,10z M11.216,17.045l1.918,1.918l4.576-5.491L21.518,20H9 L11.216,17.045z M7,12c1.104,0,2-0.896,2-2S8.104,8,7,8s-2,0.896-2,2S5.896,12,7,12z"})})},87111:(e,t,o)=>{o.d(t,{I:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("play",{viewBox:"0 0 14 16",svg:(0,r.jsx)("path",{d:"M1.34699 16C1.73805 16 2.07697 15.8756 2.52017 15.6089L12.8703 9.47556C13.6437 9.01333 14 8.62222 14 8C14 7.37778 13.6437 6.98667 12.8703 6.52444L2.52017 0.391111C2.07697 0.133333 1.73805 0 1.34699 0C0.582247 0 0 0.595556 0 1.57333V14.4356C0 15.4044 0.582247 16 1.34699 16Z"})})},59401:(e,t,o)=>{o.d(t,{K:()=>a});var n=o(67294),r=o(45238),i=o(85893);const a=(0,r.I)("playbackError",{viewBox:"0 0 32 32",svg:(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)("path",{d:"M6.39515 29.0485c3.44161 0 6.29115-2.8495 6.29115-6.2911 0-3.4355-2.8557-6.2912-6.29732-6.2912-3.43544 0-6.28495 2.8557-6.28495 6.2912 0 3.4416 2.85568 6.2911 6.29112 6.2911zm-.00617-5.366c-.32689 0-.50575-.1912-.51809-.5181l-.08635-3.0468c-.01233-.3393.24671-.5798.59828-.5798.34539 0 .61677.2467.60444.5859l-.09252 3.0407c-.01233.3331-.1912.5181-.50576.5181zm0 2.2698c-.35773 0-.69078-.2838-.69078-.6662s.32689-.6661.69078-.6661c.3639 0 .69079.2776.69079.6661 0 .3886-.33306.6662-.69079.6662z"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M29.1373 16.1987c0 6.7017-5.542 12.2437-12.2436 12.2437-1.622 0-3.1761-.3246-4.6001-.9118.3323-.4107.6226-.8567.8644-1.3316 1.1612.4325 2.4197.6687 3.7357.6687 5.9082 0 10.6689-4.7608 10.6689-10.669-.0122-5.9082-4.7729-10.65671-10.6812-10.65671-5.5497 0-10.08288 4.20726-10.5961 9.62871-.55173.0075-1.08925.0738-1.60656.193.4362-6.32082 5.78156-11.40862 12.20266-11.40862 6.7139 0 12.2559 5.54199 12.2559 12.24362zm-15.4585 4.4372a7.628 7.628 0 00-.0797-.2566.65573.65573 0 01-.0013-.0424v-8.2764c0-.5004.5859-.7202 1.0498-.4516l6.7016 4.0161c.4395.2686.4517.8911 0 1.1597l-6.7016 3.9917c-.3763.2257-.796.1398-.9688-.1405z"})]})})},47453:(e,t,o)=>{o.d(t,{R:()=>i,s:()=>r});o(67294);var n=o(45238);const r=(0,o(85893).jsx)("path",{d:"M7.977 14.963c.407 0 .747-.324.747-.723V8.72h5.362c.399 0 .74-.34.74-.747a.746.746 0 00-.74-.738H8.724V1.706c0-.398-.34-.722-.747-.722a.732.732 0 00-.739.722v5.529h-5.37a.746.746 0 00-.74.738c0 .407.341.747.74.747h5.37v5.52c0 .399.332.723.739.723z"}),i=(0,n.I)("plus",{viewBox:"0 0 16 16",svg:r})},36067:(e,t,o)=>{o.d(t,{J:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("replit",{viewBox:"0 0 793.8 871.5",svg:(0,r.jsx)("g",{children:(0,r.jsx)("path",{d:"M396.9 356.1H227.2c-16.6 0-30-13.4-30-30v-99.8c0-16.6 13.4-30 30-30h139.7c16.6 0 30 13.4 30 30v129.8zm169.7 159.7H396.9V356.1h169.7c16.5 0 29.9 13.4 29.9 29.9v99.8c0 16.6-13.4 30-29.9 30zM366.9 675.6H227.2c-16.5 0-29.9-13.4-29.9-29.9v-99.8c0-16.5 13.4-29.9 29.9-29.9h169.7v129.8c0 16.3-13.4 29.8-30 29.8z"})})})},18442:(e,t,o)=>{o.d(t,{H:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("settings",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M7.30957 15.4814H8.69043C9.25781 15.4814 9.70215 15.1328 9.83203 14.5928L10.1123 13.3828L10.29 13.3145L11.3428 13.9639C11.8213 14.2646 12.3818 14.1895 12.7783 13.7861L13.7354 12.8291C14.1455 12.4258 14.2139 11.8652 13.9131 11.3936L13.2637 10.3477L13.3252 10.1768L14.5352 9.89648C15.0684 9.75977 15.4238 9.31543 15.4238 8.75488V7.4082C15.4238 6.84766 15.0752 6.40332 14.5352 6.2666L13.3389 5.97949L13.2705 5.80176L13.9199 4.75586C14.2207 4.28418 14.1455 3.73047 13.7422 3.31348L12.7852 2.35645C12.3887 1.95996 11.8281 1.88477 11.3564 2.17871L10.3037 2.82129L10.1123 2.74609L9.83203 1.53613C9.70215 0.996094 9.25781 0.647461 8.69043 0.647461H7.30957C6.73535 0.647461 6.29785 0.996094 6.16797 1.53613L5.8877 2.74609L5.69629 2.82129L4.64355 2.17871C4.16504 1.88477 3.60449 1.95996 3.20801 2.35645L2.25098 3.31348C1.84766 3.73047 1.77246 4.28418 2.07324 4.75586L2.72949 5.80176L2.6543 5.97949L1.46484 6.2666C0.917969 6.40332 0.576172 6.84766 0.576172 7.4082V8.75488C0.576172 9.31543 0.924805 9.75977 1.46484 9.89648L2.66797 10.1768L2.73633 10.3477L2.08008 11.3936C1.7793 11.8652 1.85449 12.4258 2.25781 12.8291L3.21484 13.7861C3.61816 14.1895 4.17871 14.2646 4.65039 13.9639L5.70312 13.3145L5.8877 13.3828L6.16797 14.5928C6.29785 15.1328 6.73535 15.4814 7.30957 15.4814ZM7.47363 14.2441C7.35742 14.2441 7.30273 14.1895 7.28223 14.0869L6.87891 12.4053C6.44141 12.3027 6.03125 12.1318 5.69629 11.9199L4.21973 12.8291C4.1377 12.8838 4.05566 12.877 3.9668 12.7949L3.24219 12.0703C3.16699 11.9951 3.16016 11.9131 3.22168 11.8242L4.13086 10.3477C3.93945 10.0264 3.75488 9.61621 3.65234 9.18555L1.96387 8.78223C1.86133 8.76172 1.81348 8.70703 1.81348 8.59082V7.56543C1.81348 7.44238 1.86133 7.39453 1.96387 7.36719L3.65234 6.9707C3.75488 6.5127 3.95312 6.08887 4.11719 5.79492L3.21484 4.3252C3.15332 4.22949 3.15332 4.14746 3.23535 4.06543L3.95996 3.34766C4.04883 3.27246 4.11719 3.25879 4.21973 3.31348L5.68945 4.20898C5.99707 4.02441 6.44824 3.83301 6.87891 3.72363L7.28223 2.04199C7.30273 1.93945 7.35742 1.88477 7.47363 1.88477H8.52637C8.64258 1.88477 8.69727 1.93262 8.71094 2.04199L9.12109 3.7373C9.56543 3.83984 9.96875 4.02441 10.3037 4.21582L11.7734 3.32031C11.876 3.26562 11.9443 3.27246 12.0264 3.35449L12.7578 4.07227C12.8398 4.14746 12.8398 4.22949 12.7783 4.3252L11.876 5.79492C12.04 6.08887 12.2451 6.5127 12.3477 6.9707L14.0293 7.36719C14.1387 7.39453 14.1865 7.44238 14.1865 7.56543V8.59082C14.1865 8.70703 14.1318 8.76172 14.0293 8.78223L12.3408 9.18555C12.2383 9.61621 12.0537 10.0264 11.8691 10.3477L12.7715 11.8242C12.8262 11.9131 12.8262 11.9951 12.751 12.0635L12.0264 12.7949C11.9375 12.877 11.8555 12.8838 11.7734 12.8291L10.2969 11.9199C9.96191 12.1318 9.57227 12.3027 9.12109 12.4053L8.71094 14.0869C8.69727 14.1963 8.64258 14.2441 8.52637 14.2441H7.47363ZM8 10.6621C9.42188 10.6621 10.5908 9.49316 10.5908 8.06445C10.5908 6.64941 9.42188 5.48047 8 5.48047C6.57812 5.48047 5.40234 6.64941 5.40234 8.06445C5.40234 9.49316 6.57129 10.6621 8 10.6621ZM8 9.49316C7.2207 9.49316 6.57812 8.85059 6.57812 8.06445C6.57812 7.29199 7.2207 6.65625 8 6.65625C8.76562 6.65625 9.40137 7.29199 9.40137 8.06445C9.40137 8.84375 8.76562 9.49316 8 9.49316Z"})})},1436:(e,t,o)=>{o.d(t,{g:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("settingsConnectedApps",{viewBox:"0 0 20 20",svg:(0,r.jsx)("path",{d:"M16.492 3.922C15.695 3.125 14.57 3 13.234 3H7.148c-1.312 0-2.437.125-3.234.922C3.117 4.719 3 5.836 3 7.14v6.03c0 1.337.117 2.446.914 3.243.797.797 1.922.922 3.25.922h6.07c1.336 0 2.461-.125 3.258-.922.797-.797.914-1.906.914-3.242V7.164c0-1.336-.117-2.453-.914-3.242zm-.344 3.023v6.438c0 .812-.101 1.64-.578 2.117-.468.469-1.312.578-2.117.578h-6.5c-.805 0-1.648-.11-2.125-.578-.469-.477-.57-1.305-.57-2.117V6.969c0-.82.101-1.664.57-2.133.477-.477 1.328-.578 2.149-.578h6.476c.805 0 1.649.11 2.117.578.477.476.578 1.305.578 2.11zm-3.492 5.149c.344 0 .57-.266.57-.625V7.78c0-.46-.25-.64-.648-.64h-3.71c-.368 0-.602.226-.602.57s.242.57.617.57h1.422l1.156-.125-1.219 1.133-2.875 2.883a.62.62 0 00-.187.422c0 .351.226.578.57.578.188 0 .336-.07.445-.18l2.875-2.875 1.125-1.203-.117 1.219v1.351c0 .368.227.61.578.61z"})})},56996:(e,t,o)=>{o.d(t,{z:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("sidebarHome",{viewBox:"0 0 20 20",svg:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.54446 3.06854C9.8066 2.84385 10.1934 2.84385 10.4556 3.06854L15.7064 7.56922C16.0832 7.89219 16.3 8.36369 16.3 8.85996V14.6C16.3 15.5389 15.5389 16.3 14.6 16.3H11.75C11.3634 16.3 11.05 15.9866 11.05 15.6V11.7H8.95001V15.6C8.95001 15.9866 8.63661 16.3 8.25001 16.3H5.40001C4.46113 16.3 3.70001 15.5389 3.70001 14.6V8.85996C3.70001 8.36369 3.91687 7.89219 4.29367 7.56922L9.54446 3.06854ZM10 4.52198L5.20477 8.63218C5.13828 8.68918 5.10001 8.77238 5.10001 8.85996V14.6C5.10001 14.7657 5.23433 14.9 5.40001 14.9H7.55001V11.5C7.55001 10.8373 8.08727 10.3 8.75001 10.3H11.25C11.9128 10.3 12.45 10.8373 12.45 11.5V14.9H14.6C14.7657 14.9 14.9 14.7657 14.9 14.6V8.85996C14.9 8.77238 14.8617 8.68918 14.7952 8.63218L10 4.52198Z"})})},31317:(e,t,o)=>{o.d(t,{j:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("sketch",{viewBox:"0 0 46 46",svg:(0,r.jsx)("g",{fillRule:"evenodd",children:(0,r.jsx)("path",{d:"M23.0831783 10.0045301l8.1450351.8960958c.2099814.0231017.4008968.1324906.5270123.3019626l6.0917147 8.1859511c.2137793.2872733.1982297.6847539-.0373384.9544486L23.4296391 36.806161c-.2072579.2372831-.5676296.2616233-.8049127.0543654l-.0543655-.0543654L8.19039805 20.3429882c-.23556813-.2696947-.25111774-.6671753-.03733843-.9544486l6.09171468-8.1859511c.1261155-.169472.3170309-.2788609.5270123-.3019626l8.1450351-.8960958a.76060447.76060447 0 01.1663566 0zm2.0141776 2.4229231c-.0693405-.0648437-.1764661-.0687976-.2504897-.0092454-.081512.0655766-.0939018.1841651-.0276733.2648747l3.8573181 4.7007387c.055083.0671271.085151.1509825.085151.2374739 0 .207984-.1702805.3765884-.3803321.3765884H17.6186701c-.0873512 0-.1720402-.0297721-.2398346-.0843129-.163024-.1311532-.1878035-.3683301-.0553465-.5297494l3.8573181-4.7007387c.0601442-.073295.0561509-.1793661-.0093373-.2480242-.0721132-.0756035-.1924706-.0790085-.2688257-.0076051l-5.750016 5.3771171c-.0774384.0724164-.1819972.1093609-.2882425.1018466-.2095178-.0148182-.3672335-.1950067-.352268-.4024622l.2753824-3.8174045c.0064096-.0888512-.0509385-.1699933-.1374402-.1944648-.1009848-.0285688-.206239.0293302-.2350918.129321L13.1553109 17.98681c-.0869135.3012032-.3194364.539875-.62031.6367138l-2.76499194.8899366c-.07834118.0252148-.13137885.0975058-.13137885.1790711 0 .1039921.08514024.1882942.19016605.1882942h2.66553224c.3250892 0 .6276464.1644528.8021788.4360184L20.3459621 31.28552c.0777639.1209976.2347663.165079.3651002.1025088.1417556-.0680534.2009545-.2370061.1322245-.3773663l-5.0526479-10.3185107c-.0376144-.0768161-.0571558-.1610746-.0571558-.2464434 0-.3119761.2554207-.5648827.5704981-.5648827h13.3920376c.0862174 0 .1713136.0193492.2488932.0565933.2835111.1361069.401909.4740123.2644491.7547328l-5.0526479 10.3185107c-.0631922.129051-.0186726.2845081.1035279.3615065.1329093.0837462.3092182.0449521.3937968-.086649l7.0494549-10.9686759c.1745324-.2715656.4770896-.4360184.8021788-.4360184h2.5849257c.0818532 0 .1545231-.0518618.1804073-.1287503.0332121-.0986555-.0206353-.2052903-.1202715-.2381755l-2.6912281-.888246c-.2977515-.0982735-.5273437-.3357047-.6135671-.6345159l-1.2609059-4.3697316c-.0247148-.0856502-.1066636-.1424338-.196398-.1360873-.1047589.0074091-.1836168.0975033-.176134.2012311l.2753824 3.8174045c.0075889.1051994-.0297228.2087291-.1028592.2854053-.1442263.1512071-.3849411.158017-.5376513.0152103z"})})})},24600:(e,t,o)=>{o.d(t,{P:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("slackLogo",{viewBox:"0 0 16 16",svg:(0,r.jsxs)("g",{children:[(0,r.jsx)("path",{d:"M1.68078 11.7915C2.60586 11.7915 3.36156 11.0358 3.36156 10.1107V8.42993H1.68078C0.755701 8.42993 0 9.18563 0 10.1107C0 11.0358 0.755701 11.7915 1.68078 11.7915Z",fill:"#E01E5A"}),(0,r.jsx)("path",{d:"M5.88928 8.42993C4.9642 8.42993 4.2085 9.18563 4.2085 10.1107V14.3192C4.2085 15.2443 4.9642 16 5.88928 16C6.81436 16 7.57006 15.2443 7.57006 14.3192V10.1107C7.57006 9.18563 6.81436 8.42993 5.88928 8.42993Z",fill:"#E01E5A"}),(0,r.jsx)("path",{d:"M4.2085 1.68078C4.2085 2.60586 4.9642 3.36156 5.88928 3.36156H7.57006V1.68078C7.57006 0.755701 6.81436 0 5.88928 0C4.9642 0 4.2085 0.755701 4.2085 1.68078Z",fill:"#36C5F0"}),(0,r.jsx)("path",{d:"M7.57003 5.88928C7.57003 4.9642 6.81433 4.2085 5.88925 4.2085H1.68078C0.755701 4.2085 0 4.9642 0 5.88928C0 6.81436 0.755701 7.57006 1.68078 7.57006H5.88925C6.81433 7.57006 7.57003 6.81436 7.57003 5.88928Z",fill:"#36C5F0"}),(0,r.jsx)("path",{d:"M10.1107 7.57003C11.0358 7.57003 11.7915 6.81433 11.7915 5.88925V1.68078C11.7915 0.755701 11.0358 0 10.1107 0C9.18563 0 8.42993 0.755701 8.42993 1.68078V5.88925C8.42993 6.81433 9.18563 7.57003 10.1107 7.57003Z",fill:"#2EB67D"}),(0,r.jsx)("path",{d:"M14.3192 4.2085C13.3941 4.2085 12.6384 4.9642 12.6384 5.88928V7.57006H14.3192C15.2443 7.57006 16 6.81436 16 5.88928C16 4.9642 15.2443 4.2085 14.3192 4.2085Z",fill:"#2EB67D"}),(0,r.jsx)("path",{d:"M8.42993 10.1107C8.42993 11.0358 9.18563 11.7915 10.1107 11.7915H14.3192C15.2443 11.7915 16 11.0358 16 10.1107C16 9.18563 15.2443 8.42993 14.3192 8.42993H10.1107C9.18563 8.42993 8.42993 9.18563 8.42993 10.1107Z",fill:"#ECB22E"}),(0,r.jsx)("path",{d:"M11.7915 14.3192C11.7915 13.3941 11.0358 12.6384 10.1107 12.6384H8.42993V14.3192C8.42993 15.2443 9.18563 16 10.1107 16C11.0358 16 11.7915 15.2443 11.7915 14.3192Z",fill:"#ECB22E"})]})})},11751:(e,t,o)=>{o.d(t,{t:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("sparkles",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.2757 4.82358C7.57934 4.71847 7.57934 4.53161 7.2757 4.41483L5.62905 3.78419C5.33709 3.67908 4.99842 3.3404 4.88164 3.03676L4.25101 1.39009C4.1459 1.08644 3.95905 1.08644 3.84226 1.39009L3.21163 3.03676C3.10653 3.32872 2.76786 3.6674 2.46422 3.78419L0.817572 4.41483C0.513934 4.51994 0.513934 4.70679 0.817572 4.82358L2.46422 5.45422C2.75618 5.55933 3.09485 5.898 3.21163 6.20165L3.84226 7.84832C3.94737 8.15196 4.13422 8.15196 4.25101 7.84832L4.88164 6.20165C4.98674 5.90968 5.32541 5.571 5.62905 5.45422L7.2757 4.82358ZM15.2991 10.5929C16.2334 10.3593 16.2334 9.9739 15.2991 9.74032L13.2321 9.22647C12.2978 8.9929 11.3402 8.03526 11.1066 7.10097L10.5928 5.03387C10.3592 4.09959 9.97382 4.09959 9.74025 5.03387L9.2264 7.10097C8.99283 8.03526 8.03521 8.9929 7.10094 9.22647L5.03387 9.74032C4.09961 9.9739 4.09961 10.3593 5.03387 10.5929L7.10094 11.1067C8.03521 11.3403 8.99283 12.2979 9.2264 13.2322L9.74025 15.2993C9.97382 16.2336 10.3592 16.2336 10.5928 15.2993L11.1066 13.2322C11.3402 12.2979 12.2978 11.3403 13.2321 11.1067L15.2991 10.5929Z"})})},95855:(e,t,o)=>{o.d(t,{z:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("speechBubble",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M4.32 15.424c.39 0 .677-.192 1.149-.609l2.344-2.064h4.116c2.057 0 3.213-1.19 3.213-3.22V4.22c0-2.03-1.156-3.22-3.213-3.22H3.213C1.163 1 0 2.19 0 4.22V9.53c0 2.037 1.196 3.22 3.165 3.22h.28v1.675c0 .608.322.998.875.998zm.342-1.531v-1.949c0-.403-.178-.56-.56-.56H3.26c-1.285 0-1.9-.65-1.9-1.894V4.26c0-1.243.615-1.893 1.9-1.893h8.627c1.278 0 1.893.65 1.893 1.894v5.23c0 1.243-.615 1.893-1.893 1.893h-4.15c-.417 0-.622.068-.909.369l-2.167 2.14z"})})},87784:(e,t,o)=>{o.d(t,{s:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("splitView",{viewBox:"0 0 24 20",svg:(0,r.jsx)("path",{d:"M13.456 11.143V2.864c0-1.476-.766-2.242-2.222-2.242H2.915C1.452.622.693 1.388.693 2.864v8.278c0 1.477.76 2.243 2.222 2.243h8.32c1.462 0 2.221-.766 2.221-2.242zm-1.34-.083c0 .636-.335.985-.998.985H3.024c-.663 0-.99-.349-.99-.985V7.663h10.082v3.397zM2.033 2.946c0-.629.328-.984.991-.984h8.094c.663 0 .998.355.998.984v3.405H2.033V2.946z"})})},65153:(e,t,o)=>{o.d(t,{n:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("sub",{viewBox:"0 0 30 30",svg:(0,r.jsx)("path",{d:"M5 3V20H23.187L19.594 16.406L21 15L27 21L21 27L19.594 25.594L23.187 22H3V3H5Z"})})},60291:(e,t,o)=>{o.d(t,{b:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("sync",{viewBox:"0 0 30 30",svg:(0,r.jsx)("path",{d:"M27.93 13.81h-1.54c-.606-5.717-5.536-10.265-11.387-10.265-3.425 0-6.514 1.55-8.625 3.987-.427.483-.37 1.078.079 1.392.438.315.965.214 1.336-.202a9.57 9.57 0 017.21-3.268 9.503 9.503 0 019.456 8.356h-1.673c-.798 0-1 .539-.573 1.156l2.516 3.583c.359.516.898.528 1.269 0l2.504-3.572c.45-.628.236-1.167-.573-1.167zM2.064 16.202h1.55c.607 5.716 5.526 10.253 11.388 10.253 3.425 0 6.525-1.561 8.636-3.987.416-.483.36-1.09-.078-1.404-.438-.314-.977-.202-1.337.214-1.74 2.01-4.324 3.268-7.221 3.268a9.496 9.496 0 01-9.467-8.344H7.22c.798 0 1-.55.573-1.157l-2.516-3.583c-.359-.516-.898-.527-1.269 0l-2.515 3.572c-.438.617-.236 1.168.572 1.168z"})})},77734:(e,t,o)=>{o.d(t,{s:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("tableHeaderColumn",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M13.7847 14H2.21528C0.756437 14 0 13.2862 0 11.9164V4.0836C0 2.7074 0.756437 2 2.21528 2H13.7847C15.2436 2 16 2.71383 16 4.0836V11.9164C16 13.2862 15.2436 14 13.7847 14ZM14.6762 4.19293C14.6762 3.56913 14.325 3.25402 13.7037 3.25402H7V5.60772H14.6762V4.19293ZM7 6.81672V9.18328H14.6762V6.81672H7ZM13.7037 12.7395C14.325 12.7395 14.6762 12.4309 14.6762 11.8071V10.3923H7V12.7395H13.7037Z"})})},73599:(e,t,o)=>{o.d(t,{f:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("tableHeaderRow",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M13.7847 14H2.21528C0.756437 14 0 13.2862 0 11.9164V4.0836C0 2.7074 0.756437 2 2.21528 2H13.7847C15.2436 2 16 2.71383 16 4.0836V11.9164C16 13.2862 15.2436 14 13.7847 14ZM1.32377 6.81672V9.18328H7.34825V6.81672H1.32377ZM8.645 6.81672V9.18328H14.6762V6.81672H8.645ZM1.32377 11.8071C1.32377 12.4309 1.66821 12.7395 2.29633 12.7395H7.34825V10.3923H1.32377V11.8071ZM13.7037 12.7395C14.325 12.7395 14.6762 12.4309 14.6762 11.8071V10.3923H8.645V12.7395H13.7037Z"})})},63003:(e,t,o)=>{o.d(t,{f:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("tex",{viewBox:"0 0 32 21",svg:(0,r.jsxs)("g",{children:[" ",(0,r.jsxs)("g",{id:"d7fc5246-3c04-467c-8f25-6c129c5642ac","data-name":"tex",children:[" ",(0,r.jsxs)("g",{id:"ec363c67-067d-4da0-8c27-f8d029e068bd","data-name":"E",children:[" ",(0,r.jsx)("path",{id:"e1948427-1829-4c96-a9f4-14a99a3d5b97","data-name":"path0 fill",d:"M497.33,497.82c-1.2,0-2.11-.06-3-0.06a0.5,0.5,0,0,0-.55.27c0,0.15.17,0.23,0.57,0.32a1.08,1.08,0,0,1,1.06,1.23c0,0.55,0,1,0,3.32s-0.08,4.43-.13,5.21c-0.08,1-.42,1.2-1.39,1.41a0.59,0.59,0,0,0-.53.32c0,0.21.23,0.25,0.59,0.25,0.7,0,1.08-.09,2.13-0.09,2.76,0,6,.13,6.21.13a0.7,0.7,0,0,0,.36-0.21,14.63,14.63,0,0,0,.68-2.07c0-.21,0-0.53-0.15-0.53a0.78,0.78,0,0,0-.48.55,2.41,2.41,0,0,1-1.54,1.41,9,9,0,0,1-1.8.15,10.57,10.57,0,0,1-1.69-.13,0.74,0.74,0,0,1-.38-0.44,7,7,0,0,1-.15-1.56c0-.78,0-2.49.06-2.93a0.26,0.26,0,0,1,.17-0.17c0.53,0,1.29,0,1.9,0,1.06,0.06,1.18.13,1.44,1a0.52,0.52,0,0,0,.32.4c0.15,0,.23-0.19.23-0.53s-0.06-.68-0.06-1.2,0-.84.06-1.35c0-.17,0-0.46-0.17-0.46a0.54,0.54,0,0,0-.36.42c-0.34.87-.38,0.93-2.09,0.93h-1.27a0.18,0.18,0,0,1-.17-0.17c0-.44,0-3.84.08-4.29a0.5,0.5,0,0,1,.27-0.55,21.09,21.09,0,0,1,2.7.1,1.4,1.4,0,0,1,1.25,1.31,0.54,0.54,0,0,0,.3.47,0.46,0.46,0,0,0,.3-0.51c0-.38,0-1.08,0-1.84a0.28,0.28,0,0,0-.17-0.23,14.12,14.12,0,0,1-1.75.08h-2.81Z",transform:"translate(-484.44 -490.06)"})," "]})," ",(0,r.jsxs)("g",{id:"8dfbf0a9-85f0-49da-99d8-6229354b9534","data-name":"T",children:[" ",(0,r.jsx)("path",{id:"8602b8e9-f5d6-42d3-88c6-0649b350ce04","data-name":"path1 fill",d:"M490.48,490.82c-2.18,0-3.91-.06-4.39-0.11a1.32,1.32,0,0,1-.68-0.34,0.85,0.85,0,0,0-.3-0.3,0.39,0.39,0,0,0-.28.32,19.85,19.85,0,0,1-.38,2.55,0.4,0.4,0,0,0,.23.42c0.08,0,.19,0,0.38-0.42a5.64,5.64,0,0,1,.61-1,1.72,1.72,0,0,1,1.35-.44c0.32,0,1.94,0,2.3.09a0.26,0.26,0,0,1,.17.25v2.26c0,1.46-.09,5.3-0.13,6.44-0.06,1.41-.11,1.71-1.41,2a0.47,0.47,0,0,0-.38.34c0,0.11.19,0.23,0.57,0.23s1.33-.13,2.22-0.13,2.13,0.1,2.28.1,0.53,0,.53-0.25a0.65,0.65,0,0,0-.49-0.34c-1.22-.25-1.31-0.53-1.39-1.33s-0.1-2.6-.1-4.81c0-1.63,0-3.61,0-4.5a0.35,0.35,0,0,1,.15-0.25c0.29-.06,2.26-0.06,2.6,0,1.12,0.06,1.37.15,1.5,1.16,0.06,0.48.15,0.61,0.28,0.61a0.43,0.43,0,0,0,.32-0.38,11.69,11.69,0,0,1,.42-2.2c0.1-.27,0-0.44-0.09-0.44a0.72,0.72,0,0,0-.28.13,2.49,2.49,0,0,1-1.33.32C494,490.8,491.49,490.82,490.48,490.82Z",transform:"translate(-484.44 -490.06)"})," "]})," ",(0,r.jsxs)("g",{id:"88168da7-a35d-4a6e-af2a-2bab78b9d062","data-name":"X",children:[" ",(0,r.jsx)("path",{id:"f33958e3-fb20-476c-b2a8-674ffe821a96","data-name":"path2 fill",d:"M504,491a0.52,0.52,0,0,0,.51.36,3,3,0,0,1,1.84,1.14,53.54,53.54,0,0,1,3,4.73,0.22,0.22,0,0,1-.06.27c-1.14,1.58-2.22,2.87-3,3.72a4.47,4.47,0,0,1-2.22,1.27c-0.51.1-.7,0.27-0.7,0.44s0.15,0.21.51,0.21,1.2-.1,2-0.1c0.61,0,1.48.06,2,.06,0.25,0,.46-0.08.46-0.27a0.53,0.53,0,0,0-.46-0.32c-0.74-.27-1-0.47-0.17-1.82,0.53-.78,1.44-2,2.05-2.72a0.15,0.15,0,0,1,.19,0c0.23,0.21,2.09,3.17,2.53,4a0.26,0.26,0,0,1-.08.34,3.18,3.18,0,0,1-.68.23c-0.32.11-.42,0.19-0.42,0.34s0.11,0.25.47,0.25,1-.08,1.58-0.08c1.12,0,2.17.11,2.79,0.11,0.42,0,.57-0.09.57-0.25a0.49,0.49,0,0,0-.44-0.36,3.37,3.37,0,0,1-2.34-1.73c-0.49-.67-2.7-4-2.83-4.31a0.45,0.45,0,0,1,0-.23c0.91-1.27,2.17-2.7,2.85-3.52a3.79,3.79,0,0,1,2.38-1.41,0.5,0.5,0,0,0,.44-0.34,0.44,0.44,0,0,0-.46-0.21c-0.44,0-1.56.06-2,.06s-1.12,0-1.69,0c-0.36,0-.53.1-0.53,0.25a0.49,0.49,0,0,0,.48.34c0.67,0.13,1,.34.72,0.89a32.86,32.86,0,0,1-2.53,3.44,0.14,0.14,0,0,1-.19,0,33.44,33.44,0,0,1-2.3-3.63c-0.21-.38,0-0.59.34-0.68s0.46-.21.46-0.36a0.43,0.43,0,0,0-.47-0.21c-0.55,0-.91,0-1.63,0s-2-.1-2.39-0.1S504,490.84,504,491Z",transform:"translate(-484.44 -490.06)"})," "]})," "]})," "]})})},98519:(e,t,o)=>{o.d(t,{k:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("thinCheck",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M6.385 14.162c.362 0 .642-.15.84-.444L13.652 3.71c.144-.226.205-.417.205-.602 0-.485-.341-.82-.833-.82-.335 0-.54.123-.746.444l-5.926 9.4-3.042-3.903c-.205-.267-.417-.376-.718-.376-.492 0-.848.348-.848.827 0 .212.075.417.253.629l3.541 4.416c.24.3.492.437.848.437z"})})},33676:(e,t,o)=>{o.d(t,{A:()=>a});o(67294);var n=o(45238),r=o(39986),i=o(85893);const a=(0,n.I)("thumbDown",{viewBox:"0 0 18 19",svg:(0,i.jsx)("g",{transform:"rotate(180 9 9.5)",children:r.f})})},97022:(e,t,o)=>{o.d(t,{E:()=>a});o(67294);var n=o(45238),r=o(10498),i=o(85893);const a=(0,n.I)("thumbDownFilled",{viewBox:"0 0 16 18",svg:(0,i.jsx)("g",{transform:"rotate(180 8 9)",children:r.O})})},39986:(e,t,o)=>{o.d(t,{P:()=>i,f:()=>r});o(67294);var n=o(45238);const r=(0,o(85893).jsx)("path",{d:"M0.539062 12.3125C0.539062 15.0547 2.29688 17.3125 4.54688 17.3125H7.11719C8.17188 17.8516 9.42188 18.1641 10.8047 18.1641H11.8906C12.9062 18.1641 13.7734 18.1016 14.3359 17.9609C15.4766 17.6797 16.1953 16.8672 16.1953 15.8516C16.1953 15.6641 16.1719 15.5 16.1172 15.3281C16.6562 14.9141 16.9609 14.2969 16.9609 13.6328C16.9609 13.3203 16.8984 13.0078 16.7891 12.7578C17.1484 12.375 17.3594 11.8203 17.3594 11.25C17.3594 10.875 17.2656 10.4922 17.1094 10.2031C17.3281 9.86719 17.4531 9.42188 17.4531 8.9375C17.4531 7.69531 16.5078 6.73438 15.2734 6.73438H12.3672C12.1953 6.73438 12.0859 6.65625 12.0938 6.50781C12.1328 5.69531 13.4062 3.75781 13.4062 2.17188C13.4062 1.01562 12.5859 0.171875 11.4688 0.171875C10.6484 0.171875 10.0859 0.59375 9.55469 1.61719C8.58594 3.48438 7.40625 5.125 5.65625 7.28125H4.25C2.14844 7.28125 0.539062 9.52344 0.539062 12.3125ZM5.375 12.25C5.375 10.5938 5.75 9.53125 6.80469 8.11719C7.99219 6.53125 9.625 4.63281 10.8125 2.27344C11.0625 1.77344 11.2344 1.64844 11.4844 1.64844C11.7891 1.64844 11.9844 1.86719 11.9844 2.25C11.9844 3.42188 10.6641 5.35156 10.6641 6.61719C10.6641 7.55469 11.4219 8.15625 12.4375 8.15625H15.2422C15.7031 8.15625 16.0391 8.5 16.0391 8.95312C16.0391 9.28125 15.9297 9.5 15.6562 9.76562C15.4609 9.96875 15.4375 10.25 15.6094 10.4453C15.8359 10.7734 15.9375 10.9844 15.9375 11.25C15.9375 11.5781 15.7812 11.8516 15.4609 12.0938C15.2031 12.2812 15.1094 12.5859 15.2656 12.8828C15.4297 13.2109 15.5156 13.3672 15.5156 13.6172C15.5156 14 15.2734 14.2891 14.7812 14.5469C14.5312 14.6875 14.4609 14.9531 14.5703 15.1875C14.7344 15.5938 14.7578 15.6641 14.7578 15.8438C14.7578 16.1797 14.5078 16.4531 13.9766 16.5859C13.5156 16.7031 12.7812 16.75 11.8203 16.7422L10.8125 16.7344C7.57031 16.7031 5.375 14.8828 5.375 12.25ZM1.9375 12.3125C1.9375 10.3281 2.96094 8.73438 4.14062 8.6875C4.34375 8.6875 4.55469 8.6875 4.75781 8.6875C4.20312 9.76562 3.95312 10.8984 3.95312 12.25C3.95312 13.6875 4.46094 14.9531 5.375 15.9453C5.07812 15.9453 4.76562 15.9375 4.46875 15.9375C3.10156 15.8906 1.9375 14.2812 1.9375 12.3125Z"}),i=(0,n.I)("thumbUp",{viewBox:"0 0 18 19",svg:r})},10498:(e,t,o)=>{o.d(t,{O:()=>r,w:()=>i});o(67294);var n=o(45238);const r=(0,o(85893).jsx)("path",{d:"M4 12.1875C3.99219 15.1641 6.34375 17.4297 10.0859 17.4375H11.1719C12.1953 17.4375 12.9766 17.3594 13.4297 17.2422C14.1016 17.0781 14.7031 16.6562 14.7031 15.8828C14.7031 15.5859 14.625 15.3594 14.5312 15.1875C14.4766 15.1016 14.4922 15.0234 14.5703 14.9922C15.0859 14.7578 15.4766 14.2812 15.4766 13.6562C15.4766 13.2969 15.375 12.9766 15.2031 12.75C15.125 12.6406 15.1406 12.5469 15.2656 12.4766C15.625 12.25 15.875 11.7891 15.875 11.2656C15.875 10.8828 15.7578 10.4844 15.5547 10.2812C15.4453 10.1797 15.4609 10.1094 15.5781 10.0156C15.8281 9.78906 15.9844 9.41406 15.9844 8.96094C15.9844 8.15625 15.3516 7.5 14.5234 7.5H11.7031C11.0234 7.5 10.5781 7.15625 10.5781 6.60156C10.5781 5.54688 11.9141 3.57812 11.9141 2.14844C11.9141 1.375 11.4219 0.90625 10.75 0.90625C10.1641 0.90625 9.85938 1.28906 9.53125 1.9375C8.33594 4.24219 6.75781 6.11719 5.54688 7.72656C4.49219 9.11719 4.00781 10.3125 4 12.1875ZM0.015625 12.25C0.015625 14.6719 1.52344 16.6719 3.53125 16.6719H4.89062C3.47656 15.5938 2.85156 13.9922 2.86719 12.1719C2.875 10.2031 3.57812 8.77344 4.32031 7.79688H3.23438C1.41406 7.79688 0.015625 9.75 0.015625 12.25Z"}),i=(0,n.I)("thumbUpFilled",{viewBox:"0 0 16 18",svg:r})},91:(e,t,o)=>{o.d(t,{L:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("triangle",{viewBox:"0 0 100 100",svg:(0,r.jsx)("polygon",{points:"5.9,88.2 50,11.8 94.1,88.2 "})})},77926:(e,t,o)=>{o.d(t,{l:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("twitter",{viewBox:"0 0 300 300",svg:(0,r.jsx)("path",{d:"M103.62,251.13969 C197.96,251.13969 249.56,172.97969 249.56,105.19969 C249.56,102.97969 249.56,100.76969 249.41,98.5696903 C259.448314,91.3087989 268.113555,82.3184843 275,72.0196903 C265.638791,76.167708 255.708293,78.8879768 245.54,80.0896903 C256.24744,73.6795109 264.261235,63.5974102 268.09,51.7196903 C258.021575,57.6942435 247.006461,61.9048105 235.52,64.1696903 C219.620828,47.2636331 194.357194,43.1258162 173.895493,54.0764896 C153.433792,65.027163 142.86275,88.3429476 148.11,110.94969 C106.868957,108.882186 68.4447578,89.402923 42.4,57.3596903 C28.7862276,80.7961376 35.7398788,110.778285 58.28,125.82969 C50.117412,125.587766 42.1327937,123.385822 35,119.40969 C35,119.61969 35,119.83969 35,120.05969 C35.0066813,144.47562 52.2175149,165.505042 76.15,170.33969 C68.598696,172.399091 60.6758059,172.700133 52.99,171.21969 C59.7094793,192.113919 78.9657456,206.427529 100.91,206.83969 C82.7473504,221.11401 60.3105951,228.862968 37.21,228.83969 C33.1290357,228.831856 29.0520407,228.584765 25,228.09969 C48.4563595,243.152456 75.749134,251.13686 103.62,251.09969"})})},51929:(e,t,o)=>{o.d(t,{G:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("typeform",{viewBox:"0 0 30 31",svg:(0,r.jsx)("path",{d:"M15.027 30.53c-4.294-.036-8.467-2.247-11.47-5.222C.553 22.333-.09 19.78.009 15.654.107 11.53 1.2 7.81 4.047 4.68 6.895 1.55 10.121.11 14.25.006c4.129-.103 7.291 1.046 10.44 4.156 3.15 3.11 5.242 7.127 5.31 11.392.067 4.266-1.978 6.94-4.972 9.936-2.994 2.995-5.706 5.077-10 5.04zm-4.891-19.66h3.818v10.304h1.903V10.87h3.818V9.071h-9.54v1.798z"})})},55863:(e,t,o)=>{o.d(t,{s:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("undo",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M14.542 10.6826C14.542 7.96875 12.71 6.10254 9.59961 6.10254H5.29297L3.70703 6.1709L4.91016 5.15234L6.67383 3.43652C6.80371 3.30664 6.89258 3.14258 6.89258 2.91699C6.89258 2.5 6.59863 2.19238 6.1543 2.19238C5.96973 2.19238 5.76465 2.28125 5.61426 2.4248L1.69043 6.29395C1.5332 6.4375 1.45117 6.64258 1.45117 6.84766C1.45117 7.05273 1.5332 7.25098 1.69043 7.40137L5.61426 11.2705C5.76465 11.4141 5.96973 11.5029 6.1543 11.5029C6.59863 11.5029 6.89258 11.1953 6.89258 10.7715C6.89258 10.5527 6.80371 10.3887 6.67383 10.252L4.91016 8.53613L3.70703 7.52441L5.29297 7.59277H9.64746C11.8486 7.59277 13.0586 8.84375 13.0586 10.6211C13.0586 12.4053 11.8486 13.7109 9.64746 13.7109H8.05469C7.60352 13.7109 7.2959 14.0459 7.2959 14.4629C7.2959 14.873 7.61035 15.208 8.05469 15.208H9.69531C12.751 15.208 14.542 13.4102 14.542 10.6826Z"})})},95097:(e,t,o)=>{o.d(t,{H:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("video",{viewBox:"0 0 30 30",svg:(0,r.jsx)("path",{d:"M2,2v26h26V2H2z M26,6h-2V4h2V6z M22,14H8V4h14V14z M6,10H4V8h2V10z M6,12v2H4v-2H6z M6,16v2H4v-2H6z M6,20v2H4v-2H6z M8,16 h14v10H8V16z M24,20h2v2h-2V20z M24,18v-2h2v2H24z M24,14v-2h2v2H24z M24,10V8h2v2H24z M6,4v2H4V4H6z M4,24h2v2H4V24z M24,26v-2h2v2 H24z"})})},54497:(e,t,o)=>{o.d(t,{t:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("warning",{viewBox:"0 0 14 14",svg:(0,r.jsx)("path",{d:"M1.619 12.581h9.96c.983 0 1.618-.73 1.618-1.625 0-.266-.07-.54-.21-.793L7.998 1.25a1.593 1.593 0 00-2.8 0L.217 10.163c-.14.26-.216.527-.216.793 0 .895.635 1.625 1.619 1.625zm4.989-4.367c-.375 0-.59-.21-.603-.584l-.089-3.174c-.013-.394.267-.666.686-.666.406 0 .704.279.691.672l-.101 3.162c-.013.387-.222.59-.584.59zm0 2.196c-.432 0-.787-.31-.787-.73 0-.419.349-.73.787-.73.432 0 .78.311.78.73 0 .425-.355.73-.78.73z"})})},98616:(e,t,o)=>{o.d(t,{A:()=>i});o(67294);var n=o(45238),r=o(85893);const i=(0,n.I)("whimsical",{viewBox:"0 0 32 32",svg:(0,r.jsxs)("g",{children:[(0,r.jsx)("path",{opacity:".8",fillRule:"evenodd",clipRule:"evenodd",d:"M12.807 9.772a.497.497 0 00-.705 0L5.76 16.146a.502.502 0 000 .708l6.343 6.374c.195.195.51.195.705 0l6.343-6.374a.503.503 0 000-.708l-6.343-6.374zm.352-2.479a.993.993 0 00-1.41 0l-8.457 8.499a1.005 1.005 0 000 1.416l8.458 8.499a.993.993 0 001.41 0l8.457-8.499c.39-.391.39-1.025 0-1.416l-8.458-8.499z",fill:"#A7A6A2"}),(0,r.jsx)("mask",{id:"a",maskUnits:"userSpaceOnUse",x:"3",y:"7",width:"19",height:"19",children:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.807 9.772a.497.497 0 00-.705 0L5.76 16.146a.502.502 0 000 .708l6.343 6.374c.195.195.51.195.705 0l6.343-6.374a.503.503 0 000-.708l-6.343-6.374zm.352-2.479a.993.993 0 00-1.41 0l-8.457 8.499a1.005 1.005 0 000 1.416l8.458 8.499a.993.993 0 001.41 0l8.457-8.499c.39-.391.39-1.025 0-1.416l-8.458-8.499z",fill:"#fff"})}),(0,r.jsx)("g",{filter:"url(#filter0_d)",mask:"url(#a)",children:(0,r.jsx)("path",{d:"M18.84 7.293a.993.993 0 011.41 0l8.458 8.499c.39.39.39 1.025 0 1.416l-8.458 8.499a.993.993 0 01-1.41 0l-8.457-8.499a1.005 1.005 0 010-1.416l8.457-8.499z",fill:"#000",fillOpacity:".01"})}),(0,r.jsx)("path",{d:"M18.84 7.293a.993.993 0 011.41 0l8.458 8.499c.39.39.39 1.025 0 1.416l-8.458 8.499a.993.993 0 01-1.41 0l-8.457-8.499a1.005 1.005 0 010-1.416l8.457-8.499z",fill:"#A7A6A2"}),(0,r.jsx)("defs",{children:(0,r.jsxs)("filter",{id:"filter0_d",x:"8.055",y:"4.964",width:"22.98",height:"23.071",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,r.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,r.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,r.jsx)("feOffset",{}),(0,r.jsx)("feGaussianBlur",{stdDeviation:"1.018"}),(0,r.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.6 0"}),(0,r.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow"}),(0,r.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"})]})})]})})},74229:(e,t,o)=>{o.d(t,{H1:()=>n});o(57658);const n={is:e=>r(e),async*fromValues(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];yield*t},async collect(e){const t=[];for await(const o of e)t.push(o);return t},async*withIndex(e){let t=0;for await(const o of e)yield[t,o],t++},async*chunk(e,t){let o=[];for await(const n of e)o.push(n),o.length>=t&&(yield o,o=[]);o.length>0&&(yield o)},async*map(e,t){for await(const o of e)yield t(o)},async*concat(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];for(const n of t)yield*n},async*filter(e,t){for await(const o of e){t(o)&&(yield o)}},withSideEffect:(e,t)=>Object.assign({},e,{async*[Symbol.asyncIterator](){for await(const o of e)await t(o),yield o}})};function r(e){return Symbol.asyncIterator in e}},25718:(e,t,o)=>{o.d(t,{Lk:()=>B,wB:()=>I,dx:()=>x,c8:()=>$,lM:()=>Y,on:()=>Q,CK:()=>H,WB:()=>D});o(57658);var n=o(67266),r=o.n(n),i=o(41432),a=o(80951),s=o(7057),l=o(14215),c=o(95538),d=o(64962),p=o(61075),u=o(64572),m=o(22808),g=o(72126),h=o(59753),f=o(21202);var y=o(19233),v=o(606),b=o(70279),S=o(19889),_=o(70203);o(29477);var w=o(97880),k=o(7928);function x(e){const t=_.J7s(e);return"a"===t?"[":"b"===t?"**":"i"===t?"*":"c"===t?"`":"s"===t?"~~":"e"===t?"$":""}function I(e,t,o){const n=_.J7s(e);if(_.j0F(e)){const n=_.zW$(e),r=(0,u.A5)({...o,url:n});return`](${(r?t({toPageId:r}):n)||""})`}return"b"===n?"**":"i"===n?"*":"c"===n?"`":"s"===n?"~~":"e"===n?"$":""}function C(e){const{annotation:t,exportArgs:o}=e,{getRecordValue:n,userTimeZone:r,getExportedPathToPage:i,intl:a,transformAnnotation:l}=o;if(l){const e=l(t,o);if("string"==typeof e)return e}if(_.IWo(t)){const e=_.zEN(t),o=n({table:S.KJ,id:e});return`@${(0,k.Nz)(a,o)}`}if(_.STW(t)){const e=_.TOT(t),r=n({table:f.iU,id:e});if(r){return`[${D({block:r,exportArgs:o})}](${i({toPageId:e})})`}}else{if(_.K$_(t)){var c;const e=_.r3j(t),r=n({table:b.x_,id:e,spaceId:o.root.spaceId});return null==r||null===(c=r.text)||void 0===c?void 0:c.toString()}if(_.fpG(t)){const{date_format:e,time_format:n,...i}=_.zyO(t);return(0,s.ZV)({value:i,date_format:e,time_format:n,userTimeZone:r,allowRelativeDates:!1,intl:o.intl})}if(_.kuv(t))return _.xey(t);if(_._bk(t)){const e=(0,p.kF)({annotation:t,exportArgs:o});if(e)return e}else{if(_.nSN(t)){var d;const e=_.frW(t);return null===(d=n({table:f.iU,id:e,spaceId:o.root.spaceId}))||void 0===d||null===(d=d.format)||void 0===d?void 0:d.original_url}if(_.OU5(t))return"";if(_.inx(t)||_.j0F(t)||_.aC4(t)||_.xw5(t)||_.pV3(t)||_.STW(t)||_.rIb(t)||_.LAI(t)||_.fTS(t)||_.aq(t)||_.QVC(t)||_.uge(t)||_.Lyt(t)||_.wjk(t))return;(0,w.t1)(t)}}}const T=e=>{const t=/^\s+/.exec(e);return t?t[0]:""},M=e=>{const t=/\s+$/.exec(e);return t?t[0]:""},P=e=>{const t=M(e);return t.length>0?e.slice(0,-1*t.length):e},A=e=>{const t=T(e);return e.slice(t.length)};function D(e){const{block:t,exportArgs:o}=e;return H({textValue:_.lzi(h.kk.fromBlock(t).getProperties().title),exportArgs:o})}function B(e){const{block:t,exportArgs:o}=e,{getRecordValue:n}=o,r=t&&t.content?t.content:[];return g.oA(g.UI(r,(t=>q({block:n({table:f.iU,id:t}),exportArgs:{...o,blockId:t},visitedBlock:e.visitedBlock}))))}function R(e){return e.split("\n")}function E(e){const{block:t,exportArgs:o}=e,n=_.lzi(h.kk.fromBlock(t).getProperties().caption);return n.length>0?[{text:H({textValue:n,exportArgs:o}),breakLines:!0,children:[]}]:[]}function F(e){const{block:t,exportArgs:o}=e;return H({textValue:_.lzi(h.kk.fromBlock(t).getProperties().caption),exportArgs:o})}function N(e){return{text:"",breakLines:!0,children:B(e)}}function j(){}function O(e){const{block:t,exportArgs:o}=e;return{text:`# ${D({block:t,exportArgs:o}).trim()}`,breakLines:!0,children:B(e)}}function L(e){const{block:t,exportArgs:o}=e;return{text:`- ${D({block:t,exportArgs:o}).trim()}`,breakLines:!1,childrenPrefix:z,children:B(e)}}function U(e){const{block:t,exportArgs:o}=e,{getExportedRenderAsset:n}=o,{source:r}=h.kk.fromBlock(t).getProperties(),i=_.QaF(r),a=n({fromBlockId:o.blockId,toFileURI:i});return{text:`[${F(e)||D({block:t,exportArgs:o})||a}](${a})`,breakLines:!0,children:E(e)}}function Z(e){const{block:t,exportArgs:o}=e,{getRecordValue:n,getExportedPathToPage:r,userTimeZone:i,intl:a}=o;if("collection_view"===t.type||"collection_view_page"===t.type){return{text:`[${(0,p.Ho)({blockId:t.id,getRecordValue:n,userTimeZone:i,intl:a})}](${r({toPageId:t.id,exportFileExt:".csv"})})`,breakLines:!0,children:[]}}}const V={text:function(e){const{block:t,exportArgs:o}=e;return{text:D({block:t,exportArgs:o}),breakLines:!0,children:B(e)}},header:O,sub_header:function(e){const{block:t,exportArgs:o}=e;return{text:`## ${D({block:t,exportArgs:o}).trim()}`,breakLines:!0,children:B(e)}},sub_sub_header:function(e){const{block:t,exportArgs:o}=e;return{text:`### ${D({block:t,exportArgs:o}).trim()}`,breakLines:!0,children:B(e)}},quote:function(e){const{block:t,exportArgs:o}=e;return{text:`> ${D({block:t,exportArgs:o}).trim()}`,breakLines:!0,childrenPrefix:"> ",children:B(e)}},bulleted_list:L,toggle:L,to_do:function(e){const{block:t,exportArgs:o}=e;let n;return n=a.Ml(h.kk.fromBlock(t).getProperties().checked)?"- [x] ":"- [ ] ",{text:`${n} ${D({block:t,exportArgs:o}).trim()}`,breakLines:!1,childrenPrefix:z,children:B(e)}},numbered_list:function(e){const{block:t,exportArgs:o}=e,{getRecordValue:n}=o;return{text:`${function(e){const{block:t,getRecordValue:o}=e,n=t.parent_id,r=o({table:f.iU,id:n});let a;a=r?g.oA(g.UI(r.content,(e=>o({table:f.iU,id:e})))):[];const s=g.cx(a,(e=>e.id===t.id)),l=g.tP(a,0,s),c=g.qr(l,(e=>e.type!==i.Ti.numberedList));return l.length-(c+1)}({block:t,getRecordValue:n})+1}. ${D({block:t,exportArgs:o})}`,breakLines:!1,childrenPrefix:z,children:B(e)}},code:function(e){const{block:t,exportArgs:o}=e,n=D({block:t,exportArgs:o});return{text:`${`\`\`\`${t.properties&&t.properties.language?function(e){const t=_.QaF(e);if(!t)return"";const o=y.W[t];return void 0===o||o===y.W["Plain Text"]?"":o}(t.properties.language):""}\n${R(n).join("\n")}\n\`\`\``}`,breakLines:!0,children:[]}},page:function(e){const{block:t,exportArgs:o}=e;if(t.id===o.navigableBlockId&&!o.renderParentBlockId)return O(e);const{getExportedPathToPage:n}=o;return{text:`[${D({block:t,exportArgs:o})}](${n({toPageId:t.id})})`,breakLines:!0,children:[]}},image:function(e){const{block:t,exportArgs:o}=e,{getExportedRenderAsset:n}=o,{source:r}=h.kk.fromBlock(t).getProperties(),i=_.QaF(r),a=n({fromBlockId:o.blockId,toFileURI:i}),s=F(e)||D({block:t,exportArgs:o})||a;return{text:(0,c.SR)({url:i})?`![${s}](${a})`:`[${s}](${a})`,breakLines:!0,children:E(e)}},video:U,embed:U,bookmark:function(e){const{block:t,exportArgs:o}=e,{link:n}=h.kk.fromBlock(t).getProperties(),r=a.zB(n);return{text:`[${D({block:t,exportArgs:o})}](${r})`,breakLines:!0,children:E(e)}},file:U,external_object_instance:function(e){var t;const{block:o}=e,n=null===(t=o.format)||void 0===t?void 0:t.original_url;if(n)return{text:`[${n}](${n})`,breakLines:!0,children:[]}},tweet:U,maps:U,gist:U,framer:U,invision:U,mixpanel:U,drive:function(e){const{block:t}=e;if(t.format&&t.format.drive_properties){const{url:e,title:o}=t.format.drive_properties;return{text:`[${o}](${e})`,breakLines:!0,children:[]}}return U(e)},figma:U,loom:U,pdf:U,typeform:U,codepen:U,audio:U,divider:function(){return{text:"---",breakLines:!0,children:[]}},equation:function(e){const{block:t}=e;let o="";return t&&t.properties&&t.properties.title&&(o=_.QaF(t.properties.title)),{text:`$$\n${o}\n$$`,breakLines:!0,children:[]}},collection_view:Z,collection_view_page:Z,column_list:N,column:N,factory:j,personal_home_page:j,copy_indicator:j,breadcrumb:j,link_to_collection:j,link_to_page:j,callout:function(e){var t;const{block:o,exportArgs:n}=e,r=D({block:o,exportArgs:n}),i=null===(t=o.format)||void 0===t?void 0:t.page_icon;return{text:`${(0,m.Z)(i)?i:"string"==typeof i?function(e){let{source:t,width:o=40,exportArgs:n}=e;const{getExportedRenderAsset:r}=n,i=r({fromBlockId:n.blockId,toFileURI:t});return`<img src="${i}" alt="${i}" width="${o}px" />`}({source:i,exportArgs:n}):""} ${r}`.trim(),breakLines:!0,children:B(e),htmlTag:"aside"}},table_of_contents:j,whimsical:U,miro:U,abstract:U,sketch:U,excalidraw:U,replit:U,hex:U,deepnote:U,alias:function(e){const{block:t,exportArgs:o}=e,{getRecordValue:n}=o;if(t.format&&t.format.alias_pointer&&(0,v.$O)(t.format.alias_pointer,f.iU)){const r=n(t.format.alias_pointer);if(r)return q({block:r,exportArgs:{...o,renderParentBlockId:t.id,blockId:t.format.alias_pointer.id},visitedBlock:e.visitedBlock})}},transclusion_container:N,transclusion_reference:function(e){const{block:t,exportArgs:o}=e,{getRecordValue:n}=o;if(t.format&&t.format.transclusion_reference_pointer){const r=n(t.format.transclusion_reference_pointer);if(r)return q({block:r,exportArgs:{...o,renderParentBlockId:t.id,blockId:t.format.transclusion_reference_pointer.id},visitedBlock:e.visitedBlock})}},table:function(e){var t;const{block:o,exportArgs:n}=e,{getRecordValue:r}=n,i=(null===(t=o.format)||void 0===t||null===(t=t.table_block_column_order)||void 0===t?void 0:t.length)||0,a=o.content,s={text:"",breakLines:!0,children:[]};if(0===i||!a)return s;const l=a.map((t=>{const i=r({table:f.iU,id:t});return i&&q({block:i,exportArgs:{...n,blockId:t,renderParentBlockId:o.id},visitedBlock:e.visitedBlock})||s})),c={text:`| ${[...Array(i).keys()].map((()=>"---")).join(" | ")} |`,breakLines:!1,children:[]};return{text:"",breakLines:!0,children:[l[0],c,...l.slice(1)]}},table_row:function(e){var t;const{block:o,exportArgs:n}=e,{getRecordValue:r,renderParentBlockId:i}=n;if(!i)return;const s=r({table:f.iU,id:i}),l=null==s||null===(t=s.format)||void 0===t?void 0:t.table_block_column_order;if(!l)return;return{text:`| ${l.map((t=>{const n=a.wS(o,t);return n?(0,p.hJ)({textValue:n,fromString:e=>e,exportArgs:e.exportArgs,renderers:d.O}).join(""):void 0})).join(" | ")} |`,breakLines:!1,children:[]}},tab:function(e){var t;const{block:o,exportArgs:n}=e,{getRecordValue:r}=n;return{text:`${g.oA(null===(t=o.content)||void 0===t?void 0:t.flatMap((e=>{const t=r({table:f.iU,id:e});if(t)return[D({block:t,exportArgs:n}),W(B({block:t,exportArgs:n})).trim()]}))).join("\n\n")}\n\t\t`,breakLines:!0,children:[]}},external_object_instance_page:j,button:j,ai_block:N,drawing:j};function q(e){const{block:t,forceRenderAsText:o,exportArgs:{transformBlockMapping:n}}=e;if(t&&t.type){if(e.visitedBlock){if(e.visitedBlock.has(t.id))return;e.visitedBlock.add(t.id)}const r=o&&i.wL[t.type]?(null==n?void 0:n.text)??V.text:(null==n?void 0:n[t.type])??V[t.type];if(r)return r(e)}}const z="    ";function W(e){let t="";for(const o of e){o.breakLines&&(t+="\n"),o.htmlTag&&(t+=`<${o.htmlTag}>\n`),o.text&&(t+=`${o.text}\n`),o.breakLines&&(t+=o.childrenPrefix?`${o.childrenPrefix}\n`:"\n");let e=W(o.children);if(e&&o.childrenPrefix){const t=R(e);e=[...t.slice(0,-1).map((e=>o.childrenPrefix+e)),...t.slice(-1)].join("\n")}t+=`${e}`,o.htmlTag&&(t+=`</${o.htmlTag}>\n\n`),o.suffix&&(t+=`${o.suffix}\n\n`)}return t=t.replace(/[\n]{3,}/g,"\n\n"),t}function H(e){const{textValue:t,exportArgs:o}=e;let n="";const i=_.lzi(t);let a=[];for(const c of i){const e=_.hDy(c),t=(0,l.N)(a,e,(e=>r()(e))),i=_.WiV(c),s=e.map((e=>C({annotation:e,exportArgs:o}))).find((e=>(0,w.$K)(e)))??i,d=M(n);n=P(n),t.deleted.reverse();for(const r of t.deleted)n+=I(r,o.getExportedPathToPage,o);n+=d,n+=T(s);for(const o of t.created)n+=x(o);n+=A(s);a=[...g.DY(a,e,((e,t)=>g.Xy(e,t))),...t.created]}const s=M(n);n=P(n),a.reverse();for(const r of a)n+=I(r,o.getExportedPathToPage,o);return n+=s,n}function G(e,t){const o=(new e).match(t)||[];if(0===o.length)return t;let n="",r=0;for(const i of o){const e=0===i.index||"<"!==t[i.index-1],o=i.lastIndex===t.length||">"!==t[i.lastIndex],a=Boolean(t.slice(i.index).match(/^[a-z][a-z]+:/i)),s=e&&o&&a;n+=t.slice(r,i.index),s&&(n+="<"),n+=i.raw,s&&(n+=">"),r=i.lastIndex}return n+=t.slice(r),n}function K(e){return e.replace(/\\/g,"\\\\")}const $=e=>{const{MarkdownIt:t,LinkifyIt:o,markdown:n,plugin:r}=e,i=new t({linkify:!0});return r&&i.use(r),i.render(K(G(o,n)))},Y=e=>{const{MarkdownIt:t,LinkifyIt:o,markdown:n,plugin:r}=e,i=new t({linkify:!0});return r&&i.use(r),i.renderInline(K(G(o,n)))};function Q(e,t){const o=new Set;return W(g.oA(e.map((e=>q({block:e,exportArgs:{...t,blockId:e.id},visitedBlock:o}))))).trim()}},44615:(e,t,o)=>{o.d(t,{Cy:()=>y,JK:()=>C,JY:()=>h,Lp:()=>v,Mv:()=>_,NP:()=>k,Ns:()=>S,T0:()=>x,ZS:()=>u,bS:()=>f,e7:()=>T,jY:()=>g,je:()=>b,pD:()=>I,pb:()=>w,pz:()=>m});var n=o(606),r=o(21202),i=o(6287),a=o(13493),s=o(80396),l=o(15047),c=o(77858),d=o(29369);const p={[l.bx]:!0,[r.iU]:!0,[a.n]:!0,[i.v]:!0,[c.zU]:!0,[d.e0]:!0,[s.yo]:!0};function u(e){return(0,n.UI)(e.table)&&!(e.table in p)?`versions/${e.id}:${e.table}:${e.spaceId}`:`versions/${e.id}:${e.table}`}function m(e){const t=e.indexOf("/");if(-1===t)return;const o=e.substring(t+1).split(":");return 2===o.length?n.dr.fromPointerLike({table:o[1],id:o[0]}):3===o.length?n.dr.fromPointerLike({table:o[1],id:o[0],spaceId:o[2]}):void 0}function g(e){return`collection/${e}`}function h(e){return`typedDatabasesListChanged/${e.spaceId}-${e.databaseType}`}function f(e){return`activity/${e}`}function y(e){return`activity/${e}`}function v(e){return`notification/${e}`}function b(e){return`teams_in_space/${e}`}function S(e){return`user_page_visit/${e}`}function _(e){return`backlinks/${e}`}function w(e){return`page_visit/${e}`}function k(e){return`user_shared_pages_in_space/${e.spaceId}-${e.userId}`}function x(e){return`presence/${e}`}function I(e){return`user_joined_teams_in_space/${e.userId}:${e.spaceId}`}function C(e){return`diagnosticPing/${e}`}function T(e){return`presence/drawing/${e}`}},56589:(e,t,o)=>{function n(e,t){return t&&e.redirect_uris.includes(t)?t:t||1!==e.redirect_uris.length?void 0:e.redirect_uris[0]}o.d(t,{_:()=>n})},82036:(e,t,o)=>{o.d(t,{_:()=>n});const n={invalid_request:"invalid_request",unauthorized_client:"unauthorized_client",access_denied:"access_denied",unsupported_response_type:"unsupported_response_type",invalid_scope:"invalid_scope",server_error:"server_error",temporarily_unavailable:"temporarily_unavailable"}},33317:(e,t,o)=>{o.d(t,{FS:()=>B,bv:()=>T,lK:()=>C,Iw:()=>A});o(21703),o(57658);var n=o(40902),r=o(53504),i=o(79317),a=o(59730),s=(o(30541),o(72126));function l(e,t){let o=Array.isArray(t)?t:[];return o=o.filter((t=>t!==e.id)),o}function c(e,t){let o=Array.isArray(t)?t:[];return o=o.filter((t=>t&&t.id&&t.id!==e.remove.id)),o}var d=o(59753),p=o(482),u=o(26825),m=o(80951),g=o(606),h=o(21202);o(70203);function f(e,t){const o=(0,m.rq)(t).filter((t=>t.id!==e.id));return(0,m.ow)(o)}function y(e,t){const o=(0,m.rq)(t),n=o.findIndex((t=>t.id===e.args.id));return n<0?{pointer:e.pointer,path:e.path,command:"removeRelation",args:{id:e.args.id,spaceId:e.args.spaceId}}:n===o.length-1?{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,spaceId:e.args.spaceId}}:{pointer:e.pointer,path:e.path,command:"addRelationBefore",args:{id:e.args.id,before:o[n+1].id,spaceId:e.args.spaceId}}}var v=o(76462),b=o(64684);o(68955),o(82798),o(26109);o(46227),o(4615),o(69920);o(47247);var S=o(67175),_=o(97880),w=o(63143);const k={set:e=>e,update:(e,t)=>(t||(t={}),{...t,...e}),listBefore:function(e,t){let o=Array.isArray(t)?t:[];o=l({id:e.id},o);const n=s.cx(o,(t=>t===e.before));return n>=0?o.splice(n,0,e.id):o.unshift(e.id),o},listAfter:function(e,t){let o=Array.isArray(t)?t:[];o=l({id:e.id},o);const n=s.cx(o,(t=>t===e.after));return n>=0?o.splice(n+1,0,e.id):o.push(e.id),o},listRemove:l,listReplace:function(e,t){let o=Array.isArray(t)?t:[];return o=o.map((t=>t===e.id?e.newId:t)),o},listAfterMulti:function(e,t){const o=new Set(e.ids),n=(Array.isArray(t)?t:[]).filter((e=>!o.has(e))),r=s.cx(n,(t=>t===e.after));return r>=0?n.splice(r+1,0,...e.ids):n.push(...e.ids),n},listBeforeMulti:function(e,t){const o=new Set(e.ids),n=(Array.isArray(t)?t:[]).filter((e=>!o.has(e))),r=s.cx(n,(t=>t===e.before));return r>=0?n.splice(r,0,...e.ids):n.unshift(...e.ids),n},keyedObjectListBefore:function(e,t){let o=Array.isArray(t)?t:[];o=c({remove:{id:e.value.id}},o);const n=e.before?e.before.id:void 0,r=s.cx(o,(e=>e&&e.id&&e.id===n));return r>=0?o.splice(r,0,e.value):o.unshift(e.value),o},keyedObjectListAfter:function(e,t){let o=Array.isArray(t)?t:[];o=c({remove:{id:e.value.id}},o);const n=e.after?e.after.id:void 0,r=s.cx(o,(e=>e&&e.id&&e.id===n));return r>=0?o.splice(r+1,0,e.value):o.push(e.value),o},keyedObjectListRemove:c,keyedObjectListUpdate:function(e,t){const o=Array.isArray(t)?[...t]:[],n=s.cx(o,(t=>t&&t.id&&t.id===e.value.id));return n>=0?o[n]=e.value:o.push(e.value),o},appendActivity:n.tR,setPermissionItem:u.r2,setSingletonPermissionItem:u.co,addRelation:function(e,t){const o=(0,m.rq)(t),n={id:e.id,spaceId:e.spaceId,table:h.iU},r=g.dr.uniq([...o,n]);return(0,m.ow)(r)},addRelationAfter:function(e,t){const o=f({id:e.id,spaceId:e.spaceId},t),n=(0,m.rq)(o),r={id:e.id,spaceId:e.spaceId,table:h.iU};let i;if(e.after){const t=n.findIndex((t=>t.id===e.after));i=g.dr.uniq([...n.slice(0,t+1),r,...n.slice(t+1)])}else i=g.dr.uniq([...n,r]);return(0,m.ow)(i)},addRelationBefore:function(e,t){const o=f({id:e.id,spaceId:e.spaceId},t),n=(0,m.rq)(o),r={id:e.id,spaceId:e.spaceId,table:h.iU};let i;if(e.before){const t=n.findIndex((t=>t.id===e.before));i=g.dr.uniq([...n.slice(0,t),r,...n.slice(t)])}else i=g.dr.uniq([r,...n]);return(0,m.ow)(i)},addRelations:function(e,t){const o=s.Kn(t)?t:{},n={...o};for(const r in e){const t=e[r],i=(0,m.rq)(o[r]),a=g.dr.uniq([...i,...t.map((e=>({id:e.id,spaceId:e.spaceId,table:h.iU})))]);n[r]=(0,m.ow)(a)}return n},removeRelation:f,copyFile:(e,t)=>{const o=t.file_ids||[];return o.includes(e.fileId)?{...t}:{...t,file_ids:[...o,e.fileId]}},removeTeamMembershipItem:b.Uk,setTeamMembershipItem:b.I6};const x=(e,t)=>function(e,t){if(0!==e.path.length||!(0,_.Kn)(t)||0!==Object.keys(t).length||!(0,_.Kn)(e.args))return!1;const o=e.args.format;return!!(0,_.Kn)(o)&&!0===o.use_crdt}(e,t)?{pointer:e.pointer,path:[],command:"update",args:{alive:!1}}:{pointer:e.pointer,path:e.path,command:"set",args:w.z4(t)?null:t};function I(e){return void 0===e.size?1:e.size}const C=function(e,t){let o,n,i=t||{};if(o=e.path.length>0?s.U2(i,e.path):i,n=i.version?i.version+I(e):I(e),!k[e.command])throw new Error(`Unknown operation command ${e.command}.`);if(void 0!==e.expectedVersion&&i.version&&e.expectedVersion!==i.version)throw new a.vq("Mismatching expected and actual versions for the record",{clientData:{type:"operation_conflict",expectedVersion:e.expectedVersion,currentVersion:i.version,command:e.command,path:e.path,pointer:e.pointer}});o=(0,k[e.command])(e.args,o);i=e.path.length>0?function(e,t,o){if(0===t.length)throw new a.D3("Empty path to set");const n=s.d9(e);let r=n;for(let i=0;i<t.length;i++){const e=t[i];if(i===t.length-1)r[e]=o;else{let o=s.d9(r[e]);null==o&&(o="number"==typeof t[i+1]?[]:{}),r[e]=o,r=o}}return n}(i,e.path,o):o;const l=v.ZP[e.pointer.table],c=l.requiredColumns||{},d=l.defaultColumnValues||{};for(const r of Object.keys(c))!t||w.z4(t[r])||i&&!w.z4(i[r])||(d.hasOwnProperty(r)?i[r]=d[r]:i[r]=t[r]);if(i&&t){const e=t.file_ids||[];(i.file_ids||[]).length<e.length&&(i.file_ids=e)}return i=(0,r.Z)(i,"mangle-class-instances")||{},i.id=e.pointer.id,i.version=n,i},T=function(e,t){let o;switch(t=t||{},o=e.path.length>0?s.U2(t,e.path):t,e.command){case"set":return x(e,o);case"update":return((e,t)=>{t||(t={});const o={};return Object.keys(e.args).forEach((e=>{o[e]=t[e],void 0===o[e]&&(o[e]=null)})),{pointer:e.pointer,path:e.path,command:"update",args:o}})(e,o);case"listBefore":return function(e,t){const o=Array.isArray(t)?t:[],n=o.findIndex((t=>t===e.args.id));if(n>=0){if(n+1===o.length)return{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id}};const t=o[n+1];return{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id,before:t}}}return{pointer:e.pointer,path:e.path,command:"listRemove",args:{id:e.args.id}}}(e,o);case"listAfter":return function(e,t){const o=Array.isArray(t)?t:[],n=o.findIndex((t=>t===e.args.id));if(n>0){const t=o[n-1];return{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id,after:t}}}return 0===n?{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id}}:{pointer:e.pointer,path:e.path,command:"listRemove",args:{id:e.args.id}}}(e,o);case"listRemove":return function(e,t){const o=Array.isArray(t)?t:[],n=o.findIndex((t=>t===e.args.id)),r=o[n-1];return r?{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id,after:r}}:{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id}}}(e,o);case"keyedObjectListBefore":return function(e,t){const o=Array.isArray(t)?t:[],n=o.findIndex((t=>t.id===e.args.value.id));if(n>=0){if(n+1===o.length)return{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:e.args};const t=o[n+1];return{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:e.args.value,before:{id:t.id}}}}return{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,o);case"keyedObjectListAfter":return function(e,t){const o=Array.isArray(t)?t:[],n=o.findIndex((t=>t.id===e.args.value.id));if(n>0){const t=o[n-1];return{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:{value:e.args.value,after:{id:t.id}}}}return 0===n?{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:e.args.value}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,o);case"keyedObjectListRemove":return function(e,t){const o=Array.isArray(t)?t:[],n=o.findIndex((t=>t.id===e.args.remove.id)),r=o[n],i=o[n-1];return r?i?{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:{value:r,after:{id:i.id}}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:r}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:i.id}}}}(e,o);case"keyedObjectListUpdate":return function(e,t){t||(t={});const o=(Array.isArray(t)?t:[]).find((t=>t.id===e.args.value.id));return o?{pointer:e.pointer,path:e.path,command:"keyedObjectListUpdate",args:{value:o}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,o);case"addRelation":case"addRelationAfter":case"addRelationBefore":return y(e,o);case"removeRelation":return function(e,t){const o=(0,m.rq)(t),n=o.findIndex((t=>t.id===e.args.id));return n<0?{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,spaceId:e.args.spaceId}}:0===n?{pointer:e.pointer,path:e.path,command:"addRelationBefore",args:{id:e.args.id,before:o.length>1?o[1].id:void 0,spaceId:e.args.spaceId}}:{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,after:o[n-1].id,spaceId:e.args.spaceId}}}(e,o);default:return}};function M(e){let{operation:t,previousOperation:o}=e;return{...t,args:t.args,size:I(t)+I(o)}}function P(e){let{operation:t,previousOperation:o}=e;return{...t,args:{...o.args,...t.args},size:I(t)+I(o)}}function A(e){const[t,...o]=e,n=[t];for(const r of o){const e=n[n.length-1],t=s.Xy(r.pointer,e.pointer)&&s.Xy(r.path,e.path);"set"===r.command&&"set"===e.command&&t?n[n.length-1]=M({operation:r,previousOperation:e}):"update"===r.command&&"update"===e.command&&t?n[n.length-1]=P({operation:r,previousOperation:e}):n.push(r)}return n}function D(e){const{getRecordModel:t,setNewValue:o,primitiveOperation:n,updateOnly:r}=e,i=t.getRecordValue(n.pointer);if(!r||i){const e=C(n,i);o({pointer:n.pointer,newValue:e})}}function B(e){const{recordMap:t,operations:o,updateOnly:n}=e;o.forEach((e=>{if((0,S.Qf)(e))throw new Error("Text operations should be applied separately")})),function(e){const{getRecordModel:t,setNewValue:o,recordOperations:n,updateOnly:r}=e;for(const a of n)if((0,p.S)(a)){const e=(0,i.T1)(a,t.getRecordValue);for(const n of e)D({primitiveOperation:n,getRecordModel:t,setNewValue:o,updateOnly:r})}else D({primitiveOperation:a,getRecordModel:t,setNewValue:o,updateOnly:r})}({getRecordModel:d.om.fromRecordMap(t),setNewValue:e=>{const{pointer:o,newValue:n}=e;t.setValue(o,n)},recordOperations:o,updateOnly:n})}},69246:(e,t,o)=>{o.d(t,{PT:()=>a,cz:()=>i,fY:()=>l,g$:()=>s,kg:()=>n,mu:()=>r});const n="teamSidebar",r="teamBrowserSearch",i="teamBrowserUnjoinedTeams",a="teamBrowserJoinedTeams",s="publicPageTemplateIncludes";function l(e){const{block:t,query:o,getRecordModel:n,userTimeZone:r,intl:i}=e;if(!o)return!0;const a=null==t?void 0:t.getRenderTitle({getRecordModel:n,userTimeZone:r,intl:i});return!!a&&a.toLowerCase().indexOf(o.trim().toLowerCase())>=0}},80:(e,t,o)=>{o.d(t,{kU:()=>s,p:()=>c,w6:()=>a});o(21703),o(57658);var n=o(72126),r=o(149);class i extends Error{constructor(e){super(e)}}function a(e,t){const o=Array.isArray(t)?t:[t],[,n]=e(o);return n.status?{value:n.value}:{error:n.error}}function s(e,t){const o=a(e,t);if(r.x.isFail(o))throw o.error;return o.value}const l=Symbol("ManyTillEndSentinel"),c={try:e=>t=>{const[o,n]=e(t);return n.status?[o,n]:[t,n]},any:()=>e=>e.length>0?[e.slice(1),{status:!0,value:e[0]}]:[[],{status:!1,error:new i("Reached end of input")}],eof:e=>t=>0===t.length?[[],{status:!0,value:void 0}]:[t,{status:!1,error:(null==e?void 0:e(t[0]))??new i("Expected end of input")}],map:(e,t)=>o=>{const[n,r]=e(o);return[n,r.status?{status:!0,value:t(r.value)}:r]},mapResult:(e,t)=>o=>{const[n,i]=c.map(e,t)(o);return i.status?r.x.isFail(i.value)?[n,{status:!1,error:i.value.error}]:[n,{status:!0,value:i.value.value}]:[n,i]},andThen:(e,t)=>o=>{const[n,r]=e(o);return r.status?t(r.value)(n):[n,r]},sequence:function(e){return t=>{const o=[];for(const n of e){const[e,r]=n(t);if(!r.status)return[e,r];o.push(r.value),t=e}return[t,{status:!0,value:o}]}},satisfy:function(e){return c.try((t=>{const[o,n]=c.any()(t);return n.status&&!e(n.value)?[o,{status:!1,error:new i("Failed predicate")}]:[o,n]}))},filter:function(e,t){return c.try((o=>{const[n,r]=e(o);return[n,r.status?t(r.value)?r:{status:!1,error:new i("Failed predicate")}:r]}))},literal:e=>c.describe(c.satisfy((t=>n.Xy(t,e))),(()=>new i(`Expected: ${JSON.stringify(e)}.`))),describe:(e,t)=>o=>{const[n,r]=e(o);return[n,r.status?r:{status:!1,error:t()}]},constant:e=>t=>[t,{status:!0,value:e}],choice:e=>0===e.length?c.fail((()=>new i("No parsers to choose from"))):t=>{let o=e[0](t);for(const r of e.slice(1)){const[e,i]=o;if(i.status||!n.Xy(e,t))return o;o=r(t)}return o},fail:e=>t=>[t,{status:!1,error:e(t)}],many:e=>t=>{const o=[];for(;;){const[n,r]=c.try(e)(t);if(!r.status)return[n,{status:!0,value:o}];o.push(r.value),t=n}},manyTill:(e,t)=>o=>{const n=[];for(;;){const[r,i]=c.choice([c.map(t,(()=>l)),c.try(e)])(o);if(!i.status)return[r,i];if(i.value===l)return[r,{status:!0,value:n}];n.push(i.value),o=r}},many1:e=>c.map(c.sequence([e,c.many(e)]),(e=>{let[t,o]=e;return[t,...o]})),sepBy:(e,t)=>c.choice([c.sepBy1(e,t),c.constant([])]),sepBy1:(e,t)=>c.andThen(e,(o=>c.map(c.many(c.map(c.sequence([t,e]),(e=>{let[,t]=e;return t}))),(e=>[o,...e])))),lazy:e=>c.andThen(c.constant(void 0),e),lookAhead:e=>t=>[t,e(t)[1]]}},26825:(e,t,o)=>{o.d(t,{D3:()=>ue,FD:()=>ie,GU:()=>G,Gx:()=>ce,IF:()=>R,IJ:()=>S,J3:()=>le,KJ:()=>I,Kf:()=>x,L2:()=>Y,N0:()=>K,OC:()=>j,Rh:()=>ne,SL:()=>D,Ub:()=>X,WM:()=>re,Wo:()=>$,Xr:()=>ee,YO:()=>L,ZO:()=>b,_G:()=>J,aG:()=>te,cJ:()=>me,co:()=>k,gr:()=>B,kD:()=>de,mq:()=>ae,nl:()=>C,oF:()=>T,qY:()=>q,r2:()=>w,uH:()=>oe,uq:()=>pe,ws:()=>_,xO:()=>E,yY:()=>A,zX:()=>U});o(57658),o(21703);var n=o(41432),r=o(15070),i=o(72126),a=o(59753),s=o(5366),l=o(63306),c=o(27006),d=o(45953),p=o(21202),u=o(77420),m=o(33709),g=o(15047),h=o(29369),f=o(19889),y=(o(47425),o(64684)),v=o(97880);function b(e){const{actor:t,ancestors:o,updatedPermissionItem:n}=e;return q({actorPointer:t&&t.pointer,ancestors:o,permissionsContext:se({recordMap:void 0})}).some((e=>{const t=x(e.permissionItem,n)?n.role:e.permissionItem.role;return!!t&&(0,c.zz)(t)}))}function S(e){const{actor:t,ancestors:o}=e,n=q({actorPointer:t&&t.pointer,ancestors:o,permissionsContext:se({recordMap:void 0})});if(1===n.length){const e=n[0];if((0,c.$D)(e.permissionItem)&&(0,c.YX)(e.permissionItem.role))return e}}function _(e,t){return e.some((e=>"user_permission"===e.type&&e.user_id===t))}function w(e,t){let o=t||[];if("public_permission"===e.type){const t=o.filter((e=>(0,c.$D)(e))).map((e=>e.added_timestamp||0));t.length>0?e.added_timestamp=Math.min(...t):e.added_timestamp=(new Date).getTime()}return o=o.filter((t=>!x(t,e))),o.push(e),o=o.filter((e=>!(0,c.C2)(e)||"none"!==(0,c.cY)(e))),o}function k(e,t){const{singletonPermissionItem:o,set:n}=e;let r=t||[];return r=r.filter((e=>!x(e,o))),n&&r.push(o),r}function x(e,t){return!(!e||!t)&&((0,c.jg)(e)&&(0,c.jg)(t)||(0,c.e_)(e)&&(0,c.e_)(t)?e.user_id===t.user_id:(0,c.FB)(e)&&(0,c.FB)(t)?e.bot_id===t.bot_id:(0,c.hV)(e)&&(0,c.hV)(t)?e.group_id===t.group_id:(0,c.LW)(e)&&(0,c.LW)(t)||(0,c.zU)(e)&&(0,c.zU)(t)?e.team_id===t.team_id:e.type===t.type)}function I(e){return(0,l.gc)(e).map((e=>{if(e.table===p.iU){const t=a.kk.isAnyModel(e)?e.getPermissionItems():e.value.permissions,o=a.kk.isAnyModel(e)?e.id:e.value.id;if(t&&t.length>0)return{from:{table:p.iU,blockId:o},permissions:t}}else if(e.table===h.e0){const t=a.kk.isAnyModel(e)?e.getPermissionItems():e.value.permissions,o=a.kk.isAnyModel(e)?e.id:e.value.id;if(t&&t.length>0)return{from:{table:h.e0,teamId:o},permissions:t}}})).filter(v.$K)}function C(){let e=0,t="none";for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];for(const a of n)if("string"==typeof a)e=Math.max(e,c.Av.indexOf(a));else for(const e of(0,v.Yd)(a))a[e]&&(t=P(t,e));const i=c.Av[e];return"editor"===i||"read_and_write"===i||"membership_admin"===i?i:"none"!==t&&Object.keys(t).length?("reader"!==i&&"comment_only"!==i&&"content_only_editor"!==i||(t=P(t,"read_content")),t):i}const T=(0,v.AO)((e=>"object"==typeof e?{true:e}:{false:e})),M=(0,v.AO)((e=>(0,r.pH)(e)||(0,r.Ye)(e)||"none"===e?{true:e}:{false:e}));function P(e,t){let o;return"none"===e?"read_content"===t?o={read_content:!0}:"update_content"===t?o={update_content:!0}:"insert_content"===t?o={insert_content:!0}:"read_property"===t||"update_property"===t||"insert_property"===t?o={read_property:!0}:"read_comment"===t?o={read_comment:!0}:"insert_comment"===t?o={insert_comment:!0}:(0,v.t1)(t):(o={...e},"read_content"===t?(o.read_content=!0,delete o.read_property):"update_content"===t?(o.update_content=!0,delete o.update_property):"insert_content"===t?(o.insert_content=!0,delete o.insert_property):"read_property"===t?o.read_content||(o.read_property=!0):"update_property"===t?o.update_content||(o.update_property=!0):"insert_property"===t?o.insert_content||(o.insert_property=!0):"read_comment"===t?o.read_comment=!0:"insert_comment"===t?o.insert_comment=!0:(0,v.t1)(t)),o}function A(e,t){if("string"==typeof e&&"string"==typeof t)return R(e,t);if("string"==typeof e){if("editor"===e||"membership_admin"===e)return!0;e=c.jD[e]}if("string"==typeof t){if("editor"===t||"membership_admin"===t)return!1;t=c.jD[t]}return function(e,t){if("none"===t)return!0;if("none"===e)return!1;let o=!0;for(const n of(0,v.Yd)(t))"read_property"===n?o&&=e.read_property||e.read_content:"update_property"===n?o&&=e.update_property||e.update_content:"insert_property"===n?o&&=e.insert_property||e.insert_content:"read_content"===n?o&&=e.read_content:"update_content"===n?o&&=e.update_content:"insert_content"===n?o&&=e.insert_content:"read_comment"===n?o&&=e.read_comment:"insert_comment"===n?o&&=e.insert_comment:"link_preview"===n||"synced_database"===n||(0,v.t1)(n);return Boolean(o)}(e,t)}function D(e,t){return c.Av.indexOf(e)<=c.Av.indexOf(t)}function B(e,t){return c.Av.indexOf(e)<c.Av.indexOf(t)}function R(e,t){return c.Av.indexOf(e)>=c.Av.indexOf(t)}function E(e,t){return c.Av.indexOf(e)>c.Av.indexOf(t)}function F(e,t){return void 0!==e&&e||void 0!==t&&t}function N(e){const{inheritedPermissionToCompare:t,mostPermissivePermissionLoose:o}=e,n=o;if((0,c.KF)(n.permissionItem)&&!(0,c.KF)(t.permissionItem))return t;const r=n.permissionItem.role,i=C(r,t.permissionItem.role),a=i!==r?t:n;return{from:a.from,permissionItem:{...a.permissionItem,role:i}}}function j(e){return e?(0,c.jg)(e)||(0,c.e_)(e)?`${e.type}:${e.user_id}`:(0,c.FB)(e)?`${e.type}:${e.bot_id}`:(0,c.hV)(e)?`${e.type}:${e.group_id}`:(0,c.zU)(e)||(0,c.LW)(e)?`${e.type}:${e.team_id}`:e.type:""}function O(e){return 1===e.length?e[0]:e.reduce(((e,t)=>{if(!x(e.permissionItem,t.permissionItem))throw Error("Items should be grouped by target, but given items have different targets");return(0,c.jg)(t.permissionItem)||(0,c.e_)(t.permissionItem)||(0,c.ix)(t.permissionItem)||(0,c.bm)(t.permissionItem)||(0,c.RI)(t.permissionItem)||(0,c.ZQ)(t.permissionItem)||(0,c.hV)(t.permissionItem)||(0,c.FB)(t.permissionItem)?N({mostPermissivePermissionLoose:e,inheritedPermissionToCompare:t}):(0,c.$D)(t.permissionItem)?function(e){const{mostPermissivePermissionLoose:t,inheritedPermissionToCompare:o}=e,n=N({mostPermissivePermissionLoose:t,inheritedPermissionToCompare:o});var r,i,a,s;return n.permissionItem={...n.permissionItem,allow_duplicate:(a=n.permissionItem.allow_duplicate,s=o.permissionItem.allow_duplicate,void 0===a||a||void 0===s||s),allow_search_engine_indexing:F(n.permissionItem.allow_search_engine_indexing,o.permissionItem.allow_search_engine_indexing),expiration_timestamp:(r=n.permissionItem.expiration_timestamp,i=o.permissionItem.expiration_timestamp,r&&i?Math.max(r,i):r||i)},n}({mostPermissivePermissionLoose:e,inheritedPermissionToCompare:t}):(0,c.gG)(t.permissionItem)?{...e,from:t.from}:(0,c.Le)(t.permissionItem)?e:void(0,v.t1)(t.permissionItem)}),e[0])}function L(e){const t=i.xH(e.map((e=>{const{permissions:t,from:o}=e;return t.map((e=>({from:o,permissionItem:e})))})));t.reverse();const o=i.vM(t,(e=>j(e.permissionItem))),n=i.Q8(o,O),r=new Set,a=[];for(const i of t){const e=j(i.permissionItem);r.has(e)||(r.add(e),a.push(n[e]))}const s=a.find((e=>(0,c.gG)(e.permissionItem)));return s?[s]:a}function U(e){return e.table===g.bx}function Z(e){return e.table===g.bx}function V(e){return e.table===h.e0}function q(e){const{actorPointer:t,ancestors:o,permissionsContext:n}=e;if((0,l.GR)(o))return[];let r=e.ignorePublicPermissions;r||(0,l.Zg)(o)||(r=!0);const i=o.find(Z),[a,s,d]=i?[i.__IM_SORRY__getValue(),i.getPermissionItems(),i.getPermissionGroups()]:[null,[],[]],g=(null==t?void 0:t.table)===f.KJ&&t,h=(null==t?void 0:t.table)===u.cZ&&t,v=h&&h.id,b=o.find(V),S=b?b.__IM_SORRY__getValue():null;if(h&&h.spaceId&&a&&a.id!==h.spaceId)return[];h&&!r&&(r=!0);const _=g&&g.id,w=_?d.filter((e=>e.user_ids&&e.user_ids.includes(_))).reduce(((e,t)=>(e.add(t.id),e)),new Set):new Set,k=L(I(o).map((e=>{const{permissions:t,from:o}=e;return{from:o,permissions:t.filter((e=>{if((0,c.jg)(e)||(0,c.e_)(e))return e.user_id===_;if((0,c.FB)(e))return e.bot_id===v;if((0,c.hV)(e))return w.has(e.group_id);if((0,c.Ix)(e))return Boolean(_&&S&&a&&(0,y.AL)({userId:_,team:S,space:a,groupIdsThatIncludeUser:w}));if((0,c.KK)(e))return Boolean(S&&g&&(0,y.pd)(S,g.id));if((0,c.zU)(e)){const t=H({team:S,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:n});return Boolean(_&&t&&a&&(0,y.AL)({userId:_,team:t,space:a,groupIdsThatIncludeUser:w}))}if((0,c.LW)(e)){const t=H({team:S,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:n});return Boolean(t&&g&&(0,y.pd)(t,g.id))}if((0,c.bm)(e)){const t=H({team:S,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:n});return Boolean(_&&t&&a&&(0,y.s8)({userId:_,team:t}))}return!0}))}}))),x=K({spacePermissions:s,userId:_||void 0,botId:v||void 0}),C=(0,l.Zg)(o),T=o.some((e=>Boolean(e.table===m.qF&&e.resolved)));return k.filter((e=>{const{permissionItem:t}=e;if(!(0,c.C2)(t))return!1;if((!C||T)&&(0,c.rz)(t.role)&&!(0,c.FB)(t))return!1;if(((0,c.jg)(t)||(0,c.e_)(t))&&t.user_id===_)return!0;if((0,c.FB)(t)&&t.bot_id===v)return!0;if((0,c.Ix)(t))return Boolean(_&&S&&a&&(0,y.AL)({userId:_,team:S,space:a,groupIdsThatIncludeUser:w}));if((0,c.KK)(t))return Boolean(S&&g&&(0,y.pd)(S,g.id));if((0,c.zU)(t)){const e=H({team:S,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:n});return Boolean(_&&e&&a&&(0,y.AL)({userId:_,team:e,space:a,groupIdsThatIncludeUser:w}))}if((0,c.bm)(t)){const e=H({team:S,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:n});return Boolean(_&&e&&a&&(0,y.s8)({userId:_,team:e}))}if((0,c.LW)(t)){const e=H({team:S,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:n});return Boolean(e&&g&&(0,y.pd)(e,g.id))}return!(!(0,c.ix)(t)||!x)||(!(r||!(0,c.$D)(t)||(0,c.o7)(t))||!!((0,c.hV)(t)&&x&&w.has(t.group_id)))})).map((e=>{const{from:t,permissionItem:n}=e,[r,i]=o;if("content_only_editor"===n.role){if(t.table!==p.iU)return W(o,t,e,n);if(!z(t,r)&&!z(t,i))return W(o,t,e,n);if(i&&i.table===t.table&&"collection"!==r.table&&"collection_view"!==r.table&&i.hasWikiBlockUri())return W(o,t,e,n)}return e}))}function z(e,t){return!!t&&(t.table===e.table&&t.id===e.blockId)}function W(e,t,o,r){return function(e,t){if(t.table!==p.iU)return!1;const o=e.findIndex((e=>e.table===p.iU&&e.type===n.Ti.page&&e.is_template));if(o<0)return!1;const r=e[o+2];if(!r)return!1;if(r.table!==p.iU)return!1;return r.isType(n.pg)&&r.id===t.blockId}(e,t)?{...o,permissionItem:{...r,role:"comment_only"}}:{...o,permissionItem:{...r,role:"read_and_write"}}}function H(e){var t;let{team:o,permissionItem:n,spaceId:r,permissionsContext:i}=e;if(o&&o.id===n.team_id)return o;const a={table:h.e0,id:n.team_id,spaceId:r};let s=null===(t=i.explicitTeamsRecordMap)||void 0===t?void 0:t.get(a);return s||(s=i.originalRecordMap.getValue(a)),s}function G(e){const{spacePermissions:t,userId:o}=e;return t.some((e=>(0,c.jg)(e)&&e.user_id===o&&(0,c.J5)(e.role)))}function K(e){const{spacePermissions:t,userId:o,botId:n}=e;return t.some((e=>{const t=(0,c.jg)(e)&&e.user_id===o&&(0,c.J5)(e.role),r=(0,c.FB)(e)&&e.bot_id===n&&(0,c.J5)(e.role),i=(0,c.jg)(e)&&e.user_id===o&&(0,c.Bc)(e.role);return t||r||i}))}function $(e){return L(I(e)).map((e=>{let{permissionItem:t}=e;return t}))}function Y(e,t){const o=[],n=[],r=[],i=[],a={};for(const s of e){a[j(s)]=s}for(const s of t){const e=j(s);if(a[e]){const t=a[e];(0,c.C2)(t)&&(0,c.C2)(s)&&t.role!==s.role?r.push([t,s]):i.push(s),delete a[e]}else o.push(s)}for(const s of Object.values(a))n.push(s);return{created:o.sort(J),deleted:n.sort(J),changed:r.sort(J),unchanged:i.sort(J)}}function Q(e){return Array.isArray(e)?e[0].type:e.type}function J(e,t){return c.UF.indexOf(Q(e))-c.UF.indexOf(Q(t))}function X(e,t,o){const n=Y(t,o),r=n.unchanged.filter((e=>(0,c.C2)(e)));for(const[s,l]of n.changed){const t=C(s.role,l.role);e.isCollectionView()||"read_and_write"!==s.role||"content_only_editor"!==l.role?s.role!==l.role&&s.role!==t&&r.push(s):r.push(s)}const i=[];for(const s of r){const t={pointer:e.pointer,command:"setPermissionItem",path:["permissions"],args:{...s,role:"none"}};i.push(t)}const a={pointer:e.pointer,command:"setSingletonPermissionItem",path:["permissions"],args:{singletonPermissionItem:{type:"restricted_permission"},set:!1}};return i.push(a),i}function ee(e,t){const o=[],n=Y(e,t);for(const r of n.created)if((0,c.C2)(r)){const e={...r,role:"none"};o.push([e,r])}for(const[r,i]of n.changed){const e=C(r.role,i.role);("content_only_editor"===i.role&&"read_and_write"===r.role||r.role!==e)&&o.push([r,i])}return o}function te(e){const t=a.kk.isAnyModel(e)?e.getPermissionItems():e.permissions;return i.oA((t||[]).map((e=>{if((0,c.jg)(e)&&(0,c.Jy)(e.role))return{userId:e.user_id,role:e.role}})))}function oe(e){if(e){const{read_user_without_email:t,read_user_with_email:o,inherit_creator_permissions:n,link_preview:r,synced_database:i,webhooks:a,workspace_search:s,workspace_page_export:l,...c}=e;if(M(c))return c}return"none"}function ne(e){if(!e)return{};const{read_user_with_email:t,read_user_without_email:o}=e;return o&&t?{read_user_without_email:o,read_user_with_email:t}:o?{read_user_without_email:o}:{}}function re(e){if(!e)return{};const{link_preview:t,synced_database:o}=e;return t&&o?{link_preview:t,synced_database:o}:t?{link_preview:t}:{}}function ie(e){return Boolean(e&&e.inherit_creator_permissions)}const ae=(0,s.defineMessages)({adminLabel:{id:"userPermissionsMenu.adminItem.label",defaultMessage:"Admin"},adminCaption:{id:"userPermissionsMenu.adminItem.caption",defaultMessage:"Can change workspace settings and invite new members to the workspace."},workspaceOwnerLabel:{id:"userPermissionsMenu.workspaceOwnerItem.label",defaultMessage:"Workspace owner"},workspaceOwnerCaption:{id:"userPermissionsMenu.workspaceOwnerItem.caption",defaultMessage:"Can change workspace settings and invite new members to the workspace."},membershipAdminLabel:{id:"userPermissionsMenu.membershipAdminItem.label",defaultMessage:"Membership admin"},membershipAdminCaption:{id:"userPermissionsMenu.membershipAdminItem.caption",defaultMessage:"Can manage workspace and group membership."},fullAccessLabel:{id:"userPermissionsMenu.fullAccessItem.label",defaultMessage:"Full access"},fullAccessCaption:{id:"userPermissionsMenu.fullAccessItem.caption",defaultMessage:"Can edit and share with others."},memberLabel:{id:"userPermissionsMenu.memberItem.label",defaultMessage:"Member"},memberCaption:{id:"userPermissionsMenu.memberItem.caption",defaultMessage:"Cannot change workspace settings or invite new members to the workspace."},canEditLabel:{id:"userPermissionsMenu.canEditItem.label",defaultMessage:"Can edit"},canEditCaption:{id:"userPermissionsMenu.canEditItem.caption",defaultMessage:"Can edit, but not share with others."},canEditContentLabel:{id:"userPermissionsMenu.canEditContentItem.label",defaultMessage:"Can edit content"},canEditContentCaption:{id:"userPermissionsMenu.canEditContentItem.caption",defaultMessage:"Can edit content, but can't edit the database's views or structure."},canReadLabel:{id:"userPermissionsMenu.canReadItem.label",defaultMessage:"Can view"},canReadCaption:{id:"userPermissionsMenu.canReadItem.caption",defaultMessage:"Cannot edit or share with others."},canWriteLabel:{id:"userPermissionsMenu.canWriteItem.label",defaultMessage:"Can write."},canWriteCaption:{id:"userPermissionsMenu.canWriteItem.caption",defaultMessage:"Cannot read or share with others."},canCommentLabel:{id:"userPermissionsMenu.canCommentItem.label",defaultMessage:"Can comment"},canCommentCaption:{id:"userPermissionsMenu.canCommentItem.caption",defaultMessage:"Can view and comment, but not edit."},mixedAccessLabel:{id:"userPermissionsMenu.mixedAccessItem.label",defaultMessage:"Mixed access"},mixedAccessCaption:{id:"userPermissionsMenu.mixedAccessItem.caption",defaultMessage:"Has mixed access."},leaveWorkspaceLabel:{id:"userPermissionsMenu.leaveWorkspaceItem.label",defaultMessage:"Leave workspace"},removeFromWorkspaceLabel:{id:"userPermissionsMenu.removeFromWorkspaceItem.label",defaultMessage:"Remove from workspace"},removeWorkspaceLabel:{id:"userPermissionsMenu.removeWorkspaceItem.label",defaultMessage:"Remove"},disabledLabel:{id:"userPermissionsMenu.disabledItem.label",defaultMessage:"Disabled"},noAccessLabel:{id:"userPermissionsMenu.noAccessItem.label",defaultMessage:"No access"},guestLabel:{id:"userPermissionsMenu.guestItem.label",defaultMessage:"Guest"},pageGuestLabel:{id:"userPermissionsMenu.pageGuestItem.label",defaultMessage:"Page guest"},teamGuestLabel:{id:"userPermissionsMenu.teamGuestItem.label",defaultMessage:"Teamspace guest"},canAccessLabel:{id:"userPermissionsMenu.canAccessItem.label",defaultMessage:"Can access"},limitedAccessLabel:{id:"userPermissionsMenu.limitedAccessItem.label",defaultMessage:"Limited access"}});function se(e){const{recordMap:t}=e;return{originalRecordMap:t||d.Ak.create(),explicitTeamsRecordMap:void 0,type:"empty_permissions_context"}}function le(e){const{recordMap:t,explicitTeamsRecordMap:o}=e;return{originalRecordMap:t||d.Ak.create(),explicitTeamsRecordMap:o,type:"loaded_permissions_context"}}function ce(e,t){if(!e)throw new Error("Expected to have a role");if("none"===e)return{label:ae.noAccessLabel};if(t===g.bx)return{label:ae.memberLabel,caption:ae.memberCaption};if(e.read_content&&e.update_content&&e.insert_content)return{label:ae.canEditLabel,caption:ae.canEditCaption};if(e.insert_content||e.update_content||e.read_content||e.read_comment)return{label:ae.mixedAccessLabel,caption:ae.mixedAccessCaption};if(e.insert_comment)return{label:ae.canCommentLabel,caption:ae.canCommentCaption};if(e.insert_property||e.update_property||e.read_property)throw new Error("Unsupported permission role");(0,v.t1)(e)}function de(e,t){if(T(e)){const{label:o}=ce(e,t);return o}return"reader"===e?ae.canReadLabel:"editor"===e?ae.fullAccessLabel:"read_and_write"===e?ae.canEditLabel:"content_only_editor"===e?ae.canEditContentLabel:"comment_only"===e?ae.canCommentLabel:"none"===e?ae.noAccessLabel:"membership_admin"===e?ae.membershipAdminLabel:void(0,v.t1)(e)}async function pe(e){return function(e){if(e.shared_to_web)return"shared_to_web";if(e.shared_externally)return"shared_externally";if(e.shared_internally)return"shared_internally";return"private"}(await async function(e){const{permissionItems:t,spaceUserPermissions:o,hasTeamLevelGuests:n,teamHasTeamLevelGuestsCache:r}=e,i={shared_internally:!1,shared_externally:!1,shared_to_web:!1,private:!1},a=t.filter((e=>!(0,c.Le)(e)));if(1===a.length&&(0,c.jg)(a[0]))return i.private=!0,i;const s=new Set((o??[]).map((e=>{let{user_id:t}=e;return t})));for(const l of a)switch(l.type){case"user_permission":case"exclusive_user_permission":s.has(l.user_id)?i.shared_internally=!0:i.shared_externally=!0;continue;case"explicit_team_owner_permission":case"explicit_team_permission":case"explicit_team_guest_permission":const e=l.team_id;(void 0!==(null==r?void 0:r[e])?r[e]:await n(e))?i.shared_externally=!0:i.shared_internally=!0;continue;case"bot_permission":i.shared_externally=!0;continue;case"group_permission":case"space_permission":i.shared_internally=!0;continue;case"public_permission":i.shared_to_web=!0;break;case"deleted_permission":case"restricted_permission":case"team_owner_permission":case"team_permission":continue;default:(0,v.t1)(l)}return i}(e))}function ue(e){switch(e.type){case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"explicit_team_permission":return e.team_id;case"bot_permission":return e.bot_id;case"exclusive_user_permission":case"user_permission":return e.user_id;case"group_permission":return e.group_id;case"public_permission":case"team_permission":case"team_owner_permission":case"deleted_permission":case"restricted_permission":case"space_permission":return;default:(0,v.t1)(e)}}function me(e){const{permissions:t,userId:o}=e;for(const n of t)if((0,c.jg)(n)&&n.user_id===o)return n.invite_id}},19233:(e,t,o)=>{o.d(t,{W:()=>r,Y:()=>i});var n=o(20852);const r={ABAP:n.PrismLanguages.abap,Agda:n.PrismLanguages.agda,Arduino:n.PrismLanguages.arduino,Assembly:n.PrismLanguages.nasm,Bash:n.PrismLanguages.bash,BASIC:n.PrismLanguages.basic,BNF:n.PrismLanguages.bnf,C:n.PrismLanguages.c,"C#":n.PrismLanguages.csharp,"C++":n.PrismLanguages.cpp,Clojure:n.PrismLanguages.clojure,CoffeeScript:n.PrismLanguages.coffeescript,Coq:n.PrismLanguages.coq,CSS:n.PrismLanguages.css,Dart:n.PrismLanguages.dart,Dhall:n.PrismLanguages.dhall,Diff:n.PrismLanguages.diff,Docker:n.PrismLanguages.docker,EBNF:n.PrismLanguages.ebnf,Elixir:n.PrismLanguages.elixir,Elm:n.PrismLanguages.elm,Erlang:n.PrismLanguages.erlang,"F#":n.PrismLanguages.fsharp,Flow:n.PrismLanguages.flow,Fortran:n.PrismLanguages.fortran,Gherkin:n.PrismLanguages.gherkin,GLSL:n.PrismLanguages.glsl,Go:n.PrismLanguages.go,GraphQL:n.PrismLanguages.graphql,Groovy:n.PrismLanguages.groovy,Haskell:n.PrismLanguages.haskell,HTML:n.PrismLanguages.html,Idris:n.PrismLanguages.idris,Java:n.PrismLanguages.java,JavaScript:n.PrismLanguages.jsx,JSON:n.PrismLanguages.json,Julia:n.PrismLanguages.julia,Kotlin:n.PrismLanguages.kotlin,LaTeX:n.PrismLanguages.latex,Less:n.PrismLanguages.less,Lisp:n.PrismLanguages.lisp,LiveScript:n.PrismLanguages.livescript,"LLVM IR":n.PrismLanguages.llvm,Lua:n.PrismLanguages.lua,Makefile:n.PrismLanguages.makefile,Markdown:n.PrismLanguages.markdown,Markup:n.PrismLanguages.markup,MATLAB:n.PrismLanguages.matlab,Mathematica:n.PrismLanguages.mathematica,Mermaid:n.PrismLanguages.mermaid,Nix:n.PrismLanguages.nix,"Notion Formula":n.PrismLanguages.notion,"Objective-C":n.PrismLanguages.objectivec,OCaml:n.PrismLanguages.ocaml,Pascal:n.PrismLanguages.pascal,Perl:n.PrismLanguages.perl,PHP:n.PrismLanguages.php,"Plain Text":"null",PowerShell:n.PrismLanguages.powershell,Prolog:n.PrismLanguages.prolog,Protobuf:n.PrismLanguages.protobuf,PureScript:n.PrismLanguages.purescript,Python:n.PrismLanguages.python,R:n.PrismLanguages.r,Racket:n.PrismLanguages.racket,Reason:n.PrismLanguages.reason,Ruby:n.PrismLanguages.ruby,Rust:n.PrismLanguages.rust,Sass:n.PrismLanguages.sass,Scala:n.PrismLanguages.scala,Scheme:n.PrismLanguages.scheme,Scss:n.PrismLanguages.scss,Shell:n.PrismLanguages.bash,Solidity:n.PrismLanguages.solidity,SQL:n.PrismLanguages.sql,Swift:n.PrismLanguages.swift,TOML:n.PrismLanguages.toml,TypeScript:n.PrismLanguages.tsx,"VB.Net":n.PrismLanguages.vbnet,Verilog:n.PrismLanguages.verilog,VHDL:n.PrismLanguages.vhdl,"Visual Basic":n.PrismLanguages.visualBasic,WebAssembly:n.PrismLanguages.wasm,XML:n.PrismLanguages.xml,YAML:n.PrismLanguages.yaml,"Java/C/C++/C#":n.PrismLanguages.clike},i={[n.PrismLanguages.abap]:"ABAP",[n.PrismLanguages.agda]:"Agda",[n.PrismLanguages.arduino]:"Arduino",[n.PrismLanguages.bash]:"Shell",[n.PrismLanguages.basic]:"BASIC",[n.PrismLanguages.bnf]:"BNF",[n.PrismLanguages.c]:"C",[n.PrismLanguages.clojure]:"Clojure",[n.PrismLanguages.coffeescript]:"CoffeeScript",[n.PrismLanguages.coq]:"Coq",[n.PrismLanguages.cpp]:"C++",[n.PrismLanguages.csharp]:"C#",[n.PrismLanguages.css]:"CSS",[n.PrismLanguages.dart]:"Dart",[n.PrismLanguages.dhall]:"Dhall",[n.PrismLanguages.diff]:"Diff",[n.PrismLanguages.docker]:"Docker",[n.PrismLanguages.ebnf]:"EBNF",[n.PrismLanguages.elixir]:"Elixir",[n.PrismLanguages.elm]:"Elm",[n.PrismLanguages.erlang]:"Erlang",[n.PrismLanguages.flow]:"Flow",[n.PrismLanguages.fortran]:"Fortran",[n.PrismLanguages.fsharp]:"F#",[n.PrismLanguages.gherkin]:"Gherkin",[n.PrismLanguages.glsl]:"GLSL",[n.PrismLanguages.go]:"Go",[n.PrismLanguages.graphql]:"GraphQL",[n.PrismLanguages.groovy]:"Groovy",[n.PrismLanguages.haskell]:"Haskell",[n.PrismLanguages.html]:"HTML",[n.PrismLanguages.idris]:"Idris",[n.PrismLanguages.java]:"Java",[n.PrismLanguages.javascript]:"JavaScript",[n.PrismLanguages.json]:"JSON",[n.PrismLanguages.jsx]:"JavaScript",[n.PrismLanguages.julia]:"Julia",[n.PrismLanguages.kotlin]:"Kotlin",[n.PrismLanguages.latex]:"LaTeX",[n.PrismLanguages.less]:"Less",[n.PrismLanguages.lisp]:"Lisp",[n.PrismLanguages.livescript]:"LiveScript",[n.PrismLanguages.llvm]:"LLVM IR",[n.PrismLanguages.lua]:"Lua",[n.PrismLanguages.makefile]:"Makefile",[n.PrismLanguages.markdown]:"Markdown",[n.PrismLanguages.markup]:"Markup",[n.PrismLanguages.matlab]:"MATLAB",[n.PrismLanguages.mathematica]:"Mathematica",[n.PrismLanguages.mermaid]:"Mermaid",[n.PrismLanguages.nasm]:"Assembly",[n.PrismLanguages.notion]:"Notion Formula",[n.PrismLanguages.nix]:"Nix",[n.PrismLanguages.objectivec]:"Objective-C",[n.PrismLanguages.ocaml]:"OCaml",[n.PrismLanguages.pascal]:"Pascal",[n.PrismLanguages.perl]:"Perl",[n.PrismLanguages.php]:"PHP",[n.PrismLanguages.powershell]:"PowerShell",[n.PrismLanguages.prolog]:"Prolog",[n.PrismLanguages.protobuf]:"Protobuf",[n.PrismLanguages.purescript]:"PureScript",[n.PrismLanguages.python]:"Python",[n.PrismLanguages.r]:"R",[n.PrismLanguages.racket]:"Racket",[n.PrismLanguages.reason]:"Reason",[n.PrismLanguages.ruby]:"Ruby",[n.PrismLanguages.rust]:"Rust",[n.PrismLanguages.sass]:"Sass",[n.PrismLanguages.scala]:"Scala",[n.PrismLanguages.scheme]:"Scheme",[n.PrismLanguages.scss]:"Scss",[n.PrismLanguages.solidity]:"Solidity",[n.PrismLanguages.sql]:"SQL",[n.PrismLanguages.swift]:"Swift",[n.PrismLanguages.toml]:"TOML",[n.PrismLanguages.tsx]:"TypeScript",[n.PrismLanguages.typescript]:"TypeScript",[n.PrismLanguages.vbnet]:"VB.Net",[n.PrismLanguages.verilog]:"Verilog",[n.PrismLanguages.vhdl]:"VHDL",[n.PrismLanguages.visualBasic]:"Visual Basic",[n.PrismLanguages.wasm]:"WebAssembly",[n.PrismLanguages.xml]:"XML",[n.PrismLanguages.yaml]:"YAML",[n.PrismLanguages.clike]:"Java/C/C++/C#"}},90850:(e,t,o)=>{o.d(t,{$r:()=>a,Zj:()=>i,Zk:()=>s});var n=o(15157);const r="promoCode";function i(e){let{currentUserId:t,promoCode:o}=e;o?n.Z.set({userId:t,key:r,value:o}):n.Z.remove({userId:t,key:r})}function a(e){n.Z.remove({userId:e,key:r})}function s(e){return n.Z.get({userId:e,key:r})}},81491:(e,t,o)=>{o.r(t),o.d(t,{DEFAULT_MAX_RECURRENCE_DUPLICATION_PER_TASK:()=>m,MAXIMUM_DAILY_RECURRENCES_IN_PATH:()=>d,MAXIMUM_NESTED_RECURRENCE_LEVEL:()=>c,MAX_RECURRENCE_INTERVAL:()=>s,RRULE_WEEKDAYS_MAP:()=>a,getRecurrenceAfter:()=>u,rruleFromRecurrence:()=>l,templateAncestorsViolateRecurrenceNesting:()=>p});var n=o(30120),r=o(84885);const i={day:r.Ci.DAILY,week:r.Ci.WEEKLY,month:r.Ci.MONTHLY,year:r.Ci.YEARLY},a={MO:r.Ci.MO,TU:r.Ci.TU,WE:r.Ci.WE,TH:r.Ci.TH,FR:r.Ci.FR,SA:r.Ci.SA,SU:r.Ci.SU},s=100;function l(e){const{start_date:t,frequency:o,interval:n,weekdays:s,timezone:l,hour:c,minute:d}=e,p="week"===o&&s?s.map((e=>a[e])):void 0;return new r.Ci({freq:i[o],dtstart:new Date(t),interval:n,byweekday:p,tzid:l,byhour:c??0,byminute:d??0,bysecond:0})}const c=1,d=1;function p(e){const t=e.filter((e=>{var t;return"day"===(null===(t=e.getRecurrence())||void 0===t?void 0:t.frequency)}));return e.length>c||t.length>=d}function u(e){const{recurrence:t,afterDate:o}=e,r=l(t).after(new Date(o));if(!r)return;return n.ou.fromJSDate(r).toUTC().setZone("local",{keepLocalTime:!0}).toJSDate()}const m=100},23014:(e,t,o)=>{o.d(t,{P8:()=>g,oN:()=>m,qB:()=>d,un:()=>u,zy:()=>p});o(57658),o(67294);var n=o(5366),r=o(76205),i=o(99036),a=o(96449),s=o(40652),l=o(85893);class c{constructor(e,t){this.variable=void 0,this.property=void 0,this.variable=e,this.property=t}getProperty(){return this.property}get(e){const t=this.getCombinatorFilter(e);if(t)return{type:"results",limit:1,filter:t}}getCombinatorFilter(e){const t=this.getPropertyFilter(e,this.variable);if(t)return{operator:"and",filters:[{property:this.property,filter:t}]}}getPropertyFilter(e,t){var o;const n=e[this.property];if(!n)return;return{operator:"status_is",value:{type:"is_option",value:null===(o=n.options)||void 0===o||null===(o=o.find((e=>e.id===t)))||void 0===o?void 0:o.value}}}}const d={[s.p$]:{current:{formattedMessage:(0,l.jsx)(n.FormattedMessage,{id:"database.filterValue.relationType.relativeSprintVariable.current",defaultMessage:"Current"}),reducer:new c(a.SF,a.b0.StatusV2)},next:{formattedMessage:(0,l.jsx)(n.FormattedMessage,{id:"database.filterValue.relationType.relativeSprintVariable.next",defaultMessage:"Next"}),reducer:new c(a.YE,a.b0.StatusV2)}}};function p(e,t){const{filter:o,property:n}=e;if(!(0,r.e)(o)||!(0,r.vR)(o))return!1;const a=t[n];if(!a||!(0,i.p_)(a))return!1;return(0,r.YO)(o).some((e=>"relative"===e.type))}function u(e,t,o){if(!e)return!1;const n=t[o];return!!n&&(e===s.p$&&o===a.b0.StatusV2&&(0,i.gB)(n))}function m(e,t){return!!e&&u(t,e,a.b0.StatusV2)}function g(e,t){const o=Object.entries(t).find((t=>{let[o,n]=t;return e===n}));return o?o[0]:void 0}},76462:(e,t,o)=>{o.d(t,{OC:()=>rt,ZP:()=>at});o(59730);var n=o(72126),r=o(97880),i=o(63143),a=o(74487),s=o(58129),l=o(70921),c=o(30842),d=o(39050),p=o(54368),u=o(51650),m=o(88179),g=o(80926),h=o(98963),f=o(18844),y=o(21202),v=o(7470),b=o(77420),S=o(60014),_=o(6287),w=o(13493),k=o(70279),x=o(75908),I=o(6359),C=o(7678),T=o(73409),M=o(60897),P=o(33709),A=o(44312),D=o(4986),B=o(52719),R=o(58912),E=o(19639),F=o(73387),N=o(36077),j=o(97715),O=o(32161),L=o(82447),U=o(9713),Z=o(57398),V=o(49953),q=o(14710),z=o(9508),W=o(62643),H=o(57883),G=o(66726),K=o(30754),$=o(6946),Y=o(9844),Q=o(25753),J=o(84683),X=o(38429),ee=o(89488),te=o(65311),oe=o(16427),ne=o(61220),re=o(96683),ie=o(70017),ae=o(89470),se=o(49126),le=o(94578),ce=o(4137),de=o(80396),pe=o(24836),ue=o(86135),me=o(78929),ge=o(84323),he=o(83200),fe=o(67627),ye=o(65963),ve=o(14130),be=o(34406),Se=o(42314),_e=o(16663),we=o(19221),ke=o(93646),xe=o(91644),Ie=o(63787),Ce=o(38952),Te=o(40837),Me=o(15047),Pe=o(96740),Ae=o(63921),De=o(75990),Be=o(57829),Re=o(63188),Ee=o(56877),Fe=o(76413),Ne=o(47238),je=o(35623),Oe=o(77858),Le=o(37202),Ue=o(29369),Ze=o(26195),Ve=o(60113),qe=o(14718),ze=o(14327),We=o(53412),He=o(65836),Ge=o(5505),Ke=o(66295),$e=o(10354),Ye=o(19889),Qe=o(19716),Je=o(98897),Xe=o(46769),et=o(66079),tt=o(58161),ot=o(28182),nt=o(35794);const rt={block:y.ZP,customer:M.ZP,notion_user:Ye.ZP,space:Me.ZP,space_view:Oe.ZP,token:Ge.Z,user_root:et.ZP,temporary_password:He.ZP,password:se.Z,collection:_.Z,collection_view:w.Z,apple_token:m.Z,google_token:$.Z,follow:H.ZP,activity:l.ZP,notification:te.ZP,firebase_token:W.ZP,trello_token:Ke.Z,asana_token:g.Z,confluence_token:x.Z,monday_token:ee.Z,external_entity:U.Z,external_token:z.Z,external_integration_app:Z.Z,slack_integration:Ie.Z,slack_notification:Ce.Z,discussion:P.ZP,comment:k.ZP,snapshot:Te.Z,credit:C.ZP,used_credit:$e.Z,user_settings:ot.ZP,evernote_token:N.Z,space_recover_pages:Fe.ZP,drive_token:D.ZP,block_token:v.Z,user_metadata:Xe.Z,bot:b.ZP,bot_token:S.Z,saml_config:me.ZP,experiment:j.ZP,education_domain:B.Z,education_email:R.Z,space_invite_link:Re.Z,public_email_domain:ce.Z,user_data_consent_permissions:Qe.Z,access_request:s.ZP,csat_feedback:T.ZP,template_checklist:Ve.Z,template_tag:We.ZP,page_visit:ae.ZP,page_exit:ie.ZP,subscription:Le.ZP,space_domain:Ae.ZP,admin_api_log:c.Z,admin_api_op_log:d.Z,integration:Y.ZP,integration_token:Q.Z,oauth_authorization_code:oe.Z,mfa_settings:X.ZP,[O.P]:O.Z,[L.r]:L.Z,[nt.b]:nt.Z,[q.Dw]:q.ZP,[tt.t]:tt.Z,team:Ue.ZP,[ke.O]:ke.Z,[I.H]:I.Z,[K.G]:K.Z,[G.l]:G.Z,[de.yo]:de.ZP,[V.r9]:V.ZP,[A.Jd]:A.ZP,[E.mz]:E.ZP,[De.F]:De.Z,[J.Tu]:J.ZP,[h.cv]:h.ZP,[ge.b]:ge.Z,[ye.a]:ye.Z,[_e.h]:_e.Z,[be.f1]:be.ZP,[Se.P]:Se.Z,[he.w]:he.Z,[ve.O]:ve.Z,[fe.m]:fe.Z,[we.a]:we.Z,[pe.qV]:pe.ZP,[ue.FM]:ue.ZP,[f.Xj]:f.ZP,[F.k]:F.Z,[Be.fF]:Be.ZP,[Ne.x]:Ne.ZP,[Je.pm]:Je.ZP,[Pe.L]:Pe.Z,[Ee.L9]:Ee.ZP,[Ze.nE]:Ze.ZP,[ze.z]:ze.Z,[qe.u]:qe.Z,[ne.V7]:ne.ZP,[re.K]:re.Z,[p.y]:p.Z,[je.M]:je.Z,[xe.AT]:xe.ZP,[u.b]:u.Z,[le.P9]:le.ZP};(0,r.Yd)(rt);a.literals(...(0,i.XP)(rt));const it={};n.M6(rt,(e=>{e.columnTypes&&n.M6(e.columnTypes,((e,t)=>{t&&(it[t]=!0)}))}));const at=rt},53772:(e,t,o)=>{function n(e){return"development"===e.env||"local"===e.env||e.isAdminMode}o.d(t,{x:()=>n})},94804:(e,t,o)=>{o.d(t,{A7:()=>i,Y6:()=>l,fe:()=>s,rE:()=>a,w8:()=>c});var n=o(15157),r=o(97880);function i(e){let{searchSessionId:t,searchSessionFlowNumber:o}=e;if((0,r.$K)(t)&&(0,r.$K)(o))return`1:${t}:${o}`}const a="SearchShowFilterBar";function s(e){return d({key:a,userId:e,defaultValue:!1})}const l="SearchSidePeekDefaultOpen";function c(e){return d({key:l,userId:e,defaultValue:!0})}function d(e){const{key:t,userId:o,defaultValue:r}=e,i=n.Z.get({userId:o,key:t});return void 0===i?r:"boolean"==typeof i&&i}},92338:(e,t,o)=>{o.d(t,{GA:()=>v,Ix:()=>S,Um:()=>_,dK:()=>w,iY:()=>c,jl:()=>u,n8:()=>d,u4:()=>p,vp:()=>b});var n=o(41432),r=o(40652),i=o(74487);const a=i.object({required:{type:i.literal("date"),start_date:i.string()},optional:{}}),s=i.union([i.object({required:{starting:a,ending:i.isUndefined()},optional:{}}),i.object({required:{starting:i.isUndefined(),ending:a},optional:{}}),i.object({required:{starting:a,ending:a},optional:{}}),i.object({required:{starting:i.isUndefined(),ending:i.isUndefined()},optional:{}})]),l=i.union([i.array(i.string()),i.object({required:{teamIds:i.array(i.string()),includeSpaceRecords:i.boolean()},optional:{}})]);function c(e){if(e)return Array.isArray(e)?e:e.teamIds?e.teamIds:void 0}i.object({required:{id:i.string(),type:i.union([i.literal("user"),i.literal("permission_group")])},optional:{}});let d=function(e){return e.CollectionsInSpace="CollectionsInSpace",e.BlocksInSpace="BlocksInSpace",e.BlocksInAncestor="BlocksInAncestor",e.BlocksInParent="BlocksInParent",e.BlocksInCollection="BlocksInCollection",e}({});i.object({required:{ancestors:i.array(i.string()),createdBy:i.array(i.string()),editedBy:i.array(i.string()),lastEditedTime:s,createdTime:s},optional:{requireEditPermissions:i.boolean(),isDeletedOnly:i.boolean(),excludeTemplates:i.boolean(),isAdminModeDeletedPageSearch:i.boolean(),blockTypes:i.minLength(i.array(i.literals(...Object.keys(n.Ti))),1),inTeams:l,navigableBlockContentOnly:i.boolean(),includePublicPagesWithoutExplicitAccess:i.boolean(),audience:i.array(i.literals("private","shared_internally","shared_externally","shared_to_web")),dev_excludedPages:i.array(i.string()),dev_excludedTeams:i.array(i.string()),parentId:i.string(),databaseType:i.array(i.literals(...r.fW))}});function p(e){return{isDeletedOnly:!1,excludeTemplates:!1,navigableBlockContentOnly:!1,requireEditPermissions:!1,includePublicPagesWithoutExplicitAccess:!1,ancestors:[],parentId:void 0,createdBy:[],editedBy:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},inTeams:[],...e}}function u(e,t){return{...e,...t,createdTime:{...e.createdTime,...t.createdTime},lastEditedTime:{...e.lastEditedTime,...t.lastEditedTime}}}const m=["quick_find","quick_find_public","quick_find_input_change","quick_find_scroll","quick_find_filters","quick_find_ancestor_filter","quick_find_navigational_mode"],g=(m.filter((e=>"quick_find_ancestor_filter"!==e)),["cron_attachment_search_input_change","cron_attachment_parent_search_input_change","cron_time_collection_views_query"]),h=(i.union([...m.map(i.literal),...g.map(i.literal),i.literal("ancestor_filter_page_search"),i.literal("debugging"),i.literal("report_bad_search"),i.literal("trash"),i.literal("link_to_page_block"),i.literal("link_to_collection_block"),i.literal("mention_menu"),i.literal("move_to_menu"),i.literal("public_home_page_menu"),i.literal("relation_menu"),i.literal("relation_setup_menu"),i.literal("web_clipper"),i.literal("oauth"),i.literal("collection_group_value"),i.literal("collection_settings_source"),i.literal("collection_settings_select_relation_source"),i.literal("admin_search_permanently_deleted_pages"),i.literal("bot_iterate_blocks_in_space"),i.literal("api_unknown"),i.literal("simple_formula_value_page_search"),i.literal("automation_page_picker"),i.literal("automation_collection_picker"),i.literal("admin_content_search"),i.literal("ediscovery_search_api"),i.literal("admin_content_search_export"),i.literal("question_answer_context_search"),i.literal("export_content_analytics"),i.literal("send_to_notion_database_options"),i.literal("search_content_analytics"),i.literal("search_unique_id"),i.literal("update_sidebar_tab_assistant"),i.literal("legacy_searchPagesWithParent")]),["lastEdited","created","scroll","id",...Object.keys({pageViewsLast7Days:"pageViews.pageViewsLast7Days",pageViewsLast28Days:"pageViews.pageViewsLast28Days",pageViewsLast90Days:"pageViews.pageViewsLast90Days",pageViewsAllTime:"pageViews.pageViewsAllTime",uniquePageViewsLast7Days:"uniquePageViews.uniquePageViewsLast7Days",uniquePageViewsLast28Days:"uniquePageViews.uniquePageViewsLast28Days",uniquePageViewsLast90Days:"uniquePageViews.uniquePageViewsLast90Days",uniquePageViewsAllTime:"uniquePageViews.uniquePageViewsAllTime"})]),f=i.object({required:{field:i.literals("relevance")},optional:{}}),y=i.object({required:{field:i.literals(...h),direction:i.literals("asc","desc")},optional:{missing:i.union([i.literal("_first"),i.literal("_last"),i.number(),i.boolean(),i.string()]),searchAfter:i.undefinable(i.union([i.number(),i.string()]))}}),v=i.union([f,y]);let b=function(e){return e.Local="local",e.ElasticSearch="es",e.Postgres="pg",e.VectorDBBlock="vector_block",e.VectorDBCollection="vector_collection",e.ElasticsearchRandom="es_random",e.ElasticsearchUniqueID="es_uniqueId",e.ElasticsearchForcedRecentRecall="es_forced_recent_recall",e}({});const S={RequestFailed:{type:"RequestFailed",message:"Something went wrong."},NoResults:{type:"NoResultsFound",message:"No results found."},Offline:{type:"Offline",message:"Go online for more results."}},_="<gzkNfoUU>",w="</gzkNfoUU>"},25666:(e,t,o)=>{o.d(t,{D:()=>a,T:()=>i});var n=o(24211),r=o(72126);const i="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function a(e,t){if(r.HD(e))return e;{const o=e[t];return void 0!==o?o:e[n.al]}}},94044:(e,t,o)=>{o.d(t,{$e:()=>m,TQ:()=>u,UF:()=>s,VX:()=>c,jm:()=>d,my:()=>p,p_:()=>a,vr:()=>l});var n=o(5366),r=o(30845),i=o(59753);o(4615);const a=8,s=70,l=1e3,c=(0,n.defineMessages)({member:{id:"sharedContextualInviteHelpers.member.inviteMessage2",defaultMessage:"{userName} shared a page {pageName} with you."},guest:{id:"sharedContextualInviteHelpers.guest.inviteMessage2",defaultMessage:"{userName} shared {pageName}. Join {spaceName} to view this page."},default:{id:"sharedContextualInviteHelpers.default.inviteMessage",defaultMessage:"Your invitation message"},optional:{id:"sharedContextualInviteHelpers.default.inviteMessagePrefix",defaultMessage:"Optional message..."}});function d(e){const{includeOptional:t,isGuest:o,emailProps:n,intl:r}=e,i=o?c.guest:c.member;if(t){return`${r.formatMessage(c.optional)}\n"${r.formatMessage(i,n)}"`}return r.formatMessage(i,n)}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;if(!e)return"";const o=r.s(e,"url");let n=e.slice();return o.forEach(((e,t)=>{n=n.replace(e.value,"[link]")})),n.length>t&&(n=`${n.substring(0,t)}...`),n}function u(e){if(!e)return!1;return r.s(e,"url").length>0}function m(e,t){var o;const n=null===(o=i.kk.fromValue("block",e).getPermissionItems())||void 0===o?void 0:o.find((e=>"user_permission"===e.type&&e.user_id===t.invited_user_id));if(n&&"invite_id"in n)return n.invite_id}},99108:(e,t,o)=>{o.d(t,{VR:()=>P,hI:()=>D});o(57658);var n=o(40902),r=o(41432),i=o(80951),a=o(53504),s=o(72126),l=o(26825),c=o(27006),d=o(97880);function p(e,t){return e.space_id===t.space_id&&e.collection_id===t.collection_id&&e.navigable_block_id===t.navigable_block_id}function u(e){return e.table+e.id}function m(e,t){return s.Xy(s.MR(e.authors||[],u),s.MR(t.authors||[],u))}function g(e,t){return s.MR(s.mN([...e.authors||[],...t.authors||[]],u),u)}function h(e,t){return e.block_id===t.block_id&&p(e,t)}function f(e,t){return e.block_id===t.block_id&&p(e,t)}function y(e,t){return p(e,t)&&e.comment_id===t.comment_id}function v(e,t){return p(e,t)}function b(e,t){return e.collection_property_id===t.collection_property_id&&p(e,t)}function S(e,t){return e.collection_view_id===t.collection_view_id&&p(e,t)}function _(e,t){return e.mentioned_block_id===t.mentioned_block_id&&e.mentioned_user_id===t.mentioned_user_id&&e.mentioned_property===t.mentioned_property&&m(e,t)&&p(e,t)}function w(e,t){return e.mentioned_block_id===t.mentioned_block_id&&e.mentioned_group_id===t.mentioned_group_id&&e.mentioned_property===t.mentioned_property&&m(e,t)&&p(e,t)}function k(e){const t=[];e:for(;e.list.length>0;){const o=e.list.shift();let n,r=0,i=!1;for(;r<e.list.length;){const t=e.list[r];if(i=e.cancel(o,t),i){e.list.splice(r,1);continue e}if(n=e.replace(o,t),n){e.list[r]=n;continue e}r++}t.push(o)}return t}function x(e,t){return 0===s.e5(e,t).length&&0===s.e5(t,e).length}function I(e,t){return p(e,t)&&e.permission_group_id===t.permission_group_id}function C(e){return"permission-created"===e.type||"permission-deleted"===e.type?(0,l.OC)(e.permission_data):"permission-changed"===e.type?(0,l.OC)(e.permission_data.before):void(0,d.t1)(e)}function T(e,t){return!!p(e,t)&&(!!m(e,t)&&("permission-restriction-created"===e.type||"permission-restriction-deleted"===e.type?"permission-restriction-created"===t.type||"permission-restriction-deleted"===t.type||(null===(o=e.permission_data)||void 0===o||null===(o=o.actual_changes)||void 0===o?void 0:o.some((e=>(0,l.OC)(e)===C(t)))):"permission-restriction-created"===t.type||"permission-restriction-deleted"===t.type?t.permission_data.actual_changes.some((t=>(0,l.OC)(t)===C(e))):C(e)===C(t)));var o}function M(e,t){if("permission-deleted"===e.type&&"permission-created"===t.type&&T(e,t)&&!function(e,t){return c.cY(e)===c.cY(t)}(e.permission_data,t.permission_data))return{...t,type:"permission-changed",timestamp:t.timestamp,permission_data:{before:e.permission_data,after:t.permission_data}}}function P(e){const t=k({list:k({list:s.MR((0,a.Z)(e,"mangle-class-instances")||[],(e=>e.timestamp)),cancel:(e,t)=>!1,replace:(e,t)=>M(e,t)}),cancel:(e,t)=>function(e,t){return"block-created"===e.type&&"block-deleted"===t.type&&h(e,t)}(e,t)||function(e,t){return"block-deleted"===e.type&&"block-created"===t.type&&h(e,t)}(e,t)||function(e,t){if("block-changed"===e.type&&"block-changed"===t.type&&h(e,t)){if(e.block_data.after.block_value.type===r.Ti.tableRow){const o=n.Yr({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),r=n.Yr({before:t.block_data.before.block_value,after:t.block_data.after.block_value});return x(o,r)&&s.Xy(s.ei(e.block_data.before.block_value.properties||{},o),s.ei(t.block_data.after.block_value.properties||{},r))}const o=n.OS({before:e.block_data.before.block_value,after:e.block_data.after.block_value,schema:e.block_schema}),i=n.B9({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),a=n.OS({before:t.block_data.before.block_value,after:t.block_data.after.block_value,schema:t.block_schema}),l=n.B9({before:t.block_data.before.block_value,after:t.block_data.after.block_value});return!n.lv({before:t.block_data.before.block_value,after:t.block_data.after.block_value})&&x(o,a)&&s.Xy(s.ei(e.block_data.before.block_value.properties||{},o),s.ei(t.block_data.after.block_value.properties||{},a))&&x(i,l)&&s.Xy(s.ei(e.block_data.before.block_value.format||{},i),s.ei(t.block_data.after.block_value.format||{},l))}return!1}(e,t)||function(e,t){return!("block-property-changed"!==e.type||"block-property-changed"!==t.type||!f(e,t))&&x(Object.keys(e.property_updates),Object.keys(t.property_updates))&&s.Xy(Object.values(e.property_updates).map((e=>e.before)),Object.values(t.property_updates).map((e=>e.after)))}(e,t)||function(e,t){return"permission-created"===e.type&&"permission-deleted"===t.type&&T(e,t)}(e,t)||function(e,t){return"permission-deleted"===e.type&&"permission-created"===t.type&&T(e,t)}(e,t)||function(e,t){return"permission-changed"===e.type&&"permission-changed"===t.type&&T(e,t)&&s.Xy(e.permission_data.before,t.permission_data.after)}(e,t)||function(e,t){return"mention-created"===e.type&&"mention-deleted"===t.type&&_(e,t)}(e,t)||function(e,t){return"mention-deleted"===e.type&&"mention-created"===t.type&&_(e,t)}(e,t)||function(e,t){return"permission-group-mention-created"===e.type&&"permission-group-mention-deleted"===t.type&&w(e,t)}(e,t)||function(e,t){return"permission-group-mention-deleted"===e.type&&"permission-group-mention-created"===t.type&&w(e,t)}(e,t)||function(e,t){return"comment-created"===e.type&&"comment-deleted"===t.type&&y(e,t)}(e,t)||function(e,t){return"comment-deleted"===e.type&&"comment-created"===t.type&&y(e,t)}(e,t)||function(e,t){return"comment-changed"===e.type&&"comment-changed"===t.type&&y(e,t)&&s.Xy(e.comment_data.before,t.comment_data.after)}(e,t)||function(e,t){return!!("collection-changed"===e.type&&"collection-changed"===t.type&&v(e,t)&&e.collection_data&&t.collection_data)&&s.Xy(e.collection_data.before,t.collection_data.after)}(e,t)||function(e,t){return"collection-property-created"===e.type&&"collection-property-deleted"===t.type&&b(e,t)}(e,t)||function(e,t){return"collection-property-deleted"===e.type&&"collection-property-created"===t.type&&b(e,t)}(e,t)||function(e,t){return"collection-property-changed"===e.type&&"collection-property-changed"===t.type&&b(e,t)&&s.Xy(e.collection_property_data.before,t.collection_property_data.after)}(e,t)||function(e,t){return"collection-view-created"===e.type&&"collection-view-deleted"===t.type&&S(e,t)}(e,t)||function(e,t){return"collection-view-deleted"===e.type&&"collection-view-created"===t.type&&S(e,t)}(e,t)||function(e,t){return"collection-view-changed"===e.type&&"collection-view-changed"===t.type&&S(e,t)&&s.Xy(e.collection_view_data.before,t.collection_view_data.after)}(e,t)||function(e,t){return"permission-group-created"===e.type&&"permission-group-deleted"===t.type&&I(e,t)}(e,t)||function(e,t){return"permission-group-deleted"===e.type&&"permission-group-created"===t.type&&I(e,t)}(e,t),replace:(e,t)=>function(e,t){if("block-created"===e.type&&"block-changed"===t.type&&h(e,t))return{...e,timestamp:t.timestamp,authors:g(e,t),block_schema:t.block_schema,block_data:t.block_data.after}}(e,t)||function(e,t){if("block-changed"===e.type&&"block-changed"===t.type&&h(e,t))return{...e,timestamp:t.timestamp,authors:g(e,t),block_schema:t.block_schema,block_data:{before:e.block_data.before,after:t.block_data.after}}}(e,t)||function(e,t){if("block-property-changed"===e.type&&"block-property-changed"===t.type&&f(e,t)){const o=e.property_updates;return t.property_updates&&Object.entries(t.property_updates).forEach((n=>{let[r,i]=n;r in o?s.Xy(o[r].before,i.after)?(delete o[r],e.filtered_block_schema&&delete e.filtered_block_schema[r],t.filtered_block_schema&&delete t.filtered_block_schema[r]):o[r].after=i.after:o[r]=i})),{...e,timestamp:t.timestamp,authors:g(e,t),filtered_block_schema:{...e.filtered_block_schema,...t.filtered_block_schema},property_updates:o}}}(e,t)||function(e,t){if("comment-created"===e.type&&"comment-changed"===t.type&&y(e,t))return{...e,comment_data:t.comment_data.after}}(e,t)||function(e,t){if("comment-changed"===e.type&&"comment-changed"===t.type&&y(e,t))return{...e,comment_data:{before:e.comment_data.before,after:t.comment_data.after}}}(e,t)||function(e,t){if("permission-created"===e.type&&"permission-changed"===t.type&&T(e,t))return{...e,timestamp:t.timestamp,permission_data:t.permission_data.after}}(e,t)||function(e,t){if("permission-changed"===e.type&&"permission-changed"===t.type&&T(e,t))return{...e,permission_data:{before:e.permission_data.before,after:t.permission_data.after},timestamp:t.timestamp}}(e,t)||function(e,t){if("permission-created"===t.type&&"permission-restriction-created"===e.type&&T(e,t))return{...e,timestamp:t.timestamp}}(e,t)||function(e,t){if("permission-deleted"===t.type&&"permission-restriction-deleted"===e.type&&T(e,t))return{...e,timestamp:t.timestamp}}(e,t)||function(e,t){if("collection-created"===e.type&&"collection-changed"===t.type&&v(e,t))return{...e,authors:g(e,t),collection_data:t.collection_data?t.collection_data.after:void 0}}(e,t)||function(e,t){if("collection-changed"===e.type&&"collection-changed"===t.type&&v(e,t))return{...e,timestamp:t.timestamp,authors:g(e,t),collection_data:{before:e.collection_data?e.collection_data.before:void 0,after:t.collection_data?t.collection_data.after:void 0}}}(e,t)||function(e,t){if("collection-property-created"===e.type&&"collection-property-changed"===t.type&&b(e,t))return{...e,timestamp:t.timestamp,authors:g(e,t),collection_property_data:t.collection_property_data.after}}(e,t)||function(e,t){if("collection-property-changed"===e.type&&"collection-property-changed"===t.type&&b(e,t))return{...e,timestamp:t.timestamp,authors:g(e,t),collection_property_data:{before:e.collection_property_data.before,after:t.collection_property_data.after}}}(e,t)||function(e,t){if("collection-view-created"===e.type&&"collection-view-changed"===t.type&&S(e,t))return{...e,timestamp:t.timestamp,authors:g(e,t),collection_view_data:t.collection_view_data.after}}(e,t)||function(e,t){if("collection-view-changed"===e.type&&"collection-view-changed"===t.type&&S(e,t))return{...e,timestamp:t.timestamp,authors:g(e,t),collection_view_data:{before:e.collection_view_data.before,after:t.collection_view_data.after}}}(e,t)||function(e,t){if("permission-group-created"===e.type&&"permission-group-changed"===t.type&&I(e,t))return{...e,timestamp:t.timestamp,permission_group_data:t.permission_group_data.after,authors:g(e,t)}}(e,t)||function(e,t){if("permission-group-changed"===e.type&&"permission-group-changed"===t.type&&I(e,t))return{...e,permission_group_data:{before:e.permission_group_data.before,after:t.permission_group_data.after},timestamp:t.timestamp,authors:g(e,t)}}(e,t)}).filter((e=>!function(e){if("block-changed"===e.type){const t=n.gg({before:e.block_data.before.block_value,after:e.block_data.after.block_value,schema:e.block_schema}),o=n.lv({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),r=n.fc({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),i=n.Z3({before:e.block_data.before.block_value,after:e.block_data.after.block_value});return!(t||o||r||i)}return!1}(e)));return s.MR(t,(e=>e.timestamp))}function A(e){const t=k({list:s.MR((0,a.Z)(e,"ignore-class-instances")||[],(e=>e.timestamp)),cancel:(e,t)=>!1,replace:(e,t)=>function(e,t){if("block-changed"===e.type&&"block-deleted"===t.type&&h(e,t))return{...t,authors:g(e,t)}}(e,t)||function(e,t){if("permission-group-changed"===e.type&&"permission-group-deleted"===t.type&&I(e,t))return{...t,timestamp:t.timestamp,permission_group_data:e.permission_group_data.before,authors:g(e,t)}}(e,t)||function(e,t){if("permission-changed"===e.type&&"permission-deleted"===t.type&&T(e,t))return{...t,timestamp:t.timestamp,permission_data:e.permission_data.before}}(e,t)||function(e,t){if("collection-property-changed"===e.type&&"collection-property-deleted"===t.type&&b(e,t))return{...t,authors:g(e,t)}}(e,t)||function(e,t){if("collection-view-changed"===e.type&&"collection-view-deleted"===t.type&&S(e,t))return{...t,authors:g(e,t)}}(e,t)});return s.MR(t,(e=>e.timestamp))}function D(e){return function(e){const t=[];return e.forEach((e=>{if("block-changed"===e.type)if(n.lv({before:e.block_data.before.block_value,after:e.block_data.after.block_value})){const o={...e,type:"block-created",block_data:e.block_data.after},n={...e,type:"block-deleted",block_data:e.block_data.before};t.push(n),t.push(o)}else t.push(e);else t.push(e)})),t}(A(e)).filter((e=>!function(e){return("block-created"===e.type||"block-deleted"===e.type)&&r.wL[e.block_data.block_value.type]&&"page"!==e.block_data.block_value.type&&!(0,i.wS)(e.block_data.block_value,"title")}(e)&&!function(e){return("block-created"===e.type||"block-deleted"===e.type)&&r.XX[e.block_data.block_value.type]}(e)))}},34886:(e,t,o)=>{o.d(t,{F:()=>a,R:()=>i});var n=o(72126),r=o(97880);function i(e){const t={};return e?((0,r.qP)(e).forEach((e=>{let[o,r]=e;o&&r&&(t[String(o)]=n.HD(r)?r:JSON.stringify(r))})),t):t}function a(e){return e>=1e3?"1000+":e>=500?"500-999":e>=100?"100-499":e>=50?"50-99":e>=10?"10-49":e>=2?"2-9":e>=1?"1":"0"}},46637:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(29450),r=o(30548);const i=["adClick","fbp"];const a=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new r.ZP(e,t,"targeting")}get(e){return this.localStorageStore.get(e)}set(e,t){return this.localStorageStore.set(e,t)}remove(e){return this.localStorageStore.remove(e)}removeAllIfNoPermission(){const{trackingType:e}=this.localStorageStore;(0,n.hasPermissionForTrackingTypeBrowser)(e)||i.forEach((e=>this.remove(e)))}}(r.$p,!1)},72128:(e,t,o)=>{o.d(t,{Z:()=>a});var n=o(29450),r=o(30548);const i=["sourceInitialPage"];const a=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new r.ZP(e,t,"performance")}get(e){let{userId:t,key:o}=e;return this.localStorageStore.get((0,r.dq)(t,o))}set(e){let{userId:t,key:o,value:n}=e;return this.localStorageStore.set((0,r.dq)(t,o),n)}remove(e){let{userId:t,key:o}=e;return this.localStorageStore.remove((0,r.dq)(t,o))}removeAllIfNoPermission(){const{namespace:e,trackingType:t}=this.localStorageStore;if((0,n.hasPermissionForTrackingTypeBrowser)(t))return;const o=`${r.eg}${e}:`;Object.keys(localStorage).filter((e=>e.startsWith(o))).filter((e=>{const[t,o,n,r]=e.split(":");return r&&i.includes(r)})).forEach((e=>localStorage.removeItem(e)))}}(r.TA,!1)},64793:(e,t,o)=>{o.d(t,{t:()=>a});var n=o(97880),r=o(31919),i=o(896);class a{constructor(e){this.lastVersion=void 0,this.externalId=void 0,this.product=void 0,this.billingInterval=void 0,this.unitAmount=void 0,this.state=void 0,this.regions=void 0,this.externalId=e.external_id,this.product=e.product,this.billingInterval=e.billing_interval,this.unitAmount=r.n.fromValue({amount:e.unit_amount,currencyCode:e.currency}),this.state=e.state,this.regions=e.regions}get currencyCode(){return this.unitAmount.currencyCode}isAddOn(){return"ai"===this.product}getMonthlyUnitCost(e){const t=this.getAdjustedUnitAmount(e);return"year"===this.billingInterval?t.withDividedAmount(12):t}getMonthlyCost(e){const{quantity:t,coupon:o}=e;return this.getMonthlyUnitCost(o).withMultipliedAmount(t)}getCostPerBillingInterval(e){const{quantity:t,coupon:o}=e;return this.getAdjustedUnitAmount(o).withMultipliedAmount(t)}getDiscountPerBillingInterval(e){var t;const{quantity:o,coupon:n,promo:r}=e,a=this.unitAmount.withMultipliedAmount(o);if(n&&this.doesCouponApply(n))return a.withMultipliedAmount((0,i.ZN)(n));let s=0;return null!=r&&r.percent_off&&null!==(t=r.applies_to)&&void 0!==t&&t.includes(this.externalId)&&(s=r.percent_off/100),a.withMultipliedAmount(s)}getAdjustedUnitAmount(e){let t=1;return e&&this.doesCouponApply(e)&&(t=1-(0,i.ZN)(e)),this.unitAmount.withMultipliedAmount(t)}doesCouponApply(e){switch(this.product){case"ai":return"ai_fifty_percent"===e;case"free":case"student":case"personal":return!1;case"plus":return["team_three_months","team_annual"].includes(e);case"business":case"enterprise":return["business_three_months","business_annual"].includes(e);default:(0,n.t1)(this.product)}}}},31919:(e,t,o)=>{o.d(t,{n:()=>r});o(21703);const n={BRL:{currencyCode:"BRL",minorUnitDigits:2},EUR:{currencyCode:"EUR",minorUnitDigits:2},USD:{currencyCode:"USD",minorUnitDigits:2}};class r{static fromValue(e){const{amount:t,currencyCode:o}=e,i=n[o];if(!i)throw new Error(`Unsupported currency code: ${o}`);return new r(i,t)}static sum(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];const n=t.filter((e=>void 0!==e));if(0===n.length)return;const{currencyCode:i}=n[0];if(n.some((e=>e.currencyCode!==i)))throw new Error("Cannot add money with different currencies");const a=n.reduce(((e,t)=>e+t.amount),0);return r.fromValue({amount:a,currencyCode:i})}static zero(e){return r.fromValue({amount:0,currencyCode:e})}constructor(e,t){this.currencyValue=void 0,this.amount=void 0,this.currencyValue=e,this.amount=t}get currencyCode(){return this.currencyValue.currencyCode}toMoneyValue(){return{amount:this.amount,currencyCode:this.currencyValue.currencyCode}}withAmount(e){return new r(this.currencyValue,e)}withAddedAmount(e){return new r(this.currencyValue,this.amount+e)}plus(e){if(this.currencyCode!==e.currencyCode)throw new Error(`Cannot add money with currency code ${this.currencyCode} to money with currency code ${e.currencyCode}`);return new r(this.currencyValue,this.amount+e.amount)}minus(e){return this.plus(e.withMultipliedAmount(-1))}withMultipliedAmount(e){return new r(this.currencyValue,this.amount*e)}withDividedAmount(e){return new r(this.currencyValue,this.amount/e)}zeroIfNegative(){return new r(this.currencyValue,Math.max(0,this.amount))}zeroIfPositive(){return new r(this.currencyValue,Math.min(0,this.amount))}isPositive(){return this.amount>0}isNegative(){return this.amount<0}}},896:(e,t,o)=>{o.d(t,{$v:()=>i,ZN:()=>a,pp:()=>r});var n=o(97880);function r(e){if(!e)return!1;switch(e){case"ai_fifty_percent":return!0;case"team_three_months":case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return!1;default:(0,n.t1)(e)}}function i(e){if(!e)return!1;switch(e){case"ai_fifty_percent":return!1;case"team_three_months":case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return!0;default:(0,n.t1)(e)}}function a(e){switch(e){case"team_three_months":case"ai_fifty_percent":return.5;case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return.1;default:(0,n.t1)(e)}}},26929:(e,t,o)=>{o.d(t,{cS:()=>s});o(21703);var n=o(30120),r=o(97880);const i={payment_failed:30,confirmation_required:15};function a(e){const{now:t,subscriptionId:o,invoiceId:n,overdueReason:a,subscriptionStatus:s,invoiceDueDate:l}=e,c=function(e){const{subscriptionId:t,subscriptionStatus:o}=e;if(t&&o)switch(o){case"past_due":case"unpaid":return{paymentStatus:o,reason:`Subscription [${t}] status is '${o}'. This triggered the '${o}' payment status`};case"incomplete":return{paymentStatus:"past_due",reason:`Subscription [${t}] status is '${o}'. This triggered the 'past_due' payment status`};case"active":case"canceled":case"incomplete_expired":case"paused":case"trialing":return;default:(0,r.t1)(o)}}({subscriptionId:o,subscriptionStatus:s}),d=function(e){const{invoiceId:t,invoiceDueDate:o,overdueReason:n,now:r}=e;if(!t||!o||!n)return;if(r<o)return;const a=o.toFormat("LLLL dd, yyyy"),s=i[n];if(!s)throw new Error(`Unsupported overdue reason '${n}'`);const l=o.plus({days:s});if(r>=l)return{paymentStatus:"unpaid",reason:`Invoice [${t}] is overdue since ${a} due to '${n}'. This triggered the 'unpaid' payment status after a ${s} day warning period ending on ${l.toFormat("LLLL dd, yyyy")}`};return{paymentStatus:"past_due",reason:`Invoice [${t}] is overdue since ${a} due to '${n}'. This triggered the 'past_due' payment status on the due date.`}}({now:t,invoiceId:n,invoiceDueDate:l,overdueReason:a});return"unpaid"===(null==c?void 0:c.paymentStatus)?c:"unpaid"===(null==d?void 0:d.paymentStatus)?d:"past_due"===(null==c?void 0:c.paymentStatus)?c:"past_due"===(null==d?void 0:d.paymentStatus)?d:{paymentStatus:"paid"}}function s(e){const{now:t,overdueSubscription:o}=e;if(!o)return{paymentStatus:"paid",reason:"No overdue subscription was provided"};const{subscriptionId:r,invoiceId:i,subscriptionStatus:s,dueDate:l,overdueReason:c}=o;return a({now:t,subscriptionId:r,invoiceId:i,overdueReason:c,subscriptionStatus:s,invoiceDueDate:l?n.ou.fromMillis(l):void 0})}},2438:(e,t,o)=>{o.d(t,{CF:()=>i,du:()=>r,nR:()=>s,qH:()=>l,uN:()=>a});o(21703);var n=o(60897);function r(e){return"none"===e.role}function i(e){return"none"!==e.role}function a(e,t){return t?t.percent_off?{amount:e*t.percent_off/100,monthsRemaining:t.duration_in_months}:t.amount_off?{amount:t.amount_off}:{amount:0}:{amount:0}}function s(e){return"personal"!==e&&n.tt.find((t=>t===e))}function l(e){const t=n.KK.find((t=>t.includes(e))),o=null==t?void 0:t.findIndex((t=>t===e));if(0===o||e.includes("monthly")||e.includes("free")||e.includes("trial"))return"month";if(1===o||e.includes("yearly"))return"year";if(n.uw.has(e))return n.uw.get(e);throw new Error(`${e} not found in billing interval config nor contain known billing interval indicators.`)}},64684:(e,t,o)=>{o.d(t,{AL:()=>y,AW:()=>B,B5:()=>D,Ei:()=>R,Hf:()=>m,I6:()=>L,J2:()=>_,Rk:()=>f,Uk:()=>O,V3:()=>w,W9:()=>F,XO:()=>u,ah:()=>P,bk:()=>A,hY:()=>d,jI:()=>E,jc:()=>k,lF:()=>j,m4:()=>g,pd:()=>h,s8:()=>b,t0:()=>T,tO:()=>I,wN:()=>N,x4:()=>p,xC:()=>S,xf:()=>x,zz:()=>v});o(57658),o(21703);var n=o(59730),r=o(72126),i=(o(59753),o(63306),o(26825)),a=o(27006),s=o(29369),l=o(90965),c=o(97880);function d(e){return void 0===e.membership?[]:e.membership}function p(e){let{members:t,groups:o}=e;if(!t||!o)return[];const n=r.KX(o,(e=>e.id)),i=t.map((e=>"group"===e.entity_type?n[e.group_id]:void 0));return r.oA(i)}function u(e){const t=d(e);return r.oA(t.map((e=>{if("owner"===e.type)return e.user_id})))}function m(e){const t=d(e);return r.oA(t.map((e=>{if("team_level_guest"===e.type)return e.user_id})))}function g(e){return Boolean(e.archived_by)}function h(e,t){return u(e).includes(t)}function f(e){var t;let{team:o,space:n,userId:r}=e;const i=null===(t=C({team:o,space:n}).find((e=>{let{userId:t}=e;return t===r})))||void 0===t?void 0:t.teamMemberInfos;if(!i||0===i.length)return"none";return function(){let e=0;for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];for(const r of o)e=Math.max(e,s.d2.indexOf(r));return s.d2[e]}(...i.map((e=>e.type)))}function y(e){let{team:t,space:o,userId:n,groupIdsThatIncludeUser:r}=e;window.__c={n:"isNonGuestTeamMember"};const i=(0,l.kC)(o.permissions,n);if(!i)return!1;if(t.is_default&&i)return!0;r||(r=(o.permission_groups??[]).filter((e=>e.user_ids&&e.user_ids.includes(n))).reduce(((e,t)=>(e.add(t.id),e)),new Set));const a=d(t);for(const s of a){if("member"!==s.type&&"owner"!==s.type)continue;const{entity_type:e}=s;switch(e){case"user":if(s.user_id===n)return!0;break;case"group":if(r.has(s.group_id))return!0;break;default:(0,c.t1)(e)}}return!1}function v(e){let{team:t,space:o,userId:n}=e;const r=f({team:t,space:o,userId:n});switch(r){case"owner":case"member":case"team_level_guest":return!0;case"none":return!1;default:(0,c.t1)(r)}}function b(e){let{team:t,userId:o}=e;return d(t).some((e=>"team_level_guest"===e.type&&e.user_id===o))}function S(e){if(!e.permissions)return"none";const t=e.permissions.find((t=>_(t,e.id)));return t?t.role:"none"}function _(e,t){return(0,a.zU)(e)?e.team_id===t:(0,a.Ix)(e)}function w(e,t){return!!(0,a.bm)(e)&&e.team_id===t}function k(e,t){return!(!(0,a.LW)(e)||e.team_id!==t)||(0,a.KK)(e)}function x(e){let{team:t,space:o}=e;const n=C({team:t,space:o}),r=[];for(const i of n){const{teamMemberInfos:e,userId:t}=i;e.some((e=>"owner"===e.type||"member"===e.type))&&r.push(t)}return r}function I(e){let{team:t,space:o}=e;return C({team:t,space:o}).map((e=>e.userId))}function C(e){let{team:t,space:o}=e;const n={},r={},i=new Set((0,l.Mi)(o));return(t.is_default?T({team:t,space:o}):d(t)).forEach((e=>{if("user"===e.entity_type){("team_level_guest"===e.type||i.has(e.user_id))&&(n[e.user_id]=[e])}else"group"===e.entity_type?r[e.group_id]=e:(0,c.t1)(e)})),o.permission_groups&&o.permission_groups.forEach((e=>{if(e.id in r&&e.user_ids){const t=r[e.id];e.user_ids.forEach((e=>{e in n||(n[e]=[]),i.has(e)&&n[e].push(t)}))}})),(0,c.qP)(n).map((e=>{let[t,o]=e;return{userId:t,teamMemberInfos:o}}))}function T(e){let{team:t,space:o}=e;const n=[],r=new Set;for(const a of d(t))n.push(a),"user"!==a.entity_type||"member"!==a.type&&"owner"!==a.type||r.add(a.user_id);const i=(0,l.UD)(o);for(const a of i)r.has(a.user_id)||n.push({type:"member",entity_type:"user",user_id:a.user_id});return n}function M(e){return"user"===e.entity_type?`${e.entity_type}|${e.user_id}`:"group"===e.entity_type?`${e.entity_type}|${e.group_id}`:void(0,c.t1)(e)}function P(e,t){return M(e)===M(t)}function A(e){let{teamValue:t,permissionRole:o}=e;const r=S(t);if(!r)throw new n.p8("Couldn't find team's default permission");return(0,i.nl)(o,r)===r&&o!==r}function D(e){return"self_join"===e.space_member_join_access?"open":"team_members"===e.visibility?"private":"closed"}function B(e){const{accessLevel:t,isDefault:o}=e,{id:n,permissions:r,settings:i}=e.teamValue,s={type:"explicit_team_owner_permission",role:"editor",team_id:n},l=(null==r?void 0:r.find(a.zU))||{type:"explicit_team_permission",role:"editor",team_id:n},d=null==r?void 0:r.find(a.ix),p={visibility:"space_members",space_member_join_access:"self_join",invite_access:"team_members"};if(o)return{settings:p,permissions:[s,l,{type:"space_permission",role:l.role},{type:"explicit_team_guest_permission",role:"none",team_id:n}]};if("open"===t){const e=(null==d?void 0:d.role)??"none";return{settings:p,permissions:[s,l,{type:"space_permission",role:(0,a.YX)(e)?e:l.role}]}}return"closed"===t?{settings:{visibility:"space_members",space_member_join_access:"invite_only",invite_access:i.invite_access},permissions:[s,l,{type:"space_permission",role:"none"}]}:"private"===t?{settings:{visibility:"team_members",space_member_join_access:"invite_only",invite_access:null==i?void 0:i.invite_access},permissions:[s,l,{type:"space_permission",role:"none"}]}:void(0,c.t1)(t)}function R(e){let{userId:t,teamModel:o,spaceModel:n}=e;if(void 0===t||void 0===o||void 0===n)return!1;if("private"!==D(o.getSettings()))return!1;return"none"===f({userId:t,team:{is_default:o.isDefault(),membership:o.getRawMembership()},space:{permissions:n.getPermissionItems()}})}function E(e){return u(e).length<1}function F(e,t,o){return!!E(e)&&(!!(0,l.wv)(o,t)&&("private"!==D(e.settings)||(o.subscription_tier,y({team:e,space:o,userId:t}))))}function N(e){let{spaceValue:t,teamsInSpace:o,currentUserId:n}=e;const r=(0,i.aG)(t),a=o.filter((e=>!g({archived_by:e.archived_by}))).filter((e=>y({team:e,space:t,userId:n})));return Boolean(1===r.length&&r[0].userId===n&&1===a.length&&h({membership:a[0].membership},n))}function j(e){let{groupId:t,teamMember:o}=e;return"group"===o.entity_type&&o.group_id===t}function O(e,t){return t?t.filter((t=>!P(t,e))):[]}function L(e,t){return(t=(t=t??[]).filter((t=>!P(t,e)))).push(e),t}},62992:(e,t,o)=>{o.d(t,{J:()=>r});const n=new Set(["7754cf02-251f-4bc9-ab2f-9cc897765336","ba43b46e-4ad3-47f7-95f0-58a3ba01476f","86fd2f05-b95a-48d9-a2fd-9fd8aab2f74f","aa94ac95-f6b0-47f1-8211-37087c9dcba6","10e7ee2a-3beb-4b49-96f2-8b8f662aabd4","6ce5f94a-8f64-42bd-9df9-2718a97bf539","c3eec6d5-b872-4ed6-ba75-306ec8006d88","7777cfa6-76ad-4976-8ef6-8f49c217ab52","6f521ac5-cfca-4580-860b-65df285f9660","fbe283d2-7e33-41ce-ac39-4b29f194ee26","c1de9900-4b7d-431b-a470-84c5c26eefde","dfb87d56-70af-4ac6-917d-1291d8ec7354","73feb0ab-635a-4c7c-8925-0bf551c61700","f0391877-6552-4b6c-969f-4effd300e264","75aacb5d-c105-4c73-8aad-bba3df0181f8","6f040c35-60bf-432c-b30a-096d494c5960","b8cf3a52-269f-430e-8dcf-e4cc860e0884","ad3d8b0b-22d8-48d1-9146-812b7ad4faec","0bc5a2e1-f401-4179-ba2a-c99bcae55190","179b5241-bada-44e4-8928-1efd1656c38d","c9443c7b-c803-49fb-bce3-44d4e9021454","27fdba35-578f-482d-b496-a98821942c35","b72f783a-5dce-41e3-9735-2cae3fcef6e6","3d811429-6bdf-489a-8f10-832380aa873d","de1cdbdd-9c77-4f08-8211-007a2b3401c3","307087b5-e940-46bf-ae69-fe3eebe91031","566b2711-4a9c-4d1b-a9d7-a2439f358674","bb957a92-76ec-4283-aaab-7fa77deba3f1","bef399e1-8841-4a69-aa8b-1471664c582c","ee6c3e86-3fd1-4164-9351-b31ccbc695f8","35eee73a-0536-420a-a6a5-125e0aad2d54","ddc2981c-e7fd-4880-81b5-86e0c4bc2ea1","14d1a2a5-dc71-4275-9b0c-cfc5a1b13b00","fcc6e15e-257d-4260-bced-da7d6aeb7257","10a07eab-3d8f-42d2-86fe-e58aba32c6a4","a929b937-0b73-427a-afd5-1896715abc49","1f87c3fd-3c99-484d-af03-7a6296dd09af","9b8c7303-4148-4754-ae47-da98ad15ebd3","06917ea1-367b-44d4-9e74-8d0a507d0a1f","44b19dbc-c008-4dc3-a203-77d28f5c1859","c87c2638-8564-444c-88c6-8d6231da145e","f3627a1c-aa76-40d0-956d-4b305813f3b2","0bf1bac9-af83-47e9-8bd0-987732d57348","3b9a8796-0d8e-455e-af31-f5b4631ae438","4728ffef-226b-423b-a730-c71d38e71d85","835f8d33-9268-42e6-9e04-a9c9db7acfac","0f844dc5-4142-4061-9e84-e0dd1ef71d00","44ed096e-f287-46a7-9222-f8f1e519b0bb","866ce03b-d6a6-4ce3-a527-b95118b56bd7","82c3118e-5e8b-4917-a921-9e695a1853bb","72630fc1-3d80-4b39-b7de-269b1ce5d455","039fba32-3bea-4377-8b42-04ff8e5dd3f4","9f115bdc-8fa6-4272-896d-2678970d3ef8","98772d76-b111-49e4-a9db-f000e9d61b03","960c9f76-30d6-4861-bc01-ce82ba1a8591","b830a9d4-06bd-4639-ba9e-2832ee81a689","912d82c7-cd39-455d-8ff6-9742118186db","ca827af1-3833-4a3a-8e82-c02552d820f5","bb439161-a466-4571-b5da-63f84b193474","a80ed33e-3840-408e-a445-b1099ce2b9d0","f24f8158-ecde-49ef-a51a-95b6ccc0703e","bdcdf14b-1f7d-471b-b4d6-e3cd244d12a6","e15410a0-4766-499d-a513-f536544bd2f3","ef512485-d49b-448f-a038-c6c71cfddbca","5f6d17ed-543a-4395-a5a7-04b3d2a35a55","48374a18-b873-461c-9d08-0127c6553204","d3cc5d9f-1aee-4ebe-90ec-77968c058905","b3558f2a-8ee3-472b-ab47-3d05b83e47a4","caca4605-2888-4869-8dfd-ef8f1dedab70","61c5eaf1-c511-4e80-9ad9-a4aab4edd106","1a49c41e-4107-4161-ad19-7161197defa5","bf154056-b048-4a3e-bb40-f41ec111791b","0c805a36-50be-4442-9a35-ed2907d70239","72955d7d-a8c1-4e84-a5e1-db637f53781e","e5c98f03-928b-4d20-ba01-e36382468187","0fa21220-95d0-400f-9fa4-5a95a046e9e8","ff889770-d18d-4b18-9f01-905a57cd9b28","2273a46b-12b5-483b-8f67-f4842f282967","47f7d067-7741-4113-ab72-6d12b8cd5786","e609dd4f-39d7-4424-b273-6eead26c7fe9","4ba726cb-4898-4702-9e05-4e23d85fd015","d6ec9638-6bb3-4b9d-ae4f-47122405e3eb","282a4fdf-1457-4d32-88cd-51d599481d71","eb12d79d-5dff-4d0a-ba49-02c7fd72e7ac","04576141-9d17-4d7c-a499-79590630e9fa","e0513925-3754-4cdc-8213-398c81f89d1b","25154d3e-5937-43f2-a47e-11509f34ce5a","59fd9e00-4b34-4e8d-bf9e-26b86323fd81","07b1a6c5-3526-4272-a35a-127684cfbcfe","e9642cc5-1342-4e34-b0c4-585321151347","a2bbdea8-2e03-4df8-9b89-0569c0ffd127","6905c1f8-6e8b-4e92-b3e5-5bf3059ce472","7cb6e153-76d8-4f11-9c3c-2f0c3b816ddc","8c37f1d6-19ee-4de0-a851-65ddbef0d642","1b65b28b-db02-4a9a-b596-26bd59ec9ce0","1d32c0de-c904-4e01-b56f-759c643c20ca","14fc89bf-4a6a-44ab-b9f4-79c5f997a73a","c352dfd4-67b1-413c-88ea-f7bf2ec8a3e0","bdb36fd4-ac83-4c8d-b83b-2884fa63f0fd","f7bdcac5-3454-4ffe-904e-ad4fe91b4b53","ea04b311-11bd-4872-9ab7-c15faadc3e3c","b03f9c77-daaf-432a-8573-71a931204d98","89238317-2b73-4ca7-922d-7c6df95f6bdb","33f2c6ca-7a7e-44d0-ba49-8e8e2897c91f","70b3c08c-cd4a-40db-9c2c-0029a23ba970","8de1c223-226e-46f6-9f16-36847f42b99f","4175a9b5-ea6e-489b-a2b1-70db5518f9db","f582c072-525e-4412-8f5a-68e8f9aaba9b","1b53b923-a77d-4bca-adc6-764ff78769f7","16a18cca-cacb-48ed-b1a6-72560e0ad728","cb5551ab-a47f-41a0-8a9c-ad134d77c693","75fd09a5-821f-4faa-a8f4-9f862d3892d9","75a93415-c9a4-4270-86fd-42664893cc7c","754b3d46-509e-4a4b-82d0-ec340114d5b5","42a45521-808f-4f85-9922-dc8bc583e287","a5b24576-80f8-415c-9877-45ba9d6e6033","58444e8f-94eb-4708-9f3b-6582245e6a9e","e29a8fd7-faf4-4614-9341-c55cce539b3d","f41adbea-5c0a-4b74-b222-d898d8ece92c","aa2398a2-6261-4995-bcf5-2423e8560336","cf48a687-67bd-4117-ad07-c20c0682662c","edbfd965-92a1-4291-b11e-f52d21184507","e7b453b7-98b4-4166-a97a-e99fc7bd6a35","d7768c90-8491-42af-b960-3575f5b218a7","9368e169-ec01-4953-b7dc-817398ab6e53","3477b696-40b1-4548-8ff0-a93e0d41fc25","e0ccdb5a-bacd-4d8c-875c-4f29c8786048","8fb16dba-6f02-4d4f-b69c-210a900f9e57","9a47645f-8880-4d04-8b1e-d49f9f24a524","ded667af-370f-469a-ae2b-16737d423cfe","cd19749e-355c-493a-a1a9-64be68ba9399","aa94fec7-7dba-4aa3-a444-d321c2e6e11c","68e75880-ea6b-43f6-9a62-f813972d8f40","8c6f9188-eaff-426b-9d81-a14c4148a34b","b17d77ae-2af7-48e3-be6b-0c70b1dadd61","3e2349d2-0ca4-47ed-b4b9-817e5daafb19","5fd0af8d-72f1-4b7e-8246-4c46b651c531","e558a94c-6104-4bfd-b97b-ac7a2cecce35","cb137291-1ad2-4c35-b496-6f87a469c1b2","a7d3d253-0bfd-4c9d-a9c3-3459ec3ee8d8","3a966f53-355f-4a2e-a25a-4afce1ea4a0f","eea1c2a4-4992-459e-bf8c-735bf96abbe9","57c9d2f6-7086-4d8e-9d5d-1eca18ec8891","06334913-07b1-4622-9b2a-370cf56f0007","74dfb5af-738b-4a0e-916b-ce1970ec85cf","ba72173e-c456-46e9-92dc-73185c654d77","1887f846-11e7-4ab2-b816-c2e8c724718e","9ac64262-cad7-44f3-bfae-96dabec9e770","5b51de44-604b-4a96-b421-9f3e3cf470d2","b9626438-4451-441c-9608-35ab50e3b182","eb402bfa-b46f-4f51-878c-37aef629d3fa","89c371f3-766b-4dab-bde6-d23a97952cd5","ff21bacf-9b2b-4dc2-a715-02cf94e08015","87c07fd3-dcb2-4ba2-8855-927206bfba62","ea69e9ee-ee67-4f2d-83f6-7f862a8495ff","958b2624-6de2-44c8-bf07-ce363d450a28","67a391bb-2b1e-4fb6-b032-dc006e236e6e","e1218662-df9e-477c-bf3d-805e9b420911","697d17c4-4597-4949-9c24-c220aefc31f7","3d6561ad-7ea5-4c0e-9b9d-3280be3ffcc7","0f12132a-db77-4cdb-8b24-449d623a9010","05017ffd-160e-48c5-a6cf-67d04a45f53f","92cc7ea8-55a1-486c-a2ba-71c5093628aa","0821d4cd-353f-431c-bc63-5b51a7971bf0","4c801bb7-cb1b-45e3-a5eb-5aa31bbe1098","5c94c383-f6b2-4cf3-aff8-d629519c5fcd","b989c735-bc3a-4695-a7c2-9496aa28b8a6","a9019468-ed82-456b-854c-c08adf545757","4a898da1-68ac-4794-a30c-1fb7135776eb","aaddc9ad-2a6b-49cd-85a3-e80f4a04c5b8","6dd32bf2-72f8-4e62-bd77-870d9cc9cc99","949b3963-dbea-4abe-9590-97c7cd361209","897a2735-0e80-46da-b6f6-58fc3df53086","cdbbe77b-4b6c-49f0-a006-c1cb7c053d15","61a5c696-b407-4e63-85a8-b57f3f935cbb","42e9c365-194e-49b2-a7ac-d651f12c8cf7","fd81a9e6-b912-4f81-904c-a52526f6dbda","c46efa5f-a694-475c-8663-040a95fb807b","4adffda2-b85f-4660-b450-cfe09c9b0738","bd5cc0b9-d2e8-421b-9c88-de91dda82774","e9bc2136-0167-4fec-a72d-737571f7b027","0f93fc48-ec04-445d-94e5-ce4ed8b70c87","db3c3399-ddb8-4bae-9e89-1b0478931527","f3dfe652-b303-4177-ac57-10dff07f906f","56f414f6-20c9-40e8-8ff2-29784f768d1c","644c1c6a-8d94-4041-8dd4-5fb6a2aada91","7da30be9-2725-4226-9247-2a8fbf5d3d71","dd5540c5-fb12-49f9-b94f-5ffca3054ba5","b4f7298d-08b2-407a-9bee-50dbac0a7f00","7a950eae-90da-4885-8157-68009c201af0","8da6e187-ca72-4c85-8640-517601e1271f","046c0e5f-7098-42d1-b754-64fcc6276660","0b1a2c1b-3b18-4a55-8fa8-08fd5985aa4f","1abf52e0-b652-4629-8353-e2fc1ed8f046","bd871031-b4ad-417f-8082-5fd7bf3c805d","e8d82ad2-a010-4448-a29e-bd19ddf655e7","13d638ec-4f82-4318-bfa6-1f636643dc46","eeb6fd30-006e-4f99-b4c2-40931da53359","4c86679b-7ab7-407e-b863-2a8a46b82a8b","0a0b7aa2-bec5-46e7-949e-fd54ef7bffdc","d355b3d8-545a-4720-82f9-2a0243d72407","dc7a8827-25ac-4443-b8e1-c7de2304eb25","79ddf4d1-9031-4700-b30b-8db26a7b02af","68b8c5b5-7836-476b-8a02-af5b500aa180","e118777a-a087-4a6a-ba10-699cb73b06c4","b4d83009-a10d-4eb4-a04b-ff3dbc8e1304","1c3735df-eb4a-4a7a-ac45-a12b8c6ddbf7","412cb881-aecd-4cfd-8187-cbef4f6d70bb","3d875026-6da6-4cdf-ac18-084706a3eb24","f992976c-ecb4-41b5-ae2c-b25d48707701","90b462a0-5cbe-43d3-8de1-04926b96d492","a28036b8-5a0d-4867-9d8f-dfe034d6ac77","34e78ee8-d46b-4bd1-accb-8efffd17e7f2","1aacaa6e-3718-4b6b-9436-e5cf747a85f5","b147ba74-1764-41ec-93f2-47694e1b8ae3","f8243ce8-45a0-468f-a949-42595e728618","42496cf1-408c-45b5-9492-90985b5d933d","ee70e79d-2c8e-4307-81e3-5e8d1e6cdc4f","833ac885-ef61-4748-bd02-85e3e927a7da","da2975ce-c5eb-4f36-9ae5-541d74b0b370","edc45a1f-e2b4-4a8d-8868-c5d33027ff65","0907e06e-8884-4cdd-bc9a-766dc771049a","22f3e6fb-90b9-4cc6-bd8c-7d97998ffb9c","020a62e4-c5b4-4280-9872-3bf56fa34803","be58e424-c2ac-4835-a482-1083af3f75db","f3a92c2d-1fe4-48e6-b07e-52bf0a73735b","5b51f361-b0a8-4442-a095-4e781cdd2a38","476b5d8c-6d64-49fb-b664-d5c3b19e0dc6","bccc09eb-c3c0-43e1-a377-73ede6bfdc93","b31728b7-f4c4-4870-85dd-e4e543354fa9","4d2f560e-ef38-414b-b78c-c6b400f6d521","634abe84-7bfd-41c4-8ca8-8f2d8d548ec5","06c04e85-a23f-411c-8134-7d75ae627ebb","4c007793-6634-4891-b899-f709d3f8be13","90f9e4a2-b696-4f0c-ba98-d2856619b921","011db133-fd04-47f7-8fc1-255d2bb63e0b","652d83ae-50de-45da-8086-33749e5a8484","dc42afef-e4eb-4f39-9414-30cf73df3ec6","dd47099e-f772-48fd-97da-0396514afd22","9a0a5a76-bca8-44f9-87dc-65384c3a217c","99dcd6b6-61a3-4a17-945c-3e7be66ea38d","30b77330-aeed-45ff-84cc-fe68ff1f8f3a","f5157133-84a3-4904-97d4-07ee533ad17d","5ff9e66d-d71c-4449-825f-2f40aea916a7","05d2906c-0d7e-464a-86a7-e201ef984fdf","46500981-90b0-466c-ba96-7c8cc3abe6bb","66e403e8-7381-4576-a3a1-55b3e5562142","b8f6fce4-32fe-44d3-aa93-1f2b98735a46","9a87eddb-b5c5-4d26-9c05-2ebb3bc25c38","d7608a6b-48f4-4155-abcc-e3f816d76540","5b1ea383-85a8-49e0-92db-c5314fc2bf60","09c9fad5-8783-4bc5-823b-ee96006c988a","c6754733-1cae-447c-87f1-7dcc97ec3c91","e75096b4-c1b9-457c-a0b1-08bb16a9ccb7","184316f7-5174-4e40-ab49-9d0acc795626","1d1f0bf1-ed8d-4b28-b95d-2d45951f6bb7","e4bcde5b-a9af-4ca3-8048-84ed66114db6","fe748adb-5348-4b99-9550-eb578d1267fe","77af2dcb-2afc-4346-afed-eb4a056e6aea","4e041ef3-1f42-4185-a27c-89f919eab933","87546bbc-daa7-45f8-a9a4-1d3fb0dbccc8","c45fab4c-5aae-47ec-a2e8-3eff476212ca","83b9fbc2-90db-4d77-805e-3e5439c3cf94","81bb64e8-81e8-491d-8f87-d08a1a563293","7c02ebd1-16b2-45a2-93c0-276a9b2b802f","5ba31d6f-cb0d-404d-ba7e-470460959007","52308efd-956f-40f1-86c7-121262bfacc1","f76d2214-119e-4338-a84c-976c0f816f8d","d80b366f-38f8-4f43-b773-5fd57180ea04","7b2a23ff-8a2d-437d-927a-d3ebe2bfad75","0397fc82-ee33-457d-b0f5-ee1d6cdb96c8","c11cb495-f207-4780-b893-c049f88cb828","29927ba5-b792-45d2-a9eb-92009c88f23e","4c3cd83e-e143-4a16-9c5a-fafada32b0d1","65767cff-5517-4446-bc54-ab2783fd245e","2a5c0225-dc76-4cdf-9505-bef61cca3074","e687822e-f385-4a3a-b52f-e07dcf1eb946","85dbea68-b96e-4807-a076-fd2e76050c56","f3bccfd2-1ead-4101-8fb8-fd91e9264c47","93aaac98-cf8b-4647-bec1-75cadd34b277","5b6740a2-5ecb-4333-9971-ce9122536803","d138d7b0-547f-4a7a-aa7e-f5905d6f93d1","57ba4b5b-cda7-4fbf-a84b-d390fa8cb998","67e3ad55-b09b-45db-9e1c-d19f6cf42f75","c79374e2-375f-483d-b911-fcf31f5ab260","7cdb9ea8-6ba6-4e96-bd55-4a088f564c1a","2b8820f7-aa83-4844-aa7c-49f65e76ca13","5d695d09-8b83-4974-bbfa-e23db25c9777","965b2b54-ddd1-4aa4-ae8b-e9063f176508","cd7e1241-257f-4fb6-8a47-b58c44fa7fd8","144276a5-081a-491d-a7fe-1d2c302c3c77","48a232b8-2bc3-4e9c-8a19-3a6ea3b0a4f2","eb9db865-87c3-4c9f-8fc2-b616f33a191c","5a05fe82-51e7-4dec-be56-9ee88e1dfb09","1819b87e-93f4-437f-a576-a81829aea8a9","ad85e229-b68e-4609-b15d-7fb83cc57440","ac64ba9a-7be1-49a1-b3c7-ab03eeabb887","a04035db-bb1c-4a4f-a401-46b2852b69d5","31118d8a-d030-4990-ab6c-c1903e25f52d","b55a8da7-da4c-4f95-b24d-df30c2f45c71","d004e080-0446-4f6d-b7c1-e23a4112e42e","2229861a-a659-49b6-83f7-04532904bcaf","c627a829-9cce-40ba-9f5f-658730381474","cd180496-ae10-45de-b90d-ed645113e574","9f85c044-5eb6-43c3-8067-f3a7c605e90f","0428cf5d-33df-46de-bde7-15cdf830836e","2343e042-1a90-4156-bb85-1b4796cef497","f1559f2d-b7fa-438f-8203-314660014496","1137fddf-9bc0-4096-a8f7-60299e1045fa","933b8d80-00ac-441a-b7f1-ff89747a96ef","04530f0c-0761-4c13-8d09-9de1f762f1fb","47345698-eaa6-4dff-a289-a6166b7ed7de","73d74b26-c367-41d2-9631-8b0870281364","f871a524-8782-4e18-82bd-b37c9a02d20e","1cb94ea7-851b-47c4-9779-ca6e36ff729e","d825ee6e-087e-4529-b9c6-cc872035a99b","a0813507-dd48-4247-9e11-5591505be841","22e4f4a0-11e2-48e4-971f-45b042ab5ffe","f2cf7d5a-be29-4778-8716-2ba8052782b5","f7dcc389-593f-440f-9d0f-f2fcb13969b4","f1337a6d-af6e-4577-b393-b1b951b29caf","b0221a97-158b-40c8-9fdb-96de7f828d6f","ebeec459-313c-4cc1-b10e-1d1fd89379d2","67fd654f-5f30-4da9-a9ac-c3a00e62298d","ee5fc60a-9b57-470e-965b-016a9c78965d","1a69020b-4480-48c5-863e-0d362dadc4c5","07cedd59-44b0-4cf0-bb2f-71c15d4d959a","d9deb1c2-2e23-48c2-9df9-d45053a3d7c9","749d0431-47c8-491b-b325-2632a3450efa","3e688f6f-dd89-44a2-990b-1fbebfe4c545","49b38afa-be03-45c9-9709-e99f0fa29896","c0f9dd57-cb4c-4275-8c2c-923bf844fdcb","1224bf88-115f-4ccb-9990-9193ff2c38a5","0e60c769-183d-4657-9a98-b4348b446275","3a47f793-6767-4fab-bddd-acfd43149d5b","345b4e0a-1cd4-4bf6-9647-2830ff18d5ec","8f3857a7-54c3-4a78-8b47-5826f8886fee","dfe91161-0409-42bb-adf7-a97310d6a5e7","49a239b3-6587-4943-8518-ab1f6aa0c200","42f690d6-1db4-410d-85b7-5c89d567ecda","5632a03f-c43a-4560-86f8-9c85313f4164","5ecf0ee6-6e50-4b3e-a08e-62c57333a30c","073ca394-eaed-4b85-a191-6f44fc33ee41","538b78d9-928e-4ad4-b15a-34b37c96ab37","424d82df-9b44-41b5-b611-a1c29ee8ba3e","7a913969-1603-411f-9d1f-cea873782252","b67ce306-a79d-42b0-b2ea-030fc537611e","73aa919d-2805-4438-848b-8349c3f65fe0","c11dafa1-9f92-4f55-8fb7-4e1661bd8fa6","8d9c8281-961f-4c0f-94d3-c50222841c73","98846fb8-3d54-4f77-9d36-414234d86ef6","33b07269-76b3-44d8-9b67-8e101b1df37e","09556661-5d31-4e2b-a916-40772339c29d","a0a3bb82-6ff0-41b3-8b56-65bfad9bddfe","0de62cce-27ed-4c27-a27c-ad4ff7df3cb3","cfaa64e2-78ef-4426-a6a5-9c97b9416a9c","fac15e0e-1c6d-4f78-8b8b-0f64c67559e8","628a2e25-26d3-4ad2-af01-47435cb033aa","7d775bff-9e67-4e9c-bdf6-657139b0c7e3","c69ae828-ce06-417b-8d30-193e8f051c03","4d3d6a95-ba15-4d1a-ab3f-c62584729c22","40b390b6-94d7-4328-879a-4c44fc289ad4","fdebe0c2-395c-425b-ab3b-b460431c9f62","8885799b-3107-4637-8d53-e1a9c3699875","b6f9434d-abba-4b06-b4c5-802dd940be7c","f563cfb6-381f-49ba-85b1-7a59d873d828","5964fc7d-d005-414d-8ddd-f600e78816fc","26655761-99f0-4668-abd0-e86f18515d7d","a9fdbb7a-f803-49ba-b75d-cfa1a3742687","a17cce9b-db68-45da-8f95-44470ab22288","92fe12c4-d11f-4721-830f-acc1dc7ae238","fe508199-026a-4d25-8f86-4863e133ec55","a3d9e508-d6aa-43f0-81cd-bc04671db8e3","8131a139-1b1c-4eda-a538-5f3ffd99a260","eb1a4b9f-2727-4e6e-868e-5120a6f2a48a","f8a4db90-da62-41d3-a74f-fd50fc4f5458","b5c44d60-6655-4f28-a7a0-edd81828f572","6338cbe2-021e-406d-9bb8-88f1ddf0cbbe","51e3a828-8857-4d4c-907f-289e425fff1a","5ca2c593-796b-4ec9-a6af-0f9b56419b9b","41ecdb08-d684-418c-ae6a-6e459f7b7e39","b0df2874-6a4a-41f0-ab0a-74ffd9a58638","814f566f-c8da-4034-8ea5-dc73d1041280","7d3ffe57-f411-4116-97b1-5da284fb32f5","2731005d-3f2c-4d59-af95-857605008540","5c186c47-5c84-44c6-9019-fb1eda5ab042","4ae28606-869e-475e-aa55-6497ecb88ffc","1e9e7223-cf3f-4483-a682-c4da7477279f","e1473692-e4ad-40e2-a560-349cf8f67dbb","ed8ae3e6-b566-4e62-987c-f5d529774521","4e4db2c2-8ccb-4bfe-ae24-3562d9bbc9b1","7293bd3a-0389-4060-862d-33fc45dde040","c969b419-b18f-42cb-99cd-d361018bd4be","456f3b5a-9909-4d60-9810-7a8604038228","32b5f3ee-c089-4dbf-9f4d-afc4753d3ca6","35489a7a-2c8a-46f0-9ac7-b057f8310ddc","2278e74f-c3a5-46de-bc28-c6f4248b1f00","37dd0d04-d5bd-40a7-b057-3aa0ce27c438","f30afd5d-3d43-476e-96ba-30f31569e913","93c85785-8b2a-4305-b81d-f42431891bc0","b14624c2-72fa-44e9-a8ec-c9d82657e130","6dc57f42-9f7b-40e4-ab76-053508dd1cfb","17047d04-360c-41a4-b396-798269d987c5","15978e45-60a6-486a-bdfe-71c6359eae43","cd0038d3-3aff-4bce-aedf-d2caabc0ff24","38ccea82-6607-4013-a099-9e1d2dba1c29","bf90ab92-062f-4db9-bad7-bbf3d2de6203","c5a2d542-031b-465e-8227-e25357b6824c","e267772f-7f8f-4ff2-8420-8a74e70cbac6","f9131d21-248c-48ee-a7d2-0a955bc18143","e82516e0-a77e-481c-87f3-0c6111a60dee","78d7784c-3e69-4e7e-951e-b141fc903c01","5a86d993-6611-4359-b89c-090341d3cad6","60f6e613-1c1f-4e0c-ade6-c1d1df66c942","4f47a4f1-f305-4c53-a102-4c87a1140962","899c1257-4bd8-413e-8c22-15217d3bf246","dc37be6e-7432-43db-a5c4-85c3a61a41bf","b9a001df-14be-44a2-bd41-a91ecd393375","45efbfa5-1720-47fe-ae18-37f7997f2a9a","0da47389-92f1-435f-acb6-b6b88feb8cc3","18819350-9c15-44ef-9d3e-bea11c4f2a31","bad9dc3b-5768-4d3b-b929-cc30b44c6780","2c27388a-7069-4004-b793-7a46d671b9cc","8f94bda0-a5c9-4d38-9367-f76ba52212e5","c6717003-5b76-4978-bd64-e45a9815d9ad","2d189307-1cf8-4374-9357-32f7f719fdaa","4d6f6eed-8b98-4db2-82af-3c4459822a67","05932da9-e597-4c69-97bb-3178abe38ba7","76736415-9cd4-405e-92cc-36ef7fd42af7","35c2b473-7820-47de-b4e4-04001621ad86","c59c055e-e32d-4a75-9637-672fc770456a","927d26d8-a163-40cc-b8c0-95aae0d4c11e","9d09f6b8-402d-4023-8277-d73ef25bfadb","439e0c29-cea7-411a-8c43-f45fa2151183","d6ec245c-cddd-440e-b0b1-81330cb4a693","830701d2-8642-447e-9b42-41bc8cf0df9a","9a6bd000-39e6-4336-9bce-bfc1e0e4f59f","85770327-8f9d-464e-b0c1-5b8e9959e881","4867da7c-1548-4c15-afe2-105d99fca78c","34df3977-43be-4bcb-a7d8-89ef602f253d","7396298f-9fa6-48de-bc19-f7a13bd5ba35","44ee4609-b70a-4577-9728-a9d62330a30e","2c3e349c-e1ea-4089-b4af-20ba6836c694","250c35ee-2fa5-4eb9-b0eb-c7e46c240f3f","e4091305-7e34-41c2-b2e0-7eb6543f4710","02beaf98-46f4-4de2-a54b-9c6369d5409e","d6a2cc8c-7689-4cd5-802d-64373cf7ce8e","36e2df71-8508-4161-b4e2-cefb95aa211e","dafcf971-afd9-4346-a02a-198a71c4fd1f","813ff5ba-c59d-4597-98a9-a349a4b4008a","09c278d6-282b-4553-b1a3-0ecc88adb1ae","e578ce9a-42cf-4124-bc61-c6eb083de860","c25d1c6a-0ff7-4fce-9a3b-6f0d8669f75b","deb12fde-ed41-4923-970c-b8f29dbaea2e","8d3de27b-fb2f-40a8-9527-7c20df05cc8d","00ea135f-a479-45e1-a548-1f22f49ff99b","2bdd0d05-3d1f-4d51-a699-9e69435aab0c","8c371dbd-1a3c-402e-aa75-331025962d7b","83d0a451-567a-4e25-895a-62ead41abb09","310a39f7-be67-47aa-a92e-178da5267ee4","27e68f03-e28a-465e-a81f-336307432807","9f020f1c-ed8e-43fe-a4a0-1ba5c1b005e4","3348bfc5-29f4-4a7d-bbab-72c173fc43f2","24c2d68c-ea31-430c-a60c-718c61628680","bfc49a80-d536-48df-a7bb-b6e6b76a865f","6f5ce424-89c3-4459-ae53-a4945b232dae","c5906279-6c27-40e9-81e0-b440b781dddd","cadf74c9-8649-4b86-9eee-c1484a480745","460843c7-1b6a-4089-8f59-3413e3a5b6f4","6fae06c8-6ad4-47ba-82dc-8af74c6f6834","0e67e333-1728-4aa8-ac78-78a80bfaf00c","f04f5325-8bef-4a11-8dd1-7aee77bd888b","e3fa9fd5-10c3-4e52-88ae-9cb554776ba5","c9d27ef3-e2d0-4f15-9b26-76c6a0ef5c76","01f003ec-b90a-426b-b4f3-963bdb77a0db","4af52f7e-86d4-439f-9ff4-e11717f1c78f","8e76bce7-7c70-4854-aabc-ba8772740776","01fefbbd-9750-4fdd-a775-ccc4b2f43ea8","d77b6817-b98c-4827-a163-f4bfc77b5785","cf30353f-7429-4e89-b992-67b7dbe6ecca","a9056d36-db54-4e74-855c-6749a363dd21","6e424ac3-047a-4b53-b527-0d3689f94f3d","6eaa925a-29af-4359-9560-b8347e47f6fe","92b29e7d-c8ba-4cf2-a42c-f7e885704f63","32fbf9b8-4d95-4c94-9c0d-4ade7df6f586","f579b995-1c59-47d0-aca2-0d5c7b7802d9","4fad536a-fbdb-4acd-8e98-c71f64a8c88d","52d017d6-c4f9-4250-b478-b587d0ab6130","328ceba1-e265-457a-882a-41bbbb0e13e7","f281bde8-1b22-455f-ad21-843533f32437","bc5feb55-c4d3-4f3c-b07f-d160e1d4fb69","53368c52-10b3-4fa8-81d9-d6dca66bdd8b","d7d8b44d-0d19-421e-b3b4-4cb27442e225","75748896-5a01-4af3-8ff1-e63a8448acf6","7f1895e0-ba4e-48ac-85fc-8f8491b8d136","a504ed15-cddc-408f-8521-f302c6013c59","4aeb7590-be76-4ed6-bf30-339680701d77","4b9f4739-40d3-42c2-9868-605478b8dfb7","90bedd71-d96a-4b6a-a8eb-b783151461e6","4b9b3c6f-43c0-4652-9e0c-c308dc5bd091","89194e22-7505-4e71-9089-b2b21473ae2c","6efa3aeb-a5e6-4deb-9995-12bdee1bc77c","813736a0-b2f8-4998-b526-a0702f07f3f7","d99ec63a-e805-40a6-bb2f-c15a589241e0","269bb4b1-693f-4e47-844b-f181b6c92137","3bb69b37-9033-4507-8777-1a290c2074cb","5b31bc69-877b-41d5-a9c5-94460219ca5b","55258282-a6c6-4a33-afbf-70a927aa4c7a","1b74ea0a-9cd0-4f35-8070-cbed478058b1","91f94047-dcef-4d55-a243-9222d57dea3c","626a046b-e7ad-4795-af3a-9676745688b1","cd8e1b6b-7c3a-4e27-8473-c927becc83e8","2c76610c-703f-4246-9937-d21590f8dfff","ec844790-40e3-4651-8ac8-0263bf457b50","229e1236-0e31-4ca9-87a9-14566d3eb47e","805ed1ef-3805-4d0a-a165-9113872dd4d9","3f8bd200-0916-427d-9faa-fc20e4e17491","3dc84eb4-3ca6-44e8-80b8-85a74f989a5f","ab72f8f7-2e66-4adc-8056-5034b9417e87","ffd13238-71af-4015-8cb7-a633ead39d75","cc0f64ab-f56d-4dae-87e9-b77931ce4b7c","2007f60f-317f-4c63-9d0a-a9fec1968026","0af9b723-7a50-4db6-88d3-ca9eac2521d1","b1e3b467-7928-44ee-b131-d4689d2c9fbb","64de2a69-5822-47e2-affb-0138152703a2","003222f5-d07f-4347-a61b-bcabb3b852c1","66ed0ce7-e2b1-4c7a-bd7a-6e1901de2400","397ab7e2-065b-47c4-87d1-1b3119d20e7d","e96547f7-1f3d-42b8-a4ca-9bfbf2c0728e","36cd4db0-a61a-4b36-bbb0-0f87d0a7b7e0","00e361f1-9021-450e-bf35-fe48f1fb6844","ce6bbda4-1b44-44fa-983e-e5f37b89895b","4cd0eced-e273-46c2-84f5-a7efd7fbdd2f","82be252e-5184-44cd-a91b-a7d6ffdefac6","bea8efd0-61d7-495b-a255-5c1f40753cf7","12a6eaa5-30f7-419b-aee7-1be2dbc7278c","75db54d0-46ad-43b1-8ef0-7556ce0e9069","89ba9061-3275-4d76-966f-11691fdfd72f","0eb824c6-f768-47bc-9204-d94dbb912c6e","09f3541c-8edb-4603-9bc3-02bd22cd7836","b13cc3bd-a0a3-4b61-b482-63051d7804b5","b2b10be2-1b2f-4a48-a453-532657bd8e92","a00ebb82-58f2-4b40-89ee-a65be3befabf","6d1f21ba-36cf-4c90-9ecb-d5e377942f3a","50a76940-a26e-443a-b752-1412855e6ad7","30fa18a6-609e-4f5b-af3d-31906c46fe23","3afd60d5-3ce7-431a-b812-2c836b7596a3","dd2f1d05-d4ef-48a0-899c-10fe0346a447","ac411712-ee48-4589-828d-b4e5827efc17","0c5be7d7-cfcf-417b-824a-1a280254a58e","35c18cd6-99a8-47f3-91ee-40dbfec922fa","017372b2-9d34-4118-ad13-9b8e15c30ebd","035cfcde-4292-4905-82b2-6517e58a28b9","bd0b93b9-a0e9-4582-a164-98acdc7a5b45","ecdfe65a-28ee-46d2-a82b-99573e3dd63d","56dd4a06-5073-46d2-8aca-8e37d90e5610","1f8febec-2e84-4be2-a67d-7b5165845a4b","ee67a0e4-8343-4dd6-9636-9504cae6c573","eabf4d1f-9a77-441f-88fb-de9e9e0dc26e","56ba9c1f-2a28-4d05-910c-e89fb051327d","07ffa801-adfb-41f3-809b-87f69ae9e9cd","27fa9add-6ec7-433a-88c9-58279f5055c3","24c31e38-d546-423f-b3cb-a0533e711d02","6e87073b-2877-44d1-9df7-2dd266bb35e3","d6367cec-2e43-4558-882d-fb9a00545fef","172fd543-704b-489a-8d2e-7d1255f51bef","8f27f9ff-57f2-4c07-ad65-55c7f7f7501f","24f220ca-372b-4003-8e74-13291220c778","e16c2241-0f08-4946-908e-c5e6612b0a8c","2e568628-70b1-4f35-934e-81ea4263d0e8","3d8c8d33-f904-41f7-a3ff-b6272c633079","9aefc3b4-f172-4917-b1c7-495c26ec37f9","4453c56e-831c-4203-83fc-9736e276b7dc","6239e7bb-e6a6-4cb4-b4fa-236035bad7f7","95dafcd5-6243-4838-bea1-8e19b0596f6f","34d8ae09-8161-49ec-ae2d-c188c477bb90","cb2a5d30-074f-4c07-97b5-61147e0ea504","e950a58c-0d6f-42c3-8225-9e7adc5d4182","bfe1c963-57ad-4ed2-a9f9-65a3e65f61fd","4ba67e59-362e-4fee-9a67-da423ceefa54","6e41b1fc-a49b-491c-a312-13578c137ab4","037b290e-c8e2-4985-9859-83c40b32b47a","ed447931-f637-4b99-ad61-a2d9d6292ed9","46bcda2b-ec7a-47cc-bcd4-255bb39d310d","61430569-a0c3-4804-a0a3-088135cbbf3e","8e9658b3-1879-43ee-8dd0-aa453db5102d","d8d61f33-8960-4603-849b-b4d1f13a6d36","ece03bf4-b8b2-477a-abe6-125ed58de706","e7bd67f9-1c39-4ac0-b9fe-3441fa74bc14","1ac86639-060b-4e5d-8801-5dd0a40743ff","3ebbe91c-2198-4cd8-8558-ca0b7b47464f","c3762916-2f17-40e0-bd88-12b9442756fd","fe341c1f-ce4e-4845-a24a-802d106b1c80","b5bc1d11-c24d-4523-b371-22c3ee0c4253","0c017ea5-219e-4212-bfdf-89f2ea88187f","39365f4f-a881-461b-97e5-d9aa4ff49498","37f70389-a5e2-4fb8-840f-8cfe940662ef","5ab11760-87f6-4b8a-ae84-206e92aa9009","2486c8b2-de46-4f07-8df9-00ac5080303e","453e1a27-0815-46a0-a5ad-b55267008588","a91e6b04-d782-4974-b523-6c4519a54f50","2c2559b7-77fa-4a0b-877b-2b9769a0caab","ff21f4c6-5ca3-4bb6-b795-aeb1c5b2fe06","845cb0c6-34d2-46fe-9d44-adc3dc124c80","64917ef4-eb94-4a23-a8dc-cb07d7756103","6c5d4d64-558f-4925-8168-b1a96613b0ad","ffb3e282-814e-4b16-a707-5efb54961ba7","7ea58f0d-22f4-4c96-8188-42319c1509ae","1e371f92-dae2-43d6-b029-3d4d1ac8acd9","47a3e557-3e63-45f6-beeb-f7f767589a83","d6070391-2f76-412f-b5a5-bccbfcafc4e5","a96635d9-4dfb-4970-9671-b8f64a5c080c","2238e3ac-7da8-4c47-a13f-854c0576fbd4"]);function r(e){return n.has(e.id)}},94826:(e,t,o)=>{o.d(t,{Bb:()=>c,EY:()=>b,I$:()=>_,RW:()=>w,Uw:()=>S,ZB:()=>y,uw:()=>x,z6:()=>k});var n=o(15070),r=o(5366),i=o(4615),a=o(97880),s=o(64002),l=o(63143);const c={headers:{authorization:{prefix:"Bearer"},hmac:!1,extras:{}},body:{path:["event"]},urlValidator:function(e){return(0,s.yn)(e)}},d=(0,r.defineMessages)({nightfall:{id:"temporaryWebhookIntegrationConfig.taglines.nightfall",defaultMessage:"Simplify security and compliance with Nightfall AI"},panther:{id:"temporaryWebhookIntegrationConfig.taglines.panther",defaultMessage:"A SIEM built for speed, scale, and flexibility"},sumologic:{id:"temporaryWebhookIntegrationConfig.taglines.sumologic",defaultMessage:"Secure and protect against modern threats with cloud-native log analytics"},splunk:{id:"temporaryWebhookIntegrationConfig.taglines.splunk",defaultMessage:"The unified security and observability platform"},datadog:{id:"temporaryWebhookIntegrationConfig.taglines.datadog",defaultMessage:"Detect, investigate, and automate response to threats at any scale"},polymer:{id:"temporaryWebhookIntegrationConfig.taglines.polymer",defaultMessage:"Protect sensitive data across cloud apps and reduce the risk of exposure"},onna:{id:"temporaryAdminIntegrationConfig.taglines.onna",defaultMessage:"Connect. Find. Act."},hanzo:{id:"temporaryAdminIntegrationConfig.taglines.hanzo",defaultMessage:"Manage Risk Everywhere Work Is Done"},aware:{id:"temporaryAdminIntegrationConfig.taglines.aware",defaultMessage:"Secure Your Digital Workplace. Drive Growth. Scale AI."}}),p={id:"a2768733-a1f9-4174-84fa-40a9ff2053d7",name:"nightfall",icon:"/images/external_integrations/nightfall-logo.svg",website_url:"https://www.nightfall.ai/",signupUrl:"https://www.nightfall.ai/integrations/notion",privacy_policy_url:"https://www.nightfall.ai/privacy",terms_of_use_url:"https://www.nightfall.ai/terms",developer_name:"Nightfall AI",installation_info_url:void 0,type:"dlp",tagline:d.nightfall,webhookUrl:"https://notion.nightfall.ai/notion/v1/event",customization:{headers:{hmac:!0}},allowedBotCapabilities:{webhooks:!0,read_content:!0,update_content:!0,read_comment:!0,insert_comment:!0,read_user_without_email:!0,read_user_with_email:!0},allowedEndpoints:["public_getPage","public_getPageProperty","public_getBlock","public_listBlockChildren","public_getDatabase","public_getSelf","public_updatePage","public_updateBlock","public_deleteBlock","public_updateDatabase","public_listComments","public_createComment","public_deleteComment","public_updateComment","public_getComment","public_unsharePageFromWeb","public_removeGuestsFromPage","public_getUser","public_external_deleteExternalBot"],acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations/nightfall-ai",redirectUri:"https://app.nightfall.ai/dashboard"},u={id:"fb50a39e-955a-4b9c-9ffb-49587de2a79c",name:"panther",icon:"/images/external_integrations/panther-logo.png",website_url:"https://panther.com/",signupUrl:"https://panther.com/product/request-a-demo/",privacy_policy_url:"https://panther.com/privacy-policy/",terms_of_use_url:"https://panther.com/terms-of-service/",developer_name:"Panther",installation_info_url:void 0,type:"siem",customization:{headers:{hmac:!0},urlValidator:function(e){if(!e||!(0,s.yn)(e))return;const t=new URL(e);if("https:"!==t.protocol)return;if(!t.hostname.endsWith(".runpanther.net"))return;if(!t.pathname.startsWith("/http/"))return;const o=t.pathname.replace("/http/","");return(0,i.t)(o)?e:void 0}},tagline:d.panther,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!0,integrationGalleryUrl:"https://www.notion.so/integrations/panther"},m={id:"3ecda536-3b09-4218-a756-bda416c512d7",name:"sumologic",icon:"/images/external_integrations/sumo-logic-logo.jpeg",website_url:"https://www.sumologic.com/",signupUrl:"https://www.sumologic.com/sign-up/",privacy_policy_url:"https://www.sumologic.com/privacy-statement/",terms_of_use_url:"https://www.sumologic.com/terms-conditions/",developer_name:"Sumo Logic",installation_info_url:void 0,type:"siem",tagline:d.sumologic,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations/sumo-logic",customization:{urlValidator:function(e){if(!e||!(0,s.yn)(e))return;const t=new URL(e);return"https:"===t.protocol&&t.hostname.endsWith("sumologic.com")&&t.pathname.startsWith("/receiver/v1/http/")?e:void 0}}},g={id:"ff522b0f-e688-4986-9b7d-255627316f73",name:"splunk",icon:"/images/external_integrations/splunk-logo.jpeg",website_url:"https://www.splunk.com/",signupUrl:"https://www.splunk.com/en_us/talk-to-sales.html",privacy_policy_url:"https://www.splunk.com/en_us/legal/privacy/privacy-policy.html",terms_of_use_url:"https://www.splunk.com/en_us/legal/terms/terms-of-use.html",developer_name:"Splunk",installation_info_url:void 0,integrationGalleryUrl:"https://www.notion.so/integrations/splunk",customization:{headers:{authorization:{prefix:"Splunk"}},body:{path:["event"]},urlValidator:function(e){if(!e||!(0,s.yn)(e))return;const t=new URL(e);if(!["http:","https:"].includes(t.protocol))return;let o=t.hostname;return o.startsWith("http-inputs")&&o.endsWith(".splunkcloud.com")&&(o=o.replace("http-inputs","").replace(".splunkcloud.com",""),!(o.length<2||!o.startsWith("-")&&!o.startsWith("."))&&["/services/collector/raw","/services/collector/event"].includes(t.pathname))?e:void 0}},type:"siem",tagline:d.splunk,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!0},h=["public_exportPage","public_workspaceSearch","public_getUser","public_listUsers","public_listTeamspaces","public_getPage","public_getDatabase","public_getSelf"],f={workspace_search:!0,workspace_page_export:!0,read_content:!0,read_user_without_email:!0,read_user_with_email:!0},y={datadog:{id:"97d68716-a483-4472-8fa9-da26215d721a",name:"datadog",icon:"/images/external_integrations/datadog-logo.png",website_url:"https://www.datadoghq.com/",signupUrl:"https://www.datadoghq.com/free-datadog-trial/",privacy_policy_url:"https://www.datadoghq.com/legal/privacy/",terms_of_use_url:"https://www.datadoghq.com/legal/terms/",developer_name:"Datadog",installation_info_url:void 0,type:"siem",integrationGalleryUrl:"https://www.notion.so/integrations/datadog",customization:{headers:{hmac:!0}},oauth:{sendScopes:!1,accountInfoPropertyNames:{accountId:"dd_oid",accountName:"dd_org_name"},usePKCE:!0,apiDomainsByRegion:{"https://app.datadoghq.com":"api.datadoghq.com","https://us3.datadoghq.com":"api.us3.datadoghq.com","https://us5.datadoghq.com":"api.us5.datadoghq.com","https://app.datadoghq.eu":"datadoghq.eu","https://app.ddog-gov.com":"ddog-gov.com","https://ap1.datadoghq.com":"ap1.datadoghq.com"},tokenPath:"/oauth2/v1/token",apiKeyPath:"/api/v2/api_keys/marketplace"},tagline:d.datadog,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!1},nightfall:p,panther:u,polymer:{id:"9fb229bb-d287-45de-82f1-7331e99d9c6b",name:"polymer",icon:"/images/external_integrations/polymer-logo.jpeg",website_url:"https://www.polymerhq.io/",signupUrl:"https://www.polymerhq.io/request-demo/",privacy_policy_url:"https://www.polymerhq.io/privacy/",terms_of_use_url:"https://www.polymerhq.io/terms-of-service/",developer_name:"Polymer",installation_info_url:void 0,type:"dlp",tagline:d.polymer,webhookUrl:"https://umalik.dev3.polymerhq.io/notion/oauth/webhook",integrationGalleryUrl:"https://www.notion.so/integrations/polymer",allowedBotCapabilities:{webhooks:!0,read_content:!0,update_content:!0,read_comment:!0,insert_comment:!0,read_user_without_email:!0,read_user_with_email:!0},allowedEndpoints:["public_getPage","public_getPageProperty","public_getBlock","public_listBlockChildren","public_getDatabase","public_getSelf","public_updatePage","public_updateBlock","public_deleteBlock","public_updateDatabase","public_listComments","public_createComment","public_deleteComment","public_updateComment","public_getComment","public_unsharePageFromWeb","public_removeGuestsFromPage","public_listUsers","public_getUser","public_external_deleteExternalBot"],acceptsSecretToken:!1,redirectUri:"https://www.polymerhq.io/"},splunk:g,sumologic:m,onna:{id:"bb67e6bb-09f3-48fe-a7b2-428665ff20ac",name:"onna",icon:"/images/external_integrations/onna-icon.jpeg",website_url:"https://onna.com/",privacy_policy_url:"https://onna.com/privacy-policy",terms_of_use_url:"https://onna.com/master-subscription-agreement",developer_name:"Onna",type:"ediscovery",tagline:d.onna,integrationGalleryUrl:"https://www.notion.so/integrations/onna",allowedBotCapabilities:f,allowedEndpoints:h,redirectUri:"https://localhost:3005"},aware:{id:"99b8b727-7eee-40f8-af16-de045fb78e15",name:"aware",icon:"/images/external_integrations/aware-icon.png",website_url:"https://www.awarehq.com/",privacy_policy_url:"https://www.awarehq.com/privacy",terms_of_use_url:"https://www.awarehq.com/terms-conditions",developer_name:"Aware",type:"ediscovery",tagline:d.aware,integrationGalleryUrl:"https://www.notion.so/integrations/aware",allowedBotCapabilities:f,allowedEndpoints:h,redirectUri:"https://localhost:3005"},hanzo:{id:"2ebac254-9d38-4c94-b579-0eac7fe0f43c",name:"hanzo",icon:"/images/external_integrations/hanzo-icon.png",website_url:"https://www.hanzo.co/",privacy_policy_url:"https://www.hanzo.co/privacy",terms_of_use_url:"https://www.hanzo.co/privacy",developer_name:"Hanzo",type:"ediscovery",tagline:d.hanzo,integrationGalleryUrl:"https://www.notion.so/integrations/hanzo",allowedBotCapabilities:f,allowedEndpoints:h,redirectUri:"https://localhost:3005"}},v=(0,l.m8)((0,a.qP)(y).map((e=>{let[t,o]=e;return[o.id,o]})));function b(e){var t;return null===(t=_(e))||void 0===t?void 0:t.name}function S(e){const t=_(e);return Boolean(t&&"ediscovery"===t.type)}function _(e){if(e)return v[e]}function w(e){const t=_(e);if(t&&("siem"===t.type||"dlp"===t.type))return t}function k(e){return Boolean(_(e))}function x(e){if(!e)return!1;const t=_(e);return!!t&&(0,n.ms)(t.allowedBotCapabilities)}},26109:(e,t,o)=>{o.d(t,{NL:()=>a,Og:()=>i});o(67266),o(19056),o(47247),o(68955);var n=o(72126),r=(o(4615),o(70203));o(97880),o(82798);function i(e){const{existingDiscussions:t,oldTextValue:o,newTextValue:i}=e,a=n.e5(r.llS(i),r.llS(o));return a.length>0?n.G0(t??[],a):t}function a(e){const{existingDiscussions:t,oldTextValue:o,newTextValue:i}=e,a=n.e5(r.llS(o),r.llS(i));return a.length>0?n.zu(t??[],...a):t}},67175:(e,t,o)=>{o.d(t,{Qf:()=>i,W5:()=>a});var n=o(97880);const r={insertText:!0,deleteText:!0,splitTextIntoBlock:!0,splitText:!0,moveTextSliceIntoBlock:!0,moveTextSlice:!0,addAnnotation:!0,removeAnnotation:!0};function i(e){return Boolean(r[e.command])}function a(e){const{pointer:t,crdtOperation:o}=e,r=o.type;switch(r){case"insertText":return{command:"insertText",pointer:t,path:[],args:o};case"deleteText":return{command:"deleteText",pointer:t,path:[],args:o};case"addAnnotation":return{command:"addAnnotation",pointer:t,path:[],args:o};case"removeAnnotation":return{command:"removeAnnotation",pointer:t,path:[],args:o};case"splitText":return{command:"splitText",pointer:t,path:[],args:o};default:(0,n.t1)(r)}}},7250:(e,t,o)=>{o.d(t,{$A:()=>d,Jq:()=>p,Nv:()=>h,OP:()=>v,j:()=>u,oG:()=>c});o(57658);var n=o(67294),r=o(29450),i=o(65454),a=o(4615);const s={download_desktop_app:!0,download_mobile_app:!0,sign_up:!0,onboarding_show:!0,onboarding_complete:!0,gdpr_consent:!0,create_subscription:!0,subscription_update_plan:!0,subscription_update_billing:!0,subscription_update_billing_email:!0,cancel_subscription:!0,click_upgrade_button:!0,create_space:!0,join_space:!0,leave_space:!0,delete_space:!0,open_support_chat:!0},l=[];function c(e){let{getLocale:t,analyticsSettings:o,deviceId:s,onVisibilityChange:c}=e;(0,n.useEffect)((()=>{!function(e){const{getLocale:t,analyticsSettings:o,deviceId:n,onVisibilityChange:s}=e;if(void 0===o||!o.isIntercomEnabled)return;if(!(0,r.hasPermissionForThirdPartyServiceBrowser)("intercom"))return;const c=t().split("-")[0];window.intercomSettings={app_id:o.intercomAppId,user_hash:o.intercomUserHash?o.intercomUserHash:void 0,language_override:c},!o.noIntercomUserId&&o.user_id?window.intercomSettings.user_id=(0,a.cj)(o.user_id):o.user_email&&(window.intercomSettings.email=o.user_email);n&&(window.intercomSettings.device_id=(0,a.cj)(n));const d=window.Intercom;if("function"==typeof d)d("reattach_activator"),d("update",window.intercomSettings);else{const e=function(){e.c(arguments)};e.q=l,e.c=function(t){e.q.push(t)},window.Intercom=e,(0,i.ZP)(`https://widget.intercom.io/widget/${o.intercomAppId}`)}s&&(g("onShow",(()=>{s(!0)})),g("onHide",(()=>{s(!1)})))}({getLocale:t,analyticsSettings:o,deviceId:s,onVisibilityChange:c})}),[t,o,s,c])}function d(e){if(y()){const{userId:o,userName:n,traits:r,settings:i}=e;if(!i)return;var t={};n&&(t.name=n);const a={email:i.user_email,user_hash:i.intercomUserHash,...r,...t};!i.noIntercomUserId&&o?a.user_id=o:delete a.user_id,Intercom("update",a)}}function p(e){if(y()){const{companiesData:t}=e;Intercom("update",{companies:t})}}function u(e){const{eventName:t,eventData:o}=e;y()&&s[t]&&Intercom("trackEvent",t,o)}let m=!1;function g(e,t){if(y())Intercom(e,t);else{l.push([e,t])}}function h(e){const{prepopulatedContent:t,waitForCssInsets:o}=e;g("showNewMessage",t),!m&&o&&(m=!0,f((()=>o())))}const f=function(e){g("onHide",e)},y=function(){return"undefined"!=typeof Intercom};function v(){if(y())return Intercom("getVisitorId")}},49902:(e,t,o)=>{o.d(t,{j:()=>s,kI:()=>a});o(57658);var n=o(67294),r=o(66673),i=o(65454);function a(e){let{isEnabled:t,isLoggedIn:o,userId:a,userEmail:l,spaceId:c,sprigConfig:d,userDaysSinceSignup:p,userDomainType:u,isSpaceAdmin:m}=e;(0,n.useEffect)((()=>{if(!t||!o||void 0===a||void 0===l||void 0===c||void 0===d||void 0===u)return;if(window.Sprig)return;const e=function(){e._queue.push(arguments)};e._queue=[],e.appId=d.environmentId,window.Sprig=e,window.UserLeap=e,window.Sprig("setUserId",a),window.Sprig("setEmail",l),window.Sprig("setAttribute","SPACE_ID",c),p>=3&&p<=14&&"professional"===u&&s(m?{name:"trigger-phase-1"}:{name:"trigger-phase-1-1"}),(0,i.ZP)("https://cdn.sprig.com/shim.js")}),[t,o,a,d,l,c,m,u,p]);const g=(0,r.D9)(o);(0,n.useEffect)((()=>{g&&!o&&window.Sprig&&window.Sprig("logoutUser")}),[g,o])}function s(e){const t=e.name;if(!window.Sprig)return void console.error("Sprig not loaded, not tracking: ",t);const o="args"in e?e.args:{};window.Sprig("track",t,o)}},9163:(e,t,o)=>{o.d(t,{FW:()=>r,eU:()=>n,lR:()=>i});const n={"sprints-onboarding":{steps:[{id:"current-sprint-view-tooltip"},{id:"sprint-task-tooltip"},{id:"complete-sprint-button-tooltip"}]}},r="completed",i="dismissed"},41641:(e,t,o)=>{function n(e){return![".","#","$","[","]"].map((t=>-1!==e.indexOf(t))).reduce(((e,t)=>e||t),!1)}o.d(t,{Z:()=>n})},73123:(e,t,o)=>{o.d(t,{Fi:()=>u,Hz:()=>i,Rh:()=>s,Zj:()=>c,aT:()=>g,ez:()=>a,hx:()=>m,xX:()=>l,y3:()=>p,yM:()=>d});var n=o(5366),r=o(97880);const i=["last_7_days","last_28_days","last_90_days","all_time"],a={last_7_days:7,last_28_days:28,last_90_days:90},s=((0,r.AO)((e=>7===e||28===e||90===e?{true:e}:{false:e})),(0,n.defineMessages)({last_7_days:{id:"spaceAnalyticsUserTab.dateFilter.last7days",defaultMessage:"Last 7 Days"},last_28_days:{id:"spaceAnalyticsUserTab.dateFilter.last28days",defaultMessage:"Last 28 Days"},last_90_days:{id:"spaceAnalyticsUserTab.dateFilter.last90days",defaultMessage:"Last 90 Days"},all_time:{id:"spaceAnalyticsUserTab.dateFilter.allTime",defaultMessage:"All Time"}})),l=(0,n.defineMessages)({last_7_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last7days",defaultMessage:"last 7 days"},last_28_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last28days",defaultMessage:"last 28 days"},last_90_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last90days",defaultMessage:"last 90 days"},all_time:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.allTime",defaultMessage:"all time"}});function c(e,t,o){const n=e||0,r=t||0;return o?n-r:r-n}function d(e,t,o){const n=e||-1,r=t||-1;return o?n-r:r-n}const p=(0,n.defineMessages)({page:{id:"contentAnalyticsHeaderMessages.columnHeader.page",defaultMessage:"Page"},pageId:{id:"contentAnalyticsHeaderMessages.columnHeader.pageId",defaultMessage:"Page ID"},teams:{id:"contentAnalyticsHeaderMessages.columnHeader.teamspace",defaultMessage:"Teamspace"},audience:{id:"contentAnalyticsHeaderMessages.columnHeader.audience",defaultMessage:"Audience"},allViews:{id:"contentAnalyticsHeaderMessages.columnHeader.allViews",defaultMessage:"All views"},uniqueViews:{id:"contentAnalyticsHeaderMessages.columnHeader.uniqueViews",defaultMessage:"Unique views"},createdBy:{id:"contentAnalyticsHeaderMessages.columnHeader.createdBy",defaultMessage:"Created by"},createdAt:{id:"contentAnalyticsHeaderMessages.columnHeader.createdAt",defaultMessage:"Created at"},lastEditedBy:{id:"contentAnalyticsHeaderMessages.columnHeader.lastEditedBy",defaultMessage:"Last edited by"},lastEditedAt:{id:"contentAnalyticsHeaderMessages.columnHeader.lastEditedAt",defaultMessage:"Last edited at"}});const u={num_searches:"numSearches",num_unique_users:"numUniqueUsers",ctr:"ctr"},m={numSearches:"num_searches",numUniqueUsers:"num_unique_users",ctr:"ctr"};function g(e){return e<=1?"1":e<=50?"2-50":e<=100?"51-100":e<=500?"101-500":e<=1e3?"501-1000":e<=5e3?"1001-5000":"5001-plus"}},51454:(e,t,o)=>{o.d(t,{A_:()=>E,Bh:()=>O,D_:()=>l,E:()=>H,Eo:()=>A,Gt:()=>_,I5:()=>u,LI:()=>R,LN:()=>f,MC:()=>v,MU:()=>N,Mo:()=>P,Nm:()=>I,Nn:()=>M,O7:()=>q,Qm:()=>a,RJ:()=>p,S1:()=>C,VT:()=>m,Wd:()=>W,Wi:()=>n,XB:()=>F,XP:()=>r,Y6:()=>D,YO:()=>j,_:()=>z,_Y:()=>k,ag:()=>K,db:()=>$,eU:()=>s,eu:()=>T,fQ:()=>w,hT:()=>U,ke:()=>Y,l6:()=>i,lB:()=>Z,lI:()=>B,mJ:()=>V,nD:()=>c,ov:()=>b,p8:()=>G,py:()=>d,sL:()=>g,t8:()=>S,vt:()=>L,wx:()=>y,xP:()=>h,y:()=>x});const n=1,r=2,i=2,a=2,s=3,l=9,c=9,d=81,p=83,u=83,m=85,g=84,h=30,f=85,y=83,v=84,b=85,S=85,_=86,w=86,k=86,x=86,I=87,C=88,T=89,M=99,P=99,A=99,D=99,B=100,R=100,E=101,F=102,N=102,j=109,O=110,L=111,U=111,Z=113,V=999,q=1001,z=9999,W=9999999,H=1e6,G=1,K=2,$=3,Y=4},88642:(e,t,o)=>{o.d(t,{j:()=>l,g:()=>c});var n=o(29450),r=o(29477);let i,a;async function s(e,t,o){if(i)return i;e.planType=t,e.isSalesAssistedPlan=o;const a=(0,r.UZ)();i=a.promise,await async function(e){if(!(0,n.hasPermissionForThirdPartyServiceBrowser)("zendesk"))return;const t=document.createElement("script");if(t.type="text/javascript",t.async=!0,t.src="https://solve-widget.forethought.ai/embed.js",t.id="forethought-widget-embed-script",t.setAttribute("data-api-key","c895ee24-2c6c-4ed6-a100-3037e65cadda"),t.setAttribute("data-ft-full-name",e.fullName||"Forethought Deflected"),t.setAttribute("data-ft-email",e.email||"forethought@makenotion.com"),e.locale){var o;const n=null===(o=e.locale.split("-")[0])||void 0===o?void 0:o.toLowerCase();n&&t.setAttribute("data-ft-embed-script-language",n)}const r=e.planType||"undefined";"enterprise"===r&&e.isSalesAssistedPlan?(t.setAttribute("data-ft-plan-type","enterprise_free"),t.setAttribute("data-ft-workflow-tag","enterprise_free"),t.setAttribute("initial-intent-id","d5cb32d0-3637-4e8e-87fa-c4ea8d79d45f")):(t.setAttribute("data-ft-plan-type",r),t.setAttribute("data-ft-workflow-tag",r));const i=document.getElementsByTagName("script")[0];return null==i||i.parentNode.insertBefore(t,i),window.addEventListener("message",(e=>{var t,o;"forethoughtWidgetClosed"===(null==e||null===(t=e.data)||void 0===t?void 0:t.event)&&(null===(o=Forethought)||void 0===o||o("widget","hide"))})),new Promise((e=>{t.addEventListener("load",(()=>{var t;null===(t=Forethought)||void 0===t||t("widget","hide"),e()}))}))}(e),a.resolve()}async function l(e){if(a)return a;const t=(0,r.UZ)();a=t.promise,e.isForethoughtEnabled&&await s(e.forethoughtInitializeArgs,e.userHighestPlanType,e.isSalesAssistedPlan),await async function(e){const{locale:t}=e;if(!(0,n.hasPermissionForThirdPartyServiceBrowser)("zendesk"))return;const o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://static.zdassets.com/ekr/snippet.js?key=b9ad856d-6b98-4cf5-a2f6-d96e50557722",o.id="ze-snippet";const r=document.getElementsByTagName("script")[0];return null==r||r.parentNode.insertBefore(o,r),new Promise((e=>{o.addEventListener("load",(()=>{var o=window.zE;o&&(o("webWidget","setLocale",t),o("webWidget","hide"),e())}))}))}(e),t.resolve()}async function c(e){if(await l(e),"undefined"!=typeof Forethought)Forethought("widget","show"),Forethought("widget","open");else{var t=window.zE;if(!t)return;t("webWidget","show"),t("webWidget","open"),t("webWidget:on","close",(function(e){(t=window.zE)&&t("webWidget","hide")}))}}}}]);