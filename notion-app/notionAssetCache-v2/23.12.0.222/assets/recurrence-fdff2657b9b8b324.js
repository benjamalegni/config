"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[653],{93289:(e,t,a)=>{a.d(t,{Z:()=>o});var r=a(67294),n=a(13991),s=a(77907),i=a(85893);const o=function(e){let{firstDayOfWeek:t,value:a,selectValue:o=!0,onChange:l,disabledDays:d}=e;window.__c={n:"DatePicker"};const c=(0,r.useMemo)((()=>new Date(a)),[a]),[u,m]=(0,r.useState)(c),y=(0,r.useRef)(a);(0,r.useLayoutEffect)((()=>{y.current!==a&&(m(new Date(a)),y.current=a)}),[a]);const p=(0,r.useCallback)(((e,t,a)=>{l(e.getTime())}),[l]);return(0,i.jsx)(s.LazyDayPicker,{locale:n.SP,className:"notion-calendar-picker",numberOfMonths:1,weekStartsOn:t,modifiers:o?{value:c}:{},showOutsideDays:!0,fixedWeeks:!0,onDayClick:p,onMonthSelected:m,disabled:d,month:u})}},26803:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var r=a(30120),n=a(67294),s=a(480),i=a(86628),o=a(24405),l=a(40506),d=a(53877),c=a(42853),u=a(53523),m=a(24211),y=a(72126),p=a(4615),g=a(81491),f=a(97880),h=a(63143),M=a(5366),k=a(3992),v=a(28020),b=a(87279);const x=[{frequency:"day",interval:1},{frequency:"week",interval:1},{frequency:"month",interval:1},{frequency:"year",interval:1}];var w=a(90106),I=a(52275),S=a(31945),j=a(96525),R=a(88359),C=a(74194),P=a(3386),F=a(78140),L=a(28992),E=a(32163),Z=a(89728),D=a(72495),q=a(7931),T=a(64369),_=a(93289),A=a(84795),O=a(26388),B=a(85893);function W(e){window.__c={n:"TimeInput"};const t=(0,s.O7)(),{device:a}=t,i=(0,M.useIntl)(),[l,d]=(0,n.useState)(e.value),[c,u]=(0,n.useState)(void 0),m=t=>{const a=(0,A.parseTime)(t,i),n=r.ou.fromFormat(a??"","T");return n.isValid?(u(void 0),e.onUpdate({hour:n.hour,minute:n.minute})):(u("invalid"),e.onError&&e.onError()),n},y=e=>{const t=e.target.value;d(t),m(t)},p=()=>{const e=m(l);e.isValid&&d(e.toLocaleString(r.ou.TIME_SIMPLE))},g=(0,o.yK)((e=>({input:{textAlign:"right"},error:{boxShadow:e.outlineRedInputBoxShadow}})),[]);return(0,B.jsx)(O.Z,{renderTooltip:()=>function(e){if("invalid"===e)return(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Invalid time",id:"timeInput.invalid"})}(c),forceVisibleState:void 0!==c,placement:O.Z.Placement.Bottom,render:()=>(0,B.jsx)(C.Z,{type:"text",onChange:y,onSubmit:p,onBlur:p,value:l,size:1,style:{...e.style,...c?g.error:{},fontSize:a.isMobile?16:14},inputStyle:g.input})})}var U=a(62069),K=a(67149),z=a(7057),V=a(64921);function H(e){window.__c={n:"WeekdaySelector"};const{weekdays:t,onChange:a}=e,r=e.minimumSelection??0,n=(0,M.useIntl)(),s=(0,o.yK)((e=>({wrapper:{display:"flex",alignItems:"center",justifyContent:"space-between",textAlign:"center"},selectedDay:{...Y,background:e.blueButtonBackground,color:e.regularInvertedTextColor},unselectedDay:{...Y,background:e.accentColors.gray[50],color:e.mediumTextColor},selectedDayHover:{background:e.blueButtonHoveredBackground},unselectedDayHover:{background:e.accentColors.gray[100]},selectedDayPressed:{background:e.blueButtonPressedBackground},unselectedDayPressed:{background:e.accentColors.gray[200]}})),[]);return(0,B.jsx)(P.Z,{capture:!0,children:(0,B.jsx)("div",{style:{...s.wrapper,...e.style},children:K.Z.map(((i,o)=>(0,B.jsx)(V.Z,{...e,onClick:()=>{const e=t.includes(i)?t.length>r?t.filter((e=>e!==i)):t:[...t,i];a(e)},style:t.includes(i)?s.selectedDay:s.unselectedDay,hoveredStyle:t.includes(i)?s.selectedDayHover:s.unselectedDayHover,pressedStyle:t.includes(i)?s.selectedDayPressed:s.unselectedDayPressed,children:(0,z.er)(n,o+1)},i)))})})}const Y={borderRadius:"50%",marginLeft:3,marginRight:3,height:25,width:25,fontSize:14,paddingTop:2};const N=(0,n.forwardRef)((function(e,t){const a=(0,s.O7)(),{device:b}=a,L=(0,o.Fg)(),A=(0,M.useIntl)(),[O,K]=(0,n.useState)(void 0),[z,V]=(0,n.useState)({id:(0,p.ZP)(),start_date:r.ou.local().set({hour:0,minute:0,second:0,millisecond:0}).toMillis(),timezone:(0,d.Sv)(),hour:0,minute:0,frequency:"day",interval:1}),[Y,N]=(0,n.useState)(!0),ne=e.templateStore,ie=(0,i.VK)((()=>w.Mz.fromBlockStore(ne)),[ne]),oe=(0,i.VK)((()=>void 0===ne.getAutomationId()||(null==ie?void 0:ie.isReady())),[ne,ie]),le=(0,i.VK)((()=>(null==ie?void 0:ie.isActive())??!1),[ie]),de=(0,i.VK)((()=>null==ie?void 0:ie.getRecurrence()),[ie]);void 0===O&&oe&&(void 0!==de?(V({...de,hour:de.hour??0,minute:de.minute??0,start_date:(0,l.YL)(de.start_date)}),K(!0)):K(!1));const ce=e=>{const t="week"!==e||void 0!==z.weekdays&&0!==z.weekdays.length?z.weekdays:[(a=z.start_date,(0,f.Yd)(g.RRULE_WEEKDAYS_MAP)[r.ou.fromMillis(a).weekday-1])];var a;V({...z,weekdays:t,frequency:e}),K(!0)},ue=()=>{k.addRecurrence({environment:a,blockStore:e.templateStore,recurrence:z})},me=b.isMobile?S.Z4.SlideUp:S.Z4.Popup,ye=function(){const{isMobile:e}=(0,s.Fy)();return(0,o.yK)((t=>({iconStyle:{fill:t.regularIconColor,width:e?18:16},customFrequencySelectButton:{color:t.mediumTextColor,fill:t.lightIconColor,fontWeight:500,fontSize:12},weekdayWrapper:{padding:10},inputLabel:{display:"flex",alignItems:"center",...e?{padding:"10px 14px",fontSize:16,background:t.cardBackground}:{paddingLeft:8}},intervalFrequencyLabel:{color:t.lightTextColor},intervalInputWrapper:{width:70,marginLeft:10,marginRight:10},intervalInput:{textAlign:"right"},timeInputWrapper:{width:90,marginLeft:10,marginRight:10},inputSection:{...X,alignItems:"center",justifyContent:"flex-start",padding:8},chevron:{width:e?14:10,fill:t.lightIconColor,marginLeft:4}})),[e])}(),pe=b.isMobile?"number":"text",ge=x.map((e=>({key:e.frequency,action:()=>{ce(e.frequency)},render:t=>(0,B.jsx)(I.Z,{...t,title:J(e.frequency)})}))),fe=(0,B.jsx)(P.Z,{capture:!0,onLeft:y.yR,onRight:y.yR,onSelectAll:y.yR,onRedo:y.yR,onUndo:y.yR,onCut:y.yR,onCopy:y.yR,onPaste:y.yR,onKeypress:y.yR,onDelete:y.yR,onBackspace:y.yR,onTab:y.yR,children:(0,B.jsx)(C.Z,{value:z.interval.toString(),style:ye.intervalInputWrapper,inputStyle:ye.intervalInput,type:pe,maxlength:3,onChange:e=>{const t=parseInt(e.target.value);(0,h.hj)(t)&&t>0&&t<=g.MAX_RECURRENCE_INTERVAL&&V({...z,interval:t})},onBlur:e=>{e.target.value=z.interval.toString()}})});return(0,B.jsx)(j.Z,{...e,popupType:me,ref:t,stopClickPropagation:!0,renderOrigin:t=>(0,B.jsx)(R.Z,{...t,icon:(0,u.N)(ye.iconStyle),title:(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Repeat",id:"database.templatePickerItem.actionMenu.repeat"}),focused:e.focused,showExtensionArrow:b.isMobile,right:oe&&re({isActive:le,recurrence:de,intl:A})}),render:t=>(0,B.jsx)(P.Z,{capture:!0,onEnter:y.yR,children:(0,B.jsxs)(F.Z,{...ee(t,b.isMobile,Y,ue),children:[O?(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)(D.Z,{style:X,children:[(0,B.jsx)(q.Z,{innerButtonStyle:{...!b.isMobile&&ye.customFrequencySelectButton},selectedTitle:Q(z.frequency),renderMenuSections:r=>[{key:"repeatOptionsSection",render:e=>(0,B.jsx)(D.Z,{...e}),items:[...te({parent:r,updateFrequencyFn:e=>{ce(e)}}),ae({environment:a,parent:r,templateStore:e.templateStore,onClose:()=>{K(!1),t.close()}})]}]}),!b.isMobile&&(0,B.jsx)(Z.Z,{isBlue:Y,isLightGray:!Y,onClick:e=>{ue(),t.close()},disabled:!Y,children:G})]}),(0,B.jsx)(D.Z,{style:ye.inputSection,shouldShowBottomDivider:!0,children:(0,B.jsx)(T.Z,{style:ye.inputLabel,children:$(fe,z.frequency,ye.intervalFrequencyLabel)})}),"week"===z.frequency&&(0,B.jsx)(D.Z,{children:(0,B.jsx)(H,{style:ye.weekdayWrapper,focused:!0,weekdays:z.weekdays||[],minimumSelection:1,onChange:e=>{V({...z,weekdays:e})}})}),(0,B.jsx)(D.Z,{topBorder:!0,children:(0,B.jsx)(S.ZP,{popupType:me,renderOrigin:e=>(0,B.jsx)(R.Z,{...e,title:(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Starts",id:"database.templatePickerItem.repeatMenu.starts"}),focused:!1,showExtensionArrow:b.isMobile,right:r.ou.fromMillis(z.start_date).setLocale((0,m.E2)(A)).toLocaleString({weekday:"short",month:"short",day:"numeric",year:"numeric"})}),render:e=>(0,B.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,B.jsx)(_.Z,{firstDayOfWeek:v.AK.state,value:Math.max(z.start_date,Date.now()),onChange:t=>{V({...z,start_date:t}),e.close()},disabledDays:{before:new Date}})})})}),(0,B.jsx)(D.Z,{style:ye.inputSection,shouldShowBottomDivider:!0,children:(0,B.jsxs)(T.Z,{style:ye.inputLabel,children:[(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Create at",id:"database.templatePickerItem.repeatMenu.createAt"}),(0,B.jsx)(P.Z,{capture:!0,onLeft:y.yR,onRight:y.yR,onSelectAll:y.yR,onRedo:y.yR,onUndo:y.yR,onCut:y.yR,onCopy:y.yR,onPaste:y.yR,onKeypress:y.yR,onDelete:y.yR,onBackspace:y.yR,onTab:y.yR,children:(0,B.jsx)(W,{value:r.ou.local().set({hour:z.hour,minute:z.minute}).toLocaleString(r.ou.TIME_SIMPLE),style:ye.timeInputWrapper,onUpdate:e=>{V({...z,...e}),N(!0)},onError:()=>{N(!1)}})}),(0,B.jsx)(U.Z,{renderOrigin:e=>(0,B.jsxs)(Z.Z,{...e,children:[(0,d.er)(z.timezone),(0,c.i)(ye.chevron)]}),onSelect:e=>{V({...z,timezone:e})}})]})})]}):(0,B.jsx)(E.Z,{type:E.i.Vertical,sections:[{key:"repeatOptionsSection",render:e=>(0,B.jsx)(D.Z,{...e}),items:[...ge,ae({environment:a,parent:t,templateStore:e.templateStore})]}],initialFocus:void 0}),O&&se(A,z,L)]})})})})),X={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px"};const G=(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Save",id:"database.templatePickerItem.customRecurrence.save"});function J(e){switch(e){case"day":return(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Every day",id:"database.templatePickerItem.quickOptionMenuItem.day"});case"week":return(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Every week",id:"database.templatePickerItem.quickOptionMenuItem.week"});case"month":return(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Every month",id:"database.templatePickerItem.quickOptionMenuItem.month"});case"year":return(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Every year",id:"database.templatePickerItem.quickOptionMenuItem.year"});default:(0,f.t1)(e)}}function Q(e){switch(e){case"day":return(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Repeat daily",id:"database.templatePickerItem.recurrenceFrequency.daily"});case"week":return(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Repeat weekly",id:"database.templatePickerItem.recurrenceFrequency.weekly"});case"month":return(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Repeat monthly",id:"database.templatePickerItem.recurrenceFrequency.monthly"});case"year":return(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Repeat yearly",id:"database.templatePickerItem.recurrenceFrequency.yearly"});default:(0,f.t1)(e)}}function $(e,t,a){switch(t){case"day":return(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Every {interval} <label>days</label>",id:"database.templatePickerItem.recurrenceInterval.everyXdays",values:{label:e=>(0,B.jsx)("label",{style:a,children:e}),interval:e}});case"week":return(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Every {interval} <label>weeks</label>",id:"database.templatePickerItem.recurrenceInterval.everyXweeks",values:{label:e=>(0,B.jsx)("label",{style:a,children:e}),interval:e}});case"month":return(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Every {interval} <label>months</label>",id:"database.templatePickerItem.recurrenceInterval.everyXmonths",values:{label:e=>(0,B.jsx)("label",{style:a,children:e}),interval:e}});case"year":return(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Every {interval} <label>years</label>",id:"database.templatePickerItem.recurrenceInterval.everyXyears",values:{label:e=>(0,B.jsx)("label",{style:a,children:e}),interval:e}});default:(0,f.t1)(t)}}function ee(e,t,a,r){return t?{menuType:b.og.Modal,title:(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Repeat",id:"database.templatePickerItem.mobileRepeatModal.title"}),left:(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Cancel",id:"database.templatePickerItem.customRecurrence.cancel"}),right:G,rightDisabled:!a,onClickRight:()=>{a&&(r(),e.close())},onClickLeft:()=>{e.close()}}:{menuType:b.og.Popup}}function te(e){let{parent:t,updateFrequencyFn:a}=e;return x.map((e=>({key:e.frequency,action:()=>{a(e.frequency),t.close()},render:t=>(0,B.jsx)(I.Z,{...t,title:Q(e.frequency)})})))}function ae(e){let{environment:t,parent:a,templateStore:r,onClose:n}=e;return{key:"disable",action:()=>{k.disableRecurrence({environment:t,blockStore:r}),a.close(),n&&n()},render:e=>(0,B.jsx)(I.Z,{...e,title:(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Off",id:"database.templatePickerItem.quickOptionMenuItem.off"})})}}function re(e){let{isActive:t,recurrence:a,intl:r}=e;return t?a?(0,B.jsx)(B.Fragment,{children:ne(a,r)}):void 0:(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Off",id:"database.templatePickerItem.recurrenceConfigMenuLabel.off"})}function ne(e,t){return(0,g.rruleFromRecurrence)({...e,weekdays:void 0,hour:0,minute:0}).toText((e=>{switch(e){case"every":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.every",defaultMessage:"every"});case"day":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.day",defaultMessage:"day"});case"days":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.days",defaultMessage:"days"});case"week":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.week",defaultMessage:"week"});case"weeks":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.weeks",defaultMessage:"weeks"});case"month":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.month",defaultMessage:"month"});case"months":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.months",defaultMessage:"months"});case"year":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.year",defaultMessage:"year"});case"years":return t.formatMessage({id:"database.templatePickerItem.repeatMenuLabel.years",defaultMessage:"years"});default:return e.toString()}}))}function se(e,t,a){const n=(0,g.rruleFromRecurrence)({...t,start_date:(0,l.Io)(new Date(t.start_date))}).after(new Date((0,l.Io)()));if(!n)return null;const s=r.ou.fromJSDate(n).toUTC().setLocale((0,m.E2)(e)).toLocaleString(r.ou.DATETIME_SHORT);return(0,B.jsx)(D.Z,{topBorder:!0,children:(0,B.jsx)(L.Z,{caption:(0,B.jsx)("span",{style:{color:a.lightTextColor},children:(0,B.jsx)(M.FormattedMessage,{defaultMessage:"Next: {dates}",id:"database.templatePickerItem.recurrenceConfigMenuLabel.next",values:{dates:s}})})})})}},54983:(e,t,a)=>{a.d(t,{Z:()=>s});var r=a(49085);class n extends r.default{getInitialState(){return{}}}const s=n},81491:(e,t,a)=>{a.r(t),a.d(t,{MAX_RECURRENCE_INTERVAL:()=>i,RRULE_WEEKDAYS_MAP:()=>s,rruleFromRecurrence:()=>o});var r=a(84885);const n={day:r.Ci.DAILY,week:r.Ci.WEEKLY,month:r.Ci.MONTHLY,year:r.Ci.YEARLY},s={MO:r.Ci.MO,TU:r.Ci.TU,WE:r.Ci.WE,TH:r.Ci.TH,FR:r.Ci.FR,SA:r.Ci.SA,SU:r.Ci.SU},i=100;function o(e){const{start_date:t,frequency:a,interval:i,weekdays:o,timezone:l,hour:d,minute:c}=e,u="week"===a&&o?o.map((e=>s[e])):void 0;return new r.Ci({freq:n[a],dtstart:new Date(t),interval:i,byweekday:u,tzid:l,byhour:d??0,byminute:c??0,bysecond:0})}}}]);