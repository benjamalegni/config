"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[9380],{81346:(e,t,o)=>{o.r(t),o.d(t,{default:()=>A});o(57658),o(67294);var s=o(83355),r=o(1302),n=o(32739),a=o(70203),i=o(5366),c=o(84908),l=o(98104),d=o(95477),p=o(87279),u=o(68056),m=o(56171),g=o(758),f=o(81212),b=o(45214),h=o(24666),y=o(93405),k=o(52275),M=o(1743),x=o(78140),N=o(32163),j=o(53437),_=o(72495),v=o(85893);class I extends s.Z{constructor(){super(...arguments),this.handleContextMenu=(e,t)=>{if(e.preventDefault(),t.misspelledWord){const e=h.default.state,o="editing"===e.mode&&(0,u.QY)(e.multiSelection);if(o&&o.selection.startIndex===o.selection.endIndex){const e=a.Oqk({textValue:o.store.getValue()||[],substring:t.misspelledWord,ignoreCase:!1}),s=o.selection.startIndex,r=a.PEL(e,s);r&&l.Z5({store:o.store,selection:r})}}b.Z.setState({open:!0,menuInfo:t})},this.handleDismiss=()=>{b.Z.setState({...b.Z.state,open:!1})}}willMount(){c.electronApi&&c.electronApi.contextMenu&&c.electronApi.contextMenu.addListener(this.handleContextMenu)}willUnmount(){c.electronApi&&c.electronApi.contextMenu&&c.electronApi.contextMenu.removeListener(this.handleContextMenu)}renderComponent(){const{menuInfo:e,open:t}=b.Z.state,{device:o}=this.environment,{x:s,y:n}=this.getClickPosition(e),a=new DOMRect(s,n,0,0),i=e?this.getMenuSections(e):[],c=document.activeElement,l=m.get();let d=null,u=null;(c instanceof HTMLInputElement||c instanceof HTMLTextAreaElement)&&(d=c.selectionStart,u=c.selectionEnd);for(const p of i)for(const e of p.items){const t=e.action;e.action=e=>{c.focus(),c instanceof HTMLInputElement||c instanceof HTMLTextAreaElement?(c.selectionStart=d,c.selectionEnd=u):l&&m.set(l,o),r.default.afterNextFlush((()=>{t(e)}))}}return(0,v.jsx)(j.ZP,{open:t&&i.length>0,popupType:j.ZP.PopupType.Popup,originRect:a,render:()=>(0,v.jsx)(M.Z,{capture:!0,allowEsc:!0,children:(0,v.jsx)(x.Z,{menuType:p.og.Popup,children:(0,v.jsx)(N.Z,{type:N.i.Vertical,sections:i,initialFocus:void 0,onAccept:this.handleDismiss})})}),onDismiss:this.handleDismiss,overlayContainerStore:f.Z})}getClickPosition(e){const t=c.getCurrentZoom();return{x:e?e.x/t:0,y:e?e.y/t:0}}getMenuSections(e){const t=[],o=this.getSpellingCorrectionItems(e);if(o.length>0){const e=t.length>0;t.push({key:"spellingCorrectionItems",items:o,render:t=>(0,v.jsx)(_.Z,{...t,topBorder:e})})}const s=this.getDisableSpellCheckItems(e);if(s.length>0){const e=t.length>0;t.push({key:"disableSpellCheckItems",items:s,render:t=>(0,v.jsx)(_.Z,{...t,topBorder:e})})}const r=this.getSearchItems(e);if(r.length>0){const e=t.length>0;t.push({key:"searchItems",items:r,render:t=>(0,v.jsx)(_.Z,{...t,topBorder:e})})}const n=this.getLinkMenuItems(e);if(n.length>0){const e=t.length>0;t.push({key:"linkMenuItems",items:n,render:t=>(0,v.jsx)(_.Z,{...t,topBorder:e})})}const a=this.getImageMenuItems(e);if(a.length>0){const e=t.length>0;t.push({key:"imageMenuItems",items:a,render:t=>(0,v.jsx)(_.Z,{...t,topBorder:e})})}const i=this.getTextEditingItems(e);if(i.length>0){const e=t.length>0;t.push({key:"textEditingItems",items:i,render:t=>(0,v.jsx)(_.Z,{...t,topBorder:e})})}const c=this.getEnableSpellCheckItem(e);if(c.length>0){const e=t.length>0;t.push({key:"enableSpellCheckItems",items:c,render:t=>(0,v.jsx)(_.Z,{...t,topBorder:e})})}return t}getLinkMenuItems(e){const t=[];return e.linkURL&&e.linkURL.length>0&&(e.linkURL.startsWith("mailto:")?t.push({key:"copy-email",action:()=>{c.electronApi&&c.electronApi.copyText&&c.electronApi&&c.electronApi.copyText(e.linkText)},render:e=>(0,v.jsx)(k.Z,{...e,title:(0,v.jsx)(i.FormattedMessage,{defaultMessage:"Copy email address",id:"desktop.rightClickMenu.copyEmailAddress"})})}):t.push({key:"copy-link",action:()=>{c.electronApi&&c.electronApi.copyText&&c.electronApi&&c.electronApi.copyText(n.b({url:e.linkURL,domainBaseUrl:d.default.domainBaseUrl,protocol:d.default.protocol}))},render:e=>(0,v.jsx)(k.Z,{...e,title:(0,v.jsx)(i.FormattedMessage,{defaultMessage:"Copy link",id:"desktop.rightClickMenu.copyLink"})})}),t.push({key:"open-link",action:()=>{c.electronApi&&c.electronApi.openExternalUrl(n.b({url:e.linkURL,domainBaseUrl:d.default.domainBaseUrl,protocol:d.default.protocol}))},render:e=>(0,v.jsx)(k.Z,{...e,title:(0,v.jsx)(i.FormattedMessage,{defaultMessage:"Open link in browser",id:"desktop.rightClickMenu.openLinkInBrowser"})})})),t}getImageMenuItems(e){const t=[];return e.hasImageContents&&e.srcURL&&e.srcURL.length>0&&(t.push({key:"copy-image",action:()=>{c.electronApi&&c.electronApi.copyImage&&c.electronApi.copyImage(e.srcURL)},render:e=>(0,v.jsx)(k.Z,{...e,title:(0,v.jsx)(i.FormattedMessage,{defaultMessage:"Copy image",id:"desktop.rightClickMenu.copyImage"})})}),t.push({key:"copy-image-address",action:()=>{c.electronApi&&c.electronApi.copyText&&c.electronApi.copyText(e.srcURL)},render:e=>(0,v.jsx)(k.Z,{...e,title:(0,v.jsx)(i.FormattedMessage,{defaultMessage:"Copy image address",id:"desktop.rightClickMenu.copyImageAddress"})})})),t}isEditing(e){return e.isEditable||e.inputFieldType&&"none"!==e.inputFieldType}hasMisspelling(e){return this.isEditing(e)&&e.misspelledWord&&e.misspelledWord.length>0}getSpellingCorrectionItems(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,o=[];if(this.hasMisspelling(e)&&t&&t.isEnabled()){const s=t.getCorrections(e);for(const e of s)o.push({key:e,action:()=>{c.electronApi&&c.electronApi.replaceMisspelling&&c.electronApi.replaceMisspelling(e)},render:t=>(0,v.jsx)(k.Z,{...t,title:e})})}return o}getDisableSpellCheckItems(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,o=[];return this.hasMisspelling(e)&&t&&t.isEnabled()&&!(0,g.x)(t)&&o.push({key:"learn-spelling",action:()=>{t.addToDictionary(e.misspelledWord)},render:e=>(0,v.jsx)(k.Z,{...e,title:(0,v.jsx)(i.FormattedMessage,{defaultMessage:"Add to dictionary",id:"desktop.spellcheckMenuItem.addToDictionary.title"})})}),this.hasMisspelling(e)&&t&&t.isEnabled()&&o.push({key:"disable",action:()=>{t.setEnabled(!1)},render:e=>(0,v.jsx)(k.Z,{...e,title:(0,v.jsx)(i.FormattedMessage,{defaultMessage:"Disable spell check",id:"desktop.spellcheckMenuItem.disableSpellcheck.title"})})}),o}getEnableSpellCheckItem(e){const t="SpellCheckStore"in this.environment&&this.environment.SpellCheckStore,o=[];return this.isEditing(e)&&t&&!t.isEnabled()&&o.push({key:"enable",action:()=>{t.setEnabled(!0)},render:e=>(0,v.jsx)(k.Z,{...e,title:(0,v.jsx)(i.FormattedMessage,{defaultMessage:"Enable spell check",id:"desktop.spellcheckMenuItem.enableSpellcheck.title"})})}),o}getSearchItems(e){const t=[];return e.selectionText&&e.selectionText.length>0&&t.push({key:"google",action:()=>{if(c.electronApi){const t=`https://www.google.com/search?q=${encodeURIComponent(e.selectionText.trim())}`;c.electronApi.openExternalUrl(t)}},render:e=>(0,v.jsx)(k.Z,{...e,title:(0,v.jsx)(i.FormattedMessage,{defaultMessage:"Search with Google",id:"desktop.searchMenuItem.searchWithGoogle.title"})})}),t}getTextEditingItems(e){const t=[];return this.isEditing(e)&&(e.editFlags.canCut&&t.push({key:"cut",action:()=>{c.electronApi&&c.electronApi.cut&&c.electronApi.cut()},render:e=>(0,v.jsx)(y.Z,{...e,title:(0,v.jsx)(i.FormattedMessage,{defaultMessage:"Cut",id:"desktop.textEditingMenuItem.cutAction.title"}),shortcut:"cut"})}),e.editFlags.canCopy&&t.push({key:"copy",action:()=>{c.electronApi&&c.electronApi.copy&&c.electronApi.copy()},render:e=>(0,v.jsx)(y.Z,{...e,title:(0,v.jsx)(i.FormattedMessage,{defaultMessage:"Copy",id:"desktop.textEditingMenuItem.copyAction.title"}),shortcut:"copy"})}),e.editFlags.canPaste&&t.push({key:"paste",action:()=>{c.electronApi&&c.electronApi.paste&&c.electronApi.paste()},render:e=>(0,v.jsx)(y.Z,{...e,title:(0,v.jsx)(i.FormattedMessage,{defaultMessage:"Paste",id:"desktop.textEditingMenuItem.pasteAction.title"}),shortcut:"paste"})})),t}}I.displayName="ElectronContextMenu";const A=I},45214:(e,t,o)=>{o.d(t,{Z:()=>n});var s=o(49085);class r extends s.default{getInitialState(){return{open:!1}}}const n=new r},60951:(e,t,o)=>{o.r(t),o.d(t,{Notification:()=>h});var s=o(40902),r=o(66897),n=o(99036),a=o(38297),i=o(72126),c=o(59753),l=o(55061),d=o(82883),p=o(21202),u=o(13493),m=o(70279),g=o(19889),f=o(70203),b=o(64002);function h(e){const{activity:t,getRecordValue:o,baseURL:h,userTimeZone:k,pageVisitSource:M,intl:x,useSimplifiedEmailSubjectForGrouping:N,isMobilePush:j}=e,_=c.om.fromGetRecordValueFn(o),v=(0,l.P6)({...e}),I=(0,l.XW)(v,x),A=(0,l.Qs)(v),T=(0,l.xS)(v),E=(0,l.oP)({...e,intl:x}),C=(0,l.sn)({...e,intl:x}),Z=(0,l.iR)({...e,intl:x}),S=(0,l.rn)({...e,intl:x});switch(t.type){case"top-level-block-created":return{subject:x.formatMessage(l.qJ.topLevelBlockCreated,{userName:I,targetName:E,spaceName:S})};case"top-level-block-deleted":return{subject:x.formatMessage(l.qJ.topLevelBlockDeleted,{userName:I,targetName:E,spaceName:S})};case"collection-row-created":return{subject:x.formatMessage(l.qJ.collectionRowCreated,{userName:I,targetName:E,collectionName:Z})};case"collection-row-deleted":return{subject:x.formatMessage(l.qJ.collectionRowDeleted,{userName:I,targetName:E,collectionName:Z})};case"block-edited":{let r;const c=t.getEdits();if(c.length){const t=c[0];if("block-changed"===t.type){const c=t.block_data.after.block_value,d=(0,a.ky)({block:c,getRecordValue:o});if("page"===c.type&&d){const a=t.block_schema||n.Kc(x),c=s.OS({before:t.block_data.before.block_value,after:t.block_data.after.block_value,schema:a}).filter((e=>{const t=a[e];return t&&"formula"!==t.type})).map((s=>{const r=a[s],n=r?r.name:void 0,i=(0,l.v4)({intl:x,property:s,schema:a,block:t.block_data.after.block_value,getRecordValue:o,userTimeZone:e.userTimeZone,baseURL:e.baseURL})||x.formatMessage(l.qJ.emptyBlockEditedProperty);return x.formatMessage(l.qJ.propertyNameAndValueEdited,{propertyName:n,propertyValue:i})})),d=s.B9({before:t.block_data.before.block_value,after:t.block_data.after.block_value}),p=i.oA(d.map((e=>{const s=(0,l._u)({formatProperty:e,intl:x}),r=(0,l.W9)({formatProperty:e,intl:x,block:t.block_data.after.block_value,getRecordValue:o});if(s&&r)return x.formatMessage(l.qJ.propertyNameAndValueEdited,{propertyName:s,propertyValue:r})})));r=x.formatList(c.concat(p),{type:"conjunction",style:"narrow"})}else r=(0,l._2)({intl:x,blockValue:c,getRecordValue:o,baseURL:h,userTimeZone:k})}else if("block-created"===t.type){const e=t.block_data.block_value;r=(0,l._2)({intl:x,blockValue:e,getRecordValue:o,baseURL:h,userTimeZone:k})}else if("block-deleted"===t.type){const e=t.block_data.block_value,s=(0,l._2)({intl:x,blockValue:e,getRecordValue:o,baseURL:h,userTimeZone:k});r=x.formatMessage(l.qJ.blockDeletedEditBody,{renderedBlock:s})}}return{subject:N?y(E,x):x.formatMessage(l.qJ.blockEditedNotification,{userName:I,blockName:E}),body:r}}case"block-property-edited":const q={subject:N?y(E,x):x.formatMessage(l.qJ.blockPropertyEditedNotification,{userName:I,blockName:E}),body:void 0},J=t.getEdits();if(J.length){const t=J[0],s=Object.entries(t.property_updates).filter((e=>{let[o,s]=e;const r=t.filtered_block_schema[o];return r&&!["formula","created_by","created_time"].includes(r.type)})).map((s=>{let[r,n]=s;const a=t.filtered_block_schema[r],i=a?a.name:void 0,c=(0,l.Wy)({intl:x,propertySchema:a,textValue:n.after.value,getRecordValue:o,userTimeZone:e.userTimeZone,baseURL:e.baseURL})||x.formatMessage(l.qJ.emptyBlockEditedProperty);return x.formatMessage(l.qJ.propertyNameAndValueEdited,{propertyName:i,propertyValue:c})}));q.body=x.formatList(s,{type:"conjunction",style:"narrow"})}return j?{subject:x.formatMessage(l.qJ.mobileBlockPropertyEditedNotification,{userName:I}),subtitle:E,body:q.body,senderUserId:A,senderProfilePhoto:T,conversationIdentifier:C}:q;case"permissions-edited":return{subject:x.formatMessage(l.qJ.userEditedPermissionsFor,{userName:I,targetName:E}),body:(0,l.gt)({intl:x,activity:t,getRecordValue:o,pageVisitSource:M,userTimeZone:e.userTimeZone})};case"user-mentioned":{const s=(0,l.kU)({intl:x,getRecordValue:o,baseURL:h,userTimeZone:e.userTimeZone,blockId:t.mentioned_block_id,property:t.mentioned_property});return j?{subject:x.formatMessage(l.qJ.mobileUserMentionedIn,{userName:I}),subtitle:E,body:s,senderUserId:A,senderProfilePhoto:T,conversationIdentifier:C}:{subject:N?y(E,x):x.formatMessage(l.qJ.userMentionedIn,{userName:I,targetName:E}),body:s}}case"commented":{let s;const r=t.getEdits();if(r.length){const t=r[0];if("comment-created"===t.type){const r=o({table:m.x_,id:t.comment_id,spaceId:t.space_id}),n=t.comment_data||r;n&&(s=(0,d.X)({intl:x,textValue:n.text,getRecordModel:_,userTimeZone:e.userTimeZone}))}else if("comment-changed"===t.type)s=(0,d.X)({intl:x,textValue:t.comment_data.after.text,getRecordModel:_,userTimeZone:e.userTimeZone});else{const r=o({table:m.x_,id:t.comment_id,spaceId:t.space_id}),n=t.comment_data||r;if(n){const t=(0,d.X)({intl:x,textValue:n.text,getRecordModel:_,userTimeZone:e.userTimeZone});s=x.formatMessage(l.qJ.userDeletedComment,{commentText:t})}}}return j?{subject:x.formatMessage(l.qJ.mobileUserCommentedSubject,{userName:I}),subtitle:E,body:s,senderUserId:A,senderProfilePhoto:T,conversationIdentifier:C}:{subject:N?y(E,x):x.formatMessage(l.qJ.userCommentedSubject,{userName:I,targetName:E}),body:s}}case"user-invited":const R=(0,b.pE)(E),U=R.length>0?R:x.formatMessage(l.qJ.defaultPageName);if(t.permission_group_id)return{subject:x.formatMessage(l.qJ.userAddedToSpace,{userName:I,workspaceName:U})};return{subject:0===v.filter(r.uC).length?x.formatMessage(l.qJ.userInvitedToSpaceByBot,{workspaceName:U}):x.formatMessage(l.qJ.userInvitedToSpace,{userName:I,workspaceName:U})};case"collection-edited":{let e,o=x.formatMessage(l.qJ.userEditedCollectionSubject,{userName:I,collectionName:E});const r=t.getEdits();if(r.length){const t=r[0];if("collection-changed"===t.type&&t.collection_data){const r=t.collection_data.after?t.collection_data.after.description:void 0,n=t.collection_data.before?t.collection_data.before.description:void 0;n&&!r?o=x.formatMessage(l.qJ.collectionDescriptionDeleted,{userName:I,collectionName:E}):!n&&r?(o=x.formatMessage(l.qJ.collectionDescriptionCreated,{userName:I,collectionName:E}),e=f.Jcv(r)):n&&r&&s.Dn(n,r)&&(e=f.Jcv(r))}else if("collection-created"===t.type&&t.collection_data){const s=t.collection_data.description;s&&(o=x.formatMessage(l.qJ.userCreatedCollectionSubject,{userName:I,collectionName:E}),e=f.Jcv(s))}}return{subject:o,body:e}}case"collection-view-edited":const V=e.getRecordValue({table:u.n,id:t.collection_view_id,spaceId:t.space_id}),L=V&&V.name||x.formatMessage(l.qJ.untitledCollectionView);return{subject:x.formatMessage(l.qJ.collectionViewEditedSubject,{userName:I,collectionViewName:L,collectionName:E})};case"collection-property-edited":const w=t.getEdits(),P=w.length&&w[0],F=P&&("collection-property-changed"===P.type?P.collection_property_data.after.name:P.collection_property_data.name)||x.formatMessage(l.qJ.collectionPropertyEditedUnknown);return t.collection_property_id,{subject:x.formatMessage(l.qJ.collectionPropertyEditedSubject,{userName:I,propertyType:F,collectionName:E})};case"reminder":return{subject:x.formatMessage(l.qJ.reminderSubject,{pageName:E}),body:(0,l.kU)({getRecordValue:o,baseURL:h,userTimeZone:e.userTimeZone,blockId:t.reminder_block_id,property:t.reminder_property,intl:x})};case"permission-group-edited":return{subject:(0,l.pF)({activity:t,intl:x,userName:I,targetName:E})};case"page-locked":case"page-unlocked":return{subject:"page-locked"===t.type?x.formatMessage(l.qJ.pageLockedActivity,{userName:I,pageName:E}):x.formatMessage(l.qJ.pageUnlockedActivity,{userName:I,pageName:E})};case"email-edited":return{subject:x.formatMessage(l.qJ.emailEditedActivity,{userName:I})};case"access-requested":return{subject:t.parent_table===p.iU?x.formatMessage(l.qJ.accessRequestedSubject,{userName:I,pageName:E}):x.formatMessage(l.qJ.membershipRequestedSubject,{userName:I,workspaceName:E})};case"page-deleted":return{subject:x.formatMessage(l.qJ.pageDeletedActivity,{userName:I})};case"page-restored":return{subject:x.formatMessage(l.qJ.pageRestoredActivity,{userName:I})};case"page-permanently-deleted":return{subject:x.formatMessage(l.qJ.pagePermanentlyDeletedActivity,{userName:I})};case"team-membership-edited":return{subject:x.formatMessage(l.qJ.userInvitedToTeam,{userName:I,teamName:E})};case"private-content-transferred":const B=t.getEdits(),D=B.length&&B[0].from_user_id;if(!D)return{subject:x.formatMessage({defaultMessage:"{author} transferred private content to you: {pageName}",id:"pushNotification.privateContentTransferred.noFromUserName"},{author:I,pageName:E})};const W=o({table:g.KJ,id:D});return{subject:x.formatMessage(l.qJ.privateContentTransferred,{author:I,pageName:E,fromUserName:W&&c.kk.fromValue(g.KJ,W).getFullName(x)})};case"permission-group-mentioned":const G=(0,l.Bg)({spaceId:t.space_id,permissionGroupId:t.mentioned_group_id,getRecordValue:e.getRecordValue}),O=(0,l.jQ)(x,G);return{subject:N?y(E,x):x.formatMessage(l.qJ.permissionGroupMentionedIn,{userName:I,targetName:E,groupName:O}),body:(0,l.kU)({intl:x,getRecordValue:o,baseURL:h,userTimeZone:e.userTimeZone,blockId:t.navigable_block_id,property:t.mentioned_property})};case"verification-expired":return{subject:x.formatMessage(l.qJ.verificationExpired,{pageName:E})}}}function y(e,t){return t.formatMessage({defaultMessage:"New activity in {pageTitle}",id:"emailActivity.pageActivity.simplifiedSubjectLine"},{pageTitle:e})}}}]);