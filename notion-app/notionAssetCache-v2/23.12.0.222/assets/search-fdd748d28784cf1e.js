"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[6464],{3043:(e,t,s)=>{s.d(t,{Qe:()=>n.Z,Yo:()=>i.Z,fY:()=>r.f});var r=s(87686),i=s(24946),n=s(7692)},10912:(e,t,s)=>{s.d(t,{Z:()=>b});s(57658),s(67294);var r=s(83355),i=s(27531),n=s(41432),o=s(80951),l=s(95538),a=s(21202),d=s(97880),c=s(78316),u=s(17311),h=s(35328),p=s(90106),m=s(865),g=s(12981),v=s(81865),f=s(35541),y=s(85893);function x(e){return"number"==typeof e}class S extends r.Z{constructor(){super(...arguments),this.renderContentBlock=e=>{const{store:t,renderAdditionalBlocks:s}=this.props,r=p.G.createChildStore(t,{table:a.iU,id:e}),n=r.getType(),o=s&&void 0!==n?(0,f.u)(r):(0,m.h)(r);if(o)return(0,y.jsx)(i.D,{value:this.restrictedContentStore,children:(0,y.jsx)(o,{store:r,disabled:!0,disableCommentMenu:!0,disableHoverMenu:!0,hideContent:(0,h.BX)(r),style:{fontSize:12,opacity:.8,pointerEvents:"none"},isQuickFind:!0,numberedListCounterStore:this.createComputedStore((()=>({depth:0,numberedListBlockIdsWithFormat:this.createNumberedListCounterStore(e)})))},e)})},this.coverStore=this.createComputedStore((()=>{const{store:e,renderAdditionalBlocks:t=!1}=this.props,s=(0,c.NU)(e,t);return s.image?s.image:s.blockIds})),this.restrictedContentStore=this.createComputedStore((()=>{const{store:e,renderAdditionalBlocks:t=!1}=this.props,s=(0,c.wK)(e,t);return s.image?void 0:s.blockIds})),this.numberedLists=this.createComputedStore((()=>{const{store:e}=this.props,t=this.coverStore.state,s=[];if(Array.isArray(t)){let r=0;for(;r<t.length;){let i=t[r],o=p.G.createChildStore(e,{table:a.iU,id:i});if(o.getType()===n.Ti.numberedList){const l=[{blockId:i,idx:1}],d=[{id:i,format:void 0,depth:l.length-1,index:l[0].idx}];for(r+=1;r<t.length&&(i=t[r],o=p.G.createChildStore(e,{table:a.iU,id:i}),o.getType()===n.Ti.numberedList);){{const e=o.getParentId();if(o.getParentId()===l[l.length-1].blockId)l.push({blockId:i,idx:1});else{let t=l[l.length-1].idx;for(;l.length>0&&l[l.length-1].blockId!==e;)t=l[l.length-1].idx,l.pop();l.push({blockId:i,idx:t+1})}d.push({id:i,format:void 0,depth:l.length-1,index:l[l.length-1].idx})}r+=1}s.push(d)}else r+=1}}return s}))}didUpdate(e){this.props.coverFormat.type!==e.coverFormat.type&&this.props.onLoadProxiedImage()}renderComponent(){const{coverFormat:e}=this.props;return"page_cover"===e.type?this.renderPageCover():"page_content"===e.type?this.renderPageContent():"property"===e.type?this.renderProperty(e.property):void 0}renderPageCover(){var e;const{store:t}=this.props,s=null===(e=t.getCover())||void 0===e?void 0:e.cover;return s?(0,y.jsxs)("div",{style:this.getImageCoverWrapStyle(),children:[(0,y.jsx)(v.Z,{url:s,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:this.getCoverWidth(),onFinishedLoadingProxyUrl:e=>this.props.onLoadProxiedImage(e),render:(e,t)=>{if(t)return(0,y.jsx)(g.Z,{style:{...this.getImageStyle(),...this.getCoverStyle(),...this.getCoverAspectStyle(),objectPosition:`center ${100*(1-this.imagePosition)}%`},src:t})}}),this.renderImageBorder()]}):this.props.showEmptyGalleryCover?this.renderEmptyGalleryCover():void 0}renderPageContent(){const e=this.coverStore.state,t=this.restrictedContentStore.state;if(e){if(!Array.isArray(e))return(0,y.jsxs)("div",{style:this.getImageCoverWrapStyle(),children:[(0,y.jsx)(v.Z,{url:e.url,onFinishedLoadingProxyUrl:e=>this.props.onLoadProxiedImage(e),isAuthenticated:!0,permissionRecord:e.pointer,width:this.getCoverWidth(),render:(e,t)=>{if(t)return(0,y.jsx)(g.Z,{style:{...this.getImageStyle(),...this.getPageContentImageStyle(),...this.getCoverAspectStyle(),objectPosition:`center ${100*(1-this.imagePosition)}%`},src:t})}}),this.renderImageBorder()]});if(e.length>0)return(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)("div",{style:this.getContentWrapStyle(),children:[t?e.filter((e=>t.indexOf(e)>=0)).map(this.renderContentBlock):e.map(this.renderContentBlock),this.props.coverContentFadedOverlay&&(0,y.jsx)("div",{style:this.getContentFadedOverlayStyle()})]})});if(this.props.showEmptyGalleryCover)return this.renderEmptyGalleryCover()}else if(this.props.showEmptyGalleryCover)return this.renderEmptyGalleryCover()}renderProperty(e){const{store:t}=this.props,s=(0,o.g)(t.getPropertyValue(e)).find((e=>(0,l.SR)({url:e.url})));return s?(0,y.jsxs)("div",{style:this.getImageCoverWrapStyle(),children:[(0,y.jsx)(v.Z,{onFinishedLoadingProxyUrl:e=>this.props.onLoadProxiedImage(e),url:s.url,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:this.getCoverWidth(),render:(e,t)=>{if(t)return(0,y.jsx)(g.Z,{style:{...this.getImageStyle(),...this.getCoverStyle(),...this.getCoverAspectStyle(),objectPosition:`center ${100*(1-this.imagePosition)}%`},src:t})}}),this.renderImageBorder()]}):this.props.showEmptyGalleryCover?this.renderEmptyGalleryCover():void 0}renderEmptyGalleryCover(){return(0,y.jsx)("div",{style:{height:this.getCoverHeight(),...this.props.emptyGalleryCoverStyle}})}renderImageBorder(){switch(this.props.variant){case"default":return null;case"gallery":return(0,y.jsx)("div",{style:{position:"absolute",left:0,right:0,bottom:0,borderBottom:`1px solid ${this.theme.regularDividerColor}`}});default:(0,d.t1)(this.props.variant)}}get imagePosition(){const{coverPosition:e,store:t}=this.props;if(x(e))return e;if(t.getFormatStore().isDefined()){const{page_cover_position:e,card_cover_position:s}=t.getFormat();if(x(s))return s;if(x(e))return e}return.5}createNumberedListCounterStore(e){const t=this.numberedLists.state;for(const s of t)if(s.find((t=>t.id===e)))return s;return[]}getImageStyle(){return this.props.style||{}}getCoverHeight(){const{coverHeight:e,coverSizeFormat:t}=this.props;if(e)return e;switch(t){case"large":return u.Z.card.desktop.large.height;case"small":return u.Z.card.desktop.small.height;case"medium":default:return u.Z.card.desktop.medium.height}}getCoverWidth(){const{coverWidth:e,coverSizeFormat:t}=this.props;return e||(0,c.rD)(t)}getImageCoverWrapStyle(){return{height:this.getCoverHeight(),position:"relative",pointerEvents:"none",overflow:"hidden",...this.props.imageCoverWrapStyle}}getContentWrapVariantStyle(){const{ThemeStore:e}=this.environment,t="dark"===e.state.mode;switch(this.props.variant){case"default":return{};case"gallery":return{background:this.theme.collectionGalleryPreviewCardCover,padding:"8px 8px 0",boxShadow:t?"transparent":`inset 0 -1px 0 0 ${this.theme.regularDividerColor}`,...this.props.contentWrapStyle};default:(0,d.t1)(this.props.variant)}}getContentWrapStyle(){return{height:this.getCoverHeight(),pointerEvents:"none",overflow:"hidden",position:this.props.coverContentFadedOverlay?"relative":"static",...this.getContentWrapVariantStyle(),...this.props.contentWrapStyle}}getContentFadedOverlayStyle(){return{width:"100%",height:40,position:"absolute",bottom:0,left:0,background:`linear-gradient(to bottom, transparent, ${this.theme.accentColors.gray[30]} 100%)`,...this.props.coverContentFadedOverlayStyle}}getCoverVariantStyle(){switch(this.props.variant){case"default":return{border:`1px solid ${this.theme.stroke.regular}`,borderRadius:4};case"gallery":return{borderRadius:0,borderTopLeftRadius:1,borderTopRightRadius:1};default:(0,d.t1)(this.props.variant)}}getCoverStyle(){return{width:"100%",height:this.getCoverHeight(),...this.getCoverVariantStyle(),objectPosition:"center"}}getCoverAspectStyle(){const{coverAspectFormat:e}=this.props;return{objectFit:void 0===e?"cover":e}}getPageContentImageStyle(){return{...this.getCoverStyle(),objectPosition:"center center"}}}S.displayName="CollectionItemCover";const b=S},92660:(e,t,s)=>{s.d(t,{Z:()=>l});s(67294);var r=s(83355),i=s(50506),n=s(53437),o=s(85893);class l extends r.Z{renderComponent(){const{render:e}=this.props,{device:t}=this.environment,s=this.props.modalStore.state;return t.isMobile?(0,o.jsx)(n.ZP,{ariaLabel:this.props.ariaLabel,open:s.open,popupType:n.ZP.PopupType.SlideUp,origin:this.props.origin,onDismiss:this.props.onDismiss,render:e,style:this.props.style}):(0,o.jsx)(i.Z,{ariaLabel:this.props.ariaLabel,open:s.open,preventHideChildrenWhileOpening:!0,render:e,onDismiss:this.props.onDismiss,style:this.props.style,innerStyle:this.props.innerStyle})}}l.displayName="DefaultPopupOrModal"},36507:(e,t,s)=>{s.d(t,{Z:()=>c});s(67294);var r=s(83355),i=s(82990),n=s(87279),o=s(75024),l=s(28992),a=s(85893);class d extends r.Z{constructor(){super(...arguments),this.styles={menuItem:{minHeight:void 0,...this.environment.device.isMobile&&{background:void 0,boxShadow:void 0},paddingTop:32,paddingBottom:32},text:{textAlign:"center"},title:{margin:0,fontWeight:i.Z.fontWeight.medium,fontSize:o.yv(this.environment,"UIRegular"),lineHeight:o.Dp(this.environment,"UIRegular")},caption:{fontSize:o.yv(this.environment,"UIRegular")}}}renderComponent(){const{style:e,captionStyle:t,...s}=this.props,r={...this.styles.menuItem,...e},i={...this.styles.caption,...t};return(0,a.jsx)(l.Z,{...s,title:this.renderTitle(),caption:this.renderCaption(i),textWrapperStyle:this.styles.text,style:r,captionStyle:i})}renderTitle(){const{title:e}=this.props;if(!e)return;const t=this.styles,s=this.getThemeColors(),r={...t.title,...s.title};return(0,a.jsx)("h4",{role:"alert",style:r,children:e})}renderCaption(e){const{caption:t}=this.props;if(!t)return;const s={...e,...this.getThemeColors().caption};return(0,a.jsx)("div",{style:s,children:t})}getThemeColors(){return{title:{color:this.theme.mediumTextColor},caption:{color:this.theme.lightTextColor}}}}d.displayName="ErrorMenuItem",d.contextTypes={...n.mw,...r.w};const c=d},30676:(e,t,s)=>{s.d(t,{F:()=>l});s(67294);var r=s(86628),i=s(52275),n=s(93686),o=s(85893);function l(e){window.__c={n:"TeamMenuItem"};const{teamStore:t}=e,{name:s}=(0,r.VK)((()=>({name:t.getName()})),[t]);return(0,o.jsx)(i.Z,{...e,icon:(0,o.jsx)(n.p,{size:14,store:t,disabled:!0}),title:s})}},97680:(e,t,s)=>{s.d(t,{Z:()=>g});s(67294);var r=s(83355),i=s(66897),n=s(97880),o=s(33929),l=s(87279),a=s(98742),d=s(52275),c=s(26388),u=s(70301),h=s(45653),p=s(85893);class m extends r.Z{renderComponent(){const{actor:e,userTitle:t,useEmailAsTooltip:s,tooltip:r,tooltipPlacement:l}=this.props,m=o.default.getIntl(),g=e.asActor&&e.isUser()?e.email:void 0,v=s&&g?g:r,f=this.environment.device.isMobile?24:20;let y;return(0,i.YU)(e)?y=(0,p.jsx)(u.Z,{botValue:null==e?void 0:e.asActor,size:f}):(0,i.$S)(e)?y=(0,p.jsx)(h.Z,{userValue:null==e?void 0:e.asActor,size:f}):(0,i.Iq)(e)?y=(0,p.jsx)(h.Z,{userValue:void 0,size:f}):(0,n.t1)(e),(0,p.jsx)(c.Z,{placement:l??c.Z.Placement.Bottom,alignment:c.Z.Alignment.Start,textWrap:!0,render:s=>(0,p.jsx)(d.Z,{...(0,a.Z)(s,this.props),icon:y,title:t??(0,i.$4)(m,e),className:"notranslate"}),disableTooltip:!v,renderTooltip:()=>v})}}m.displayName="UserMenuItem",m.contextTypes={...l.mw,...r.w};const g=m},22715:(e,t,s)=>{s.d(t,{Z:()=>o});s(67294);var r=s(480),i=s(24405),n=(s(58047),s(85893));function o(){window.__c={n:"WebComponentNotSupportedInMobileNativeWarning"};(0,r.O7)(),(0,i.yK)((e=>({container:{margin:"8px 16px",background:e.accentColors.yellow[100],borderRadius:8,height:"fit-content"}})),[]);return(0,n.jsx)(n.Fragment,{})}},93481:(e,t,s)=>{s.d(t,{Z:()=>M});s(67294);var r=s(83355),i=s(69651),n=s(97880),o=s(5366),l=s(65496),a=s(41558),d=s(33338),c=s(42922),u=s(52275),h=s(3386),p=s(89728),m=s(53437),g=s(72495),v=s(83264),f=s(255),y=s(75689),x=s(91642),S=s(8319),b=s(85893);class C extends r.Z{constructor(){super(...arguments),this.storeTypes={store:a.Z},this.renderActiveButtonOrigin=()=>{const{value:e,dateFormat:t,disabled:s,focused:r,intl:n}=this.props,o=this.styles,a=this.getThemeColors(),d={...o.menuItem,...a.activeMenuItem},c=l._Q(e,n,t),h=(0,b.jsx)(f.Z,{onClick:this.handleClear,disabled:s});return(0,b.jsx)(u.Z,{focused:r,disabled:s,icon:(0,i.C)(o.iconActiveDesktop),title:c,right:h,isTokenTitle:!0,alignIconTop:!0,onClick:this.handleOriginActivate,desktopTitleStyle:o.menuItemTitleDesktop,desktopIconStyle:o.iconActiveDesktopWrapper,style:d})},this.renderInactiveButtonOrigin=()=>{const{title:e,icon:t,disabled:s,focused:r,mode:i}=this.props,n=this.styles,o=this.getThemeColors(),l={...n.menuItem,...o.buttonMenuItem,...i===S.Z.Mode.Pill?{width:"fit-content",border:"solid 1px",paddingLeft:0,paddingRight:0,borderRadius:20,fontSize:12}:{}};return(0,b.jsx)(u.Z,{focused:r,disabled:s,icon:t(n.icon),title:e,onClick:this.handleOriginActivate,style:l})},this.renderPillButtonOrigin=()=>{const{value:e,title:t}=this.props;return(0,b.jsx)(d.Z,{on:Boolean(e.starting||e.ending),icon:(0,i.C)({width:16,marginRight:6,fill:"currentColor"}),title:(0,b.jsx)("span",{children:t}),onClick:this.handleOriginActivate})},this.renderPopupContents=()=>{const{title:e,showButtons:t}=this.props,{store:s}=this.stores;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.Z,{title:e,value:this.getCurrentValue(),onUpdate:this.updateTemporary,store:s,onDismiss:this.handleMenuClose}),t&&(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",padding:"0px 10px"},children:[(0,b.jsx)(p.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleMenuClose,children:(0,b.jsx)(o.FormattedMessage,{defaultMessage:"Cancel",id:"searchDateFilter.cancelButton.label"})}),(0,b.jsx)(c.Z,{onClick:()=>this.props.onChange(this.stores.store.state.temporaryDateRange),children:(0,b.jsx)(o.FormattedMessage,{defaultMessage:"Accept",id:"searchDateFilter.acceptButton.label"})})]})]})},this.renderFooter=()=>{const{store:e}=this.stores;return(0,b.jsxs)(g.Z,{topBorder:!0,style:{padding:6,justifyContent:"space-between",display:"flex"},children:[(0,b.jsx)(p.Z,{onClick:()=>{e.setState({...e.state,temporaryDateRange:{starting:void 0,ending:void 0}}),this.props.onChange({})},children:(0,b.jsx)(o.FormattedMessage,{id:"searchDateFilter.clearButton",defaultMessage:"Clear"})}),(0,b.jsx)(c.Z,{onClick:this.handleMenuClose,children:(0,b.jsx)(o.FormattedMessage,{id:"searchDateFilter.applyButton",defaultMessage:"Apply"})})]})},this.handleOriginActivate=()=>{const{disabled:e}=this.props,{store:t}=this.stores;e||t.setState({...t.state,isOpen:!0,focus:"starting"})},this.handleMenuClose=e=>{const{onChange:t,onMenuDismiss:s}=this.props,{store:r}=this.stores,{temporaryDateRange:i}=r.state;l.zD(e)||(this.props.showButtons||t(i),r.setState({...r.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),s&&s())},this.handleClear=()=>{const{onChange:e}=this.props;e({starting:void 0,ending:void 0})},this.handleMenuListKey=e=>{e.preventDefault&&e.preventDefault()},this.updateTemporary=e=>{const{store:t}=this.stores;if(!e.error)return t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:12,paddingBottom:8},menuItemTitleDesktop:{width:"100%"},sectionMenuItem:{display:"flex"},summary:{display:"inline-flex"}}}didMount(){this.updateTemporary({value:this.props.value})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{title:t}=this.props,{store:s}=this.stores,r=this.styles,i=e===S.z.Section,o=i?t:void 0,l=(()=>e===S.Z.Mode.Section?this.renderActiveButtonOrigin():e===S.Z.Mode.Button?this.renderInactiveButtonOrigin():e===S.Z.Mode.Pill?this.renderPillButtonOrigin():void(0,n.t1)(e))();return(0,b.jsx)(x.Z,{title:o,marginAfter:i,children:(0,b.jsx)(h.Z,{capture:s.state.isOpen,onUp:this.handleMenuListKey,onDown:this.handleMenuListKey,onEnter:this.handleMenuListKey,children:(0,b.jsx)(m.ZP,{popupType:this.getPopupType(),open:s.state.isOpen,origin:l,render:this.renderPopupContents,onDismiss:this.handleMenuClose,placementToOrigin:m.ZP.Placement.Bottom,alignmentToOrigin:m.ZP.Alignment.Start,keepFocus:!0,style:r.popup})})})}renderMobile(e){const{store:t}=this.stores,s=e===S.z.Section?this.renderMobileFilterSummary():this.renderMobileButtonOrigin();return(0,b.jsx)(m.ZP,{popupType:m.ZP.PopupType.SlideUp,open:t.state.isOpen,origin:s,render:this.renderPopupContents,onDismiss:this.handleMenuClose,preventScaleTransition:!0})}renderMobileButtonOrigin(){const{icon:e,title:t,disabled:s}=this.props,r=this.styles;return(0,b.jsx)(u.Z,{disabled:s,focused:!1,icon:e(r.icon),title:t,onClick:this.handleOriginActivate})}renderMobileFilterSummary(){const{title:e,value:t,dateFormat:s,disabled:r,intl:n}=this.props,o=this.styles,a=(0,b.jsxs)("div",{style:o.summary,children:[(0,i.C)(o.iconActiveMobile),l._Q(t,n,s)]});return(0,b.jsx)(y.Z,{disabled:r,onClick:this.handleOriginActivate,onClickClear:this.handleClear,label:e,title:a})}getCurrentValue(){const{value:e}=this.props,{store:t}=this.stores,{temporaryDateRange:s}=t.state;return{...e,...s}}getPopupType(){const{device:e}=this.environment;return e.isMobile?m.ZP.PopupType.SlideUp:m.ZP.PopupType.Popup}getThemeColors(){return{buttonMenuItem:{color:this.theme.mediumTextColor},activeMenuItem:{color:this.theme.regularTextColor}}}}C.displayName="SearchDateFilter";const M=(0,o.injectIntl)(C)},83890:(e,t,s)=>{s.d(t,{Z:()=>x});var r=s(67294),i=s(83355),n=s(66897),o=s(22686),l=s(19889),a=s(7928),d=s(5366),c=s(2985),u=s(90106),h=s(92864),p=s(93044),m=s(255),g=s(97680),v=s(8319),f=s(85893);class y extends i.Z{constructor(){super(...arguments),this.renderFilterListItem=(e,t)=>{let{disabled:s,onRemove:r,onClick:i}=t;const o=this.styles,l=this.getUserValue(e),a=(0,f.jsx)(m.Z,{disabled:s,onClick:r});return(0,f.jsx)(g.Z,{disabled:s,focused:!1,actor:(0,n.m3)(l),right:a,style:o.menuItem,desktopTitleStyle:o.menuItemTitle,onClick:i},e)},this.renderItemForSummary=e=>(0,a.Nz)(this.props.intl,this.getUserValue(e)),this.renderToken=(e,t)=>{const{userIds:s}=this.props,r=1===s.length,i=this.getUserValue(e);if(i)return(0,f.jsx)(h.ZP,{format:this.environment.device.isMobile?p.lP.Large:p.lP.Small,showRemoveButton:!0,isSingle:r,onClickRemove:t.onRemove,actor:(0,n.m3)(i),shouldShrink:!0,style:{background:"transparent"}},e)},this.renderResultMenuItem=(e,t)=>{const s=this.getUserValue(e);return(0,r.createElement)(g.Z,{...t,key:e,actor:(0,n.m3)(s)})},this.performRequest=async e=>{let{query:t,current:s}=e;const r=new Set(s);return(await c.Yu({environment:this.environment,query:t,membersOnly:!1})).filter((e=>!r.has(e.id))).slice(0,20).map((e=>e.id))},this.getUserValue=e=>this.createUserStore(e).getValue(),this.createUserStore=e=>{const{parentStore:t}=this.props;return u.U6.createChildStore(t,{table:l.KJ,id:e})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:2,fill:"currentColor"}}}renderComponent(){const{mode:e,title:t,userIds:s,onChange:r,disabled:i,focused:n,onMenuDismiss:l,intl:a}=this.props;return(0,f.jsx)(v.Z,{mode:e,title:t,icon:o.f,iconStyles:this.styles.recordIcon,items:s,onChange:r,disabled:i,focused:n,renderFilter:this.renderFilterListItem,renderToken:this.renderToken,renderItemForSummary:this.renderItemForSummary,addItemLabel:(0,f.jsx)(d.FormattedMessage,{defaultMessage:"Add a person",id:"search.filterMenu.addAPersonButton.label"}),labelText:{title:t,tokenInputPlaceholder:a.formatMessage({defaultMessage:"Search people",id:"search.filterMenu.searchPeople.placeholder"}),componentDebugName:"SearchPersonFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,onMenuDismiss:l,hasItemsSelected:(null==s?void 0:s.length)>0})}}y.displayName="SearchPersonFilter";const x=(0,d.injectIntl)(y)},50817:(e,t,s)=>{s.r(t),s.d(t,{SearchStaticContext:()=>ai,SearchStoresContext:()=>di,default:()=>ui});s(57658);var r=s(67294),i=s(83355),n=s(18466),o=s(49085),l=s(15145),a=s(12174),d=s(72126),c=s(4615),u=s(97880);var h=s(70203),p=s(63143),m=s(50906),g=s(34602),v=s(87531),f=s(81598),y=s(95477),x=s(73744),S=s(69988),b=s(98165),C=s(65598),M=s(65496),j=s(95697),I=s(74948),P=s(80444),T=s(24042),w=s(77080),k=s(32470),F=s(55320),R=s(2342),Z=s(30857),B=s(87956),A=s(29026),L=s(13627),O=s(9019),D=s(480),E=s(86628),N=s(24405),V=s(29477),q=s(84166);var _=s(43250),W=s(87279),z=s(82063),H=s(5162),U=s(88632),K=s(69454),$=s(23063),G=s(36488),Q=s(56940),Y=s(78140),J=s(40721),X=s(83785),ee=s(22715),te=s(67220),se=s(69651),re=s(64275),ie=s(6637),ne=s(60291),oe=s(37612),le=s(83303),ae=s(53772),de=s(82990),ce=s(5366),ue=s(61766),he=s(64921),pe=s(52275),me=s(31945),ge=s(60458),ve=s(89728),fe=s(72495),ye=s(93481),xe=s(84619),Se=s(90028),be=s(21202),Ce=s(2985),Me=s(33929),je=s(15447),Ie=s(90106),Pe=s(31278),Te=s(11470),we=s(76798),ke=s(255),Fe=s(85567),Re=s(8319),Ze=s(85893);const Be=(0,ce.defineMessages)({searchPages:{defaultMessage:"Search pages",id:"searchPageFilter.searchTokenFilter.tokenInput.placeholder"},selectAPage:{defaultMessage:"Select a page",id:"searchPageFilter.searchTokenFilter.resultSection.title"}});class Ae extends i.Z{constructor(){super(...arguments),this.renderFilterListItem=(e,t)=>{let{disabled:s,onRemove:r,onClick:i}=t;const n=this.styles,o=this.createBlockStore(e),l=(0,Ze.jsx)(ke.Z,{disabled:s,onClick:r});return(0,Ze.jsx)(Te.Z,{disabled:s,focused:!1,store:o,right:l,style:n.menuItem,desktopTitleStyle:n.menuItemTitle,onClick:i})},this.renderItemForSummary=e=>(0,Ze.jsx)(we.Z,{store:this.createBlockStore(e),shouldWrap:!0,maxLength:50}),this.renderToken=(e,t)=>{const{blockIds:s}=this.props,r=this.tokenStyles,i=1===s.length,n=this.createBlockStore(e),o=(0,Ze.jsxs)("div",{style:r.token,children:[(0,Ze.jsx)(Pe.Z,{disabled:!0,icon:n.getIcon(),isEmptyPage:!1,size:20,style:r.icon}),(0,Ze.jsx)(we.Z,{store:n})]});return(0,Ze.jsx)(Fe.Z,{format:this.environment.device.isMobile?xe.l.Large:xe.l.Small,value:o,showRemoveButton:!0,onClickRemove:t.onRemove,isSingle:i,shouldShrink:!0,backgroundColor:"transparent",shouldWrap:!1},e)},this.renderResultMenuItem=(e,t)=>{const s=this.createBlockStore(e);return(0,r.createElement)(Te.Z,{...t,key:e,store:s})},this.performRequest=async e=>{let{query:t,current:s}=e;const{currentSpaceStore:r}=P.default.state;if(!r)return[];const i=t?(await Ce.nJ({environment:this.environment,query:t,limit:20,spaceId:r.id,requireEditPermissions:!1,excludeTemplates:!1,source:"ancestor_filter_page_search",boostRecentlyViewedPages:!0})).results:je.X4.state.map((e=>e.pageId)),n=new Set(s);return i.filter((e=>!n.has(e)))},this.createBlockStore=e=>{const{parentStore:t}=this.props;return Ie.G.createChildStore(t,{table:be.iU,id:e})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{fill:"currentColor"}},this.tokenStyles={token:{display:"flex",alignItems:"center"},icon:{marginRight:4}}}renderComponent(){const{mode:e,title:t,blockIds:s,onChange:r,disabled:i,focused:n,onMenuDismiss:o}=this.props;return(0,Ze.jsx)(Re.Z,{mode:e,hasItemsSelected:(null==s?void 0:s.length)>0,title:t,icon:Se.j,iconStyles:this.styles.recordIcon,items:s,onChange:r,focused:n,renderFilter:this.renderFilterListItem,renderToken:this.renderToken,renderItemForSummary:this.renderItemForSummary,addItemLabel:(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Add another page",id:"searchPageFilter.searchTokenFilter.addAPage.button"}),labelText:{title:t,tokenInputPlaceholder:Me.default.formatMessage(Be.searchPages),componentDebugName:"SearchPageFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,disabled:i,onMenuDismiss:o})}}Ae.displayName="SearchPageFilter";const Le=Ae;var Oe=s(83890),De=s(88507),Ee=s(29369),Ne=s(92338),Ve=s(30397),qe=s(93044),_e=s(30676);class We extends i.Z{constructor(){super(...arguments),this.renderFilterListItem=(e,t)=>{let{disabled:s,onRemove:r,onClick:i}=t;const n=this.styles,o=this.createTeamStore(e),l=(0,Ze.jsx)(ke.Z,{disabled:s,onClick:r});return(0,Ze.jsx)(_e.F,{disabled:s,focused:!1,teamStore:o,right:l,style:n.menuItem,desktopTitleStyle:n.menuItemTitle,onClick:i},e)},this.renderItemForSummary=e=>this.createTeamStore(e).getName(),this.renderAvatarFactory=e=>{const t=e.getIcon();return e=>(0,Ze.jsx)(Pe.Z,{disabled:!0,icon:t,isEmptyPage:!1,size:e})},this.renderToken=(e,t)=>{const{teamIds:s}=this.props,r=(0,Ne.iY)(s),i=1===(null==r?void 0:r.length),n=this.createTeamStore(e);if(!n)return;const o=n.getName();return(0,Ze.jsx)(qe.ZP,{format:this.environment.device.isMobile?qe.lP.Large:qe.lP.Small,showRemoveButton:!0,isSingle:i,onClickRemove:t.onRemove,renderAvatar:this.renderAvatarFactory(n),title:o,style:{background:"transparent"}},e)},this.renderResultMenuItem=(e,t)=>{const s=this.createTeamStore(e);return(0,r.createElement)(_e.F,{...t,key:e,teamStore:s})},this.performRequest=async e=>{var t;let{query:s,current:r}=e;const i=new Set(r),n=P.default.state.currentSpaceViewStore,o=P.default.state.currentSpaceStore,l=null===(t=P.default.state.currentUserStore)||void 0===t?void 0:t.id;if(!n||!o||!l)return[];if(!s){const e=new Set(n.getTeamsStores().map((e=>e.id)));if(Ve.Z.state.teams.map((e=>e.id)).forEach((t=>e.add(t))),e.size>0)return[...e]}const a=await(0,j.qX)({environment:this.environment,spaceStore:o,currentUserId:l});return(await Ce.zf({query:s,spaceViewStore:n,teamStores:a})).filter((e=>!i.has(e.id))).slice(0,20).map((e=>e.id))},this.createTeamStore=e=>{const{parentStore:t}=this.props;return Ie.zX.createChildStore(t,{table:Ee.e0,id:e})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},menuItemTitle:{width:"100%"},labeledMenuItemTitle:{display:"inline-flex",alignItems:"center"},menuItemLabel:{marginRight:12},recordIcon:{marginRight:6,fill:"currentColor"}}}renderComponent(){const{mode:e,title:t,teamIds:s,onChange:r,disabled:i,focused:n,onMenuDismiss:o,intl:l}=this.props,a=(0,Ne.iY)(s);return(0,Ze.jsx)(Re.Z,{mode:e,title:t,icon:De.I,iconStyles:this.styles.recordIcon,items:a||[],onChange:r,disabled:i,focused:n,renderFilter:this.renderFilterListItem,renderToken:this.renderToken,renderItemForSummary:this.renderItemForSummary,addItemLabel:(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Add a teamspace",id:"search.filterMenu.addATeamButton.label"}),labelText:{title:t,tokenInputPlaceholder:l.formatMessage({defaultMessage:"Search teamspaces",id:"search.filterMenu.searchTeams.placeholder"}),componentDebugName:"SearchTeamFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,onMenuDismiss:o,hasItemsSelected:Boolean(a&&(null==a?void 0:a.length)>0)})}}We.displayName="SearchTeamFilter";const ze=(0,ce.injectIntl)(We);var He=s(33338),Ue=s(86825),Ke=s(75689),$e=s(91642);class Ge extends i.Z{constructor(){super(...arguments),this.handleToggle=()=>{const{value:e,onChange:t}=this.props;t(!e)},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:14,width:14,fill:"currentColor"},pillIcon:{height:16,width:16,fill:"currentColor",marginRight:6},sectionMenuItem:{display:"flex"}}}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){return(0,Ze.jsx)($e.Z,{marginAfter:!1,style:this.styles.sectionMenuItem,children:this.renderSwitcherMenuItem(e)})}renderMobile(e){const{title:t,value:s,disabled:r}=this.props;return e===Re.z.Button?this.renderSwitcherMenuItem(e):(0,Ze.jsx)(Ke.Z,{disabled:r,onClick:this.handleToggle,label:t,isToggle:!0,isToggleActive:s})}renderSwitcherMenuItem(e){const{title:t,icon:s,value:r,style:i,...n}=this.props,o=this.styles,l=this.getThemeColors(),a={...o.menuItem,...l.menuItem,...i};return e===Re.z.Pill?(0,Ze.jsx)(He.Z,{on:r,hideChevron:!0,title:(0,Ze.jsx)("span",{children:t}),onClick:this.handleToggle,icon:s(o.pillIcon)}):(0,Ze.jsx)(Ue.Z,{title:t,icon:s(o.icon),on:r,onClick:this.handleToggle,style:a,...n})}getThemeColors(){return{menuItem:{color:this.theme.mediumTextColor}}}}Ge.displayName="SearchToggleFilter",Ge.Mode=Re.z;const Qe=Ge;var Ye=s(8848),Je=s(42853),Xe=s(32163);function et(e){window.__c={n:"SearchExperimentFilterPopupButton"};const t=(0,D.Fy)();return(0,Ze.jsx)(me.ZP,{popupType:t.isMobile?me.Z4.SlideUp:me.Z4.Popup,renderOrigin:t=>(0,Ze.jsx)(st,{events:t,...e}),render:t=>(0,Ze.jsx)(tt,{parent:t,...e})})}function tt(e){let{parent:t,experiment:s,searchExperimentOverrides:r,onChange:i}=e;window.__c={n:"SearchExperimentFilterMenu"};const n=(0,D.Fy)(),o=(0,N.yK)((()=>({menuOptionStyle:{color:Ye.ZP.mediumTextColor}})),[]);let l;l=n.isMobile?{menuType:W.og.Modal,title:s.experimentId,right:(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Done",id:"appearanceSettings.modal.done"}),onClickRight:t.close}:{menuType:W.og.Popup,width:250};const a=s.groups.map((e=>({key:e,action:r=>{i({experimentId:s.experimentId,group:e}),t.close()},render:(t,s)=>(0,Ze.jsx)(pe.Z,{...t,title:e,style:o.menuOptionStyle})})));return(0,Ze.jsx)(Y.Z,{...l,children:(0,Ze.jsx)(Xe.Z,{type:Xe.i.Vertical,initialFocus:void 0,sections:[{key:s.experimentId,render:e=>(0,Ze.jsx)(fe.Z,{...e}),items:a}]})})}function st(e){let{experiment:t,events:s,searchExperimentOverrides:i}=e;window.__c={n:"SearchExperimentFilterMenuButton"};const n=(0,N.yK)((e=>({experimentGroupButtonChevronStyle:{width:10,fill:e.lightIconColor},experimentGroupButtonStyle:{overflowX:"hidden",justifyContent:"left",overflow:"hidden",marginLeft:6,color:e.mediumTextColor},rowContainer:{display:"flex",overflow:"hidden",flexDirection:"row"},groupCell:{overflow:"hidden",marginRight:4}})),[]);return(0,r.createElement)(ve.Z,{...s,isSmall:!0,key:t.experimentId,style:n.experimentGroupButtonStyle},(0,Ze.jsxs)("div",{style:n.rowContainer,children:[(0,Ze.jsx)("div",{style:n.groupCell,children:i[t.experimentId]||t.group}),(0,Ze.jsx)("div",{children:(0,Je.i)(n.experimentGroupButtonChevronStyle)})]}))}const rt=e=>({fontSize:14,lineHeight:1.2,color:e.mediumTextColor,marginRight:4,display:"flex",alignItems:"center",whiteSpace:"nowrap"}),it=function(e){window.__c={n:"SearchExperimentFilter"};const{experiment:t}=e,{leftOverrides:s,rightOverrides:i,experimentDiffers:n,experimentAgreesButNondefault:o}=(0,E.VK)((()=>{const e=k.v_.state.searchExperimentOverrides,s=k.BJ.state.searchExperimentOverrides,r=(e[t.experimentId]??t.group)!==(s[t.experimentId]??t.group);return{leftOverrides:e,rightOverrides:s,experimentDiffers:r,experimentAgreesButNondefault:!r&&void 0!==s[t.experimentId]&&e[t.experimentId]!==t.group}}),[t]),l=(0,N.yK)((e=>({rowContainer:{backgroundColor:n?e.equationErrorPlaceholderBackground:o?e.accentColors.yellow[100]:void 0},titleCell:{...rt(e),maxWidth:180,textOverflow:"ellipsis",overflow:"hidden"}})),[o,n]),a=(0,r.useCallback)((e=>{const{experimentId:t,group:s,store:r}=e;r.setState({...r.state,searchExperimentOverrides:{...r.state.searchExperimentOverrides,[t]:s}})}),[]);return(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)("div",{style:{...l.titleCell,...l.rowContainer},children:t.experimentId.replace("search-","")}),(0,Ze.jsx)("div",{style:l.rowContainer,children:(0,Ze.jsx)(et,{experiment:t,searchExperimentOverrides:s,onChange:e=>{a({...e,store:k.v_})}})}),(0,Ze.jsx)("div",{style:l.rowContainer,children:(0,Ze.jsx)(et,{experiment:t,searchExperimentOverrides:i,onChange:e=>{a({...e,store:k.BJ})}})})]})};var nt=s(53877),ot=s(42875),lt=s(22686);let at=function(e){return e[e.Button=0]="Button",e[e.MenuItem=1]="MenuItem",e}({});class dt extends i.Z{constructor(){super(...arguments),this.handleFilterClick=e=>{const{onMenuDismiss:t}=this.props;this.applyFilter(e),this.openSidebar(),t&&t()},this.applyFilter=e=>{A.ZP.updateFilters(e)},this.openSidebar=()=>{A.ZP.isDebugSidebarOpen()||A.ZP.setState({...A.ZP.state,isDebugSidebarOpen:!0})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},buttonFilter:{padding:"4px 8px",display:"flex",alignItems:"center",overflow:"hidden"},buttonText:{...de.Z.textOverflowStyle},icon:{display:"inline-block",height:14,width:14,fill:"currentColor"},buttonIcon:{marginRight:6}}}renderComponent(){const{mode:e}=this.props;return e===at.Button?this.renderAsButton():e===at.MenuItem?this.renderAsMenuItem():void(0,u.t1)(e)}renderAsButton(){const{icon:e,title:t,filter:s}=this.props,r=this.styles,i=this.getThemeColors();return(0,Ze.jsxs)(he.Z,{style:{...r.buttonFilter,...i.buttonFilter},onClick:()=>this.handleFilterClick(s),children:[e&&e({...r.icon,...r.buttonIcon}),(0,Ze.jsx)("span",{style:r.buttonText,children:t})]})}renderAsMenuItem(){const{icon:e,title:t,filter:s,focused:r}=this.props,i=this.styles,n=this.getThemeColors(),o={...i.menuItem,...n.menuItem};return(0,Ze.jsx)(pe.Z,{icon:e&&e(i.icon),focused:r,title:t,onClick:()=>this.handleFilterClick(s),style:o})}getThemeColors(){const{device:e}=this.environment;return{menuItem:{color:e.isDesktop?this.theme.mediumTextColor:void 0,...this.props.isLastInSection&&{boxShadow:void 0}},buttonFilter:{color:this.theme.mediumTextColor}}}}dt.displayName="SearchFilterPreset",dt.Mode=at;class ct extends i.Z{renderComponent(){const e=ct.getCurrentPageFilter();if(e)return(0,Ze.jsx)(dt,{icon:Se.j,title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.quickFilters.inCurrentPage",defaultMessage:"In current page"}),filter:e,...this.props})}static isActive(e){const t=ct.getCurrentPageFilter();if(!t)return!1;if(!t.ancestors)return!1;const s=t.ancestors[0];return-1!==e.ancestors.indexOf(s)}}ct.displayName="InCurrentPagePreset",ct.getCurrentPageFilter=()=>{const{mainEditorCurrentBlockStore:e}=P.default.state;if(e&&e.id)return{ancestors:[e.id]}};class ut extends i.Z{renderComponent(){const e=ut.getCurrentUserFilter(this.environment);if(e)return(0,Ze.jsx)(dt,{icon:lt.f,title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.quickFilters.createdByMe",defaultMessage:"Created by me"}),filter:e,...this.props})}static isActive(e,t){const s=ut.getCurrentUserFilter(e);if(!s)return!1;if(!s.createdBy)return!1;const r=s.createdBy[0];return-1!==t.createdBy.indexOf(r)}}ut.displayName="CreatedByMePreset",ut.getCurrentUserFilter=e=>{const{id:t}=e.currentUser;if(t)return{createdBy:[t]}};class ht extends i.Z{renderComponent(){const e=ht.getPastWeekFilter();if(e)return(0,Ze.jsx)(dt,{icon:se.C,title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.quickFilters.editedLastWeek",defaultMessage:"Edited last week"}),filter:e,...this.props})}static isActive(e){const{lastEditedTime:t}=ht.getPastWeekFilter();return d.Xy(t,e.lastEditedTime)}}ht.displayName="EditedLastWeekPreset",ht.getPastWeekFilter=()=>({lastEditedTime:{starting:nt.Oo((0,ot.r)()),ending:nt.Lg((0,ot.r)())}});var pt=s(1743),mt=s(74194);function gt(e){window.__c={n:"SearchStringOverrideControls"};const{leftValue:t,rightValue:s,setLeftValue:i,setRightValue:n,placeholder:o,label:l}=e,{titleCell:a,rightTitleCell:d,leftTitleCell:c}=(0,N.yK)((e=>{const r=rt(e);return{titleCell:r,rightTitleCell:{...r,color:s?r.color:e.lightTextColor,width:"95%"},leftTitleCell:{...r,color:t?r.color:e.lightTextColor,width:"95%"}}}),[t,s]),[u,h]=(0,r.useState)(s),[p,m]=(0,r.useState)(t);(0,r.useEffect)((()=>{void 0===s&&h(void 0),void 0===t&&m(void 0)}),[s,t]);const g=(0,r.useCallback)((()=>{n(u)}),[n,u]),v=(0,r.useCallback)((()=>{i(p)}),[i,p]),f=(0,r.useCallback)((e=>{h(e.target.value)}),[]),y=(0,r.useCallback)((e=>{m(e.target.value)}),[]);return(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)("div",{style:a,children:l}),(0,Ze.jsxs)(pt.Z,{capture:!0,allowMenuList:!1,children:[(0,Ze.jsx)(mt.Z,{style:c,onBlur:v,value:p,onChange:y,placeholder:o}),(0,Ze.jsx)(mt.Z,{style:d,onBlur:g,value:u,onChange:f,placeholder:o})]})]})}let vt=function(e){return e.Button="Button",e.Section="Section",e}({});class ft extends i.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:ue.Z},this.renderAddFilterOrigin=e=>{const t=this.styles;return(0,Ze.jsx)(ve.Z,{...e,style:t.addFilterButtonMobile,icon:ie.I,isBlue:!0,children:(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Add filter",id:"search.addFilter.button.label"})})},this.renderAddFilterMenu=()=>(0,Ze.jsxs)(Y.Z,{menuType:W.og.ActionSheet,children:[this.renderSuggestedFilters(),(0,Ze.jsxs)($e.Z,{title:this.renderMoreFiltersTitle(),children:[this.renderCreatedByFilter(Re.Z.Mode.Button),this.renderCreatedTimeFilter(Re.Z.Mode.Button),this.renderLastEditedTimeFilter(Re.Z.Mode.Button),this.renderAncestorFilter(Re.Z.Mode.Button),this.renderInTeamFilter(Re.Z.Mode.Button)]})]}),this.searchExperimentsToToggle=this.createComputedStore((()=>Object.entries(a.g6).map((e=>{let[t,s]=e;return{experimentId:t,experimentVersion:1,group:w.default.getGroup(t),groups:["control",...s]}})))),this.closeAddFilterMenu=()=>{const{buttonPopupStore:e}=this.stores;e.setState({...e.state,open:!1})},this.callTitleFilterUpdateFns=e=>{A.ZP.updateFilters({navigableBlockContentOnly:e})},this.closeSidebar=()=>A.ZP.setState({...A.ZP.state,isDebugSidebarOpen:!1}),this.styles={sidebar:{paddingTop:12,paddingBottom:24,overflowY:"auto",overflowX:"hidden",flex:"0 0 250px",minHeight:400},sidebarHidden:{display:"none"},addFilterButtonMobile:{fontSize:this.props.isMobile?de.Z.fontSize.UISmall.mobile:de.Z.fontSize.UISmall.desktop,fontWeight:de.Z.fontWeight.medium,marginRight:-8}}}renderComponent(){return this.props.isMobile?this.props.mode===vt.Button?this.renderAddButtonMobile():this.props.mode===vt.Section?this.renderActiveFiltersMobile():void(0,u.t1)(this.props.mode):this.renderSidebar()}renderActiveFiltersMobile(){const{state:e}=A.ZP,t=M.De(e.query.filters);return(0,Ze.jsxs)(fe.Z,{disableMobilePadding:!0,disableMobileBorders:!0,children:[this.renderTitlesOnlyFilter(Re.z.Section),this.renderDeletedOnlyFilter(Re.z.Section),this.renderActiveFilters(t,Re.Z.Mode.Section)]})}renderAddButtonMobile(){const{buttonPopupStore:e}=this.stores;return(0,Ze.jsx)(me.ZP,{popupType:me.Z4.SlideUp,buttonPopupStore:e,renderOrigin:this.renderAddFilterOrigin,render:this.renderAddFilterMenu})}renderActiveFilters(e,t){return(0,Ze.jsxs)(r.Fragment,{children:[e.createdBy&&this.renderCreatedByFilter(t),e.createdTime&&this.renderCreatedTimeFilter(t),e.lastEditedTime&&this.renderLastEditedTimeFilter(t),e.ancestors&&this.renderAncestorFilter(t),e.inTeams&&this.renderInTeamFilter(t)]})}renderSuggestedFilters(){const{filters:e}=A.ZP.state.query,t=ut.isActive(this.environment,e),s=ht.isActive(e),r=ct.isActive(e);if(!(t&&s&&r))return(0,Ze.jsxs)($e.Z,{title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.quickFiltersSection.title",defaultMessage:"Quick filters"}),marginAfter:!0,children:[!t&&(0,Ze.jsx)(ut,{mode:at.MenuItem,focused:!1,onMenuDismiss:this.closeAddFilterMenu}),!s&&(0,Ze.jsx)(ht,{mode:at.MenuItem,focused:!1,onMenuDismiss:this.closeAddFilterMenu}),!r&&(0,Ze.jsx)(ct,{mode:at.MenuItem,focused:!1,onMenuDismiss:this.closeAddFilterMenu,isLastInSection:!0})]})}renderSidebar(){const e=this.styles,t=this.getThemeColors(),s={...e.sidebar,...t.sidebar,...!A.ZP.isDebugSidebarOpen()&&e.sidebarHidden};return(0,Ze.jsxs)("aside",{style:s,children:[(0,Ze.jsx)(he.Z,{onClick:this.closeSidebar,style:{display:"flex",alignItems:"center",justifyContent:"center",background:void 0,borderRadius:6,width:16,height:16,position:"absolute",top:10,right:10},children:(0,re.D)({width:14,fill:this.theme.mediumTextColor})}),this.renderDevToolsSection()]})}renderForcedClusterPatternInput(){return null}renderShowDebugInfoToggle(){return(0,Ze.jsx)(Qe,{mode:Re.z.Button,focused:!1,title:"Show debug info",icon:te.S,value:k.ZP.state.showDebugInfo,onChange:e=>{k.ZP.setState({...k.ZP.state,showDebugInfo:Boolean(e)})}})}renderShowDebugSearchToggle(){return(0,Ze.jsx)(Qe,{mode:Re.z.Button,focused:!1,title:"Profile query",icon:te.S,value:"everything"===k.ZP.state.debug,onChange:e=>{k.ZP.setState({...k.ZP.state,debug:e?"everything":void 0})}})}renderDevToolsSection(){if((0,ae.x)(y.default))return(0,Ze.jsx)($e.Z,{title:"Dev Tools",children:(0,Ze.jsx)($.Z,{isVisible:!0,animationStyle:{height:"100%"},render:()=>(0,Ze.jsxs)("div",{style:{overflow:"scroll"},children:[this.renderShowDebugInfoToggle(),this.renderShowDebugSearchToggle(),this.renderForcedClusterPatternInput(),(0,Ze.jsxs)($e.Z,{style:{marginTop:16},title:"Quick Switch",children:[(0,Ze.jsx)(xt,{title:"No local at all",searchExperimentOverrides:{"search-no-local-blending":"on","search-debug-only-no-recent-boosting":"on"}}),(0,Ze.jsx)(xt,{title:"No local results",searchExperimentOverrides:{"search-no-local-blending":"on"}}),(0,Ze.jsx)(xt,{title:"No local boosting",searchExperimentOverrides:{"search-debug-only-no-recent-boosting":"on"}}),(0,Ze.jsx)(xt,{title:"Vector only",searchExperimentOverrides:{"search-vectors":"log-norm"}})]}),(0,Ze.jsx)($e.Z,{style:{marginTop:16},title:"Dev Experiments",right:(0,Ze.jsx)(ve.Z,{onClick:()=>{k.v_.reset(),k.BJ.reset()},style:{paddingLeft:0,paddingRight:0,height:"unset"},children:(0,ne.b)({width:12})}),children:(0,Ze.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr 1fr",minWidth:"100%",maxWidth:"100%",paddingLeft:14},children:[(0,Ze.jsx)("div",{}),(0,Ze.jsx)("div",{}),(0,Ze.jsx)(yt,{columnStore:k.BJ}),this.searchExperimentsToToggle.state.map((e=>(0,Ze.jsx)(it,{experiment:e},e.experimentId))),(0,Ze.jsx)(gt,{leftValue:k.v_.state.forcedClusterPattern,rightValue:k.BJ.state.forcedClusterPattern,setLeftValue:k.v_.updateForcedClusterPattern,setRightValue:k.BJ.updateForcedClusterPattern,placeholder:"cluster-pattern",label:"forced cluster pattern"}),(0,Ze.jsx)(gt,{leftValue:k.v_.state.forcedBlockIds,rightValue:k.BJ.state.forcedBlockIds,setLeftValue:k.v_.updateForcedBlockIds,setRightValue:k.BJ.updateForcedBlockIds,placeholder:"block ids",label:"forced block ids"})]})})]})})})}renderTitlesOnlyFilter(e){const{filters:t}=A.ZP.state.query;return(0,Ze.jsx)(Qe,{mode:e,focused:!1,title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Title only"}),icon:le.c,value:t.navigableBlockContentOnly||!1,onChange:this.callTitleFilterUpdateFns})}renderDeletedOnlyFilter(e){const{filters:t}=A.ZP.state.query;return(0,Ze.jsx)(Qe,{mode:e,focused:!1,title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.deletedOnlyToggle.label",defaultMessage:"Deleted only"}),icon:oe.y,value:t.isDeletedOnly||!1,onChange:this.createUpdateFunction("isDeletedOnly")})}renderMoreFiltersTitle(){return(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.moreFiltersSection.title",defaultMessage:"More filters"})}renderAncestorFilter(e){const{filters:t}=A.ZP.state.query;return(0,Ze.jsx)(di.Consumer,{children:s=>{let{parentStore:r}=s;return(0,Ze.jsx)(Le,{mode:e,focused:!1,title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In"}),parentStore:r,blockIds:t.ancestors,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("ancestors")})}})}renderCreatedByFilter(e){const{filters:t}=A.ZP.state.query;return(0,Ze.jsx)(di.Consumer,{children:s=>{let{parentStore:r}=s;return(0,Ze.jsx)(Oe.Z,{mode:e,focused:!1,title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.moreFilters.createdBy",defaultMessage:"Created by"}),parentStore:r,userIds:t.createdBy,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("createdBy")})}})}renderCreatedTimeFilter(e){const{filters:t}=A.ZP.state.query;return(0,Ze.jsx)(ye.Z,{mode:e,focused:!1,title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"}),icon:se.C,value:t.createdTime,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("createdTime")})}renderLastEditedTimeFilter(e){const{filters:t}=A.ZP.state.query;return(0,Ze.jsx)(ye.Z,{mode:e,focused:!1,title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),icon:se.C,value:t.lastEditedTime,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("lastEditedTime")})}renderInTeamFilter(e){if(!(0,j.bq)())return;const{filters:t}=A.ZP.state.query;return(0,Ze.jsx)(di.Consumer,{children:s=>{let{parentStore:r}=s;return(0,Ze.jsx)(ze,{mode:e,focused:!1,title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace"}),parentStore:r,teamIds:t.inTeams,onMenuDismiss:this.closeAddFilterMenu,onChange:this.createUpdateFunction("inTeams")})}})}createUpdateFunction(e){return t=>A.ZP.updateFilters({[e]:t})}getThemeColors(){return{sidebar:{backgroundColor:this.theme.sidebarSecondaryBackground,borderLeft:`1px solid ${this.theme.regularDividerColor}`}}}}function yt(e){let{columnStore:t}=e;window.__c={n:"ExperimentColumnShowHeader"};const s=(0,E.VK)((()=>t.state.visible),[t]);return(0,Ze.jsx)(pe.Z,{icon:(0,Ze.jsx)(ge.Z,{checked:s,size:14,onClick:()=>t.update((e=>({...e,visible:!e.visible})))}),focused:!1,title:"Show",onClick:()=>t.update((e=>({...e,visible:!e.visible})))})}function xt(e){let{title:t,searchExperimentOverrides:s}=e;return(0,Ze.jsx)(pe.Z,{focused:!1,title:t,onClick:()=>{k.BJ.update((e=>({...e,visible:!1}))),k.v_.update((e=>({...e,searchExperimentOverrides:s})))}})}ft.displayName="SearchFilterMenu";const St=ft;var bt=s(28992),Ct=s(98519),Mt=s(4023),jt=s(7931);const It=function(e){window.__c={n:"SearchSortMenu"};const t=r.useRef(),s=(0,D.Fy)(),{isMobile:i}=s,{activeOption:n,items:o}=r.useMemo((()=>function(e){const{currentSortBy:t,setSortBy:s,sortOptions:r,selectButton:i}=e;let n=r[0];const o=r.map((e=>{const r=t.field,o=`${r}.${"relevance"===r?"":t.direction}`,l=e.key===o;return l&&(n=e),{key:e.key,action:()=>{s(e.sort),i&&i.current&&i.current.closeMenu()},render:t=>(0,Ze.jsx)(pe.Z,{...t,title:e.formattedName,right:l&&(0,Ct.k)({fill:Ye.ZP.regularIconColor,width:14,height:14})})}}));return{activeOption:n,items:o}}({...e,selectButton:t})),[e,t]),l=(0,N.yK)((e=>({selectedTitle:{color:e.mediumTextColor},label:{marginRight:2,fontSize:i?de.Z.fontSize.UISmall.mobile:de.Z.fontSize.UISmall.desktop,transform:"translateY(0.5px)"},innerButton:{color:e.mediumTextColor,fontWeight:de.Z.fontWeight.semibold,fontSize:i?de.Z.fontSize.UISmall.mobile:de.Z.fontSize.UISmall.desktop,height:20,padding:"2px 4px",marginRight:1,transform:"translateY(0.5px)"},menu:{minWidth:200}})),[i]),a=i?(0,Ze.jsx)(ce.FormattedMessage,{id:"search.sort.sortMenuTitle",defaultMessage:"Sort By"}):void 0;return(0,Ze.jsx)(jt.Z,{ref:e=>{e&&(t.current=e)},alignmentToOrigin:Mt.v.Start,selectedTitle:(0,Ze.jsx)("div",{style:l.selectedTitle,children:n.formattedName}),label:void 0,renderMenuSections:()=>[{key:"searchSortOrder",render:e=>(0,Ze.jsx)($e.Z,{...e,title:a,desktopStyle:l.menu,disableDesktopPadding:!1}),items:o}],labelStyle:l.label,innerButtonStyle:l.innerButton})};class Pt extends i.Z{constructor(){super(...arguments),this.styles={menuItemMobile:{paddingBottom:0},titleWrapper:{flex:void 0,marginTop:-3,marginBottom:-1},showSidebarButton:()=>{const{device:e}=this.environment;return{padding:"0 4px",fontSize:e.isMobile?de.Z.fontSize.UISmall.mobile:de.Z.fontSize.UISmall.desktop,fontWeight:de.Z.fontWeight.medium,borderRadius:3,height:20,lineHeight:"20px"}}}}renderComponent(){const{device:e}=this.environment,t=this.styles,s={...e.isMobile&&t.menuItemMobile},r=this.shouldAllowFilters()&&this.renderAddFilterButton();return(0,Ze.jsx)(bt.Z,{title:this.renderSortMenu(),right:r,textWrapperStyle:t.titleWrapper,style:s})}renderSortMenu(){return(0,Ze.jsx)(It,{currentSortBy:A.ZP.state.query.sort,setSortBy:e=>{A.ZP.setState({...A.ZP.state,query:{...A.ZP.state.query,sort:e}})},sortOptions:Tt})}renderAddFilterButton(){const{device:e}=this.environment;if(e.isMobile)return(0,Ze.jsx)(St,{isMobile:!0,mode:vt.Button})}shouldAllowFilters(){const{isPublicPageSearch:e}=this.props;return!e}}Pt.displayName="SearchHeader";const Tt=[{key:"relevance.",formattedName:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.sort.sortOrder.bestMatches",defaultMessage:"Best matches"}),sort:{field:"relevance"}},{key:"lastEdited.desc",formattedName:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.newestFirst",defaultMessage:"Last edited: Newest first"}),sort:{field:"lastEdited",direction:"desc"}},{key:"lastEdited.asc",formattedName:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.sort.sortOrder.lastEdited.oldestFirst",defaultMessage:"Last edited: Oldest first"}),sort:{field:"lastEdited",direction:"asc"}},{key:"created.desc",formattedName:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.sort.sortOrder.created.newestFirst",defaultMessage:"Created: Newest first"}),sort:{field:"created",direction:"desc"}},{key:"created.asc",formattedName:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.sort.sortOrder.created.oldestFirst",defaultMessage:"Created: Oldest first"}),sort:{field:"created",direction:"asc"}}],wt=Pt;var kt=s(35840),Ft=s(38755);class Rt extends o.default{getInitialState(){return{open:!1}}}const Zt=new Rt;var Bt=s(68785),At=s(33411);class Lt extends i.Z{constructor(){super(...arguments),this.typingTimer=void 0,this.renderLeft=()=>{const{showSpinner:e,selectedResult:t}=this.props,{device:s}=this.environment,r=this.styles,i={...this.getThemeColors().searchIcon,...r.searchIcon},n=null==t?void 0:t.getIcon(),o=Boolean(A.ZP.state.query.text.trim())&&!s.isMobile;return(0,Ze.jsx)(At.Z,{show:e,showDelay:500,showHold:200,render:e=>(e=>(0,Ze.jsx)("div",{style:r.headerIcon,children:e?(0,Ze.jsx)(Bt.Z,{style:i}):o?(0,Ze.jsx)(Pe.Z,{disabled:!0,icon:n,isEmptyPage:Boolean(n),size:20}):(0,kt.R)(i)}))(e)})},this.handleQueryChange=e=>{this.handleTyping();const t=String(e.target.value);this.props.onQueryChange(t)},this.handleClearButtonClick=()=>{A.ZP.resetQuery({resetFilters:!0}),A.ZP.update((e=>({...e,source:"quick_find"})))},this.handleFocus=()=>{const{onFocusChange:e}=this.props;e(!0)},this.handleBlur=()=>{const{onFocusChange:e}=this.props;e(!1)},this.styles={inputDesktop:{fontSize:18,height:Lt.DESKTOP_INPUT_HEIGHT,paddingLeft:12,paddingRight:16,alignItems:"center",flexGrow:0,flexShrink:0,zIndex:1},inputMobile:{fontSize:16,border:"none",boxShadow:"none",borderRadius:7,lineHeight:"1.2",padding:"6px 8px"},searchIcon:{width:16,height:16},headerIcon:{height:24,width:24,display:"flex",alignItems:"center",justifyContent:"center"},input:{minWidth:0,...de.Z.textOverflowStyle},suggestedText:{whiteSpace:"pre",color:this.theme.mediumTextColor},clearButton:{marginLeft:8}}}willUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=void 0)}renderComponent(){const{device:e}=this.environment,{isOpen:t,selectedResult:s}=this.props,r=this.styles,i=this.getThemeColors(),n=h.Jcv(null==s?void 0:s.getTitleValue()),o=A.ZP.state.query.text,l=void 0!==s&&(null==n?void 0:n.slice(0,o.length).toLocaleLowerCase())===o.toLocaleLowerCase()&&o&&o.length<20&&!e.isMobile,a=!l&&void 0!==s&&o&&o.length<20&&!e.isMobile;let d="";l?d=`${null==n?void 0:n.substring(o.length)} — ${Lt.messages.open.defaultMessage}`:a&&(d=n?` — ${Lt.messages.open.defaultMessage} ${n}`:` — ${Lt.messages.open.defaultMessage}`);const c=""!==d&&(0,Ze.jsxs)("div",{children:[(0,Ze.jsx)("span",{children:o}),(0,Ze.jsx)("span",{style:{background:this.theme.tint.regular},children:d})]}),u=e.isMobile?mt.Z.Format.ExtraLarge:mt.Z.Format.Transparent,p=e.isMobile?{...r.inputMobile,...i.inputMobile}:{...r.inputDesktop,...i.inputDesktop};return(0,Ze.jsx)(mt.Z,{format:u,placeholder:this.getPlaceholderText(),left:this.renderLeft(),value:o,suggestedText:c,suggestedTextStyle:r.suggestedText,focus:e.isMobile?void 0:t&&!Zt.state.open,focusInitial:!(0,H.Y)("supportsNativeHome")&&e.isMobile,focusAfterAnimation:!0,showClearButton:!0,selectAll:!0,onChange:this.handleQueryChange,onClearButtonClick:this.handleClearButtonClick,onFocus:this.handleFocus,onBlur:this.handleBlur,style:p,inputStyle:r.input})}updateIfIsFirstKeyStroke(){void 0===Z.default.state.firstKeyStrokeTimeMs&&Z.default.update((e=>({...e,firstKeyStrokeTimeMs:Date.now()})))}handleTyping(){this.updateIfIsFirstKeyStroke();const{onTypingChange:e}=this.props;this.typingTimer&&window.clearTimeout(this.typingTimer),e(!0),this.typingTimer=window.setTimeout((()=>e(!1)),Lt.TYPING_DEBOUNCE_MS)}getPlaceholderText(){const{currentSpaceStore:e,mainEditorCurrentBlockStore:t}=P.default.state,s=e&&(0,Ft.rn)(this.environment,e);if(s)return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.namedSpace",defaultMessage:"Search {spaceName}…"},{spaceName:s});if(t){const e=h.Jcv(t.getTitleValue()).slice(0,Lt.MAX_PLACEHOLDER_TITLE_LENGTH);return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.namedPage",defaultMessage:"Search in {pageTitle}…"},{pageTitle:e})}return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.unnamedPage",defaultMessage:"Search in page…"})}getThemeColors(){return{inputDesktop:{boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`},inputMobile:{background:this.theme.inputBackground},searchIcon:{fill:this.theme.mediumIconColor}}}}Lt.displayName="SearchInputMenuItem",Lt.messages=(0,ce.defineMessages)({open:{id:"search.inputMenu.suggestedText.open",defaultMessage:"Open"}}),Lt.TYPING_DEBOUNCE_MS=300,Lt.DESKTOP_INPUT_HEIGHT=48,Lt.MAX_PLACEHOLDER_TITLE_LENGTH=100;const Ot=(0,ce.injectIntl)(Lt);var Dt=s(11751),Et=s(12921),Nt=s(69327),Vt=s(29798),qt=s(88923),_t=s(27724),Wt=s(43145),zt=s(94184),Ht=s.n(zt),Ut=s(75e3),Kt=s(64369);function $t(e,t){window.__c={n:"SearchActionMenuItem"};const{inline:s,title:r,focused:i,isLastInSection:n,isBeforeFocused:o,className:l}=e,{icon:a,...d}=e,c=(0,N.yK)((e=>({hoveredStyle:{background:e.buttonHoveredBackground}})),[]),u=(0,N.yK)((e=>({style:{minHeight:36,paddingTop:8,paddingBottom:8,...!s&&!n&&!o&&!i&&{boxShadow:`0 1px 0 ${e.lightDividerColor}`}},textWrapper:{marginLeft:4,alignItems:void 0,flex:void 0,width:"100%",display:"block",textOverflow:"ellipsis",...s&&{alignItems:"baseline"}},icon:{display:"block",flexShrink:0,height:18,width:18,color:e.mediumTextColor},enterIcon:{height:14,width:14,fill:e.mediumIconColor},iconContainer:{marginTop:1}})),[n,i,s,o]),h={title:r,icon:Gt(a,u.icon,u.iconContainer),style:u.style,textWrapperStyle:u.textWrapper,right:Qt(i,u.enterIcon),className:Ht()("notranslate",l),buttonStyle:{paddingLeft:2},hoveredStyle:c.hoveredStyle};return(0,Ze.jsx)(pe.Z,{ref:t,...d,...h,disableTransition:!0,ignoreLocalHoverState:!0})}function Gt(e,t,s){return(0,Ze.jsx)(Kt.Z,{style:s,children:e(t)})}function Qt(e,t){const s={...t,opacity:e?1:0};return(0,Ze.jsx)("div",{style:{display:"flex"},children:(0,Ut.U)(s)})}const Yt=r.forwardRef($t);var Jt=s(75024),Xt=s(63296);class es extends i.Z{constructor(){super(...arguments),this.openSidebar=()=>A.ZP.setState({...A.ZP.state,isDebugSidebarOpen:!0}),this.styles={footer:()=>{const{device:e}=this.environment;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:e.isMobile?de.Z.fontSize.UIRegular.mobile:de.Z.fontSize.UIRegular.desktop}},footerWrapper:{flexShrink:0},footerText:{color:this.theme.lightTextColor,fontSize:Jt.yv(this.environment,"UISmall"),...de.Z.textOverflowStyle},footerDebugButton:{...ts(this.theme),marginRight:6}}}renderComponent(){const e=this.styles;return(0,Ze.jsx)("footer",{style:e.footerWrapper,children:(0,Ze.jsxs)(fe.Z,{topBorder:!0,style:e.footer(),disableDesktopPadding:!0,children:[(0,Ze.jsx)(bt.Z,{...this.props,style:e.footerText}),(0,ae.x)(y.default)&&!A.ZP.state.isDebugSidebarOpen&&(0,Ze.jsx)(Xt.Z,{onClick:this.openSidebar,style:e.footerDebugButton,children:"Open Debug Sidebar"})]})})}}es.displayName="SearchFooterContainer";const ts=e=>({fontSize:12,color:e.lightTextColor,marginLeft:6,paddingRight:4,paddingLeft:4,height:24}),ss=es;var rs=s(33907),is=s(22109),ns=s(62134);function os(){window.__c={n:"SearchFooterNavigationHints"};const e=(0,D.O7)(),t=(0,ce.useIntl)(),s=(0,N.yK)((t=>({upDownIcon:{marginRight:4,marginBottom:-2,display:"inline",width:12,height:12,fill:t.mediumIconColor},enterIcon:{marginRight:4,marginBottom:-2,display:"inline",width:11,height:11,fill:t.mediumIconColor},commandGlyph:{fontSize:.75*Jt.yv(e,"UIRegular"),paddingRight:1,color:t.mediumIconColor},footerText:{fontSize:Jt.yv(e,"UISmall"),color:t.lightTextColor,...de.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16},forwardSlash:{fontSize:9,userSelect:"none",fontWeight:500,display:"flex",lineHeight:1.4},toggleSidePeekHotkey:{display:"inline-flex",marginRight:4}})),[e]),r={...Jt.mK,...s.footerText},[i,n]=(0,E.VK)((()=>[F.default.isSidePeekPanelEnabled(),A.ZP.isSidePeekPanelOpen()]),[]),{command:o}=ns.fg(e);return(0,Ze.jsxs)("ul",{style:r,children:[(0,Ze.jsxs)("li",{style:s.inlineHint,children:[(0,is.T)(s.upDownIcon),t.formatMessage({id:"searchFooter.helpText.selectHint",defaultMessage:"Select"})]}),(0,Ze.jsxs)("li",{style:s.inlineHint,children:[(0,Ut.U)(s.enterIcon),t.formatMessage({id:"searchFooter.helpText.openHint",defaultMessage:"Open"})]}),(0,Ze.jsxs)("li",{style:s.inlineHint,children:[(0,Ze.jsx)("span",{style:s.commandGlyph,children:o}),(0,Ut.U)(s.enterIcon),e.device.isElectron?t.formatMessage({id:"searchFooter.helpText.openNewWindow",defaultMessage:"Open in a new window"}):t.formatMessage({id:"searchFooter.helpText.openNewTab",defaultMessage:"Open in a new tab"})]}),i?(0,Ze.jsxs)("li",{style:s.inlineHint,children:[(0,Ze.jsxs)("span",{style:s.toggleSidePeekHotkey,children:[(0,Ze.jsx)("span",{style:s.commandGlyph,children:o}),(0,Ze.jsx)("span",{style:s.forwardSlash,children:"\\"})]}),n?t.formatMessage({id:"searchFooter.helpText.closeSidePeek",defaultMessage:"Close preview"}):t.formatMessage({id:"searchFooter.helpText.openSidePeek",defaultMessage:"Preview"})]}):null]})}function ls(e){var t;let{explanation:s,simple:r=!1,filterZeros:i=!1}=e;return function e(t,s){if(!t)return[];const{value:n,description:o,details:l}=t;if(0===n&&i)return[];const a=(0===n?"0":n.toFixed(4)).padStart(8);function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return`${"  ".repeat(s+t)}${e}`}const c=`[${a}] ${o}`;if(o.startsWith("match on required clause")){return[d(`[${a}] match on required clause ${null==l?void 0:l[1].description}`)]}if(["max of:","sum of:","min of:"].includes(o)&&1===(null==l?void 0:l.length))return e(l[0],s);if(o.startsWith("tf")||o.startsWith("idf")){var u;const e=o.split(",")[0],t=null===(u=o.split(" computed as ")[1])||void 0===u?void 0:u.replace(" from:","");return[d(`[${a}] ${e}: [${(l??[]).map((e=>`${e.description.split(",")[0]}=${e.value}`)).join(" ")}] --\x3e ${t}`)]}if(o.startsWith("ConstantScore(_id:"))return[d(`[${a}] ids query`)];const h=r&&0!==s&&(o.startsWith("weight")||o.startsWith("Function"));return[d(c.replace(", result of:","").replace(" from:","").replace(" [PerFieldSimilarity]","").replace(/:$/,"").trim()),...(h?[]:l??[]).flatMap((t=>e(t,s+1)))]}(null==s||null===(t=s.details)||void 0===t?void 0:t[0],0)}rs.n;s(75553),s(32240);var as=s(94308),ds=s(45168),cs=s(14871),us=s(97820),hs=s(28020),ps=s(84210),ms=s(98742),gs=s(16402),vs=s(77907),fs=s(35057),ys=s(24039),xs=s(90403),Ss=s(64133),bs=(s(73063),s(50506)),Cs=s(86176),Ms=s(26388),js=s(3043),Is=s(96525);function Ps(e){window.__c={n:"SearchBreadcrumbFilterPopup"};const{parent:t,store:s,onClick:i}=e,n=(0,D.O7)(),{device:o}=n;let l;l=o.isMobile?{menuType:W.og.Modal,title:(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Breadcrumb",id:"breadcrumb.mobileBreadcrumbMenu.title"}),right:(0,Ze.jsx)(J.DoneMenuText,{}),onClickRight:t.close}:{menuType:W.og.Popup,width:240};const a=(0,r.useCallback)((()=>{null==i||i({store:s,action:"include"})}),[i,s]),d=(0,r.useCallback)((()=>{null==i||i({store:s,action:"exclude"})}),[i,s]),c=s instanceof Ie.zX?"teamspace":"parent page",u={key:"results",render:e=>(0,Ze.jsx)(fe.Z,{...e}),items:[{key:"include-filter",render:e=>(0,Ze.jsx)(pe.Z,{...e,title:`Add ${c} to filter`}),action:a},{key:"exclude-filter",render:e=>(0,Ze.jsx)(pe.Z,{...e,title:`Exclude ${c} from results`}),action:d}]};return(0,Ze.jsx)(Y.Z,{...l,children:(0,Ze.jsx)(Xe.Z,{type:Xe.i.Vertical,onAccept:t.close,initialFocus:void 0,sections:[u]})})}class Ts extends i.Z{constructor(){super(...arguments),this.getFilterPopupRenderer=e=>t=>(0,Ze.jsx)(Ps,{parent:t,store:e,onClick:this.props.onClick}),this.getBreadcrumbCommonProps=e=>({maxWidth:this.props.ancestorMaxWidth,popupRenderer:this.getFilterPopupRenderer(e),iconSize:this.props.iconSize,titleStyle:this.getTitleStyle(),iconStyle:Ts.iconStyle,highlighter:this.props.highlighter})}renderComponent(){const{store:e}=this.props,t=e.getTitleStore();if(t&&t.isReady())return(0,Ze.jsx)("div",{style:this.getStyle(),className:"notranslate",children:this.renderAncestors()})}renderAncestors(){const{store:e,maxAncestorCount:t}=this.props,s=b.uJ(e),r=e.isNavigableBlock()?s.slice(1):[...s];if(r.reverse(),s.reverse(),r.length>t){const[e,i,n]=[r[0],r.slice(1,r.length-t+1),r.slice(r.length-t+1)];if((0,j.bq)()){const t=n.length;return[this.renderButtonForStore({store:e,showDivider:!this.props.isMobile}),this.renderBlocksAsPopup(this.props.isMobile?s:i),...n.map(((e,s)=>{const r=!this.props.hideCurrentPage||s!==t-1;return e instanceof Ie.zX?(0,Ze.jsx)(js.Yo,{store:e,showDivider:r,...this.getBreadcrumbCommonProps(e)},e.id):(0,Ze.jsx)(js.Qe,{store:e,showDivider:r,...this.getBreadcrumbCommonProps(e)},e.id)}))]}{const e=r.filter((e=>e instanceof Ie.G)),s=r.filter((e=>e instanceof Ie.G)),i=e.length;return[(0,Ze.jsx)(js.Qe,{store:e[0],showDivider:!this.props.isMobile,...this.getBreadcrumbCommonProps(e[0])},e[0].id),this.renderBlocksAsPopup(this.props.isMobile?s:e.slice(1,e.length-t+1)),...e.slice(e.length-t+1).map(((e,t)=>(0,Ze.jsx)(js.Qe,{store:e,showDivider:!this.props.hideCurrentPage||t!==i-1,...this.getBreadcrumbCommonProps(e)},e.id)))]}}{const e=r.length;return r.map(((t,s)=>this.renderButtonForStore({store:t,showDivider:!this.props.hideCurrentPage||s!==e-1})))}}renderButtonForStore(e){const{store:t,showDivider:s}=e;return t instanceof Ie.zX?(0,Ze.jsx)(js.Yo,{store:t,showDivider:s,...this.getBreadcrumbCommonProps(t)}):(0,Ze.jsx)(js.Qe,{store:t,showDivider:s,...this.getBreadcrumbCommonProps(t)})}getMenuListSections(e){const t=this.props.isMobile?me.Z4.SlideUp:me.Z4.Popup;return[{key:"results",render:e=>(0,Ze.jsx)(fe.Z,{...e}),items:e.map(((e,s)=>({key:e.id,render:r=>(0,Ze.jsx)(Is.Z,{...r,stopClickPropagation:!0,popupType:t,renderOrigin:t=>(0,Ze.jsx)(Te.Z,{...t,isSubpage:0!==s,store:e,hidePath:!0,focused:!1}),render:t=>(0,Ze.jsx)(Ps,{parent:t,store:e,onClick:this.props.onClick})}),action:()=>{}})))}]}renderBlocksAsPopup(e){return(0,Ze.jsx)(me.ZP,{popupType:this.props.isMobile?me.Z4.SlideUp:me.Z4.Popup,renderOrigin:e=>{var t;return this.props.isMobile?(0,Ze.jsxs)(he.Z,{style:{...Ts.dividerWrapStyle},mobileFeedback:!0,...e,children:[(0,Ze.jsx)(js.fY,{}),(0,Ze.jsx)("div",{style:ws,children:"..."}),(0,Ze.jsx)(js.fY,{})]}):(0,Ze.jsxs)("div",{style:Ts.dividerWrapStyle,children:[(0,Ze.jsx)(ve.Z,{isSmall:!0,...e,style:{paddingLeft:2,paddingRight:2,fontSize:null===(t=this.props.style)||void 0===t?void 0:t.fontSize},children:"..."}),(0,Ze.jsx)(js.fY,{})]})},render:t=>{let s;return s=this.props.isMobile?{menuType:W.og.Modal,title:(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Breadcrumb",id:"breadcrumb.mobileBreadcrumbMenu.title"}),right:(0,Ze.jsx)(J.DoneMenuText,{}),onClickRight:t.close}:{menuType:W.og.Popup,width:240},(0,Ze.jsx)(Y.Z,{...s,children:(0,Ze.jsx)(Xe.Z,{type:Xe.i.Vertical,initialFocus:void 0,sections:this.getMenuListSections(e)})})}},"pages-popup")}getStyle(){return{display:"flex",alignItems:"center",lineHeight:1.2,fontSize:this.props.isMobile?de.Z.fontSize.UIRegular.mobile:de.Z.fontSize.UIRegular.desktop,color:this.theme.text.tertiary,filter:"grayscale(70%)",...this.props.style}}getTitleStyle(){return{lineHeight:1.2,fontSize:this.props.isMobile?de.Z.fontSize.UISmall.mobile:de.Z.fontSize.UISmall.desktop,color:this.theme.text.tertiary}}}Ts.displayName="SearchPathBreadcrumb",Ts.iconStyle={marginRight:3},Ts.dividerWrapStyle={display:"flex",alignItems:"center",flexShrink:0};const ws={marginLeft:3,marginRight:3};var ks=s(66897),Fs=s(45238);const Rs=(0,Fs.I)("arrowRightSquare",{viewBox:"0 0 18 18",svg:(0,Ze.jsx)("path",{d:"M3.06641 17.998L14.9121 17.998C16.9629 17.998 17.9785 16.9824 17.9785 14.9707L17.9785 3.04688C17.9785 1.03516 16.9629 0.0195312 14.9121 0.0195312L3.06641 0.0195312C1.02539 0.0195312 0 1.02539 0 3.04688L0 14.9707C0 16.9922 1.02539 17.998 3.06641 17.998ZM14.1797 8.98438C14.1797 9.20898 14.082 9.38477 13.8867 9.57031L10.4883 12.9785C10.3516 13.1152 10.1758 13.1934 9.96094 13.1934C9.54102 13.1934 9.22852 12.8711 9.22852 12.4512C9.22852 12.2363 9.31641 12.0508 9.45312 11.9141L10.7129 10.6738L11.9238 9.6582L9.79492 9.73633L4.56055 9.73633C4.12109 9.73633 3.80859 9.42383 3.80859 8.98438C3.80859 8.53516 4.12109 8.22266 4.56055 8.22266L9.79492 8.22266L11.9238 8.31055L10.7129 7.29492L9.45312 6.05469C9.32617 5.9082 9.22852 5.72266 9.22852 5.50781C9.22852 5.08789 9.54102 4.77539 9.96094 4.77539C10.1758 4.77539 10.3516 4.84375 10.4883 4.98047L13.8867 8.39844C14.0918 8.60352 14.1797 8.75977 14.1797 8.98438Z"})}),Zs=(0,Fs.I)("sidebarRight",{viewBox:"0 0 23 18",svg:(0,Ze.jsx)("path",{d:"M3.06641 17.998L19.9609 17.998C22.0117 17.998 23.0273 16.9824 23.0273 14.9707L23.0273 3.04688C23.0273 1.03516 22.0117 0.0195312 19.9609 0.0195312L3.06641 0.0195312C1.02539 0.0195312 0 1.02539 0 3.04688L0 14.9707C0 16.9922 1.02539 17.998 3.06641 17.998ZM3.08594 16.4258C2.10938 16.4258 1.57227 15.9082 1.57227 14.8926L1.57227 3.125C1.57227 2.10938 2.10938 1.5918 3.08594 1.5918L19.9414 1.5918C20.9082 1.5918 21.4551 2.10938 21.4551 3.125L21.4551 14.8926C21.4551 15.9082 20.9082 16.4258 19.9414 16.4258ZM14.082 16.7285L15.6152 16.7285L15.6152 1.29883L14.082 1.29883ZM17.4902 5.21484L19.5801 5.21484C19.8828 5.21484 20.1367 4.95117 20.1367 4.66797C20.1367 4.375 19.8828 4.12109 19.5801 4.12109L17.4902 4.12109C17.1973 4.12109 16.9336 4.375 16.9336 4.66797C16.9336 4.95117 17.1973 5.21484 17.4902 5.21484ZM17.4902 7.74414L19.5801 7.74414C19.8828 7.74414 20.1367 7.48047 20.1367 7.1875C20.1367 6.89453 19.8828 6.65039 19.5801 6.65039L17.4902 6.65039C17.1973 6.65039 16.9336 6.89453 16.9336 7.1875C16.9336 7.48047 17.1973 7.74414 17.4902 7.74414ZM17.4902 10.2637L19.5801 10.2637C19.8828 10.2637 20.1367 10.0195 20.1367 9.72656C20.1367 9.43359 19.8828 9.17969 19.5801 9.17969L17.4902 9.17969C17.1973 9.17969 16.9336 9.43359 16.9336 9.72656C16.9336 10.0195 17.1973 10.2637 17.4902 10.2637Z"})});var Bs=s(90683);function As(e){window.__c={n:"SearchResultToolTip"};const{store:t}=e,s=(0,E.VK)((()=>{const e=t.getCreatedByPointer();if(e)return(0,ks.Hl)({pointer:e,getRecordValue:t.getRecordValue})}),[t]),r=(0,E.VK)((()=>{const e=t.getLastEditedByPointer();if(e)return(0,ks.Hl)({pointer:e,getRecordValue:t.getRecordValue})}),[t]),i=(0,N.yK)((e=>({container:{backgroundColor:Ye.FN.light.gray[900],display:"flex",flexDirection:"column",borderRadius:8},preview:{fontSize:14,color:Ye.FN.light.gray[100],fontWeight:400,display:"flex",gap:10,alignItems:"center"}})),[]),n=(0,ce.useIntl)();return(0,Ze.jsxs)("div",{style:i.container,children:[s&&(0,Ze.jsx)(Ls,{store:t,activity:"created",actor:s}),r&&(0,Ze.jsx)(Ls,{store:t,activity:"edited",actor:r}),(0,Ze.jsxs)("div",{style:{padding:10,display:"flex",justifyContent:"space-between",cursor:"pointer",alignItems:"center"},onClick:()=>A.ZP.update((e=>({...e,isSidePeekPanelOpen:!0}))),children:[(0,Ze.jsxs)("div",{style:i.preview,children:[(0,Ze.jsx)("span",{children:Zs({height:14,width:14})}),(0,Ze.jsx)("span",{children:n.formatMessage({id:"searchResultMenuItem.tooltip.sidePeek",defaultMessage:"Preview"})})]}),(0,Ze.jsx)("div",{style:{color:"#7F7F7F"},children:Rs({height:14,width:14})})]})]})}function Ls(e){window.__c={n:"UserActivity"};const{activity:t,actor:s,store:r}=e,i=(0,N.yK)((e=>({container:{display:"flex",flexDirection:"column",padding:"8px 10px 10px 10px",gap:8,borderBottom:`1px solid ${Ye.FN.light.gray[800]}`,minWidth:195},actorAvatarAndName:{display:"flex",alignItems:"center",gap:5},actorActivityInfo:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:10,fontSize:14},description:{color:"#7F7F7F",fontSize:12,fontWeight:600},date:{color:"#7F7F7F",fontSize:12}})),[]),[n]=(0,E.VK)((()=>{const e="created"===t?r.getCreatedTime():r.getLastEditedTime();return[(0,gs.IS)(e,{useCompactFormat:!0,useLowercase:!0})]}),[t,r]),o=(0,ce.useIntl)();return(0,Ze.jsxs)("div",{style:i.container,children:[(0,Ze.jsx)("div",{style:i.description,children:"edited"===t?o.formatMessage({id:"searchResultMenuItem.tooltip.lastEditedBy",defaultMessage:"Last edited by"}):o.formatMessage({id:"searchResultMenuItem.tooltip.createdBy",defaultMessage:"Created by"})}),(0,Ze.jsxs)("div",{style:i.actorActivityInfo,children:[(0,Ze.jsxs)("div",{style:i.actorAvatarAndName,children:[(0,Ze.jsx)("span",{children:(0,Bs.a)({actor:s,size:20,style:{}})}),(0,Ze.jsx)("span",{children:(0,ks.$4)(o,s)})]}),(0,Ze.jsx)("div",{style:i.date,children:n})]})]})}(0,ce.defineMessages)({openInSidePeekButtonLabel:{id:"search.result.openInSidePeek.button.label",defaultMessage:"Open search result in side peek"},copySearchResultLinkButtonLabel:{id:"search.result.copyLink.button.label",defaultMessage:"Copy link to search result"}});class Os extends i.Z{constructor(){super(...arguments),this.storeTypes={explanationModalOpen:o.default.createClass(!1)},this.renderTooltip=()=>F.default.state.intentBasedSearch.enablesSidePeekPanel?(0,Ze.jsx)(As,{store:this.props.store}):(0,Ze.jsx)(ys.Z,{store:this.props.store}),this.handleSearchPathBreadcrumbClick=e=>{let{store:t,action:s}=e;"block"===t.table?"include"===s?A.ZP.updateFilters({ancestors:d.jj(A.ZP.state.query.filters.ancestors.concat(t.id))}):A.ZP.updateFilters({dev_excludedPages:d.jj((A.ZP.state.query.filters.dev_excludedPages||[]).concat(t.id))}):"team"===t.table&&("include"===s?A.ZP.updateFilters({inTeams:d.jj((Ne.iY(A.ZP.state.query.filters.inTeams)||[]).concat(t.id))}):A.ZP.updateFilters({dev_excludedTeams:d.jj((A.ZP.state.query.filters.dev_excludedTeams||[]).concat(t.id))}))},this.renderVerifiedBadge=()=>(0,Ze.jsx)(xs.Z,{style:this.styles.badge,content:(0,Ze.jsxs)("div",{style:this.styles.badgeContent,children:[(0,as.f)(this.styles.verifiedBadgeIcon),(0,Ze.jsx)("div",{style:this.styles.badgeCaption,children:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.result.verified.badge.text",defaultMessage:"Verified"})})]})}),this.renderPopularThisWeekBadge=()=>(0,Ze.jsx)(xs.Z,{style:this.styles.badge,content:(0,Ze.jsx)("div",{style:this.styles.badgeCaption,children:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.result.popularThisWeek.badge.text",defaultMessage:"Popular this week"})})}),this.renderMostViewedBadge=()=>(0,Ze.jsx)(xs.Z,{style:this.styles.badge,content:(0,Ze.jsx)("div",{style:this.styles.badgeCaption,children:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.result.mostViewed.badge.text",defaultMessage:"Most viewed"})})}),this.renderIsTemplateBadge=()=>(0,Ze.jsx)(xs.Z,{content:(0,Ze.jsx)("div",{style:this.styles.grayedOutBadgeCaption,children:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.result.template.badge.text",defaultMessage:"Template"})})}),this.getPageVisitSource=()=>"recent_pages"===this.props.type?l.tY.SearchRecents:l.tY.SearchQuery,this.handleOpenInSidePeek=()=>{const{store:e,queryId:t,result:s}=this.props,r=this.getPageVisitSource();s?g.navigateToSearchResult({searchResult:s,openInSidePeek:!0,environment:this.environment,pageVisitSource:r,queryId:t,openInNew:void 0}):g.navigateToPage({store:e,queryId:t,environment:this.environment,pageVisitSource:r,openInSidePeek:!0,peekMode:"s"})},this.handleCopy=()=>{const{store:e,queryId:t}=this.props,s=(0,ps.ZP)({store:e,pageVisitSource:this.getPageVisitSource(),queryId:t});cs.RD({environment:this.environment,stringValue:s,copiedMessage:cs.tq.copiedLinkToClipboard})},this.styles={title:{fontWeight:de.Z.fontWeight.medium,lineHeight:"20px"},titleContent:{display:"flex",...this.props.inline?{}:{width:0,flexGrow:1}},menuItem:{minHeight:36,paddingTop:this.environment.device.isMobile?12:8,paddingBottom:this.environment.device.isMobile?12:8},textWrapper:{marginLeft:4,alignItems:"center",width:"100%"},inlineTextWrapper:{alignItems:"center"},highlight:{fontWeight:de.Z.fontWeight.medium},vectorHighlight:{fontWeight:de.Z.fontWeight.medium,whiteSpace:"pre-wrap"},rightContentWrapper:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},rightIcon:{height:16,width:16},rightIconButtonIcon:{height:12,width:12},rightIconButtonWrapper:{height:18,width:18,marginRight:6},uniqueIDBadgeWrapper:{display:"flex",gap:8,marginRight:8,alignItems:"center"},caption:{marginTop:1},debugArea:{fontFamily:"monospace"},timestamp:{fontSize:de.Z.fontSize.UISmall.desktop,fontWeight:de.Z.fontWeight.regular},tooltip:{maxWidth:300},sidePeekTooltip:{background:"transparent",boxShadow:"none"},tooltipTitle:{fontWeight:de.Z.fontWeight.medium,fontSize:de.Z.fontSize.UISmall.desktop},tooltipText:{fontWeight:de.Z.fontWeight.medium,fontSize:de.Z.fontSize.UISmall.desktop,marginLeft:0,paddingRight:20},tooltipValue:{fontSize:de.Z.fontSize.UISmall.desktop,fontWeight:de.Z.fontWeight.regular},tooltipMenuItem:{minHeight:20},badge:{background:"light"===this.theme.mode?this.theme.accentColors.blue[30]:this.theme.accentColors.blue[200]},badgeContent:{display:"flex",alignItems:"center",width:"100%"},badgeCaption:{marginLeft:2,color:this.theme.blueColor},grayedOutBadgeCaption:{marginLeft:1},vectorBadge:{background:this.theme.invoiceGreen,color:this.theme.contentBackground},verifiedBadgeIcon:{width:10,height:10,fill:this.theme.blueColor},right:{display:"flex"},collectionTextMatchingProperty:{lineHeight:2}},this.debugHitCustomRenderer=e=>{let{data:t,keyPath:s}=e;if(2===s.length&&"_explanation"===s[0])return{element:(0,Ze.jsx)(Ze.Fragment,{children:(0,Ze.jsx)("button",{onClick:e=>{this.stores.explanationModalOpen.setState(!0),e.stopPropagation()},children:"show simplified explanation"})}),expanded:!1};const r=t._ltrlog;if(r)return function(e){const t=Object.keys(e[0])[0],s=e[0][t].map(((e,t)=>{const s=t%2==0?Vs:Ns;return(0,Ze.jsxs)("tr",{children:[(0,Ze.jsx)("td",{style:s,children:`${t}`}),(0,Ze.jsx)("td",{style:s,children:`${e.name}`}),(0,Ze.jsx)("td",{style:s,children:`${e.value}`})]},e.name)}));return{element:(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)("div",{children:(0,Ze.jsx)("b",{children:`Featureset: ${t}`})}),(0,Ze.jsx)("div",{style:qs,children:(0,Ze.jsx)("table",{style:_s,children:s})})]}),expanded:!1}}(r);if(!["_score","matched_queries"].every((e=>t[e])))return null;const{_score:i,matched_queries:n}=t;return{element:(0,Ze.jsx)(Ze.Fragment,{children:`score ${i}, ${(n??[]).length} matched query clauses`}),expanded:!1}}}renderComponent(){const{focused:e,isLastInSection:t,isBeforeFocused:s,inline:r,className:i}=this.props,n=this.styles,o=this.getThemeColors(),l={...n.menuItem,...!r&&!t&&!s&&!e&&o.menuItemBorder},a={...n.caption,...o.caption},d={...n.timestamp,...o.timestamp},c={...n.textWrapper,...this.props.inline&&n.inlineTextWrapper},u={title:this.renderTitle(),icon:this.renderIcon(),caption:this.renderCaption(),body:this.renderPreview(),right:this.renderRight(),rightStyle:e?void 0:d,dontShrinkRight:!0,captionStyle:a,style:l,spacerStyle:this.hasPath()?void 0:Ws,textWrapperStyle:c,className:Ht()("notranslate",i),buttonStyle:{paddingLeft:2},hoveredStyle:{background:this.theme.tint.regular}},h=F.default.state.intentBasedSearch.enablesSidePeekPanel,p=(0,fs.Mk)()&&!A.ZP.state.isSidePeekPanelOpen,m=p&&h&&this.props.focused;return p?(0,Ze.jsx)(Ms.Z,{delayThreshold:50,placement:Ms.Z.Placement.Right,originGap:18,forceVisibleState:!!m||void 0,renderTooltip:this.renderTooltip,allowHover:!!h,style:h?n.sidePeekTooltip:n.tooltip,render:e=>(0,Ze.jsx)(pe.Z,{...this.props,...u,disableTransition:!0,...(0,ms.Z)(this.props,e)}),closeDelay:0}):(0,Ze.jsx)(pe.Z,{...this.props,...u,disableTransition:!0,ignoreLocalHoverState:!0})}renderTitle(){var e;const{store:t,result:s,placeholder:r,index:i}=this.props,n=this.styles,o=this.getThemeColors(),l=void 0===s,a={...n.title,...!l&&!this.props.focused&&o.nonHighlightedTextColor},d=[];if(s&&s.highlight)if(d.push(...(0,S.fe)(s.highlight.pathText)),this.isANonLocalResult())d.push(...(0,S.fe)(s.highlight.title));else{Ie.G.createChildStore(this.props.store,{table:be.iU,id:s.id,spaceId:s.spaceId}).isNavigableBlock()&&d.push(...(0,S.fe)(s.highlight.text))}const c=this.props.focused?void 0:this.getWordHighlighter({words:d}),u=null===(e=(0,b.VP)(t))||void 0===e?void 0:e.isArchived(),h=(0,ds.e)(s),p=(0,hs.zj)(),m=p&&p===(null==s?void 0:s.id)&&"on"===w.default.getGroup("search-includes-current-page-in-local-search");const g=(0,fs.Mk)()&&!m&&!u?function(){function e(e){var t;return void 0!==(null==s||null===(t=s.badges)||void 0===t?void 0:t.find((t=>t.type===e)))}return e("is_template")?"is_template":e("verified")?"verified":e("popular_this_week")?"popular_this_week":e("most_viewed")?"most_viewed":void 0}():void 0,v={is_template:this.renderIsTemplateBadge,verified:this.renderVerifiedBadge,popular_this_week:this.renderPopularThisWeekBadge,most_viewed:this.renderMostViewedBadge};return(0,Ze.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",...a},children:[(0,Ze.jsxs)("div",{style:n.titleContent,children:[k.ZP.state.showDebugInfo&&void 0!==i&&`${i+1}. `,h&&this.renderUniqueIdHighlight(s),(0,Ze.jsx)(we.Z,{style:a,store:t,placeholder:r,highlighter:c}),!1,u&&(0,Ze.jsx)(xs.Z,{content:(0,Ze.jsx)("div",{style:this.styles.grayedOutBadgeCaption,children:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.result.archived.badge.text",defaultMessage:"Archived"})})}),m&&(0,Ze.jsx)(xs.Z,{content:(0,Ze.jsx)("div",{style:this.styles.grayedOutBadgeCaption,children:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.result.currentPage.badge.text",defaultMessage:"Current page"})})}),g&&v[g]()]}),k.ZP.state.showDebugInfo&&this.renderDebugIcons()]})}renderUniqueIdHighlight(e){var t;const{focused:s}=this.props,r=null==e||null===(t=e.highlight)||void 0===t?void 0:t.uniqueId;if(!r)return;const i="dark"===this.environment.ThemeStore.state.mode,n=this.styles,o=this.getWordHighlighter({words:[r]}),l=s?i?Ye.FN.dark.translucentGray[300]:Ye.se.light.darkgray.alpha(.09):i?Ye.FN.dark.translucentGray[200]:Ye.se.light.darkgray.alpha(.06);return(0,Ze.jsxs)("div",{style:n.uniqueIDBadgeWrapper,children:[(0,Ze.jsx)("div",{children:(0,Ze.jsx)(Ss.Z,{text:r,highlighter:o})}),(0,Ze.jsx)("div",{style:{borderRight:`1.5px solid ${l}`,height:14,borderRadius:1}})]})}renderRight(){return(0,Ze.jsx)("div",{style:this.styles.right,children:this.rightContent()})}rightContent(){const{lastViewed:e,focused:t}=this.props;if(this.environment.device.isMobile)return;if(e&&!t)return(0,gs.IS)(e,{useCompactFormat:!0});const s=this.styles,r=this.getThemeColors(),i={...s.rightIcon,...r.enterIcon,opacity:t?1:0};s.rightIconButtonIcon;return(0,Ut.U)(i)}renderDebugIcons(){var e;const{result:t,index:s,originalPosition:r}=this.props,i=null===(e=(null==t?void 0:t.sources)??[])||void 0===e?void 0:e.flatMap((e=>e===Ne.vp.Local?["💻"]:e===Ne.vp.ElasticSearch?["🌐"]:e===Ne.vp.Postgres?["🐘"]:e===Ne.vp.VectorDBBlock||e===Ne.vp.VectorDBCollection?["🔭"]:e===Ne.vp.ElasticsearchRandom?["🎲"]:e===Ne.vp.ElasticsearchUniqueID?["🆔"]:e===Ne.vp.ElasticsearchForcedRecentRecall?["⏰"]:void(0,u.t1)(e))).reverse(),n=[...void 0===s||void 0===r?[" "]:s>r?["⬇️"]:s<r?["⬆️"]:[],...i].join("").trim();return n&&(0,Ze.jsx)("span",{children:n})}renderIcon(){const{store:e}=this.props;return(0,Ze.jsx)(Pe.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:20,largeIcon:!1})}renderCaption(){const{store:e,inline:t,result:s,debugLocal:r,debugHits:i}=this.props,{device:n}=this.environment,o=this.getWordHighlighter({words:(0,S.fe)(s&&s.highlight&&s.highlight.pathText),removeDuplicate:!0}),l=t||n.isMobile?0:2,a=(i??[]).find((e=>"elasticsearch"===e.type&&void 0!==e._explanation)),d="elasticsearch"===(null==a?void 0:a.type)?null==a?void 0:a._explanation:void 0;return(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)(Cs.Z,{store:e,extraLength:l,showFullPathInTooltip:!0,highlighter:o,enableHoverAncestor:!0,tooltipStyle:this.getThemeColors().captionTooltip,tooltipDividerStyle:this.getThemeColors().captionTooltipDivider}),(0,Ze.jsxs)("div",{ref:this.props.debugAreaRef,children:[r&&(0,Ze.jsx)("div",{style:this.styles.debugArea,children:(0,Ze.jsx)(vs.LazyAdminReactJson,{data:{debugLocal:r},defaultCollapsed:!0,customCollapsedRenderers:[Es],showCopyButton:!1,showModalButton:!1})}),i&&(0,Ze.jsx)("div",{style:this.styles.debugArea,children:(0,Ze.jsx)(vs.LazyAdminReactJson,{data:{debugHits:i},defaultCollapsed:!0,customCollapsedRenderers:[this.debugHitCustomRenderer],showCopyButton:"small",showModalButton:!0})}),i&&(null==s?void 0:s.rankingSignals)&&(0,Ze.jsx)("div",{style:this.styles.debugArea,children:(0,Ze.jsx)(vs.LazyAdminReactJson,{data:{rankingSignals:s.rankingSignals},defaultCollapsed:!0,showCopyButton:"small",showModalButton:!1})}),d&&(0,Ze.jsx)(bs.Z,{open:this.stores.explanationModalOpen.state,innerStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},onDismiss:()=>{this.stores.explanationModalOpen.setState(!1)},render:()=>(0,Ze.jsx)("pre",{children:ls({explanation:d}).join("\n")})})]})]})}renderPreview(){var e,t;const{result:s}=this.props;if(!s)return;if(!s.highlight)return;if(Ie.G.createChildStore(this.props.store,{table:be.iU,id:s.id,spaceId:s.spaceId}).isNavigableBlock()&&!this.isANonLocalResult())return;let r,i;if(s.highlight.text)r=s.highlight.text;else if(s.highlight.collectionText){var n;r=s.highlight.collectionText,i=null==s||null===(n=s.matchedCollectionProperties)||void 0===n?void 0:n.collectionText}if(!r)return;const o=(0,S.ZP)(r);let l=!1;if(this.isANonLocalResult()){const e=e=>e.filter(S.il).map((e=>e[0].toLowerCase())),t=t=>void 0===t?[]:e((0,S.ZP)(t)),r=[...new Set([...t(s.highlight.title),...t(s.highlight.pathText)])],i=e=>r.some((t=>t.includes(e)));l=e(o).every((e=>i(e)))}const a=null!==(e=s.sources)&&void 0!==e&&e.includes(Ne.vp.VectorDBBlock)||null!==(t=s.sources)&&void 0!==t&&t.includes(Ne.vp.VectorDBCollection)?this.styles.vectorHighlight:this.styles.highlight,{highlightedText:d}=this.getThemeColors();let c={...a,...d};if(l){const e=w.default.getEligibleGroup({experimentId:"search-show-redundant-body-preview"});switch(e){case void 0:case"control":return;case"no-highlight":c={};break;case"highlight":break;default:(0,u.t1)(e)}}return(0,Ze.jsxs)(Ze.Fragment,{children:[void 0!==i&&(0,Ze.jsx)(us.Z,{propertySchema:i,showIcon:!0,style:this.styles.collectionTextMatchingProperty}),(0,Ze.jsx)(Ss.Z,{text:r,highlighter:{tokenize:e=>(0,S.Vu)(o),style:c}})]})}isANonLocalResult(){const{result:e}=this.props;return e&&!e.sources.includes(Ne.vp.Local)}getWordHighlighter(e){const{words:t,removeDuplicate:s}=e;if(0===t.length)return;const r={...this.styles.highlight,...this.getThemeColors().highlightedText},i=s?new Set:void 0;return{tokenize:e=>(0,S.XT)({text:e,patterns:t,uniqueTokenHighlighterContext:i}),style:r}}shouldComponentUpdate(e,t,s){return e.focused!==this.props.focused}hasPath(){const{hidePath:e,store:t}=this.props;return!e&&(0,Cs.L)(t)}getThemeColors(){return{nonHighlightedTextColor:{color:this.theme.text.secondary},menuItemBorder:{boxShadow:`0 1px 0 ${this.theme.lightDividerColor}`},highlightedText:{color:this.theme.text.primary},enterIcon:{fill:this.theme.icon.secondary},bookmarkedIcon:{fill:this.theme.topbarFavorite},caption:{color:this.theme.text.secondary},captionTooltip:{color:this.theme.text.contrast},captionTooltipDivider:{color:this.theme.text.contrast},timestamp:{color:this.theme.text.tertiary},tooltipTitle:{color:this.theme.text.secondary},tooltipText:{color:this.theme.text.primary},tooltipValue:{color:this.theme.text.tertiary}}}}Os.displayName="SearchResultMenuItem",Os.contextTypes={...W.mw,...i.w};const Ds=Os,Es=e=>{let{data:t}=e;const s=t;if(!s)return null;const{localSource:r,score:i,frecencyScore:n,personalizationBoost:o}=s;let l=r;return l||(l=new Set("unknown")),{element:(0,Ze.jsx)(Ze.Fragment,{children:`from ${[...l].join(",")} [s ${i} | f ${n} | b ${o}]`}),expanded:!1}},Ns={paddingLeft:5,paddingRight:20,paddingTop:2,paddingBottom:2,border:"1px solid black",color:Ye.FN.dark.green[900]},Vs={...Ns,color:Ye.FN.dark.gray[30]},qs={maxHeight:200,overflowY:"scroll"},_s={border:"1px solid black"};const Ws={visibility:"hidden"};function zs(e){switch(e){case"Today":return(0,Ze.jsx)(ce.FormattedMessage,{id:"search.recentPagesTimeBuckets.today.text",defaultMessage:"Today"});case"Yesterday":return(0,Ze.jsx)(ce.FormattedMessage,{id:"search.recentPagesTimeBuckets.yesterday.text",defaultMessage:"Yesterday"});case"Past Week":return(0,Ze.jsx)(ce.FormattedMessage,{id:"search.recentPagesTimeBuckets.pastWeek.text",defaultMessage:"Past Week"});case"Past 30 Days":return(0,Ze.jsx)(ce.FormattedMessage,{id:"search.recentPagesTimeBuckets.past30Days.text",defaultMessage:"Past 30 Days"});case"Older":return(0,Ze.jsx)(ce.FormattedMessage,{id:"search.recentPagesTimeBuckets.older.text",defaultMessage:"Older"})}(0,u.t1)(e)}const Hs=function(e){window.__c={n:"SearchDefaultBody"};const{onSelect:t,spaceId:s}=e,[i,n]=r.useState(!1),[o,l]=r.useState(!1),a=(0,E.qz)(void 0,Vt.Z),{section:c,indexLocal:u}=(0,E.VK)((()=>a.state.focus),[a]),h=(0,D.O7)(),p=(0,D.Fy)(),m=(0,N.yK)((e=>({wrapper:{width:"100%",height:"100%",overflowX:"hidden",overflowY:"auto"},sectionHeader:{fontWeight:de.Z.fontWeight.semibold,marginBottom:7},section:{marginBottom:18},notionAiLabel:{lineHeight:"20px",fontSize:14,textOverflow:"ellipsis",overflow:"hidden",display:"block",fontWeight:de.Z.fontWeight.medium},notionAiIcon:{fill:e.aiPurpleColor}})),[]),{defaultBodyFocusedResult:g}=(0,r.useContext)(ai),f=(0,E.VK)((()=>je.X4.state),[]),y=(0,E.VK)((()=>{const e=qt.default.state,t=qt.default.isMiniOrCenterPeekOpen()||_t.default.isInPeekRenderer();return e.open&&(t||e.isOpening)?e.target:P.default.state.mainEditorCurrentBlockStore}),[]),x=(0,E.VK)((()=>Et.fG.shouldShowSearchMenuItemAskAI()),[]);(0,r.useEffect)((()=>()=>{g.setState(void 0)}));const S=(0,E.VK)((()=>x?[{key:"actionMenuItem.assistant",action:()=>{v.em({environment:h})},render:e=>(0,Ze.jsx)(Yt,{...e,title:(0,Ze.jsx)("div",{className:"notranslate",style:m.notionAiLabel,children:(0,Ze.jsx)(ce.FormattedMessage,{id:"searchDefaultBody.searchActionMenuItem.askNotionAi",defaultMessage:"Ask Notion AI"})}),icon:e=>(0,Dt.t)({...e,...m.notionAiIcon})})}]:[]),[h,x,m.notionAiIcon,m.notionAiLabel]),b=f.filter((e=>e.pageId!==(null==y?void 0:y.id))),C=(0,E.VK)((()=>{const e={};return b.forEach((t=>{let{pageId:s,visitedAt:r}=t;return e[s]=r})),e}),[b]),M=(0,E.VK)((()=>{const e=new Map;return b.map(((s,r)=>{const i=je._5(s.visitedAt),n="Today"!==i&&"Yesterday"!==i,o={result:{key:`${s.store.id}:${r}`,action:e=>t({action:{...e,index:e.index-S.length},sectionName:"recents",selectedResult:{store:s.store,id:s.store.id,score:-1,spaceId:s.store.getSpaceId(),sources:[Ne.vp.Local],featureGroups:[],originalPosition:r,serverEventProperties:void 0}}),render:e=>(0,Ze.jsx)(Ds,{...e,inline:!p.isMobile,store:s.store,hidePath:!1,lastViewed:n?C[s.store.id]:void 0,buttonStyle:{paddingLeft:1},type:"recent_pages"})},store:s.store};var l;e.has(i)?null===(l=e.get(i))||void 0===l||l.push(o):e.set(i,[o])})),e}),[S.length,p.isMobile,b,t,C]),j=(0,E.VK)((()=>{const e=[];S.length>0&&e.push({key:"actions",items:S,render:e=>(0,Ze.jsx)(fe.Z,{title:"Actions",desktopTitleStyle:m.sectionHeader,disableDesktopPadding:!0,style:m.section,children:e.children})});for(const[t,s]of M.entries()){const r=zs(t),i={key:t,items:s.map((e=>e.result)),render:e=>(0,Ze.jsx)(fe.Z,{title:r,desktopTitleStyle:m.sectionHeader,disableDesktopPadding:!0,style:m.section,children:e.children})};e.push(i)}return e}),[S,M,m.section,m.sectionHeader]),I=(0,r.useCallback)((e=>{const t=()=>{const e=Nt.Z.getWithoutSubscribing(s),t=e[e.length-1];return null==t?void 0:t.visitedAt},r=d.P2((async()=>{const e=t(),r=h.currentUser.id;if(!r||!e)return;n(!0);const i=await je.Od(e,{environment:h,userId:r,spaceId:s});n(!1),i||l(!0)}),300);t()&&e<=200&&!i&&!o&&r()}),[o,i,h,s]);(0,r.useEffect)((()=>{if(void 0!==c&&void 0!==u){var e;const s=null===(e=j[c])||void 0===e?void 0:e.key;if(s&&"string"==typeof s&&"action"!==s&&je._k.includes(s)){var t;const e=null===(t=M.get(s))||void 0===t||null===(t=t[u])||void 0===t?void 0:t.store;return void g.setState(e)}}g.setState(void 0)}),[g,c,u,M,j]);const T=!p.isMobile&&b.length>0;return(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsxs)("div",{style:m.wrapper,children:[(0,Ze.jsx)(Xe.Z,{store:a,type:Xe.i.Vertical,initialFocus:0,disableKeyboardArrowWrap:!0,sections:j,unfocusOnScroll:!0}),(0,Ze.jsx)(Wt.Z,{onChange:I})]}),T&&(0,Ze.jsx)(ss,{title:(0,Ze.jsx)(os,{})})]})},Us=(0,Fs.I)("title",{viewBox:"0 0 14 10",svg:(0,Ze.jsx)("path",{d:"M10.674 9.45c.293 0 .576-.052.85-.153.273-.098.515-.238.726-.422.215-.184.383-.4.504-.65h.03v.662a.569.569 0 00.163.416c.11.101.25.152.422.152a.579.579 0 00.428-.164c.11-.105.164-.256.164-.451V4.973c0-.43-.104-.805-.31-1.125-.208-.32-.5-.569-.88-.744-.378-.18-.828-.27-1.347-.27-.594 0-1.114.115-1.559.346-.445.226-.75.533-.914.92-.031.07-.056.14-.076.21a.684.684 0 00-.03.194c0 .148.05.27.147.363.102.09.23.135.387.135a.61.61 0 00.287-.064.555.555 0 00.217-.2c.172-.32.377-.554.615-.703.238-.148.533-.223.885-.223.426 0 .76.112 1.002.334.242.223.363.528.363.915v.486l-1.828.1c-.77.042-1.361.23-1.775.562-.41.328-.616.773-.616 1.336 0 .379.09.71.27.996.183.285.435.508.756.668.324.16.697.24 1.119.24zm.328-.938c-.367 0-.666-.092-.897-.276a.906.906 0 01-.345-.738.86.86 0 01.34-.709c.23-.184.558-.29.984-.322l1.664-.106v.598c0 .293-.078.557-.234.791a1.69 1.69 0 01-.627.557c-.266.136-.56.205-.885.205zM.689 9.414c.2 0 .354-.045.463-.135.114-.086.202-.234.264-.445l.65-1.816h3.346l.65 1.816c.063.21.149.36.258.445.114.09.268.135.463.135.207 0 .371-.057.492-.17a.593.593 0 00.188-.463c0-.129-.027-.27-.082-.422L4.79 1.357c-.09-.246-.22-.43-.393-.55C4.23.686 4.012.625 3.742.625c-.508 0-.847.244-1.02.732L.116 8.39a1.3 1.3 0 00-.076.404c0 .195.057.348.17.457.117.11.277.164.48.164zm1.717-3.486L3.73 2.119h.03l1.324 3.809H2.406z"})});var Ks=s(15157),$s=s(34859),Gs=s(79131),Qs=s(53336),Ys=s(76725),Js=s(19889),Xs=s(7928);function er(e){window.__c={n:"SearchFilterBarTitle"};const{filterUIName:t}=e,{parentStore:s}=(0,r.useContext)(di),i=(0,E.VK)((()=>A.ZP.state.query.filters),[]),n=(0,N.yK)((e=>({title:{maxWidth:220,...de.Z.textOverflowStyle}})),[]),o=(0,E.VK)((()=>{switch(t){case"personFilter":return function(e,t){const s=e.createdBy,r=Me.default.getIntl(),i=d.oA(s.map((e=>{const s=Ie.U6.createChildStore(t,{table:Js.KJ,id:e});return(0,Xs.Nz)(r,s.getModel())})));return(0,Ys.Z)(i,ir)}(i,s);case"teamsFilter":case"dev_notInTeamFilter":return function(e,t){const s=(0,Ne.iY)(e.inTeams);if(!s)return[];const r=d.oA(s.map((e=>Ie.zX.createChildStore(t,{table:Ee.e0,id:e}).getName())));return(0,Ys.Z)(r,ir)}(i,s);case"pageFilter":return nr(i,s);case"dateFilter":return function(e){const t=Me.default.getIntl(),s=sr(e);if("createdTime"===s)return M._Q(e.createdTime,t);if("lastEditedTime"===s)return M._Q(e.lastEditedTime,t);return""}(i);case"pageFilter":case"dev_notInPageFilter":return nr(i,s);case"titleToggle":return[];default:(0,u.t1)(t)}}),[s,t,i]);return(0,Ze.jsx)("div",{style:n.title,children:(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"{filterName}{colon} {filterOperator} {filterValues}",id:"search.filterBarFilter.title",values:{filterName:tr(t),filterOperator:0===o.length?void 0:rr(t,i),filterValues:o,colon:0===o.length?void 0:":"}})})}function tr(e){switch(e){case"personFilter":return(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.moreFilters.person",defaultMessage:"Created by"});case"teamsFilter":return(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.moreFilters.inTeams",defaultMessage:"Teamspace"});case"pageFilter":return(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.moreFilters.inPage",defaultMessage:"In"});case"dateFilter":return(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.moreFilters.date",defaultMessage:"Date"});case"titleToggle":return(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.onlyMatchTitlesToggle.label",defaultMessage:"Title only"});case"dev_notInPageFilter":return(0,Ze.jsx)(ce.FormattedMessage,{id:"[DO NOT TRANSLATE].search.filterMenu.notInPageFilter.label",defaultMessage:"[dev] Not in page"});case"dev_notInTeamFilter":return(0,Ze.jsx)(ce.FormattedMessage,{id:"[DO NOT TRANSLATE].search.filterMenu.notInTeamFilter.label",defaultMessage:"[dev] Not in teamspace"})}(0,u.t1)(e)}function sr(e){const t=M.VD.createdTime(e.createdTime),s=M.VD.lastEditedTime(e.lastEditedTime);return t?"createdTime":s?"lastEditedTime":void 0}function rr(e,t){switch(e){case"personFilter":case"teamsFilter":case"pageFilter":case"dev_notInPageFilter":case"dev_notInTeamFilter":case"dateFilter":case"titleToggle":return}(0,u.t1)(e)}const ir=e=>", ";function nr(e,t){const s=e.ancestors,r=d.oA(s.map((e=>{const s=Ie.G.createChildStore(t,{table:be.iU,id:e});return s.isDefined()?s.getModel().getRenderTitle({getRecordModel:s.getRecordModel,userTimeZone:(0,ot.r)(),intl:Me.default.getIntl()}):""})));return(0,Ys.Z)(r,ir)}var or=s(41558),lr=s(3386),ar=s(53437),dr=s(45959),cr=s(83264);const ur={today:(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Today",id:"searchDateFilter.quickActions.today.label"}),pastWeek:(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Last 7 days",id:"searchDateFilter.quickActions.last7Days.label"}),pastMonth:(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Last 30 days",id:"searchDateFilter.quickActions.last30Days.label"})};function hr(e){let{date:t,onClick:s,onDismiss:r}=e;const i=(0,ot.r)(),n=nt.Lg(i),o=n;let l;const a=ur[t];"today"===t?l=n:"pastWeek"===t?l=nt.Oo(i):"pastMonth"===t?l=nt.dj(i):(0,u.t1)(t);return(0,Ze.jsx)(pe.Z,{focused:!1,icon:(0,se.C)({height:18,width:18}),title:a,onClick:e=>{s({value:{starting:{type:"date",start_date:l.start_date},ending:{type:"date",start_date:o.start_date}}}),r(e)}})}class pr extends i.Z{constructor(){super(...arguments),this.storeTypes={store:or.Z},this.renderPillButtonOrigin=()=>{const{icon:e,title:t}=this.props,{store:s}=this.stores,r=this.styles,{dateFilterType:i}=s.state,n=A.ZP.state.query.filters[i].starting;return(0,Ze.jsx)(He.Z,{on:Boolean(n),icon:e(r.pillIcon),title:(0,Ze.jsx)("span",{children:t}),onClick:this.handleOriginActivate})},this.renderPopupContents=()=>{const{title:e}=this.props,{store:t}=this.stores;return(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsxs)("div",{style:this.styles.dateFilterHeader,children:[this.renderOperatorSelect(),(0,Ze.jsx)(he.Z,{style:this.styles.clearButton,onClick:this.handleClear,children:(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Clear",id:"searchDateFilter.clearButton.label"})})]}),(0,Ze.jsxs)("div",{style:this.styles.quickDatesWrapper,children:[(0,Ze.jsx)(hr,{date:"today",onClick:this.updateTemporary,onDismiss:this.handleMenuClose}),(0,Ze.jsx)(hr,{date:"pastWeek",onClick:this.updateTemporary,onDismiss:this.handleMenuClose}),(0,Ze.jsx)(hr,{date:"pastMonth",onClick:this.updateTemporary,onDismiss:this.handleMenuClose})]}),(0,Ze.jsx)(cr.Z,{title:e,value:this.getCurrentValue(),onUpdate:this.updateTemporary,store:t,onDismiss:this.handleMenuClose,hideDateInputMenuItems:!0})]})},this.handleOriginActivate=()=>{const{disabled:e}=this.props,{store:t}=this.stores;e||t.setState({...t.state,isOpen:!0,focus:"starting"})},this.handleMenuClose=e=>{const{onMenuDismiss:t}=this.props,{store:s}=this.stores,{temporaryDateRange:r,dateFilterType:i}=s.state;M.zD(e)||(this.updateFilter(i,r),s.setState({...s.state,isOpen:!1}),t&&t())},this.handleClear=()=>{const{store:e}=this.stores,{dateFilterType:t}=e.state;this.updateFilter(t,{starting:void 0,ending:void 0}),e.clearTemporaryDateRange()},this.handleMenuListKey=e=>{e.preventDefault&&e.preventDefault()},this.updateTemporary=e=>{const{store:t}=this.stores;if(e.error)return;t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}});const{dateFilterType:s,temporaryDateRange:r}=t.state,{starting:i,ending:n}=r;i&&n&&this.updateFilter(s,{starting:i,ending:n})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},sectionMenuItem:{display:"flex"},icon:{height:14,width:14,fill:"currentColor"},pillIcon:{height:16,width:16,fill:"currentColor",marginRight:6},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:12,paddingBottom:8},menuItemTitleDesktop:{width:"100%"},summary:{display:"inline-flex"},quickDatesWrapper:{marginTop:12,boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,paddingBottom:15,marginBottom:15},clearButton:{color:this.theme.mediumTextColor,fill:this.theme.lightIconColor,fontWeight:500,fontSize:13,paddingLeft:2,paddingRight:2,paddingBottom:2,borderRadius:3,flexShrink:0},dateFilterHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",marginLeft:12,marginRight:12}}}didMount(){this.updateTemporary({value:this.props.value})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{store:t}=this.stores,s=this.styles;return(0,Ze.jsx)($e.Z,{style:s.sectionMenuItem,children:(0,Ze.jsx)(lr.Z,{capture:t.state.isOpen,onUp:this.handleMenuListKey,onDown:this.handleMenuListKey,onEnter:this.handleMenuListKey,children:(0,Ze.jsx)(ar.ZP,{popupType:this.getPopupType(),open:t.state.isOpen,origin:this.renderPillButtonOrigin(),render:this.renderPopupContents,onDismiss:this.handleMenuClose,placementToOrigin:ar.ZP.Placement.Bottom,alignmentToOrigin:ar.ZP.Alignment.Start,keepFocus:!0,style:s.popup})})})}updateFilter(e,t){A.ZP.updateFilters({[e]:t})}getHumanReadableDateFilterType(e){return{lastEditedTime:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.moreFilters.lastEdited",defaultMessage:"Last edited"}),createdTime:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.filterMenu.moreFilters.created",defaultMessage:"Created"})}[e]}updateFilterFromToggle(e){const{value:t}=this.props,{store:s}=this.stores,{dateFilterType:r}=s.state;this.updateFilter(e,t),e!==r&&(this.updateFilter(r,{starting:void 0,ending:void 0}),s.setState({...s.state,dateFilterType:e}))}renderOperatorSelect(){const{device:e}=this.environment,{store:t}=this.stores,{dateFilterType:s}=t.state,r={width:190,items:["createdTime","lastEditedTime"],selectedItem:s,getKey:e=>e,onSelect:e=>this.updateFilterFromToggle(e),renderItem:e=>(0,Ze.jsx)(pe.Z,{title:this.getHumanReadableDateFilterType(e.value),...e}),renderOrigin:t=>(0,Ze.jsx)(he.Z,{...t,style:{paddingLeft:2,paddingRight:2,paddingBottom:2,borderRadius:3,flexShrink:0},children:(0,Ze.jsxs)("div",{style:{display:"flex",alignItems:"center",...!e.isMobile&&{color:this.theme.mediumTextColor,fill:this.theme.lightIconColor,fontWeight:500,fontSize:13}},children:[(0,Ze.jsx)("span",{style:{marginRight:4},children:this.getHumanReadableDateFilterType(s)}),this.renderOperatorChevron()]})})};return(0,Ze.jsx)(dr.Z,{...r,mobileActionSheet:!0})}renderOperatorChevron(){const{device:e}=this.environment;return(0,Je.i)({width:10,height:10,...e.isMobile&&{marginTop:2}})}renderMobile(e){const{store:t}=this.stores,s=e===Re.z.Section?this.renderMobileFilterSummary():this.renderMobileButtonOrigin();return(0,Ze.jsx)(ar.ZP,{popupType:ar.ZP.PopupType.SlideUp,open:t.state.isOpen,origin:s,render:this.renderPopupContents,onDismiss:this.handleMenuClose,preventScaleTransition:!0})}renderMobileButtonOrigin(){const{icon:e,title:t,disabled:s}=this.props,r=this.styles;return(0,Ze.jsx)(pe.Z,{disabled:s,focused:!1,icon:e(r.icon),title:t,onClick:this.handleOriginActivate})}renderMobileFilterSummary(){const{title:e,value:t,dateFormat:s,disabled:r,intl:i}=this.props,n=this.styles,o=(0,Ze.jsxs)("div",{style:n.summary,children:[(0,se.C)(n.iconActiveMobile),M._Q(t,i,s)]});return(0,Ze.jsx)(Ke.Z,{disabled:r,onClick:this.handleOriginActivate,onClickClear:this.handleClear,label:e,title:o})}getCurrentValue(){const{store:e}=this.stores,{dateFilterType:t,temporaryDateRange:s}=e.state;return{...A.ZP.state.query.filters[t],...s}}getPopupType(){const{device:e}=this.environment;return e.isMobile?ar.ZP.PopupType.SlideUp:ar.ZP.PopupType.Popup}}pr.displayName="SearchGenericDateFilter";const mr=(0,ce.injectIntl)(pr);function gr(e){const t=A.ZP.state.query.sort,s=Tt.find((e=>d.Xy(e.sort,t)))??Tt[0],r="relevance"===s.sort.field?(0,Ze.jsx)(ce.FormattedMessage,{id:"search.sort.sortOrder.bestMatches.title",defaultMessage:"Sort"}):s.formattedName;return(0,Ze.jsx)(He.Z,{disabled:!1,title:r,onClick:e.onClick,icon:(0,is.T)({width:16,marginRight:6,fill:"currentColor"})})}function vr(){const e=A.ZP.state.query.sort,t=Tt.findIndex((t=>d.Xy(t.sort,e))),s=[];for(const r of Tt)s.push({key:r.key,render:e=>(0,Ze.jsx)(pe.Z,{...e,title:r.formattedName}),action:()=>{A.ZP.setState({...A.ZP.state,query:{...A.ZP.state.query,sort:r.sort}})}});return(0,Ze.jsx)(Y.Z,{menuType:W.og.Popup,children:(0,Ze.jsx)(Xe.Z,{type:Xe.i.Vertical,initialFocus:t<0?0:t,sections:[{key:"sortOptions",items:s,render:e=>(0,Ze.jsx)(fe.Z,{...e,disableDesktopPadding:!0})}]})})}const fr=function(){window.__c={n:"SearchSortButton"};const e=(0,N.yK)((()=>({popup:{paddingTop:12,paddingBottom:8}})),[]);return(0,Ze.jsx)(me.ZP,{popupType:me.Z4.Popup,renderOrigin:gr,render:vr,disabled:!1,placementToOrigin:ar.ZP.Placement.Bottom,alignmentToOrigin:ar.ZP.Alignment.Start,style:e.popup})},yr="SearchFilterSettings";function xr(e){window.__c={n:"SearchFilterBar"};const t=(0,E.qz)(void 0,ue.Z),{isMobile:s}=e,{parentStore:i}=(0,r.useContext)(di),n=(0,D.O7)(),o=(0,E.VK)((()=>n.currentUser.id),[n]),l=(0,E.VK)((()=>A.ZP),[]),a=(0,E.Kw)(l),d=a.query.filters,c=(0,E.VK)((()=>F.default.state.isPublicPageSearch),[]),u=(0,E.VK)((()=>(0,j.bq)()&&w.default.checkGate("enable_search_team_filter")&&!c),[c]),h=(0,E.VK)((()=>!c),[c]),p=!1,m=(0,N.yK)((e=>({scroller:{display:"flex",alignItems:"center",paddingTop:10,paddingRight:12,paddingBottom:10,paddingLeft:12},barContainer:{display:"flex",alignItems:"center"},scrollerContainer:{position:"relative",flexGrow:0,overflow:"hidden"},draggableList:{display:"flex",flexShrink:0,marginLeft:6},divider:{height:16,width:1,borderRadius:1,backgroundColor:e.stroke.deemphasized}})),[]),g=(0,r.useCallback)((e=>t=>l.updateFilters({[e]:t})),[l]),v=(0,r.useCallback)((()=>{t.setState({...t.state,open:!1})}),[t]),f=(0,r.useCallback)((()=>{if(h)return(0,Ze.jsx)(Oe.Z,{mode:Re.z.Pill,focused:!1,title:(0,Ze.jsx)(er,{filterUIName:"personFilter"}),parentStore:i,userIds:d.createdBy,onMenuDismiss:v,onChange:g("createdBy")})}),[h,i,d.createdBy,v,g]),y=(0,r.useCallback)((()=>u&&(0,Ze.jsx)(ze,{mode:Re.z.Pill,focused:!1,title:(0,Ze.jsx)(er,{filterUIName:"teamsFilter"}),parentStore:i,teamIds:d.inTeams,onMenuDismiss:v,onChange:g("inTeams")})),[i,d.inTeams,v,g,u]),x=(0,r.useCallback)((()=>(0,Ze.jsx)(Le,{mode:Re.z.Pill,focused:!1,title:(0,Ze.jsx)(er,{filterUIName:"pageFilter"}),parentStore:i,blockIds:d.ancestors,onMenuDismiss:v,onChange:g("ancestors")})),[i,d.ancestors,v,g]),S=(0,r.useCallback)((()=>null),[i,d.dev_excludedPages,v,g,p]),b=(0,r.useCallback)((()=>null),[i,d.dev_excludedTeams,v,g,p]),C=(0,r.useCallback)((()=>(0,Ze.jsx)(mr,{mode:Re.z.Pill,focused:!1,title:(0,Ze.jsx)(er,{filterUIName:"dateFilter"}),icon:se.C,value:d.lastEditedTime,onMenuDismiss:v})),[d.lastEditedTime,v]),M=(0,r.useCallback)((()=>!s&&(0,Ze.jsx)(Qe,{mode:Re.z.Pill,focused:!1,title:(0,Ze.jsx)(er,{filterUIName:"titleToggle"}),icon:Us,value:d.navigableBlockContentOnly||!1,onChange:g("navigableBlockContentOnly")})),[d.navigableBlockContentOnly,g,s]);(0,r.useEffect)((()=>{const e=Ks.Z.get({userId:o,key:yr});e&&e.filterOrder&&l.updateFilterState(e)}),[o,l]);const I={titleToggle:M(),personFilter:f(),teamsFilter:y(),pageFilter:x(),dateFilter:C(),dev_notInPageFilter:S(),dev_notInTeamFilter:b()};const P=(0,r.useCallback)((()=>(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)(fr,{}),(0,Ze.jsx)("div",{style:m.divider})]})),[m.divider]);return(0,Ze.jsx)("div",{style:m.barContainer,children:(0,Ze.jsx)("div",{style:m.scrollerContainer,children:(0,Ze.jsxs)(Qs.Z,{type:$s.Z.X,style:m.scroller,showLeftRightOverlay:!1,children:[(0,Ze.jsx)(Ze.Fragment,{children:P()}),(0,Ze.jsx)(Ze.Fragment,{children:(0,Ze.jsx)(Gs.ZP,{direction:"horizontal",keys:a.filterState.filterOrder,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,renderKey:e=>I[e],style:m.draggableList,onDrop:e=>function(e){const t={...a.filterState,filterOrder:e};Ks.Z.set({userId:o,key:yr,value:t}),l.updateFilterState(t)}(e)})})]})})})}var Sr=s(63737),br=s(44500),Cr=(s(1800),s(54642),s(47307),s(64964),s(31194),s(1310),s(16354)),Mr=s(43765);s(92660);(0,ce.defineMessages)({additionalInformationPlaceholder:{id:"SearchBadResultsForm.additionalInformation.placeholder",defaultMessage:"Any additional comments or context (e.g. ...)"},urlPlaceholder:{id:"SearchBadResultsForm.url.placeholder",defaultMessage:"Link to page you were looking for"}});class jr extends i.Z{constructor(){super(...arguments),this.storeTypes={requestModalOpen:o.default.createClass(!1),responseModalOpen:o.default.createClass(!1)},this.styles={footer:()=>{const{device:e}=this.environment;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:e.isMobile?de.Z.fontSize.UIRegular.mobile:de.Z.fontSize.UIRegular.desktop}},footerText:{fontSize:Jt.yv(this.environment,"UISmall"),...de.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16},resultCountWrapper:{display:"flex",alignItems:"center",...de.Z.textOverflowStyle},resultCount:{fontWeight:de.Z.fontWeight.medium},resultText:{verticalAlign:"middle",marginRight:6},spinner:{display:"inline",width:12,height:12,verticalAlign:"middle"},keyboardShortcut:{marginRight:4,marginBottom:1,fontVariant:"all-small-caps",fontSize:1.1*Jt.yv(this.environment,"UISmall")},commandGlyph:{fontSize:.75*Jt.yv(this.environment,"UIRegular")},footerDebugButton:ts(this.theme),debugModalStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},navigationHints:{marginLeft:15}}}renderComponent(){const{localResults:e,serverResults:t}=this.props.searchResultStore.state,{shouldShow:s}=this.props;if(!s)return;const r=this.styles,i=this.getThemeColors(),n={...r.resultCount,...i.resultCount},{count:o,isLowerBound:l}=this.props.searchResultStore.getResultCount(),a=(0,Ze.jsx)("span",{style:r.resultText,children:l?this.props.intl.formatMessage({id:"SearchResultsFooter.helpText.resultCountApproximate",defaultMessage:"{resultCount, plural, other {<resultwrapper>{resultCount}+</resultwrapper> results}}"},{resultCount:o,resultwrapper:e=>(0,Ze.jsx)("span",{style:n,children:e})}):this.props.intl.formatMessage({id:"SearchResultsFooter.helpText.resultCount",defaultMessage:"{resultCount, plural, one {<resultwrapper>{resultCount}</resultwrapper> result} other {<resultwrapper>{resultCount}</resultwrapper> results}}"},{resultCount:o,resultwrapper:e=>(0,Ze.jsx)("span",{style:n,children:e})})}),d=F.default.state.intentBasedSearch.enablesGrouping,c=d?(0,Ze.jsx)(os,{}):(0,Ze.jsxs)("div",{style:r.resultCountWrapper,children:[d?void 0:(0,Ze.jsxs)("div",{children:[a,this.renderSpinner(this.props.showSpinner)]}),(0,Ze.jsx)("div",{style:r.navigationHints,children:(0,Ze.jsx)(os,{})})]});return(0,Ze.jsx)(ss,{title:c,right:(0,Ze.jsxs)(Ze.Fragment,{children:[false,this.renderSearchDebugButtons()]})})}renderSpinner(e){const t=this.styles;return(0,Ze.jsx)(At.Z,{show:e,showDelay:500,showHold:200,render:e=>e&&(0,Ze.jsx)(Bt.Z,{style:t.spinner})})}renderSearchDebugButtons(){var e;if(!k.ZP.state.debug&&!k.ZP.state.showDebugInfo)return;const{rawRequests:t,rawResponses:s}=(null===(e=this.props.searchResultStore.state.serverResults)||void 0===e||null===(e=e.debugInfo)||void 0===e?void 0:e.response)||{};return(0,Ze.jsxs)(Ze.Fragment,{children:[t&&(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)(bs.Z,{open:this.stores.requestModalOpen.state,innerStyle:this.styles.debugModalStyle,onDismiss:()=>{this.stores.requestModalOpen.setState(!1)},render:()=>(0,Ze.jsx)(vs.LazyAdminReactJson,{showCopyButton:"large",defaultCollapsed:!1,data:t})}),(0,Ze.jsx)(Xt.Z,{style:this.styles.footerDebugButton,onClick:()=>this.stores.requestModalOpen.setState(!0),children:"Open Request"})]}),s&&(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)(bs.Z,{open:this.stores.responseModalOpen.state,innerStyle:this.styles.debugModalStyle,onDismiss:()=>{this.stores.responseModalOpen.setState(!1)},render:()=>(0,Ze.jsx)(vs.LazyAdminReactJson,{showCopyButton:"large",data:{rawResponses:s},defaultCollapsed:!1})}),(0,Ze.jsx)(Xt.Z,{style:this.styles.footerDebugButton,onClick:()=>this.stores.responseModalOpen.setState(!0),children:"Open Response"})]})]})}getThemeColors(){return{footerText:{color:this.theme.lightTextColor},resultCount:{color:this.theme.mediumTextColor},keyboardShortcut:{color:this.theme.mediumTextColor}}}}jr.displayName="SearchResultsFooter";const Ir=(0,ce.injectIntl)(jr);var Pr=s(73935),Tr=s(36896),wr=s(44604),kr=s(39634),Fr=s(36507);class Rr extends i.Z{constructor(){super(...arguments),this.handleSendMessageClick=()=>{kr.j({environment:this.environment,from:"quick_find"})},this.styles={menuItem:{marginTop:"auto",marginBottom:"auto"},caption:{marginTop:"auto"},reportProblemButton:{display:"inline"},searchDeletedButton:{display:"inline",lineHeight:"25px"}}}renderComponent(){return(0,Ze.jsx)(Fr.Z,{...this.getErrorMessage(),style:this.styles.menuItem,captionStyle:this.styles.caption,shouldWrapCaption:!0})}renderNoResults(){return{title:Rr.noResultsTitle,caption:this.renderNoResultsMessage()}}renderNoResultsMessage(){const e=A.ZP.state.query.filters,t=M.FN(e);if(!M.VD.isDeletedOnly(e.isDeletedOnly)){const e=this.styles,t=this.getThemeColors(),s={...e.searchDeletedButton,...t.searchDeletedButton};return(0,Ze.jsx)(ce.FormattedMessage,{id:"searchErrorMenuItem.errorPrompt.searchDeleted",defaultMessage:"Some results may be in your deleted pages.{br}<searchdeleted>Search deleted pages</searchdeleted>",values:{searchdeleted:e=>(0,Ze.jsx)(Cr.Z,{onClick:this.props.handleSearchDeletedOnly,style:s,children:e}),br:(0,Ze.jsx)("br",{})}})}return t?(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Try different search terms or filters",id:"searchErrorMenuItem.errorPrompt.searchTermsAndFilters"}):(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Try different search terms",id:"searchErrorMenuItem.errorPrompt.searchTerms"})}renderOffline(){return{title:Rr.noResultsTitle,caption:(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Go online for more results.",id:"searchErrorMenuItem.errorPrompt.goOnline"})}}renderRequestFailed(){const e=this.styles,t=this.getThemeColors(),s={...e.reportProblemButton,...t.reportProblemButton};return{title:(0,Ze.jsx)(ce.FormattedMessage,{id:"searchErrorMenuItem.error.genericErrorMessage",defaultMessage:"Something went wrong"}),caption:(0,Ze.jsx)(ce.FormattedMessage,{id:"searchErrorMenuItem.errorPrompt.refreshOrReport",defaultMessage:"Try refreshing or <reportlink>report a problem</reportlink>.",values:{reportlink:e=>(0,Ze.jsx)(Cr.Z,{onClick:this.handleSendMessageClick,style:s,children:e})}})}}getErrorMessage(){const{error:e}=this.props;switch(e.type){case Ne.Ix.NoResults.type:return this.renderNoResults();case Ne.Ix.Offline.type:return this.renderOffline();case Ne.Ix.RequestFailed.type:return this.renderRequestFailed();default:(0,u.t1)(e)}}getThemeColors(){return{reportProblemButton:{color:this.theme.blueColor},searchDeletedButton:{color:this.theme.blueColor}}}}Rr.displayName="SearchErrorMenuItem",Rr.contextTypes={...W.mw,...i.w},Rr.noResultsTitle=(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"No results",id:"searchErrorMenuItem.error.noResults"});const Zr=Rr;function Br(e,t){if(!e.isLoading)return e.showMajorError?(0,Ze.jsx)(Zr,{error:e.serverError,handleSearchDeletedOnly:()=>{const e=A.ZP.state.query.text;v.IB(),Tr.Z.setState({...Tr.Z.state,open:!0}),wr.Z.setState({...wr.Z.state,currentTab:"all_pages",filter:e,limit:wr.Z.startLimit})}}):e.serverError&&e.serverError!==Ne.Ix.NoResults?function(e,t){return(0,Ze.jsx)(fe.Z,{disableMobilePadding:!0,disableMobileBorders:!0,children:(0,Ze.jsx)(Mr.Z,{title:e,style:t})})}(e.serverError.message,t):void 0}function Ar(e,t){return(0,Ze.jsx)(fe.Z,{disableMobilePadding:!0,disableMobileBorders:!0,topBorder:!1,style:{marginTop:0,paddingTop:0},children:(0,Ze.jsx)(bt.Z,{body:e,bodyStyle:t})})}const Lr=(0,ce.injectIntl)((function(e){var t,s,i,n,o,l;window.__c={n:"SearchResultsMenuList"};const[a,c]=(0,r.useState)(!1),h=(0,D.Fy)().isMobile,p=(0,N.yK)((e=>({results:{flex:1,display:"flex",flexDirection:"column",overflow:"auto",height:"100%"},messageMenuItem:{...h&&{background:void 0,boxShadow:void 0}},debugMessageMenuItemTextStyle:{whiteSpace:"pre-wrap",fontFamily:"monospace",marginTop:0},actionMenuItemTitle:{fontWeight:de.Z.fontWeight.medium,lineHeight:"20px",fontSize:15,color:e.mediumTextColor,textOverflow:"ellipsis",overflow:"hidden",display:"block"},menuListContainer:{display:"flex",flexDirection:"column",gap:12,marginTop:h?13:void 0,marginBottom:4}})),[h]),{searchResultStore:m,localResults:g,serverResults:v,resultListStore:f,searchExperimentOverrides:y,intl:x,showActions:S}=e,b=e.errorState,C=(0,E.VK)((()=>A.ZP.state.query.text),[]),j=S.length>0?{key:"actions",render:e=>(0,Ze.jsx)(fe.Z,{...e,shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.searchActions.actions.text",defaultMessage:"Actions"})}),items:d.oA(S.map((e=>function(e){const{type:t,title:s,icon:r,action:i}=e;return{key:`actionMenuItem.${t}`,action:i,render:e=>(0,Ze.jsx)(Yt,{...e,title:s,icon:r})}}({...e,title:e.renderTitle(C,x,p.actionMenuItemTitle)}))))}:void 0,I=(0,E.VK)((()=>F.default.state.intentBasedSearch.enablesGrouping),[]),P=(0,M.IV)({intentBasedGrouping:I,localResults:g,serverResults:v}),{allSearchResults:T}=P,w=(0,r.useCallback)((t=>{const{results:s,sectionTitle:i,compact:n,rendersTimeSinceLastViewedMs:o}=t,{id:l,title:a}=function(e){if(!e)return{id:"allSearchResults",title:void 0};switch(e.type){case"unique-id":return{id:"uniqueIdSearchResults",title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.searchResultBuckets.uniqueID.text",defaultMessage:"ID matches"})};case"jump-back-in":return{id:"jumpBackInSearchResults",title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.searchResultBuckets.topResults.text",defaultMessage:"Top results"})};case"server":return{id:"serverOnlySearchResults",title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.searchResultBuckets.server.text",defaultMessage:"{count}{maybeLowerBoundSign} results",values:{count:e.values.count,maybeLowerBoundSign:e.values.isLowerBound?"+":""}})};case"main":return{id:"mainSearchResults",title:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.searchResultBuckets.bestMatches.text",defaultMessage:"Best Matches"})}}(0,u.t1)(e)}(i);return s.length>0?{key:l,render:e=>(0,Ze.jsx)(fe.Z,{...e,shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:a}),items:d.oA(s.map(((t,s)=>{var i,a;return function(e){var t;const{selectedResult:s,index:i,globalIndexOffset:n,sectionName:o,allSearchResults:l,props:a,compact:d,timeSinceLastViewedMs:c}=e,{store:u}=s,h=u.isNavigableBlock()?u:u.getNavigableBlockStore();if(!h)return;const p=r.createRef(),m=Boolean(k.ZP.getDebugLevel()),g=m&&s.sources.includes(Ne.vp.Local)?{score:s.score,frecencyScore:s.frecencyScore,localSource:s.localSource,personalizationBoost:s.personalizationBoost,id:s.id}:void 0,v=m&&(s.sources.includes(Ne.vp.ElasticSearch)||s.sources.includes(Ne.vp.VectorDBBlock)||s.sources.includes(Ne.vp.VectorDBCollection))?null===(t=a.debugInfo)||void 0===t||null===(t=t.response)||void 0===t?void 0:t.resultsDebugMap[u.id]:void 0,f=a.clusterInfo,y=Date.now();return{key:`${u.id}:${i}`,action:e=>{const{event:t}=e;function r(e){const s=Pr.findDOMNode(e.current);return Boolean(s&&"target"in t&&t.target&&(s===t.target||s.contains(t.target)))}p.current&&r(p)||a.handleSelectResult({action:{...e,index:e.index+(n??0)},selectedResult:s,sectionName:o,allSearchResults:l})},render:e=>{var t;return(0,Ze.jsx)(Ds,{...e,index:i,originalPosition:s.originalPosition,isFirstInSection:0===i,store:h,hidePath:!1,result:s,className:_.ulv,debugLocal:g,debugHits:v,debugAreaRef:p,clusterInfo:f,inline:d&&!m,inlineCaptionMinWidthPercentage:20,lastViewed:c?y-c:void 0,queryId:null===(t=s.serverEventProperties)||void 0===t?void 0:t["server-queryId"],type:"query_results"})}}}({selectedResult:t,index:s,globalIndexOffset:-((null==j||null===(i=j.items)||void 0===i?void 0:i.length)??0),sectionName:l,allSearchResults:T,props:e,compact:n,timeSinceLastViewedMs:o&&null!==(a=t.localSource)&&void 0!==a&&a.has("recentVisit")?t.timeSinceLastViewedMs:void 0})})))}:void 0}),[null==j||null===(t=j.items)||void 0===t?void 0:t.length,T,e]),R=(0,E.VK)((()=>w({results:"intent-based-grouping"===P.type?P.sections.jumpBackInSearchResults:[],sectionTitle:{type:"jump-back-in"},compact:!0,rendersTimeSinceLastViewedMs:!0})),[w,P.sections,P.type]),Z=(0,E.VK)((()=>{const e="intent-based-grouping"===P.type?P.sections.serverOnlySearchResults:[],{count:t,isLowerBound:s}=m.getResultCount();return w({results:e,sectionTitle:{type:"server",values:{count:t,isLowerBound:s}},compact:!1})}),[w,P.sections,P.type,m]),B=(0,E.VK)((()=>w({results:"uniqueIdSearchResults"in P.sections?P.sections.uniqueIdSearchResults:[],sectionTitle:{type:"unique-id"},compact:!1})),[w,P.sections]),L=(0,E.VK)((()=>w({results:"unique-id"===P.type?P.sections.nonUniqueIdSearchResults:"all"===P.type?P.sections.allSearchResults:[],sectionTitle:"unique-id"===P.type||((null==j?void 0:j.items)??[]).length>0?{type:"main"}:void 0,compact:!1})),[null==j?void 0:j.items,w,P.sections,P.type]),O=[j,R,B,Z,L].filter(u.$K),V=null===(s=e.debugInfo)||void 0===s||null===(s=s.response)||void 0===s?void 0:s.parsedQueries,q=null===(i=e.debugInfo)||void 0===i||null===(i=i.response)||void 0===i?void 0:i.detectedLanguages,W=null===(n=e.debugInfo)||void 0===n?void 0:n.traceLogs,z=null===(o=e.debugInfo)||void 0===o||null===(o=o.response)||void 0===o?void 0:o.debugUrls,H=(0,r.useCallback)(((t,s)=>{const{onMaybeLoadMoreResults:r}=e,i=t<=200;i&&!a&&r(),c(i),s.offsetFromTop&&A.ZP.update((e=>({...e,hasScrolled:!0})))}),[a,e]),U=L||Z?(null==j||null===(l=j.items)||void 0===l?void 0:l.length)??0:0;return(0,Ze.jsx)(ai.Consumer,{children:e=>{let{queryResultsSectionRef:t}=e;return(0,Ze.jsxs)("section",{style:p.results,ref:t,children:[!d.xb(y)&&Ar((0,Ze.jsx)(Ze.Fragment,{children:(0,Ze.jsx)(vs.LazyAdminReactJson,{data:{searchExperimentOverrides:y},showCopyButton:!1,showModalButton:!1,defaultCollapsed:!1})}),p.debugMessageMenuItemTextStyle),V&&Ar((0,Ze.jsx)(vs.LazyAdminReactJson,{data:{parsedQueries:V},customCollapsedRenderers:[Nr],showCopyButton:"small",showModalButton:!0,defaultCollapsed:!0}),p.debugMessageMenuItemTextStyle),q&&Ar((0,Ze.jsx)(vs.LazyAdminReactJson,{data:{detectedLanguages:q},customCollapsedRenderers:[Er]}),p.debugMessageMenuItemTextStyle),W&&Ar((0,Ze.jsx)(vs.LazyAdminReactJson,{data:{tracer:{traceLogs:W}},customCollapsedRenderers:[Dr],defaultCollapsed:!0}),p.debugMessageMenuItemTextStyle),z&&Ar((0,Ze.jsx)(vs.LazyAdminReactJson,{data:{debugUrls:z},defaultCollapsed:!0,customCollapsedRenderers:[qr],showCopyButton:"small",showModalButton:!0,maxLinkValueLength:40}),p.debugMessageMenuItemTextStyle),O&&(0,Ze.jsx)("div",{className:"search-results-list",children:(0,Ze.jsx)(Xe.Z,{type:Xe.i.Vertical,initialFocus:U,store:f,disableKeyboardArrowWrap:!0,sections:O,style:p.menuListContainer})}),Br(b,p.messageMenuItem)||(0,Ze.jsx)(Wt.Z,{onChange:H})]})}})}));function Or(e){const t=e.replaceAll(/\(MatchNoDocsQuery\("Matching no documents because no terms present"\)\)\^[0-9\.]/g,"").replaceAll(/MatchNoDocsQuery\("Matching no documents because no terms present"\)/g,"").replaceAll(/ConstantScore\(([^)]+):([^)]+)\)/g,"<i>$1</i>:<b>$2</b>").replace(/function score \(\((.*)\), functions:.*\)/,"$1").replaceAll("( ","(").replaceAll(" )",")").replaceAll("|","| <br/>").replaceAll(/([^( ]+):"([^"]+)"/g,'<i>$1</i>:<b>"$2"</b>').replaceAll(/([^( ]+):([^) ]+)/g,"<i>$1</i>:<b>$2</b>");return(0,Ze.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})}const Dr=e=>{let{data:t,keyPath:s}=e;if("traceLogs"===(null==s?void 0:s[0])&&d.PO(t)&&Array.isArray(t.log)&&t.log.length>0){const{log:e,startTimeMs:s}=t;return{element:(0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)("div",{children:(0,Ze.jsx)("b",{children:`Trace started at ${s}`})}),e.map(((e,t)=>(0,Ze.jsxs)("div",{children:[(0,Ze.jsx)("span",{style:Vr,children:`[${e.timestamp-s}ms][${e.callerFileName.split(".")[0]}]`}),(0,Ze.jsx)("span",{children:`${e.msg}`})]},t)))]}),expanded:!1}}return null},Er=e=>{let{data:t,keyPath:s}=e;return"detectedLanguages"===s.join(".")&&d.PO(t)?{element:(0,Ze.jsx)(Ze.Fragment,{children:Object.entries(t).filter((e=>{let[t,s]=e;return Boolean(s)})).map((e=>{let[t]=e;return t})).join(", ")||"None"}),expanded:!1}:null},Nr=e=>{var t,s;let{data:r,keyPath:i}=e;const n=r,o=Object.values(n).find((e=>void 0!==e));if(!o)return null;if(!["type","description","time_in_nanos"].every((e=>o[e])))return null;if(1===i.length)return{element:Or(o.description),expanded:!1};let l=o.description??"";return null!==(t=l)&&void 0!==t&&t.includes("permissions.teamIds")&&(l="PermissionsQuery"),null!==(s=l)&&void 0!==s&&s.includes("(_id:[")&&(l="BoostRecentPageIds"),{element:Or(l),expanded:!1}},Vr={color:"blue"},qr=e=>{let{data:t}=e;const s=t;if(!s)return null;const r=Object.values(s).find((e=>{let{clusterName:t}=e;return void 0!==t}));if(r){const{clusterName:e}=r;return{element:(0,Ze.jsx)(Ze.Fragment,{children:e}),expanded:!1}}return{element:(0,Ze.jsx)(Ze.Fragment,{children:"unknown"}),expanded:!1}};const _r=function(e){window.__c={n:"SearchResultsBody"};const{searchResultStore:t,sxsMode:s,searchDebugColumnStore:i}=e,n=(0,D.O7)(),o=(0,D.Fy)(),l=(0,N.yK)((e=>({container:{display:"flex",flexDirection:"column",width:s?"50%":"100%",flex:1,overflow:"hidden"},askAiLabel:{color:e.regularTextColor,fontWeight:de.Z.fontWeight.medium,fontSize:14},askAiQuery:{fontWeight:de.Z.fontWeight.regular},askAiIcon:{fill:e.aiPurpleColor}})),[s]),a=(0,E.qz)(void 0,Vt.Z),d=(0,E.VK)((()=>a.state.focus.indexGlobal),[a]),{handleSelectResult:c,globalFocusedIndex:u}=(0,r.useContext)(ai),{localResults:h,serverResults:p,clusterInfo:m,debugInfo:g,serverResultsLoading:f,searchExperimentOverrides:y,hasPublicAccessPermission:x,errorState:S,serverResultsAllLoaded:b}=(0,E.VK)((()=>{var e,s;const{hasPublicAccessPermission:r}=M.bC(n);return{localResults:t.state.localResults,serverResults:t.state.serverResults,serverResultsLoading:t.state.serverResultsLoading,clusterInfo:null===(e=t.state.serverResults)||void 0===e?void 0:e.clusterInfo,debugInfo:null===(s=t.state.serverResults)||void 0===s?void 0:s.debugInfo,searchExperimentOverrides:i.state.searchExperimentOverrides,hasPublicAccessPermission:r,errorState:t.state.errorState,serverResultsAllLoaded:t.state.serverResultsAllLoaded}}),[t,i,n]),C=!1===S.isLoading&&S.showMajorError,j=Boolean(h||p),I=(0,r.useCallback)((()=>{!f&&!b&&void 0!==p&&A.ZP.update((e=>({...e,limit:e.limit+A.Xv,isScrolled:!0,source:"quick_find_scroll"})))}),[f,b,p]),P=(0,E.VK)((()=>M.oO({localResults:null==h?void 0:h.results,serverResults:null==p?void 0:p.results})),[h,p]),T=(0,E.VK)((()=>[{type:"assistant",renderTitle:(e,t,s)=>function(e,t){return(0,Ze.jsx)("div",{className:"notranslate",style:t,children:e})}((0,Ze.jsxs)(Ze.Fragment,{children:[(0,Ze.jsx)("span",{children:(0,Ze.jsx)(ce.FormattedMessage,{id:"searchResultsBody.askAiMenuItem.title",defaultMessage:"Ask Notion AI"})}),(0,Ze.jsx)("span",{style:l.askAiQuery,children:e?` “${e}”`:""})]}),{...s,...l.askAiLabel}),icon:e=>(0,Dt.t)({...e,...l.askAiIcon}),action:()=>{Sr.resetAssistantStore({environment:n,primeTextInput:void 0,clientSkill:br.lU}).then((()=>{v.em({environment:n})}))},shouldShow:()=>Et.fG.shouldShowSearchMenuItemAskAI()}].filter((e=>e.shouldShow(n)))),[n,l],{useDeepEqual:!0});(0,E.VK)((()=>{const e=t.state.insertedActionResultsCount,s=T.length;e!==s&&t.update((e=>({...e,insertedActionResultsCount:s})))}),[T,t]);const w=(0,r.useCallback)((()=>a.update((e=>e.focus.isInitialized&&0===e.focus.section&&0===e.focus.indexLocal&&0===e.focus.indexGlobal?e:{...e,focus:T.length>0?{section:1,indexLocal:0,indexGlobal:T.length}:{section:0,indexLocal:0,indexGlobal:0}}))),[a,T]);return(0,r.useEffect)((()=>{w()}),[P,w]),(0,r.useEffect)((()=>{u.setState(d)}),[u,d]),(0,Ze.jsxs)("div",{style:l.container,children:[(0,Ze.jsx)(Lr,{errorState:S,handleSelectResult:c,onMaybeLoadMoreResults:I,resultListStore:a,searchResultStore:t,localResults:null==h?void 0:h.results,serverResults:null==p?void 0:p.results,debugInfo:g,clusterInfo:m,publicAccessPermission:x,searchExperimentOverrides:y,showActions:T}),(0,Ze.jsx)(Ir,{searchResultStore:t,showSpinner:f,shouldShow:!C&&j&&!o.isMobile})]})};function Wr(){window.__c={n:"SearchNavigationalView"};const{searchFilterMenuRef:e,handleRecentPageSelect:t,searchResultStore:s,secondarySearchResultStore:i}=(0,r.useContext)(ai),n=(0,D.Fy)(),{errorState:o,shouldShowSxSView:l,hasQuery:a}=(0,E.VK)((()=>({shouldShowSxSView:Boolean((0,k.gq)({device:n})&&k.BJ.state.visible),errorState:s.state.errorState,hasQuery:Boolean(A.ZP.state.query.text.trim())||M.VA(A.ZP.state.query.filters)})),[s,n]),d=(0,N.yK)((()=>({container:{display:"flex",flexDirection:"column",width:l?"50%":"100%"},sxsContainer:{display:"flex",flexDirection:"row",height:"100%",overflow:"hidden",maxWidth:"100%"}})),[l]),c=!1===o.isLoading&&o.showMajorError,u={searchResultStore:s,searchDebugColumnStore:k.v_,sxsMode:l},h=(0,E.VK)((()=>{var e;return null===(e=P.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]);return(0,Ze.jsxs)(Ze.Fragment,{children:[!n.isMobile&&(0,Ze.jsx)(xr,{isMobile:n.isMobile}),a?(0,Ze.jsxs)(Ze.Fragment,{children:[!c&&n.isMobile&&(0,Ze.jsx)(St,{isMobile:!0,mode:vt.Section,ref:e}),(0,Ze.jsxs)("div",{style:d.sxsContainer,children:[(0,Ze.jsx)(_r,{...u}),l&&(0,Ze.jsx)(_r,{...u,searchResultStore:i,searchDebugColumnStore:k.BJ})]})]}):h?(0,Ze.jsx)(Hs,{onSelect:t,spaceId:h}):null]})}var zr=s(97439),Hr=s(27714),Ur=s(26825),Kr=s(37034),$r=s(10912),Gr=s(84076);function Qr(e){window.__c={n:"SearchSidePeekPanelMetadataItem"};const{itemName:t,itemValue:s,isFirstInList:r}=e,i=(0,N.yK)((e=>({itemName:{fontSize:14,color:e.mediumTextColor},itemValue:{fontSize:14,maxWidth:"60%"},itemContainer:{height:36,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderTop:r?void 0:`1px solid ${e.regularDividerColor}`}})),[r]);return(0,Ze.jsxs)("div",{style:i.itemContainer,children:[(0,Ze.jsx)("div",{style:i.itemName,children:t}),(0,Ze.jsx)("div",{style:i.itemValue,children:s})]})}const Yr={createdBy:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.preview.metadata.createdBy",defaultMessage:"Created by"}),created:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.preview.metadata.created",defaultMessage:"Created"}),lastEditedBy:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.preview.metadata.lastEditedBy",defaultMessage:"Last edited by"}),lastEdited:(0,Ze.jsx)(ce.FormattedMessage,{id:"search.preview.metadata.lastEdited",defaultMessage:"Last edited"})},Jr={type:"page_content"};function Xr(e){window.__c={n:"SearchSidePeekPanel"};const{selectedResult:t}=e,s=(0,N.yK)((e=>({sidePeekPanel:{flex:"0 0 300px",overflowY:"auto",overflowX:"hidden",minHeight:400,borderLeft:`1px solid ${e.regularDividerColor}`,display:"flex",flexDirection:"column",justifyContent:"space-between",zIndex:1},sidePeekPanelHidden:{display:"none"},emoji:{width:20},sidePeekContentContainer:{margin:16,width:268},sidePeekActionContainer:{display:"flex",flexDirection:"column"},titleContainer:{marginTop:20,display:"flex",height:73,flexDirection:"column",justifyContent:"space-between"},title:{fontSize:22,fontWeight:de.Z.fontWeight.bold,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},previewContainer:{marginTop:15,marginBottom:16,display:"flex",flexDirection:"column",position:"relative"},hoveredOrPressedPreview:{background:"unset",boxShadow:"unset"},preview:{borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"16px 16px",background:"unset",boxShadow:"unset"},previewGradientOverlay:{background:`linear-gradient(to top, ${e.contentBackground} 0px, ${e.contentBackgroundTransparent} 20px)`},metadataContainer:{marginTop:15,display:"flex",flexDirection:"column"},action:{margin:16,border:`1px solid ${e.regularDividerColor}`,borderRadius:4,background:"unset"},metadataActorWrapper:{display:"flex",alignItems:"center"},metadataActorName:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},metadataActorAvatar:{marginRight:5},doubleChevronIcon:{color:e.accentColors.gray[400],cursor:"pointer",width:"max-content"}})),[]),i=(0,E.VK)((()=>({...s.sidePeekPanel,...!A.ZP.isSidePeekPanelOpen()&&s.sidePeekPanelHidden})),[s.sidePeekPanel,s.sidePeekPanelHidden]),n=(0,D.O7)(),o=(0,ce.useIntl)(),a=(0,E.VK)((()=>(0,Kr.V)(t,o,n)),[o,n,t]),d=(0,E.VK)((()=>P.default.state.currentSpaceStore?(0,Ft.jv)(P.default.state.currentSpaceStore):[]),[]),c=(0,r.useCallback)(((e,t,r)=>{if(void 0===e||void 0===t)return;const i=(0,ks.Hl)({pointer:{id:e,spaceId:r.id,table:t},getRecordModel:r.getRecordModel}).asActor;return void 0!==i&&(0,Ur.GU)({spacePermissions:d,userId:i.id})?(0,Ze.jsxs)("span",{style:s.metadataActorWrapper,children:[(0,Bs.a)({actor:i,size:18,style:s.metadataActorAvatar}),(0,Ze.jsx)("div",{style:s.metadataActorName,children:(0,ks.$4)(o,i)})]}):void 0}),[o,d,s.metadataActorWrapper,s.metadataActorName,s.metadataActorAvatar]),u=(0,r.useCallback)((e=>(0,gs.IS)(e,{useCompactFormat:!0,useLowercase:!0})),[]),{createdBy:h,created:p,lastEditedBy:m,lastEdited:g}=(0,E.VK)((()=>{const e=P.default.state.currentSpaceStore;return void 0===e?{createdBy:void 0,created:void 0,lastEditedBy:void 0,lastEdited:void 0}:{createdBy:c(t.getCreatedById(),t.getCreatedByTable(),e),created:u(t.getCreatedTime()),lastEditedBy:c(t.getLastEditedById(),t.getLastEditedByTable(),e),lastEdited:u(t.getLastEditedTime())}}),[u,c,t]),f=[{key:"createdBy",itemName:Yr.createdBy,itemValue:h},{key:"created",itemName:Yr.created,itemValue:p},{key:"lastEditedBy",itemName:Yr.lastEditedBy,itemValue:m},{key:"lastEdited",itemName:Yr.lastEdited,itemValue:g}],{previewIcon:y,isEmptyPage:x}=(0,E.VK)((()=>({previewIcon:t.getIcon(),isEmptyPage:t.isEmptyPage()})),[t]),S=(0,E.VK)((()=>(0,ps.ZP)({store:t,collectionViewId:t.id,fullyQualified:!0,pageVisitSource:l.tY.SearchQuery})),[t]),b=(0,r.useCallback)((()=>{cs.RD({environment:n,stringValue:S,copiedMessage:cs.tq.copiedLinkToClipboard})}),[n,S]);return(0,Ze.jsxs)("aside",{style:i,children:[(0,Ze.jsxs)("div",{style:s.sidePeekContentContainer,children:[(0,Ze.jsx)("div",{onClick:()=>v.bn(n.currentUser.id),style:s.doubleChevronIcon,children:(0,zr.D)({width:15,height:15})}),(0,Ze.jsxs)("div",{style:s.titleContainer,children:[(0,Ze.jsx)(Pe.Z,{disabled:!0,icon:y,isEmptyPage:x,size:36,largeIcon:!0}),(0,Ze.jsx)("div",{style:s.title,children:a})]}),(0,Ze.jsx)(Gr.Z,{style:s.previewContainer,href:S,hoveredStyle:s.hoveredOrPressedPreview,pressedStyle:s.hoveredOrPressedPreview,children:(0,Ze.jsx)($r.Z,{variant:"default",contentWrapStyle:s.preview,store:t,coverFormat:Jr,coverSizeFormat:"large",showEmptyGalleryCover:!1,coverContentFadedOverlay:!0,coverContentFadedOverlayStyle:s.previewGradientOverlay,onLoadProxiedImage:()=>{},renderAdditionalBlocks:!0})}),(0,Ze.jsx)("div",{style:s.metadataContainer,children:f.filter((e=>void 0!==e.itemValue)).map(((e,t)=>(0,Ze.jsx)(Qr,{isFirstInList:0===t,itemName:e.itemName,itemValue:e.itemValue},e.key)))})]}),(0,Ze.jsx)("div",{style:s.sidePeekActionContainer,children:(0,Ze.jsx)(Xt.Z,{icon:Hr.N,style:s.action,onClick:b,children:(0,Ze.jsx)(ce.FormattedMessage,{defaultMessage:"Copy link",id:"search.preview.actions.copyLink"})})})]})}const ei="80vh";function ti(e){window.__c={n:"SearchContentPane"};const t=(0,D.Fy)(),s=(0,D.O7)();return(0,r.useEffect)((()=>{(async e=>{const{hasPublicAccessPermission:t}=M.bC(e),s=P.default.state.currentSpaceStore,r=P.default.state.currentSpaceViewStore;if(t)return;if(!s)return;const i=await M.hb({environment:e,currentSpaceStore:s,currentSpaceViewStore:r,excludeCurrentPage:!0});q.Z.update((e=>({...e,localSearchableBlocksCache:i})))})(s)}),[s]),(0,z.Z)(),(0,Ze.jsx)(Q.Z,{capture:!0,ignoreBlockSelection:!0,focusOffscreenInput:!1,restoreSelection:!t.isMobile,render:()=>(0,Ze.jsx)(G.Z,{capture:!0,allowMenuList:!0,render:t=>(0,Ze.jsx)(si,{...e,ignoreAreaEvents:t})})})}function si(e){window.__c={n:"SearchContentPaneInner"};const{ignoreAreaEvents:t,renderAsPage:s,onClose:i}=e,{handleQueryChange:n,searchFilterMenuRef:o,modalBodyMenuRef:l,searchResultStore:a,globalFocusedIndex:c,defaultBodyFocusedResult:u}=(0,r.useContext)(ai),h=(0,N.yK)((e=>({body:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",zIndex:2,backgroundColor:e.popoverBackground},topbar:{height:void 0,marginTop:10,marginLeft:16,marginBottom:10,marginRight:16},topbarRightButtonWrapper:{flex:void 0,paddingLeft:16},topbarButton:{fontWeight:void 0,padding:0,color:e.mediumTextColor},scroller:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",maxHeight:s?"100vh":ei}})),[s]),[p,m]=(0,r.useState)(!1),[g,v]=(0,r.useState)(!1),f=(0,D.O7)(),y=(0,D.Fy)(),{isSearchMenuOpen:x,shouldShowSidePeekPanel:S,shouldShowDebugSidebar:b,hasPublicAccessPermission:C,hasQuery:j,shouldShowSpinner:I}=(0,E.VK)((()=>{const e=Boolean(U.Z.state.online),{hasPublicAccessPermission:t}=M.bC(f);return{isSearchMenuOpen:F.default.state.open,shouldShowSpinner:e&&Boolean(A.ZP.state.query.text)&&a.state.serverResultsLoading&&!p,shouldShowSidePeekPanel:oi(y),shouldShowDebugSidebar:li({device:y,isPublicAccessPermissionForPage:t}),hasPublicAccessPermission:t,hasQuery:Boolean(A.ZP.state.query.text.trim())||M.VA(A.ZP.state.query.filters)}}),[p,a,y,f]),P=(0,r.useMemo)((()=>d.Ds((()=>{const{activeElement:e}=document;e instanceof HTMLInputElement&&e.blur()}),500,{leading:!0})),[]),T=(0,r.useCallback)((()=>{g&&P()}),[P,g]),w=(0,r.useCallback)((e=>{v(e),e||y.isMobileNative&&K.Z.updateKeyboardPhase(f,K.i.willHide,0)}),[y.isMobileNative,f]),k=(0,E.VK)((()=>M.pG(a,c)),[a,c]),R=(0,E.VK)((()=>u.state),[u]),Z=(0,r.useMemo)((()=>(0,Ze.jsx)(Ot,{isOpen:Boolean(s||x),onTypingChange:m,onFocusChange:w,showSpinner:I,onQueryChange:n,selectedResult:k})),[s,x,w,I,n,k]),B=(0,r.useMemo)((()=>{if(y.isMobile){return{menuType:W.og.Modal,left:Z,shouldRenderLeftDirectly:!0,width:s?"100vw":void 0,...ii({isPhone:y.isPhone,renderAsPage:s,style:h.topbarRightButtonWrapper,onClick:i}),header:j&&(0,Ze.jsx)(wt,{isPublicPageSearch:C}),disableHeaderShadow:!0,topbarStyle:h.topbar,leftRightButtonStyle:h.topbarButton,onScroll:ni(y)?T:void 0,bodyScrollerClassName:_.GZn,...t}}const e={menuType:W.og.Popup,maxHeight:s?"100vh":ei,minHeight:50,disableScroller:!0,scrollerStyle:h.scroller,...t};return s&&y.isDesktop&&(e.maxWidth="100%"),e}),[y,h,t,Z,s,i,j,C,T]),L=R||k;return(0,Ze.jsx)(Y.Z,{...B,className:_.Oau,ref:l,children:(0,Ze.jsxs)(ri,{enableLazyLoading:s,children:[(0,Ze.jsxs)("div",{style:h.body,children:[(0,Ze.jsx)(ee.Z,{}),!y.isMobile&&Z,(0,Ze.jsx)(Wr,{})]}),S&&void 0!==L&&(0,Ze.jsx)($.Z,{isVisible:!0,enterAnimationStyle:{translateXPercent:-20},animationStyle:{translateXPercent:0},exitAnimationStyle:{translateXPercent:100},render:()=>(0,Ze.jsx)(Xr,{selectedResult:L})}),b&&(0,Ze.jsx)(St,{ref:o})]})})}function ri(e){window.__c={n:"SearchMenuContentsWrapper"};const{enableLazyLoading:t,children:s}=e,i=(0,D.O7)();return t?(0,Ze.jsx)(X.Z,{fetch:async()=>{var e;await V.Vs(0),await P.default.waitUntil((()=>void 0!==P.default.state.currentSpaceStore)),null===(e=i.mobileNative)||void 0===e||e.markTransitionReady({type:"search"})},loading:()=>(0,Ze.jsx)(r.Fragment,{}),render:()=>s}):(0,Ze.jsx)(r.Fragment,{children:s})}function ii(e){let{isPhone:t,style:s,renderAsPage:r,onClick:i}=e;return t&&(0,H.Y)("supportsNativeHome")||r?{rightOuterStyle:{display:"none"}}:{right:(0,Ze.jsx)(J.CancelMenuText,{}),onClickRight:i,rightOuterStyle:s}}function ni(e){return!!e.isMobile&&(!e.isIOS||e.isMobileNative)}function oi(e){if(!e.isMobile&&!(0,k.gq)({device:e}))return A.ZP.isSidePeekPanelOpen()}function li(e){let{device:t,isPublicAccessPermissionForPage:s}=e;if(!s&&!t.isMobile)return A.ZP.isDebugSidebarOpen()}const ai=r.createContext(null),di=r.createContext(null);class ci extends i.Z{constructor(){super(...arguments),this.inactiveTimer=void 0,this.spaceId=void 0,this.isOpen=!1,this.shouldClearServerResultsOnQueryChange=!1,this.queryResultsSectionRef=r.createRef(),this.searchFilterMenuRef=r.createRef(),this.modalBodyMenuRef=r.createRef(),this.searchResultStore=new R.ZP,this.secondarySearchResultStore=new R.ZP,this.globalFocusedIndex=o.default.createValue(0),this.defaultBodyFocusedResult=o.default.createValue(void 0),this.getStaticContext=d.HP((()=>({queryResultsSectionRef:this.queryResultsSectionRef,searchFilterMenuRef:this.searchFilterMenuRef,modalBodyMenuRef:this.modalBodyMenuRef,handleSelectResult:this.handleQueryResultSelect,handleRecentPageSelect:this.handleRecentPageSelect,handleQueryChange:this.handleQueryChange,searchResultStore:this.searchResultStore,secondarySearchResultStore:this.secondarySearchResultStore,globalFocusedIndex:this.globalFocusedIndex,defaultBodyFocusedResult:this.defaultBodyFocusedResult}))),this.getStoresContext=d.HP((e=>({parentStore:e}))),this.renderContent=()=>{const e=this.currentMode.state;return(0,Ze.jsx)(ai.Provider,{value:this.getStaticContext(),children:(0,Ze.jsx)(di.Provider,{value:this.getStoresContext(this.props.parentStore),children:"search"===e?(0,Ze.jsx)(ti,{renderAsPage:this.props.renderAsPage,onClose:this.handleComponentClose}):(0,Ze.jsx)(f.yX,{renderAsPage:this.props.renderAsPage,onClose:this.handleComponentClose})})})},this.handleRecentPageSelect=e=>{this.handleSelectResult({...e,context:"recent_pages"})},this.handleQueryResultSelect=e=>{this.handleSelectResult({...e,context:"query_results"})},this.handleComponentOpenClose=()=>{this.isOpen!==F.default.state.open&&(this.isOpen=F.default.state.open,F.default.state.open&&(clearTimeout(this.inactiveTimer),A.ZP.update((e=>({...e,hasScrolled:!1})))))},this.handleComponentClose=()=>{const{device:e}=this.environment,{selectedQueryResult:t,numKeystrokes:s,numServerRequests:r,numLocalRequests:i,hadMetaClick:n}=Z.default.state,{serverEventProperties:o}=this.searchResultStore.state,{query:l,hasScrolled:d}=A.ZP.state;if(s>0&&(r>0||i>0)&&!t&&!n&&(F.default.state.openAsPage||F.default.state.open)){const t=Date.now(),i=F.default.state.openedTimeMs,n=F.default.state.sessionId,l=Z.default.state.firstKeyStrokeTimeMs;m.EH8(this.environment,{...o,timeToAbandonMs:t-i,timeFromFirstKeyStrokeToAbandonMs:l?t-l:void 0,numKeystrokes:s,numResultsAboveFold:this.getNumResultsAboveFold(),searchSessionId:n,searchSessionFlowNumber:r,hasScrolled:d,numLocalResults:this.getNumLocalResults(),numTotalLocalResults:this.getNumTotalLocalResults(),numVisibleMembers:(0,L.qX)(),isMobile:e.isMobile})}v.IB(),""===l.text.trim()&&A.ZP.reset();const c=w.default.getEligibleGroup({experimentId:"search-shorten-inactive-timer",defaultGroup:"control"});let u=120*p.C0;"control"!==c&&a.g6["search-shorten-inactive-timer"].includes(c)&&(u=parseInt(c,10)*p.C0),this.inactiveTimer&&clearTimeout(this.inactiveTimer),u>0?this.inactiveTimer=window.setTimeout(this.resetState,u):this.resetState(),!this.props.renderAsPage&&e.isMobile&&I.close(),Z.default.reset()},this.handlePotentialWebSearchAbandon=e=>{this.props.renderAsPage&&this.handleComponentClose()},this.handleSelectResult=e=>{var t,s;let{action:r,sectionName:i,context:n,selectedResult:o,allSearchResults:a}=e;const{serverEventProperties:d,store:c}=o,{numKeystrokes:h,hadMetaClick:p}=Z.default.state;if(!F.default.state.open&&!F.default.state.openAsPage)return;const{event:v}=r,f=x.DJ(v);"query_results"===n&&(Z.default.update((e=>({...e,selectedQueryResult:!0}))),this.searchResultStore.update((e=>({...e,selectedQueryResultQuery:A.ZP.state.query}))));const y=Date.now(),{openedTimeMs:S,sessionId:b}=F.default.state,{firstKeyStrokeTimeMs:C}=Z.default.state,{numServerRequests:j}=Z.default.state,{query:I}=A.ZP.state,P=(0,L.qX)(),T=(null==a?void 0:a.filter((e=>{var t;return void 0!==(null===(t=e.matchedCollectionProperties)||void 0===t?void 0:t.collectionText)})).length)??0,w=(null==a?void 0:a.filter((e=>{var t;return void 0!==(null===(t=e.highlight)||void 0===t?void 0:t.collectionText)})).length)??0,k=void 0!==(null===(t=o.matchedCollectionProperties)||void 0===t?void 0:t.collectionText),R=void 0!==(null===(s=o.highlight)||void 0===s?void 0:s.collectionText);m.nLf(this.environment,{...d,context:n,queryStringLength:I.text.trim().length,hasFilters:M.FN(I.filters),activeFilters:I.filters,selectedItemIndex:r.index,selectedItemLocalIndex:{sectionName:i,index:r.indexLocal.indexLocal},numKeystrokes:h,isMetaClick:Boolean(f),isSidebarOpen:A.ZP.isDebugSidebarOpen(),timeToSelectMs:y-S,timeFromFirstKeyStrokeToSelectMs:C?y-C:y-S,sources:null==o?void 0:o.sources,localSources:[...(null==o?void 0:o.localSource)??[]],indexInRecentPages:null==o?void 0:o.indexInRecentPages,timeSinceLastViewedMs:null==o?void 0:o.timeSinceLastViewedMs,hadMetaClick:p,numResultsAboveFold:this.getNumResultsAboveFold(),selectedSearchResultMetadata:this.getSearchResultMetadata(o),selectedSearchResultContent:void 0,allSearchResultMetadata:null==a?void 0:a.slice(0,ci.MAX_RESULT_TO_TRACK).map((e=>this.getSearchResultMetadata(e))),totalSearchResultCount:null==a?void 0:a.length,searchSessionId:b,searchSessionFlowNumber:j,originalPosition:null==o?void 0:o.originalPosition,numLocalResults:this.getNumLocalResults(),numTotalLocalResults:this.getNumTotalLocalResults(),numVisibleMembers:P,isMobile:this.environment.device.isMobile,resultWithCollectionPropertyMatchCount:T,resultWithCollectionPropertyHighlightCount:w,isCollectionPropertyMatch:k,isCollectionPropertyHighlight:R});const O=(null==d?void 0:d["server-queryId"])??function(e){let{searchSessionId:t,searchSessionFlowNumber:s}=e;if((0,u.$K)(t)&&(0,u.$K)(s))return`1:${t}:${s}`}({searchSessionId:b,searchSessionFlowNumber:j});let D;"recent_pages"===n?D=l.tY.SearchRecents:"query_results"===n?D=l.tY.SearchQuery:(0,u.t1)(n);g.navigateToSearchResult({searchResult:o,environment:this.environment,pageVisitSource:D,queryId:O,openInNew:f,openInSidePeek:!1}),B.Z.setState({queryId:O,pageId:c.id,timeEntered:new Date}),f?Z.default.update((e=>({...e,hadMetaClick:!0}))):this.handleComponentClose()},this.handleQueryChange=e=>{this.shouldClearServerResultsOnQueryChange&&(this.searchResultStore.update((e=>({...e,serverResults:void 0}))),this.secondarySearchResultStore.update((e=>({...e,serverResults:void 0})))),""!==e?(Z.default.update((e=>({...e,numKeystrokes:e.numKeystrokes+1}))),A.ZP.updateQueryText(e)):A.ZP.resetQuery({resetFilters:!1})},this.getNumResultsAboveFold=()=>M.MQ({environment:this.environment,searchResultsSection:this.queryResultsSectionRef.current,modalBodyMenu:this.modalBodyMenuRef.current,searchFilterMenu:this.searchFilterMenuRef.current}),this.getNumLocalResults=()=>{var e;return(null===(e=this.searchResultStore.state.localResults)||void 0===e?void 0:e.results.length)??0},this.getNumTotalLocalResults=()=>{var e;return(null===(e=this.searchResultStore.state.localResults)||void 0===e?void 0:e.total)??0},this.getSearchResultMetadata=e=>{const{store:t,highlight:s,sources:r,localSource:i}=e;return n.Z.withListenerIgnored((()=>{var n,o,l,a,d;return{blockId:t.id,blockType:t.getType(),lowestNavigableAncestorId:null===(n=t.getNavigableBlockStore())||void 0===n?void 0:n.id,depth:b.qA(t).length,matchesText:Boolean(null==s?void 0:s.text),matchesPathText:Boolean((null==s?void 0:s.pathText)||(null==s?void 0:s.title)),matchesTitle:Boolean(null==s?void 0:s.title),isNavigable:t.isNavigableBlock(),lastEditedTime:t.getLastEditedTime(),isTeamArchived:null===(o=(0,b.VP)(t))||void 0===o?void 0:o.isArchived(),sources:r,localSource:[...i??[]],badges:(null===(l=e.badges)||void 0===l?void 0:l.map((e=>e.type)))??[],isCollectionPropertyMatch:void 0!==(null===(a=e.matchedCollectionProperties)||void 0===a?void 0:a.collectionText),isCollectionPropertyHighlight:void 0!==(null===(d=e.highlight)||void 0===d?void 0:d.collectionText),featureGroups:e.featureGroups}}))},this.getPathText=e=>{const t=[];return b.uJ(e).forEach((e=>{if(C.OY(e)){var s;const r=(0,h.QaF)(null===(s=e.getNavigableBlockStore())||void 0===s?void 0:s.getTitleValue());r&&t.push(r)}else if((0,j.bq)()&&C.Y(e)){const s=e.getName();s&&t.push(s)}})),t},this.handleSpaceChange=()=>{const e=P.default.state.currentSpaceStore&&P.default.state.currentSpaceStore.id;this.spaceId!==e&&(this.spaceId=e,this.resetState())},this.resetState=()=>{A.ZP.reset(),F.default.reset(),this.searchResultStore.reset(),this.secondarySearchResultStore.reset(),Z.default.reset()},this.currentMode=this.createComputedStore((()=>A.ZP.state.mode))}willMount(){var e;this.spaceId=null===(e=P.default.state.currentSpaceStore)||void 0===e?void 0:e.id,this.shouldClearServerResultsOnQueryChange="on"===w.default.getGroup("search-clear-results-on-query-change"),(0,k.lO)()}willMountOrUpdate(e){if(e.renderAsPage&&!F.default.state.sessionId){const e=(0,c.ZP)();F.default.update((t=>({...t,open:!1,openAsPage:!0,openedTimeMs:Date.now(),sessionId:e}))),m.wFN(this.environment,{from:"nativeTab-search-direct-link",searchSessionId:e})}}didMount(){this.props.renderAsPage||F.default.addListener(this.handleComponentOpenClose),P.default.addListener(this.handleSpaceChange),g.potentialWebSearchAbandonEventEmitter.addListener(this.handlePotentialWebSearchAbandon)}willUnmount(){this.resetState(),this.props.renderAsPage||F.default.removeListener(this.handleComponentOpenClose),g.potentialWebSearchAbandonEventEmitter.removeListener(this.handlePotentialWebSearchAbandon),P.default.removeListener(this.handleSpaceChange),this.inactiveTimer&&(clearTimeout(this.inactiveTimer),this.inactiveTimer=void 0)}renderComponent(){if(T.Z.state.isGlobalSearchHost)return null;if(this.props.renderAsPage)return this.renderContent();const{device:e,mobileNative:t}=this.environment,s=Boolean(F.default.state.open);return(0,Ze.jsx)(O.Z,{open:s,onDismiss:this.handleComponentClose,modalStyle:this.getModalStyle(),disableAnimation:!e.isMobile||(null==t?void 0:t.supportsNativeHomeOnPhone())||!1,renderContent:this.renderContent})}getPublicAccessPermissionForPage(){return M.bC(this.environment)}getSearchResultContent(e,t){return n.Z.withListenerIgnored((()=>{var s;return{title:(0,h.QaF)(null===(s=e.getNavigableBlockStore())||void 0===s?void 0:s.getTitleValue()),pathText:this.getPathText(e),highlight:{text:(0,S.fe)(null==t?void 0:t.text),pathText:(0,S.fe)(null==t?void 0:t.pathText)}}}))}getModalStyle(){const{renderAsPage:e}=this.props;return{width:"75%",minHeight:50,maxHeight:e?"100vh":"80vh",transform:"translate3d(0,0,0)",background:this.theme.popoverBackground,maxWidth:this.getMaxWidth(),borderRadius:12,transition:"max-width 270ms"}}getMaxWidth(){const e=(0,k.gq)({device:this.environment.device}),t=li({device:this.environment.device,isPublicAccessPermissionForPage:this.getPublicAccessPermissionForPage().hasPublicAccessPermission}),s=oi(this.environment.device);if(e)return"90vw";let r=660;return t&&(r+=250),s&&(r+=300),r}}ci.displayName="Search",ci.MAX_RESULT_TO_TRACK=50;const ui=ci},82063:(e,t,s)=>{s.d(t,{Z:()=>k});var r=s(67294),i=s(480),n=s(86628),o=s(50817),l=s(32470),a=s(29026),d=s(59054),c=s(72126),u=s(21202),h=s(92338),p=s(97880),m=s(63143),g=s(68120),v=s(50906),f=s(65496),y=s(18245),x=s(80444),S=s(88632),b=s(77080),C=s(69327),M=s(84166),j=s(90106),I=s(55320),P=s(30857);function T(e){let{dependencies:t,debugColumnStore:s,localDebounce:o=25,serverDebounce:l=275,searchResultStore:u,permanentFilterOverride:h,enabled:p}=e;const m=(0,i.O7)(),g=(0,n.VK)((()=>function(e){const{isOnline:t,debugColumnStore:s}=e,r=s.state.searchExperimentOverrides;function i(e){return(null==r?void 0:r[e])??b.default.getGroup(e,{disableExposureLogging:!0})}return{shouldSearchLocal:"on"!==i("search-no-local-blending")&&t,forcedClusterPattern:s.state.forcedClusterPattern,searchExperimentOverrides:s.state.searchExperimentOverrides,forcedBlockIds:s.state.forcedBlockIds}}({isOnline:t.isOnline,debugColumnStore:s})),[t.isOnline,s]),v=(0,r.useMemo)((()=>c.Ds(w,l)),[l]);(0,d.r5)((()=>p?async function(e){var t;const{query:s,openAsPage:r,store:i,fetchServerResultsFn:n}=e;if(r&&c.Xy(s,i.state.selectedQueryResultQuery))return;"quick_find_scroll"!==a.ZP.state.source&&function(e){const{shouldSearchLocal:t,parentStore:s,environment:r,query:i,debug:n,limit:o,hasPublicAccessPermission:l,isOnline:a,store:d,permanentFilterOverride:c}=e;let u;const h={...i,filters:{...i.filters,...c}};t&&(u=f.b9(function(e){const{parentStore:t,requestInput:s,isOnline:r,environment:i,hasPublicAccessPermission:n,localSearchCache:o}=e,{query:l}=s;if(!o)return;if(!l.text.trim())return;if(n)return;const a=y.default.mark("rum.local_quick_search_query"),d=void 0,c=f.Y_({query:s,localCachedPages:o,parentStore:t,environment:i,isOnline:r,shouldLimitLocalResultsWhenOnline:!0,applyScoreThresholdWhenOnline:!0,maxLocalResultsOverride:d});return y.default.measure(a,{environment:i}),c}({parentStore:s,environment:r,requestInput:{query:h,debug:n,limit:o},hasPublicAccessPermission:l,isOnline:a,localSearchCache:M.Z.state.localSearchableBlocksCache})),P.default.update((e=>({...e,numLocalRequests:e.numLocalRequests+1}))),d.update((e=>({...e,localResults:u}))))}(e);const o=new Set;null===(t=i.state.localResults)||void 0===t||t.results.forEach((e=>o.add(e.id))),await n({...e,excludedBlockIds:[...o]})}({...t,...g,store:u,fetchServerResultsFn:v,environment:m,permanentFilterOverride:h}):Promise.resolve()),[t,g,u,v,m,h,p],{debounce:o})}async function w(e){let{parentStore:t,environment:s,query:r,debug:i,isOnline:n,publicAccessPermissionAncestorBlockId:o,currentSpaceStore:d,searchExperimentOverrides:x,forcedClusterPattern:S,store:b,forcedBlockIds:M,limit:T,permanentFilterOverride:w,excludedBlockIds:k}=e;const F={query:{...r,filters:{...r.filters,...w}},debug:i,limit:T};b.update((e=>({...e,serverResultsLoading:!0}))),P.default.update((e=>({...e,numServerRequests:e.numServerRequests+1})));const R=b.state.serverResults,Z=a.ZP.state.source,B=await async function(e){const{parentStore:t,requestInput:s,isOnline:r,environment:i,publicAccessPermissionAncestorBlockId:n,searchSessionId:o,searchSessionFlowNumber:l,source:a,spaceId:d,searchExperimentOverrides:c,forcedClusterPattern:v,forcedBlockIds:x,excludedBlockIds:S}=e,{query:b}=s;if(!b.text.trim()&&!f.FN(b.filters))return;if(!r)return{error:h.Ix.Offline};const M=y.default.mark("rum.server_quick_search_query"),I=await f.MS({environment:i,input:s,spaceId:d,publicAccessPermissionAncestorBlockId:n,searchSessionId:o,searchSessionFlowNumber:l,source:a,searchExperimentOverrides:c,forcedClusterPattern:v,recentPagesForBoosting:d&&"on"!==(null==c?void 0:c["search-debug-only-no-recent-boosting"])?C.Z.getWithoutSubscribing(d):[],forcedBlockIds:x,excludedBlockIds:S});if(!I)return;if("failed"===I.type)return I.offline?{error:h.Ix.Offline}:{error:h.Ix.RequestFailed};const P=I.data.trackEventProperties,T=(0,g.Qr)(P)?{}:(0,m.m8)((0,p.Yd)(P).map((e=>[`server-${e}`,P[e]]))),w=I.data.results.map(((e,s)=>({...e,serverEventProperties:T,originalPosition:s,store:j.G.createChildStore(t,{table:u.iU,id:e.id})})));return y.default.measure(M,{environment:i}),{value:{results:w,total:I.data.total,debugInfo:I.data.debug,serverEventProperties:T,clusterInfo:I.data.clusterInfo}}}({parentStore:t,environment:s,requestInput:F,spaceId:null==d?void 0:d.id,searchSessionId:I.default.state.sessionId,searchSessionFlowNumber:P.default.state.numServerRequests,publicAccessPermissionAncestorBlockId:o,isOnline:n,source:Z,searchExperimentOverrides:x,forcedClusterPattern:S,forcedBlockIds:M,excludedBlockIds:k}),A={query:{...a.ZP.state.query,filters:{...a.ZP.state.query.filters,...w}},limit:a.ZP.state.limit,debug:l.ZP.getDebugLevel()};if(!c.Xy(F,A))return;const L=f.b9(B),O="quick_find_scroll"===Z?f.Nu({existingResults:R,newPageResults:L}):L;if(B&&!B.error){var D,E,N;const e=B.value.results;b.update((t=>({...t,serverError:null==B?void 0:B.error,serverResultsLoading:!1,serverResults:O,serverResultsAllLoaded:e.length<T,serverEventProperties:B.value.serverEventProperties})));const t=(null==O?void 0:O.results.map((e=>{var t;return{id:e.id,badges:(null===(t=e.badges)||void 0===t?void 0:t.map((e=>e.type)))??[]}})))??[],r=new Map;for(const{badges:s}of t)for(const e of s){const t=r.get(e)??0;r.set(e,t+1)}const{sections:i}=f.IV({intentBasedGrouping:I.default.state.intentBasedSearch.enablesGrouping,localResults:null===(D=b.state.localResults)||void 0===D?void 0:D.results,serverResults:null==O?void 0:O.results}),n={};for(const[s,o]of Object.entries(i))n[s]=o.map((e=>e.id));v.ZfC(s,{numLocalResults:(null===(E=b.state.localResults)||void 0===E?void 0:E.results.length)||0,numServerResults:(null==O?void 0:O.results.length)||0,localResultsIds:(null===(N=b.state.localResults)||void 0===N?void 0:N.results.map((e=>e.id)))||[],...B.value.serverEventProperties,badgeCounts:r,badgesByResultId:t,idsBySection:n})}else b.update((e=>({...e,serverError:null==B?void 0:B.error,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0})))}function k(){const e=(0,i.Fy)(),{searchResultStore:t,secondarySearchResultStore:s}=(0,r.useContext)(o.SearchStaticContext),{parentStore:d}=(0,r.useContext)(o.SearchStoresContext),c=function(e){const t=(0,i.O7)();return(0,n.VK)((()=>{const{hasPublicAccessPermission:s,publicAccessPermissionAncestorBlockId:r}=f.bC(t);return{isOnline:Boolean(S.Z.state.online),limit:a.ZP.state.limit,parentStore:e,hasPublicAccessPermission:s,publicAccessPermissionAncestorBlockId:r,currentSpaceStore:x.default.state.currentSpaceStore,debug:l.ZP.getDebugLevel(),openAsPage:I.default.state.openAsPage,currentSpaceViewStore:x.default.state.currentSpaceViewStore,query:a.ZP.state.query}}),[t,e])}(d),u=(0,n.VK)((()=>Boolean((0,l.gq)({device:e})&&l.BJ.state.visible)),[e]),h=(0,n.VK)((()=>{var e;return(null===(e=t.state.selectedQueryResultQuery)||void 0===e?void 0:e.text)!==a.ZP.state.query.text}),[t]);T({dependencies:c,searchResultStore:t,debugColumnStore:l.v_,enabled:h}),T({dependencies:c,searchResultStore:s,debugColumnStore:l.BJ,enabled:u})}},63334:(e,t,s)=>{s.d(t,{Z:()=>n});var r=s(49085);class i extends r.default{getInitialState(){return{}}}const n=i},84166:(e,t,s)=>{s.d(t,{Z:()=>n});var r=s(49085);class i extends r.default{}const n=new i},2342:(e,t,s)=>{s.d(t,{ZP:()=>d});var r=s(49085),i=s(92338),n=s(62965),o=s(29026);class l extends r.default{getInitialState(){return{insertedActionResultsCount:0,localResults:void 0,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0,serverResultsAllLoaded:!1,errorState:a,selectedQueryResultQuery:void 0}}setState(e){const t={...this.instanceState};if(!(0,n.Z)(this.instanceState,t))return;const s=function(e){const{newState:t,priorState:s}=e,{localResults:r,serverError:n,serverResultsLoading:o,serverResults:l}=t,a=Boolean(r),d=o?void 0:n;if(!a&&o)return!s.errorState.isLoading&&s.errorState.showMajorError?s.errorState:{isLoading:o};if(a)return{hasLocalResults:a,serverError:d,isLoading:!1,showMajorError:!1};if(d)return{hasLocalResults:a,serverError:d,isLoading:!1,showMajorError:!0};if(0===(null==l?void 0:l.results.length))return{hasLocalResults:a,serverError:i.Ix.NoResults,isLoading:!1,showMajorError:!0};return{hasLocalResults:a,serverError:d,isLoading:!1,showMajorError:!1}}({newState:e,priorState:t});super.setState({...e,errorState:s})}getResultCount(){const{serverResults:e,localResults:t}=this.state,s=(null==e?void 0:e.total)??(null==t?void 0:t.total)??0,r=Boolean(e&&s>=100);return{count:s,isLowerBound:Boolean(e&&t&&s<o.Xv)||r}}}const a={showMajorError:!1,isLoading:!1,hasLocalResults:!1,serverError:void 0};const d=l},54983:(e,t,s)=>{s.d(t,{Z:()=>n});var r=s(49085);class i extends r.default{getInitialState(){return{}}}const n=i},22109:(e,t,s)=>{s.d(t,{T:()=>n});s(67294);var r=s(45238),i=s(85893);const n=(0,r.I)("arrowsUpDown",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M4.11 2.385a.61.61 0 01.48-.211c.191 0 .353.07.486.21L8.03 5.409a.66.66 0 01.2.475c0 .191-.061.347-.182.469a.627.627 0 01-.463.181.59.59 0 01-.451-.187L5.926 5.098l-.72-.844.04 1.219v7.242a.624.624 0 01-.187.469.624.624 0 01-.47.187.636.636 0 01-.468-.187.635.635 0 01-.182-.47V5.474l.041-1.22-.726.845-1.201 1.248a.61.61 0 01-.457.187.627.627 0 01-.463-.181.634.634 0 01-.182-.47.66.66 0 01.2-.474l2.958-3.023zm7.786 10.781a.636.636 0 01-.486.205.665.665 0 01-.486-.205l-2.947-3.035a.64.64 0 01-.206-.475c0-.191.061-.345.182-.463a.634.634 0 01.469-.181c.18 0 .33.06.451.181l1.201 1.248.727.85-.041-1.219V2.824c0-.187.06-.342.181-.463a.636.636 0 01.47-.187.627.627 0 01.65.65v7.248l-.041 1.219.726-.85 1.207-1.248a.6.6 0 01.451-.181c.188 0 .342.06.463.181a.615.615 0 01.182.463.648.648 0 01-.2.475l-2.953 3.035z"})})},67220:(e,t,s)=>{s.d(t,{S:()=>n});s(67294);var r=s(45238),i=s(85893);const n=(0,r.I)("bot",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.996 16C12.381 16 16 12.38 16 8s-3.627-8-8.012-8C3.611 0 0 3.62 0 8s3.62 8 7.996 8zm0-1.594A6.375 6.375 0 011.61 8a6.366 6.366 0 016.38-6.398A6.393 6.393 0 0114.398 8a6.383 6.383 0 01-6.403 6.406zM4.648 8.518c0 .21.17.364.386.364h2.53l-1.346 3.605c-.202.527.355.813.703.395l4.168-5.176a.515.515 0 00.132-.325c0-.209-.17-.356-.379-.356H8.305l1.346-3.613c.201-.518-.356-.812-.704-.395l-4.16 5.184a.484.484 0 00-.14.317z"})})},6637:(e,t,s)=>{s.d(t,{I:()=>n});s(67294);var r=s(45238),i=s(85893);const n=(0,r.I)("filterCircled",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.667 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM4.41797 6.75879H11.5889C11.9307 6.75879 12.1699 6.54688 12.1699 6.22559C12.1699 5.9043 11.9307 5.68555 11.5889 5.68555H4.41797C4.07617 5.68555 3.84375 5.9043 3.84375 6.22559C3.84375 6.54688 4.07617 6.75879 4.41797 6.75879ZM5.36816 9.02148H10.6455C10.9805 9.02148 11.2197 8.80273 11.2197 8.48145C11.2197 8.16016 10.9805 7.94141 10.6455 7.94141H5.36816C5.02637 7.94141 4.78711 8.16016 4.78711 8.48145C4.78711 8.80273 5.02637 9.02148 5.36816 9.02148ZM6.35254 11.2773H9.6543C9.99609 11.2773 10.2354 11.0654 10.2354 10.7441C10.2354 10.4229 9.99609 10.2041 9.6543 10.2041H6.35254C6.01074 10.2041 5.77148 10.4229 5.77148 10.7441C5.77148 11.0654 6.01074 11.2773 6.35254 11.2773Z"})})},88507:(e,t,s)=>{s.d(t,{I:()=>n});s(67294);var r=s(45238),i=s(85893);const n=(0,r.I)("openTeamSearch",{viewBox:"0 0 16 14",svg:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("path",{d:"M9.506 13.342h4.447c.348 0 .621-.11.82-.328.2-.22.3-.516.3-.891V4.852c0-.375-.1-.67-.3-.885-.199-.219-.472-.328-.82-.328H9.922v1.136h3.709c.101 0 .178.026.228.077.051.05.076.127.076.228v6.815c0 .101-.025.177-.076.228-.05.05-.127.076-.228.076H9.506v1.143zm2.28-6.358h.925c.129 0 .193-.064.193-.193v-.896c0-.133-.064-.2-.193-.2h-.926c-.125 0-.187.067-.187.2v.896c0 .129.062.193.187.193zm0 2.168h.925c.129 0 .193-.066.193-.199v-.896c0-.133-.064-.2-.193-.2h-.926c-.125 0-.187.067-.187.2v.896c0 .133.062.2.187.2zm0 2.163h.925c.129 0 .193-.067.193-.2v-.896c0-.13-.064-.194-.193-.194h-.926c-.125 0-.187.065-.187.194v.896c0 .133.062.2.187.2zm-10.864.808c0 .375.1.672.299.89.199.22.474.329.826.329H9.44c.348 0 .621-.11.82-.328.204-.22.305-.516.305-.891V1.928c0-.38-.101-.676-.304-.89-.2-.22-.473-.329-.82-.329H2.046c-.352 0-.627.11-.826.328-.2.215-.3.512-.3.89v10.196zm1.142-.228V2.162c0-.105.026-.183.077-.234.05-.051.127-.076.228-.076h6.75c.102 0 .178.025.229.076.05.05.076.129.076.234v9.733c0 .101-.026.177-.076.228-.051.05-.127.076-.229.076H2.37c-.101 0-.178-.025-.228-.076-.051-.05-.077-.127-.077-.228zm1.588.85h.891v-1.946c0-.117.06-.176.182-.176h2.039c.12 0 .181.059.181.176v1.945h.89V10.5c0-.25-.058-.435-.175-.557-.117-.125-.295-.187-.533-.187H4.36c-.238 0-.416.062-.533.187-.117.122-.176.307-.176.557v2.244zm.17-8.362h1.12c.156 0 .234-.078.234-.235v-1.09c0-.156-.078-.234-.235-.234H3.822c-.148 0-.222.078-.222.235v1.09c0 .156.074.234.222.234zm2.719 0h1.12c.152 0 .228-.078.228-.235v-1.09c0-.156-.077-.234-.229-.234H6.541c-.152 0-.229.078-.229.235v1.09c0 .156.077.234.229.234zM3.822 6.627h1.12c.156 0 .234-.078.234-.234V5.309c0-.157-.078-.235-.235-.235H3.822c-.148 0-.222.078-.222.235v1.084c0 .156.074.234.222.234zm2.719 0h1.12c.152 0 .228-.078.228-.234V5.309c0-.157-.077-.235-.229-.235H6.541c-.152 0-.229.078-.229.235v1.084c0 .156.077.234.229.234zm-2.719 2.25h1.12c.156 0 .234-.08.234-.24V7.553c0-.157-.078-.235-.235-.235H3.822c-.148 0-.222.078-.222.235v1.084c0 .16.074.24.222.24zm2.719 0h1.12c.152 0 .228-.08.228-.24V7.553c0-.157-.077-.235-.229-.235H6.541c-.152 0-.229.078-.229.235v1.084c0 .16.077.24.229.24z"})})})},90028:(e,t,s)=>{s.d(t,{j:()=>n});s(67294);var r=s(45238),i=s(85893);const n=(0,r.I)("searchInPage",{viewBox:"0 0 12 14",svg:(0,i.jsx)("path",{d:"M2.877 13.365h6.24c.63 0 1.104-.164 1.424-.492.32-.324.48-.8.48-1.43V6.13c0-.274-.015-.504-.046-.691a1.531 1.531 0 00-.182-.522 2.185 2.185 0 00-.387-.498l-3.07-3.123a2.11 2.11 0 00-.48-.38 1.528 1.528 0 00-.51-.183A3.464 3.464 0 005.7.68H2.877c-.629 0-1.104.164-1.424.492-.32.324-.48.8-.48 1.43v8.841c0 .633.16 1.112.48 1.436.32.324.795.486 1.424.486zm.094-1.154c-.282 0-.492-.072-.633-.217-.14-.144-.211-.351-.211-.621V2.678c0-.27.07-.479.21-.627.142-.149.354-.223.64-.223h2.496V5.04c0 .418.101.73.304.938.207.207.52.31.938.31h3.158v5.086c0 .27-.07.477-.21.621-.142.145-.354.217-.64.217H2.971zm3.855-6.938c-.12 0-.209-.027-.263-.082-.051-.054-.077-.142-.077-.263V1.986l3.229 3.287H6.826z"})})},45168:(e,t,s)=>{s.d(t,{e:()=>i});var r=s(92338);function i(e){if(e)return e.sources.includes(r.vp.ElasticsearchUniqueID)}},68120:(e,t,s)=>{s.d(t,{Qr:()=>h});s(21703);var r=s(97880),i=s(63143),n=s(74487);const o=Symbol("JSON Schema"),l=Symbol("JSON Schema Components"),a=Symbol("No JSON Schema"),d={isNull:()=>({type:"null",[l]:{}}),boolean:()=>({type:"boolean",[l]:{}}),number:()=>({type:"number",[l]:{}}),integer:()=>({type:"integer",[l]:{}}),string:()=>({type:"string",[l]:{}}),dateString:()=>({type:"string",format:"date",[l]:{}}),literal:e=>({enum:[e],[l]:{}}),literals:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return{enum:t,[l]:{}}},uuid:()=>({type:"string",format:"uuid",[l]:{}}),uuidWithoutDashes:()=>({type:"string",format:"uuid",[l]:{}}),any:()=>u,array:e=>({type:"array",items:e[o],[l]:e[o][l]}),tuple:e=>({type:"tuple",items:!1,prefixItems:e.map((e=>e[o])).filter((e=>e!==a)),[l]:Object.assign({},...e.map((e=>e[o][l])))}),record:(e,t)=>({type:"object",additionalProperties:t[o],[l]:t[o][l]}),object:e=>{let{required:t,optional:s,exact:r}=e;return{type:"object",properties:(0,i.m8)(Object.entries({...t,...s}).filter((e=>{let[t,s]=e;return s[o]!==a})).map((e=>{let[t,s]=e;return[t,s[o]]}))),...r&&{additionalProperties:!1},...Object.keys(t).length>0&&{required:Object.keys(t)},[l]:Object.assign({},...Object.values({...t,...s}).map((e=>e[o][l])))}},union:e=>({anyOf:e.map((e=>e[o])).filter((e=>e!==a)),[l]:Object.assign({},...e.map((e=>e[o][l])))}),gte:(e,t)=>{const s=e[o];return s!==a?{...s,minimum:t}:s},lte:(e,t)=>{const s=e[o];return s!==a?{...s,maximum:t}:s},maxLength:(e,t)=>{const s=e[o];if(s===a)return s;if("type"in s){if("string"===s.type)return{...s,maxLength:t};if("array"===s.type)return{...s,maxItems:t}}throw new Error("Unknown type for max length.")},minLength:(e,t)=>{const s=e[o];if(s===a)return s;if("type"in s){if("string"===s.type)return{...s,minLength:t};if("array"===s.type)return{...s,minItems:t}}throw new Error("Unknown type for min length.")},nonEmpty:e=>{const t=e[o];if(t===a)return t;if("type"in t){if("string"===t.type)return{...t,minLength:1};if("object"===t.type)return{...t,minProperties:1};if("array"===t.type)return{...t,minItems:1}}throw new Error("Unknown non-emptyable type.")},nullable:e=>{const t=e[o];if(t===a)return t;if("type"in t)if(Array.isArray(t.type)){if("null"===t.type[1])return t;(0,r.t1)(t.type[1])}else{if("string"===t.type)return{...t,type:[t.type,"null"]};if("object"===t.type)return{...t,type:[t.type,"null"]};if("array"===t.type)return{...t,type:[t.type,"null"]};if("tuple"===t.type)return{...t,type:[t.type,"null"]};if("boolean"===t.type)return{...t,type:[t.type,"null"]};if("integer"===t.type)return{...t,type:[t.type,"null"]};if("number"===t.type)return{...t,type:[t.type,"null"]};if("null"===t.type)return t;(0,r.t1)(t.type)}else{if("const"in t)return{...t,enum:[t.const,null]};if("enum"in t)return{...t,enum:[...t.enum,null]};if("anyOf"in t)return{...t,anyOf:t.anyOf.map((e=>d.nullable({[o]:e})))};if("$ref"in t)return{anyOf:[t,{type:"null"}],[l]:t[l]};if(h(t))return t;(0,r.t1)(t)}}},c=(0,i.m8)(Object.entries(d).map((e=>{let[t,s]=e;return[t,function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];return 1===i.length&&(0,r.Kn)(i[0])&&("id"in i[0]||"description"in i[0])?function(){const{description:e,examples:r,id:a}=i[0];let d={description:e,...r&&{examples:r},...s(...arguments)};return a&&(d={$ref:`#/components/schemas/${a}`,[l]:{...d[l],[a]:d}}),{[o]:d,...n[t](...arguments)}}:{[o]:s(...i),...n[t](...i)}}]}))),u=(Symbol("Exact empty object ({})"),c.object({id:"emptyObject"})({required:{},optional:{},exact:!0}),{});function h(e){return(0,r.Kn)(e)&&0===Object.keys(e).length}}}]);