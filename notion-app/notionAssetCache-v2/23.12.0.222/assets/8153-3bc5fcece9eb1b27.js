"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8153],{23321:(e,t,o)=>{o.d(t,{L6:()=>T,OF:()=>Z,ZP:()=>R});o(57658),o(67294);var r,i=o(83355),s=o(8848),n=o(15095),a=o(72126),l=o(54153),p=o(5366),d=o(50906),c=o(72187),h=o(24608),u=o(5385),g=o(33929),m=o(4391),y=o(29798),f=o(73657),S=o(68785),x=o(32163),M=o(77137),v=o(43145),P=o(72495),b=o(57670),C=o(85893);const j=c.tg,k=c.Nm,Z=c.II,T=c.pq,w=(0,p.defineMessages)({noResults:{defaultMessage:"No results",id:"emojiPicker.noResults.message"}});class I extends i.Z{constructor(){super(...arguments),this.filter="",this.splitFilter=[],this.storeTypes={store:m.Z,menuListStore:y.Z},this.insertIcon=e=>{const t=this.getNormalizedIconPath(e);this.props.onSubmit(t);const o=t.split(/[/_.]/),r=o[2],i=o[3];this.addToRecentIcons(r),this.props.iconLoggingData&&d.fAb(this.environment,"pick_colored_icon",{icon:r,color:i,...this.props.iconLoggingData})},this.createListItem=(e,t)=>{const o=u.x(),r=this.props.enforceIconColor??o,i=`/icons/${`${e}${r?`_${r}`:""}`}.svg`;return{key:i,action:e=>this.handleIconButtonClick(i),render:o=>(0,C.jsx)(b.Z,{...o,icon:e,color:r??"gray",variations:t,insertIcon:this.insertIcon,shouldOpenVariations:!Boolean(r)})}},this.performGetAllIconsRequest=async e=>{const{store:t}=this.stores;if(!a.xb(t.getState().allIcons))return t.getState().allIcons;const o=await(0,h.ZP)({environment:this.environment,url:e,method:"GET",format:"json",mode:"cors"});if("success"===o.type)return t.setState({...t.state,allIcons:o.data}),o.data;throw o.error},this.createCategory=(e,t)=>{if(!t)return;let o=[];return o="recent"===e.id?this.stores.store.state.recentIcons||[]:Object.keys(t),0!==o.length?{key:e.id,items:o.map((e=>{if(void 0!==t[e])return this.createListItem(e,t[e])})).filter(Boolean),render:t=>(0,C.jsx)(P.Z,{isTitleUppercase:!0,title:e.title,children:(0,C.jsx)("div",{style:this.getIconSectionWrapStyle(),children:t.children})},t.key)}:void 0},this.handleScroll=e=>{if(Math.abs(e)<I.loadMoreCategoryEdgeDistance){const{loadIconCount:e,allIcons:t}=this.stores.store.state,o=this.getNumIconsPerRow()*this.getNumRowsPerPage(),r=Math.max(o,this.getAllSectionsIconCount(t));this.stores.store.setState({...this.stores.store.state,loadIconCount:Math.min(r,e+o)})}},this.handleIconButtonClick=e=>{this.insertIcon(e)},this.getNormalizedIconPath=e=>e.replace("_dark","")}willMount(e){super.willMount(e);const t=l.Z.get(I.localRecentIconsKey);this.stores.store.setState({...this.stores.store.state,recentIcons:t||[]})}renderComponent(){return(0,C.jsx)(M.Z,{request:"/icons/all",performRequest:this.performGetAllIconsRequest,render:(e,t,o)=>o?this.renderIconPicker(t):(0,C.jsx)("div",{style:this.getLoadingContainerStyle(),children:(0,C.jsx)(S.Z,{})})})}getNumIconsPerRow(){var e,t;const{device:o,WindowSizeStore:r}=this.environment;return o.isPhone?(window.innerWidth-r.getSafePaddingLeftPx(I.phonePaddingLeft)-r.getSafePaddingRightPx(I.phonePaddingRight))/b.Z.mobileButtonSize:o.isTablet?j:null!==(e=this.props)&&void 0!==e&&null!==(e=e.menuRef)&&void 0!==e&&null!==(e=e.current)&&void 0!==e&&e.offsetWidth?((null===(t=this.props)||void 0===t||null===(t=t.menuRef)||void 0===t||null===(t=t.current)||void 0===t?void 0:t.offsetWidth)-2*I.desktopPopupPaddingHorizontal)/b.Z.desktopButtonSize:o.isTablet?j:8}getNumRowsPerPage(){return this.environment.device.isMobile?T:Z}renderIconPicker(e){const{menuListStore:t}=this.stores,o=this.getVisibleSections(this.getAllSections(e)),r=this.environment.device.isDesktop&&o.length>0?0:void 0;return 0===o.length&&(this.props.onNoResults&&this.props.onNoResults(),o.push({key:"no results",items:[{key:"no results",action:e=>{},render:(e,t)=>(0,C.jsx)(f.Z,{...e,caption:g.default.formatMessage(w.noResults)})}],render:e=>(0,C.jsx)(P.Z,{...e})})),(0,C.jsxs)("div",{style:I.wrapStyle,children:[(0,C.jsx)("div",{style:{flexGrow:1},children:(0,C.jsx)(x.Z,{...this.getMenuListProps(),store:t,initialFocus:r,sections:o,disableKeyboardArrowWrap:!0,unfocusOnScroll:this.environment.device.isMobile})}),(0,C.jsx)(v.Z,{onChange:this.handleScroll})]})}getCategories(){return a.oA([!this.props.filter&&{id:"recent",title:(0,C.jsx)(p.FormattedMessage,{id:"iconPicker.section.recent",defaultMessage:"Recent"})},!this.props.filter&&{id:"icons",title:(0,C.jsx)(p.FormattedMessage,{id:"iconPicker.section.icons",defaultMessage:"Icons"})}])}createFilteredSection(e){if(!e)return[];const t=this.filterAndSortIcons(e);return 0===t.length?[]:[{key:"search-results",items:t.map((t=>this.createListItem(t,e[t]))),render:e=>(0,C.jsx)(P.Z,{children:(0,C.jsx)("div",{style:this.getIconSectionWrapStyle(),children:e.children})},e.key)}]}getMenuListProps(){return{type:x.i.Grid,itemsPerRow:this.getNumIconsPerRow(),renderRow:(e,t)=>(0,C.jsx)("div",{style:I.rowStyle,children:e},t)}}addToRecentIcons(e){const t=l.Z.get(I.localRecentIconsKey),o=a.G0([e],t),r=a.qn(o,this.getNumIconsPerRow()*k);l.Z.set(I.localRecentIconsKey,r),this.stores.store.setState({...this.stores.store.state,recentIcons:r})}getAllSections(e){this.filter=n.rJ(this.props.filter)??"",this.splitFilter=this.filter?this.filter.split(" ").filter(Boolean):[];const t=a.oA(this.getCategories().map((t=>this.createCategory(t,e))));return this.props.filter&&this.filter?this.createFilteredSection(e):t}getAllSectionsIconCount(e){const t=this.getAllSections(e);let o=0;for(const r of t)o+=r.items.length;return o}getVisibleSections(e){let{loadIconCount:t}=this.stores.store.state;0===t&&(t+=this.getNumIconsPerRow()*this.getNumRowsPerPage());const o=[];let r=0;for(const i of e){if(!(r+i.items.length<=t)){o.push({...i,items:i.items.slice(0,t-r)});break}o.push(i),r+=i.items.length}return o}filterAndSortIcons(e){const{filter:t}=this,o=a.oA(Object.keys(e).map((o=>{const r=e[o],i=((null==r?void 0:r.tooltip)??o).replace("-"," "),s=[i,...r.tags],n=s.findIndex((e=>e===t));if(-1!==n)return[0===n?100:50,o];const a=s.findIndex((e=>e.startsWith(t))),l=i.includes(t);return 0!==a&&l?[40,o]:-1!==a?[0===a?80:30,o]:void 0})));return a.MR(o,(e=>-e[0])).map((e=>e[1]))}getLoadingContainerStyle(){return{display:"flex",width:"100%",height:"100%",justifyContent:"center",alignItems:"center",paddingBottom:"10px"}}getIconSectionWrapStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",flexWrap:"wrap",alignItems:"flex-start",...e.isPhone?{background:this.theme.popoverBackground,paddingTop:10,paddingBottom:10,paddingLeft:t.getSafePaddingLeftCSS(I.phonePaddingLeft),paddingRight:t.getSafePaddingLeftCSS(I.phonePaddingRight),boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,marginBottom:1}:{background:s.ZP.transparent,paddingLeft:e.isTablet?I.tabletPopupPaddingHorizontal:I.desktopPopupPaddingHorizontal,paddingRight:e.isTablet?I.tabletPopupPaddingHorizontal:I.desktopPopupPaddingHorizontal}}}}r=I,I.displayName="IconPicker",I.loadMoreCategoryEdgeDistance=100,I.localRecentIconsKey="recentIcons",I.desktopPopupPaddingHorizontal=c.PS,I.tabletPopupPaddingHorizontal=c.vP,I.desktopIconPickerOnlyPopupWidth=8*b.Z.desktopButtonSize+2*r.desktopPopupPaddingHorizontal,I.desktopIconPickerOnlyPopupHeight=356,I.phonePaddingLeft=c.$P,I.phonePaddingRight=c.qJ,I.wrapStyle={display:"flex",flexDirection:"column"},I.rowStyle={display:"flex"};const R=I},57670:(e,t,o)=>{o.d(t,{Z:()=>y});o(67294);var r=o(83355),i=o(79362),s=o(72187),n=o(98742),a=o(61766),l=o(64921),p=o(31945),d=o(1743),c=o(3386),h=o(32163),u=o(26388),g=o(85893);class m extends r.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:a.Z},this.renderIconWithVariations=()=>{const{icon:e,focused:t}=this.props,{buttonPopupStore:o}=this.stores;return(0,g.jsx)(c.Z,{capture:t,onEnter:this.handleOpenMenu,onEsc:this.handleCloseMenu,children:(0,g.jsx)(p.ZP,{buttonPopupStore:o,popupType:p.Z4.Popup,renderOrigin:e=>this.renderSingleIcon(e),render:this.renderVariationMenu})},e)},this.renderSingleIcon=e=>{const{icon:t,focused:o,color:r,onClick:i,onMouseEnter:s,variations:a,hideTooltip:p}=this.props,d=a.tooltip?a.tooltip:t,c="dark"===this.theme.mode?a.dark:a.light;return(0,g.jsx)(u.Z,{allowHover:Boolean(t&&!p),disableTooltip:p,renderTooltip:()=>d.replaceAll("-"," ").replaceAll("_"," "),closeDelay:0,render:a=>(0,g.jsx)(l.Z,{focused:o,onClick:i,...(0,n.Z)(e||{},(0,n.Z)({onMouseEnter:s},a)),ignoreLocalHoverState:!0,style:this.styles.iconButton,children:(0,g.jsx)("img",{src:`data:image/svg+xml;utf8,${encodeURIComponent(c[r])}`,style:this.styles.iconImage,onContextMenu:e=>e.preventDefault()})},t)})},this.renderVariationMenu=e=>{const{icon:t,variations:o,insertIcon:r}=this.props,s="dark"===this.theme.mode?o.light:o.dark,n=Object.keys(s).sort(((e,t)=>i.Oe.indexOf(e)-i.Oe.indexOf(t))).map((i=>{const s=`${t}_${i}`;return{key:s,action:t=>{e.close(),r(`/icons/${s}.svg`)},render:e=>(0,g.jsx)(m,{...this.props,...e,icon:s,color:i,variations:o,shouldOpenVariations:!1,hideTooltip:!0})}}));return(0,g.jsx)(d.Z,{capture:!0,allowEsc:!0,children:(0,g.jsx)(h.Z,{type:h.i.Grid,itemsPerRow:5,initialFocus:0,sections:[{key:"variations",render:e=>(0,g.jsx)("div",{...e}),items:n}],renderRow:(e,t)=>(0,g.jsx)("div",{style:this.styles.variationMenu,children:e},t)})})},this.handleOpenMenu=e=>{e.preventDefault();const{buttonPopupStore:t}=this.stores;t.setState({...t.state,open:!0})},this.handleCloseMenu=()=>{const{buttonPopupStore:e}=this.stores;e.setState({...e.state,open:!1})},this.styles={iconButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4,...this.getButtonStyles()},variationMenu:{display:"flex",padding:2,gap:1},iconImage:{...this.environment.device.isMobile?{width:m.mobileFontSize,height:m.mobileFontSize}:{width:m.desktopFontSize,height:m.desktopFontSize}}}}renderComponent(){const{shouldOpenVariations:e}=this.props;return e?this.renderIconWithVariations():this.renderSingleIcon()}getButtonStyles(){const{device:e}=this.environment;return e.isMobile?{width:m.mobileButtonSize,height:m.mobileButtonSize,fontSize:m.mobileFontSize}:{width:m.desktopButtonSize,height:m.desktopButtonSize,fontSize:m.desktopFontSize}}}m.displayName="IconPickerMenuItem",m.desktopButtonSize=s.T8,m.desktopFontSize=s.WB,m.mobileButtonSize=s.mz,m.mobileFontSize=s.jo;const y=m},3072:(e,t,o)=>{o.d(t,{Z:()=>P});o(57658),o(67294);var r=o(83355),i=o(2032),s=o(72126),n=o(5366),a=o(47853),l=o(16187),p=o(87279),d=o(98742),c=o(52275),h=o(78140),u=o(32163),g=o(40721),m=o(53437),y=o(72495),f=o(26388),S=o(42782),x=o(85893);const M=(0,n.defineMessages)({noneText:{defaultMessage:"None",id:"database.propertyAggregationMenu.noneText"}});class v extends r.Z{renderComponent(){const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:p.og.Modal,title:(0,x.jsx)(n.FormattedMessage,{defaultMessage:"Table aggregation",id:"database.mobilePropertyAggregationMenu.title"}),right:(0,x.jsx)(g.DoneMenuText,{}),onClickRight:this.props.onClose}:{menuType:p.og.Popup,width:200},(0,x.jsx)(h.Z,{...t,children:(0,x.jsx)(u.Z,{type:u.i.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,x.jsx)(y.Z,{...e}),items:this.getAggregationActions()}],onAccept:this.props.onClose})})}getAggregationActions(){const e=[],{property:t,schema:o,source:r}=this.props,s=o[t];if(!s)return[];e.push({key:"none",render:e=>(0,x.jsx)(c.Z,{...e,title:this.props.noneText||this.props.intl.formatMessage(M.noneText)}),action:()=>this.props.onChange(void 0)});for(const n of i.o5)e.push(this.createAggregationAction(n));if((0,i.iV)(s))for(const n of i.Sy){const t=this.createAggregationAction(n);if("show_unique"===n)switch(r){case"tableAggregation":continue;case"rollupPropertyMenu":e.splice(1,0,t);continue}e.push(t)}if((0,i.O4)(s))for(const n of i.k$)e.push(this.createAggregationAction(n));if((0,i.dN)(s))for(const n of i.f8)e.push(this.createAggregationAction(n));if((0,i.Mv)(s))for(const n of i.gC)e.push(this.createAggregationAction(n));if((0,i.Ei)(s))for(const n of i.OK)e.push(this.getStatusPropAggregationAction(t,n));return e}createAggregationAction(e){const t=l.VN[e],o=l.Sn[e];return{key:t,render:r=>(0,x.jsx)(f.Z,{placement:m.GI.Placement.Right,delayThreshold:0,render:e=>(0,x.jsx)(c.Z,{title:t,...(0,d.Z)(e,r)}),renderTooltip:()=>(0,x.jsxs)("div",{style:{width:140,whiteSpace:"normal"},children:[o&&(0,x.jsx)("img",{src:(0,a.D)(o),style:{borderRadius:3,width:140,marginTop:4}}),l.BG[e]]})},r.key),action:()=>{this.props.onChange(e)}}}getStatusPropAggregationAction(e,t){const{device:o}=this.environment,r=l.VN[t],i=s.oA(this.createStatusPropGroupAggregationAction(e,t));return{key:t,render:(e,t)=>(0,x.jsx)(S.Z,{...e,onFocus:t.onFocus,renderOrigin:e=>(0,x.jsx)(c.Z,{...e,title:r}),renderExtension:(e,s)=>{let n;return n=o.isMobile?{menuType:p.og.Modal,title:r,right:(0,x.jsx)(g.DoneMenuText,{}),onClickRight:s.close,...e}:{menuType:p.og.Popup,width:200,...e},(0,x.jsx)(h.Z,{...n,children:(0,x.jsx)(u.Z,{type:u.i.Vertical,initialFocus:0,sections:[{key:"groups",render:e=>(0,x.jsx)(y.Z,{...e}),items:i}],onAccept:t.onAccept})})}}),action:()=>null}}createStatusPropGroupAggregationAction(e,t){const o=this.props.schema[e];if(!o||"status"!==o.type)return;const r=o.groups;return r?r.map((e=>({key:`${t}${e.name}`,render:o=>this.renderAggregationGroupMenuItem(t,e.name,o),action:()=>{this.props.onChange({operator:t,groupName:e.name})}}))):void 0}renderAggregationGroupMenuItem(e,t,o){const r=l.Sn[e];return(0,x.jsx)(f.Z,{placement:m.GI.Placement.Right,delayThreshold:0,render:e=>(0,x.jsx)(c.Z,{title:t,...(0,d.Z)(e,o)}),renderTooltip:()=>(0,x.jsxs)("div",{style:{width:140,whiteSpace:"normal"},children:[r&&(0,x.jsx)("img",{src:(0,a.D)(r),style:{borderRadius:3,width:140,marginTop:4}}),l.BG[e]]})},o.key)}}v.displayName="PropertyAggregationMenu";const P=(0,n.injectIntl)(v)},18145:(e,t,o)=>{o.d(t,{Z:()=>F,t:()=>R});o(67294);var r=o(83355),i=o(2032),s=o(99036),n=o(42853),a=o(72126),l=o(5366),p=o(50906),d=o(66890),c=o(16187),h=o(75079),u=o(87279),g=o(98742),m=o(61766),y=o(90106),f=o(42917),S=o(52275),x=o(31945),M=o(78140),v=o(32163),P=o(40721),b=o(53437),C=o(72495),j=o(26388),k=o(97820),Z=o(3072),T=o(69872),w=o(77498),I=o(85893);let R=function(e){return e[e.BlockPropertyOverlay=0]="BlockPropertyOverlay",e[e.ViewSettings=1]="ViewSettings",e}({});class A extends r.Z{constructor(){super(...arguments),this.storeTypes={relationButtonPopupStore:m.Z,targetPropertyButtonPopupStore:m.Z,aggregationButtonPopupStore:m.Z},this.renderRelationSelect=e=>(0,I.jsx)(w.Z,{schema:this.props.schema,isRelationProperty:!0,onAccept:this.handleRelationAccept,onClose:e.close,allowProperty:this.handleRelationAllowProperty}),this.renderTargetPropertyTooltip=()=>(0,I.jsx)(l.FormattedMessage,{id:"database.rollupProperty.editProperty.tooltip",defaultMessage:"Select an existing relation first."}),this.renderTargetPropertySelect=e=>{const t=this.getRenderState();if(t)return(0,I.jsx)(w.Z,{isRelationProperty:!1,schema:t.relatedCollectionSchema,onAccept:this.handleTargetPropertyAccept,allowProperty:this.handleTargetPropertyAllowProperty,onClose:e.close})},this.renderAggregationTooltip=()=>(0,I.jsx)(l.FormattedMessage,{id:"database.rollupProperty.editAggregate.tooltip",defaultMessage:"Select an existing relation and property first."}),this.renderAggregationSelect=e=>{const t=this.getRenderState();if(t&&t.propertySchema.target_property)return(0,I.jsx)(Z.Z,{property:t.propertySchema.target_property,schema:t.relatedCollectionSchema,onChange:this.handlePropertyAggregationMenuChange,onClose:e.close,noneText:(0,I.jsx)(l.FormattedMessage,{id:"database.rollupProperty.aggregate.showOriginal",defaultMessage:"Show original"}),source:"rollupPropertyMenu"})},this.handleRelationAccept=e=>{const{onChange:t,analyticsFrom:o}=this.props,r=this.getRenderState();if(!r)return;const i={...r.propertySchema,relation_property:e,target_property:"title",target_property_type:"title",aggregation:void 0};null==t||t({propertySchema:i}),p.Zrf(this.environment,{...(0,h.Pn)(this.context.collectionContextStore),from:o})},this.handleTargetPropertyAccept=e=>{const{onChange:t,analyticsFrom:o}=this.props,r=this.getRenderState();if(!r||!r.relatedCollectionValue||!r.relatedCollectionSchema)return;const i=r.relatedCollectionSchema[e];if(!i)return;const s={...r.propertySchema,target_property:e,target_property_type:i.type,aggregation:void 0};null==t||t({propertySchema:s}),p.yjq(this.environment,{...(0,h.Pn)(this.context.collectionContextStore),from:o,property_type:i.type})},this.handlePropertyAggregationMenuChange=e=>{const{onChange:t,analyticsFrom:o}=this.props,r=this.getRenderState();if(!r)return;const s={...r.propertySchema,aggregation:e,show_as:void 0};null==t||t({propertySchema:s});const n=e?(0,i.gu)(e):void 0;p.enk(this.environment,{...(0,h.Pn)(this.context.collectionContextStore),from:o,aggregation:n})},this.handleRelationAllowProperty=e=>"relation"===e.type,this.handleTargetPropertyAllowProperty=e=>"rollup"!==e.type&&!s.Eu.includes(e.type)}renderComponent(){const{device:e}=this.environment,{context:t}=this.props,o=this.getRenderState();if(!o)return;const r=Boolean(o.propertySchema.relation_property),i=Boolean(o.propertySchema.relation_property&&o.propertySchema.target_property);if(t===R.BlockPropertyOverlay){let t;return t=e.isMobile?{menuType:u.og.Modal,title:o.propertySchema.name,right:(0,I.jsx)(P.DoneMenuText,{}),onClickRight:this.props.onDismiss}:{menuType:u.og.Popup},(0,I.jsx)(M.Z,{...t,children:(0,I.jsx)(v.Z,{type:v.i.Vertical,initialFocus:void 0,sections:a.oA([this.renderRelationSection(),this.renderTargetPropertySection(r),this.renderAggregationSection(i)])})})}return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(x.ZP,{popupType:e.isMobile?b.kQ.SlideUp:b.kQ.Popup,alignmentToOrigin:x.vR.End,renderOrigin:e=>(0,I.jsx)(f.Z,{title:(0,I.jsx)(l.FormattedMessage,{defaultMessage:"Relation",id:"database.viewSettings.rollupOptions.relationProperty"}),disabled:this.props.disabled,showChevron:!0,rotateChevron:this.stores.relationButtonPopupStore.state.open,right:o.relationPropertySchema?(0,I.jsx)(k.Z,{propertySchema:o.relationPropertySchema,showIcon:!0}):(0,I.jsx)(l.FormattedMessage,{id:"database.viewSettings.rollupOptions.selectRelation",defaultMessage:"Select"}),...e}),render:this.renderRelationSelect,buttonPopupStore:this.stores.relationButtonPopupStore}),(0,I.jsx)(j.Z,{renderTooltip:this.renderTargetPropertyTooltip,disableTooltip:r,render:t=>(0,I.jsx)(x.ZP,{popupType:e.isMobile?b.kQ.SlideUp:b.kQ.Popup,alignmentToOrigin:x.vR.End,renderOrigin:e=>(0,I.jsx)(f.Z,{title:(0,I.jsx)("span",{style:{...!i&&{color:this.theme.mediumTextColor}},children:(0,I.jsx)(l.FormattedMessage,{defaultMessage:"Property",id:"database.viewSettings.rollupOptions.targetProperty"})}),disabled:!r||this.props.disabled,showChevron:!0,rotateChevron:this.stores.targetPropertyButtonPopupStore.state.open,right:r&&(o.targetPropertySchema?(0,I.jsx)(k.Z,{propertySchema:o.targetPropertySchema,showIcon:!0}):(0,I.jsx)(l.FormattedMessage,{id:"database.viewSettings.rollupOptions.selectTargetProperty",defaultMessage:"Select"})),...(0,g.Z)(t,e)}),render:this.renderTargetPropertySelect,buttonPopupStore:this.stores.targetPropertyButtonPopupStore})}),(0,I.jsx)(j.Z,{renderTooltip:this.renderAggregationTooltip,disableTooltip:i,render:t=>(0,I.jsx)(x.ZP,{popupType:e.isMobile?b.kQ.SlideUp:b.kQ.Popup,alignmentToOrigin:x.vR.End,renderOrigin:e=>(0,I.jsx)(f.Z,{disabled:!i||this.props.disabled,title:(0,I.jsx)("span",{style:{...!i&&{color:this.theme.mediumTextColor}},children:(0,I.jsx)(l.FormattedMessage,{defaultMessage:"Calculate",id:"database.viewSettings.rollupOptions.calculate"})}),showChevron:!0,rotateChevron:this.stores.aggregationButtonPopupStore.state.open,right:i&&this.renderCurrentAggregation(),...(0,g.Z)(t,e)}),render:this.renderAggregationSelect,buttonPopupStore:this.stores.aggregationButtonPopupStore})})]})}renderRelationSection(){const{device:e}=this.environment,{disabled:t}=this.props,o=this.getRenderState();if(o)return{key:0,render:e=>(0,I.jsx)(C.Z,{...e,title:(0,I.jsx)(l.FormattedMessage,{id:"database.rollupProperty.editRelation.title",defaultMessage:"Relation"}),isTitleUppercase:!0}),items:[{key:0,render:r=>(0,I.jsx)(x.ZP,{popupType:e.isMobile?b.kQ.SlideUp:b.kQ.Popup,renderOrigin:e=>o.relationPropertySchema?(0,I.jsx)(T.Z,{...(0,g.Z)(r,e),propertySchema:o.relationPropertySchema,format:T.L.Name,right:this.getMenuItemChevron(t),disabled:t}):(0,I.jsx)(S.Z,{...(0,g.Z)(r,e),title:(0,I.jsx)(l.FormattedMessage,{id:"database.rollupProperty.editRelation.buttonTitle",defaultMessage:"Select an existing relation…"}),right:this.getMenuItemChevron(t),style:{color:this.theme.mediumTextColor},disabled:t}),render:this.renderRelationSelect,buttonPopupStore:this.stores.relationButtonPopupStore},r.key),action:()=>{this.stores.relationButtonPopupStore.setState({open:!0})}}]}}renderTargetPropertySection(e){const{device:t}=this.environment,{disabled:o}=this.props,r=this.getRenderState();if(r)return{key:1,render:e=>(0,I.jsx)(C.Z,{...e,title:(0,I.jsx)(l.FormattedMessage,{id:"database.rollupProperty.editProperty.title",defaultMessage:"Property"}),topBorder:!0,isTitleUppercase:!0}),items:[{key:0,render:i=>(0,I.jsx)(j.Z,{renderTooltip:this.renderTargetPropertyTooltip,disableTooltip:e,render:s=>(0,I.jsx)(x.ZP,{popupType:t.isMobile?b.kQ.SlideUp:b.kQ.Popup,renderOrigin:t=>r.targetPropertySchema?(0,I.jsx)(T.Z,{...(0,g.Z)(i,t),propertySchema:r.targetPropertySchema,format:T.L.Name,right:this.getMenuItemChevron(o),disabled:o}):(0,I.jsx)(S.Z,{...(0,g.Z)(i,s),title:(0,I.jsx)(l.FormattedMessage,{id:"database.rollupProperty.editProperty.buttonTitle",defaultMessage:"Select a property to display…"}),right:this.getMenuItemChevron(!e||o),disabled:!e||o,disabledFeedback:!0}),render:this.renderTargetPropertySelect,buttonPopupStore:this.stores.targetPropertyButtonPopupStore})},i.key),action:()=>{this.stores.targetPropertyButtonPopupStore.setState({open:!0})}}]}}renderAggregationSection(e){const{device:t}=this.environment,{disabled:o}=this.props;if(this.getRenderState())return{key:2,render:e=>(0,I.jsx)(C.Z,{...e,title:(0,I.jsx)(l.FormattedMessage,{id:"database.rollupProperty.editAggregate.title",defaultMessage:"Calculate"}),topBorder:!0,isTitleUppercase:!0}),items:[{key:0,render:r=>(0,I.jsx)(j.Z,{renderTooltip:this.renderAggregationTooltip,disableTooltip:e,render:i=>e?(0,I.jsx)(x.ZP,{popupType:t.isMobile?b.kQ.SlideUp:b.kQ.Popup,renderOrigin:e=>(0,I.jsx)(S.Z,{...(0,g.Z)(r,e),title:this.renderCurrentAggregation(),right:this.getMenuItemChevron(o),disabled:o}),render:this.renderAggregationSelect,buttonPopupStore:this.stores.aggregationButtonPopupStore}):(0,I.jsx)(S.Z,{...(0,g.Z)(r,i),title:(0,I.jsx)(l.FormattedMessage,{id:"database.rollupProperty.aggregate.showOriginal",defaultMessage:"Show original"}),right:this.getMenuItemChevron(o),disabled:!0,disabledFeedback:!0})},r.key),action:()=>{this.stores.aggregationButtonPopupStore.setState({open:!0})}}]}}renderCurrentAggregation(){const e=this.getRenderState();if(e)return e.propertySchema.aggregation?c.VN[(0,i.gu)(e.propertySchema.aggregation)]:(0,I.jsx)(l.FormattedMessage,{id:"database.rollupProperty.aggregate.showOriginal",defaultMessage:"Show original"})}getMenuItemChevron(e){return e?void 0:(0,n.i)({width:11,fill:this.theme.mediumIconColor})}getRenderState(){const{schema:e,property:t,parentStore:o}=this.props,r=e[t];if(!r)return;let i,n;if(r.relation_property){const t=e[r.relation_property];t&&"relation"===t.type&&(i=t)}if(i){const e=s.j0(i);if(e){n=y.NW.createChildStore(o,e).getValue()}}const a=n?s.oC(n):{};let l;return n&&r.target_property&&(l=a[r.target_property]),{propertySchema:r,relationPropertySchema:i,relatedCollectionValue:n,relatedCollectionSchema:a,targetPropertySchema:l}}}A.displayName="RollupPropertyMenu",A.contextTypes={...r.w,...d.xm};const F=A},9050:(e,t,o)=>{o.d(t,{Z:()=>d});o(67294);var r=o(83355),i=o(8848),s=o(80025),n=o(87279),a=o(52275),l=o(85893);class p extends r.Z{renderComponent(){return(0,l.jsx)(a.Z,{...this.props,icon:this.renderColorTile(),title:(0,s.Vn)(this.props.color)})}renderColorTile(){const e=(0,i.KR)(this.theme,this.props.color);return(0,l.jsx)("div",{style:{width:this.environment.device.isMobile?24:18,height:this.environment.device.isMobile?24:18,background:e.menuBackgroundColor,color:e.textColor,boxShadow:this.theme.innerBorderBoxShadow,borderRadius:3}})}}p.displayName="SelectColorMenuItem",p.contextTypes={...n.mw,...r.w};const d=p},73456:(e,t,o)=>{o.d(t,{Z:()=>_});o(57658),o(67294);var r=o(83355),i=o(49085),s=o(99036),n=o(8848),a=o(84619),l=o(96711),p=o(18557),d=o(84169),c=o(44495),h=o(37612),u=o(72126),g=o(6287),m=o(82990),y=o(5366),f=o(50906),S=o(47307),x=o(66890),M=o(75079),v=o(43224),P=o(87279),b=o(77080),C=o(33846),j=o(13709),k=o(50959),Z=o(93405),T=o(68894),w=o(78140),I=o(32163),R=o(40721),A=o(53437),F=o(72495),O=o(26388),B=o(9050),L=o(22084),Y=o(85893);class D extends r.Z{constructor(){super(...arguments),this.storeTypes={renameInputStore:C.Z,descriptionStore:i.default.createClass(""),addedDescriptionStore:i.default.createClass(!1)},this.renderPopup=()=>{const{device:e}=this.environment,{option:t,statusGroup:o,propertySchema:r}=this.props,{renameInputStore:i}=this.stores,s=b.default.checkGate("property_descriptions"),u=this.stores.addedDescriptionStore.state,g=[],m={key:"action",render:e=>(0,Y.jsx)(F.Z,{...e}),items:[]};if(g.push(m),m.items.push({key:"delete",render:e=>(0,Y.jsx)(Z.Z,{...e,title:(0,Y.jsx)(y.FormattedMessage,{id:"database.selectPropertyOptionEditMenu.deleteLabel",defaultMessage:"Delete"}),svg:h.y}),action:this.handleDelete}),o&&"status"===r.type&&(m.items.push({key:"setAsDefault",render:e=>(0,Y.jsx)(Z.Z,{...e,title:(0,Y.jsx)(y.FormattedMessage,{id:"database.selectPropertyOptionEditMenu.setAsDefault",defaultMessage:"Set as default"}),svg:p.z}),action:this.handleSetAsDefault}),m.items.push({key:"Group",render:e=>(0,Y.jsx)("div",{...e,children:(0,Y.jsx)(j.Z,{...e,title:(0,Y.jsx)(y.FormattedMessage,{id:"database.selectPropertyOptionEditMenu.Group",defaultMessage:"Group"}),selectedKey:o.name,options:(r.groups??[]).map((e=>({key:e.name,title:k.ZA[e.name]??e.name}))),icon:e=>(0,l.V)({...e,width:16,marginRight:0}),onChange:e=>{this.handleChangeGroup(e)}})}),action:()=>{}})),s)if(u||void 0!==t.description){const e=b.default.checkGate("autofill_tags");g.push({key:"description",render:t=>(0,Y.jsx)(F.Z,{...t,title:(0,Y.jsx)(y.FormattedMessage,{defaultMessage:"Description",id:"database.editProperty.select.description"}),isTitleUppercase:!0,topBorder:!0,right:(0,Y.jsx)(O.Z,{placement:O.Z.Placement.Bottom,render:e=>(0,Y.jsx)("div",{...e,children:(0,d.m)({width:12})}),renderTooltip:t=>(0,Y.jsx)("div",{...t,style:{width:300,whiteSpace:"normal"},children:e?(0,Y.jsx)(y.FormattedMessage,{defaultMessage:"Descriptions provide extra information about options to users and Notion AI. They appear when hovering over options while editing.",id:"database.editProperty.select.descriptionTooltipWithAI"}):(0,Y.jsx)(y.FormattedMessage,{defaultMessage:"Descriptions provide extra information about options to users. They appear when hovering over options while editing.",id:"database.editProperty.select.descriptionTooltip"})})})}),items:[{key:"description",render:e=>(0,Y.jsx)(T.ZP,{...e,value:this.stores.descriptionStore.state,onChange:e=>{this.stores.descriptionStore.setState(e.target.value)},onSubmit:this.handleEditDescription,onBlur:this.handleEditDescription,placeholder:"",focusInitial:this.stores.addedDescriptionStore.state,textarea:!0,textareaSubmitOnEnter:!0,maxlength:v.p}),action:()=>{}}]})}else m.items.push({key:"addDescription",render:e=>(0,Y.jsx)(Z.Z,{...e,svg:c.D,title:(0,Y.jsx)(y.FormattedMessage,{defaultMessage:"Add description",id:"database.editProperty.select.addDescription"})}),action:this.handleAddDescriptionClick});const f={key:"color",render:e=>(0,Y.jsx)(F.Z,{...e,title:(0,Y.jsx)(y.FormattedMessage,{id:"database.selectPropertyOptionEditMenu.colorsSection",defaultMessage:"Colors"}),isTitleUppercase:!0,topBorder:!0}),items:n.AP.map((e=>({key:e,render:o=>(0,Y.jsx)(B.Z,{...o,color:e,checkState:t.color===e}),action:()=>{this.handleSelectPropertyColorPickerChange(e)}})))};let S;return g.push(f),S=e.isMobile?{menuType:P.og.Modal,title:(0,Y.jsx)(L.a,{format:a.l.Large,value:t.value,color:t.color,showRemoveButton:!1,isSingle:!0}),right:(0,Y.jsx)(R.DoneMenuText,{}),onClickRight:this.handleRenameInputSubmit}:{menuType:P.og.Popup,width:220},(0,Y.jsxs)(w.Z,{...S,children:[(0,Y.jsx)(F.Z,{isInput:!0,children:(0,Y.jsx)(T.ZP,{focusInitial:!0,selectAll:!e.isMobile,value:i.state.inputValue,maxlength:180,onChange:this.handleRenameInputChange,onSubmit:this.handleRenameInputSubmit,rightMobileEditLabel:(0,Y.jsx)(y.FormattedMessage,{defaultMessage:"Rename",id:"database.editProperty.select.mobileLabel"})})}),(0,Y.jsx)(I.Z,{type:I.i.Vertical,disableKeyboard:!0,initialFocus:void 0,sections:g})]})},this.handleDelete=()=>{const{option:e,collectionId:t,onChange:o,analyticsFrom:r,statusGroup:i,propertySchema:n,property:a}=this.props;"status"!==n.type||e.value!==n.defaultOption?S.showDialog({showCancel:!0,keepFocus:!1,message:(0,Y.jsx)(y.FormattedMessage,{id:"database.selectPropertyOptionEditMenu.deleteModal.prompt",defaultMessage:"Are you sure you want to remove this option?"}),items:[{label:(0,Y.jsx)(y.FormattedMessage,{id:"database.selectPropertyOptionEditMenu.deleteModal.confirmButton",defaultMessage:"Remove"}),color:"red",onAccept:()=>{if(!s.cu(n)&&"status"!==n.type)return;const l={table:g.v,id:t},p=[],d={pointer:l,command:"keyedObjectListRemove",path:["schema",a,"options"],args:{remove:{id:e.id}}};if(p.push(d),i&&"status"===n.type){const t=(n.groups??[]).findIndex((e=>e.id===i.id)),o={pointer:l,command:"listRemove",path:["schema",a,"groups",t,"optionIds"],args:{id:e.id}};p.push(o)}o(p),this.props.onClose(),f.$qu(this.environment,{...(0,M.Pn)(this.context.collectionContextStore),property_type:n.type,action:"select_delete_option",from:r})}}]}):S.showErrorMessage((0,Y.jsx)(y.FormattedMessage,{defaultMessage:"Cannot delete default option.",id:"database.editProperty.errorDialog.forbidDeleteDefaultOption.message"}))},this.handleSetAsDefault=async()=>{const{collectionId:e,property:t,propertySchema:o,onChange:r,statusGroup:i,analyticsFrom:s,option:n}=this.props;if("status"!==o.type||!i)return;if(n.value===o.defaultOption)return;if(!(await S.confirmUserAction({message:(0,Y.jsx)("span",{children:(0,Y.jsx)(y.FormattedMessage,{defaultMessage:"Change default to <b>{defaultValue}</b>?",id:"database.editProperty.setAsDefault.confirm.title",values:{defaultValue:n.value,b:e=>(0,Y.jsx)("span",{style:{fontWeight:m.Z.fontWeight.semibold},children:e})}})}),description:(0,Y.jsx)("span",{children:(0,Y.jsx)(y.FormattedMessage,{defaultMessage:"New pages will start with {defaultValue} as the default status. Existing pages <b>without a status set</b> will switch to {defaultValue}.",id:"database.editProperty.setAsDefault.confirm.description",values:{defaultValue:n.value,b:e=>(0,Y.jsx)("span",{style:{fontWeight:m.Z.fontWeight.semibold},children:e})}})}),acceptLabel:(0,Y.jsx)(y.FormattedMessage,{defaultMessage:"Continue",id:"database.editProperty.setAsDefault.confirm.continueButton"})})))return;const a=[],l={pointer:{table:g.v,id:e},command:"update",path:["schema",t],args:{defaultOption:n.value}};a.push(l),r(a),this.props.onClose(),f.$qu(this.environment,{property_type:o.type,action:"status_set_default",from:s,collection_id:e})},this.handleChangeGroup=e=>{const{collectionId:t,option:o,property:r,onChange:i,statusGroup:s,analyticsFrom:n,propertySchema:a}=this.props;if("status"!==a.type||!s)return;const l={table:g.v,id:t},p=[],d=a.groups??[],c=d.findIndex((e=>e.id===s.id)),h=d.findIndex((t=>t.name===e));if(c===h)return;const u={pointer:l,command:"listRemove",path:["schema",r,"groups",c,"optionIds"],args:{id:o.id}},m={pointer:l,command:"listAfter",path:["schema",r,"groups",h,"optionIds"],args:{id:o.id}};p.push(u,m);const y=a.options??[],S={pointer:l,command:"set",path:["schema",r,"options"],args:d.flatMap((e=>{const t=e.optionIds??[];return y.filter((e=>t.includes(e.id)))}))};p.push(S),i(p),f.$qu(this.environment,{property_type:a.type,action:"status_set_default",from:n,collection_id:t})},this.handleRenameInputChange=e=>{const{renameInputStore:t}=this.stores,o=e.target.value.replace(/,/g,"");t.setState({...t.state,inputValue:o}),t.emit()},this.handleRenameInputSubmit=()=>{this.props.onClose(),this.performRename()},this.handleDismiss=()=>{this.props.onClose(),this.handleEditDescription(),this.performRename()},this.handleSelectPropertyColorPickerChange=e=>{const{option:t,collectionId:o,property:r,propertySchema:i,onChange:s,analyticsFrom:n}=this.props,a={...t,color:e};s([{pointer:{table:g.v,id:o},command:"keyedObjectListUpdate",path:["schema",r,"options"],args:{value:a}}]),f.$qu(this.environment,{property_type:i.type,action:"select_change_color",from:n,collection_id:o})},this.handleAddDescriptionClick=()=>{const{onChange:e,collectionId:t,property:o}=this.props;this.stores.addedDescriptionStore.setState(!0);const r={...this.props.option,description:""};e([{pointer:{table:g.v,id:t},command:"keyedObjectListUpdate",path:["schema",o,"options"],args:{value:r}}])},this.handleEditDescription=()=>{const{onChange:e,collectionId:t,property:o}=this.props,r=this.stores.descriptionStore.state,i={...this.props.option,description:r.length>0?r:void 0};e([{pointer:{table:g.v,id:t},command:"keyedObjectListUpdate",path:["schema",o,"options"],args:{value:i}}])}}willMount(e){super.willMount(e),this.stores.renameInputStore.setState({...this.stores.renameInputStore.state,inputValue:e.option.value}),void 0!==e.option.description&&this.stores.descriptionStore.setState(e.option.description)}renderComponent(){const{origin:e,open:t,alignmentToOrigin:o}=this.props,{device:r}=this.environment;return(0,Y.jsx)(A.ZP,{popupType:r.isMobile?A.ZP.PopupType.SlideUp:A.ZP.PopupType.Popup,open:t,onDismiss:this.handleDismiss,origin:e,render:this.renderPopup,alignmentToOrigin:o})}performRename(){const{collectionId:e,propertySchema:t,property:o,onChange:r,option:i}=this.props,{renameInputStore:s}=this.stores,n=s.state.inputValue,a=t.options||[],l=a.find((e=>e.id!==i.id&&e.value.trim().toLowerCase()===n.trim().toLowerCase()));if(i.value!==n)if(n)if(l)S.showErrorMessage((0,Y.jsx)(y.FormattedMessage,{defaultMessage:"This select option already exists.",id:"database.editProperty.errorDialog.duplicateSelectValue.message"}));else{const s=a.find((e=>e.id===i.id));if(!s)return;const l={...s,value:n},p={pointer:{table:g.v,id:e},command:"keyedObjectListUpdate",path:["schema",o,"options"],args:{value:l}},d="status"===t.type&&i.value===t.defaultOption?{pointer:{table:g.v,id:e},command:"update",path:["schema",o],args:{defaultOption:n}}:void 0;r(u.oA([p,d]))}else S.showErrorMessage((0,Y.jsx)(y.FormattedMessage,{defaultMessage:"Please type a value.",id:"database.editProperty.errorDialog.missingSelectValue.message"}))}}D.displayName="SelectOptionActionMenu",D.contextTypes={...r.w,...x.xm};const _=D},72589:(e,t,o)=>{o.d(t,{Z:()=>R});var r=o(67294),i=o(480),s=o(86628),n=o(24405),a=o(35011),l=o(84619),p=o(84116),d=o(21114),c=o(78106),h=o(42875),u=o(66673),g=o(59753),m=o(149),y=o(82990),f=o(50906),S=o(66890),x=o(75079),M=o(33929),v=o(87279),P=o(73807),b=o(80444),C=o(19629),j=o(30752),k=o(8606),Z=o(53876),T=o(78140),w=o(74648),I=o(85893);function R(e){var t,o,n,l;window.__c={n:"CollectionFormulaEditor"};const{property:y,disabled:C,formulas:j,getRecordModel:k,propertySchema:Z,collectionStore:R,handleSave:F,handleClose:O,blockStore:B,analyticsFrom:L}=e,Y=(0,i.O7)(),D=(0,S.Y$)(),[_,V]=(0,r.useState)(null==Z||null===(t=Z.formula2)||void 0===t?void 0:t.code),z=(0,u.Kt)(_,200,Object.is),E=(0,r.useRef)(null===(o=Z.formula2)||void 0===o?void 0:o.code),N=(0,r.useRef)(_),H=(0,r.useRef)(null==Z||null===(n=Z.formula2)||void 0===n?void 0:n.result_type),G=(0,r.useCallback)((e=>{N.current=e,V(e)}),[]),W=(0,r.useCallback)((e=>{H.current=e}),[]),[U,$]=(0,r.useState)([]),K=(0,i.Fy)();(0,r.useEffect)((()=>()=>{const e=E.current,t=N.current,o=H.current;t===e&&void 0===X||(F({newValue:t,newType:(0,a.x9)(o??{type:"unknown"}),propertySchema:Z,collectionStore:R,property:y}),f.$qu(Y,{...(0,x.Pn)(D),property_type:Z.type,action:"formula_v2_edit",from:L}))}),[]);const q=(0,s.VK)((()=>R.pointer),[R.pointer]),Q=(0,r.useMemo)((()=>{const e={type:"block",collection:q};return{kind:p.yp.ThisRow,type:e}}),[q]),J=(0,r.useMemo)((()=>{const e=g.s8.fromGetRecordModelFn(k);return{sourceProperty:y,valueTypes:[Q],handleDataRequest:j.createFormulaDataRequestHandler(k,e),formulaPropertyNames:_&&(0,c.Ny)(_)}}),[_,j,k,y,Q]),X=(0,s.VK)((()=>{if("v2"!==Z.version&&Z.formula)return j.convertCollectionFormulaToFormula2(Z.formula,q,R.getSchema())}),[q,R,j,Z.formula,Z.version]),ee=(0,r.useRef)(!1);(0,r.useEffect)((()=>{!async function(){if(!X||ee.current)return;const e=await j.analyzeFormula(X,J);let t;t=m.x.isFail(e)?{type:"unknown"}:e.value.type??{type:"unknown"},ee.current=!0,G(X),W(t)}()}),[R,j,G,W,y,Z,X,J]);const te=(0,r.useMemo)((()=>{var e;const t="v2"===Z.version?null===(e=Z.formula2)||void 0===e?void 0:e.code:X;return E.current=t,t}),[null===(l=Z.formula2)||void 0===l?void 0:l.code,Z.version,X]),oe=(0,s.VK)((()=>{var e;return null===(e=b.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),re=(0,P._)(),ie=(0,s.VK)((()=>{$([]);const e=R.getModel(),t=null==B?void 0:B.getModel(),o=null==B?void 0:B.getRecordModel;if(!(t&&e&&z&&o))return;const r=(0,a.NM)({block:t,formulaCode:z,getRecordModel:o,intl:M.default.getIntl(),userTimeZone:(0,h.r)(),depth:0,visitedProperties:new Set,formulaTimeoutTimestampMs:Date.now()+re});if(r){if(!m.x.isFail(r))return r.value;(0,d.y_)(r.error)&&$([r.error])}}),[B,R,z,re]);return J&&oe?(0,I.jsx)(T.Z,{menuType:K.isMobile?v.og.Modal:v.og.Popup,hideMobileTopbar:!0,width:K.isMobile?void 0:740,disableBottomPadding:!0,maxHeight:"unset",disableHeaderBorder:!0,disableScroller:!0,children:(0,I.jsx)(w.Z,{initialCode:te,outputFooter:void 0!==B&&(0,I.jsx)(A,{formulaResult:ie,blockStore:B,formulaSchema:Z}),formulas:j,getRecordModel:k,focus:!0,disabled:C,parentSpaceId:oe,typecheckContext:J,onCodeChange:G,onTypeChange:W,handleClose:O,parentCollection:R,evaluationErrors:U})}):null}const A=r.memo((e=>{let{formulaResult:t,blockStore:o,formulaSchema:i}=e;window.__c={n:"FormulaOutputFooter"};const[a,p]=(0,s.VK)((()=>{var e;if(!t||"undefined"===t.type)return[[],"text"];const r=(0,j.$I)(t,o.getRecordModel,(0,h.r)());return[r,(null===(e=r[0])||void 0===e?void 0:e.type)??"text"]}),[o.getRecordModel,t]),d=(0,s.VK)((()=>{if(null==a||!a.length)return[];const e=(0,C.vQ)(p,i);return(0,I.jsx)(C.E1,{propertyType:p,rootPropertySchema:i,numberRightAlign:!1,children:a.map(((t,r)=>(0,I.jsx)(C.gZ,{token:t,targetPropertySchema:i,blockStore:o,withComma:e&&r<a.length-1,numberRightAlign:!1},`${t.id}-${r}`)))})}),[o,i,a,p]),c=(0,n.yK)((e=>({output:{display:"flex",alignItems:"center",zIndex:1,fontSize:y.Z.fontSize.UISmall.desktop,height:38,padding:10,width:"100%",borderTop:`1px solid ${e.outlineButtonBorder}`,overflow:"hidden"},equals:{fontSize:y.Z.fontSize.UIRegular.desktop,color:e.mediumTextColor,marginRight:6,marginLeft:2}})),[]),u=(0,r.useMemo)((()=>({baseStyles:{sizing:"small",tokenFormat:l.l.Small,textStyle:{overflow:"hidden",textOverflow:"ellipsis",textWrap:"nowrap"},tokenWrapStyle:{display:"flex",flexWrap:"nowrap",...Z.RQ[l.l.Medium]}},store:o,isEmpty:!1,isReadOnly:!0,shouldRenderTooltip:!1,shouldWrap:!1,collectionContextStore:void 0,templateVariableContext:void 0,propertySchema:i,trackEditBlockProperty:()=>{},format:0,containerRef:null})),[o,i]);return(0,I.jsx)(k.O.Provider,{value:u,children:(0,I.jsxs)("div",{style:c.output,children:[(0,I.jsx)("span",{style:c.equals,children:"="}),d]})})}))},5385:(e,t,o)=>{o.d(t,{x:()=>i});var r=o(80444);function i(){var e;return null===(e=r.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.icon_picker_color}},12205:(e,t,o)=>{o.d(t,{J:()=>s});var r=o(86628),i=o(80444);function s(){const{currentSpaceStore:e}=(0,r.Kw)(i.default);return(0,r.VK)((()=>(null==e?void 0:e.canAdmin())??!1),[e])}},4391:(e,t,o)=>{o.d(t,{Z:()=>s});var r=o(49085);class i extends r.default{getInitialState(){return{allIcons:{},recentIcons:[],loadIconCount:0}}}const s=i},11843:(e,t,o)=>{o.d(t,{E:()=>s,S:()=>i});const r={"de-DE":{time:{"12h":"LT","24h":"H:mm"},month:"MMMM YYYY"},"da-DK":{time:{"12h":"LT","24h":"H:mm"},month:"MMMM YYYY"},"fi-FI":{time:{"12h":"LT","24h":"H:mm"},month:"MMMM YYYY"},"nb-NO":{time:{"12h":"LT","24h":"H:mm"},month:"MMMM YYYY"},"nl-NL":{time:{"12h":"LT","24h":"H:mm"},month:"MMMM YYYY"},"sv-SE":{time:{"12h":"LT","24h":"H:mm"},month:"MMMM YYYY"},"en-US":{time:{"12h":"LT","24h":"H:mm"},month:"MMMM YYYY"},"es-ES":{time:{"12h":"LT","24h":"H:mm"},month:"MMMM YYYY"},"es-LA":{time:{"12h":"LT","24h":"H:mm"},month:"MMMM YYYY"},"fr-FR":{time:{"12h":"LT","24h":"H:mm"},month:"MMMM YYYY"},"pt-BR":{time:{"12h":"LT","24h":"H:mm"},month:"MMMM YYYY"},"ko-KR":{time:{"12h":"LT","24h":"H:mm"},month:"YYYY[년] MMMM"},"zh-CN":{time:{"12h":"LT","24h":"H:mm"},month:"YYYY[年]MMM"},"zh-TW":{time:{"12h":"LT","24h":"H:mm"},month:"YYYY[年]MMM"},"ja-JP":{time:{"12h":"A h:mm","24h":"H:mm"},month:"YYYY[年]MMM"},pseudo:{time:{"12h":"A h:mm","24h":"H:mm"},month:"MMMM YYYY"}},i=["de-DE","fr-FR"],s=e=>r[e]},96711:(e,t,o)=>{o.d(t,{V:()=>s});o(67294);var r=o(45238),i=o(85893);const s=(0,r.I)("checkboxSquareChecked",{viewBox:"0 0 14 14",svg:(0,i.jsx)("path",{d:"M2.85742 13.4561H11.1357C12.6123 13.4561 13.3779 12.6904 13.3779 11.2344V2.91504C13.3779 1.45215 12.6123 0.693359 11.1357 0.693359H2.85742C1.38086 0.693359 0.615234 1.45215 0.615234 2.91504V11.2344C0.615234 12.6973 1.38086 13.4561 2.85742 13.4561ZM2.93945 12.1162C2.30371 12.1162 1.95508 11.7812 1.95508 11.1182V3.02441C1.95508 2.36133 2.30371 2.0332 2.93945 2.0332H11.0537C11.6826 2.0332 12.0381 2.36133 12.0381 3.02441V11.1182C12.0381 11.7812 11.6826 12.1162 11.0537 12.1162H2.93945ZM6.26855 10.3115C6.51465 10.3115 6.72656 10.1885 6.87012 9.96973L9.92578 5.19141C10.0146 5.04785 10.0967 4.88379 10.0967 4.72656C10.0967 4.3916 9.7959 4.16602 9.47461 4.16602C9.26953 4.16602 9.08496 4.27539 8.94141 4.50781L6.24121 8.8418L4.96973 7.22168C4.80566 7.00977 4.6416 6.93457 4.43652 6.93457C4.10156 6.93457 3.8418 7.20117 3.8418 7.54297C3.8418 7.70703 3.90332 7.85742 4.01953 8.00098L5.63281 9.96973C5.81738 10.209 6.01562 10.3115 6.26855 10.3115Z"})})},44643:(e,t,o)=>{o.d(t,{L:()=>s});o(67294);var r=o(45238),i=o(85893);const s=(0,r.I)("eyeHidePadded",{viewBox:"0 0 24 24",svg:(0,i.jsx)("path",{d:"M17.3867 18.1074C17.6055 18.3193 17.9404 18.333 18.1592 18.1074C18.3848 17.875 18.3711 17.5469 18.1592 17.335L6.5791 5.76855C6.37402 5.55664 6.01855 5.5498 5.80664 5.76855C5.60156 5.97363 5.60156 6.3291 5.80664 6.53418L17.3867 18.1074ZM12 6.1582C10.8105 6.1582 9.73047 6.36328 8.72559 6.69141L9.81934 7.78516C10.5098 7.58691 11.2275 7.4707 12 7.4707C16.3682 7.4707 19.8408 11.2715 19.8408 12.0713C19.8408 12.6113 18.7334 14.0059 16.9766 15.1064L17.9883 16.125C20.1348 14.7168 21.3857 12.8779 21.3857 12.0713C21.3857 10.6699 17.6055 6.1582 12 6.1582ZM12 17.9912C13.2646 17.9912 14.4199 17.7725 15.4658 17.4102L14.3789 16.3232C13.6338 16.542 12.8477 16.6787 12 16.6787C7.63184 16.6787 4.15918 13.0283 4.15918 12.0713C4.15918 11.6133 5.32129 10.1299 7.19434 8.98145L6.16211 7.94922C3.92676 9.37109 2.60742 11.251 2.60742 12.0713C2.60742 13.4727 6.46973 17.9912 12 17.9912ZM15.4111 13.3906C15.5889 12.9873 15.6914 12.5361 15.6914 12.0713C15.6914 10.0137 14.0508 8.39355 12 8.39355C11.5283 8.39355 11.084 8.48242 10.6738 8.65332L15.4111 13.3906ZM12 15.7559C12.5332 15.7559 13.0322 15.6328 13.4766 15.4209L8.64355 10.5811C8.4248 11.0322 8.30176 11.5312 8.30176 12.0781C8.30859 14.0811 9.94238 15.7559 12 15.7559Z"})})}}]);