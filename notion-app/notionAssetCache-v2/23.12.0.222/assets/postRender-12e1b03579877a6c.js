"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8586,7994],{63923:(e,t,s)=>{s.d(t,{Op:()=>B,DN:()=>O,Oq:()=>U,hS:()=>N});s(57658),s(67294);var i=s(41432),n=s(88437),a=s(66466),o=s(79310),r=s(37612),l=s(45238),d=s(85893);const c=(0,l.I)("unstar",{viewBox:"0 0 16 16",svg:(0,d.jsx)("path",{d:"M11.6641 9.32227L15.1299 6.83398C15.5879 6.50586 15.7861 6.14355 15.6562 5.76074C15.5264 5.38477 15.1641 5.2002 14.5967 5.20703L10.1943 5.23438L8.85449 1.03711C8.68359 0.490234 8.40332 0.196289 8 0.196289C7.60352 0.196289 7.32324 0.490234 7.14551 1.03711L6.22949 3.9082L7.2002 4.87207L7.96582 2.28125C7.97266 2.24023 7.98633 2.2334 8 2.2334C8.02051 2.2334 8.02734 2.24023 8.04102 2.28125L9.13477 6.01367C9.2373 6.35547 9.42188 6.47168 9.77051 6.45801L13.6602 6.36914C13.7012 6.36914 13.7148 6.37598 13.7217 6.38965C13.7285 6.41016 13.7217 6.41699 13.6875 6.4375L10.7754 8.44043L11.6641 9.32227ZM13.9268 14.2783C14.1387 14.4902 14.4941 14.4902 14.6992 14.2783C14.9043 14.0664 14.9111 13.7246 14.6992 13.5127L3.44043 2.28809C3.22852 2.07617 2.87988 2.06934 2.66797 2.28809C2.46289 2.49316 2.46289 2.84863 2.66797 3.05371L13.9268 14.2783ZM3.2627 14.7637C3.58398 15.0098 3.98047 14.9277 4.44531 14.5928L8 11.9814L11.5547 14.5928C12.0195 14.9277 12.4092 14.9961 12.7441 14.7637C12.8193 14.709 12.8672 14.6406 12.9629 14.5107L8.3418 10.7236C8.10254 10.5254 7.84277 10.5391 7.60352 10.7305L4.52051 13.1094C4.49316 13.123 4.47266 13.1367 4.45898 13.1162C4.45215 13.1025 4.45215 13.0957 4.45898 13.0615L5.75781 9.39062C5.87402 9.05566 5.83301 8.84375 5.52539 8.63867L2.3125 6.4375C2.28516 6.42383 2.27148 6.41016 2.27832 6.38965C2.29199 6.37598 2.30566 6.36914 2.33984 6.36914L4.88281 6.42383L3.67969 5.2207L1.40332 5.20703C0.835938 5.2002 0.480469 5.38477 0.350586 5.76074C0.220703 6.14355 0.412109 6.50586 0.876953 6.83398L4.46582 9.41113L3.05762 13.5879C2.87305 14.1279 2.94141 14.5244 3.2627 14.7637Z"})});var u=s(5366),m=s(50906),p=s(3297),g=s(42858),h=s(39699),f=s(52275),y=s(31278),v=s(72495),x=s(19037),S=s(28020),b=s(38755),M=s(74948),w=s(80444),j=s(34583),C=s(49386),k=s(82763),_=s(29768),T=s(62967),I=s(42784),P=s(2295),Z=s(6471),F=s(5337);const A=(0,u.defineMessages)({unpinName:{id:"action.unpin.name",defaultMessage:"Remove from sidebar"},leaveName:{id:"action.leave.name",defaultMessage:"Leave"},removefromFavoritesName:{id:"action.removefromFavorites.name",defaultMessage:"Remove from Favorites"},duplicateToPrivateName:{id:"action.duplicateToPrivate.name",defaultMessage:"Duplicate to Private"},duplicateToName:{id:"action.duplicateTo.name",defaultMessage:"Duplicate to"}}),D=(0,T.cN)({key:"remove pinned shared page",displayName:A.unpinName,analyticsName:A.unpinName.defaultMessage,svg:o.A,validators:[x.cW,x.uq],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;const{currentSpaceViewStore:i,currentUserSettingsStore:n}=w.default.state;i&&n&&(h.createAndCommit({userAction:"actionRegistry.removePinnedSharedPage",environment:s,perform:e=>{for(const a of t)M.unpinSharedPage({environment:s,transaction:e,spaceViewStore:i,userSettingsStore:n,store:a})}}),m.An9(s,{type:"shared",from:"sidebar_dropdown_menu"}))}}),B=(0,T.cN)({key:"delete block without shortcuts",displayName:T.RE.deleteName,analyticsName:T.RE.deleteName.defaultMessage,svg:r.y,validators:[x.DF,x.eo,x.ff(x.sR),x.ff(x.P9(i.Ti.externalObjectInstancePage)),x.vd],closeParentMenu:!0,action:async e=>{let{blocks:t,environment:s}=e;await g.Qw({environment:s,blocks:t})}}),R=(0,T.cN)({key:"leave shared page",displayName:A.leaveName,analyticsName:A.leaveName.defaultMessage,svg:a.S,validators:[x.cW,x.zl,x.ff(x.uq)],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;h.createAndCommit({userAction:"actionRegistry.leaveSharedPage",environment:s,perform:e=>{M.leaveBlocks({environment:s,blocks:t,transaction:e})}})}}),L=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,T.cN)({key:"remove from favorites",displayName:A.removefromFavoritesName,analyticsName:A.removefromFavoritesName.defaultMessage,svg:c,validators:[...e,x.UI,x.U7,x.ff(x.xD([x.uq,x.cW]))],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;const{currentSpaceViewStore:i}=w.default.state;i&&h.createAndCommit({userAction:"actionRegistry.removeFromFavorites",environment:s,perform:e=>{M.unbookmarkPage({spaceViewStore:i,store:t[0],transaction:e})}})}})},N=L([x.tq]),E=L(),O=(0,T.cN)({key:"duplicate into private",displayName:A.duplicateToPrivateName,analyticsName:A.duplicateToPrivateName.defaultMessage,svg:n.a,validators:[x.ff(x.sR),x.DF,x.J5,x.ff(x.nJ),x.or([x.cW,x.ff(x.KE),x.b1])],closeParentMenu:!0,action:async e=>{let{blocks:t,environment:s}=e;if(!j.M_(s))return;const i=t[0],n=w.default.state.currentSpaceStore,a=w.default.state.currentSpaceViewStore;n&&a&&await p.DK({environment:s,store:i,spaceStore:n,spaceViewStore:a,isPrivate:!0,context:"duplicate_to_private_space"})}}),V=(0,T.MV)({key:"duplicate to workspace",displayName:A.duplicateToName,analyticsName:A.duplicateToName.defaultMessage,svg:n.a,validators:[x.DF,x.nJ,x.zz,x.ff(x.KE),x.Jl],subActions:e=>{let{blocks:t,environment:s}=e;const{currentUserRootStore:i}=w.default.state;if(!i)return[];const n=t[0],a=S.o(i),o=[];for(const r of a){const e=r.getSpaceStore();if(e){const t=(0,b.rn)(s,e),i=(0,b.Wd)(s,e);o.push({key:r.id,displayName:t||"",analyticsName:"Duplicate to workspace",searchName:t||"",closeParentMenu:!0,action:async()=>{await p.DK({environment:s,store:n,spaceStore:e,spaceViewStore:r,isPrivate:!0,context:"duplicate_to_another_space"})},render:(e,s)=>{let{environment:n}=s;return(0,d.jsx)(f.Z,{title:t,icon:(0,d.jsx)(y.Z,{icon:i,isEmptyPage:!1,title:t,size:n.device.isMobile?24:20,disabled:!0}),...e})}})}}return[(0,T.$J)({key:"duplicate-to",render:e=>(0,d.jsx)(v.Z,{...e}),actions:o})]}}),U=[I.ww,{key:"outliner primary actions",render:e=>(0,d.jsx)(v.Z,{...e}),actions:[D,B,R,C._p,E,_.Ay,...(0,_.jW)()?[_.vh]:[],O,V,k.H,k.K,C.Dw,C.IK,Z.$]},{key:"outliner move actions",render:e=>(0,d.jsx)(v.Z,{...e}),actions:[P.A]},{key:"turn page into teamspace or wiki",render:e=>(0,d.jsx)(v.Z,{...e}),actions:[F.NO,F.LM,F.BW]}]},68714:(e,t,s)=>{s.d(t,{l:()=>p});s(67294);var i=s(8848),n=s(45238),a=s(85893);const o=(0,n.I)("reportPage",{viewBox:"0 0 13 14",svg:(0,a.jsx)("path",{d:"M.832 13.846c.349 0 .636-.28.636-.636V9.47a4.696 4.696 0 011.634-.273c2.488 0 4.156 1.244 6.562 1.244 1.053 0 1.538-.13 2.065-.376.492-.218.779-.622.779-1.25v-6.81c0-.45-.349-.73-.814-.73-.39 0-1.005.26-2.098.26C7.216 1.534 5.515.29 3.033.29 2.001.29 1.53.42.976.666.49.892.189 1.247.189 1.869V13.21c0 .349.294.636.643.636zm8.805-4.703c-2.215 0-3.931-1.238-6.508-1.238-.663 0-1.265.075-1.627.212v-6.07c.123-.198.629-.465 1.552-.465 2.33 0 4.047 1.244 6.514 1.244.657 0 1.21-.075 1.627-.191v6.05c-.116.198-.635.458-1.558.458z",fill:"#ED6A5F"})});var r=s(5366),l=s(360),d=s(93405),c=s(19037),u=s(62967);const m=(0,r.defineMessages)({reportPageName:{id:"action.reportPage.name",defaultMessage:"Report page"}}),p=(0,u.cN)({key:"action report page",displayName:m.reportPageName,analyticsName:m.reportPageName.defaultMessage,validators:[c.Gg,c.iK,c.Id],closeParentMenu:!0,render:e=>(0,a.jsx)(d.Z,{...e,style:{color:i.ZP.red},svg:o,title:(0,a.jsx)(r.FormattedMessage,{...m.reportPageName})}),action:e=>{let{blocks:t,environment:s}=e;l.l()}})},5337:(e,t,s)=>{s.d(t,{NO:()=>F,LM:()=>P,BW:()=>D,bV:()=>R,R$:()=>L});s(67294);var i=s(62208),n=s(73039),a=s(55863),o=s(70203),r=s(82990),l=s(5366),d=s(47307),c=s(39699),u=s(29919),m=s(72495),p=s(24405),g=s(98742),h=s(93405),f=s(74420),y=s(26388),v=s(85893);function x(e){let{menuListItemProps:t,title:s,caption:i,icon:n,disabled:a,tooltipText:o,showNewBadge:r}=e;window.__c={n:"CreateFromPageMenuItem"};const l=(0,p.yK)((()=>({menuItem:{WebkitBackfaceVisibility:"hidden"},caption:{whiteSpace:"pre-wrap"}})),[]);return(0,v.jsx)(y.Z,{placement:y.Z.Placement.Right,textWrap:!1,disableTooltip:!o,renderTooltip:()=>o,render:e=>(0,v.jsx)(h.Z,{...(0,g.Z)(t,e),style:l.menuItem,title:s,caption:i,captionStyle:i?l.caption:void 0,svg:n,disabled:a,disabledFeedback:a,right:r&&(0,v.jsx)(f.Z,{})})})}var S=s(19037),b=s(95697),M=s(77080),w=s(21884),j=s(35057),C=s(73466),k=s(62967),_=s(11732);const T=(0,l.defineMessages)({createTeamFromPageFullName:{id:"action.createTeamFromPage.fullName",defaultMessage:"Turn into teamspace"},createTeamFromPageCaption:{id:"action.createTeamFromPage.caption",defaultMessage:"Space for your team to customize permissions and collaborate"},createTeamFromPageName:{id:"action.createTeamFromPage.name",defaultMessage:"Teamspace"},turnPageIntoWikiCaption:{id:"action.turnPageIntoWiki.caption",defaultMessage:"Organize by owner, tags, verification, and more"},turnPageIntoWikiName:{id:"action.turnPageIntoWiki.name",defaultMessage:"Wiki"},undoTurnPageIntoWikiName:{id:"action.undoTurnPageIntoWiki.name",defaultMessage:"Undo wiki"},turnPageIntoWikiFullName:{id:"action.turnPageIntoWiki.fullName",defaultMessage:"Turn into wiki"}}),I=(e,t)=>(0,k.cN)({key:"turn page into team",displayName:t,analyticsName:T.createTeamFromPageFullName.defaultMessage,svg:i.z,validators:e,closeParentMenu:!0,render:(e,s)=>{const i=function(e){const{block:t,environment:s}=e;if(!s.currentUser.id)return;if(0===o.QaF(t.getTitleValue()).length)return(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Cannot turn page without a title into a Teamspace",id:"sidebar.turnPageIntoTeamButton.missingTitleDisabledTooltip"});if("private"===(0,b.Pr)(t).accessLevel&&!(0,j.Rs)())return(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Only Business Plans and above can turn a private page into a Teamspace",id:"sidebar.turnPageIntoTeamButton.privateTeamsOnlyOnBusinessPlansAndAboveDisabledTooltip"})}({environment:s.environment,block:s.blocks[0]});return(0,v.jsx)(x,{menuListItemProps:e,title:(0,v.jsx)(l.FormattedMessage,{...t}),caption:(0,v.jsx)(l.FormattedMessage,{defaultMessage:T.createTeamFromPageCaption.defaultMessage,id:T.createTeamFromPageCaption.id}),disabled:Boolean(i),tooltipText:i,icon:n.K})},action:e=>{let{blocks:t,environment:s}=e;const i=t[0];C.VG({environment:s,page:i})}}),P=I([S.xD([S.jp,S.ff(S.KS)])],T.createTeamFromPageFullName),Z=I([S.jp],T.createTeamFromPageName),F=(0,k.MV)({key:"turn into teamspace or wiki",displayName:_.s.turnIntoSection,analyticsName:_.s.turnIntoSection.defaultMessage,svg:i.z,validators:[S.jp,S.KS],subActions:()=>[(0,k.$J)({key:"turn into teamspace or wiki",render:e=>(0,v.jsx)(m.Z,{...e}),actions:[Z,B]})],width:300}),A=(e,t)=>(0,k.cN)({key:"turn page into wiki",displayName:t,analyticsName:T.turnPageIntoWikiFullName.defaultMessage,svg:i.z,validators:e,closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;"bottom_right"===M.default.getEligibleGroup({experimentId:"wiki_education_convert_modal",defaultGroup:"control"})?w.E.setState({showConvertTooltip:!1,forceShow:!0}):c.createAndCommit({userAction:"actionRegistry.turnIntoAction.wiki",environment:t,perform:e=>{u.Y({environment:t,blocks:s,transaction:e,source:"page_menu"})}})},render:e=>(0,v.jsx)(x,{menuListItemProps:e,title:(0,v.jsx)(l.FormattedMessage,{...t}),disabled:!1,icon:i.z,caption:(0,v.jsx)(l.FormattedMessage,{...T.turnPageIntoWikiCaption})})}),D=A([S.xD([S.KS,S.ff(S.jp)])],T.turnPageIntoWikiFullName),B=A([S.KS],T.turnPageIntoWikiName);const R=A([S.KS],T.turnPageIntoWikiFullName),L=(0,k.cN)({key:"undo turn page into wiki",displayName:T.undoTurnPageIntoWikiName,analyticsName:T.undoTurnPageIntoWikiName.defaultMessage,svg:a.s,validators:[S.U7,S.U_,S.ff(S.p1),S.f7,S.QL("wiki_database")],closeParentMenu:!0,action:async e=>{let{environment:t,blocks:s}=e;await d.confirmUserAction({message:(0,v.jsx)("div",{style:{textAlign:"center"},children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"Are you sure you want to turn <bold>{pageName}</bold> back into a normal page?",id:"action.undoTurnIntoWiki.message",values:{pageName:o.QaF(s[0].getTitleValue()),bold:e=>(0,v.jsx)("span",{style:{fontWeight:r.Z.fontWeight.semibold},children:e})}})}),description:(0,v.jsx)("div",{style:{textAlign:"center"},children:(0,v.jsx)(l.FormattedMessage,{defaultMessage:"This will remove properties like owners and verification from your pages",id:"action.undoTurnIntoWiki.description"})})})&&c.createAndCommit({userAction:"actionRegistry.undoTurnIntoAction.wiki",environment:t,perform:e=>{u.Cq({environment:t,blocks:s,transaction:e,source:"page_menu"})}})}})},41311:(e,t,s)=>{s.d(t,{B3:()=>P,T_:()=>I,XP:()=>k,bA:()=>T,h7:()=>Z,w1:()=>C,y2:()=>_});s(57658);var i=s(45433),n=s(68626),a=s(4615),o=s(515),r=s(23867),l=s(64002),d=s(5366),c=s(95477),u=s(93959),m=s(91924),p=s(77907),g=s(80444),h=s(22756),f=s(67940),y=s(50906),v=s(54642),x=s(47307),S=s(84908),b=s(43181),M=s(15356),w=s(39699);const j=(0,d.defineMessages)({authenticatingWithAsana:{id:"asanaActions.authenticatingWithAsana.loadingMessage",defaultMessage:"Authenticating with Asana…"},titleMessage:{id:"asanaActions.loginWithAsanaPopupModal.title",defaultMessage:"Asana login"}});async function C(e){const{environment:t,flowId:s}=e;await v.disconnectAsana(t,{});const i=(0,m.eC)(t);let n=(0,o.s1)(c.default.domainBaseUrl,{authType:i,userId:t.currentUser.id});if(n=i.redirectToAuth?n:await(0,m.HU)(t,n),t.device.isElectron)return h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!0}),void S.openExternalUrl(n);const a=await M.M(t,{width:580,height:800,url:n,titleMessage:j.titleMessage});if(!a)return;const r=l.Qc(a);if(!r.query.code||!r.query.state)return;h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!0});const d=await v.authWithAsana(t,{code:r.query.code,encryptedState:r.query.state}),u=await v.getAsanaWorkspacesNames(t,{});if("failed"===d.type)y.a1y(t,{import_source:"asana",data:{import_type:"api",status:"failure",error:d.error},flowId:s}),console.error(d.error),x.showError(d);else if(y.a1y(t,{import_source:"asana",data:{import_type:"api",status:"success"},flowId:s}),"success"===u.type){const{data:{account:e,workspaces:t}}=u;h.Z.setState({...h.Z.state,isAccountLinkingInProgress:!1,account:e,workspaces:t,currentTab:"selectData",isModalOpen:!0})}}async function k(e){const{environment:t}=e;h.Z.setState({...h.Z.state,isAccountDelinkingInProgress:!0});const s=await v.disconnectAsana(t,{});"failed"===s.type?(console.error(s.error),x.showError(s)):(y.qJZ(t,{integration_name:"asana"}),"success"===s.type&&h.Z.setState({...h.Z.state,isAccountDelinkingInProgress:!1,account:void 0,workspaces:[]}))}async function _(e){const{selectedWorkspace:t,environment:s}=e;h.Z.setState({...h.Z.state,isLoadingProjects:!0});const i=await v.getTeamsAndProjectsInAsanaWorkspace(s,{workspaceId:t,size:5});"success"===i.type&&h.Z.setState({...h.Z.state,teamsAndProjects:i.data,isLoadingProjects:!1})}async function T(e){let{environment:t}=e;h.Z.setState({...h.Z.state,isLoadingAsanaWorkspaces:!0});const s=await v.getAsanaWorkspacesNames(t,{});"success"===s.type&&h.Z.setState({...h.Z.state,account:s.data.account,workspaces:s.data.workspaces,isLoadingAsanaWorkspaces:!1})}async function I(e){let{environment:t,spaceStore:s,currentSpaceViewStore:o,teamsStores:l,flowId:d}=e;const{appTemplatesSetupActions:c,appConfigs:m}=await p.deps.AppTemplates.loader(),x=h.Z.state.selectedWorkspace;if(!x)return;h.Z.setState({...h.Z.state,templateCreationInProgress:!0});const S={},M={};try{for(const e in h.Z.state.selectedProjectsAndTeamspaces){if(0===h.Z.state.selectedProjectsAndTeamspaces[e].projects.length)continue;let n;const a=h.Z.state.selectedProjectsAndTeamspaces[e],{notionTeamspaceId:r}=a;if(!r)continue;const d=l.find((e=>e.id===a.notionTeamspaceId));if(n=d||s,M[r])S[e]=M[r];else{const{serverCommitResult:s,performResult:a}=w.createAndCommit({environment:t,perform:e=>{const s={type:"preset",uri:i._F};if("preset"===s.type&&!s.uri.startsWith("notion://wiki")){var a;const i=s.uri,r=null===(a=(0,u.iX)(m(),i))||void 0===a?void 0:a.uri;if(!r)return;const l=m().find((e=>e.uri===r));if(null==l?void 0:l.presets.find((e=>e.uri===i))){return c.initializeApp({environment:t,spaceViewStore:o,appParentStore:n,appUri:r,presetUri:i,transaction:e,from:"asana_import"})}return[]}},userAction:"importActions.importAsana"});S[e]=a,M[r]=a,await s}}}catch(A){return void h.Z.setState({...h.Z.state,templateCreationInProgress:!1,currentTab:"failure"})}const j=[],C=g.default.state.currentSpaceViewStore;if(!C)return;const k=b.Ym({environment:t,spaceStore:s,spaceViewStore:C,append:!0});await k.deferred.promise;const _=k.pageId;h.Z.setState({...h.Z.state,loggerPageId:_});const T=new Set,I=[],P=[];for(const i in S){const e=h.Z.state.selectedProjectsAndTeamspaces[i],t=S[i];if(!(t&&e.notionTeamspaceId&&e.projects.length))continue;const n="string"==typeof e.projects?[]:e.projects;I.push(...n),T.add(e.notionTeamspaceId),P.push(i),j.push({collectionViewBlocks:t.map((e=>({id:e.id,spaceId:(0,r.C)(s.id)}))),projectIds:n,asanaTeamId:i,notionTeamSpaceId:e.notionTeamspaceId,importAllProjects:"all"===e.projects,importOnlyIncompleteProjects:"in_complete"===e.projects})}const Z=v.parallelAsanaImport(t,{importParams:j,spaceId:(0,r.C)(s.id),asanaWorkspaceId:x,importCompletedTasks:h.Z.state.importCompletedTasks,loggerPageId:_,flowId:d||(0,a.ZP)()});h.Z.setState({...h.Z.state,templateCreationInProgress:!1,currentTab:"importingData"}),f.Z.reset();const F=h.Z.state.workspaces.find((e=>e.gid===x));F&&function(e,t,s){try{y.qyQ(e,{import_source:"asana",data:t,flowId:s})}catch(i){n.log({level:"error",from:"asanaV2Actions",type:"parallelAsanaImport",error:{miscDataString:JSON.stringify({error:i,message:"Errored in tracking import_source_input event."})}})}}(t,{workspaceName:F.name,teams:P,projects:I,numberOfTeamspacesUsed:T.size,completedTasks:h.Z.state.importCompletedTasks,userId:t.currentUser.id,spaceId:(0,r.C)(s.id)},d);for await(const i of Z){if(!h.Z.state.isModalOpen)break;if(i.error)return void h.Z.setState({...h.Z.state,currentTab:"failure"});"success"===i.taskStatus&&h.Z.setState({...h.Z.state,currentTab:"confirm",result:i.value.status,isComplete:!0})}}function P(e){var t;let{teamId:s,spaceId:i}=e;h.Z.setState({...h.Z.state,selectedProjectsAndTeamspaces:{...h.Z.state.selectedProjectsAndTeamspaces,[s]:{projects:(null===(t=h.Z.state.selectedProjectsAndTeamspaces[s])||void 0===t?void 0:t.projects)||[],notionTeamspaceId:i}}})}function Z(){h.Z.setState({...h.Z.state,isModalOpen:!0})}},79257:(e,t,s)=>{s.d(t,{D2:()=>h,Do:()=>g,M0:()=>m,W4:()=>p,bA:()=>c,xv:()=>u});var i=s(85680),n=s(98452),a=s(52258),o=s(50906),r=s(6404),l=s(96802),d=s(39699);function c(e){const{originRect:t}=e;a.Z.reset(),n.Z.reset(),r.xv(),i.Z.setState({isOpen:!0,rect:t})}function u(){i.Z.setState({isOpen:!1})}function m(e){const{format:t,store:s,property:i,visibility:n,transaction:a}=e,o=t.property_visibility;o&&a&&l.FH({stores:[s],update:{property_visibility:Object.values(o||{}).map((e=>({property:e.property,visibility:i===e.property?n:e.visibility})))},transaction:a})}function p(e){const{store:t,pageSection:s,visibility:i,environment:n,format:a}=e,r=a.page_section_visibility;r&&(o.Mzl(n,{section:s,visibility:i}),d.createAndCommit({userAction:"customizePageActions.updatePageSectionVisibility",environment:n,perform:e=>{l.FH({stores:[t],update:{page_section_visibility:{...r,[s]:i}},transaction:e})}}))}function g(e){const{store:t,transaction:s,pageSectionFormats:i}=e;l.FH({stores:[t],update:{collection_page_sections:i},transaction:s})}function h(e){const{store:t,properties:s,environment:i}=e;d.createAndCommit({userAction:"customizePageActions.updateCollectionPageProperties",environment:i,perform:e=>{l.FH({stores:[t],update:{collection_page_properties:s},transaction:e})}})}},43181:(e,t,s)=>{s.d(t,{Ym:()=>V,A1:()=>z,am:()=>W,ro:()=>O,su:()=>U});s(57658),s(21703);var i=s(13991),n=s(41432),a=s(7057),o=s(7406),r=s(68626),l=s(59730);const d=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"],c=["text/plain",".md",".mdown",".markdown",".mkdn",".mkd",".Rmd",".md.txt"],u={markdown:c,csv:["text/plain",".csv"],html:["text/html"],docx:d,gdocs:d,dropbox:d,quip:["text/html",c],workflowy:["text/plain"],confluence:["application/zip"],genericImporter:["application/zip"]};var m=s(72126),p=s(91155),g=s(32056),h=s(29477),f=s(4615),y=s(21202),v=s(23867),x=s(5366),S=s(72340),b=s(33954),M=s(8989),w=s(33929),j=s(36214),C=(s(46190),s(78900)),k=s(90365),_=s(82066),T=s(90106),I=s(50906),P=s(54642),Z=s(47307),F=s(94419),A=s(92625),D=s(9953),B=s(28014),R=s(39699),L=s(53471);const N=(0,x.defineMessages)({uploadingOneFile:{id:"importActions.uploadingOneFile.loadingMessage",defaultMessage:"Uploading… ({percentComplete}%)"},uploadingMultipleFilesNotStarted:{id:"importActions.uploadingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Uploaded 0 of {totalNumberOfFiles}"},uploadingMultipleFilesInProgress:{id:"importActions.uploadingMultipleFilesInProgress.loadingMessage",defaultMessage:"Uploaded {numberOfUploadedFiles} of {totalNumberOfFiles}"},uploadingMultipleFilesComplete:{id:"importActions.uploadingMultipleFilesComplete.loadingMessage",defaultMessage:"Uploaded {totalNumberOfFiles} of {totalNumberOfFiles}"},importingOneFile:{id:"importActions.importingOneFile.loadingMessage",defaultMessage:"Importing…"},importingMultipleFilesNotStarted:{id:"importActions.importingMultipleFilesNotStarted.loadingMessage",defaultMessage:"Imported 0 of {totalNumberOfFiles}"},importingMultipleFilesInProgress:{id:"importActions.importingMultipleFilesInProgress.loadingMessage",defaultMessage:"Imported {numberOfImportedFiles} of {totalNumberOfFiles}"},importingMultipleFilesComplete:{id:"importActions.importingMultipleFilesComplete.loadingMessage",defaultMessage:"Imported {totalNumberOfFiles} of {totalNumberOfFiles}"},importingFromTrelloMessage:{id:"importActions.importingFromTrello.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} board from Trello} other {Importing {importingCount} boards from Trello}}"},importingFromAsanaMessage:{id:"importActions.importingFromAsana.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} project from Asana} other {Importing {importingCount} projects from Asana}}"},importingFromEvernoteMessage:{id:"importActions.importingFromEvernote.loadingMessage",defaultMessage:"{importingCount, plural, one {Importing {importingCount} notebook from Evernote} other {Importing {importingCount} notebooks from Evernote}}"},importingFromConfluenceViaAPIMessage:{id:"importActions.importingFromConfluenceViaAPI.loadingMessage",defaultMessage:"Importing confluence space: {confluenceSpaceKey}."},importFailed:{id:"importActions.importFailedError.message",defaultMessage:"Import failed."},fileImportFailedSizeTooLarge:{id:"importActions.fileImportFailedError.sizeTooLarge.message",defaultMessage:"Import failed: file exceeds 5MB."},trelloImportFailed:{id:"importActions.trelloImportFailedError.message",defaultMessage:"Trello import failed."},asanaImportFailed:{id:"importActions.asanaImportFailedError.message",defaultMessage:"Asana import failed."},evernoteImportFailed:{id:"importActions.evernoteImportFailedError.message",defaultMessage:"Evernote import failed."},confluenceImportViaAPIFailed:{id:"importActions.confluenceImportViaAPIFailedError.message",defaultMessage:"Confluence space import failed."},importTitle:{id:"importActions.importTitle",defaultMessage:"Import {date}"},importTitleForGenericFileImporter:{id:"importActions.importTitleForGenericFileImporter",defaultMessage:"{fileName} Import {date}"}}),E=1073741824;async function O(e){const{environment:t,pageStore:s,spaceStore:n,isTeamPage:d,spaceViewStore:c,uploadType:m,flowId:v}=e;let x;try{const o=await L.y({multiple:!0,accept:u[m].join(",")});if(0===o.length)return;const r=1===o.length;if("confluence"===m){const s=(Number((0,S.$6)(t))||15)*E;if(o[0].size>s)throw I.a1y(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:o[0].size},flowId:v}),new l.nY("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:g.td(s,1)}}})}else if("genericImporter"===m){const s=(0,M.b)(t)||15,i=s*E;if(o[0].size>i)throw I.a1y(e.environment,{import_source:"file",data:{import_type:"file",status:"failure",error:"Maximum upload size exceeded",fileSize:o[0].size},flowId:v}),new l.p8("Maximum upload size exceeded",{clientData:{type:"upload_file_size_exceeded",messageValues:{maxSize:`${s} GB}`}}})}const p=await new Promise(((e,s)=>{L.IL({environment:t,uploadType:m,files:o,bucket:"temporary",preventLimitFreeFileSize:!0,flowId:v,onBatchStart:()=>{A.j({message:r?N.uploadingOneFile:N.uploadingMultipleFilesNotStarted,interpolatedValues:{totalNumberOfFiles:o.length,percentComplete:0}})},onBatchProgress:e=>{let{uploadedFiles:t,progressPercent:s}=e;A.j({message:r?N.uploadingOneFile:N.uploadingMultipleFilesInProgress,interpolatedValues:{numberOfUploadedFiles:t,totalNumberOfFiles:o.length,percentComplete:s}})},onBatchComplete:t=>{A.j({message:r?N.uploadingOneFile:N.uploadingMultipleFilesComplete,interpolatedValues:{totalNumberOfFiles:o.length,percentComplete:100}}),e(t)},onBatchError:s})}));let b,j;if(s&&s.isEmptyPage())o.length>1||s.isInsideCollection()?(b=s.id,j="AppendToBlock"):(b=s.id,j="ReplaceBlock");else{const e={date:(0,a.Yx)(Date.now(),"medium",i.SP)};"genericImporter"===m&&(null!=o&&o[0].name?e.fileName=null==o?void 0:o[0].name.replace(".zip",""):e.fileName=(null==o?void 0:o[0].name)||"Universal File");const{performResult:s}=R.createAndCommit({userAction:"importActions.result",environment:t,perform:s=>{const i=w.default.formatMessage("genericImporter"===m?N.importTitleForGenericFileImporter:N.importTitle,e),a=B.KE({environment:t,spaceStore:n,spaceViewStore:c,isPrivate:!d,prepend:!d,title:i,transaction:s});let r;r=o.length>1?"AppendToBlock":"ReplaceBlock";const l=h.UZ();return s.postSubmitCallbacks.push((e=>{e?l.reject(e):l.resolve()})),{deferred:l,createdPage:a,pageId:a.id,importType:r}}});x=s.createdPage,b=s.pageId,j=s.importType,await s.deferred.promise}const C=p.map(((e,t)=>({fileURL:e,fileName:o[t].name})));let k=0;A.j({message:r?N.importingOneFile:N.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:k,totalNumberOfFiles:o.length}});for(const{fileURL:e,fileName:s}of C){if("confluence"===m){I.a1y(t,{import_source:"confluence",data:{import_type:"file",status:"success",fileSize:o[0].size},flowId:v});const i=V({environment:t,spaceStore:n,spaceViewStore:c});await i.deferred.promise;const a=i.pageId,r=P.parallelImportConfluenceExport(t,{fileURL:e,fileName:s,page:{id:b,spaceId:n.id},loggerPageId:a,flowId:v||(0,f.ZP)()});for await(const e of r){if(e.error)throw e.error;e.value.isComplete||A.j(e.value.status)}}else if("AppendToBlock"===j){const i={fileURL:e,fileName:s,importType:j,block:{id:b,spaceId:n.id},flowId:v};I.qyQ(t,{import_source:"file",data:i,flowId:v});const{value:a}=await P.importFile(t,i).next();if(a.error)throw a.error}else if("ReplaceBlock"===j){const i={fileURL:e,fileName:s,importType:j,block:{id:b,spaceId:n.id},flowId:v};I.qyQ(t,{import_source:"file",data:i,flowId:v});const{value:a}=await P.importFile(t,i).next();if(a.error)throw a.error}k++,A.j({message:r?N.importingOneFile:N.importingMultipleFilesInProgress,interpolatedValues:{numberOfImportedFiles:k,totalNumberOfFiles:o.length}})}return A.x(),T.G.createChildStore(n,{table:y.iU,id:b})}catch(C){var j;let e;r.log({level:"error",from:"importFiles",type:"importFilesFailure",error:(0,p.Ui)(C),data:{spaceId:n.id}}),A.x(),R.createAndCommit({userAction:"importActions.importFiles",environment:t,perform:e=>{x&&F.Od({parent:n.getPagesStore(),childToRemove:x,transaction:e})}});let s=null,i=null;if(C instanceof l.hm&&C.clientData?(s=C.clientData,b.Em[C.clientData.type]&&"ImportFileSizeTooLargeError"===(0,o.tg)(C).message?i=b.Em[C.clientData.type]:b.$5[C.clientData.type]&&"CsvImportError"===(0,o.tg)(C).message?i=b.$5[C.clientData.type]:b.zP[C.clientData.type]&&(i=b.zP[C.clientData.type])):C instanceof l.nY&&"upload_file_size_exceeded"===(null===(j=C.body)||void 0===j||null===(j=j.clientData)||void 0===j?void 0:j.type)&&b.zP[C.body.clientData.type]&&(s=C.body.clientData,i=b.zP[s.type]),s&&i){const t="messageValues"in s?s.messageValues:void 0;e=w.default.formatMessage(i,t)}else e="ImportFileSizeTooLargeError"===(0,o.tg)(C).message?w.default.formatMessage(N.fileImportFailedSizeTooLarge):w.default.formatMessage(N.importFailed);throw Z.showErrorMessage(e),C}}function V(e){const{environment:t,spaceStore:s,spaceViewStore:n,append:o}=e,{performResult:r}=R.createAndCommit({userAction:"importActions.result",environment:t,perform:e=>{const r=w.default.formatMessage(N.importTitle,{date:(0,a.Yx)(Date.now(),"medium",i.SP)}),l=B.KE({environment:t,spaceStore:s,spaceViewStore:n,isPrivate:!0,prepend:!o,title:`${r} Logs`,transaction:e}),d=h.UZ();return e.postSubmitCallbacks.push((e=>{e?d.reject(e):d.resolve()})),{deferred:d,pageId:l.id}}});return r}async function U(e){const{environment:t,boards:s,spaceStore:i,spaceViewStore:n}=e;A.j({message:N.importingFromTrelloMessage,interpolatedValues:{importingCount:s.length}}),_.Z.setState({open:!1});const{performResult:{deferred:a,pages:r}}=R.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{const a=s.map((s=>B.KE({environment:t,spaceStore:i,spaceViewStore:n,isPrivate:!0,prepend:!0,loading:!0,title:s.name,transaction:e}))),o=h.UZ();return e.postSubmitCallbacks.push((e=>{e?o.reject(e):o.resolve()})),{deferred:o,pages:a}}});await a.promise;try{return await Promise.all(r.map((async(e,i)=>{const n=s[i],{value:a}=await P.importTrello(t,{boardId:n.id,block:{id:e.id,spaceId:(0,v.C)(e.pointer.spaceId)}}).next();if(a.error)throw a.error}))),A.x(),r[0]}catch(l){throw R.createAndCommit({userAction:"importActions.importTrello",environment:t,perform:e=>{for(const t of r)F.Od({parent:i.getPagesStore(),childToRemove:t,transaction:e})}}),Z.showErrorMessage(w.default.formatMessage(N.trelloImportFailed)),A.x(),new Error((0,o.tg)(l).message)}}async function W(e){const{environment:t,spaceStore:s,spaceViewStore:i,notebooks:a,userSettingsStore:o}=e;if(0===a.length)throw new Error("Expected at least one notebook");A.j({message:N.importingFromEvernoteMessage,interpolatedValues:{importingCount:a.length}}),k.Z.setState({open:!1});const r=await async function(e){const{environment:t,spaceStore:s,spaceViewStore:i,notebooks:a}=e,{serverCommitResult:o,performResult:{blockStores:r}}=R.createAndCommit({userAction:"importActions.createStacks",environment:t,perform:e=>{const o=m.jj(m.oA(a.map((e=>e.stack)))).sort().reverse(),r={};let l=e=>!0;return a.length>1&&o.length>0&&(o.forEach((o=>{const l=B.KE({environment:t,spaceStore:s,spaceViewStore:i,isPrivate:!0,prepend:!0,loading:!1,title:o,transaction:e}),d=l.getContentStore();a.filter((e=>e.stack===o)).forEach((s=>{const i=D.j4({environment:t,type:n.Ti.copyIndicator,inMemoryRecordCache:l.inMemoryRecordCache,transaction:e,spaceId:d.pointer.spaceId,useCrdt:l.useCrdt()});F.R3({parent:d,append:i,transaction:e}),r[s.guid]=i}))})),l=e=>!Boolean(e.stack)),a.filter(l).reverse().forEach((n=>{const a=B.KE({environment:t,spaceStore:s,spaceViewStore:i,isPrivate:!0,prepend:!0,loading:!0,title:n.title,transaction:e});r[n.guid]=a})),{blockStores:r}}});return await o,r}({environment:t,spaceStore:s,spaceViewStore:i,notebooks:a}),l=r[a[0].guid];try{return await async function(e){const{environment:t,spaceStore:s,spaceViewStore:i,notebooks:n,waitForNotebook:a,notebookMapping:o,userSettingsStore:r}=e;let l;if(h.dC(n,2,(async e=>{await Promise.all(e.map((async e=>{const s=o[e.guid];if(!s)throw new Error(`Missing notebook page ${e.guid}`);const i=h.UZ();s===a&&(l=i),await async function(e){const{environment:t,notebookStore:s,notebook:i,firstCompleted:n}=e,a=P.importEvernote(t,{notebookId:i.guid,block:{id:s.id,spaceId:(0,v.C)(s.pointer.spaceId)},timestamp:Date.now(),parentTable:y.iU}),{value:o}=await a.next();o.error&&(console.error(o.error),R.createAndCommit({userAction:"importActions.importEvernoteNotebook",environment:t,perform:e=>{const t=s.getParentBlockStore();if(t){const i=t.getContentStore();F.Od({parent:i,childToRemove:s,transaction:e})}}}),Z.showErrorMessage(w.default.formatMessage(N.evernoteImportFailed)));n.resolve(void 0)}({environment:t,notebookStore:s,notebook:e,firstCompleted:i})})))})),!l)throw new Error("waitForNotebookFirstCompleted not defined.");const d=r.getSettings();null!=d&&d.created_evernote_getting_started||await j.FI({environment:t,type:"evernote",spaceStore:s,spaceViewStore:i,userSettingsStore:r});await l.promise}({environment:t,waitForNotebook:l,notebookMapping:r,notebooks:a,spaceStore:s,spaceViewStore:i,userSettingsStore:o}),A.x(),l}catch(d){throw A.x(),Z.showErrorMessage(w.default.formatMessage(N.evernoteImportFailed)),d}}async function z(e){const{environment:t,spaceStore:s,spaceViewStore:n,space:l,flowId:d}=e;if(!t.currentUser.id)throw new Error("User does not exist.");A.j({message:N.importingFromConfluenceViaAPIMessage,interpolatedValues:{confluenceSpaceKey:l.name}}),C.Z.setState({open:!1});const c=V({environment:t,spaceStore:s,spaceViewStore:n});await c.deferred.promise;const u=c.pageId,{performResult:m}=R.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{const o=w.default.formatMessage(N.importTitle,{date:(0,a.Yx)(Date.now(),"medium",i.SP)}),r=B.KE({environment:t,spaceStore:s,spaceViewStore:n,isPrivate:!0,prepend:!0,title:o,transaction:e}),l=h.UZ();return e.postSubmitCallbacks.push((e=>{e?l.reject(e):l.resolve()})),{deferred:l,createdPage:r,pageId:r.id}}});await m.deferred.promise;const g=m.createdPage;try{if(!g)throw new Error("No root page");const e=P.parallelImportConfluenceViaApi(t,{userId:t.currentUser.id,confluenceSpaceKey:l.key,confluenceSpaceId:l.id,page:{id:m.pageId,spaceId:s.id},loggerPageId:u,flowId:d});for await(const t of e){if(t.error)throw t.error;t.value.isComplete||A.j(t.value.status)}return A.x(),g}catch(f){throw r.log({level:"error",from:"importConfluenceViaAPI",type:"importConfluenceViaAPIFailure",error:(0,p.Ui)(f),data:{spaceId:s.id}}),R.createAndCommit({userAction:"importActions.importConfluenceViaApi",environment:t,perform:e=>{g&&F.Od({parent:s.getPagesStore(),childToRemove:g,transaction:e})}}),Z.showErrorMessage(w.default.formatMessage(N.confluenceImportViaAPIFailed)),A.x(),new Error((0,o.tg)(f).message)}}},360:(e,t,s)=>{s.d(t,{l:()=>n,q:()=>a});var i=s(25399);function n(){i.Z.setState({open:!0,submitted:!1,error:void 0})}function a(){i.Z.setState({open:!1})}},16859:(e,t,s)=>{s.d(t,{d:()=>P});var i=s(67294),n=s(480),a=s(5366),o=s(73063),r=s(53437),l=s(26388),d=s(935),c=s(24405),u=s(64275),m=s(81570),p=s(83065),g=s(82990),h=s(42922),f=s(64921),y=s(60458),v=s(1743),x=s(74194),S=s(16354),b=s(64369),M=s(42402),w=s(43250),j=s(18514),C=s(85893);function k(e){const{checked:t,onChange:s}=e;return(0,C.jsxs)("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[(0,C.jsx)(y.Z,{checked:t,onClick:s,size:14}),(0,C.jsx)("div",{onClick:s,children:(0,C.jsx)(b.Z,{style:{cursor:"pointer"},isSmall:!0,children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Share this AI session with Notion",id:"completions.FeedbackPopup.shareWithNotion"})})})]})}function _(){window.__c={n:"OptInLearnMore"};const e=(0,c.yK)((e=>({container:{display:"flex",flexDirection:"row"},giftIcon:{width:16,height:16,fill:e.lightIconColor},message:{marginLeft:9,color:e.mediumTextColor,fontSize:12}})),[]);return(0,C.jsxs)("div",{style:e.container,children:[(0,m.T)(e.giftIcon),(0,C.jsx)("div",{style:e.message,children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"You’re sharing data with Notion for AI quality improvement. <aiTerms>Learn more</aiTerms>",id:"completions.OptInLearnMore.description",values:{aiTerms:e=>(0,C.jsx)(M.Z,{external:!0,href:(0,j.UY)("ai.dataSharingTerms"),children:e})}})})]})}function T(e){window.__c={n:"ShareDataPopup"};const{onSubmit:t}=e,s=(0,c.yK)((e=>({container:{width:300,display:"flex",flexDirection:"column",alignItems:"center",padding:19,position:"relative"},closeButtonContainer:{position:"absolute",top:10,right:10},closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor},giftIcon:{width:24,height:24,fill:e.lightIconColor},terms:{color:e.mediumTextColor,textAlign:"center",fontSize:13},shareButton:{width:"100%",marginTop:17,paddingTop:7,paddingBottom:7},notNowButton:{color:e.mediumTextColor,fontSize:14,marginTop:15},title:{textAlign:"center",marginTop:9,marginBottom:8,fontWeight:g.Z.fontWeight.semibold}})),[]);return(0,C.jsxs)("div",{style:s.container,children:[(0,C.jsx)("div",{style:s.closeButtonContainer,children:(0,C.jsx)(f.Z,{onClick:()=>{t({optIn:!1})},style:s.closeButton,hoveredStyle:s.closeButtonHover,children:(0,u.D)(s.closeButtonIcon)})}),(0,m.T)(s.giftIcon),(0,C.jsx)("div",{style:s.title,children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Always share data to improve Notion AI?",id:"completions.ShareDataPopup.title"})}),(0,C.jsx)("div",{style:s.terms,children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Help Notion improve AI quality by automatically sharing data from your usage of AI powered features.{br}By continuing, you agree to <aiTerms>AI Data Sharing Terms</aiTerms>",id:"completions.ShareDataPopup.description",values:{br:(0,C.jsx)("br",{}),aiTerms:e=>(0,C.jsx)(M.Z,{external:!0,href:(0,j.UY)("ai.dataSharingTerms"),children:e})}})}),(0,C.jsx)(h.Z,{style:s.shareButton,onClick:()=>{t({optIn:!0})},children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Always share",id:"completions.ShareDataPopup.alwaysShareButton"})}),(0,C.jsx)(S.Z,{style:s.notNowButton,onClick:()=>{t({optIn:!1})},children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Not now",id:"completions.ShareDataPopup.notNowButton"})})]})}function I(e){window.__c={n:"FeedbackPopup"};const{state:t,onUpdate:s,onSubmit:r,onCancel:l,userOptIn:d}=e,c=(0,i.useCallback)((()=>{s({...t,shareWithNotion:!t.shareWithNotion})}),[t,s]),u=(0,i.useCallback)((()=>{r(t)}),[r,t]),m=(0,i.useCallback)((e=>{s({...t,userContent:e.target.value})}),[s,t]),g=(0,a.useIntl)(),h=(0,n.O7)(),f=!d;return(0,C.jsx)("div",{style:{padding:14,...h.device.isMobile?{width:"100%"}:{minWidth:400}},className:w.YOJ,children:(0,C.jsxs)(v.Z,{capture:!0,children:[(0,C.jsx)(x.Z,{value:t.userContent,onChange:m,onSubmit:e=>{e.stopPropagation(),u()},onCancel:l,focusInitial:!0,placeholder:g.formatMessage({id:"completions.FeedbackPopup.userCommentPlaceholder",defaultMessage:"How could the output be improved? (optional)"})}),(0,C.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingTop:10},children:[f?(0,C.jsx)(k,{checked:t.shareWithNotion,onChange:c}):(0,C.jsx)(_,{}),(0,C.jsx)(o.Z,{icon:p._,onClick:u,ariaLabel:g.formatMessage({id:"completions.FeedbackPopup.submitButtonLabel",defaultMessage:"Submit feedback"}),isBlue:!0,iconStyle:{height:24,width:24},style:{height:20,width:20}})]})]})})}function P(e){window.__c={n:"FeedbackButtonWithPopup"};const{type:t,ariaLabel:s,onClick:c,feedbackState:u,onDismiss:m,onSubmit:p,onUpdate:g,showShareDataPopup:h,onDataShareSubmit:f,userOptIn:y,iconButtonStyles:v}=e,x=(0,n.O7)(),S=t===(null==u?void 0:u.type),b=(0,d.L)(t,S),M=(0,i.useCallback)((()=>c(t)),[c,t]),w=(0,C.jsx)(l.Z,{renderTooltip:()=>(0,C.jsx)("div",{children:(0,C.jsx)(a.FormattedMessage,{defaultMessage:"Share feedback with Notion",id:"completions.CompletionMenuActionBar.feedbackTooltip"})}),placement:l.Z.Placement.Bottom,render:e=>(0,C.jsx)(o.Z,{onClick:M,icon:b,ariaLabel:s,style:{...v},...e})});return(0,C.jsx)(r.ZP,{origin:w,open:(null==u?void 0:u.type)===t,popupType:x.device.isMobile?r.kQ.SlideUp:r.kQ.Popup,onDismiss:m,render:()=>u?h?(0,C.jsx)(T,{onCancel:m,onSubmit:f}):(0,C.jsx)(I,{state:u,onSubmit:p,onUpdate:g,onCancel:m,userOptIn:y}):null})}},935:(e,t,s)=>{s.d(t,{L:()=>b,u:()=>M});var i=s(67294),n=s(480),a=s(86628),o=s(33676),r=s(97022),l=s(39986),d=s(10498),c=s(5366),u=s(50906),m=s(64964),p=s(39699),g=s(37181),h=s(80444),f=s(77080),y=s(35057),v=s(84254),x=s(16859),S=s(85893);function b(e,t){switch(e){case"thumbsup":return t?d.w:l.P;case"thumbsdown":return t?r.E:o.A}}function M(e){window.__c={n:"FeedbackButtons"};const{revision:t}=e,s=(0,c.useIntl)(),o=(0,n.O7)(),[r,l]=(0,i.useState)(void 0),[d,b]=(0,i.useState)(!1),M=(0,i.useRef)(null),w=(0,a.VK)((()=>f.default.checkGate("ai_data_sharing")),[]),j=(0,a.VK)((()=>h.default.state.currentUserSettingsStore),[]),C=(0,a.VK)((()=>{var e;const t=null==j||null===(e=j.getSettings())||void 0===e?void 0:e.seen_ai_data_share_prompt_at,s=!(0,y.mq)();return!Boolean(t)&&s}),[j]),k=(0,a.VK)((()=>{var e;return(null==j||null===(e=j.getSettings())||void 0===e?void 0:e.ai_data_share_opt_in)??false}),[j]),_=(0,i.useCallback)((()=>{m.oV({label:s.formatMessage({id:"completions.CompletionMenuFooter.showFeedbackThanksMessage",defaultMessage:"Thanks for submitting feedback!"})})}),[s]),T=(0,i.useCallback)((e=>{M.current=document.activeElement,l((t=>({userContent:"",shareWithNotion:true,...t,type:e})))}),[]),I=(0,i.useCallback)((e=>{e.shareWithNotion&&C&&w?b(!0):(_(),l(void 0)),v.submitFeedbackForRevision({...e,environment:o,revision:t,userOptIn:k})}),[t,o,k,C,w,_]),P=(0,i.useCallback)((e=>{e&&e.stopPropagation&&e.stopPropagation(),l(void 0),M.current&&M.current instanceof HTMLElement&&M.current.focus()}),[]),Z=(0,i.useCallback)((e=>{const{optIn:t}=e;j&&(p.createAndCommit({userAction:"FeedbackButtons.aiDataShareOptIn",environment:o,userId:j.id,perform:e=>{g.d2({userSettingsStore:j,data:{ai_data_share_opt_in:t,seen_ai_data_share_prompt_at:Date.now()},transaction:e})}}),u.bd0(o,{user_opt_in:t}),t?m.oV({label:s.formatMessage({id:"completions.CompletionMenuFooter.dataShareThanks",defaultMessage:"Thank you for your help making Notion better!"})}):_(),b(!1),l(void 0))}),[s,j,o,_]);return t.hasFeedback&&!d?null:(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(x.d,{type:"thumbsup",ariaLabel:s.formatMessage({id:"completions.CompletionMenuFooter.thumbsUp",defaultMessage:"Submit positive feedback"}),onClick:T,feedbackState:r,onDismiss:P,onSubmit:I,onUpdate:l,showShareDataPopup:d,onDataShareSubmit:Z,userOptIn:k}),(0,S.jsx)(x.d,{type:"thumbsdown",ariaLabel:s.formatMessage({id:"completions.CompletionMenuFooter.thumbsDown",defaultMessage:"Submit negative feedback"}),onClick:T,feedbackState:r,onDismiss:P,onSubmit:I,onUpdate:l,showShareDataPopup:d,onDataShareSubmit:Z,userOptIn:k})]})}},3043:(e,t,s)=>{s.d(t,{Qe:()=>a.Z,Yo:()=>n.Z,fY:()=>i.f});var i=s(87686),n=s(24946),a=s(7692)},41229:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(41892),l=s(64275),d=(s(1436),s(11751)),c=s(5366),u=s(82990),m=s(41752),p=s(12921),g=s(80444),h=s(55031),f=s(54119),y=s(42922),v=s(64921),x=s(61519),S=s(36488),b=(s(84076),s(50506)),M=s(64369),w=s(85893);const j=(0,c.injectIntl)((function(e){window.__c={n:"AiQnaIntroModal"};const[t,s]=(0,i.useState)(!1),j=(0,n.O7)(),C=(0,o.Fg)(),k=(0,i.useCallback)((()=>{const{currentUserSettingsStore:e}=g.default.state;e&&(0,m.C)(j,{userSettingsStore:e,phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickCancel"})}),[j]),_=(0,i.useCallback)((()=>{const{currentUserSettingsStore:e}=g.default.state;e&&(0,m.C)(j,{userSettingsStore:e,phase:"tooltip",transactionUserAction:"AiQnaIntroModal.debug.clickTryNow"})}),[j]),T=(0,a.VK)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:t,mainEditorCurrentBlockStore:s,inAppCalloutStore:i}=g.default.state;if(!i.canShow("ai_qna_alpha"))return!1;if(!e||!e.isReady())return!1;const n=e.getSettings();return!!n&&(!!(t&&s&&s.canRead())&&(!j.device.isMobile&&(!(void 0!==n.ai_qna_intro_onboarding_phase||!p.fG.showAiQnaOnboardingModalForAlphaLaunch())||void 0)))}),[j.device]);(0,i.useEffect)((()=>{s(!!T)}),[T]);const I=(0,a.VK)((()=>(0,h.y)(j,{theme:C,rightEdgeDistance:24,isInPeekRenderer:!1,width:48})),[j,C]),P=(0,i.useMemo)((()=>(0,d.t)({width:24,fill:C.accentColors.purple[400]})),[C]),Z=()=>{const{device:e,WindowSizeStore:t}=j;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(v.Z,{onClick:k,style:{position:"absolute",top:12,right:12,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:C.buttonHoveredBackground,width:18,height:18,marginTop:t.state.paddingTopCSS},hoveredStyle:{background:C.buttonPressedBackground},children:(0,l.D)({width:14,fill:C.mediumTextColor})}),(0,w.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",fontWeight:u.Z.fontWeight.bold,fontSize:28,margin:"0 auto",maxWidth:700,marginTop:46},children:[(0,w.jsx)(v.Z,{ariaLabel:"ai",className:"notion-ai-button",style:{...I,position:"initial",marginBottom:12},onClick:()=>{},children:P}),(0,w.jsx)(c.FormattedMessage,{defaultMessage:"<introducing>Introducing</introducing> <purple>Notion AI with Q&A</purple>",id:"AiIntroModal.title",values:{introducing:e=>(0,w.jsx)("div",{children:e}),purple:e=>(0,w.jsxs)("div",{style:{color:C.accentColors.purple[400],marginTop:-8,marginBottom:4},children:[e,(0,w.jsx)(f.Z,{message:(0,w.jsx)(c.FormattedMessage,{id:"AiQnaIntroModal.alphaLabel",defaultMessage:"Alpha"})})]})}})]}),(0,w.jsx)("div",{style:{width:"100%"},children:(0,w.jsx)(M.Z,{isSecondaryColor:!0,isMultiline:!0,style:{width:300,margin:"0 auto",textAlign:"center"},children:(0,w.jsx)(c.FormattedMessage,{defaultMessage:"Get instant answers to your questions, using information from across your workspace.",id:"AiIntroModal.caption"})})}),(0,w.jsx)("div",{style:{height:250,marginTop:24,marginBottom:24,textAlign:"center"},children:(0,w.jsx)("img",{src:r.Z.images.onboarding.qnaPng,style:{height:250}})}),!e.isPhone&&(0,w.jsx)(x.Z,{size:1}),(0,w.jsxs)("div",{style:{display:"flex",...!e.isPhone&&{margin:20,alignItems:"center"},...e.isPhone&&{margin:"0 auto",width:"max-content",marginBottom:24}},children:[(0,w.jsx)("div",{style:{flexGrow:1,color:C.mediumTextColor,fontSize:14},children:!1}),(0,w.jsx)(y.Z,{style:{height:32,minWidth:72},onClick:_,children:(0,w.jsx)(c.FormattedMessage,{defaultMessage:"Try it now",id:"AiIntroModal.nextMessage"})})]})]})};return(0,w.jsx)(b.Z,{open:t,innerStyle:{background:C.sidebarBackground,borderRadius:12,width:450},preventHideChildrenWhileOpening:!0,onDismiss:k,render:()=>(0,w.jsx)(S.Z,{capture:!0,allowEsc:!0,render:Z})})}))},87493:(e,t,s)=>{s.r(t),s.d(t,{default:()=>d});s(67294);var i=s(480),n=s(49386),a=s(87279),o=s(48019),r=s(78140),l=s(85893);const d=function(e){let{block:t,onAccept:s}=e;window.__c={n:"AliasBlockPopupMenu"};const d={blocks:[t],environment:(0,i.O7)(),publicEditMode:void 0};return(0,l.jsx)(r.Z,{menuType:a.og.Popup,children:(0,l.jsx)(o.Z,{sections:n.Qi,context:d,onAccept:s})})}},66309:(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(27328),r=s(24677),l=s(98104),d=s(95477),c=s(18514),u=s(34859),m=s(69454),p=s(36488),g=s(28451),h=s(50506),f=s(53437),y=s(53336),v=s(32662),x=s(85893);function S(e){window.__c={n:"AnnouncementModal"};const t=(0,i.O7)(),s=(0,a.Fg)(),S=(0,i.Fy)(),b=(0,n.VK)((()=>(0,c.__)(t)),[t]),M=(0,n.VK)((()=>t.TabbedRouterStore),[t.TabbedRouterStore]),w=(0,n.VK)((()=>(0,o.w_)(M.state)),[M]);let j=e.shouldShow&&!d.default.isAdminMode;const C=(0,n.VK)((()=>t.WindowSizeStore.isLandscape()),[t.WindowSizeStore]),k=(0,n.VK)((()=>{const e=m.Z.state.phase===m.i.hidden||m.Z.state.phase===m.i.willHide;let s=m.Z.estimatedNativeWebBottomOverlap();return S.isMobileBrowser&&(s+=32),e?t.WindowSizeStore.getSafePaddingBottomPx(s):s}),[S.isMobileBrowser,t.WindowSizeStore]);if(S.isPhone){if(b){var _;const e="web"===w.type&&((null===(_=w.redirectedTo)||void 0===_?void 0:_.route)||w.route);j=e&&"page"===e.name}function i(){var s;null===(s=e.onModalShow)||void 0===s||s.call(e),r.ZH(t),l.sD()}return(0,x.jsx)(g.g,{calloutId:e.calloutId,shouldShow:j,onShow:i,children:(0,x.jsx)(f.ZP,{open:!0,forceFullScreenSlideUp:!0,hidesMobileNativeBottomBar:!0,preventBlockRenderQueueOnEnter:!0,popupType:f.ZP.PopupType.SlideUp,style:{background:s.sidebarBackground,borderRadius:0,width:"100%",height:"100%",...e.mobileInnerStyle},render:()=>(0,x.jsxs)(y.Z,{type:u.Z.Y,style:{width:C?"80%":"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,x.jsx)(v.Z,{size:C?200:0}),e.mobileRenderInner(),(0,x.jsx)(v.Z,{size:k})]})})})}return(0,x.jsx)(g.g,{calloutId:e.calloutId,shouldShow:e.shouldShow,onShow:e.onModalShow,children:(0,x.jsx)(h.Z,{open:!0,preventHideChildrenWhileOpening:!0,onDismiss:e.desktopOnDismiss,innerStyle:{background:s.sidebarBackground,borderRadius:12,...e.desktopInnerStyle},render:()=>(0,x.jsx)(p.Z,{capture:!0,allowEsc:!0,render:e.desktopRenderInner})})})}},82243:(e,t,s)=>{s.r(t),s.d(t,{default:()=>td});var i=s(67294),n=s(480),a=s(86628),o=s(83355),r=s(5366),l=s(36488),d=s(78140),c=s(53437),u=s(43250),m=s(87279),p=s(77907),g=s(95306),h=s(34047),f=s(9080),y=s(85893);class v extends o.Z{constructor(){super(...arguments),this.renderDiscussion=()=>{const{device:e}=this.environment;if(f.Z.state.open){const{discussionStore:t,discussionInputStore:s,blockStore:i,discussionLocation:n}=f.Z.state;let a;return a=e.isMobile?{menuType:m.og.Modal,title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Comments",id:"discussion.mobileReplyMenu.title"}),right:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Close",id:"discussion.mobileReplyMenu.closeButton.label"}),onClickRight:()=>g.UZ(this.environment),whiteBackground:!0}:{menuType:m.og.Popup,width:420,maxWidth:e.isMobileBrowser?"80vw":"100%"},(0,y.jsx)(d.Z,{className:u.LoZ,...a,children:(0,y.jsx)(l.Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,y.jsx)(p.LazyDiscussion,{store:t,discussionInputStore:s,onDismiss:()=>g.UZ(this.environment),format:h.O2.Menu,isFirst:!0,isOnly:!0,discussionLocation:n,showResolveButtonByDefaultIfPossible:!0,blockStore:i})})})}}}renderComponent(){const{device:e}=this.environment,{open:t,rect:s}=f.Z.state;return(0,y.jsx)(c.ZP,{popupType:e.isMobile?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:t,originRect:s,placementToOrigin:c.ZP.Placement.Bottom,alignmentToOrigin:c.ZP.Alignment.Center,originGap:4,onDismiss:()=>g.UZ(this.environment),render:this.renderDiscussion})}}v.displayName="ReplyDiscussionMenu";const x=v;var S=s(72126),b=s(70203),M=s(50906),w=s(4727),j=s(39699),C=s(68056),k=s(31352),_=s(24666),T=s(72187),I=s(69783),P=(s(57658),s(8848)),Z=s(90902),F=s(15095),A=s(54153),D=s(73657),B=s(32163),R=s(43145),L=s(72495),N=s(70177),E=s(33929),O=s(29798),V=s(60682),U=s(24990),W=s(49085);const z="recentEmojis";class K extends W.default{getInitialState(){return{recentEmojis:[],loadEmojiCount:0}}cleanupSkinTonedRecents(e){const t=S.jj(F.p4(A.Z.get(z)).map((t=>void 0===e?t:F.Gb(t))));return A.Z.set(z,t.join("")),this.setState({...this.state,recentEmojis:t}),t}}const H=new K;var G=s(64921),q=s(31945),Y=s(1743),Q=s(3386),$=s(26388),X=s(98742),J=s(61766),ee=s(11059),te=s(37181),se=s(68894),ie=s(80444);function ne(){window.__c={n:"EmojiPickerSkinTonePicker"};const e=(0,a.VK)((()=>{var e;return null===(e=ie.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.emoji_picker_skin_tone}),[]),t=(0,n.O7)(),s=(0,a.qz)(void 0,J.Z);return(0,y.jsx)($.Z,{renderTooltip:()=>(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Select skin tone",id:"emojiPickerSkinTonePicker.selectSkinTone"}),placement:$.Z.Placement.Bottom,render:i=>(0,y.jsx)(q.ZP,{buttonPopupStore:s,popupType:q.Z4.Popup,renderOrigin:t=>(0,y.jsx)(se.DO,{icon:()=>(0,y.jsx)("div",{style:{paddingRight:6},children:void 0!==e?Z.YN[e]:"✋"}),style:{fontSize:20},...(0,X.Z)(t,i)}),render:s=>function(e){const{parent:t,environment:s,currentSkinTone:i}=e,n=Z.YN.map(((e,i)=>({key:e,action:()=>{t.close(),ae({environment:s,skinTone:i})},render:t=>(0,y.jsx)(re,{...t,insertEmoji:()=>{},emoji:e,variations:void 0,tooltip:void 0})})));return(0,y.jsx)(Y.Z,{capture:!0,allowEsc:!0,children:(0,y.jsx)(B.Z,{type:B.i.Horizontal,initialFocus:i,sections:[{key:"variations",render:e=>(0,y.jsx)("div",{style:{display:"flex",padding:4},...e}),items:n}]})})}({parent:s,environment:t,currentSkinTone:e}),...i})})}function ae(e){const{environment:t,skinTone:s}=e,{currentUserSettingsStore:i}=ie.default.state;i&&(void 0!==s&&H.cleanupSkinTonedRecents(s),j.createAndCommit({userAction:"mediaPicker.setEmojiSkinTone",environment:t,perform:e=>{te.d2({userSettingsStore:i,transaction:e,data:{emoji_picker_skin_tone:s}})}}))}class oe extends o.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:J.Z},this.renderEmojiWithVariations=()=>{const{emoji:e,focused:t}=this.props,{buttonPopupStore:s}=this.stores;return(0,y.jsx)(Q.Z,{capture:t,onEnter:this.handleOpenMenu,onEsc:this.handleCloseMenu,children:(0,y.jsx)(q.ZP,{buttonPopupStore:s,popupType:q.Z4.Popup,renderOrigin:e=>this.renderSingleEmoji(e),render:this.renderVariationMenu})},e)},this.renderSingleEmoji=e=>{const{emoji:t,focused:s,onClick:i,onMouseEnter:n,tooltip:a}=this.props,{fontSize:o}=this.getButtonStyles();return(0,y.jsx)($.Z,{allowHover:Boolean(a),renderTooltip:()=>a,closeDelay:0,disableTooltip:!a,render:a=>(0,y.jsx)(G.Z,{focused:s,onClick:i,...(0,X.Z)(e||{},(0,X.Z)({onMouseEnter:n},a)),ignoreLocalHoverState:!0,style:this.styles.emojiButton,children:(0,y.jsx)(ee.Z,{size:o,char:t})},t)})},this.renderVariationMenu=e=>{const{emoji:t,variations:s,insertEmoji:i}=this.props,n=(s&&s.length>0?[t,...s]:[t]).map(((t,n)=>({key:t,action:a=>{e.close(),(null==s?void 0:s.length)===Z.tN&&ae({environment:this.environment,skinTone:n}),i(t,n)},render:e=>(0,y.jsx)(oe,{...this.props,...e,emoji:t,variations:void 0})})));return(0,y.jsx)(Y.Z,{capture:!0,allowEsc:!0,children:(0,y.jsx)(B.Z,{type:B.i.Horizontal,initialFocus:0,sections:[{key:"variations",render:this.renderVariationWrapper,items:n}]})})},this.renderVariationWrapper=e=>(0,y.jsx)("div",{style:this.styles.variationMenu,...e}),this.handleOpenMenu=e=>{e.preventDefault();const{buttonPopupStore:t}=this.stores;t.setState({...t.state,open:!0})},this.handleCloseMenu=()=>{const{buttonPopupStore:e}=this.stores;e.setState({...e.state,open:!1})},this.styles={emojiButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3,...this.getButtonStyles()},variationMenu:{display:"flex",padding:4}}}renderComponent(){const{variations:e}=this.props;return void 0===(0,V.sg)()&&e&&e.length>0?this.renderEmojiWithVariations():this.renderSingleEmoji()}getButtonStyles(){const{device:e}=this.environment;return e.isMobile?{width:T.mz,height:T.mz,fontSize:T.jo}:{width:T.T8,height:T.T8,fontSize:T.WB}}}oe.displayName="EmojiPickerMenuItem";const re=oe,le=["💡","👉","☝","👌","🔑","🚧","⚠️","🔥","📌","✂️","❓","🚫","⛔","⏰","☎️","🚨","♻️","✅","🔒","📎","📖","🗣","➡️","📢","🛠","⚙"],de=(0,r.defineMessages)({noResults:{defaultMessage:"No results",id:"emojiPicker.noResults.message"}});var ce=!1;class ue extends o.Z{constructor(){super(...arguments),this.filter="",this.splitFilter=[],this.storeTypes={menuListStore:O.Z},this.insertEmoji=e=>{this.props.onSubmit(e),this.addToRecentEmojis(e),this.props.iconLoggingData&&M.fAb(this.environment,"pick_emoji",{icon:e,...this.props.iconLoggingData})},this.createCategory=e=>{let t=[];if(t="recent"===e.id?H.state.recentEmojis||[]:"callout"===e.id?le:U.Z.state.emojiByCategory[e.id]||[],this.filter&&(t=this.filterAndSortEmojis(t)),0!==t.length)return{key:e.id,items:t.map((e=>this.getTonedEmojiIfSkinToneSet(e))).map(this.createListItem),render:t=>(0,y.jsx)(L.Z,{isTitleUppercase:!0,title:e.title,children:(0,y.jsx)("div",{style:this.getEmojiSectionWrapStyle(),children:t.children})},t.key)}},this.createListItem=e=>{const t=F.Hk(e,U.Z.state),s=void 0===(0,V.sg)()?F.yS(e,U.Z.state):[];return{key:e,action:()=>{0===s.length&&this.insertEmoji(e)},render:i=>(0,y.jsx)(re,{...i,emoji:e,tooltip:t,variations:s,insertEmoji:this.insertEmoji})}},this.removeSkinToneModifierIfSkinToneSet=e=>void 0===(0,V.sg)()?e:F.Gb(e),this.getTonedEmojiIfSkinToneSet=e=>{var t;const s=(0,V.sg)(),i=void 0!==s&&0!==s,n=null===(t=F.yz(e,U.Z.state))||void 0===t?void 0:t.variations;return(null==n?void 0:n.length)===Z.tN&&i?n[s-1]:e},this.handleScroll=e=>{if(e<ue.loadMoreCategoryEdgeDistance){const{loadEmojiCount:e}=H.state,t=Math.max(this.getNumIconsPerRow()*this.getNumRowsPerPage(),this.getAllSectionsEmojiCount());H.setState({...H.state,loadEmojiCount:Math.min(t,e+this.getNumIconsPerRow()*this.getNumRowsPerPage())})}}}willMount(e){super.willMount(e),H.setState({...H.state,loadEmojiCount:this.getNumIconsPerRow()*this.getNumRowsPerPage()}),H.cleanupSkinTonedRecents((0,V.sg)()),this.loadEmojiData()}didUpdate(e){const{menuListStore:t}=this.stores;e.filter!==this.props.filter&&t.setState({...t.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}renderComponent(){const{menuListStore:e}=this.stores,t=this.getVisibleSections(this.getAllSections()),s=this.environment.device.isDesktop&&t.length>0?0:void 0;return 0===t.length&&(this.props.onNoResults&&this.props.onNoResults(),t.push({key:"no results",items:[{key:"no results",action:()=>{},render:(e,t)=>(0,y.jsx)(D.Z,{...e,caption:E.default.formatMessage(de.noResults)})}],render:e=>(0,y.jsx)(L.Z,{...e})})),(0,y.jsxs)("div",{style:ue.wrapStyle,children:[(0,y.jsx)("div",{style:{flexGrow:1},children:(0,y.jsx)(B.Z,{...this.getMenuListProps(),store:e,initialFocus:s,sections:t,disableKeyboardArrowWrap:!0,unfocusOnScroll:this.environment.device.isMobile})}),(0,y.jsx)(R.Z,{onChange:this.handleScroll})]})}getNumIconsPerRow(){var e,t;const{device:s,WindowSizeStore:i}=this.environment;return s.isPhone?(window.innerWidth-i.getSafePaddingLeftPx(T.$P)-i.getSafePaddingRightPx(T.qJ))/T.mz:s.isTablet?T.tg:null!==(e=this.props)&&void 0!==e&&null!==(e=e.menuRef)&&void 0!==e&&null!==(e=e.current)&&void 0!==e&&e.offsetWidth?((null===(t=this.props)||void 0===t||null===(t=t.menuRef)||void 0===t||null===(t=t.current)||void 0===t?void 0:t.offsetWidth)-2*T.PS)/T.T8:T.IQ}getNumRowsPerPage(){return this.environment.device.isMobile?T.pq:T.II}async loadEmojiData(){await(0,N.L)(),await this.loadUniqueKeywords()}async loadUniqueKeywords(){if(!ce){await U.Z.waitUntilLoaded();for(const t in U.Z.state.positionalEmojiData){var e;const s=null===(e=F.yz(t,U.Z.state))||void 0===e?void 0:e.keywords;s&&(Z.Q4[t]={...Z.Q4[t],uniqueKeywords:S.jj(s.flatMap((e=>e.split(" "))))})}ce=!0}}addToRecentEmojis(e){const t=A.Z.get(z),s=S.jj(S.G0([this.removeSkinToneModifierIfSkinToneSet(e)],F.p4(t))),i=S.qn(s,T.Nm*this.getNumIconsPerRow());A.Z.set(z,i.join("")),H.setState({...H.state,recentEmojis:i})}getAllSections(){this.filter=F.rJ(this.props.filter)??"",this.splitFilter=this.filter?this.filter.split(" ").filter(Boolean):[];const e=S.oA(this.getCategories().map(this.createCategory));return this.props.filter&&this.filter?this.getEmojiItemCount(e)>this.getNumIconsPerRow()*this.getNumRowsPerPage()/2?e:this.createFilteredSection():e}getAllSectionsEmojiCount(){const e=this.getAllSections();let t=0;for(const s of e)t+=s.items.length;return t}getEmojiItemCount(e){let t=0;for(const s of e)t+=s.items.length;return t}getVisibleSections(e){const{loadEmojiCount:t}=H.state,s=[];let i=0;for(const n of e){if(!(i+n.items.length<=t)){s.push({...n,items:n.items.slice(0,t-i)});break}s.push(n),i+=n.items.length}return s}getCategories(){return S.oA([!this.props.filter&&{id:"recent",title:(0,y.jsx)(r.FormattedMessage,{id:"emojiPicker.section.recent",defaultMessage:"Recent"})},this.props.isCallout?{id:"callout",title:(0,y.jsx)(r.FormattedMessage,{id:"emojiPicker.section.callout",defaultMessage:"Callout"})}:void 0,{id:"People & Body",title:(0,y.jsx)(r.FormattedMessage,{id:"emojiPicker.section.people",defaultMessage:"People"})},{id:"Animals & Nature",title:(0,y.jsx)(r.FormattedMessage,{id:"emojiPicker.section.animals",defaultMessage:"Animals and nature"})},{id:"Food & Drink",title:(0,y.jsx)(r.FormattedMessage,{id:"emojiPicker.section.food",defaultMessage:"Food and drink"})},{id:"Activities",title:(0,y.jsx)(r.FormattedMessage,{id:"emojiPicker.section.activity",defaultMessage:"Activity"})},{id:"Travel & Places",title:(0,y.jsx)(r.FormattedMessage,{id:"emojiPicker.section.travel",defaultMessage:"Travel and places"})},{id:"Objects",title:(0,y.jsx)(r.FormattedMessage,{id:"emojiPicker.section.objects",defaultMessage:"Objects"})},{id:"Symbols",title:(0,y.jsx)(r.FormattedMessage,{id:"emojiPicker.section.symbols",defaultMessage:"Symbols"})},{id:"Flags",title:(0,y.jsx)(r.FormattedMessage,{id:"emojiPicker.section.flags",defaultMessage:"Flags"})}])}filterAndSortEmojis(e){const{filter:t,splitFilter:s}=this,i=S.oA(e.map((e=>{const i=F.yz(e,U.Z.state),n=i&&i.keywords||[],a=t.length<3||t.includes(" ")?n:n.map((e=>e.replaceAll(" ",""))),o=a.findIndex((e=>e===`:${t}`));if(-1!==o)return[100-o,e];const r=a.findIndex((e=>e===t));if(-1!==r)return[10*(10-r),e];const l=a.findIndex((e=>e.startsWith(t)));if(-1!==l)return[10-l,e];if(s.length>1){const t=i&&i.uniqueKeywords||[];if(s.every((e=>t.find((t=>t.startsWith(e))))))return[s.length,e]}return a.some((e=>e.includes(t)))?[1,e]:void 0})));return S.MR(i,(e=>-e[0])).map((e=>e[1]))}createFilteredSection(){const e=this.filterAndSortEmojis(S.xH(this.getCategories().map((e=>U.Z.state.emojiByCategory[e.id]))));return 0===e.length?[]:[{key:"search-results",items:e.map((e=>this.getTonedEmojiIfSkinToneSet(e))).map(this.createListItem),render:e=>(0,y.jsx)(L.Z,{children:(0,y.jsx)("div",{style:this.getEmojiSectionWrapStyle(),children:e.children})},e.key)}]}getMenuListProps(){return{type:B.i.Grid,itemsPerRow:this.getNumIconsPerRow(),renderRow:(e,t)=>(0,y.jsx)("div",{style:ue.rowStyle,children:e},t)}}getEmojiSectionWrapStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",flexWrap:"wrap",alignItems:"flex-start",...e.isPhone?{background:this.theme.popoverBackground,paddingTop:10,paddingBottom:10,paddingLeft:t.getSafePaddingLeftCSS(T.$P),paddingRight:t.getSafePaddingRightCSS(T.qJ),boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,marginBottom:1}:{background:P.ZP.transparent,paddingLeft:e.isTablet?T.vP:T.PS,paddingRight:e.isTablet?T.vP:T.PS}}}}ue.displayName="EmojiPicker",ue.loadMoreCategoryEdgeDistance=100,ue.wrapStyle={display:"flex",flexDirection:"column"},ue.rowStyle={display:"flex"};const me=ue;class pe extends o.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=I.Z.state,s=i.createRef();if(!t.open)return;let n;return n=e.isMobileNative&&!e.isTablet?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:T.fG,maxHeight:T.VJ,onClickOutside:w.xv},(0,y.jsx)(d.Z,{innerRef:s,...n,children:(0,y.jsx)(me,{filter:this.getFilter(t)||"",onSubmit:this.handleSubmit,onNoResults:this.handleNoResults,isCallout:!1,menuRef:s})})},this.handleNoResults=()=>{const e=I.Z.state;if(!e.open)return;const t=this.getFilter(e);if(!t)return;const s=S.Z$(t);s&&(/\s/g.test(s)?w.xv():this.trackNoResultsDebounced(t))},this.trackNoResultsDebounced=S.Ds((e=>{M.VJs(this.environment,{searchQuery:e})}),500),this.handleSubmit=e=>{j.createAndCommit({userAction:"EmojiMenu.handleSubmit",environment:this.environment,perform:t=>{w.RL({environment:this.environment,emoji:e,transaction:t})}})},this.handleCancel=()=>{w.xv()}}willMountOrUpdate(){const e=I.Z.state;if(e.open){var t;const s=_.default.state,i=this.getFilter(e);if("editing"!==s.mode)return void w.xv();const n=b.eeV(s.multiSelection.start.store.getValue())[s.multiSelection.start.index-1];if(!i&&":"!==n)return void w.xv();((null===(t=(0,C.QY)(s.multiSelection))||void 0===t?void 0:t.store)!==e.textStore||void 0===i||":"===i||i.startsWith("\n")||i.startsWith(" "))&&w.xv()}}renderComponent(){const{device:e}=this.environment,t=I.Z.state;let s=!1;if(t.open){const e=this.getFilter(t);e&&e.length>0&&(s=!0),t.showPopupWithEmptyFilter&&(s=!0)}return(0,y.jsx)(c.ZP,{popupType:e.isMobileNative&&!e.isTablet?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:s,originRect:t.open?t.selectionRect:void 0,placementToOrigin:c.ZP.Placement.Bottom,alignmentToOrigin:c.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:this.handleCancel,render:this.renderMenu,keepFocus:!0})}getFilter(e){return k.zK(e.textStore,e.oldTextValue,!0)}}pe.displayName="EmojiMenu";const ge=pe;var he=s(95697),fe=s(35868);function ye(){window.__c={n:"MessageStoreDebugPanelWrapper"};return(0,a.VK)((()=>fe.Z.state.open),[],{debugName:"MessageStoreDebugPanelWrapper.isOpen"})?(0,y.jsx)(p.LazyMessageStoreDebugPanel,{}):null}var ve=s(19671),xe=s(13023),Se=s(41464),be=s(54564),Me=s(92650),we=s(24646),je=s(24229),Ce=s(41432),ke=s(65598),_e=s(34859),Te=s(865),Ie=s(72897),Pe=s(40721),Ze=s(3553),Fe=s(66957);const Ae=[je.u.Open,je.u.Resolved];class De extends o.Z{constructor(){super(...arguments),this.deepDiscussionsStores=this.createComputedStore((()=>{const{discussionIds:e}=this.props,{blockStore:t,recursivelyLoadAllDiscussions:s}=this.props;return ke.al(t,{recursivelyLoadAllDiscussions:s}).filter((t=>!e||e.includes(t.id)||(0,h.De)(t)))})),this.handleChangeTab=e=>{const t=je.Z.state;t.open&&je.Z.setState({...t,tab:Ae[e]})},this.handleBackspace=e=>{null==e||e.preventDefault(),be.LZ()}}renderComponent(){if((0,we.Sx)(this.environment))return null;const{device:e}=this.environment;let t;return t=e.isMobile?{menuType:m.og.Modal,title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Comments",id:"blockDiscussionMenu.mobileMenu.title"}),header:this.renderMenuHeader(),right:(0,y.jsx)(Pe.DoneMenuText,{}),onClickRight:be.LZ,whiteBackground:!0}:{menuType:m.og.Popup,header:this.renderMenuHeader(),width:480,maxHeight:"50vh",onClickOutside:be.LZ},(0,y.jsx)(Ie.Z,{capture:!0,preventType:_e.Z.All,children:(0,y.jsx)(l.Z,{capture:!0,allowMobileAutoScroll:!0,render:()=>(0,y.jsx)(Q.Z,{capture:!0,onEsc:be.LZ,onBackspace:this.handleBackspace,onDelete:this.handleBackspace,children:(0,y.jsx)(Ze.Z,{store:this.props.blockStore,droppable:!0,render:()=>(0,y.jsx)(d.Z,{...t,children:this.renderMenuContent()})},this.props.blockStore.id)})})})}renderMenuHeader(){const{device:e}=this.environment,{resolved:t,unresolved:s}=ke.bB(this.deepDiscussionsStores.state),i=s.length,n=t.length;return 0===n||0===i?null:(0,y.jsx)(Fe.Z,{tabs:[(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Open ({numberOfOpenDiscussions})",id:"blockDiscussionMenu.openDiscussionsTab.title",values:{numberOfOpenDiscussions:i}},"openDiscussions"),(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Resolved ({numberOfResolvedDiscussions})",id:"blockDiscussionMenu.resolvedDiscussionsTab.title",values:{numberOfResolvedDiscussions:n}},"resolvedDiscussions")],selectedIndex:Ae.indexOf(this.props.tab),onChange:this.handleChangeTab,style:{...e.isAndroid&&{borderBottom:"none"}}})}renderMenuContent(){const{device:e}=this.environment,{resolved:t,unresolved:s}=ke.bB(this.deepDiscussionsStores.state);if(this.props.tab===je.u.Open){if(s.length){const t=s.map(((e,t,s)=>(0,y.jsx)(p.LazyDiscussion,{store:e,format:h.O2.Menu,isFirst:0===t,isOnly:1===s.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:this.props.blockStore,onDismiss:be.LZ},e.id))),n=this.props.blockStore.getType(),a=n&&Ce.p2[n];if(e.isMobile&&a){const e=Te.h(this.props.blockStore);return e?(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)("div",{style:{padding:"12px 16px",boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,marginBottom:1},children:(0,y.jsx)(e,{store:this.props.blockStore,disabled:!0,hideContent:!0,style:{fontSize:14,pointerEvents:"none"},isQuickFind:!0})}),t]}):t}return t}return this.renderEmptyState((0,y.jsx)(r.FormattedMessage,{defaultMessage:"No comments to show.",id:"blockDiscussionMenu.emptyState.noCommentsMessage"}))}return t.length?t.map(((e,t,s)=>(0,y.jsx)(p.LazyDiscussion,{store:e,format:h.O2.Menu,isFirst:0===t,isOnly:1===s.length,discussionLocation:"block_menu",showResolveButtonByDefaultIfPossible:!0,blockStore:this.props.blockStore,onDismiss:be.LZ},e.id))):this.renderEmptyState((0,y.jsx)(r.FormattedMessage,{defaultMessage:"No resolved comments.",id:"blockDiscussionMenu.emptyState.noResolvedCommentsMessage"}))}renderEmptyState(e){const{device:t}=this.environment;return(0,y.jsx)("div",{style:{textAlign:"center",padding:t.isMobile?"64px 18px":"32px 18px 36px",fontSize:14,color:this.theme.mediumTextColor},children:e})}}De.displayName="BlockDiscussionMenu";const Be=De;const Re=function(){window.__c={n:"BlockDiscussionMenuPopup"};const e=(0,n.O7)(),{device:t}=e,s=(0,a.VK)((()=>je.Z.state.rect),[]),o=(0,a.VK)((()=>!(0,we.Sx)(e)&&je.Z.state.open&&!(0,Me.az)(e,je.Z.state.blockStore)),[e]),r=(0,i.useCallback)((()=>{if(je.Z.state.open&&!(0,we.Sx)(e))return(0,y.jsx)(Be,{rect:je.Z.state.rect,tab:je.Z.state.tab,blockStore:je.Z.state.blockStore,discussionIds:je.Z.state.discussionIds,recursivelyLoadAllDiscussions:je.Z.state.recursivelyLoadAllDiscussions})}),[e]);return(0,y.jsx)(c.ZP,{popupType:t.isMobile?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:o,originRect:s,placementToOrigin:c.ZP.Placement.Bottom,alignmentToOrigin:c.ZP.Alignment.Center,disableMouseCapture:!0,originGap:4,render:r,preventScaleTransition:!0,preventOpacityTransition:!0,onDismiss:be.LZ})};var Le=s(29369),Ne=s(97880),Ee=s(49386);const Oe=[{key:"block in comment menu primary",render:e=>(0,y.jsx)(L.Z,{...e}),actions:[s(35067).G,Ee.yN,Ee.TH]}];var Ve=s(63923),Ue=s(82763),We=s(34658);const ze=[{key:"page mention context menu primary",render:e=>(0,y.jsx)(L.Z,{isTitleUppercase:!1,...e}),actions:[We.sN,We.Jw,We.KB,We.oL,Ue.K,Ue.H]}];var Ke=s(6404),He=s(28020),Ge=s(75079),qe=s(18514),Ye=s(35328),Qe=s(40745),$e=s(37652),Xe=s(33907),Je=s(8597),et=s(80988),tt=s(53465),st=s(88437),it=s(77734),nt=s(73599),at=s(37612),ot=s(62967),rt=s(41216),lt=s(19037),dt=s(80025),ct=s(98794);const ut=(0,r.defineMessages)({simpleTableHeaderColumn:{id:"action.rowHeader.title",defaultMessage:"Header column"},simpleTableHeaderRow:{id:"action.columnHeader.title",defaultMessage:"Header row"},simpleTableInsertColumnLeft:{id:"action.insertColumnLeft.title",defaultMessage:"Insert Left"},simpleTableInsertColumnRight:{id:"action.insertColumnRight.title",defaultMessage:"Insert Right"},simpleTableClearContents:{id:"action.clearContents.title",defaultMessage:"Clear Contents"},simpleTableInsertRowAbove:{id:"action.insertRowAbove.title",defaultMessage:"Insert Above"},simpleTableInsertRowBelow:{id:"action.insertRowBelow.title",defaultMessage:"Insert Below"},textColorSection:{id:"action.section.textColor",defaultMessage:"Text Color"},backgroundColorSection:{id:"action.section.backgroundColor",defaultMessage:"Background Color"}}),mt=(0,ot.wL)({key:"simple table header column",displayName:ut.simpleTableHeaderColumn,label:E.default.formatMessage(ut.simpleTableHeaderColumn),property:"table_block_row_header",svg:it.s,validators:[lt.J5,lt.ff(lt.b4),lt.W5,lt.p4],afterAction:(e,t)=>{}}),pt=(0,ot.wL)({key:"simple table header row",displayName:ut.simpleTableHeaderRow,label:E.default.formatMessage(ut.simpleTableHeaderRow),property:"table_block_column_header",svg:nt.f,validators:[lt.J5,lt.ff(lt.b4),lt.W5,lt.zO],afterAction:(e,t)=>{}}),gt=(0,ot.cN)({key:"insert column left",displayName:ut.simpleTableInsertColumnLeft,analyticsName:ut.simpleTableInsertColumnLeft.defaultMessage,svg:$e.V,validators:[lt.J5,lt.ff(lt.fI),lt.W5,lt.z2],closeParentMenu:!0,action:e=>{let{environment:t}=e;j.createAndCommit({userAction:"actionRegistry.insertColumnLeft",environment:t,perform:e=>{ct.insertColumnLeft({environment:t,transaction:e})}})}}),ht=(0,ot.cN)({key:"insert column right",displayName:ut.simpleTableInsertColumnRight,analyticsName:ut.simpleTableInsertColumnRight.defaultMessage,svg:Xe.n,validators:[lt.J5,lt.ff(lt.fI),lt.W5,lt.z2],closeParentMenu:!0,action:e=>{let{environment:t}=e;j.createAndCommit({userAction:"actionRegistry.insertColumnRight",environment:t,perform:e=>{ct.insertColumnRight({environment:t,transaction:e})}})}}),ft=(0,ot.cs)({key:"duplicate columns",displayName:ot.RE.duplicateName,analyticsName:ot.RE.duplicateName.defaultMessage,svg:st.a,validators:[lt.J5,lt.ff(lt.fI),lt.W5,lt.z2],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;j.createAndCommit({userAction:"actionRegistry.duplicateColumns",environment:t,perform:e=>{ct.duplicateColumns({transaction:e})}})}}),yt=(0,ot.cs)({key:"delete columns",displayName:ot.RE.deleteName,analyticsName:ot.RE.deleteName.defaultMessage,svg:at.y,validators:[lt.J5,lt.ff(lt.fI),lt.W5,lt.OT,lt.z2],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;j.createAndCommit({userAction:"actionRegistry.deleteColumns",environment:t,perform:e=>{ct.deleteColumns({environment:t,transaction:e})}})}}),vt=(0,ot.cN)({key:"clear column contents",displayName:ut.simpleTableClearContents,analyticsName:ut.simpleTableClearContents.defaultMessage,svg:tt.X,validators:[lt.J5,lt.ff(lt.fI),lt.W5,lt.z2],closeParentMenu:!0,action:e=>{let{environment:t}=e;j.createAndCommit({userAction:"actionRegistry.clearColumnContents",environment:t,perform:e=>{ct.clearSelectionContents({environment:t,transaction:e})}}),ct.clearSelection()}}),xt=(0,ot.cN)({key:"insert row above",displayName:ut.simpleTableInsertRowAbove,analyticsName:ut.simpleTableInsertRowAbove.defaultMessage,svg:Je.Z,validators:[lt.J5,lt.ff(lt.fI),lt.W5,lt.EJ],closeParentMenu:!0,action:e=>{let{environment:t}=e;j.createAndCommit({userAction:"actionRegistry.insertRowAbove",environment:t,perform:e=>{ct.insertRowAbove({environment:t,transaction:e})}})}}),St=(0,ot.cN)({key:"insert row below",displayName:ut.simpleTableInsertRowBelow,analyticsName:ut.simpleTableInsertRowBelow.defaultMessage,svg:Qe.M,validators:[lt.J5,lt.ff(lt.fI),lt.W5,lt.EJ],closeParentMenu:!0,action:e=>{let{environment:t}=e;j.createAndCommit({userAction:"actionRegistry.insertRowBelow",environment:t,perform:e=>{ct.insertRowBelow({environment:t,transaction:e})}})}}),bt=(0,ot.cs)({key:"duplicate rows",displayName:ot.RE.duplicateName,analyticsName:ot.RE.duplicateName.defaultMessage,svg:st.a,validators:[lt.J5,lt.ff(lt.fI),lt.W5,lt.EJ],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;j.createAndCommit({userAction:"actionRegistry.duplicateRows",environment:t,perform:e=>{ct.duplicateRows({environment:t,transaction:e})}})}}),Mt=(0,ot.cs)({key:"delete rows",displayName:ot.RE.deleteName,analyticsName:ot.RE.deleteName.defaultMessage,svg:at.y,validators:[lt.J5,lt.ff(lt.fI),lt.W5,lt.W3,lt.EJ],shortcuts:["delete","backspace"],closeParentMenu:!0,action:e=>{let{environment:t}=e;j.createAndCommit({userAction:"actionRegistry.deleteRows",environment:t,perform:e=>{ct.deleteRows({environment:t,transaction:e})}})}}),wt=(0,ot.cN)({key:"clear row contents",displayName:ut.simpleTableClearContents,analyticsName:ut.simpleTableClearContents.defaultMessage,svg:tt.X,validators:[lt.J5,lt.ff(lt.fI),lt.W5,lt.EJ],closeParentMenu:!0,action:e=>{let{environment:t}=e;j.createAndCommit({userAction:"actionRegistry.clearRowContents",environment:t,perform:e=>{ct.clearSelectionContents({environment:t,transaction:e})}}),ct.clearSelection()}}),jt=[lt.J5,lt.ff(lt.fI),lt.W5,lt.z2],Ct=[lt.J5,lt.ff(lt.fI),lt.W5,lt.EJ];function kt(e,t,s,i){const n=i||(0,dt.qf)(e),a=(0,ot.cN)({key:`color ${s||e}`,displayName:n,analyticsName:n.defaultMessage,fuzzySearchKeywords:(0,ot.CJ)(e),validators:"column"===t?jt:Ct,action:t=>{let{blocks:s,environment:i}=t;j.createAndCommit({userAction:"actionRegistry.createSimpleTableColorAction",environment:i,perform:t=>{ct.setColor(i,e,t)}})},closeParentMenu:!0,render:t=>(0,y.jsx)(rt.Z,{...t,color:e,overrideDisplayName:a.displayName}),nativeRender:t=>{let{environment:i}=t;return(0,ot.fi)(i,e,s)}});return a}const _t=(0,ot.$J)({key:"simple table column background color actions",title:ot.RE.backgroundSection,overrideSearchTitle:ot.RE.backgroundSectionKeywords,render:e=>(0,y.jsx)(L.Z,{...e}),actions:[kt("default","column","default background",dt.mF.backgroundColorDefault),...P._K.map((e=>kt(e,"column")))]}),Tt=(0,ot.$J)({key:"simple table column text color actions",title:ot.RE.colorSection,overrideSearchTitle:ot.RE.colorSection,render:e=>(0,y.jsx)(L.Z,{...e}),actions:[...P.CY.map((e=>kt(e,"column")))]}),It=(0,ot.$J)({key:"simple table row background color actions",title:ot.RE.backgroundSection,overrideSearchTitle:ot.RE.backgroundSectionKeywords,render:e=>(0,y.jsx)(L.Z,{...e}),actions:[kt("default","row","default background",dt.mF.backgroundColorDefault),...P._K.map((e=>kt(e,"row")))]}),Pt=(0,ot.$J)({key:"simple table row text color actions",title:ot.RE.colorSection,overrideSearchTitle:ot.RE.colorSection,render:e=>(0,y.jsx)(L.Z,{...e}),actions:[...P.CY.map((e=>kt(e,"row")))]}),Zt=(0,ot.MV)({key:"set column color",displayName:ot.RE.colorName,analyticsName:ot.RE.colorName.defaultMessage,svg:et.U,validators:jt,subActions:()=>[{key:0,title:E.default.formatMessage(ut.textColorSection),render:e=>(0,y.jsx)(L.Z,{...e}),actions:Tt.actions},{key:1,title:E.default.formatMessage(ut.backgroundColorSection),render:e=>(0,y.jsx)(L.Z,{...e}),actions:_t.actions}]}),Ft=(0,ot.MV)({key:"set row color",displayName:ot.RE.colorName,analyticsName:ot.RE.colorName.defaultMessage,svg:et.U,validators:Ct,subActions:()=>[{key:0,title:E.default.formatMessage(ut.textColorSection),render:e=>(0,y.jsx)(L.Z,{...e}),actions:Pt.actions},{key:1,title:E.default.formatMessage(ut.backgroundColorSection),render:e=>(0,y.jsx)(L.Z,{...e}),actions:It.actions}]}),At=[(0,ot.$J)({key:"column section",render:e=>(0,y.jsx)(L.Z,{...e}),actions:[mt,Zt,gt,ht,ft,vt,yt]}),(0,ot.$J)({key:"row section",render:e=>(0,y.jsx)(L.Z,{...e}),actions:[pt,Ft,xt,St,bt,wt,Mt]})];var Dt=s(8949),Bt=s(90106),Rt=s(27724),Lt=s(13713),Nt=s(80209),Et=s(48019),Ot=s(83182);class Vt extends o.Z{constructor(){super(...arguments),this.renderOverlay=()=>{const{device:e}=this.environment,t=Dt.Z.state;if(!t.isActive)return;const{originBlockRect:s,actionSectionGroupKey:i,inputValue:n,publicEditMode:a}=t,o={environment:this.environment,blocks:t.stores,originRect:s,publicEditMode:a},l=t.showInput&&this.renderInputSection(),c=t.stores[0];let u;return u=e.isPhone?{menuType:m.og.Modal,title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Actions",id:"blockMenu.actionButton.label"}),right:(0,y.jsx)(Pe.DoneMenuText,{}),onClickRight:this.handleOverlayBgClick,header:l}:{menuType:m.og.Popup,width:265,header:l},(0,y.jsx)(Q.Z,{capture:!0,onBackspace:S.yR,children:(0,y.jsxs)(d.Z,{...u,children:[(0,y.jsx)(Et.Z,{filter:n,context:o,sections:Ut(i),onAccept:this.handleAccept,initialFocus:n?0:void 0}),!n&&this.renderBlockAuthorInfo(),!n&&(0,y.jsx)(Nt.Z,{store:c}),!n&&c.isCollectionView()&&this.renderCollectionHelpButton()]})})},this.handleOverlayBgClick=()=>{Ke.xv()},this.handleAccept=e=>{const t=Dt.Z.state;if(!t.isActive)return;const{stores:s}=Rt.default.state,{analyticsFrom:i,collectionContextStore:n}=t,a=s[0];if(a){const t=a.getParentTable(),s=a.getType();if(s&&t){let o;if(t===Le.e0){const e=a.getParentId(),{currentSpaceStore:t}=ie.default.getState();t&&void 0!==e&&(o=Bt.zX.createChildStore(t,{table:Le.e0,id:e}))}const r=(0,Ge.Pn)(n)||{};M.dhV(this.environment,{analyticsName:e.analyticsName,from:i,block_id:a.id,block_type:s,parentTeamStore:o,is_toggleable:(0,Ye._A)(s,a.getFormat()),...r})}}e.closeParentMenu&&Ke.xv()},this.handleInputChange=e=>{Dt.Z.state.isActive&&Dt.Z.setState({...Dt.Z.state,inputValue:e.target.value})}}renderComponent(){const{device:e}=this.environment,t=Dt.Z.state;return(0,y.jsx)(c.ZP,{popupType:e.isPhone?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originBlockRect:void 0,onDismiss:this.handleOverlayBgClick,placementToOrigin:c.ZP.Placement.Bottom,alignmentToOrigin:c.ZP.Alignment.Start,originGap:0,preventScaleTransition:!0,render:this.renderOverlay,preventBlockRenderQueueOnEnter:e.isMobile})}renderBlockAuthorInfo(){const e=Dt.Z.state;if(this.environment.currentUser.isLoggedIn()&&e.isActive&&!(e.stores.length>1)&&(1!==e.stores.length||!(0,He.qG)(e.stores[0].id)))return(0,y.jsx)(Lt.Z,{store:e.stores[0],isPageMoreButton:!1})}renderInputSection(){const{device:e}=this.environment,{intl:t}=this.props,s=Dt.Z.state;if(!s.isActive||e.isPhone)return;const{inputValue:i}=s;return(0,y.jsx)(L.Z,{isInput:!0,children:(0,y.jsx)(se.ZP,{value:i,onChange:this.handleInputChange,focus:!0,focusAfterAnimation:!0,placeholder:t.formatMessage({defaultMessage:"Search actions…",id:"blockMenu.filterForActions.placeholder"}),preventCaptureDeleteWhenEmpty:!0})})}renderCollectionHelpButton(){return(0,y.jsx)(L.Z,{topBorder:!0,children:(0,y.jsx)(Ot.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.blockMenu.collectionHelpButton"}),href:(0,qe.UY)("guides.database"),analyticsFrom:"block_menu"})})}}function Ut(e){switch(e){case"default":return Ee.Qi;case"simple_table":return At;case"page_mention":return ze;case"sidebar_outliner":return Ve.Oq;case"comment_media":return Oe;default:(0,Ne.t1)(e)}}Vt.displayName="BlockMenu";const Wt=(0,r.injectIntl)(Vt);var zt=s(62965),Kt=s(79554),Ht=s(61207),Gt=s(52275);const qt=(0,r.defineMessages)({createTransclusion:{defaultMessage:"Paste and sync",id:"blockPasteMenu.actions.createTransclusion.title"},linkToPage:{defaultMessage:"Link to page",id:"blockPasteMenu.actions.linkToPage.title"},dismissItem:{defaultMessage:"Dismiss",id:"blockPasteMenu.actions.dismiss.title"}});class Yt extends o.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=Ht.Z.state;if(!t.open)return;const s=this.getSections(t);let i;return i=e.isMobile?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:320,maxHeight:"40vh"},(0,y.jsx)(d.Z,{...i,className:u.srZ,children:(0,y.jsx)(B.Z,{type:B.i.Vertical,sections:s,initialFocus:0})})},this.handleDismiss=()=>{Kt.xv()}}willMountOrUpdate(){const e=Ht.Z.state;if(e.open){const{stores:t,phase:s}=Rt.default.state;(0,zt.Z)(t,e.blocks)&&s===Rt.SelectionPhase.Selected||Kt.xv()}}renderComponent(){const{device:e}=this.environment,t=Ht.Z.state;return(0,y.jsx)(c.ZP,{popupType:e.isMobileNative&&!e.isTablet?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.rect:void 0,placementToOrigin:c.ZP.Placement.Bottom,alignmentToOrigin:c.ZP.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDismiss})}getSections(e){const{blocks:t}=e,{currentSpaceStore:s}=ie.default.state,i=[];if("blocks"===e.type){const{copiedStores:n,pageSource:a}=e;Kt.H8({currentSpaceId:null==s?void 0:s.id,blocks:t,copiedStores:n})&&i.push({name:E.default.formatMessage(qt.createTransclusion),action:async()=>{await Kt.ry({environment:this.environment,blocks:t,copiedBlockIds:n.map((e=>e.id))})}}),Kt.wK({blocks:t})&&i.push({name:E.default.formatMessage(qt.linkToPage),action:async()=>Kt.Dq({environment:this.environment,blocks:t,source:{type:"blocks",copiedStores:n,pageSource:a}})})}"links"===e.type&&i.push({name:E.default.formatMessage(qt.linkToPage),action:async()=>Kt.Dq({environment:this.environment,blocks:t,source:{type:"links",copiedLinks:e.copiedLinks}})});return[{key:"embed section",render:e=>(0,y.jsx)(L.Z,{...e}),items:[{key:"dismiss",render:e=>(0,y.jsx)(Gt.Z,{...e,title:E.default.formatMessage(qt.dismissItem)}),action:this.handleDismiss},...i.map((e=>{let{name:t,action:s}=e;return{key:`embed ${t}`,render:e=>(0,y.jsx)(Gt.Z,{...e,title:t}),action:s}}))]}]}}Yt.displayName="BlockPasteMenu";const Qt=Yt;var $t=s(87143),Xt=s(74194),Jt=s(64369);class es extends o.Z{constructor(){super(...arguments),this.handleOverlayBgClick=e=>{$t.Z.setState({...$t.Z.state,active:!1,stringValue:""})}}renderComponent(){const{device:e}=this.environment,{active:t,stringValue:s}=$t.Z.state,i=window.innerWidth/2-150,n=window.innerHeight/2,a=e.isMobileNative?(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Tap to copy the link above",id:"clipboardInputRenderer.copyLink.mobile_message"}):(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Right click and copy the link above",id:"clipboardInputRenderer.copyLink.message"});return(0,y.jsx)(c.ZP,{popupType:e.isMobileNative?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:t,originRect:{top:n,left:i},onDismiss:this.handleOverlayBgClick,placementToOrigin:c.ZP.Placement.Bottom,alignmentToOrigin:c.ZP.Alignment.Start,originGap:0,render:()=>(0,y.jsx)(Q.Z,{capture:!0,onEnter:S.yR,onCommandEnter:S.yR,onCommandShiftEnter:S.yR,onCommandSlash:S.yR,onDelete:S.yR,onBackspace:S.yR,onEsc:S.yR,onLeft:S.yR,onRight:S.yR,onUntab:S.yR,onTab:S.yR,onSelectAll:S.yR,onRedo:S.yR,onUndo:S.yR,onToggleBold:S.yR,onToggleItalics:S.yR,onToggleStrike:S.yR,onToggleCode:S.yR,onCut:S.yR,onCopy:S.yR,onPaste:S.yR,onKeypress:S.yR,children:(0,y.jsxs)("div",{style:{padding:8,width:300},children:[(0,y.jsx)(Xt.Z,{style:{width:"100%",fontSize:12},value:s,focus:!0,textarea:!0,selectAll:!0,readOnly:!0}),(0,y.jsx)(Jt.Z,{isSmall:!0,style:{marginTop:6,pointerEvents:"none"},children:a})]})})})}}es.displayName="ClipboardInputRenderer";const ts=es;var ss=s(11977),is=s(14131),ns=s(7337),as=s(29193),os=s(40506),rs=s(67133),ls=s(9953),ds=s(28748);class cs extends o.Z{constructor(){super(...arguments),this.handleChangeValue=e=>{if(!e)return void this.removeDateAnnotation();if(!os.U3(e))return;const t=this.getEverythingIWant();if(!t)return;const{date_format:s,time_format:i}=t;this.setDateAnnotationData({date_format:s,time_format:i,...e})},this.handleChangeDateFormat=e=>{const t=this.getEverythingIWant();if(!t)return;const{dateValue:s,time_format:i}=t;this.setDateAnnotationData({date_format:e,time_format:i,...s})},this.handleChangeTimeFormat=e=>{const t=this.getEverythingIWant();if(!t)return;const{dateValue:s,date_format:i}=t;this.setDateAnnotationData({date_format:i,time_format:e,...s})},this.setDateAnnotationData=e=>{const t=this.getEverythingIWant();if(!t)return;const{textStore:s,textValue:i,tokenIndex:n,annotations:a}=t,o=i.map(((t,s)=>{if(s===n){const s=a.map((t=>b.fpG(t)?["d",e]:t));return b.V3y(t[0],s)}return t}));j.createAndCommit({userAction:"DateMentionMenu.setDateAnnotationData",environment:this.environment,perform:e=>{ls.sO({store:s,value:o,transaction:e})}})},this.removeDateAnnotation=()=>{const e=this.getEverythingIWant();if(!e)return;const{textStore:t,textValue:s,tokenIndex:i}=e,n=s.filter(((e,t)=>t!==i));j.createAndCommit({userAction:"DateMentionMenu.removeDateAnnotation",environment:this.environment,perform:e=>{ls.sO({store:t,value:n,transaction:e})}})}}renderComponent(){const{device:e}=this.environment,t=ds.Z.state;return(0,y.jsx)(c.ZP,{popupType:e.isMobile?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:t.open,originRect:t.originRect,onDismiss:rs.x,render:()=>{const e=this.getEverythingIWant();if(!e)return null;const{date_format:s,time_format:i,dateValue:n}=e;return(0,y.jsx)(p.DependencyConsumer,{dependency:p.deps.menus,children:e=>{let{DatePropertyMenu:a}=e;return(0,y.jsx)(a,{firstDayOfWeek:He.AK.state,value:n,canConfigureCollection:!0,onChangeValue:this.handleChangeValue,dateFormat:s,onChangeDateFormat:this.handleChangeDateFormat,timeFormat:i,onChangeTimeFormat:this.handleChangeTimeFormat,onDismiss:rs.x,disabled:!1,shouldShowReminder:!!t.open&&t.allowReminders,isTemplatePage:!1})}})}})}getEverythingIWant(){const e=ds.Z.state;if(e.open){const{textStore:t,tokenIndex:s}=e,i=t.getValue();if(i){const e=i[s];if(e){const n=b.hDy(e),a=b.K9C(n);if(a){const{date_format:o,time_format:r,...l}=b.zyO(a);return{textStore:t,textValue:i,tokenIndex:s,token:e,annotations:n,date_format:o,time_format:r,dateValue:l}}}}}}}cs.displayName="DateMentionMenu";const us=cs;s(30541);var ms=s(95538),ps=s(515),gs=s(21202),hs=s(63143),fs=s(89951),ys=s(95477),vs=s(64233),xs=s(88923);const Ss=(0,r.defineMessages)({image:{defaultMessage:"Embed image",id:"embedMenu.action.image"},video:{defaultMessage:"Embed video",id:"embedMenu.action.video"},tweet:{defaultMessage:"Embed Tweet",id:"embedMenu.action.tweet"},drive:{defaultMessage:"Embed Google Drive",id:"embedMenu.action.drive"},gist:{defaultMessage:"Embed GitHub Gist",id:"embedMenu.action.gist"},figma:{defaultMessage:"Embed Figma",id:"embedMenu.action.figma"},invision:{defaultMessage:"Embed Invision project",id:"embedMenu.action.invision"},abstract:{defaultMessage:"Embed Abstract project",id:"embedMenu.action.abstract"},framer:{defaultMessage:"Embed Framer prototype",id:"embedMenu.action.framer"},whimsical:{defaultMessage:"Embed Whimsical board",id:"embedMenu.action.whimsical"},mixpanel:{defaultMessage:"Embed Mixpanel project",id:"embedMenu.action.mixpanel"},sketch:{defaultMessage:"Embed Sketch document",id:"embedMenu.action.sketch"},excalidraw:{defaultMessage:"Embed excalidraw",id:"embedMenu.action.excalidraw"},replit:{defaultMessage:"Embed a repl",id:"embedMenu.action.replit"},miro:{defaultMessage:"Embed Miro board",id:"embedMenu.action.miro"},audio:{defaultMessage:"Embed audio",id:"embedMenu.action.audio"},maps:{defaultMessage:"Embed Google Map",id:"embedMenu.action.maps"},loom:{defaultMessage:"Embed Loom",id:"embedMenu.action.loom"},typeform:{defaultMessage:"Embed Typeform",id:"embedMenu.action.typeform"},codepen:{defaultMessage:"Embed CodePen",id:"embedMenu.action.codepen"},pdf:{defaultMessage:"Embed PDF",id:"embedMenu.action.pdf"},embed:{defaultMessage:"Create embed",id:"embedMenu.action.createEmbed"},hex:{defaultMessage:"Embed Hex",id:"embedMenu.action.hex"},deepnote:{defaultMessage:"Embed Deepnote",id:"embedMenu.action.deepnote"},drawing:{defaultMessage:"Embed a drawing",id:"embedMenu.action.drawing"}}),bs=(0,r.defineMessages)({linkToPage:{defaultMessage:"Link to page",id:"embedMenu.actions.linkToPage.title"},mentionPage:{defaultMessage:"Mention page",id:"embedMenu.actions.mentionPage.title"},mentionBlock:{defaultMessage:"Mention block",id:"embedMenu.actions.mentionBlock.title"},createLinkedDatabase:{defaultMessage:"Create linked database",id:"embedMenu.actions.createLinkedDatabase.title"},createLinkedViewOfDatabase:{defaultMessage:"Create linked view of database",id:"embedMenu.actions.createLinkedViewOfDatabase.title"},bookmarkMenuItem:{defaultMessage:"Create bookmark",id:"embedMenu.actions.createBookmark.title"},createTransclusionItem:{defaultMessage:"Paste and sync",id:"embedMenu.actions.createTransclusion.title"},dismissItem:{defaultMessage:"Dismiss",id:"embedMenu.actions.dismiss.title"}}),Ms={image:E.default.formatMessage(Ss.image),video:E.default.formatMessage(Ss.video),tweet:E.default.formatMessage(Ss.tweet),drive:E.default.formatMessage(Ss.drive),gist:E.default.formatMessage(Ss.gist),figma:E.default.formatMessage(Ss.figma),invision:E.default.formatMessage(Ss.invision),abstract:E.default.formatMessage(Ss.abstract),framer:E.default.formatMessage(Ss.framer),whimsical:E.default.formatMessage(Ss.whimsical),mixpanel:E.default.formatMessage(Ss.mixpanel),miro:E.default.formatMessage(Ss.miro),sketch:E.default.formatMessage(Ss.sketch),excalidraw:E.default.formatMessage(Ss.excalidraw),replit:E.default.formatMessage(Ss.replit),audio:E.default.formatMessage(Ss.audio),maps:E.default.formatMessage(Ss.maps),loom:E.default.formatMessage(Ss.loom),typeform:E.default.formatMessage(Ss.typeform),codepen:E.default.formatMessage(Ss.codepen),pdf:E.default.formatMessage(Ss.pdf),embed:E.default.formatMessage(Ss.embed),hex:E.default.formatMessage(Ss.hex),deepnote:E.default.formatMessage(Ss.deepnote),drawing:E.default.formatMessage(Ss.drawing)};class ws extends o.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=vs.Z.state;if(!t.open)return;const s=this.getSections(t);let i;return 0===s.length&&fs.xv(),i=e.isMobile?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:320,maxHeight:"40vh"},(0,y.jsx)(d.Z,{...i,className:u.srZ,children:(0,y.jsx)(B.Z,{type:B.i.Vertical,sections:s,initialFocus:0})})},this.handleDismiss=()=>{const e=vs.Z.state,{url:t}=e;M.X0y(this.environment,{url:t,type:"close"}),fs.xv()},this.handleAccept=e=>{const t=vs.Z.state,{url:s}=t;fs.RL({environment:this.environment,type:e}),M.X0y(this.environment,{url:s,type:e})}}willMountOrUpdate(){const e=vs.Z.state;if(e.open){const t=_.default.state;if("editing"===t.mode){const{multiSelection:s}=t;(0,C.qS)(s)&&s.start.store.id===e.textStore.id&&s.end.index===e.urlSelection.endIndex||fs.xv()}}}renderComponent(){const{device:e}=this.environment,t=vs.Z.state;return(0,y.jsx)(c.ZP,{popupType:e.isMobileNative&&!e.isTablet?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:c.ZP.Placement.Bottom,alignmentToOrigin:c.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDismiss})}isInCollection(e){const t=e.getRecordStoreAtRootPath();return t instanceof Bt.G&&void 0!==t.getParentCollectionStore()}isCollectionViewWithContent(e,t){const s=e.getCollectionViewStores(),i=S.sE(s,(e=>e.id===t&&"page"===e.getType()));return Boolean(i)}getSections(e){const{device:t}=this.environment,{url:s,textStore:i}=e,{currentSpaceStore:n}=ie.default.state,a=[],o=(0,ps.Wj)({url:s,baseUrl:ys.default.domainBaseUrl,publicDomainName:ys.default.publicDomainName,isMobile:t.isMobile,protocol:ys.default.protocol,currentUrl:window.location.href});if("page"===o.name){const e=Bt.G.createChildStore(i,{table:gs.iU,id:o.blockId}),t=o.scrollToBlockId?Bt.G.createChildStore(i,{table:gs.iU,id:o.scrollToBlockId}):void 0;a.push({name:E.default.formatMessage(bs.createLinkedViewOfDatabase),validator:()=>!t&&e.isCollectionView()&&!this.isInCollection(i)&&(!e.isCollectionViewPageWithContent()||!this.isCollectionViewWithContent(e,o.collectionViewId))&&!xs.default.isMiniPeekOpen()&&(null==n?void 0:n.id)===e.getSpaceId(),type:Ce.Ti.collectionView}),a.push({name:E.default.formatMessage(void 0===t?bs.mentionPage:bs.mentionBlock),validator:()=>!0,type:"mention-page"}),a.push({name:E.default.formatMessage(bs.createTransclusionItem),validator:()=>Boolean(t&&!t.isNavigableBlock()&&!this.isInCollection(i)&&!t.isLocked()&&!t.isNavigableAncestorLocked()&&t.canEdit()&&t.getSpaceId()===(null==n?void 0:n.id)),type:"create-transclusion"}),a.push({name:E.default.formatMessage(bs.linkToPage),validator:()=>!t&&!e.isCollectionView()&&!this.isInCollection(i),type:Ce.Ti.page})}const r=hs.XP(Ms);for(const c of r)"embed"!==c&&a.push({name:Ms[c],validator:ms.Wb[c],type:c});a.push({name:E.default.formatMessage(bs.bookmarkMenuItem),validator:e=>!this.isInCollection(i)&&ms.Cm(e),type:Ce.Ti.bookmark}),a.push({name:Ms.embed,validator:e=>!this.isInCollection(i)&&ms.Wb.embed(e),type:"embed"});const l=S.oA(a.map((e=>{let{name:t,validator:i,type:n}=e;if(i({url:s,baseUrl:ys.default.domainBaseUrl,publicDomainName:ys.default.publicDomainName})){return{key:`embed ${t}`,render:e=>(0,y.jsx)(Gt.Z,{...e,title:t}),action:()=>this.handleAccept(n)}}}))),d={key:"dismiss",render:e=>(0,y.jsx)(Gt.Z,{...e,title:E.default.formatMessage(bs.dismissItem)}),action:this.handleDismiss};if(0===l.length)return[];"page"===o.name?l.push(d):l.unshift(d);return[{key:"embed section",render:e=>(0,y.jsx)(L.Z,{...e}),items:l}]}}ws.displayName="EmbedMenu";const js=ws;var Cs=s(43593),ks=s(45238);const _s=(0,ks.I)("collapse",{viewBox:"0 0 16 16",svg:(0,y.jsx)("path",{d:"M2.477 7.51h3.787c.396 0 .701-.106.916-.32.214-.22.321-.525.321-.917V2.534a.723.723 0 00-.745-.745.731.731 0 00-.54.212.736.736 0 00-.205.533v.486l.15 2.146-1.6-1.682-1.968-1.982a.695.695 0 00-.52-.219.791.791 0 00-.574.219.736.736 0 00-.219.554.78.78 0 00.055.294.917.917 0 00.17.253L3.482 4.57l1.675 1.593-2.153-.143h-.526a.723.723 0 00-.746.745.723.723 0 00.746.745zm6.74 6.912a.71.71 0 00.526-.212.7.7 0 00.212-.526v-.554l-.143-2.14 1.6 1.682 2.002 2.016a.69.69 0 00.526.22c.224 0 .41-.074.561-.22a.725.725 0 00.226-.553.707.707 0 00-.062-.294.728.728 0 00-.164-.246l-2.01-2.017-1.688-1.586 2.16.144h.588a.736.736 0 00.533-.205.711.711 0 00.219-.534.72.72 0 00-.219-.54.723.723 0 00-.533-.211H9.702c-.392 0-.697.109-.916.328-.214.214-.321.517-.321.909v3.8a.7.7 0 00.212.527.746.746 0 00.54.212z"})});var Ts,Is=s(64330),Ps=s(80342),Zs=s(47453),Fs=s(51454),As=s(54604),Ds=s(42858),Bs=s(24677),Rs=s(39500),Ls=s(17504),Ns=s(58202),Es=s(38302),Os=s(23063),Vs=s(68785),Us=s(4827),Ws=s(89728),zs=s(1445);class Ks extends o.Z{constructor(){var e;super(...arguments),e=this,this.zoomFocusPercentageX=0,this.zoomFocusPercentageY=0,this.isListeningToWheel=!1,this.hideControlsTimeout=void 0,this.isMovingToPrevOrNextTimeout=void 0,this.isEditingZoom=W.default.createValue(!1),this.contentDimensions=W.default.createValue(void 0),this.showControls=W.default.createValue(!1),this.responsiveSettings=this.createComputedStore((()=>{const e=this.environment.WindowSizeStore.state.width;return{edgePadding:As.zp(e),backgroundOpacity:.8}})),this.renderOverlay=()=>{const{isOpen:e,renderFullScreenNode:t,fullScreenNodeRect:s,contentAspectRatio:i,zoomScale:n,panOffset:a,skipAnimations:o}=Es.Z.state;if(!s)return;e&&!this.isListeningToWheel?(window.addEventListener("wheel",this.handleWheel,{passive:!1}),this.isListeningToWheel=!0):!e&&this.isListeningToWheel&&(window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1);const{edgePadding:r,backgroundOpacity:l}=this.responsiveSettings.state,d=window.innerWidth,c=window.innerHeight-2*r;let u=d-2*r;const m=i||s.height/s.width;let p=u*m;if(p>c){const e=p/c;p/=e,u/=e}const g={opacity:0},h={scale:n,opacity:1,translateX:a.x,translateY:a.y};let f,v;return t&&(f=t()),v=this.showControls.state?n>=1.5?"zoom-out":"zoom-in":"none",(0,Ls.Z)((t=>(0,y.jsx)(Q.Z,{capture:e,onEsc:()=>{this.handleClose(!0)},onEnter:S.yR,onSpace:()=>this.handleClose(!0),onCommandEnter:()=>this.handleClose(!0),onCommandShiftEnter:S.yR,onCommandSlash:S.yR,onUp:S.yR,onDown:S.yR,onDelete:S.yR,onBackspace:S.yR,onLeft:()=>this.handlePrevious(!0),onRight:()=>this.handleNext(!0),onUntab:S.yR,onTab:S.yR,onSelectAll:S.yR,onRedo:S.yR,onUndo:S.yR,onToggleBold:S.yR,onToggleItalics:S.yR,onToggleStrike:S.yR,onToggleCode:S.yR,onCut:S.yR,onCopy:S.yR,onPaste:S.yR,onKeypress:this.handleKeypress,children:(0,y.jsx)(Ie.Z,{capture:e,preventType:_e.Z.All,children:(0,y.jsxs)("div",{style:this.getStyle({isOpen:e}),...t,onClick:this.handleBackgroundClick,onMouseMove:this.resetHideControlsTimeout,children:[(0,y.jsx)(Os.Z,{isVisible:e,enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},animationStyle:{opacity:l},render:()=>(0,y.jsx)("div",{style:this.getBackgroundStyle()}),onAnimationEnd:this.handleBackgroundAnimationEnd}),(0,y.jsx)(Os.Z,{isVisible:e,enterAnimationStyle:g,exitAnimationStyle:g,animationStyle:h,skipAnimation:o,springConfig:{scale:this.getSpringConfig(),translateX:this.getSpringConfig(),translateY:this.getSpringConfig()},render:()=>(0,y.jsx)("div",{style:{display:"flex",cursor:v,maxWidth:u,maxHeight:p,justifyContent:"center"},ref:e=>{e&&this.contentDimensions.setState({width:e.clientWidth,height:e.clientHeight})},onClick:this.handleContentClick,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onMouseLeave:this.handleMouseUp,onMouseMove:this.handleMouseMove,children:f}),onAnimationEnd:this.handleFullscreenNodeAnimationEnd}),this.renderBottomBar()]})})})))},this.clearHideControlsTimeout=()=>{this.hideControlsTimeout&&clearTimeout(this.hideControlsTimeout)},this.resetHideControlsTimeout=()=>{const{isSaving:e}=Es.Z.state;this.showControls.setState(!0),this.clearHideControlsTimeout(),this.isEditingZoom.state||e||(this.hideControlsTimeout=setTimeout((()=>this.showControls.setState(!1)),2e3))},this.enableZoomEditing=()=>{this.isEditingZoom.setState(!0),this.clearHideControlsTimeout()},this.disableZoomEditing=()=>{this.isEditingZoom.setState(!1),this.resetHideControlsTimeout()},this.handleBackgroundClick=e=>{(0,Rs.uG)(e)||this.handleClose()},this.handleContentClick=e=>{const{zoomScale:t,panOffset:s}=Es.Z.state;if(e.stopPropagation(),(0,Rs.uG)(e))return;let i,n;i=t<1?1:t<1.5?1.5:1,n=i<=1?{x:0,y:0}:this.clampPanOffset({x:(window.innerWidth/2-e.clientX)/(i/(i-1)),y:(window.innerHeight/2-e.clientY)/(i/(i-1))})??s,Es.Z.setState({...Es.Z.state,zoomScale:i,panOffset:n}),this.resetHideControlsTimeout(),this.disableZoomEditing()},this.handleClose=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];As.xv(),e.resetControls(),M.Lfx(e.environment,{type:"close",triggered_by:t?"keypress":"click"}),Bs.ZH(e.environment),e.handleMouseUp()},this.handleResize=()=>{const{isOpen:e}=Es.Z.state;e&&this.enqueueForceUpdate()},this.handleBackgroundAnimationEnd=()=>{const{isOpen:e}=Es.Z.state;e||Es.Z.setState({...Es.Z.state,backgroundAnimationComplete:!0})},this.handleFullscreenNodeAnimationEnd=()=>{const{isOpen:e}=Es.Z.state;e||Es.Z.setState({...Es.Z.state,fullscreenNodeAnimationComplete:!0})},this.cancelBackgroundClick=e=>{e.stopPropagation()},this.handlePrevious=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(-1,t)},this.handleNext=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.moveToImageOffset(1,t)},this.handleZoomInputSubmit=e=>{const t=e.target,s=parseInt(t.value);if(!isNaN(s)){const e=s/100;M.Lfx(this.environment,{type:"set_zoom",new_zoom:e}),this.setZoomScale(e)}this.disableZoomEditing()},this.handleZoomOut=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:s}=Es.Z.state;let i=Math.ceil((s-Ks.ZOOM_STEP)*Ks.INVERSE_ZOOM_STEP)/Ks.INVERSE_ZOOM_STEP;s-i<Ks.ZOOM_THRESHOLD&&(i-=Ks.ZOOM_STEP),M.Lfx(e.environment,{type:"zoom_out",new_zoom:i,triggered_by:t?"keypress":"click"}),e.setZoomScale(i)},this.handleZoomIn=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{zoomScale:s}=Es.Z.state;let i=Math.floor((s+Ks.ZOOM_STEP)*Ks.INVERSE_ZOOM_STEP)/Ks.INVERSE_ZOOM_STEP;i-s<Ks.ZOOM_THRESHOLD&&(i+=Ks.ZOOM_STEP),M.Lfx(e.environment,{type:"zoom_in",new_zoom:i,triggered_by:t?"keypress":"click"}),e.setZoomScale(i)},this.addDeltaToZoomScale=e=>{const{zoomScale:t}=Es.Z.state;this.setZoomScale(t+e)},this.setZoomScale=e=>{const{panOffset:t}=Es.Z.state;this.resetHideControlsTimeout();const s=Math.max(Math.min(e,Ks.MAX_ZOOM),Ks.MIN_ZOOM),i=s<=1?{x:0,y:0}:t;Es.Z.setState({...Es.Z.state,zoomScale:s,panOffset:i})},this.handleWheel=e=>{const{isOpen:t,panOffset:s}=Es.Z.state;t&&(e.preventDefault(),e.ctrlKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*Ks.TRACK_PAD_SCALE):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*Ks.TRACK_PAD_SCALE):e.metaKey?e.deltaY?this.addDeltaToZoomScale(e.deltaY*Ks.MOUSE_WHEEL_SCALE):e.deltaX&&this.addDeltaToZoomScale(e.deltaX*Ks.MOUSE_WHEEL_SCALE):this.canPan()&&this.setPanOffset({x:s.x-e.deltaX,y:s.y-e.deltaY}))},this.handleMouseDown=e=>{const{panOffset:t,zoomScale:s}=Es.Z.state;Es.Z.setState({...Es.Z.state,panStartPosition:{x:e.clientX/s-t.x,y:e.clientY/s-t.y},skipAnimations:!0})},this.handleMouseUp=()=>{Es.Z.setState({...Es.Z.state,skipAnimations:!1})},this.handleMouseMove=e=>{const{panStartPosition:t,zoomScale:s}=Es.Z.state;this.contentDimensions.state&&1===e.buttons&&this.canPan()&&this.setPanOffset({x:e.clientX/s-t.x,y:e.clientY/s-t.y})},this.handleDownload=e=>{const{block:t,imageUrl:s}=Es.Z.state;if(!t||!this.canDownload())return;Es.Z.setState({...Es.Z.state,isSaving:!0}),this.clearHideControlsTimeout();const i=null==t?void 0:t.getProperties();let n;if(n=s||b.QaF(null==i?void 0:i.source),!n)return;const a=b.QaF(null==i?void 0:i.caption);(0,Cs.GN)(n,null==t?void 0:t.pointer,ys.default.domainBaseUrl,this.environment.currentUser.id,a).then((()=>{Es.Z.setState({...Es.Z.state,isSaving:!1}),M.Lfx(this.environment,{type:"download",triggered_by:"click"}),this.resetHideControlsTimeout()}))},this.handleKeypress=e=>{switch(e.key){case"+":case"=":this.handleZoomIn(!0);break;case"-":case"_":this.handleZoomOut(!0)}}}didMount(){super.didMount(),window.addEventListener("resize",this.handleResize)}willUnmount(){super.willUnmount(),window.removeEventListener("resize",this.handleResize),window.removeEventListener("wheel",this.handleWheel),this.isListeningToWheel=!1}renderComponent(){const{isOpen:e,fullscreenNodeAnimationComplete:t,backgroundAnimationComplete:s}=Es.Z.state;return(0,y.jsx)(Us.Z,{open:e||!t||!s,children:this.renderOverlay()})}getAllImageBlocksOnPage(){const e=Rt.default.getCurrentRootStore();return Ns.R.getMembersByDOMOrder({filter:t=>t instanceof zs.Z&&Boolean(t.props.store.findRecordStoreUIAncestor((t=>Boolean(e&&t===e))).ancestor)}).map((e=>e.props.store)).filter((e=>Boolean(e.getProperties().source)))}renderBottomBar(){const{isOpen:e}=Es.Z.state;if(!this.environment.device.isMobile)return(0,y.jsx)(Os.Z,{isVisible:this.showControls.state,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},animationStyle:{opacity:1},render:()=>(0,y.jsxs)("div",{style:this.getBottomContainerStyle(e),onClick:e=>{this.cancelBackgroundClick(e),this.resetHideControlsTimeout(),this.disableZoomEditing()},children:[(0,y.jsx)("div",{style:{...Ks.controlBarStyle,marginRight:10},children:this.renderPrevNextButtons()}),(0,y.jsxs)("div",{style:Ks.controlBarStyle,children:[this.renderZoomControls(),this.renderVerticalLine(),this.canDownload()?(0,y.jsxs)(y.Fragment,{children:[this.renderDownloadButton(),this.renderVerticalLine()]}):void 0,this.renderCloseButton()]})]})})}renderZoomControls(){const{zoomScale:e}=Es.Z.state,t=(100*e).toFixed(0);return(0,y.jsxs)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifySelf:"flex-start"},children:[(0,y.jsx)($.Z,{renderTooltip:()=>this.renderTooltip({primaryText:(0,y.jsx)(r.FormattedMessage,{id:"fullScreenRenderer.zoomOut",defaultMessage:"Zoom out"}),secondaryText:"-"}),disableTooltip:e<=Ks.MIN_ZOOM,render:t=>(0,y.jsx)(Ws.Z,{...t,disabled:e<=Ks.MIN_ZOOM,style:{...this.getButtonStyle(e<=Ks.MIN_ZOOM),...Ks.firstButtonPadding},onClick:()=>this.handleZoomOut(),icon:e=>(0,Ps.$)({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})})}),this.isEditingZoom.state?(0,y.jsx)(Hs,{initialValue:t,onSubmit:this.handleZoomInputSubmit,onCancel:this.disableZoomEditing,primaryColor:this.getBottomBarPrimaryColor(),secondaryColor:this.getBottomBarSecondaryColor()}):(0,y.jsx)(Ws.Z,{onClick:e=>{e.stopPropagation(),this.enableZoomEditing()},style:{color:this.getBottomBarSecondaryColor(),margin:0,width:46,padding:0,justifyContent:"center"},children:`${t}%`}),(0,y.jsx)($.Z,{renderTooltip:()=>this.renderTooltip({primaryText:(0,y.jsx)(r.FormattedMessage,{id:"fullScreenRenderer.zoomIn",defaultMessage:"Zoom in"}),secondaryText:"+"}),disableTooltip:e>=Ks.MAX_ZOOM,render:t=>(0,y.jsx)(Ws.Z,{...t,disabled:e>=Ks.MAX_ZOOM,style:this.getButtonStyle(e>=Ks.MAX_ZOOM),onClick:()=>this.handleZoomIn(),icon:e=>(0,Zs.R)({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})})})]})}renderPrevNextButtons(){const{block:e}=Es.Z.state,t=this.getAllImageBlocksOnPage(),s=(null==t?void 0:t.length)??0,i=(null==t?void 0:t.findIndex((t=>t===e)))??-1;return s<=1||i<0?(0,y.jsx)("div",{}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)($.Z,{renderTooltip:()=>this.renderTooltip({primaryText:(0,y.jsx)(r.FormattedMessage,{id:"fullScreenRenderer.previous",defaultMessage:"Back"}),secondaryText:this.renderPrevNextSecondaryText(i-1,s)}),disableTooltip:0===i,render:e=>(0,y.jsx)(Ws.Z,{...e,disabled:i<=0,style:{...this.getButtonStyle(i<=0),...Ks.firstButtonPadding},hoveredStyle:Ks.hoveredButtonStyle,onClick:()=>this.handlePrevious(),icon:e=>(0,$e.V)({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})})}),(0,y.jsx)($.Z,{renderTooltip:()=>this.renderTooltip({primaryText:(0,y.jsx)(r.FormattedMessage,{id:"fullScreenRenderer.next",defaultMessage:"Next"}),secondaryText:this.renderPrevNextSecondaryText(i+1,s)}),disableTooltip:i+1===s,render:e=>(0,y.jsx)(Ws.Z,{...e,disabled:i>=s-1,style:{...this.getButtonStyle(i>=s-1),...Ks.lastButtonPadding},hoveredStyle:Ks.hoveredButtonStyle,onClick:()=>this.handleNext(),icon:e=>(0,Xe.n)({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})})})]})}renderDownloadButton(){const{isSaving:e}=Es.Z.state;return(0,y.jsx)($.Z,{renderTooltip:()=>this.renderTooltip({primaryText:(0,y.jsx)(r.FormattedMessage,{id:"fullScreenRenderer.download",defaultMessage:"Download"})}),render:t=>(0,y.jsx)(Ws.Z,{...t,disabled:e,onClick:this.handleDownload,style:this.getButtonStyle(!1),hoveredStyle:Ks.hoveredButtonStyle,children:e?(0,y.jsx)(Vs.Z,{style:{width:16}}):(0,Is.a)({fill:this.getBottomBarPrimaryColor(),width:16})})})}renderCloseButton(){return(0,y.jsx)($.Z,{renderTooltip:()=>this.renderTooltip({primaryText:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Close",id:"fullscreenRenderer.closeButton.label"}),secondaryText:"esc"}),render:e=>(0,y.jsx)(Ws.Z,{...e,onClick:()=>this.handleClose(),style:{...this.getButtonStyle(!1),...Ks.lastButtonPadding},hoveredStyle:Ks.hoveredButtonStyle,icon:e=>_s({...e,fill:this.getBottomBarPrimaryColor(),height:16,margin:0,width:16})})})}renderPrevNextSecondaryText(e,t){return(0,y.jsx)(r.FormattedMessage,{values:{currentIndex:e+1,totalCount:t},defaultMessage:"{currentIndex} of {totalCount}",id:"fullscreenRenderer.imageCount.label"})}renderTooltip(e){const{primaryText:t,secondaryText:s}=e;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("span",{style:{marginRight:s?4:void 0},children:t}),s?(0,y.jsx)("span",{style:{color:this.getBottomBarSecondaryColor()},children:s}):void 0]})}renderVerticalLine(){return(0,y.jsx)("span",{style:{borderLeft:`1px solid ${P.ZP.whiteWithAlpha(.25)}`,height:"100%"}})}scrollToZoomFocus(e){const t=window.innerWidth/2,s=window.innerHeight/2,i=e.scrollWidth*this.zoomFocusPercentageX,n=e.scrollHeight*this.zoomFocusPercentageY;e.scrollLeft=i-t,e.scrollTop=n-s}resetControls(){this.isEditingZoom.setState(!1),Es.Z.setState({...Es.Z.state,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}})}canPan(){const{zoomScale:e}=Es.Z.state;return e>1}clampPanOffset(e){const t=this.contentDimensions.state;if(!t)return;let s,i;s=t.width*Ks.MAX_ZOOM>window.innerWidth?(t.width*Ks.MAX_ZOOM-window.innerWidth)/(2*Ks.MAX_ZOOM):(window.innerWidth-t.width*Ks.MAX_ZOOM)/(2*Ks.MAX_ZOOM),i=t.height*Ks.MAX_ZOOM>window.innerHeight?(t.height*Ks.MAX_ZOOM-window.innerHeight)/(2*Ks.MAX_ZOOM):(window.innerHeight-t.height*Ks.MAX_ZOOM)/(2*Ks.MAX_ZOOM);return{x:Math.min(Math.max(e.x,-1*s),s),y:Math.min(Math.max(e.y,-1*i),i)}}setPanOffset(e){const{panStartPosition:t}=Es.Z.state,s=this.clampPanOffset(e);s&&(e.x!==s.x&&(t.x=t.x+(e.x-s.x)),e.y!==s.y&&(t.y=t.y+(e.y-s.y)),Es.Z.setState({...Es.Z.state,panOffset:s,panStartPosition:t}))}canDownload(){var e;const{block:t,imageUrl:s}=Es.Z.state;return t&&(s||(null===(e=t.getProperties())||void 0===e?void 0:e.source)&&b.QaF(t.getProperties().source))}moveToImageOffset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{block:s}=Es.Z.state,i=this.getAllImageBlocksOnPage();if(!i)return;const n=i.findIndex((e=>e===s));if(n+e<0||n+e>=i.length)return;M.Lfx(this.environment,{type:e>0?"next":"previous",image_count:i.length,image_index:n+e,triggered_by:t?"keypress":"click"}),Es.Z.setState({...Es.Z.state,skipAnimations:!0}),this.isMovingToPrevOrNextTimeout&&clearTimeout(this.isMovingToPrevOrNextTimeout),this.isMovingToPrevOrNextTimeout=setTimeout((()=>{Es.Z.setState({...Es.Z.state,skipAnimations:!1})}),250);const a=i[n+e];Ds.dK({blocks:[a]}),this.resetControls()}getSpringConfig(){return{stiffness:100,damping:10,precision:.001}}getStyle(e){const{isOpen:t}=e;return{zIndex:Fs.mJ,position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:t?"auto":"none",cursor:this.showControls.state?void 0:"none"}}getBackgroundStyle(){return{position:"absolute",top:0,left:0,right:0,bottom:0,background:P.ZP.black}}getBottomContainerStyle(e){return{bottom:30,display:e?"flex":"none",fontSize:14,left:"50%",lineHeight:1.2,position:"absolute",transform:"translate(-50%, 0)"}}getBottomBarPrimaryColor(){return P.ZP.white}getBottomBarSecondaryColor(){return P.ZP.whiteWithAlpha(.5)}getButtonStyle(e){return{borderRadius:4,opacity:e?.4:1,padding:6}}}function Hs(e){window.__c={n:"ZoomInput"};const[t,s]=(0,i.useState)(e.initialValue);return(0,y.jsx)(Xt.Z,{style:{width:46,color:e.primaryColor},inputStyle:{textAlign:"center",border:"solid 1px rgba(45, 156, 219, 0.72)",borderRadius:3,boxShadow:"0px 0px 0px 3px rgba(45, 156, 219, 0.2)"},onClick:e=>e.stopPropagation(),onChange:e=>{const t=e.target;s(t.value)},value:t,onSubmit:e.onSubmit,focusInitial:!0,selectAll:!0,format:Xt.B.Transparent,right:(0,y.jsx)("span",{style:{color:e.secondaryColor},children:"%"}),onKeyDown:t=>{t.stopPropagation(),"Escape"===t.key?e.onCancel():"Tab"===t.key&&e.onSubmit(t)}})}Ts=Ks,Ks.displayName="FullScreenRenderer",Ks.MAX_ZOOM=2,Ks.MIN_ZOOM=.5,Ks.ZOOM_STEP=.5,Ks.INVERSE_ZOOM_STEP=1/Ts.ZOOM_STEP,Ks.ZOOM_THRESHOLD=.25,Ks.MOUSE_WHEEL_SCALE=-.002,Ks.TRACK_PAD_SCALE=-.004,Ks.controlBarStyle={display:"flex",borderRadius:4,background:P.ZP.blackWithAlpha(.65)},Ks.firstButtonPadding={padding:"6px 6px 6px 10px"},Ks.lastButtonPadding={padding:"6px 10px 6px 6px"},Ks.hoveredButtonStyle={background:"rgba(255, 255, 255, 0.055)"};const Gs=Ks;var qs=s(98567),Ys=s(70279),Qs=s(23867),$s=s(19889),Xs=s(36280),Js=s(73959),ei=s(89086),ti=s(66949),si=s(3702);class ii extends o.Z{constructor(){super(...arguments),this.input=i.createRef(),this.handleInputChange=(e,t)=>{ti.Z.isOpen()&&ti.Z.setState({...ti.Z.state,value:e,error:t})},this.handleSubmit=()=>{j.createAndCommit({userAction:"InlineEquationOverlay.handleSubmit",environment:this.environment,perform:e=>{Xs.gt({environment:this.environment,equationStore:ti.Z,transaction:e})}})},this.handleClose=()=>{Xs.Wj()},this.handleLeft=e=>{if(!this.input.current)return;const t=this.input.current.getSelection();t&&"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&0===t.startIndex&&0===t.endIndex&&(this.handleSubmit(),Xs.Wj(ti.P.Backward))},this.handleRight=e=>{if(!ti.Z.isOpen())return;if(!this.input.current)return;const t=this.input.current.getSelection();if(!t)return;const s=ti.Z.state.value.length;"altKey"in e&&!e.altKey&&"shiftKey"in e&&!e.shiftKey&&t.startIndex===s&&t.endIndex===s&&(this.handleSubmit(),Xs.Wj())},this.isDisabled=()=>{var e;if("editing"!==_.default.state.mode&&!ti.Z.isOpen())return!0;const t=ti.Z.isOpen()?null===(e=(0,C.QY)(ti.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store:void 0;if(t&&!t.canEdit())return!0;if(t){const e=(0,Js.J2)(t);if(e&&e.isLocked())return!0}if(t&&t.table===Ys.x_){const e=Bt.T5.createChildStore(t,{table:Ys.x_,id:t.id,spaceId:(0,Qs.C)(t.pointer.spaceId)}),s=e.isDefined(),{currentUserStore:i}=ie.default.state;if(!s||!i)return!0;const n=e.getCreatedByTable(),a=e.getCreatedById();if(n!==$s.KJ||i.id!==a)return!0}const s={[b.GKr.User]:b.GKr.User,[b.GKr.Page]:b.GKr.Page,[b.GKr.Comment]:b.GKr.Comment,[b.GKr.Bot]:b.GKr.Bot,[b.GKr.Date]:b.GKr.Date,[b.GKr.ExternalObjectInstance]:b.GKr.ExternalObjectInstance,[b.GKr.TemporaryPage]:b.GKr.TemporaryPage,[b.GKr.TemplateVariable]:b.GKr.TemplateVariable,[b.GKr.FormulaPageProperty]:b.GKr.FormulaPageProperty,[b.GKr.FormulaContextValue]:b.GKr.FormulaContextValue,[b.GKr.Group]:b.GKr.Group};for(const i of Object.values(s))if((0,ei.J6)(i))return!0;return!1},this.INPUT_ORIGIN_GAP_PX=8}renderComponent(){if(!ti.Z.isOpen())return;const e=!ti.Z.isOpen(),t=this.isDisabled(),s=this.getInputOriginRect(),i=ti.Z.state.value,n=ti.Z.state.error;return(0,y.jsx)(p.DependencyConsumer,{dependency:p.deps.prismjs,children:a=>{if(!e)return(0,y.jsx)(si.Z,{Prism:a,ref:this.input,isOpen:!0,equationValue:i,error:n,displayMode:"inline",disabled:t,originRect:s,originGap:this.INPUT_ORIGIN_GAP_PX,onDismiss:this.handleClose,onChange:this.handleInputChange,onSubmit:this.handleSubmit,onLeft:this.handleLeft,onRight:this.handleRight})}})}getInputOriginRect(){if(ti.Z.isOpen())return ti.Z.state.savedTextSelectionRect}}ii.displayName="InlineEquationOverlay";const ni=ii;var ai=s(84908),oi=s(94416);class ri extends o.Z{constructor(){super(...arguments),this.handleOpen=()=>{oi.Z.setState({open:!0})},this.handleClose=()=>{oi.Z.setState({open:!1})}}willMount(){ai.inPageSearch.started.addListener(this.handleOpen),ai.inPageSearch.stopped.addListener(this.handleClose)}willUnmount(){ai.inPageSearch.started.removeListener(this.handleOpen),ai.inPageSearch.stopped.removeListener(this.handleClose)}}ri.displayName="InPageSearchListener";const li=ri;var di=s(73935),ci=s(96313),ui=s(73744),mi=s(70726),pi=s(48863),gi=s(33411);function hi(e){switch(e){case mi.Z.Preview:return(0,y.jsx)(r.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"});case mi.Z.Mention:return(0,y.jsx)(r.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"});case mi.Z.Link:return(0,y.jsx)(r.FormattedMessage,{id:"internalUnfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"});default:(0,Ne.t1)(e)}}const fi=function(){window.__c={n:"InternalUnfurlingMenu"};const e=(0,n.O7)(),t=(0,i.useRef)(null),[s]=(0,a.AF)(pi.Z),o=(0,i.useCallback)((t=>{if(s.open){var i;if(!t)ci.pg({actionType:s.focusedIndex,environment:e,commentStore:null===(i=s.args.commentStore)||void 0===i?void 0:i.state,useTempStores:!1});pi.Z.setState({open:!1})}}),[e,s]),r=(0,i.useCallback)((e=>{s.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&o(void 0)}),[o,s.open]),l=(0,i.useCallback)((e=>{const i=t.current;if(!s.open||!e.target||!i)return;const n=di.findDOMNode(i);n&&(n.contains(e.target)||o(void 0))}),[o,s.open]);(0,i.useEffect)((()=>((0,ui.lj)(window,"keydown",r),(0,ui.lj)(window,"mousedown",l),()=>{(0,ui.ZV)(window,"keydown",r),(0,ui.ZV)(window,"mousedown",l)})),[r,l]);const p=(0,i.useRef)(!1);function g(t){var i;s.open&&void 0!==t.indexGlobal&&(pi.Z.setState({...s,focusedIndex:t.indexGlobal}),ci.pg({actionType:t.indexGlobal,environment:e,commentStore:null===(i=s.args.commentStore)||void 0===i?void 0:i.state,useTempStores:!0}))}(0,a.VK)((()=>{var t,i;const n=(s.open&&(null===(t=s.args.commentStore)||void 0===t?void 0:t.state)&&(null===(i=s.args.commentStore.state)||void 0===i?void 0:i.isReady()))??!1;var a;n&&!p.current&&s.open&&ci.pg({actionType:s.focusedIndex,environment:e,commentStore:null===(a=s.args.commentStore)||void 0===a?void 0:a.state,useTempStores:!0});p.current=n}),[e,s]);const h=(0,a.VK)((()=>e.device.isMobileNative&&!e.device.isTablet),[e]),f=e.device.isMobile;return(0,y.jsx)(c.ZP,{popupType:h?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:s.open,originRect:s.open?s.selectionRect:void 0,placementToOrigin:c.ZP.Placement.Top,alignmentToOrigin:c.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:f,keepFocus:f,render:function(){var i;const{device:n}=e;if(!s.open)return;const a=function(t){const{url:s,args:i}=t,n=[];n.push({title:hi(mi.Z.Preview),validator:()=>!0,type:mi.Z.Preview}),n.push({title:hi(mi.Z.Mention),validator:()=>!0,type:mi.Z.Mention}),n.push({title:hi(mi.Z.Link),validator:()=>!0,type:mi.Z.Link});return[{key:"menu section",render:e=>(0,y.jsx)(L.Z,{...e}),items:S.oA(n.map((t=>{let{title:n,validator:a,type:o}=t;if(a({url:s,baseUrl:ys.default.domainBaseUrl,publicDomainName:ys.default.publicDomainName})){return{key:`item ${o}`,render:t=>(0,y.jsx)(Gt.Z,{...t,title:n,onMouseEnter:s=>{var n;t.onMouseEnter(s),ci.pg({actionType:o,environment:e,commentStore:null===(n=i.commentStore)||void 0===n?void 0:n.state,useTempStores:!0})}}),action:()=>{var t;return ci.pg({actionType:o,environment:e,commentStore:null===(t=i.commentStore)||void 0===t?void 0:t.state,useTempStores:!1})}}}})))}]}(s);let o;return o=n.isMobile?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:320,maxHeight:"40vh"},null!==(i=s.args.commentStore)&&void 0!==i&&i.state&&s.args.commentStore.state.isReady()?(0,y.jsx)(d.Z,{...o,className:u.srZ,ref:t,children:(0,y.jsx)(B.Z,{type:B.i.Vertical,sections:a,onKeyboardArrow:g,initialFocus:0,priority:1,disallowBackspace:!0})}):(0,y.jsx)(gi.Z,{show:!0,showDelay:500,showHold:0,render:()=>(0,y.jsx)(d.Z,{...o,className:u.srZ,ref:t,children:(0,y.jsx)(L.Z,{style:{display:"flex",justifyContent:"center"},children:(0,y.jsx)(Vs.Z,{})})})})},onDismiss:()=>o(void 0)})};var yi=s(64572),vi=s(88295),xi=s(45990),Si=s(48709),bi=s(40462),Mi=s(23210),wi=s(54882),ji=s(23178);function Ci(e){window.__c={n:"LinkMenuInput"};const{state:t,focusInitial:s,defaultValue:i,onBlur:a,onKeyDown:o,style:l}=e,d=(0,n.MO)(),c=(0,r.useIntl)(),u=c.formatMessage({defaultMessage:"Paste link or search pages",id:"selectionLinkButton.search.createNewLinkPlaceholder"}),m=c.formatMessage({defaultMessage:"Edit link or search pages",id:"selectionLinkButton.search.editLinkPlaceholder"}),p=!d||!t.showCreateIn,g=d?void 0:!t.showCreateIn&&t.focusLinkInput,h=t.editingToken?m:u;return p?(0,y.jsx)(se.ZP,{onFocus:Si.FV,placeholder:h,value:i||t.url,onChange:ki,onBlur:a,onKeyDown:o,focus:g,focusInitial:s,focusAfterAnimation:!0,preventCaptureArrowShortcuts:!0,style:l}):null}const ki=e=>{const t=ji.Z.state;t.open&&ji.Z.setState({...t,url:e.target.value,focusLinkInput:!0})};function _i(e){window.__c={n:"LinkMenuInputWithPreview"};const{state:t,showPreview:s,store:i}=e,a=(0,n.MO)(),o=(0,Si.Fs)(t),{editingToken:r,focusTitleInput:l}=t;return s&&i?(0,y.jsx)(wi.B,{store:i,onClick:Si.FV}):(0,y.jsx)(Ci,{state:t,onBlur:Si.cX,onKeyDown:Ti,defaultValue:s?o:void 0,style:r?void 0:{marginTop:6},focusInitial:!Boolean(r)||a&&!l})}const Ti=e=>{"Escape"===e.key&&(e.stopPropagation(),(0,Si.hy)())};function Ii(e){window.__c={n:"LinkMenuTitleInput"};const{title:t,focus:s,defaultTitle:a}=e,o=(0,n.O7)(),r=(0,n.MO)(),[l,d]=(0,i.useState)(),c=(0,i.useRef)(!1),u=(0,i.useMemo)((()=>({environment:o,defaultTitle:a,setPlaceholder:d,hasTitleChanged:c})),[a,o]);return(0,i.useEffect)((()=>{const e=c.current;return()=>{e&&M.pZG(o)}}),[c,o]),(0,y.jsx)(se.ZP,{focus:s,focusInitial:r,onFocus:Fi,onBlur:()=>Ai(u),onChange:e=>Pi(e,u),onKeyDown:e=>Di(e,u),value:l?"":t,placeholder:l,preventCaptureArrowShortcuts:!0,style:{paddingBottom:8}})}const Pi=(e,t)=>{Zi(e.target.value,t)},Zi=(e,t)=>{const s=ji.Z.state;if(!s.open)return;const{editingToken:i,savedTextSelectionState:n}=s;if(!i)return;if(!e)return void ji.Z.setState({...s,title:""});const{environment:a,setPlaceholder:o,hasTitleChanged:r}=t;j.createAndCommit({userAction:"LinkMenu.updateTitle",environment:a,perform:t=>{const l=xi.iX({environment:a,title:e,transaction:t,editingToken:i,savedTextSelectionState:n});l&&ji.Z.setState({...s,...l,title:e}),o(void 0),r.current=!0}})},Fi=()=>{(0,Si.ZG)(!0)},Ai=e=>{Bi(e),(0,Si.ZG)(!1)},Di=(e,t)=>{"Enter"!==e.key&&"Escape"!==e.key||(e.stopPropagation(),Ai(t))},Bi=e=>{const t=ji.Z.state;if(!t.open)return;const{defaultTitle:s,setPlaceholder:i}=e;t.title||(Zi(s,e),i(s))};var Ri=s(88632),Li=s(18466),Ni=s(59054),Ei=s(2985),Oi=s(11470),Vi=s(15447);function Ui(e){const{state:t}=e,s=(0,i.useMemo)((()=>(0,Si.uP)(t)),[t]),o=(0,i.useMemo)((()=>(0,Si.dY)(s)),[s]),l=function(e){const{state:t,inputUrl:s,query:o,handleLinkSelection:l}=e,{url:d}=t,c=(0,n.O7)(),u=(0,n.MO)(),m=(0,a.VK)((()=>Ri.Z.state.online),[]),p=!!d;return(0,i.useMemo)((()=>{let e,i=!1;if(!s&&p)e=(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Type a complete URL to link",id:"selectionLinkButton.invalidUrl"}),i=!0;else{if(!s)return;if("notion"===s.type&&m)return;"web"===s.type?e=(0,y.jsx)(r.FormattedMessage,{id:"selectionLinkButton.linkToWebPage",defaultMessage:"Link to web page"}):"notion"===s.type?e=(0,y.jsx)(r.FormattedMessage,{id:"selectionLinkButton.linkToPage",defaultMessage:"Link to page"}):"other"===s.type?e=(0,y.jsx)(r.FormattedMessage,{id:"selectionLinkButton.linkToURL",defaultMessage:"Link to URL"}):(0,Ne.t1)(s.type)}return{key:"link to url",action:()=>l(c,t,o,u),render:t=>(0,y.jsx)(Gt.Z,{...t,title:d,caption:e,icon:(0,bi.o)({width:16,paddingTop:4}),disabled:i})}}),[t,o,c,u,m,s,l,p,d])}({state:t,inputUrl:o,query:s,handleLinkSelection:Wi}),d=function(e){const{state:t,inputUrl:s,query:o,additionalItem:l}=e,{editingToken:d}=t,c=function(e){const{state:t,inputUrl:s,query:o,handleLinkSelection:l,disableEmptyQueryResults:d}=e,{savedTextSelectionState:c}=t,u=(0,n.O7)(),m=(0,n.MO)(),[{online:p}]=(0,a.AF)(Ri.Z),g=(0,i.useMemo)((()=>{var e;const t=null===(e=(0,C.QY)(c.multiSelection))||void 0===e?void 0:e.store;if(t&&(0,ke.OY)(t))return t}),[c]),[{value:h,status:f}]=(0,Ni.r5)((async()=>p?o?(await Ei.WL({nearBlock:g,environment:u,query:o,source:"mention_menu",limit:10})).map((e=>e.id)):d?[]:Vi.X4.state.map((e=>e.pageId)):[]),[o,g,u,p,d]),v=(0,i.useMemo)((()=>{if(s&&"notion"===s.type){const e=h?S.zu(h,s.notionPage.blockId):[];return[s,...e]}return h}),[h,s]);return(0,i.useMemo)((()=>{if(!v||0===v.length)return;if(s&&"web"===s.type&&s.url===o)return;const e=Li.Z.withListenerIgnored(He.RM);if(!e)return;const i=t.url?5:3,n=(0,y.jsx)(r.FormattedMessage,{id:"selectionLinkButton.linkToPage.linkToBlock",defaultMessage:"Link to block"}),a=(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Link to page",id:"selectionLinkButton.linkToPageSection.title"});return{items:v.map(((s,i)=>{const a="object"==typeof s?s.notionPage.peekViewBlockId||s.notionPage.blockId:s,o=Bt.G.createChildStore(e,{table:gs.iU,id:a});return{key:i,action:()=>{if("object"==typeof s){const e=(0,yi.nR)({pageId:s.notionPage.blockId,peekViewBlockId:s.notionPage.peekViewBlockId,peekMode:s.notionPage.peekMode,discussionId:s.notionPage.discussionId,collectionViewId:s.notionPage.collectionViewId,scrollToBlockId:s.notionPage.scrollToBlockId});l(u,t,e,m)}else l(u,t,(0,yi.nR)({pageId:a}),m)},render:e=>{const t="object"==typeof s&&s.notionPage.scrollToBlockId;return(0,y.jsx)(Oi.Z,{...e,store:o,caption:t?n:void 0,placeholder:(0,y.jsx)(gi.Z,{showHold:300,showDelay:300,show:"resolved"===f,render:e=>e?(0,y.jsx)(r.FormattedMessage,{id:"selectionLinkButton.linkToPage.unknownBlock",defaultMessage:"Unknown block"}):(0,y.jsx)(r.FormattedMessage,{id:"selectionLinkButton.linkToPage.loading",defaultMessage:"Loading..."})})})}}})).slice(0,i),title:v.some((e=>Boolean("object"==typeof e&&e.notionPage.scrollToBlockId)))?n:a}}),[v,t,u,m,o,s,f,l])}({state:t,inputUrl:s,query:o,handleLinkSelection:Wi,disableEmptyQueryResults:!!d});return(0,i.useMemo)((()=>{if(c||l){return{key:"results",items:S.oA([...(null==c?void 0:c.items)||[],l]),render:e=>(0,y.jsx)(L.Z,{...e,title:d||o?void 0:(0,y.jsx)(r.FormattedMessage,{id:"selectionLinkButton.recents.title",defaultMessage:"Recents"})})}}}),[c,l,d,o])}({state:t,inputUrl:o,query:s,additionalItem:l}),c=(0,Si.Fs)(t),u=c&&(0,yi.A5)({url:c,baseUrl:ys.default.domainBaseUrl,publicDomainName:ys.default.publicDomainName}),m=(0,a.VK)((()=>{if(!u)return;const e=(0,He.RM)();return e?Bt.G.createChildStore(e,{table:gs.iU,id:u}):void 0}),[u]),p=function(e){const{state:t,url:s,isEmptyResults:n,pageStore:a}=e;return(0,i.useMemo)((()=>{let e=(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Page or URL",id:"selectionLinkButton.currentInfo.pageOrUrl"});const i=!t.focusLinkInput&&n;let o;return a?o={key:"link to page",action:()=>{},render:()=>(0,y.jsx)(_i,{state:t,showPreview:i,store:a})}:s?o={key:"link to web",action:()=>{},render:()=>(0,y.jsx)(_i,{state:t,showPreview:!0})}:(e=void 0,o={key:"create link",action:()=>{},render:()=>(0,y.jsx)(_i,{state:t,showPreview:i})}),{key:"page or url",render:t=>(0,y.jsx)(L.Z,{title:e,...t}),items:[o]}}),[t,s,n,a])}({state:t,url:c,isEmptyResults:!Boolean(d),pageStore:m}),g=function(e){const{state:t,url:s,pageStore:n}=e,{editingToken:o,title:l,focusTitleInput:d}=t,c=(0,a.VK)((()=>n?b.QaF(n.getTitleValue()):void 0),[n]);return(0,i.useMemo)((()=>{if(o)return{key:"link title",render:e=>(0,y.jsx)(L.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Link title",id:"selectionLinkButton.currentInfo.linkTitle"}),...e}),items:[{key:"update title",action:()=>{},render:()=>(0,y.jsx)(Ii,{title:l,defaultTitle:c??s,focus:d})}]}}),[o,l,d,s,c])}({state:t,url:c,pageStore:m}),h=function(e){const{state:t}=e,s=function(e){const{state:t}=e,s=(0,n.O7)();return(0,i.useMemo)((()=>{if(t.editingToken)return{key:"unlink",action:()=>{xi.PP(s);const e=(0,Si.Fs)(t);M.oSR(s,{type:"remove_link",url:e})},render:e=>(0,y.jsx)(Gt.Z,{...e,title:(0,y.jsx)(r.FormattedMessage,{id:"selectionLinkButton.removeLink",defaultMessage:"Remove link"}),icon:(0,at.y)({width:16})})}}),[t,s])}({state:t});return(0,i.useMemo)((()=>{const e=S.oA([s]);if(0!==e.length)return{key:"link actions",render:e=>(0,y.jsx)(L.Z,{topBorder:!0,...e}),items:e}}),[s])}({state:t});let f,v;return d?(v=1,f=S.oA([p,d])):(v=void 0,f=S.oA([p,g,h])),{initialFocus:v,sections:f}}function Wi(e,t,s,i){const n=(0,Mi.D)(s);if(!n)return;const{editingToken:a,savedTextSelectionState:o,title:r}=t;j.createAndCommit({userAction:"LinkMenu.handleLinkSelection",environment:e,perform:s=>{const l=xi.gp({environment:e,transaction:s,url:n,title:r,editingToken:a,savedTextSelectionState:o});l?(M.oSR(e,{type:"edit_link",url:n}),ji.Z.setState({...t,...l,url:"",focusLinkInput:!1,focusTitleInput:Boolean(i)})):(M.oSR(e,{type:"create_link",url:n}),ji.Z.reset())}})}var zi=s(96469),Ki=s(34583),Hi=s(56940);function Gi(){window.__c={n:"LinkMenu"};const e=(0,a.VK)((()=>ji.Z.state),[]),t=(0,n.Fy)(),s=(0,a.VK)(he.bq,[]),o=(0,a.VK)((()=>{if(!e.open)return!1;if(e.focusLinkInput||e.focusTitleInput)return!1;const t=_.default.state;if("editing"!==t.mode)return!0;const s=(0,C.QY)(t.multiSelection);if(!s)return!0;const{store:i,selection:n}=s;return(0,ei.wd)(n)?!b.oP(i.getValue(),n.startIndex,n.endIndex,b.GKr.Link):!(0,C._v)(t.multiSelection,e.savedTextSelectionState.multiSelection)}),[e]);return(0,i.useEffect)((()=>{o&&xi.F5()}),[o]),(0,y.jsx)(c.ZP,{popupType:t.isMobile?t.isTablet?c.ZP.PopupType.Popup:c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,style:{width:Ji(s)},keepFocus:t.isPhone,open:e.open,originRect:e.open?e.selectionRect:void 0,placementToOrigin:c.ZP.Placement.Bottom,alignmentToOrigin:c.ZP.Alignment.Center,originGap:8,disableContentScroll:!0,onDismiss:xi.F5,render:()=>e.open?(0,y.jsx)(qi,{state:e}):void 0,preventBlockRenderQueueOnEnter:!t.isMobile})}function qi(e){window.__c={n:"LinkMenuContent"};const{state:t}=e,s=(0,n.MO)(),[a,o]=(0,i.useState)(!0);if((0,i.useEffect)((()=>o(!1)),[]),t.showCreateIn&&!s)return(0,y.jsx)(Qi,{state:t});let l;return l=s?{menuType:m.og.Modal,title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Link",id:"selectionLinkButton.mobile.title"}),right:(0,y.jsx)(Pe.CancelMenuText,{}),onClickRight:xi.F5,footer:(0,y.jsx)(c.ZP,{popupType:c.ZP.PopupType.SlideUp,open:t.showCreateIn||!1,render:()=>(0,y.jsx)(Qi,{state:t})})}:{menuType:m.og.Popup},(0,y.jsxs)(Y.Z,{capture:t.open&&(a||t.focusLinkInput||t.focusTitleInput),allowEsc:!0,children:[(0,y.jsx)(d.Z,{...l,children:(0,y.jsx)(Hi.Z,{capture:s&&!t.focusLinkInput&&!t.focusTitleInput,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!0,render:()=>(0,y.jsx)(Yi,{state:t,useMenuList:Ui})})}),(0,y.jsx)(Q.Z,{capture:!0,onCommandSlash:Si.FV})]})}function Yi(e){window.__c={n:"LinkMenuList"};const{state:t,useMenuList:s}=e,{initialFocus:i,sections:n}=s({state:t});return(0,y.jsx)(B.Z,{type:B.i.Vertical,initialFocus:i,sections:n})}function Qi(e){var t;window.__c={n:"LinkCreateInMenu"};const{state:s}=e,o=(0,n.O7)(),r=(0,i.useCallback)((async e=>{var t;if(!Ki.M_(o))return;const i=null===(t=(0,C.QY)(s.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store;if(!i)return;const{performResult:{createInState:n}}=await j.createAndCommitAsync({environment:o,userAction:"LinkMenu.LinkCreateInMenu",waitForServerCommit:!0,perform:async t=>{const n=vi.f8({environment:o,transaction:t,titleText:s.url||"",createInValue:e,recordStoreParent:i}),[a]=n.createdPages;return a&&(xi.gp({environment:o,url:(0,yi.nR)({pageId:a.id}),transaction:t,editingToken:s.editingToken,savedTextSelectionState:s.savedTextSelectionState}),ji.Z.reset()),await n.moveToStorePromise,{createInState:n}}});await vi.c_({analyticsFrom:"link_menu",createInState:n})}),[s,o]),l=null===(t=(0,C.QY)(s.savedTextSelectionState.multiSelection))||void 0===t?void 0:t.store,d=l&&"block"===l.table?l.id:void 0,c=(0,a.VK)(he.bq,[]);return(0,y.jsx)(zi.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:r,captureSelection:!1,restoreSelection:!1,parentBlockId:d,onAutocompleteQueryChange:$i,autocompleteQuery:s.createInQuery||"",desktopWidth:Ji(c),onCancel:Xi})}function $i(e){const t=ji.Z.state;t.open&&ji.Z.setState({...t,createInQuery:e})}function Xi(){const e=ji.Z.state;e.open&&ji.Z.setState({...e,showCreateIn:!1,createInQuery:""})}function Ji(e){return e?400:330}var en=s(27153),tn=s(84939),sn=s(79362);const nn=(0,ks.I)("giphyLogo",{viewBox:"0 0 12 12",svg:(0,y.jsx)("path",{d:"M 1.332031 0 L 1.332031 12 L 10.667969 12 L 10.667969 4.332031 L 9.332031 5.667969 L 9.332031 10.667969 L 2.667969 10.667969 L 2.667969 1.335938 L 5 1.335938 L 6.332031 0 Z M 6.667969 0 L 6.667969 4 L 10.667969 4 L 10.667969 2.667969 L 9.332031 2.667969 L 9.332031 1.335938 L 8 1.335938 L 8 0 "})});var an=s(35840);const on=(0,ks.I)("shuffle",{viewBox:"0 0 16 16",svg:(0,y.jsx)("path",{d:"M0.162354 11.7542C0.162354 12.1365 0.458984 12.4067 0.867676 12.4067H2.41675C3.55054 12.4067 4.21631 12.0771 4.99414 11.1609L6.58936 9.26245L8.16479 11.1279C8.9624 12.0771 9.71387 12.4067 10.8477 12.4067H12.166V13.9954C12.166 14.3118 12.3572 14.4963 12.6736 14.4963C12.8186 14.4963 12.9504 14.4436 13.0625 14.3579L15.6465 12.2024C15.897 11.998 15.897 11.6816 15.6465 11.4641L13.0625 9.30859C12.9504 9.21631 12.8186 9.17017 12.6736 9.17017C12.3572 9.17017 12.166 9.34814 12.166 9.67114V11.095H10.8872C10.1094 11.095 9.60181 10.8379 9.0415 10.1655L7.43311 8.2605L9.0481 6.34888C9.62158 5.66992 10.083 5.42603 10.8477 5.42603H12.166V6.87622C12.166 7.19263 12.3572 7.3772 12.6736 7.3772C12.8186 7.3772 12.9504 7.32446 13.0625 7.23877L15.6465 5.08325C15.897 4.87891 15.897 4.5625 15.6465 4.34497L13.0625 2.18945C12.9504 2.09717 12.8186 2.05103 12.6736 2.05103C12.3572 2.05103 12.166 2.229 12.166 2.552V4.10767H10.8542C9.68091 4.10767 8.9624 4.43066 8.12524 5.43262L6.58936 7.25854L4.99414 5.36011C4.21631 4.44385 3.50439 4.11426 2.3772 4.11426H0.867676C0.458984 4.11426 0.162354 4.38452 0.162354 4.76685C0.162354 5.14917 0.458984 5.42603 0.867676 5.42603H2.32446C3.06274 5.42603 3.5769 5.68311 4.1438 6.35547L5.74561 8.2605L4.1438 10.1655C3.5769 10.8379 3.10229 11.095 2.37061 11.095H0.867676C0.458984 11.095 0.162354 11.3718 0.162354 11.7542Z"})});var rn=s(11751);const ln=(0,ks.I)("unsplashLogo",{viewBox:"0 0 12 12",svg:(0,y.jsx)("path",{d:"M3.75 3.375V0H8.25V3.375H3.75ZM8.25 5.25H12V12H0V5.25H3.75V8.625H8.25V5.25Z"})});var dn=s(91584),cn=s(96802),un=s(64964),mn=s(53471),pn=s(24405),gn=s(17809),hn=s(65187);function fn(e){window.__c={n:"AiSourcePickerQueryInput"};const{placeholder:t,onSubmit:s}=e,n=(0,pn.yK)((e=>({wrap:{flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:4,padding:"6px 10px",marginLeft:8,marginRight:8,overflow:"hidden",fontSize:14,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:{minHeight:60},placeholder:{minHeight:60}})),[]),a=(0,i.useCallback)((e=>{if(s&&!e.shiftKey)s();else{if("editing"!==_.default.state.mode)return}}),[s]);return(0,y.jsx)("div",{style:n.wrap,className:u.Wh_,children:(0,y.jsx)(hn.Z,{placeholder:t,disabled:!1,store:e.store,style:n.text,placeholderStyle:n.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!0,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:a,disableMobileActionBar:!1,disableDateReminderMentions:!0,disableStyleAnnotations:!0})})}var yn=s(6202);function vn(e){window.__c={n:"AiSourcePickerInputWrapper"};const{tab:t}=e,s=(0,n.O7)(),{store:a}=(0,gn.Cl)({initialValue:void 0,onChange:S.yR}),o=(0,pn.yK)((e=>({desktopStyle:{marginTop:8,marginBottom:6},sparkleStyle:{width:16,height:16,marginRight:4},captionStyle:{textAlign:s.device.isMobile?"left":"center"}})),[s.device.isMobile]),l=(0,i.useCallback)((async()=>{const s=a.getValue();if(!s)return;const i=[];for(const e of s){var n;if("‣"===e[0]&&null!==(n=e[1])&&void 0!==n&&n.length){if("d"===e[1][0][0]){const t=e[1][0][1].start_date;i.push(t)}else if("u"===e[1][0][0]){const t=e[1][0][1],{currentSpaceStore:s}=ie.default.state;if(!s)return{users:[],bots:[]};const n=Bt.U6.createChildStore(s,{table:$s.KJ,id:t});await n.load();const a=n.getEmail();i.push(a||"")}}else i.push(e[0])}const o=i.join(""),r=t.integration;if(o){e.store.setState({...e.store.state,loading:!0});const s=await t.getResults(o,r);e.store.setState({...e.store.state,loading:!1,result:s.results})}}),[a,e.store,t]);return(0,y.jsxs)("div",{children:[(0,y.jsx)(L.Z,{desktopStyle:o.desktopStyle,children:(0,y.jsx)(fn,{placeholder:e.placeholder,onSubmit:l,store:a})}),(0,y.jsx)(L.Z,{children:(0,y.jsx)(yn.Z,{onClick:l,title:t.buttonText||(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Ask",id:"mediaPicker.aiSourcePickerTab.askButtonText"}),(0,y.jsx)("div",{children:(0,rn.t)(o.sparkleStyle)})]}),fullWidth:e.isSmallWidth})}),t.caption&&(0,y.jsx)(D.Z,{shouldWrapCaption:!0,caption:t.caption,style:o.captionStyle})]})}var xn=s(42922),Sn=s(949),bn=s(51077),Mn=s(91839),wn=s(63296),jn=s(77137),Cn=s(30506),kn=s(91718),_n=s(23321);const Tn=(0,ks.I)("colorPickerCircle",{viewBox:"0 0 32 32",svg:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("circle",{cx:"16",cy:"16",r:"14",strokeWidth:"3",fill:"none"}),(0,y.jsx)("circle",{cx:"16",cy:"16",r:"14",opacity:"0.9"})]})});var In=s(73063),Pn=s(86825),Zn=s(57670);const Fn=(0,r.defineMessages)({selectSpecificIconColor:{defaultMessage:"Select icon color {iconColor}",id:"iconPickerColorPicker.selectSpecificColor"},selectIconColor:{defaultMessage:"Select icon color",id:"iconPickerColorPicker.selectColor"},selectIconColorWithCurrentColor:{defaultMessage:"Select icon color, {iconColor} selected",id:"iconPickerColorPicker.selectColorWithCurrentColor"},noIconColor:{defaultMessage:"no color",id:"iconPickerColorPicker.noColor"}});function An(){window.__c={n:"IconPickerColorPicker"};const e=(0,a.VK)((()=>{var e;return null===(e=ie.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.icon_picker_color}),[]),t=(0,r.useIntl)(),s=(0,n.O7)(),i=(0,pn.Fg)(),o=(0,n.Fy)(),l=(0,a.qz)(void 0,J.Z);return(0,y.jsx)($.Z,{renderTooltip:()=>t.formatMessage(Fn.selectIconColor),placement:$.Z.Placement.Bottom,render:n=>(0,y.jsx)(q.ZP,{preventBlockRenderQueueOnEnter:!0,buttonPopupStore:l,popupType:q.Z4.Popup,renderOrigin:s=>(0,y.jsx)(se.DO,{ariaLabel:t.formatMessage(Fn.selectIconColorWithCurrentColor,{iconColor:t.formatMessage(e?sn.RR[e]:Fn.noIconColor)}),icon:t=>Tn({...t,stroke:e?sn.Lr[i.mode][e]:sn.Lr[i.mode].lightgray,fill:e?sn.Lr[i.mode][e]:i.lightIconColor}),...(0,X.Z)(s,n)}),render:n=>function(e){const{parent:t,environment:s,currentIconPickerColor:i,theme:n,device:a,intl:o}=e,l=sn.Oe.map((e=>({key:e,action:i=>{t.close(),Dn({environment:s,color:e})},render:t=>(0,y.jsx)($.Z,{renderTooltip:()=>o.formatMessage(sn.RR[e]),placement:$.Z.Placement.Bottom,render:s=>(0,y.jsx)(In.Z,{...(0,X.Z)(s,t),ariaLabel:o.formatMessage(Fn.selectSpecificIconColor,{iconColor:o.formatMessage(sn.RR[e])}),style:{...a.isMobile?{width:Zn.Z.mobileButtonSize,height:Zn.Z.mobileButtonSize}:{width:Zn.Z.desktopButtonSize,height:Zn.Z.desktopButtonSize}},icon:t=>Tn({...t,height:a.isMobile?18:14,width:a.isMobile?18:14,stroke:sn.Lr[n.mode][e],fill:sn.Lr[n.mode][e]})})})})));return l.push({key:"askEveryTime",action:()=>{t.close(),Dn({environment:s,color:void 0})},render:e=>(0,y.jsx)(Pn.Z,{...e,title:(0,y.jsx)(r.FormattedMessage,{id:"iconPickerColorPicker.askEveryTime",defaultMessage:"Ask every time"}),onClick:()=>{Dn(void 0!==i?{environment:s,color:void 0}:{environment:s,color:"gray"})},on:void 0===i,style:{boxShadow:void 0},textWrapperStyle:{marginLeft:a.isMobile?10:6},rightStyle:{marginRight:4}})}),(0,y.jsx)(Y.Z,{capture:!0,allowEsc:!0,children:(0,y.jsx)(B.Z,{type:B.i.Grid,itemsPerRow:5,initialFocus:i?Math.max(sn.Oe.indexOf(i),0):10,sections:[{key:"variations",render:e=>(0,y.jsx)("div",{...e}),items:l}],renderRow:(e,t)=>(0,y.jsx)("div",{style:{display:"flex",padding:4,...t<2&&void 0===i&&{opacity:.5},...2===t&&{padding:"0 0 4px 0",flexDirection:"row-reverse"}},children:e},t)})})}({parent:n,environment:s,currentIconPickerColor:e,theme:i,device:o,intl:t})})})}function Dn(e){const{environment:t,color:s}=e,{currentUserSettingsStore:i}=ie.default.state;i&&j.createAndCommit({userAction:"mediaPicker.setIconPickerColor",environment:t,perform:e=>{const t=void 0!==s?s:null;te.d2({userSettingsStore:i,transaction:e,data:{icon_picker_color:t}})}})}var Bn=s(78948),Rn=s(5385),Ln=s(45567),Nn=s(75538);class En extends W.default{getInitialState(){return{inputValue:"",focus:!1,result:void 0,loading:!1,hover:""}}}const On=En;var Vn=s(4391),Un=s(33846),Wn=s(91390),zn=s(78291),Kn=s(13627),Hn=s(3403),Gn=s(12981),qn=s(16354),Yn=s(81865),Qn=s(62385);function $n(){const{device:e,WindowSizeStore:t}=(0,n.O7)();return(0,pn.yK)((s=>({galleryWrap:{display:"flex",flexWrap:"wrap",alignContent:"flex-start",background:s.popoverBackground,paddingTop:e.isPhone?12:0,paddingBottom:e.isPhone?12:0,paddingLeft:e.isPhone?t.getSafePaddingLeftCSS(14):12,paddingRight:e.isPhone?t.getSafePaddingRightCSS(14):12,boxShadow:e.isPhone?`0 1px 0 ${s.regularDividerColor}`:""}})),[t,e])}function Xn(e){let{pageCover:t,tab:s}=e;window.__c={n:"GalleryItem"};const{coverUrl:n,title:a,subtitle:o,position:r}=t,l=(0,pn.yK)((e=>({container:{width:"25%",padding:3},tooltip:{maxWidth:180,whiteSpace:"normal"},title:{color:e.regularInvertedTextColor},subtitle:{color:e.mediumInvertedTextColor},buttonHover:{opacity:.85},imageBox:{width:"100%",height:64,objectFit:"cover",objectPosition:`center ${100*(r||0)}%`,borderRadius:3}})),[r]),d=(0,i.useCallback)((()=>{s.onChange({url:n,position:r})}),[s,n,r]);return(0,y.jsx)("div",{style:l.container,children:(0,y.jsx)($.Z,{originGap:0,placement:$.Z.Placement.Bottom,delayThreshold:600,renderTooltip:()=>(0,y.jsxs)("div",{style:l.tooltip,children:[(0,y.jsx)("span",{style:l.title,children:E.default.formatMessage(a)})," ",(0,y.jsx)("span",{style:l.subtitle,children:o&&E.default.formatMessage(o)})]}),render:e=>(0,y.jsx)(G.Z,{hoveredStyle:l.buttonHover,...e,onClick:d,children:(0,y.jsx)(Yn.Z,{url:n,width:200,isAuthenticated:!1,render:(e,t)=>t&&(0,y.jsx)(Gn.Z,{src:t,style:l.imageBox})})})})})}const Jn=function(e){let{tab:t}=e;window.__c={n:"GalleryMediaPickerTab"};const[s,n]=(0,i.useState)({}),[a,o]=(0,i.useState)(!1);(0,i.useEffect)((()=>{(async()=>{o(!0),await p.deps.pageCovers.loader().then((e=>{n(e.default),o(!1)}))})()}),[]);const r=$n(),l=(0,pn.yK)((e=>({container:{paddingBottom:8},groupTitle:{marginLeft:-5},loader:{height:300}})),[]);return a?(0,y.jsx)("div",{style:l.loader,children:(0,y.jsx)(Hn.Z,{})}):(0,y.jsx)("div",{style:l.container,children:S.UI(s,((e,s)=>(0,y.jsx)(L.Z,{title:(0,y.jsx)(qn.Z,{style:l.groupTitle,href:e.url,external:!0,children:(0,y.jsx)(Qn.Z,{children:E.default.formatMessage(e.title)})}),isTitleUppercase:!0,noTextOverflow:!0,children:(0,y.jsx)("div",{style:r.galleryWrap,children:e.items.map(((e,s)=>(0,y.jsx)(Xn,{pageCover:e,tab:t},s)))})},s)))})};var ea=s(54642),ta=s(42402);const sa=(0,r.defineMessages)({giphyPlaceholder:{id:"mediaPicker.giphyPlaceholder.text",defaultMessage:"Search GIPHY"}});function ia(e){window.__c={n:"GiphyResults"};const{tab:t,results:s,ready:n,isSmallWidth:a,giphyRandomId:o}=e,l=(0,pn.yK)((e=>({loading:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1},captionMenuItem:{textAlign:a?"left":"center",color:e.mediumTextColor}})),[a]);return n?!s||s&&!s.length?(0,y.jsx)(D.Z,{shouldWrapCaption:!0,caption:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.giphy.noResultsText"}),style:l.captionMenuItem}):(0,y.jsxs)(i.Fragment,{children:[s.map(((e,s)=>(0,y.jsx)(na,{tab:t,image:e,giphyRandomId:o},s))),(0,y.jsx)(D.Z,{shouldWrapCaption:!0,caption:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.giphy.searchText"}),style:l.captionMenuItem})]}):(0,y.jsx)("div",{style:l.loading,children:(0,y.jsx)(Vs.Z,{})})}function na(e){var t;let{tab:s,image:a,giphyRandomId:o}=e;window.__c={n:"RenderedGiphyImage"};const l=(0,n.O7)(),{device:d}=l,c=(0,pn.yK)((e=>({container:{width:d.isMobile?"33%":"25%",padding:3},hoveredButton:{opacity:.85},imageBox:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:3},label:{marginTop:2,marginBottom:4}})),[d.isMobile]),u=(0,i.useCallback)((async()=>{var e;if(s.onChange({url:a.imageUrl}),null!==(e=a.analytics)&&void 0!==e&&e.onclick)try{var t;await ea.postGiphyAnalytics(l,{url:null===(t=a.analytics)||void 0===t?void 0:t.onclick.url,timestamp:Date.now(),random_id:o})}catch(i){}}),[l,o,a.imageUrl,s,null===(t=a.analytics)||void 0===t?void 0:t.onclick]);return(0,y.jsxs)("div",{style:c.container,children:[(0,y.jsx)(G.Z,{hoveredStyle:c.hoveredButton,onClick:u,children:(0,y.jsx)(Gn.Z,{src:a.thumbUrl,style:c.imageBox})}),(0,y.jsx)(Jt.Z,{isSmall:!0,isSecondaryColor:!0,style:c.label,children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.giphy.byAuthor",values:{authorName:a.authorName||"GIPHY",inlinetextlink:e=>(0,y.jsx)(ta.Z,{external:!0,href:a.imageUrl,children:e})}})})]},a.id)}const aa=function(e){let{tab:t,isSmallWidth:s}=e;window.__c={n:"GiphyMediaPickerTab"};const[a,o]=(0,i.useState)(""),[r,l]=(0,i.useState)(""),d=(0,n.O7)(),{device:c}=d,u=$n(),m=(0,i.useCallback)((async()=>{if(!S.xb(a))return a;const e=await ea.getGiphyRandomId(d,{});return"success"===e.type?(o(e.data.random_id),e.data.random_id):void 0}),[d,a]);return(0,y.jsxs)("div",{style:{paddingBottom:8},children:[(0,y.jsx)(L.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,y.jsx)(se.ZP,{value:r,placeholder:E.default.formatMessage(sa.giphyPlaceholder),showClearButton:!0,focus:!c.isMobile||void 0,onChange:e=>l(e.target.value)})}),(0,y.jsx)("div",{style:u.galleryWrap,children:(0,y.jsx)(jn.Z,{request:r,debounce:Ei.vp,performRequest:async e=>{await m();const t=await ea.searchGiphyImages(d,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(e,i,n)=>(0,y.jsx)(ia,{tab:t,results:i,ready:n,isSmallWidth:s,giphyRandomId:a})})})]})};var oa=s(24608);const ra=(0,r.defineMessages)({unsplashPlaceholder:{id:"mediaPicker.unsplashPlaceholder.text",defaultMessage:"Search for an image…"}});function la(e){window.__c={n:"UnsplashResults"};const{tab:t,results:s,ready:n,isSmallWidth:a}=e,o=(0,pn.yK)((e=>({loading:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:320,flex:1},captionMenuItem:{textAlign:a?"left":"center",color:e.mediumTextColor}})),[a]);return n?!s||s&&!s.length?(0,y.jsx)(D.Z,{shouldWrapCaption:!0,caption:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.unsplash.noResultsText"}),style:o.captionMenuItem}):(0,y.jsxs)(i.Fragment,{children:[s.map(((e,s)=>(0,y.jsx)(da,{tab:t,image:e},s))),(0,y.jsx)(D.Z,{shouldWrapCaption:!0,caption:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Search to find more results.",id:"mediaPicker.unsplash.searchText"}),style:o.captionMenuItem})]}):(0,y.jsx)("div",{style:o.loading,children:(0,y.jsx)(Vs.Z,{})})}function da(e){let{tab:t,image:s}=e;window.__c={n:"RenderedUnsplashImage"};const a=(0,n.O7)(),{device:o}=a,l=(0,i.useCallback)((async()=>{const e=await(0,oa.ZP)({environment:a,url:s.downloadUrl,method:"GET",format:"json"});"success"===e.type&&t.onChange({url:e.data.url})}),[a,s.downloadUrl,t]);return(0,y.jsxs)("div",{style:{width:o.isMobile?"33%":"25%",padding:3},children:[(0,y.jsx)(G.Z,{hoveredStyle:{opacity:.85},onClick:l,children:(0,y.jsx)(Gn.Z,{src:s.thumbUrl,style:{width:"100%",height:64,objectFit:"cover",objectPosition:"center 0%",borderRadius:3}})}),(0,y.jsx)(Jt.Z,{isSmall:!0,isSecondaryColor:!0,style:{marginTop:2,marginBottom:4},children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"by <inlinetextlink>{authorName}</inlinetextlink>",id:"mediaPicker.unsplash.byAuthor",values:{authorName:s.authorName,inlinetextlink:e=>(0,y.jsx)(ta.Z,{external:!0,href:s.unsplashUrl,children:e})}})})]},s.id)}const ca=function(e){let{tab:t,isSmallWidth:s}=e;window.__c={n:"UnsplashMediaPickerTab"};const[a,o]=(0,i.useState)(""),r=(0,n.O7)(),{device:l}=r,d=$n();return(0,y.jsxs)("div",{style:{paddingBottom:8},children:[(0,y.jsx)(L.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,y.jsx)(se.ZP,{value:a,placeholder:E.default.formatMessage(ra.unsplashPlaceholder),showClearButton:!0,focus:!l.isMobile||void 0,onChange:e=>o(e.target.value)})}),(0,y.jsx)("div",{style:d.galleryWrap,children:(0,y.jsx)(jn.Z,{request:a,debounce:Ei.vp,performRequest:async e=>{const t=await ea.searchUnsplashImages(r,{query:e,page:0});if("success"===t.type)return t.data.results;throw t.error},render:(e,i,n)=>(0,y.jsx)(la,{tab:t,results:i,ready:n,isSmallWidth:s})})})]})},ua=(0,r.defineMessages)({embedPlaceholder:{id:"mediaPicker.embedPlaceholder.text",defaultMessage:"Paste in https://…"},filterPlaceholder:{id:"mediaPicker.emojiFilter.text",defaultMessage:"Filter…"},aiSourcePickerPlaceholder:{id:"mediaPicker.githubPlaceholder.text",defaultMessage:"Ask query here"},aiIsFetchingLoader:{id:"mediaPicker.aiIsFetchingLoader.text",defaultMessage:"Ai is fetching"}});class ma extends o.Z{constructor(){super(...arguments),this.menuRef=i.createRef(),this.storeTypes={embedInputStore:Un.Z,emojiInputStore:Un.Z,iconInputStore:Un.Z,iconPickerStore:Vn.Z,aiSourcePickerStore:On},this.handleEmbedSubmit=e=>()=>{const t=this.stores.embedInputStore.state.inputValue;if(t){const s=(0,Cs.Wv)(t,ys.default.secureFileS3.url,ys.default.secureFileS3V2.url,ys.default.secureFileConfig.rootPath,ys.default.secureFileConfig.hostname),i=s?s.link:t;e.onChange(i),M.bOx(this.environment,{pastedText:i,source:"media_picker"})}},this.handleAiSourcePickerSubmit=(e,t)=>()=>{e&&t.onChange(e)},this.handleSwipeLeft=()=>{if(!Wn.Z.state.isActive)return;const e=this.getTabs(),t=e.map((e=>e.type)).indexOf(Wn.Z.state.currentTab),s=e[t+1];void 0!==s&&this.handleTabChange(s.type)},this.handleSwipeRight=()=>{if(!Wn.Z.state.isActive)return;const e=this.getTabs(),t=e.map((e=>e.type)).indexOf(Wn.Z.state.currentTab),s=e[t-1];void 0!==s&&this.handleTabChange(s.type)},this.handleTabChange=e=>{Wn.Z.state.isActive&&(Wn.Z.setState({...Wn.Z.state,currentTab:e}),"icon"===e&&Wn.Z.state.recordIconLoggingData&&M.kz9(this.environment,"select_icon_tab",Wn.Z.state.recordIconLoggingData))},this.handleRandomEmojiClick=()=>{const{device:e}=this.environment,t=this.getTabs().find((e=>e.type===this.props.currentTab));if(t&&"emoji"===t.type){const s=cn.zM();t.onChange(s,{keepVisible:!e.isMobile})}},this.handleRandomIconClick=()=>{const{device:e}=this.environment,{iconPickerStore:t}=this.stores,s=this.getTabs().find((e=>e.type===this.props.currentTab));if(s&&"icon"===s.type){const i=s.enforceIconColor??Rn.x(),n=`/icons/${S.UP(Object.keys(t.getState().allIcons))}_${i??S.UP(sn.Oe)}.svg`;s.onChange(n,{keepVisible:!e.isMobile})}},this.handleFilterChange=e=>{const{emojiInputStore:t,iconInputStore:s,iconPickerStore:i}=this.stores,n=this.getNumIconPerRow()*(this.environment.device.isMobile?T.pq:T.II),a=this.getNumIconPerRow()*(this.environment.device.isMobile?_n.L6:_n.OF);t.setState({...t.state,inputValue:e.currentTarget.value}),H.setState({...H.state,loadEmojiCount:n}),s.setState({...s.state,inputValue:e.currentTarget.value}),i.setState({...i.state,loadIconCount:a})}}renderComponent(){const{device:e}=this.environment,t=this.renderTabsHeader(),s=this.renderInputHeader(),n=(t||s)&&(0,y.jsxs)(i.Fragment,{children:[t,s]});let a;if(e.isMobile)a={menuType:m.og.Modal,title:this.props.title,header:n,right:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Close",id:"mediaPicker.mobileCloseButton.label"}),onClickRight:this.props.onCancel,left:this.props.onDelete&&(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Remove",id:"mediaPicker.mobileRemoveButton.label"}),onClickLeft:this.props.onDelete};else{a={menuType:m.og.Popup,header:n};const e=this.getTabs().find((e=>e.type===this.props.currentTab)),t=e&&"custom"===e.type?e.tabHeight:void 0;a.width=this.props.popupWidth||300,a.height=t||this.props.popupHeight,a.maxHeight=this.props.maxHeight,a.maxWidth=this.props.maxWidth}return(0,y.jsx)(Cn.Z,{onSwipeLeft:this.handleSwipeLeft,onSwipeRight:this.handleSwipeRight,render:e=>(0,y.jsx)(d.Z,{...a,...e,className:u.tQh,innerRef:this.menuRef,children:this.renderCurrentTab()})})}renderTabsHeader(){const{device:e}=this.environment;if(!(this.getTabs().length<=1)||this.props.onDelete){const t={gallery:(0,y.jsx)(r.FormattedMessage,{id:"mediaPicker.tabs.gallery",defaultMessage:"Gallery"}),embed:(0,y.jsx)(r.FormattedMessage,{id:"mediaPicker.tabs.embedLink",defaultMessage:"Embed link"}),file:(0,y.jsx)(r.FormattedMessage,{id:"mediaPicker.tabs.upload",defaultMessage:"Upload"}),emoji:(0,y.jsx)(r.FormattedMessage,{id:"mediaPicker.tabs.emoji",defaultMessage:"Emoji"}),icon:(0,y.jsx)(r.FormattedMessage,{id:"mediaPicker.tabs.icon",defaultMessage:"Icon"}),custom:(0,y.jsx)(r.FormattedMessage,{id:"mediaPicker.tabs.custom",defaultMessage:"Custom"}),unsplash:(0,y.jsxs)(i.Fragment,{children:[ln({width:12,marginRight:4,height:12}),(0,y.jsx)("span",{children:"Unsplash"})]}),giphy:(0,y.jsxs)(i.Fragment,{children:[nn({width:12,marginRight:4,height:12}),(0,y.jsx)("span",{children:"GIPHY"})]}),drive:(0,y.jsx)(r.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),box:(0,y.jsx)(r.FormattedMessage,{id:"mediaPicker.tabs.browse",defaultMessage:"Browse"}),aiSourcePicker:(0,y.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,y.jsx)(r.FormattedMessage,{id:"mediaPicker.tabs.ask",defaultMessage:"Ask"}),(0,rn.t)({width:16,height:16,marginRight:4,color:this.theme.accentColors.purple[400]})]})},s=this.getTabs(),n=s.findIndex((e=>e.type===this.props.currentTab)),a=s.map((e=>e.title||t[e.type])),o=s.find((e=>e.type===this.props.currentTab)),l=o&&"emoji"!==o.type&&e.isAndroid;return(0,y.jsx)(Fe.Z,{tabs:a,selectedIndex:n,onChange:e=>{const t=s[e];this.handleTabChange(t.type)},right:this.props.onDelete&&!e.isMobile&&(0,y.jsx)(Ws.Z,{isGray:!0,onClick:this.props.onDelete,children:(0,y.jsx)(r.FormattedMessage,{id:"mediaPicker.tabs.remove",defaultMessage:"Remove"})}),style:{...l&&{borderBottom:"none"}}})}}renderInputHeader(){const{isPhone:e,isMobile:t,isAndroid:s}=this.environment.device,i=this.getTabs().find((e=>e.type===this.props.currentTab));if(i&&("emoji"===i.type||"icon"===i.type)){const n="emoji"===i.type?this.stores.emojiInputStore.state.inputValue:this.stores.iconInputStore.state.inputValue,a="emoji"===i.type?this.handleRandomEmojiClick:this.handleRandomIconClick,o=this.renderColorPicker({hasRandomButtonOnLeft:!i.hideRandomButton});return(0,y.jsx)("div",{style:{display:"flex",...e?{}:{marginTop:16,marginBottom:10}},children:(0,y.jsx)(se.ZP,{value:n,placeholder:E.default.formatMessage(ua.filterPlaceholder),autoFocus:!t||void 0,focus:!t||void 0,showClearButton:!0,inputLeft:(0,y.jsx)(se.f_,{icon:an.R}),onChange:this.handleFilterChange,right:(0,y.jsxs)("div",{style:{display:"flex"},children:[null!=i&&i.hideRandomButton?void 0:(0,y.jsx)($.Z,{renderTooltip:()=>(0,y.jsx)(r.FormattedMessage,{id:"mediaPicker.emojiTab.random",defaultMessage:"Random"}),placement:$.Z.Placement.Bottom,render:e=>(0,y.jsx)(se.DO,{icon:on,onClick:a,...e})}),o]}),isRightLastElementOfInput:!0,style:{...s&&{borderBottom:"none"}}})})}}renderColorPicker(e){const t=this.getTabs().find((e=>e.type===this.props.currentTab));if(!t)return null;let s;return"emoji"===(null==t?void 0:t.type)?s=(0,y.jsx)(ne,{}):"icon"===(null==t?void 0:t.type)&&void 0===t.enforceIconColor&&(s=(0,y.jsx)(An,{})),e.hasRandomButtonOnLeft&&s?(0,y.jsx)("div",{style:{marginLeft:6},children:s}):s}renderCurrentTab(){const e=this.getTabs().find((e=>e.type===this.props.currentTab));if(!e)return(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Uh oh! Something went wrong.",id:"mediaPicker.errorMessage"});switch(e.type){case"embed":return this.renderEmbedTab(e);case"file":return this.renderUploadTab(e);case"emoji":return this.renderEmojiTab(e);case"icon":return this.renderIconTab(e);case"gallery":return(0,y.jsx)(Jn,{tab:e});case"unsplash":return(0,y.jsx)(ca,{tab:e,isSmallWidth:this.props.isSmallWidth});case"giphy":return(0,y.jsx)(aa,{tab:e,isSmallWidth:this.props.isSmallWidth});case"drive":return this.renderGoogleDriveTab(e);case"box":return this.renderBoxTab(e);case"aiSourcePicker":return this.renderAiSourcePickerTab(e);case"custom":return this.renderCustomEmbedUploadTab(e)}}renderEmojiTab(e){return(0,y.jsx)(me,{onSubmit:e.onChange,filter:this.stores.emojiInputStore.state.inputValue||"",isCallout:this.props.isCallout,iconLoggingData:this.props.recordIconLoggingData,menuRef:this.menuRef})}renderIconTab(e){return(0,y.jsx)(_n.ZP,{store:this.stores.iconPickerStore,filter:this.stores.iconInputStore.state.inputValue||"",onSubmit:e.onChange,iconLoggingData:this.props.recordIconLoggingData,enforceIconColor:e.enforceIconColor,menuRef:this.menuRef})}renderCustomEmbedUploadTab(e){const{device:t}=this.environment,{data:s}=zn.default.state,i=(0,y.jsx)(xn.Z,{onClick:this.handleEmbedSubmit(e),disabled:0===this.stores.embedInputStore.state.inputValue.length,hovered:!1,children:e.buttonText||(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"})}),n=(0,y.jsx)(L.Z,{desktopStyle:{marginTop:16,display:"flex",paddingTop:0,paddingBottom:12},children:(0,y.jsx)(se.ZP,{type:"url",value:this.stores.embedInputStore.state.inputValue,placeholder:e.inputPlaceholder||E.default.formatMessage(ua.embedPlaceholder),autoFocus:!t.isMobile||void 0,showClearButton:!0,focus:!t.isMobile||void 0,onSubmit:this.handleEmbedSubmit(e),onChange:e=>{this.stores.embedInputStore.setState({...this.stores.embedInputStore.state,inputValue:e.target.value})},inputRight:t.isPhone?i:void 0,right:t.isPhone?void 0:i,isRightLastElementOfInput:!0})}),a=(0,y.jsx)(Sn.Q,{type:this.getAllowedFileTypeFromTab(e)??Ln.gU,dropTargetKey:"uploadTab",onDropFile:t=>{"invalidFileDrop"!==t.type?e.onUpload(t.file):un.oV({label:(0,y.jsx)(r.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})})},dropzoneStyle:{background:(0,P.fn)([P.ZP.blueWithAlpha(.14),(0,tn.Fq)(this.theme.contentBackground,.5)])},children:(0,y.jsxs)("div",{style:{marginTop:-24,paddingTop:24},children:[e.fileUpload&&(0,y.jsx)(L.Z,{desktopStyle:{marginTop:this.props.isSmallWidth?8:24},children:(0,y.jsx)(yn.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>this.handleUpload(e),fullWidth:this.props.isSmallWidth})}),this.renderMediaCapture(e),e.caption&&(0,y.jsx)(D.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}),e.preventUploadLimitFreeFileSize||s&&Kn.YK(s)&&(0,y.jsx)("div",{style:{height:8}}),s&&!e.preventUploadLimitFreeFileSize&&!Kn.YK(s)&&(0,y.jsx)(D.Z,{shouldWrapCaption:!0,caption:(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:this.props.isSmallWidth?"flex-start":"center"},children:[(0,y.jsx)("div",{style:{marginRight:6,color:this.theme.mediumTextColor},children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:mn.K_}})}),!Nn.default.isOnboarding.state&&(0,y.jsx)(kn.Z,{subscriptionTier:Kn.M9(this.environment)||"plus",onClick:()=>{this.props.onCancel&&this.props.onCancel()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}})]})})]})});return(0,y.jsxs)(y.Fragment,{children:[n,a]})}renderUploadTab(e){const{data:t}=zn.default.state;return(0,y.jsx)(Sn.Q,{type:this.getAllowedFileTypeFromTab(e)??Ln.gU,dropTargetKey:"uploadTab",onDropFile:t=>{"invalidFileDrop"!==t.type?e.onUpload(t.file):un.oV({label:(0,y.jsx)(r.FormattedMessage,{id:"mediaPicker.invalidImageDrop.wrongTypeErrorMessage",defaultMessage:"Sorry, that file type is not supported."})})},dropzoneStyle:{background:(0,P.fn)([P.ZP.blueWithAlpha(.14),(0,tn.Fq)(this.theme.contentBackground,.5)])},children:(0,y.jsxs)("div",{style:{marginTop:-24,paddingTop:24},children:[e.fileUpload&&(0,y.jsx)(L.Z,{desktopStyle:{marginTop:this.props.isSmallWidth?8:24},children:(0,y.jsx)(yn.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Choose a file",id:"mediaPicker.chooseFile.button.label"}),onClick:()=>this.handleUpload(e),fullWidth:this.props.isSmallWidth})}),this.renderMediaCapture(e),e.caption&&(0,y.jsx)(D.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}),e.preventUploadLimitFreeFileSize||t&&Kn.YK(t)&&(0,y.jsx)("div",{style:{height:8}}),t&&!e.preventUploadLimitFreeFileSize&&!Kn.YK(t)&&(0,y.jsx)(D.Z,{shouldWrapCaption:!0,caption:(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:this.props.isSmallWidth?"flex-start":"center"},children:[(0,y.jsx)("div",{style:{marginRight:6,color:this.theme.mediumTextColor},children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"The maximum size per file is {filesize} MB.",id:"mediaPicker.maximumFileSize.notice",values:{filesize:mn.K_}})}),!Nn.default.isOnboarding.state&&(0,y.jsx)(kn.Z,{subscriptionTier:Kn.M9(this.environment)||"plus",onClick:()=>{this.props.onCancel&&this.props.onCancel()},analyticsName:"media_picker",desktopStyle:{marginBottom:1}})]})})]})})}renderMediaCapture(e){if(e.imageUpload||e.videoUpload)return(0,y.jsxs)(L.Z,{desktopStyle:{marginTop:4,display:"flex",justifyContent:"center",marginRight:12,marginLeft:12},children:[e.imageUpload&&(0,y.jsx)(wn.Z,{isLarge:!0,onClick:()=>this.handleUpload(e,"image/*"),style:{width:"100%"},children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Upload file",id:"mediaPicker.chooseImage.buttonText"})}),e.videoUpload&&(0,y.jsx)(yn.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Choose a video",id:"mediaPicker.chooseVideo.buttonText"}),onClick:()=>this.handleUpload(e,"video/*"),fullWidth:this.props.isSmallWidth})]})}renderEmbedTab(e){const{device:t}=this.environment;return(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)(L.Z,{desktopStyle:{marginTop:8,marginBottom:6},children:(0,y.jsx)(se.ZP,{type:"url",value:this.stores.embedInputStore.state.inputValue,placeholder:e.inputPlaceholder||E.default.formatMessage(ua.embedPlaceholder),autoFocus:!t.isMobile||void 0,showClearButton:!0,focus:!t.isMobile||void 0,onSubmit:this.handleEmbedSubmit(e),onChange:e=>{this.stores.embedInputStore.setState({...this.stores.embedInputStore.state,inputValue:e.target.value})}})}),(0,y.jsx)(L.Z,{children:(0,y.jsx)(yn.Z,{onClick:this.handleEmbedSubmit(e),title:e.buttonText||(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Link",id:"mediaPicker.embedTab.embedLinkButtonText"}),fullWidth:this.props.isSmallWidth})}),e.caption&&(0,y.jsx)(D.Z,{shouldWrapCaption:!0,caption:e.caption,style:{textAlign:t.isMobile?"left":"center"}})]})}renderGoogleDriveTab(e){return"accounts"in e?this.renderGoogleDriveAccounts(e):(0,y.jsx)(jn.Z,{request:this.environment,performRequest:dn.vQ,render:(t,s,i)=>{if(!i)return(0,y.jsx)(L.Z,{children:(0,y.jsx)(Bn.Z,{})});const n=s&&s.accounts?s.accounts:[];return this.renderGoogleDriveAccounts(e,n)}})}renderGoogleDriveAccounts(e,t){return"accounts"in e?e.accounts&&0===e.accounts.length?this.renderGoogleDriveConnectAccountOption(e):(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)(L.Z,{children:e.accounts.map(((t,s)=>(0,y.jsx)(Gt.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.account_name}}),onClick:()=>e.onSelect(t),focused:!1},t.account_key)))}),(0,y.jsx)(L.Z,{topBorder:!0,children:(0,y.jsx)(Gt.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1})})]}):t?0===t.length?this.renderGoogleDriveConnectAccountOption(e):(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)(L.Z,{children:t.map(((t,s)=>(0,y.jsx)(Gt.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.accountName}}),onClick:()=>e.onSelect(t),focused:!1},t.accountId)))}),(0,y.jsx)(L.Z,{topBorder:!0,children:(0,y.jsx)(Gt.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreGoogleAccounts.label"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1})})]}):void 0}renderGoogleDriveConnectAccountOption(e){return(0,y.jsxs)(L.Z,{children:[(0,y.jsx)(Gt.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Connect Google account",id:"mediaPicker.menuItem.connectFirstGoogleAccount.label"}),onClick:()=>e.onSelect(),focused:!1,style:{color:this.theme.blueColor}}),(0,y.jsx)(D.Z,{shouldWrapCaption:!1,caption:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Find and embed your Google Drive files.",id:"mediaPicker.menuItem.connectFirstGoogleAccount.caption"})})]})}renderAiSourcePickerTab(e){var t,s;return(0,y.jsxs)(i.Fragment,{children:[this.stores.aiSourcePickerStore.state.result&&!1===this.stores.aiSourcePickerStore.state.loading&&(0===(null===(t=this.stores.aiSourcePickerStore.state.result)||void 0===t?void 0:t.length)?(0,y.jsx)(D.Z,{shouldWrapCaption:!0,caption:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"No results found.",id:"mediaPicker.aiSourcePicker.noResultsText"}),style:{textAlign:this.props.isSmallWidth?"left":"center",color:this.theme.mediumTextColor}}):null===(s=this.stores.aiSourcePickerStore.state.result)||void 0===s?void 0:s.map((t=>(0,y.jsxs)("div",{style:{cursor:"pointer",color:this.theme.mediumTextColor,textAlign:"left",hyphens:"auto",padding:"10px 8px",backgroundColor:this.stores.aiSourcePickerStore.state.hover===t.url?"rgba(55,53,47,0.08)":"",display:"flex",flexDirection:"row"},onClick:this.handleAiSourcePickerSubmit(t.url,e),onMouseEnter:()=>{this.stores.aiSourcePickerStore.setState({...this.stores.aiSourcePickerStore.state,hover:t.url})},children:[(0,y.jsx)(bn.Z,{imageURL:"NONE"===t.avatar?e.defaultAvatar:t.avatar,size:24,imageStyle:{borderRadius:34,boxShadow:"0 2px 4px rgba(15, 15, 15, 0.1)"},type:"image_url"}),(0,y.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"rgb(55, 53, 47)",fontWeight:500,fontSize:"14px",paddingLeft:8},children:t.title})]},t.url)))),this.stores.aiSourcePickerStore.state.loading&&(0,y.jsxs)("div",{style:{flex:1,color:this.theme.accentColors.purple[400],fontWeight:500,flexDirection:"row",gap:6,display:"flex",alignItems:"center",padding:"12px 12px",marginLeft:10},children:[(0,y.jsx)(r.FormattedMessage,{id:"aiSourcePicker.loadingMessage.fetching",defaultMessage:E.default.formatMessage(ua.aiIsFetchingLoader)}),(0,y.jsx)(Mn.Z,{style:{backgroundColor:this.theme.accentColors.purple[400]}})]}),!this.stores.aiSourcePickerStore.state.result&&!this.stores.aiSourcePickerStore.state.loading&&(0,y.jsx)(vn,{tab:e,placeholder:e.inputPlaceholder||E.default.formatMessage(ua.aiSourcePickerPlaceholder),store:this.stores.aiSourcePickerStore,isSmallWidth:this.props.isSmallWidth})]})}renderBoxTab(e){const{accounts:t}=e;return 0===t.length?(0,y.jsxs)(L.Z,{children:[(0,y.jsx)(Gt.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Connect Box account",id:"mediaPicker.menuItem.connectFirstBoxAccount.label"}),onClick:()=>e.onSelect(),focused:!1,style:{color:this.theme.blueColor}}),(0,y.jsx)(D.Z,{shouldWrapCaption:!1,caption:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Find and embed your Box files.",id:"mediaPicker.menuItem.connectFirstBoxAccount.caption"})})]}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(L.Z,{children:t.map((t=>(0,y.jsx)(Gt.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Choose from {accountName}",id:"mediaPicker.menuItem.choosePagesFromAccount.label",values:{accountName:t.account_name}}),onClick:()=>e.onSelect(t),focused:!1},t.account_key)))}),(0,y.jsx)(L.Z,{topBorder:!0,children:(0,y.jsx)(Gt.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Connect another account",id:"mediaPicker.menuItem.connectMoreBoxAccounts.label"}),onClick:()=>e.onSelect(),style:{color:this.theme.mediumTextColor},focused:!1})})]})}getTabs(){return this.props.tabs}getAllowedFileTypeFromTab(e){return e.fileUpload?Ln.jo:e.imageUpload?Ln.LR:e.videoUpload?Ln.G7:void 0}async handleUpload(e,t){const s=await mn.y({multiple:!1,accept:t});s.length&&e.onUpload(s[0])}getNumIconPerRow(){var e,t;return null!==(e=this.menuRef)&&void 0!==e&&null!==(e=e.current)&&void 0!==e&&e.offsetWidth?((null===(t=this.menuRef)||void 0===t||null===(t=t.current)||void 0===t?void 0:t.offsetWidth)-24)/32:12}}ma.displayName="MediaPicker";const pa=ma;class ga extends o.Z{constructor(){super(...arguments),this.handleCloseOverlay=()=>{en.Z()}}renderComponent(){const{device:e}=this.environment,{state:t}=Wn.Z;return(0,y.jsx)(c.ZP,{popupType:e.isMobile?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:t.isActive,originRect:t.isActive?t.originRect:void 0,originGap:t.isActive?t.originGap:void 0,placementToOrigin:c.ZP.Placement.Bottom,alignmentToOrigin:c.ZP.Alignment.Center,preventScaleTransition:!0,onDismiss:this.handleCloseOverlay,render:()=>{if(t.isActive)return(0,y.jsx)(Q.Z,{capture:!0,onUp:S.yR,onDown:S.yR,children:(0,y.jsx)(pa,{...t,onCancel:this.handleCloseOverlay})})}})}}ga.displayName="MediaMenu";const ha=ga;var fa=s(66897),ya=s(15145),va=s(41892),xa=s(7057),Sa=s(53877),ba=s(84795),Ma=s(58573),wa=s(42875),ja=s(9999),Ca=s(82114),ka=s(56666),_a=s(6746),Ta=s(92338),Ia=s(18613),Pa=s(7928),Za=s(67060),Fa=s(34602),Aa=s(97444),Da=s(65496),Ba=s(83089),Ra=s(18245),La=s(14568),Na=s(63334),Ea=s(19111),Oa=s(69454),Va=s(72087),Ua=s(43765),Wa=s(82990);const za={...Wa.Z.textOverflowStyle,fontWeight:Wa.Z.fontWeight.medium,maxWidth:160,display:"inline-block",verticalAlign:"bottom"};function Ka(e){const{pageTitle:t}=e;return t?(0,y.jsx)(r.FormattedMessage,{defaultMessage:"New “{filterText}” page in…",id:"createPageMenuItem.title.withPageName",values:{filterText:(0,y.jsx)("span",{style:za,children:t})}}):(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Add new page in…",id:"createPageMenuItem.title.withoutPageName"})}function Ha(e){const{pageTitle:t}=e;return t?(0,y.jsx)(r.FormattedMessage,{defaultMessage:"New “{filterText}” sub-page",id:"createSubpageMenuItem.title.withPageName",values:{filterText:(0,y.jsx)("span",{style:za,children:t})}}):(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Add new sub-page",id:"createSubpageMenuItem.title.withoutPageName"})}var Ga=s(85215),qa=s(60442),Ya=s(97680);function Qa(e){window.__c={n:"SvgWorkaroundForChromiumBug"};const{svg:t,viewBox:s,fill:n}=e,a=(0,i.useMemo)((()=>{const e=_a.Z.renderToString((0,y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:s,children:t}));return`url("${`data:image/svg+xml,${encodeURIComponent(e)}`}")`}),[t,s]);return(0,y.jsx)("div",{style:{width:"100%",height:"100%",backgroundColor:n,WebkitMaskImage:a,maskImage:a}})}const $a=(0,r.defineMessages)({mentionAll:{defaultMessage:"Mention a person, page, or date…",id:"mentionMenu.personPageDate.prompt2"},mentionPersonPage:{defaultMessage:"Mention a person or page…",id:"mentionMenu.personPage.prompt2"},mentionPersonDate:{defaultMessage:"Mention a person or date…",id:"mentionMenu.personDate.prompt2"},mentionPageDate:{defaultMessage:"Mention a page or date…",id:"mentionMenu.pageDate.prompt2"},mentionPerson:{defaultMessage:"Mention a person…",id:"mentionMenu.person.prompt2"},mentionDate:{defaultMessage:"Mention a date…",id:"mentionMenu.date.prompt2"},mentionPage:{defaultMessage:"Type to link or add page…",id:"mentionMenu.page.prompt2"},addPage:{defaultMessage:"Type to add or link page…",id:"mentionMenu.addPage.prompt2"}}),Xa=(0,r.defineMessages)({autocompleteToday:{defaultMessage:"Today",id:"mentionMenu.date.autocomplete.today"},autocompleteNextTuesday:{defaultMessage:"Next Tuesday 3pm",id:"mentionMenu.date.autocomplete.nextTuesday"},autocompleteReminder:{defaultMessage:"Remind tomorrow 9am",id:"mentionMenu.date.autocomplete.reminder"},reminder:{defaultMessage:"Remind {dateTime}",id:"mentionMenu.date.remindAtDateTime"},noResults:{defaultMessage:"No results",id:"mentionMenu.noSearchResults.title"},groupMentionCaption:{defaultMessage:"{numMembersInGroup, plural, one {{numMembersInGroup} member} other {{numMembersInGroup} members}}",id:"mentionMenu.group.caption"}});class Ja extends o.Z{constructor(){super(...arguments),this.storeTypes={ignoreSelectionAreaStore:Na.Z,localPageMentionRequestStore:Va.Z,localCachePageMentionRequestStore:Va.Z},this.renderMentionResult=(e,t)=>{const{intl:s}=this.props,i=Ea.Z.state,n=i.open&&i.insertionType,a={sections:[],nextSectionShouldHaveTopBorder:()=>a.sections.length>0,addSection(e){e&&this.sections.push(e)}};"+"===n&&a.addSection(this.getCreatePageMenuSection(a.nextSectionShouldHaveTopBorder())),a.addSection(this.getDateResultsMenuSection(t,a.nextSectionShouldHaveTopBorder())),a.addSection(this.getUserResultsMenuSection(t,a.nextSectionShouldHaveTopBorder())),a.addSection(this.getGroupResultsMenuSection(t,a.nextSectionShouldHaveTopBorder(),this.props.intl)),a.addSection(this.getPageResultsMenuSection(t,a.nextSectionShouldHaveTopBorder())),("@"===n&&this.filterStore.state||"[["===n)&&a.addSection(this.getCreatePageMenuSection(a.nextSectionShouldHaveTopBorder()));const{sections:o}=a;let l,c;if(Ri.Z.state.online){const e=i.mentionTypes.user,t=i.mentionTypes.page,n=i.mentionTypes.date;let a="";const o=$a;e&&t&&n?a=s.formatMessage(o.mentionAll):e&&t?a=s.formatMessage(o.mentionPersonPage):e&&n?a=s.formatMessage(o.mentionPersonDate):t&&n?a=s.formatMessage(o.mentionPageDate):e?a=s.formatMessage(o.mentionPerson):n?a=s.formatMessage(o.mentionDate):t&&i&&(a=i.open&&"+"===i.insertionType?s.formatMessage($a.addPage):s.formatMessage(o.mentionPage)),this.setTemporaryInputData({title:a,icon:this.renderTemporaryInputEmptyIcon(),allowTabCompletion:!1}),l=void 0}else l=(0,y.jsx)(Ua.Z,{title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Please go online to mention a person or page.",id:"mentionMenu.offlineMessage"})});0===o.length&&(c=(0,y.jsx)(L.Z,{children:(0,y.jsx)(Ua.Z,{title:(0,y.jsx)(r.FormattedMessage,{...Xa.noResults})})}));const{device:u}=this.environment;let p;return p=this.isActionSheet()?{menuType:m.og.ActionSheet,disableBottomPadding:!0,height:`calc(70vh - ${Oa.Z.estimatedNativeWebBottomOverlap()}px)`}:{menuType:m.og.Popup,width:this.getMenuDesktopWidth(),maxHeight:u.isMobile?"30vh":"40vh",onClickOutside:this.makeHandleCancelCallback()},(0,y.jsxs)(d.Z,{...p,header:l,children:[(0,y.jsx)(Q.Z,{capture:Ea.Z.state.open,onBackspace:this.shouldCaptureBackspace()?this.handleEmptyBackspace:void 0,onTab:this.handleTab}),(0,y.jsx)(B.Z,{type:B.i.Vertical,initialFocus:this.getMenuInitialFocus(),sections:o,onEmptyEnter:this.makeHandleCancelCallback()}),c]})},this.handleCreateInAutocompleteQueryChange=e=>{this.updateOpenState({createInQuery:e})},this.renderCreateInMenu=()=>{const e=Ea.Z.state;if(!e.open)return;const t="block"===e.textStore.table?e.textStore.id:void 0;return(0,y.jsx)(zi.Z,{targets:[],isAddTo:!0,isCreateIn:!0,onAccept:e=>{Za.Br({environment:this.environment,titleText:this.getNormalizedFilter(),ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,createInValue:e,menuListItemAction:void 0})},captureSelection:!0,restoreSelection:!0,parentBlockId:t,onAutocompleteQueryChange:this.handleCreateInAutocompleteQueryChange,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,autocompleteQuery:e.createInQuery,desktopWidth:this.getMenuDesktopWidth(),onCancel:this.handleCreateInCancel})},this.handleCreateInStart=()=>{this.updateOpenState({showCreateIn:!0})},this.handleCreateInCancel=()=>{this.updateOpenState({showCreateIn:!1,createInQuery:""})},this.handleEmptyBackspace=e=>{this.shouldCaptureBackspace()&&e.preventDefault(),this.makeHandleCancelCallback()()},this.makeHandleCancelCallback=()=>{const e=Ea.Z.state,t=this.getNormalizedFilter(),s=Za.WI();let i=Date.now();return e.open&&(i=e.openTime),()=>{M.ewV(this.environment,{timeToAbandonInMs:Date.now()-i,queryLength:t.length,analyticsFrom:s}),Za.xv()}},this.handleTab=e=>{e.preventDefault();const t=this.tabCompletionString;if(!t)return;const s=_.default.state;if("editing"!==s.mode)return;const i=(0,C.QY)(s.multiSelection);if(!i)return;const n=Ea.Z.state;n.open&&n.textStore===i.store&&j.createAndCommit({userAction:"MentionMenu.handleTab",environment:this.environment,perform:e=>{Aa.hJ({environment:this.environment,transaction:e,string:t,store:i.store,selection:i.selection,disableMentions:!0,disableDateMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0})}})},this.tabCompletionString=void 0,this.inputSelectionsStore=this.createComputedStore((()=>{const e=Ea.Z.state;if(e.open)return k.O2(e.textStore,e.oldTextValue,e.isEmptyPageTitle?"":e.insertionType)})),this.filterStore=this.createComputedStore((()=>{const e=this.inputSelectionsStore.state,t=Ea.Z.state;if(e&&t.open)return k.ug(t.textStore,e)})),this.popupOpenStore=this.createComputedStore((()=>{const e=Ea.Z.state;return!!e.open&&("+"!==e.insertionType||""!==this.getNormalizedFilter())})),this.performUserMentionRequest=async e=>{const t=Ea.Z.state;if(!t.open)return;const s=t.mentionTypes.user?await this.getUserResults(e):[];return""===e?s.slice(0,2):s.slice(0,20)},this.performLocalCachePageMentionRequest=async()=>{const{currentSpaceStore:e,currentSpaceViewStore:t}=ie.default.state;if(!e)return;return Da.hb({environment:this.environment,currentSpaceStore:e,currentSpaceViewStore:t})},this.performLocalPageMentionRequest=async e=>{const{localCachePageMentionRequestStore:t}=this.stores,s=t.state.result;if(!s)return;const i=He.RM();return i&&this.getNormalizedFilter()?Promise.resolve(Da.Y_({query:e,localCachedPages:s,parentStore:i,isOnline:Ri.Z.state.online,environment:this.environment,shouldLimitLocalResultsWhenOnline:!1,applyScoreThresholdWhenOnline:!0})):void 0},this.performServerPageMentionRequest=async e=>{const t=Ea.Z.state;return t.open&&this.getNormalizedFilter()&&t.mentionTypes.page?await this.getPageResults(e):[]},this.getUserResults=async e=>{if(Ri.Z.state.online){return await Ei.Yu({environment:this.environment,query:e,membersOnly:!1})}return[]},this.getGroupResults=e=>{var t;if(!Ea.Z.state.open)return[];const s=(null===(t=ie.default.state.currentSpaceStore)||void 0===t?void 0:t.getPermissionGroups())||[];return(0,Ma.ZP)(e,s,(e=>e.name||""))},this.getPageResults=async e=>{if(!Ri.Z.state.online)return[];const t=Ea.Z.state,s=t.open&&(0,ke.OY)(t.textStore)&&t.textStore;return await Ei.WL({nearBlock:s||void 0,environment:this.environment,query:e,source:"mention_menu",limit:20})},this.getDateResults=e=>{const t=Ea.Z.state;if(!t.open)return[];const{intl:s}=this.props,i=t.mentionTypes.reminder;return t.mentionTypes.date?function(e,t,s){if(0===e.length)return S.oA([{label:s.formatMessage(Xa.autocompleteToday),value:()=>Sa.Lg((0,wa.r)())},t?void 0:{label:s.formatMessage(Xa.autocompleteNextTuesday),value:()=>{const e=Sa.Uu((0,wa.r)()),t=e.set({weekday:2,hour:15}),s=t<=e?t.plus({week:2}):t.plus({week:1});return{type:"datetime",start_date:s.toFormat(Sa.Iq),start_time:s.toFormat(os.jK),time_zone:(0,wa.r)()}}},t?{label:s.formatMessage(Xa.autocompleteReminder),value:()=>({type:"datetime",start_date:Sa.Ro((0,wa.r)()).start_date,start_time:"09:00",reminder:{unit:"day",value:0,time:os.HZ,defaultTimeZone:(0,wa.r)()},time_zone:(0,wa.r)()})}:void 0]);const i=e.normalize("NFKD"),n=t?ba.parsePersistedDateWithOptionalReminder(i,s):ba.parsePersistedDate(i,s);if(n){let e=(0,xa.ZV)({value:n,date_format:"relative",userTimeZone:(0,wa.r)(),intl:s,allowRelativeDates:!0});return n.reminder&&(e=s.formatMessage(Xa.reminder,{dateTime:e})),[{label:e,value:()=>n}]}return[]}(e,i,s).slice(0,6):[]},this.getTemplateVariableResults=e=>{const t=Ea.Z.state;if(!t.open)return[];if(!t.mentionTypes.templateVariable)return[];const{intl:s}=this.props;return b.XVI(e,s)}}willMountOrUpdate(){const e=Ea.Z.state,t=this.filterStore.state;if(e.open){var s;const i=_.default.state,n="editing"===i.mode?(0,C.QY)(i.multiSelection):void 0,a=(null==n?void 0:n.store)===e.textStore,o=this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,r=o&&"editing"===o.mode&&(null===(s=(0,C.QY)(o.multiSelection))||void 0===s?void 0:s.store)===e.textStore;if(!a&&!r)return void Za.xv();const l=a&&(null==n?void 0:n.selection),d=this.inputSelectionsStore.state;if(d&&l&&(l.startIndex<d.filter.startIndex||l.endIndex>d.filter.endIndex))return void Za.xv();const c=this.filterStore.state&&this.filterStore.state[0];if("+"===e.insertionType&&c&&!c.match(Ba.Ff))return void Za.xv();if(void 0===t&&!e.isEmptyPageTitle)return void Za.xv()}}renderComponent(){const{device:e}=this.environment,t=Ea.Z.state,s=La.Z.find((e=>e.props.capture)),i=this.popupOpenStore.state;let n;if(s&&e.isMobile){var a;const e=null===(a=s.stores.store.state.node)||void 0===a?void 0:a.getBoundingClientRect();e&&(n={height:`calc(100vh - ${e.height}px)`})}const o=t.open&&t.showCreateIn;return(0,y.jsx)(c.ZP,{popupType:this.isActionSheet()?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:i,originRect:t.open?t.selectionRect:void 0,slideUpWrapStyle:n,placementToOrigin:c.ZP.Placement.Bottom,alignmentToOrigin:c.ZP.Alignment.Start,originGap:8,disableMouseCapture:!0,disableContentScroll:!0,onDismiss:this.makeHandleCancelCallback(),disableDarkOverlayBackground:e.isMobile,keepFocus:!0,render:()=>e.isMobile?(0,y.jsxs)(y.Fragment,{children:[this.renderMentionSearch(),(0,y.jsx)(c.ZP,{popupType:c.ZP.PopupType.SlideUp,render:this.renderCreateInMenu,open:o,keepFocus:!0})]}):o?this.renderCreateInMenu():this.renderMentionSearch()})}renderMentionSearch(){const e=this.getNormalizedFilter(),t=Ea.Z.state,s=Ra.default.mark("rum.mention_menu_ready"),i={field:"relevance"};return(0,y.jsx)(jn.Z,{requestStore:t.userRequestStore,request:e,performRequest:this.performUserMentionRequest,render:n=>(0,y.jsx)(jn.Z,{requestStore:t.pageRequestStore,request:e,performRequest:this.performServerPageMentionRequest,debounce:Ei.vp,render:t=>(0,y.jsx)(jn.Z,{requestStore:this.stores.localCachePageMentionRequestStore,request:ie.default.state.currentSpaceStore&&ie.default.state.currentSpaceStore.id,performRequest:this.performLocalCachePageMentionRequest,render:a=>(0,y.jsx)(jn.Z,{requestStore:this.stores.localPageMentionRequestStore,debounce:Ei.E5,request:{query:{text:e,filters:Ta.u4({isDeletedOnly:!1,navigableBlockContentOnly:!0,excludeTemplates:!0,requireEditPermissions:void 0}),sort:i},limit:5},performRequest:this.performLocalPageMentionRequest,render:e=>this.renderMentionResult(n||t||e,this.getCurrentMentionResults(s))})})})})}getDateResultsMenuSection(e,t){const{dateResults:s}=e,{intl:i}=this.props,n=this.getNormalizedFilter(),a=this.getTemplateVariableMenuItems(e,"date");if(0===s.length&&0===a.length)return;const o=s.map((e=>{let{label:t,value:s}=e;return{key:t,render:e=>{if(e.focused&&this.setTemporaryInputData({title:t,icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),ba.parseRelativeDate(t,i)){const n=(0,xa.ZV)({value:s(),userTimeZone:(0,wa.r)(),intl:i,allowRelativeDates:!1});return(0,y.jsx)(Gt.Z,{...e,title:t,caption:n,inline:!0})}return(0,y.jsx)(Gt.Z,{...e,title:t})},action:e=>{j.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:t=>{Za.RL({environment:this.environment,annotation:["d",{...s(),date_format:"relative"}],transaction:t,menuListItemAction:e,query:n,mentionType:"date"})}})}}}));return this.applySectionLimit("date",{key:"date results",render:e=>(0,y.jsx)(L.Z,{...e,title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Date",id:"mentionMenu.dateSection.title"}),topBorder:t,isTitleUppercase:!0}),items:a.concat(o)})}getTemplateVariableMenuItems(e,t){const{templateVariableResults:s}=e,{intl:i}=this.props,n=this.getNormalizedFilter();return s.filter((e=>b.i6A(e,t))).map((e=>({key:e,render:t=>{const s=b.U$y(e,i),n=b.Z08(e,i);return t.focused&&this.setTemporaryInputData({title:s,icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),(0,y.jsx)(Gt.Z,{...t,title:s,caption:n,inline:!0})},action:t=>{j.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:s=>{Za.RL({environment:this.environment,annotation:b.WBu({type:e}),transaction:s,menuListItemAction:t,query:n,mentionType:"templateVariable"})}})}})))}renderSpinner(e){return(0,y.jsx)(gi.Z,{show:e,showDelay:500,showHold:300,render:e=>(0,y.jsx)(Vs.Z,{style:{textAlign:"center",visibility:e?"visible":"hidden",display:"inline",marginLeft:8}})})}renderTemporaryInputEmptyIcon(){const e=Ea.Z.state;if(e.open)return"+"===e.insertionType?this.renderTemporaryInputAddIcon():(0,y.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,y.jsx)(Qa,{svg:an.T,viewBox:an.R.__iconViewBox,fill:this.theme.mediumIconColor})})}renderTemporaryInputAddIcon(){return(0,y.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,y.jsx)(Qa,{svg:Zs.s,viewBox:Zs.R.__iconViewBox,fill:this.theme.mediumIconColor})})}renderTemporaryInputPageIcon(e){return(0,Ia.tp)({pageModel:e.getModel(),pageRole:e.getRole(),showEmojiInline:!0,emojiType:(0,V.e_)(this.environment),baseUrl:ys.default.domainBaseUrl,getRecordModel:e.getRecordModel,isClient:!0,isSafariOrIOS:this.environment.device.isSafari||this.environment.device.isIOS,currentUserId:this.environment.currentUser.id,theme:this.theme,emojiData:U.Z.state})}renderTemporaryInputAtMentionIcon(){return(0,y.jsx)("span",{style:{width:"1em",height:"1em",display:"inline-block",verticalAlign:"-0.15em",marginRight:"0.2em"},children:(0,y.jsx)(Qa,{svg:Ca.Q,viewBox:Ca.p.__iconViewBox,fill:this.theme.mediumIconColor})})}getUserResultsMenuSection(e,t){const{userResults:s}=e,i=this.getNormalizedFilter(),n=this.getTemplateVariableMenuItems(e,"user");if(0===s.length&&0===n.length)return;const a=S.oA(s.map((e=>({key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:(0,Pa.Nz)(this.props.intl,e),icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),(0,y.jsx)(Ya.Z,{...t,actor:(0,fa.dp)(e),useEmailAsTooltip:!0})),action:t=>{j.createAndCommit({userAction:"MentionMenu.menuItem",environment:this.environment,perform:s=>{Za.RL({environment:this.environment,annotation:(0,b.tEo)(e.id),transaction:s,menuListItemAction:t,query:i,mentionType:"user"})}})}}))));return this.applySectionLimit("user",{key:"user results",render:e=>(0,y.jsx)(L.Z,{...e,title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"People",id:"mentionMenu.peopleSection.title"}),topBorder:t,isTitleUppercase:!0}),items:n.concat(a)})}getGroupResultsMenuSection(e,t,s){const{groupResults:i}=e;if(0===i.length)return;const n=this.getNormalizedFilter(),a=S.oA(i.map((e=>{var t;const i=s.formatMessage(Xa.groupMentionCaption,{numMembersInGroup:(null===(t=e.user_ids)||void 0===t?void 0:t.length)||0});return{key:e.id,render:t=>(t.focused&&this.setTemporaryInputData({title:e.name||"",icon:this.renderTemporaryInputAtMentionIcon(),allowTabCompletion:!0}),(0,y.jsx)(Ga.l,{menuListItemProps:{...t,caption:i},group:e})),action:t=>{var s;const i=null===(s=ie.default.state.currentSpaceStore)||void 0===s?void 0:s.id;i&&j.createAndCommit({userAction:"MentionMenu.groupMention",environment:this.environment,perform:s=>{Za.RL({environment:this.environment,annotation:b.XIB(e.id,i),transaction:s,menuListItemAction:t,query:n,mentionType:"group"})}})}}})));return this.applySectionLimit("group",{key:"group results",render:e=>(0,y.jsx)(L.Z,{...e,title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Groups",id:"mentionMenu.groupSection.title"}),topBorder:t,isTitleUppercase:!0}),items:a})}getPageResultsMenuSection(e,t){const{pageResults:s}=e,i=this.getNormalizedFilter(),n=(0,y.jsxs)(y.Fragment,{children:[0===s.length?(0,y.jsx)(r.FormattedMessage,{...Xa.noResults}):(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Link to page",id:"mentionMenu.pagesSection.title2"}),this.renderSpinner(Ea.Z.state.pageRequestStore.state.loading)]});return this.applySectionLimit("page",{key:"page results",render:e=>(0,y.jsx)(L.Z,{...e,title:n,topBorder:t,isTitleUppercase:!0}),items:S.oA(s.map((e=>{const t=He.RM();if(!t)return;const s=Bt.G.createChildStore(t,{table:gs.iU,id:e});return{key:e,render:e=>{if(e.focused){const e=s.getModel();if(e){const t=e.getRenderTitle({getRecordModel:s.getRecordModel,userTimeZone:(0,wa.r)(),intl:this.props.intl});this.setTemporaryInputData({title:t||"",icon:this.renderTemporaryInputPageIcon(s),allowTabCompletion:!0})}}return(0,y.jsx)(Oi.Z,{...e,store:s})},action:t=>{j.createAndCommit({userAction:"MentionMenu.getPageResultsMenuSection",environment:this.environment,perform:s=>{Za.RL({environment:this.environment,annotation:["p",e],transaction:s,menuListItemAction:t,query:i,mentionType:"page"})}})}}})))})}getCreatePageMenuSection(e){if(!this.canCreatePage())return;const t=Ea.Z.state;if(!t.open)return;const{intl:s}=this.props,i=this.getNormalizedFilter(),n="@"===t.insertionType?(0,y.jsx)(r.FormattedMessage,{id:"mentionMenu.createPageSection.title",defaultMessage:"New page"}):void 0;return{key:"create page",render:t=>(0,y.jsx)(L.Z,{title:n,isTitleUppercase:!0,...t,topBorder:e}),items:[{key:"add new subpage",action:async e=>{const s=vi.gt(t.textStore);s&&await Za.Br({environment:this.environment,ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,titleText:this.getNormalizedFilter(),createInValue:s.createInValue,onPageCreated:e=>{e&&""===b.QaF(e.getTitleValue())&&Fa.navigateToBlock({environment:this.environment,store:e,pageVisitSource:ya.tY.Create})},menuListItemAction:e})},render:e=>{e.focused&&this.setTemporaryInputData({title:0===i.length?s.formatMessage($a.addPage):"",icon:this.renderTemporaryInputAddIcon(),allowTabCompletion:!1});const t=t=>(0,y.jsx)(Gt.Z,{...(0,X.Z)(t||{},e),icon:(0,Zs.R)({width:16}),title:(0,y.jsx)(Ha,{pageTitle:this.getNormalizedFilter()})});return this.environment.device.isMobile?t():(0,y.jsx)($.Z,{renderTooltip:()=>(0,y.jsx)(qa.Z,{imageURL:va.Z.images.tooltips.pageMenu.newSubpagePng,imageWidth:140,imageHeight:100,caption:(0,y.jsx)(r.FormattedMessage,{...zi.s.createSubpage})}),placement:$.Z.Placement.Right,delayThreshold:0,render:e=>t(e)})}},{key:"open create in menu",action:this.handleCreateInStart,render:e=>{e.focused&&this.setTemporaryInputData({title:0===i.length?s.formatMessage($a.addPage):"",icon:this.renderTemporaryInputAddIcon(),allowTabCompletion:!1});const t=(0,y.jsx)(Ka,{pageTitle:this.getNormalizedFilter()}),n=s=>(0,y.jsx)(Gt.Z,{...(0,X.Z)(s||{},e),icon:(0,ja.J)({width:16}),title:t});return this.environment.device.isMobile?n():(0,y.jsx)($.Z,{renderTooltip:()=>(0,y.jsx)(qa.Z,{imageURL:va.Z.images.tooltips.pageMenu.newPageInPng,imageWidth:140,imageHeight:100,caption:(0,y.jsx)(r.FormattedMessage,{...zi.s.newPageIn})}),placement:$.Z.Placement.Right,delayThreshold:0,render:e=>n(e)})}}]}}applySectionLimit(e,t){const s=Ea.Z.state;if(!s.open)return t;if(s.expandSection&&s.expandSection===e)return t;const{items:i}=t,n=this.environment.device.isPhone?3:5;if(i.length<=n)return t;const a=[...i.slice(0,n),{key:"show more",render:e=>(0,y.jsx)(Gt.Z,{...e,icon:(0,ka.o)({width:16,fill:this.theme.mediumTextColor}),title:(0,y.jsx)("span",{style:{color:this.theme.mediumTextColor},children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"{numberMore} more results",id:"mentionMenu.showMoreResultsButton.title",values:{numberMore:i.length-n}})})}),action:()=>{this.updateOpenState({expandSection:e})}}];return{...t,items:a}}updateOpenState(e){const t=Ea.Z.state;t.open&&Ea.Z.setState({...t,...e})}getNormalizedFilter(){const e=this.filterStore.state;return e?Ea.Z.state.open&&"@"===Ea.Z.state.insertionType&&this.environment.device.isAndroid&&e.startsWith("@")?e.slice(1).trim():Ea.Z.state.open&&"[["===Ea.Z.state.insertionType&&e.endsWith("]]")?e.slice(0,-2).trim():e.trim():""}setTemporaryInputData(e){const t=Ea.Z.state;if(!t.open)return;if(!e)return void t.temporaryInputData.setState(void 0);const{device:s}=this.environment,{title:i,icon:n,allowTabCompletion:a}=e,o=this.filterStore.state||"",r=i.toLowerCase().startsWith(o)?i.slice(o.length):"";this.tabCompletionString=a?r:void 0;const l=s.isFirefox?void 0:n;t.temporaryInputData.setState({prefix:t.insertionType,suffix:"[["===t.insertionType&&o.endsWith("]]")?"]]":"",completion:r,prefixIcon:l})}getCurrentMentionResults(e){const t=Ea.Z.state,s=t.userRequestStore.state.result||[],i=t.pageRequestStore.state.result||[],n=this.getDateResults(this.getNormalizedFilter()),a=this.getTemplateVariableResults(this.getNormalizedFilter()),o=t.mentionTypes.group?this.getGroupResults(this.getNormalizedFilter()):[];let r=i;const{result:l}=this.stores.localPageMentionRequestStore.state;if(l&&!l.error){const e=l.value.results,t=He.RM();r=t?Da.oO({localResults:e,serverResults:i.map(((e,s)=>({...e,serverEventProperties:void 0,originalPosition:s,store:Bt.G.createChildStore(t,{table:gs.iU,id:e.id})})))})||[]:e}let d;d=this.getNormalizedFilter()?r.map((e=>e.id)):Vi.X4.state.map((e=>e.pageId));const c=t.userRequestStore.state.ready&&t.pageRequestStore.state.ready;return c&&Ra.default.measure(e,{environment:this.environment}),{userResults:s,groupResults:o,pageResults:d,dateResults:n,templateVariableResults:a,ready:c}}canCreatePage(){return!!Ea.Z.state.mentionTypes.createPage}isActionSheet(){const{device:e}=this.environment;return e.isMobileNative&&!e.isTablet}shouldCaptureBackspace(){return""===this.filterStore.state}getMenuInitialFocus(){if(""!==this.getNormalizedFilter())return 0}getMenuDesktopWidth(){return(0,he.bq)()?400:330}}Ja.displayName="MentionMenu";const eo=(0,r.injectIntl)(Ja);var to=s(42239);class so extends o.Z{constructor(){super(...arguments),this.cancelDragTimeout=void 0,this.handleDragOver=e=>{e.preventDefault(),this.startDrag(e),this.continueDragThrottled(e)},this.handleDrop=e=>{e.preventDefault();const t=Array.from(e.dataTransfer.files);t.length>0&&j.createAndCommit({userAction:"NativeDragHandler.handleDrop",environment:this.environment,perform:e=>{to._4({environment:this.environment,files:t,analyticsFrom:"native_drag",transaction:e})}})},this.startDrag=e=>{to.f$(this.environment,{startX:e.clientX,startY:e.clientY,stores:[],isNativeDrag:!0,getGhostElement:void 0})&&Bs.ZH(this.environment)},this.continueDrag=e=>{this.cancelDragTimeout&&window.clearTimeout(this.cancelDragTimeout),this.cancelDragTimeout=window.setTimeout(this.cancelDrag,this.getCancelDragTimeoutMS()),to.td(this.environment,{currentX:e.clientX,currentY:e.clientY})},this.continueDragThrottled=S.P2(this.continueDrag,so.dragOverThrottleMS),this.cancelDrag=()=>{to.cQ(this.environment)}}didMount(){super.didMount(),window.addEventListener("dragover",this.handleDragOver),window.addEventListener("drop",this.handleDrop)}willUnmount(){super.willUnmount(),window.removeEventListener("dragover",this.handleDragOver),window.removeEventListener("drop",this.handleDrop)}getCancelDragTimeoutMS(){const{device:e}=this.environment;return e.isLinux?2e3:200}}so.displayName="NativeDragHandler",so.dragOverThrottleMS=62.5;const io=so;var no=s(40902),ao=s(44615),oo=s(65311),ro=s(19719),lo=s(2688),co=s(19034),uo=s(12252);class mo extends o.Z{constructor(){super(...arguments),this.lastEmitValue=-1,this.lastSentBadgeNumber=void 0,this.lastSentCurrentSpaceBadgeNumber=void 0,this.handleNotificationEmit=async(e,t)=>{if(t===this.lastEmitValue)return;if(this.lastEmitValue=t,!this.shouldFetchUserNotifications(String(t)))return;const s=await ea.getUserNotifications(this.environment,{size:1e3});if("failed"===s.type)return;const{results:i}=s.data;co.Z.setState({results:i}),this.syncInitialBadgeNumber();const n=S.G0.apply(null,i.map((e=>e.unreceived.notificationIds)));for(const a of n)this.displayNotification(a)},this.handleNotificationEmitThrottled=S.P2(this.handleNotificationEmit,1e3),this.handleNotificationEmitWhenActive=(e,t)=>{uo.Z.whenActive((()=>{this.handleNotificationEmitThrottled(e,t)}))},this.listenerReference=void 0,this.updateBadgeNumbers=()=>{const{mobileNative:e}=this.environment,{allSpaces:t,currentSpace:s}=this.getBadgeCounts();e&&(t===this.lastSentBadgeNumber&&s===this.lastSentCurrentSpaceBadgeNumber||e.setBadgeNumber(t,s),this.lastSentCurrentSpaceBadgeNumber=s),t!==this.lastSentBadgeNumber&&(t>0?ai.setBadge(`${t}`):ai.setBadge("")),this.lastSentBadgeNumber=t},this.syncInitialBadgeNumber=S.IH(this.updateBadgeNumbers)}willMount(){this.startMessageListeners(),co.Z.addListener(this.updateBadgeNumbers),this.environment.mobileNative&&ie.default.addListener(this.updateBadgeNumbers)}didUpdate(e){e.rootStore.userId!==this.props.rootStore.userId&&(this.stopMessageListeners(),this.startMessageListeners(),this.handleNotificationEmit("initializeListener",-1))}willUnmount(){this.stopMessageListeners(),co.Z.removeListener(this.updateBadgeNumbers),this.environment.mobileNative&&ie.default.removeListener(this.updateBadgeNumbers)}startMessageListeners(){const{currentUserStore:e}=ie.default.state;if(e){const t=(0,ao.Lp)(e.id);this.listenerReference=lo.Z.addListener(t,this.handleNotificationEmitWhenActive,void 0,this.environment)}}stopMessageListeners(){this.listenerReference&&lo.Z.removeListener(this.listenerReference,this.environment)}getBadgeCounts(){return{allSpaces:co.Z.getTotalUnreadMentionsCount(),currentSpace:co.Z.getUnreadCountForCurrentSpace().mentions}}async displayNotification(e){const t=(0,Bt.Kv)(this.props.rootStore,{table:oo.uX,id:e});await t.load();const s=t.getValue();if(!s)return;const i=(0,ke.No)(t,s.activity_id,s.space_id);await i.load();const n=i.getModel(),{currentUserStore:a,currentSpaceViewStore:o}=ie.default.state;if(a&&o&&n&&!n.invalid&&!no.BX(n,a.id)&&await ai.isMainTabOrWindow()&&"undefined"!=typeof Notification){if(await o.load(),!o.isDefined())return;if(!n.isMentionType())return;if(!o.getNotifyDesktop())return;if(!this.environment.device.isDesktop)return;const e=(0,(await p.deps.desktop.loader()).Notification)({activity:n,getRecordValue:t.getRecordValue,userTimeZone:(0,wa.r)(),intl:this.props.intl,pageVisitSource:ya.tY.PushNotification});if(!e)return;const{subject:s,body:a}=e,r=new Notification(s,{body:a,silent:!0}),l=no.Fb(n.type),d={medium:"desktop_push",type:l,badge_number:this.getBadgeCounts().allSpaces,notification_id:t.id,activity_id:i.id},c=e=>ro.b2({environment:this.environment,args:d,action:e});c("sent"),r.addEventListener("show",(()=>c("shown"))),r.addEventListener("close",(()=>c("closed"))),r.addEventListener("click",(()=>{const e=no.hY({activity:n,getRecordModel:t.getRecordModel,baseUrl:ys.default.domainBaseUrl,pageVisitSource:ya.tY.PushNotification}),s=(0,ya.k6)(e,[l,"desktop_push"],ya.tY.PushNotification);Fa.navigate({environment:this.environment,url:s}),c("clicked")}))}}shouldFetchUserNotifications(e){return 0===co.Z.state.results.length||(!document.hasFocus()||!e.includes("unreadCount"))}}mo.displayName="NotificationListener";const po=(0,r.injectIntl)(mo);var go=s(35683),ho=s(56171),fo=s(58261);class yo extends o.Z{constructor(){super(...arguments),this.renderTooltip=()=>(0,y.jsx)(Q.Z,{capture:!0,onEnter:this.handleEnter,onCommandEnter:this.handleCommandEnter,children:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Open page",id:"pageMentionOverlay.openPage"}),(0,y.jsx)("div",{children:(0,y.jsx)(fo.Z,{onlyShowFirst:!0,name:"enter",style:{color:this.theme.mediumInvertedTextColor}})})]})}),this.handleEnter=e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:s,store:i}=t;if(!s)return;e.preventDefault&&e.preventDefault();const n=Bt.G.createChildStore(i,{table:gs.iU,id:s});Fa.navigateToBlock({store:n,environment:this.environment,visitType:go.vu.Link,pageVisitSource:ya.tY.MentionInPage})},this.handleCommandEnter=e=>{const t=this.pageMentionTokenStore.state;if(!t)return;const{pageId:s,store:i}=t;if(!s)return;e.preventDefault();const n=Bt.G.createChildStore(i,{table:gs.iU,id:s});Fa.navigateToBlock({store:n,environment:this.environment,visitType:go.vu.Link,openInNew:"tab",pageVisitSource:ya.tY.MentionInPage})},this.pageMentionTokenStore=this.createComputedStore((()=>{const e=_.default.state;if("editing"!==e.mode)return;const t=(0,C.QY)(e.multiSelection);if(!t)return;const{store:s,selection:i}=t;if(i.endIndex!==i.startIndex+1)return;const n=s.getValue(),a=b.b1T(n,i.startIndex);if(!a||!b.eOb(a))return;const[o]=b.jDe([a]);return{pageId:o,store:s}}))}renderComponent(){if(this.environment.device.isMobile)return;const e=ho.getSelectionRect(),t=this.pageMentionTokenStore.state;return(0,y.jsx)($.Z,{render:()=>{},renderTooltip:this.renderTooltip,originRect:e,forceVisibleState:Boolean(t&&e),placement:$.Z.Placement.Bottom})}}yo.displayName="PageMentionOverlay";const vo=yo;var xo=s(52989),So=s(69784);class bo extends o.Z{constructor(){super(...arguments),this.handleKey=e=>{So.Z.state.isActive&&(e.preventDefault(),xo.MZ({environment:this.environment,currentX:So.Z.state.currentX,currentY:So.Z.state.currentY,toggle:e.shiftKey}))},this.handleMouseMove=e=>{So.Z.state.isActive&&(e.preventDefault(),xo.MZ({environment:this.environment,currentX:e.clientX,currentY:e.clientY,toggle:e.shiftKey}))},this.handleMouseUp=e=>{So.Z.state.isActive&&((0,Rs.N9)(e)||e.preventDefault(),xo.qw(this.environment))}}willMount(){window.addEventListener("keydown",this.handleKey),window.addEventListener("keyup",this.handleKey),window.addEventListener("mousemove",this.handleMouseMove),window.addEventListener("mouseup",this.handleMouseUp)}willUnmount(){window.removeEventListener("keydown",this.handleKey),window.removeEventListener("keyup",this.handleKey),window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("mouseup",this.handleMouseUp)}renderComponent(){return null}}bo.displayName="RectangularSelectionListener";const Mo=bo;var wo=s(43008),jo=s(98104),Co=s(64951);class ko extends o.Z{constructor(){super(...arguments),this.renderPopupContent=()=>(0,y.jsx)(To,{})}renderComponent(){const{device:e}=this.environment,{blockStore:t,originRect:s}=Co.Z.state;return(0,y.jsx)(c.ZP,{popupType:e.isMobile?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:Boolean(t),originRect:s,placementToOrigin:c.ZP.Placement.Bottom,alignmentToOrigin:c.ZP.Alignment.Center,originGap:4,onDismiss:()=>wo.x(this.environment),render:this.renderPopupContent})}}ko.displayName="RenameFileMenuPopup";class _o extends o.Z{didMount(){const{blockStore:e}=Co.Z.state;if(!e)return;const t=e.getTitleStore();t&&jo.mT({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{blockStore:t}=Co.Z.state;if(!t)return;const s=t.getTitleStore();if(!s)return;let i;return i=e.isMobile?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:380},(0,y.jsx)(d.Z,{...i,children:(0,y.jsx)("div",{style:this.getWrapStyle(),children:(0,y.jsx)(hn.Z,{store:s,disabled:!t.canEdit(),onEsc:()=>wo.x(this.environment),onEnter:()=>wo.x(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,placeholder:this.props.intl.formatMessage({defaultMessage:"Untitled",id:"renameFileMenuPopup.input.placeholder"}),style:this.getInputStyle(),pasteBehavior:"inline"})})})}getWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:3,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}_o.displayName="LocalizableRenameFileMenu";const To=(0,r.injectIntl)(_o),Io=ko;var Po=s(52771),Zo=s(82187),Fo=s(31278);class Ao extends o.Z{constructor(){super(...arguments),this.renderPopupContent=()=>{const{renderDelete:e}=Zo.Z.state;return(0,y.jsx)(Bo,{renderDelete:Boolean(e)})}}renderComponent(){const{device:e}=this.environment,{clonedBlockStore:t,originRect:s}=Zo.Z.state;return(0,y.jsx)(c.ZP,{popupType:e.isMobile?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:Boolean(t),originRect:s,placementToOrigin:c.ZP.Placement.Bottom,alignmentToOrigin:c.ZP.Alignment.Center,originGap:4,onDismiss:()=>Po.x(this.environment),render:this.renderPopupContent})}}Ao.displayName="RenamePageMenuPopup";class Do extends o.Z{constructor(){super(...arguments),this.handleRecordIconChange=e=>{const{clonedBlockStore:t}=Zo.Z.state;if(t){const s=t.getIconStore();s&&j.createAndCommit({userAction:"RenamePageMenuPopup.handleRecordIconChange",environment:this.environment,perform:t=>{ls.sO({store:s,value:e,transaction:t})}})}}}didMount(){const{clonedBlockStore:e}=Zo.Z.state;if(!e)return;const t=e.getTitleStore();t&&jo.mT({environment:this.environment,store:t,canSelectAllBlocks:!1})}renderComponent(){const{device:e}=this.environment,{clonedBlockStore:t}=Zo.Z.state;if(!t)return;const s=t.getTitleStore();if(!s)return;const{renderDelete:i}=this.props;let n;return n=e.isMobile?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:380},(0,y.jsx)(d.Z,{...n,children:(0,y.jsxs)("div",{style:this.getWrapStyle(),children:[this.renderIcon(t),(0,y.jsx)(hn.Z,{store:s,disabled:!t.canEdit(),onEsc:()=>Po.x(this.environment),onEnter:()=>Po.x(this.environment),disableSlashCommands:!0,disableEmojiCommands:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,disableStyleAnnotations:!0,placeholder:this.renderEmptyTitlePlaceholder(),style:this.getInputStyle(),pasteBehavior:"inline"}),i&&t.canEdit()&&this.renderDeleteButton()]})})}renderDeleteButton(){return(0,y.jsx)(In.Z,{icon:e=>(0,at.y)({height:20,width:20,...e}),style:{marginLeft:6},hasBackground:!0,isDarkIconColor:!0,showShadow:!0,onClick:async()=>{const{originalBlockStore:e}=Zo.Z.state;e&&await Ds.Qw({environment:this.environment,blocks:[e]}),Po.x(this.environment)}})}renderIcon(e){const t={width:28,height:28,marginRight:6,flexShrink:0,flexGrow:0,boxShadow:`inset 0 0 0 1px ${this.theme.darkDividerColor}`};if(e.canEdit()){var s,i;const n=null===(s=e.getIconStore())||void 0===s?void 0:s.table;return(0,y.jsx)(Fo.Z,{disabled:!1,bucket:"secure",store:e,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:18,style:t,iconLoggingData:{recordTable:n,source:"breadcrumb",block_type:e.getType(),collection_id:"collection"===n?null===(i=e.getIconStore())||void 0===i?void 0:i.id:void 0},onChange:this.handleRecordIconChange})}return(0,y.jsx)(Fo.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:18,style:t})}renderEmptyTitlePlaceholder(){const{clonedBlockStore:e}=Zo.Z.state,{intl:t}=this.props;if(null!=e&&e.isDefined())return e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,wa.r)(),intl:t})}getWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"block",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:3,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}Do.displayName="LocalizableRenamePageMenu";const Bo=(0,r.injectIntl)(Do),Ro=Ao;var Lo=s(42853);const No=(0,ks.I)("code",{viewBox:"0 0 30 30",svg:(0,y.jsx)("path",{d:"M11.625,4L0,15l11.625,11L13,24.563L2.906,15L13,5.438L11.625,4z M18.375,4L17,5.438L27.094,15L17,24.563L18.375,26L30,15L18.375,4z"})});var Eo=s(69634),Oo=s(22962),Vo=s(6287),Uo=s(80503),Wo=s(11732),zo=s(56863),Ko=s(92022),Ho=s(82343),Go=s(12921),qo=s(40959),Yo=s(87078),Qo=s(45162),$o=s(67669),Xo=s(15723),Jo=s(45214),er=s(17903),tr=s(4548),sr=s(42057),ir=s(49557),nr=s(4935),ar=s(99757),or=s(13966),rr=s(64131),lr=s(82945),dr=s(40464),cr=s(32404),ur=s(73383);class mr extends o.Z{constructor(){super(...arguments),this.mouseIsDownExternally=!1,this.lastRenderState=void 0,this.completionContextOnOpen=void 0,this.renderOverlay=()=>{const{isActive:e}=ir.Z.state;return(0,y.jsx)(Os.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},springConfig:{opacity:{stiffness:100,damping:10,precision:1e-4}},render:this.renderAnimated,onAnimationEnd:this.handleAnimationEnd})},this.renderAnimated=()=>{const{top:e,left:t}=ir.Z.state,s=this.canOnlyDiscussStore.state,i=Math.max(s?t:t-mr.leftOffset,0),n=s?"12px 0":12;return(0,y.jsxs)("div",{className:u.Qcf,style:{pointerEvents:"none",position:"absolute",top:e,left:0,display:"flex",width:"100%"},children:[(0,y.jsx)("div",{style:{flexShrink:1,width:i,minWidth:24}}),(0,Ls.Z)((e=>(0,y.jsx)("div",{style:{pointerEvents:"none",padding:n},...e,children:this.lastRenderState&&this.renderMenu(this.lastRenderState)}))),(0,y.jsx)("div",{style:{flexGrow:1,flexShrink:1,minWidth:36}})]})},this.updateRichTextState=()=>{const e=ir.Z.state;if(ji.Z.state.open||nr.Z.state.open)return;if(ar.n.state)return zo.w();const t=_.default.state;if("empty"===t.mode)return zo.w();const s=(0,Qo.L5)(t.multiSelection);if(0===s.length)return zo.w();if(!s.every((e=>{let{store:t}=e;return t.table===gs.iU||t.table===Ys.x_||t.table===Vo.v})))return zo.w();if(!this.environment.currentUser.isLoggedIn()||!s.every((e=>{let{store:t}=e;return t.canComment()})))return;const i=ho.get();if(He.JE())return zo.w();if(s.some((e=>{let{editable:t}=e;return t.props.disableAnnotation})))return zo.w();const n=s.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()}));if(n.some(((e,t)=>{const i=s[t].store.canComment(),n=s[t].store.table===Ys.x_&&s[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!i||n})))return zo.w();if(this.mouseIsDownExternally&&e.blockTarget!==n[0])return zo.w();const a=s.some((e=>{let{store:t}=e;const s=t.getRecordStoreAtRootPath();if(!(s instanceof Bt.G))return!1;const i=s.getValue();return!!i&&mr.richTextMenuBlockTypesDenylist[i.type]}));if(a)return zo.w();const o=i?ho.getRect(i):void 0;if(o&&!Xo.kK(o,(0,Yo.Z)()))return zo.w();if(Zo.Z.isActive()||Co.Z.isActive()||ti.Z.isOpen()||a||!i||!this.hasNonCollapsedTextSelection()||Jo.Z.state.open)return zo.w();let r=0,l=0;if(o){r=o.left;const e=25,t=o.top-mr.height-e,s=Uo.R6(this.environment.device.isElectronMac),i=this.environment.WindowSizeStore.state.height-mr.height-e;l=Math.min(Math.max(t,s),i)}0===Math.abs(ir.Z.state.top-l)&&Math.abs(ir.Z.state.left-r)<10&&(l=ir.Z.state.top,r=ir.Z.state.left),ir.Z.setState({...ir.Z.state,isActive:!0,isAnimatingClosed:!1,top:l,left:r,blockTarget:Rt.default.state.stores[0]})},this.updateRichTextStateThrottled=S.P2(this.updateRichTextState,200,{leading:!1}),this.handleAnimationEnd=()=>{ir.Z.state.isActive||ir.Z.setState({...ir.Z.state,isAnimatingClosed:!1}),this.lastRenderState=this.renderStateStore.state},this.renderStateStore=this.createComputedStore((()=>{const{isActive:e,blockTarget:t}=ir.Z.state,s=_.default.state;if(!e||"empty"===s.mode)return;const{multiSelection:i}=s,n=(0,Qo.L5)(i),a=n.map((e=>{let{editable:t}=e;return t.getContextClosestSelectableStore()})),o=(0,C.qS)(i),r=_.default.isEditingComment(),l=_.default.isEditingCaption(),d=t&&t.getParentTable()===Vo.v,c=o&&t&&i.start.store===t.getCollectionViewSourceDescriptionStore(),u=this.pageContext&&this.pageContext.publicEditModeStore.state,m=!(0,$o.YF)(u)&&(i.start.store.canEdit()&&i.end.store.canEdit()),p=a.some(((e,t)=>{const s=n[t].store.table===Ys.x_&&!n[t].editable.props.disabled;return!!e&&(e.isLocked()||e.isNavigableAncestorLocked())&&!s})),g=m&&!p,h=t&&t.getType(),f=h&&mr.richTextMenuActionsDenylist[h],y=null==t?void 0:t.isType("button"),v=(0,Ho.td)(i.start.store)||(0,Ho.td)(i.end.store),x={isSingleStoreSelection:o,showTurnInto:Boolean(o&&!r&&!d&&!c&&!l&&t&&g&&!y&&!xs.default.isMiniPeekOpen()),showBold:Boolean(g),showItalic:Boolean(g),showStrikethrough:Boolean(g),showUnderline:Boolean(g),showCode:Boolean(g),showLink:Boolean(o&&g),showHighlight:Boolean(g),showDiscuss:Boolean(!r&&t&&!d&&!c&&!v&&!xs.default.isMiniPeekOpen()),showEquation:Boolean(o&&g),showMention:Boolean(o&&!r&&t&&!d&&g),showActionButton:Boolean(o&&!r&&!l&&t&&!d&&!xs.default.isMiniPeekOpen()),blockTarget:t,isComment:r,showCompletions:Boolean((0,Go.GD)(this.environment,u)&&g&&!r&&!l&&t&&!d&&!c&&!y&&!v)};if(f&&f.size>0)for(const S of f)x[S]=!1;return x})),this.canOnlyDiscussStore=this.createComputedStore((()=>{const e=this.renderStateStore.state;return e&&e.showDiscuss&&!e.showBold}))}didMount(){Rt.default.addListener(this.updateRichTextStateThrottled),_.default.addListener(this.updateRichTextStateThrottled),er.Z.addListener(this.updateRichTextState),sr.Z.addListener(this.updateRichTextState),tr.Z.addListener(this.updateRichTextState)}willUnmount(){_.default.removeListener(this.updateRichTextStateThrottled),Rt.default.removeListener(this.updateRichTextStateThrottled),er.Z.removeListener(this.updateRichTextState),sr.Z.removeListener(this.updateRichTextState),tr.Z.removeListener(this.updateRichTextState)}willMountOrUpdate(){const e=this.renderStateStore.state;e&&(this.lastRenderState=e)}renderComponent(){const{isActive:e,isAnimatingClosed:t}=ir.Z.state;return(0,y.jsx)(Us.Z,{open:e||t,children:this.renderOverlay()})}renderMenu(e){const{isActive:t}=ir.Z.state;return(0,y.jsxs)("div",{style:{display:"inline-flex",alignItems:"stretch",height:mr.height,background:this.theme.popoverBackground,overflow:"hidden",fontSize:14,lineHeight:1.2,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,pointerEvents:t?"auto":"none"},onMouseDown:e=>e.preventDefault(),children:[e.showCompletions&&this.renderCompletionsButton(),e.showTurnInto&&e.blockTarget&&this.renderTurnInto(e.blockTarget),e.showLink&&this.renderLinkButton(!0),e.showDiscuss&&e.blockTarget&&this.renderCommentButton(e.blockTarget),(0,y.jsxs)("div",{style:{display:"flex"},children:[e.showBold&&this.renderBoldButton(),e.showItalic&&this.renderItalicButton(),e.showUnderline&&this.renderUnderlineButton(),e.showStrikethrough&&this.renderStrikethroughButton(),e.showCode&&this.renderCodeButton(),e.showEquation&&this.renderEquationButton()]}),e.showHighlight&&(0,y.jsx)(rr.Z,{style:this.getBorderRight()}),e.showMention&&this.renderMention(),e.showActionButton&&e.blockTarget&&this.renderActionButton(e.blockTarget)]})}renderTurnInto(e){let t=(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.label"});const{intl:s}=this.props,i=e.getType();if(i){const e=qo.Hc[i];t=e&&e.displayName||t}return(0,y.jsx)(q.ZP,{popupType:q.Z4.Popup,buttonPopupStore:nr.Z,originGap:4,renderOrigin:e=>(0,y.jsx)($.Z,{renderTooltip:()=>s.formatMessage({defaultMessage:"Turn into",id:"richTextMenu.turnIntoButton.tooltip"}),render:s=>(0,y.jsxs)(G.Z,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...this.getBorderRight()},...(0,X.Z)(e,s),children:[t,(0,Lo.i)({width:10,marginLeft:4,fill:this.theme.lightIconColor})]})}),render:()=>(0,y.jsx)(d.Z,{menuType:m.og.Popup,children:(0,y.jsx)(Et.Z,{context:{blocks:[e],environment:this.environment,publicEditMode:void 0},sections:[Wo.g],onAccept:t=>{const s=e.getType(),i=e.getFormat();zo.w(),M.dhV(this.environment,{analyticsName:t.analyticsName,from:"rich_text_menu",block_id:e.id,block_type:s,is_toggleable:s?(0,Ye._A)(s,i):void 0})}})}),onClick:()=>{M.mt_(this.environment,{action:"turn_into"})}})}renderBoldButton(){return(0,y.jsx)(dr.Z,{type:"b",tooltipLabel:(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)("div",{children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Bold",id:"richTextMenu.boldButton.tooltip"})}),(0,y.jsx)("div",{children:(0,y.jsx)(fo.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleBold"})})]}),children:(0,y.jsx)("span",{style:{fontWeight:Wa.Z.fontWeight.semibold},children:"B"})})}renderItalicButton(){return(0,y.jsx)(dr.Z,{type:"i",tooltipLabel:(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)("div",{children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Italicize",id:"richTextMenu.italicsButton.tooltip"})}),(0,y.jsx)("div",{children:(0,y.jsx)(fo.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleItalics"})})]}),children:(0,y.jsx)("span",{style:{fontStyle:"italic"},children:"i"})})}renderStrikethroughButton(){return(0,y.jsx)(dr.Z,{type:"s",tooltipLabel:(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)("div",{children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Strike-through",id:"richTextMenu.strikeThroughButton.tooltip"})}),(0,y.jsx)("div",{children:(0,y.jsx)(fo.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleStrike"})})]}),children:(0,y.jsx)("span",{style:{textDecoration:"line-through"},children:"S"})})}renderUnderlineButton(){return(0,y.jsx)(dr.Z,{type:"_",tooltipLabel:(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)("div",{children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Underline",id:"richTextMenu.underlineButton.tooltip"})}),(0,y.jsx)("div",{children:(0,y.jsx)(fo.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleUnderline"})})]}),children:(0,y.jsx)("span",{style:{textDecoration:"underline"},children:"U"})})}renderCodeButton(){return(0,y.jsx)(dr.Z,{type:"c",style:{padding:"0 6px"},tooltipLabel:(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)("div",{children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Mark as code",id:"richTextMenu.markAsCodeButton.tooltip"})}),(0,y.jsx)("div",{children:(0,y.jsx)(fo.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"toggleCode"})})]}),children:No({width:15,height:15})})}renderLinkButton(e){const t=this.environment.device.isMobile;return(0,y.jsxs)(ur.Z,{style:this.getBorderRight(),children:[e&&(0,ja.J)({width:t?18:16,height:t?18:16,marginRight:4,fill:this.theme.regularIconColor}),(0,y.jsx)("span",{style:{borderBottom:`1px solid ${this.theme.linkDecorationColor}`},children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Link",id:"richTextMenu.linkButton.tooltip"})})]})}renderCompletionsButton(){const{intl:e}=this.props;return(0,y.jsx)($.Z,{renderTooltip:()=>(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{children:e.formatMessage({defaultMessage:"Ask AI to help edit, review, or generate text.",id:"richTextMenu.assist.tooltip"})}),(0,y.jsx)("div",{children:(0,y.jsx)(fo.Z,{style:{color:this.theme.mediumInvertedTextColor},name:"commandJ"})})]}),render:e=>(0,y.jsxs)(G.Z,{style:{display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap",...this.getBorderRight()},...e,onClick:()=>{(0,Ko.hr)({from:"rich_text_menu",environment:this.environment}),M.mt_(this.environment,{action:"completions"})},children:[(0,rn.t)({width:16,height:16,fill:P.FN.light.purple[400],marginRight:4}),(0,y.jsx)("span",{style:{color:P.FN.light.purple[400],fontWeight:500},children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Ask AI",id:"richTextMenu.assistButton.label"})})]})})}renderEquationButton(){return(0,y.jsx)(cr.Z,{style:this.getBorderRight(),onClick:()=>{M.mt_(this.environment,{action:"e"}),zo.w()},children:(0,Eo.G)({width:16,height:16})})}renderMention(){return(0,y.jsx)($.Z,{renderTooltip:()=>(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)("div",{children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Mention a person,{br}page, or date",id:"richTextMenu.mentionButton.tooltip",values:{br:(0,y.jsx)("br",{})}})}),(0,y.jsx)("div",{style:{color:this.theme.mediumInvertedTextColor},children:"@"})]}),render:e=>(0,y.jsx)(G.Z,{style:{...this.getBorderRight(),padding:"0 8px"},...e,onClick:()=>{Za.lZ(this.environment,{page:!0,createPage:!0,user:!0,bot:!0,date:!0,reminder:!0,templateVariable:!0,group:!0}),M.mt_(this.environment,{action:"mention"})},children:(0,Oo.O)({width:14,fill:this.theme.regularTextColor})})})}renderCommentButton(e){return(0,y.jsx)(lr.Z,{style:this.getBorderRight(),blockStore:e})}renderActionButton(e){return(0,y.jsx)(or.Z,{store:e,style:{borderRight:"none",borderRadius:0,padding:0,width:30,height:"none"},iconStyle:{fill:this.theme.regularTextColor},fadeIn:!1,onClick:()=>{M.mt_(this.environment,{action:"more"})}})}hasNonCollapsedTextSelection(){const e=ho.get();return!!e&&!e.collapsed&&"empty"!==_.default.state.mode&&!(0,C.iG)(_.default.state.multiSelection)}getBorderRight(){return{boxShadow:`1px 0 0 ${this.theme.regularDividerColor}`,marginRight:1}}}mr.displayName="RichTextMenu",mr.richTextMenuBlockTypesDenylist={[Ce.Ti.factory]:!0},mr.richTextMenuActionsDenylist={[Ce.Ti.code]:new Set(["showMention","showCode","showCompletions"]),[Ce.Ti.table]:new Set(["showTurnInto","showActionButton","showCompletions"]),[Ce.Ti.tableRow]:new Set(["showTurnInto","showActionButton","showCompletions"])},mr.leftOffset=60,mr.height=32;const pr=(0,r.injectIntl)(mr);s(21703);var gr=s(1302),hr=s(14248),fr=s(14714),yr=s(93959),vr=s(78316),xr=s(79954),Sr=s(55367),br=s(12211),Mr=s(50628);const wr=200;var jr=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}(jr||{});function Cr(e){return e.type===jr.Selectable?{type:Sr.Dl.Selectable,store:e.target.props.store,direction:e.direction}:{type:Sr.Dl.DropTarget,key:e.target.props.dropTargetKey,direction:e.direction}}function kr(e){const{target:t,device:s,direction:i,points:n}=e;return i===Sr.vh.Onto||!s.isPhone||t.props.dropzoneShouldNeverUseOrigin?n.mousePoint:{x:n.originPoint.x,y:n.mousePoint.y}}function _r(e){return e instanceof xr.Z?{type:jr.Selectable,target:e}:{type:jr.DropTarget,target:e}}function Tr(e){if(!(e&&e instanceof xr.Z))return!1;let t=e;const s=Sr.ZP.state;if(!s.isDragging)return!1;const{draggedStores:i}=s;for(;t;){if(i.indexOf(t.props.store)>=0)return!0;t=t.getContextClosestSelectable()}return!1}function Ir(e){const{dropzoneMustBeWithinHorizontalBound:t,device:s}=e;return t?0:s.isPhone?9999:0}function Pr(e){switch(e.direction){case Sr.vh.Onto:return function(e){const{device:t,isNativeDrag:s,rect:i,target:n,points:a,priority:o,canAcceptDrop:r}=e,l=Sr.vh.Onto,d=kr({device:t,target:n,direction:l,points:a});if((s?n.props.canNativeDropOnto:n.props.canDropOnto)&&Fr(d,i)&&!Tr(n)&&r(n,l))return{..._r(n),direction:l,left:i.left,top:i.top,width:i.width,height:i.height,priority:o}}(e);case Sr.vh.Left:return function(e){const{device:t,isNativeDrag:s,rect:i,target:n,points:a,priority:o,optionKeyDown:r,canAcceptDrop:l}=e,d=Sr.vh.Left,c=kr({device:t,target:n,direction:d,points:a});if((s?n.props.canNativeDropLeft:n.props.canDropLeft)&&i&&c.y>=i.top&&c.y<=i.bottom&&Math.abs(c.x-i.left)<=200&&(r||!Tr(n))&&l(n,d))return{..._r(n),direction:d,left:i.left,top:i.top,width:0,height:i.height,priority:o}}(e);case Sr.vh.Right:return function(e){const{device:t,isNativeDrag:s,rect:i,target:n,points:a,priority:o,optionKeyDown:r,canAcceptDrop:l}=e,d=Sr.vh.Right,c=kr({device:t,target:n,direction:d,points:a});if((s?n.props.canNativeDropRight:n.props.canDropRight)&&i&&c.y>=i.top&&c.y<=i.bottom&&Math.abs(c.x-i.right)<=wr&&(r||!Tr(n))&&l(n,d))return{..._r(n),direction:d,left:i.right,top:i.top,width:0,height:i.height,priority:o}}(e);case Sr.vh.Above:return function(e){const{device:t,isNativeDrag:s,rect:i,target:n,points:a,priority:o,optionKeyDown:r,canAcceptDrop:l}=e,d=Ir({dropzoneMustBeWithinHorizontalBound:n.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=Sr.vh.Above,u=kr({device:t,target:n,direction:c,points:a});if((s?n.props.canNativeDropAbove:n.props.canDropAbove)&&i&&u.x>=i.left-14-d&&u.x<=i.right+d&&(r||!Tr(n))&&l(n,c))return{..._r(n),direction:c,left:i.left,top:i.top,width:i.width,height:0,priority:o}}(e);case Sr.vh.Below:return function(e){const{device:t,isNativeDrag:s,rect:i,target:n,points:a,priority:o,optionKeyDown:r,canAcceptDrop:l}=e,d=Ir({dropzoneMustBeWithinHorizontalBound:n.props.dropzoneMustBeWithinHorizontalBound,device:t}),c=Sr.vh.Below,u=kr({device:t,target:n,direction:c,points:a});if((s?n.props.canNativeDropBelow:n.props.canDropBelow)&&i&&u.x>=i.left-14-d&&u.x<=i.right+d&&(r||!Tr(n))&&l(n,Sr.vh.Below))return{..._r(n),direction:Sr.vh.Below,left:i.left,top:i.bottom,width:i.width,height:0,priority:o}}(e)}}function Zr(e){const{device:t,rect:s,target:i,points:n,optionKeyDown:a}=e;return Fr(kr({device:t,target:i,direction:Sr.vh.Onto,points:n}),s)&&Tr(i)&&!a}function Fr(e,t){return Boolean(t&&e.x>=t.left&&e.x<=t.right&&e.y>=t.top&&e.y<=t.bottom)}var Ar=s(28314),Dr=s(75770),Br=s(35026),Rr=s(17031),Lr=s(27406),Nr=s(81844),Er=s(16339),Or=s(95802),Vr=s(91681),Ur=s(86486);class Wr extends o.Z{constructor(){super(...arguments),this.isUpdatingDragState=!1,this.didTouchEnd=!1,this.lastMouseInfo=void 0,this.handleWindowMouseMove=e=>{const t=Ur.default.state;if(!e||t.isOpen&&t.menuIsOpen||(this.lastMouseInfo={target:e.target,x:e.clientX,y:e.clientY}),this.didTouchEnd)return void(this.didTouchEnd=!1);const{isDragging:s}=Sr.ZP.state;if(s)this.updateDragState();else{if(!this.lastMouseInfo)return;this.updateHoverState(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}},this.handleDragBlockStoreChange=()=>{this.isUpdatingDragState||this.handleWindowMouseMoveThrottled(void 0)},this.handleWindowMouseMoveThrottled=S.P2((e=>Li.Z.withListenerIgnored((()=>this.handleWindowMouseMove(e)))),60),this.handleSelectionChange=()=>{const{isDragging:e}=Sr.ZP.state;gr.default.afterNextFlush((()=>{this.lastMouseInfo&&!e&&this.updateHoverState(this.lastMouseInfo.target,this.lastMouseInfo.x,this.lastMouseInfo.y)}))},this.handleSelectionChangeThrottled=S.P2(this.handleSelectionChange,60),this.handleWindowKeyEvent=()=>{const{isDragging:e}=Sr.ZP.state;e&&this.updateDragState()},this.handleWindowTouchEnd=()=>{this.didTouchEnd=!0},this.handleWindowScroll=()=>{Bs.Ch(),this.clearHoverState()},this.handleWindowResize=()=>{Bs.Ch(),this.clearHoverState()},this.handleGlobalMenuIsOpenChange=()=>{const e=Ur.default.state,t=He.kw.state;e.isOpen&&!e.menuIsOpen&&t&&Ur.default.reset()},this.memoizedCanDragCache=new WeakMap,this.memoizedCanDrag=e=>{const t=this.memoizedCanDragCache.get(e);if(this.memoizedCanDragCache.has(e))return t;const s=(0,lt.OO)({environment:this.environment,blocks:e,publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state});return this.memoizedCanDragCache.set(e,s),s},this.getDropZonePriority=e=>(null==e?void 0:e.priority)??0}didMount(){super.didMount();const{device:e}=this.environment;ui.lj(window,"mousemove",this.handleWindowMouseMoveThrottled),Rt.default.addListener(this.handleSelectionChangeThrottled),e.isIOS&&ui.lj(window,"touchend",this.handleWindowTouchEnd),ui.lj(window,"keydown",this.handleWindowKeyEvent),ui.lj(window,"keyup",this.handleWindowKeyEvent),Sr.ZP.addListener(this.handleDragBlockStoreChange),ui.lj(window,"scroll",this.handleWindowScroll,!0),ui.lj(window,"resize",this.handleWindowResize),He.kw.addListener(this.handleGlobalMenuIsOpenChange),Bs.Jy()}willUnmount(){super.willUnmount();const{device:e}=this.environment;ui.ZV(window,"mousemove",this.handleWindowMouseMoveThrottled),Rt.default.removeListener(this.handleSelectionChangeThrottled),e.isIOS&&ui.ZV(window,"touchend",this.handleWindowTouchEnd),ui.ZV(window,"keydown",this.handleWindowKeyEvent),ui.ZV(window,"keyup",this.handleWindowKeyEvent),Sr.ZP.removeListener(this.handleDragBlockStoreChange),ui.ZV(window,"scroll",this.handleWindowScroll,!0),ui.ZV(window,"resize",this.handleWindowResize),He.kw.removeListener(this.handleGlobalMenuIsOpenChange)}updateDragState(){if(this.isUpdatingDragState)throw new Error("Assertion failure, updateDragState() called when this.isUpdatingDragState === true!");this.isUpdatingDragState=!0;try{this.updateDragStateInner()}finally{this.isUpdatingDragState=!1}}updateDragStateInner(){const e=Sr.ZP.state;if(!e.isDragging)return;const{draggedStores:t,currentX:s,currentY:i,offsetX:n,offsetY:a,isNativeDrag:o}=e,r={x:s,y:i},l={x:s-n,y:i-a},d=this.findNearbyDropZones({mousePoint:r,originPoint:l},t[0],o);if(d.ontoDropZone)Sr.ZP.setState({...e,currentDropZone:d.ontoDropZone,currentHintDropZones:[],currentParentStore:void 0});else if(d.verticalDropZone)Sr.ZP.setState({...e,currentDropZone:d.verticalDropZone,currentHintDropZones:[],currentParentStore:void 0});else{if(d.horizontalDropZones.length>0){const t=d.horizontalDropZones[0],s=S.Gb(d.horizontalDropZones);if(t.type===Sr.Dl.Selectable){const i=Or.C.findSelectableFromStore(t.store);if(i){const n=i.getContextClosestSelectable();let a;return n&&n.props.store!==t.store&&n.props.shouldShowParentHalo&&(a=n.props.store),void Sr.ZP.setState({...e,currentDropZone:t,currentHintDropZones:s,currentParentStore:a})}}else{if(Lr.Z.findDropTargetFromKey(t.key))return void Sr.ZP.setState({...e,currentDropZone:t,currentHintDropZones:s,currentParentStore:void 0})}}Sr.ZP.setState({...e,currentDropZone:void 0,currentHintDropZones:[],currentParentStore:void 0})}}clearHoverState(){const e=Ur.default.state;e.isOpen&&!e.menuIsOpen&&Ur.default.reset()}updateHoverState(e,t,s){const i=Ur.default.state;if(!i.isOpen||!i.menuIsOpen){const n=this.findHoverMenuTarget(e,t,s);n?i.isOpen&&n.selectable.props.store===i.currentStore||Ur.default.setState({isOpen:!0,currentStore:n.selectable.props.store,container:n.container,menuIsOpen:!1}):Ur.default.reset()}}getHighestDropZonePriorityRects(e){const t=this.getDropZonePriority(S.UT(e,this.getDropZonePriority));return e.filter((e=>this.getDropZonePriority(e)===t))}getSelectableContainerPriority(e){return(Rt.default.state.droppableContainerStack||[]).indexOf(e)}findNearbyDropZones(e,t,s){const{device:i}=this.environment,n=Ar.yA(),a=function(){const{selectableRectMap:e}=Mr.Z.state,{dropTargetRectMap:t}=br.Z.state,s=new Map;return e.forEach(((e,t)=>{s.set(t,e)})),t.forEach(((e,t)=>{s.set(t,e)})),s}(),o=a.keys();let r=o.next();const l=Or.C.findSelectableFromStore(t),d=l?l.getContextSelectableContainer():void 0;let c=[];for(;!r.done;){const t=r.value;r=o.next();const l=a.get(t),u=t.getContextSelectableContainer();if(i.isPhone&&u!==d)continue;if(!u||u.props.disable)continue;const m=this.getSelectableContainerPriority(u),p={device:this.environment.device,isNativeDrag:s,rect:l,target:t,points:e,priority:m,optionKeyDown:n.option,canAcceptDrop:(e,t)=>this.selectableCanAcceptDrop(e,t,n.option)};if(Zr(p))return{ontoDropZone:void 0,verticalDropZone:void 0,horizontalDropZones:[]};c.push(...S.oA([Pr({...p,direction:Sr.vh.Onto}),Pr({...p,direction:Sr.vh.Left}),Pr({...p,direction:Sr.vh.Right}),Pr({...p,direction:Sr.vh.Above}),Pr({...p,direction:Sr.vh.Below})]))}c=this.getHighestDropZonePriorityRects(c);const u=c.filter((e=>e.direction===Sr.vh.Above||e.direction===Sr.vh.Below)),m=S.F(u,(t=>Math.abs(t.top-this.getReferencePointForRect(t,e).y)));let p=u.filter((e=>{let{top:t}=e;return Math.abs(t-(m?m.top:0))<=Wr.competingHorizontalDropZoneMinDist}));if(p.length>1){p=p.filter((t=>{const s=this.getReferencePointForRect(t,e).x,i=Ir({device:this.environment.device});return s>=t.left-i&&s<=t.left+t.width+i})),p=S.MR(p,(e=>{let{left:t}=e;return t}));let t=0;for(;t<p.length-1;t++){const s=p[t+1],i=this.getReferencePointForRect(s,e).x;if(s.left>i)break}p=p.slice(0,t+1),p.reverse()}const g=p.map(Cr);let h;const f=c.filter((e=>e.direction===Sr.vh.Onto)),y=S.F(f,(e=>e.height));if(y){u.some((t=>{const s=this.getReferencePointForRect(t,e).y;return Math.abs(t.top-s)<Wr.competingOntoDropZoneVerticalOffset}))||(h=Cr(y))}let v;const x=c.filter((e=>e.direction===Sr.vh.Left||e.direction===Sr.vh.Right));let b=S.F(x,(t=>{const s=this.getReferencePointForRect(t,e).x;return Math.abs(t.left-s)}));if(b){const e=b,t=x.filter((t=>Math.abs(t.left-e.left)<Wr.verticalDropZoneAmbiguousDist));t.length>0&&(b=S.F(t,(e=>e.left)))}if(b){const e=b;u.some((t=>t.top>=e.top&&t.top+t.height<=e.top+e.height))||(v=Cr(b))}return{ontoDropZone:h,verticalDropZone:v,horizontalDropZones:g}}findHoverMenuTarget(e,t,s){if(Vr.Z.state.isResizing||Sr.ZP.state.isDragging||So.Z.state.isActive||He.kw.state)return;const{selectableRectMap:i}=Mr.Z.state,n=Er.Z.getMembersByDOMOrder({filter:t=>{const s=t.getNode();return Boolean(s&&s.contains(e))}})[0],a=Rt.default.getCurrentDefaultContainer(),o=n||a;if(!o)return;const r=i.keys();let l=r.next();const d=[];for(;!l.done;){const e=l.value,n=i.get(e);(e.props.shouldShowHoverMenu||e.props.shouldShowCommentMenu)&&e.getContextSelectableContainer()===o&&n&&s>=n.top&&s<=n.bottom&&t>=n.left-Wr.hoverMaxHorizontalOffset&&t<=n.right&&d.push(e),l=r.next()}const c=S.MR(d,(e=>{const t=i.get(e);return t?-t.left:1/0})),u=c.find((e=>{const t=e.getNode();if(t){if(c.find((s=>{if(s!==e){const e=s.getNode();return Boolean(e&&t.contains(e))}return!1})))return!1}return!0}));return u?{selectable:u,container:o}:void 0}selectableCanAcceptDrop(e,t,s){if(ve.Z.state.isOpen&&!xs.default.state.open)return!1;if(xe.Z.state.isOpen)return!1;const i=Sr.ZP.state,n=i.isDragging?i.draggedStores:[],a=!!i.isDragging&&i.isNativeDrag;let o,r,l,d=!1,c=!1;n.find((e=>{const t=Nr.Z.findOutlinerItemFromStore(e);return!!t&&(o=t,r=t.type,d=t.isTopLevelItem,!0)}));const u=e instanceof xr.Z?Nr.Z.findOutlinerItemFromStore(e.props.store):void 0,m=null==u?void 0:u.parentStore;var p;u&&(l=u.type,c=u.isTopLevelItem||"team"===(null===(p=u.parentStore)||void 0===p?void 0:p.table));if(this.isDraggingSharedPageOutOfTopLevelTeamSection({draggingOutlinerItem:o,selectableOutlinerItemParent:m,direction:t}))return!1;if(!(e instanceof xr.Z))return e.props.canAcceptDrop({direction:t,draggingStores:n,isNativeDrag:a});const g=e.props.store,h=g.getAssociatedCollectionStore();if(t===Sr.vh.Onto&&h){const e=h.id,t=(0,vr.fm)(g),s=null==t?void 0:t.collectionViewStore();if(s&&"page"!==s.getType()){if(n.find((t=>{const s=t.getAssociatedCollectionStore();return Boolean(t instanceof Bt.G&&s&&s.id===e)})))return!1}}if(e.props.groupsPointer){if(e.props.groupsPointer.find((e=>!(0,hr.WL)(e)))){if(n.find((t=>{var s;const i=Or.C.findSelectableFromStore(t);return(null==i||null===(s=i.props)||void 0===s?void 0:s.groupsPointer)&&e.props.groupsPointer&&!(0,fr.HH)(i.props.groupsPointer,e.props.groupsPointer)})))return!1}}if((0,Dr.ru)({targets:n,destination:g,direction:t,draggingOutlinerType:r}))return!1;if(s&&n.find((e=>e.isTypedCollectionViewBlock()||(0,yr.h7)(e))))return!1;if(u&&t!==Sr.vh.Onto&&!c&&!(0,lt.M)({environment:this.environment,blocks:[u.store],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(l&&a)return!1;if("bookmarks"===r&&d&&("bookmarks"!==l||!c||t===Sr.vh.Onto))return!1;if("bookmarks"===l&&c&&t!==Sr.vh.Onto&&("bookmarks"!==r||!d))return!1;if(o&&o.isTopLevelItem&&"team"===o.type&&o.parentStore&&o.parentStore.table===Le.e0){const e=o.parentStore,t=Bt.zX.createChildStore(e,{...e.pointer,table:Le.e0});if(t&&!(0,Br.si)({teamStore:t,environment:this.environment}))return!1}if(u&&u.isTopLevelItem&&"team"===u.type&&u.parentStore&&u.parentStore.table===Le.e0){const e=u.parentStore,t=Bt.zX.createChildStore(e,{...e.pointer,table:Le.e0});if(t&&!(0,Br.si)({teamStore:t,environment:this.environment}))return!1}if("shared"===l&&c&&("shared"!==r||!d))return!1;if(l&&c&&t!==Sr.vh.Onto){if(n.find((e=>{const t=e.getType();return Boolean(!t||!Ce.Z7[t])})))return!1}const{device:f}=this.environment;if(l&&f.isMobile&&t===Sr.vh.Onto&&c)return!1;if(n.find((e=>Boolean(e instanceof Bt.G&&e.isInlineCollectionView())))&&(t===Sr.vh.Left||t===Sr.vh.Right))return!1;if(n.some((e=>Boolean(Rr.Z.findCollectionTemplatePickerItemFromStore(e))))!==Boolean(Rr.Z.findCollectionTemplatePickerItemFromStore(g)))return!1;if(t===Sr.vh.Onto&&g&&!(0,lt.J5)({environment:this.environment,blocks:[g],publicEditMode:this.pageContext&&this.pageContext.publicEditModeStore.state}))return!1;if(!this.memoizedCanDrag(n))return!1;if(n.some((e=>e.isTransclusionType()))){if(g.findRecordStoreUIAncestor((e=>{if(e===g)return!1;const t=e.isTable("block")&&e.isPath([])&&e.getValue();return Boolean(t&&(0,Ce.nq)(t.type))})).ancestor)return!1}return!0}getReferencePointForRect(e,t){return kr({device:this.environment.device,target:e.target,points:t})}isDraggingSharedPageOutOfTopLevelTeamSection(e){var t;const{draggingOutlinerItem:s,selectableOutlinerItemParent:i,direction:n}=e;if(s&&"team"===s.type&&s.isTopLevelItem&&(null===(t=s.parentStore)||void 0===t?void 0:t.pointer.table)===Le.e0){const e=s.parentStore;if(!(s.store.getParentId()===e.pointer.id||i&&i.pointer.id===e.pointer.id&&n!==Sr.vh.Onto))return!0}return!1}}Wr.displayName="SelectableOrDropTargetListener",Wr.hoverMaxHorizontalOffset=150,Wr.competingOntoDropZoneVerticalOffset=7,Wr.verticalDropZoneAmbiguousDist=20,Wr.competingHorizontalDropZoneMinDist=2;const zr=Wr;var Kr=s(12534),Hr=s(49427),Gr=s(74948),qr=s(38676);class Yr extends o.Z{constructor(){super(...arguments),this.cachedPageViewRect=void 0,this.previousMousePosition=void 0,this.mouseSpeed=1/0,this.timerId=void 0,this.setPreviousMousePosition=(e,t)=>{this.previousMousePosition={x:e,y:t},clearTimeout(this.timerId),this.timerId=setTimeout((()=>{this.previousMousePosition=void 0}),100)},this.handleWindowMouseMove=e=>{(0,Kr.ZP)({event:e,context:Kr.Af.SidebarMouseMove,callback:()=>{if(this.updatePageViewRectThrottled(),void 0!==this.previousMousePosition&&(this.mouseSpeed=Math.sqrt(Math.pow(e.clientX-this.previousMousePosition.x,2)+Math.pow(e.clientY-this.previousMousePosition.y,2))),this.setPreviousMousePosition(e.clientX,e.clientY),this.cachedPageViewRect){const{sidebarMinTriggerWidth:t,sidebarOpenWidthPercent:s}=Yr,i=qr.TC.state,n=(0,we.Wk)(this.environment),a=e.clientX,o=this.cachedPageViewRect.left,r=Math.max(o*s,t,qr.Ic.state);a<r&&!xs.default.isMiniOrCenterPeekOpen()&&this.mouseSpeed<Yr.mouseSpeedThreshold&&0!==this.mouseSpeed&&!i&&Gr.open(),a>n&&a>r&&i&&Gr.close()}}})},this.handleWindowMouseOut=e=>{e.toElement||e.relatedTarget||Gr.close()},this.handleWindowResize=e=>{this.environment.WindowSizeStore.state.width<Gr.OnlyOneSidebarVisibleWidthThreshold&&(0,we.Sx)(this.environment)&&(0,we.in)(this.environment)&&Gr.setExpand({environment:this.environment,isExpanded:!1,from:"sidebar_listener"})},this.updatePageViewRectThrottled=S.P2(this.updatePageViewRect,500)}didMount(){window.addEventListener("mousemove",this.handleWindowMouseMove),window.addEventListener("mouseout",this.handleWindowMouseOut),window.addEventListener("resize",this.handleWindowResize)}willUnmount(){window.removeEventListener("mousemove",this.handleWindowMouseMove),window.removeEventListener("mouseout",this.handleWindowMouseOut),window.removeEventListener("resize",this.handleWindowResize)}updatePageViewRect(){const e=this.getPageViewWrapEl();this.cachedPageViewRect=e?e.getBoundingClientRect():document.body.getBoundingClientRect()}getPageViewWrapEl(){const{mainEditorCurrentBlockStore:e}=ie.default.state,t=Hr.Z.find((t=>t.props.store===e));if(t){const e=t.getContentWrapEl();if(e)return e}}}Yr.displayName="SidebarListener",Yr.sidebarOpenWidthPercent=.38,Yr.sidebarMinTriggerWidth=18,Yr.mouseSpeedThreshold=5;const Qr=Yr;var $r=s(13991),Xr=s(46225),Jr=s(15944),el=s(84084),tl=s(68204),sl=s(64286),il=s(10743);class nl extends o.Z{constructor(){super(...arguments),this.renderMenu=()=>{const{device:e}=this.environment,t=il.Z.state;if(!t.open)return;const s=this.getSections(t),i=this.getFilter(t);let n;return n=e.isMobileNative&&!e.isTablet?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:this.getWidth(),maxHeight:"40vh",onClickOutside:el.xv},(0,y.jsx)(d.Z,{...n,children:(0,y.jsx)(Et.Z,{sections:s,onAccept:this.handleAccept,context:{environment:this.environment,blocks:Rt.default.state.stores,originRect:t.selectionRect,publicEditMode:void 0},filter:i,initialFocus:0,onEmptyEnter:this.handleCancel,useLimit:!0})})},this.handleCancel=()=>{el.xv()},this.handleAccept=(e,t,s,i)=>{const n=Rt.default.state.stores[0];if(n){const t=n.getType(),s=n.getFormat();M.dhV(this.environment,{analyticsName:e.analyticsName,from:"slash_menu",block_id:n.id,block_type:t,is_toggleable:t?(0,Ye._A)(t,s):void 0,slash_menu_filter_length:this.filterLength(),slash_menu_section:i})}j.createAndCommit({userAction:"SlashMenu.handleAccept",environment:this.environment,perform:e=>{el.RL({environment:this.environment,transaction:e})}})},this.filterLength=()=>{const e=il.Z.state;return e.open?e.filter.length:0}}willMountOrUpdate(){let e=il.Z.state;if(e.open){var t;const s=_.default.state;if("editing"!==s.mode)return!1;const i=this.getFilter(e),n=(0,tl.sG)({sections:this.getSections(e),context:{blocks:Rt.default.state.stores,environment:this.environment,publicEditMode:void 0},query:i||""});let a=0;if(i)if(0===n.length)a=i.length-e.lettersAtLastResult;else{const t={...e,lettersAtLastResult:(null==i?void 0:i.length)??0,filter:i};il.Z.setState(t),e=t}const{currentUserSettingsStore:o}=ie.default.state;!o||null!==(t=o.getSettings())&&void 0!==t&&t.pressed_slash_tooltip||!(0,sl.u)(this.environment)||Jr.q(this.environment);const{multiSelection:r}=s;(0,C.qS)(r)&&r.start.store===e.textStore&&!k.Ye(i,!0,n.length,a,e.textStore)||el.xv()}}renderComponent(){const{device:e}=this.environment,t=il.Z.state;return(0,y.jsx)(c.ZP,{popupType:e.isMobileNative&&!e.isTablet?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:t.open,originRect:t.open?t.selectionRect:void 0,placementToOrigin:c.ZP.Placement.Bottom,alignmentToOrigin:c.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,preventBlockRenderQueueOnEnter:!0,onDismiss:this.handleCancel,render:this.renderMenu})}getFilter(e){return k.zK(e.textStore,e.oldTextValue,!e.isAddMenu)}getSections(e){const{insertActions:t,slashActions:s}=Xr.w.state;return e.isAddMenu?t:s}getWidth(){return"fr-FR"===$r.SP?375:324}}nl.displayName="SlashMenu";const al=nl;var ol=s(84169),rl=s(1310),ll=s(9612),dl=s(84076);class cl extends o.Z{constructor(){super(...arguments),this.showingAnimatedList=W.default.createValue(!1),this.handleShow=()=>{this.showingAnimatedList.setState(!0)},this.handleHide=()=>{this.showingAnimatedList.setState(!1)}}renderComponent(){const{currentItem:e}=rl.ZP.state,t=Boolean(e||this.showingAnimatedList.state);return(0,y.jsx)(Us.Z,{open:t,zIndex:201,children:(0,y.jsx)(ll.Z,{render:()=>S.oA([this.renderCurrentItem()]),onShow:this.handleShow,onHide:this.handleHide})})}renderCurrentItem(){const{currentItem:e}=rl.ZP.state;if(!e)return;const t=(null==e?void 0:e.position)??"bottom",{WindowSizeStore:s,device:i}=this.environment;let n=24;if(i.isMobileNative&&i.isIOS){n=Oa.Z.state.estimatedKeyboardWebViewOverlap>0?24+Oa.Z.estimatedNativeWebBottomOverlap():s.getSafePaddingBottomCSS(24+Oa.Z.estimatedNativeWebBottomOverlap())}const a="top"===t?{top:24}:{bottom:n};return(0,y.jsx)(Os.Z,{isVisible:!0,enterAnimationStyle:{translateY:"top"===t?-50:50,opacity:1,scale:1},animationStyle:{translateY:0,opacity:1,scale:1},exitAnimationStyle:{translateY:0,opacity:0,scale:.95},render:()=>(0,y.jsx)("div",{"aria-live":"polite",style:{...a,position:"fixed",left:0,width:"100%",display:"flex",zIndex:Fs.E,padding:4},children:(0,y.jsxs)("div",{style:{background:this.theme.tooltipBackground,color:this.theme.regularInvertedTextColor,borderRadius:8,padding:"11px 16px",boxShadow:this.theme.largeBoxShadow,margin:"0 auto",fontSize:14,display:"flex",alignItems:"center",...null==e?void 0:e.style},children:[e.label,e.helpUrl&&(0,y.jsx)(dl.Z,{href:e.helpUrl,external:!0,style:{marginLeft:8,width:16,height:16,color:this.theme.regularInvertedTextColor},children:(0,ol.m)({fill:this.theme.mediumInvertedTextColor})}),(0,y.jsx)("div",{style:{marginLeft:4,marginRight:-4},children:e.right})]})})},e.key)}}cl.displayName="SnackbarRenderer";const ul=cl;var ml=s(6906),pl=s(76994),gl=s(65965),hl=s(47425),fl=s(37834),yl=s(1865),vl=s(83420),xl=s(52533),Sl=s(46096),bl=s(35057),Ml=s(84787),wl=s(50506),jl=s(76798),Cl=s(53336),kl=s(46247),_l=s(26263),Tl=s(16691),Il=s(4615),Pl=s(45953),Zl=s(606),Fl=s(13493),Al=s(66213),Dl=s(82136),Bl=s(45926);class Rl extends o.Z{constructor(){super(...arguments),this.handleOverrideLinkClick=e=>{fl.U4(),Fa.navigate({environment:this.environment,url:e})},this.loadSnapshot=async e=>{const{timestamp:t}=e,s=e.block.id,i=await ea.getSnapshotContents(this.environment,e);if("failed"===i.type)throw i.error;const n=Pl.PF.create(i.data.contentMap),a=this.environment.currentUser.id,o=new _l.Z({name:"PageSnapshotPreview"});for(const{pointer:u,model:m}of n)m&&o.setModelAndRole({pointer:u,userId:a},m,"reader");o.snapshotData={blockId:s,timestamp:t};const r=new Map,l=e=>{const t=o.getRecord({pointer:e,userId:a}),s=(0,Tl.dn)(e);t||!(0,Il.e)(e.id)||r.has(s)||r.set(s,(0,Bt.Kv)(this.props.blockStore,e))};for(const{model:u}of n)if(u)if(u.table===gs.iU){const e=u,t=e.getProperties(),s=Zl.dr.uniq(S.xH(Object.keys(t).map((e=>t[e])).map(b.cCA)));for(const d of s)l(d);const i=e.isNavigableBlock()?[]:e.getContentIds()||[];for(const d of i)l({table:gs.iU,id:d});const n=e.getCollectionPointer();n&&l(n);const a=S.jj(S.xH(Object.keys(t).map((e=>t[e])).map(b.lcG)));for(const d of a)l({table:$s.KJ,id:d});const o=u.getCreatedByPointer();o&&l(o);const r=u.getLastEditedByPointer();r&&l(r)}else if(u.table===Fl.n){var d;const e=null===(d=u.getFormat())||void 0===d?void 0:d.collection_pointer;e&&l(e)}else if(u.table===Ys.x_){const e=u.getCreatedByPointer();e&&l(e)}const c=Array.from(r.values());return await Promise.all(c.map((async e=>{await e.load();const t=e.getValue();t&&o.setRecord({pointer:e.pointer,userId:a},{role:"reader",value:t})}))),{blockStore:new Bt.G(this.environment,{table:gs.iU,id:s},{inMemoryRecordCache:o}),timestamp:t}}}getChildContext(){return{...this.context,overrideLinkClick:this.handleOverrideLinkClick}}renderComponent(){const e=this.props.blockStore.id,t=this.props.timestamp,s={request:{block:{id:e,spaceId:(0,Qs.C)(this.props.blockStore.pointer.spaceId)},timestamp:t},performRequest:this.loadSnapshot,render:(e,t,s)=>(0,y.jsx)(gi.Z,{show:!s||!t,showDelay:400,showHold:400,render:s=>s?(0,y.jsx)("div",{style:this.getSpinnerWrapperStyles(),children:(0,y.jsx)(Vs.Z,{})}):e?(0,y.jsx)("div",{style:{padding:32},children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Something went wrong.",id:"pageSnapshotPreview.unknownPreviewLoadError.message"})}):t?(0,y.jsx)(Ze.Z,{store:t.blockStore,isDefaultContainer:!0,droppable:!0,render:e=>{let{selectableEvents:s}=e;return(0,y.jsx)(Cl.Z,{style:{background:this.theme.contentBackground,zIndex:1,flexGrow:1},type:(0,He.Zy)({environment:this.environment,store:t.blockStore}),...s,children:(0,y.jsx)(Bl.Z,{store:t.blockStore,disabled:!0,loadingContainerStore:void 0,context:Dl.S.InAppTemplatePreview,paddingBottom:Bl.Z.paddingBottom(this.environment),paddingLeft:(0,He.ui)(this.environment),paddingRight:(0,He.ui)(this.environment),pageCoverHeight:Bl.Z.defaultPageCoverHeight(this.environment)})})}},t.timestamp):void 0})};return(0,y.jsx)(Al.LF,{value:this.handleOverrideLinkClick,children:(0,y.jsx)(jn.Z,{...s})})}getSpinnerWrapperStyles(){return{padding:32,display:"flex",alignItems:"center",justifyContent:"center"}}}Rl.displayName="PageSnapshotPreview",Rl.contextTypes=o.w,Rl.childContextTypes={...Al.wK,...o.w};const Ll=Rl;class Nl extends o.Z{constructor(){super(...arguments),this.renderSnapshotsListRequest=()=>{const{device:e}=this.environment,t=Sl.Z.state;if(!t.open)return;const s={request:{block:{id:t.blockStore.id,spaceId:(0,Qs.C)(t.blockStore.pointer.spaceId)},size:t.size},performRequest:e=>this.loadSnapshotsList(e,t),render:(s,i,n)=>(0,y.jsx)(gi.Z,{show:Boolean(!i||i.snapshots.length>=t.size&&t.openSnapshotNearTimestamp),showDelay:400,showHold:100,render:a=>e.isMobile?this.renderMobileHistory({snapshotValues:i?i.snapshots:[],menuState:t,error:s,initialLoading:a,loadingMore:!n}):this.renderDesktopHistory({snapshotValues:i?i.snapshots:[],menuState:t,error:s,initialLoading:a,loadingMore:!n})})};return(0,y.jsx)(jn.Z,{...s})},this.renderMobileHistory=e=>{let t,s;return e.loadingMore||0!==e.snapshotValues.length||(t=this.renderUnavailableMessage(Nl.noSnapshotsMessage,!1)),s=e.error?(0,y.jsx)("div",{style:Nl.wrapStyle,children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.errorMessage"})}):e.initialLoading?(0,y.jsx)("div",{style:Nl.wrapStyle,children:(0,y.jsx)(Vs.Z,{})}):(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)(Cl.Z,{type:_e.Z.Y,children:this.renderSnapshotsMenuList(e)}),this.renderMobileSnapshotPreview(e.menuState)]}),(0,y.jsx)(d.Z,{menuType:m.og.Modal,title:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"History",id:"historyModal.mobileHistoryMenu.title"}),left:this.renderMobileHelpButton(),right:(0,y.jsx)(Pe.DoneMenuText,{}),onClickRight:fl.U4,header:t,children:s})},this.renderDesktopHistory=e=>{let t;if(e.error)t=(0,y.jsx)("div",{style:Nl.wrapStyle,children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Something went wrong",id:"historyModal.desktopModal.errorMessage"})});else if(e.initialLoading)t=(0,y.jsx)("div",{style:Nl.wrapStyle,children:(0,y.jsx)(Vs.Z,{})});else{const s=e.menuState.snapshot&&this.getSnapshotUpsell({snapshot:e.menuState.snapshot,nextFutureSnapshot:e.menuState.nextFutureSnapshot});t=s?this.renderUnavailableMessage(s.message,s.tier):e.loadingMore||0!==e.snapshotValues.length?this.renderDesktopSnapshotPreview(e.menuState):this.renderUnavailableMessage(Nl.noSnapshotsMessage,!1)}return(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)("div",{style:{display:"flex",flexDirection:"column",width:`calc(100% - ${Nl.sidebarWidth}px)`,boxShadow:`1px 0 0 ${this.theme.regularDividerColor}`},children:t}),this.renderDesktopSidebar(e)]})},this.renderSnapshotsMenuList=e=>{const{device:t}=this.environment,{menuState:s,loadingMore:n}=e,a=S.oA(e.snapshotValues.map(((i,n)=>{const a=n>0?e.snapshotValues[n-1]:void 0,o=this.getSnapshotUpsell({snapshot:i,nextFutureSnapshot:a}),l=!o;return{key:i.id,action:()=>{fl.gs({environment:this.environment,snapshot:i,nextFutureSnapshot:a})},render:e=>{const n=i.authors||[],a=this.props.intl.formatList(S.oA(n.map((e=>(0,vl.nc)({parentStore:s.blockStore,pointer:e}).getDisplayName(this.props.intl)))),{type:"conjunction",style:"narrow"}),d=(0,y.jsx)("div",{style:{...Wa.Z.textOverflowStyle},children:a}),c=Boolean(s.snapshot&&s.snapshot.id===i.id),u=parseInt(i.timestamp),m=u>Date.now()-6*hs.A0?(0,xa.$b)(u,$r.SP,this.props.intl):(0,xa.Yx)(u,"medium",$r.SP),p=(0,xa.Yx)(u,"medium_with_time",$r.SP);return l?(0,y.jsx)($.Z,{render:s=>(0,y.jsx)(Gt.Z,{...(0,X.Z)(e,s),title:m,focused:!t.isMobile&&c,caption:d}),renderTooltip:()=>(0,y.jsxs)("div",{style:{maxWidth:270,whiteSpace:"normal"},children:[(0,y.jsx)("div",{children:p}),(0,y.jsx)("div",{children:a})]})},e.key):(0,y.jsx)($.Z,{render:s=>(0,y.jsx)(Gt.Z,{...(0,X.Z)(s,e),title:(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,y.jsx)("div",{style:{...t.isMobile&&{display:"flex",flex:1},...Wa.Z.textOverflowStyle},children:m}),(0,y.jsx)(kn.Z,{subscriptionTier:o.tier,analyticsName:"history_modal",desktopStyle:{marginLeft:8},onClick:()=>this.handleUpgrade(o.tier)})]}),focused:!t.isMobile&&c,caption:d}),renderTooltip:()=>(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Upgrade to view this snapshot.",id:"historyModal.snapshotsMenuList.upgrade.tooltip"}),disableTooltip:!hl.QM},e.key)}}}))),o=s.snapshot&&s.snapshot.id,l=a.findIndex((e=>o===e.key)),d=[{key:"snapshots",render:e=>(0,y.jsx)(L.Z,{...e}),items:a}];return(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)(B.Z,{type:B.i.Vertical,initialFocus:l,sections:d}),(0,y.jsx)(Ml.Z,{loading:n,fetchSize:s.size,resultSize:e.snapshotValues.length,onLoadMore:fl.FF}),(0,y.jsx)(gi.Z,{show:n,showDelay:300,showHold:100,render:e=>e&&(0,y.jsx)("div",{style:Nl.wrapStyle,children:(0,y.jsx)(Vs.Z,{})})})]})},this.handleUpgrade=e=>{yl.y(this.environment,{from:"history_modal",for:e})},this.getAriaLabel=()=>this.props.intl.formatMessage({id:"historyModal.ariaLabel",defaultMessage:"Page History"}),this.loadSnapshotsList=async(e,t)=>{const{device:s}=this.environment,i=await ea.getSnapshotsList(this.environment,e);if("failed"===i.type)throw i.error;const{snapshots:n}=i.data;if(t.pageHasCollection=n.some((e=>{var t;const s=null===(t=e.collection_ids)||void 0===t?void 0:t.length;return s&&0!==s})),t.openSnapshotNearTimestamp){const e=parseInt(t.openSnapshotNearTimestamp),s=n.findIndex((t=>parseInt(t.timestamp)<e));0===n.length||(0===s?fl.gs({environment:this.environment,snapshot:n[s],nextFutureSnapshot:void 0}):s>0?fl.gs({environment:this.environment,snapshot:n[s-1],nextFutureSnapshot:s>1?n[s-2]:void 0}):n.length<t.size?fl.gs({environment:this.environment,snapshot:n[n.length-1],nextFutureSnapshot:n.length>1?n[n.length-2]:void 0}):fl.FF())}else Boolean(t.snapshot)||s.isMobile||Sl.Z.setState({...t,snapshot:n[0],nextFutureSnapshot:void 0});return i.data},this.iconSize=()=>{const{device:e}=this.environment;return e.isMobile?24:20}}renderComponent(){const{device:e}=this.environment,t=Sl.Z.state;return e.isMobile?(0,y.jsx)(c.ZP,{ariaLabel:this.getAriaLabel(),popupType:c.ZP.PopupType.SlideUp,open:t.open,render:this.renderSnapshotsListRequest,onDismiss:fl.U4}):(0,y.jsx)(wl.Z,{ariaLabel:this.getAriaLabel(),open:t.open,innerStyle:{height:"80vh",width:"80vw",overflow:"hidden",display:"flex"},onDismiss:fl.U4,render:this.renderSnapshotsListRequest,className:u.Nn$})}renderMobileSnapshotPreview(e){return(0,y.jsx)(c.ZP,{popupType:c.ZP.PopupType.SlideUp,open:Boolean(e.snapshot),forceFullScreenSlideUp:!0,render:()=>{if(!e.snapshot)return;const t=this.getSnapshotUpsell({snapshot:e.snapshot,nextFutureSnapshot:e.nextFutureSnapshot}),s=!t,i=s?(0,y.jsx)(Ll,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp}):this.renderUnavailableMessage(t.message,t.tier);return(0,y.jsx)(d.Z,{menuType:m.og.Modal,title:(0,xa.$b)(parseInt(e.snapshot.timestamp),$r.SP,E.default.getIntl()),right:(0,y.jsx)(Pe.DoneMenuText,{}),onClickRight:fl.zb,leftDisabled:!s,left:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.mobileSnapshotMenu.restoreButton.label"}),onClickLeft:()=>fl.xx(this.environment),whiteBackground:s,forceFullScreenSlideUp:!0,children:i})}})}hasPermissionToRestore(e){return(0,lt.k5)({environment:this.environment,blocks:[e.blockStore],originRect:void 0,publicEditMode:void 0})}renderDesktopSidebar(e){const{menuState:t}=e,s=Boolean(t.snapshot&&!this.getSnapshotUpsell({snapshot:t.snapshot,nextFutureSnapshot:t.nextFutureSnapshot})&&this.hasPermissionToRestore(t));return(0,y.jsxs)("div",{style:this.getSidebarStyle(),children:[(0,y.jsx)(Cl.Z,{type:_e.Z.Y,style:{flex:1},children:this.renderSnapshotsMenuList(e)}),(0,y.jsxs)("div",{style:{display:"flex",padding:14,borderTop:`\n\t\t\t\t\t\t\t1px solid ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`},children:[(0,y.jsx)($.Z,{disableTooltip:s,renderTooltip:()=>(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Upgrade to restore snapshots.",id:"historyModal.desktopModal.sidebar.upgradeMessage.tooltip"}),render:e=>(0,y.jsx)(xn.Z,{isLarge:!0,onClick:()=>fl.xx(this.environment),disabled:!s,...e,children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Restore version",id:"historyModal.desktopModal.restoreButton.label"})})}),(0,y.jsx)(wn.Z,{isLarge:!0,style:{marginLeft:12},onClick:fl.U4,children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Cancel",id:"historyModal.desktopModal.cancelButton.label"})})]}),(0,y.jsx)(L.Z,{topBorder:!0,disableDesktopPadding:!0,children:(0,y.jsx)(Ot.Z,{title:(0,y.jsx)(r.FormattedMessage,{id:"historyModal.desktopModal.learnMoreButton.label",defaultMessage:"Learn about page history"}),href:(0,qe.UY)("guides.pageHistory"),analyticsFrom:"page_history"})})]})}renderDesktopSnapshotPreview(e){if(e.snapshot)return(0,y.jsxs)(i.Fragment,{children:[(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center",flexShrink:0,height:45,fontSize:14,paddingLeft:14},children:[e.blockStore.hasIcon()&&(0,y.jsx)(Fo.Z,{disabled:!0,icon:e.blockStore.getIcon(),isEmptyPage:e.blockStore.isEmptyPage(),size:this.iconSize(),style:{marginRight:6}}),(0,y.jsx)(jl.Z,{store:e.blockStore})]}),(0,y.jsx)(Ll,{blockStore:e.blockStore,timestamp:e.snapshot.timestamp})]})}deviceSupportsUpgrade(e){const{device:t}=this.environment;return!t.isMobile||"personal"===e&&(0,xl.S$)({environment:this.environment})}renderUnavailableMessage(e,t){const{device:s}=this.environment,i=zn.default.state.data;let n=this.deviceSupportsUpgrade(t);const a=i&&Kn.GJ(i);return n&&(0,xl.S$)({environment:this.environment})&&"personal"===t&&!a&&(n=!1),(0,y.jsxs)("div",{style:this.getUnavailableMessageStyle(),children:[this.deviceSupportsUpgrade(t)&&this.renderVersionHistoryIcon(),(0,y.jsx)("div",{style:{...!s.isMobile&&{maxWidth:340}},children:e}),n&&t&&(0,y.jsx)(xn.Z,{isLarge:!0,onClick:()=>this.handleUpgrade(t),style:{marginTop:16},children:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Upgrade",id:"historyModal.upgradeForHistoryButton.label"})})]})}renderVersionHistoryIcon(){return(0,pl.w)({width:64,height:"auto",fill:this.theme.lightIconColor,marginBottom:12})}renderMobileHelpButton(){return(0,y.jsx)(kl.Z,{href:(0,qe.UY)("guides.pageHistory"),analyticsFrom:"page_history"})}getSnapshotUpsell(e){var t;if(ys.default.isAdminMode)return;const{nextFutureSnapshot:s}=e;if(!s)return;const i=this.snapshotDaysOld(s);if((0,bl.Aw)()&&i<=gl.hy.plus.days)return;const n=this.getTiersSupportingSnapshotAge(i);if((0,bl.p4)(n))return;const a=n[0]??"enterprise";return(0,hl.QM)(a)?void 0:{tier:a,message:(0,y.jsx)(r.FormattedMessage,{defaultMessage:"Please upgrade to the {upsellTier} Plan to access versions older than {snapshotLimitDays} days.",id:"historyModal.upsell.message",values:{upsellTier:(0,ml.Z)((0,hl.eR)(a)?"plus":a),snapshotLimitDays:(null===(t=this.getPlanBelow(a))||void 0===t?void 0:t.days)??Math.floor(i)}})}}getTiersSupportingSnapshotAge(e){return this.getAvailablePlansWithHistories().filter((t=>t.days>e)).map((e=>e.tier))}getPlanBelow(e){const t=this.getAvailablePlansWithHistories(),s=t.findIndex((t=>t.tier===e));if(!(s<=0))return t[s-1]}getAvailablePlansWithHistories(){return gl.sb.filter((e=>"personal"!==e.tier))}snapshotDaysOld(e){return(Date.now()-parseInt(e.timestamp))/hs.A0}getSidebarStyle(){return{display:"flex",flexDirection:"column",flexShrink:0,width:Nl.sidebarWidth}}getUnavailableMessageStyle(){const{device:e}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:28,padding:16,textAlign:"center",fontSize:14,...e.isMobile?{position:"relative",zIndex:1,background:this.theme.popoverBackground,boxShadow:`\n\t\t\t\t\t\t\t0 -1px 0 ${this.theme.regularDividerColor},\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`}:{height:"100%"}}}}Nl.displayName="HistoryModal",Nl.sidebarWidth=240,Nl.noSnapshotsMessage=(0,y.jsx)(r.FormattedMessage,{defaultMessage:"This page does not have any snapshots yet. Allow up to 10 minutes for the first snapshot to be generated.",id:"historyModal.noSnapshotsYet.message"}),Nl.wrapStyle={display:"flex",justifyContent:"center",padding:32};const El=(0,r.injectIntl)(Nl);var Ol=s(94507),Vl=s(61464);function Ul(){window.__c={n:"UserJoinedTeamsListener"};const e=(0,n.O7)(),{currentSpaceStore:t}=(0,a.Kw)(ie.default),s=e.currentUser.id,o=(0,a.VK)((()=>null==t?void 0:t.id),[t]);return(0,i.useEffect)((()=>{if(!o||!s)return;const t=lo.Z.addListener((0,ao.pD)({userId:s,spaceId:o}),(async(t,i)=>{(function(e){var t;let{spaceId:s,userId:i,emitValue:n}=e;const a=null===(t=Vl.Z.getUserJoinedTeamsState({userId:i,spaceId:s}))||void 0===t?void 0:t.lastEmitValue;if(a===n)return!1;if(void 0===a&&Vl.Z.getHasFetched({userId:i,spaceId:s}))return!1;return!0})({spaceId:o,userId:s,emitValue:i})&&await Ol.m({environment:e,spaceId:o,userId:s,emitValue:i});const n=Vl.Z.getUserJoinedTeamsState({userId:s,spaceId:o});n&&Vl.Z.setUserJoinedTeamsState({userId:s,spaceId:o,state:{...n,lastEmitValue:i}})}),void 0,e);return function(){t&&lo.Z.removeListener(t,e)}}),[e,s,o]),null}var Wl=s(30397);const zl=function(){window.__c={n:"TeamsInSpaceListener"};const e=(0,n.O7)(),{currentSpaceStore:t,currentUserStore:s}=(0,a.Kw)(ie.default),[,o,r]=(0,a.AF)(Wl.Z),l=null==s?void 0:s.id;return(0,i.useEffect)((()=>{if(!t||!l)return;const s=lo.Z.addListener((0,ao.je)(t.id),(async(s,i)=>{if(!r.shouldRefetchTeamsInSpace({currentUserId:l,currentSpaceId:t.id,emitValue:i}))return;const n=await(0,he.qX)({environment:e,spaceStore:t,includeArchived:!1,currentUserId:l});o({teams:n,lastEmitData:{spaceId:t.id,userId:l,value:i}})}),void 0,e);return function(){s&&lo.Z.removeListener(s,e)}}),[t,l,e,o,r]),null};var Kl=s(13148),Hl=s(42631),Gl=s(4926),ql=s(1634);class Yl extends o.Z{constructor(){super(...arguments),this.handleConnectClick=async()=>{const e=ql.Z.state,{currentSpaceStore:t}=ie.default.state;e.open&&t&&(await Hl.hM({environment:this.environment,integration:e.integration,spaceId:t.id,unfurlUrl:e.unfurlUrl,externalObjectInstanceBlockId:e.externalObjectInstanceBlockId,from:"external_object_instance_inline_popup"}),this.markPopupAsDismissed(e.integration.id),ql.Z.reset())},this.handleCloseClick=()=>{const e=ql.Z.state;e.open&&this.markPopupAsDismissed(e.integration.id),ql.Z.reset()},this.markPopupAsDismissed=e=>{const{currentUserSettingsStore:t}=ie.default.state;t&&j.createAndCommit({userAction:"UnfurlingInformationPopup.markPopupAsDismissed",environment:this.environment,perform:s=>{te.GK({transaction:s,userSettingsStore:t,integrationId:e})}})}}renderComponent(){const e=ql.Z.state;if(!e.open)return;const t=e.integration.info.icon;return t?(0,y.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"default",padding:16,background:this.theme.popoverBackground,borderRadius:3,boxShadow:this.theme.lightBoxShadow,position:"absolute",bottom:65+Gl.Z.state,right:16+Gl.Z.state,width:240,zIndex:Fs.hT,clipPath:"inset(-10px -10px -10px -10px)"},children:[(0,y.jsx)(bn.Z,{type:"image_url",imageURL:t,size:38,style:{marginBottom:6}}),(0,y.jsx)("div",{style:{color:this.theme.regularTextColor,fontSize:14,fontWeight:Wa.Z.fontWeight.semibold,marginBottom:6,textAlign:"center"},children:(0,y.jsx)(r.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.title",defaultMessage:"Connect to {integration}",values:{integration:e.integration.name}})}),(0,y.jsxs)("div",{style:{color:this.theme.mediumTextColor,fontSize:12,marginBottom:8,textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,y.jsx)(r.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.caption",defaultMessage:"You, and anyone else who has access to this Notion page, will see rich previews that update live."}),(0,y.jsx)(ta.Z,{href:(0,qe.UY)("guides.unfurling"),external:!0,children:(0,y.jsx)(r.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.learnMore.text",defaultMessage:"Learn more"})})]}),(0,y.jsx)(xn.Z,{onClick:this.handleConnectClick,style:{width:"100%"},children:(0,y.jsx)(r.FormattedMessage,{id:"inlineUnfurlingAuthenticationPopup.connectButton",defaultMessage:"Connect"})}),(0,y.jsx)(In.Z,{icon:Kl.U,onClick:this.handleCloseClick,style:{position:"absolute",top:6,right:6}})]}):void 0}}Yl.displayName="UnfurlingInformationPopup";const Ql=(0,r.injectIntl)(Yl);var $l=s(61202),Xl=s(80064);class Jl extends o.Z{constructor(){super(...arguments),this.menuRef=(0,i.createRef)(),this.renderMenu=()=>{const{device:e}=this.environment,t=Xl.Z.state;if(!t.open)return;const{allOptionTypes:s}=t,i={key:"embed section",render:e=>(0,y.jsx)(L.Z,{...e}),items:s.map((e=>({key:e,render:t=>(0,y.jsx)(Gt.Z,{...t,title:this.renderTitleForOptionType(e),onMouseEnter:s=>{t.onMouseEnter(s),this.updateUnfurlingOptionType(e)}}),action:()=>this.handleDismiss(e)})))};let n;return n=e.isMobile?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:320,maxHeight:"40vh"},(0,y.jsx)(d.Z,{...n,className:u.b_f,ref:this.menuRef,children:(0,y.jsx)(B.Z,{type:B.i.Vertical,sections:[i],initialFocus:0,onKeyboardArrow:this.handleMenuListKeyboardArrow,priority:1,disallowBackspace:!0})})},this.handleDefaultDismiss=()=>{this.handleDismiss(void 0)},this.handleDismiss=e=>{j.createAndCommit({userAction:"UnfurlingMenu.handleDismiss",environment:this.environment,perform:t=>{$l.xv({environment:this.environment,setType:e,transaction:t})}})},this.updateUnfurlingOptionType=e=>{j.createAndCommit({userAction:"UnfurlingMenu.handleMenuListKeyboardArrow",environment:this.environment,perform:t=>{$l.hJ({environment:this.environment,type:e,useTemporaryRecordCache:!0,transaction:t,intl:this.props.intl})}})},this.handleMenuListKeyboardArrow=e=>{const t=Xl.Z.state;if(!t.open||void 0===e.indexGlobal)return;const s=t.allOptionTypes[e.indexGlobal];s&&this.updateUnfurlingOptionType(s)},this.handleWindowKeydown=e=>{Xl.Z.state.open&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"Enter"!==e.key&&this.handleDismiss(void 0)},this.handleWindowMousedown=e=>{const t=Xl.Z.state,s=this.menuRef.current;if(!t.open||!e.target||!s)return;const i=di.findDOMNode(s);i&&(i.contains(e.target)||this.handleDismiss(void 0))}}willMount(){(0,ui.lj)(window,"keydown",this.handleWindowKeydown),(0,ui.lj)(window,"mousedown",this.handleWindowMousedown)}willUnmount(){(0,ui.ZV)(window,"keydown",this.handleWindowKeydown),(0,ui.ZV)(window,"mousedown",this.handleWindowMousedown)}renderComponent(){const{device:e}=this.environment,t=Xl.Z.state;return(0,y.jsx)(c.ZP,{popupType:e.isMobileNative&&!e.isTablet?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,open:Boolean(t.open&&t.renderRect),originRect:t.open?t.renderRect:void 0,placementToOrigin:c.ZP.Placement.Top,alignmentToOrigin:c.ZP.Alignment.Start,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,disableDarkOverlayBackground:e.isMobile,keepFocus:e.isMobile,render:this.renderMenu,onDismiss:this.handleDefaultDismiss})}renderTitleForOptionType(e){return"preview"===e?(0,y.jsx)(r.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsPreview.title",defaultMessage:"Paste as preview"}):"mention"===e?(0,y.jsx)(r.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsMention.title",defaultMessage:"Paste as mention"}):"link"===e?(0,y.jsx)(r.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsLink.title",defaultMessage:"Paste as link"}):"collection"===e?(0,y.jsx)(r.FormattedMessage,{id:"unfurlingMenu.actions.pasteAsDatabase.title",defaultMessage:"Paste as database"}):void(0,Ne.t1)(e)}}Jl.displayName="UnfurlingMenu";const ed=(0,r.injectIntl)(Jl);const td=function(){window.__c={n:"AppComponents"};const e=(0,n.Fy)(),t=(0,n.O7)(),{isMobile:s,isElectron:o}=e;(0,i.useEffect)((()=>{if(s){function e(e){e.preventDefault()}return document.addEventListener("gesturestart",e),()=>{document.removeEventListener("gesturestart",e)}}}),[s]);const{currentSpaceStore:r,teamsEnabled:l}=(0,a.VK)((()=>({currentSpaceStore:ie.default.state.currentSpaceStore,teamsEnabled:(0,he.bq)()})),[]),d=t.currentUser.isLoggedIn();return(0,y.jsxs)(i.Fragment,{children:[(0,y.jsx)(li,{}),(0,y.jsx)(Re,{}),(0,y.jsx)(p.LazyNewDiscussionMenu,{}),(0,y.jsx)(x,{}),(0,y.jsx)(ye,{}),(0,y.jsx)(as.Z,{}),(0,y.jsx)(Se.Z,{priority:-1,capture:!0}),(0,y.jsx)(zr,{}),d&&!s&&(0,y.jsx)(Qr,{}),d&&r&&(0,y.jsx)(po,{rootStore:r}),d&&(0,y.jsx)(zl,{}),d&&l&&(0,y.jsx)(Ul,{}),(0,y.jsx)(ns.Z,{}),(0,y.jsx)(io,{}),(0,y.jsx)(Wt,{}),(0,y.jsx)(Ro,{}),(0,y.jsx)(Io,{}),(0,y.jsx)(Gs,{}),(0,y.jsx)(ts,{}),!s&&(0,y.jsx)(pr,{}),(0,y.jsx)(ni,{}),(0,y.jsx)(vo,{}),(0,y.jsx)(ha,{}),(0,y.jsx)(ss.Z,{store:ve.Z}),(0,y.jsx)(ss.Z,{store:xe.Z}),(0,y.jsx)(eo,{}),(0,y.jsx)(al,{}),(0,y.jsx)(ge,{}),(0,y.jsx)(js,{}),(0,y.jsx)(ed,{}),(0,y.jsx)(fi,{}),(0,y.jsx)(Ql,{}),(0,y.jsx)(Qt,{}),(0,y.jsx)(ul,{}),(0,y.jsx)(Gi,{}),o&&(0,y.jsx)(p.LazyElectronContextMenu,{}),(0,y.jsx)(us,{}),(0,y.jsx)(is.Z,{}),(0,y.jsx)(Mo,{}),d&&(0,y.jsx)(El,{}),(0,y.jsx)(qs.s6,{})]})}},13713:(e,t,s)=>{s.d(t,{B:()=>x,Z:()=>S});s(67294);var i=s(13991),n=s(480),a=s(86628),o=s(24405),r=s(66897),l=s(7057),d=s(5366),c=s(83420),u=s(33929),m=s(4023),p=s(24039),g=s(28992),h=s(72495),f=s(26388),y=s(64369),v=s(85893);function x(e){const t=e.getCreatedByPointer(),s=e.getCreatedTime(),n=e.getLastEditedByPointer(),a=e.getLastEditedTime(),o=u.default.getIntl();if(t&&s&&a&&n){const r=(0,c.ue)({parentStore:e,pointer:t}),d=(0,l.$b)(s,i.SP,o),u=(0,c.ue)({parentStore:e,pointer:n}),m=(0,l.$b)(a,i.SP,o);if(!u)return;return{createdBy:r,createdTime:d,lastEditedBy:u,lastEditedTime:m}}}const S=function(e){let{isPageMoreButton:t,hideTopBorder:s,store:i}=e;window.__c={n:"BlockAuthorInfo"};const l=(0,a.VK)((()=>x(i)),[i]),{device:c}=(0,n.O7)(),S=(0,a.VK)((()=>c.isPhone),[c]),b=u.default.getIntl(),M=(0,o.yK)((()=>({menuItem:{paddingTop:S?8:s?0:6,paddingBottom:S?8:16}})),[s,S]);return(0,v.jsx)(h.Z,{topBorder:!t&&!s,style:{paddingTop:t?0:8,paddingBottom:8},children:(0,v.jsx)(g.Z,{style:l?void 0:M.menuItem,shouldWrapTitle:!0,title:l?(0,v.jsx)(f.Z,{placement:m.u.Right,render:e=>(0,v.jsxs)("div",{...e,children:[(0,v.jsx)(y.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isPhone,isMultiline:!0,style:{marginBottom:4},children:(0,v.jsx)(d.FormattedMessage,{id:"blockAuthorInfo.label",defaultMessage:"Last edited by {author}",values:{author:l.lastEditedBy.asActor?(0,r.$4)(b,l.lastEditedBy):void 0}})}),(0,v.jsx)(y.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:c.isPhone,children:l.lastEditedTime})]}),renderTooltip:()=>(0,v.jsx)(p.Z,{store:i,compactFormat:!0})}):void 0,loading:!l})})}},98692:(e,t,s)=>{s.d(t,{Z:()=>y});var i=s(67294),n=s(83355),a=s(8848),o=s(5366),r=s(91376),l=s(1865),d=s(78291),c=s(70060),u=s(13627),m=s(64921),p=s(61519),g=s(76844),h=s(85893);class f extends n.Z{constructor(){super(...arguments),this.handleClick=e=>{if(!e)return r.r$();l.y(this.environment,{from:"sidebar"===this.props.source?"block_limit_sidebar":"block_limit_settings",for:"plus"})}}renderComponent(){const{data:e}=d.default.state;if(!e)return;const t=u.GJ(e);if(0===u.Lz(this.environment,e))return;const s=u.zl(this.environment,e);return u.XZ(this.environment,e)?(0,h.jsxs)(i.Fragment,{children:[this.renderDivider("settings"===this.props.source),(0,h.jsxs)(m.Z,{style:f.buttonStyle,onClick:()=>this.handleClick(t),children:[(0,h.jsx)("div",{style:f.headerStyle,children:(0,h.jsx)(o.FormattedMessage,{id:"spaceSettings.sidebar.upgradeLink",defaultMessage:"Upgrade to go unlimited"})}),(0,h.jsxs)("div",{style:f.labelStyle,children:[(0,h.jsx)("div",{style:this.usageLabelStyle(s),children:u.cA(this.environment,e)}),!(0,c.du)()&&(0,h.jsx)(g.Z,{style:{marginTop:12,marginBottom:12},percent:s}),(0,h.jsx)("div",{style:f.ctaStyle,children:this.renderCtaMessage(t)})]})]})]}):void 0}renderDivider(e){return e?(0,h.jsx)(p.Z,{size:27,style:{paddingLeft:14,paddingRight:14}}):(0,h.jsx)(p.Z,{size:0})}renderCtaMessage(e){return e?(0,h.jsx)(o.FormattedMessage,{id:"spaceSettings.sidebar.button.upgrade",defaultMessage:"Upgrade plan"}):(0,h.jsx)(o.FormattedMessage,{id:"spaceSettings.sidebar.button.contactWorkspaceOwner",defaultMessage:"Contact a workspace owner"})}usageLabelStyle(e){return e>u.Tj&&!(0,c.du)()?(0,a.x7)("red",this.theme):{}}}f.displayName="BlockLimitUsage",f.buttonStyle={padding:14,fontSize:12,lineHeight:1.4},f.headerStyle={fontWeight:500,lineHeight:2},f.labelStyle={fontWeight:400},f.ctaStyle={textDecoration:"underline"};const y=f},80209:(e,t,s)=>{s.d(t,{Z:()=>f});s(67294);var i=s(83355),n=s(26825),a=s(82990),o=s(5366),r=s(47307),l=s(76464),d=s(18878),c=s(19037),u=s(98165),m=s(64921),p=s(64369),g=s(85893);class h extends i.Z{constructor(){super(...arguments),this.handleRestorePermissionAction=async()=>{const{store:e}=this.props,t=e.getPermissionItems(),s=u.Om(e),i=s?n.Wo(u.fJ(s)):[],a={type:"restore",permissionChanges:n.Xr(t,i)};await r.confirmUserAction({message:(0,d.mX)(a),acceptLabel:(0,d.nH)(a),cancelLabel:(0,g.jsx)(o.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,g.jsx)(d.mo,{openState:a})})&&l.hs({environment:this.environment,store:e})}}renderComponent(){const{store:e}=this.props,t={environment:this.environment,blocks:[e],publicEditMode:void 0};if(c.xD([c.X,c.ff(c.J5)])(t)){const{device:e}=this.environment,s=c.xD([c.c2,c.ff(c.zz)])(t);return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{style:{backgroundColor:this.theme.sidebarSecondaryBackground,boxShadow:`0 -1px 0 ${this.theme.regularDividerColor}`,marginTop:e.isMobile?28:1},children:(0,g.jsxs)(m.Z,{disabled:!s,style:{padding:12},onClick:this.handleRestorePermissionAction,children:[(0,g.jsx)(p.Z,{isMultiline:!0,isSmall:!0,children:(0,g.jsx)(o.FormattedMessage,{id:"blockMenuRestrictedMessage.label",defaultMessage:"You don’t have permission to edit this block because it is restricted."})}),s&&(0,g.jsx)(p.Z,{style:{marginTop:6,fontWeight:a.Z.fontWeight.semibold},children:(0,g.jsx)(o.FormattedMessage,{id:"blockMenuRestrictedMessage.adminRestoreAction.label",defaultMessage:"Restore permissions"})})]})})})}}}h.displayName="BlockMenuRestrictedMessage";const f=h},81933:(e,t,s)=>{s.r(t),s.d(t,{default:()=>R});s(67294);var i=s(83355),n=s(41892),a=s(8848),o=s(64275),r=s(45137),l=s(30845),d=s(72126),c=s(82990),u=s(5366),m=s(50906),p=s(33929),g=s(49085);class h extends g.default{getInitialState(){return{step:"initial"}}}const f=h;var y=s(73796),v=s(37240),x=s(52275),S=s(63296),b=s(45959),M=s(85893);class w extends i.Z{renderComponent(){const{intl:e,question:t}=this.props,s={setup_trial:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.setup_trial",defaultMessage:"Setup an enterprise trial"}),setup_enterprise_trial:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.setup_trial",defaultMessage:"Setup an enterprise trial"}),setup_business_trial:(0,M.jsx)(u.FormattedMessage,{id:"contactModalQuestionSelect.question.setup_business_trial",defaultMessage:"Setup a business trial"}),live_demo:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.live_demo",defaultMessage:"Schedule a live demo"}),plan_help:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.plan_help",defaultMessage:"Need help choosing a plan"}),other:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModalQuestionSelect.question.other",defaultMessage:"Other"})},i={menuTitle:e.formatMessage({defaultMessage:"Your question",id:"enterpriseContactModal.yourQuestion.title"}),items:["setup_enterprise_trial","setup_business_trial","live_demo","plan_help","other"],width:"auto",minWidth:280,getKey:e=>e,selectedItem:t,originGap:4,onSelect:e=>{this.props.onSelect(e)},renderItem:e=>(0,M.jsx)(x.Z,{title:s[e.key],...e}),renderOrigin:e=>(0,M.jsxs)(S.Z,{...e,isLarge:!0,style:{...this.getInputStyle(),...this.props.invalid&&{border:`1px solid ${a.ZP.red}`}},children:[(0,M.jsx)("div",{style:{display:"flex",alignItems:"center",color:t?this.theme.regularTextColor:this.theme.lightTextColor},children:t?s[t]:(0,M.jsx)(u.FormattedMessage,{defaultMessage:"Select question",id:"enterpriseContactModal.selectQuestion.label"})}),(0,v.s)({width:10,fill:this.theme.lightIconColor})]})};return(0,M.jsx)(b.Z,{...i},"onboarding")}getInputStyle(){const{device:e}=this.environment;return{backgroundColor:this.theme.whiteButtonBackground,height:31,...e.isMobile&&{height:42},padding:"2px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:3,border:0,transition:"box-shadow 0.3s ease",boxShadow:`0 0 0 1px ${this.theme.outlineButtonBorder}`,background:this.theme.buttonBackground}}}w.displayName="ContactModalQuestionSelect";const j=(0,u.injectIntl)(w);var C=s(23063),k=s(42922),_=s(64921),T=s(74194),I=s(3386),P=s(50506),Z=s(89728),F=s(26388),A=s(29551);const D=(0,u.defineMessages)({additionalFeedbackPlaceholder:{id:"enterpriseContactModal.additionalFeedback.placeholder",defaultMessage:"What would you like to learn more about?"}});class B extends i.Z{constructor(){super(...arguments),this.storeTypes={store:f},this.renderMenu=()=>(0,M.jsxs)("div",{style:this.getContainerStyle(),children:[this.renderCancel(),(0,M.jsx)(A.gq,{style:this.getInnerContainerStyle(),alignItems:"center",alignContent:"center",children:this.renderStep()})]}),this.renderInitial=()=>{const{invalidField:e}=this.stores.store.state;if(y.Z.state.open)return(0,M.jsxs)("div",{style:{...this.getSlideUpStyle(),padding:20},children:[(0,r.o)({width:"100%",height:24}),(0,M.jsx)("div",{style:{fontSize:14,fontWeight:c.Z.fontWeight.semibold,paddingTop:6,paddingBottom:4},children:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.header",defaultMessage:"Get in touch with sales"})}),(0,M.jsx)("div",{style:{fontSize:12,color:this.theme.mediumTextColor,width:200,margin:"0 auto"},children:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.caption",defaultMessage:"We'll work with you on your setup and help you land on the best plan."})}),(0,M.jsx)("div",{style:{...this.getLabelStyle(),marginTop:24},children:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.nameLabel",defaultMessage:"Your name"})}),(0,M.jsx)(T.Z,{focusInitial:!0,value:this.getName(),placeholder:"Ada Lovelace",style:{marginRight:4,...this.getInputStyle(),..."name"===e&&this.getInvalidInputStyle()},onChange:e=>{y.Z.setState({...y.Z.state,open:!0,name:void 0}),this.stores.store.setState({...this.stores.store.state,name:e.target.value}),m.QOK(this.environment,{contactFieldType:"name",contactFieldValue:e.target.value})}}),(0,M.jsx)("div",{style:this.getLabelStyle(),children:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.emailLabel",defaultMessage:"Your work email"})}),(0,M.jsx)(T.Z,{value:this.getEmail(),placeholder:"ada@lovelace.app",type:"email",style:{marginRight:4,...this.getInputStyle(),..."email"===e&&this.getInvalidInputStyle()},onChange:e=>{y.Z.setState({...y.Z.state,open:!0,email:void 0}),this.stores.store.setState({...this.stores.store.state,email:e.target.value}),m.QOK(this.environment,{contactFieldType:"email",contactFieldValue:e.target.value})}}),(0,M.jsx)("div",{style:this.getLabelStyle(),children:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.companySizeLabel",defaultMessage:"Company size"})}),(0,M.jsx)(A.gq,{children:this.getCompanySizeButtonData().map((e=>{let{type:t,message:s,style:i}=e;return(0,M.jsx)(Z.Z,{isLightGray:!0,isLarge:!0,style:{...this.getBaseButtonStyle(),...this.stores.store.state.companySize===t&&this.getSelectedButtonStyle(),...i},onClick:()=>{this.stores.store.setState({...this.stores.store.state,companySize:t}),m.QOK(this.environment,{contactFieldType:"companySize",contactFieldValue:t})},children:s},t)}))}),(0,M.jsx)("div",{style:this.getLabelStyle(),children:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.questionLabel",defaultMessage:"Your question"})}),(0,M.jsx)(j,{question:this.getQuestion(),invalid:"question"===e,onSelect:e=>{this.stores.store.setState({...this.stores.store.state,question:e,step:"other"===e?"additional_input":"initial"}),m.QOK(this.environment,{contactFieldType:"question",contactFieldValue:"other"===e?"additional_input":"initial"})}}),(0,M.jsx)(T.Z,{textarea:!0,textareaElementAttributes:{style:this.getInnerTextAreaStyle()},style:this.getTextAreaStyle(),focus:"additional_input"===this.stores.store.state.step,value:this.stores.store.state.additionalFeedback,placeholder:p.default.formatMessage(D.additionalFeedbackPlaceholder),onChange:e=>{this.stores.store.setState({...this.stores.store.state,additionalFeedback:e.target.value}),m.QOK(this.environment,{contactFieldType:"additionalFeedback",contactFieldValue:e.target.value})}})]})},this.renderCancel=()=>(0,M.jsx)(_.Z,{onClick:()=>{m.g3X(this.environment),this.handleCancel()},style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground},children:(0,o.D)({width:14,fill:this.theme.mediumTextColor})}),this.renderThanks=()=>(0,M.jsxs)("div",{children:[(0,M.jsx)("img",{style:{width:165,height:80},src:n.Z.images.feedbackThankYouPng}),(0,M.jsx)("div",{style:this.getThanksHeaderStyle(),children:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.thanks.caption",defaultMessage:"We've received your inquiry and will be contacting you via email shortly."})})]}),this.handleCancel=()=>{y.Z.setState({open:!1})}}renderComponent(){return(0,M.jsx)(P.Z,{preventHideChildrenWhileOpening:!0,open:y.Z.state.open,render:this.renderMenu,onDismiss:this.handleCancel})}renderStep(){const{step:e,companySize:t}=this.stores.store.state,s="1_100"===t;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(C.Z,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,M.jsx)(I.Z,{capture:!0,onBackspace:d.yR,onLeft:d.yR,onRight:d.yR,onSelectAll:d.yR,onRedo:d.yR,onUndo:d.yR,onCut:d.yR,onCopy:d.yR,onPaste:d.yR,onKeypress:d.yR,onDelete:d.yR,onTab:d.yR,children:this.renderInitial()})}),(0,M.jsx)(C.Z,{isVisible:"thanks"===e,animationStyle:this.getAnimationStyle("thanks"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks}),(0,M.jsx)(C.Z,{isVisible:"initial"===e||"additional_input"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,M.jsx)(F.Z,{style:{width:"auto"},textWrap:!0,renderTooltip:()=>s?(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.companySize.error.label",defaultMessage:"The company size selected is not eligible for a sales assisted plan. Please message support if you have any questions."}):null,render:e=>(0,M.jsx)(k.Z,{...e,disabled:s,isLarge:!0,style:{marginTop:17,width:284,position:"absolute",bottom:20},onClick:()=>{const e=this.getInvalidField();if(e){const{question:t}=this.stores.store.state;this.stores.store.setState({...this.stores.store.state,step:"initial",invalidField:e,question:"other"===t?this.getQuestion():t})}else this.stores.store.setState({...this.stores.store.state,invalidField:void 0,step:"thanks"}),y.Z.state.open&&m.Ls9(this.environment,{email:y.Z.state.email,name:y.Z.state.name,question:y.Z.state.question,...this.stores.store.state}),d.gw((()=>{y.Z.reset(),d.gw((()=>{this.stores.store.reset()}),1e3)}),2e3)},children:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.sendLabel",defaultMessage:"Send"})})})})]})}getName(){if(y.Z.state.open)return this.stores.store.state.name||y.Z.state.name}getEmail(){if(y.Z.state.open)return this.stores.store.state.email||y.Z.state.email}getQuestion(){if(y.Z.state.open)return this.stores.store.state.question||y.Z.state.question}getInvalidField(){const e=this.getEmail(),t=this.getName(),{companySize:s}=this.stores.store.state;return t?e&&l.B(e,"email")?s?this.getQuestion()?void 0:"question":"company_size":"email":"name"}getCompanySizeButtonData(){return[{type:"1_100",message:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.1_100Label",defaultMessage:"1-100"})},{type:"101_1000",message:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.101_1000Label",defaultMessage:"101-1,000"}),style:{marginLeft:8,marginRight:8}},{type:"1001+",message:(0,M.jsx)(u.FormattedMessage,{id:"enterpriseContactModal.initial.1000PlusLabel",defaultMessage:"1,001+"})}]}getThanksHeaderStyle(){return{color:this.theme.regularTextColor,fontWeight:c.Z.fontWeight.semibold,fontSize:14}}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}getInnerContainerStyle(){return{width:320,height:470,overflow:"hidden",position:"relative",padding:20,cursor:"default",textAlign:"center",justifyContent:"center"}}getLabelStyle(){return{marginTop:17,fontSize:12,color:this.theme.mediumTextColor,fontWeight:c.Z.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}getInputStyle(){return{backgroundColor:this.theme.whiteButtonBackground,height:31}}getInvalidInputStyle(){return{border:`1px solid ${a.ZP.red}`}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getBaseButtonStyle(){return{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center"}}getSelectedButtonStyle(){return{color:a.ZP.blue,border:`1px solid ${a.ZP.blue}`}}getSlideUpStyle(){const{step:e}=this.stores.store.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===e?"translateY(153px)":"translateY(-180px)"}}getInnerTextAreaStyle(){return{width:"100%",height:"100%",background:"none",border:"none",resize:"none"}}getTextAreaStyle(){return{width:"100%",background:this.theme.popoverBackground,display:"block",padding:"7px 10px",height:310,marginTop:17,marginBottom:17,transition:"opacity 200ms ease-in",opacity:"additional_input"===this.stores.store.state.step?1:.001}}}B.displayName="ContactModal";const R=B},85324:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var i=s(67294),n=s(480),a=s(24405),o=s(41892),r=s(86658),l=s(82990),d=s(63143),c=s(5366),u=s(50950),m=s(36867),p=s(45293),g=s(10182),h=s(42922),f=s(89728),y=s(92660),v=s(29551),x=s(85893);function S(){window.__c={n:"SaveAllButton"};const e=(0,a.yK)(w,[]),t=(0,n.O7)();return(0,x.jsx)(h.Z,{isLarge:!0,style:e.acceptAllButton,onClick:()=>{u.a9(t,{necessary:!0,preference:!0,performance:!0,targeting:!0}),p.Z.setState({open:!1}),u.qo()},children:(0,x.jsx)(c.FormattedMessage,{...r.ze.acceptAllButtonLabel})})}function b(){window.__c={n:"RejectAllButton"};const e=(0,a.yK)(w,[]),t=(0,n.O7)();return(0,x.jsx)(f.Z,{isLarge:!0,isGray:!0,style:e.moreOptionsButton,onClick:()=>{u.a9(t,{necessary:!0,preference:!1,performance:!1,targeting:!1}),p.Z.setState({open:!1}),u.qo()},children:(0,x.jsx)(c.FormattedMessage,{...r.ze.rejectAllButtonLabel})})}function M(){window.__c={n:"MoreOptionsButton"};const e=(0,a.yK)(w,[]);return(0,x.jsx)(g.Z,{hasDismissButton:!0,onDismiss:()=>{p.Z.setState({open:!1})},renderOrigin:t=>(0,x.jsx)(f.Z,{...t,isLarge:!0,isGray:!0,style:e.moreOptionsButton,children:(0,x.jsx)(c.FormattedMessage,{...r.ze.moreOptionsButtonLabel})})})}function w(e){return{modal:{maxWidth:400,padding:24},image:{height:100},title:{marginTop:8,color:e.regularTextColor,fontWeight:l.Z.fontWeight.semibold,fontSize:18},description:{color:e.mediumTextColor,textAlign:"center",fontSize:14,marginTop:8,marginBottom:18},acceptAllButton:{width:"100%",marginBottom:6},moreOptionsButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}}}const j=(0,c.injectIntl)((function(){window.__c={n:"CookieModal"};const e=(0,n.O7)().currentUser.id;(0,i.useEffect)((()=>{if(!e)return;(0,m._)(e);const t=window.setInterval((()=>{(0,m._)(e)}),d.A0);return()=>{window.clearInterval(t)}}),[e]);const t=(0,a.yK)(w,[]);return(0,x.jsx)(y.Z,{onDismiss:()=>{},render:()=>(0,x.jsx)("div",{style:t.modal,children:(0,x.jsxs)(v.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,x.jsx)("img",{style:t.image,src:o.Z.images.feedbackThankYouPng}),(0,x.jsx)("div",{style:t.title,children:(0,x.jsx)(c.FormattedMessage,{id:"cookieModal.requestConsent.title",defaultMessage:"Set your cookie preferences"})}),(0,x.jsx)("div",{style:t.description,children:(0,r.Fd)(u.Tz,"banner")}),(0,x.jsx)(S,{}),(0,x.jsx)(b,{}),(0,x.jsx)(M,{})]})}),requireOnline:!0,modalStore:p.Z})}))},57037:(e,t,s)=>{s.r(t),s.d(t,{default:()=>O});s(67294);var i=s(83355),n=s(18466),a=s(41892),o=s(64275),r=s(60651),l=s(91427),d=s(95094),c=s(72126),u=s(82990),m=s(51454),p=s(5366),g=s(54642),h=s(73409),f=s(62992);function y(e,t,s){if(s){const{templateId:i}=s;return e.some((e=>e.milestone===t&&e.template_id===i))}return e.some((e=>e.milestone===t))}var v=s(33929),x=s(38755),S=s(80444),b=s(4926),M=s(49085);const w="rate",j="send",C="thanks";class k extends M.default{getInitialState(){return{starRating:void 0,step:w}}}const _=k;var T=s(5188),I=s(35057),P=s(23063),Z=s(42922),F=s(64921),A=s(74194),D=s(3386),B=s(31278),R=s(29551),L=s(85893);const N=(0,p.defineMessages)({additionalFeedbackPlaceholder:{id:"csatPopup.additionalFeedback.placeholder",defaultMessage:"Tell us more..."}});class E extends i.Z{constructor(){super(...arguments),this.storeTypes={csatPopupStore:_},this.renderCancel=()=>(0,L.jsx)(F.Z,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground},children:(0,o.D)({width:14,fill:this.theme.mediumTextColor})}),this.renderStep=()=>{const{step:e}=this.stores.csatPopupStore.state,{currentSpaceStore:t}=S.default.state;let s;if(t){const e=t.getInitialUseCases();e&&(s=c.UP(e))}return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(P.Z,{isVisible:e===w,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0,translateY:-120},render:()=>(0,L.jsxs)("div",{style:{paddingBottom:40},children:[this.renderIcon(),this.renderFeedbackPrompt(s)]})}),(0,L.jsx)(P.Z,{isVisible:e===w||e===j,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,L.jsxs)("div",{style:this.getSlideContainerStyle(),children:[this.renderStars(s),this.renderInput(),this.renderSendButton()]})}),(0,L.jsx)(P.Z,{isVisible:e===C,animationStyle:this.getAnimationStyle(e===C),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks})]})},this.renderThanks=()=>(0,L.jsxs)("div",{children:[(0,L.jsx)("img",{style:{width:165,height:80},src:a.Z.images.feedbackThankYouPng}),(0,L.jsx)("div",{style:this.getThanksHeaderStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Thanks for your feedback!",id:"csatPopup.thanks.header"})}),(0,L.jsx)("div",{style:this.getThanksDescriptionStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Your feedback will help us make Notion better.",id:"csatPopup.thanks.description"})})]}),this.renderIcon=()=>{const{mainEditorCurrentBlockStore:e}=S.default.state;if(e){const t=e.getIcon();if(t)return(0,L.jsx)(R.gq,{justifyContent:"center",alignItems:"center",children:(0,L.jsx)(B.Z,{icon:t,isEmptyPage:!1,size:32,disabled:!0})})}return(0,L.jsx)(R.gq,{justifyContent:"center",alignItems:"center",children:(0,r.h)({width:32,height:32})})},this.renderFeedbackPrompt=e=>{switch(e){case"doc_notes":return(0,L.jsx)("div",{style:this.getFeedbackPromptStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for notes & docs?",id:"csatPopup.feedbackPrompt.docNotesLabel"})},"feedback-prompt");case"project_management":return(0,L.jsx)("div",{style:this.getFeedbackPromptStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"How satisfied are you with managing projects and tasks in Notion?",id:"csatPopup.feedbackPrompt.projManagementLabel"})},"feedback-prompt");case"wiki":return(0,L.jsx)("div",{style:this.getFeedbackPromptStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion for team wikis?",id:"csatPopup.feedbackPrompt.wikiLabel"})},"feedback-prompt");default:return this.shouldRenderAsNPS(e)?(0,L.jsx)("div",{style:this.getFeedbackPromptStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"How likely are you to recommend Notion to a friend?",id:"csatPopup.feedbackPrompt.enterpriseDefaultLabel"})},"feedback-prompt"):(0,L.jsx)("div",{style:this.getFeedbackPromptStyle(),children:(0,L.jsx)(p.FormattedMessage,{defaultMessage:"How satisfied are you with using Notion? ",id:"csatPopup.feedbackPrompt.defaultlabel"})},"feedback-prompt")}},this.renderInput=()=>{const{step:e,additionalFeedback:t}=this.stores.csatPopupStore.state;return(0,L.jsx)(D.Z,{capture:!0,onBackspace:c.yR,onLeft:c.yR,onRight:c.yR,onSelectAll:c.yR,onRedo:c.yR,onUndo:c.yR,onCut:c.yR,onCopy:c.yR,onPaste:c.yR,onKeypress:c.yR,onDelete:c.yR,onTab:c.yR,children:(0,L.jsx)(A.Z,{textarea:!0,style:this.getInputContainerStyle(),focus:e===j,value:t,placeholder:v.default.formatMessage(N.additionalFeedbackPlaceholder),onChange:e=>{this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,additionalFeedback:e.target.value})}})})},this.renderSendButton=()=>(0,L.jsx)(Z.Z,{isLarge:!0,style:this.getButtonStyle(),onClick:this.handleSend,children:(0,L.jsx)(p.FormattedMessage,{id:"csatPopup.sendButton.label",defaultMessage:"Send"})}),this.renderStars=e=>{const{starRating:t,step:s}=this.stores.csatPopupStore.state,i=e=>{let{rating:i}=e;return(0,L.jsxs)("div",{style:this.getStarStyle(),onMouseEnter:()=>{s===w&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:i})},onClick:()=>{this.stores.csatPopupStore.setState({starRating:i,step:j})},children:[(0,l.e)({width:18,fill:this.theme.mediumIconColor,position:"absolute",opacity:t&&t>=i?0:1}),(0,d.p)({width:18,fill:"#F6C050",position:"absolute",opacity:t&&t>=i?1:0})]})},n=()=>{const s=this.shouldRenderAsNPS(e);switch(t){case 1:return s?(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Very unlikely",id:"csatPopup.stars.1StarLabelNps"}):(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Very dissatisfied",id:"csatPopup.stars.1StarLabel"});case 2:return s?(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Somewhat unlikely",id:"csatPopup.stars.2StarLabelNps"}):(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Somewhat dissatisfied",id:"csatPopup.stars.2StarLabel"});case 3:return s?(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Not likely nor unlikely",id:"csatPopup.stars.3StarLabelNps"}):(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Not dissatisfied nor satisfied",id:"csatPopup.stars.3StarLabel"});case 4:return s?(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Somewhat likely",id:"csatPopup.stars.4StarLabelNps"}):(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Somewhat satisfied",id:"csatPopup.stars.4StarLabel"});case 5:return s?(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Very likely",id:"csatPopup.stars.5StarLabelNps"}):(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Very satisfied",id:"csatPopup.stars.5StarLabel"});default:return(0,L.jsx)(p.FormattedMessage,{defaultMessage:"Select an option",id:"csatPopup.stars.notSpecifiedLabel"})}};return(0,L.jsxs)("div",{onMouseLeave:()=>{c.gw((()=>{this.stores.csatPopupStore.state.step===w&&this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,starRating:void 0})}),500)},style:this.getStarsContainerStyle(),children:[(0,L.jsxs)("div",{style:this.getStarsStyle(),children:[(0,L.jsx)(i,{rating:1}),(0,L.jsx)(i,{rating:2}),(0,L.jsx)(i,{rating:3}),(0,L.jsx)(i,{rating:4}),(0,L.jsx)(i,{rating:5})]}),(0,L.jsx)("div",{style:this.getStarLabelStyle(),children:(0,L.jsx)(n,{})})]})},this.handleCancel=async()=>{const{state:e}=T.Z;if(!e.open)return;const{open:t,...s}=e;if(t&&"trigger"===s.type){const{currentSpaceStore:e}=S.default.state;if(!e)return;await g.submitCsatFeedback(this.environment,{spaceId:e.id,rating:void 0,additionalFeedback:void 0,templateId:void 0,...s})}T.Z.setState({...T.Z.state,open:!1})},this.handleSend=async()=>{const{additionalFeedback:e,starRating:t}=this.stores.csatPopupStore.state,{currentSpaceStore:s}=S.default.state;if(!s||!t)return;const{state:i}=T.Z;if(!i.open)return;const{open:n,...a}=i,o="passive"===a.type?await g.submitCsatFeedback(this.environment,{spaceId:s.id,rating:t,additionalFeedback:e,type:a.type,milestone:void 0,templateId:void 0}):await g.submitCsatFeedback(this.environment,{spaceId:s.id,rating:t,additionalFeedback:e,templateId:void 0,...a});if("success"!==o.type)throw o.error;this.stores.csatPopupStore.setState({...this.stores.csatPopupStore.state,step:C}),c.gw((()=>{T.Z.setState({...T.Z.state,open:!1}),c.gw((()=>{this.stores.csatPopupStore.reset()}),1e3)}),2e3)},this.flexCenteredStyle={display:"flex",alignItems:"center",flexDirection:"column"}}willMount(){const{userSettingsStore:e,blockStore:t,spaceStore:s}=this.props;if(e&&t&&s){const i=this.environment;if("CsatMilestoneStore"in i){const a=n.Z.withListenerIgnored((()=>function(e,t){const{userSettingsStore:s,blockStore:i,spaceStore:n}=t,a=s.getSettings(),o=null==a?void 0:a.signup_time,{CsatMilestoneStore:r}=e,{data:l}=r.state,d=864e5,u=e=>Math.floor((Date.now()-e)/d);if(!n.isDefined()||!l)return;const{milestones:m}=l;if(!m)return;if(Math.max(...m.map((e=>e.created_time)))>Date.now()-24192e5)return;if(o){const e=u(o),t=c.UP(n.getInitialUseCases())||"legacy";if(e>=180){if(!y(m,h.Hf))return{milestone:h.Hf,useCase:t}}else if(e>=90){if(!y(m,h.Vx))return{milestone:h.Vx,useCase:t}}else if(e>=28){if(!y(m,h.Sh))return{milestone:h.Sh,useCase:t}}else if(e>=7&&!y(m,h.zK))return{milestone:h.zK,useCase:t}}const p=i.getCopiedFromPointer();return i.isDefined()&&p&&(0,f.J)(p)&&u(i.getCreatedTime())>=7&&!y(m,h.a0,{templateId:p.id})?{milestone:h.a0,useCase:"legacy",templateId:p.id}:void 0}(i,{userSettingsStore:e,blockStore:t,spaceStore:s})));if(a){const{milestone:e,useCase:t,templateId:s}=a;c.gw((()=>{T.Z.setState({open:!0,milestone:e,type:"trigger",useCase:t,templateId:s})}),2e3)}}}}renderComponent(){const{device:e}=this.environment;if(e.isMobile)return;const{currentSpaceStore:t}=S.default.state;return t&&!(0,x.Cx)(t)?(0,L.jsx)(P.Z,{isVisible:T.Z.state.open,animationStyle:this.getAnimationStyle(T.Z.state.open),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),springConfig:this.getSpringConfig(),render:()=>(0,L.jsxs)("div",{style:this.getContainerStyle(),children:[this.renderCancel(),(0,L.jsx)("div",{style:this.getInnerContainerStyle(),children:this.renderStep()})]})}):void 0}shouldRenderAsNPS(e){const t=(0,I.zt)(),{state:s}=T.Z,i=s.open&&"trigger"===s.type;return"enterprise"===t&&!e&&i}getSpringConfig(){return{scale:{stiffness:58,damping:4.3}}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getThanksHeaderStyle(){return{color:this.theme.regularTextColor,fontWeight:u.Z.fontWeight.semibold,fontSize:14}}getThanksDescriptionStyle(){return{color:this.theme.mediumTextColor,fontSize:12}}getButtonStyle(){return{width:"calc(100% - 30px)"}}getInputContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{width:"calc(100% - 30px)",display:"block",background:this.theme.popoverBackground,height:80,marginTop:10,marginBottom:10,opacity:e===w?0:1}}getStarLabelStyle(){return{fontSize:12,color:this.theme.mediumTextColor,paddingTop:4}}getFeedbackPromptStyle(){return{paddingTop:12,paddingBottom:12,color:this.theme.regularTextColor,fontWeight:u.Z.fontWeight.semibold,fontSize:14,lineHeight:1.4,width:188}}getStarStyle(){return{display:"inline-flex",position:"relative",width:20,height:20,marginRight:3}}getSlideContainerStyle(){const{step:e}=this.stores.csatPopupStore.state;return{...this.flexCenteredStyle,position:"absolute",transition:"transform 200ms ease",width:240,transform:e===w?"translateY(120px)":"translateY(0px)"}}getStarsContainerStyle(){return{width:"100%",...this.flexCenteredStyle}}getStarsStyle(){return{display:"flex",cursor:"pointer"}}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,position:"absolute",bottom:65+b.Z.state,right:16+b.Z.state,zIndex:m.hT}}getInnerContainerStyle(){return{...this.flexCenteredStyle,width:240,height:195,overflow:"hidden",position:"relative",padding:12,cursor:"default",textAlign:"center",justifyContent:"center"}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}}E.displayName="CsatPopup";const O=(0,p.injectIntl)(E)},15480:(e,t,s)=>{s.r(t),s.d(t,{default:()=>$});s(67294);var i=s(83355),n=s(5366),a=s(79257),o=s(11599),r=s(80444),l=s(85680),d=s(88923),c=s(53437),u=s(15145),m=s(6695),p=s(9999),g=s(90199),h=s(45238),f=s(85893);const y=(0,h.I)("speechBubbleThick",{viewBox:"0 0 16 16",svg:(0,f.jsx)("path",{d:"M4.32 15.424c.39 0 .677-.192 1.149-.609l2.344-2.064h4.116c2.057 0 3.213-1.19 3.213-3.22V4.22c0-2.03-1.156-3.22-3.213-3.22H3.213C1.163 1 0 2.19 0 4.22V9.53c0 2.037 1.196 3.22 3.165 3.22h.28v1.675c0 .608.322.998.875.998zm.342-1.531v-1.949c0-.403-.178-.56-.56-.56H3.26c-1.285 0-1.9-.65-1.9-1.894V4.26c0-1.243.615-1.893 1.9-1.893h8.627c1.278 0 1.893.65 1.893 1.894v5.23c0 1.243-.615 1.893-1.893 1.893h-4.15c-.417 0-.622.068-.909.369l-2.167 2.14zm-.567-8.668h6.884a.433.433 0 00.423-.438.425.425 0 00-.423-.417H4.095a.419.419 0 00-.417.417c0 .24.184.438.417.438zm0 2.167h6.884a.427.427 0 000-.855H4.095a.425.425 0 00-.417.424c0 .24.184.43.417.43zm0 2.173h4.484c.24 0 .424-.191.424-.423 0-.24-.185-.431-.424-.431H4.095a.422.422 0 00-.417.43.42.42 0 00.417.424z"})});var v=s(92607),x=s(37888),S=s(72126),b=s(82990),M=s(50906),w=s(96802),j=s(39699),C=s(84210),k=s(87279),_=s(18514),T=s(92547),I=s(90106),P=s(81870),Z=s(26909),F=s(44514),A=s(79131),D=s(84076),B=s(78140),R=s(28992),L=s(40721),N=s(89728),E=s(31278),O=s(76798),V=s(72495),U=s(49085),W=s(61766),z=s(43700),K=s(69872);class H extends i.Z{constructor(){super(...arguments),this.storeTypes={hovered:U.default.createClass(!1),buttonPopupStore:U.default.createClass(new W.Z)}}renderComponent(){const{schema:e,property:t,format:s,showAsSectionMenu:i,handlePageSectionClick:n}=this.props,a=e[t];if(!a)return;const o=this.getPropertyVisibility(a);return(0,f.jsx)(K.Z,{onMouseEnter:()=>this.stores.hovered.setState(!0),onMouseLeave:()=>this.stores.hovered.setState(!1),focused:this.stores.hovered.state,showDragHandle:!this.environment.device.isMobile,showExtensionArrow:!1,propertySchema:a,format:K.Z.DisplayFormat.Name,dontShrinkRight:!0,ignoreLocalHoverState:!0,locked:this.props.locked,onClick:()=>{if(!this.props.locked){const e=this.stores.buttonPopupStore.state;e.setState({open:!e.state.open})}},right:i&&n?(0,f.jsx)(z.Z,{buttonPopupStore:this.stores.buttonPopupStore.state,visibility:o,visibilityLevels:["show","hide","hide_if_empty","inline","minimal"],locked:this.props.locked,onSelect:e=>n(e,t,s),onClose:()=>this.stores.hovered.setState(!1),type:"relation_property",propertySchema:a,showAsMenu:!0}):(0,f.jsx)(z.Z,{buttonPopupStore:this.stores.buttonPopupStore.state,visibility:o,locked:this.props.locked,onSelect:e=>this.handleVisibilitySelectClick(e),onClose:()=>this.stores.hovered.setState(!1),type:"property",propertySchema:a})},t)}getPropertyVisibility(e){const{visibility:t}=this.props;switch(t){case"hide_if_empty":return o.kq({propertySchema:e})?"hide_if_empty":"show";default:return t}}handleVisibilitySelectClick(e){const{property:t,format:s,store:i}=this.props;j.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:this.environment,perform:n=>{a.M0({property:t,visibility:e,format:s,store:i,transaction:n})}})}}H.displayName="CustomizePageMenuPropertyMenuItem";const G=H;class q extends i.Z{constructor(){super(...arguments),this.storeTypes={lockStore:T.Z},this.handleDraggableDrop=e=>{const t=this.getCollectionPageProperties(),s=this.props.store;if(t){const i=e.map((e=>t.find((t=>t.property===e))));a.D2({environment:this.environment,properties:i,store:s})}},this.handleDraggableDropSections=e=>{const t=this.getCollectionPageSections(),s=this.props.store;if(t){const i=e.map((e=>t.find((t=>t.section===e))));t&&j.createAndCommit({userAction:"CustomizePageMenu.handleDraggableDropSections",environment:this.environment,perform:e=>{a.Do({environment:this.environment,pageSectionFormats:i,store:s,transaction:e})}})}},this.handleShowAsClick=(e,t,s,i)=>{const n=o.$0();if(!n)return!1;let r=i.collection_page_sections?S.Xh(i.collection_page_sections):[];if(!s[t])return;const l=r.findIndex((e=>e.section===t));-1!==l?r[l]={section:t,visibility:e}:r=[...r,{section:t,visibility:e}];const d="inline"===e||"minimal"===e?"section":"show";r&&(j.createAndCommit({userAction:"CustomizePageMenu.handleShowAsClick",environment:this.environment,perform:e=>{a.Do({environment:this.environment,pageSectionFormats:r,store:n,transaction:e}),a.M0({property:t,visibility:d,store:n,format:i,transaction:e})}}),M.K1b(this.environment,{from:"page_properties",mode:"inline"===e?"page_section":"minimal"===e?"minimal_page_section":"property"}))},this.handleShowAsSectionMenuClick=(e,t,s)=>{const i=o.$0();if(!i)return;let n=s.collection_page_sections?S.Xh(s.collection_page_sections):[];if("inline"===e||"minimal"===e){const o=n.findIndex((e=>e.section===t));-1!==o?n[o]={section:t,visibility:e}:n=[...n,{section:t,visibility:e}];const r="inline"===e||"minimal"===e?"section":"show";n&&(j.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPageSectionClick",environment:this.environment,perform:e=>{a.Do({environment:this.environment,pageSectionFormats:n,store:i,transaction:e}),a.M0({property:t,visibility:r,store:i,format:s,transaction:e})}}),M.K1b(this.environment,{from:"page_properties",mode:"minimal"===e?"minimal_page_section":"page_section"}))}else{const n=m.AX.find((t=>t===e));if(!n)return;j.createAndCommit({userAction:"CustomizePageMenu.handleShowAsPropertyClick",environment:this.environment,perform:e=>{a.M0({property:t,visibility:n,store:i,format:s,transaction:e})}}),M.K1b(this.environment,{from:"page_properties",mode:"property"})}},this.handleToggleLockClick=()=>{const e=o.$0();if(!e)return!1;const t=e.getParentBlockStore();t&&(j.createAndCommit({userAction:"CustomizePageMenu.handleToggleLockClick",environment:this.environment,perform:e=>{w.Wq({environment:this.environment,store:t,isLocked:!o.p1(),transaction:e})}}),this.stores.lockStore.setState({justUnlocked:!this.stores.lockStore.state.justUnlocked}))}}renderComponent(){const{device:e}=this.environment,t=this.createComputedStore((()=>"page"===this.props.type?this.props.store.isExternalObjectInstancePageBlockStore():this.props.store.isSyncedCollection()));let s;s=e.isMobile?{menuType:k.og.Modal,right:(0,f.jsx)(L.DoneMenuText,{}),onClickRight:a.xv,title:this.props.intl.formatMessage({id:"customizePageMenu.mobileHeader.label",defaultMessage:"Customize page"})}:{menuType:k.og.Popup,minWidth:400};const i=this.getNormalizedFormat();return(0,f.jsxs)(B.Z,{...s,header:this.renderHeader(),children:[(this.props.locked||this.stores.lockStore.state.justUnlocked)&&this.renderLockControls(),this.renderPageSectionsSectionMenuItem(i,t.state),this.renderPropertiesSectionMenuItem(i)]})}renderLockControls(){return(0,f.jsxs)("div",{style:{fontSize:12,display:"flex",justifyContent:"center",alignItems:"center",borderTop:`1px solid ${this.theme.regularDividerColor}`,borderBottom:`1px solid ${this.theme.regularDividerColor}`,background:this.theme.sidebarBackground,color:this.theme.mediumTextColor,paddingTop:6,paddingBottom:6},children:[(0,f.jsx)("span",{style:{display:"inline-block",verticalAlign:"middle",paddingRight:6},children:this.stores.lockStore.state.justUnlocked?(0,x.U)({height:12,width:12,fill:this.theme.mediumIconColor}):(0,g.b)({height:12,width:12,fill:this.theme.mediumIconColor})}),this.stores.lockStore.state.justUnlocked?(0,f.jsx)(n.FormattedMessage,{id:"customizePageMenu.unlocked.header",defaultMessage:"Settings unlocked on parent database."}):(0,f.jsx)(n.FormattedMessage,{id:"customizePageMenu.locked.header",defaultMessage:"Settings locked on parent database."}),(0,f.jsx)(N.Z,{style:{fontSize:12,color:this.theme.mediumTextColor,fontWeight:b.Z.fontWeight.semibold,marginLeft:2,paddingLeft:4,paddingRight:4,height:20},onClick:this.handleToggleLockClick,children:this.stores.lockStore.state.justUnlocked?(0,f.jsx)(n.FormattedMessage,{id:"customizePageMenu.lock.label",defaultMessage:"Re-lock"}):(0,f.jsx)(n.FormattedMessage,{id:"customizePageMenu.unlock.label",defaultMessage:"Unlock"})})]})}renderPropertiesSectionMenuItem(e){if(!this.getSchema()||"page"===this.props.type)return;const t=this.getPageCustomization(e);if(!t)return;const{propertyVisibility:s}=t;if(!s)return;const i=s.reduce(((e,t)=>(e[t.property]=t.visibility,e)),{}),a=this.getCollectionPageSections().filter((e=>"inline"===e.visibility||"minimal"===e.visibility)).map((e=>e.section)),o=S.e5(this.getCollectionPageProperties().map((e=>e.property)),a);return(0,f.jsx)(V.Z,{style:{opacity:this.props.locked?.5:1},title:(0,f.jsx)(n.FormattedMessage,{id:"customizePageMenu.propertiesSection.header",defaultMessage:"Properties"}),children:this.renderDraggablePageProperties(o,i,e,this.handleDraggableDrop)})}renderPageSectionsSectionMenuItem(e,t){const s=this.props.store,i=this.getSchema();if(!i||!s)return;const r=this.getPageCustomization(e);if(!r)return;const{pageSectionVisibility:l}=r;if(!l)return;const d=this.getCollectionPageSections().map((e=>e.section)),c={topLevelDiscussions:!t,backLinks:!0,pageComments:!t};return(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(V.Z,{style:{opacity:this.props.locked?.5:1},title:(0,f.jsx)(n.FormattedMessage,{id:"customizePageMenu.sectionsSection.header",defaultMessage:"Sections"}),topBorder:!this.props.locked&&!this.stores.lockStore.state.justUnlocked,children:(0,f.jsxs)("div",{style:{marginLeft:8},children:[d.length>0&&(0,f.jsxs)(V.Z,{style:{opacity:this.props.locked?.5:1,width:"100%",paddingBottom:0,paddingTop:0},children:[(0,f.jsx)(A.ZP,{direction:"vertical",keys:d,renderKey:t=>{if("collection"===this.props.type&&"inline"===(0,o.ab)(void 0,t))return this.renderRelationSectionMenuItem(i,t,e)},onDrop:this.handleDraggableDropSections}),(0,f.jsx)(A.ZP,{direction:"vertical",keys:d,renderKey:t=>{if("collection"===this.props.type&&"minimal"===(0,o.ab)(void 0,t))return this.renderRelationSectionMenuItem(i,t,e)},onDrop:this.handleDraggableDropSections})]}),c.topLevelDiscussions&&(0,f.jsx)(R.Z,{title:(0,f.jsx)(n.FormattedMessage,{id:"customizePageMenu.pageSections.topLevelPageDiscussionsTitle",defaultMessage:"Top-level page discussions"}),icon:y({height:16,width:16}),right:(0,f.jsx)(z.Z,{visibility:l.comments,visibilityLevels:["section_show","section_hide"],locked:this.props.locked,onSelect:t=>{a.W4({environment:this.environment,pageSection:"comments",visibility:t,store:s,format:e})},type:"page"})}),c.backLinks&&(0,f.jsx)(R.Z,{title:(0,f.jsx)(n.FormattedMessage,{id:"customizePageMenu.pageSections.backlinksTitle",defaultMessage:"Backlinks"}),icon:(0,p.J)({height:16,width:16,transform:"rotate(180deg)"}),right:(0,f.jsx)(z.Z,{visibility:l.backlinks,locked:this.props.locked,visibilityLevels:["section_show","section_hide","section_collapsed"],onSelect:t=>{a.W4({environment:this.environment,pageSection:"backlinks",visibility:t,store:s,format:e})},type:"page"})}),c.pageComments&&(0,f.jsx)(R.Z,{title:(0,f.jsx)(n.FormattedMessage,{id:"customizePageMenu.pageSections.pageCommentsTitle",defaultMessage:"Page comments"}),icon:y({height:16,width:16}),right:(0,f.jsx)(z.Z,{visibility:(0,o.ab)(l,"margin_comments"),visibilityLevels:["inline","minimal"],locked:this.props.locked,onSelect:t=>{a.W4({environment:this.environment,pageSection:"margin_comments",visibility:t,store:s,format:e})},type:"page"})})]})})})}renderRelationSectionMenuItem(e,t,s){var i;return(0,f.jsx)("div",{style:{display:"inline-flex",width:"100%"},children:(0,f.jsx)(R.Z,{title:null===(i=e[t])||void 0===i?void 0:i.name,icon:(0,v.v)({height:14,width:14,color:this.theme.mediumIconColor,fill:this.theme.mediumIconColor,fontWeight:b.Z.fontWeight.medium}),disabled:this.props.locked,showDragHandle:!this.environment.device.isMobile,right:(0,f.jsx)(z.Z,{visibility:(0,o.ab)(void 0,t),visibilityLevels:["section_hide","inline","minimal"],locked:this.props.locked,onSelect:i=>{this.handleShowAsClick(i,t,e,s)},type:"page",showAsMenu:!0})})})}renderHeader(){if(this.environment.device.isMobile)return;const{store:e}=this.props;if(e){const t=e.getIcon(),s="collection"===this.props.type?this.props.store.getParentBlockStore():void 0,i=t&&(0,f.jsx)(E.Z,{icon:t,isEmptyPage:!1,size:14,disabled:!0,style:{display:"inline-flex",marginRight:2}}),o=(0,f.jsx)(O.Z,{store:e,style:{display:"inline"}}),r=s?(0,f.jsx)(F.Q,{prefix:(0,f.jsx)(n.FormattedMessage,{id:"customizePageMenu.header.allPages.label",defaultMessage:"Customize all pages in"}),viewName:s?(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(D.Z,{onClick:a.xv,href:(0,C.ZP)({store:s,fullyQualified:!1,pageVisitSource:u.tY.Breadcrumb}),inline:!0,children:[i,o]})}):(0,f.jsxs)(f.Fragment,{children:[i,o]})}):(0,f.jsx)(n.FormattedMessage,{id:"customizePageMenu.header.singlePage.label",defaultMessage:"Customize this page view"});return(0,f.jsx)(R.Z,{style:{...Z.ZP.headingStyle},title:r,right:(0,f.jsx)(P.Z,{helpButtonContext:"customize_page_menu",href:(0,_.UY)("guides.customizePageView")})})}}renderDraggablePageProperties(e,t,s,i){const n=this.getSchema(),a=this.props.store;return a instanceof I.NW?(0,f.jsx)(A.ZP,{direction:"vertical",keys:e,renderKey:e=>{var i;const o=null===(i=n[e])||void 0===i?void 0:i.type;if("collection"===this.props.type)return"relation"===o?(0,f.jsx)(G,{schema:n,visibility:t[e],property:e,format:s,store:a,locked:this.props.locked,showAsSectionMenu:!0,handlePageSectionClick:this.handleShowAsSectionMenuClick}):(0,f.jsx)(G,{schema:n,visibility:t[e],property:e,format:s,store:a,locked:this.props.locked})},onDrop:i}):null}getSchema(){return this.props.type,this.props.store.getSchema()}getNormalizedFormat(){const{store:e}=this.props,t=e.getFormat(),s=this.getSchema();if(!s)return{};return m.iB(t,s,void 0,m.j5.Collection)}getCollectionPageProperties(){if("collection"!==this.props.type)return[];return this.getNormalizedFormat().collection_page_properties||[]}getCollectionPageSections(){if("collection"!==this.props.type)return[];return this.getNormalizedFormat().collection_page_sections||[]}getPageCustomization(e){return{propertyVisibility:e.property_visibility,pageSectionVisibility:e.page_section_visibility}}isWikiPage(){const e=this.props.store.getParentStore();return!!(e&&e instanceof I.G)&&e.isAssociatedCollectionAPageTree()}}q.displayName="CustomizePageMenu";const Y=q;class Q extends i.Z{constructor(){super(...arguments),this.renderModal=()=>{if(!l.Z.state.isOpen)return;const e=o.$0(),{mainEditorCurrentBlockStore:t}=r.default.state,s=d.default.state.open&&d.default.state.target||t;return e?(0,f.jsx)(Y,{store:e,type:"collection",intl:this.props.intl,locked:o.p1()}):s?(0,f.jsx)(Y,{store:s,type:"page",intl:this.props.intl,locked:!1}):void 0}}renderComponent(){const{device:e}=this.environment,t=l.Z.state;return(0,f.jsx)(c.ZP,{popupType:e.isMobile?c.ZP.PopupType.SlideUp:c.ZP.PopupType.Popup,alignmentToOrigin:c.ZP.Alignment.Center,open:t.isOpen,render:this.renderModal,originRect:t.isOpen?t.rect:void 0,onDismiss:()=>a.xv()})}}Q.displayName="CustomizePageMenuRenderer";const $=(0,n.injectIntl)(Q)},43700:(e,t,s)=>{s.d(t,{Z:()=>g});s(67294);var i=s(83355),n=s(42853),a=s(5366),o=s(61766),r=s(31194),l=s(31945),d=s(89728),c=s(6318),u=s(85893);const m=(0,a.defineMessages)({hideSimpleLabel:{id:"customizePageMenuVisibilitySelect.hideSimple.label",defaultMessage:"Hide"},hideLabel:{id:"customizePageMenuVisibilitySelect.hide.label",defaultMessage:"Always hide"},hidePageLabel:{id:"customizePageMenuVisibilitySelect.off.label",defaultMessage:"Off"},showLabel:{id:"customizePageMenuVisibilitySelect.show.label",defaultMessage:"Always show"},showPageLabel:{id:"customizePageMenuVisibilitySelect.expanded.label",defaultMessage:"Expanded"},hideIfEmptyLabel:{id:"customizePageMenuVisibilitySelect.hideIfEmpty.label",defaultMessage:"Hide when empty"},collapsedLabel:{id:"customizePageMenuVisibilitySelect.collapsed.label",defaultMessage:"Show in popover"},defaultLabel:{id:"customizePageMenuVisibilitySelect.default.label",defaultMessage:"Default"},minimalLabel:{id:"customizePageMenuVisibilitySelect.minimal.label",defaultMessage:"Minimal"},sectionLabel:{id:"customizePageMenuVisibilitySelect.section.label",defaultMessage:"As page section"},propertyLabel:{id:"customizePageMenuVisibilitySelect.property.label",defaultMessage:"As property"}});class p extends i.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:o.Z}}renderComponent(){const{device:e}=this.environment;return(0,u.jsx)(l.ZP,{popupType:e.isMobile?l.Z4.SlideUp:l.Z4.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>(0,u.jsxs)(d.Z,{style:{color:this.theme.mediumTextColor,paddingRight:0,height:this.environment.device.isMobile?32:22},disabled:this.props.locked,...e,children:[p.getVisibilityLabel(this.props.visibility,this.props.showAsMenu),(0,n.i)({width:10,marginLeft:4,marginRight:4,fill:this.theme.lightIconColor})]}),placementToOrigin:r.Iw.Bottom,onClose:this.props.onClose,render:e=>(0,u.jsx)(c.Z,{...this.props,onClose:e.close})})}static getVisibilityLabel(e,t){switch(e){case"hide":return(0,u.jsx)(a.FormattedMessage,{...m.hideLabel});case"show":return(0,u.jsx)(a.FormattedMessage,{...m.showLabel});case"hide_if_empty":return(0,u.jsx)(a.FormattedMessage,{...m.hideIfEmptyLabel});case"section_hide":return t?(0,u.jsx)(a.FormattedMessage,{...m.propertyLabel}):(0,u.jsx)(a.FormattedMessage,{...m.hidePageLabel});case"section_show":return(0,u.jsx)(a.FormattedMessage,{...m.showPageLabel});case"section_collapsed":return(0,u.jsx)(a.FormattedMessage,{...m.collapsedLabel});case"inline":return t?(0,u.jsx)(a.FormattedMessage,{...m.sectionLabel}):(0,u.jsx)(a.FormattedMessage,{...m.defaultLabel});case"minimal":return(0,u.jsx)(a.FormattedMessage,{...m.minimalLabel})}}}p.displayName="CustomizePageMenuVisibilitySelect";const g=p},6318:(e,t,s)=>{s.d(t,{Z:()=>f});s(67294);var i=s(83355),n=s(6695),a=s(36591),o=s(5366),r=s(11599),l=s(87279),d=s(52275),c=s(78140),u=s(32163),m=s(72495),p=s(43700),g=s(85893);class h extends i.Z{constructor(){super(...arguments),this.renderMenuItem=e=>{const{device:t}=this.environment;return{key:e,render:s=>(0,g.jsx)(d.Z,{...s,textWrapperStyle:{marginRight:0},title:(0,g.jsx)("div",{style:{display:"flex",alignItems:"center",width:150},children:(0,g.jsx)("div",{children:p.Z.getVisibilityLabel(e,this.props.showAsMenu)})}),right:this.props.visibility===e?(0,g.jsx)("div",{style:{width:t.isMobile?16:14},children:(0,a.e)()}):void 0}),action:()=>{if("page"===this.props.type){const t=e;this.props.onSelect(t)}if("relation_property"===this.props.type){const t=e;this.props.onSelect(t)}else if("property"===this.props.type){const t=e;this.props.onSelect(t)}this.props.onClose&&this.props.onClose()}}}}renderComponent(){const{device:e}=this.environment,t=[{key:"visibilityLevels",render:e=>(0,g.jsx)(m.Z,{...e,topBorder:0!==e.index}),items:"page"===this.props.type||"relation_property"===this.props.type?this.getPageOrPropertyVisibilityLevels().map((e=>this.renderMenuItem(e))):this.getPropertyVisibilityLevels().filter((e=>"property"!==this.props.type||"hide_if_empty"!==e||r.kq({propertySchema:this.props.propertySchema}))).map((e=>this.renderMenuItem(e)))}];let s;return s=e.isMobile?{menuType:l.og.Modal,title:(0,g.jsx)(o.FormattedMessage,{id:"customizePageMenuVisibilitySelect.mobile.title",defaultMessage:"Select visibility"}),right:(0,g.jsx)(o.FormattedMessage,{id:"customizePageMenuVisibilitySelect.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:()=>this.props.onClose&&this.props.onClose()}:{menuType:l.og.Popup,width:"auto",maxWidth:360},(0,g.jsx)(c.Z,{...s,children:(0,g.jsx)(u.Z,{type:u.i.Vertical,initialFocus:void 0,sections:t})})}getPageOrPropertyVisibilityLevels(){return"page"!==this.props.type&&"relation_property"!==this.props.type?[]:this.props.visibilityLevels?this.props.visibilityLevels:n.Sn}getPropertyVisibilityLevels(){return n.AX}}h.displayName="CustomizePageMenuVisibilitySelectMenuItem";const f=h},81070:(e,t,s)=>{s.r(t),s.d(t,{default:()=>$});var i=s(30120),n=s(67294),a=s(83355),o=s(13991),r=s(49085),l=s(8848),d=s(41797),c=s(5366),u=s(40506);const m=(0,c.defineMessages)({none:{defaultMessage:"None",id:"dateFormatHelpers.reminderMenuItems.none"},onTheDay:{defaultMessage:"On day of event {formattedTimeText}",id:"dateFormatHelpers.reminderMenuItems.onTheDayOfEvent"},hoursBefore:{defaultMessage:"{numberOfHours, plural, one {{numberOfHours} hour before} other {{numberOfHours} hours before}}",id:"dateFormatHelpers.reminderMenuItems.hoursBefore"},minutesBefore:{defaultMessage:"{numberOfMinutes, plural, one {{numberOfMinutes} minute before} other {{numberOfMinutes} minutes before}}",id:"dateFormatHelpers.reminderMenuItems.minutesBefore"},yearsBefore:{defaultMessage:"{numberOfYears, plural, one {{numberOfYears} year before {formattedTimeText}} other {{numberOfYears} years before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.yearsBefore"},daysBefore:{defaultMessage:"{numberOfDays, plural, one {{numberOfDays} day before {formattedTimeText}} other {{numberOfDays} days before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.daysBefore"},monthsBefore:{defaultMessage:"{numberOfMonths, plural, one {{numberOfMonths} month before {formattedTimeText}} other {{numberOfMonths} months before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.monthsBefore"},weeksBefore:{defaultMessage:"{numberOfWeeks, plural, one {{numberOfWeeks} week before {formattedTimeText}} other {{numberOfWeeks} weeks before {formattedTimeText}}}",id:"dateFormatHelpers.reminderMenuItems.weeksBefore"},atTimeOf:{defaultMessage:"At time of event",id:"dateFormatHelpers.reminderMenuItems.atTimeOfEvent"}});function p(e){const{reminder:t,shouldShowTime:s,intl:i,formatTime:n}=e;if(!t)return i.formatMessage(m.none);if(u.vJ(t)){const{unit:e,value:a,time:o}=t,r=n({start_time:o,time_format:"LT",humanReadable:!0,intl:i}),l=s?`(${r})`:"";return 0===a?i.formatMessage(m.onTheDay,{formattedTimeText:l}):"day"===e?i.formatMessage(m.daysBefore,{formattedTimeText:l,numberOfDays:a}):"year"===e?i.formatMessage(m.yearsBefore,{formattedTimeText:l,numberOfYears:a}):"month"===e?i.formatMessage(m.monthsBefore,{formattedTimeText:l,numberOfMonths:a}):i.formatMessage(m.weeksBefore,{formattedTimeText:l,numberOfWeeks:a})}{const{unit:e,value:s}=t;return 0===s?i.formatMessage(m.atTimeOf):"hour"===e?i.formatMessage(m.hoursBefore,{numberOfHours:s}):i.formatMessage(m.minutesBefore,{numberOfMinutes:s})}}var g=s(7057),h=s(53877),f=s(84795),y=s(42875),v=s(11843),x=s(36700),S=s(16001),b=s(72126),M=s(70203),w=s(97880),j=s(63143),C=s(50906),k=s(87279),_=s(18514),T=s(77907),I=s(76150),P=s(77080),Z=s(69582),F=s(52275),A=s(31945),D=s(37601),B=s(88359),R=s(1743),L=s(74194),N=s(78140),E=s(32163),O=s(72495),V=s(45959),U=s(24006),W=s(26388),z=s(64369),K=s(83182),H=s(46247),G=s(62069),q=s(85893);class Y extends a.Z{constructor(){super(...arguments),this.storeTypes={store:I.ZP,timezoneQuery:r.default.createClass("")},this.handleWindowKeyDown=e=>{"Escape"===e.key&&this.maybePreEmptivelyBlurInput()},this.handleWindowMouseDown=e=>{e.target instanceof HTMLInputElement&&e.target===document.activeElement||this.maybePreEmptivelyBlurInput()},this.handleDateFormatChange=e=>{var t,s;null===(t=(s=this.props).onChangeDateFormat)||void 0===t||t.call(s,e)},this.handleTimeFormatChange=e=>{var t,s;const i=this.getTimeFormatOptions()[e];null===(t=(s=this.props).onChangeTimeFormat)||void 0===t||t.call(s,i)},this.handleChangeReminder=e=>{const t=this.getDateValue();var s,i;if(e){if(u.vJ(e)){var n,a;null===(n=(a=this.props).onChangeValue)||void 0===n||n.call(a,{...t,reminder:{...e,defaultTimeZone:(0,y.r)()}})}else if("datetime"===t.type||"datetimerange"===t.type){var o,r;null===(o=(r=this.props).onChangeValue)||void 0===o||o.call(r,{...t,reminder:e})}}else null===(s=(i=this.props).onChangeValue)||void 0===s||s.call(i,{...t,reminder:e});C.IMD(this.environment,{date:t,reminder:e})},this.handleInputChange=e=>{const{device:t}=this.environment,{store:s}=this.stores;s.setState({...s.state,inputTemporaryValue:{...s.state.inputTemporaryValue,[s.state.focus]:e.target.value||""}}),t.isAndroid&&this.handleInputBlur()},this.handleStartDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startDate;if(!t)return;const s=this.parseInputDateValue(t);if(!s)return I.pd.InvalidDate;const i={...this.getDateValue(),start_date:s},n=h.XI(i);if(!n)return I.pd.InvalidRange;this.applyValidDateState({newDate:i,currentMonth:n.start,resetField:I.Hv.StartDate})},this.handleStartTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.startTime;if(!t)return;const s=this.parseInputTimeValue(t);if(!s)return I.pd.InvalidTime;const i=this.getDateValue();if(u.qg(i)){const{newDate:e,currentMonth:t}=h.vz({previous:i,updatedStartTime:s});this.applyValidDateState({newDate:e,currentMonth:t,resetField:I.Hv.StartTime}),this.resetInputState(I.Hv.EndDate),this.resetInputState(I.Hv.EndTime)}else{const e={...i,start_time:s},t=h.XI(e);this.applyValidDateState({newDate:e,currentMonth:t.start,resetField:I.Hv.StartTime})}},this.handleEndDateInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endDate;if(!t)return;const s=this.parseInputDateValue(t);if(!s)return I.pd.InvalidDate;const i={...this.getDateValue(),end_date:s},n=h.XI(i);if(!n)return I.pd.InvalidRange;this.applyValidDateState({newDate:i,currentMonth:n.end,resetField:I.Hv.EndDate})},this.handleEndTimeInputChange=()=>{const{inputTemporaryValue:e}=this.stores.store.state,t=e.endTime;if(!t)return;const s=this.parseInputTimeValue(t);if(!s)return I.pd.InvalidTime;const i={...this.getDateValue(),end_time:s},n=h.XI(i);if(!n)return I.pd.InvalidRange;this.applyValidDateState({newDate:i,currentMonth:n.end,resetField:I.Hv.EndTime})},this.handleInputBlur=e=>{const{focus:t}=this.stores.store.state;let s;t===I.Hv.StartDate?s=this.handleStartDateInputChange():t===I.Hv.StartTime?s=this.handleStartTimeInputChange():t===I.Hv.EndDate?s=this.handleEndDateInputChange():t===I.Hv.EndTime&&(s=this.handleEndTimeInputChange()),s?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[t]:s}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},inputIsFocused:!1,error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleInputSubmit=()=>{const{focus:e}=this.stores.store.state;let t;e===I.Hv.StartDate?t=this.handleStartDateInputChange():e===I.Hv.StartTime?t=this.handleStartTimeInputChange():e===I.Hv.EndDate?t=this.handleEndDateInputChange():e===I.Hv.EndTime&&(t=this.handleEndTimeInputChange()),t?this.stores.store.setState({...this.stores.store.state,error:{...this.stores.store.state.error,[e]:t}}):this.stores.store.setState({...this.stores.store.state,inputTemporaryValue:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0},error:{startDate:void 0,startTime:void 0,endDate:void 0,endTime:void 0}})},this.handleDayPickerDayClick=(e,t,s)=>{if(this.props.disabled)return;let n=b.Xh(this.getDateValue());const{focus:a}=this.stores.store.state,o=i.ou.fromJSDate(e).setLocale(u.ah).toFormat(h.Iq);if(!s.shiftKey||"date"!==n.type&&"datetime"!==n.type)if("daterange"===n.type||"datetimerange"===n.type){var r,l;a===I.Hv.StartDate||a===I.Hv.StartTime?n={...n,start_date:o}:a!==I.Hv.EndDate&&a!==I.Hv.EndTime||(n={...n,end_date:o});const e=h.NK(n,(0,y.r)());if(e.end&&e.end<e.start){if("datetimerange"===n.type){const{start_date:e,start_time:t,end_date:s,end_time:i}=n;n={...n,start_date:s,start_time:i,end_date:e,end_time:t}}else{const{start_date:e,end_date:t}=n;n={...n,start_date:t,end_date:e}}this.stores.store.setState({...this.stores.store.state,focus:a===I.Hv.StartDate||a===I.Hv.StartTime?I.Hv.EndDate:I.Hv.StartDate})}null===(r=(l=this.props).onChangeValue)||void 0===r||r.call(l,n),this.resetInputState(a);const t=a===I.Hv.StartDate||a===I.Hv.StartTime?I.Hv.EndDate:I.Hv.StartDate;this.stores.store.setState({...this.stores.store.state,focus:t})}else{var d,c;const e={...n,start_date:o};null===(d=(c=this.props).onChangeValue)||void 0===d||d.call(c,e),this.resetInputState(a)}else this.enableEndDate({dateValue:n,endDate:o})},this.handleDayPickerMonthChange=e=>{this.stores.store.setState({...this.stores.store.state,currentMonth:i.ou.fromJSDate(e)})},this.handleEndDateControlChange=()=>{const e=this.getDateValue();if("datetimerange"===e.type){var t,s;const i={type:"datetime",start_date:e.start_date,start_time:e.start_time,time_zone:e.time_zone,reminder:e.reminder};null===(t=(s=this.props).onChangeValue)||void 0===t||t.call(s,i)}else if("daterange"===e.type){var i,n;const t={type:"date",start_date:e.start_date,reminder:e.reminder};null===(i=(n=this.props).onChangeValue)||void 0===i||i.call(n,t)}else this.enableEndDate({dateValue:e})},this.handleAllDayChange=()=>{const e=this.getDateValue();if("date"===e.type){var t,s;const i={type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,y.r)(),reminder:e.reminder&&u.AE(e.reminder)};null===(t=(s=this.props).onChangeValue)||void 0===t||t.call(s,i)}else if("daterange"===e.type){var i,n;const t={type:"datetimerange",start_date:e.start_date,start_time:"00:00",end_date:e.end_date,end_time:"00:00",time_zone:(0,y.r)(),reminder:e.reminder&&u.AE(e.reminder)};null===(i=(n=this.props).onChangeValue)||void 0===i||i.call(n,t)}else if("datetime"===e.type){var a,o;const t={type:"date",start_date:e.start_date,reminder:e.reminder&&u.wg(e.reminder,(0,y.r)())};null===(a=(o=this.props).onChangeValue)||void 0===a||a.call(o,t)}else{var r,l;const t={type:"daterange",start_date:e.start_date,end_date:e.end_date,reminder:e.reminder&&u.wg(e.reminder,(0,y.r)())};null===(r=(l=this.props).onChangeValue)||void 0===r||r.call(l,t)}},this.handleTimeZoneChange=e=>{const t=this.getDateValue();if("datetime"===t.type||"datetimerange"===t.type){var s,i;const n={...t,time_zone:e};null===(s=(i=this.props).onChangeValue)||void 0===s||s.call(i,n)}},this.handleStartInputDateFocus=()=>{const e=this.getDateValue(),t=h.NK(e,(0,y.r)());this.stores.store.setState({...this.stores.store.state,focus:I.Hv.StartDate,inputIsFocused:!0,currentMonth:t.start})},this.handleStartInputTimeFocus=()=>{const e=this.getDateValue(),t=h.NK(e,(0,y.r)());this.stores.store.setState({...this.stores.store.state,focus:I.Hv.StartTime,inputIsFocused:!0,currentMonth:t.start})},this.handleEndInputDateFocus=()=>{const e=this.getDateValue(),t=h.NK(e,(0,y.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:I.Hv.EndDate,inputIsFocused:!0,currentMonth:t.end})},this.handleEndInputTimeFocus=()=>{const e=this.getDateValue(),t=h.NK(e,(0,y.r)());t.end&&this.stores.store.setState({...this.stores.store.state,focus:I.Hv.EndTime,inputIsFocused:!0,currentMonth:t.end})},this.handleClearClick=()=>{var e,t;null===(e=(t=this.props).onChangeValue)||void 0===e||e.call(t,void 0)},this.getTimeFormatOptions=()=>(0,v.E)(o.SP).time,this.getSelectedTimeFormatType=()=>{const e=this.getTimeDisplayFormat(),t=this.getTimeFormatOptions();for(const s in t)if(t[s]===e)return s;return"12h"},this.tooltipOriginGap=12}willMount(e){super.willMount(e),this.openTimeFormat=h.Lg((0,y.r)()),window.addEventListener("mousedown",this.handleWindowMouseDown),window.addEventListener("keydown",this.handleWindowKeyDown,!0)}willUnmount(){super.willUnmount(),window.removeEventListener("mousedown",this.handleWindowMouseDown),window.removeEventListener("keydown",this.handleWindowKeyDown,!0)}maybePreEmptivelyBlurInput(){const{inputIsFocused:e}=this.stores.store.state;e&&this.handleInputBlur()}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,{disabled:s,canConfigureCollection:i,shouldShowReminder:n,header:a,isTemplatePage:o}=this.props,{inputIsFocused:r}=this.stores.store.state,l=this.getDateValue(),d="datetime"===l.type||"datetimerange"===l.type,u="daterange"===l.type||"datetimerange"===l.type,m=o&&P.default.checkGate("template-variable-properties"),p=(0,q.jsxs)("div",{style:{paddingTop:e.isMobile?16:8,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:d?"block":"flex",...e.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0},children:[this.renderStartInput(),u&&(0,q.jsx)("div",{style:{width:12,height:8}}),this.renderEndInput(),this.renderTimeZone()]});let g;return g=e.isMobile?{menuType:k.og.Modal,title:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Date",id:"LuxonDatePropertyMenu.mobileDate.title"}),right:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),left:n?this.renderRemindersHelp():void 0,onClickRight:this.props.onDismiss,header:p}:{menuType:k.og.Popup,maxHeight:"none",width:270,header:a},(0,q.jsx)(R.Z,{capture:r,allowEsc:!0,children:(0,q.jsx)(R.Z,{capture:!0,allowUndo:!0,allowEsc:!0,children:(0,q.jsxs)(N.Z,{...g,children:[(0,q.jsx)(D.Z,{show:r}),m&&(0,q.jsx)(Q,{onChangeValue:this.props.onChangeValue}),(0,q.jsxs)(O.Z,{topBorder:!0,children:[!e.isMobile&&p,(0,q.jsx)("div",{style:{padding:e.isMobile?"16px 14px 16px":"4px 0 4px",textAlign:"center",...e.isMobile&&{borderBottom:`1px solid ${this.theme.regularDividerColor}`,background:this.theme.popoverBackground}},children:this.renderCalendar()})]}),!s&&this.renderControls(),!s&&i&&(0,q.jsx)(O.Z,{topBorder:!0,children:this.renderFormatPopup()}),!s&&(0,q.jsx)(O.Z,{topBorder:!0,children:this.renderClearButton()}),!s&&!e.isMobile&&n&&(0,q.jsx)(O.Z,{topBorder:!0,children:this.renderRemindersHelp()})]})})})}getLocale(){return this.props.locale||this.props.intl.locale}renderStartInput(){const{device:e}=this.environment,{disabled:t}=this.props,{focus:s,inputTemporaryValue:i,error:n}=this.stores.store.state,a=this.getDateValue(),o=h.NK(a,(0,y.r)(),this.getLocale()),r=Boolean(n.startDate||n.startTime),l="datetime"===a.type||"datetimerange"===a.type,d="daterange"===a.type||"datetimerange"===a.type,c=s===I.Hv.StartDate||s===I.Hv.StartTime,m=(0,j.z4)(i.startDate)?o.start.toFormat(this.getDateDisplayFormat()):i.startDate,p=(0,j.z4)(i.startTime)?o.start.toFormat(this.getTimeDisplayFormat()):i.startTime,g=(0,j.z4)(i.startDate)?o.start.toFormat(h.Iq):i.startDate,f=(0,j.z4)(i.startTime)?o.start.toFormat(u.jK):i.startTime;return(0,q.jsxs)("div",{style:{...r?this.getInputWrapErrorStyle():c&&d?this.getInputWrapActiveStyle():this.getInputWrapInactiveStyle(),fontSize:e.isMobile?16:14},children:[(0,q.jsx)(W.Z,{renderTooltip:()=>this.getInputErrorMessage(n.startDate),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(n.startDate),placement:W.Z.Placement.Left,render:()=>e.isMobile?(0,q.jsx)(L.Z,{type:"date",format:L.B.Transparent,value:g,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1}):(0,q.jsx)(L.Z,{selectAll:!0,format:L.B.Transparent,value:m,focusInitial:s===I.Hv.StartDate,onChange:this.handleInputChange,onFocus:this.handleStartInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,disabled:t,size:1})}),l&&this.getInputSeparator(),l&&(0,q.jsx)(W.Z,{renderTooltip:()=>this.getInputErrorMessage(n.startTime),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(n.startTime),placement:W.Z.Placement.Right,render:()=>e.isMobile?(0,q.jsx)(L.Z,{type:"time",format:L.B.Transparent,value:f,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):(0,q.jsx)(L.Z,{format:L.B.Transparent,value:p,focusInitial:s===I.Hv.StartTime,onChange:this.handleInputChange,onFocus:this.handleStartInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})})]})}renderEndInput(){const{device:e}=this.environment,{disabled:t}=this.props,s=this.getDateValue(),i=h.NK(s,(0,y.r)(),this.getLocale()),n="datetime"===s.type||"datetimerange"===s.type;if(i.end){const{focus:s,error:a,inputTemporaryValue:o}=this.stores.store.state,r=Boolean(a.endDate||a.endTime),l=s===I.Hv.EndDate||s===I.Hv.EndTime,d=(0,j.z4)(o.endDate)?i.end.toFormat(this.getDateDisplayFormat()):o.endDate,c=(0,j.z4)(o.endTime)?i.end.toFormat(this.getTimeDisplayFormat()):o.endTime,m=(0,j.z4)(o.endDate)?i.end.toFormat(h.Iq):o.endDate,p=(0,j.z4)(o.endTime)?i.end.toFormat(u.jK):o.endTime,g=this.getDateRangeBounds(),f=g&&g.earliestValidEnd;return(0,q.jsxs)("div",{style:{...r?this.getInputWrapErrorStyle():l?this.getInputWrapActiveStyle():this.getInputWrapInactiveStyle(),fontSize:e.isMobile?16:14},children:[(0,q.jsx)(W.Z,{renderTooltip:()=>this.getInputErrorMessage(a.endDate),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(a.endDate),placement:W.Z.Placement.Left,render:()=>e.isMobile?(0,q.jsx)(L.Z,{type:"date",format:L.B.Transparent,value:m,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t,inputElementAttributes:{min:f}}):(0,q.jsx)(L.Z,{format:L.B.Transparent,value:d,focusInitial:s===I.Hv.EndDate,onChange:this.handleInputChange,onFocus:this.handleEndInputDateFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})}),n&&this.getInputSeparator(),n&&(0,q.jsx)(W.Z,{renderTooltip:()=>this.getInputErrorMessage(a.endTime),originGap:this.tooltipOriginGap,forceVisibleState:Boolean(a.endTime),placement:W.Z.Placement.Right,render:()=>e.isMobile?(0,q.jsx)(L.Z,{type:"time",format:L.B.Transparent,value:p,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t}):(0,q.jsx)(L.Z,{format:L.B.Transparent,value:c,focusInitial:s===I.Hv.EndTime,onChange:this.handleInputChange,onFocus:this.handleEndInputTimeFocus,onBlur:this.handleInputBlur,onSubmit:this.handleInputSubmit,size:1,disabled:t})})]})}}renderTimeZone(){const{device:e}=this.environment,{intl:t}=this.props,s=this.getDateValue();if(("datetime"===s.type||"datetimerange"===s.type)&&s.time_zone!==(0,y.r)())return(0,q.jsx)(z.Z,{isSmall:!0,isMobile:e.isMobile,style:{marginTop:8},children:(0,d.E)(t)[s.time_zone]})}renderCalendar(){const{firstDayOfWeek:e}=this.props,t=this.getDateValueForceCurrentTimeZone(),s=h.NK(t,(0,y.r)()),i=this.stores.store.state.currentMonth||s.start,{focus:n}=this.stores.store.state;if(s.end){const t=s.start.toJSDate(),a=s.end.toJSDate(),r=n===I.Hv.StartDate||n===I.Hv.StartTime;return(0,q.jsx)(T.LazyDayPicker,{className:"notion-date-property-menu notranslate",weekStartsOn:e,numberOfMonths:1,defaultMonth:i.toJSDate(),month:i.toJSDate(),locale:o.SP,modifiers:{range:{from:t,to:a},...r?{end:a,start:t}:{start:t,end:a}},modifiersStyles:{range:Y.dayPickerRangeDayStyle,start:r?this.getDayPickerActiveDayStyle():this.getDayPickerInactiveDayStyle(),end:r?this.getDayPickerInactiveDayStyle():this.getDayPickerActiveDayStyle()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.handleDayPickerMonthChange})}{const t=s.start.toJSDate();return(0,q.jsx)(T.LazyDayPicker,{className:"notion-date-property-menu notranslate",numberOfMonths:1,weekStartsOn:e,defaultMonth:i.toJSDate(),month:i.toJSDate(),locale:o.SP,selected:[t],modifiers:{start:t},modifiersStyles:{start:this.getDayPickerActiveDayStyle()},showOutsideDays:!0,fixedWeeks:!0,onDayClick:this.handleDayPickerDayClick,onMonthSelected:this.handleDayPickerMonthChange})}}renderControls(){const{device:e}=this.environment,{shouldShowReminder:t}=this.props;return e.isMobile?(0,q.jsxs)(O.Z,{topBorder:!0,children:[t&&this.renderReminderControl(),this.renderEndDateControl(),this.renderAllDayControl()]}):(0,q.jsxs)(n.Fragment,{children:[t&&(0,q.jsx)(O.Z,{topBorder:!0,children:this.renderReminderControl()}),(0,q.jsxs)(O.Z,{topBorder:!0,children:[this.renderEndDateControl(),this.renderAllDayControl()]})]})}renderEndDateControl(){const e=this.getDateValue();return(0,q.jsx)(F.Z,{focused:!1,onClick:this.handleEndDateControlChange,title:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"End date",id:"LuxonDatePropertyMenu.menuItem.endDate.label"}),right:(0,q.jsx)(U.Z,{on:"daterange"===e.type||"datetimerange"===e.type,onClick:this.handleEndDateControlChange})})}renderAllDayControl(){const e=this.getDateValue();return(0,q.jsx)(F.Z,{focused:!1,onClick:this.handleAllDayChange,title:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Include time",id:"LuxonDatePropertyMenu.menuItem.includeTime.label"}),right:(0,q.jsx)(U.Z,{on:"date"!==e.type&&"daterange"!==e.type,onClick:this.handleAllDayChange})})}renderReminderControl(){const{device:e}=this.environment,{intl:t}=this.props,s=this.getDateValue();return(0,q.jsx)(A.ZP,{popupType:e.isMobile?A.Z4.SlideUp:A.Z4.Popup,placementToOrigin:A.pO.Right,renderOrigin:i=>(0,q.jsx)(B.Z,{...i,icon:(0,x.m)({width:14}),title:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.menuItem.remind.label"}),focused:!1,showExtensionArrow:e.isMobile,right:p({reminder:s.reminder,intl:t,formatTime:g.mr})}),render:i=>{let n;n=e.isMobile?{menuType:k.og.Modal,title:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Remind",id:"LuxonDatePropertyMenu.mobileRemindModal.title"}),right:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneReminderButton.label"}),onClickRight:i.close}:{menuType:k.og.Popup,width:250};const a=("date"===s.type||"daterange"===s.type?u.PI:u.dG).map((e=>{const s=p({reminder:e,shouldShowTime:!0,intl:t,formatTime:g.mr});return{key:s,action:t=>{this.handleChangeReminder(e),i.close()},render:(e,t)=>(0,q.jsx)(F.Z,{...e,title:s})}}));return(0,q.jsx)(N.Z,{...n,children:(0,q.jsx)(E.Z,{type:E.i.Vertical,sections:[{key:"reminder section",render:e=>(0,q.jsx)(O.Z,{...e}),items:a}],initialFocus:void 0})})}})}renderFormatPopup(){const{device:e}=this.environment;return(0,q.jsx)(A.ZP,{popupType:e.isMobile?A.Z4.SlideUp:A.Z4.Popup,placementToOrigin:A.pO.Right,renderOrigin:t=>(0,q.jsx)(F.Z,{...t,icon:(0,S.r)({width:14}),title:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Date format & timezone",id:"LuxonDatePropertyMenu.menuItem.formatAndTimezone.label"}),focused:!1,showExtensionArrow:e.isMobile}),render:t=>{let s;return s=e.isMobile?{menuType:k.og.Modal,title:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.mobileDateFormatModal.title"}),right:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Done",id:"LuxonDatePropertyMenu.mobileDoneButton.label"}),onClickRight:t.close}:{menuType:k.og.Popup,width:250},(0,q.jsx)(N.Z,{...s,children:(0,q.jsxs)(O.Z,{children:[this.renderDateFormatControl(),this.showTimeFormatControl()&&this.renderTimeFormatControl(),this.renderTimeZoneControl()]})})}})}renderDateFormatControl(){const e=this.props.dateFormat||u.sF,{intl:t}=this.props,s={menuTitle:t.formatMessage({defaultMessage:"Date format",id:"LuxonDatePropertyMenu.dateFormatDropdownButton.label"}),items:u.Zy,getKey:e=>e,selectedItem:e,onSelect:this.handleDateFormatChange,renderItem:e=>(0,q.jsx)(F.Z,{...e,title:t.formatMessage(u.fy[e.value])}),renderOrigin:s=>(0,q.jsx)(B.Z,{focused:!1,title:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Date format",id:"LuxonDatePropertyMenu.menuItem.format.label"}),right:e?t.formatMessage(u.fy[e]):(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.formatMenu.emptyButton.label"}),...s})};return(0,q.jsx)(V.Z,{...s})}renderTimeFormatControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,s=this.getTimeDisplayFormat(),{intl:i}=this.props,n=this.getSelectedTimeFormatType(),a={menuTitle:i.formatMessage({defaultMessage:"Time format",id:"LuxonDatePropertyMenu.timeFormatMenu.title"}),items:u.L7,getKey:e=>e,selectedItem:n,onSelect:this.handleTimeFormatChange,renderItem:e=>(0,q.jsx)(F.Z,{...e,title:i.formatMessage(u.Fi[e.value])}),disabled:t,renderOrigin:e=>(0,q.jsx)(B.Z,{focused:!1,title:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Time format",id:"LuxonDatePropertyMenu.menuItem.timeFormat.label"}),disabled:t,right:!t&&(s?i.formatMessage(u.Fi[n]):(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Empty",id:"LuxonDatePropertyMenu.timeFormatMenu.emptyButton.label"})),...e})};return(0,q.jsx)(V.Z,{...a})}renderTimeZoneControl(){const e=this.getDateValue(),t="date"===e.type||"daterange"===e.type,s=this.getTimeZone();return(0,q.jsx)(G.Z,{renderOrigin:e=>(0,q.jsx)(B.Z,{...e,focused:!1,title:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Timezone",id:"datePropertyMenu.menuItem.time.label"}),disabled:t,right:!t&&h.er(s)}),onSelect:e=>this.handleTimeZoneChange(e)})}renderClearButton(){return(0,q.jsx)(F.Z,{focused:!1,onClick:this.handleClearClick,title:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Clear",id:"LuxonDatePropertyMenu.clearButton.label"})})}renderRemindersHelp(){const{device:e}=this.environment;return e.isMobile?(0,q.jsx)(H.Z,{href:(0,_.UY)("guides.reminders"),analyticsFrom:"date_selector"}):(0,q.jsx)(K.Z,{title:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Learn about reminders",id:"LuxonDatePropertyMenu.learnMore.helpButton.label"}),href:(0,_.UY)("guides.reminders"),analyticsFrom:"date_selector"})}enableEndDate(e){const{dateValue:t,endDate:s,endTime:i}=e;if("datetime"===t.type){var n,a;const e={type:"datetimerange",start_date:t.start_date,start_time:t.start_time,end_date:s||t.start_date,end_time:i||t.start_time,time_zone:t.time_zone,reminder:t.reminder};null===(n=(a=this.props).onChangeValue)||void 0===n||n.call(a,e),this.stores.store.setState({...this.stores.store.state,focus:I.Hv.EndDate})}else if("date"===t.type){var o,r;const e={type:"daterange",start_date:t.start_date,end_date:s||t.start_date,reminder:t.reminder};null===(o=(r=this.props).onChangeValue)||void 0===o||o.call(r,e),this.stores.store.setState({...this.stores.store.state,focus:I.Hv.EndDate})}else(0,w.t1)(t)}getDateValue(){const{value:e}=this.props;return e&&!b.i2(e)?e:this.openTimeFormat}getDateRangeBounds(){const e=this.getDateValue();if(u.h(e)||u.qg(e)){const t=h.NK(e,(0,y.r)());return{earliestValidEnd:t.start.toFormat(h.Iq),latestValidStart:t.end.toFormat(h.Iq)}}}getDateValueForceCurrentTimeZone(){const{value:e}=this.props;return e&&!b.i2(e)?"datetime"===e.type||"datetimerange"===e.type?{...e,time_zone:(0,y.r)()}:e:this.openTimeFormat}getDateDisplayFormat(){const{dateFormat:e}=this.props;return void 0===e||"relative"===e||"ll"===e?u.oq(this.getLocale()):u.jG(e)}getTimeDisplayFormat(){const{timeFormat:e}=this.props;return e?u._F(e):u.Sc}showTimeFormatControl(){return!v.S.includes(o.SP)}getTimeZone(){const e=this.getDateValue();return"datetime"===e.type||"datetimerange"===e.type?e.time_zone:(0,y.r)()}parseInputDateValue(e){const{intl:t}=this.props;return this.environment.device.isMobile?(0,f.parseDateValueWithInputFormat)(e,h.Iq,t):(0,f.parseDateValueWithInputFormat)(e,this.getDateDisplayFormat(),t)}parseInputTimeValue(e){return(0,f.parseTimeValueWithInputFormat)(e,this.getTimeDisplayFormat(),this.props.intl)}applyValidDateState(e){var t,s;const{newDate:i,currentMonth:n,resetField:a}=e;null===(t=(s=this.props).onChangeValue)||void 0===t||t.call(s,i),this.stores.store.setState({...this.stores.store.state,currentMonth:n}),this.resetInputState(a)}resetInputState(e){const{state:t}=this.stores.store;this.stores.store.setState({...t,error:{...t.error,[t.focus]:void 0},inputTemporaryValue:{...t.inputTemporaryValue,[t.focus]:void 0}})}getInputErrorMessage(e){const{intl:t}=this.props;switch(e){case I.pd.InvalidDate:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateError.tooltip",defaultMessage:"Invalid date"});case I.pd.InvalidRange:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidDateOrTimeRangeError.tooltip",defaultMessage:"Invalid range"});case I.pd.InvalidTime:return t.formatMessage({id:"LuxonDatePropertyMenu.invalidTimeError.tooltip",defaultMessage:"Invalid time"});default:return}}getInputSeparator(){return(0,q.jsx)("div",{style:{height:14,width:1,background:this.theme.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}})}getInputWrapStyle(){return{display:"flex",alignItems:"center",borderRadius:3,height:28,lineHeight:1.2,background:this.theme.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%"}}getInputWrapInactiveStyle(){return{...this.getInputWrapStyle(),boxShadow:this.theme.inputBoxShadow,flexGrow:1}}getInputWrapErrorStyle(){return{...this.getInputWrapStyle(),boxShadow:`inset 0 0 0 2px ${l.ZP.red}`,background:l.ZP.redWithAlpha(.15),flexGrow:1}}getInputWrapActiveStyle(){return{...this.getInputWrapStyle(),boxShadow:`inset 0 0 0 2px ${l.ZP.blue}`,background:l.ZP.blueWithAlpha(.15),flexGrow:1}}getDayPickerActiveDayStyle(){return{backgroundColor:l.ZP.blue,color:l.ZP.white}}getDayPickerInactiveDayStyle(){return{backgroundColor:l.ZP.blueWithAlpha(.43)}}}function Q(e){window.__c={n:"RelativeDateShortcutsSection"};const{onChangeValue:t}=e,s=(0,c.useIntl)();return(0,q.jsx)(O.Z,{title:(0,q.jsx)(c.FormattedMessage,{defaultMessage:"Shortcuts",id:"DatePropertyMenu.menuItem.shortcuts.label"}),children:["now","today"].map((e=>(0,q.jsx)(F.Z,{title:(0,q.jsx)(Z.w,{templateVariableType:e}),caption:M.Z08(e,s),inline:!0,onClick:()=>{null==t||t(e)},focused:!1},`relative-date-shortcut-${e}`)))})}Y.displayName="DatePropertyMenu",Y.dayPickerRangeDayStyle={backgroundColor:l.ZP.blueWithAlpha(.15)};const $=(0,c.injectIntl)(Y)},92660:(e,t,s)=>{s.d(t,{Z:()=>r});s(67294);var i=s(83355),n=s(50506),a=s(53437),o=s(85893);class r extends i.Z{renderComponent(){const{render:e}=this.props,{device:t}=this.environment,s=this.props.modalStore.state;return t.isMobile?(0,o.jsx)(a.ZP,{ariaLabel:this.props.ariaLabel,open:s.open,popupType:a.ZP.PopupType.SlideUp,origin:this.props.origin,onDismiss:this.props.onDismiss,render:e,style:this.props.style}):(0,o.jsx)(n.Z,{ariaLabel:this.props.ariaLabel,open:s.open,preventHideChildrenWhileOpening:!0,render:e,onDismiss:this.props.onDismiss,style:this.props.style,innerStyle:this.props.innerStyle})}}r.displayName="DefaultPopupOrModal"},86249:(e,t,s)=>{s.d(t,{ZP:()=>$,UV:()=>Q,f4:()=>Y});s(57658);var i=s(67294),n=s(24405),a=s(56666),o=s(44495),r=s(37612),l=s(5366),d=s(97880),c=s(47307),u=s(40394),m=s(42922),p=s(52275),g=s(53695),h=s(64369),f=s(480),y=s(86628),v=s(50906),x=s(54642),S=s(33954),b=s(52507),M=s(50506),w=s(13991),j=s(82990),C=s(74194),k=s(68785),_=s(85893);const T=(0,l.defineMessages)({samlConfigSubtitle:{id:"verifyDomainModal.addNewDomain.samlConfig.subtitle",defaultMessage:"Users with a verified domain can log in {br}using SAML SSO."},integrationSubtitle:{id:"verifyDomainModal.addNewDomain.integration.subtitle",defaultMessage:"Link preview integrations must verify {br}domains before they are published."}});const I=function(e){let{handleAddNewDomain:t,loading:s,verificationType:a}=e;window.__c={n:"AddNewDomain"};const[o,r]=(0,i.useState)(""),c=!Boolean(o),u=(0,i.useCallback)((e=>{r(e.target.value)}),[]),p=(0,n.yK)((()=>({title:{fontFamily:j.Z.getCompositeFontFamily(w.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:j.Z.getCompositeFontFamily(w.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"},input:{marginTop:22,marginBottom:14},button:{width:"100%",opacity:c?.5:1}})),[c]);let g;switch(a){case"integration":g=T.integrationSubtitle;break;case"saml_config":g=T.samlConfigSubtitle;break;default:(0,d.t1)(a)}return(0,_.jsxs)(i.Fragment,{children:[(0,_.jsx)(h.Z,{style:p.title,children:(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.addNewDomain.title",defaultMessage:"Add new domain"})}),(0,_.jsx)(h.Z,{style:p.subtitle,isMultiline:!0,children:(0,_.jsx)(l.FormattedMessage,{...g,values:{br:(0,_.jsx)("br",{})}})}),(0,_.jsx)(C.Z,{value:o,style:p.input,placeholder:"notion.so",onChange:u}),(0,_.jsx)(m.Z,{onClick:()=>t(o),style:p.button,isLarge:!0,disabled:c,children:s?(0,_.jsx)(k.Z,{}):(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.addNewDomain.next",defaultMessage:"Next"})})]})};var P=s(63296);const Z=function(e){let{domain:t,isExpired:s,onClose:a}=e;window.__c={n:"InvalidDomain"};const o=(0,n.yK)((e=>({title:{fontFamily:j.Z.getCompositeFontFamily(w.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:j.Z.getCompositeFontFamily(w.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center",marginBottom:22}})),[]);return(0,_.jsxs)(i.Fragment,{children:[(0,_.jsx)(h.Z,{style:o.title,isMultiline:!0,children:(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.invalidDomain.title",defaultMessage:"Unable to verify {domain}",values:{domain:t}})}),(0,_.jsx)(h.Z,{style:o.subtitle,isMultiline:!0,children:s?(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.invalidDomain.expired",defaultMessage:"The code for this domain's verification has expired."}):(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.invalidDomain.invalid",defaultMessage:"You are unable to verify this domain because it has already been verified by another workspace."})}),(0,_.jsx)(P.Z,{onClick:a,style:{width:"100%"},children:(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.invalidDomain.okay",defaultMessage:"Okay"})})]})},F=(0,l.defineMessages)({samlConfigSubtitle:{id:"verifyDomainModal.verifiedDomain.samlConfig.subtitle",defaultMessage:"Users are able to use this email domain to{br}log in using SAML SSO."},integrationSubtitle:{id:"verifyDomainModal.verifiedDomain.integration.subtitle",defaultMessage:"This integration can unfurl URLs containing this domain."}});const A=function(e){let{domain:t,onClose:s,verificationType:a}=e;window.__c={n:"VerifyDomain"};const o=(0,n.yK)((()=>({title:{fontFamily:j.Z.getCompositeFontFamily(w.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:j.Z.getCompositeFontFamily(w.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center",marginBottom:22}})),[]);let r;switch(a){case"saml_config":r=F.samlConfigSubtitle;break;case"integration":r=F.integrationSubtitle;break;default:(0,d.t1)(a)}return(0,_.jsxs)(i.Fragment,{children:[(0,_.jsx)(h.Z,{style:o.title,isMultiline:!0,children:(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifiedDomain.title",defaultMessage:"Successfully verified {domain}",values:{domain:t}})}),(0,_.jsx)(h.Z,{style:o.subtitle,isMultiline:!0,children:(0,_.jsx)(l.FormattedMessage,{...r,values:{br:(0,_.jsx)("br",{})}})}),(0,_.jsx)(P.Z,{onClick:s,style:{width:"100%"},children:(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifiedDomain.okay",defaultMessage:"Okay"})})]})};var D=s(75553),B=s(63143),R=s(14871),L=s(16402),N=s(64921);const E=function(e){let{handleVerifyDomain:t,domainVerification:s,loading:a}=e;window.__c={n:"VerifyExistingDomain"};const o=(0,f.O7)(),r=s.expiresAt-Date.now()<2*B.U6,d=(0,n.yK)((e=>({title:{fontFamily:j.Z.getCompositeFontFamily(w.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},subtitle:{fontFamily:j.Z.getCompositeFontFamily(w.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"},list:{paddingInlineStart:22,margin:"24px 0"},listItem:{fontFamily:j.Z.getCompositeFontFamily(w.SP).sans,fontSize:14,fontWeight:400,lineHeight:"19px",marginBottom:12},expiresSoonText:{color:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500]},copyButton:{borderRadius:3,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,fontFamily:j.Z.getCompositeFontFamily(w.SP).sans,fontSize:12,fontWeight:500,lineHeight:"14px"},copyIcon:{width:16,height:16,marginRight:4,fill:e.mediumIconColor},code:{width:"100%",color:e.mediumTextColor,fontFamily:j.Z.getCompositeFontFamily(w.SP).mono,fontSize:14,fontWeight:400,lineHeight:"18px"},codeContainer:{display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`,height:32,paddingLeft:12,paddingRight:12,borderRadius:3,marginTop:4,marginBottom:8}})),[]);return(0,_.jsxs)(i.Fragment,{children:[(0,_.jsx)(h.Z,{style:d.title,children:(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.title",defaultMessage:"Verify your domain"})}),(0,_.jsx)(h.Z,{style:d.subtitle,children:(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.subtitle",defaultMessage:"Follow these steps to finalize verification."})}),(0,_.jsx)(h.Z,{isSmall:!0,style:{marginTop:22},children:(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verificationCodeLabel",defaultMessage:"Verification code"})}),(0,_.jsxs)("div",{style:d.codeContainer,children:[(0,_.jsx)(h.Z,{style:d.code,children:`notion-domain-verification=${s.verificationCode}`}),(0,_.jsxs)(N.Z,{onClick:function(){R.RD({environment:o,stringValue:`notion-domain-verification=${s.verificationCode}`,copiedMessage:R.tq.copiedLinkToClipboard})},style:d.copyButton,children:[(0,D.U)(d.copyIcon),(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.copy",defaultMessage:"Copy"})]})]}),(0,_.jsx)(h.Z,{style:r?d.expiresSoonText:void 0,isSmall:!0,children:(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verificationCodeExpiresAt",defaultMessage:"Expires on {timeLeft}",values:{timeLeft:(0,L.gs)(s.expiresAt)}})}),(0,_.jsxs)("ol",{style:d.list,children:[(0,_.jsx)("li",{style:d.listItem,children:(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsDNS",defaultMessage:"Navigate to the DNS record section of your domain host."})}),(0,_.jsx)("li",{style:d.listItem,children:(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsTXT",defaultMessage:"Create a new TXT record and paste in the code above as the value."})}),(0,_.jsx)("li",{style:d.listItem,children:(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsHangTight",defaultMessage:"Typically, this change takes only minutes to occur, however, there are cases where it may take up to 72 hours for the DNS record to propagate."})}),(0,_.jsx)("li",{style:d.listItem,children:(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.instructionsVerify",defaultMessage:'Click "Verify" to notify Notion to check your DNS record.'})})]}),(0,_.jsx)(P.Z,{style:{width:"100%"},onClick:()=>t(s),disabled:a,children:a?(0,_.jsx)(k.Z,{}):(0,_.jsx)(l.FormattedMessage,{id:"verifyDomainModal.verifyExistingDomain.verify",defaultMessage:"Verify"})})]})};const O=function(e){window.__c={n:"VerifyDomainModal"};const t=(0,f.O7)(),s=(0,l.useIntl)(),a=(0,n.Fg)(),[o,r]=(0,y.AF)(e.store,b.ZP),{verificationType:u,verificationTargetId:m,refreshDomains:p}=e,g=(0,i.useCallback)((()=>{r((e=>({...e,loading:!1,modalOpen:!1})))}),[r]),h=(0,i.useCallback)((async e=>{r((e=>({...e,loading:!0})));const i="integration"===u?{type:u,integrationId:m,domain:e}:{type:u,spaceId:m,domain:e},n=await x.createDomainVerificationCode(t,i);if("success"===n.type){p(),v.G7$(t,{type:u});const e=n.data.domainVerification,s=(0,b.Hs)(e);r((e=>({...e,domainVerification:s,loading:!1})))}else c.showErrorMessage((0,S.wf)(s,n)),r((e=>({...e,loading:!1})))}),[t,r,m,p,u,s]),w=(0,i.useCallback)((async e=>{r((e=>({...e,loading:!0})));const i=await x.verifyDomain(t,{verificationId:e.id});if(v.DoK(t,{type:u}),"success"===i.type){p(),v.aOs(t,{type:u});const s={type:"verified",domain:e.domain};r((e=>({...e,domainVerification:s,loading:!1})))}else c.showErrorMessage((0,S.wf)(s,i)),r((e=>({...e,loading:!1})))}),[t,s,r,p,u]),j=(0,i.useCallback)((()=>{if(!o.domainVerification)return(0,_.jsx)(I,{handleAddNewDomain:h,loading:o.loading,verificationType:u});switch(o.domainVerification.type){case"invalid":return(0,_.jsx)(Z,{domain:o.domainVerification.domain,isExpired:Date.now()>o.domainVerification.expiresAt,onClose:g});case"unverified":return(0,_.jsx)(E,{handleVerifyDomain:w,domainVerification:o.domainVerification,loading:o.loading});case"verified":return(0,_.jsx)(A,{domain:o.domainVerification.domain,onClose:g,verificationType:u});default:(0,d.t1)(o.domainVerification)}}),[o.domainVerification,o.loading,w,h,g,u]);return(0,_.jsx)(M.Z,{open:o.modalOpen,preventHideChildrenWhileOpening:!0,onDismiss:g,render:()=>(0,_.jsx)("div",{style:{background:a.popoverBackground,width:410,padding:24,borderRadius:3},children:j()})})};var V=s(5478);const U=[{id:"domain",headerTitle:(0,_.jsx)(l.FormattedMessage,{id:"domainVerificationTable.table.header.domain",defaultMessage:"Domain"}),renderCell:e=>(0,_.jsx)(h.Z,{children:e.domain}),widthData:{width:100},sortable:!1},{id:"status",headerTitle:(0,_.jsx)(l.FormattedMessage,{id:"domainVerificationTable.table.header.status",defaultMessage:"Status"}),renderCell:e=>(0,_.jsx)(H,{status:e.status}),widthData:{width:100},sortable:!1},{id:"actions",headerTitle:null,renderCell:e=>(0,_.jsx)(G,{onShowDetails:e.onShowDetails,onRemove:e.onRemove}),widthData:{width:20},sortable:!1}],W=(0,l.defineMessages)({verifiedSAMLWarning:{defaultMessage:"Deleting this domain will prevent others with this email from logging in using SAML SSO.",id:"domainVerificationInput.securitySAMLSettings.emailDomainsSection.removeDomain.description"},verifiedIntegrationsWarning:{defaultMessage:"Deleting this domain will prevent integrations from unfurling urls that contain this domain.",id:"domainVerificationInput.myIntegrations.emailDomainsSection.removeDomain.description"},unverifiedDomainWarning:{defaultMessage:"Deleting this domain will restart its verification process. A new verification code will be generated for this domain in the next verification attempt.",id:"domainVerificationInput.securitySAMLSettings.emailDomainsSection.removeDomain.pending.description"}}),z={fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center",marginBottom:8},K={fontSize:14,fontWeight:400,lineHeight:"19px",textAlign:"center"};function H(e){let{status:t}=e;window.__c={n:"VerificationToken"};const s=(0,n.yK)((e=>{const s={[V.YF.Success]:e.statusTokenBackground.green,[V.YF.Pending]:e.statusTokenBackground.yellow,[V.YF.Failure]:e.statusTokenBackground.red},i={[V.YF.Success]:e.statusTokenIndicator.green,[V.YF.Pending]:e.statusTokenIndicator.yellow,[V.YF.Failure]:e.statusTokenIndicator.red},n={[V.YF.Success]:e.statusTokenText.green,[V.YF.Pending]:e.statusTokenText.yellow,[V.YF.Failure]:e.statusTokenText.red};return{container:{background:s[t],color:n[t],display:"flex",justifyContent:"center",alignItems:"center",gap:6,borderRadius:18,height:20,paddingLeft:7,paddingRight:9},dot:{background:i[t],width:10,height:10,borderRadius:"100%"}}}),[t]);return(0,_.jsxs)("div",{style:s.container,children:[(0,_.jsx)("div",{style:s.dot}),q(t)]})}function G(e){let{onShowDetails:t,onRemove:s}=e;window.__c={n:"DropdownMenu"};const i=(0,n.yK)((e=>({primaryIcon:{width:14,height:14,color:e.mediumIconColor,fill:"currentColor"},menuItem:{width:250},menuIcon:{width:14,height:14,color:e.regularIconColor,fill:"currentColor"}})),[]),d=[];return t&&d.push({key:"details",action:()=>t(),render:e=>(0,_.jsx)(p.Z,{...e,style:i.menuItem,focused:!1,icon:(0,o.D)(i.menuIcon),title:(0,_.jsx)(l.FormattedMessage,{defaultMessage:"View details",id:"securitySAMLSettings.emailDomainsSection.details"}),caption:(0,_.jsx)(l.FormattedMessage,{defaultMessage:"See more information about the state of this domain verification record.",id:"securitySAMLSettings.emailDomainsSection.detailsCaption"}),shouldWrapCaption:!0})}),s&&d.push({key:"remove",action:()=>s(),render:e=>(0,_.jsx)(p.Z,{...e,style:i.menuItem,focused:!1,icon:(0,r.y)(i.menuIcon),title:(0,_.jsx)(l.FormattedMessage,{defaultMessage:"Remove domain",id:"securitySAMLSettings.emailDomainsSection.remove"}),caption:(0,_.jsx)(l.FormattedMessage,{defaultMessage:"Delete this domain verification record.",id:"securitySAMLSettings.emailDomainsSection.removeCaption"}),shouldWrapCaption:!0})}),0===d.length?null:(0,_.jsx)(g.N,{hideDropdownIcon:!0,title:(0,a.o)(i.primaryIcon),items:d})}function q(e){switch(e){case V.YF.Success:return(0,_.jsx)(l.FormattedMessage,{defaultMessage:"Verified",id:"domainVerificationInput.emailDomainsSection.statusToken.verified"});case V.YF.Pending:return(0,_.jsx)(l.FormattedMessage,{defaultMessage:"Pending",id:"domainVerificationInput.emailDomainsSection.statusToken.pending"});case V.YF.Failure:return(0,_.jsx)(l.FormattedMessage,{defaultMessage:"Failed",id:"domainVerificationInput.emailDomainsSection.statusToken.failed"});default:(0,d.t1)(e)}}function Y(e){return{domain:e,status:V.YF.Success,data:{type:"verified",domain:e}}}function Q(e){return Date.now()>e.expiresAt||Boolean(e.invalidatedAt)?{domain:e.domain,status:V.YF.Failure,data:{type:"invalid",id:e.id,domain:e.domain,verificationCode:e.verificationCode,createdAt:e.createdAt,expiresAt:e.expiresAt,invalidatedAt:e.invalidatedAt}}:{domain:e.domain,status:V.YF.Pending,data:{type:"unverified",id:e.id,domain:e.domain,verificationCode:e.verificationCode,createdAt:e.createdAt,expiresAt:e.expiresAt,invalidatedAt:e.invalidatedAt}}}const $=function(e){window.__c={n:"DomainVerificationTable"};const{disabled:t,domains:s,domainVerificationStore:a,verificationType:o,verificationTargetId:r,refreshDomains:p,onRemoveDomain:g,onClickAddDomain:f,renderOverrideAddDomainButton:y}=e,v=(0,n.yK)((e=>(0,u.b)({columnRenderInfo:U,theme:e,containerMarginTop:0})),[]);function x(){t||(f&&f(),a.setState({domainVerification:void 0,loading:!1,modalOpen:!0}))}const S=s.map((e=>{let{domain:s,status:i,data:n}=e;return{id:"verified"===n.type?s:n.id,isClickable:!1,domain:s,status:i,onShowDetails:t?void 0:()=>function(e){t||a.setState({domainVerification:e,loading:!1,modalOpen:!0})}(n),onRemove:t?void 0:()=>async function(e,t){let s;if(t===V.YF.Failure)return void g(e);t===V.YF.Pending?s=W.unverifiedDomainWarning:t===V.YF.Success?s="saml_config"===o?W.verifiedSAMLWarning:W.verifiedIntegrationsWarning:(0,d.t1)(t),await c.confirmUserAction({message:(0,_.jsx)("div",{style:z,children:(0,_.jsx)(l.FormattedMessage,{defaultMessage:"Are you sure you want to delete this domain?",id:"domainVerificationInput.emailDomainsSection.removeDomain.message"})}),description:(0,_.jsx)("div",{style:K,children:(0,_.jsx)(l.FormattedMessage,{...s})}),acceptLabel:(0,_.jsx)(l.FormattedMessage,{id:"domainVerificationInput.emailDomainsSection.removeDomain.accept",defaultMessage:"Delete domain"}),cancelLabel:(0,_.jsx)(l.FormattedMessage,{id:"domainVerificationInput.emailDomainsSection.removeDomain.cancel",defaultMessage:"Cancel"})})&&g(e)}(n,i)}}));return(0,_.jsxs)(i.Fragment,{children:[y?y(x):(0,_.jsx)(m.Z,{isLarge:!0,disabled:t,onClick:x,style:{margin:"4px 0px 16px",width:"fit-content"},children:(0,_.jsx)(l.FormattedMessage,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain"})}),(0,_.jsx)(u.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:U,rows:S,styles:v,renderNoRowsComponent:()=>(0,_.jsx)(h.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,_.jsx)(l.FormattedMessage,{id:"securitySAMLSettings.emailDomainsSection.emptyTable",defaultMessage:"No domains configured."})})}),(0,_.jsx)(O,{store:a,verificationTargetId:r,verificationType:o,refreshDomains:p})]})}},36507:(e,t,s)=>{s.d(t,{Z:()=>c});s(67294);var i=s(83355),n=s(82990),a=s(87279),o=s(75024),r=s(28992),l=s(85893);class d extends i.Z{constructor(){super(...arguments),this.styles={menuItem:{minHeight:void 0,...this.environment.device.isMobile&&{background:void 0,boxShadow:void 0},paddingTop:32,paddingBottom:32},text:{textAlign:"center"},title:{margin:0,fontWeight:n.Z.fontWeight.medium,fontSize:o.yv(this.environment,"UIRegular"),lineHeight:o.Dp(this.environment,"UIRegular")},caption:{fontSize:o.yv(this.environment,"UIRegular")}}}renderComponent(){const{style:e,captionStyle:t,...s}=this.props,i={...this.styles.menuItem,...e},n={...this.styles.caption,...t};return(0,l.jsx)(r.Z,{...s,title:this.renderTitle(),caption:this.renderCaption(n),textWrapperStyle:this.styles.text,style:i,captionStyle:n})}renderTitle(){const{title:e}=this.props;if(!e)return;const t=this.styles,s=this.getThemeColors(),i={...t.title,...s.title};return(0,l.jsx)("h4",{role:"alert",style:i,children:e})}renderCaption(e){const{caption:t}=this.props;if(!t)return;const s={...e,...this.getThemeColors().caption};return(0,l.jsx)("div",{style:s,children:t})}getThemeColors(){return{title:{color:this.theme.mediumTextColor},caption:{color:this.theme.lightTextColor}}}}d.displayName="ErrorMenuItem",d.contextTypes={...a.mw,...i.w};const c=d},1176:(e,t,s)=>{s.r(t),s.d(t,{default:()=>G});var i=s(67294),n=s(83355),a=s(41892),o=s(43593),r=s(72126),l=s(32056),d=s(23867),c=s(75246),u=s(5366),m=s(61652),p=s(1865),g=s(77080);var h=s(33929),f=s(87279),y=s(98742),v=s(61766),x=s(88632),S=s(71071),b=s(42922),M=s(52275),w=s(1743),j=s(74194),C=s(78140),k=s(32163),_=s(89728),T=s(72495),I=s(7931),P=s(24006),Z=s(87968),F=s(33411),A=s(26388),D=s(64369),B=s(92660),R=s(6202),L=s(60442),N=s(42115),E=s(85893);const O=["pdf","html","markdown"],V=["currentView","all"],U=e=>e>.1&&e<2,W=["everything","no_files"],z=(0,u.defineMessages)({dialogLabel:{id:"exportModal.dialogLabel",defaultMessage:"Export"}});class K extends n.Z{constructor(){super(...arguments),this.storeTypes={includeContentsPopupStore:v.Z,exportTypePopupStore:v.Z,pdfFormatPopupStore:v.Z,collectionViewExportTypePopupStore:v.Z},this.renderMenu=()=>{const{device:e}=this.environment;if(!x.Z.state.online)return this.renderOffline();const t=S.ZP.state;return t.open&&e.isMobile?this.renderMobileModal(t):t.open?this.renderDesktopModal(t):void 0},this.handleSelectExportType=(e,t)=>{const s=S.ZP.state;if(!s.open)return;const{exportOptions:i}=s;if(e===i.exportType)return;let n;n="pdf"===e?{...i,exportType:"pdf",pdfFormat:m.GI(t)}:{...i,exportType:e},m.BO(this.environment,{...s,exportOptions:n})},this.handleSelectPaperFormat=e=>{const t=S.ZP.state;t.open&&S.Sw(t)&&m.BO(this.environment,{...t,exportOptions:{...t.exportOptions,pdfFormat:e}})},this.handleSelectIncludeContents=e=>{const t=S.ZP.state;t.open&&m.BO(this.environment,{...t,exportOptions:{...t.exportOptions,includeContents:e}})},this.handleSelectCollectionExportType=e=>{const t=S.ZP.state;t.open&&m.BO(this.environment,{...t,exportOptions:{...t.exportOptions,collectionViewExportType:e}})},this.handleToggleFlattenExportFiletree=()=>{const e=S.ZP.state;e.open&&m.BO(this.environment,{...e,exportOptions:{...e.exportOptions,flattenExportFiletree:!e.exportOptions.flattenExportFiletree}})},this.handleToggleRecursive=()=>{const e=S.ZP.state;if(e.open){if(S.Sw(e)&&!m.y1(this.environment))return p.y(this.environment,{from:"export_modal",for:"enterprise"}),void this.handleUpgrade();m.BO(this.environment,{...e,recursive:!e.recursive})}},this.handleSetScalePercent=e=>{const t=S.ZP.state;t.open&&S.Sw(t)&&m.BO(this.environment,{...t,exportOptions:{...t.exportOptions,scale:e}})},this.handleCancel=()=>{m.Qr()},this.handleSubmit=()=>{if(!this.canSubmit())return;const e=S.ZP.state;e.open&&(m.Qr(),e.root.table===c.bx?m.AW(this.environment,{spaceId:e.root.id,exportOptions:e.exportOptions}):m.ZO(this.environment,{block:{id:e.root.id,spaceId:(0,d.C)(e.root.spaceId)},recursive:e.recursive,exportOptions:e.exportOptions}))},this.handleUpgrade=()=>{m.Qr()}}renderComponent(){return(0,E.jsx)(B.Z,{ariaLabel:h.default.formatMessage(z.dialogLabel),onDismiss:this.handleCancel,render:this.renderMenu,requireOnline:!0,modalStore:S.ZP})}renderOffline(){return(0,E.jsx)("div",{style:this.getOfflineStyle(),children:(0,E.jsx)(u.FormattedMessage,{defaultMessage:"Please go online to export.",id:"exportModal.offlineMessage.description"})})}renderMobileModal(e){const t={menuType:f.og.Modal,title:(0,E.jsx)(u.FormattedMessage,{id:"exportModal.title",defaultMessage:"Export"}),right:(0,E.jsx)(u.FormattedMessage,{id:"exportModal.closeButton.label",defaultMessage:"Close"}),onClickRight:this.handleCancel};return(0,E.jsx)(C.Z,{...t,children:(0,E.jsx)(k.Z,{type:k.i.Vertical,initialFocus:void 0,sections:[{key:"exportOptions",render:e=>(0,E.jsx)(T.Z,{...e}),items:this.getMobileExportOptionsMenuItems(e)},{key:"actions",render:e=>{let{children:t,...s}=e;return(0,E.jsx)(T.Z,{isSubmitButton:!0,...s,children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...s}=e;return(0,E.jsx)(R.Z,{...s,onClick:t||this.handleSubmit,disabled:!this.canSubmit(),title:(0,E.jsx)(u.FormattedMessage,{id:"exportModal.exportButton.label",defaultMessage:"Export"})})},action:this.handleSubmit}]}]})})}renderDesktopModal(e){const{device:t,currentUser:s}=this.environment,i=S.Sw(e)&&!m.y1(this.environment)&&"business",n=this.environment.device.isWindows;return(0,E.jsxs)("div",{style:this.getModalWrapStyle(),children:[(0,E.jsx)(I.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:(0,E.jsx)(u.FormattedMessage,{id:"exportModal.exportFormat.description",defaultMessage:"Export format"}),selectedTitle:this.getBlockExportTypeTitle(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>(0,E.jsx)(T.Z,{...e}),items:O.map((t=>this.getBlockExportTypeMenuListItem(t,e,s.id)))}]}),e.exportOptions.collectionViewExportType&&(0,E.jsx)(I.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.collectionViewExportTypePopupStore,label:(0,E.jsx)(u.FormattedMessage,{id:"exportModal.includeDatabases.description",defaultMessage:"Include databases"}),selectedTitle:this.getCollectionViewExportTypeTitle(e.exportOptions.collectionViewExportType||"currentView"),renderMenuSections:e=>[{key:"exportCollection",render:e=>(0,E.jsx)(T.Z,{...e}),items:V.map((t=>this.getCollectionViewExportTypeMenuListItem(t,e)))}]}),(0,E.jsx)(I.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.includeContentsPopupStore,label:(0,E.jsx)(u.FormattedMessage,{id:"exportModal.includeContents.description",defaultMessage:"Include content"}),selectedTitle:this.getBlockIncludeContentsTitle(e.exportOptions.includeContents||"everything"),renderMenuSections:e=>[{key:"includeContents",render:e=>(0,E.jsx)(T.Z,{...e}),items:W.map((t=>this.getIncludeContentsMenuListItem(t,e)))}]}),S.Sw(e)&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(I.Z,{isMenuItem:t.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:(0,E.jsx)(u.FormattedMessage,{id:"exportModal.pageFormat.description",defaultMessage:"Page format"}),selectedTitle:this.getPDFFormatTitle(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>(0,E.jsx)(T.Z,{...e}),items:o.lJ.map((t=>this.getPaperFormatMenuListItem(t,e)))},{key:"otherPaperFormats",render:e=>(0,E.jsx)(T.Z,{topBorder:!0,...e}),items:o.bY.map((t=>this.getPaperFormatMenuListItem(t,e)))}]}),this.renderScalePercent()]}),"space"!==e.root.table&&(0,E.jsx)(N.Z,{requireUpgradeToTier:i,analyticsName:"export_modal",onClick:this.handleToggleRecursive,render:(t,s)=>(0,E.jsxs)("div",{...t,style:{display:"flex",alignItems:"center",height:32},children:[(0,E.jsxs)("div",{style:{display:"flex",alignItems:"center",marginRight:"auto",color:this.theme.lightTextColor,fontSize:14},children:[(0,E.jsx)(u.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",s&&(0,E.jsx)("div",{style:{marginLeft:8},children:s})]}),(0,E.jsx)(P.Z,{on:e.recursive,disabled:Boolean(i)})]}),renderUpgradeTooltip:()=>(0,E.jsx)(L.Z,{imageURL:a.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,E.jsx)(u.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:(0,E.jsx)(u.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:A.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2},onUpgradeClick:this.handleUpgrade}),(0,E.jsx)(Z.Z,{title:(0,E.jsx)(u.FormattedMessage,{id:"exportModal.flattenExportFiletree.description",defaultMessage:"Create folders for subpages"}),subtitle:"",style:{color:this.theme.lightTextColor,fontSize:14,display:"flex",alignItems:"center",marginRight:"auto",height:32},on:void 0===e.exportOptions.flattenExportFiletree?!n:!e.exportOptions.flattenExportFiletree,disabled:!e.recursive,onChange:()=>this.handleToggleFlattenExportFiletree()}),(0,E.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:16},children:[(0,E.jsx)(_.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleCancel,children:(0,E.jsx)(u.FormattedMessage,{defaultMessage:"Cancel",id:"exportModal.cancelButton.label"})}),(0,E.jsx)(b.Z,{onClick:this.handleSubmit,disabled:!this.canSubmit(),children:(0,E.jsx)(u.FormattedMessage,{defaultMessage:"Export",id:"exportModal.exportButton.label"})})]})]})}renderScalePercent(){const e=this.getScalePercent();return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",height:32},children:[(0,E.jsx)(D.Z,{style:{color:this.theme.lightTextColor},children:(0,E.jsx)(u.FormattedMessage,{id:"exportModal.pageScale.description",defaultMessage:"Scale percent"})}),(0,E.jsx)(H,{value:e,onChange:this.handleSetScalePercent})]}),!U(e)&&(0,E.jsx)(F.Z,{show:!0,showDelay:500,showHold:100,render:e=>e&&(0,E.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:32,padding:"4px 0"},children:(0,E.jsx)(D.Z,{isSmall:!0,isMultiline:!0,style:{color:this.theme.errorText},children:(0,E.jsx)(u.FormattedMessage,{id:"exportModal.pageScale.invalidScaleError",defaultMessage:"Scale percent must be a number between 10 and 200"})})})})]})}getMobileExportOptionsMenuItems(e){const{currentUser:t,device:s}=this.environment;return r.oA([{key:"export type",render:i=>(0,E.jsx)(I.Z,{...i,isMenuItem:s.isMobile,buttonPopupStore:this.stores.exportTypePopupStore,label:(0,E.jsx)(u.FormattedMessage,{defaultMessage:"Export format",id:"exportModal.exportFormat.description"}),selectedTitle:this.getBlockExportTypeTitle(e.exportOptions.exportType),renderMenuSections:e=>[{key:"exportType",render:e=>(0,E.jsx)(T.Z,{...e}),items:O.map((s=>this.getBlockExportTypeMenuListItem(s,e,t.id)))}]}),action:()=>{this.stores.exportTypePopupStore.setState({open:!0})}},S.Sw(e)&&{key:"pdf format",render:t=>(0,E.jsx)(I.Z,{...t,isMenuItem:s.isMobile,buttonPopupStore:this.stores.pdfFormatPopupStore,label:(0,E.jsx)(u.FormattedMessage,{defaultMessage:"Page format",id:"exportModal.pageFormat.description"}),selectedTitle:this.getPDFFormatTitle(e.exportOptions.pdfFormat),renderMenuSections:e=>[{key:"isoPaperFormats",render:e=>(0,E.jsx)(T.Z,{...e}),items:o.lJ.map((t=>this.getPaperFormatMenuListItem(t,e)))},{key:"otherPaperFormats",render:e=>(0,E.jsx)(T.Z,{topBorder:!0,...e}),items:o.bY.map((t=>this.getPaperFormatMenuListItem(t,e)))}]}),action:()=>{this.stores.pdfFormatPopupStore.setState({open:!0})}},"space"!==e.root.table&&{key:"recursive",render:t=>{let{onClick:s,key:i,...n}=t;const o=S.Sw(e)&&!m.y1(this.environment)&&"business";return(0,E.jsx)(N.Z,{requireUpgradeToTier:o,analyticsName:"export_modal",onClick:s,render:(t,s)=>{const i=(0,y.Z)(n,t);return(0,E.jsx)(M.Z,{...i,title:(0,E.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,E.jsx)(u.FormattedMessage,{defaultMessage:"Include subpages",id:"exportModal.includeSubpages.label"})," ",s&&(0,E.jsx)("div",{style:{marginLeft:8},children:s})]}),right:(0,E.jsx)(P.Z,{...i,on:e.recursive,disabled:Boolean(o)})})},renderUpgradeTooltip:()=>(0,E.jsx)(L.Z,{imageURL:a.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,E.jsx)(u.FormattedMessage,{defaultMessage:"Upgrade to include subpages in PDF exports",id:"exportModal.pdfSubpageUpgradeTooltip.title"}),caption:(0,E.jsx)(u.FormattedMessage,{defaultMessage:"Creates a zip file containing all the pages nested inside the current page as PDF files.",id:"exportModal.pdfSubpageUpgradeTooltip.caption"})}),tooltipPlacement:A.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2},onUpgradeClick:this.handleUpgrade},i)},action:this.handleToggleRecursive}])}getBlockExportTypeTitle(e){switch(e){case"pdf":return(0,E.jsx)(u.FormattedMessage,{id:"exportModal.exportFormatButton.pdf.label",defaultMessage:"PDF"});case"markdown":return(0,E.jsx)(u.FormattedMessage,{id:"exportModal.exportFormatButton.markdownAndCSV.label",defaultMessage:"Markdown & CSV"});case"html":return(0,E.jsx)(u.FormattedMessage,{id:"exportModal.exportFormatButton.html.label",defaultMessage:"HTML"})}}getBlockIncludeContentsTitle(e){switch(e){case"everything":return(0,E.jsx)(u.FormattedMessage,{id:"exportModal.includeContentTypes.everything.label",defaultMessage:"Everything"});case"no_files":return(0,E.jsx)(u.FormattedMessage,{id:"exportModal.includeContentTypes.no_files.label",defaultMessage:"No files or images"})}}getCollectionViewExportTypeTitle(e){switch(e){case"all":return g.default.checkGate("export_collections_v1")?(0,E.jsx)(u.FormattedMessage,{id:"exportModal.includeDatabases.all.label.defaultView",defaultMessage:"Default View"}):(0,E.jsx)(u.FormattedMessage,{id:"exportModal.includeDatabases.all.label.everything",defaultMessage:"Everything"});case"currentView":return(0,E.jsx)(u.FormattedMessage,{id:"exportModal.includeDatabases.currentView.label",defaultMessage:"Current view"})}}getPDFFormatTitle(e){switch(e){case"Letter":return(0,E.jsx)(u.FormattedMessage,{id:"exportModal.pageFormatButton.letter.label",defaultMessage:"Letter"});case"A3":return(0,E.jsx)(u.FormattedMessage,{id:"exportModal.pageFormatButton.a3.label",defaultMessage:"A3"});case"A4":return(0,E.jsx)(u.FormattedMessage,{id:"exportModal.pageFormatButton.a4.label",defaultMessage:"A4"});case"Legal":return(0,E.jsx)(u.FormattedMessage,{id:"exportModal.pageFormatButton.legal.label",defaultMessage:"Legal"});case"Tabloid":return(0,E.jsx)(u.FormattedMessage,{id:"exportModal.pageFormatButton.tabloid.label",defaultMessage:"Tabloid"})}}getBlockExportTypeMenuListItem(e,t,s){const i=S.ZP.state,n=i.open&&"pdf"===e&&"space"===i.root.table&&!m.y1(this.environment)&&"business";return{key:e,action:()=>{if(t.close(),n)return p.y(this.environment,{from:"export_modal",for:n}),void this.handleUpgrade();this.handleSelectExportType(e,s)},render:s=>{let{onClick:i,key:o,...r}=s;return(0,E.jsx)(N.Z,{requireUpgradeToTier:n,analyticsName:"export_modal",onClick:i,onUpgradeClick:()=>{t.close(),this.handleUpgrade()},render:(t,s)=>(0,E.jsx)(M.Z,{...(0,y.Z)(r,t),title:this.getBlockExportTypeTitle(e),right:s}),renderUpgradeTooltip:()=>(0,E.jsx)(L.Z,{imageURL:a.Z.images.tooltips.upsells.exportPdfSubpagesPng,imageWidth:240,imageHeight:100,title:(0,E.jsx)(u.FormattedMessage,{defaultMessage:"Upgrade to export the workspace as PDFs",id:"exportModal.workspacePdfUpgradeTooltip.title"}),caption:(0,E.jsx)(u.FormattedMessage,{defaultMessage:"Creates a zip file containing all pages in the workspace as PDF files.",id:"exportModal.workspacePdfUpgradeTooltip.caption"})}),tooltipPlacement:A.Z.Placement.Left,upgradeButtonDesktopStyle:{marginTop:2}},o)}}}getIncludeContentsMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectIncludeContents(e)},render:t=>(0,E.jsx)(M.Z,{...t,title:this.getBlockIncludeContentsTitle(e)})}}getCollectionViewExportTypeMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectCollectionExportType(e)},render:t=>(0,E.jsx)(M.Z,{...t,title:this.getCollectionViewExportTypeTitle(e)})}}getPaperFormatMenuListItem(e,t){return{key:e,action:()=>{t.close(),this.handleSelectPaperFormat(e)},render:t=>(0,E.jsx)(M.Z,{...t,title:this.getPDFFormatTitle(e)})}}getScalePercent(){const e=S.ZP.state;return e.open&&S.Sw(e)?void 0===e.exportOptions.scale?1:e.exportOptions.scale:1}canSubmit(){return U(this.getScalePercent())}getModalWrapStyle(){return{width:320,padding:24,fontSize:14}}getOfflineStyle(){return{...this.getModalWrapStyle(),color:this.theme.mediumTextColor}}}function H(e){let{value:t,onChange:s}=e;window.__c={n:"PercentInput"};const n=(0,u.useIntl)(),a=i.useCallback((e=>{const t=e.target.value,i=(0,l._g)(t)||(0,l.p3)(t);let n;"object"==typeof i?n="percent"===i.format?i.value:i.value/100:"number"==typeof i&&(n=i/100),void 0!==n&&s(n)}),[s]),[o,r]=i.useState(!1),d=i.useMemo((()=>(0,l.uf)(Math.round(100*t),"number",n)),[t,n]);return(0,E.jsx)(w.Z,{capture:o,children:(0,E.jsx)(j.Z,{value:d,onChange:a,onFocus:()=>r(!0),onBlur:()=>r(!1),style:{width:60},inputStyle:{textAlign:"right"}})})}K.displayName="ExportModal";const G=K},16972:(e,t,s)=>{s.d(t,{Z:()=>H});var i=s(67294),n=s(73935),a=s(83355),o=s(72126),r=s(5366),l=s(47307),d=s(27153),c=s(53471),u=s(33929),m=s(87279),p=s(83279),g=s(13401),h=s(79131),f=s(1743),y=s(78140),v=s(40721),x=s(72495),S=(s(57658),s(95538)),b=s(43593),M=s(50066),w=s(50906),j=s(54604),C=s(34602),k=s(95477),_=s(49085);class T extends _.default{getInitialState(){return{open:!1}}}const I=T;var P=s(24736),Z=s(52275),F=s(31945),A=s(74194),D=s(32163),B=s(53437),R=s(81865),L=s(85893);class N extends a.Z{constructor(){super(...arguments),this.storeTypes={filePropertyMenuItemStore:I},this.imageNode=void 0,this.renderRenameMenu=()=>{const{device:e}=this.environment,t=this.stores.filePropertyMenuItemStore.state;if(!t.open)return;let s;return s=e.isMobile?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:380},(0,L.jsx)(y.Z,{...s,children:(0,L.jsx)("div",{style:this.getInputWrapStyle(),children:(0,L.jsx)(A.Z,{style:this.getInputStyle(),value:t.inputValue,placeholder:b.w2(this.props.url),onChange:this.handleRenameInputChange,onSubmit:this.handleCloseRename,focusInitial:!0,selectAll:!0})})})},this.handleFullScreen=()=>{j.ui({environment:this.environment,renderFullScreenNode:()=>(0,L.jsx)(R.Z,{url:this.props.url,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:300,render:(e,t)=>(0,L.jsx)("img",{src:t,style:{position:"relative",maxHeight:"100%",maxWidth:"100%",margin:0,alignSelf:"center",width:"100%"}})}),fullScreenNodeRect:this.imageNode.getBoundingClientRect(),block:this.props.store,imageUrl:this.props.url})},this.handleRename=()=>{this.stores.filePropertyMenuItemStore.setState({open:!0,inputValue:this.props.name})},this.handleCloseRename=()=>{this.stores.filePropertyMenuItemStore.setState({open:!1})},this.handleRenameInputChange=e=>{const t=this.stores.filePropertyMenuItemStore.state;if(!t.open)return;const s=e.target.value;this.stores.filePropertyMenuItemStore.setState({...t,inputValue:s});const i=b.rF({title:s,source:this.props.url});this.props.onChange({url:this.props.url,name:i})},this.handleViewOriginal=()=>{const{url:e,name:t}=this.props;C.openFileUrl(this.environment,{url:e,type:"file",from:"view_original",downloadName:t,permissionRecord:this.props.store.pointer})},this.handleDownload=()=>{const{url:e,name:t}=this.props;w.Uk(this.environment,{url:e,fileName:t,from:"FilePropertyMenuItem"}),C.downloadFileUrl(this.environment,{url:e,download:!0,downloadName:t,permissionRecord:this.props.store.pointer})},this.handleDelete=()=>{this.props.onDelete(this.props.url)}}renderComponent(){const{url:e}=this.props;return S.SR({url:e})?this.renderImage(e):this.renderFile()}renderImage(e){const{device:t}=this.environment,{disabled:s}=this.props;return(0,L.jsx)(Z.Z,{focused:!1,showDragHandle:!s&&!t.isMobile,style:{paddingTop:t.isMobile?12:8,paddingBottom:t.isMobile?12:8,alignItems:"flex-start"},title:(0,L.jsx)(R.Z,{url:e,isAuthenticated:!0,permissionRecord:this.props.store.pointer,width:300,render:(e,t)=>(0,L.jsx)("div",{style:N.innerStyle,children:(0,L.jsx)("img",{src:t,style:N.imageStyle,onClick:this.handleFullScreen,ref:e=>this.imageNode=e})})}),right:this.renderActionMenu(!0),dontShrinkRight:!0})}renderFile(){const{device:e}=this.environment,{disabled:t}=this.props,{name:s}=this.props;return(0,L.jsx)(B.GI,{open:this.stores.filePropertyMenuItemStore.state.open,popupType:e.isMobile?F.Z4.SlideUp:F.Z4.Popup,origin:(0,L.jsx)(Z.Z,{focused:!1,showDragHandle:!t&&!e.isMobile,onClick:this.handleViewOriginal,title:s,icon:(0,L.jsx)("div",{style:{width:e.isMobile?16:14},children:(0,M.R)()}),right:this.renderActionMenu(!1),dontShrinkRight:!0}),render:this.renderRenameMenu,onDismiss:this.handleCloseRename})}getActionMenuItems(e){const{device:t}=this.environment,{url:s,disabled:i}=this.props,n=[];return e&&n.push({key:"fullscreen",render:e=>(0,L.jsx)(Z.Z,{...e,title:(0,L.jsx)(r.FormattedMessage,{defaultMessage:"Full screen",id:"database.actionMenu.fileProperty.fullscreen.title"})}),action:this.handleFullScreen}),(b.E$(s,[k.default.secureFileS3.url,k.default.secureFileS3V2.url])||t.isNative)&&n.push({key:"download",render:e=>(0,L.jsx)(Z.Z,{...e,title:(0,L.jsx)(r.FormattedMessage,{defaultMessage:"Download",id:"database.actionMenu.fileProperty.download.title"})}),action:this.handleDownload}),n.push({key:"original",render:e=>(0,L.jsx)(Z.Z,{...e,title:(0,L.jsx)(r.FormattedMessage,{defaultMessage:"View original",id:"database.actionMenu.fileProperty.viewOriginal.title"})}),action:this.handleViewOriginal}),i||e||n.push({key:"rename",render:e=>(0,L.jsx)(Z.Z,{...e,title:(0,L.jsx)(r.FormattedMessage,{defaultMessage:"Rename",id:"database.actionMenu.fileProperty.rename.title"})}),action:this.handleRename}),i||n.push({key:"delete",render:e=>(0,L.jsx)(Z.Z,{...e,title:(0,L.jsx)(r.FormattedMessage,{defaultMessage:"Delete",id:"database.actionMenu.fileProperty.delete.title"})}),action:this.handleDelete}),n}renderActionMenu(e){const{device:t}=this.environment;return(0,L.jsx)(F.ZP,{popupType:t.isMobile?F.Z4.SlideUp:F.Z4.Popup,renderOrigin:e=>(0,L.jsx)(P.Z,{isMobile:t.isMobile,...e}),render:s=>{let i;return i=t.isMobile?{menuType:m.og.ActionSheet}:{menuType:m.og.Popup,width:200},(0,L.jsx)(y.Z,{...i,children:(0,L.jsx)(D.Z,{type:D.i.Vertical,initialFocus:0,onAccept:s.close,sections:[{key:"section",render:e=>(0,L.jsx)(x.Z,{...e}),items:this.getActionMenuItems(e)}]})})}})}getInputWrapStyle(){return{display:"flex",alignItems:"center",color:this.theme.regularTextColor,fontSize:"13px",padding:"4px 8px"}}getInputStyle(){return{display:"flex",alignItems:"center",flexGrow:1,fontSize:14,lineHeight:"20px",paddingTop:4,paddingBottom:4,paddingLeft:10,paddingRight:10,width:"100%",borderRadius:3,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,cursor:"text",position:"relative"}}}N.displayName="FilePropertyMenuItem",N.imageStyle={display:"block",maxWidth:"100%",maxHeight:180,cursor:"zoom-in"},N.innerStyle={flex:"auto",overflow:"hidden"};const E=N;var O=s(68785),V=s(28992),U=s(32854);class W extends a.Z{renderComponent(){return(0,L.jsx)(V.Z,{title:(0,L.jsxs)("div",{style:{display:"flex"},children:[(0,L.jsx)(O.Z,{style:{marginTop:1,marginRight:6}}),(0,L.jsx)(U.Z,{percentage:this.props.progressPercent})]})})}}W.displayName="ProgressMenuItem";const z=W;class K extends a.Z{constructor(){super(...arguments),this.uploadingFiles=void 0,this.storeTypes={fileUploadStore:p.Z},this.renderFile=e=>{const{device:t}=this.environment,{value:s,disabled:i}=this.props,n=s.find((t=>t.url===e));if(n){const e=n.url,s=n.name;return t.isMobile?(0,L.jsx)(x.Z,{children:(0,L.jsx)(E,{store:this.props.store,name:s,url:e,onDelete:this.handleFileDelete,onChange:this.handleFileChange,disabled:i})},e):(0,L.jsx)(E,{store:this.props.store,name:s,url:e,onDelete:this.handleFileDelete,onChange:this.handleFileChange,disabled:i},e)}},this.handleAddFileMount=e=>{e&&(this.addFileButton=e)},this.handleAddFileClick=e=>{this.showMediaPicker()},this.handleDraggableDrop=e=>{const{onChange:t,value:s}=this.props;t({value:o.MR(s,(t=>{const s=t.url;return s?e.indexOf(s):1/0}))})},this.handleMediaPickerUploadStart=e=>{d.Z(),this.stores.fileUploadStore.setState({isLoading:!0,progressPercent:0}),this.uploadingFiles=[e]},this.handleMediaPickerUploadComplete=e=>{const{value:t,onChange:s}=this.props;if(!this.uploadingFiles)return;const i=this.uploadingFiles[0];if(!i)return;s({value:[...t,{name:i.name||e,url:e}]}),this.stores.fileUploadStore.reset(),d.Z()},this.handleMediaPickerEmbedComplete=e=>{const{value:t,onChange:s}=this.props;s({value:[...t,{name:e,url:e}]}),this.stores.fileUploadStore.reset(),d.Z()},this.handleUploadFilesStart=e=>{this.stores.fileUploadStore.setState({isLoading:!0,progressPercent:0}),this.uploadingFiles=e},this.handleUploadFilesComplete=e=>{const{value:t,onChange:s}=this.props;if(!this.uploadingFiles)return;s({value:[...this.uploadingFiles.map(((t,s)=>{const i=e[s];return{name:t.name||i,url:i}})),...t]}),this.stores.fileUploadStore.reset()},this.handleUploadProgress=e=>{const{progressPercent:t}=e;this.stores.fileUploadStore.setState({...this.stores.fileUploadStore.state,progressPercent:t})},this.handleUploadError=()=>{this.stores.fileUploadStore.reset(),l.showErrorMessage((0,L.jsx)(r.FormattedMessage,{id:"filePropertyMenu.uploadFileFailedError.message",defaultMessage:"Upload failed."}))},this.handleFileChange=e=>{const{value:t,onChange:s}=this.props;s({value:t.map((t=>t.url===e.url?{name:e.name,url:e.url}:t))})},this.handleFileDelete=e=>{const{value:t,onChange:s}=this.props;s({value:t.filter((t=>t.url!==e))})}}didMount(){const{device:e}=this.environment,{uploadFiles:t,store:s}=this.props;t?c.IL({environment:this.environment,files:t,bucket:"secure",record:s.pointer,onBatchStart:this.handleUploadFilesStart,onBatchProgress:this.handleUploadProgress,onBatchComplete:this.handleUploadFilesComplete,onBatchError:this.handleUploadError}):this.isEmpty()&&!e.isMobile&&this.showMediaPicker()}willUnmount(){d.Z()}renderComponent(){const{device:e}=this.environment,{disabled:t}=this.props,s=this.isEmpty(),{isLoading:i,progressPercent:n}=this.stores.fileUploadStore.state;let a;return a=e.isMobile?{menuType:m.og.Modal,title:(0,L.jsx)(r.FormattedMessage,{defaultMessage:"File property",id:"database.fileProperty.mobileMenu.title"}),right:(0,L.jsx)(v.DoneMenuText,{}),onClickRight:this.props.onDismiss}:{menuType:m.og.Popup},(0,L.jsx)(f.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!0,children:(0,L.jsxs)(y.Z,{...a,children:[this.renderFiles(),(0,L.jsxs)(x.Z,{topBorder:!s&&!t,desktopStyle:{...s&&{paddingTop:3,paddingBottom:3}},children:[i&&(0,L.jsx)(z,{progressPercent:n}),!i&&!t&&(0,L.jsx)(g.Z,{focused:!1,onClick:this.handleAddFileClick,title:(0,L.jsx)(r.FormattedMessage,{id:"database.fileProperty.focusedLabel",defaultMessage:"Add a file or image"}),ref:this.handleAddFileMount})]})]})})}renderFiles(){const{device:e}=this.environment,{value:t,disabled:s}=this.props,n=o.oA(t.map((e=>e.url)));return 0===n.length?void 0:e.isMobile||s?(0,L.jsx)(i.Fragment,{children:n.map(this.renderFile)}):(0,L.jsx)(x.Z,{children:(0,L.jsx)(h.ZP,{direction:"vertical",keys:n,renderKey:this.renderFile,onDrop:this.handleDraggableDrop})})}isEmpty(){const{value:e}=this.props;return 0===e.length}showMediaPicker(){const{store:e}=this.props,t=n.findDOMNode(this.addFileButton);if(!t)return;if(!(t instanceof Element))return;const s=u.default.getIntl();d.$(this.environment,{originRect:t.getBoundingClientRect(),originGap:3,isSmallWidth:!0,showArrow:!0,title:s.formatMessage({id:"filePropertyMenu.header",defaultMessage:"File"}),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:!1,videoUpload:!1,onUpload:t=>{c.cT({environment:this.environment,file:t,bucket:"secure",record:e.pointer,onStart:this.handleMediaPickerUploadStart,onProgress:this.handleUploadProgress,onComplete:this.handleMediaPickerUploadComplete,onError:this.handleUploadError})}},{type:"embed",onChange:this.handleMediaPickerEmbedComplete}]})}}K.displayName="FilePropertyMenu";const H=K},79027:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(41892),l=s(82990),d=s(5366),c=s(91376),u=s(17311),m=s(7844),p=s(42922),g=s(50506),h=s(62385),f=s(85893);function y(){window.__c={n:"GoogleAuthPromptModal"};const e=(0,n.Fy)(),t=(0,a.VK)((()=>m.Z.state.open),[]),s=()=>{m.Z.state.open&&m.Z.state.onDecline&&m.Z.state.onDecline(),m.Z.setState({open:!1})},y=()=>{m.Z.state.open&&m.Z.state.onConfirm(),m.Z.setState({open:!1})},v=()=>{s(),c.r$({currentTab:"connected_apps"})},x=(0,o.yK)((e=>({wrap:{padding:"24px 36px 24px",minWidth:300,maxWidth:400},modalHeaderWrap:{textAlign:"center",marginTop:8,marginBottom:18,justifyContent:"space-between"},modalMessage:{fontSize:16,lineHeight:1.5,fontWeight:l.Z.fontWeight.medium,marginTop:15,marginBottom:20,color:e.mediumTextColor}})),[]);return(0,f.jsx)(g.Z,{open:t,innerStyle:x.wrap,preventHideChildrenWhileOpening:!0,render:()=>(0,f.jsx)(i.Fragment,{children:(0,f.jsxs)("div",{style:x.modalHeaderWrap,children:[(0,f.jsx)("img",{src:r.Z.images.googleDriveLogoPng,style:{width:50,display:"inline-block"}}),(0,f.jsx)("div",{style:x.modalMessage,children:(0,f.jsx)(d.FormattedMessage,{defaultMessage:"Notion cannot access the Google Drive file you are trying to embed.",id:"googleAuthPromptModal.noAccessFile.errorMessage"})}),e.isMobileNative?(0,f.jsx)("div",{style:x.modalMessage,children:(0,f.jsx)(d.FormattedMessage,{defaultMessage:"Please use Notion on desktop to connect a new account.",id:"googleAuthPromptModal.mobileUseDesktopPrompt.errorMessage"})}):(0,f.jsx)(p.Z,{isLarge:!0,onClick:y,children:(0,f.jsx)(d.FormattedMessage,{defaultMessage:"Connect to Google",id:"googleAuthPromptModal.connectToGoogleButton.label"})}),!e.isMobile&&(0,f.jsx)("div",{style:{display:"block",marginTop:u.Z.vertical.tiny},children:(0,f.jsx)(h.Z,{underlined:!0,onClick:v,children:(0,f.jsx)(d.FormattedMessage,{defaultMessage:"See my connected accounts",id:"googleAuthPromptModal.seeConnectedAccountsButton.label"})})})]})}),onDismiss:s})}},82935:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(64275),l=s(45238),d=s(85893);const c=(0,l.I)("graduationCapInvert",{viewBox:"0 0 24 24",svg:(0,d.jsx)("path",{d:"M18.0791 3.76953L11.4141 0.720703C10.6826 0.392578 10.0811 0.235352 9.5 0.249023C8.91895 0.235352 8.31738 0.392578 7.58594 0.720703L0.920898 3.76953C0.415039 3.99512 0.148438 4.41211 0.148438 4.85645C0.148438 5.30078 0.415039 5.71777 0.920898 5.94336L3.45703 7.07812L7.96191 4.98633C7.93457 4.93848 7.92773 4.89746 7.92773 4.85645C7.92773 4.31641 8.70703 3.94043 9.52051 3.94043C10.3271 3.94043 11.1064 4.31641 11.1064 4.85645C11.1064 5.40332 10.3271 5.78613 9.52051 5.78613C9.26758 5.78613 9.01465 5.75195 8.78906 5.68359L4.5918 7.625L7.58594 8.99219C8.31738 9.33398 8.91895 9.47754 9.5 9.4707C10.0811 9.47754 10.6826 9.32715 11.4141 8.99219L18.0791 5.94336C18.585 5.71094 18.8516 5.30078 18.8516 4.85645C18.8516 4.41211 18.585 3.99512 18.0791 3.76953ZM4.57129 8.7666V12.6768C5.78809 13.4014 7.49707 13.832 9.5 13.832C13.5059 13.832 16.3496 12.0957 16.3496 9.91504V7.87793L11.8447 9.94238C11.0039 10.332 10.2246 10.5234 9.5 10.5166C8.77539 10.5234 8.00293 10.332 7.15527 9.94238L4.57129 8.7666ZM2.65039 7.88477V9.91504C2.65039 10.5098 2.94434 11.1934 3.48438 11.7812V8.26758L2.65039 7.88477ZM2.8418 14.29V16.0469C2.8418 16.6621 3.24512 17.0586 3.85352 17.0586H4.19531C4.80371 17.0586 5.20703 16.6621 5.20703 16.0469V14.29C5.20703 13.8184 4.96777 13.4697 4.57129 13.3398V12.6768C4.13379 12.417 3.76465 12.1162 3.48438 11.7812V13.3398C3.08789 13.4697 2.8418 13.8115 2.8418 14.29Z"})});var u=s(82990),m=s(51454),p=s(5366),g=s(80444),h=s(93278);var f=s(37190),y=s(92639),v=s(77080),x=s(42922),S=s(64921),b=s(28451);const M=(0,p.defineMessages)({title:{id:"guidedTutorialPopup.title",defaultMessage:"Learn Notion in 3 steps"},subtitle:{id:"guidedTutorialPopup.subtitle",defaultMessage:"We'll show you how to quickly customize {workspacename}."},cta:{id:"guidedTutorialPopup.cta",defaultMessage:"Get started"}}),w={display:"flex",alignItems:"center",flexDirection:"column"};function j(){window.__c={n:"GuidedTutorialPopup"};const e=(0,o.Fg)(),t=(0,n.O7)(),s=(0,a.VK)((()=>g.default.state.currentUserSettingsStore),[]),l=(0,a.VK)((()=>g.default.state.guidedTutorialStore),[]),j=(0,a.VK)((()=>{var e;return null===(e=g.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),C=(0,o.yK)((e=>({container:{background:e.popoverBackground,borderRadius:5,boxShadow:e.mediumBoxShadow,position:"absolute",bottom:65,right:16,zIndex:m.hT},cancel:{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},content:{...w,width:299,height:204,overflow:"hidden",position:"relative",padding:12,cursor:"default",justifyContent:"center"},contentTextFlex:{display:"flex",flexDirection:"column",gap:8,padding:8},subtitle:{fontSize:14,color:e.mediumTextColor,paddingBottom:8,textAlign:"center"}})),[]),k=(0,a.VK)((()=>h.default.state.open&&g.default.state.inAppCalloutStore.canShow("guided_tutorial_popup")&&(0,y.TL)(t)),[t]),_=(0,i.useCallback)((e=>{if(!s)return;const i={x:window.innerWidth/2,y:window.innerHeight/2};switch(v.default.getEligibleGroup({experimentId:"tooltip_vs_shadow_cursor",defaultGroup:"control"})){case"shadow_cursor":f.startShadowCursorTutorial(t,{position:i,userSettingsStore:s,guidedTutorialStore:l});break;case"tooltip":!function(){h.default.setState({open:!1});const{guidedTutorialStore:e}=g.default.state;e.setState({...g.default.state.guidedTutorialStore.state,currentCursorElement:"new-page-sidebar",type:"tooltip"})}()}}),[t,s,l]),T=(0,i.useCallback)((e=>{f.updateShadowCursorSubpagePhase({environment:t,userSettingsStore:s,phase:"dismissed_modal"})}),[t,s]);return k?(0,d.jsx)(b.P,{calloutId:"guided_tutorial_popup",children:(0,d.jsxs)("div",{style:C.container,children:[(0,d.jsx)(S.Z,{onClick:T,style:C.cancel,children:(0,r.D)({width:14,fill:e.mediumTextColor})}),(0,d.jsx)("div",{style:C.content,children:(0,d.jsxs)("div",{style:C.contentTextFlex,children:[c({width:24,height:24,fill:e.blueColor,alignSelf:"center"}),(0,d.jsx)("div",{style:{fontWeight:u.Z.fontWeight.medium,fontSize:16,alignSelf:"center"},children:(0,d.jsx)(p.FormattedMessage,{...M.title})}),(0,d.jsx)("div",{style:C.subtitle,children:(0,d.jsx)(p.FormattedMessage,{...M.subtitle,values:{workspacename:j}})}),(0,d.jsx)(x.Z,{isLarge:!0,style:{width:"calc(100% -30px)"},onClick:_,children:(0,d.jsx)(p.FormattedMessage,{...M.cta})})]})})]})}):null}},7523:(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});var i=s(67294),n=s(83355),a=s(15145),o=s(84169),r=s(82990),l=s(5366),d=s(50906),c=s(34602),u=s(18514),m=s(80444),p=s(47593),g=s(16354),h=s(50506),f=s(89728),y=s(69507),v=s(85893);class x extends n.Z{constructor(){super(...arguments),this.handleModalDismiss=()=>{p.Z.setState({open:!1})},this.handleImportComplete=e=>{p.Z.setState({open:!1}),c.navigateToBlock({environment:this.environment,store:e,pageVisitSource:a.tY.Import})}}renderComponent(){const e=p.Z.state;return(0,v.jsx)(h.Z,{open:e.open,innerStyle:x.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>(0,v.jsxs)(i.Fragment,{children:[(0,v.jsxs)("div",{style:x.modalTopbarWrapStyle,children:[(0,v.jsx)("div",{style:x.modalTopbarHeaderStyle,children:(0,v.jsx)(l.FormattedMessage,{id:"importModal.importButton.label",defaultMessage:"Import"})}),this.renderHelpButton()]}),(0,v.jsx)("div",{children:this.renderImportOptions(e)})]}),onDismiss:this.handleModalDismiss})}renderHelpButton(){return(0,v.jsx)(g.Z,{href:(0,u.UY)("guides.import"),onClick:()=>d.Fsx(this.environment,{from:"import"}),external:!0,children:(0,v.jsx)(f.Z,{isSmall:!0,icon:o.m,isGray:!0,children:(0,v.jsx)(l.FormattedMessage,{id:"importModal.helpButton.label",defaultMessage:"Learn about importing"})})})}renderImportOptions(e){const{mainEditorCurrentBlockStore:t,currentSpaceStore:s,currentSpaceViewStore:i,currentUserSettingsStore:n}=m.default.state;if(t&&s&&i&&n)return(0,v.jsx)(y.Z,{pageStore:e.open&&e.pageStore?e.pageStore:t,spaceStore:s,spaceViewStore:i,userSettingsStore:n,analyticsFrom:"modal",onComplete:this.handleImportComplete,readOnlyCreditButton:!1})}}x.displayName="ImportModal",x.wrapStyle={padding:"24px 36px 24px",minWidth:300},x.modalTopbarWrapStyle={display:"flex",alignItems:"center",marginTop:8,marginBottom:18},x.modalTopbarHeaderStyle={fontSize:24,lineHeight:1.2,marginBottom:6,fontWeight:r.Z.fontWeight.bold,marginRight:"auto"};const S=x},69507:(e,t,s)=>{s.d(t,{Z:()=>dt});var i=s(67294),n=s(83355),a=s(41892),o=s(56666),r=s(84169),l=s(82356),d=s(45238),c=s(85893);const u=(0,d.I)("importCSV",{viewBox:"0 0 32 32",svg:(0,c.jsx)("polygon",{points:"21.0286 9.14285 10.7429 9.14285 10.7429 10.8571 16.3143 16 10.7429 21.1429 10.7429 22.8571 21.0286 22.8571 21.0286 20.2857 15.0286 20.2857 19.3143 16 15.0286 11.7143 21.0286 11.7143"})}),m=(0,d.I)("importHTML",{viewBox:"0 0 32 32",svg:(0,c.jsx)("path",{d:"M13.088,21.472 L7.93605,16.32 L13.088,11.168 L11.52,9.59999 L4.80005,16.32 L11.52,23.04 L13.088,21.472 Z M18.912,21.472 L24.0641,16.32 L18.912,11.168 L20.48,9.59999 L27.2,16.32 L20.48,23.04 L18.912,21.472 Z"})}),p=(0,d.I)("importText",{viewBox:"0 0 32 32",svg:(0,c.jsx)("path",{d:"M6.3999,22.4 L19.1999,22.4 L19.1999,20.2667 L6.3999,20.2667 L6.3999,22.4 Z M6.3999,9.59999 L6.3999,11.7333 L25.5999,11.7333 L25.5999,9.59999 L6.3999,9.59999 Z M6.3999,17.0667 L25.5999,17.0667 L25.5999,14.9333 L6.3999,14.9333 L6.3999,17.0667 Z"})});var g=s(4615),h=s(5366),f=s(50906),y=s(47307),v=s(49085);class x extends v.default{getInitialState(){return{}}}const S=new x;var b=s(54642),M=s(92625);async function w(e){const{environment:t,spaceId:s,requestStore:i}=e;if(!t.currentUser.id)return y.showMessage({message:"Invalid details"}),void M.x();S.setState({...S.state,[s]:{...S.state[s],showLoader:!0}});const n=await b.getConfluenceSpaces(t,{spaceId:s});if(await(null==i?void 0:i.refresh()),S.setState({...S.state,[s]:{...S.state[s],showLoader:!1}}),"failed"!==n.type)return S.setState({...S.state,[s]:{...S.state[s],spacesResult:n.data}}),n.data;console.error(n.error),y.showError(n),M.x()}var j=s(43181),C=s(68821),k=s(72340),_=s(8989),T=s(22756);async function I(e){const t=await b.getTrelloAccount(e,{});return"success"===t.type?t.data:(console.error(t.error),{})}async function P(e){T.Z.setState({...T.Z.state,isFetchingAsanaAccount:!0});const t=await b.getAsanaAccount(e,{});if("success"===t.type){const{account:e}=t.data;return T.Z.setState({...T.Z.state,account:e,isFetchingAsanaAccount:!1}),e?t.data:{}}return console.error(t.error),T.Z.setState({...T.Z.state,isFetchingAsanaAccount:!1}),{}}async function Z(e){try{const t=await b.getEvernoteAccount(e,{});if("success"===t.type){const{userInfo:e}=t.data;return{userInfo:e}}return console.error(t.error),{userInfo:void 0}}catch(t){return console.error(t),{userInfo:void 0}}}var F=s(87279),A=s(77080);var D=s(18514),B=s(88632),R=s(67940),L=s(72087),N=s(480),E=s(86628),O=s(8848),V=s(41311),U=s(80444);const W=new(s(61766).Z);var z,K=s(93405),H=s(31945),G=s(73063),q=s(16354),Y=s(68785),Q=s(78140),$=s(32163),X=s(53437),J=s(72495),ee=s(26388),te=s(64369),se=s(82990),ie=s(64921);class ne extends n.Z{renderComponent(){const{title:e,actionButton:t,onClick:s,tooltipEvents:i}=this.props;return(0,c.jsxs)(ie.Z,{...i,onClick:s,style:this.getButtonStyle(),children:[this.renderIcon(),(0,c.jsxs)("div",{style:{minWidth:0,width:"100%"},children:[(0,c.jsxs)("div",{style:{display:"flex"},children:[(0,c.jsx)("div",{style:ne.titleStyle,children:e}),(0,c.jsx)("div",{style:{marginLeft:"auto"},children:t})]}),this.renderCaption()]})]})}renderIcon(){const{icon:e,logo:t}=this.props;return t?(0,c.jsx)("img",{style:ne.imageIconStyle,src:t}):e?(0,c.jsx)("div",{style:this.getIconWrapStyle(),children:e(this.getIconStyle())}):void 0}renderCaption(){const{caption:e}=this.props;if(e)return(0,c.jsx)("div",{style:this.getCaptionStyle(),children:e})}getButtonStyle(){return{display:"flex",alignItems:"center",padding:10,paddingRight:8,borderRadius:3,marginBottom:12,cursor:"pointer",boxShadow:this.theme.lightBoxShadow,transition:"background 200ms ease-out",background:this.theme.importOptionsButtonBackground}}getIconWrapStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",width:ne.iconSize,height:ne.iconSize,borderRadius:3,marginRight:8,color:this.theme.mediumTextColor,background:this.theme.importOptionsIconWrapBackground}}getIconStyle(){return{flexShrink:0,width:ne.iconSize,height:ne.iconSize}}getCaptionStyle(){return{fontSize:12,color:this.theme.mediumTextColor,wordBreak:"keep-all",...!this.props.shouldWrapCaption&&{...se.Z.textOverflowStyle}}}}z=ne,ne.displayName="ImportOptionsItem",ne.iconSize=28,ne.imageIconStyle={flexShrink:0,width:z.iconSize,height:z.iconSize,borderRadius:3,marginRight:10,background:O.ZP.white},ne.titleStyle={fontSize:16,fontWeight:se.Z.fontWeight.medium};const ae=ne,oe={whiteSpace:"pre-wrap"};function re(e,t){return(0,c.jsx)(ee.Z,{renderTooltip:()=>(0,c.jsx)(te.Z,{style:{color:O.ZP.white},isSmall:!0,children:(0,c.jsx)(h.FormattedMessage,{id:"AsanaImportOption.helpButton.tooltip",defaultMessage:"Learn about how to import"})}),render:s=>(0,c.jsx)(q.Z,{...s,external:!0,href:e,style:{marginLeft:"auto"},children:(0,c.jsx)(G.Z,{icon:r.m,ariaLabel:t.formatMessage({id:"AsanaImportOption.helpButton.ariaLabel",defaultMessage:"Learn about how to asana import help icon"})})})})}const le=function(){window.__c={n:"AsanaV2ImportOption"};const e=(0,E.VK)((()=>T.Z.state),[]),t=(0,E.VK)((()=>R.Z.state),[]),{account:s,isLoadingAsanaWorkspaces:i,isAccountDelinkingInProgress:n,isAccountLinkingInProgress:r}=e,l=(0,N.O7)(),d=(0,h.useIntl)(),{device:u}=l,m=t.flowId||(0,g.ZP)();t.flowId||R.Z.setState({flowId:m});const p={title:d.formatMessage({id:"asanaImportOption.asanaButton.title",defaultMessage:"Asana"}),logo:a.Z.images.import.asanaPng,caption:r?d.formatMessage({id:"asanaImportOption.asanaButton.accountLinkingInProgress",defaultMessage:"Authenticating..."}):n?d.formatMessage({id:"asanaImportOption.asanaButton.accountDelinkingInProgress",defaultMessage:"Removing account..."}):s,actionButton:s?(y=[{name:d.formatMessage({id:"asanaImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),captionText:d.formatMessage({id:"asanaImportOption.connectAnotherAccount.captionText",defaultMessage:"Ensure you are logged into the new Asana account in your browser"}),action:()=>V.w1({environment:l,flowId:m}).catch((()=>{}))},{name:d.formatMessage({id:"asanaImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>V.XP({environment:l})}],(0,c.jsx)(H.ZP,{popupType:X.kQ.Popup,renderOrigin:e=>i?(0,c.jsx)(Y.Z,{}):(0,c.jsx)(G.Z,{ariaLabel:d.formatMessage({id:"asanaImportOption.asanaButton.ariaLabel",defaultMessage:"Import from Asana button"}),icon:o.o,...e}),render:e=>{const t={key:"section",render:e=>(0,c.jsx)(J.Z,{...e}),items:y.map((t=>{let{name:s,captionText:i,action:n}=t;return{key:s,render:e=>(0,c.jsx)(K.Z,{...e,title:s,caption:i,captionStyle:i?oe:void 0}),action:()=>{n(),e.close()}}}))};return(0,c.jsx)(Q.Z,{menuType:F.og.Popup,width:200,children:(0,c.jsx)($.Z,{type:$.i.Vertical,initialFocus:void 0,sections:[t]})})}})):re((0,D.UY)("guides.importAsana"),d),onClick:()=>{}};var y;return(0,c.jsx)(H.ZP,{onClick:async()=>{var e;T.Z.resetImport(),i||r||n||(s?(f.ays(l,{import_source:"asana",from:"settings_modal",userId:l.currentUser.id,spaceId:null===(e=U.default.state.currentSpaceStore)||void 0===e?void 0:e.id,flowId:m}),await V.bA({environment:l}),V.h7()):V.w1({environment:l,flowId:m}).catch((()=>{})))},popupType:u.isMobile?H.Z4.SlideUp:H.Z4.Popup,buttonPopupStore:W,renderOrigin:e=>{let{onClick:t}=e;return(0,c.jsx)(ae,{...p,onClick:t})},render:()=>null})};var de=s(24405),ce=s(36591),ue=s(42853),me=s(44495),pe=s(22711),ge=s(78900),he=s(42922),fe=s(52275),ye=s(61519),ve=s(1743),xe=s(74194),Se=s(50506),be=s(63296),Me=s(89728),we=s(74523),je=s(58573);class Ce extends v.default{getInitialState(){return{searchQuery:"",selection:new Set}}}const ke=Ce;var _e=s(68894),Te=s(43765),Ie=s(29551);class Pe extends n.Z{constructor(){super(...arguments),this.storeTypes={store:ke},this.handleToggleItem=e=>{this.props.onComplete(e)}}willMount(e){const t=this.stores.store.state.selection,[s]=e.sections;if(s){const[e]=s.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return(0,c.jsx)(Q.Z,{menuType:F.og.Popup,header:this.renderMenuHeader(),width:280,maxHeight:350,children:this.renderMenuList()})}renderMenuHeader(){const{searchInputPlaceholder:e}=this.props,{searchQuery:t}=this.stores.store.state;return(0,c.jsx)(J.Z,{isInput:!0,desktopStyle:{paddingBottom:2},children:(0,c.jsx)(_e.ZP,{focus:!0,focusAfterAnimation:!0,value:t,onChange:e=>{const{store:t}=this.stores;t.setState({...t.state,searchQuery:e.target.value})},placeholder:e})})}renderMenuList(){const{sections:e,noSearchResultsPlaceholder:t}=this.props,{store:s}=this.stores,{searchQuery:i}=s.state,n=e.map((e=>{const t=(0,je.ZP)(i,e.items,(t=>`${t.key} ${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===n.length)return(0,c.jsx)(J.Z,{children:(0,c.jsx)(Te.Z,{title:t})});const a=n.map((t=>{const s=t.items.map((e=>e.name)),i={};return s.forEach((e=>{i[e]=i[e]?i[e]+1:1})),{key:t.name,render:s=>(0,c.jsx)(J.Z,{...s,title:e.length>1?t.name:void 0}),items:t.items.map((e=>({key:e.key,render:t=>(0,c.jsx)(fe.Z,{...t,title:(0,c.jsxs)(Ie.gq,{gap:2,alignItems:"center",children:[e.name,i[e.name]>1&&(0,c.jsx)(ee.Z,{placement:ee.Z.Placement.Right,renderTooltip:()=>e.key,render:t=>(0,c.jsx)(G.Z,{ariaLabel:`Associated space key is ${e.key}`,disableBackground:!0,icon:me.D,...t})})]}),right:void 0!==e.count&&(0,c.jsx)(te.Z,{isSmall:!0,children:e.count})}),action:()=>{this.props.handleClickImportConfluenceWorkspace(e.key,e.name),this.handleToggleItem(e)}})))}}));return(0,c.jsx)($.Z,{type:$.i.Vertical,initialFocus:void 0,sections:a})}}Pe.displayName="IntegrationConfluenceImportPopup";const Ze=Pe,Fe={whiteSpace:"pre-wrap"};function Ae(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:s,options:i,currentOption:n}=e,a=null===(t=i.find((e=>{let{key:t}=e;return t===n})))||void 0===t?void 0:t.label,o=(0,de.yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,c.jsx)(H.ZP,{popupType:H.Z4.Popup,placementToOrigin:H.pO.Left,renderOrigin:e=>(0,c.jsxs)(Me.Z,{...e,isLarge:!0,style:{opacity:1},disabled:!1,children:[a,(0,ue.i)(o.icon)]}),render:e=>{const t={menuType:F.og.Popup,width:250,left:50},n=[{key:"settings-item-section",render:e=>(0,c.jsx)(J.Z,{...e}),items:i.map((t=>{let{key:i,label:n}=t;return{key:i,action:()=>{s(i),e.close()},render:e=>(0,c.jsx)(fe.Z,{...e,title:n,shouldWrapCaption:!0,right:a===n?(0,c.jsx)("div",{style:{width:14},children:(0,ce.e)()}):void 0})}}))}];return(0,c.jsx)(Q.Z,{...t,children:(0,c.jsx)($.Z,{type:$.i.Vertical,sections:n,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}async function De(e){await async function(e){const{environment:t,requestStore:s,userEmail:i,site:n,access_token:a,instance:o,spaceId:r,username:l,password:d,flowId:c}=e;if(!t.currentUser.id)return y.showMessage({message:"Invalid details"}),void M.x();const u=await b.authenticateConfluenceUser(t,{userEmail:i,site:n,access_token:a,instance:o,userId:t.currentUser.id,spaceId:r,username:l,password:d});await s.refresh(),"failed"===u.type?(f.a1y(t,{import_source:"confluence",data:{import_type:"api",status:"failure",error:u.error},flowId:c}),console.error(u.error),y.showError(u)):(f.a1y(t,{import_source:"confluence",data:{import_type:"api",status:"success"},flowId:c}),y.showMessage({message:"Successfully connected confluence instance."}),await w({environment:t,requestStore:s,spaceId:r})),M.x()}(e)}function Be(e){let{environment:t,title:s,email:n,accountType:a,site:o,APIToken:r,personalAccessToken:l,confluenceVersion:d,username:u,password:m,hidePopup:p,spaceId:g,flowId:f,requestStore:y}=e;window.__c={n:"ModalContent"};const[v,x]=(0,i.useState)(""),[S,b]=(0,i.useState)("Cloud"),[M,w]=(0,i.useState)(""),[j,C]=(0,i.useState)(""),[k,_]=(0,i.useState)("OAuth2.0"),[T,I]=(0,i.useState)(""),[P,Z]=(0,i.useState)(""),F=(0,de.yK)((e=>({title:{fontWeight:se.Z.fontWeight.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor}})),[]);return(0,c.jsx)(ve.Z,{capture:!0,children:(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,c.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,c.jsxs)("div",{style:{marginBottom:24},children:[(0,c.jsx)("div",{style:F.title,children:s}),(0,c.jsx)(we.Z,{title:(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Confluence"}),href:"https://www.notion.so/help/import-from-confluence",analyticsFrom:"import",style:{marginTop:8}})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row"},children:[(0,c.jsx)("label",{htmlFor:"accountType",style:{...F.inputLabels},children:a}),(0,c.jsx)(Ae,{onSelectOption:b,options:[{key:"Cloud",label:(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownCloudOption.label",defaultMessage:"Cloud"})},{key:"Server",label:(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.accountTypeDropdownServerOption.label",defaultMessage:"Server/On-Premise"})}],currentOption:S})]}),(0,c.jsx)(ye.Z,{size:12,isHidden:!0}),(0,c.jsx)("div",{children:"Server"===S?(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",flexDirection:"row",alignItems:"center"},children:[(0,c.jsx)("label",{htmlFor:"confluenceVersion",style:{...F.inputLabels},children:d}),(0,c.jsx)(Ae,{onSelectOption:_,options:[{key:"OAuth2.0",label:(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownNewVersionOption.label",defaultMessage:"7.9 or later"})},{key:"Basic",label:(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.confluenceVersionDropdownOlderVersionOption.label",defaultMessage:"Prior to 7.9"})}],currentOption:k})]}),(0,c.jsx)(ye.Z,{size:12,isHidden:!0})]}):void 0}),(0,c.jsx)("label",{htmlFor:"email",style:{...F.inputLabels},children:n}),(0,c.jsx)(xe.Z,{id:"email",value:v,autoComplete:"off",autoCapitalize:"off",onChange:e=>{x(e.target.value)},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),(0,c.jsx)(ye.Z,{size:12,isHidden:!0}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"site",style:{...F.inputLabels},children:o}),(0,c.jsx)(xe.Z,{id:"site",value:M,onChange:e=>w(e.target.value),showClearButton:!0,placeholder:"Cloud"===S?"https://confluence.atlassian.net":"https://domain.com",inputElementAttributes:{minLength:4}}),(0,c.jsx)(ye.Z,{size:12,isHidden:!0}),"Cloud"===S?(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"APIToken",style:{...F.inputLabels},children:r}),(0,c.jsx)(xe.Z,{id:"AccessToken",type:"password",value:j,onChange:e=>{C(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})]}):(0,c.jsx)("div",{children:(0,c.jsx)("div",{children:"Basic"===k?(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"username",style:{...F.inputLabels},children:u}),(0,c.jsx)(xe.Z,{id:"username",value:T,onChange:e=>{I(e.target.value)},showClearButton:!0,placeholder:"confluenceUser",inputElementAttributes:{minLength:1}}),(0,c.jsx)(ye.Z,{size:12,isHidden:!0}),(0,c.jsx)("label",{htmlFor:"password",style:{...F.inputLabels},children:m}),(0,c.jsx)(xe.Z,{type:"password",id:"password",value:P,onChange:e=>{Z(e.target.value)},showClearButton:!0,placeholder:"P@S$w0rd",inputElementAttributes:{minLength:1}})]}):(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"AccessToken",style:{fontSize:"14px",fontWeight:"400"},children:l}),(0,c.jsx)(xe.Z,{id:"AccessToken",type:"password",value:j,onChange:e=>{C(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABCi7h",inputElementAttributes:{minLength:4}})]})})})]})]})]}),(0,c.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,c.jsx)(ye.Z,{size:24}),(0,c.jsx)(he.Z,{isLarge:!0,onClick:async()=>{await De({environment:t,userEmail:v,site:M,access_token:"Server"===S&&"Basic"===k?void 0:j,instance:S,username:"Basic"===k?T:void 0,password:"Basic"===k?P:void 0,spaceId:g,flowId:f,requestStore:y}),p()},children:(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,c.jsx)(be.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{p()},children:(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const Re=(0,h.injectIntl)((function(e){var t;window.__c={n:"ConfluenceImportOption"};const[s,n]=(0,i.useState)(!1),o=(0,E.VK)((()=>S.getState()),[]),{spaceStore:r,flowId:l}=e,d=[{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi",defaultMessage:"Import via API"}),captionText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaApi.message",defaultMessage:"Recommended for the best import experience"}),action:()=>{e.handleApiImportClick("confluence",l),n(!0)}},{name:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),captionText:e.intl.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile.message",defaultMessage:"Best for importing partial workspace content"}),action:()=>e.handleFileUploadClick("confluence",l)}],u=(0,N.O7)(),{device:m}=u,{confluenceResult:p,onComplete:y,intl:v,requestStore:x,spaceViewStore:b}=e,{account:M}=p,C={spacesResult:void 0,showLoader:!1},{showLoader:k}=o[r.id]||C;function _(e,t){f.qyQ(u,{import_source:"confluence",data:{spaceKey:e,spaceName:t},flowId:l})}function T(e){return(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{style:{fontSize:"12px",color:"rgba(55, 53, 47, 0.65)",paddingLeft:"12px"},children:(0,c.jsx)(h.FormattedMessage,{id:"confluenceImportOption.search.title",defaultMessage:"Select a space to import"})}),(0,c.jsx)(Ze,{searchInputPlaceholder:v.formatMessage({id:"confluenceImportOption.search.placeholder",defaultMessage:"Search for a Space"}),noSearchResultsPlaceholder:v.formatMessage({id:"confluenceImportOption.search.noResultsPlaceholder",defaultMessage:"No Spaces"}),sections:[e],onComplete:async e=>{await async function(e){const{environment:t,onComplete:s,selectedSpace:i,spaceStore:n,spaceViewStore:a,flowId:o}=e,r=await j.A1({environment:t,spaceStore:n,spaceViewStore:a,space:i,flowId:o||(0,g.ZP)()});s(r)}({environment:u,onComplete:y,selectedSpace:e,spaceStore:r,spaceViewStore:b,flowId:l})},handleClickImportConfluenceWorkspace:_})]})}const I={title:"Confluence",logo:a.Z.images.import.confluencePng,caption:M,actionButton:M&&k?(0,c.jsx)(Y.Z,{}):M&&e.renderItemActionsButton([{name:v.formatMessage({id:"confluenceImportOption.actionsMenu.importViaFile",defaultMessage:"Import via file"}),action:()=>e.handleFileUploadClick("confluence",l)},{name:v.formatMessage({id:"confluenceImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another instance"}),action:()=>{e.handleApiImportClick("confluence",l),n(!0)}},{name:v.formatMessage({id:"confluenceImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:()=>async function(e){const{environment:t,spaceId:s,requestStore:i}=e;S.setState({...S.state,[s]:{...S.state[s],showLoader:!1}}),await pe.DP(t,i,s)}({environment:u,spaceId:r.id,requestStore:x})}]),onClick:()=>{}},P=(null===(t=o[r.id])||void 0===t||null===(t=t.spacesResult)||void 0===t?void 0:t.spaces)||[],Z={key:"default",name:v.formatMessage({id:"confluenceImportOption.spacesProperty.defaultName",defaultMessage:"Spaces"}),items:P.map((e=>({id:e.id,key:e.key,name:e.name})))},A={key:"section",render:e=>(0,c.jsx)(J.Z,{...e}),items:d.map((e=>{let{name:t,captionText:s,action:i}=e;return{key:t,render:e=>(0,c.jsx)(K.Z,{...e,title:t,caption:s,captionStyle:s?Fe:void 0}),action:i}}))};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(H.ZP,{popupType:m.isMobile?H.Z4.SlideUp:H.Z4.Popup,onClick:()=>{M&&w({environment:u,requestStore:x,spaceId:r.id}).catch((()=>{}))},buttonPopupStore:ge.Z,render:e=>M?function(e){return k?(0,c.jsx)(c.Fragment,{}):T(e)}(Z):(0,c.jsx)(Q.Z,{menuType:F.og.Popup,width:200,children:(0,c.jsx)($.Z,{onAccept:e.close,type:$.i.Vertical,initialFocus:void 0,sections:[A]})}),renderOrigin:e=>{let{onClick:t}=e;return(0,c.jsx)(ae,{...I,onClick:t})}}),(0,c.jsx)(Se.Z,{open:s,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{n(!1)},render:()=>(0,c.jsx)(Be,{hidePopup:()=>{n(!1)},environment:u,title:(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,c.jsxs)(Ie.gq,{style:{alignItems:"center",gap:2},children:[(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.emailMessage",defaultMessage:"Email"}),(0,c.jsx)(ee.Z,{placement:ee.Z.Placement.Right,renderTooltip:()=>(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.emailHelpText",defaultMessage:"Email address of the Confluence user importing the data"}),render:e=>(0,c.jsx)(G.Z,{ariaLabel:"Email help text button",disableBackground:!0,icon:me.D,...e})})]}),accountType:(0,c.jsxs)(Ie.gq,{style:{alignItems:"center",gap:2},children:[(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.instanceMessage",defaultMessage:"Confluence instance"}),(0,c.jsx)(ee.Z,{style:{width:300,whiteSpace:"normal"},placement:ee.Z.Placement.Right,renderTooltip:()=>(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.instanceHelperText",defaultMessage:"On Confluence, click 'Help', the (?) next to your profile, then click on 'About Confluence' this will tell you if it is a Server, Cloud or Data Center"}),render:e=>(0,c.jsx)(G.Z,{ariaLabel:"Confluence instance type help text button",disableBackground:!0,icon:me.D,...e})})]}),site:(0,c.jsxs)(Ie.gq,{style:{alignItems:"center",gap:2},children:[(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.siteMessage",defaultMessage:"Site"}),(0,c.jsx)(ee.Z,{style:{width:300,whiteSpace:"normal"},placement:ee.Z.Placement.Right,renderTooltip:()=>(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.siteHelperText",defaultMessage:"The base URL that is used to access Confluence. If you are running on a non-standard port, please provide the input in host:port format"}),render:e=>(0,c.jsx)(G.Z,{ariaLabel:"Confluence site help text button",disableBackground:!0,icon:me.D,...e})})]}),APIToken:(0,c.jsxs)(Ie.gq,{style:{alignItems:"center",gap:2},children:[(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,c.jsx)(ee.Z,{placement:ee.Z.Placement.Right,renderTooltip:()=>(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceAccessToken.captions",defaultMessage:"Click to learn how to get access token from Confluence cloud"}),render:e=>(0,c.jsx)(G.Z,{ariaLabel:"Confluence access token help text button",onClick:()=>{window.open("https://support.atlassian.com/atlassian-account/docs/manage-api-tokens-for-your-atlassian-account","_blank")},icon:me.D,...e})})]}),personalAccessToken:(0,c.jsxs)(Ie.gq,{style:{alignItems:"center",gap:2},children:[(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.personalAccessTokenMessage",defaultMessage:"Personal Access Token"}),(0,c.jsx)(ee.Z,{placement:ee.Z.Placement.Right,style:{width:300,whiteSpace:"normal"},renderTooltip:()=>(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluencePAT.caption",defaultMessage:"Click to learn how to get personal authentication token from Confluence server"}),render:e=>(0,c.jsx)(G.Z,{ariaLabel:"Confluence personal access token help text button",onClick:()=>{window.open("https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html","_blank")},icon:me.D,...e})})]}),confluenceVersion:(0,c.jsxs)(Ie.gq,{style:{alignItems:"center",gap:2},children:[(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.confluenceVersion",defaultMessage:"Confluence version"}),(0,c.jsx)(ee.Z,{style:{width:300,whiteSpace:"normal"},placement:ee.Z.Placement.Right,renderTooltip:()=>(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.stepsToGetConfluenceVersion.captions",defaultMessage:"Click to learn how to know the version of Confluence you are running"}),render:e=>(0,c.jsx)(G.Z,{ariaLabel:"Confluence version help text button",onClick:()=>{window.open("https://confluence.atlassian.com/confkb/how-do-i-know-what-version-of-confluence-is-running-179441565.html","_blank")},icon:me.D,...e})})]}),username:(0,c.jsxs)(Ie.gq,{style:{alignItems:"center",gap:2},children:[(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.username",defaultMessage:"Username"}),(0,c.jsx)(ee.Z,{placement:ee.Z.Placement.Right,renderTooltip:()=>(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.usernameHelpText",defaultMessage:"Username of the Confluence user importing the data"}),render:e=>(0,c.jsx)(G.Z,{ariaLabel:"Confluence user's username help text button",disableBackground:!0,icon:me.D,...e})})]}),password:(0,c.jsxs)(Ie.gq,{style:{alignItems:"center",gap:2},children:[(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.password",defaultMessage:"Password"}),(0,c.jsx)(ee.Z,{placement:ee.Z.Placement.Right,renderTooltip:()=>(0,c.jsx)(h.FormattedMessage,{id:"confluenceAuthentication.passwordHelpText",defaultMessage:"Password of the Confluence user importing the data"}),render:e=>(0,c.jsx)(G.Z,{ariaLabel:"Confluence user's password help text button",disableBackground:!0,icon:me.D,...e})})]}),spaceId:r.id,flowId:l,requestStore:x})})]})}));var Le=s(77137),Ne=s(72126),Ee=s(23867),Oe=s(83805),Ve=s(34602),Ue=s(53833),We=s(90365),ze=(s(57658),s(60458)),Ke=s(28992),He=s(62385);class Ge extends n.Z{renderComponent(){return(0,c.jsx)("div",{style:this.getStyle(),children:"·"})}getStyle(){return{display:"inline-block",textAlign:"center",color:this.props.disabled?this.theme.lightTextColor:this.theme.mediumTextColor,userSelect:"none",WebkitUserSelect:"none",width:8}}}Ge.displayName="DotSeparator";const qe=Ge;class Ye extends n.Z{constructor(){super(...arguments),this.storeTypes={store:ke},this.handleSelectAllClick=()=>{const{sections:e,analyticsName:t}=this.props,{store:s}=this.stores,{selection:i}=s.state;for(const n of e)for(const e of n.items)i.add(e.key);s.emit(),f.VfZ(this.environment,{integration_name:t})},this.handleDeselectAllClick=()=>{const{analyticsName:e}=this.props,{store:t}=this.stores,{selection:s}=t.state;s.clear(),t.emit(),f.FIS(this.environment,{integration_name:e})},this.handleToggleItem=e=>{const{analyticsName:t}=this.props,{store:s}=this.stores,{selection:i}=s.state;i.has(e.key)?(i.delete(e.key),f.Z36(this.environment,{integration_name:t})):(i.add(e.key),f.Glf(this.environment,{integration_name:t})),s.emit()},this.handleImport=()=>{const{sections:e}=this.props,{selection:t}=this.stores.store.state,s=Ne.xH(e.map((e=>e.items))),i=[];t.forEach((e=>{const t=s.find((t=>t.key===e));t&&i.push(t)})),this.props.onComplete(i)}}willMount(e){const t=this.stores.store.state.selection,[s]=e.sections;if(s){const[e]=s.items;e&&t.add(e.key)}this.stores.store.emit()}renderComponent(){return(0,c.jsx)(Q.Z,{menuType:F.og.Popup,header:this.renderMenuHeader(),footer:this.renderMenuFooter(),width:280,maxHeight:350,children:this.renderMenuList()})}renderMenuHeader(){const{searchInputPlaceholder:e}=this.props,{searchQuery:t}=this.stores.store.state,s=Boolean(t);return(0,c.jsxs)(J.Z,{isInput:!0,desktopStyle:{paddingBottom:2},children:[(0,c.jsx)(_e.ZP,{focus:!0,focusAfterAnimation:!0,value:t,onChange:e=>{const{store:t}=this.stores;t.setState({...t.state,searchQuery:e.target.value})},placeholder:e}),(0,c.jsx)(Ke.Z,{isTokenTitle:!0,style:{marginTop:2},title:(0,c.jsxs)("div",{style:{marginLeft:-3},children:[(0,c.jsx)(He.Z,{onClick:this.handleSelectAllClick,disabled:s,disabledFeedback:!0,children:(0,c.jsx)(h.FormattedMessage,{id:"importPopup.selectAll",defaultMessage:"Select all"})}),(0,c.jsx)(qe,{disabled:s}),(0,c.jsx)(He.Z,{onClick:this.handleDeselectAllClick,disabled:s,disabledFeedback:!0,children:(0,c.jsx)(h.FormattedMessage,{id:"importPopup.deselectAll",defaultMessage:"Deselect all"})})]})})]})}renderMenuFooter(){const e=0===this.stores.store.state.selection.size;return(0,c.jsx)(J.Z,{topBorder:!0,desktopStyle:{paddingTop:8,paddingBottom:8},children:(0,c.jsx)(Ke.Z,{title:(0,c.jsx)(he.Z,{disabled:e,onClick:this.handleImport,children:(0,c.jsx)(h.FormattedMessage,{id:"integrationImportPopup.importButton.label",defaultMessage:"Import"})})})})}renderMenuList(){const{sections:e,noSearchResultsPlaceholder:t}=this.props,{store:s}=this.stores,{searchQuery:i,selection:n}=s.state,a=e.map((e=>{const t=(0,je.ZP)(i,e.items,(t=>`${t.name} ${e.name}`));return{...e,items:t}})).filter((e=>e.items.length>0));if(0===a.length)return(0,c.jsx)(J.Z,{children:(0,c.jsx)(Te.Z,{title:t})});const o=a.map((t=>({key:t.name,render:s=>(0,c.jsx)(J.Z,{...s,title:e.length>1?t.name:void 0}),items:t.items.map((e=>{const t=()=>this.handleToggleItem(e);return{key:e.key,render:s=>(0,c.jsx)(fe.Z,{...s,title:e.name,icon:(0,c.jsx)(ze.Z,{checked:n.has(e.key),size:16,onClick:t}),right:void 0!==e.count&&(0,c.jsx)(te.Z,{isSmall:!0,children:e.count})}),action:t}}))})));return(0,c.jsx)($.Z,{type:$.i.Vertical,initialFocus:void 0,sections:o})}}Ye.displayName="IntegrationImportPopup";const Qe=Ye;class $e extends n.Z{constructor(){super(...arguments),this.evernoteStoreState=this.createComputedStore((()=>Ue.Z.getState())),this.handleClickImportEvernote=async()=>{var e;const{isFetchingNotebooks:t}=this.evernoteStoreState.state;t&&await Oe.B({environment:this.environment,requestStore:this.props.requestStore});const s=R.Z.getOrCreateFlowId();f.ays(this.environment,{import_source:"evernote",from:this.props.analyticsFrom,flowId:s,userId:this.environment.currentUser.id,spaceId:null===(e=U.default.state.currentSpaceStore)||void 0===e?void 0:e.id})},this.handleRemoveEvernote=async()=>{await b.disconnectEvernote(this.environment,{}),Ue.Z.setState({notebooksResponse:{notebooks:[]},isFetchingNotebooks:!0,showLoader:!1}),await this.props.requestStore.refresh(),f.qJZ(this.environment,{integration_name:"evernote"})},this.handleEvernoteAuth=async()=>{await Oe.e({environment:this.environment,requestStore:this.props.requestStore})},this.handleImportEvernoteComplete=async(e,t)=>{const{notebooks:s}=e,i=s.filter((e=>Boolean(t.find((t=>t.key===e.guid)))));f.G7t(this.environment,{integration_name:"evernote",count:t.length});const n=await j.am({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore,notebooks:i});f.qyQ(this.environment,{import_source:"evernote",data:{notebooks:i.map((e=>e.guid)),userId:this.environment.currentUser.id,spaceId:(0,Ee.C)(this.props.spaceStore.id)},flowId:R.Z.getOrCreateFlowId()}),this.props.onComplete(n)},this.handleEvernoteHelpClick=()=>{Ve.navigateToExternalURL({environment:this.environment,url:(0,D.UY)("guides.importEvernote")})}}renderComponent(){const{device:e}=this.environment,{evernoteResult:t,intl:s}=this.props,{userInfo:i}=t,{notebooksResponse:n,showLoader:o}=this.evernoteStoreState.state,r=(null==n?void 0:n.notebooks)||[],l=Ne.vM(r,(e=>e.stack||"")),d=Object.keys(l).map((e=>{const t=e||"Top-Level";return{key:t,name:t,items:(l[e]||[]).map((e=>({key:e.guid,name:e.title,count:e.noteCount})))}})),u={title:"Evernote",logo:a.Z.images.import.evernotePng,shouldWrapCaption:!i,caption:i?i.name||i.username||i.email:void 0,actionButton:i&&o?(0,c.jsx)(Y.Z,{}):i?this.props.renderItemActionsButton([{name:s.formatMessage({id:"evernoteImportOption.actionsMenu.learnMore",defaultMessage:"Learn more"}),action:this.handleEvernoteHelpClick},{name:s.formatMessage({id:"evernoteImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>We.Z.setState({open:!0})},{name:s.formatMessage({id:"evernoteImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleEvernoteAuth},{name:s.formatMessage({id:"evernoteImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveEvernote}]):this.props.defaultActionButton,onClick:()=>{}};return(0,c.jsx)(H.ZP,{popupType:e.isMobile?H.Z4.SlideUp:H.Z4.Popup,buttonPopupStore:We.Z,onClick:this.handleClickImportEvernote,render:()=>o?(0,c.jsx)(c.Fragment,{}):(0,c.jsx)(Qe,{searchInputPlaceholder:s.formatMessage({id:"evernoteImportOption.search.placeholder",defaultMessage:"Search for a notebook…"}),noSearchResultsPlaceholder:s.formatMessage({id:"evernoteImportOption.search.noResultsPlaceholder",defaultMessage:"No notebooks"}),analyticsName:"evernote",sections:d,onComplete:e=>this.handleImportEvernoteComplete(n,e)}),renderOrigin:e=>{let{onClick:t}=e;return(0,c.jsx)(ae,{...u,onClick:i?t:this.handleEvernoteAuth})}})}}$e.displayName="EvernoteImportOption";const Xe=(0,h.injectIntl)($e);var Je=s(33929);const et=(0,h.defineMessages)({successfullyConnected:{id:"mondayActions.successfullyConnected.message",defaultMessage:"Successfully connected monday.com instance."}});function tt(e){let{environment:t,title:s,email:n,APIToken:a,hidePopup:o,flowId:r,requestStore:l,spaceStore:d}=e;window.__c={n:"ModalContent"};const[u,m]=(0,i.useState)(""),[p,g]=(0,i.useState)(""),v=(0,de.yK)((e=>({title:{fontWeight:se.Z.fontWeight.semibold},inputLabels:{fontSize:"14px",fontWeight:"400"},helpText:{textAlign:"center",marginTop:"5px",lineHeight:"15px",fontSize:12,color:e.lightTextColor}})),[]);return(0,c.jsx)(ve.Z,{capture:!0,children:(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",padding:20,width:"100%"},children:[(0,c.jsxs)("div",{style:{overflowY:"scroll"},children:[(0,c.jsxs)("div",{style:{marginBottom:24},children:[(0,c.jsx)("div",{style:v.title,children:s}),(0,c.jsx)(we.Z,{title:(0,c.jsx)(h.FormattedMessage,{id:"mondayAuthentication.helpButton.caption",defaultMessage:"Learn more about importing from Monday.com"}),href:"",analyticsFrom:"import",style:{marginTop:8}})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"email",style:{...v.inputLabels},children:n}),(0,c.jsx)(xe.Z,{id:"email",value:u,autoComplete:"off",autoCapitalize:"off",onChange:e=>{m(e.target.value)},showClearButton:!0,placeholder:"sample@gmail.com",inputElementAttributes:{minLength:4}}),(0,c.jsx)(ye.Z,{size:12,isHidden:!0}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{htmlFor:"APIToken",style:{...v.inputLabels},children:a}),(0,c.jsx)(xe.Z,{id:"AccessToken",type:"password",value:p,onChange:e=>{g(e.target.value)},showClearButton:!0,placeholder:"ABC0NDU4NTE0MzUzOooUABCoUOct72zybAxEsiABC7h",inputElementAttributes:{minLength:4}})]})]})]}),(0,c.jsxs)("div",{style:{flexGrow:0,flexShrink:0},children:[(0,c.jsx)(ye.Z,{size:24}),(0,c.jsx)(he.Z,{isLarge:!0,onClick:async()=>{await async function(e){const{environment:t,requestStore:s,userEmail:i,APIToken:n,flowId:a,spaceId:o}=e;if(!t.currentUser.id)return y.showMessage({message:"Invalid details"}),void M.x();const r=await b.authenticateMondayUser(t,{userId:t.currentUser.id,spaceId:o,userEmail:i,APIToken:n});await s.refresh(),"failed"===r.type?(f.a1y(t,{import_source:"monday.com",data:{import_type:"api",status:"failure",error:r.error},flowId:a}),console.error(r.error),y.showError(r)):(f.a1y(t,{import_source:"monday.com",data:{import_type:"api",status:"success"},flowId:a}),y.showMessage({message:Je.default.formatMessage(et.successfullyConnected)})),M.x()}({environment:t,requestStore:l,userEmail:u,APIToken:p,flowId:r,spaceId:d.id}),o()},children:(0,c.jsx)(h.FormattedMessage,{id:"mondayAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,c.jsx)(be.Z,{isLarge:!0,style:{marginLeft:12},onClick:()=>{o()},children:(0,c.jsx)(h.FormattedMessage,{id:"mondayAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}const st=(0,h.injectIntl)((function(e){window.__c={n:"MondayImportOption"};const[t,s]=(0,i.useState)(!1),{mondayResult:n,flowId:a,intl:o,requestStore:r,spaceStore:l}=e,{user:d}=n,u=(0,N.O7)(),m={title:"Monday",logo:"",caption:null==d?void 0:d.email,actionButton:d&&e.renderItemActionsButton([{name:o.formatMessage({id:"mondayImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:()=>{s(!0)}},{name:o.formatMessage({id:"mondayImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:async()=>{await pe.dt(u,r,l.id)}}]),onClick:()=>{}};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(H.ZP,{popupType:u.device.isMobile?H.Z4.SlideUp:H.Z4.Popup,onClick:()=>{s(!0)},renderOrigin:e=>{let{onClick:t}=e;return(0,c.jsx)(ae,{...m,onClick:d?async()=>{await async function(e){const{environment:t,spaceStore:s}=e,i=b.parallelMondayImport(t,{importParams:[],loggerPageId:"",spaceId:s.id});for await(const n of i)return n}({environment:u,spaceStore:l})}:t})},render:()=>null}),(0,c.jsx)(Se.Z,{open:t,innerStyle:{width:600,maxWidth:"calc(100vw - 100px)",overflow:"hidden",borderRadius:5,maxHeight:"90vh"},onDismiss:()=>{s(!1)},render:()=>(0,c.jsx)(tt,{hidePopup:()=>{s(!1)},environment:u,title:(0,c.jsx)(h.FormattedMessage,{id:"mondayAuthentication.titleMessage",defaultMessage:"Authentication details"}),email:(0,c.jsxs)(Ie.gq,{style:{alignItems:"center",gap:2},children:[(0,c.jsx)(h.FormattedMessage,{id:"mondayAuthentication.emailMessage",defaultMessage:"Email"}),(0,c.jsx)(ee.Z,{placement:ee.Z.Placement.Right,renderTooltip:()=>(0,c.jsx)(h.FormattedMessage,{id:"mondayAuthentication.emailHelpText",defaultMessage:"Email address of the Monday.com user importing the data"}),render:e=>(0,c.jsx)(G.Z,{...e,ariaLabel:"Email help text button",disableBackground:!0,icon:me.D})})]}),APIToken:(0,c.jsxs)(Ie.gq,{style:{alignItems:"center",gap:2},children:[(0,c.jsx)(h.FormattedMessage,{id:"mondayAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,c.jsx)(ee.Z,{placement:ee.Z.Placement.Right,renderTooltip:()=>(0,c.jsx)(h.FormattedMessage,{id:"mondayAuthentication.stepsToGetMondayAPIToken.captions",defaultMessage:"Click to learn how to get API token from Monday.com"}),render:e=>(0,c.jsx)(G.Z,{...e,ariaLabel:"Monday.com API token help text button",onClick:()=>{window.open("https://developer.monday.com/api-reference/docs/authentication#accessing-api-tokens","_blank")},icon:me.D})})]}),flowId:a,requestStore:r,spaceStore:l})})]})}));var it=s(52192),nt=s(82066),at=s(81676);class ot extends n.Z{constructor(){super(...arguments),this.trelloStoreState=this.createComputedStore((()=>at.Z.getState())),this.handleClickImportTrello=async()=>{this.trelloStoreState.state.isFetchingBoards&&await it.u(this.environment,this.props.requestStore),f.ays(this.environment,{import_source:"trello",from:this.props.analyticsFrom})},this.handleTrelloAuth=async()=>{await it.M({environment:this.environment,requestStore:this.props.requestStore})},this.handleRemoveTrello=async()=>{await b.disconnectTrello(this.environment,{}),at.Z.setState({boardsResponse:{boards:[]},isFetchingBoards:!0,showLoader:!1}),await this.props.requestStore.refresh(),f.qJZ(this.environment,{integration_name:"trello"})},this.handleImportTrelloComplete=async(e,t)=>{const{boards:s}=e,i=s.filter((e=>Boolean(t.find((t=>t.key===e.id)))));f.G7t(this.environment,{integration_name:"trello",count:t.length});const n=await j.su({environment:this.environment,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,boards:i});this.props.onComplete(n)}}renderComponent(){const{device:e}=this.environment,{trelloResult:t,intl:s}=this.props,{account:i}=t,{boardsResponse:n,showLoader:o}=this.trelloStoreState.state,r=n.boards,l={key:"default",name:s.formatMessage({id:"trelloImportOption.boardProperty.defaultName",defaultMessage:"Boards"}),items:r.map((e=>({key:e.id,name:e.name})))},d={title:"Trello",logo:a.Z.images.import.trelloPng,actionButton:i&&o?(0,c.jsx)(Y.Z,{}):i&&this.props.renderItemActionsButton([{name:s.formatMessage({id:"trelloImportOption.actionsMenu.import",defaultMessage:"Import"}),action:()=>nt.Z.setState({open:!0})},{name:s.formatMessage({id:"trelloImportOption.actionsMenu.connectAnotherAccount",defaultMessage:"Connect another account"}),action:this.handleTrelloAuth},{name:s.formatMessage({id:"trelloImportOption.actionsMenu.removeIntegration",defaultMessage:"Remove"}),action:this.handleRemoveTrello}]),onClick:()=>{}};return(0,c.jsx)(H.ZP,{popupType:e.isMobile?H.Z4.SlideUp:H.Z4.Popup,buttonPopupStore:nt.Z,onClick:this.handleClickImportTrello,render:()=>o?(0,c.jsx)(c.Fragment,{}):(0,c.jsx)(Qe,{searchInputPlaceholder:s.formatMessage({id:"trelloImportOption.search.placeholder",defaultMessage:"Search for a board…"}),noSearchResultsPlaceholder:s.formatMessage({id:"trelloImportOption.search.noResultsPlaceholder",defaultMessage:"No boards found."}),analyticsName:"trello",sections:[l],onComplete:e=>this.handleImportTrelloComplete(n,e)}),renderOrigin:e=>{let{onClick:t}=e;return(0,c.jsx)(ae,{...d,onClick:i?t:this.handleTrelloAuth})}})}}ot.displayName="TrelloImportOption";const rt=(0,h.injectIntl)(ot);class lt extends n.Z{constructor(){super(...arguments),this.storeTypes={trelloRequestStore:L.Z,asanaRequestStore:L.Z,evernoteRequestStore:L.Z,confluenceRequestStore:L.Z,mondayRequestStore:L.Z},this.handleFileUploadClick=async(e,t)=>{f.ays(this.environment,{import_source:e,from:this.props.analyticsFrom,import_type:"file",flowId:t});const s=await j.ro({environment:this.environment,pageStore:this.props.pageStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,uploadType:e,flowId:t});s&&(f.W2j(this.environment,{from:"import",type:"page",new_page_id:s.id}),this.props.onComplete(s))},this.handleApiImportClick=(e,t)=>{w({environment:this.environment,requestStore:this.props.confluenceRequestStore,spaceId:this.props.spaceStore.id}).catch((()=>{})),f.ays(this.environment,{import_source:e,from:this.props.analyticsFrom,import_type:"api",flowId:t})},this.getAnalyticsFlowId=()=>R.Z.state.flowId||(0,g.ZP)()}renderComponent(){if(!B.Z.state.online)return(0,c.jsx)("div",{style:{...lt.wrapStyle,fontSize:14,color:this.theme.mediumTextColor},children:(0,c.jsx)(h.FormattedMessage,{id:"importOptions.offlineErrorMessage",defaultMessage:"Please go online to import."})});const{analyticsFrom:e,isLoadingNewConnections:t}=this.props;return this.renderRequests((s=>!s||t?(0,c.jsx)("div",{style:"onboarding"===e?{}:lt.wrapStyle,children:(0,c.jsx)(Y.Z,{})}):(0,c.jsx)("div",{style:lt.wrapStyle,children:this.renderOptions(s)})))}renderOptions(e){const t=this.getAnalyticsFlowId();return(0,c.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"},children:[this.renderAsanaImportOption(e.asanaResult),(0,k.Tc)(this.environment)?this.renderConfluenceImportViaAPIOption(e.confluenceResult,t):this.renderConfluenceImportViaFileOption(t),(0,c.jsx)(ae,{title:"Google Docs",logo:a.Z.images.import.googleDocsPng,actionButton:this.renderHelpButtonToURL((0,D.UY)("guides.importGoogleDocs")),onClick:()=>this.handleFileUploadClick("gdocs")}),this.renderCsvImportWithTooltip(),(0,c.jsx)(ae,{title:(0,c.jsx)(h.FormattedMessage,{id:"importOptions.textMarkdown.title",defaultMessage:"Text & Markdown"}),icon:p,onClick:()=>this.handleFileUploadClick("markdown")}),(0,c.jsx)(ae,{title:"HTML",icon:m,onClick:()=>this.handleFileUploadClick("html")}),(0,c.jsx)(ae,{title:"Word",logo:a.Z.images.import.wordPng,onClick:()=>this.handleFileUploadClick("docx")}),(0,c.jsx)(ae,{title:"Dropbox Paper",logo:a.Z.images.import.dropboxPaperPng,actionButton:this.renderHelpButtonToURL((0,D.UY)("guides.importDropboxPaper")),onClick:()=>this.handleFileUploadClick("dropbox")}),this.renderTrelloImportOption(e.trelloResult),this.renderEvernoteImportOption(e.evernoteResult),"on"===A.default.getEligibleGroup({experimentId:"monday_importer",defaultGroup:"control"})&&this.renderMondayImportOption(e.mondayResult),(0,c.jsx)(ae,{title:"Quip",logo:a.Z.images.import.quipPng,actionButton:this.renderHelpButtonToURL((0,D.UY)("guides.importQuip")),onClick:()=>this.handleFileUploadClick("quip")}),(0,c.jsx)(ae,{title:"Workflowy",logo:a.Z.images.import.workflowyPng,actionButton:this.renderHelpButtonToURL((0,D.UY)("guides.importWorkflowy")),onClick:()=>this.handleFileUploadClick("workflowy")}),(0,_.t)()&&(0,c.jsx)(ae,{title:(0,c.jsx)(h.FormattedMessage,{id:"importOptions.genericImporter.title",defaultMessage:"Universal import"}),icon:l.l,onClick:()=>this.handleFileUploadClick("genericImporter",t),actionButton:this.renderHelpButtonToURL("",(0,c.jsx)(h.FormattedMessage,{id:"importOptions.universalImport.tooltip",defaultMessage:"Import any ZIP file that contains text, Markdown, CSV, HTML, and other files"}),240,!0)})]})}renderRequests(e){return(0,c.jsx)(Le.Z,{request:this.environment,performRequest:I,requestStore:this.stores.trelloRequestStore,render:(t,s)=>(0,c.jsx)(Le.Z,{request:this.environment,performRequest:P,requestStore:this.stores.asanaRequestStore,render:(t,i)=>(0,c.jsx)(Le.Z,{request:this.environment,performRequest:Z,requestStore:this.stores.evernoteRequestStore,render:(t,n)=>(0,c.jsx)(Le.Z,{request:this.environment,performRequest:()=>async function(e,t){const s=await b.getConfluenceAccount(e,{spaceId:t});return"success"===s.type?s.data:(console.error(s.error),{})}(this.environment,this.props.spaceStore.id),requestStore:this.stores.confluenceRequestStore,render:(t,a)=>(0,c.jsx)(Le.Z,{request:this.environment,performRequest:()=>async function(e,t){const s=await b.getMondayUser(e,{spaceId:t});if("success"===s.type)return s.data;console.error(s.error)}(this.environment,this.props.spaceStore.id),requestStore:this.stores.mondayRequestStore,render:(t,o)=>e(s&&i&&n&&a&&o?{trelloResult:s,asanaResult:i,evernoteResult:n,confluenceResult:a,mondayResult:o}:void 0)})})})})})}renderTrelloImportOption(e){return(0,c.jsx)(rt,{trelloResult:e,analyticsFrom:this.props.analyticsFrom,renderItemActionsButton:this.renderItemActionsButton,onComplete:this.props.onComplete,requestStore:this.stores.trelloRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderAsanaImportOption(e){return(0,C.c)()?(0,c.jsx)(le,{}):(0,c.jsx)(c.Fragment,{})}renderMondayImportOption(e){return(0,c.jsx)(st,{mondayResult:e,analyticsFrom:"onboarding",flowId:"",renderItemActionsButton:this.renderItemActionsButton,onComplete:this.props.onComplete,requestStore:this.stores.mondayRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderConfluenceImportViaAPIOption(e,t){const{analyticsFrom:s,onComplete:i,spaceStore:n,spaceViewStore:a,userSettingsStore:o}=this.props;return(0,c.jsx)(Re,{confluenceResult:e,analyticsFrom:s,flowId:t,renderItemActionsButton:this.renderItemActionsButton,onComplete:i,spaceStore:n,requestStore:this.stores.confluenceRequestStore,spaceViewStore:a,userSettingsStore:o,handleFileUploadClick:this.handleFileUploadClick,handleApiImportClick:this.handleApiImportClick})}renderConfluenceImportViaFileOption(e){return(0,c.jsx)(ae,{title:"Confluence",logo:a.Z.images.import.confluencePng,onClick:()=>this.handleFileUploadClick("confluence",e),actionButton:this.renderHelpButtonToURL((0,D.UY)("guides.importConfluence"))})}renderEvernoteImportOption(e){return(0,c.jsx)(Xe,{evernoteResult:e,analyticsFrom:"onboarding",renderItemActionsButton:this.renderItemActionsButton,defaultActionButton:this.renderHelpButtonToURL((0,D.UY)("guides.importEvernote")),onComplete:this.props.onComplete,requestStore:this.stores.evernoteRequestStore,spaceStore:this.props.spaceStore,spaceViewStore:this.props.spaceViewStore,userSettingsStore:this.props.userSettingsStore})}renderCsvImportWithTooltip(){return(0,c.jsx)(ee.Z,{placement:ee.Z.Placement.Bottom,render:e=>(0,c.jsx)(ae,{tooltipEvents:e,title:"CSV",icon:u,onClick:()=>this.handleFileUploadClick("csv")}),renderTooltip:()=>(0,c.jsx)(h.FormattedMessage,{id:"importOptions.csvImport.tooltip",defaultMessage:"Ensure first row in the CSV is the header"})})}renderHelpButtonToURL(e,t,s,i){return(0,c.jsx)(ee.Z,{renderTooltip:()=>t??(0,c.jsx)(h.FormattedMessage,{id:"importOptions.helpButton.tooltip",defaultMessage:"Learn about how to import"}),style:{width:s??170},textWrap:!0,render:t=>(0,c.jsx)(q.Z,{external:!0,href:e,style:{marginLeft:"auto"},...t,children:(0,c.jsx)(G.Z,{icon:r.m,disableBackground:i??!1})})})}renderItemActionsButton(e){return(0,c.jsx)(H.ZP,{popupType:X.kQ.Popup,renderOrigin:e=>(0,c.jsx)(G.Z,{icon:o.o,...e}),render:t=>{const s={key:"section",render:e=>(0,c.jsx)(J.Z,{...e}),items:e.map((e=>{let{name:s,action:i}=e;return{key:s,render:e=>(0,c.jsx)(fe.Z,{...e,title:s}),action:()=>{i(),t.close()}}}))};return(0,c.jsx)(Q.Z,{menuType:F.og.Popup,width:200,children:(0,c.jsx)($.Z,{type:$.i.Vertical,initialFocus:void 0,sections:[s]})})}})}}lt.displayName="ImportOptions",lt.wrapStyle={display:"flex",alignItems:"center",justifyContent:"center",width:752,minHeight:240},lt.optionsColumnStyle={width:240};const dt=lt},15474:(e,t,s)=>{s.r(t),s.d(t,{IntegrationGalleryModal:()=>P});s(57658);var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(58573),l=s(2585),d=s(5257),c=s(35840),u=s(74181),m=s(72126),p=s(5366),g=s(42631),h=s(61202),f=s(80444),y=s(30874),v=s(49900),x=s(35878),S=s(42922),b=s(52275),M=s(73063),w=s(74194),j=s(3386),C=s(32163),k=s(50506),_=s(74136),T=s(72495),I=s(85893);function P(){window.__c={n:"IntegrationGalleryModal"};const e=(0,a.VK)((()=>v.d.state.open),[]),t=(0,n.Fy)(),s=(0,o.yK)((e=>({modal:{width:t.isMobile?"auto":"90vw",height:t.isMobile?"auto":"90vh",borderRadius:8}})),[t.isMobile]);return(0,I.jsx)(k.Z,{open:e,innerStyle:s.modal,onDismiss:()=>{v.d.setState({open:!1})},render:()=>(0,I.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"},children:[(0,I.jsx)(A,{}),(0,I.jsx)(Z,{})]})})}function Z(){window.__c={n:"GalleryModalDetail"};const e=(0,n.O7)(),t=(0,o.yK)((e=>({container:{width:"100%",height:"100%",overflow:"auto",flex:1,display:"flex",flexDirection:"column",alignItems:"stretch",background:e.contentBackground,color:e.regularTextColor,padding:20},text:{color:e.darkTextColor}})),[]),s=(0,a.VK)((()=>{const{currentSpaceStore:e}=f.default.state;return null==e?void 0:e.id}),[]),i=(0,a.VK)((()=>{if(v.d.state.open)return v.d.state.selectedIntegration}),[]),r=(0,a.VK)((()=>i?y.Z.externalAuthentications.state.filter((e=>e.integration_id===i.id)):[]),[i]);if(!i||!s)return null;const l=i.info.icon,d=i.name,c=i.info.developer_name,m=i.info.description,b=[];(0,u.mo)(i)&&b.push("linkPreview"),(0,u.zc)(i)&&b.push("databaseSync");const M=i.info.screenshots,w=M?(0,I.jsx)(F,{imageUrls:M},i.id):null;return(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)("div",{style:t.container,children:[w,(0,I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",paddingBottom:20},children:[(0,I.jsxs)("div",{style:{display:"flex"},children:[(0,I.jsx)("img",{src:l,style:{width:50,marginRight:10}}),(0,I.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,I.jsx)("span",{children:(0,I.jsx)("b",{style:{fontSize:18},children:d})}),(0,I.jsx)("span",{style:t.text,children:(0,I.jsx)(p.FormattedMessage,{id:"integrationGalleryModalDetail.madeBy.name",defaultMessage:"By {name}",values:{name:c}})})]})]}),(0,I.jsx)(S.Z,{style:{width:120},onClick:()=>(async t=>{await g.hM({environment:e,integration:t,spaceId:s,from:"integration_gallery"}),h.pJ({environment:e})})(i),children:r.length>0?(0,I.jsx)(p.FormattedMessage,{id:"integrationGalleryModalDetail.button.installAnother",defaultMessage:"Install another"}):(0,I.jsx)(p.FormattedMessage,{id:"integrationGalleryModalDetail.button.install",defaultMessage:"Install"})})]}),(0,I.jsx)("span",{style:{...t.text,fontSize:14},children:m}),(0,I.jsx)("div",{style:{display:"flex",marginTop:10},children:b.map(((e,t)=>e&&(0,I.jsx)(_.Z,{desktopStyle:{marginLeft:4},innerStyle:{fontSize:12},children:x.a_[e]},t)))})]})})}function F(e){window.__c={n:"ImageCarousel"};const{imageUrls:t}=e,[s,n]=(0,i.useState)(0),a=(0,o.yK)((e=>({heroImg:{width:"100%",objectFit:"contain",objectPosition:"top",paddingBottom:30},arrows:{fill:"#000"}})),[]),r=e=>{let i="right"===e?s+1:s-1;i<0&&(i=t.length-1),i>t.length-1&&(i=0),n(i)},c=t.length>0;return(0,I.jsxs)("div",{style:{width:"100%",position:"relative"},children:[c&&(0,I.jsx)(M.Z,{style:{position:"absolute",top:"50%",left:10},iconStyle:a.arrows,icon:l.f,onClick:()=>r("left")}),(0,I.jsx)("img",{style:a.heroImg,src:t[s]}),c&&(0,I.jsx)(M.Z,{style:{position:"absolute",top:"50%",right:10},iconStyle:a.arrows,icon:d.o,onClick:()=>r("right")})]})}function A(){window.__c={n:"GalleryModalSidebar"};const e=(0,p.useIntl)(),t=(0,o.yK)((e=>({sidebar:{height:"100%",width:275,background:e.sidebarBackground,alignContent:"center",display:"flex",flexDirection:"column",alignItems:"stretch",boxShadow:e.sidebarBoxShadow},header:{padding:"12px 12px 0 12px"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchBar:{height:32,borderRadius:5,fontSize:14,marginTop:0,marginBottom:8,padding:"16px 10px"},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.sidebarItemSelectedBackground,fontWeight:500}})),[]),[s,n]=(0,i.useState)(""),l=(0,a.VK)((()=>y.Z.integrations.state),[]),d=(0,a.VK)((()=>m.vM(y.Z.externalAuthentications.state,(e=>e.integration_id))),[]),u=(0,a.VK)((()=>{if(v.d.state.open)return v.d.state.selectedIntegration}),[]),g=(0,r.ZP)(s,l,(e=>e.name)),h=g.filter((e=>{var t;return null===(t=d[e.id])||void 0===t?void 0:t.length})),f=g.filter((e=>{var t;return!(null!==(t=d[e.id])&&void 0!==t&&t.length)})),x=[{key:"installed",render:e=>(0,I.jsx)(T.Z,{...e,title:"Installed"}),items:h.map((e=>({key:e.id,action:()=>{v.d.state.open&&v.d.setState({...v.d.state,selectedIntegration:e})},render:s=>(0,I.jsx)(b.Z,{...s,title:e.name,icon:(0,I.jsx)("img",{src:e.info.icon,style:{width:12}}),buttonStyle:{...e.id===(null==u?void 0:u.id)?t.selectedItem:void 0}})})))},{key:"not_installed",render:e=>(0,I.jsx)(T.Z,{...e,title:"Not Installed"}),items:f.map((e=>({key:e.id,action:()=>{v.d.state.open&&v.d.setState({...v.d.state,selectedIntegration:e})},render:s=>(0,I.jsx)(b.Z,{...s,title:e.name,icon:(0,I.jsx)("img",{src:e.info.icon,style:{width:12}}),buttonStyle:{...e.id===(null==u?void 0:u.id)?t.selectedItem:void 0}})})))}];return(0,I.jsxs)("div",{style:t.sidebar,children:[(0,I.jsx)("div",{style:t.header,children:(0,I.jsx)(j.Z,{capture:!0,onBackspace:m.yR,onLeft:m.yR,onRight:m.yR,onSelectAll:m.yR,onRedo:m.yR,onUndo:m.yR,onCut:m.yR,onCopy:m.yR,onPaste:m.yR,onKeypress:m.yR,onDelete:m.yR,onTab:m.yR,children:(0,I.jsx)(w.Z,{placeholder:e.formatMessage({id:"integrationGallery.sidebar.searchbar.placeholder",defaultMessage:"Search integrations"}),left:(0,c.R)(t.searchIcon),showClearButton:!0,format:w.Z.Format.Small,value:s,style:t.searchBar,onChange:e=>{n(e.target.value)}})})}),(0,I.jsx)(C.Z,{type:C.i.Vertical,initialFocus:0,sections:x})]})}},74661:(e,t,s)=>{s.r(t),s.d(t,{default:()=>T});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(66673),l=s(88145),d=s(64275),c=s(515),u=s(89101),m=s(82990),p=s(5366),g=s(50906),h=s(54642),f=s(34602),y=s(21969),v=s(4023),x=s(45946),S=s(42922),b=s(60458),M=s(73063),w=s(16354),j=s(53437),C=s(62385),k=s(64369),_=s(85893);function T(){window.__c={n:"OpenInDesktopAppPopup"};const e=(0,n.O7)(),t=(0,p.useIntl)(),[s,T]=(0,i.useState)(!0),{isDesktopBrowser:I,os:P}=(0,n.Fy)(),Z=(0,a.VK)((()=>e.RouterStore.state.route.name in c.c$),[e]),F=e.currentUser.isLoggedIn(),A=(0,a.VK)((()=>x.Z.state),[]),[D,B]=(0,i.useState)(!1),R=!D&&F&&void 0===A&&I&&("mac"===P||"windows"===P)&&Z&&x.Z.canPersistToLocalStorage(),[L,N]=(0,i.useState)(!1),E=R&&L,O=(0,i.useRef)(!1);(0,i.useEffect)((()=>{R&&!O.current&&(async function(e,t){const s=await h.getDesktopAppRegistration(e,{os:t});return"data"in s&&s.data.isRegistered}(e,P).then((e=>{N(e)})),O.current=!0)}),[R,N,e,P]);const V=(0,r.D9)(E);(0,i.useEffect)((()=>{E&&!V&&g.wWx(e)}),[E,V,e]);const U=(0,o.yK)((()=>({origin:{position:"fixed",left:"50%",top:"100%"},container:{bottom:20,padding:"8px 12px 12px",width:300},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},headerText:{fontSize:14,fontWeight:m.Z.fontWeight.medium},appDownloadButton:{fontSize:14,marginLeft:-5},appDownloadIcon:{width:14,height:14,marginRight:6},actions:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:8},alwaysOpenLinks:{display:"flex",alignItems:"center"},alwaysOpenLinksLabel:{marginLeft:6},alwaysOpenLinksButton:{paddingLeft:12,paddingRight:12,height:34}})),[]);return(0,_.jsx)(j.ZP,{popupType:j.kQ.Popup,placementToOrigin:v.u.Bottom,origin:(0,_.jsx)("div",{style:U.origin}),disableMouseCapture:!0,open:E,style:U.container,render:()=>(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)("div",{style:U.header,children:[(0,_.jsx)(k.Z,{style:U.headerText,children:(0,_.jsx)(p.FormattedMessage,{id:"openInDesktopAppPopup.header",defaultMessage:"Open in Notion's desktop app?"})}),(0,_.jsx)(M.Z,{ariaLabel:t.formatMessage({id:"openInDesktopAppPopup.closeButton",defaultMessage:"Dismiss"}),icon:d.D,onClick:()=>{x.Z.setState("never"),B(!0),g.ZyU(e)}})]}),(0,_.jsx)(w.Z,{href:u.AR.desktop,external:!0,onClick:()=>{g.iDe(e)},children:(0,_.jsxs)(C.Z,{style:U.appDownloadButton,children:[(0,l.E)(U.appDownloadIcon),(0,_.jsx)("span",{children:(0,_.jsx)(p.FormattedMessage,{id:"openInDesktopAppPopup.appDownloadButton",defaultMessage:"Don't have the app? Download"})})]})}),(0,_.jsxs)("div",{style:U.actions,children:[(0,_.jsxs)("div",{style:U.alwaysOpenLinks,children:[(0,_.jsx)(b.Z,{checked:s,size:16,onClick:()=>{T(!s)}}),(0,_.jsx)(k.Z,{isInline:!0,style:U.alwaysOpenLinksLabel,children:(0,_.jsx)(p.FormattedMessage,{id:"openInDesktopAppPopup.alwaysOpenLinksLabel",defaultMessage:"Always open in app",values:{strongtext:e=>(0,_.jsx)("strong",{children:e})}})})]}),(0,_.jsx)(S.Z,{style:U.alwaysOpenLinksButton,onClick:()=>{x.Z.setState(s?"always":"never"),B(!0),f.openInNativeApp({url:(0,y.W)(window.location.href),environment:e}),g.LC7(e,{always_open_in_app:s})},children:(0,_.jsx)(p.FormattedMessage,{id:"openInDesktopAppPopup.openInAppButton",defaultMessage:"Open in app",values:{strongtext:e=>(0,_.jsx)("strong",{children:e})}})})]})]})})}},18326:(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});s(67294);var i=s(83355),n=s(82990),a=s(5366),o=s(54564),r=s(47307),l=s(86282),d=s(39699),c=s(80444),u=s(56638),m=s(88923),p=s(50795),g=s(68785),h=s(40721),f=s(53437),y=s(31184),v=s(85893);class x extends i.Z{constructor(){super(...arguments),this.storeTypes={templateRecordCacheStore:p.$},this.renderMobilePopup=()=>{const e=u.Z.state;if(e.open)return(0,v.jsx)(h.default,{title:(0,v.jsx)(a.FormattedMessage,{defaultMessage:"Try this template",id:"pageTemplateModal.mobileModal.title"}),left:(0,v.jsx)(h.CancelMenuText,{}),onClickLeft:this.handleDismiss,right:e.isLoading?(0,v.jsx)(g.Z,{}):(0,v.jsx)(a.FormattedMessage,{defaultMessage:"Use",id:"pageTemplateModal.mobileModal.useButton.label"}),onClickRight:this.handleUseTemplateClick,forceFullScreenSlideUp:!0,children:this.renderPreview(e)})},this.handleDismiss=async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await this.showEditConfirmDialog()?this.accept(!0):this.close()}else this.close()},this.handleUseTemplateClick=async()=>{const{inMemoryRecordCache:e}=this.stores.templateRecordCacheStore.state;if(e.appliedTransaction){await this.showEditConfirmDialog()?this.accept(!0):this.accept(!1)}else this.accept(!1)}}willMountOrUpdate(){const e=u.Z.state,{currentSpaceViewStore:t}=c.default.state;e.open&&t&&d.createAndCommit({userAction:"PageTemplateModal.willMountOrUpdate",environment:this.environment,perform:s=>{l.GF({item:e.item,spaceViewStore:t,transaction:s})}})}renderComponent(){const{device:e}=this.environment,t=u.Z.state;if(e.isMobile)return(0,v.jsx)(f.GI,{open:t.open,render:this.renderMobilePopup,forceFullScreenSlideUp:!0,onDismiss:this.handleDismiss,popupType:f.GI.PopupType.SlideUp})}renderPreview(e){return(0,v.jsx)(y.Z,{previewRootId:e.item.previewRootId,isFrontPage:!1,style:x.previewMobileStyle,templateRecordCacheStore:this.stores.templateRecordCacheStore,disabled:!0},e.item.previewRootId)}accept(e){const{inMemoryRecordCache:t}=this.stores.templateRecordCacheStore.state,s=u.Z.state,{currentSpaceViewStore:i,currentSpaceStore:n,mainEditorCurrentBlockStore:a}=c.default.state;if(s.open&&i&&n){const o=a&&a.isEmptyPage()?a:void 0,r=m.default.state.open&&m.default.state.target&&m.default.state.target.isEmptyPage()?m.default.state.target:void 0;l.RL({environment:this.environment,item:s.item,spaceStore:n,spaceViewStore:i,useRecordCache:e?t:void 0,initializeStore:s.createNewPage?void 0:o||r,isPrivate:s.isPrivate,from:s.createNewPage?"sidebar":"newPage"})}}close(){l.xv(this.environment),o.LZ()}setCurrentItem(e){u.Z.state.open&&l.zO({templateItem:e,currentUserId:this.environment.currentUser.id})}showEditConfirmDialog(){return new Promise(((e,t)=>{r.showDialog({message:(0,v.jsx)(a.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.prompt",defaultMessage:"It looks like you've modified the template. Would you like to save your edits?"}),showCancel:!1,keepFocus:!0,items:[{label:(0,v.jsx)(a.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.saveButton.label",defaultMessage:"Save edits"}),onAccept:()=>{e(!0)}},{label:(0,v.jsx)(a.FormattedMessage,{id:"pageTemplateModal.modifiedTemplateDialog.discardEditsButton.label",defaultMessage:"Discard"}),color:"red",onAccept:()=>{e(!1)}}]})}))}getIconWrapStyle(){return{color:this.theme.regularTextColor,position:"relative"}}hoveredButtonStyle(){return{color:this.theme.regularTextColor,fontWeight:n.Z.fontWeight.medium}}fixedLinkStyle(){return{padding:12,color:this.theme.mediumTextColor,background:"dark"===this.theme.mode?this.theme.popoverBackground:this.theme.sidebarBackground,fontSize:13,fontWeight:n.Z.fontWeight.medium,display:"flex",alignItems:"center",position:"absolute",bottom:0,right:0,height:45,width:x.sidebarWidth,borderTop:`1px solid ${this.theme.regularDividerColor}`}}fixedLinkIconStyle(){return{width:12,height:12,marginLeft:8,marginRight:10,marginBottom:0,fill:this.theme.regularIconColor,fontWeight:n.Z.fontWeight.medium}}}x.displayName="PageTemplateModal",x.sidebarWidth=240,x.previewMobileStyle={width:"100%",flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",overflow:"hidden"},x.scrollerStyle={flexGrow:1,flexShrink:1,paddingBottom:44};const S=(0,a.injectIntl)(x)},76844:(e,t,s)=>{s.d(t,{Z:()=>a});s(67294);var i=s(72126),n=s(85893);const a=function(e){return e=i.f0({percent:.1},e),(0,n.jsxs)("div",{style:i.f0({position:"relative",minWidth:30,height:5,borderRadius:1,overflow:"hidden"},e.style),children:[(0,n.jsx)("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:"100%",background:"currentColor",opacity:.1}}),(0,n.jsx)("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:100*e.percent+"%",minWidth:2,background:"currentColor",opacity:.6}})]})}},57806:(e,t,s)=>{s.r(t),s.d(t,{PermissionsInviteBase:()=>F,default:()=>A});s(67294);var i=s(83355),n=s(8848),a=s(72126),o=s(94044),r=s(5366),l=s(50906),d=s(95209),c=s(43250),u=s(87279),m=s(45101),p=s(65598),g=s(18514),h=s(95697),f=s(18245),y=s(85834),v=s(1903),x=s(29677),S=s(90106),b=s(34583),M=s(35057),w=s(78140),j=s(40721),C=s(72495),k=s(83182),_=s(7567),T=s(44385),I=s(24145),P=s(43579),Z=s(85893);class F extends i.Z{constructor(){super(...arguments),this.renderInShareMenu=this.createComputedStore((()=>Boolean(this.props.renderInShareMenu&&!this.environment.device.isMobile))),this.inviteOrigin=this.createComputedStore((()=>this.props.store instanceof S.G?this.renderInShareMenu.state?"page_share_modal":"page_permission_modal":"space_share_modal")),this.defaultRoleForSpaceBot=this.createComputedStore((()=>"editor")),this.defaultRoleForNonBot=this.createComputedStore((()=>{const{store:e,isSubscribed:t}=this.props;return m.xT({environment:this.environment,store:e,isSubscribed:t})})),this.inputDebounce=void 0,this.storeTypes={permissionsInviteStore:v.Z,contextualInviteStore:y.ZP},this.handleUpgradeClick=()=>{d.Vu({environment:this.environment,upgradeButtonName:this.props.upgradeButtonName,onUpgradeButtonClick:this.props.onUpgradeButtonClick})},this.handleModalDismiss=async()=>{await d.kL({environment:this.environment,permissionsInviteStore:this.stores.permissionsInviteStore,from:"share_menu"})},this.handleInputChange=async e=>{var t;null===(t=this.inputDebounce)||void 0===t||t.cancel(),this.inputDebounce=a.Ds((()=>{l.UWw(this.environment,{invite_flow_id:this.stores.permissionsInviteStore.state.flowId,subscription_tier:(0,M.zt)(),invite_origin:this.inviteOrigin.state})}),1e3),this.inputDebounce(),await d.jC({environment:this.environment,event:e,permissionsInviteStore:this.stores.permissionsInviteStore})},this.handleClickRemoveToken=e=>{d.PV({targetToRemove:e,permissionsInviteStore:this.stores.permissionsInviteStore,defaultRoleForNonBot:this.defaultRoleForNonBot.state})}}async willMount(){await b.bi(this.environment)}willUnmount(){var e;null===(e=this.inputDebounce)||void 0===e||e.flush()}renderComponent(){if(this.renderInShareMenu.state)return this.renderComponentInShareMenu();const e=this.renderHeader(),t=this.renderSearchRequest();return this.renderComponentOriginal(e,t)}renderHeader(){const{permissionsInviteStore:e}=this.stores,{device:t}=this.environment;return(0,Z.jsx)(I.Z,{permissionsInviteStore:e,store:this.props.store,handleClickRemoveToken:e=>{this.handleClickRemoveToken(e)},handleInputChange:async e=>{await this.handleInputChange(e)},handleInputSubmit:async()=>{await this.handleInviteInputSubmit()},origin:Boolean(this.renderInShareMenu.state)?"share_menu":"share_modal",defaultRoleForNonBot:this.defaultRoleForNonBot.state,isTeamsEnabled:(0,h.bq)(),right:!t.isMobile&&this.renderDesktopInputRightInner(),focus:"invitee"===e.state.inputFocus||"invitee-popup-closed"===e.state.inputFocus,handleFocus:()=>{t.isMobile||e.setState({...e.state,inputFocus:"invitee"})}})}renderSearchRequest(){const{permissionsInviteStore:e}=this.stores,t=(0,p.OY)(this.props.store),s=(0,p.OY)(this.props.store);return(0,Z.jsx)(P.Z,{permissionsInviteStore:e,store:this.props.store,defaultRoleForSpaceBot:this.defaultRoleForSpaceBot.state,shouldShowBots:t,shouldShowGroups:s,sectionRenderLimit:this.renderInShareMenu.state?5:10,membersOnly:this.props.membersOnly})}renderComponentOriginal(e,t){const{device:s}=this.environment;let i;return i=s.isMobile?{menuType:u.og.Modal,title:(0,p.Mm)(this.props.store)?(0,Z.jsx)(r.FormattedMessage,{id:"inviteUserModal.addMemberMenu.title",defaultMessage:"Add members"}):(0,Z.jsx)(r.FormattedMessage,{id:"inviteUserModal.invitePersonMenu.title",defaultMessage:"Invite a person"}),right:(0,Z.jsx)("div",{style:{color:n.ZP.blue},children:(0,Z.jsx)(r.FormattedMessage,{id:"inviteUserModal.mobile.inviteButton.label",defaultMessage:"Invite"})}),left:(0,Z.jsx)(j.CancelMenuText,{}),onClickLeft:this.handleModalDismiss,onClickRight:async()=>{await this.handleInviteClick()},header:e}:{menuType:u.og.Popup,width:480,height:"60vh",header:e,tokenInputHeader:!0,footer:this.renderHelpButton(),disableScroller:!1},(0,Z.jsxs)(w.Z,{...i,className:c.FJA,children:[s.isMobile&&(0,Z.jsx)(C.Z,{title:(0,Z.jsx)(r.FormattedMessage,{id:"inviteUserModal.permissionLevel.title",defaultMessage:"Permission level"}),children:this.renderDesktopInputRightInnerSelect()}),(0,Z.jsx)("div",{children:t}),s.isMobile&&this.renderHelpButton()]})}renderHelpButton(){return this.renderInShareMenu.state?null:(0,Z.jsx)(C.Z,{topBorder:!0,disableDesktopPadding:!0,children:(0,Z.jsx)(k.Z,{title:(0,Z.jsx)(r.FormattedMessage,{id:"inviteUserModal.helpButton.caption",defaultMessage:"Learn how to invite people and set permissions"}),href:(0,g.UY)("guides.invitePerson"),analyticsFrom:"invite_person"})})}renderDesktopInputRightInner(){return(0,Z.jsxs)("div",{style:{marginLeft:o.p_,display:"flex",alignItems:"center"},children:[this.renderDesktopInputRightInnerSelect(),!this.renderInShareMenu.state&&this.renderDesktopInputRightInnerButton({isLarge:!0})]})}renderDesktopInputRightInnerButton(e){const{isLarge:t}=e;return(0,Z.jsx)(T.Z,{store:this.props.store,permissionsInviteStore:this.stores.permissionsInviteStore,handleUpgradeClick:()=>this.handleUpgradeClick(),handleInviteClick:()=>this.handleInviteClick(),disabled:this.props.disabled,isLarge:t})}renderDesktopInputRightInnerSelect(){const{device:e}=this.environment,{store:t}=this.props,{permissionsInviteStore:s}=this.stores;if(s.state.isInviteTargetsEmpty||!(0,x.ow)(s.state))return(0,Z.jsx)(_.ZP,{disabled:(0,p.Mm)(t)&&!t.canAdmin(),role:s.state.inviteRole,table:s.state.table,type:"user_permission",blockType:(0,p.OY)(t)?t.getType():void 0,isInvite:!0,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonStyle:{display:"flex",whiteSpace:"nowrap",height:26,color:n.ZP.uiGray,...this.renderInShareMenu.state&&{marginTop:e.isMobile?4:s.state.isInviteTargetsEmpty?1:6,marginBottom:e.isMobile?4:s.state.isInviteTargetsEmpty?1:6,marginRight:0}},isMenuItem:e.isMobile,onChange:e=>{d.XC({environment:this.environment,newRole:e,permissionsInviteStore:this.stores.permissionsInviteStore})}})}renderComponentInShareMenu(){const e={menuType:u.og.Popup,header:(0,Z.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"top",marginLeft:12,marginRight:12,gap:10},children:[this.renderHeader(),this.renderDesktopInputRightInnerButton({isLarge:!0})]}),footer:this.renderHelpButton(),disableScroller:!1};return(0,Z.jsx)("div",{style:{paddingTop:14,paddingBottom:14,paddingLeft:2,paddingRight:2},children:(0,Z.jsx)(w.Z,{...e,children:this.renderSearchRequest()})})}async handleInviteInputSubmit(){await this.handleInviteClick()}async handleInviteClick(){const e=f.default.mark("share_menu.invite_user_lag");await d.qg({environment:this.environment,store:this.props.store,sudoModeStore:this.props.sudoModeStore,permissionsInviteStore:this.stores.permissionsInviteStore,contextualInviteStore:this.stores.contextualInviteStore,onInviteClick:this.props.onInviteClick,onInviteComplete:this.props.onInviteComplete,inviteOrigin:this.inviteOrigin.state,intl:this.props.intl}),f.default.measure(e,{environment:this.environment})}}F.displayName="PermissionsInviteBase";const A=(0,r.injectIntl)(F)},44385:(e,t,s)=>{s.d(t,{Z:()=>y,e:()=>f});s(67294);var i=s(480),n=s(86628),a=s(5366),o=s(94044),r=s(47425),l=s(67669),d=s(45101),c=s(26781),u=s(4023),m=s(35057),p=s(42922),g=s(26388),h=s(85893);function f(){window.__c={n:"GuestLimitTooltip"};const e=(0,n.VK)((()=>(0,r.tP)((0,m.zt)())),[]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{children:(0,h.jsx)(a.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine1",defaultMessage:"Your plan allows up to {guestLimit} unique guests.",values:{guestLimit:e}})}),(0,h.jsx)("div",{children:(0,h.jsx)(a.FormattedMessage,{id:"inviteUserButton.modalTooltip.guestLimitLine2",defaultMessage:"Upgrade to go unlimited."})})]})}const y=function(e){window.__c={n:"PermissionsInviteButton"};const{store:t,permissionsInviteStore:s,handleUpgradeClick:r,handleInviteClick:m,isLarge:y}=e,v=(0,i.O7)(),[x]=(0,n.AF)(s),S=(0,n.VK)((()=>x.inviteTargets.some((e=>d.OA(e)))),[x]),b=(0,c.i)(t),M=(0,n.VK)((()=>{const e=x.inviteTargets,t=e.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),s=e.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return l.dA(v,[...t,...s])}),[v,x]),w=S?b:void 0;return(0,h.jsx)(g.Z,{alignment:u.v.Center,disableTooltip:!(M||w),renderTooltip:()=>M?(0,h.jsx)(f,{}):w,render:e=>(0,h.jsx)(p.Z,{isLarge:y,style:{minWidth:o.UF},disabled:Boolean(w),onClick:M?r:m,...e,children:M?(0,h.jsx)(a.FormattedMessage,{id:"inviteUserModal.inviteButton.upgradeLabel",defaultMessage:"Upgrade"}):(0,h.jsx)(a.FormattedMessage,{id:"inviteUserModal.inviteButton.label",defaultMessage:"Invite"})})})}},7378:(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});s(67294);var i=s(83355),n=s(41892),a=s(5366),o=s(1865),r=s(45101),l=s(65598),d=s(1903),c=s(78291),u=s(34583),m=s(35057),p=s(42922),g=s(9019),h=s(26388),f=s(57806),y=s(60442),v=s(85893);class x extends i.Z{constructor(){super(...arguments),this.storeTypes={permissionsInviteStore:d.Z},this.renderOverlay=()=>(0,v.jsx)(f.default,{...this.props,permissionsInviteStore:this.stores.permissionsInviteStore}),this.handleUpgradeClick=()=>{o.y(this.environment,{from:this.props.upgradeButtonName,for:"plus"}),this.props.onUpgradeButtonClick&&this.props.onUpgradeButtonClick()},this.handleButtonClick=()=>{(0,r.z5)({environment:this.environment,permissionsInviteStore:this.stores.permissionsInviteStore,store:this.props.store,renderInShareModal:!1,isSubscribed:this.props.isSubscribed})},this.handleModalDismiss=async()=>{const{permissionsInviteStore:e}=this.stores;await(0,r.Aw)({environment:this.environment,permissionsInviteStoreState:e.state,from:(0,l.Mm)(this.props.store)?"space_share_modal":"page_share_modal"})||e.reset()}}async willMount(){await u.bi(this.environment)}renderComponent(){const{store:e}=this.props,{modalOpen:t}=this.stores.permissionsInviteStore.state;let s,i,o=!1;return e.canEditMembership()?e.canEditMembership()&&(0,l.Mm)(e)&&c.default.state.data&&!m.Mk()?(s=!1,o=!0,i=(0,v.jsx)(y.Z,{imageURL:n.Z.images.tooltips.upsells.spaceReadAndWritePng,imageWidth:240,imageHeight:100,caption:(0,v.jsx)(a.FormattedMessage,{defaultMessage:"Members are teammates you invite to your workspace. They can access and add pages for all members to see, or be added to pages with permissions for private collaboration.",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.caption"}),title:(0,v.jsx)(a.FormattedMessage,{defaultMessage:"Upgrade to add members",id:"permissionsInvite.spaceAddMemberUpgradeTooltip.title"})})):s=!0:(s=!1,i=(0,l.Mm)(e)?(0,v.jsx)(a.FormattedMessage,{id:"inviteUserButton.tooltip.adminsOnlyMessage",defaultMessage:"Only admins can add members."}):(0,v.jsx)(a.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."})),(0,v.jsx)("div",{children:(0,l.Mm)(e)?(0,v.jsx)(g.Z,{open:t,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:(0,v.jsx)(h.Z,{renderTooltip:()=>i,disableTooltip:s,render:e=>(0,v.jsx)(p.Z,{isLarge:!0,onClick:o?this.handleUpgradeClick:this.handleButtonClick,disabled:!s&&!o,style:{flex:this.props.shouldGrow?1:0,...this.props.buttonStyle},...e,children:(0,v.jsx)(a.FormattedMessage,{id:"inviteUserButton.addMemberLabel",defaultMessage:"Add members"})})})}):(0,v.jsx)(g.Z,{open:t,onDismiss:this.handleModalDismiss,renderContent:this.renderOverlay,origin:null})})}}x.displayName="PermissionsInviteWithModal";const S=(0,a.injectIntl)(x)},3044:(e,t,s)=>{s.d(t,{Z:()=>P});s(57658);var i=s(67294),n=s(83355),a=s(49085),o=s(66897),r=s(72126),l=s(19889),d=s(70203),c=s(97880),u=s(5366),m=s(2985),p=s(87279),g=s(77080),h=s(49068),f=s(69582),y=s(52275),v=s(78140),x=s(32163),S=s(43765),b=s(40721),M=s(77137),w=s(72495),j=s(92864),C=s(47082),k=s(97680),_=s(85893);const T=(0,u.defineMessages)({searchForPerson:{defaultMessage:"Search for a person…",id:"database.personPropertyValue.searchPlaceholder"}});class I extends n.Z{constructor(){super(...arguments),this.inputValue=a.default.createValue(""),this.handlePersonPropertyMenuChange=e=>{const{schema:t,property:s}=this.props,i=t[s];if(!i||"person"!==i.type)return;let n;n=1===i.limit?e.length>0?[e[e.length-1]]:[]:e,this.props.onChange({value:n}),this.inputValue.setState("")}}willMount(e){super.willMount(e),e.insertChar&&this.inputValue.setState(e.insertChar)}renderComponent(){const{device:e}=this.environment,{disabled:t,intl:s,schema:n,property:a,isTemplatePage:I}=this.props,P=I&&g.default.checkGate("template-variable-properties"),Z=n[a];if(!Z||"person"!==Z.type)return;const F=[],A=this.props.value.map((s=>{if((0,d.D4X)(s))return F.push(s),(0,_.jsx)(f.w,{templateVariableType:s,showRemoveButton:!t,onRemove:()=>{const e=this.props.value.filter((e=>(0,o.Wk)(e)));this.props.onChange({value:e})},style:{margin:"0px 6px 6px 0px"}},s);if((0,o.Wk)(s)){const i=(0,o.Hl)({pointer:s,getRecordValue:this.props.parentStore.getRecordValue});return(0,_.jsx)(j.ZP,{actor:i,format:e.isMobile?j.ZP.Format.Large:j.ZP.Format.Medium,showRemoveButton:!t,onClickRemove:()=>{const e=this.props.value.filter((e=>(0,d.D4X)(e)||(0,o.Wk)(e)&&e.id!==s.id));this.props.onChange({value:e})},shouldShrink:!0,isSingle:!1},s.id)}(0,c.t1)(s)})),D=d.s8k.filter((e=>!F.includes(e))),B={request:{query:this.inputValue.state,actors:r.hX(this.props.value,o.Wk)},performRequest:async e=>{let{query:t,actors:s}=e;const{users:i}=await m.CO({environment:this.environment,query:t,membersOnly:!1});return{users:i.filter((e=>!s.some((t=>t.id===e.id)))).slice(0,20)}},render:(e,t,s)=>{if(e)return(0,_.jsx)(w.Z,{title:(0,h.$)(Z.limit),loading:!s,children:(0,_.jsx)(S.Z,{title:(0,_.jsx)(u.FormattedMessage,{defaultMessage:"Something went wrong.",id:"database.personPropertyMenu.searchErrorMessage"})})});if(t&&0===t.users.length)return(0,_.jsx)(w.Z,{title:(0,h.$)(Z.limit),loading:!s,children:(0,_.jsx)(S.Z,{title:(0,_.jsx)(u.FormattedMessage,{defaultMessage:"No results",id:"database.personPropertyMenu.noSearchResults.message"})})});const i=r.oA((t&&t.users||[]).map((e=>({key:e.id,render:t=>(0,_.jsx)(k.Z,{...t,actor:(0,o.dp)(e)}),action:()=>{this.handlePersonPropertyMenuChange([...this.props.value,{table:l.KJ,id:e.id}])}})))),n=r.oA([i.length>0?{key:"person section",render:e=>(0,_.jsx)(w.Z,{...e,title:(0,h.$)(Z.limit),loading:!s}),items:i}:void 0]);return(0,_.jsx)(x.Z,{type:x.i.Vertical,initialFocus:this.inputValue.state.length>0?0:void 0,sections:n})}},R=(0,_.jsx)(C.Z,{focus:!e.isMobile||void 0,focusAfterAnimation:!0,format:C.Z.Format.Person,tokens:A,placeholder:s.formatMessage(T.searchForPerson),hideInput:t,onRemoveLastToken:()=>{this.props.onChange({value:this.props.value.slice(0,this.props.value.length-1)})},value:this.inputValue.state,onChange:e=>this.inputValue.setState(e.target.value),dontShowBorderBottom:e.isAndroid});let L;return L=e.isMobile?{menuType:p.og.Modal,title:Z.name,right:(0,_.jsx)(b.DoneMenuText,{}),onClickRight:this.props.onDismiss,header:R}:{menuType:p.og.Popup,header:R,tokenInputHeader:!0,maxHeight:333},t?(0,_.jsx)(v.Z,{...L}):(0,_.jsxs)(v.Z,{...L,children:[P&&(0,_.jsx)(w.Z,{title:(0,_.jsx)(u.FormattedMessage,{defaultMessage:"Shortcuts",id:"PersonPropertyMenu.menuItem.shortcuts.label"}),children:D.length>0?(0,_.jsx)(i.Fragment,{children:D.map((e=>(0,_.jsx)(y.Z,{focused:!1,title:(0,_.jsx)(f.w,{templateVariableType:e}),caption:(0,d.Z08)(e,s),inline:!0,onClick:()=>{this.handlePersonPropertyMenuChange([...this.props.value,e])}},`relative-person-shortcut-${e}`)))}):(0,_.jsx)(S.Z,{title:(0,_.jsx)(u.FormattedMessage,{id:"database.personPropertyMenu.noShorcuts.message",defaultMessage:"No shortcuts"})})}),(0,_.jsx)(M.Z,{...B})]})}}I.displayName="PersonPropertyMenu";const P=(0,u.injectIntl)(I)},1244:(e,t,s)=>{s.r(t),s.d(t,{default:()=>U});var i=s(67294),n=s(83355),a=s(480),o=s(86628),r=s(24405),l=s(41892),d=s(8848),c=s(64275),u=s(72126),m=s(89101),p=s(60949),g=s(82990),h=s(5366),f=s(50906),y=s(29974),v=s(97627),x=s(39699),S=s(37181),b=s(36867),M=s(75538),w=s(80444),j=s(4926),C=s(77080),k=s(5188),_=s(49085);class T extends _.default{getInitialState(){return{open:!1,step:"prompt"}}}const I=new T;var P=s(23063),Z=s(42922),F=s(64921),A=s(28451),D=s(3386),B=s(89728),R=s(53437),L=s(42402),N=s(29551),E=s(38294),O=s(85893);class V extends n.Z{constructor(){super(...arguments),this.hasSeenInitial=!1,this.renderMenu=()=>(0,O.jsx)(A.P,{calloutId:"persona_collection",children:(0,O.jsxs)("div",{style:this.getContainerStyle(),children:[this.renderCancel(),(0,O.jsx)(N.gq,{style:this.getInnerContainerStyle(),alignItems:"center",alignContent:"center",children:this.renderStep()})]})}),this.renderInitial=()=>{const e=this.environment.currentUser.id;if(!I.state.open||!e)return;this.hasSeenInitial||(f.q5U(this.environment,{user_id:e,event:"initial"}),this.hasSeenInitial=!0);const{invalidField:t}=I.state;return(0,O.jsxs)("div",{style:{...this.getSlideUpStyle(),padding:8},children:[(0,O.jsx)("img",{style:{width:40,height:32},src:l.Z.images.chatButtonSmallPng}),(0,O.jsx)("div",{style:{fontSize:14,fontWeight:g.Z.fontWeight.semibold,paddingTop:0,paddingBottom:8},children:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.header",defaultMessage:"Tell us more about yourself"})}),(0,O.jsx)("div",{style:{fontSize:12,color:this.theme.mediumTextColor,width:270,margin:"0 auto"},children:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.caption",defaultMessage:"We would love to learn more about you so we can make our product better serve you"})}),(0,O.jsx)("div",{style:{...this.getLabelStyle(),marginTop:10},children:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.roleLabel",defaultMessage:"What is your role?"})}),(0,O.jsx)(E.Z,{questionType:"role",title:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.roleLabel",defaultMessage:"Role"}),question:I.state.role,invalid:"role"===t,onSelect:e=>{I.state.open&&I.setState({...I.state,role:e,step:"initial"})}}),(0,O.jsx)("div",{style:this.getLabelStyle(),children:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.workLabel",defaultMessage:"What kind of work do you do?"})}),(0,O.jsx)(E.Z,{questionType:"work",title:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.workLabel",defaultMessage:"Work"}),question:I.state.work,invalid:"work"===t,onSelect:e=>{I.state.open&&I.setState({...I.state,work:e,step:"initial"})}}),(0,O.jsx)("div",{style:this.getLabelStyle(),children:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.questionLabel",defaultMessage:"What are you planning to use Notion for?"})}),(0,O.jsx)(E.Z,{questionType:"use",title:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.useLabel",defaultMessage:"Use"}),question:I.state.use,invalid:"use"===t,onSelect:e=>{I.state.open&&I.setState({...I.state,use:e,step:"initial"})}}),(0,O.jsx)("div",{style:this.getLabelStyle(),children:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.companySizeLabel",defaultMessage:"Company size"})}),(0,O.jsx)(N.gq,{children:this.getCompanySizeButtonData().map((e=>{let{type:t,message:s,style:i}=e;return(0,O.jsx)(B.Z,{isLightGray:!0,isLarge:!0,style:{...this.getBaseButtonStyle(),...I.state.open&&I.state.companySize===t&&this.getSelectedButtonStyle(),...i},onClick:()=>{I.state.open&&I.setState({...I.state,companySize:t,step:"initial"})},children:s},t)}))})]})},this.renderCancel=()=>(0,O.jsx)(F.Z,{onClick:this.handleCancel,style:this.getCancelStyle(),hoveredStyle:{background:this.theme.buttonPressedBackground},children:(0,c.D)({width:14,fill:this.theme.mediumTextColor})}),this.renderThanks=()=>{const e=this.environment.currentUser.id;if(e)return(0,O.jsx)(z,{userId:e})},this.renderPrompt=()=>{const e=this.environment.currentUser.id;if(e)return(0,O.jsx)(W,{userId:e})},this.handleCancel=()=>{const{currentUserSettingsStore:e}=w.default.state,t=this.environment.currentUser.id;e&&t&&(f.jPN(this.environment,{user_id:t,event:"cancel"}),x.createAndCommit({userAction:"PersonaCollectionModal.handleCancel",environment:this.environment,perform:t=>{S.d2({userSettingsStore:e,data:{seen_persona_collection:!0},transaction:t})}}),I.reset())}}willMountOrUpdate(){var e;if(I.state.open)return;const t=this.environment,s=t.currentUser.id,i=(0,b.g)(s),{currentUserSettingsStore:n,inAppCalloutStore:a}=w.default.state;if(!n||t.device.isMobile)return;if(i<3)return;const o=n.getSettings();if(!o)return;if(Boolean(o.seen_persona_collection||(null===(e=o.persona_version)||void 0===e?void 0:e.version)))return;const r="on"===C.default.getEligibleGroup({experimentId:"persona_collection",defaultGroup:"unassigned"});!M.default.state.isOnboarding&&"closed"!==I.state.step&&!1===k.Z.state.open&&a.canShow("persona_collection")&&r&&I.setState({...I.state,open:!0})}renderComponent(){return(0,O.jsx)(R.GI,{keepFocus:!1,open:I.state.open,render:this.renderMenu,onDismiss:this.handleCancel,popupType:R.kQ.Popup,disableDarkOverlayBackground:!0,disableMouseCapture:!0})}renderStep(){if(!1===I.state.open)return;const{step:e}=I.state;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(P.Z,{isVisible:"initial"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,O.jsx)(D.Z,{capture:!0,onBackspace:u.yR,onLeft:u.yR,onRight:u.yR,onSelectAll:u.yR,onRedo:u.yR,onUndo:u.yR,onCut:u.yR,onCopy:u.yR,onPaste:u.yR,onKeypress:u.yR,onDelete:u.yR,onTab:u.yR,children:this.renderInitial()})}),(0,O.jsx)(P.Z,{isVisible:"prompt"===e,animationStyle:this.getAnimationStyle("prompt"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderPrompt}),(0,O.jsx)(P.Z,{isVisible:"thanks"===e,animationStyle:this.getAnimationStyle("thanks"===e),enterAnimationStyle:this.getEnterExitAnimationStyle(),exitAnimationStyle:this.getEnterExitAnimationStyle(),render:this.renderThanks}),(0,O.jsx)(P.Z,{isVisible:"initial"===e,enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,O.jsx)(Z.Z,{isLarge:!0,style:{marginTop:17,width:270,position:"absolute",bottom:20},onClick:()=>this.handleSubmitClick(),children:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.sendLabel",defaultMessage:"Submit"})})})]})}getInvalidField(){if(!I.state.open)return"closed";const{use:e,role:t,work:s,companySize:i}=I.state;return i?e?t?s?void 0:"work":"role":"use":"company_size"}getCompanySizeButtonData(){return[{type:"1_100",message:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.1_100Label",defaultMessage:"1-100"})},{type:"101_1000",message:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.101_1000Label",defaultMessage:"101-1,000"}),style:{marginLeft:8,marginRight:8}},{type:"1001+",message:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.initial.1000PlusLabel",defaultMessage:"1,001+"})}]}handleSubmitClick(){const e=this.environment.currentUser.id;if(!I.state.open||!e)return;const t=this.getInvalidField();if(t)return void I.setState({...I.state,step:"initial",invalidField:t});f.jPN(this.environment,{user_id:e,event:"submit"});const{currentUserSettingsStore:s}=w.default.state;if(s&&I.state.open){const e=I.state;if(x.createAndCommit({userAction:"PersonaCollectionModal.handleSubmitClick",environment:this.environment,perform:t=>{S.d2({userSettingsStore:s,data:{seen_persona_collection:!0,persona:e.work,team_role:e.role,use_case:e.use,source:"persona_collection",persona_version:{version:"V3",timestamp:(new Date).getTime()}},transaction:t})}}),C.default.checkGate("survey_data_writes")){const t=(new Date).getTime(),s=p.Dh({maybeFunction:e.work,guessedFunctionVersion:4,maybeRole:e.role,guessedRoleVersion:2,collectedFrom:"inapp_modal",collectedAt:t});void 0!==s&&v.Q1(this.environment,s);const i=p.K0({maybeCompanySize:e.companySize,guessedCompanySizeVersion:1,maybeUseCases:[e.use],guessedUseCasesVersion:3,collectedFrom:"inapp_modal",collectedAt:t});void 0!==i&&y.wg(this.environment,i)}}I.setState({...I.state,invalidField:void 0,step:"thanks"}),u.gw((()=>{I.reset()}),6e3)}getContainerStyle(){return{background:this.theme.popoverBackground,borderRadius:5,boxShadow:this.theme.mediumBoxShadow,position:"fixed",bottom:65+j.Z.state,right:16+j.Z.state}}getBackgroundStyle(){return{backgroundColor:"transparent",pointerEvents:"none"}}getCancelStyle(){return{position:"absolute",top:"10px",right:"10px",background:this.theme.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10}}getInnerContainerStyle(){return{width:320,height:"prompt"===I.state.step||"thanks"===I.state.step?200:450,overflow:"hidden",position:"relative",right:"auto",padding:30,paddingTop:0,cursor:"default",textAlign:"center",justifyContent:"center"}}getLabelStyle(){return{marginTop:10,fontSize:12,color:this.theme.mediumTextColor,fontWeight:g.Z.fontWeight.medium,lineHeight:"135%",marginBottom:4,textAlign:"left"}}getAnimationStyle(e){return{opacity:e?1:0,scale:e?1:.96}}getEnterExitAnimationStyle(){return{opacity:0,scale:.96}}getBaseButtonStyle(){return{border:"1px solid #E7E6E5",flexGrow:1,justifyContent:"center"}}getSelectedButtonStyle(){return{color:d.ZP.blue,border:`1px solid ${d.ZP.blue}`}}getSlideUpStyle(){if(!I.state.open)return{};const{step:e}=I.state;return{position:"absolute",transition:"transform 200ms ease",transform:"initial"===e?"translateY(0px)":"translateY(-180px)"}}}V.displayName="PersonaCollectionModal";const U=V;function W(e){window.__c={n:"PersonaCollectionPrompt"};const[t,s]=(0,o.AF)(I),n=(0,r.yK)((e=>({promptHeaderStyle:{color:e.regularTextColor,fontWeight:g.Z.fontWeight.semibold,fontSize:14},promptTextStyle:{fontSize:12,color:e.mediumTextColor,width:270,margin:"0 auto"}})),[]),d=(0,a.O7)();return(0,i.useEffect)((()=>{f.q5U(d,{user_id:e.userId,event:"prompt"})}),[d,e.userId]),(0,O.jsxs)("div",{style:{paddingTop:24},children:[(0,O.jsx)("img",{style:{width:40,height:56,paddingTop:24},src:l.Z.images.chatButtonSmallPng}),(0,O.jsx)("div",{style:n.promptHeaderStyle,children:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.prompt.header",defaultMessage:"Tell us more about yourself"})}),(0,O.jsx)("div",{style:n.promptTextStyle,children:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.prompt.caption",defaultMessage:"We would love to learn more about you so we can make our product better serve you"})}),(0,O.jsx)(Z.Z,{isLarge:!0,style:{marginTop:6,width:260,bottom:20},onClick:()=>{!0===t.open&&s({...t,step:"initial"});const{currentUserSettingsStore:e}=w.default.state;e&&x.createAndCommit({userAction:"PersonaCollectionModal.PersonaCollectionPrompt",environment:d,perform:t=>{S.d2({userSettingsStore:e,data:{seen_persona_collection:!0},transaction:t})}})},children:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.prompt.survey",defaultMessage:"Take the 20 second survey"})}),(0,O.jsx)(B.Z,{isLightGray:!0,isLarge:!0,onClick:()=>{const{currentUserSettingsStore:t}=w.default.state;t&&e.userId&&(x.createAndCommit({userAction:"PersonaCollectionModal.PersonaCollectionPrompt",environment:d,perform:e=>{S.d2({userSettingsStore:t,data:{seen_persona_collection:!0},transaction:e})}}),f.jPN(d,{user_id:e.userId,event:"skip"}),I.setState({open:!1,step:"closed"}))},children:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.prompt.skipLabel",defaultMessage:"Skip"})})]})}function z(e){window.__c={n:"PersonaCollectionThanks"};const t=(0,r.yK)((e=>({thanksHeaderStyle:{color:e.regularTextColor,fontWeight:g.Z.fontWeight.semibold,fontSize:14}})),[]),s=(0,a.O7)();return(0,i.useEffect)((()=>{f.q5U(s,{user_id:e.userId,event:"thanks"})}),[s,e.userId]),(0,O.jsxs)("div",{children:[(0,O.jsx)("img",{style:{width:208,height:89,paddingTop:30},src:l.Z.images.heroIllustrationPng}),(0,O.jsx)("div",{style:t.thanksHeaderStyle,children:(0,O.jsx)(h.FormattedMessage,{id:"PersonaCollectionModal.thanks.caption",defaultMessage:"Thank you! Discover new ways to use Notion in the <textlink>Template Gallery</textlink>",values:{textlink:t=>(0,O.jsx)(L.Z,{disableUnderline:!0,disableHover:!0,href:m._j.templates,external:!0,style:{color:d.ZP.blue,fontSize:g.Z.fontSize.UIRegular.desktop,fontWeight:500},onClick:()=>{e.userId&&f.jPN(s,{user_id:e.userId,event:"template_gallery"})},children:t})}})})]})}},38294:(e,t,s)=>{s.d(t,{Z:()=>S});s(67294);var i=s(83355),n=s(8848),a=s(37240),o=s(29091),r=s(5366),l=s(52275),d=s(63296),c=s(45959),u=s(64369),m=s(85893);const p="other",g={exec:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.exec",defaultMessage:"Executive (C-level / VP)"}),dept_lead:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.dept_lead",defaultMessage:"Department lead"}),team_manager:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.team_manager",defaultMessage:"Team manager"}),member:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.member",defaultMessage:"Team member"}),solo:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.solo",defaultMessage:"Solo-preneur / Freelancer"}),personal:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.roleQuestion.personal",defaultMessage:"Using Notion just for myself"})},h={creative:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.creative",defaultMessage:"Creative"}),founderCeo:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.founderCeo",defaultMessage:"Founder / CEO"}),internalCommunication:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.internalCommunication",defaultMessage:"Internal Communication"}),eng:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.eng",defaultMessage:"Engineering"}),productDesign:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.productDesign",defaultMessage:"Product Design"}),projectProgramMgmt:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.projectProgramMgmt",defaultMessage:"Project / Program Management"}),product:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.question.product",defaultMessage:"Product Management"}),marketing:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.marketing",defaultMessage:"Marketing"}),sales:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.sales",defaultMessage:"Sales"}),support:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.support",defaultMessage:"Customer Service"}),finance:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.finance",defaultMessage:"Finance"}),hr:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.hr",defaultMessage:"Human Resources"}),itAdmin:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.itAdmin",defaultMessage:"IT Admin"}),knowledgeManagement:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.knowledgeManagement",defaultMessage:"Knowledge Management"}),operations:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.operations",defaultMessage:"Operations"}),educator:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.educator",defaultMessage:"Educator"}),other:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.other",defaultMessage:"Other"}),student:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.workQuestion.student",defaultMessage:"Student"})},f={student:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.schoolQuestion.student",defaultMessage:"Student"}),educator:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.schoolQuestion.educator",defaultMessage:"Educator"}),other:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.schoolQuestion.other",defaultMessage:"Other"})},y={docs:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.docs",defaultMessage:"Collaborate with others in docs"}),wikis:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.wikis",defaultMessage:"Create a knowledge base / wiki"}),notes:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.notes",defaultMessage:"Write notes"}),project:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.project",defaultMessage:"Manage projects"}),goals:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.goals",defaultMessage:"Track company goals and OKRs"}),ai:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.question.ai",defaultMessage:"Write with AI"}),other:(0,m.jsx)(r.FormattedMessage,{id:"PersonaCollectionModalQuestionSelect.useQuestion.other",defaultMessage:"Other"})},v={"1_49":(0,m.jsx)(r.FormattedMessage,{id:"OnboardingSurvey.companySize.question.1_49",defaultMessage:"1-49"}),"50_99":(0,m.jsx)(r.FormattedMessage,{id:"OnboardingSurvey.companySize.question.50_99",defaultMessage:"50-99"}),"100_299":(0,m.jsx)(r.FormattedMessage,{id:"OnboardingSurvey.companySize.question.100_299",defaultMessage:"100-299"}),"300_999":(0,m.jsx)(r.FormattedMessage,{id:"OnboardingSurvey.companySize.question.300_999",defaultMessage:"300-999"}),"1000_5000":(0,m.jsx)(r.FormattedMessage,{id:"OnboardingSurvey.companySize.question.1000_5000",defaultMessage:"1000-5000"}),"5000+":(0,m.jsx)(r.FormattedMessage,{id:"OnboardingSurvey.companySize.question.5000+",defaultMessage:"5000+"})};class x extends i.Z{renderComponent(){const{question:e,questionType:t,title:s,randomizeSelectionOrder:i,className:o,width:p,placeholder:x}=this.props,{device:S}=this.environment;let b={};"role"===t&&(b=g),"school"===t&&(b=f),"work"===t&&(b=h),"use"===t&&(b=y),"companySize"===t&&(b=v);const M={menuTitle:s,items:this.getPersonaSelectionMessages(b,i,this.environment.currentUser.id),width:p||280,disabled:this.props.disabled||!1,getKey:e=>e,selectedItem:t,originGap:4,onSelect:e=>{this.props.onSelect(e)},renderItem:e=>(0,m.jsx)(l.Z,{title:b[e.key],...e,className:`${o}-${e.key}`}),renderOrigin:t=>(0,m.jsxs)(d.Z,{...t,isLarge:!0,style:{...this.getInputStyle(),...this.props.invalid&&{border:`1px solid ${n.ZP.red}`},...this.props.styles},className:o,focused:this.props.focus,children:[(0,m.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,m.jsx)(u.Z,{isMobile:S.isMobile,isSecondaryColor:!Boolean(e),children:e?b[e]:x||(0,m.jsx)(r.FormattedMessage,{defaultMessage:"Select response",id:"PersonaCollectionModal.selectQuestion.label"})})}),(0,a.s)({width:10,fill:this.theme.lightIconColor})]})};return(0,m.jsx)(c.Z,{...M},"persona")}getInputStyle(){const{device:e}=this.environment;return{backgroundColor:this.theme.whiteButtonBackground,height:e.isMobile?44:32,padding:"2px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:3,border:0,transition:"box-shadow 0.3s ease",boxShadow:`0 0 0 1px ${this.theme.outlineButtonBorder}`,background:this.theme.buttonBackground}}getPersonaSelectionMessages(e,t,s){const i=Object.keys(e);if(!t)return i;const n=(0,o.yH)(s);return i.filter((e=>e!==p)).sort((()=>n()-.5)).concat(i.filter((e=>e===p)))}}x.displayName="PersonaCollectionModalQuestionSelect";const S=(0,r.injectIntl)(x)},73099:(e,t,s)=>{s.r(t),s.d(t,{default:()=>de});var i=s(67294),n=s(480),a=s(86628),o=s(15145),r=s(86658),l=s(15769),d=s(88437),c=s(43876),u=s(27714),m=s(45238),p=s(85893);const g=(0,m.I)("loginArrow",{viewBox:"0 0 16 12",svg:(0,p.jsx)("path",{d:"M8.65 11.116a.615.615 0 00.444-.184l4.546-4.54a.66.66 0 00.205-.39v4.526c0 .349.253.588.608.588.356 0 .615-.239.615-.588V1.361a.59.59 0 00-.615-.608.585.585 0 00-.608.608v4.512a.698.698 0 00-.205-.396L9.094.944a.623.623 0 00-.445-.191.58.58 0 00-.594.588c0 .164.054.328.164.437L9.75 3.33l2.242 2.05-1.456-.054h-9.01c-.355 0-.601.253-.601.609 0 .355.246.615.601.615h9.01L12 6.495 9.75 8.54l-1.531 1.559a.616.616 0 00-.164.43c0 .342.26.588.594.588z"})});var h=s(60651),f=s(25651),y=s(18442),v=s(45137),x=s(89101),S=s(64002),b=s(5366),M=s(14871),w=s(47307),j=s(3297),C=s(40277),k=s(34602),_=s(29974),T=s(10182),I=s(93405),P=s(72495),Z=s(19037),F=s(28020),A=s(84210),D=s(33929),B=s(80444),R=s(83212),L=s(82763),N=s(62967),E=s(68714),O=s(62466);const V=(0,b.defineMessages)({whatIsNotionName:{id:"action.whatIsNotion.name",defaultMessage:"What is Notion?"},createNotionPageName:{id:"action.createNotionPage.name",defaultMessage:"Create your own Notion page"},signUpOrLogInName:{id:"action.signUpOrlogIn.name",defaultMessage:"Sign up or log in"},loginName:{id:"action.logIn.name",defaultMessage:"Log in"},shareLinkName:{id:"action.shareLink.name",defaultMessage:"Share link"},editPageName:{id:"action.editPage.name",defaultMessage:"Edit"},commentPageName:{id:"action.commentPage.name",defaultMessage:"Comment"},duplicatePageName:{id:"action.duplicatePage.name",defaultMessage:"Duplicate page"},backtoNotionName:{id:"action.backtoNotion.name",defaultMessage:"Back to Notion"}}),U=(0,S.SK)(x._j.signup,{try_notion_cta:"mobile"}),W=(0,N.cN)({key:"Create Notion Page",displayName:V.createNotionPageName,analyticsName:V.createNotionPageName.defaultMessage,svg:h.h,validators:[Z.ff(Z.jl),Z.ff(Z.tY)],closeParentMenu:!0,action:e=>{let{environment:t}=e;k.navigateOnBaseUrl({environment:t,url:U})}}),z=(0,N.cN)({key:"log in",displayName:V.signUpOrLogInName,analyticsName:V.signUpOrLogInName.defaultMessage,svg:g,validators:[Z.ff(Z.jl)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;await k.publicPageTopBarAction(t,{utmContent:"sign_up_or_log_in",nextRoute:x._j.login})}}),K=(0,N.cN)({key:"log in",displayName:V.loginName,analyticsName:V.loginName.defaultMessage,svg:g,validators:[Z.ff(Z.jl)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;k.navigateOnBaseUrl({environment:t,url:x._j.login,extraSearchParams:await k.generatePartnerStackPathParam(t)})}}),H=(0,N.cN)({key:"ios share link",displayName:V.shareLinkName,analyticsName:V.shareLinkName.defaultMessage,svg:c.s,validators:[Z.U7,Z.Fx,Z.gn],closeParentMenu:!0,action:e=>{let{blocks:t,environment:s}=e;const i=t[0],n=i.getNavigableBlockStore();if(n){const e=(0,A.ZP)({store:n,scrollToBlockId:n.id===i.id?void 0:i.id,fullyQualified:!0,pageVisitSource:o.tY.NativeShareLink});s.mobileNative&&s.mobileNative.share(e)}}}),G=(0,N.cN)({key:"android share link",displayName:V.shareLinkName,analyticsName:V.shareLinkName.defaultMessage,svg:l.Q,validators:[Z.U7,Z.Fx,Z.Dt],closeParentMenu:H.closeParentMenu,action:H.action}),q=(0,N.cs)({key:"copy link",displayName:N.RE.copyLinkName,analyticsName:N.RE.copyLinkName.defaultMessage,svg:u.N,shortcuts:["copyLinkToBlock"],validators:[Z.jl,Z.U7,Z.ff(Z.Fx),Z.ff(Z.DF)],closeParentMenu:!0,action:(e,t)=>{M.Hs({...e,event:t})}}),Y=(0,N.cN)({key:"edit page",displayName:V.editPageName,analyticsName:V.editPageName.defaultMessage,svg:f.R,validators:[Z.U7,Z.DF,Z.Zk,Z.ff(Z.eM)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;const{RouterStore:i}=t,n=i.state.route,a=F.np();if("page"===n.name&&n.requestedOnPublicDomain&&a){const e=(0,A.ZP)({store:a,preferPublicLink:!1,pageVisitSource:o.tY.EditPublicPage});k.navigateOnBaseUrl({environment:t,url:e})}else t.currentUser.isLoggedIn()?w.showDialog({showCancel:!0,keepFocus:!1,message:(0,p.jsx)(b.FormattedMessage,{defaultMessage:"When you start editing, your name, email and photo may become visible to anyone who can view the page.",id:"action.startPublicEditDialog.message"}),items:[{label:(0,p.jsx)(b.FormattedMessage,{defaultMessage:"Continue",id:"action.startPublicEditDialog.continueLabel"}),color:"blue",onAccept(){R.Z.setState({editing:!0,commenting:!0})}}]}):(C.Hr({currentUserId:t.currentUser.id,blockId:s[0].id}),k.navigateOnBaseUrl({environment:t,url:x._j.login}))}}),Q=(0,N.cN)({key:"comment page",displayName:V.commentPageName,analyticsName:V.commentPageName.defaultMessage,svg:v.o,validators:[Z.U7,Z.DF,Z.RF,Z.ff(Z.jl)],closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;C.Hr({currentUserId:t.currentUser.id,blockId:s[0].id}),k.navigateOnBaseUrl({environment:t,url:x._j.login})}}),$=(0,N.cN)({key:"duplicate page",displayName:V.duplicatePageName,analyticsName:V.duplicatePageName.defaultMessage,svg:d.a,validators:[Z.U7,Z.tq,Z.DF,Z.S4],closeParentMenu:!0,action:e=>{let{blocks:t,originRect:s,environment:i}=e;j.S({environment:i,store:t[0],originRect:s})}}),X=(0,N.cN)({key:"back to my content",displayName:V.backtoNotionName,analyticsName:V.backtoNotionName.defaultMessage,svg:h.h,validators:[Z.jl,Z.tq],closeParentMenu:!0,action:(e,t)=>{let{environment:s}=e;const{currentUserRootStore:i,currentUserSettingsStore:n}=B.default.state;i&&n&&_.L5({environment:s,userRootStore:i,userSettingsStore:n,pageVisitSource:o.tY.SwitchSpace})}}),J=(0,N.cN)({key:"cookie settings",displayName:r.ze.cookieSettingsLabel,analyticsName:r.ze.cookieSettingsLabel.defaultMessage,validators:[Z.ff(Z.tY)],closeParentMenu:!1,render:e=>(0,p.jsx)(T.Z,{hasDismissButton:!1,renderOrigin:t=>{const{onClick:s,...i}=e;return(0,p.jsx)(I.Z,{...i,...t,title:D.default.formatMessage(r.ze.cookieSettingsLabel),svg:y.H})}}),action:()=>{}}),ee=(0,N.cN)({key:"What is Notion?",displayName:V.whatIsNotionName,analyticsName:V.whatIsNotionName.defaultMessage,svg:h.h,validators:[Z.ff(Z.jl),Z.ff(Z.tY)],closeParentMenu:!0,action:async e=>{let{environment:t}=e;await k.publicPageTopBarAction(t,{utmContent:"what_is_notion",nextRoute:x._j.product})}}),te=[(0,N.$J)({key:"page",render:e=>(0,p.jsx)(P.Z,{...e}),actions:[W,O.y,K,Y,Q,$,q,L.K,H,G,X,E.l,J]})],se=[(0,N.$J)({key:"page",render:e=>(0,p.jsx)(P.Z,{...e}),actions:[ee,Y,Q,$,q,L.K,H,G]}),(0,N.$J)({key:"user",render:e=>(0,p.jsx)(P.Z,{...e}),actions:[X,z]}),(0,N.$J)({key:"report page actions",render:e=>(0,p.jsx)(P.Z,{...e}),actions:[E.l,J]})];var ie=s(50906),ne=s(12955),ae=s(87279),oe=s(35328),re=s(48019),le=s(78140);const de=function(e){let{block:t,onDismiss:s}=e;window.__c={n:"PublicTopbarMoreMenu"};const o=(0,n.O7)(),{currentUser:r,device:l}=o,d=Boolean(r.isLoggedIn()||(0,ne.getPublicDomainUserId)(o)),c=(0,a.VK)((()=>R.Z.getMode(o,t)),[o,t]),u={environment:o,blocks:[t],publicEditMode:c};let m;m=l.isMobile?{menuType:ae.og.ActionSheet}:{menuType:ae.og.Popup,width:210,maxHeight:"80vh"};const g=(0,i.useCallback)((e=>{const{mainEditorCurrentBlockStore:t}=B.default.state;if(t){const s=t.getType();s&&ie.dhV(o,{analyticsName:e.analyticsName,from:"public_topbar_more_menu",block_id:t.id,block_type:s,is_toggleable:(0,oe._A)(s,t.getFormat())})}e.closeParentMenu&&s()}),[o,s]),h=!d&&l.isMobile?te:se;return(0,p.jsx)(le.Z,{...m,children:(0,p.jsx)(re.Z,{sections:h,onAccept:g,context:u})})}},46978:(e,t,s)=>{s.d(t,{Z:()=>r});var i=s(67294),n=s(24405),a=s(85893);function o(e,t){let{isSelected:s}=e;window.__c={n:"RadioButtonIcon"};const{radioButtonStyle:i,dotStyle:o}=(0,n.yK)((e=>({radioButtonStyle:{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:16,height:16,borderRadius:16,marginRight:8,background:s?e.blueColor:e.whiteButtonBackground,border:s?"none":`1px solid ${e.radioButtonBorder}`,transition:"background 100ms ease-out"},dotStyle:{width:6,height:6,borderRadius:6,background:e.regularInvertedTextColor,transition:"opacity 100ms ease-out",opacity:s?1:0}})),[s]);return(0,a.jsx)("div",{ref:t,style:i,children:(0,a.jsx)("div",{style:o})})}const r=i.forwardRef(o)},55880:(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});s(67294);var i=s(83355),n=s(8848),a=s(45238),o=s(85893);const r=(0,a.I)("thanksShield",{viewBox:"0 0 27 32",svg:(0,o.jsx)("path",{d:"M13.5 31.672c.281 0 .672-.125 1.031-.328 8.75-5.063 11.64-6.969 11.64-12.344V7.125c0-1.672-.624-2.219-2.062-2.797-2.218-.89-7.14-2.719-9.375-3.484-.406-.14-.828-.235-1.234-.235-.422 0-.844.11-1.25.235-2.219.719-7.156 2.61-9.375 3.484C1.437 4.891.812 5.453.812 7.125V19c0 5.375 2.922 7.234 11.641 12.344.36.203.75.328 1.047.328zm0-2.14c-.266 0-.547-.126-.922-.36-7.25-4.5-9.844-5.797-9.844-10.547V7.485c0-.782.141-1.063.735-1.298 2.078-.828 7.187-2.656 9.281-3.468.281-.125.547-.188.75-.188.188 0 .438.078.75.188 2.078.812 7.156 2.703 9.266 3.469.593.218.734.515.734 1.296v11.141c0 4.75-2.625 6.016-9.844 10.547-.375.234-.656.36-.906.36zm-1.688-6.75c.391 0 .72-.188.954-.548l7.593-11.859c.141-.234.282-.5.282-.75 0-.531-.485-.906-.985-.906-.312 0-.61.203-.843.547L11.75 20.437 8.156 16c-.281-.375-.562-.484-.89-.484a.944.944 0 00-.938.953c0 .265.11.531.281.765l4.188 5c.297.391.61.547 1.015.547z",fill:"#636363"})});var l=s(5366);const d=(0,l.defineMessages)({phishing_or_spam:{id:"reportPage.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"},inappropriate_content:{id:"reportPage.reportReasons.inappropriate_content",defaultMessage:"Inappropriate content"},other_content_policy_violation:{id:"reportPage.reportReasons.other_content_policy_violation",defaultMessage:"Other"}});var c=s(7250),u=s(82990),m=s(54642),p=s(47307),g=s(360),h=s(28020),f=s(33929),y=s(87279),v=s(18514),x=s(88632),S=s(25399),b=s(36488),M=s(74194),w=s(78140),j=s(28992),C=s(32163),k=s(17293),_=s(63296),T=s(72495),I=s(92660),P=s(74523),Z=s(6202);const F=(0,l.defineMessages)({additionalInformationPlaceholder:{id:"reportPage.additionalInformation.placeholder",defaultMessage:"Add additional information (optional)"},dialogLabel:{id:"reportPage.dialogLabel",defaultMessage:"Report page"}});class A extends i.Z{constructor(e){super(e),this.handleCancel=()=>{g.q()},this.renderContent=()=>{const{device:e}=this.environment;if(!x.Z.state.online)return this.renderOffline();const t=S.Z.state;return t.open?e.isMobile?this.renderMobileModal(t):this.renderDesktopModal(t):void 0},this.onSubmit=async()=>{const e=this.environment,t=S.Z.getState();if(!t.open)return;const{additionalInformation:s,reason:i}=t,n=(0,h.Fv)();if(!i||null==n||!n.id)return void p.showErrorMessage((0,o.jsx)(l.FormattedMessage,{defaultMessage:"Something went wrong.",id:"reportPageModal.somethingWentWrong.label"}));const a=await(d=(0,c.OP)(),m.reportPage(e,{reason:i,page:n,intercomVisitorId:d,additionalInformation:s}));var d;"failed"===a.type?p.showError(a):(S.Z.setState({open:!1}),p.showMessage({message:(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[r({width:40}),(0,o.jsx)("div",{style:{paddingTop:12,paddingBottom:8,fontSize:"large",textAlign:"center"},children:(0,o.jsx)(l.FormattedMessage,{id:"reportPageModal.thanksForReporting",defaultMessage:"Thanks for reporting this page, our team will take a look."})})]})})}))},this.modalTitleStyle={fontSize:16,marginBottom:12,fontWeight:u.Z.fontWeight.medium}}renderComponent(){return(0,o.jsx)(I.Z,{ariaLabel:f.default.formatMessage(F.dialogLabel),onDismiss:this.handleCancel,render:this.renderContent,requireOnline:!0,modalStore:S.Z})}renderOptionButtons(e){const{reason:t}=e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(k.Z,{title:(0,o.jsx)(l.FormattedMessage,{id:"reportPageModal.reportReasons.phishing_or_spam",defaultMessage:"Phishing or spam"}),isSelected:"phishing_or_spam"===t,onClick:()=>S.Z.setState({...e,reason:"phishing_or_spam"}),name:"report-page-modal"},"phishing_or_spam"),(0,o.jsx)(k.Z,{title:f.default.formatMessage(d.inappropriate_content),isSelected:"inappropriate_content"===t,onClick:()=>S.Z.setState({...e,reason:"inappropriate_content"}),name:"report-page-modal"},"inappropriate_content"),(0,o.jsx)(k.Z,{title:(0,o.jsx)(l.FormattedMessage,{id:"reportPageModal.reportReasons.other_content_policy_violation",defaultMessage:"Other"}),isSelected:"other_content_policy_violation"===t,onClick:()=>S.Z.setState({...e,reason:"other_content_policy_violation"}),name:"report-page-modal"},"other_content_policy_violation")]})}renderMobileModal(e){if(!e.open)return;const{reason:t}=e,s={menuType:y.og.Modal,title:(0,o.jsx)(l.FormattedMessage,{id:"reportPageModal.mobile.title",defaultMessage:"Report page"}),right:(0,o.jsx)(l.FormattedMessage,{id:"reportPageModal.closeButton.label",defaultMessage:"Close"}),onClickRight:this.handleCancel};return(0,o.jsx)(w.Z,{...s,children:(0,o.jsx)(C.Z,{type:C.i.Vertical,initialFocus:void 0,sections:[{key:"help",render:e=>{let{children:t,...s}=e;return(0,o.jsx)(T.Z,{...s,children:t})},items:[{key:"help",render:()=>(0,o.jsx)(j.Z,{title:(0,o.jsx)(P.Z,{title:(0,o.jsx)(l.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,v.UY)("contentPolicy"),analyticsFrom:"report_page"}),right:(0,o.jsx)(o.Fragment,{}),onClick:()=>{}}),action:()=>{}}]},{key:"reportOptions",render:e=>{let{children:t,...s}=e;return(0,o.jsx)(T.Z,{...s,children:t})},items:[{key:"options",render:()=>this.renderOptionButtons(e),action:()=>{}},{key:"additionalInfo",render:()=>t&&(0,o.jsx)(M.Z,{textarea:!0,style:this.getTextAreaStyle(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:f.default.formatMessage(F.additionalInformationPlaceholder),onChange:t=>{S.Z.setState({...e,additionalInformation:t.target.value})}}),action:()=>{}}]},{key:"actions",render:e=>{let{children:t,...s}=e;return(0,o.jsx)(T.Z,{isSubmitButton:!0,...s,children:t})},items:[{key:"submit",render:e=>{const{onClick:t,...s}=e;return(0,o.jsx)(Z.Z,{...s,disabled:!this.canSubmit(),title:(0,o.jsx)("div",{style:{color:n.ZP.red},children:(0,o.jsx)(l.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})}),onClick:t||this.onSubmit})},action:this.onSubmit}]}]},"main list")})}canSubmit(){const{state:e}=S.Z;if(e.open){const{reason:t}=e;return void 0!==t}return!1}renderDesktopModal(e){if(!e.open)return;const{reason:t}=e;return(0,o.jsx)(b.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:()=>(0,o.jsxs)("div",{style:this.getModalWrapStyle(),children:[(0,o.jsx)("div",{style:this.modalTitleStyle,children:(0,o.jsx)(l.FormattedMessage,{id:"reportPageModal.title",defaultMessage:"Why are you reporting this page?"})}),(0,o.jsx)("div",{style:{paddingBottom:12},children:(0,o.jsx)(P.Z,{title:(0,o.jsx)(l.FormattedMessage,{id:"reportPage.helpButton.caption",defaultMessage:"Notion's content policy"}),href:(0,v.UY)("contentPolicy"),analyticsFrom:"report_page"})}),(0,o.jsx)("div",{children:this.renderOptionButtons(e)}),t&&(0,o.jsx)(M.Z,{textarea:!0,style:this.getTextAreaStyle(),focus:Boolean(e.reason),value:e.additionalInformation,placeholder:f.default.formatMessage(F.additionalInformationPlaceholder),onChange:t=>{S.Z.setState({...e,additionalInformation:t.target.value})}}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,o.jsx)(_.Z,{isLarge:!0,onClick:this.handleCancel,style:{marginRight:12},children:(0,o.jsx)(l.FormattedMessage,{id:"reportPageModal.cancelButton.label",defaultMessage:"Cancel"})}),(0,o.jsx)(_.Z,{isRed:!0,isLarge:!0,onClick:this.onSubmit,disabled:!this.canSubmit(),disabledFeedback:!0,children:(0,o.jsx)(l.FormattedMessage,{id:"reportPageModal.reportButton.label",defaultMessage:"Report"})})]})]})})}renderOffline(){return(0,o.jsx)("div",{style:this.getOfflineStyle(),children:(0,o.jsx)(l.FormattedMessage,{defaultMessage:"Please go online to make a report.",id:"reportPageModal.offlineMessage.description"})})}getModalWrapStyle(){return{width:360,padding:24,fontSize:14}}getOfflineStyle(){return{...this.getModalWrapStyle(),color:this.theme.mediumTextColor}}getTextAreaStyle(){const{device:e}=this.environment;return{width:"100%",background:this.theme.popoverBackground,display:"block",padding:e.isMobile?16:"10px 12px",height:e.isMobile?150:130,marginTop:17,marginBottom:17,fontSize:e.isMobile?16:14}}}A.displayName="ReportPageModal";const D=A},18878:(e,t,s)=>{s.d(t,{mX:()=>f,mo:()=>g,nH:()=>h});s(67294);var i=s(86628),n=s(24405),a=s(27006),o=s(97880),r=s(82990),l=s(5366),d=s(34859),c=s(80444),u=s(53336),m=s(63381),p=s(85893);function g(e){window.__c={n:"RestorePermissionEdits"};const{openState:t}=e,{mainEditorCurrentBlockStore:s,currentSpaceStore:a}=(0,i.VK)((()=>c.default.state),[]),o=(0,n.yK)((e=>({scroller:{display:"flex",flexDirection:"column",maxHeight:290},editContainer:{marginTop:2,marginBottom:2,color:e.regularTextColor}})),[]);if(!s||!a)return null;const r=Date.now();return(0,p.jsx)(u.Z,{type:d.Z.Y,style:o.scroller,children:t.permissionChanges.map(((e,t)=>{let[i,n]=e;const l={timestamp:r,space_id:a.id,type:"permission-changed",permission_data:{before:i,after:n}};return(0,p.jsx)("div",{style:o.editContainer,children:(0,p.jsx)(m.Z,{rootStore:s,edit:l})},`${i.type}-${t}`)}))})}function h(e){return["remove","restrict"].includes(e.type)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restrictAccess",defaultMessage:"Restrict access"}):"restoreTeamPermissions"===e.type?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restoreTeamPermissions",defaultMessage:"Reset Permissions"}):(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restoreAccess",defaultMessage:"Restore access"})}function f(e){switch(e.type){case"remove":return(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restrict.description",defaultMessage:"Are you sure you want to remove this {permissionGroup} and restrict access? This page will no longer inherit share settings from the parent page.",values:{permissionGroup:y(e)}});case"restrict":return(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.remove.description",defaultMessage:"Are you sure you want to change this role and restrict access? This page will no longer inherit share settings from the parent page."});case"restore":return e.permissionChanges.length>0?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restore.description",defaultMessage:"Are you sure you want to restore access? This will inherit the following permissions from the parent page:"}):(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreNoChanges.description",defaultMessage:"Are you sure you want to restore access?"});case"restoreTeamPermissions":return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{style:{fontWeight:r.Z.fontWeight.semibold,marginBottom:4},children:(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.mainDescription",defaultMessage:"Are you sure you want to reset permissions to match the teamspace defaults?"})}),(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.warningMessage",defaultMessage:"Everyone else who is not part of the teamspace will lose access, including guests."})]});default:throw o.t1(e)}}function y(e){return(0,a.jg)(e.permissionItem)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.user",defaultMessage:"user"}):(0,a.hV)(e.permissionItem)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.group",defaultMessage:"group"}):(0,a.ix)(e.permissionItem)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.space",defaultMessage:"workspace"}):(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.generic",defaultMessage:"permission"})}},21121:(e,t,s)=>{s.d(t,{Z:()=>W});s(57658);var i=s(43261),n=s.n(i),a=(s(67294),s(83355)),o=s(99036),r=s(80951),l=s(84619),d=s(72126),c=s(4615),u=s(71644),m=s(6287),p=s(5366),g=s(50906),h=s(66890),f=s(75079),y=s(78316),v=s(87279),x=s(77080),S=s(29798),b=s(49085);class M extends b.default{getInitialState(){return{inputValue:"",openPropertyActionMenu:void 0}}}const w=M;var j=s(52275),C=s(79131),k=s(78140),_=s(32163),T=s(43765),I=s(40721),P=s(72495),Z=s(12534),F=s(4023),A=s(33846),D=s(24736),B=s(3386),R=s(73456),L=s(22084),N=s(85893);class E extends a.Z{constructor(){super(...arguments),this.storeTypes={renameInputStore:A.Z},this.renderActionMenuButton=()=>{const{property:e,collectionId:t,analyticsFrom:s,onChange:i,onCloseActionMenu:n,actionMenuOpen:a,focused:o,option:r,propertySchema:l}=this.props,{device:d}=this.environment;return(0,N.jsx)(R.Z,{open:a,origin:(0,N.jsx)(D.Z,{onClick:this.handleActionButtonClick,isMobile:d.isMobile,style:{opacity:o||d.isMobile?1:0}}),option:r,propertySchema:l,property:e,collectionId:t,analyticsFrom:s,onChange:i,onClose:n})},this.handleActionButtonClick=e=>{(0,Z.ZP)({event:e,context:Z.Af.MenuListClick,callback:()=>this.props.onOpenActionMenu(this.props.option.value)})}}willMountOrUpdate(e){e.actionMenuOpen&&!this.props.actionMenuOpen&&this.stores.renameInputStore.setState({...this.stores.renameInputStore.state,inputValue:this.props.option.value})}renderComponent(){const{locked:e,option:t}=this.props;return(0,N.jsx)(B.Z,{capture:this.props.actionMenuOpen,onEnter:d.yR,children:(0,N.jsx)(j.Z,{...this.props,title:(0,N.jsx)(L.a,{format:this.environment.device.isMobile?l.l.Large:l.l.Medium,value:t.value,color:t.color,descriptionTooltip:t.description,tooltipPlacement:F.u.Left,showRemoveButton:!1,isSingle:!0,showEllipsis:!0}),desktopTitleStyle:{marginRight:6},isTokenTitle:!0,right:!e&&this.renderActionMenuButton()})})}}E.displayName="SelectPropertyMenuItem",E.contextTypes={...v.mw,...a.w};const O=E;var V=s(47082);class U extends a.Z{constructor(){super(...arguments),this.storeTypes={store:w,menuListStore:S.Z},this.handleSelectPropertyMenuItemChange=e=>{const{property:t,schema:s}=this.props,i=s[t];if(!i)return;if(!o.cu(i))return;const n=i.options||[],a=[...n],r={},l=this.props.value.filter((e=>{const t=n.find((t=>t.value===e));return!t||a.some((e=>e.id===t.id))}));r.operations=e,d.Xy(l,this.props.value)||(r.value=l),this.props.onChange(r)},this.handleCloseActionMenu=()=>{this.stores.store.setState({...this.stores.store.state,openPropertyActionMenu:void 0})},this.handleOpenActionMenu=e=>{this.stores.store.setState({...this.stores.store.state,openPropertyActionMenu:e})},this.handleTokenInputChange=e=>{this.stores.store.setState({...this.stores.store.state,inputValue:""});const{collectionId:t,allowMultiple:s,property:i,schema:n,onChange:a,analyticsFrom:r}=this.props,l=n[i];if(!l)return;if(!o.cu(l))return;const u=l.options||[];let p;p=s?e:e.length>0?[e[e.length-1]]:[];const h=d.jj(d.oA(p.map((e=>{const t=u.find((t=>t.value===e));if(t)return t.value})))),v=p.find((e=>!u.find((t=>t.value===e)))),S={value:h.concat(d.oA([v]))};if(v){const e={id:(0,c.ZP)(),value:v,color:this.createSelectColor};let s;s="alphabetical"!==l.auto_sort_options&&"reverse_alphabetical"!==l.auto_sort_options||!x.default.checkGate("collection_properties_select_auto_sort_options")?[{pointer:{table:m.v,id:t},command:"keyedObjectListAfter",path:["schema",i,"options"],args:{value:e}}]:[(0,y.Ch)({collectionId:t,property:i,propertySchema:l,newOption:e,isAscending:"alphabetical"===l.auto_sort_options})],S.operations=s,this.setRandomCreateSelectColor(),g.$qu(this.environment,{...(0,f.Pn)(this.context.collectionContextStore),property_type:l.type,action:"select_add_option",from:r})}a(S)},this.handleDraggableListDrop=e=>{const{collectionId:t,property:s,schema:i,onChange:n}=this.props,a=(0,y.YL)({newOptions:e,collectionId:t,property:s,schema:i});if(a){const e=i[s];if(e&&o.cu(e)){"manual"!==(e.auto_sort_options||"manual")&&a.push({pointer:{table:m.v,id:t},command:"update",path:["schema",s],args:{auto_sort_options:"manual"}})}n({operations:a})}this.stores.menuListStore.reset()}}willMount(e){if(this.setRandomCreateSelectColor(),e.insertChar){const t=e.insertChar;this.stores.store.setState({...this.stores.store.state,inputValue:t})}}renderNoOptionsFound(){return(0,N.jsx)(p.FormattedMessage,{id:"database.selectPropertyEditMenu.noResults",defaultMessage:"No options found"})}renderSelectOnlyPrompt(){return(0,N.jsx)(p.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOnlyPrompt",defaultMessage:"Select an option"})}renderSelectOrCreatePrompt(){return(0,N.jsx)(p.FormattedMessage,{id:"database.selectPropertyEditMenu.selectOrCreatePrompt",defaultMessage:"Select an option or create one"})}renderComponent(){const{device:e}=this.environment,{disabled:t,canConfigureCollection:s}=this.props,i=this.props.schema[this.props.property];if(!i)return;if(!o.cu(i))return;const n=i.options||[],a=this.renderCurrentTokens(n),r=this.getTokenResults(this.stores.store.state.inputValue,n),l=0===r.length,d=(0,N.jsx)(V.Z,{focus:e.isMobile?void 0:!this.stores.store.state.openPropertyActionMenu,focusAfterAnimation:!0,format:V.Z.Format.Select,tokens:a,placeholder:this.props.intl.formatMessage({id:"database.selectPropertyEditMenu.searchPlaceholder",defaultMessage:"Search for an option..."}),onRemoveLastToken:()=>{this.handleTokenInputChange(this.props.value.slice(0,this.props.value.length-1))},value:this.stores.store.state.inputValue,disabled:t,hideInput:t,onChange:e=>this.stores.store.setState({...this.stores.store.state,inputValue:e.target.value}),dontShowBorderBottom:e.isAndroid});let c;return c=e.isMobile?{menuType:v.og.Modal,title:i.name,right:(0,N.jsx)(I.DoneMenuText,{}),onClickRight:this.props.onDismiss,header:d}:{menuType:v.og.Popup,header:d,tokenInputHeader:!0},t?(0,N.jsx)(k.Z,{...c}):(0,N.jsx)(k.Z,{...c,children:l?(0,N.jsx)(P.Z,{title:s?this.renderSelectOrCreatePrompt():this.renderNoOptionsFound(),children:e.isMobileNative&&(0,N.jsx)(T.Z,{title:this.renderNoOptionsFound()})}):(0,N.jsx)(_.Z,{type:_.i.Vertical,initialFocus:this.stores.store.state.inputValue.length>0?0:void 0,sections:[{key:0,render:e=>this.renderMenuListSection(e,r),items:this.getSelectMenuListItems(r,n)}],onAccept:(e,t,s)=>{this.props.onAccept(s)},store:this.stores.menuListStore})})}renderMenuListSection(e,t){const{canConfigureCollection:s}=this.props;return s?(0,N.jsx)(P.Z,{...e,title:this.renderSelectOrCreatePrompt(),children:(0,N.jsx)(C.ZP,{direction:"vertical",keys:t,renderKey:s=>e.children[t.indexOf(s)],onDrop:this.handleDraggableListDrop})}):(0,N.jsx)(P.Z,{...e,title:this.renderSelectOnlyPrompt(),children:e.children})}renderFoundSelectPropertyMenuItem(e,t){const{schema:s,property:i}=this.props,n=s[i];if(n&&o.cu(n))return(0,N.jsx)(O,{...e,option:t,showDragHandle:this.props.canConfigureCollection,locked:!this.props.canConfigureCollection,property:this.props.property,analyticsFrom:this.props.analyticsFrom,collectionId:this.props.collectionId,onChange:this.handleSelectPropertyMenuItemChange,actionMenuOpen:this.stores.store.state.openPropertyActionMenu===t.value,propertySchema:n,onCloseActionMenu:this.handleCloseActionMenu,onOpenActionMenu:this.handleOpenActionMenu})}renderCreateSelectPropertyMenuItem(e,t,s){const{device:i}=this.environment;return(0,N.jsx)(j.Z,{...e,title:(0,N.jsxs)("div",{style:{display:"flex",minWidth:0},children:[(0,N.jsx)("div",{style:{marginRight:6,lineHeight:1.3},children:(0,N.jsx)(p.FormattedMessage,{id:"database.selectPropertyEditMenu.createLabel",defaultMessage:"Create"})}),(0,N.jsx)(L.a,{value:t.value,color:t.color,showRemoveButton:!1,isSingle:!0,format:i.isMobile?l.l.Large:l.l.Medium,showEllipsis:!0})]}),isTokenTitle:!0})}getSelectMenuListItems(e,t){return e.map((e=>{const s=t.find((t=>t.value===e));return{key:e,render:t=>{if(s)return this.renderFoundSelectPropertyMenuItem(t,s);{const s={id:(0,u.ZP)(),value:e,color:this.createSelectColor};return this.renderCreateSelectPropertyMenuItem(t,s,e)}},action:()=>{this.handleTokenInputChange([...this.props.value,e])}}}))}renderCurrentTokens(e){const{disabled:t}=this.props,{device:s}=this.environment;return d.oA(this.props.value.map((i=>{const n=(0,r.i7)(e,i);if(n)return(0,N.jsx)(L.a,{value:n.value,color:n.color,showRemoveButton:!t,isSingle:!1,format:s.isMobile?l.l.Large:l.l.Medium,shouldShrink:!0,onClickRemove:()=>{this.handleTokenInputChange(this.props.value.filter((e=>e!==i)))},showEllipsis:!0},n.id)})))}getTokenResults(e,t){const s=t.map((e=>e.value));let i;if(e){i=n().filter(e,s).map((e=>e.original));!t.find((t=>t.value===e))&&e.trim().length>0&&this.props.canConfigureCollection&&i.push(e.trim().replace(/,/g,""))}else i=s;return i}setRandomCreateSelectColor(){const{schema:e,property:t}=this.props,s=e[t];if(!s)return;if(!o.cu(s))return;const i=s.options||[],n=(0,o.TL)(i);this.createSelectColor=n}}U.displayName="SelectPropertyMenu",U.contextTypes={...a.w,...h.xm};const W=(0,p.injectIntl)(U)},77376:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var i=s(67294),n=s(480),a=s(86628),o=s(5366),r=s(49386),l=s(50906),d=s(75079),c=s(78316),u=s(87279),m=s(18514),p=s(35328),g=s(27724),h=s(13713),f=s(80209),y=s(48019),v=s(68894),x=s(78140),S=s(72495),b=s(83182),M=s(85893);const w=(0,o.defineMessages)({filterActions:{defaultMessage:"Search actions…",id:"selectableHoverMenu.filterActions.placeholder"}});function j(e){window.__c={n:"SelectableHoverMenuPopup"};const{hasEditorPermissions:t,isWorkspaceAdmin:s,store:o,onDismiss:m,containerRef:v,query:S,setQuery:b}=e,w=(0,n.O7)(),j=(0,n.MO)(),_=(0,a.VK)((()=>{var e;return{environment:w,blocks:g.default.state.stores.length?g.default.state.stores:[o],originRect:null===(e=v.current)||void 0===e?void 0:e.getBoundingClientRect(),publicEditMode:void 0}}),[w,o,v]),T=(0,a.VK)((()=>o.isNavigableAncestorLocked()),[o]),[I,P]=(0,i.useState)(void 0),Z=(0,i.useCallback)((e=>{const t=g.default.state.stores[0],s=t.getType();if(s){const i=(0,c.fm)(t),n=(0,d.Pn)(i)||{};l.dhV(w,{analyticsName:e.analyticsName,from:"selection_menu",block_id:t.id,block_type:s,is_toggleable:(0,p._A)(s,t.getFormat()),...n})}e.closeParentMenu&&m()}),[w,m]),F=(0,a.VK)((()=>o.isCollectionView()),[o]),A=!j&&t&&!T&&(0,M.jsx)(C,{filter:S,setQuery:b,comboboxAriaProps:I});let D;return D=j?{menuType:u.og.ActionSheet,header:A}:{menuType:u.og.Popup,width:265,header:A},(0,M.jsxs)(x.Z,{...D,children:[(0,M.jsx)(y.Z,{filter:S,initialFocus:S?0:void 0,sections:r.Qi,context:_,onAccept:Z,setComboboxAriaProps:P}),!S&&(t||s)&&(0,M.jsx)(h.Z,{store:o,isPageMoreButton:!1,hideTopBorder:!1}),!S&&(0,M.jsx)(f.Z,{store:o}),!S&&F&&(0,M.jsx)(k,{})]})}function C(e){window.__c={n:"SelectableHoverMenuHeader"};const{filter:t,setQuery:s,comboboxAriaProps:i}=e,a=(0,n.Fy)(),r=(0,o.useIntl)();return(0,M.jsx)(S.Z,{isInput:!0,children:(0,M.jsx)(v.ZP,{value:t,onChange:e=>s(e.target.value),focus:!a.isMobile||void 0,focusAfterAnimation:!0,placeholder:r.formatMessage(w.filterActions),preventCaptureDeleteWhenEmpty:!0,preventCaptureClipboardShortcuts:!0,...i})})}function k(){return(0,M.jsx)(S.Z,{topBorder:!0,children:(0,M.jsx)(b.Z,{title:(0,M.jsx)(o.FormattedMessage,{defaultMessage:"Learn about databases",id:"blocks.hoverBlockMenu.collectionHelpButton"}),href:(0,m.UY)("guides.database"),analyticsFrom:"selectable_hover_menu"})})}},30761:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});s(67294);var i=s(480),n=s(24405),a=s(50506),o=s(38493),r=s(85893);function l(e){window.__c={n:"SidebarConnectionsModal"};const t=(0,i.Fy)(),s=(0,n.yK)((e=>({modal:{width:t.isMobile?"auto":890,height:t.isMobile?"auto":606,borderRadius:8}})),[t.isMobile]);return(0,r.jsx)(a.Z,{open:e.modalOpened,innerStyle:s.modal,onDismiss:e.onModalClose,render:()=>(0,r.jsx)("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"},children:(0,r.jsx)(o.Z,{location:"sidebar-modal"})})})}},82905:(e,t,s)=>{s.r(t),s.d(t,{MembersTabTitle:()=>us,PeopleRow:()=>ds,SettingToggle:()=>ms,SidebarTeamModal:()=>cs});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(72126),l=s(97880),d=s(82990),c=s(5366),u=s(50906),m=s(1865),p=s(43250),g=s(95697),h=s(46874),f=s(43914),y=s(55838),v=s(80444),x=s(90106),S=s(3386),b=s(50506),M=s(76798),w=s(53336),j=s(24006),C=s(26388),k=s(64369),_=s(29302),T=s(13490),I=s(66957),P=s(69814),Z=s(58260),F=(s(57658),s(8848)),A=s(45238),D=s(85893);const B=(0,A.I)("leaveArrow",{viewBox:"0 0 16 12",svg:(0,D.jsx)("path",{d:"M8.65 11.116a.615.615 0 00.444-.184l4.546-4.54a.66.66 0 00.205-.39v4.526c0 .349.253.588.608.588.356 0 .615-.239.615-.588V1.361a.59.59 0 00-.615-.608.585.585 0 00-.608.608v4.512a.698.698 0 00-.205-.396L9.094.944a.623.623 0 00-.445-.191.58.58 0 00-.594.588c0 .164.054.328.164.437L9.75 3.33l2.242 2.05-1.456-.054h-9.01c-.355 0-.601.253-.601.609 0 .355.246.615.601.615h9.01L12 6.495 9.75 8.54l-1.531 1.559a.616.616 0 00-.164.43c0 .342.26.588.594.588z"})});var R=s(64964),L=s(39699),N=s(33929),E=s(78122),O=s(63409);function V(e){return!(0,h.q)(e)}var U=s(35901),W=s(71064),z=s(4023),K=s(35817),H=s(42922),G=s(36488),q=s(74194),Y=s(22235),Q=s(51923),$=s(93686),X=s(37708),J=s(38755),ee=s(65426);const te=(0,c.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsFull",defaultMessage:"Teamspace members have full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsEdit",defaultMessage:"Teamspace members can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsComment",defaultMessage:"Teamspace members can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.teamPermissionsView",defaultMessage:"Teamspace members can view"}}),se=(0,c.defineMessages)({editor:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsFull",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} has full access"},read_and_write:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsEdit",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can edit"},comment_only:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsComment",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can comment"},reader:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsView",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} can view"},none:{id:"TeamSettingsGeneral.generalSettings.spacePermissionsNone",defaultMessage:"{showTeam, select, true {Everyone else} other {Everyone at {spaceName}}} does not have access"}});function ie(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsPermissionCard"};const s=(0,o.yK)((()=>({listItem:{padding:0,margin:0},spacer:{height:20,width:"100%"},accessLevelButton:{border:"none"}})),[]),[i,n]=(0,a.AF)(y.Z),r=y.a.Members,l=(0,a.VK)((()=>t.getTeamAccessLevel()),[t]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{style:s.spacer}),(0,D.jsx)(X.Ph,{title:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.permissions",defaultMessage:"Permissions"}),rows:[(0,D.jsx)(ee._,{currentAccessLevel:l,teamStore:t,disabledWithRightChevron:!0,style:s.accessLevelButton},"visibility"),(0,D.jsx)(ne,{teamStore:t},"permissions")],onClick:()=>{i.open&&n({...i,tab:r})},itemStyle:s.listItem})]})}function ne(e){let{teamStore:t}=e;window.__c={n:"PermissionsRow"};const s=(0,a.VK)((()=>v.default.state.currentSpaceStore),[]),i=(0,n.O7)(),r=(0,o.yK)((e=>({label:{color:e.regularTextColor,whiteSpace:"normal"},row:{display:"inline-flex",alignItems:"center",marginTop:12,marginBottom:12,paddingRight:15,paddingLeft:15},icon:{marginRight:15}})),[]),l=(0,a.VK)((()=>t.getTeamPermission()||{type:"team_permission",role:"none"}),[t]),d=(0,a.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),{spaceIcon:c,spaceName:u}=(0,a.VK)((()=>{if(!s)return{spaceIcon:void 0,spaceName:void 0};const e=(0,J.rn)(i,s);return{spaceIcon:(0,D.jsx)($.p,{disabled:!0,store:s,size:20,style:r.icon}),spaceName:e}}),[s,i,r.icon]),m=(0,a.VK)((()=>(0,D.jsx)($.p,{disabled:!0,store:t,size:20,style:r.icon})),[t,r.icon]),p=!(l.role===d.role),g=p?m:c,h=N.default.formatMessage(se[d.role],{showTeam:p,spaceName:u}),f=N.default.formatMessage(te[l.role]);return(0,D.jsxs)("div",{style:r.row,children:[g,(0,D.jsxs)(k.Z,{isSmall:!0,style:r.label,children:[p&&(0,D.jsxs)(D.Fragment,{children:[f,(0,D.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),h]})]})}var ae=s(52867),oe=s(45660),re=s(89728),le=s(91718),de=s(42853),ce=s(27006),ue=(s(59730),s(26825));const me=["none","reader","comment_only","read_and_write","editor"],pe=["reader","comment_only","read_and_write"],ge=["reader","comment_only","read_and_write","editor"],he=["editor"];function fe(e){const t=function(e){var t,s;let{teamId:i,permissions:n}=e;const a=(null===(t=n.find((e=>(0,ce.ix)(e))))||void 0===t?void 0:t.role)??"none",o=(null===(s=n.find((e=>(0,ce.zU)(e)&&e.team_id===i)))||void 0===s?void 0:s.role)??a,r=n.find((e=>(0,ce.bm)(e)));return{spacePermission:{type:"space_permission",role:a},teamMemberPermission:{type:"explicit_team_permission",team_id:i,role:o},teamOwnerPermission:{type:"explicit_team_owner_permission",team_id:i,role:"editor"},...r&&{teamGuestPermission:{type:"explicit_team_guest_permission",team_id:i,role:r.role}}}}({teamId:e.id,permissions:e.permissions??[]}),{spacePermission:s,teamMemberPermission:i}=t,n={visibility:["team_members","space_members"],space_member_join_access:["invite_only","self_join"],invite_access:["team_members","team_owners"]},a={spacePermission:ve({roles:me,currentRole:i.role}),teamGuestPermission:pe,teamMemberPermission:ye({roles:ge,currentRole:s.role}),teamOwnerPermission:he},{visibility:o,space_member_join_access:r}=e.settings;return"team_members"===o&&(n.space_member_join_access=["invite_only"],a.spacePermission=["none"]),"self_join"===r&&(n.visibility=["space_members"],n.invite_access=["team_members"],a.spacePermission=a.spacePermission.filter((e=>"none"!==e))),e.is_default&&(a.teamMemberPermission=[i.role],a.spacePermission=[i.role]),{settingsOptions:n,permissionItemRoleOptions:a,currentTeamPermissionItems:t}}function ye(e){let{roles:t,currentRole:s}=e;return t.filter((e=>(0,ue.IF)(e,s)))}function ve(e){let{roles:t,currentRole:s}=e;return t.filter((e=>(0,ue.SL)(e,s)))}var xe=s(4708),Se=s(87279),be=s(98742),Me=s(52275),we=s(31945),je=s(78140),Ce=s(32163),ke=s(72495);function _e(e){let{teamStore:t}=e;window.__c={n:"TeamSecuritySection"};const{teamSettings:s,isInviteToggleVisible:i}=(0,a.VK)((()=>({teamSettings:t.getSettingsStore().getValue(),isInviteToggleVisible:(0,xe.s$)()})),[t]),n=(0,a.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return fe({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t]);if(!s||!n)return null;const o=[(0,D.jsx)(Ie,{teamStore:t,hasMultiInviteAccessOptions:1===n.settingsOptions.invite_access.length,inviteAccess:s.invite_access},"invite"),(0,D.jsx)(Te,{teamStore:t,disablePageEdits:s.disable_team_page_edits},"editSidebar")];return i&&o.push((0,D.jsx)(Pe,{teamStore:t},"toggleInviteLink")),(0,D.jsx)(X.Ph,{title:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsSecurity.teamspaceSettingsTitle",defaultMessage:"Teamspace Security"}),rows:o,hideDividers:!0})}function Te(e){window.__c={n:"EditSidebarPermissionRow"};const{teamStore:t,disablePageEdits:s}=e,o=(0,n.O7)(),r=V(t),l=(0,a.VK)((()=>{var e;return(null===(e=t.getTeamPermission())||void 0===e?void 0:e.role)??"none"}),[t]),d=(0,i.useCallback)((e=>{L.createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:o,perform:s=>{K.$x({environment:o,store:t,update:{disable_team_page_edits:e},transaction:s})}})}),[o,t]),u=(0,ce.J5)(l),m=[{option:!0,label:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>d(!0)}];return u&&m.push({option:!1,label:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>d(!1)}),(0,D.jsx)(Ze,{title:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.title",defaultMessage:"Who can edit teamspace sidebar"}),caption:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanEditTeamPages.caption",defaultMessage:"Adding, removing, or re-ordering sidebar pages"}),disabled:r||!u,currentOption:!u||Boolean(s),allOptions:m,optionTooltip:u?void 0:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.settingSelect.whoCanEditTeamPages.teamMemberPermissionTooltip",defaultMessage:"Change member permissions to Can edit or Full access to allow teamspace members to edit the sidebar"})})}function Ie(e){window.__c={n:"InvitePermissionRow"};const{teamStore:t,hasMultiInviteAccessOptions:s,inviteAccess:a}=e,o=(0,h.q)(t),r=(0,n.O7)(),l=(0,i.useCallback)((e=>{L.createAndCommit({userAction:"team.setInviteAccess",environment:r,perform:s=>{K.$x({environment:r,store:t,update:{invite_access:e},transaction:s})}})}),[r,t]),d=!o||s;return(0,D.jsx)(Ze,{title:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.title",defaultMessage:"Who can invite teamspace members"}),disabled:d,optionTooltip:d&&o&&(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembersDisabled.caption",defaultMessage:"Change access level to Closed or Private to restrict who can invite teamspace members"}),currentOption:a,allOptions:[{option:"team_members",label:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamspaceMembers.teamMembersAndOwners.title",defaultMessage:"Any teamspace member"}),action:()=>l("team_members")},{option:"team_owners",label:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsPermissions.whoCanInviteTeamMembers.teamOwners.title",defaultMessage:"Only teamspace owners"}),action:()=>l("team_owners")}]})}function Pe(e){window.__c={n:"ToggleInviteLinkRow"};const{teamStore:t}=e,s=(0,n.O7)(),i=(0,a.VK)((()=>g.U2(t)),[t]),r=V(t),l=(0,o.yK)((()=>({container:{display:"flex",justifyContent:"space-between"},subtitle:{marginBottom:5},switcher:{marginTop:5}})),[]);return(0,D.jsxs)("div",{style:l.container,children:[(0,D.jsxs)("div",{children:[(0,D.jsx)(k.Z,{children:(0,D.jsx)(c.FormattedMessage,{id:"TeamsecuritySection.inviteLink.label",defaultMessage:"Invite Link"})}),(0,D.jsx)(k.Z,{isSmall:!0,style:l.subtitle,children:(0,D.jsx)(c.FormattedMessage,{id:"TeamsecuritySection.inviteLink.description",defaultMessage:"Only users who can invite members can see the invite link"})})]}),(0,D.jsx)("div",{style:l.switcher,children:(0,D.jsx)(j.Z,{disabled:r,on:!i,onClick:()=>{L.createAndCommit({userAction:"team.setInviteAccess",environment:s,perform:e=>{K.$x({environment:s,store:t,update:{disable_invite_link:!i},transaction:e})}})}})})]})}function Ze(e){window.__c={n:"SettingSelect"};const{title:t,caption:s,currentOption:i,allOptions:a,disabled:r,optionTooltip:l}=e,d=(0,n.Fy)(),c=(0,o.yK)((e=>({root:{display:"flex",alignItems:"center",width:"100%"},title:{fontSize:14,marginRight:8,flexGrow:1},divider:{marginTop:14,marginBottom:14},chevron:{width:10,marginLeft:4,fill:e.lightIconColor},buttonStyle:{fontSize:12.5,color:e.mediumTextColor},tooltipWidth:{width:300}})),[]),u=a.find((e=>e.option===i));return u?(0,D.jsxs)("div",{style:c.root,children:[(0,D.jsxs)("div",{style:c.title,children:[t,s&&(0,D.jsx)(k.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:1,width:"95%",marginBottom:5},children:s})]}),(0,D.jsx)(C.Z,{style:c.tooltipWidth,placement:z.u.Top,alignment:C.Z.Alignment.Start,textWrap:!0,disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,D.jsx)(we.ZP,{...e,disablePopup:r,popupType:d.isMobile?we.Z4.SlideUp:we.Z4.Popup,alignmentToOrigin:we.vR.End,renderOrigin:t=>(0,D.jsxs)(re.Z,{style:c.buttonStyle,disabled:r,...(0,be.Z)(e,t),children:[u.label,!r&&(0,de.i)(c.chevron)]}),render:e=>{let t;t=d.isMobile?{menuType:Se.og.ActionSheet}:{menuType:Se.og.Popup,minWidth:150};const s=[{key:"options",render:e=>(0,D.jsx)(ke.Z,{...e}),items:a.map((t=>({key:t.option.toString(),render:e=>(0,D.jsx)(Me.Z,{...e,title:t.label,caption:t.caption,checkState:i===t.option}),action:()=>{t.action(),e.close()}})))}];return(0,D.jsx)(je.Z,{...t,children:(0,D.jsx)(Ce.Z,{type:Ce.i.Vertical,initialFocus:void 0,sections:s})})}})})]}):null}function Fe(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsSecurity"};const{currentSpaceStore:s}=(0,a.Kw)(v.default),i=(0,n.O7)(),o=(0,oe.D)(),r="business",l=i.currentUser.id,d=(0,a.VK)((()=>({disable_public_access:{spaceIsDisabled:(null==s?void 0:s.getDisablePublicAccess())??!1,teamIsDisabled:t.getDisablePublicAccess()},disable_export:{spaceIsDisabled:(null==s?void 0:s.getDisableExport())??!1,teamIsDisabled:t.getDisableExport()},disable_guests:{spaceIsDisabled:(null==s?void 0:s.getDisableGuests())??!1,teamIsDisabled:t.getDisableGuests()},disable_team_page_edits:{spaceIsDisabled:void 0,teamIsDisabled:t.getDisableTeamPageEdits()}})),[s,t]),u=(0,h.q)(t),m=(0,a.VK)((()=>(null==s?void 0:s.canAdmin())??!1),[s]);if(!s)return null;if(!l)return null;const p=e=>o&&!d[e].teamIsDisabled,g=e=>{if(p(e))return!1;if(!u)return!1;return!(e=>d[e].spaceIsDisabled&&d[e].teamIsDisabled)(e)||m},f=e=>p(e)&&m,y=e=>{const{teamIsDisabled:s,spaceIsDisabled:n}=d[e],a=!s;K.d({environment:i,store:t,settingName:e,newTeamSettingValue:Re(a),spaceSettingValue:void 0===n?void 0:Re(n)})},x=e=>{if((e=>d[e].spaceIsDisabled)(e))return(e=>d[e].teamIsDisabled)(e)?(0,D.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.basedOnWorkspaceSettings",defaultMessage:"Based on <underline>workspace settings</underline>",values:{underline:e=>(0,D.jsx)("span",{style:{textDecoration:"underline"},children:e})}}):(0,D.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.overridesWorkspaceSettings",defaultMessage:"Overriding <underline>workspace setting</underline>",values:{underline:e=>(0,D.jsx)("span",{style:{textDecoration:"underline"},children:e})}})},S=(0,D.jsx)(le.Z,{subscriptionTier:r,analyticsName:"team_security_settings",desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}}),b=(0,D.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.setting.businessGateToggleTooltip",defaultMessage:"Upgrade to Business Plan to change security settings"}),M=[(0,D.jsx)(ms,{on:d.disable_public_access.teamIsDisabled,disabled:!g("disable_public_access"),onChange:()=>y("disable_public_access"),shouldTriggerUpsell:f("disable_public_access"),secondCaption:x("disable_public_access"),title:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.setting.shareTitle",defaultMessage:"Disable public page sharing"}),p("disable_public_access")&&S]}),tooltip:p("disable_public_access")&&b}),(0,D.jsx)(ms,{on:d.disable_guests.teamIsDisabled,disabled:!g("disable_guests"),onChange:()=>y("disable_guests"),shouldTriggerUpsell:f("disable_guests"),secondCaption:x("disable_guests"),title:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.setting.guestTitle",defaultMessage:"Disable guests"}),p("disable_guests")&&S]}),tooltip:p("disable_guests")&&b}),(0,D.jsx)(ms,{on:d.disable_export.teamIsDisabled,disabled:!g("disable_export"),onChange:()=>y("disable_export"),shouldTriggerUpsell:f("disable_export"),secondCaption:x("disable_export"),title:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.setting.exportTitle",defaultMessage:"Disable export"}),p("disable_export")&&S]}),tooltip:p("disable_export")&&b})];return(0,D.jsx)(Ae,{teamStore:t,toggles:M})}function Ae(e){let{teamStore:t,toggles:s}=e;window.__c={n:"TeamsSettingsSecurity"};const i=(0,o.yK)((e=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},spacer:{height:20,width:"100%"}})),[]),n=(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsSecurity.pageSettingsTitle",defaultMessage:"Page Security"});return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(_e,{teamStore:t}),(0,D.jsx)("div",{style:i.spacer}),(0,D.jsx)(X.Ph,{title:n,rows:s,hideDividers:!0}),(0,D.jsx)(Q.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_security",containerStyle:i.learnMoreLinkContainer,message:(0,D.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.learnMore",defaultMessage:"Learn about teamspace security"})})]})}function De(e){window.__c={n:"RestoreTeamButton"};const t=(0,n.O7)();return(0,D.jsx)(D.Fragment,{children:(0,D.jsx)(re.Z,{style:e.style,icon:e=>(0,ae.H)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),onClick:()=>(e=>{let{teamStore:s,teamName:i}=e;return K.YH({environment:t,teamStore:s,teamName:i,from:"sidebar_team_modal"})})({teamName:e.teamName,teamStore:e.teamStoreInstance}),children:(0,D.jsxs)("div",{children:[(0,D.jsx)(k.Z,{children:(0,D.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamButton",defaultMessage:"Restore teamspace"})}),(0,D.jsx)(k.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,D.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.restoreTeamCaption",defaultMessage:"Restoring this teamspace will add it to the sidebar for all teamspace members that were previously added."})})]})})})}function Be(e){window.__c={n:"ArchiveTeamButton"};const t=(0,n.O7)(),s=(0,o.yK)((()=>({archiveLabel:{color:F.ZP.red}})),[]);return(0,D.jsx)(re.Z,{style:e.style,isRed:!0,icon:e=>(0,ae.H)({...e,margin:"2px 17px 2px 2px",width:16,height:16}),disabled:e.disabled,disabledFeedback:e.disabled,onClick:()=>e.disabled?void 0:async function(e){let{teamStore:t,environment:s}=e;await K.aQ({environment:s,teamStore:t,from:"sidebar_team_modal"})}({environment:t,teamStore:e.teamStoreInstance}),...e.tooltipEvents,children:(0,D.jsxs)("div",{children:[(0,D.jsx)(k.Z,{style:s.archiveLabel,children:(0,D.jsx)(c.FormattedMessage,{id:"teamSettingsSecurity.dangerZone.archiveTeamButton",defaultMessage:"Archive teamspace"})}),(0,D.jsx)(k.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,D.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.archiveTeamDescription",defaultMessage:"Removes teamspace from the sidebar for all members"})})]})})}function Re(e){return e?"disable":"allow"}const Le=(0,c.defineMessages)({noDescription:{id:"TeamSettingsGeneral.generalSettings.noDescription",defaultMessage:"No description"}});function Ne(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsGeneral"};const s=(0,n.O7)(),r=(0,a.VK)((()=>v.default.state.currentSpaceStore),[]),l=V(t),[d,u]=(0,i.useState)(void 0),[m,p]=(0,i.useState)(void 0),g=(0,o.yK)((()=>({container:{maxWidth:"none",marginLeft:4},nameAndIconWrap:{display:"flex",alignItems:"center",marginBottom:0,marginTop:4},icon:{marginRight:7},name:{height:20,background:"none",boxShadow:"none",padding:"0 8px"},description:{minHeight:20,background:"none",boxShadow:"none",padding:"0 8px",margin:"0 -8px"},updateButton:{marginTop:14},learnMoreLinkContainer:{marginTop:15,marginBottom:15}})),[20]),[h,f]=(0,a.VK)((()=>[t.getName(),t.getDescription()]),[t]);if(void 0===h)return null;const y=h||"",x=f??"",S=x.length>0,b=null==d?void 0:d.trim(),M=null==m?void 0:m.trim(),w=""===b||(void 0===m||M===x.trim())&&(void 0===d||b===y.trim()),j=(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.iconAndName.title",defaultMessage:"Icon and name"}),C=(0,D.jsxs)("div",{style:g.nameAndIconWrap,children:[(0,D.jsx)($.p,{disabled:l,store:t,style:g.icon,size:20,onChange:e=>{L.createAndCommit({userAction:"TeamSettingsGeneral.updateIcon",environment:s,perform:s=>{K.fs({store:t,update:{icon:e},transaction:s})}})}}),l?(0,D.jsx)(k.Z,{children:y}):(0,D.jsx)(Ee,{value:d??y,style:g.name,onBlur:e=>{u(e)},onChange:e=>{u(e)},disabled:l,placeholder:"Acme Labs"})]}),_=(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.description.title",defaultMessage:"Description"}),T=N.default.formatMessage(Le.noDescription),I=l?(0,D.jsx)(k.Z,{isMultiline:!0,isSecondaryColor:!S,children:S?x:T}):(0,D.jsx)(Ee,{value:void 0===m?x:m,onBlur:e=>{p(e)},onChange:e=>{p(e)},disabled:l,textarea:!0,autosize:!0,placeholder:T,style:g.description}),P=[(0,D.jsxs)(i.Fragment,{children:[(0,D.jsx)(k.Z,{isSmall:!0,children:j}),C]},"name"),(0,D.jsxs)(i.Fragment,{children:[(0,D.jsx)(k.Z,{isSmall:!0,children:_}),I]},"description")];return(0,D.jsxs)("div",{style:g.container,children:[(0,D.jsx)(X.Ph,{title:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.generalSettings.details",defaultMessage:"Details"}),rows:P}),!l&&(0,D.jsx)(H.Z,{style:g.updateButton,disabled:w,isLarge:!0,onClick:async()=>{if(w)return;if(b&&b!==y.trim()){if(!(await(0,E.Xg)({environment:s,spaceStore:r,teamName:b})))return}const{performResult:e,serverCommitResult:i}=L.createAndCommit({userAction:"TeamSettingsGeneral.updateNameAndDescription",environment:s,perform:e=>{K.fs({store:t,update:{name:b??y,description:M??x},transaction:e})}});try{await Promise.all([e,i])}catch(n){return}R.oV({label:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsGeneral.settingsChanged",defaultMessage:"Updated teamspace details"})})},children:(0,D.jsx)(c.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})}),(0,D.jsx)("br",{}),(0,D.jsx)(ie,{teamStore:t}),(0,D.jsx)(Oe,{teamStore:t}),(0,D.jsx)(Q.Z,{helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_team_settings_general",containerStyle:g.learnMoreLinkContainer})]})}function Ee(e){window.__c={n:"EditableInput"};const{value:t,style:s,onBlur:n,onChange:a,placeholder:o,disabled:r}=e,[l,d]=(0,i.useState)(!1),c=(0,i.useRef)(null);return(0,D.jsx)(G.Z,{capture:l,render:i=>(0,D.jsx)(q.Z,{textarea:e.textarea,autosize:e.autosize,ref:c,onFocus:e=>{d(!0)},onBlur:e=>{d(!1),n(e.target.value)},onChange:e=>{d(!1),a&&a(e.target.value)},onSubmit:e=>{e.target.blur()},placeholder:o,disabled:r,value:t,style:s,...i})})}function Oe(e){let{teamStore:t}=e;window.__c={n:"MaybeDangerZone"};const s=(0,o.yK)((()=>({buttonStyle:{alignItems:"center",height:"auto",width:"100%",paddingTop:X.MQ,paddingBottom:X.MQ,paddingLeft:X.oM,paddingRight:X.oM}})),[]),[i,n]=(0,a.VK)((()=>[t.getName(),t.isArchived()]),[t]),r=(0,a.VK)((()=>v.default.state.currentSpaceStore),[]),l=(0,h.q)(t),d=(0,W.e)(t),u=(0,U.y)(t.id),m=(0,O.n)(r),p=u&&!m;if(void 0===i||!d)return null;const g=[],f=(0,D.jsx)(Y.Z,{buttonInternals:(0,D.jsx)(Ve,{isTeamOwner:l}),teamStore:t,placement:z.u.Bottom,alignment:z.v.Start,from:"sidebar_team_modal",style:s.buttonStyle,icon:e=>B({...e,margin:"2px 17px 2px 2px",width:16,height:16}),isRed:!l});if(g.push(f),l)if(n)g.push((0,D.jsx)(De,{teamStoreInstance:t,teamName:i,style:s.buttonStyle}));else{const e=(0,D.jsx)(C.Z,{disableTooltip:!p,placement:z.u.Bottom,alignment:z.v.Start,renderTooltip:()=>(0,D.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.cannotArchive",defaultMessage:"Cannot archive this teamspace because it is the only default teamspace in this workspace."}),render:e=>(0,D.jsx)(Be,{disabled:p,teamStoreInstance:t,tooltipEvents:e,style:s.buttonStyle})});g.push(e)}return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)("div",{style:{height:20,width:"100%"}}),(0,D.jsx)(X.Ph,{title:(0,D.jsx)(c.FormattedMessage,{id:"sidebarTeamModalSettingsScreen.dangerZone.title",defaultMessage:"Danger zone"}),rows:g,itemStyle:{padding:0,margin:0}})]})}function Ve(e){let{isTeamOwner:t}=e;window.__c={n:"LeaveTeamButton"};const s=(0,o.yK)((()=>({label:{color:t?"inherit":F.ZP.red}})),[t]);return(0,D.jsxs)("div",{children:[(0,D.jsx)(k.Z,{style:s.label,children:(0,D.jsx)(c.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeam",defaultMessage:"Leave teamspace"})}),(0,D.jsx)(k.Z,{isSmall:!0,style:{whiteSpace:"normal"},children:(0,D.jsx)(c.FormattedMessage,{id:"teamBrowser.teamCard.button.leaveTeamDescription",defaultMessage:"Removes teamspace from your sidebar"})})]})}var Ue=s(35840),We=s(62837),ze=s(77907),Ke=s(33052),He=s(30688);function Ge(e){let{teamStore:t}=e;window.__c={n:"TeamFilterAndAddMemberRow"};const s=(0,o.yK)((e=>({container:{display:"flex",justifyContent:"space-between",alignItems:"center",position:"sticky",top:0,background:e.modalBackground,zIndex:10,paddingBottom:8},input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12,width:"45%",maxWidth:260,marginRight:2},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),i=(0,c.useIntl)(),[n,r]=(0,a.AF)(y.Z),[l,d,u]=(0,a.AF)(void 0,Ke.Z),m=(0,We.e)(t),p=(0,a.VK)((()=>(0,xe.s$)()&&!g.U2(t)),[t]);return(0,D.jsxs)("div",{style:s.container,children:[(0,D.jsxs)("div",{children:[(0,D.jsx)(ze.LazyTeamPermissionsInviteWithModal,{store:t,permissionsInviteStore:u,origin:(0,D.jsx)(C.Z,{placement:C.Z.Placement.Left,alignment:C.Z.Alignment.Start,textWrap:!0,renderTooltip:()=>m?(0,D.jsx)("div",{style:{width:"max-content",maxWidth:150},children:(0,D.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembers.tooltip",defaultMessage:"Add members and groups"})}):(0,D.jsx)("div",{style:{width:220},children:(0,D.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteWithModal.addMembersNoPermissions.tooltip",defaultMessage:"You do not have permissions to add members to this teamspace"})}),render:e=>(0,D.jsx)(H.Z,{disabled:!m,isLarge:!0,onClick:()=>{d({...l,modalOpen:!0})},...e,children:(0,D.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteWithModal.openModal",defaultMessage:"Add members"})})})}),p&&(0,D.jsx)(He.u,{store:t,isSmall:!0})]}),(0,D.jsx)(q.Z,{placeholder:i.formatMessage({id:"teamPermissionsInviteWithModal.filterGroupsAndMembersInput.placeholder",defaultMessage:"Search for members or groups…"}),style:s.input,value:n.memberFilterQuery,onChange:e=>{r({...n,memberFilterQuery:e.target.value,limitMembers:!0})},left:(0,Ue.R)(s.searchIcon),showClearButton:!0,format:q.Z.Format.Small})]})}var qe=s(58573),Ye=s(59054),Qe=s(2985),$e=s(62385),Xe=s(75246),Je=s(64684),et=s(7928),tt=s(67669),st=s(86125),it=s(12793),nt=s(31278),at=s(45653),ot=s(25735),rt=(s(21703),s(36591)),lt=s(47307),dt=s(61766),ct=s(31194),ut=s(61519),mt=s(29369),pt=s(7567);function gt(e){window.__c={n:"TeamMemberPermissionRoleSelect"};const{teamStore:t,memberInfo:s,permissionItem:r,memberName:l,style:d,onMenuItemClicked:u,isPermissionOverridden:m}=e,p=(0,n.O7)(),g=(0,c.useIntl)(),h=(0,o.Fg)(),f=(0,i.useMemo)((()=>new dt.Z),[]),y=(0,o.yK)((e=>({header:{display:"flex",flexDirection:"column",backgroundColor:e.sidebarSecondaryBackground,fontSize:12,color:e.mediumTextColor,alignItems:"flex-start",paddingTop:10,paddingLeft:12,paddingRight:12,paddingBottom:10},overrideTitle:{display:"flex",alignItems:"center",justifyContent:"space-between",height:28},overrideLabel:{paddingLeft:8,color:e.mediumTextColor}})),[]),x=(0,a.VK)((()=>t.getTeamPermission()),[t]),S=(0,a.VK)((()=>{if(null==t||!t.isDefined())return;const e=g.formatMessage({id:"teamMemberPermissionRoleSelect.member.permissionitem.description",defaultMessage:"You can't give less access than the teamspace default. Lower teamspace members‘ access to enable this option."}),s=(0,D.jsx)(c.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionItem.defaultTag",defaultMessage:"default"});function i(s){return(0,Je.bk)({teamValue:{id:t.id,permissions:t.getPermissionItems()},permissionRole:s})?{isDisabled:!0,disabledMessage:e}:void 0}return["editor","read_and_write","comment_only","reader"].map((e=>({role:e,disabledInfo:i(e),tag:(null==x?void 0:x.role)===e?s:void 0})))}),[x,g,t]);const b=(0,a.VK)((()=>v.default.state.currentSpaceStore),[]),M=(0,a.VK)((()=>!("enterprise"===(null==b?void 0:b.getSubscriptionTier()))&&!m),[b,m]),w=(0,D.jsxs)("div",{style:y.overrideTitle,children:[(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.permissionsOverride",defaultMessage:"Custom permissions"}),M?(0,D.jsx)(le.Z,{subscriptionTier:"enterprise",analyticsName:"team_member_permission_override",desktopStyle:{marginLeft:8,marginRight:12}}):(0,D.jsx)(pt.ZP,{role:"owner"===s.type?"none":r.role,table:mt.e0,type:"user"===s.entity_type?"user_permission":"group_permission",upgradeButtonName:"user"===s.entity_type?"user_permission_item":"group_permission_item",buttonStyle:{marginRight:0,fontSize:12,color:h.mediumTextColor,visibility:m?void 0:"hidden"},availableRoleItems:S,header:(0,D.jsx)(k.Z,{isSmall:!0,isSecondaryColor:!0,style:{fontWeight:600,marginLeft:16,marginTop:8},children:(0,D.jsx)(c.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.menuHeader",defaultMessage:"Select custom role"})}),onChange:e=>{"none"!==e&&(!function(e){lt.showDialog({message:(0,D.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.message",defaultMessage:"Are you sure you want to change {name}'s role to {role}?",values:{name:l,role:(0,tt.r_)(e).toLowerCase()}}),description:(0,D.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.confirmation.description",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),showCancel:!0,keepFocus:!1,handleCancel:lt.dismissDialog,items:[{label:(0,D.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:async()=>{const{serverCommitResult:i}=L.createAndCommit({userAction:"TeamMemberPermissionRoleSelect.handleRoleSelect",environment:p,perform:i=>{K.jg({memberInfo:s,teamStore:t,transaction:i,environment:p,permissionRole:e})}});await i,t.isDefault()&&(t.getMembershipDefinedOnTeam().some((e=>(0,Je.ah)(e,s)))||await K.Uj({environment:p,teamStore:t,teamMemberInfos:[s],isSettingDefaultTeam:!0,createNewTeamFlowId:void 0}))}}]})}(e),u&&u())},buttonPopupStore:f,placementToOrigin:ct.Iw.Right,alignmentToOrigin:ct.lU.End})]});return(0,D.jsx)(C.Z,{placement:C.Z.Placement.Left,textWrap:!0,renderTooltip:()=>(0,D.jsx)(c.FormattedMessage,{id:"teamMemberPermissionRoleSelect.permissionOverride.buttonTooltip",defaultMessage:"Set a custom permission level for all pages in this teamspace"}),render:e=>(0,D.jsx)(Me.Z,{...e,focused:!1,style:d,textWrapperStyle:{marginRight:0},disabled:M,onClick:()=>f.setState({open:!0}),title:w,icon:m?(0,D.jsx)("div",{style:{marginTop:8},children:(0,rt.e)({width:14})}):void 0})})}function ht(e){let{teamStore:t,memberInfo:s,permissionItem:i,memberName:o,isPermissionOverridden:r,disabled:d}=e;window.__c={n:"TeamMemberOwnerSelect"};const u=(0,a.qz)(void 0,dt.Z),[m,p]=(0,a.AF)(u),h=(0,n.O7)(),f=(0,a.VK)((()=>v.default.state.currentSpaceStore),[]),y=(0,a.VK)((()=>v.default.state.currentUserStore),[]),x=(0,a.VK)((()=>{const e=null==y?void 0:y.userId;return"user"===s.entity_type&&s.user_id===e}),[null==y?void 0:y.userId,s]),S=()=>p({...m,open:!1}),b=async e=>{S();const i="owner"===e?(0,D.jsx)(c.FormattedMessage,{defaultMessage:"owner",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelOwner"}):(0,D.jsx)(c.FormattedMessage,{defaultMessage:"member",id:"teamMemberPermissionSettings.upgradeGuestConfirmation.roleLabelMember"});if("team_level_guest"!==s.type||"owner"!==e&&"member"!==e)if("owner"===e){if("user"===s.entity_type){const{serverCommitResult:e}=L.createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:h,perform:e=>{K.W8({environment:h,userId:s.user_id,teamStore:t,transaction:e})}});await e}}else x?lt.showDialog({message:(0,D.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.removeSelfTeamOwner.confirmation.message",defaultMessage:"Are you sure you want to remove yourself as a teamspace owner? You'll no longer be able to edit teamspace settings and permissions."}),showCancel:!0,keepFocus:!1,handleCancel:lt.dismissDialog,items:[{label:(0,D.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.permissionSwitcher.accept",defaultMessage:"Change access"}),color:"red",onAccept:M}]}):await M();else{const n=(0,g.Mf)(s.user_id).length;lt.showDialog({message:(0,D.jsx)(D.Fragment,{children:n>1?(0,D.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmationWithOtherTeamspaces.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member, and they will become a member in {numberOfOtherTeams, plural, one {{numberOfOtherTeams} other teamspace} other {{numberOfOtherTeams} other teamspaces}}.",values:{memberOrOwner:i,numberOfOtherTeams:n-1}}):(0,D.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.message",defaultMessage:"Are you sure you want to upgrade this user to a teamspace {memberOrOwner}? They will also be added to the workspace as a member.",values:{memberOrOwner:i}})}),showCancel:!0,keepFocus:!1,handleCancel:lt.dismissDialog,items:[{label:(0,D.jsx)(c.FormattedMessage,{id:"teamMemberPermissionSettings.upgradeGuestConfirmation.accept",defaultMessage:"Add to workspace"}),color:"blue",onAccept:async()=>{if(f){const{serverCommitResult:i}=L.createAndCommit({userAction:"TeamMemberOwnerSelect.handleOwnerMenuItemClicked",environment:h,perform:i=>{K.Ce({environment:h,userId:s.user_id,teamStore:t,transaction:i,spaceStore:f,newTeamRole:e})}});await i}}}]})}},M=async()=>{if("owner"===s.type&&"user"===s.entity_type){const{serverCommitResult:e}=L.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:h,perform:e=>{K.mX({userId:s.user_id,teamStore:t,transaction:e,environment:h})}});await e}else if("member"===s.type){const{serverCommitResult:e}=L.createAndCommit({userAction:"TeamMemberOwnerSelect.handleSetMemberAccept",environment:h,perform:e=>{K.X0({environment:h,memberInfo:s,teamStore:t,transaction:e})}});await e}},w=async()=>{const{entity_type:e}=s;switch(S(),e){case"group":const i=(0,J.TC)({spaceStore:f,groupId:s.group_id});if(!i)throw new Error("Permission group not found in space.");K.mN({environment:h,teamStore:t,group:i});break;case"user":await K.WO({environment:h,teamStore:t,currentSpaceStore:f,userId:s.user_id,from:"team_settings_member_table"});break;default:(0,l.t1)(e)}};return(0,D.jsx)(we.ZP,{buttonPopupStore:u,placementToOrigin:ct.Iw.Bottom,renderOrigin:e=>(0,D.jsx)(yt,{buttonPopupEvents:e,isPermissionOverridden:r,permissionItem:i,memberInfo:s,disabled:d}),render:()=>(0,D.jsx)(ft,{teamStore:t,isPermissionOverridden:r,memberInfo:s,permissionItem:i,memberName:o,onMenuItemClicked:b,onRemoveClicked:w,onSubMenuItemClicked:S}),popupType:we.Z4.Popup})}function ft(e){let{teamStore:t,isPermissionOverridden:s,memberInfo:i,permissionItem:n,memberName:l,onRemoveClicked:u,onMenuItemClicked:m,onSubMenuItemClicked:h}=e;window.__c={n:"OwnerMemberMenuList"};const f=(0,a.VK)((()=>{const{currentSpaceStore:e}=v.default.state;return!Boolean(null==e?void 0:e.getSettingsStore().getKeyStore("disable_team_guests").getValue())&&(0,xe.F$)()}),[]),y=(0,a.VK)((()=>t.isDefault()),[t]),x=(0,a.VK)((()=>(0,g.Hu)({membership:t.getKeyStore("membership").getValue()})),[t]),S=(0,a.VK)((()=>1===t.getMembers().filter((e=>"owner"===e.type)).length),[t]),b=(0,o.yK)((e=>{const t={paddingTop:5,paddingBottom:5},s={...t,width:280,alignItems:"flex-start"};return{actionMenu:{marginTop:-4},removeButton:{...t,color:e.errorText},menuItem:s,indentedMenuItem:{...s,paddingLeft:20},overrideLabel:{paddingLeft:10,color:e.mediumTextColor,fontSize:12,fontWeight:d.Z.fontWeight.regular}}}),[]),M=(e,t)=>{const i=("owner"===e||"team_level_guest"===e)&&"group"===t.entity_type,a="member"===e&&"owner"===t.type&&S,o="team_level_guest"===e&&("owner"===t.type||"member"===t.type),r=i||a||o;return{key:e,action:()=>m(e),render:l=>{const d=!s&&t.type===e;return(0,D.jsx)(C.Z,{disableTooltip:!r,placement:C.Z.Placement.Right,textWrap:!0,renderTooltip:()=>i?"owner"===e?(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableOwnerForGroupsTooltip",defaultMessage:"Groups can't be teamspace owners"}):(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableTeamGuestForGroupsTooltip",defaultMessage:"Groups can't be teamspace guests"}):a?(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableWithOnlyOneOwnerTooltip",defaultMessage:"Add another teamspace owner to downgrade yourself to member"}):o?(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.memberItem.disableDowngradeToGuestTooltip",defaultMessage:"To change this user to a teamspace guest, first remove them from the workspace."}):void 0,render:t=>(0,D.jsx)("span",{...t,children:(0,D.jsx)(Me.Z,{...l,style:d?b.menuItem:b.indentedMenuItem,disabled:r,disabledFeedback:r,title:(0,D.jsx)(vt,{isPermissionOverridden:s,type:e,permissionItem:n}),caption:St(e),shouldWrapCaption:!0,icon:d?(0,rt.e)({width:14}):void 0})})})}}},w=y&&"user"===i.entity_type,j="group"!==i.entity_type,k="group"!==i.entity_type&&f,_=[{key:"teamRoles",items:r.oA([j?M("owner",i):void 0,M("member",i),k?M("team_level_guest",i):void 0,bt({onRemoveClicked:u,styles:b,isMemberInDefaultTeam:w}),..."owner"===i.type||x?[]:[{key:"divider",action:()=>{},render:()=>(0,D.jsx)(ut.Z,{size:10})},{key:"permissions_override",action:()=>{},render:e=>(0,D.jsx)("span",{...e,children:(0,D.jsx)(gt,{teamStore:t,memberInfo:i,permissionItem:n,memberName:l,onMenuItemClicked:h,isPermissionOverridden:s,style:s?b.menuItem:b.indentedMenuItem})})}]]),render:e=>(0,D.jsx)(ke.Z,{...e,topBorder:0!==e.index})}];return(0,D.jsx)(je.Z,{className:p.a6i,menuType:Se.og.Popup,children:(0,D.jsx)(Ce.Z,{type:Ce.i.Vertical,initialFocus:void 0,sections:_})})}function yt(e){let{buttonPopupEvents:t,disabled:s,isPermissionOverridden:i,permissionItem:n,memberInfo:a}=e;window.__c={n:"SelectButton"};const r=(0,o.yK)((e=>({label:{color:e.regularTextColor,fontSize:12.5,fontWeight:d.Z.fontWeight.regular},overrideLabel:{color:e.mediumTextColor,fontSize:12,fontWeight:d.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),u=function(e,t,s){if(t&&s)return function(e){switch(e){case"none":return(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.none",defaultMessage:"No access"});case"reader":return(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.reader",defaultMessage:"Can view"});case"comment_only":return(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.comment_only",defaultMessage:"Can comment"});case"content_only_editor":return(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.content_only_editor",defaultMessage:"Can edit content"});case"membership_admin":case"read_and_write":return(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.read_and_write",defaultMessage:"Can edit"});case"editor":return(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.editor",defaultMessage:"Full access"});default:(0,l.t1)(e)}}(s);return xt(e)}(a.type,i,n.role);return(0,D.jsxs)(re.Z,{disabled:s,...t,children:[i&&(0,D.jsxs)("span",{style:r.overrideLabel,children:[(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.roleName.custom",defaultMessage:"Custom"}),(0,D.jsx)("span",{style:{marginLeft:5,marginRight:5},children:"•"})]}),(0,D.jsx)("span",{style:r.label,children:u}),!s&&(0,de.i)(r.chevron)]})}function vt(e){let{isPermissionOverridden:t,permissionItem:s,type:i}=e;const n=xt(i);return(0,D.jsx)("div",{children:(0,D.jsx)("span",{children:n})})}function xt(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,D.jsx)(c.FormattedMessage,{...g.q9[e].label});case"none":return;default:(0,l.t1)(e)}}function St(e){switch(e){case"owner":case"member":case"team_level_guest":return(0,D.jsx)(c.FormattedMessage,{...g.q9[e].caption});case"none":return;default:(0,l.t1)(e)}}function bt(e){let{styles:t,onRemoveClicked:s,isMemberInDefaultTeam:i}=e;const n=i?(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.remove.disabledTooltip.cannotRemoveFromDefault",defaultMessage:"Members cannot be removed from a default teamspace."}):void 0;return{key:"remove",action:s,render:e=>(0,D.jsx)(C.Z,{disableTooltip:!n,placement:C.Z.Placement.Right,textWrap:!1,renderTooltip:()=>n,render:s=>(0,D.jsx)("span",{...s,children:(0,D.jsx)(Me.Z,{...e,style:{...t.removeButton,...t.indentedMenuItem},disabled:Boolean(n),disabledFeedback:!0,title:(0,D.jsx)(c.FormattedMessage,{id:"TeamMemberOwnerSelect.remove",defaultMessage:"Remove"})})})})}}var Mt=s(85387);function wt(e){window.__c={n:"TeamPermissionRowAvatar"};const{icon:t,label:s,name:i,tag:n,style:a}=e,r=(0,o.yK)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",gap:10,...a},labelContainer:{display:"flex",flexDirection:"column",...d.Z.textOverflowStyle,marginLeft:5},name:{minWidth:30},nameContainer:{display:"flex",flexDirection:"row",alignItems:"center"}})),[a]);return(0,D.jsxs)("div",{style:r.container,children:[t,(0,D.jsxs)("div",{style:r.labelContainer,children:[(0,D.jsxs)("div",{style:r.nameContainer,children:[(0,D.jsx)(Mt.s,{style:r.name,children:i}),n]}),s&&(0,D.jsx)(k.Z,{isSmall:!0,isSecondaryColor:!1,isMultiline:!0,children:(0,D.jsx)(Mt.s,{children:s})})]})]})}function jt(e){window.__c={n:"TeamPermissionRowItem"};const{iconComponent:t,label:s,name:i,permissionRoleSelectComponent:n,tag:a,tooltip:r,style:l}=e,d=(0,o.yK)((e=>({permissionRow:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:36,justifyContent:"space-between",alignItems:"center",...l}})),[l]);return(0,D.jsxs)("div",{style:d.permissionRow,children:[(0,D.jsx)(wt,{icon:t,name:i,tag:a,label:s,style:{minWidth:200,marginRight:6}}),(0,D.jsx)(C.Z,{textWrap:!0,style:{width:210},disableTooltip:!r,placement:C.Z.Placement.Left,renderTooltip:()=>r,render:e=>(0,D.jsx)("span",{...e,children:n})})]})}function Ct(e){window.__c={n:"SpecificTeamMemberPermissionRow"};const{type:t,store:s,permissionItem:i,memberInfo:r}=e,d=(0,a.VK)((()=>v.default.state.currentSpaceStore),[]),u=(0,c.useIntl)(),m=(0,a.VK)((()=>{switch(t){case"group":return"none";case"user":return null!=d&&d.isDefined()?(0,tt.su)(null==d?void 0:d.getPermissionItems(),e.memberInfo.user_id):"none";default:(0,l.t1)(t)}}),[d,t,e]),p=(0,h.q)(s),g=(0,a.VK)((()=>{const{currentSpaceStore:e}=v.default.state;return null==e?void 0:e.canEditMembership()}),[]),f=(0,n.O7)(),y=(0,a.VK)((()=>{const e=f.currentUser.id,t=s.getSettingsStore().getValue();return!!(null!=d&&d.isDefined()&&s.isDefined()&&t&&e)&&(0,Je.W9)({membership:s.getMembers(),settings:t,is_default:s.isDefault()},e,{permissions:d.getPermissionItems(),subscription_tier:d.getSubscriptionTier(),permission_groups:d.getPermissionGroups()})}),[f.currentUser.id,d,s]),x=(0,a.VK)((()=>{const e=s.getPermissionItems()||[];switch(r.entity_type){case"group":return!!e.find((e=>(0,ce.hV)(e)&&e.group_id===r.group_id));case"user":return!!e.find((e=>(0,ce.jg)(e)&&e.user_id===r.user_id));default:return!1}}),[r,s]),{name:S,label:b,icon:M}=(0,a.VK)((()=>{switch(t){case"group":return _t({permissionGroup:e.permissionGroup,spaceId:null==d?void 0:d.id});case"user":return function(e){let{intl:t,userStore:s}=e;return{name:(0,et.Nz)(t,null==s?void 0:s.getModel()),label:null==s?void 0:s.getEmail(),icon:(0,D.jsx)(at.Z,{avatarShouldShowShadow:!0,userStore:s,size:32})}}({intl:u,userStore:e.userStore});default:(0,l.t1)(t)}}),[t,e,u,null==d?void 0:d.id]),w=(0,D.jsx)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:(0,D.jsx)(ht,{teamStore:s,memberInfo:r,memberName:S,permissionItem:i,isPermissionOverridden:x,disabled:!p&&!y||"team_level_guest"===r.type&&!g})}),j=(0,o.yK)((e=>({row:{minHeight:52},pill:{marginLeft:6,height:17}})),[]);return(0,D.jsx)(jt,{style:j.row,tag:(0,ce.Bc)(m)?(0,D.jsx)(st.Z,{desktopStyle:j.pill,mobileStyle:j.pill,role:kt(m)}):"group"===t?(0,D.jsx)("div",{style:j.pill,children:M}):void 0,permissionRoleSelectComponent:w,iconComponent:"group"===t?(0,D.jsx)(it.Z,{size:32}):M,name:S,label:b})}function kt(e){switch(e){case"editor":return"admin";case"membership_admin":return"membership_admin";default:(0,l.t1)(e)}}function _t(e){let{spaceId:t,permissionGroup:s}=e;const{name:i,user_ids:n,icon:a}=s,o=(null==n?void 0:n.length)??0;return{name:i??(0,D.jsx)(c.FormattedMessage,{id:"teamPermissionSettings.unknownGroup",defaultMessage:"Unknown Group"}),label:(0,D.jsx)(C.Z,{placement:C.Z.Placement.Bottom,alignment:C.Z.Alignment.Start,disableTooltip:0===o,renderTooltip:()=>(0,D.jsx)(ot.Y,{group:s,limit:10,noMembersMessage:void 0}),render:e=>(0,D.jsxs)("div",{...e,children:[(0,D.jsx)(c.FormattedMessage,{id:"teamPermissionSettings.group",defaultMessage:"Group"})," • ",(0,D.jsx)(c.FormattedMessage,{id:"teamPermissionSettings.numberOfMembers",defaultMessage:"{groupSize, plural, one {{groupSize} member} other {{groupSize} members}}",values:{groupSize:o}})]})}),icon:a&&(0,D.jsx)(nt.Z,{bucket:"public",disabled:!0,onChange:()=>{},isEmptyPage:!1,title:i,size:18,icon:a&&t?{icon:a,pointer:{table:Xe.bx,id:t}}:void 0})}}var Tt=s(47453),It=s(34583);function Pt(e){let{teamStore:t,...s}=e;window.__c={n:"SpecificTeamMemberToAddRow"};const r=(0,n.O7)(),l=(0,a.VK)((()=>{var e;return null===(e=v.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),d=(0,c.useIntl)(),u=(0,o.yK)((()=>({container:{display:"flex",flexDirection:"row",lineHeight:1.2,fontSize:14,width:"100%",minHeight:52,justifyContent:"space-between",alignItems:"center"},pill:{marginLeft:6,height:17}})),[]),m=(0,i.useCallback)((e=>{R.oV({label:(0,D.jsx)(c.FormattedMessage,{id:"SpecificTeamMemberToAddRow.team_invite_failure",defaultMessage:"Failed to add {userOrGroupName}",values:{userOrGroupName:e}})})}),[]),p=(0,i.useCallback)((async(e,s)=>{await K.Uj({environment:r,teamMemberInfos:[e],teamStore:t,isSettingDefaultTeam:!1,createNewTeamFlowId:void 0})?await It.bi(r):m(s)}),[r,m,t]),g=(0,i.useCallback)(((e,t)=>p({type:"member",entity_type:"user",user_id:e.id},t)),[p]),h=(0,i.useCallback)(((e,t)=>p({type:"member",entity_type:"group",group_id:e.id},t)),[p]);if("memberToAdd"in s){const{memberToAdd:e}=s,t=(0,et.Nz)(d,e);return(0,D.jsxs)("div",{style:u.container,children:[(0,D.jsx)(wt,{icon:(0,D.jsx)(at.Z,{userValue:e,size:32}),name:t,label:e.email}),Zt((()=>{g(e,t)}))]})}{if(!l)return(0,D.jsx)(D.Fragment,{});const{groupToAdd:e}=s,t=_t({spaceId:l,permissionGroup:e});return(0,D.jsxs)("div",{style:u.container,children:[(0,D.jsx)(wt,{icon:(0,D.jsx)(it.Z,{size:32}),name:t.name,label:t.label,tag:(0,D.jsx)("div",{style:u.pill,children:t.icon})}),Zt((()=>{h(e,t.name)}))]})}}const Zt=e=>(0,D.jsx)(re.Z,{isBlue:!0,onClick:e,icon:Tt.R,children:(0,D.jsx)(c.FormattedMessage,{id:"SpecificTeamMemberToAddRow.addMemberButton.text",defaultMessage:"Add"})});var Ft=s(40745),At=s(8597);function Dt(e){let{sortType:t,onChangeSortType:s}=e;window.__c={n:"TeamPermissionsListHeader"};const i=(0,o.yK)((e=>({container:{width:"100%",display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${e.regularDividerColor}`}})),[]),n=e=>e===t.column?t.sortedAscending?"ascending":"descending":"none",a=e=>{const i=e===t.column&&!t.sortedAscending;s({column:e,sortedAscending:i})};return(0,D.jsx)(D.Fragment,{children:(0,D.jsxs)("div",{style:i.container,children:[(0,D.jsx)(Bt,{title:(0,D.jsx)(c.FormattedMessage,{id:"TeamPermissionsListHeader.nameColumn",defaultMessage:"Name"}),sortedType:n("name"),onClick:()=>a("name")}),(0,D.jsx)(Bt,{title:(0,D.jsx)(c.FormattedMessage,{id:"TeamPermissionsListHeader.roleColumn",defaultMessage:"Role"}),sortedType:n("role"),onClick:()=>a("role")})]})})}function Bt(e){let{sortedType:t,title:s,onClick:i}=e;window.__c={n:"HeaderLabel"};const n=(0,o.yK)((e=>({button:{color:e.mediumTextColor,fontSize:12,padding:0},buttonHover:{background:"unset"},sortIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor}})),[]);return(0,D.jsxs)(re.Z,{style:n.button,hoveredStyle:n.buttonHover,onClick:i,children:["ascending"===t&&(0,At.Z)(n.sortIcon),"descending"===t&&(0,Ft.M)(n.sortIcon),s]})}function Rt(e){var t;let{store:s}=e;window.__c={n:"TeamPermissionsList"};const r=(0,n.O7)(),u=(0,o.yK)((e=>({container:{display:"block",overflow:"hidden"},membersHeader:{marginBottom:8},noResult:{fontSize:d.Z.fontSize.UIRegular.desktop,color:e.mediumTextColor,marginTop:8},showMore:{marginBottom:24,width:"max-content"}})),[]),m=(0,c.useIntl)(),[p,h]=(0,i.useState)({column:"role",sortedAscending:!1}),[f]=(0,a.AF)(y.Z),x=(0,We.e)(s),S=(0,a.VK)((()=>s.getMembers()),[s]),b=(0,a.VK)((()=>v.default.state.currentSpaceStore),[]),M=(0,a.VK)((()=>v.default.state.currentUserStore),[]),{permissionRowInfos:w,numNotShown:j}=(0,a.VK)((()=>{const e=function(e){let{permissionRowInfos:t,memberFilterQuery:s,intl:i}=e;if(""===s)return t;return(0,qe.ZP)(s,t,(e=>{const{type:t}=e;switch(t){case"group":return e.permissionGroup.name??"";case"user":const{userStore:s}=e;return s.getSearchName(i);default:(0,l.t1)(t)}}))}({permissionRowInfos:(0,g.tu)({currentUserStore:M,currentSpaceStore:b,teamStore:s,members:S}),memberFilterQuery:f.memberFilterQuery,intl:m}),t=function(e){let{permissionRowInfos:t,sortType:s,intl:i}=e;const{column:n,sortedAscending:a}=s,o={permissionRowInfos:t,sortedAscending:a};if("role"===n)return function(e){let{permissionRowInfos:t,sortedAscending:s}=e;const i=["owner","member","team_level_guest"],n=["group","user"];return[...t].sort(((e,t)=>{const s=e.memberInfo.entity_type,i=t.memberInfo.entity_type;return n.indexOf(s)-n.indexOf(i)})).sort(((e,t)=>{const n=e.memberInfo.type,a=t.memberInfo.type,o=i.indexOf(n)-i.indexOf(a);return s?-o:o}))}(o);if("name"===n)return function(e){let{permissionRowInfos:t,sortedAscending:s,intl:i}=e;return[...t].sort(((e,t)=>{const n=Lt(e,i)??"",a=Lt(t,i)??"";if(n===a)return 0;const o=n<a?-1:1;return s?-o:o}))}({...o,intl:i});(0,l.t1)(n)}({permissionRowInfos:e,sortType:p,intl:m}),i=f.limitMembers?t.slice(0,50):t;return{permissionRowInfos:i,numNotShown:e.length-i.length}}),[b,M,S,s,p,f.memberFilterQuery,f.limitMembers,m]),[C]=(0,Ye.r5)((async()=>{var e;if(!x||null===(e=f.memberFilterQuery)||void 0===e||!e.trim().length)return[];const t=(await Qe.Yu({environment:r,query:f.memberFilterQuery,membersOnly:!0})).map((e=>({type:"user",value:e}))),s=Qe.$w({query:f.memberFilterQuery,intl:m}).map((e=>({type:"group",value:e}))),i=new Set(w.map(Et));return[...t,...s].filter((e=>!i.has(e.value.id))).slice(0,5)}),[x,f.memberFilterQuery,r,m,w]),k=Boolean(null===(t=f.memberFilterQuery)||void 0===t?void 0:t.trim().length),_=w.length>0,T="resolved"===C.status?C.value:[];return(0,D.jsxs)("div",{style:u.container,children:[(0,D.jsx)(Nt,{title:k?(0,D.jsx)(c.FormattedMessage,{id:"TeamPermissionsList.search.inThisTeam",defaultMessage:"In this team"}):(0,D.jsx)(Dt,{sortType:p,onChangeSortType:h}),rows:w,renderRow:e=>(0,D.jsx)(Ct,{store:s,...e})}),j>0&&(0,D.jsx)($e.Z,{style:u.showMore,onClick:()=>{y.Z.setState({...f,limitMembers:!1})},children:(0,D.jsx)(c.FormattedMessage,{defaultMessage:"Show {numNotShown} more",id:"teamPermissionSettings.member.showMore",values:{numNotShown:j}})}),T.length>0&&(0,D.jsx)(Nt,{title:(0,D.jsx)(c.FormattedMessage,{id:"TeamPermissionsList.search.notInTeam",defaultMessage:"Not in team"}),rows:T,renderRow:e=>"user"===e.type?(0,D.jsx)(Pt,{teamStore:s,memberToAdd:e.value}):(0,D.jsx)(Pt,{teamStore:s,groupToAdd:e.value})}),!_&&0===T.length&&(0,D.jsx)("div",{style:u.noResult,children:(0,D.jsx)(c.FormattedMessage,{id:"TeamPermissionsList.search.zeroState",defaultMessage:"No members or groups found"})})]})}function Lt(e,t){const{type:s}=e;if("user"===s){const{userStore:s}=e;return s.getDisplayName(t)}if("group"===s){const{permissionGroup:t}=e;return t.name}(0,l.t1)(s)}function Nt(e){let{rows:t,renderRow:s,title:n}=e;window.__c={n:"TeamPermissionListInner"};const a=(0,o.yK)((e=>({membersList:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",width:"100%",marginBottom:12},memberDivider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[]);return t.length?(0,D.jsxs)(D.Fragment,{children:[n&&(0,D.jsx)(k.Z,{isSmall:!0,children:n}),(0,D.jsx)("div",{style:a.membersList,children:t.map(((e,t)=>(0,D.jsxs)(i.Fragment,{children:[t>0&&(0,D.jsx)("div",{style:a.memberDivider}),s(e)]},t)))})]}):null}function Et(e){switch(e.type){case"user":return e.memberInfo.user_id;case"group":return e.memberInfo.group_id;default:(0,l.t1)(e)}}function Ot(e){let{teamStore:t}=e;window.__c={n:"TeamMembersListSection"};const s=(0,o.yK)((()=>({content:{display:"grid",gridAutoFlow:"row",rowGap:6}})),[]);return(0,D.jsxs)("div",{style:s.content,children:[(0,D.jsx)(Ge,{teamStore:t}),(0,D.jsx)(Rt,{store:t})]})}var Vt=s(79362);function Ut(e){window.__c={n:"TeamGuestsPermissionRow"};const{teamStore:t}=e,s=(0,n.O7)(),i=(0,c.useIntl)(),{teamGuestPermissionItem:r,teamPermissions:l}=(0,a.VK)((()=>({teamGuestPermissionItem:t.getTeamGuestsPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),d=V(t),u=(0,a.VK)((()=>[{role:"editor",disabledInfo:{isDisabled:!0,disabledMessage:i.formatMessage({id:"teamPermissionsSettings.teamspace.guest.disabledPermissionitem.description",defaultMessage:"Teamspace guests can't have full access."})}},{role:"read_and_write",disabledInfo:void 0},{role:"comment_only",disabledInfo:void 0},{role:"reader",disabledInfo:void 0}]),[i]),m=(0,o.yK)((e=>({button:{fontSize:12.5,marginRight:0,color:e.mediumTextColor}})),[]),p=r&&(0,D.jsx)(pt.ZP,{role:r.role,table:mt.e0,type:"explicit_team_guest_permission",upgradeButtonName:"team_permission_item",disabled:d,buttonStyle:m.button,availableRoleItems:u,onChange:async e=>{if(l.filter((t=>((0,ce.jg)(t)||(0,ce.hV)(t))&&(0,ue.xO)(e,t.role))).length>0){if(!(await(0,E.Bt)()))return}L.createAndCommit({userAction:"TeamGuestsPermissionRow.permissionComponent",environment:s,perform:i=>{K.$J({environment:s,teamStore:t,newRole:e,transaction:i,permissionsToClear:[]})}})}}),g=(0,a.VK)((()=>t.getName()),[t]),h=(0,a.VK)((()=>t.getIcon()),[t]),f=h&&Vt.V2(h.icon)?Vt.mk(h.icon):"gray",y=h?{...h,icon:`/icons/user-circle_${f}.svg`}:void 0,v=(0,D.jsx)($.p,{disabled:!0,store:t,size:X.Kt,icon:y});return p?(0,D.jsx)(jt,{permissionRoleSelectComponent:p,iconComponent:v,name:Wt(g)}):null}function Wt(e){return e?(0,D.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,D.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace guests",id:"TeamMembersTopSection.permissionItem.guest.defaultAccessWithoutTeamspaceName"})}function zt(e){window.__c={n:"TeamMembersPermissionRow"};const{teamStore:t}=e,s=(0,n.O7)(),i=(0,o.Fg)(),r=(0,c.useIntl)(),{teamPermissionItem:l,teamPermissions:d}=(0,a.VK)((()=>({teamPermissionItem:t.getTeamPermission(),teamPermissions:t.getPermissionItems()||[]})),[t]),u=V(t),m=(0,a.VK)((()=>{var e;const s=null===(e=t.getPermissionItems())||void 0===e?void 0:e.find((e=>"space_permission"===e.type)),i=r.formatMessage({id:"teamPermissionsSettings.teamspace.disabledPermissionitem.description",defaultMessage:"Teamspace members can't have lower permissions than workspace members"});function n(e){return s&&e!==s.role&&(0,ue.nl)(e,s.role)===s.role&&!t.isDefault()?{isDisabled:!0,disabledMessage:i}:void 0}return[{role:"editor",disabledInfo:n("editor")},{role:"read_and_write",disabledInfo:n("read_and_write")},{role:"comment_only",disabledInfo:n("comment_only")},{role:"reader",disabledInfo:n("reader")}]}),[r,t]),p=l&&(0,D.jsx)(pt.ZP,{role:l.role,table:mt.e0,type:(0,ce.zU)(l)?"explicit_team_permission":"team_permission",upgradeButtonName:"team_permission_item",disabled:u,buttonStyle:{fontSize:12.5,marginRight:0,color:i.mediumTextColor},availableRoleItems:m,onChange:async e=>{const i=d.filter((t=>((0,ce.jg)(t)||(0,ce.hV)(t))&&(0,ue.xO)(e,t.role)));if(i.length>0){if(!(await(0,E.Bt)()))return}L.createAndCommit({userAction:"TeamMembersPermissionRow.permissionComponent",environment:s,perform:n=>{K.xI({environment:s,teamStore:t,newRole:e,transaction:n,permissionsToClear:i})}})}}),{teamName:g}=(0,a.VK)((()=>({teamName:t.getName()})),[t]),h=(0,D.jsx)($.p,{disabled:!0,store:t,size:X.Kt});return(0,D.jsx)(jt,{permissionRoleSelectComponent:p,iconComponent:h,name:Kt(g)})}function Kt(e){return e?(0,D.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessTeamSpaceName",values:{teamName:e}}):(0,D.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace members",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutTeamspaceName"})}var Ht=s(19889),Gt=s(62512);function qt(e){window.__c={n:"TeamOwnersPermissionRow"};const{teamStore:t,teamOwnerIds:s}=e,i=(0,o.Fg)(),n=(0,a.VK)((()=>t.getName()),[t]),r=(0,a.VK)((()=>t.getTeamOwnerPermission()),[t]),l=(0,a.VK)((()=>v.default.state.currentUserStore),[]),d=(0,a.VK)((()=>l?s.map((e=>x.U6.createChildStore(l,{table:Ht.KJ,id:e}))):[]),[l,s]);return(0,D.jsx)(jt,{tooltip:(0,D.jsx)(c.FormattedMessage,{id:"TeamOwnersPermissionRow.teamspaceOwnersRowTooltip",defaultMessage:"Teamspace owners have full access to teamspace pages by default"}),permissionRoleSelectComponent:(0,D.jsx)(pt.ZP,{role:"editor",table:mt.e0,type:r&&(0,ce.LW)(r)?"explicit_team_owner_permission":"team_owner_permission",upgradeButtonName:"team_owner_permission_item",disabled:!0,buttonStyle:{fontSize:12.5,color:i.mediumTextColor,marginRight:0},availableRoleItems:[]}),iconComponent:(0,D.jsx)(Gt.n,{teamStore:t,ownerStores:d,isSmall:!0}),name:Yt(n)})}function Yt(e){return e?(0,D.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleName",values:{teamName:e}}):(0,D.jsx)(c.FormattedMessage,{defaultMessage:"Teamspace owners",id:"TeamOwnersPermissionRow.permissionItem.teamspaceOwnersAccessToggleNameWithoutTeamName"})}var Qt=s(16184),$t=s(76464);function Xt(e){window.__c={n:"TeamSpacePermissionRow"};const{teamStore:t}=e,s=(0,n.O7)(),i=(0,a.VK)((()=>v.default.state.currentSpaceStore),[]),{iconComponent:o,spaceName:r}=(0,a.VK)((()=>{if(!i)return{iconComponent:void 0,spaceName:void 0};const e=(0,J.rn)(s,i);return{iconComponent:(0,D.jsx)($.p,{disabled:!0,store:i,size:X.Kt}),spaceName:e}}),[i,s]);return(0,D.jsx)(jt,{permissionRoleSelectComponent:(0,D.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:(0,D.jsx)(es,{teamStore:t})}),iconComponent:o,name:Jt(r)})}function Jt(e){return e?(0,D.jsx)(c.FormattedMessage,{defaultMessage:"Everyone else in {spaceName}",id:"TeamMembersTopSection.permissionItem.defaultAccessSpaceName",values:{spaceName:e}}):(0,D.jsx)(c.FormattedMessage,{defaultMessage:"Everyone else in the workspace",id:"TeamMembersTopSection.permissionItem.defaultAccessWithoutSpaceName"})}function es(e){window.__c={n:"TeamPermissionRoleSelect"};const{teamStore:t}=e,s=(0,n.O7)(),i=(0,o.Fg)(),l=(0,a.VK)((()=>t.getSpacePermission()||{type:"space_permission",role:"none"}),[t]),d=V(t),u=(0,a.VK)((()=>{const e=t.getSettingsStore().getValue();if(e)return fe({id:t.id,permissions:t.getPermissionItems(),settings:e,is_default:t.isDefault()})}),[t],{useDeepEqual:!0});if(!u)return null;const m=u.permissionItemRoleOptions.spacePermission;if(1===m.length&&"none"===m[0])return(0,D.jsx)(C.Z,{renderTooltip:()=>(0,D.jsx)(c.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessTooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,D.jsxs)("div",{style:{display:"flex",alignItems:"center",maxWidth:170},...e,children:[(0,Qt.Q)({width:14,height:14,fill:i.timelineRed,marginRight:4}),(0,D.jsx)("div",{style:{fontSize:12.5,color:i.timelineRed,marginRight:8},children:(0,D.jsx)(c.FormattedMessage,{id:"teamPermissionsSettings.privateTeam.noAccessLabel",defaultMessage:"No access • Invite only"})})]})});{const e=r.MR(m,(e=>-ce.xm[e])).map((e=>({role:e})));return(0,D.jsx)(pt.ZP,{role:l.role,table:mt.e0,type:"space_permission",upgradeButtonName:"space_permission_item",disabled:d||1===m.length,buttonStyle:{fontSize:12.5,marginRight:0,color:i.mediumTextColor},availableRoleItems:e,onChange:e=>{const i={...l,role:e};L.createAndCommit({userAction:"TeamSpacePermissionRow.permissionComponent",environment:s,perform:e=>{$t.ep({environment:s,store:t,permissionItems:[i],transaction:e})}})}})}}function ts(e){let{teamStore:t}=e;window.__c={n:"TeamPermissionRowsSection"};const s=(0,a.VK)((()=>t.isDefault()),[t]),i=(0,a.VK)((()=>(0,Je.XO)({membership:t.getMembers()})),[t]),n=(0,a.VK)((()=>{const e=v.default.state.currentSpaceStore;if(!e)return!1;return!(null==e?void 0:e.getDisableTeamGuests())&&(!s&&(0,xe.F$)())}),[s]),r=(0,o.yK)((()=>({container:{marginLeft:15,marginRight:7,paddingBottom:4,paddingTop:4}})),[]);return(0,D.jsxs)("div",{style:r.container,children:[(0,D.jsx)(qt,{teamStore:t,teamOwnerIds:i},"0"),(0,D.jsx)(zt,{teamStore:t},"1"),n&&(0,D.jsx)(Ut,{teamStore:t},"2"),!s&&(0,D.jsx)(Xt,{teamStore:t},"3")]})}var ss=s(49469);function is(e){let{teamStore:t}=e;window.__c={n:"TeamSettingsMembers"};const s=(0,o.yK)((()=>({spacer:{width:"100%",height:20},heading:{marginBottom:10}})),[]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(ns,{teamStore:t}),(0,D.jsx)("div",{style:s.spacer}),(0,D.jsx)(ss.z,{title:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.membersTitle",defaultMessage:"Members"}),style:s.heading}),(0,D.jsx)(Ot,{teamStore:t})]})}function ns(e){let{teamStore:t}=e;window.__c={n:"PermissionsCard"};const s=(0,n.O7)(),r=(0,a.VK)((()=>t.getName()),[t]),l=(0,o.yK)((()=>({learnMoreLinkContainer:{marginTop:15,marginBottom:15},teamSettingsListItems:{padding:0,margin:0},accessButton:{border:"none"}})),[]),d=(0,i.useCallback)(((e,i)=>{K.Ju({environment:s,accessLevel:e,isDefault:i,store:t,teamName:r,from:"sidebar_team_modal"})}),[s,t,r]),u=(0,a.VK)((()=>t.getTeamAccessLevel()),[t]),m=[(0,D.jsx)(ee._,{teamStore:t,currentAccessLevel:u,onChange:d,style:l.accessButton},"visibility"),(0,D.jsx)(ts,{teamStore:t},"permissions")];return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(X.Ph,{title:(0,D.jsx)(c.FormattedMessage,{id:"TeamSettingsMembers.memberSettings.permissionsTitle",defaultMessage:"Permissions"}),rows:m,itemStyle:l.teamSettingsListItems}),(0,D.jsx)(Q.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_team_settings_permissions",message:(0,D.jsx)(c.FormattedMessage,{id:"teamSettingsPermissions.learnMore",defaultMessage:"Learn about teamspace permissions"}),containerStyle:l.learnMoreLinkContainer})]})}var as=s(74136);function os(e){return(0,D.jsx)(as.Z,{...e,children:(0,D.jsx)(c.FormattedMessage,{id:"sidebarTeamModalTab.unownedBadge",defaultMessage:"Unowned"})})}function rs(e){window.__c={n:"ModalContent"};const{teamStore:t}=e,s=(0,a.VK)((()=>y.Z.state.tab),[]);if(void 0===s)return null;switch(s){case y.a.General:return(0,D.jsx)(Ne,{teamStore:t});case y.a.Members:return(0,D.jsx)(is,{teamStore:t});case y.a.Security:return(0,D.jsx)(Fe,{teamStore:t});default:(0,l.t1)(s)}}function ls(e){window.__c={n:"UserWithAvatar"};const{userId:t,currentSpaceStore:s}=e,{userStore:i,isDefined:n}=(0,a.VK)((()=>{const e=x.U6.createChildStore(s,{table:"notion_user",id:t,spaceId:s.id});return{userStore:e,isDefined:e.isDefined()}}),[s,t]);return n?(0,D.jsx)(_.Z,{avatarShouldShowShadow:!0,userStore:i,style:{paddingRight:6,minHeight:34,lineHeight:1.2,fontSize:14,width:"100%"},avatarSize:24}):null}function ds(e){window.__c={n:"PeopleRow"};const{userIds:t,label:s,hasMarginTop:i}=e,n=(0,a.VK)((()=>v.default.state.currentSpaceStore),[]);return n?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(T.Z,{hasMarginTop:i,children:s}),t.map((e=>(0,D.jsx)(ls,{userId:e,currentSpaceStore:n},e)))]}):null}function cs(){window.__c={n:"SidebarTeamModal"};const e=(0,n.O7)(),t=(0,a.VK)((()=>v.default.state.currentSpaceStore),[]),s=(0,a.VK)((()=>v.default.state.currentSpaceViewStore),[]),i=(0,n.Fy)(),m=(0,o.yK)((e=>({modal:{width:i.isMobile?"auto":630,height:i.isMobile?"auto":640,maxWidth:"calc(100vw - 100px)",maxHeight:"calc(100vh - 100px)",borderRadius:5,overflow:"auto"},modalWrap:{userSelect:"none",WebkitUserSelect:"none",height:"100%"},innerWrap:{width:"100%",height:"100%",display:"flex",flexDirection:"column",paddingTop:20},header:{display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,margin:"0px 36px"},tabBar:{display:"flex",width:void 0,flexGrow:0,flexShrink:0,margin:"0px 36px 20px"},scroller:{flexGrow:1},contentWrap:{margin:"0px 36px"},lockIcon:{width:16,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},icon:{marginRight:8,fontWeight:d.Z.fontWeight.medium},unownedPill:{marginLeft:6,height:17},unownedPillInner:{display:"flex",height:"100%",alignItems:"center",color:e.regularTextColor,fontWeight:d.Z.fontWeight.regular,textTransform:"unset",fontSize:11}})),[i.isMobile]),{open:f,tab:x,teamStore:j}=(0,a.VK)((()=>{const{open:e,tab:t}=y.Z.state;return{open:e,tab:t,teamStore:y.Z.getTeamStore()}}),[]),C=(0,a.VK)((()=>null==j?void 0:j.getSettings()),[j]),k=(0,h.q)(j);if(!t||!s||!j)return null;const _=[y.a.General,y.a.Members,y.a.Security];return(0,D.jsx)(b.Z,{open:f,innerStyle:m.modal,onDismiss:()=>{y.Z.reset()},render:()=>f?(0,D.jsx)("div",{className:p.rIj,style:{height:"100%"},children:(0,D.jsx)("div",{style:m.modalWrap,children:(0,D.jsx)(S.Z,{capture:!0,onBackspace:r.yR,onLeft:r.yR,onRight:r.yR,onSelectAll:r.yR,onRedo:r.yR,onUndo:r.yR,onCut:r.yR,onCopy:r.yR,onPaste:r.yR,onKeypress:r.yR,onDelete:r.yR,onTab:r.yR,children:(0,D.jsxs)("div",{style:m.innerWrap,children:[(0,D.jsxs)("div",{style:m.header,children:[(0,D.jsx)($.p,{disabled:!0,store:j,size:24,style:m.icon}),(0,D.jsx)(M.Z,{store:j,style:{fontSize:16,fontWeight:d.Z.fontWeight.semibold}}),(0,g.C2)(C)&&(0,D.jsx)(Z.Z,{iconStyle:m.lockIcon}),(0,g.Hu)({membership:j.getRawMembership()})&&(0,D.jsx)("div",{style:{gap:5,display:"flex"},children:(0,D.jsx)(os,{desktopStyle:m.unownedPill,mobileStyle:m.unownedPill,innerStyle:m.unownedPillInner})}),(0,D.jsx)("div",{style:{flexGrow:1}}),(0,D.jsx)(P.M,{teamStore:j,onLeavingTeam:()=>y.Z.reset(),from:"sidebar_team_modal",navigateToTeamHomeOnJoin:!1})]}),(0,D.jsx)(I.Z,{tabs:_.map((e=>function(e,t){switch(e){case y.a.General:return(0,D.jsx)(c.FormattedMessage,{id:"sidebarTeamModalTab.option.general",defaultMessage:"General"});case y.a.Members:return(0,D.jsx)(us,{teamStore:t});case y.a.Security:return(0,D.jsx)(c.FormattedMessage,{id:"sidebarTeamModalTab.option.security",defaultMessage:"Security"});default:(0,l.t1)(e)}}(e,j))),selectedIndex:(0,l.$K)(x)?_.indexOf(x):1,onChange:t=>{f&&(u.rFP(e,{store:j,tab_old_value:x??y.a.General,tab_new_value:_[t]}),y.Z.update((e=>e.open?{...e,tab:_[t]}:e)))},tabStyle:{marginLeft:-8},style:m.tabBar,tabTitleStyle:{marginLeft:8,marginRight:8}}),(0,D.jsx)(w.Z,{type:w.Z.OverflowType.Y,style:m.scroller,children:(0,D.jsx)("div",{style:m.contentWrap,children:(0,D.jsx)(rs,{currentSpaceStore:t,teamStore:j,userIsTeamOwner:k})})})]})})})}):null})}function us(e){let{teamStore:t}=e;window.__c={n:"MembersTabTitle"};const s=(0,f.K)(t),i=(0,o.Fg)();return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(c.FormattedMessage,{id:"sidebarTeamModalTab.option.members",defaultMessage:"Members"}),(0,D.jsx)("span",{children:" "}),(0,D.jsx)("div",{style:{color:i.lightTextColor},children:s})]})}function ms(e){let{title:t,caption:s,secondCaption:i,on:a,disabled:r,tooltip:l,style:d,onChange:c,shouldTriggerUpsell:u}=e;window.__c={n:"SettingToggle"};const p=(0,n.O7)(),g=(0,o.yK)((()=>({root:{display:"flex",alignItems:"center",width:"100%",marginTop:0,marginBottom:0,cursor:u?"pointer":void 0,...d},title:{fontSize:14,marginRight:8,flexGrow:1},switcherWrap:{marginTop:5,marginRight:18}})),[d,u]);return(0,D.jsx)(D.Fragment,{children:(0,D.jsxs)("div",{style:g.root,onClick:()=>{if(u)return m.y(p,{from:"team_security_settings",for:"business",dontOpenPlansOnCancel:!0})},children:[(0,D.jsxs)("div",{style:g.title,children:[t,s&&(0,D.jsx)(k.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"95%"},children:s}),i&&(0,D.jsx)(k.Z,{isSmall:!0,children:i})]}),(0,D.jsx)("div",{style:g.switcherWrap,children:(0,D.jsx)(C.Z,{disableTooltip:!l,renderTooltip:()=>l,render:e=>(0,D.jsx)("div",{...e,children:(0,D.jsx)(j.Z,{on:a,disabled:r,onClick:c})})})})]})})}},95759:(e,t,s)=>{s.r(t),s.d(t,{default:()=>xv});s(21703);var i=s(67294),n=s(83355),a=s(16184),o=s(45238),r=s(85893);const l=(0,o.I)("magnifyingGlass",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M1.321 6.28c0 .751.142 1.458.424 2.118a5.52 5.52 0 001.176 1.737 5.51 5.51 0 001.736 1.175 5.326 5.326 0 002.12.424c.592 0 1.157-.09 1.695-.273a5.639 5.639 0 001.476-.752l3.364 3.37a.8.8 0 00.266.171c.1.041.205.062.315.062a.766.766 0 00.683-.397.83.83 0 00.041-.718.715.715 0 00-.164-.253L11.11 9.581c.351-.456.625-.964.82-1.524.201-.56.301-1.153.301-1.778 0-.752-.14-1.456-.423-2.112a5.497 5.497 0 00-2.92-2.919A5.284 5.284 0 006.777.824c-.752 0-1.458.141-2.119.424a5.52 5.52 0 00-2.912 2.919 5.284 5.284 0 00-.424 2.112zm1.17 0A4.204 4.204 0 013.74 3.25a4.286 4.286 0 011.367-.923 4.179 4.179 0 011.668-.335 4.13 4.13 0 011.662.335 4.19 4.19 0 011.367.923c.392.392.7.848.922 1.367a4.13 4.13 0 01.335 1.661c0 .593-.111 1.149-.335 1.668a4.357 4.357 0 01-2.29 2.283 4.13 4.13 0 01-1.66.335 4.179 4.179 0 01-1.669-.335 4.357 4.357 0 01-2.29-2.283A4.254 4.254 0 012.49 6.28zM6.79 9.15c.114 0 .187-.066.219-.198.068-.369.137-.683.205-.943.068-.26.153-.474.253-.643.1-.173.23-.314.39-.424a2.01 2.01 0 01.628-.26 8.31 8.31 0 01.964-.184c.137-.018.205-.091.205-.219 0-.127-.068-.205-.205-.232a8.214 8.214 0 01-.97-.178 2.217 2.217 0 01-.643-.266 1.355 1.355 0 01-.403-.417 2.49 2.49 0 01-.246-.643 10.063 10.063 0 01-.178-.93c-.023-.136-.096-.205-.219-.205s-.2.066-.232.198c-.073.374-.144.69-.212.95A2.49 2.49 0 016.1 5.2c-.1.169-.233.308-.397.417a2.14 2.14 0 01-.622.26c-.255.064-.574.12-.957.17-.141.028-.212.106-.212.233 0 .123.07.196.212.22.479.05.864.12 1.155.211.292.087.518.216.677.39.164.173.287.41.37.71.086.297.163.675.232 1.135.009.06.034.11.075.15a.228.228 0 00.157.055z"})});var d=s(72126),c=s(4615),u=s(3791),m=s(47425),p=s(82990),g=s(5366),h=s(48298),f=s(7512),y=s(50906),v=s(47307),x=s(91376),S=s(34602),b=s(29974),M=s(71119),w=s(54642);async function j(e,t){const s=await w.getEmailDomainSettings(e,{});"success"===s.type&&t.setState({...t.state,emailDomainSettings:s.data});try{const s=await(0,M.pu)(e);t.setState({...t.state,accountSettings:{...s,error:void 0}})}catch(i){t.setState({...t.state,accountSettings:{...t.state.accountSettings,error:i}})}}var C=s(97627),k=s(5220),_=s(97880),T=s(95697),I=s(80444),P=s(74716),Z=s(49085);class F extends Z.default{getInitialState(){return{loadingState:"uninitialized"}}}const A=new F;async function D(e){let{environment:t,messageStoreEmitValue:s}=e;if(!function(e){const t=A.state;if("loading"===t.loadingState)return!1;if(("uninitialized"===t.loadingState?void 0:t.messageStoreEmitValue)===e)return!1;return!0}(s))return!1;const{currentSpaceStore:i,currentUserStore:n}=I.default.state;if(!i||!n)return!1;"uninitialized"===A.state.loadingState&&A.setState({loadingState:"loading"});const a=await async function(e){let{environment:t,currentSpaceStore:s,currentUserStore:i}=e;const n=s.getModel();if(!n)return;if((0,k.H)({userId:i.id,spaceModel:n})){return await(0,T.sj)({environment:t,spaceStore:s,includeArchived:!0,currentUserId:i.id,minRoleOnTeamStores:"reader"})}return await(0,T.qX)({environment:t,spaceStore:s,includeArchived:!0,currentUserId:i.id})}({environment:t,currentSpaceStore:i,currentUserStore:n});if(!(0,_.$K)(a))return A.setState({loadingState:"uninitialized"}),!1;const{archivedTeams:o,unarchivedTeams:r}=(0,T.tV)(a);return A.setState({loadingState:"loaded",archivedTeamIds:o.map((e=>e.id)),unarchivedTeamIds:r.map((e=>e.id)),messageStoreEmitValue:s}),!0}var B=s(39699),R=s(37181),L=s(480),N=s(86628),E=s(53877),O=s(59730);const V=["page_viewed","page_created","page_deleted","page_restored","page_exported","page_moved","page_permission_updated","page_shared_to_web","file_uploaded","file_downloaded","private_content_transferred","automation_created","automation_edited","member_invited","member_joined","member_role_updated","member_removed","guest_removed","invite_link_toggled","workspace_name_changed","invite_link_reset","page_access_requests_toggled","public_page_sharing_toggled","workspace_sidebar_editing_toggled","disable_team_guests_toggled","disable_guests_toggled","pages_to_other_workspaces_toggled","export_toggled","workspace_exported","workspace_icon_changed","workspace_domain_changed","workspace_integration_restriction_changed","allowed_email_domain_added","allowed_email_domain_removed","public_page_cleared","public_page_set","scim_token_generated","scim_token_revoked","idp_metadata_url_updated","idp_metadata_xml_updated","idp_metadata_xml_removed","saml_toggled","saml_enforce_toggled","automatic_account_creation_toggled","workspace_creation_set_for_email_domain","member_added_to_group","member_removed_from_group","space_transfer_status_changed","space_claim_and_upgrade_status_changed","space_claim_deletion_status_changed","membership_requests_toggled","external_membership_requests_toggled","membership_request_resolved","guest_membership_requests_toggled","audit_log_exported","user_analytics_exported","content_analytics_exported","admin_content_search_queried","workspace_analytics_toggled","login","logout","mfa_sms_toggled","mfa_totp_toggled","mfa_backup_code_toggled","password_set","password_cleared","password_changed","email_changed","preferred_name_changed","picture_changed","user_deleted","allowed_support_access","revoked_support_access","team_created","team_archived","team_restored","team_privacy_type_changed","team_default_toggled","team_public_page_sharing_toggled","team_export_toggled","team_sidebar_editing_toggled","team_name_changed","team_description_changed","team_icon_changed","team_creation_admins_setting_toggled","team_guests_toggled","member_added_to_team","group_added_to_team","member_removed_from_team","group_removed_from_team","member_left_team","member_joined_team","member_team_role_updated","team_user_permission_updated","team_group_permission_updated","team_member_default_permission_updated","team_guest_default_permission_updated","team_workspace_default_permission_updated","team_invite_access_changed","teams_enabled_for_space","ai_admin_legal_acceptance_toggled","space_consolidation_started","space_consolidation_completed","space_consolidation_failed"],U=["page_edited","page.automation_deleted","page.discussion.comment.created","page.discussion.comment.deleted","page.discussion.comment.updated","page.file_deleted","page.permanently_deleted","page.properties_edited","integration.created","integration.deleted","integration.secret_reset","workspace.external_account_connected","workspace.external_account_disconnected","workspace.integration_added","workspace.integration_removed","workspace.members_exported","workspace.settings.custom_session_duration_updated","workspace.settings.external_workspace_access_updated","workspace.settings.prevent_profile_edits_updated","workspace.settings.prevent_granting_support_access_updated","workspace.settings.guest_invite_request_setting_updated","workspace.guest_invite_request_resolved","admin_content_search_exported","admin_managed_users_log_out_all","admin_managed_users_log_out_one","admin_managed_users_password_cleared","admin_managed_users_password_cleared_one","user_suspended","user_unsuspended","user.settings.analytics_tracking_setting_updated",...V],W={page_edited:"page","page.properties_edited":"page",page_viewed:"page",page_created:"page",page_deleted:"page","page.permanently_deleted":"page",page_restored:"page",page_exported:"page",page_moved:"page",page_permission_updated:"page",page_shared_to_web:"page",file_uploaded:"page",file_downloaded:"page","page.file_deleted":"page",private_content_transferred:"page",automation_created:"page",automation_edited:"page","page.automation_deleted":"page","page.discussion.comment.created":"page","page.discussion.comment.updated":"page","page.discussion.comment.deleted":"page",member_invited:"space",member_joined:"space",member_role_updated:"space",member_removed:"space",guest_removed:"space",workspace_name_changed:"space",workspace_icon_changed:"space",workspace_domain_changed:"space",invite_link_toggled:"space",invite_link_reset:"space",page_access_requests_toggled:"space",public_page_sharing_toggled:"space",workspace_sidebar_editing_toggled:"space",disable_team_guests_toggled:"space",disable_guests_toggled:"space","workspace.settings.guest_invite_request_setting_updated":"space",pages_to_other_workspaces_toggled:"space",export_toggled:"space",workspace_exported:"space",workspace_integration_restriction_changed:"space",allowed_email_domain_added:"space",allowed_email_domain_removed:"space",public_page_cleared:"space",public_page_set:"space",scim_token_generated:"space",scim_token_revoked:"space",idp_metadata_url_updated:"space",idp_metadata_xml_updated:"space",idp_metadata_xml_removed:"space",saml_toggled:"space",saml_enforce_toggled:"space",automatic_account_creation_toggled:"space",workspace_creation_set_for_email_domain:"space","workspace.settings.custom_session_duration_updated":"space","workspace.settings.external_workspace_access_updated":"space","workspace.settings.prevent_profile_edits_updated":"space","workspace.settings.prevent_granting_support_access_updated":"space",member_added_to_group:"space",member_removed_from_group:"space","integration.created":"space","integration.deleted":"space","integration.secret_reset":"space","workspace.integration_added":"space","workspace.integration_removed":"space","workspace.external_account_connected":"space","workspace.external_account_disconnected":"space",space_transfer_status_changed:"space",space_claim_and_upgrade_status_changed:"space",space_claim_deletion_status_changed:"space",membership_requests_toggled:"space",external_membership_requests_toggled:"space",membership_request_resolved:"space","workspace.guest_invite_request_resolved":"space",guest_membership_requests_toggled:"space","workspace.members_exported":"space",audit_log_exported:"space",user_analytics_exported:"space",content_analytics_exported:"space",workspace_analytics_toggled:"space",ai_admin_legal_acceptance_toggled:"space",space_consolidation_started:"space",space_consolidation_completed:"space",space_consolidation_failed:"space",admin_content_search_queried:"space",admin_content_search_exported:"space",admin_managed_users_log_out_all:"space",admin_managed_users_log_out_one:"space",admin_managed_users_password_cleared:"space",admin_managed_users_password_cleared_one:"space",login:"account",logout:"account",password_set:"account",password_cleared:"account",password_changed:"account",mfa_sms_toggled:"account",mfa_totp_toggled:"account",mfa_backup_code_toggled:"account",email_changed:"account",preferred_name_changed:"account",picture_changed:"account",user_deleted:"account",allowed_support_access:"account",revoked_support_access:"account",user_suspended:"account",user_unsuspended:"account","user.settings.analytics_tracking_setting_updated":"account",member_added_to_team:"team",member_removed_from_team:"team",group_added_to_team:"team",group_removed_from_team:"team",member_joined_team:"team",member_left_team:"team",team_created:"team",team_archived:"team",team_restored:"team",team_name_changed:"team",team_description_changed:"team",team_icon_changed:"team",team_privacy_type_changed:"team",team_default_toggled:"team",team_creation_admins_setting_toggled:"team",team_member_default_permission_updated:"team",team_workspace_default_permission_updated:"team",team_guest_default_permission_updated:"team",member_team_role_updated:"team",team_user_permission_updated:"team",team_group_permission_updated:"team",team_invite_access_changed:"team",team_guests_toggled:"team",team_export_toggled:"team",team_public_page_sharing_toggled:"team",team_sidebar_editing_toggled:"team",teams_enabled_for_space:"team"},z=d.vM((0,_.Yd)(W),(e=>W[e]));function K(e){switch(e.actionName){case"page.properties_edited":case"page_edited":case"page_viewed":case"page_created":case"page_deleted":case"page.permanently_deleted":case"page_restored":case"page_exported":case"page_moved":case"page_permission_updated":case"page_shared_to_web":case"file_uploaded":case"file_downloaded":case"private_content_transferred":case"automation_created":case"automation_edited":case"page.discussion.comment.created":case"page.discussion.comment.deleted":case"page.discussion.comment.updated":case"page.automation_deleted":case"page.file_deleted":return e.target.page;case"member_invited":case"member_joined":case"member_role_updated":case"member_removed":case"guest_removed":case"workspace_name_changed":case"workspace_icon_changed":case"workspace_domain_changed":case"allowed_email_domain_added":case"allowed_email_domain_removed":case"workspace_exported":case"audit_log_exported":case"user_analytics_exported":case"content_analytics_exported":case"workspace_integration_restriction_changed":case"public_page_cleared":case"public_page_set":case"scim_token_generated":case"scim_token_revoked":case"saml_toggled":case"saml_enforce_toggled":case"automatic_account_creation_toggled":case"workspace_creation_set_for_email_domain":case"workspace.settings.external_workspace_access_updated":case"workspace.settings.custom_session_duration_updated":case"workspace.settings.prevent_profile_edits_updated":case"workspace.settings.prevent_granting_support_access_updated":case"login":case"logout":case"mfa_sms_toggled":case"mfa_totp_toggled":case"mfa_backup_code_toggled":case"password_set":case"password_cleared":case"password_changed":case"email_changed":case"preferred_name_changed":case"picture_changed":case"user_deleted":case"allowed_support_access":case"revoked_support_access":case"user_suspended":case"user_unsuspended":case"invite_link_toggled":case"invite_link_reset":case"page_access_requests_toggled":case"public_page_sharing_toggled":case"workspace_sidebar_editing_toggled":case"disable_team_guests_toggled":case"disable_guests_toggled":case"pages_to_other_workspaces_toggled":case"workspace_analytics_toggled":case"export_toggled":case"idp_metadata_url_updated":case"idp_metadata_xml_updated":case"idp_metadata_xml_removed":case"member_added_to_group":case"member_removed_from_group":case"space_transfer_status_changed":case"space_claim_and_upgrade_status_changed":case"space_claim_deletion_status_changed":case"membership_requests_toggled":case"external_membership_requests_toggled":case"membership_request_resolved":case"guest_membership_requests_toggled":case"team_created":case"team_archived":case"team_restored":case"team_default_toggled":case"team_public_page_sharing_toggled":case"team_export_toggled":case"team_sidebar_editing_toggled":case"team_name_changed":case"team_description_changed":case"team_icon_changed":case"team_creation_admins_setting_toggled":case"team_guests_toggled":case"member_added_to_team":case"group_added_to_team":case"member_removed_from_team":case"group_removed_from_team":case"member_joined_team":case"member_left_team":case"member_team_role_updated":case"team_user_permission_updated":case"team_group_permission_updated":case"team_member_default_permission_updated":case"team_guest_default_permission_updated":case"team_workspace_default_permission_updated":case"team_privacy_type_changed":case"team_invite_access_changed":case"teams_enabled_for_space":case"admin_content_search_queried":case"admin_content_search_exported":case"admin_managed_users_log_out_all":case"admin_managed_users_log_out_one":case"admin_managed_users_password_cleared":case"admin_managed_users_password_cleared_one":case"ai_admin_legal_acceptance_toggled":case"space_consolidation_started":case"space_consolidation_completed":case"space_consolidation_failed":case"integration.created":case"integration.deleted":case"integration.secret_reset":case"workspace.external_account_connected":case"workspace.external_account_disconnected":case"workspace.integration_added":case"workspace.integration_removed":case"workspace.members_exported":case"user.settings.analytics_tracking_setting_updated":case"workspace.settings.guest_invite_request_setting_updated":return;case"workspace.guest_invite_request_resolved":return e.meta.pagesAndRoles[0].page;default:(0,_.t1)(e)}}let H=function(e){return e.CreatedNewest="CreatedNewest",e.CreatedOldest="CreatedOldest",e}({});var G=s(77420),q=s(19889),Y=s(2985),Q=s(33954),$=s(33929),X=s(27617);class J extends Z.default{getInitialState(){return{pageNum:1,pageSize:10,timeRange:{},actors:[],actions:[],sortOrder:H.CreatedNewest}}}const ee=new J,te=e=>{const{timeRange:t,actors:s,actions:i,sortOrder:n}=e,a=new URLSearchParams;return t.starting&&a.append("starting",`${E.OQ.toUnixMs(t.starting)}`),t.ending&&a.append("ending",`${E.OQ.toUnixMs(t.ending)}`),(null==s?void 0:s.length)>0&&a.append("actors",s.map(X.eW).join(",")),(null==i?void 0:i.length)>0&&a.append("actions",i.join(",")),a.append("sort",`${n||H.CreatedNewest}`),a.toString()};class se extends Z.default{getInitialState(){return{spaceId:void 0,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set}}isUserOrBotRemoved(e){return Boolean(e&&(this.state.removedUserIds.has(e)||this.state.removedBotIds.has(e)))}}const ie=new se;class ne extends Z.default{getInitialState(){return{cachedResponses:{}}}getCursor(e,t,s){if(s<=1||this.state.spaceId!==e)return;const i=te(t);if(this.state.filterStr!==i)return;const n=this.state.cachedResponses[s-1];return"success"===n.status?null==n?void 0:n.nextCursor:void 0}startLoading(e,t){this.updateResultHelper(e,t,{status:"loading"})}updateLoadedResult(e,t,s){this.updateResultHelper(e,t,{...s,status:"success",loadedAt:Date.now()})}updateError(e,t){this.updateResultHelper(e,t,{status:"error"})}updateResultHelper(e,t,s){const i=te(t);1!==t.pageNum&&this.state.spaceId===e&&this.state.filterStr===i?this.setState({spaceId:e,filterStr:i,cachedResponses:{...this.state.cachedResponses,[t.pageNum]:{...s}}}):this.setState({spaceId:e,filterStr:i,cachedResponses:{[t.pageNum||1]:{...s}}})}}const ae=new ne,oe=(0,g.defineMessages)({loadCurrentAuditLogError:{id:"auditlog.error.loadCurrentAuditLogError",defaultMessage:"Failed to load audit logs"}}),re=async e=>{const{environment:t,spaceId:s}=e,i=await w.getHistoricalAuditLogUsers(t,{spaceId:s});return"success"!==i.type?[]:i.data.results},le=async e=>{const{environment:t,spaceId:s}=e;if(ie.getState().spaceId!==s&&ie.reset(),!s)return;const[i,n]=await Promise.all([Y.Te({environment:t,membersOnly:!1}),re({environment:t,spaceId:s})]),a={spaceId:s,allUserIds:new Set,allBotIds:new Set,removedUserIds:new Set,removedBotIds:new Set};i.userIds.forEach((e=>{a.allUserIds.add(e)})),i.botIds.forEach((e=>{a.allBotIds.add(e)})),n.forEach((e=>{var t;(t=e.actorId)!==G._H.id&&t!==q.s$.id&&t!==q.el.id||a.allUserIds.has(e.actorId)?e.actorType!==q.KJ||a.allUserIds.has(e.actorId)?e.actorType!==G.cZ||a.allBotIds.has(e.actorId)||(a.allBotIds.add(e.actorId),a.removedBotIds.add(e.actorId)):(a.allUserIds.add(e.actorId),a.removedUserIds.add(e.actorId)):a.allUserIds.add(e.actorId)})),ie.setState(a)};var de=s(61652),ce=s(42922),ue=s(52275),me=s(78140),pe=s(32163),ge=s(53437),he=s(72495),fe=s(26388),ye=s(87279);class ve extends Z.default{getInitialState(){return{open:!1}}}const xe=new ve,Se=(0,g.defineMessages)({30:{id:"auditLogCSV.menu.30days",defaultMessage:"Last 30 days"},60:{id:"auditLogCSV.menu.60days",defaultMessage:"Last 60 days"},90:{id:"auditLogCSV.menu.90days",defaultMessage:"Last 90 days"},365:{id:"auditLogCSV.menu.365days",defaultMessage:"Last 1 year"},Export:{id:"auditLogCSV.menu.export",defaultMessage:"Export"}});class be extends n.Z{constructor(){super(...arguments),this.renderCSVMenu=()=>{const e=[this.getCSVMenuItem(30),this.getCSVMenuItem(60),this.getCSVMenuItem(90),this.getCSVMenuItemWithConfirmation(365)];return(0,r.jsx)(me.Z,{menuType:ye.og.Popup,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,sections:[{key:"results",render:e=>(0,r.jsx)(he.Z,{...e}),items:e}],initialFocus:0})})},this.getCSVMenuItem=e=>({key:e,render:()=>(0,r.jsx)(ue.Z,{focused:!1,title:$.default.formatMessage(Se[e]),onClick:()=>{this.handleDismiss(),Me(this.environment,e)}}),action:()=>{}}),this.getCSVMenuItemWithConfirmation=e=>({key:e,render:()=>(0,r.jsx)(ue.Z,{focused:!1,title:$.default.formatMessage(Se[e]),onClick:()=>{v.showDialog({message:(0,r.jsx)(g.FormattedMessage,{id:"auditLogCSV.menu.365days.prompt",defaultMessage:"Are you sure you want to export a one year CSV? You can't repeat this action while this is processing in the background."}),showCancel:!0,keepFocus:!0,items:[{label:(0,r.jsx)(g.FormattedMessage,{id:"AuditLogCSV.exportConfirmationDialog.label",defaultMessage:"Export"}),color:"blue",onAccept:()=>{this.handleDismiss(),Me(this.environment,e)}}]})}}),action:()=>{}}),this.handleDismiss=()=>{xe.setState({open:!1})},this.popOpenOptions=e=>{xe.setState({open:e})}}renderComponent(){const e=xe.state;return(0,r.jsx)(ge.ZP,{popupType:ge.ZP.PopupType.Popup,open:e.open,placementToOrigin:ge.ZP.Placement.Bottom,alignmentToOrigin:ge.ZP.Alignment.End,originGap:4,disableMouseCapture:!0,disableContentScroll:!0,keepFocus:!1,render:this.renderCSVMenu,onDismiss:this.handleDismiss,enableOutsideClickDismiss:!0,origin:(0,r.jsx)(fe.Z,{renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"auditLogCSV.popup.tooltip",defaultMessage:"Click for options to export the Audit Log in CSV form"}),render:t=>(0,r.jsx)(ce.Z,{isLarge:!0,onClick:()=>this.popOpenOptions(!e.open),...t,children:$.default.formatMessage(Se.Export)})})})}}be.displayName="AuditLogCSV";const Me=(e,t)=>{const{currentSpaceStore:s}=I.default.state;s&&de.PN(e,{spaceId:s.id,exportOptions:{duration:t}})},we=(0,g.injectIntl)(be);var je=s(69651),Ce=s(65496),ke=s(76150),_e=s(13854),Te=s(41558),Ie=s(33338),Pe=s(3386),Ze=s(89728),Fe=s(42875),Ae=s(67950),De=s(40721),Be=s(86825),Re=s(46945),Le=s(84795);const Ne="Invalid date",Ee="Invalid range";class Oe extends Z.default{getInitialState(){return{dateEdited:!1,timeEdited:!1,temporaryValue:{date:void 0,time:void 0},error:void 0}}}const Ve=Oe;var Ue=s(74194);class We extends n.Z{constructor(){super(...arguments),this.storeTypes={store:Ve},this.renderInput=()=>{const{device:e}=this.environment,{store:t,hideClearButton:s,focus:i,showTime:n,placeholder:a,...o}=this.props,l=e.isMobile?"date":"text",d=e.isMobile?"time":"text",c=Ue.Z.Format.Transparent,u=e.isMobile?void 0:i;return(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",borderRadius:3,lineHeight:2,background:this.theme.inputBackground,paddingLeft:8,paddingRight:8,flexBasis:"50%",...this.getInputStyles().inputOuterStyle},children:[(0,r.jsx)(Ue.Z,{...o,type:l,format:c,placeholder:a,focus:"date"===u,onFocus:this.handleDateFocus,onChange:this.handleDateChange,onSubmit:e=>this.handleSubmit(e,"date"),onBlur:this.handleBlur,value:this.getDateInputValue(),size:1,style:{fontSize:e.isMobile?16:14},showClearButton:!n&&this.showClearButton(),onClearButtonClick:this.handleClear}),n&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{height:14,width:1,background:this.theme.regularDividerColor,marginLeft:6,marginRight:12,flexShrink:0}}),(0,r.jsx)(Ue.Z,{...o,placeholder:$.default.formatMessage(Ke.timePlaceholder),type:d,format:c,focus:"time"===u,onFocus:this.handleTimeFocus,onChange:this.handleTimeChange,onSubmit:e=>this.handleSubmit(e,"time"),onBlur:this.handleBlur,value:this.getTimeInputValue(),size:1,style:{fontSize:e.isMobile?16:14},showClearButton:this.showClearButton(),onClearButtonClick:this.handleClear})]})]})},this.handleDateFocus=e=>{const{onDateFocus:t}=this.props,{store:s}=this.stores;s.setState({...s.state,dateEdited:!1}),t&&t(e)},this.handleTimeFocus=e=>{const{onTimeFocus:t}=this.props,{store:s}=this.stores;s.setState({...s.state,timeEdited:!1}),t&&t(e)},this.handleClear=()=>{const{onClear:e,onUpdate:t}=this.props,{store:s}=this.stores;s.setState({...s.state,dateEdited:!0,timeEdited:!0,temporaryValue:{date:void 0,time:void 0},error:void 0});const i=this.validateCurrent();i&&t(i),s.setState({...s.state,dateEdited:!1,timeEdited:!1}),e&&e()},this.handleDateChange=e=>{const{device:t}=this.environment,{store:s}=this.stores;s.setState({...s.state,dateEdited:!0,temporaryValue:{...s.state.temporaryValue,date:e.target.value||""}}),t.isAndroid&&this.handleBlur()},this.handleTimeChange=e=>{const{device:t}=this.environment,{store:s}=this.stores;s.setState({...s.state,timeEdited:!0,temporaryValue:{...s.state.temporaryValue,time:e.target.value||""}}),t.isAndroid&&this.handleBlur()},this.handleSubmit=(e,t)=>{var s,i;const{onUpdate:n,onSubmit:a,showTime:o}=this.props,{store:r}=this.stores;let l;(!o||"date"===t&&null!==(s=this.props.value)&&void 0!==s&&s.start_time||"time"===t&&null!==(i=this.props.value)&&void 0!==i&&i.start_date)&&(l=this.validateCurrent(),l&&(n(l),l.error?r.setState({...r.state,dateEdited:!1,error:l.error}):r.reset())),a&&a(e,l)},this.handleBlur=e=>{const{onUpdate:t,onBlur:s}=this.props,{store:i}=this.stores,n=this.validateCurrent();n?(t(n),n.error?i.setState({...i.state,dateEdited:!1,timeEdited:!1,error:n.error}):i.reset()):i.setState({...i.state,dateEdited:!1,timeEdited:!1}),e&&s&&s(e)},this.styles={menuItem:{marginBottom:this.environment.device.isMobile?1:12},inputWrapper:{borderRadius:3,height:28,paddingRight:this.showClearButton()?6:0,position:"relative"},inputEditRegion:{width:this.showClearButton()?"calc(100% - 14px)":"100%"},inputEditRegionMobile:{padding:"2px 6px",position:"relative"},tooltipOriginGap:-8}}didUpdate(e){const{store:t}=this.stores;d.Xy(e.value,this.props.value)||t.reset()}renderComponent(){const e=this.styles,t=this.getError();return t?(0,r.jsx)(fe.Z,{renderTooltip:()=>t,forceVisibleState:!0,placement:fe.Z.Placement.Left,render:this.renderInput,originGap:e.tooltipOriginGap}):this.renderInput()}getDateInputValue(){const{device:e}=this.environment,{value:t,intl:s}=this.props,{store:i}=this.stores;return e.isMobile?t?X.dd(t,s):"":i.state.temporaryValue.date?i.state.temporaryValue.date:i.state.dateEdited?i.state.temporaryValue.date||"":t?X.dd(t,s):""}getTimeInputValue(){const{device:e}=this.environment,{value:t,intl:s}=this.props,{store:i}=this.stores;return e.isMobile?t?X.KN(t,s):"":i.state.temporaryValue.time?i.state.temporaryValue.time:i.state.timeEdited?i.state.temporaryValue.time||"":t?X.KN(t,s):""}getError(){const{store:e}=this.stores,{intl:t}=this.props;if(e.state.error)switch(e.state.error){case Ne:return t.formatMessage({id:"dateInputError.invalidDateError.tooltip",defaultMessage:"Invalid date"});case Ee:return t.formatMessage({id:"dateInputError.invalidDateRangeError.tooltip",defaultMessage:"Invalid range"});default:(0,_.t1)(e.state.error)}}validateCurrent(){const{validate:e}=this.props,t=this.parseCurrentDateTimeValue();if(t)return e?e(t):t}parseCurrentDateTimeValue(){const{store:e}=this.stores,{value:t,showTime:s,isEndingDate:i}=this.props;if(!e.state.dateEdited&&!e.state.timeEdited)return;if(!e.state.temporaryValue.date&&!e.state.temporaryValue.time)return{value:void 0};const n=(0,Le.parseDateValue)(e.state.temporaryValue.date||"",this.props.intl);if(n){let e="";return e=s?(null==t?void 0:t.start_time)||"00:00":i?"23:59":"00:00",{value:{type:"datetime",start_date:n,time_zone:(null==t?void 0:t.time_zone)||(0,Fe.r)(),start_time:e}}}const a=(0,Le.parseTimeValue)(e.state.temporaryValue.time||"",this.props.intl);return(null!=t&&t.start_date||n)&&a?{value:{type:"datetime",start_date:(null==t?void 0:t.start_date)||n,start_time:a,time_zone:(null==t?void 0:t.time_zone)||(0,Fe.r)()}}:{error:Ne}}showClearButton(){const{device:e}=this.environment,{hideClearButton:t}=this.props;return!!e.isMobile||!t}getInputStyles(){const{device:e}=this.environment,{inputStyle:t,inputOuterStyle:s,style:i}=this.props,n=this.styles;return{style:{...n.menuItem,...i},inputOuterStyle:{...n.inputWrapper,...s,...this.getInputBorders()},inputStyle:{...n.inputEditRegion,...e.isMobile&&n.inputEditRegionMobile,...t}}}getInputBorders(){const{disabled:e,focus:t}=this.props,s=this.getThemeColors(),i=this.getError();if(!e)return i?s.inputError:t?s.inputFocused:s.inputDefault}getThemeColors(){return{inputDefault:{background:this.theme.inputBackground,boxShadow:this.theme.inputBoxShadow},inputFocused:{boxShadow:this.theme.outlineBlueInputBoxShadow},inputError:{boxShadow:this.theme.outlineRedInputBoxShadow},placeholder:{color:this.theme.lightTextColor}}}}We.displayName="DateTimeInputMenuItem";const ze=(0,g.injectIntl)(We),Ke=(0,g.defineMessages)({startingDateMessage:{defaultMessage:"Starting",id:"auditLog.dateTimeRangeMenu.startingDatePlaceholder"},endingDateMessage:{defaultMessage:"Ending",id:"auditLog.dateTimeRangeMenu.endingDatePlaceholder"},timePlaceholder:{defaultMessage:"12:00 AM",id:"auditLog.dateTimeRangeMenu.timePlaceholderInNumber"}});class He extends n.Z{constructor(){super(...arguments),this.storeTypes={store:_e.ZP,dayRangeStore:Te.Z},this.renderInputs=()=>{const{device:e,WindowSizeStore:t}=this.environment,{value:s,disabled:i}=this.props,{store:n}=this.stores,a=n.getFocus();let o="date";a!==ke.Hv.StartTime&&a!==ke.Hv.EndTime||(o="time");const l=this.getRangeBounds();return(0,r.jsxs)("div",{style:{paddingTop:e.isMobile?16:12,paddingBottom:e.isMobile?16:8,paddingLeft:e.isMobile?t.getSafePaddingLeftCSS(16):14,paddingRight:e.isMobile?t.getSafePaddingRightCSS(16):14,display:n.state.showTime?"block":"flex",...e.isMobile&&{boxShadow:`\n\t\t\t\t\t\t\t0 1px 0 ${this.theme.regularDividerColor}\n\t\t\t\t\t\t`,position:"relative",zIndex:2},background:e.isMobile?this.theme.popoverBackground:void 0},children:[(0,r.jsx)(ze,{disabled:i,placeholder:$.default.formatMessage(Ke.startingDateMessage),focus:a===ke.Hv.StartDate||a===ke.Hv.StartTime?o:void 0,value:s.starting,validate:this.validateStart,onUpdate:this.handleUpdateStart,onDateFocus:()=>this.handleDateFocus(ke.Hv.StartDate),onTimeFocus:()=>this.handleTimeFocus(ke.Hv.StartTime),onSubmit:(e,t)=>this.handleStartSubmit(e,t,a),inputElementAttributes:{max:l.latestValidStarting},showTime:n.state.showTime}),(0,r.jsx)("div",{style:{width:12,height:8}}),(0,r.jsx)(ze,{disabled:i,placeholder:$.default.formatMessage(Ke.endingDateMessage),focus:a===ke.Hv.EndDate||a===ke.Hv.EndTime?o:void 0,value:s.ending,validate:this.validateEnd,onUpdate:this.handleUpdateEnd,onDateFocus:()=>this.handleDateFocus(ke.Hv.EndDate),onTimeFocus:()=>this.handleTimeFocus(ke.Hv.EndTime),onSubmit:(e,t)=>this.handleEndSubmit(e,t,a),inputElementAttributes:{min:l.earliestValidEnding},showTime:n.state.showTime})]})},this.renderCalendar=()=>{const{device:e}=this.environment,{value:t,onUpdate:s}=this.props,{store:i,dayRangeStore:n}=this.stores,a=this.styles,o=this.getThemeColors(),l={...a.pickerSection,...e.isMobile&&a.pickerSectionMobile,...e.isMobile&&o.pickerSectionMobile};return(0,r.jsx)(he.Z,{children:(0,r.jsx)("div",{style:l,children:(0,r.jsx)(Re.Z,{value:X.Zy(t),dateTimeStore:i,store:n,onUpdate:e=>{if(e.error)return;const i=X.PM(t,e.value);return s({error:e.error,value:i})},validate:this.validateDateRangeField})})})},this.handleDateFocus=e=>{const{store:t,dayRangeStore:s}=this.stores;t.setState({...t.state,focus:e});const i=_e.QJ[e];s.setState({...s.state,focus:i})},this.handleTimeFocus=e=>{const{store:t}=this.stores;t.setState({...t.state,focus:e})},this.handleUpdateStart=e=>{const{onUpdate:t}=this.props;e.error||t({value:{...this.props.value,starting:e.value}})},this.handleUpdateEnd=e=>{const{onUpdate:t}=this.props;e.error||t({value:{...this.props.value,ending:e.value}})},this.handleStartSubmit=(e,t,s)=>{const{store:i,dayRangeStore:n}=this.stores;t&&t.error||(s===ke.Hv.StartDate&&i.state.showTime?i.setState({...i.state,focus:ke.Hv.StartTime}):(i.setState({...i.state,focus:ke.Hv.EndDate}),n.setState({...n.state,focus:"ending"})))},this.handleEndSubmit=(e,t,s)=>{const{store:i}=this.stores;t&&t.error||s===ke.Hv.EndDate&&i.state.showTime&&i.setState({...i.state,focus:ke.Hv.EndTime})},this.validateStart=e=>{const t=this.validateField("starting",e);return t.error?t:{value:t.value.starting}},this.validateEnd=e=>{const t=this.validateField("ending",e);return t.error?t:{value:t.value.ending}},this.validateField=(e,t)=>{const{value:s}=this.props;return t.error?t:this.validateRange({...s,[e]:t.value})},this.validateRange=e=>{if(e.starting&&e.ending){const t=E.OQ.notionDateTimeToLuxon(e.starting);return E.OQ.notionDateTimeToLuxon(e.ending)>=t?{value:e}:{error:Ae.B.INVALID_RANGE}}return{value:e}},this.getMenuProps=()=>{const{device:e}=this.environment,{onDismiss:t,title:s}=this.props;if(e.isMobile){return{menuType:ye.og.Modal,title:s,right:(0,r.jsx)(De.DoneMenuText,{}),onClickRight:t,header:this.renderInputs()}}return{menuType:ye.og.Popup,onClickOutside:t,footer:this.props.footer}},this.validateDateRangeField=(e,t)=>{const{value:s}=this.props;if(t.error)return t;const i=X.Zy(s);return this.validateDateRange({...i,[e]:t.value})},this.validateDateRange=e=>{if(e.starting&&e.ending){const t=E.OQ.notionDateToLuxon(e.starting);return E.OQ.notionDateToLuxon(e.ending)>=t?{value:e}:{error:Ae.B.INVALID_RANGE}}return{value:e}},this.styles={pickerSection:{paddingLeft:16,paddingRight:16},pickerSectionMobile:{paddingTop:16,paddingBottom:8},sidebar:{paddingTop:12,paddingBottom:24,overflowY:"auto",overflowX:"hidden",flex:"0 0 220px",backgroundColor:this.theme.sidebarSecondaryBackground,borderLeft:`1px solid ${this.theme.regularDividerColor}`,maxWidth:"fit-content"},menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4,color:this.theme.mediumTextColor}}}didMount(){const{store:e}=this.stores;void 0!==this.props.showTime&&e.setState({...e.state,showTime:this.props.showTime})}renderComponent(){const{device:e}=this.environment;return(0,r.jsx)(me.Z,{...this.getMenuProps(),children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,r.jsxs)("div",{children:[this.props.header,!e.isMobile&&this.renderInputs(),this.renderCalendar()]}),this.renderSidebar()]})})}renderSidebar(){const{store:e}=this.stores,{onUpdate:t,value:s,hideTime:i}=this.props;return(0,r.jsxs)("aside",{style:this.styles.sidebar,children:[i?null:(0,r.jsx)(Be.Z,{title:(0,r.jsx)(g.FormattedMessage,{id:"auditlogDateFilter.timeToggle",defaultMessage:"Use time"}),on:e.state.showTime,onClick:()=>{if(e.toggleShowTime(),e.state.showTime){const e=s;e.starting&&(e.starting.start_time="00:00"),e.ending&&(e.ending.start_time="23:59"),t({value:e})}},focused:!1}),(0,r.jsx)(ue.Z,{focused:!1,title:(0,r.jsx)(g.FormattedMessage,{id:"auditlogDateFilter.quickFilters.today",defaultMessage:"Today"}),onClick:()=>{const e=Date.now(),t=E.CQ(e,(0,Fe.r)());this.setStoresTemporaryValue({starting:{...t,start_time:"00:00"},ending:t})},style:this.styles.menuItem}),(0,r.jsx)(ue.Z,{focused:!1,title:(0,r.jsx)(g.FormattedMessage,{id:"auditlogDateFilter.quickFilters.yesterday",defaultMessage:"Yesterday"}),onClick:()=>{const e=E.Cv((0,Fe.r)());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,Fe.r)()},ending:{type:"datetime",start_date:e.start_date,start_time:"23:59",time_zone:(0,Fe.r)()}})},style:this.styles.menuItem}),(0,r.jsx)(ue.Z,{focused:!1,title:(0,r.jsx)(g.FormattedMessage,{id:"auditlogDateFilter.quickFilters.lastWeek",defaultMessage:"Last 7 days"}),onClick:()=>{const e=E.Oo((0,Fe.r)()),t=E.CQ(Date.now(),(0,Fe.r)());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,Fe.r)()},ending:t})},style:this.styles.menuItem}),(0,r.jsx)(ue.Z,{focused:!1,title:(0,r.jsx)(g.FormattedMessage,{id:"auditlogDateFilter.quickFilters.lastMonth",defaultMessage:"Last 30 days"}),onClick:()=>{const e=E.dj((0,Fe.r)()),t=E.CQ(Date.now(),(0,Fe.r)());this.setStoresTemporaryValue({starting:{type:"datetime",start_date:e.start_date,start_time:"00:00",time_zone:(0,Fe.r)()},ending:t})},style:this.styles.menuItem})]})}setStoresTemporaryValue(e){const{store:t,dayRangeStore:s}=this.stores;e.ending&&this.handleDateFocus(ke.Hv.EndDate),t.setState({...t.state,temporaryDateRange:e}),s.setState({...s.state,displayMonth:e.starting||e.ending?E.Sy(e.starting||e.ending):void 0,temporaryDateRange:{starting:X.Qb(e.starting),ending:X.Qb(e.ending)}})}getRangeBounds(){const{value:e,intl:t}=this.props;return{earliestValidEnding:e.starting&&X.o0(e.starting,t),latestValidStarting:e.ending&&X.o0(e.ending,t)}}getThemeColors(){return{pickerSectionMobile:{background:this.theme.popoverBackground,boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,marginBottom:1}}}}He.displayName="DateTimeRangeMenu";const Ge=(0,g.injectIntl)(He);var qe=s(255),Ye=s(8319),Qe=s(75689),$e=s(91642);class Xe extends n.Z{constructor(){super(...arguments),this.storeTypes={store:_e.ZP,dayRangeStore:Te.Z},this.renderActiveButtonOrigin=()=>{const{value:e,disabled:t,focused:s,intl:i}=this.props,n=this.styles,a=this.getThemeColors(),o={...n.menuItem,...a.activeMenuItem},l=Ce._Q(e,i),d=(0,r.jsx)(qe.Z,{onClick:this.handleClear,disabled:t});return(0,r.jsx)(ue.Z,{focused:s,disabled:t,icon:(0,je.C)(n.iconActiveDesktop),title:l,right:d,isTokenTitle:!0,alignIconTop:!0,onClick:this.handleOriginActivate,desktopTitleStyle:n.menuItemTitleDesktop,desktopIconStyle:n.iconActiveDesktopWrapper,style:o})},this.renderInactiveButtonOrigin=()=>{const{title:e,icon:t,disabled:s,focused:i,mode:n}=this.props,a=this.styles,o=this.getThemeColors(),l={...a.menuItem,...o.buttonMenuItem,...n===Ye.Z.Mode.Pill?{width:"fit-content",border:"solid 1px",paddingLeft:0,paddingRight:0,borderRadius:20,fontSize:12}:{}};return(0,r.jsx)(ue.Z,{focused:i,disabled:s,icon:t(a.icon),title:e,onClick:this.handleOriginActivate,style:l})},this.renderPillButtonOrigin=()=>{const{value:e,pillTitle:t}=this.props,s=(0,r.jsx)(g.FormattedMessage,{id:"searchDateFilter.shortTitle",defaultMessage:"Date"});return(0,r.jsx)(Ie.Z,{on:Boolean(e.starting||e.ending),icon:(0,je.C)({width:16,marginRight:6,fill:"currentColor"}),title:(0,r.jsx)("span",{children:t||s}),onClick:this.handleOriginActivate})},this.renderPopupContents=()=>{const{title:e,header:t,showButtons:s,sidebar:i,hideTime:n}=this.props,{store:a,dayRangeStore:o}=this.stores;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Ge,{title:e,value:this.getCurrentValue(),onUpdate:this.updateTemporary,store:a,dayRangeStore:o,onDismiss:this.handleMenuClose,footer:"footer"===s&&this.renderFooter(),sidebar:i,hideTime:n,header:t}),"side"===s&&(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",padding:"0px 10px"},children:[(0,r.jsx)(Ze.Z,{isGray:!0,style:{marginLeft:"auto",marginRight:8},onClick:this.handleMenuClose,children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Cancel",id:"searchDateFilter.cancelButton.label"})}),(0,r.jsx)(ce.Z,{onClick:()=>this.props.onChange(this.stores.store.state.temporaryDateRange),children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Accept",id:"searchDateFilter.acceptButton.label"})})]})]})},this.renderFooter=()=>{const{store:e,dayRangeStore:t}=this.stores;return(0,r.jsxs)(he.Z,{topBorder:!0,style:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},children:[(0,r.jsx)(Ze.Z,{onClick:()=>{e.clearTemporaryDateRange(),t.clearTemporaryDateRange(),this.props.onChange({starting:void 0,ending:void 0})},children:(0,r.jsx)(g.FormattedMessage,{id:"searchDateFilter.clearButton",defaultMessage:"Clear"})}),(0,r.jsx)(ce.Z,{onClick:e=>{this.props.onChange(this.stores.store.state.temporaryDateRange),this.handleMenuClose(e)},children:(0,r.jsx)(g.FormattedMessage,{id:"searchDateFilter.applyButton",defaultMessage:"Apply"})})]})},this.handleOriginActivate=()=>{const{disabled:e}=this.props,{store:t,dayRangeStore:s}=this.stores;e||(t.setState({...t.state,isOpen:!0,focus:ke.Hv.StartDate}),s.setState({...s.state,isOpen:!0,focus:"starting"}))},this.handleMenuClose=e=>{const{onChange:t,onMenuDismiss:s,showButtons:i}=this.props,{store:n,dayRangeStore:a}=this.stores,{temporaryDateRange:o}=n.state;Ce.zD(e)||(i||t(o),n.setState({...n.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),a.setState({...a.state,isOpen:!1,temporaryDateRange:{starting:void 0,ending:void 0}}),s&&s())},this.handleClear=()=>{const{onChange:e}=this.props;e({starting:void 0,ending:void 0})},this.handleMenuListKey=e=>{e.preventDefault&&e.preventDefault()},this.updateTemporary=e=>{const{store:t,dayRangeStore:s}=this.stores;if(e.error)return;const i={starting:(0,X.Qb)(e.value.starting),ending:(0,X.Qb)(e.value.ending)};return s.setState({...s.state,temporaryDateRange:{...s.state.temporaryDateRange,...i}}),t.setState({...t.state,temporaryDateRange:{...t.state.temporaryDateRange,...e.value}})},this.styles={menuItem:{minHeight:void 0,paddingTop:this.environment.device.isMobile?12:4,paddingBottom:this.environment.device.isMobile?12:4},icon:{height:16,width:16,marginRight:6},iconActiveDesktop:{height:14,width:14,fill:"currentColor",alignSelf:"flex-start",marginTop:2,marginRight:2},iconActiveDesktopWrapper:{marginTop:0},iconActiveMobile:{height:14,width:14,fill:"currentColor",marginTop:1,marginRight:6},popup:{paddingTop:0,paddingBottom:8},popupWithSidebar:{display:"flex"},menuItemTitleDesktop:{width:"100%"},summary:{display:"inline-flex"}}}didMount(){this.updateTemporary({value:this.props.value})}renderComponent(){const{device:e}=this.environment,{mode:t}=this.props;return e.isMobile?this.renderMobile(t):this.renderDesktop(t)}renderDesktop(e){const{title:t,sidebar:s}=this.props,{store:i}=this.stores,n=this.styles,a=e===Ye.z.Section,o=a?t:void 0,l=(()=>e===Ye.Z.Mode.Section?this.renderActiveButtonOrigin():e===Ye.Z.Mode.Button?this.renderInactiveButtonOrigin():e===Ye.Z.Mode.Pill?this.renderPillButtonOrigin():void(0,_.t1)(e))();return(0,r.jsx)($e.Z,{title:o,marginAfter:a,children:(0,r.jsx)(Pe.Z,{capture:i.state.isOpen,onUp:this.handleMenuListKey,onDown:this.handleMenuListKey,onEnter:this.handleMenuListKey,children:(0,r.jsx)(ge.ZP,{popupType:this.getPopupType(),open:i.state.isOpen,origin:l,render:this.renderPopupContents,onDismiss:this.handleMenuClose,placementToOrigin:ge.ZP.Placement.Bottom,alignmentToOrigin:ge.ZP.Alignment.Start,style:s?n.popupWithSidebar:n.popup})})})}renderMobile(e){const{store:t}=this.stores,s=e===Ye.z.Section?this.renderMobileFilterSummary():this.renderMobileButtonOrigin();return(0,r.jsx)(ge.ZP,{popupType:ge.ZP.PopupType.SlideUp,open:t.state.isOpen,origin:s,render:this.renderPopupContents,onDismiss:this.handleMenuClose,preventScaleTransition:!0})}renderMobileButtonOrigin(){const{icon:e,title:t,disabled:s}=this.props,i=this.styles;return(0,r.jsx)(ue.Z,{disabled:s,focused:!1,icon:e(i.icon),title:t,onClick:this.handleOriginActivate})}renderMobileFilterSummary(){const{title:e,value:t,disabled:s,intl:i}=this.props,n=this.styles,a=(0,r.jsxs)("div",{style:n.summary,children:[(0,je.C)(n.iconActiveMobile),Ce._Q(t,i)]});return(0,r.jsx)(Qe.Z,{disabled:s,onClick:this.handleOriginActivate,onClickClear:this.handleClear,label:e,title:a})}getCurrentValue(){const{value:e}=this.props,{store:t}=this.stores,{temporaryDateRange:s}=t.state;return{...e,...s}}getPopupType(){const{device:e}=this.environment;return e.isMobile?ge.ZP.PopupType.SlideUp:ge.ZP.PopupType.Popup}getThemeColors(){return{buttonMenuItem:{color:this.theme.mediumTextColor},activeMenuItem:{color:this.theme.regularTextColor}}}}Xe.displayName="DateTimeFilter";const Je=(0,g.injectIntl)(Xe);var et=s(66897),tt=s(22686),st=s(74136),it=s(97680),nt=s(90106);class at extends Z.default{getInitialState(){return{tempSelections:new Set([])}}setTempSelections(e){this.setState({tempSelections:new Set(e)})}}class ot extends n.Z{constructor(){super(...arguments),this.storeTypes={localStore:at},this.renderResultMenuItem=(e,t)=>{var s;const{intl:n,auditLogHistoricalUserStore:a}=this.props,{localStore:o}=this.stores,l=this.getActor(e);return(0,i.createElement)(it.Z,{...t,key:e,actor:l,useEmailAsTooltip:!0,checkState:o.state.tempSelections.has(e),userTitle:(0,r.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,et.$4)(n,l),a.isUserOrBotRemoved(null===(s=l.asActor)||void 0===s?void 0:s.id)&&(0,r.jsx)(st.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"auditlogActorFilter.removed_user",defaultMessage:"Removed"})})]})})},this.performRequest=async e=>{let{query:t,current:s}=e;const{allUserIds:i,allBotIds:n}=this.props.auditLogHistoricalUserStore.getState(),a=await Y.ri({environment:this.environment,query:t,userIds:[...i],botIds:[...n]}),o=[...a.users.map((e=>`notion_user:${e.id}`)),...a.bots.map((e=>`bot:${e.id}`))];if(t.length>0)return o.slice(0,100);const r=this.props.selectedActors.map(X.eW),l=new Set(r),d=o.filter((e=>!l.has(e)));return[...r,...d].slice(0,Math.max(r.length,100))},this.createUserValue=e=>nt.U6.createChildStore(this.props.parentStore,{table:q.KJ,id:e}).getValue(),this.createBotValue=e=>(0,nt.Kv)(this.props.parentStore,{table:G.cZ,id:e}).getValue()}didMount(){this.updateTempSelectionFromProps()}renderComponent(){const{selectedActors:e,intl:t}=this.props,{localStore:s}=this.stores,i=(0,r.jsx)(g.FormattedMessage,{id:"auditlogActorFilter.title",defaultMessage:"User"});return(0,r.jsx)(Ye.Z,{mode:Ye.z.Pill,title:i,icon:tt.f,iconStyles:{marginRight:2},items:Array.from(s.state.tempSelections),hasItemsSelected:(null==e?void 0:e.length)>0,onChange:e=>{s.setTempSelections(e)},renderFooter:!0,allowApplyBatchSelection:!0,keepInputOnItemConfirm:!0,onMenuDismiss:e=>{"applyButton"!==e?this.updateTempSelectionFromProps():this.updateOnChangeToParent()},labelText:{title:i,tokenInputPlaceholder:t.formatMessage({defaultMessage:"Search user...",id:"auditlogActorFilter.searchActor.placeholder"}),resultSectionTitle:t.formatMessage({defaultMessage:"Select users",id:"auditlogActorFilter.searchActor.resultsTitle"}),componentDebugName:"SearchActorFilter"},performRequest:this.performRequest,renderResultMenuItem:this.renderResultMenuItem,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}updateOnChangeToParent(){const{onChange:e}=this.props,{localStore:t}=this.stores;e(Array.from(t.state.tempSelections).map(X.Ij).filter((e=>Boolean(e))))}updateTempSelectionFromProps(){const{selectedActors:e}=this.props,{localStore:t}=this.stores,s=e.map(X.eW);t.setTempSelections(s)}getActor(e){const t=(0,X.Ij)(e);return t?"notion_user"===t.actorType?(0,et.m3)(this.createUserValue(t.actorId)):(0,et.ON)(this.createBotValue(t.actorId)):(0,et.m3)(void 0)}}ot.displayName="AuditLogActorFilter";const rt=(0,g.injectIntl)(ot);s(57658);var lt=s(24405);const dt={audit_log_aes_event_read:["integration.created","integration.deleted","integration.secret_reset","page.automation_deleted","page.file_deleted","user.settings.analytics_tracking_setting_updated","workspace.external_account_connected","workspace.external_account_disconnected","workspace.integration_added","workspace.integration_removed","workspace.members_exported"],audit_log_permanently_deleted_filter_enable:["page.permanently_deleted"],guest_invite_requests:["workspace.guest_invite_request_resolved","workspace.settings.guest_invite_request_setting_updated"]};const ct={admin_content_search_exported:"workspace.content_search_exported",admin_content_search_queried:"workspace.content_search_queried",ai_admin_legal_acceptance_toggled:"workspace.settings.ai_legal_terms_setting_updated",allowed_email_domain_added:"workspace.settings.email_domain_added",allowed_email_domain_removed:"workspace.settings.email_domain_removed",allowed_support_access:"user.settings.support_access_granted",audit_log_exported:"workspace.audit_log_exported",automatic_account_creation_toggled:"workspace.settings.automatic_account_creation_setting_updated",content_analytics_exported:"workspace.content_analytics_exported",disable_guests_toggled:"workspace.settings.allow_guests_setting_updated",email_changed:"user.settings.email_updated",export_toggled:"workspace.settings.allow_content_export_setting_updated",external_membership_requests_toggled:"workspace.settings.external_membership_request_setting_updated",file_downloaded:"page.file_downloaded",file_uploaded:"page.file_uploaded",group_added_to_team:"teamspace.permissions.group_added",group_removed_from_team:"teamspace.permissions.group_removed",guest_membership_requests_toggled:"workspace.settings.guest_membership_request_setting_updated",guest_removed:"workspace.permissions.guest_removed",idp_metadata_url_updated:"workspace.saml_sso_idp_metadata_url_updated",idp_metadata_xml_removed:"workspace.saml_sso_idp_metadata_xml_removed",invite_link_toggled:"workspace.settings.invite_link_setting_updated",invite_link_reset:"workspace.settings.invite_link_reset",login:"user.login",logout:"user.logout",mfa_backup_code_toggled:"user.settings.login_method.mfa_backup_code_updated",mfa_sms_toggled:"user.settings.login_method.mfa_sms_updated",mfa_totp_toggled:"user.settings.login_method.mfa_totp_updated",member_added_to_group:"workspace.group.permissions.member_added",member_added_to_team:"teamspace.permissions.member_added",member_invited:"workspace.permissions.member_invited",member_joined:"workspace.permissions.member_added",member_joined_team:"teamspace.permissions.member_added",member_left_team:"teamspace.permissions.member_removed",member_removed:"workspace.permissions.member_removed",member_removed_from_group:"workspace.group.permissions.member_removed",member_removed_from_team:"teamspace.permissions.member_removed",member_role_updated:"workspace.permissions.member_role_updated",member_team_role_updated:"teamspace.permissions.member_role_updated",membership_request_resolved:"workspace.membership_request_resolved",membership_requests_toggled:"workspace.settings.membership_request_setting_updated",page_access_requests_toggled:"workspace.settings.page_access_request_setting_updated",page_created:"page.created",page_deleted:"page.deleted","page.discussion.comment.created":"page.discussion.comment.created","page.discussion.comment.deleted":"page.discussion.comment.deleted","page.discussion.comment.updated":"page.discussion.comment.updated",page_edited:"page.content_edited",page_exported:"page.exported",page_moved:"page.moved","page.properties_edited":"page.properties_edited","page.permanently_deleted":"page.permanently_deleted",page_restored:"page.restored_from_trash",page_viewed:"page.viewed",pages_to_other_workspaces_toggled:"workspace.settings.duplicate_pages_to_workspaces_setting_updated",password_cleared:"user.settings.login_method.password_removed",password_changed:"user.settings.login_method.password_updated",password_set:"user.settings.login_method.password_added",picture_changed:"user.settings.profile_photo_updated",preferred_name_changed:"user.settings.preferred_name_updated",private_content_transferred:"workspace.private_content_transferred",public_page_cleared:"workspace.settings.public_homepage_removed",public_page_sharing_toggled:"teamspace.settings.allow_public_page_sharing_setting_updated",revoked_support_access:"user.settings.support_access_revoked",saml_enforce_toggled:"workspace.settings.enforce_saml_sso_config_updated",saml_toggled:"workspace.settings.enable_saml_sso_config_updated",scim_token_generated:"workspace.scim_token_generated",scim_token_revoked:"workspace.scim_token_revoked",space_claim_and_upgrade_status_changed:"workspace.domain_management.claim_request_status_updated",space_claim_deletion_status_changed:"workspace.domain_management.deletion_request_status_updated",space_transfer_status_changed:"workspace.domain_management.transfer_request_status_updated",team_archived:"teamspace.archived",team_created:"teamspace.created",team_creation_admins_setting_toggled:"workspace.settings.allow_teamspace_creation_setting_updated",team_default_toggled:"teamspace.settings.default_setting_updated",team_description_changed:"teamspace.settings.description_updated",team_export_toggled:"teamspace.settings.allow_content_export_setting_updated",team_guests_toggled:"teamspace.settings.allow_guests_setting_updated",team_icon_changed:"teamspace.settings.icon_updated",team_invite_access_changed:"teamspace.settings.member_invitation_setting_updated",team_member_default_permission_updated:"teamspace.permissions.default_member_role_updated",team_name_changed:"teamspace.settings.name_updated",team_privacy_type_changed:"teamspace.settings.privacy_type_updated",team_public_page_sharing_toggled:"teamspace.settings.allow_public_page_sharing_setting_updated",team_restored:"teamspace.restored",team_sidebar_editing_toggled:"teamspace.settings.allow_sidebar_editing_setting_updated",teams_enabled_for_space:"workspace.settings.teamspaces_enabled_updated",user_analytics_exported:"workspace.user_analytics_exported",user_deleted:"user.account_deleted",workspace_analytics_toggled:"workspace.settings.analytics_tracking_setting_updated",workspace_creation_set_for_email_domain:"workspace.settings.allow_workspace_creation_setting_updated",workspace_domain_changed:"workspace.settings.public_pages_domain_updated",workspace_exported:"workspace.content_exported",workspace_icon_changed:"workspace.settings.icon_updated",workspace_integration_restriction_changed:"workspace.settings.integration_restriction_settings_updated",workspace_name_changed:"workspace.settings.name_updated",workspace_sidebar_editing_toggled:"workspace.settings.sidebar_editing_setting_updated","integration.created":"integration.created","integration.deleted":"integration.deleted","page.automation_deleted":"page.automation_deleted","page.file_deleted":"page.file_deleted","integration.secret_reset":"integration.secret_reset","workspace.external_account_connected":"workspace.external_account_connected","workspace.external_account_disconnected":"workspace.external_account_disconnected","workspace.integration_added":"workspace.integration_added","workspace.integration_removed":"workspace.integration_removed","workspace.members_exported":"workspace.members_exported","user.settings.analytics_tracking_setting_updated":"user.settings.analytics_tracking_setting_updated","workspace.settings.guest_invite_request_setting_updated":"workspace.settings.guest_invite_request_setting_updated","workspace.guest_invite_request_resolved":"workspace.guest_invite_request_resolved"},ut=["admin_managed_users_log_out_all","admin_managed_users_log_out_one","admin_managed_users_password_cleared","admin_managed_users_password_cleared_one","disable_team_guests_toggled","space_consolidation_completed","space_consolidation_failed","space_consolidation_started","team_guest_default_permission_updated","user_suspended","user_unsuspended","workspace.settings.custom_session_duration_updated","workspace.settings.external_workspace_access_updated","workspace.settings.prevent_granting_support_access_updated","workspace.settings.prevent_profile_edits_updated"];(0,_.AO)((e=>{for(const t of U)if(t===e)return{true:e};return{false:e}})),(0,_.AO)((e=>{for(const t of V)if(t===e)return{true:e};return{false:e}}));var mt=s(8848),pt=s(7057);const gt=(0,g.defineMessages)({adminLabel:{id:"auditLogSpaceRoleMessages.admin",defaultMessage:"admin"},workspaceOwnerLabel:{id:"auditLogSpaceRoleMessages.workspaceOwner",defaultMessage:"workspace owner"},membershipAdminLabel:{id:"auditLogSpaceRoleMessages.membershipAdmin",defaultMessage:"membership admin"},memberLabel:{id:"auditLogSpaceRoleMessages.member",defaultMessage:"member"},guestLabel:{id:"auditLogSpaceRoleMessages.guest",defaultMessage:"guest"},noAccessLabel:{id:"auditLogSpaceRoleMessages.noAccess",defaultMessage:"no access"},pageGuestLabel:{id:"auditLogSpaceRoleMessages.pageGuest",defaultMessage:"page guest"},teamGuestLabel:{id:"auditLogSpaceRoleMessages.teamGuest",defaultMessage:"teamspace guest"}}),ht=(0,g.defineMessages)({missing:{defaultMessage:"MISSING",id:"csvExport.copiedText.missingField"},notApplicable:{defaultMessage:"N/A",id:"csvExport.copiedText.notApplicable"}});function ft(e){return`"${e.replace(/"/g,'""')}"`}const yt={defaultMessage:"N/A",id:"auditLogPaginatedTable.copiedText.notAvailable",description:"Shown in the copied text when the value is not available. Means not applicable"},vt=((0,_.AO)((e=>30===e||60===e||90===e||365===e?{true:e}:{false:e})),(0,g.defineMessages)({"page.properties_edited":{id:"auditlogEventFilter.actionName.page.properties_edited",defaultMessage:"Page properties edited"},"page.discussion.comment.created":{id:"auditlogEventFilter.actionName.page.discussion.comment.created",defaultMessage:"Comment added"},"page.discussion.comment.updated":{id:"auditlogEventFilter.actionName.page.discussion.comment.updated",defaultMessage:"Comment updated"},"page.discussion.comment.deleted":{id:"auditlogEventFilter.actionName.page.discussion.comment.deleted",defaultMessage:"Comment deleted"},page_edited:{id:"auditlogEventFilter.actionName.page_edited",defaultMessage:"Page edited"},page_viewed:{id:"auditlogEventFilter.actionName.page_viewed",defaultMessage:"Page viewed"},page_created:{id:"auditlogEventFilter.actionName.page_created",defaultMessage:"Page created"},page_deleted:{id:"auditlogEventFilter.actionName.page_deleted",defaultMessage:"Page deleted"},"page.permanently_deleted":{id:"auditlogEventFilter.actionName.page.permanently_deleted",defaultMessage:"Page permanently deleted"},page_restored:{id:"auditlogEventFilter.actionName.page_restored",defaultMessage:"Page restored"},page_exported:{id:"auditlogEventFilter.actionName.page_exported",defaultMessage:"Page exported"},page_moved:{id:"auditlogEventFilter.actionName.page_moved",defaultMessage:"Page moved"},page_permission_updated:{id:"auditlogEventFilter.actionName.page_permission_updated",defaultMessage:"Page permission updated"},page_shared_to_web:{id:"auditlogEventFilter.actionName.page_shared_to_web",defaultMessage:"Page shared to web"},password_set:{id:"auditlogEventFilter.actionName.password_set",defaultMessage:"Password set"},password_cleared:{id:"auditlogEventFilter.actionName.password_cleared",defaultMessage:"Password cleared"},password_changed:{id:"auditlogEventFilter.actionName.password_changed",defaultMessage:"Password changed"},login:{id:"auditlogEventFilter.actionName.login",defaultMessage:"Login"},logout:{id:"auditlogEventFilter.actionName.logout",defaultMessage:"Logout"},mfa_sms_toggled:{id:"auditlogEventFilter.actionName.mfa_sms_toggled",defaultMessage:"MFA SMS toggled"},mfa_totp_toggled:{id:"auditlogEventFilter.actionName.mfa_totp_toggled",defaultMessage:"MFA TOTP toggled"},mfa_backup_code_toggled:{id:"auditlogEventFilter.actionName.mfa_backup_code_toggled",defaultMessage:"MFA backup code toggled"},member_invited:{id:"auditlogEventFilter.actionName.member_invited",defaultMessage:"Member invited"},member_joined:{id:"auditlogEventFilter.actionName.member_joined",defaultMessage:"Member joined"},member_role_updated:{id:"auditlogEventFilter.actionName.member_role_updated",defaultMessage:"Member role updated"},member_removed:{id:"auditlogEventFilter.actionName.member_removed",defaultMessage:"Member removed"},guest_removed:{id:"auditlogEventFilter.actionName.guest_removed",defaultMessage:"Guest removed"},user_deleted:{id:"auditlogEventFilter.actionName.user_deleted",defaultMessage:"User deleted"},email_changed:{id:"auditlogEventFilter.actionName.email_changed",defaultMessage:"Email changed"},preferred_name_changed:{id:"auditlogEventFilter.actionName.preferred_name_changed",defaultMessage:"Name changed"},picture_changed:{id:"auditlogEventFilter.actionName.picture_changed",defaultMessage:"Picture changed"},file_uploaded:{id:"auditlogEventFilter.actionName.file_uploaded",defaultMessage:"File uploaded"},file_downloaded:{id:"auditlogEventFilter.actionName.file_downloaded",defaultMessage:"File downloaded"},invite_link_toggled:{id:"auditlogEventFilter.actionName.invite_link_toggled",defaultMessage:"Invite link toggled"},workspace_name_changed:{id:"auditlogEventFilter.actionNames.workspace_name_changed",defaultMessage:"Workspace name changed"},workspace_integration_restriction_changed:{id:"auditlogEventFilter.actionNames.workspace_integration_restriction_changed",defaultMessage:"Integration installation toggled"},invite_link_reset:{id:"auditlogEventFilter.actionNames.invite_link_reset",defaultMessage:"Invite link reset"},public_page_sharing_toggled:{id:"auditlogEventFilter.actionNames.public_page_sharing_toggled",defaultMessage:"Public page sharing toggled"},workspace_sidebar_editing_toggled:{id:"auditlogEventFilter.actionNames.workspace_sidebar_editing_toggled",defaultMessage:"Workspace sidebar editing toggled"},disable_team_guests_toggled:{id:"auditlogEventFilter.actionNames.disable_team_guests_toggled",defaultMessage:"Disable teamspace guests toggled"},disable_guests_toggled:{id:"auditlogEventFilter.actionNames.disable_guests_toggled",defaultMessage:"Disable guests toggled"},pages_to_other_workspaces_toggled:{id:"auditlogEventFilter.actionNames.pages_to_other_workspaces_toggled",defaultMessage:"Pages to other workspaces toggled"},export_toggled:{id:"auditlogEventFilter.actionNames.export_toggled",defaultMessage:"Export toggled"},page_access_requests_toggled:{id:"auditlogEventFilter.actionNames.page_access_requests_toggled",defaultMessage:"Page access requests toggled"},workspace_exported:{id:"auditlogEventFilter.actionNames.workspace_exported",defaultMessage:"Workspace content exported"},audit_log_exported:{id:"auditlogEventFilter.actionNames.audit_log_exported",defaultMessage:"Audit Log exported"},user_analytics_exported:{id:"auditlogEventFilter.actionNames.user_analytics_exported",defaultMessage:"User Analytics exported"},content_analytics_exported:{id:"auditlogEventFilter.actionNames.content_analytics_exported",defaultMessage:"Content Analytics exported"},workspace_icon_changed:{id:"auditlogEventFilter.actionNames.workspace_icon_changed",defaultMessage:"Workspace icon changed"},allowed_email_domain_added:{id:"auditlogEventFilter.actionNames.allowed_email_domain_added",defaultMessage:"Added allowed email domain"},allowed_email_domain_removed:{id:"auditlogEventFilter.actionNames.allowed_email_domain_removed",defaultMessage:"Removed allowed email domain"},workspace_domain_changed:{id:"auditlogEventFilter.actionNames.workspace_domain_changed",defaultMessage:"Workspace domain changed"},public_page_cleared:{id:"auditlogEventFilter.actionNames.public_page_cleared",defaultMessage:"Public home page link cleared"},public_page_set:{id:"auditlogEventFilter.actionNames.public_page_set",defaultMessage:"Public home page set"},scim_token_generated:{id:"auditlogEventFilter.actionNames.scim_token_generated",defaultMessage:"SCIM token generated"},scim_token_revoked:{id:"auditlogEventFilter.actionNames.scim_token_revoked",defaultMessage:"SCIM token revoked"},idp_metadata_url_updated:{id:"auditlogEventFilter.actionNames.idp_metadata_url_updated",defaultMessage:"IDP metadata URL updated"},idp_metadata_xml_updated:{id:"auditlogEventFilter.actionNames.idp_metadata_xml_updated",defaultMessage:"IDP metadata XML updated"},idp_metadata_xml_removed:{id:"auditlogEventFilter.actionNames.idp_metadata_xml_removed",defaultMessage:"IDP metadata XML removed"},saml_toggled:{id:"auditlogEventFilter.actionNames.saml_toggled",defaultMessage:"SAML enable setting toggled"},saml_enforce_toggled:{id:"auditlogEventFilter.actionNames.saml_enforce_toggled",defaultMessage:"SAML enforce setting toggled"},automatic_account_creation_toggled:{id:"auditlogEventFilter.actionNames.automatic_account_creation_toggled",defaultMessage:"Auto-create accounts on sign-in toggled"},workspace_creation_set_for_email_domain:{id:"auditlogEventFilter.actionNames.workspace_creation_set_for_email_domain",defaultMessage:"Workspace creation setting updated"},"integration.created":{id:"auditlogEventFilter.actionNames.integration.created",defaultMessage:"Integration added to workspace"},"integration.deleted":{id:"auditlogEventFilter.actionNames.integration.deleted",defaultMessage:"Integration removed from workspace"},"workspace.settings.custom_session_duration_updated":{id:"auditlogEventFilter.actionNames.workspace_domain_settings_session_duration_updated",defaultMessage:"Session duration for managed users updated"},"workspace.settings.external_workspace_access_updated":{id:"auditlogEventFilter.actionNames.workspace_domain_settings_external_workspace_access_updated",defaultMessage:"Ability for managed users to join external workspaces updated"},"workspace.settings.prevent_profile_edits_updated":{id:"auditlogEventFilter.actionNames.workspace_domain_prevent_profile_edits_updated",defaultMessage:"Ability for managed users to edit their profile information updated"},"workspace.settings.prevent_granting_support_access_updated":{id:"auditlogEventFilter.actionNames.workspace_domain_prevent_granting_support_access_updated",defaultMessage:"Ability for managed users to grant support access updated"},member_added_to_group:{id:"auditlogEventFilter.actionNames.member_added_to_group",defaultMessage:"Member added to group"},member_removed_from_group:{id:"auditlogEventFilter.actionNames.member_removed_from_group",defaultMessage:"Member removed from group"},space_transfer_status_changed:{id:"auditlogEventFilter.actionNames.space_transfer_status_changed",defaultMessage:"Claimable workspace transfer status change"},space_claim_and_upgrade_status_changed:{id:"auditlogEventFilter.actionNames.space_claim_and_upgrade_status_changed",defaultMessage:"Claimable workspace upgrade status change"},space_claim_deletion_status_changed:{id:"auditlogEventFilter.actionNames.space_claim_deletion_status_changed",defaultMessage:"Claimable workspace deletion status change"},allowed_support_access:{id:"auditlogEventFilter.actionNames.allowed_support_access",defaultMessage:"Granted support access"},revoked_support_access:{id:"auditlogEventFilter.actionNames.revoked_support_access",defaultMessage:"Revoked support access"},membership_requests_toggled:{id:"auditlogEventFilter.actionNames.membership_requests_toggled",defaultMessage:"Membership requests toggled"},external_membership_requests_toggled:{id:"auditlogEventFilter.actionNames.external_membership_requests_toggled",defaultMessage:"External membership requests toggled"},membership_request_resolved:{id:"auditlogEventFilter.actionNames.membership_request_resolved",defaultMessage:"Membership request resolved"},guest_membership_requests_toggled:{id:"auditlogEventFilter.actionNames.guest_membership_requests_toggled",defaultMessage:"Guest membership requests toggled"},team_created:{id:"auditlogEventFilter.actionNames.team_created",defaultMessage:"Teamspace created"},team_archived:{id:"auditlogEventFilter.actionNames.team_archived",defaultMessage:"Teamspace archived"},team_restored:{id:"auditlogEventFilter.actionNames.team_restored",defaultMessage:"Teamspace restored"},team_default_toggled:{id:"auditlogEventFilter.actionNames.team_default_toggled",defaultMessage:"Teamspace default toggled"},team_privacy_type_changed:{id:"auditlogEventFilter.actionNames.team_privacy_type_changed",defaultMessage:"Teamspace privacy type changed"},team_invite_access_changed:{id:"auditlogEventFilter.actionNames.team_invite_access_changed",defaultMessage:"Teamspace invite access changed"},team_public_page_sharing_toggled:{id:"auditlogEventFilter.actionNames.team_public_page_sharing_toggled",defaultMessage:"Teamspace public page sharing toggled"},team_export_toggled:{id:"auditlogEventFilter.actionNames.team_export_toggled",defaultMessage:"Teamspace export toggled"},team_sidebar_editing_toggled:{id:"auditlogEventFilter.actionNames.team_sidebar_editing_toggled",defaultMessage:"Teamspace sidebar editing toggled"},team_guests_toggled:{id:"auditlogEventFilter.actionNames.team_guests_toggled",defaultMessage:"Teamspace disable guests toggled"},team_name_changed:{id:"auditlogEventFilter.actionNames.team_name_changed",defaultMessage:"Teamspace name changed"},team_description_changed:{id:"auditlogEventFilter.actionNames.team_description_changed",defaultMessage:"Teamspace description changed"},team_icon_changed:{id:"auditlogEventFilter.actionNames.team_icon_changed",defaultMessage:"Teamspace icon changed"},team_creation_admins_setting_toggled:{id:"auditlogEventFilter.actionNames.team_creation_admins_setting_toggled",defaultMessage:"Teamspace creation setting toggled"},member_added_to_team:{id:"auditlogEventFilter.actionNames.member_added_to_team",defaultMessage:"Member added to teamspace"},member_removed_from_team:{id:"auditlogEventFilter.actionNames.member_removed_from_team",defaultMessage:"Member removed from teamspace"},group_added_to_team:{id:"auditlogEventFilter.actionNames.group_added_to_team",defaultMessage:"Group added to teamspace"},group_removed_from_team:{id:"auditlogEventFilter.actionNames.group_removed_from_team",defaultMessage:"Group removed from teamspace"},member_left_team:{id:"auditlogEventFilter.actionNames.member_left_team",defaultMessage:"Member left teamspace"},member_joined_team:{id:"auditlogEventFilter.actionNames.member_joined_team",defaultMessage:"Member joined teamspace"},member_team_role_updated:{id:"auditlogEventFilter.actionNames.member_team_role_updated",defaultMessage:"Member teamspace role updated"},team_user_permission_updated:{id:"auditlogEventFilter.actionNames.team_user_permission_updated",defaultMessage:"Custom permissions updated for a member in the teamspace"},team_group_permission_updated:{id:"auditlogEventFilter.actionNames.team_group_permission_updated",defaultMessage:"Custom permissions updated for a group in the teamspace"},team_member_default_permission_updated:{id:"auditlogEventFilter.actionNames.team_member_default_permission_updated",defaultMessage:"Teamspace Members default permission updated"},team_guest_default_permission_updated:{id:"auditlogEventFilter.actionNames.team_guest_default_permission_updated",defaultMessage:"Teamspace Guests default permission updated"},team_workspace_default_permission_updated:{id:"auditlogEventFilter.actionNames.team_workspace_default_permission_updated",defaultMessage:"Everyone in workspace default page permission updated"},teams_enabled_for_space:{id:"auditlogEventFilter.actionNames.teams_enabled_for_space",defaultMessage:"Enabled teamspaces"},private_content_transferred:{id:"auditLogEventFilter.actionNames.private_content_transferred",defaultMessage:"Private content transferred"},admin_content_search_queried:{id:"auditLogEventFilter.actionNames.admin_content_search_queried",defaultMessage:"Content search queried"},admin_content_search_exported:{id:"auditLogEventFilter.actionNames.admin_content_search_exported",defaultMessage:"Content search results exported"},admin_managed_users_log_out_all:{id:"auditLogEventFilter.actionNames.admin_managed_users_log_out_all",defaultMessage:"All managed users logged out"},admin_managed_users_log_out_one:{id:"auditLogEventFilter.actionNames.admin_managed_users_log_out_one",defaultMessage:"A managed user was logged out by an admin"},admin_managed_users_password_cleared:{id:"auditLogEventFilter.actionNames.password_cleared",defaultMessage:"All managed users' passwords cleared"},admin_managed_users_password_cleared_one:{id:"auditLogEventFilter.actionNames.admin_managed_users_password_cleared_one",defaultMessage:"A managed user's password was cleared by an admin"},automation_created:{id:"auditLogEventFilter.actionNames.automation_created",defaultMessage:"Automation created"},automation_edited:{id:"auditLogEventFilter.actionNames.automation_edited",defaultMessage:"Automation edited"},ai_admin_legal_acceptance_toggled:{id:"auditLogEventFilter.actionNames.ai_admin_legal_acceptance_toggled",defaultMessage:"Notion AI toggled for workspace."},workspace_analytics_toggled:{id:"auditLogEventFilter.actionNames.workspace_analytics_toggled",defaultMessage:"Workspace analytics tracking toggled"},space_consolidation_started:{id:"auditLogEventFilter.actionNames.space_consolidation_started",defaultMessage:"Workspace consolidation started"},space_consolidation_completed:{id:"auditLogEventFilter.actionNames.space_consolidation_completed",defaultMessage:"Workspace consolidation completed"},space_consolidation_failed:{id:"auditLogEventFilter.actionNames.space_consolidation_failed",defaultMessage:"Workspace consolidation failed"},user_suspended:{id:"auditLogEventFilter.actionNames.user_suspended",defaultMessage:"User suspended"},user_unsuspended:{id:"auditLogEventFilter.actionNames.user_unsuspended",defaultMessage:"User reactivated"},"page.automation_deleted":{id:"auditLogEventFilter.actionNames.page.automation_deleted",defaultMessage:"Automation deleted"},"page.file_deleted":{id:"auditLogEventFilter.actionNames.page.file_deleted",defaultMessage:"File deleted"},"integration.secret_reset":{id:"auditLogEventFilter.actionNames.integration.secret_reset",defaultMessage:"Integration secret reset"},"workspace.external_account_connected":{id:"auditLogEventFilter.actionNames.workspace.external_account_connected",defaultMessage:"External/Public integration connected"},"workspace.external_account_disconnected":{id:"auditLogEventFilter.actionNames.workspace.external_account_disconnected",defaultMessage:"External/Public integration disconnected"},"workspace.integration_added":{id:"auditLogEventFilter.actionNames.workspace.integration_added",defaultMessage:"Integration added to workspace"},"workspace.integration_removed":{id:"auditLogEventFilter.actionNames.workspace.integration_removed",defaultMessage:"Integration removed from workspace"},"workspace.members_exported":{id:"auditLogEventFilter.actionNames.workspace.members_exported",defaultMessage:"Workspace members exported"},"user.settings.analytics_tracking_setting_updated":{id:"auditLogEventFilter.actionNames.user.settings.analytics_tracking_setting_updated",defaultMessage:"User analytics tracking toggled"},"workspace.settings.guest_invite_request_setting_updated":{id:"auditLogEventFilter.actionNames.workspace.settings.guest_invite_request_setting_updated",defaultMessage:"Guest requests toggled"},"workspace.guest_invite_request_resolved":{id:"auditLogEventFilter.actionNames.workspace.guest_invite_request_resolved",defaultMessage:"Guest invite request resolved"}})),xt=(0,g.defineMessages)({private:{id:"auditLogColumnEvent.tooltip.pageAudience.private",defaultMessage:"private"},shared_internally:{id:"auditLogColumnEvent.tooltip.pageAudience.sharedInternally",defaultMessage:"shared internally"},shared_externally:{id:"auditLogColumnEvent.tooltip.pageAudience.sharedExternally",defaultMessage:"shared externally"},shared_to_web:{id:"auditLogColumnEvent.tooltip.pageAudience.sharedToWeb",defaultMessage:"shared to web"}}),St=["name","email","status","activityType","activity","audience","dateAndTime","platform","ipAddress","city","state","country","pageId"],bt=[...St,"eventName"];(0,g.defineMessages)({name:{id:"exportAuditLog.header.name",defaultMessage:"Name"},email:{id:"exportAuditLog.header.email",defaultMessage:"Email"},status:{id:"exportAuditLog.header.status",defaultMessage:"Status"},activityType:{id:"exportAuditLog.header.activityType",defaultMessage:"Activity Type"},activity:{id:"exportAuditLog.header.activity",defaultMessage:"Activity"},dateAndTime:{id:"exportAuditLog.header.dateAndTime",defaultMessage:"Date and Time (UTC)"},platform:{id:"exportAuditLog.header.platform",defaultMessage:"Platform"},ipAddress:{id:"exportAuditLog.header.ipAddress",defaultMessage:"IP Address"},city:{id:"exportAuditLog.header.city",defaultMessage:"City"},state:{id:"exportAuditLog.header.state",defaultMessage:"State"},country:{id:"exportAuditLog.header.country",defaultMessage:"Country"},audience:{id:"exportAuditLog.header.audience",defaultMessage:"Audience"},pageId:{id:"exportAuditLog.header.pageId",defaultMessage:"Page Id"},eventName:{id:"exportAuditLog.header.eventName",defaultMessage:"Event Name"}});function Mt(e,t,s){var i;return e.actor.actorId===q.s$.id||e.actor.actorId===q.el.id?t.formatMessage({defaultMessage:"notion_admin",id:"auditLogPaginatedTable.copiedText.notionAdmin"}):"notion_user"===e.actor.actorType?t.formatMessage(function(e,t){if(!e)return gt.noAccessLabel;if(t){if("guest"===e)return gt.pageGuestLabel;if("team_level_guest"===e)return gt.teamGuestLabel}switch(e){case"admin":return gt.workspaceOwnerLabel;case"membership_admin":return gt.membershipAdminLabel;case"member":return gt.memberLabel;case"guest":case"team_level_guest":return gt.guestLabel;case"no_access":return gt.noAccessLabel;default:(0,_.t1)(e)}}(null===(i=e.actor.meta)||void 0===i?void 0:i.spaceRole,s)):t.formatMessage({defaultMessage:"N/A",id:"auditLogPaginatedTable.copiedText.noRole"})}function wt(e,t){var s,i,n,a,o,r,l,d,c,u;return null!==(s=e.actor.meta)&&void 0!==s&&s.countryCode?null!==(i=e.actor)&&void 0!==i&&null!==(i=i.meta)&&void 0!==i&&i.city?"US"===(null===(n=e.actor.meta)||void 0===n?void 0:n.countryCode)&&null!==(a=e.actor)&&void 0!==a&&null!==(a=a.meta)&&void 0!==a&&a.state?t.formatMessage({defaultMessage:"{city}, {state}, {countryCode}",id:"auditLogSettings.metadata.cityStateAndCountry"},{city:null===(d=e.actor)||void 0===d||null===(d=d.meta)||void 0===d?void 0:d.city,state:null===(c=e.actor)||void 0===c||null===(c=c.meta)||void 0===c?void 0:c.state,countryCode:null===(u=e.actor)||void 0===u||null===(u=u.meta)||void 0===u?void 0:u.countryCode}):t.formatMessage({defaultMessage:"{city}, {countryCode}",id:"auditLogSettings.metadata.cityAndCountry"},{city:null===(o=e.actor)||void 0===o||null===(o=o.meta)||void 0===o?void 0:o.city,countryCode:null===(r=e.actor)||void 0===r||null===(r=r.meta)||void 0===r?void 0:r.countryCode}):null===(l=e.actor)||void 0===l||null===(l=l.meta)||void 0===l?void 0:l.countryCode:""}function jt(e){const{auditLogEntry:t,intl:s,getAuditLogEventText:i,isTeamGuestsEnabled:n,csvColumnNames:a}=e,o=[],r=s.formatMessage(ht.missing);return a.forEach((e=>{var a,l,d,c,u;switch(e){case"name":o.push(t.actor.name||r);break;case"email":o.push(function(e,t){return"notion_user"===e.actor.actorType?e.actor.email:t.formatMessage({defaultMessage:"N/A",id:"auditLogPaginatedTable.copiedText.noEmail"})}(t,s)||r);break;case"status":o.push(Mt(t,s,n)||r);break;case"activityType":o.push(vt[t.actionName]?s.formatMessage(vt[t.actionName]):r);break;case"activity":o.push(i(t)||r);break;case"dateAndTime":o.push((0,pt.$I)(t.serverTimestamp));break;case"platform":o.push((null===(a=t.actor.meta)||void 0===a?void 0:a.platform)||r);break;case"ipAddress":o.push((null===(l=t.actor.meta)||void 0===l?void 0:l.ipAddress)||r);break;case"city":o.push((null===(d=t.actor.meta)||void 0===d?void 0:d.city)||r);break;case"state":o.push((null===(c=t.actor.meta)||void 0===c?void 0:c.state)||r);break;case"country":o.push((null===(u=t.actor.meta)||void 0===u?void 0:u.countryCode)||r);break;case"audience":const m=function(e){return Ct(e)??e.intl.formatMessage(ht.notApplicable)}({auditLogEntry:t,intl:s});o.push(m||r);break;case"pageId":const p=K(t);p?o.push(p.id):o.push(s.formatMessage(ht.notApplicable));break;case"eventName":o.push(function(e){let{auditLogEntry:t,intl:s}=e;const i=t.actionName;return ct[i]?ct[i]:((0,_.DE)(ut,i),s.formatMessage(yt))}({auditLogEntry:t,intl:s}));break;default:(0,_.t1)(e)}})),o.map(ft).join(",")}function Ct(e){var t;const{auditLogEntry:s,intl:i}=e,n=K(s);return null!=n&&null!==(t=n.meta)&&void 0!==t&&t.pageAudience?i.formatMessage(xt[n.meta.pageAudience]):null}var kt=s(58573),_t=s(67220),Tt=s(60458),It=s(64369),Pt=s(4708),Zt=s(77080),Ft=s(29798);let At=function(e){return e.All="All",e.Partial="Partial",e.None="None",e}({});class Dt extends Z.default{getInitialState(){return{categorySelections:{page:At.All,space:At.All,team:At.All,account:At.All},categoryToggleOpen:{page:!0,space:!0,team:!0,account:!0},searchQuery:void 0,actionSelections:(0,_.Xc)(W,(()=>!0)),isMenuOpen:!1,renderOrder:[{category:"page",orderedActions:z.page},{category:"space",orderedActions:z.space},{category:"account",orderedActions:z.account},{category:"team",orderedActions:z.team}]}}getAllActionNames(){return(0,_.Yd)(this.state.actionSelections)}getSelectedActionNames(){return this.getAllActionNames().filter((e=>this.state.actionSelections[e]))}hasActionNameSelected(){const e=this.getAllActionNames(),t=this.getSelectedActionNames();return t.length>0&&t.length!==e.length}updateSearchQuery(e){this.setState({...this.state,searchQuery:e})}toggleCategorySelection(e){const t=e.category;this.setState({...this.state,categoryToggleOpen:{...this.state.categoryToggleOpen,[t]:!this.state.categoryToggleOpen[t]}})}selectCategorySelection(e){const t=e.category,s=this.state.categorySelections[t],i=s===At.None||s===At.Partial?At.All:At.None,n=i===At.All,a={...this.state.actionSelections},o=this.state.renderOrder.find((e=>e.category===t));o&&(o.orderedActions.forEach((e=>{a[e]=n})),this.setState({...this.state,actionSelections:a,categorySelections:{...this.state.categorySelections,[o.category]:i}}))}selectActionName(e,t){const s=this.state.actionSelections[e],i={...this.state.actionSelections,[e]:!s},n=t.orderedActions.filter((e=>i[e])).length,a=0===n?At.None:n===t.orderedActions.length?At.All:At.Partial;this.setState({...this.state,actionSelections:i,categorySelections:{...this.state.categorySelections,[t.category]:a}})}clearAllSelections(){const e=this.getBulkUpdateNextActionSelectionState((0,_.Yd)(this.state.actionSelections),!1),t=this.getBulkUpdateNextCategorySelectionState((0,_.Yd)(this.state.categorySelections),At.None);this.setState({...this.state,actionSelections:e,categorySelections:t})}getBulkUpdateNextCategorySelectionState(e,t){const s={...this.state.categorySelections};return e.forEach((e=>{s[e]=t})),s}getBulkUpdateNextActionSelectionState(e,t){const s={...this.state.actionSelections};return e.forEach((e=>{s[e]=t})),s}}var Bt=s(5210);const Rt={page:(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.categoryName.page",defaultMessage:"Page"}),space:(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.categoryName.workspace",defaultMessage:"Workspace"}),team:(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.categoryName.team",defaultMessage:"Teamspace"}),account:(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.categoryName.account",defaultMessage:"Account"})};function Lt(e){let{totalNumEventsForCategory:t,numSelectedForCategory:s,category:i,categoryOpen:n,shouldShowCount:a,onCategoryClick:o,onCategoryToggleClick:l,...d}=e;window.__c={n:"AuditLogCategoryMenuItem"};const c=(0,lt.yK)((e=>({textWrapperStyle:{margin:0},title:{margin:0,display:"flex",alignItems:"center"},categoryText:{marginLeft:8,fontWeight:600},categorySubHeader:{marginLeft:6},toggleButton:{marginLeft:2,marginRight:2}})),[]);let u,m;return u=a?t===s?(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.allEventsSelected",defaultMessage:"({totalNum} events)",values:{totalNum:t}}):(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.numEventsSelected",defaultMessage:"({numSelected} of {totalNum} events selected)",values:{numSelected:s,totalNum:t}}):null,m=t===s||0!==s&&"partial",(0,r.jsx)(ue.Z,{...d,className:"notranslate",textWrapperStyle:c.textWrapperStyle,focused:!1,title:(0,r.jsxs)("div",{style:c.title,children:[(0,r.jsx)(Bt.Z,{style:c.toggleButton,open:n,onClick:l,isSidebar:!1,fill:!1,icon:"chevron"}),(0,r.jsx)(Tt.Z,{checked:m,size:14,checkSize:8,onClick:o}),(0,r.jsx)(It.Z,{style:c.categoryText,children:Rt[i]}),(0,r.jsx)(It.Z,{isSecondaryColor:!0,style:c.categorySubHeader,children:u})]})})}class Nt extends n.Z{constructor(){super(...arguments),this.storeTypes={componentStore:Dt,lastSelectionStore:Dt,menuListStore:Ft.Z},this.renderMenu=()=>{const{componentStore:e,menuListStore:t}=this.stores,s=this.styles,i=[];let n=0,a=0;const o=e.state.searchQuery;for(const r of e.state.renderOrder){const t=r.category;if("team"===t&&!(0,T.bq)())return;const s=[];let l=0;for(const i of r.orderedActions)this.eventsToFilterOut.includes(i)||(s.push(this.renderActionNameMenu(i,r)),e.state.actionSelections[i]&&l++);if(n+=l,a+=s.length,i.push(this.renderCategoryMenu({renderGroup:r,shouldShowCount:!Boolean(o),totalNumEventsForCategory:s.length,numSelectedForCategory:l})),e.state.categoryToggleOpen[t])if(o){const e=(0,kt.ZP)(o,s,Ot);i.push(...e)}else i.push(...s)}const l={key:"results",items:i,render:e=>(0,r.jsx)(he.Z,{...e,title:null,loading:!1})};return(0,r.jsxs)("div",{style:s.container,children:[(0,r.jsx)(Ue.Z,{style:s.searchInput,placeholder:this.props.intl.formatMessage({id:"auditlogEventFilter.searchPlaceholder",defaultMessage:"Search for an event"}),onChange:this.handleUpdateSearchQuery,value:e.state.searchQuery,showClearButton:!0}),o&&(0,r.jsx)(Vt,{totalNumSelected:n,totalNumEvents:a}),(0,r.jsx)(me.Z,{menuType:ye.og.Popup,header:null,maxHeight:356,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,store:t,initialFocus:0,sections:[l]})}),(0,r.jsxs)(he.Z,{topBorder:!0,style:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},children:[(0,r.jsx)(Ze.Z,{onClick:()=>{this.handleClear()},children:(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.clearButton",defaultMessage:"Clear"})}),(0,r.jsx)(ce.Z,{onClick:()=>{this.handleApply()},children:(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.applyButton",defaultMessage:"Apply"})})]})]})},this.renderPillButtonOrigin=e=>{const{componentStore:t}=this.stores,s=t.hasActionNameSelected();return(0,r.jsx)(Ie.Z,{on:s,icon:(0,_t.S)({width:16,marginRight:6,fill:"currentColor"}),title:(0,r.jsx)("span",{children:e}),onClick:()=>{this.setMenuOpen(!0)}})},this.featureGatedEventsToFilterOut=(0,_.qP)(dt).reduce(((e,t)=>{let[s,i]=t;return Zt.default.checkGate(s)?e:[...e,...i]}),[]),this.teamspaceGuestEventsToFilterOut=(0,Pt.F$)()?[]:["team_guest_default_permission_updated"],this.guestMembershipEventsToFilterOut=(0,Pt.Ye)()?[]:["guest_membership_requests_toggled"],this.eventsToFilterOut=[...this.featureGatedEventsToFilterOut,...this.teamspaceGuestEventsToFilterOut,...this.guestMembershipEventsToFilterOut],this.setMenuOpen=e=>{const{componentStore:t}=this.stores;t.setState({...t.state,isMenuOpen:e})},this.handleUpdateSearchQuery=e=>{this.stores.componentStore.updateSearchQuery(e.target.value)},this.styles={container:{minWidth:460},searchInput:{padding:8,borderBottomLeftRadius:0,borderBottomRightRadius:0,boxShadow:"none",borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:this.theme.lightDividerColor},popup:{paddingBottom:8}}}renderComponent(){const{componentStore:e}=this.stores,t=this.styles,s=(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.title",defaultMessage:"Event"}),i=this.renderPillButtonOrigin(s);return(0,r.jsx)($e.Z,{marginAfter:!1,children:(0,r.jsx)(ge.ZP,{popupType:ge.ZP.PopupType.Popup,placementToOrigin:ge.ZP.Placement.Bottom,alignmentToOrigin:ge.ZP.Alignment.Start,open:e.state.isMenuOpen,render:this.renderMenu,onDismiss:()=>{this.handleMenuCloseFromOutside()},keepFocus:!0,origin:i,preventScaleTransition:!0,style:t.popup})})}renderCategoryMenu(e){const{renderGroup:t,shouldShowCount:s,totalNumEventsForCategory:i,numSelectedForCategory:n}=e,{componentStore:a}=this.stores,o=t.category,l=()=>{a.toggleCategorySelection(t)},d=()=>{a.selectCategorySelection(t)};return{key:o,action:l,render:e=>(0,r.jsx)(Lt,{totalNumEventsForCategory:i,numSelectedForCategory:n,category:o,categoryOpen:a.state.categoryToggleOpen[o],shouldShowCount:s,onCategoryToggleClick:l,onCategoryClick:d,...e}),localizedActionName:null,actionName:null}}renderActionNameMenu(e,t){const{intl:s}=this.props,{componentStore:i}=this.stores,n=()=>{i.selectActionName(e,t)},a=s.formatMessage(vt[e]);return{key:e,action:n,render:t=>(0,r.jsx)(ue.Z,{...t,icon:(0,r.jsx)(Tt.Z,{checked:i.state.actionSelections[e],size:14,checkSize:8,onClick:n}),focused:!1,title:a,className:"notranslate",style:{paddingLeft:32},textWrapperStyle:{marginLeft:4}}),actionName:e,localizedActionName:a}}handleMenuCloseFromOutside(){const{componentStore:e,lastSelectionStore:t}=this.stores;e.setState({...e.state,actionSelections:{...t.state.actionSelections}}),this.setMenuOpen(!1)}handleClear(){const{componentStore:e}=this.stores;e.clearAllSelections()}handleApply(){const{onChange:e}=this.props,{componentStore:t,lastSelectionStore:s}=this.stores,i=t.getAllActionNames(),n=t.getSelectedActionNames();e(i.length===n.length?[]:n),0===n.length&&t.reset(),s.setState({...s.state,actionSelections:{...t.state.actionSelections}}),this.setMenuOpen(!1)}}Nt.displayName="AuditLogEventFilter";const Et=(0,g.injectIntl)(Nt);function Ot(e){var t;return d.oA([e.key,null===(t=e.localizedActionName)||void 0===t?void 0:t.toLowerCase()]).join(" ")}function Vt(e){let{totalNumSelected:t,totalNumEvents:s}=e;window.__c={n:"SelectedEventsPill"};const i=(0,lt.yK)((e=>({container:{background:mt.ZP.diffBackground,color:mt.ZP.diffTextColor,paddingInline:6,margin:8,marginBottom:0,borderRadius:4,fontWeight:510,width:"fit-content"},textWrapperStyle:{marginLeft:8}})),[]);return(0,r.jsx)(It.Z,{style:i.container,children:(0,r.jsx)(g.FormattedMessage,{id:"auditLogEventFilter.selectedPill",defaultMessage:"{totalNumSelected} of {totalNumEvents} selected",values:{totalNumSelected:t,totalNumEvents:s}})})}const Ut=(0,g.injectIntl)((function(e){window.__c={n:"AuditLogFilterContainer"};const{spaceStore:t}=e,[s,i]=(0,N.AF)(ee),[n,a,o]=(0,N.AF)(ie);return(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:4},children:[(0,r.jsx)(Je,{mode:Ye.z.Pill,focused:!1,title:(0,r.jsx)(g.FormattedMessage,{id:"auditlogDateFilter.title",defaultMessage:"Date"}),icon:je.C,value:s.timeRange,showButtons:"footer",onChange:e=>{i({...s,timeRange:e,pageNum:1})}}),(0,r.jsx)(rt,{parentStore:t,auditLogHistoricalUserStore:o,selectedActors:s.actors,onChange:e=>{i({...s,actors:e,pageNum:1})}}),(0,r.jsx)(Et,{parentStore:t,selectedEvents:s.actions,onChange:e=>{i({...s,actions:e,pageNum:1})}})]})}));var Wt=s(63296),zt=s(23189),Kt=s(95477);function Ht(){return(0,r.jsxs)(zt.Z,{large:!0,style:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:p.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)("div",{style:{gap:8,display:"flex"},children:(0,r.jsx)(g.FormattedMessage,{id:"auditlog.title",defaultMessage:"Audit log"})}),(0,r.jsx)(Gt,{})]})}function Gt(){window.__c={n:"AuditLogFeedbackButton"};const e=(0,L.O7)();return Kt.default.isLocalhost?(0,r.jsx)(Wt.Z,{style:{marginLeft:10},isSmall:!0,onClick:()=>{S.navigateToExternalURL({environment:e,url:"https://dev.notion.so/notion/Audit-Log-Dev-feedback-e9048c4e7d544369b0b8413ec20f02cf",targetSelf:!0})},children:"🎁 Feedback is a gift!"}):null}var qt=s(43568);const Yt=function(){return(0,r.jsx)("div",{style:{},children:(0,r.jsx)(qt.Z,{paragraphs:[{lineHeight:45,lineMargin:20,sectionWidths:[100],repeat:1,sectionMargin:15},{lineHeight:40,lineMargin:5,sectionWidths:[100],repeat:8,sectionMargin:10}]})})};var Qt=s(75553),$t=s(14871),Xt=s(40394),Jt=s(64921),es=s(21752);function ts(e){window.__c={n:"AuditLogColumnActor"};const{auditLogEntry:t,spaceStore:s,id:n}=e,a=(0,g.useIntl)(),o=(0,N.VK)((()=>{if(t.actor.actorType===q.KJ){const e=nt.U6.createChildStore(s,{id:t.actor.actorId,table:q.KJ});if(e.isDefined()&&!e.getIsDeleted())return{actorStore:e};if(t.actor.email)return{avatar:{name:t.actor.name,email:t.actor.email}}}else if(t.actor.actorType===G.cZ){const e=nt.Qx.createChildStore(s,{id:t.actor.actorId,table:G.cZ});return e.isDefined()?{actorStore:e}:{avatar:{name:t.actor.name,email:t.actor.actorId}}}return{actorStore:void 0}}),[s,t]),l=(0,N.VK)((()=>{var e,t;if(o)return(null===(e=o.actorStore)||void 0===e?void 0:e.getDisplayName(a))??(null===(t=o.avatar)||void 0===t?void 0:t.name)}),[o,a]),d=(0,N.VK)((()=>{var e,t;if(o)return(null===(e=o.actorStore)||void 0===e?void 0:e.getDetail())??(null===(t=o.avatar)||void 0===t?void 0:t.email)}),[o]),c=(0,i.useMemo)((()=>{var e;if(t.actor.actorType===q.KJ)return(0,es.K)(null===(e=t.actor.meta)||void 0===e?void 0:e.spaceRole)}),[t]),u=(0,lt.yK)((()=>({container:{display:"block",width:"100%",paddingBlock:6}})),[]),m=(0,i.createRef)();return(0,r.jsx)(fe.Z,{disableTooltip:ss(m.current),renderTooltip:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:l}),(0,r.jsx)("div",{children:d})]}),placement:fe.Z.Placement.Bottom,render:e=>(0,r.jsx)("div",{...e,style:u.container,children:(0,r.jsx)(es.Z,{id:n,...o,spaceRole:c})})})}function ss(e){return!!e&&(e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)}var is=s(13991),ns=s(4023);function as(e){window.__c={n:"AuditLogColumnDateTime"};const{auditLogEntry:t,id:s}=e,i=(0,lt.yK)((()=>({container:{display:"block",width:"100%"}})),[]);return(0,r.jsx)(fe.Z,{renderTooltip:()=>(0,r.jsx)("div",{style:{display:"flex",flexDirection:"column",fontVariantNumeric:"tabular-nums"},children:(0,r.jsx)("div",{children:(0,r.jsx)(g.FormattedMessage,{id:"auditLogSettings.timeTooltip.utcTime",defaultMessage:"UTC: {time}",values:{time:(0,pt.$I)(t.serverTimestamp)}})})}),render:e=>(0,r.jsx)("div",{id:s,style:i.container,children:(0,r.jsx)(It.Z,{isSecondaryColor:!0,...e,children:(0,pt.Yx)(t.serverTimestamp,"medium_with_time",is.SP)})}),placement:ns.u.Bottom})}var os=s(44317),rs=s(68626),ls=s(26825),ds=s(21202),cs=s(19639),us=s(75246),ms=s(29369),ps=s(73123);function gs(e){return"workspace"!==e}const hs=(0,g.defineMessages)({password_cleared:{id:"auditlog.actionNames.eventColumn.password_cleared",defaultMessage:"Cleared login password"},password_set:{id:"auditlog.actionNames.eventColumn.password_set",defaultMessage:"Created a login password"},password_changed:{id:"auditlog.actionNames.eventColumn.password_changed",defaultMessage:"Changed login password"},logout:{id:"auditlog.actionNames.eventColumn.logout",defaultMessage:"Logged out"},user_deleted:{id:"auditlog.actionNames.eventColumn.user_deleted",defaultMessage:"User was deleted"},member_joined:{id:"auditlog.actionNames.eventColumn.member_joined",defaultMessage:"Joined the workspace"},file_uploaded:{id:"auditlog.actionNames.eventColumn.file_uploaded",defaultMessage:"Uploaded a file"},invite_link_reset:{id:"auditlog.actionNames.eventColumn.invite_link_reset",defaultMessage:"Reset invite link"},workspace_exported:{id:"auditlog.actionNames.eventColumn.workspace_exported",defaultMessage:"Exported all workspace content"},audit_log_exported:{id:"auditlogEventFilter.eventColumn.audit_log_exported",defaultMessage:"Exported audit log for last {duration} days"},user_analytics_exported:{id:"auditlogEventFilter.eventColumn.user_analytics_exported",defaultMessage:"Exported user analytics for {daysFilterString}"},content_analytics_exported:{id:"auditlogEventFilter.eventColumn.content_analytics_exported",defaultMessage:"Exported content analytics for {daysFilterString}"},workspace_icon_changed:{id:"auditlog.actionNames.eventColumn.workspace_icon_changed",defaultMessage:"Changed workspace icon"},public_page_cleared:{id:"auditlogEventFilter.actionNames.public_page_cleared",defaultMessage:"Public home page link cleared"},scim_token_generated:{id:"auditlog.actionNames.scim_token_generated",defaultMessage:"Generated API SCIM token"},scim_token_revoked:{id:"auditlog.actionNames.scim_token_revoked",defaultMessage:"Revoked API SCIM token"},"workspace.members_exported":{id:"auditlog.actionName.eventColumn.workspace.members_exported",defaultMessage:"Exported workspace members CSV"},page_access_requests_toggled:{id:"auditlog.actionNames.eventColumn.page_access_requests_toggled",defaultMessage:"page access requests from non-members"},public_page_sharing_toggled:{id:"auditlog.actionNames.eventColumn.public_page_sharing_toggled",defaultMessage:"members sharing pages publicly"},workspace_sidebar_editing_toggled:{id:"auditlog.actionNames.eventColumn.workspace_sidebar_editing_toggled",defaultMessage:"members changing the Workspace section"},disable_team_guests_toggled:{id:"auditlog.actionNames.eventColumn.disable_team_guests_toggled",defaultMessage:"teamspace guests"},disable_guests_toggled:{id:"auditlog.actionNames.eventColumn.disable_guests_toggled",defaultMessage:"guests"},pages_to_other_workspaces_toggled:{id:"auditlog.actionNames.eventColumn.pages_to_other_workspaces_toggled",defaultMessage:"moving or duplicating pages to other workspaces"},export_toggled:{id:"auditlog.actionNames.eventColumn.export_toggled",defaultMessage:"export"},idp_metadata_xml_updated:{id:"auditlog.actionNames.eventColumn.idp_metadata_xml_updated",defaultMessage:"Updated IDP metadata XML"},idp_metadata_xml_removed:{id:"auditlog.actionNames.eventColumn.idp_metadata_xml_removed",defaultMessage:"Removed IDP metadata XML"},saml_enabled:{id:"auditlog.actionNames.saml_enabled",defaultMessage:"Enabled SAML"},saml_disabled:{id:"auditlog.actionNames.saml_disabled",defaultMessage:"Disabled SAML"},saml_enforced:{id:"auditlog.actionNames.saml_enforced",defaultMessage:"Enabled enforcing SAML"},saml_unenforced:{id:"auditlog.actionNames.saml_unenforced",defaultMessage:"Disabled enforcing SAML"},automatic_account_creation_enabled:{id:"auditlog.actionNames.automatic_account_creation_enabled",defaultMessage:"Enabled automatically creating accounts on sign-in"},automatic_account_creation_disabled:{id:"auditlog.actionNames.automatic_account_creation_disabled",defaultMessage:"Disabled automatically creating accounts on sign-in"},workspace_analytics_enabled:{id:"auditlog.actionNames.workspace_analytics_enabled",defaultMessage:"Enabled page view tracking for workspace analytics"},workspace_analytics_disabled:{id:"auditlog.actionNames.workspace_analytics_disabled",defaultMessage:"Disabled page view tracking for workspace analytics"},enabled:{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumnPrefix.enabled"},disabled:{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled.disabled"},a_private_page:{defaultMessage:"a private page",id:"auditlog.actionNames.eventColumn.private_page"},an_untitled_page:{defaultMessage:"an untitled page",id:"auditlog.actionNames.eventColumn.untitled_page"},thisWorkspace:{defaultMessage:"this workspace",id:"auditlog.actionNames.eventColumn.thisWorkspace"},otherWorkspace:{defaultMessage:"another workspace",id:"auditlog.actionNames.eventColumn.otherWorkspace"},workspaceLevel:{defaultMessage:"the workspace level",id:"auditlog.actionNames.eventColumn.workspaceLevel"},private:{defaultMessage:"private",id:"auditlog.actionNames.eventColumn.private"},a_file:{defaultMessage:"a file",id:"auditlog.actionNames.eventColumn.a_file"},a_file_with_extension:{defaultMessage:"a {extension} file",id:"auditlog.actionNames.eventColumn.a_file_with_extension"},team:{defaultMessage:"teamspace",id:"auditlog.actionNames.eventColumn.team"},for_a_private_team:{defaultMessage:"for a private teamspace",id:"auditlog.actionNames.eventColumn.for_private_team"},a_private_team:{defaultMessage:"a private teamspace",id:"auditlog.actionNames.eventColumn.private_team"},a_team_and_page:{defaultMessage:"a teamspace and page",id:"auditlog.actionNames.eventColumn.team_and_page"},team_member:{defaultMessage:"teamspace member",id:"auditlog.actionNames.eventColumn.team_member"},team_owner:{defaultMessage:"teamspace owner",id:"auditlog.actionNames.eventColumn.team_owner"},team_level_guest:{defaultMessage:"teamspace guest",id:"auditlog.actionNames.eventColumn.team_level_guest"},group:{defaultMessage:"group",id:"auditlog.actionNames.eventColumn.group"},user:{defaultMessage:"user",id:"auditLogEntry.user.noName"},bot:{defaultMessage:"integration",id:"auditLogEntry.bot.noName"},externalIntegration:{defaultMessage:"connection",id:"auditLogEntry.externalIntegration.noName"},guestIntegration:{defaultMessage:"integration",id:"auditLogEntry.guestIntegration.noName"},adminContentSearchQuery:{defaultMessage:"query=“{query}“",id:"auditLogEntry.adminContentSearch.query"},adminContentSearchAudience:{defaultMessage:"audience=“{audience}“",id:"auditLogEntry.adminContentSearch.audience"},adminContentSearchCreatedBy:{defaultMessage:"created by=“{createdBy}“",id:"auditLogEntry.adminContentSearch.createdBy"},adminContentSearchSharedWith:{defaultMessage:"shared with=“{sharedWith}“",id:"auditLogEntry.adminContentSearch.sharedWith"},adminContentSearchTeamspaces:{defaultMessage:"{teamspaceCount, plural, one {teamspace=“{teamspaces}“} other {teamspaces=“{teamspaces}“}}",id:"auditLogEntry.adminContentSearch.teamspace"},adminContentSearchCreatedTime:{defaultMessage:"created time=“{createdTime}“",id:"auditLogEntry.adminContentSearch.createdTime"},adminContentSearchLastEditedTime:{defaultMessage:"last edited time=“{lastEditedTime}“",id:"auditLogEntry.adminContentSearch.lastEditedTime"},adminContentSearchPredicateSplit:{defaultMessage:", ",id:"auditLogEntry.adminContentSearch.predicateSplit"},from:{defaultMessage:"from",id:"auditLogEntry.spaceContentDuplication.from"},into:{defaultMessage:"into",id:"auditLogEntry.spaceContentDuplication.into"}});function fs(e,t){if(t.target)return"user"in t.target&&t.target.user?ys(e,t.target.user):"bot"in t.target&&t.target.bot?vs(e,t.target.bot):"group"in t.target&&t.target.group?t.target.group.name?`“${t.target.group.name}“`:"group":void 0}function ys(e,t){return t?t.name&&t.email?`“${t.name}“ (${t.email})`:t.name?`“${t.name}“`:t.email?`“${t.email}“`:e.formatMessage(hs.user):e.formatMessage(hs.user)}function vs(e,t){return t.name?`“${t.name}“`:e.formatMessage(hs.bot)}function xs(e,t){return t.name?`“${t.name}“`:"guest"===t.type?e.formatMessage(hs.guestIntegration):"external"===t.type?e.formatMessage(hs.externalIntegration):void(0,_.t1)(t.type)}const Ss=(0,g.defineMessages)({started:{id:"space.spaceContentDuplicationStatus.started",defaultMessage:"Started"},completed:{id:"space.spaceContentDuplicationStatus.completed",defaultMessage:"Completed"},failed:{id:"space.spaceContentDuplicationStatus.failed",defaultMessage:"Failed"}}),bs=(0,g.defineMessages)({equallyRestrictive:{defaultMessage:". This is the same as the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_equal"},moreRestrictive:{defaultMessage:". This is more restrictive than the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_more_restrictive"},lessRestrictive:{defaultMessage:". This is less restrictive than the current workspace setting",id:"auditlog.actionNames.eventColumn.team_guests_toggled.team_space_less_restrictive"}});function Ms(e,t){if(void 0!==e&&void 0!==t)return e===t?(0,r.jsx)(g.FormattedMessage,{...bs.equallyRestrictive}):!e&&t?(0,r.jsx)(g.FormattedMessage,{...bs.moreRestrictive}):e&&!t?(0,r.jsx)(g.FormattedMessage,{...bs.lessRestrictive}):void 0}function ws(e){return e.name?`“${e.name}“ group`:(0,r.jsx)(g.FormattedMessage,{...hs.group})}function js(e){return e.changes.name.oldValue&&e.changes.name.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"from “{oldTeamName}“ to “{newTeamName}“",id:"auditlog.actionNames.eventColumn.from_old_team_name_to_new_team_name",values:{oldTeamName:e.changes.name.oldValue,newTeamName:e.changes.name.newValue}}):!e.changes.name.oldValue&&e.changes.name.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"from some teamspace name to “{newTeamName}“",id:"auditlog.actionNames.eventColumn.from_unknown_team_name_to_new_team_name",values:{newTeamName:e.changes.name.newValue}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"for {teamName}",id:"auditlog.actionNames.eventColumn.for_team_name",values:{teamName:Cs(e)}})}function Cs(e){return"team"in e.target?ks(e.target.team):(0,r.jsx)(g.FormattedMessage,{...hs.team})}function ks(e){return e.name?`“${e.name}“ teamspace`:(0,r.jsx)(g.FormattedMessage,{...hs.team})}function _s(e){if(e)switch(e){case"owner":return(0,r.jsx)(g.FormattedMessage,{...hs.team_owner});case"member":return(0,r.jsx)(g.FormattedMessage,{...hs.team_member});case"team_level_guest":return(0,r.jsx)(g.FormattedMessage,{...hs.team_level_guest})}return(0,r.jsx)(g.FormattedMessage,{...hs.team_member})}function Ts(e){return(0,r.jsx)(g.FormattedMessage,{...Is(e)})}function Is(e){if(!e)return ls.mq.noAccessLabel;switch(e){case"editor":return ls.mq.fullAccessLabel;case"membership_admin":case"read_and_write":return ls.mq.canEditLabel;case"content_only_editor":return ls.mq.canEditContentLabel;case"reader":return ls.mq.canReadLabel;case"comment_only":return ls.mq.canCommentLabel;case"none":return ls.mq.noAccessLabel;default:(0,_.t1)(e)}}function Ps(e){var t,s;return{oldRole:(0,r.jsx)(g.FormattedMessage,{...Zs(null===(t=e.changes)||void 0===t||null===(t=t.permission)||void 0===t?void 0:t.oldValue)}),newRole:(0,r.jsx)(g.FormattedMessage,{...Zs(null===(s=e.changes)||void 0===s||null===(s=s.permission)||void 0===s?void 0:s.newValue)})}}const Zs=e=>{if(!e)return ls.mq.noAccessLabel;switch(e){case"editor":return ls.mq.workspaceOwnerLabel;case"membership_admin":return ls.mq.membershipAdminLabel;case"read_and_write":return ls.mq.memberLabel;default:return ls.mq.noAccessLabel}};function Fs(e){return As(e.target.page)}function As(e){return e.title?`“${e.title}“`:(0,r.jsx)(g.FormattedMessage,{...hs.an_untitled_page})}function Ds(e){var t,s;return null!==(t=e.target)&&void 0!==t&&null!==(t=t.page)&&void 0!==t&&null!==(t=t.meta)&&void 0!==t&&t.parent&&"title"in(null===(s=e.target)||void 0===s||null===(s=s.page)||void 0===s||null===(s=s.meta)||void 0===s?void 0:s.parent)?`“${e.target.page.meta.parent.title}“`:(0,r.jsx)(g.FormattedMessage,{...hs.an_untitled_page})}function Bs(e){var t;return null!==(t=e.actor.meta)&&void 0!==t&&t.platform?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"on {platform}",id:"auditlog.actionNames.eventColumn.logged_in_platform",values:{platform:e.actor.meta.platform}}):""}function Rs(e){switch(e){case"google":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Google",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.google"});case"email":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"temporary passcode",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.email"});case"admin":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"admin mode",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.admin"});case"saml":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"SAML SSO",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.saml"});case"apple":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Apple ID",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.apple"});case"password":case"password-no-mfa":case"password-sms":case"password-totp":case"password-backup-code":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"password",id:"auditlog.actionNames.eventColumn.logged_in_auth_type.password"});default:(0,_.t1)(e)}}function Ls(e){return e.changes.name.oldValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"from “{oldDomain}“",id:"auditlog.actionNames.eventColumn.old_domain",values:{oldDomain:e.changes.name.oldValue}}):""}function Ns(e,t){return"block"===e.table?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{teamName} page {parentPage}",id:"auditlog.actionNames.eventColumn.team_parent_page",values:{teamName:ks(t),parentPage:Es(e)}}):"team"===e.table?ks(t):void 0}function Es(e){return"title"in e?`“${e.title}“`:(0,r.jsx)(g.FormattedMessage,{...hs.an_untitled_page})}function Os(e,t){if(!t)return(0,r.jsx)(g.FormattedMessage,{...hs.an_untitled_page});const s=t.table;return"space"===s?t.id!==e?(0,r.jsx)(g.FormattedMessage,{...hs.otherWorkspace}):gs(t.permissionLevel)?(0,r.jsx)(g.FormattedMessage,{...hs.private}):(0,r.jsx)(g.FormattedMessage,{...hs.thisWorkspace}):"team"===s?ks(t):"block"===s?t.title?`“${t.title}“`:(0,r.jsx)(g.FormattedMessage,{...hs.an_untitled_page}):void 0}const Vs=(0,g.defineMessages)({open:{defaultMessage:"Open",id:"auditlog.actionNames.eventColumn.team_privacy_types.open"},closed:{defaultMessage:"Closed",id:"auditlog.actionNames.eventColumn.team_privacy_types.closed"},private:{defaultMessage:"Private",id:"auditlog.actionNames.eventColumn.team_privacy_types.private"},default:{defaultMessage:"Default",id:"auditlog.actionNames.eventColumn.team_privacy_types.default"},unknown:{defaultMessage:"an unknown privacy state",id:"auditlog.actionNames.eventColumn.team_privacy_types.unknown"}});function Us(e){return e?(0,r.jsx)(g.FormattedMessage,{...Vs[e]}):(0,r.jsx)(g.FormattedMessage,{...Vs.unknown})}function Ws(e){return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.membership_requests_toggled.disabled"}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.membership_requests_toggled.enabled"})}function zs(e){return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.external_membership_requests_toggled.disabled"}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.external_membership_requests_toggled.enabled"})}function Ks(e){return"approved"===e.changes.requestStatus.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Approved",id:"auditlog.actionNames.eventColumn.membership_request_resolved.approved"}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Declined",id:"auditlog.actionNames.eventColumn.membership_request_resolved.declined"})}function Hs(e){return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled.disabled"}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled.enabled"})}function Gs(e){return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled",id:"auditlog.actionNames.eventColumn.ai_admin_legal_acceptance_toggled.disabled"}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled",id:"auditlog.actionNames.eventColumn.ai_admin_legal_acceptance_toggled.enabled"})}function qs(e,t){return t?e.formatMessage(hs.enabled):e.formatMessage(hs.disabled)}const Ys=(0,g.defineMessages)({team_members:{defaultMessage:"any teamspace member",id:"auditlog.actionNames.eventColumn.team_access_level_types.team_members"},team_owners:{defaultMessage:"only teamspace owners",id:"auditlog.actionNames.eventColumn.team_access_level_types.team_owners"},unknown:{defaultMessage:"unknown",id:"auditlog.actionNames.eventColumn.team_access_level_types.unknown"}});function Qs(e){return"recurrence"===e?(0,r.jsx)(g.FormattedMessage,{id:"auditlog.actionNames.eventColumn.automation_type.recurrence",defaultMessage:"a repeating automation"}):(0,r.jsx)(g.FormattedMessage,{id:"auditlog.actionNames.eventColumn.automation_type.automation",defaultMessage:"an automation"})}function $s(e){return!!e.meta&&("inSudoMode"in e.meta&&e.meta.inSudoMode)}function Xs(e,t,s){var i,n,a,o,l,c,u,m,p,h,f,y,v,x,S,b,M,w,j,C,k,T,I,P,Z,F;switch(e.actionName){case"page.properties_edited":{const t=e.meta.propertiesUpdated,s=e.meta.propertiesUpdated.map((e=>`“${e.propertyName}“`)).join(", ");return 1===t.length?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Edited property {properties} on {pageName}",id:"auditlog.actionNames.eventColumn.page_properties_edited.single_property",values:{properties:s,pageName:Fs(e)}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Edited properties {properties} on {pageName}",id:"auditlog.actionNames.eventColumn.page_properties_edited.multiple_properties",values:{properties:s,pageName:Fs(e)}})}case"page.discussion.comment.created":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Commented on {pageName}",id:"auditlog.actionNames.eventColumn.page.discussion.comment.created",values:{pageName:Fs(e)}});case"page.discussion.comment.deleted":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Deleted comment on {pageName}",id:"auditlog.actionNames.eventColumn.page.discussion.comment.deleted",values:{pageName:Fs(e)}});case"page.discussion.comment.updated":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Edited comment on {pageName}",id:"auditlog.actionNames.eventColumn.page.discussion.comment.updated",values:{pageName:Fs(e)}});case"page_edited":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Edited {pageName}",id:"auditlog.actionNames.eventColumn.page_edited",values:{pageName:Fs(e)}});case"page_viewed":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Viewed {pageName}",id:"auditlog.actionNames.eventColumn.page_viewed_under",values:{pageName:Fs(e)}});case"page_deleted":return e.target.page.meta.permanentDeletion?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Permanently deleted {pageName}",id:"auditlog.actionNames.eventColumn.page_permanently_deleted",values:{pageName:Fs(e)}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Deleted {pageName}",id:"auditlog.actionNames.eventColumn.page_deleted",values:{pageName:Fs(e)}});case"page.permanently_deleted":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Permanently deleted {pageName}",id:"auditlog.actionNames.eventColumn.page.permanently_deleted",values:{pageName:Fs(e)}});case"page_restored":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Restored {pageName}",id:"auditlog.actionNames.eventColumn.page_restored",values:{pageName:Fs(e)}});case"page_exported":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Exported {pageName}",id:"auditlog.actionNames.eventColumn.page_exported",values:{pageName:Fs(e)}});case"page_moved":{var A,D,B;const t=null===(A=e.changes)||void 0===A?void 0:A.team,i=e.changes.parent.oldValue,n=e.changes.parent.newValue;let a=Os(e.spaceId,e.changes.parent.oldValue),o=Os(e.spaceId,e.changes.parent.newValue);null!=t&&t.oldValue&&null!=t&&t.newValue&&i&&n&&("block"===i.table||"block"===n.table)?(a=Ns(i,null==t?void 0:t.oldValue),o=Ns(n,null==t?void 0:t.newValue)):"space"===(null===(D=e.changes.parent.oldValue)||void 0===D?void 0:D.table)&&"space"===(null===(B=e.changes.parent.newValue)||void 0===B?void 0:B.table)&&e.changes.parent.oldValue.id===e.changes.parent.newValue.id&&(gs(e.changes.parent.oldValue.permissionLevel)||gs(e.changes.parent.newValue.permissionLevel))&&(a=gs(e.changes.parent.oldValue.permissionLevel)?(0,r.jsx)(g.FormattedMessage,{...hs.private}):(0,r.jsx)(g.FormattedMessage,{...hs.workspaceLevel}),o=gs(e.changes.parent.newValue.permissionLevel)?(0,r.jsx)(g.FormattedMessage,{...hs.private}):(0,r.jsx)(g.FormattedMessage,{...hs.workspaceLevel}));const l=a?s.formatMessage({id:"auditLogEntry.changes.page_moved.old_parent",defaultMessage:" from {oldParentName}"},{oldParentName:a}):"",d=o?s.formatMessage({id:"auditLogEntry.changes.page_moved.new_parent",defaultMessage:" to {newParentName}"},{newParentName:o}):"";return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Moved {pageName}{oldParentMessage}{newParentMessage}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_moved",values:{pageName:Fs(e),oldParentMessage:l,newParentMessage:d,inSudoMode:$s(e)}})}case"page_permission_updated":return function(e,t){var s,i,n;const a="bot"in t.target,o="space"in t.target,l="team"in t.target,d="group"in t.target,c="user"in t.target&&"guest"===(null===(s=t.target.user.meta)||void 0===s?void 0:s.spaceRole);var u,m;if(a)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for bot {botName} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_bot",values:{botName:fs(e,t),oldRole:Ts(null===(u=t.changes)||void 0===u||null===(u=u.permission)||void 0===u?void 0:u.oldValue),newRole:Ts(null===(m=t.changes)||void 0===m||null===(m=m.permission)||void 0===m?void 0:m.newValue),pageName:Fs(t),inSudoMode:$s(t)}});var p,h,f,y,v,x;if(o)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for everyone in the workspace from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_space",values:{oldRole:Ts(null===(p=t.changes)||void 0===p||null===(p=p.permission)||void 0===p?void 0:p.oldValue),newRole:Ts(null===(h=t.changes)||void 0===h||null===(h=h.permission)||void 0===h?void 0:h.newValue),pageName:Fs(t),inSudoMode:$s(t)}});if(l)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for {teamName} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_team",values:{oldRole:Ts(null===(f=t.changes)||void 0===f||null===(f=f.permission)||void 0===f?void 0:f.oldValue),newRole:Ts(null===(y=t.changes)||void 0===y||null===(y=y.permission)||void 0===y?void 0:y.newValue),pageName:Fs(t),teamName:Cs(t),inSudoMode:$s(t)}});if(c)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for guest {guestNameAndEmail} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_guest",values:{guestNameAndEmail:fs(e,t),oldRole:Ts(null===(v=t.changes)||void 0===v||null===(v=v.permission)||void 0===v?void 0:v.oldValue),newRole:Ts(null===(x=t.changes)||void 0===x||null===(x=x.permission)||void 0===x?void 0:x.newValue),pageName:Fs(t),inSudoMode:$s(t)}});if(d){var S,b;return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for group {groupName} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_group",values:{groupName:fs(e,t),oldRole:Ts(null===(S=t.changes)||void 0===S||null===(S=S.permission)||void 0===S?void 0:S.oldValue),newRole:Ts(null===(b=t.changes)||void 0===b||null===(b=b.permission)||void 0===b?void 0:b.newValue),pageName:Fs(t),inSudoMode:$s(t)}})}return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated permissions of {pageName} for {memberNameAndEmail} from {oldRole} to {newRole}{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_permissions_updated_workspace_default",values:{memberNameAndEmail:fs(e,t),oldRole:Ts(null===(i=t.changes)||void 0===i||null===(i=i.permission)||void 0===i?void 0:i.oldValue),newRole:Ts(null===(n=t.changes)||void 0===n||null===(n=n.permission)||void 0===n?void 0:n.newValue),pageName:Fs(t),inSudoMode:$s(t)}})}(s,e);case"page_created":const O=K(e);if(null!=O&&null!==(i=O.meta)&&void 0!==i&&i.parent){var R,L,N,E;if(O.meta.parent.table===us.bx)return"private"===(null===(N=O.meta)||void 0===N?void 0:N.permissionLevel)||"private"===(null===(E=O.meta)||void 0===E?void 0:E.pageAudience)?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Created a private page",id:"auditlog.actionNames.eventColumn.page_created_private"}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Created a page in the workspace",id:"auditlog.actionNames.eventColumn.page_created_workspace"});if((null===(R=O.meta)||void 0===R?void 0:R.parent.table)===ms.e0)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Created a page under {teamName}",id:"auditlog.actionNames.eventColumn.page_created_team",values:{teamName:ks(O.meta.parent)}});if((null===(L=O.meta)||void 0===L?void 0:L.parent.table)===ds.iU)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Created a page under {parentPageName}",id:"auditlog.actionNames.eventColumn.page_created_under",values:{parentPageName:Ds(e)}})}return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Created a page",id:"auditlog.actionNames.eventColumn.page_created_general"});case"page_shared_to_web":return function(e){var t;if(void 0===e.changes.permission.newValue||"none"===e.changes.permission.newValue)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled sharing {pageName} to web{inSudoMode, select, true { using administrator privileges} other {}}",id:"auditlog.actionNames.eventColumn.page_shared_to_web.disabled",values:{pageName:Fs(e),inSudoMode:$s(e)}});return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled sharing {pageName} to web{inSudoMode, select, true { using administrator privileges} other {}} with permissions {newRole}",id:"auditlog.actionNames.eventColumn.page_shared_to_web.enabled",values:{pageName:Fs(e),inSudoMode:$s(e),newRole:Ts(null===(t=e.changes)||void 0===t||null===(t=t.permission)||void 0===t?void 0:t.newValue)}})}(e);case"login":return function(e,t){var s,i,n;const a=null===(s=e.meta)||void 0===s?void 0:s.authType;return null!==(i=e.actor.meta)&&void 0!==i&&i.countryCode&&a?(0,r.jsx)(g.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithCityStateAndCountry.withAuthType",defaultMessage:"Logged in {platform} via {loginMethod} in {geolocation}",values:{platform:Bs(e),geolocation:wt(e,t),loginMethod:Rs(a)}}):null!==(n=e.actor.meta)&&void 0!==n&&n.countryCode&&!a?(0,r.jsx)(g.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithCityStateAndCountry",defaultMessage:"Logged in {platform} in {geolocation}",values:{platform:Bs(e),geolocation:wt(e,t)}}):a?(0,r.jsx)(g.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithPlatform.withAuthType",defaultMessage:"Logged in {platform} via {loginMethod}",values:{platform:Bs(e),loginMethod:Rs(a)}}):(0,r.jsx)(g.FormattedMessage,{id:"auditLog.actionNames.eventColumn.loginWithPlatform",defaultMessage:"Logged in {platform}",values:{platform:Bs(e)}})}(e,s);case"allowed_support_access":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Granted support access for {name} until {date}",id:"auditlog.actionNames.allowed_support_access",values:{date:s.formatDate(e.changes.expiresAt),name:e.target.user.name}});case"revoked_support_access":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Revoked support access for {name}",id:"auditlog.actionNames.revoked_support_access",values:{name:e.target.user.name}});case"preferred_name_changed":return function(e,t){var s;const i=!!e.target&&e.actor.actorId!==(null===(s=e.target)||void 0===s?void 0:s.user.id),n=e.changes.name.oldValue,a=e.changes.name.newValue;if(i){if(n&&a)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed {memberNameAndEmail} name from “{oldValue}“ to “{newValue}“",id:"auditlog.actionNames.eventColumn.external_preferred_name_changed",values:{memberNameAndEmail:fs(t,e),oldValue:n,newValue:a}});if(!n&&a)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Set {memberNameAndEmail} name to “{newValue}“",id:"auditlog.actionNames.eventColumn.external_preferred_name_changed_to_value",values:{memberNameAndEmail:fs(t,e),newValue:a}});if(n&&!a)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} name “{oldValue}“",id:"auditlog.actionNames.eventColumn.external_preferred_name_changed_from_value",values:{memberNameAndEmail:fs(t,e),oldValue:n}})}if(n&&a)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed name from “{oldValue}“ to “{newValue}“",id:"auditlog.actionNames.eventColumn.preferred_name_changed",values:{oldValue:n,newValue:a}});if(!n&&a)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Set name to “{newValue}“",id:"auditlog.actionNames.eventColumn.preferred_name_changed_to_value",values:{newValue:a}});if(n&&!a)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Removed name “{oldValue}“",id:"auditlog.actionNames.eventColumn.preferred_name_changed_from_value",values:{oldValue:n}});return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Name was changed",id:"auditlog.actionNames.eventColumn.preferred_name_changed_generic"})}(e,s);case"email_changed":return function(e,t){var s;return e.target&&e.actor.actorId!==(null===(s=e.target)||void 0===s?void 0:s.user.id)?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed {memberNameAndEmail} email from {oldEmail} to {newEmail}",id:"auditlog.actionNames.eventColumn.external_email_changed",values:{memberNameAndEmail:fs(t,e),oldEmail:e.changes.email.oldValue,newEmail:e.changes.email.newValue}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed email from {oldEmail} to {newEmail}",id:"auditlog.actionNames.eventColumn.email_changed",values:{oldEmail:e.changes.email.oldValue,newEmail:e.changes.email.newValue}})}(e,s);case"picture_changed":return function(e,t){var s;return e.target&&e.actor.actorId!==(null===(s=e.target)||void 0===s?void 0:s.user.id)?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed {memberNameAndEmail} profile picture",id:"auditlog.actionNames.eventColumn.external_picture_changed",values:{memberNameAndEmail:fs(t,e)}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed profile picture",id:"auditlog.actionNames.eventColumn.picture_changed"})}(e,s);case"member_invited":{const t=Ps(e);return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Invited {memberNameAndEmail} to the workspace as {newRole}",id:"auditlog.actionNames.eventColumn.member_invited",values:{memberNameAndEmail:fs(s,e),newRole:t.newRole}})}case"member_role_updated":{const t=Ps(e);return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.member_role_updated",values:{memberNameAndEmail:fs(s,e),oldRole:t.oldRole,newRole:t.newRole}})}case"member_removed":return e.actor.actorId===e.target.user.id?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Left the workspace",id:"auditlog.actionNames.eventColumn.member_left"}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from the workspace",id:"auditlog.actionNames.eventColumn.member_removed",values:{memberNameAndEmail:fs(s,e)}});case"guest_removed":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Removed guest {guestNameAndEmail} from the workspace",id:"auditlog.actionNames.eventColumn.guest_removed",values:{guestNameAndEmail:fs(s,e)}});case"file_uploaded":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Uploaded a file to {pageName}",id:"auditlog.actionNames.eventColumn.file_uploaded_public",values:{pageName:Fs(e)}});case"file_downloaded":return function(e){return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Downloaded {fileName} from {pageName}",id:"auditlog.actionNames.eventColumn.file_downloaded",values:{fileName:Js(e),pageName:Fs(e)}})}(e);case"invite_link_toggled":return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{id:"auditlog.actionNames.eventColumn.inviteLink.enabled",defaultMessage:"Enabled invite link"}):(0,r.jsx)(g.FormattedMessage,{id:"auditlog.actionNames.eventColumn.inviteLink.disabled",defaultMessage:"Disabled invite link"});case"public_page_sharing_toggled":case"workspace_sidebar_editing_toggled":case"disable_team_guests_toggled":case"disable_guests_toggled":case"pages_to_other_workspaces_toggled":case"export_toggled":case"page_access_requests_toggled":return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{id:"auditlog.actionNames.eventColumn.toggleEvent.disabled",defaultMessage:"Disabled {workspaceSetting}",values:{workspaceSetting:s.formatMessage(hs[e.actionName])}}):(0,r.jsx)(g.FormattedMessage,{id:"auditlog.actionNames.eventColumn.toggleEvent.enabled",defaultMessage:"Enabled {workspaceSetting}",values:{workspaceSetting:s.formatMessage(hs[e.actionName])}});case"workspace_name_changed":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed workspace name from “{oldValue}“ to “{newValue}“",id:"auditlog.actionNames.eventColumn.workspace_name_changed",values:{oldValue:e.changes.name.oldValue,newValue:e.changes.name.newValue}});case"workspace_domain_changed":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed workspace domain {oldValue} to “{newValue}“",id:"auditlog.actionNames.eventColumn.workspace_domain_changed",values:{oldValue:Ls(e),newValue:e.changes.name.newValue}});case"workspace_integration_restriction_changed":return function(e){const t=void 0,{oldValue:s,newValue:i}=e.changes.integration_restrictions;if(i===t)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled members installing integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.no_restrictions"});if(s===t&&"approved_only"===i)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled members installing integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.approved_only"});if("approved_or_built_by_notion"===s&&"approved_only"===i)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled auto approval for built-by-Notion integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.disabled_built_by_notion.from_approved_or_built_by_notion"});if("approved_only"===s&&"approved_or_built_by_notion"===i)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled auto approval for built-by-Notion integrations",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.enabled_built_by_notion"});return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed workspace integration restriction",id:"auditlog.actionNames.eventColumn.workspace_integration_restriction_changed.fallback_message"})}(e);case"allowed_email_domain_added":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Added “{addedValue}“ into allowable email domains",id:"auditlog.actionNames.eventColumn.allowed_email_domain_added",values:{addedValue:e.changes.domain}});case"allowed_email_domain_removed":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Removed “{removedValue}“ from allowable email domains",id:"auditlog.actionNames.eventColumn.allowed_email_domain_removed",values:{removedValue:e.changes.domain}});case"public_page_set":return e.changes.name.oldValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed public home page from “{oldPage}“ to “{newPage}“",id:"auditlog.actionNames.eventColumn.public_page_changed",values:{oldPage:e.changes.name.oldValue,newPage:e.changes.name.newValue}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Set “{newPage}“ as public home page",id:"auditlog.actionNames.eventColumn.public_page_set",values:{newPage:e.changes.name.newValue}});case"idp_metadata_url_updated":return e.changes.url.oldValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed IDP metadata URL from “{oldValue}“ to “{newValue}“",id:"auditlog.actionNames.eventColumn.idp_metadata_url_updated",values:{oldValue:e.changes.url.oldValue,newValue:e.changes.url.newValue}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Set IDP metadata URL to “{newValue}“",id:"auditlog.actionNames.eventColumn.idp_metadata_url_set",values:{newValue:e.changes.url.newValue}});case"saml_toggled":return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{...hs.saml_enabled}):(0,r.jsx)(g.FormattedMessage,{...hs.saml_disabled});case"saml_enforce_toggled":return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{...hs.saml_enforced}):(0,r.jsx)(g.FormattedMessage,{...hs.saml_unenforced});case"automatic_account_creation_toggled":return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{...hs.automatic_account_creation_enabled}):(0,r.jsx)(g.FormattedMessage,{...hs.automatic_account_creation_disabled});case"workspace_analytics_toggled":return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{...hs.workspace_analytics_enabled}):(0,r.jsx)(g.FormattedMessage,{...hs.workspace_analytics_disabled});case"workspace_creation_set_for_email_domain":return function(e,t){const{oldValue:s,newValue:i}=e.changes.workspace_creation;if(!s&&!i)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed workspace creation setting",id:"auditlog.actionNames.eventColumn.workspace_creation_set_for_email_domain.fallback_message"});const n=e.changes.workspace_creation.oldValue?t.formatMessage({id:"auditLogEntry.changes.workspaceCreation.beforeSetting",defaultMessage:" from {prevWorkspaceCreationSetting}"},{prevWorkspaceCreationSetting:(0,cs.nJ)(e.changes.workspace_creation.oldValue,t)}):"",a=e.changes.workspace_creation.newValue?t.formatMessage({id:"auditLogEntry.changes.workspaceCreation.afterSetting",defaultMessage:" to {afterWorkspaceCreationSetting}"},{afterWorkspaceCreationSetting:(0,cs.nJ)(e.changes.workspace_creation.newValue,t)}):"";return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed workspace creation setting{before}{after}.",id:"auditlog.actionNames.eventColumn.workspace_creation_set_for_email_domain",values:{before:n,after:a}})}(e,s);case"member_added_to_group":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Added {memberNameAndEmail} to {groupName}",id:"auditlog.actionNames.eventColumn.member_added_to_group",values:{memberNameAndEmail:fs(s,e),groupName:ws(e.target.group)}});case"member_removed_from_group":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from {groupName}",id:"auditlog.actionNames.eventColumn.member_removed_from_group",values:{memberNameAndEmail:fs(s,e),groupName:ws(e.target.group)}});case"space_transfer_status_changed":return function(e,t){const{oldValue:s,newValue:i}=e.changes.spaceTransferStatus,n=e.target.space.name?t.formatMessage({id:"auditLogEntry.changes.space_transfer_status_changed.space_name",defaultMessage:" for {spaceName}"},{spaceName:e.target.space.name}):"";if(!s&&!i)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Workspace transfer status changed{spaceNameMessage}",id:"auditlog.actionNames.eventColumn.space_transfer_status_changed.fallback_message",values:{spaceNameMessage:n}});if(!i)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Workspace transfer request cleared{spaceNameMessage} from prior status of {oldStatus}",id:"auditlog.actionNames.eventColumn.space_transfer_status_cleared",values:{spaceNameMessage:n,oldStatus:s}});return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{newStatus, select, requested {Workspace transfer request initiated{spaceNameMessage}.} started {Workspace transfer started{spaceNameMessage}} completed {Workspace transfer completed{spaceNameMessage}} other {Workspace transfer status change to {newStatus}{spaceNameMessage}}}",id:"auditlog.actionNames.eventColumn.space_transfer_status_changed.newStatus",values:{spaceNameMessage:n,newStatus:i}})}(e,s);case"space_claim_and_upgrade_status_changed":return function(e){const{oldValue:t,newValue:s}=e.changes.claimAndUpgradeStatus,i=(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Status changed for workspace claim of {workspaceName}",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_status_changed.fallback_message",values:{workspaceName:e.target.space.name}});if(!t&&!s)return i;if(!s&&"completed"!==t)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Pending workspace claim for {workspaceName} has been cleared from {oldStatus}",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_status_cleared",values:{workspaceName:e.target.space.name,oldStatus:t}});if("completed"===s)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{workspaceName} has been claimed and upgraded to the Enterprise plan",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_status_completed",values:{workspaceName:e.target.space.name}});if("requested"===s)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Request to claim and upgrade {workspaceName} has been sent.",id:"auditlog.actionNames.eventColumn.space_claim_upgrade_requested",values:{workspaceName:e.target.space.name}});return i}(e);case"space_claim_deletion_status_changed":return function(e){const{oldValue:t,newValue:s}=e.changes.claimDeletionStatus,i=(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Claimable workspace deletion status change for {spaceName}",id:"auditlog.actionNames.eventColumn.space_claim_deletion_status_changed.fallback_message",values:{spaceName:e.target.space.name}});if(!t&&!s)return i;if(!s||"canceled"===s)return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Recovered workspace {spaceName} using Domain Management",id:"auditlog.actionNames.eventColumn.space_claim_deletion.status_cleared",values:{spaceName:e.target.space.name}});return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Deleted workspace {spaceName} using Domain Management",id:"auditlog.actionNames.eventColumn.space_claim_deletion.deleted",values:{spaceName:e.target.space.name}})}(e);case"membership_requests_toggled":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{enabled} allowing members to request adding new members",id:"auditlog.actionNames.eventColumn.membership_requests_toggled",values:{enabled:Ws(e)}});case"external_membership_requests_toggled":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{enabled} allowing external users to request to be added to the workspace as members",id:"auditlog.actionNames.eventColumn.external_membership_requests_toggled",values:{enabled:zs(e)}});case"membership_request_resolved":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{status} request to add {email} to the workspace as a member",id:"auditlog.actionNames.eventColumn.membership_request_resolved",values:{status:Ks(e),email:fs(s,e)}});case"guest_membership_requests_toggled":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{enabled} allowing page guests to request to be added to the workspace as members",id:"auditlog.actionNames.eventColumn.guest_membership_requests_toggled",values:{enabled:Hs(e)}});case"team_created":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Created {teamName}",id:"auditlog.actionNames.eventColumn.team_created",values:{teamName:Cs(e)}});case"team_archived":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Archived {teamName}",id:"auditlog.actionNames.eventColumn.team_archived",values:{teamName:Cs(e)}});case"team_restored":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Restored {teamName}",id:"auditlog.actionNames.eventColumn.team_restored",values:{teamName:Cs(e)}});case"team_default_toggled":return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Added {teamName} to the default teamspace list. Workspace members will automatically be added to the teamspace",id:"auditlog.actionNames.eventColumn.team_default_enabled",values:{teamName:Cs(e)}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Removed {teamName} from the default teamspace list. Workspace members will no longer be automatically added to the teamspace",id:"auditlog.actionNames.eventColumn.team_default_disabled",values:{teamName:Cs(e)}});case"team_public_page_sharing_toggled":return e.changes.enabled.newValue?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled members sharing pages under {teamName} publicly",id:"auditlog.actionNames.eventColumn.team_public_page_sharing_disabled",values:{teamName:Cs(e)}}),Ms((null===(n=e.meta)||void 0===n?void 0:n.spacePublicPageSharingDisabled)??(null==e?void 0:e.spacePublicPageSharingDisabled),e.changes.enabled.newValue)]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled members sharing pages under {teamName} publicly",id:"auditlog.actionNames.eventColumn.team_public_page_sharing_enabled",values:{teamName:Cs(e)}}),Ms((null===(a=e.meta)||void 0===a?void 0:a.spacePublicPageSharingDisabled)??(null==e?void 0:e.spacePublicPageSharingDisabled),e.changes.enabled.newValue)]});case"team_export_toggled":return e.changes.enabled.newValue?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled export for {teamName}",id:"auditlog.actionNames.eventColumn.team_export_disabled",values:{teamName:Cs(e)}}),Ms((null===(o=e.meta)||void 0===o?void 0:o.spaceExportDisabled)??(null==e?void 0:e.spaceExportDisabled),e.changes.enabled.newValue)]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled export for {teamName}",id:"auditlog.actionNames.eventColumn.team_export_enabled",values:{teamName:Cs(e)}}),Ms((null===(l=e.meta)||void 0===l?void 0:l.spaceExportDisabled)??(null==e?void 0:e.spaceExportDisabled),e.changes.enabled.newValue)]});case"team_sidebar_editing_toggled":return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled members changing the sidebar section for {teamName}",id:"auditlog.actionNames.eventColumn.team_sidebar_editing_disabled",values:{teamName:Cs(e)}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled members changing the sidebar section for {teamName}",id:"auditlog.actionNames.eventColumn.team_sidebar_editing_enabled",values:{teamName:Cs(e)}});case"team_creation_admins_setting_toggled":return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled members creating teamspaces",id:"auditlog.actionNames.eventColumn.team_creation_admins_setting_disabled",values:{teamName:Cs(e)}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled members creating teamspaces",id:"auditlog.actionNames.eventColumn.team_creation_admins_setting_enabled",values:{teamName:Cs(e)}});case"team_guests_toggled":return e.changes.enabled.newValue?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled guests for {teamName}",id:"auditlog.actionNames.eventColumn.team_guests_toggled_disabled",values:{teamName:Cs(e)}}),Ms((null===(c=e.meta)||void 0===c?void 0:c.spaceDisableGuests)??e.spaceDisableGuests,e.changes.enabled.newValue)]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled guests for {teamName}",id:"auditlog.actionNames.eventColumn.team_guests_toggled_enabled",values:{teamName:Cs(e)}}),Ms((null===(u=e.meta)||void 0===u?void 0:u.spaceDisableGuests)??e.spaceDisableGuests,e.changes.enabled.newValue)]});case"team_name_changed":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed teamspace name {oldTeamNameToNewTeamName}",id:"auditlog.actionNames.eventColumn.team_name_changed",values:{oldTeamNameToNewTeamName:js(e)}});case"team_description_changed":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed description of {teamName}",id:"auditlog.actionNames.eventColumn.team_description_changed",values:{teamName:Cs(e)}});case"team_icon_changed":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed icon of {teamName}",id:"auditlog.actionNames.eventColumn.team_icon_changed",values:{teamName:Cs(e)}});case"member_added_to_team":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Invited {memberNameAndEmail} to {teamName} as {teamRole}",id:"auditlog.actionNames.eventColumn.member_added_to_team",values:{memberNameAndEmail:fs(s,e),teamName:Cs(e),teamRole:_s(e.changes.teamRole.newValue)}});case"group_added_to_team":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Invited {groupName} to {teamName} as teamspace member",id:"auditlog.actionNames.eventColumn.group_added_to_team",values:{groupName:ws(e.target.group),teamName:Cs(e)}});case"member_removed_from_team":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Removed {memberNameAndEmail} from {teamName}",id:"auditlog.actionNames.eventColumn.member_removed_from_team",values:{memberNameAndEmail:fs(s,e),teamName:Cs(e)}});case"group_removed_from_team":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Removed {groupName} from {teamName}",id:"auditlog.actionNames.eventColumn.group_removed_from_team",values:{groupName:ws(e.target.group),teamName:Cs(e)}});case"member_joined_team":const V=Cs(e),U=_s(e.changes.teamRole.newValue);return $s(e)?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Joined {teamName} as {teamRole} using administrator privileges",id:"auditlog.actionNames.eventColumn.member_joined_team_privileged",values:{teamName:V,teamRole:U}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Joined {teamName} as {teamRole}",id:"auditlog.actionNames.eventColumn.member_joined_team",values:{teamName:V,teamRole:U}});case"member_left_team":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Left {teamName}",id:"auditlog.actionNames.eventColumn.member_left_team",values:{teamName:Cs(e)}});case"member_team_role_updated":const W=fs(s,e),z=_s(e.changes.teamRole.oldValue),H=_s(e.changes.teamRole.newValue),G=Cs(e);return $s(e)?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldTeamRole} to {newTeamRole} in {teamName} using administrator privileges",id:"auditlog.actionNames.eventColumn.member_team_role_updated_privileged",values:{memberNameAndEmail:W,oldTeamRole:z,newTeamRole:H,teamName:G}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated {memberNameAndEmail} from {oldTeamRole} to {newTeamRole} in {teamName}",id:"auditlog.actionNames.eventColumn.member_team_role_updated",values:{memberNameAndEmail:W,oldTeamRole:z,newTeamRole:H,teamName:G}});case"team_user_permission_updated":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated {userNameOrEmail}’s custom permissions in {teamName} from {oldPermission} to {newPermission}.",id:"auditlog.actionNames.eventColumn.team_user_permission_updated",values:{userNameOrEmail:fs(s,e),oldPermission:Ts(e.changes.permission.oldValue),newPermission:Ts(e.changes.permission.newValue),teamName:Cs(e)}});case"team_group_permission_updated":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated {groupName}’s custom permissions in {teamName} from {oldPermission} to {newPermission}.",id:"auditlog.actionNames.eventColumn.team_group_permission_updated",values:{groupName:ws(e.target.group),oldPermission:Ts(e.changes.permission.oldValue),newPermission:Ts(e.changes.permission.newValue),teamName:Cs(e)}});case"team_member_default_permission_updated":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated default page permissions for teamspace members in {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_member_default_permission_updated",values:{teamName:Cs(e),oldRole:Ts(null===(m=e.changes)||void 0===m||null===(m=m.permission)||void 0===m?void 0:m.oldValue),newRole:Ts(null===(p=e.changes)||void 0===p||null===(p=p.permission)||void 0===p?void 0:p.newValue)}});case"team_guest_default_permission_updated":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated default page permissions for teamspace guests in {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_guest_default_permission_updated",values:{teamName:Cs(e),oldRole:Ts(null===(h=e.changes)||void 0===h||null===(h=h.permission)||void 0===h?void 0:h.oldValue),newRole:Ts(null===(f=e.changes)||void 0===f||null===(f=f.permission)||void 0===f?void 0:f.newValue)}});case"team_workspace_default_permission_updated":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Updated default page permissions for everyone else in the workspace for {teamName} from {oldRole} to {newRole}",id:"auditlog.actionNames.eventColumn.team_workspace_default_permission_updated",values:{teamName:Cs(e),oldRole:Ts(null===(y=e.changes)||void 0===y||null===(y=y.permission)||void 0===y?void 0:y.oldValue),newRole:Ts(null===(v=e.changes)||void 0===v||null===(v=v.permission)||void 0===v?void 0:v.newValue)}});case"team_privacy_type_changed":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed the teamspace privacy type for {teamName} from {oldType} to {newType}",id:"auditlog.actionNames.eventColumn.team_privacy_type_changed",values:{teamName:Cs(e),oldType:Us(null===(x=e.changes)||void 0===x?void 0:x.teamAccessLevel.oldValue),newType:Us(null===(S=e.changes)||void 0===S?void 0:S.teamAccessLevel.newValue)}});case"team_invite_access_changed":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed who can invite teamspace members to {newType} for {teamName}",id:"auditlog.actionNames.eventColumn.team_invite_access_changed",values:{teamName:Cs(e),newType:(F=null===(b=e.changes)||void 0===b||null===(b=b.teamInviteAccess)||void 0===b?void 0:b.newValue,F?(0,r.jsx)(g.FormattedMessage,{...Ys[F]}):(0,r.jsx)(g.FormattedMessage,{...Ys.unknown}))}});case"teams_enabled_for_space":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled teamspaces for {workspaceName}",id:"auditlog.actionNames.eventColumn.teams_enabled_for_space",values:{workspaceName:e.target.space.name}});case"private_content_transferred":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Transferred private content from {fromUserName} to {toUserName}",id:"auditLog.actionNames.eventColumn.private_content_transferred",values:{fromUserName:ys(s,e.changes.userPermission.oldValue),toUserName:ys(s,e.changes.userPermission.newValue)}});case"audit_log_exported":return(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.eventColumn.audit_log_exported",defaultMessage:"Exported audit log for last {duration} days",values:{duration:e.meta.duration}});case"user_analytics_exported":return(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.eventColumn.user_analytics_exported",defaultMessage:"Exported user analytics for {daysFilterString}",values:{daysFilterString:s.formatMessage(ps.Rh[(null===(M=e.meta)||void 0===M?void 0:M.daysFilter)||"last_90_days"]).toLowerCase()}});case"content_analytics_exported":return(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.eventColumn.content_analytics_exported",defaultMessage:"Exported content analytics for {daysFilterString}",values:{daysFilterString:s.formatMessage(ps.Rh[(null===(w=e.meta)||void 0===w?void 0:w.daysFilter)||"last_90_days"]).toLowerCase()}});case"admin_content_search_queried":case"admin_content_search_exported":function q(e){return e.join(s.formatMessage(hs.adminContentSearchPredicateSplit))}function Y(e){return"starting"in e&&"ending"in e?`${e.starting} - ${e.ending}`:"starting"in e?`${e.starting} - `:"ending"in e?` - ${e.ending}`:void 0}const Q=e.searchParameters.query&&s.formatMessage(hs.adminContentSearchQuery,{query:e.searchParameters.query}),$=e.searchParameters.teamspaces&&e.searchParameters.teamspaces.length>0&&s.formatMessage(hs.adminContentSearchTeamspaces,{teamspaceCount:e.searchParameters.teamspaces.length,teamspaces:q(e.searchParameters.teamspaces)}),X=e.searchParameters.createdBy&&e.searchParameters.createdBy.length>0&&s.formatMessage(hs.adminContentSearchCreatedBy,{createdBy:q(e.searchParameters.createdBy)}),J=e.searchParameters.sharedWith&&e.searchParameters.sharedWith.length>0&&s.formatMessage(hs.adminContentSearchSharedWith,{sharedWith:q(e.searchParameters.sharedWith)}),ee=e.searchParameters.audience&&e.searchParameters.audience.length>0&&s.formatMessage(hs.adminContentSearchAudience,{audience:q(e.searchParameters.audience)}),te=e.searchParameters.createdTime&&s.formatMessage(hs.adminContentSearchCreatedTime,{createdTime:Y(e.searchParameters.createdTime)}),se=e.searchParameters.lastEditedTime&&s.formatMessage(hs.adminContentSearchLastEditedTime,{lastEditedTime:Y(e.searchParameters.lastEditedTime)}),ie=d.oA([Q,$,X,J,ee,te,se]);if("admin_content_search_queried"===e.actionName){if(0===ie.length)return(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_queried.no_filters",defaultMessage:"Ran a content search with no filters"});{const e=q(ie);return(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_queried",defaultMessage:"Ran a content search with the following criteria: {searchCriteria}",values:{searchCriteria:e}})}}if(0===ie.length)return(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_exported.no_filters",defaultMessage:"Exported a content search result with no filters"});{const e=q(ie);return(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_content_search_exported",defaultMessage:"Exported a content search result with the following criteria: {searchCriteria}",values:{searchCriteria:e}})}case"admin_managed_users_log_out_all":{const t=s.formatList(e.meta.emailDomains,{type:"conjunction"});return(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_managed_users_log_out_all",defaultMessage:"Logged out all managed users with the email domains {emailDomains}",values:{emailDomains:t}})}case"admin_managed_users_log_out_one":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Logged out {guestNameAndEmail} from all of their active sessions",id:"auditlog.actionNames.eventColumn.admin_managed_users_log_out_one",values:{guestNameAndEmail:fs(s,e)}});case"admin_managed_users_password_cleared_one":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Reset the password and MFA settings for {guestNameAndEmail} and logged them out of their active sessions",id:"auditlog.actionNames.eventColumn.admin_managed_users_password_cleared_one",values:{guestNameAndEmail:fs(s,e)}});case"admin_managed_users_password_cleared":{const t=s.formatList(e.meta.emailDomains,{type:"conjunction"});return(0,r.jsx)(g.FormattedMessage,{id:"auditlogEventFilter.eventColumn.admin_managed_users_password_cleared",defaultMessage:"Cleared passwords for all users with the email domains {emailDomains}",values:{emailDomains:t}})}case"automation_created":return(0,r.jsx)(g.FormattedMessage,{id:"auditlog.actionNames.eventColumn.automation_created",defaultMessage:"Created {automationType} on {pageTitle}",values:{automationType:Qs(e.meta.automationType),pageTitle:Fs(e)}});case"automation_edited":return(0,r.jsx)(g.FormattedMessage,{id:"auditlog.actionNames.eventColumn.automation_edited",defaultMessage:"Edited {automationType} on {pageTitle}",values:{automationType:Qs(e.meta.automationType),pageTitle:Fs(e)}});case"ai_admin_legal_acceptance_toggled":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{enabled} Notion AI for the workspace.",id:"auditlog.actionNames.eventColumn.ai_admin_legal_acceptance_toggled",values:{enabled:Gs(e)}});case"space_consolidation_started":case"space_consolidation_completed":case"space_consolidation_failed":const ne=e.spaceId===e.meta.spaceConsolidationMetadata.source_space_id,ae=e.meta.spaceConsolidationMetadata.source_space_name??e.meta.spaceConsolidationMetadata.source_space_id,oe=e.meta.spaceConsolidationMetadata.target_space_name??e.meta.spaceConsolidationMetadata.target_space_id,re=e.changes.spaceContentDuplicationStatus.newValue;return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{status} workspace consolidation {direction} {spaceName}.",id:"auditlog.actionNames.eventColumn.space_consolidation_status_changed",values:{status:re?(0,r.jsx)(g.FormattedMessage,{...Ss[re]}):"",spaceName:ne?oe:ae,direction:(0,r.jsx)(g.FormattedMessage,{...ne?hs.into:hs.from})}});case"mfa_sms_toggled":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{enabled} SMS MFA on “{value}“",id:"auditlog.actionNames.eventColumn.mfa_sms_toggled",values:{value:null!==(j=e.changes)&&void 0!==j&&j.maskedPhoneNumber.oldValue?null===(C=e.changes)||void 0===C?void 0:C.maskedPhoneNumber.oldValue:null===(k=e.changes)||void 0===k?void 0:k.maskedPhoneNumber.newValue,enabled:null!==(T=e.changes)&&void 0!==T&&T.enabled.newValue?"Enabled":"Disabled"}});case"mfa_totp_toggled":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{enabled} TOTP MFA",id:"auditlog.actionNames.eventColumn.mfa_totp_toggled",values:{enabled:null!==(I=e.changes)&&void 0!==I&&I.enabled.newValue?"Enabled":"Disabled"}});case"mfa_backup_code_toggled":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{enabled} backup codes for MFA",id:"auditlog.actionNames.eventColumn.mfa_backup_code_toggled",values:{enabled:null!==(P=e.changes)&&void 0!==P&&P.enabled.newValue?"Enabled":"Disabled"}});case"user_suspended":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Suspended {userNameAndEmail}",id:"auditLogEntry.user_suspended",values:{userNameAndEmail:fs(s,e)}});case"user_unsuspended":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Reactivated {userNameAndEmail}",id:"auditLogEntry.user_unsuspended",values:{userNameAndEmail:fs(s,e)}});case"user_deleted":return e.target?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Deleted {userNameAndEmail}",id:"auditLogEntry.user_deleted",values:{userNameAndEmail:ys(s,e.target.user)}}):(0,r.jsx)(g.FormattedMessage,{...hs.user_deleted});case"workspace.settings.prevent_granting_support_access_updated":return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled managed user members' ability to grant support access for their account.",id:"auditLogEntry.workspace_domain_settings_prevent_granting_support_access_updated.enabled"}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled managed user members' ability to grant support access for their account.",id:"auditLogEntry.workspace_domain_settings_prevent_granting_support_access_updated.disabled"});case"workspace.settings.prevent_profile_edits_updated":return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled managed user members' ability to edit their profile information.",id:"auditLogEntry.workspace_domain_settings_prevent_profile_edits_updated.enabled"}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled managed user members' ability to edit their profile information.",id:"auditLogEntry.workspace_domain_settings_prevent_profile_edits_updated.disabled"});case"workspace.settings.external_workspace_access_updated":return e.changes.enabled.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disabled managed user members' ability to join external workspaces.",id:"auditLogEntry.workspace_domain_settings_external_workspace_access_updated.enabled"}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Enabled managed user members' ability to join external workspaces.",id:"auditLogEntry.workspace_domain_settings_external_workspace_access_updated.disabled"});case"workspace.settings.custom_session_duration_updated":return void 0!==e.changes.valueMs.oldValue&&void 0!==e.changes.valueMs.newValue?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed the session duration for all managed users from {oldDuration} to {newDuration}.",id:"auditLogEntry.workspace_domain_settings_session_duration_updated",values:{oldDuration:(0,os.Ct)(e.changes.valueMs.oldValue,s),newDuration:(0,os.Ct)(e.changes.valueMs.newValue,s)}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changed the session duration for all managed users.",id:"auditLogEntry.workspace_domain_settings_session_duration_updated.disabled"});case"integration.created":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Added {botName} to the workspace",id:"auditLogEntry.integration.created",values:{botName:vs(s,e.meta.bot)}});case"integration.deleted":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Removed {botName} from workspace",id:"auditLogEntry.integration.deleted",values:{botName:vs(s,e.meta.bot)}});case"page.automation_deleted":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Deleted automation {automationType} from {pageTitle}",id:"auditLogEntry.page.automation_deleted",values:{automationType:Qs(e.meta.automationType),pageTitle:Fs(e)}});case"page.file_deleted":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Deleted file {fileName} from {pageTitle}",id:"auditLogEntry.page.file_deleted",values:{fileName:Js(e),pageTitle:Fs(e)}});case"integration.secret_reset":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Reset authentication secret of {botName}",id:"auditLogEntry.integration.secret_reset",values:{botName:vs(s,e.meta.bot)}});case"workspace.external_account_connected":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Connected external/public integration {integrationName}",id:"auditLogEntry.workspace.external_account_connected",values:{integrationName:xs(s,e.meta.integration)}});case"workspace.external_account_disconnected":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Disconnected external/public integration {integrationName}",id:"auditLogEntry.workspace.external_account_disconnected",values:{integrationName:xs(s,e.meta.integration)}});case"workspace.integration_added":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Added {integrationName} to the workspace",id:"auditLogEntry.workspace.workspace.integration_added",values:{integrationName:xs(s,e.meta.integration)}});case"workspace.integration_removed":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Removed {integrationName} from workspace",id:"auditLogEntry.workspace.workspace.integration_removed",values:{integrationName:xs(s,e.meta.integration)}});case"user.settings.analytics_tracking_setting_updated":return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{enabledOrDisabled} page view tracking on their user account",id:"auditLogEntry.user.settings.analytics_tracking_setting_updated",values:{enabledOrDisabled:qs(s,Boolean(null===(Z=e.changes)||void 0===Z||null===(Z=Z.enabled)||void 0===Z?void 0:Z.newValue))}});case"workspace.settings.guest_invite_request_setting_updated":return function(e,t){var s;return(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{enabledOrDisabled} the “Member can request adding guests“ setting",id:"auditLogEntry.workspace.settings.guest_invite_request_setting_updated",values:{enabledOrDisabled:qs(t,Boolean(null===(s=e.changes)||void 0===s||null===(s=s.enabled)||void 0===s?void 0:s.newValue))}})}(e,s);case"workspace.guest_invite_request_resolved":return function(e,t){const s=e.changes.requestStatus.newValue;return"approved"===s?(0,r.jsx)(g.FormattedMessage,{id:"auditLog.actionNames.eventColumn.workspace.guest_invite_request_resolved.approved",defaultMessage:"Approved {requestorNameAndEmail) request to add guest “{guestName}” ({guestEmail}) to {pageTitle}",values:{requestorNameAndEmail:ys(t,e.target.user),guestNameAndEmail:ys(t,e.meta.targetGuest),pageTitle:As(e.meta.pagesAndRoles[0].page)}}):"rejected"===s?(0,r.jsx)(g.FormattedMessage,{id:"auditLog.actionNames.eventColumn.workspace.guest_invite_request_resolved.rejected",defaultMessage:"Declined request to add guest “{guestName}” ({guestEmail}) to {pageTitle}",values:{guestNameAndEmail:ys(t,e.meta.targetGuest),pageTitle:As(e.meta.pagesAndRoles[0].page)}}):(0,r.jsx)(r.Fragment,{})}(e,s);case"workspace_exported":case"workspace_icon_changed":case"public_page_cleared":case"logout":case"password_changed":case"password_cleared":case"password_set":case"revoked_support_access":case"user_suspended":case"user_unsuspended":case"member_joined":case"invite_link_toggled":case"scim_token_generated":case"scim_token_revoked":case"invite_link_reset":case"idp_metadata_xml_removed":case"idp_metadata_xml_updated":case"workspace.members_exported":return(0,r.jsx)(g.FormattedMessage,{...hs[e.actionName]});default:if("local"!==t)return rs.log({level:"error",from:"auditLogEvent",type:"AuditLogEvent",data:{miscDataToConvertToString:{data:e}}}),(0,r.jsx)(r.Fragment,{});(0,_.t1)(e)}}function Js(e){const{name:t,extension:s}=e.target.file;return t?`“${t}“`:s?(0,r.jsx)(g.FormattedMessage,{...hs.a_file_with_extension,values:{extension:s}}):(0,r.jsx)(g.FormattedMessage,{...hs.a_file})}function ei(e){window.__c={n:"AuditLogColumnEvent"};const{auditLogEntry:t,id:s}=e,[n,a]=(0,i.useState)(""),o=(0,g.useIntl)();return(0,i.useEffect)((()=>{const e=document.getElementById(s);a((null==e?void 0:e.textContent)||"")}),[s]),(0,r.jsx)(fe.Z,{style:{whiteSpace:"normal"},delayThreshold:80,renderTooltip:()=>(0,r.jsx)(si,{text:n,auditLogEntry:t}),placement:fe.Z.Placement.Bottom,render:e=>(0,r.jsx)("div",{...e,style:{fontSize:14,...p.Z.textOverflowStyle},id:s,children:(0,r.jsx)(ti,{auditLogEntry:t,env:"production",intl:o})})})}function ti(e){const{auditLogEntry:t,env:s,intl:i}=e;return Xs(t,s,i)}function si(e){var t,s;window.__c={n:"AuditLogEventTooltip"};const{auditLogEntry:i,text:n}=e,a=(0,g.useIntl)(),o=Ct({auditLogEntry:i,intl:a});return(0,r.jsxs)("div",{children:[n,(null===(t=i.actor.meta)||void 0===t?void 0:t.ipAddress)&&(0,r.jsx)("div",{children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"IP address: {ip}",values:{ip:null===(s=i.actor.meta)||void 0===s?void 0:s.ipAddress},id:"auditLogSettings.metadata.ipAddress"})}),(0,r.jsx)("div",{children:wt(i,a)}),o&&(0,r.jsx)(g.FormattedMessage,{id:"auditLogColumnEvent.tooltip.audienceMessage",defaultMessage:"Page audience: {audience}",values:{audience:o}})]})}function ii(e){const{children:t,disabled:s,onClick:i}=e;return(0,r.jsx)(Ze.Z,{onClick:i,disabled:s,style:{justifyContent:"center",marginLeft:6},isBlue:!s,isLightGray:s,children:t})}const ni={id:"actor",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"auditlog.logTable.userColumn.header",defaultMessage:"User"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`;return(0,r.jsx)(ts,{spaceStore:e.spaceStore,auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:30},sortable:!1},ai={id:"event",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"auditlog.logTable.eventColumn.header",defaultMessage:"Event"}),renderCell:e=>{const t=`event-${e.auditLogEntry.actionName}-${e.id}`;return(0,r.jsx)(ei,{auditLogEntry:e.auditLogEntry,id:t})},widthData:{width:40},sortable:!1},oi={id:"dateTimeAndMenu",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"auditlog.logTable.dateColumn.header",defaultMessage:"Date"}),renderCell:e=>{const t=`actor-${e.auditLogEntry.actionName}-${e.id}`,s=`event-${e.auditLogEntry.actionName}-${e.id}`,i=`datetime-${e.auditLogEntry.actionName}-${e.id}`;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(as,{auditLogEntry:e.auditLogEntry,id:i}),(0,r.jsx)(di,{auditLogEntry:e.auditLogEntry,ids:{actorColumnId:t,eventColumnId:s,dateTimeColumnId:i}})]})},widthData:{width:25},sortable:!0},ri=[ni,ai,oi];function li(){return(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"40vh",flexDirection:"column"},children:[(0,r.jsx)("div",{children:(0,r.jsx)(It.Z,{isSecondaryColor:!0,style:{fontWeight:500},children:(0,r.jsx)(g.FormattedMessage,{id:"auditlog.logTable.noResults",defaultMessage:"No results"})})}),(0,r.jsx)(It.Z,{isSecondaryColor:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"auditlog.logTable.noResultsHelpText",defaultMessage:"Try different filters. Logs may take some time to show up."})})]})}function di(e){window.__c={n:"AuditLogColumnMenu"};const{auditLogEntry:t,ids:s}=e,i=(0,N.VK)((()=>(0,Pt.F$)()),[]),n=(0,N.VK)((()=>Zt.default.checkGate("audit_log_event_name_column")?bt:St),[]),a=(0,g.useIntl)(),o=(0,L.O7)(),l=(0,lt.Fg)(),d=(0,lt.yK)((e=>({container:{display:"flex",alignItems:"center",justifyContent:"flex-end",width:"100%"},button:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:3}})),[]);return(0,r.jsx)(fe.Z,{delayThreshold:80,placement:fe.Z.Placement.Bottom,render:e=>(0,r.jsx)("div",{style:d.container,...e,children:(0,r.jsx)(Jt.Z,{style:d.button,onClick:()=>{var e;$t.RD({environment:o,stringValue:jt({auditLogEntry:t,intl:a,getAuditLogEventText:(e=s.eventColumnId,t=>{var s;return null===(s=document.getElementById(e))||void 0===s?void 0:s.textContent}),isTeamGuestsEnabled:i,csvColumnNames:n}),copiedMessage:$t.tq.copiedToClipboard})},children:(0,Qt.U)({width:16,height:16,fill:l.mediumIconColor})})}),renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"AuditLogSettings.copyAuditLogEvent",defaultMessage:"Copy row"})})}const ci=(0,g.injectIntl)((function(e){window.__c={n:"AuditLogPaginatedTable"};const{searchResponse:t,spaceStore:s}=e,[n,a]=(0,N.AF)(ee),o=t.results||[],l=t.hasMoreResults,d=Boolean(o.length),c=e=>{const t={...n,pageNum:e};a(t)},u=(0,lt.yK)((e=>(0,Xt.b)({columnRenderInfo:ri,theme:e,containerMarginTop:0})),[]),m=o.map(((e,t)=>({id:t.toString(),auditLogEntry:e,spaceStore:s,isClickable:!1}))),p=(0,i.useCallback)((()=>{const e=n.sortOrder===H.CreatedOldest?H.CreatedNewest:H.CreatedOldest;a({...n,sortOrder:e,pageNum:1})}),[n,a]),h=(0,i.useMemo)((()=>({column:oi,sortAscending:n.sortOrder===H.CreatedOldest})),[n]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Xt.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:ri,rows:m,sortState:h,onSortStateChanged:p,renderNoRowsComponent:li,styles:u}),d?(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10},children:[(0,r.jsx)(ii,{onClick:()=>{c(n.pageNum-1)},disabled:1===n.pageNum,children:(0,r.jsx)(g.FormattedMessage,{id:"auditlog.logTable.previousPage",defaultMessage:"Previous"})}),(0,r.jsx)(ii,{disabled:!l,onClick:()=>{c(n.pageNum+1)},children:(0,r.jsx)(g.FormattedMessage,{id:"auditlog.logTable.nextPage",defaultMessage:"Next"})})]}):null]})}));const ui=(0,g.injectIntl)((function(e){window.__c={n:"AuditLogSettingsImpl"};const{spaceStore:t}=e,s=(0,L.O7)(),n=null==t?void 0:t.id,[a]=(0,N.AF)(ae),[o]=(0,N.AF)(ee),l=te(o)!==a.filterStr?void 0:a.cachedResponses[o.pageNum];return(0,i.useEffect)((()=>{n&&(async e=>{var t,s;const{environment:i,spaceId:n}=e,a=ee.getState();ae.startLoading(n,a);const{sortOrder:o,pageSize:r,pageNum:l}=a,d={spaceId:n,limit:r,cursor:ae.getCursor(n,a,l),filters:{timeRange:{starting:a.timeRange.starting?E.OQ.toUnixMs(a.timeRange.starting):void 0,ending:a.timeRange.ending?E.OQ.toUnixMs(a.timeRange.ending):void 0},...(null===(t=a.actors)||void 0===t?void 0:t.length)>0?{actors:a.actors}:void 0,...(null===(s=a.actions)||void 0===s?void 0:s.length)>0?{actions:a.actions}:void 0},sort:o||H.CreatedNewest},c=await w.searchAuditLog(i,d);if("success"!==c.type)if(ae.updateError(n,a),(0,O.Jx)(c.body)){const e=(0,Q.wf)($.default.getIntl(),c);v.showErrorMessage(e)}else v.showErrorMessage($.default.formatMessage(oe.loadCurrentAuditLogError));else ae.updateLoadedResult(n,a,c.data)})({environment:s,spaceId:n})}),[s,n,o]),(0,i.useEffect)((()=>{le({environment:s,spaceId:n})}),[s,n]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Ht,{}),(0,r.jsxs)("div",{style:{justifyContent:"space-between",display:"flex",paddingTop:12,paddingBottom:12},children:[(0,r.jsx)(Ut,{spaceStore:t}),(0,r.jsx)(we,{})]}),"loading"===(null==l?void 0:l.status)&&(0,r.jsx)(Yt,{}),"success"===(null==l?void 0:l.status)&&(0,r.jsx)(ci,{searchResponse:l,spaceStore:t})]})}));var mi=s(28020),pi=s(68821),gi=s(43250),hi=s(8989),fi=s(17652),yi=s(18514),vi=s(67940);class xi extends Z.default{getInitialState(){return{status:"unconfigured",emailDomains:[],domainVerifications:[],spaces:[],createAccount:!1,useMetadataUrl:!0}}}const Si=xi;var bi=s(53680);class Mi extends Z.default{getInitialState(){return{displaySummary:!0,openDropdown:!1,query:""}}}const wi=new Mi;let ji=function(e){return e.Overview="overview",e.Users="users",e.Content="content",e.Search="search",e}({});class Ci extends Z.default{getInitialState(){return{}}shouldRefreshState(e){const t=this.getState();return e!==t.currentSpaceId||!(t.currentTab!==ji.Users||t.usersTabData&&t.usersTabData.usersAndStats)}}const ki=new Ci;class _i extends Z.default{getInitialState(){return{name:"",domain:"",domainState:"current-space",emailDomains:[],publicHomePage:void 0}}getValueForSpace(e){const t=e.getPublicContentDomain(),s=e.getPublicHomePage();if(e.isDefined())return{name:e.getName()||"",domain:t||"",emailDomains:e.getEmailDomains(),domainState:"current-space",publicHomePage:s}}}const Ti=_i;class Ii extends Z.default{getInitialState(){return{emailDomains:[],spaceCreation:"admins_only",settings:{}}}async updateValueForSpace(e){const{environment:t,spaceId:s,store:i}=e,n=await w.getEmailDomainsForSpace(t,{spaceId:s});if("failed"===n.type)return void v.showError(n);const{data:a}=n,o=Object.keys(a);return 0!==o.length?i.setState({emailDomains:o,spaceCreation:a[o[0]].spaceCreationEnum,settings:a[o[0]].settings}):i.setState(this.getInitialState()),i.state}}const Pi=Ii;class Zi extends Z.default{getInitialState(){return{uploadingProfilePhoto:!1,givenName:"",familyName:"",name:"",startDayOfWeek:(0,E.aN)(),accountSettings:{hasPassword:!1,canConfigurePassword:!1,isSamlEnforced:!1,mfaStatus:"loading",numMfaSettings:0,regenerateBackupCodes:!1,error:void 0}}}getValueForUser(e,t,s){if(e.isDefined()){const i=e.getFullName(s),n=e.getProfilePhoto(),a=t.getSettings();return{...this.state,uploadingProfilePhoto:!1,profilePhoto:n,name:i||"",startDayOfWeek:void 0===(null==a?void 0:a.start_day_of_week)?(0,E.aN)():null==a?void 0:a.start_day_of_week}}}}const Fi=Zi;var Ai=s(92083),Di=s(78291),Bi=s(98905),Ri=s(85703),Li=s(34583),Ni=s(67742),Ei=s(78780),Oi=s(13627),Vi=s(88632),Ui=s(27386);function Wi(e){let{spaceId:t,filters:s,disabled:n}=e;window.__c={n:"AdminContentSearchExportButton"};const[a,o]=(0,i.useState)(!1),l=(0,L.O7)(),d=n||a,c=(0,lt.yK)((e=>({button:{opacity:d?.5:1}})),[d]);return(0,r.jsx)(Wt.Z,{style:c.button,disabled:d,onClick:async function(){o(!0),y.j_p(l,{filters:s}),await de.gJ(l,{spaceId:t,filters:s}),o(!1)},children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.export",defaultMessage:"Export results"})})}var zi=s(98165),Ki=s(68785),Hi=s(71291),Gi=s(44678),qi=s(44495);function Yi(e){window.__c={n:"AdminContentSearchAcknowledgement"};const t=(0,L.O7)(),s=(0,lt.yK)((e=>({container:{marginTop:48,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},headerIcon:{width:36,height:36,color:e.lightTextColor,fill:"currentColor"},disclaimerTitle:{margin:"12px auto",fontWeight:p.Z.fontWeight.medium,fontSize:16},disclaimer:{fontWeight:p.Z.fontWeight.regular,fontSize:14,color:e.lightTextColor,textAlign:"center",width:432,margin:"0 auto 16px"},acknowledgeButton:{width:195,margin:"8px auto 0"},learnMoreButton:{width:195,margin:"8px auto 0",justifyContent:"center",color:e.lightTextColor},learnMoreButtonIcon:{width:12,height:12,marginRight:4}})),[]),n=(0,i.useCallback)((()=>{y.vN5(t),C.NY(t)}),[t]);return(0,r.jsxs)("div",{style:s.container,children:[(0,a.Q)(s.headerIcon),(0,r.jsx)("h1",{style:s.disclaimerTitle,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.disclaimerTitle",defaultMessage:"Before using this feature"})}),(0,r.jsx)("p",{style:s.disclaimer,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.disclaimer",defaultMessage:"As a workspace owner, you can use content search to find pages that you don't have access to, including the private pages of other workspace members. Consult with your organization's legal department on how to use this feature. Actions taken here will be recorded in the audit log."})}),(0,r.jsx)(ce.Z,{style:s.acknowledgeButton,onClick:n,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.confirm",defaultMessage:"Acknowledge"})}),(0,r.jsxs)(Ze.Z,{style:s.learnMoreButton,onClick:()=>{const e=(0,yi.UY)("adminContentSearch");S.navigateToExternalURL({environment:t,url:e})},children:[(0,qi.D)(s.learnMoreButtonIcon),(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.acknowledgement.learnMore",defaultMessage:"Learn more"})]})]})}var Qi=s(80750);function $i(e){let{runNewSearch:t,error:s}=e;window.__c={n:"AdminContentSearchError"};const i=(0,lt.yK)((e=>({container:{marginTop:48,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},headerIcon:{width:28,height:28,color:e.redBadgeBackground,fill:"currentColor"},title:{margin:"8px auto",fontWeight:p.Z.fontWeight.medium,fontSize:16},description:{fontWeight:p.Z.fontWeight.regular,fontSize:14,lineHeight:1.3,color:e.lightTextColor,textAlign:"center",width:328,margin:"0 auto 16px"},errorMessage:{borderRadius:4,background:e.cardBackground,fontFamily:p.Z.baseFontFamily.mono,fontSize:12,color:e.lightTextColor,padding:"18px 24px",margin:"0 auto 12px"},errorButton:{width:195,margin:"8px auto 0",textAlign:"center"}})),[]);return(0,r.jsxs)("div",{style:i.container,children:[(0,Qi.l)(i.headerIcon),(0,r.jsx)("h1",{style:i.title,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.error.title",defaultMessage:"Something went wrong"})}),(0,r.jsx)("p",{style:i.description,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.error.description",defaultMessage:"Something went wrong when we were loading the results. Try to run your search again."})}),null,(0,r.jsx)(Wt.Z,{style:i.errorButton,onClick:()=>t(!0),children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.error.confirm",defaultMessage:"Retry"})})]})}var Xi=s(80721),Ji=s(26774);function en(e){let{selectedAudience:t,setSelectedAudience:s,onMenuClose:n,setPillTitleToActiveSelection:a}=e;window.__c={n:"AudienceFilter"};const o=(0,N.qz)(void 0,Ft.Z),l=(0,lt.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionAvatar:{marginRight:4},container:{padding:"6px 0 6px"},input:{margin:"4px auto",width:"95%"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:4,fill:"currentColor"},teamIcon:{marginRight:8}})),[]),[d,c]=(0,i.useState)(!1),u=["private","shared_internally","shared_externally","shared_to_web"];function m(){c(!1),n&&n()}function p(){s&&s([])}function h(e){const i=t.includes(e)?[...t.filter((t=>t!==e))]:[...t,e];s&&s(i)}const f=(0,r.jsx)(Ie.Z,{on:t.length>0,icon:(0,Ji.O)(l.icon),title:a&&t[0]?tn(t[0]):(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.title",defaultMessage:"Audience"}),onClick:()=>c(!0),disabled:!s,hideChevron:!s});return s?(0,r.jsx)($e.Z,{children:(0,r.jsx)(ge.ZP,{popupType:ge.ZP.PopupType.Popup,placementToOrigin:ge.ZP.Placement.Bottom,alignmentToOrigin:ge.ZP.Alignment.Start,open:d,render:function(){const e={key:"teamOptions",items:u.map((e=>({key:e,action:()=>h(e),render:s=>(0,r.jsx)(ue.Z,{...s,icon:(0,r.jsx)(Tt.Z,{checked:t.includes(e),onClick:()=>h(e),size:16}),focused:!1,title:tn(e),caption:sn(e),shouldWrapCaption:!0})}))),render:e=>(0,r.jsx)(he.Z,{...e,title:null,loading:!1})};return(0,r.jsxs)("div",{style:l.container,children:[(0,r.jsx)(me.Z,{menuType:ye.og.Popup,header:null,maxHeight:250,width:300,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,store:o,initialFocus:0,sections:[e]})}),(0,r.jsxs)(he.Z,{topBorder:!0,style:l.footer,children:[(0,r.jsx)(Ze.Z,{onClick:p,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.clearButton",defaultMessage:"Clear"})}),(0,r.jsx)(ce.Z,{onClick:m,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.doneButton",defaultMessage:"Done"})})]})]})},onDismiss:m,keepFocus:!0,origin:f,preventScaleTransition:!0})}):f}function tn(e){switch(e){case"private":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.private",defaultMessage:"Private"});case"shared_externally":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.external",defaultMessage:"Shared externally"});case"shared_internally":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.internal",defaultMessage:"Shared internally"});case"shared_to_web":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.label.publishedToWeb",defaultMessage:"Shared to web"});default:(0,_.t1)(e)}}function sn(e){switch(e){case"private":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.private",defaultMessage:"Pages that only a single workspace member has access to."});case"shared_externally":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.external",defaultMessage:"Pages that are shared with guests or connections."});case"shared_internally":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.internal",defaultMessage:"Pages that are shared with other workspace members."});case"shared_to_web":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.audience.caption.publishedToWeb",defaultMessage:"Pages that are available for anyone to see on the web."});default:(0,_.t1)(e)}}function nn(e){let{filters:t,setFilters:s}=e;window.__c={n:"AdminContentSearchSuggestions"};const i=(0,lt.yK)((e=>({container:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},title:{margin:"12px auto",fontWeight:p.Z.fontWeight.medium,fontSize:16},description:{fontWeight:p.Z.fontWeight.regular,fontSize:14,color:e.lightTextColor,textAlign:"center",width:386,margin:"0 auto 16px"},suggestion:{position:"relative",height:38,width:440,margin:"12px auto 0",justifyContent:"center",color:e.darkTextColor,boxShadow:e.borderBoxShadow},filterContainer:{margin:"0 8px",display:"flex",alignItems:"center",justifyContent:"center"},arrowIconContainer:{position:"absolute",right:12,transform:"rotate(180deg)"},arrowIcon:{width:18,height:18,opacity:.5,color:e.lightTextColor,fill:"currentColor"}})),[]);return(0,r.jsxs)("div",{style:i.container,children:[(0,r.jsx)("h1",{style:i.title,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.title",defaultMessage:"Search pages in your workspace"})}),(0,r.jsx)("p",{style:i.description,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.description",defaultMessage:"Use filters to find pages with specific sharing and permissions settings, such as:"})}),(0,r.jsxs)(Ze.Z,{style:i.suggestion,onClick:function(){s({query:"",lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},audience:["shared_externally"],teamIds:[]},{runSearchAfter:!0})},children:[(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.sharedToWeb",defaultMessage:"Search for pages <filter></filter>",values:{filter:()=>(0,r.jsx)("div",{style:i.filterContainer,children:(0,r.jsx)(en,{setPillTitleToActiveSelection:!0,selectedAudience:["shared_externally"]})})}}),(0,r.jsx)("div",{style:i.arrowIconContainer,children:(0,Xi.W)(i.arrowIcon)})]}),(0,r.jsxs)(Ze.Z,{style:i.suggestion,onClick:function(){s({query:"",lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},audience:["shared_to_web"],teamIds:[]},{runSearchAfter:!0})},children:[(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.suggestions.sharedToWeb",defaultMessage:"Search for pages <filter></filter>",values:{filter:()=>(0,r.jsx)("div",{style:i.filterContainer,children:(0,r.jsx)(en,{setPillTitleToActiveSelection:!0,selectedAudience:["shared_to_web"]})})}}),(0,r.jsx)("div",{style:i.arrowIconContainer,children:(0,Xi.W)(i.arrowIcon)})]})]})}var an=s(27006),on=s(69219);function rn(e){let{blockStore:t}=e;window.__c={n:"AudienceCell"};const[s,n]=(0,i.useState)();(0,i.useEffect)((()=>{!async function(){const{currentSpaceStore:e}=I.default.state,s=zi.fJ(t),i=ls.Wo(s),a=null==e?void 0:e.getPermissionItems().filter(an.jg),o=await ls.uq({permissionItems:i,hasTeamLevelGuests:function(t){return!!e&&nt.zX.createChildStore(e,{table:ms.e0,id:t}).getMembers().some((e=>"team_level_guest"===e.type))},spaceUserPermissions:a});n(o)}()}),[t]);const a=(0,i.useMemo)((()=>{if(s)return ln(s)}),[s]);return(0,r.jsx)(on.i,{useThinTitle:!0,title:a})}function ln(e){switch(e){case"private":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.private",defaultMessage:"Private"});case"shared_internally":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.sharedInternally",defaultMessage:"Shared internally"});case"shared_externally":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.sharedExternally",defaultMessage:"Shared externally"});case"shared_to_web":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audienceCell.publishedToWeb",defaultMessage:"Published to web"});default:(0,_.t1)(e)}}var dn=s(36409),cn=function(e){return e.Shared="shared",e.Private="private",e.Hidden="hidden",e}(cn||{});function un(e){let{blockStore:t,teamStore:s}=e;window.__c={n:"LocationCell"};const i=(0,lt.yK)((e=>({icon:{height:18,width:18,color:e.lightIconColor,fill:"currentColor"}})),[]),n=(0,N.VK)((()=>{const e=(0,zi.fJ)(t),s=(0,ls.Wo)(e),i=s.filter((e=>!(0,an.Le)(e)));return 1===i.length&&(0,an.jg)(i[0])?cn.Private:s.length>0?cn.Shared:cn.Hidden}),[t]);return s?(0,r.jsx)(dn.r,{useThinTitle:!0,teamStore:s}):function(){switch(n){case cn.Shared:return(0,r.jsx)(on.i,{useThinTitle:!0,icon:(0,Ji.O)(i.icon),title:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.locationCell.shared",defaultMessage:"Shared"})});case cn.Hidden:case cn.Private:return(0,r.jsx)(on.i,{useThinTitle:!0,icon:(0,a.Q)(i.icon),title:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.locationCell.private",defaultMessage:"Private"})})}}()}var mn=s(15145),pn=s(56666),gn=s(27714),hn=s(62397),fn=s(84210),yn=s(77907),vn=s(61766),xn=s(55899),Sn=s(97238),bn=s(8675),Mn=s(31945),wn=s(73063);function jn(e){let{blockStore:t}=e;window.__c={n:"PageCellActions"};const s=(0,L.O7)(),n=(0,N.qz)(void 0,vn.Z),a=(0,N.qz)(void 0,bn.Z),o=(0,N.qz)(void 0,xn.ZP),l=(0,lt.yK)((e=>({changePermissionsIcon:{height:18,width:18,color:e.regularIconColor,fill:"currentColor"},copyLinkIcon:{height:15,width:15,color:e.regularIconColor,fill:"currentColor"}})),[]),[d,c]=(0,i.useState)(!1);(0,i.useEffect)((()=>{a.setState({...a.state,privatePageStore:t,changePermissionsEnabled:!0,loading:!1,error:void 0})}),[t,a]);const u={key:"actions",render:e=>(0,r.jsx)(he.Z,{...e}),items:[{key:"change-permissions",render:e=>(0,r.jsx)(ue.Z,{...e,icon:(0,hn.I)(l.changePermissionsIcon),title:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.changePermissions",defaultMessage:"Change permissions"})}),action:function(){c(!0)}},{key:"copy-link",render:e=>(0,r.jsx)(ue.Z,{...e,icon:(0,gn.N)(l.copyLinkIcon),title:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.copyLink",defaultMessage:"Copy link to page"})}),action:async function(){const e=(0,fn.ZP)({store:t,pageVisitSource:mn.tY.CopyLink});await $t.RD({environment:s,stringValue:e,copiedMessage:$t.tq.copiedLinkToClipboard}),n.setState({open:!1})}}]};return(0,r.jsx)(Mn.ZP,{popupType:ge.kQ.Popup,alignmentToOrigin:ge.ZP.Alignment.Center,placementToOrigin:ge.ZP.Placement.Right,style:{width:d?450:248},render:()=>d?(0,r.jsx)(yn.LazyShareMenuContainer,{store:t,sudoModeStore:a,inviteTargetsStore:o,location:"admin_content_search"}):(0,r.jsx)(me.Z,{menuType:ye.og.Popup,width:248,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:[u]})}),onClose:()=>{c(!1),Sn.ZP.reset()},buttonPopupStore:n,renderOrigin:e=>(0,r.jsx)(wn.Z,{icon:pn.o,...e})})}var Cn=s(53695),kn=s(36596),_n=s(28992),Tn=s(70301);function In(e){let{botId:t}=e;window.__c={n:"BotMenuItem"};const s=(0,g.useIntl)(),i=(0,L.O7)(),n=(0,N.VK)((()=>nt.t1.createUniqueRootStore(i,{table:G.cZ,id:t})),[t,i]),a=(0,N.VK)((()=>n.getDisplayName(s)),[n,s]),o=(0,N.VK)((()=>n.getParentStore()),[n]),l=(0,N.VK)((()=>{if(o){if(o instanceof nt.U6)return o.getDisplayName(s);if(o instanceof nt.H2)return o.getName()}}),[o,s]),d=(0,lt.yK)((()=>({desktopIconStyle:{alignSelf:"center",width:24,fontSize:18}})),[]);return a?(0,r.jsx)(_n.Z,{desktopIconStyle:d.desktopIconStyle,icon:(0,r.jsx)(Tn.Z,{botStore:n,size:24}),title:a,caption:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.botMenuItem.createdBy",defaultMessage:"Created by {creatorName}",values:{creatorName:l}})}):(0,r.jsx)(Pn,{})}function Pn(){window.__c={n:"ShimmerLoader"};const e=(0,lt.yK)((e=>({container:{userSelect:"none",minHeight:45,fontSize:14,padding:"4px 8px",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},textContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",gap:6},icon:{flexGrow:0,flexShrink:0,width:24,height:24,borderRadius:"0.25em",marginRight:4,marginTop:1},title:{flexGrow:0,flexShrink:0,width:80,height:14,borderRadius:"0.25em",marginLeft:4},byline:{flexGrow:0,flexShrink:0,width:150,height:10,borderRadius:"0.25em",marginLeft:4}})),[]);return(0,r.jsxs)("div",{style:e.container,children:[(0,r.jsx)(kn.Z,{style:e.icon}),(0,r.jsxs)("div",{style:e.textContainer,children:[(0,r.jsx)(kn.Z,{emphasized:!1,style:e.title}),(0,r.jsx)(kn.Z,{emphasized:!1,style:e.byline})]})]})}var Zn=s(31278);const Fn=(0,g.defineMessages)({editor:{id:"adminContentSearchTab.sharedWith.permissions.editor",defaultMessage:"Full access"},readAndWrite:{id:"adminContentSearchTab.sharedWith.permissions.readAndWrite",defaultMessage:"Can edit"},commentOnly:{id:"adminContentSearchTab.sharedWith.permissions.commentOnly",defaultMessage:"Can comment"},reader:{id:"adminContentSearchTab.sharedWith.permissions.reader",defaultMessage:"Can view"},none:{id:"adminContentSearchTab.sharedWith.permissions.none",defaultMessage:"None"}});function An(e,t){switch(t){case"editor":return e.formatMessage(Fn.editor);case"read_and_write":return e.formatMessage(Fn.readAndWrite);case"comment_only":return e.formatMessage(Fn.commentOnly);case"reader":return e.formatMessage(Fn.reader);case"none":return e.formatMessage(Fn.none)}}function Dn(e){let{name:t,icon:s,role:i}=e;window.__c={n:"GroupMenuItem"};const n=(0,g.useIntl)(),a=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),o=An(n,i),l=(0,lt.yK)((e=>({defaultIcon:{height:18,width:18,color:e.lightTextColor,fill:"currentColor"},defaultGroupIcon:{height:20,width:20,color:e.lightTextColor,fill:"currentColor"}})),[]);return(0,r.jsx)(_n.Z,{desktopIconStyle:{alignSelf:"center",width:24,fontSize:18},icon:(0,r.jsx)(Zn.Z,{disabled:!0,icon:s&&a?{pointer:a.pointer,icon:s}:void 0,size:20,isEmptyPage:!1,title:t,defaultIcon:(0,Ji.O)(l.defaultGroupIcon)}),title:t||(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.untitledPage",defaultMessage:"Untitled{maybeRoleString}",values:{maybeRoleString:o?` · ${o}`:""}}),caption:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.group",defaultMessage:"Group{maybeRoleString}",values:{maybeRoleString:o?` · ${o}`:""}})})}var Bn=s(93686);function Rn(e){let{permissionItem:t}=e;window.__c={n:"SpaceMenuItem"};const s=(0,g.useIntl)(),i=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),n=(0,N.VK)((()=>{var e;return null===(e=I.default.state.currentSpaceStore)||void 0===e?void 0:e.getName()}),[]),a=null==t?void 0:t.role,o=(0,an.iC)(a)?An(s,a):void 0;return(0,r.jsx)(_n.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:i?(0,r.jsx)(Bn.p,{disabled:!0,store:i,size:24}):void 0,title:n,caption:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.spaceMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:o?` · ${o}`:""}})})}var Ln=s(91192);function Nn(e){let{teamId:t,role:s,onlyOwners:i}=e;window.__c={n:"TeamMenuItem"};const n=(0,L.O7)(),a=(0,g.useIntl)(),o=(0,N.VK)((()=>new nt.zX(n,{table:ms.e0,id:t})),[n,t]),l=An(a,s),d=(0,N.VK)((()=>o.getName()),[o]),c=d||(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.unknownTeamName",defaultMessage:"Private teamspace"});return(0,r.jsx)(_n.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:d?(0,r.jsx)(Bn.p,{disabled:!0,store:o,size:24}):(0,Ln.x)(),title:c,caption:i?(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamOwners",defaultMessage:"Owners{maybeRoleString}",values:{maybeRoleString:l?` · ${l}`:""}}):(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.teamMembers",defaultMessage:"Members{maybeRoleString}",values:{maybeRoleString:l?` · ${l}`:""}})})}var En=s(64684),On=s(67669);var Vn=s(7928),Un=s(45653);function Wn(e){let{userId:t,role:s,isGuest:i}=e;window.__c={n:"UserMenuItem"};const n=(0,g.useIntl)(),a=(0,L.O7)(),{userStore:o,userName:l}=(0,N.VK)((()=>{const e=new nt.U6(a,{table:q.KJ,id:t}),s=(0,Vn.Nz)(n,e.getModel());return{userStore:e,userName:s}}),[a,t,n]),d=An(n,s);return(0,r.jsx)(_n.Z,{desktopIconStyle:{alignSelf:"center",width:24},icon:(0,r.jsx)(Un.Z,{userStore:o,size:24}),title:l,caption:i?(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.guest",defaultMessage:"Guest{maybeRoleString}",values:{maybeRoleString:d?` · ${d}`:""}}):(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.member",defaultMessage:"Member{maybeRoleString}",values:{maybeRoleString:d?` · ${d}`:""}})})}const zn=(0,g.defineMessages)({sharedWithWorkspaceMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWorkspaceMembers",defaultMessage:"Workspace members"},sharedWithTeamOwners:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamOwners",defaultMessage:"Teamspace owners"},sharedWithTeamMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithTeamMembers",defaultMessage:"Teamspace members"},sharedWithMembers:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithMembers",defaultMessage:"{numMembers, plural, one {# member} other {# members}}"},sharedWithGroups:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGroups",defaultMessage:"{numGroups, plural, one {# group} other {# groups}}"},sharedWithGuests:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithGuests",defaultMessage:"{numGuests, plural, one {# guest} other {# guests}}"},sharedWithBots:{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithBots",defaultMessage:"{numBots, plural, one {# connection} other {# connections}}"},separator:{defaultMessage:", ",id:"adminContentSearchTab.pagesTable.sharedWithCell.separator"}});function Kn(e){let{blockStore:t}=e;window.__c={n:"SharedWithCellImpl"};const s=function(e){return(0,N.VK)((()=>{const{data:t}=Di.default.state,s=t?(0,Oi.CM)(t):[],i=I.default.state.currentSpaceStore,n=(0,On.YO)(e),a=(null==i?void 0:i.getPermissionGroups())||[],o=(0,zi.VP)(e),r=n.find((e=>{let{permissionItem:t}=e;return an.$D(t)})),l=n.find((e=>{let{permissionItem:t}=e;return an.ix(t)})),d=o?n.find((e=>{let{permissionItem:t}=e;return(0,En.J2)(t,o.id)})):void 0,c=n.map((e=>{let{permissionItem:t}=e;return t})).filter(an.zU),u=n.map((e=>{let{permissionItem:t}=e;return t})).filter(an.LW),m=n.map((e=>{let{permissionItem:t}=e;return t})).filter(an.hV).reduce(((e,t)=>{const s=t.group_id,i=t.role,n=a.find((e=>e.id===s));if(n){const t={...n,role:i};e.push(t)}return e}),[]),[p,g]=n.map((e=>{let{permissionItem:t}=e;return t})).filter(an.jg).reduce(((e,t)=>{const i=s.find((e=>e.userId===t.user_id));return Boolean(i&&!an.zz(i.role)&&!an.J5(i.role))?[e[0].concat(t),e[1]]:[e[0],e[1].concat(t)]}),[[],[]]);return{groupPermissions:m,mostPermissivePublicItem:r,spacePermission:l,teamPermission:d,teamSharePermissions:c,teamOwnerSharePermissions:u,guestUserPermissions:p,memberUserPermissions:g,botPermissions:n.map((e=>{let{permissionItem:t}=e;return t})).filter((e=>(0,an.FB)(e)))}}),[e])}(t),i=(0,g.useIntl)(),n=function(e,t){const{mostPermissivePublicItem:s,spacePermission:i,groupPermissions:n,guestUserPermissions:a,memberUserPermissions:o,teamSharePermissions:l,teamOwnerSharePermissions:d,botPermissions:c}=e,u=i&&"none"!==i.permissionItem.role;if(s&&"none"!==s.permissionItem.role)return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.sharedWithWeb",defaultMessage:"Shared to web"});if(!u&&0===n.length&&0===a.length&&0===o.length&&0===l.length&&0===d.length&&0===c.length)return(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage",defaultMessage:"Nobody"}),(0,r.jsx)(fe.Z,{render:e=>(0,r.jsx)("div",{...e,children:(0,qi.D)({marginLeft:4,height:14,width:14,opacity:.5})}),renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWithCell.orphanedPage.tooltip",defaultMessage:"No person, group, or teamspace has any access to this page."})})]});const m=[];u?m.push(t.formatMessage(zn.sharedWithWorkspaceMembers)):(d.length>0&&0===l.length?m.push(t.formatMessage(zn.sharedWithTeamOwners)):l.length>0&&m.push(t.formatMessage(zn.sharedWithTeamMembers)),o.length>0&&m.push(t.formatMessage(zn.sharedWithMembers,{numMembers:o.length})),n.length>0&&m.push(t.formatMessage(zn.sharedWithGroups,{numGroups:n.length})));a.length>0&&m.push(t.formatMessage(zn.sharedWithGuests,{numGuests:a.length}));c.length>0&&m.push(t.formatMessage(zn.sharedWithBots,{numBots:c.length}));return m.join(t.formatMessage(zn.separator))}(s,i),a=[...s.spacePermission?[{key:"space-permission",render:e=>{var t;return(0,r.jsx)(Rn,{...e,permissionItem:null===(t=s.spacePermission)||void 0===t?void 0:t.permissionItem})},action:()=>{}}]:[],...s.teamOwnerSharePermissions.map((e=>({key:`${e.team_id}-owners`,render:t=>(0,r.jsx)(Nn,{...t,onlyOwners:!0,teamId:e.team_id,role:e.role}),action:()=>{}}))),...s.teamSharePermissions.map((e=>({key:`${e.team_id}-members`,render:t=>(0,r.jsx)(Nn,{...t,teamId:e.team_id,role:e.role}),action:()=>{}}))),...s.groupPermissions.map((e=>({key:e.id,render:t=>(0,r.jsx)(Dn,{...t,name:e.name,icon:e.icon,role:e.role}),action:()=>{}}))),...s.memberUserPermissions.map((e=>({key:e.user_id,render:t=>(0,r.jsx)(Wn,{...t,userId:e.user_id,role:e.role}),action:()=>{}}))),...s.guestUserPermissions.map((e=>({key:e.user_id,render:t=>(0,r.jsx)(Wn,{...t,isGuest:!0,userId:e.user_id,role:e.role}),action:()=>{}}))),...s.botPermissions.map((e=>({key:e.bot_id,render:t=>(0,r.jsx)(In,{...t,botId:e.bot_id}),action:()=>{}})))];return(0,r.jsx)(Cn.N,{title:n,items:a,disabled:0===a.length})}const Hn=i.memo(Kn);var Gn=s(17290);function qn(e){let{blockStore:t,userIds:s,isClickable:i}=e;window.__c={n:"UsersFromIdsCell"};const n=(0,N.VK)((()=>s.map((e=>nt.U6.createChildStore(t,{table:q.KJ,id:e})))),[t,s]);return(0,r.jsx)(Gn.G,{userStores:n,isClickable:i})}const Yn={id:"page",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.name",defaultMessage:"Page"}),renderCell:e=>(0,r.jsx)(Gi.o,{blockStore:e.pageStore,rightIcon:(0,r.jsx)(jn,{blockStore:e.pageStore})}),widthData:{width:320,maxWidth:320},sortable:!1},Qn={id:"location",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.location.name",defaultMessage:"Location"}),renderCell:e=>(0,r.jsx)(un,{blockStore:e.pageStore,teamStore:e.teamStore}),widthData:{width:140},sortable:!1},$n={id:"createdTime",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.createdTime.name",defaultMessage:"Created on"}),renderCell:e=>(0,r.jsx)(Hi.T,{dateTs:e.createdTime}),widthData:{width:140},sortable:!1},Xn={id:"lastEditedTime",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.lastEditedTime.name",defaultMessage:"Last edited on"}),renderCell:e=>(0,r.jsx)(Hi.T,{dateTs:e.lastEditedTime}),widthData:{width:140},sortable:!1},Jn={id:"createdBy",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.createdBy.name",defaultMessage:"Created by"}),renderCell:e=>e.createdById?(0,r.jsx)(qn,{blockStore:e.pageStore,userIds:[e.createdById]}):null,widthData:{width:140},sortable:!1},ea={id:"lastEditedBy",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.lastEditedBy.name",defaultMessage:"Last edited by"}),renderCell:e=>e.lastEditedById?(0,r.jsx)(qn,{blockStore:e.pageStore,userIds:[e.lastEditedById]}):null,widthData:{width:140},sortable:!1},ta=[Yn,Qn,{id:"audience",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.audience.name",defaultMessage:"Audience"}),renderCell:e=>(0,r.jsx)(rn,{blockStore:e.pageStore}),widthData:{width:140},sortable:!1},{id:"sharedWith",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.sharedWith.name",defaultMessage:"Shared with"}),renderCell:e=>(0,r.jsx)(Hn,{blockStore:e.pageStore}),widthData:{width:140},sortable:!1},ea,Xn,Jn,$n];function sa(e){let{loading:t,error:s,loadNextPage:i,filters:n,setFilters:a,pageStores:o,showSuggestions:l,runNewSearch:d}=e;window.__c={n:"AdminContentSearchTable"};const c=(0,N.VK)((()=>{const e=I.default.state.currentSpaceViewStore,t=null==e?void 0:e.getSettings();return null==t?void 0:t.admin_content_search_acknowledgement}),[]),u=c&&!t&&!l,m=c&&!l,p=(0,N.VK)((()=>o.map((e=>({id:e.id,isClickable:!1,pageStore:e,teamStore:(0,zi.VP)(e),createdTime:e.getCreatedTime(),lastEditedTime:e.getLastEditedTime(),createdById:e.getCreatedById(),lastEditedById:e.getLastEditedById()})))),[o]),h=(0,lt.yK)((e=>(0,Xt.b)({columnRenderInfo:ta,theme:e,containerMarginTop:0})),[]);return s?(0,r.jsx)($i,{runNewSearch:d,error:s}):c?l&&0===p.length?(0,r.jsx)(nn,{filters:n,setFilters:a}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Xt.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:400,columnRenderInfo:ta,rows:p,onScrollBottom:m?i:void 0,renderNoRowsComponent:()=>(0,r.jsx)(It.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:u&&(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.empty",defaultMessage:"No pages found with your query."})}),styles:h}),t?(0,r.jsx)(Ki.Z,{style:{margin:"24px auto 24px"}}):null]}):(0,r.jsx)(Yi,{})}var ia=s(2438);function na(e){let{spaceStore:t}=e;return(0,N.VK)((()=>{const{data:e}=Di.default.state;if(!e)return{loading:!0};const s=Oi.CM(e);if(!s.every((e=>nt.U6.createChildStore(t,{table:q.KJ,id:e.userId}).isReady())))return{loading:!0};const i=s.filter(ia.CF),n=s.filter(ia.du);return{loading:!1,members:i.map((e=>{let{userId:s}=e;return nt.U6.createChildStore(t,{table:q.KJ,id:s})})),guests:n.map((e=>{let{userId:s}=e;return nt.U6.createChildStore(t,{table:q.KJ,id:s})}))}}),[t])}var aa=s(84619),oa=s(40462),ra=s(16639),la=s(43145),da=s(46978),ca=s(85567),ua=s(719);const ma=(0,g.defineMessages)({usersPlaceholder:{id:"adminContentSearchTab.pagesTable.filters.users.usersPlaceholder",defaultMessage:"Search for users..."},usersAndGroupsPlaceholder:{id:"adminContentSearchTab.pagesTable.filters.users.usersAndGroupsPlaceholder",defaultMessage:"Search for users and groups..."}});function pa(e){let{userStores:t,title:s,selectedItems:n,setSelectedItems:a,onMenuClose:o,isMultiSelect:l,includePermissionGroups:d,guestUserIdSet:c}=e;window.__c={n:"UsersFilter"};const u=(0,g.useIntl)(),m=(0,N.qz)(void 0,Ft.Z),p=(0,lt.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionAvatar:{marginRight:8},container:{padding:"6px 0 6px"},input:{margin:"4px auto",width:"95%",maxHeight:200,overflowY:"auto"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:4,fill:"currentColor"},defaultGroupIcon:{height:22,width:22,color:e.mediumTextColor,fill:"currentColor"},defaultGroupIconPill:{height:14,width:14,color:e.mediumTextColor,fill:"currentColor"},groupIconSpacing:{marginRight:8},pillContainer:{margin:"0px 6px 6px 0px",background:e.legacyDefaultSelectColor,height:20},guestPillContainer:{margin:"0px 6px 6px 0px",background:e.guestTokenBackground,height:20},guestIcon:{height:16,width:16,color:e.guestIconColor},pillContents:{display:"inline-flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},pillText:{marginLeft:4},noResultsMessage:{width:"100%",margin:"8px 12px"},optionTitle:{display:"block"},optionCaption:{display:"block",color:e.mediumTextColor,fontSize:12,lineHeight:"15px"}})),[]),[h,f]=(0,i.useState)(10),[y,v]=(0,i.useState)(!1),[x,S]=(0,i.useState)(""),b=t.length,M=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),w=(0,i.useMemo)((()=>n.map((e=>{let{id:t}=e;return t}))),[n]),j=(0,N.VK)((()=>{const e=I.default.state.currentSpaceStore;return d&&e?e.getPermissionGroups():[]}),[d]),C=(0,N.VK)((()=>w.map((e=>t.find((t=>t.id===e)))).filter(_.$K)),[w,t]),k=(0,N.VK)((()=>w.map((e=>j.find((t=>t.id===e)))).filter(_.$K)),[w,j]);function T(){f(10),v(!1),S(""),o()}function P(){S(""),a([])}function Z(e){e<5&&h<b&&f(h+10)}function F(e){if(l){return w.includes(e.id)?[...n.filter((t=>{let{id:s}=t;return s!==e.id}))]:[...n,e]}return w.includes(e.id)?[]:[e]}function A(e){const t=F({id:e,type:"user"});a(t),S("")}function D(e){const t=F({id:e,type:"permission_group"});a(t),S("")}const B=(0,i.useCallback)((e=>{S(e.target.value)}),[]),R=(0,N.VK)((()=>C.map((e=>{const t=(0,Vn.Nz)(u,e.getModel()),s=!!c&&c.has(e.id);return(0,r.jsx)(ca.Z,{isSingle:!0,format:aa.l.Inline,showRemoveButton:!0,onClickRemove:()=>{const t=w.filter((t=>t!==e.id)).map((e=>({id:e,type:"user"})));a(t)},style:s?p.guestPillContainer:p.pillContainer,value:(0,r.jsxs)("div",{style:p.pillContents,children:[s?(0,oa.o)(p.guestIcon):(0,r.jsx)(Un.Z,{userStore:e,size:16}),(0,r.jsx)(It.Z,{style:p.pillText,children:t})]})},e.id)}))),[w,C,a,c,p,u]),L=(0,N.VK)((()=>k.map((e=>{const t=ra.kF({intl:u,group:e});return(0,r.jsx)(ca.Z,{isSingle:!0,format:aa.l.Inline,showRemoveButton:!0,onClickRemove:()=>{const t=w.filter((t=>t!==e.id)).map((e=>({id:e,type:"permission_group"})));a(t)},style:p.pillContainer,value:(0,r.jsxs)("div",{style:p.pillContents,children:[(0,r.jsx)(Zn.Z,{disabled:!0,icon:e.icon&&M?{pointer:M.pointer,icon:e.icon}:void 0,size:14,isEmptyPage:!1,title:t,defaultIcon:(0,Ji.O)(p.defaultGroupIconPill),style:p.groupIconSpacing}),(0,r.jsx)(It.Z,{style:p.pillText,children:t})]})},e.id)}))),[w,k,a,p,M,u]);const E=(0,r.jsx)(Ie.Z,{on:w.length>0,icon:(0,tt.f)(p.icon),title:s,onClick:()=>v(!0)});return(0,r.jsx)($e.Z,{children:(0,r.jsx)(ge.ZP,{popupType:ge.ZP.PopupType.Popup,placementToOrigin:ge.ZP.Placement.Bottom,alignmentToOrigin:ge.ZP.Alignment.Start,open:y,render:function(){const e=[];for(const n of t){var s;const t=(0,Vn.Nz)(u,n.getModel()),i=!!c&&c.has(n.id);(t.toLocaleLowerCase().includes(x)||null!==(s=n.getEmail())&&void 0!==s&&s.toLocaleLowerCase().includes(x))&&e.push({key:n.id,action:()=>A(n.id),render:e=>(0,r.jsx)(ue.Z,{...e,icon:l?(0,r.jsx)(Tt.Z,{checked:w.includes(n.id),onClick:()=>A(n.id),size:16}):(0,r.jsx)(da.Z,{isSelected:w.includes(n.id)}),focused:!1,title:(0,r.jsxs)("div",{style:p.optionContainer,children:[(0,r.jsx)(Un.Z,{userStore:n,size:24,style:p.optionAvatar}),(0,r.jsxs)("div",{style:{paddingTop:4,paddingBottom:4},children:[(0,r.jsx)(It.Z,{style:p.optionTitle,children:t}),(0,r.jsx)(It.Z,{style:p.optionCaption,children:i?(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.guestCaption",defaultMessage:"Guest"}):(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.memberCaption",defaultMessage:"Member"})})]})]})})})}const i=[];for(const t of j){const e=ra.kF({intl:u,group:t});e.toLocaleLowerCase().includes(x)&&i.push({key:t.id,action:()=>D(t.id),render:s=>(0,r.jsx)(ue.Z,{...s,icon:l?(0,r.jsx)(Tt.Z,{checked:w.includes(t.id),onClick:()=>D(t.id),size:16}):(0,r.jsx)(da.Z,{isSelected:w.includes(t.id)}),focused:!1,title:(0,r.jsxs)("div",{style:p.optionContainer,children:[(0,r.jsx)(Zn.Z,{disabled:!0,icon:t.icon&&M?{pointer:M.pointer,icon:t.icon}:void 0,size:22,isEmptyPage:!1,title:e,defaultIcon:(0,Ji.O)(p.defaultGroupIcon),style:p.groupIconSpacing}),(0,r.jsxs)("div",{style:{paddingTop:4,paddingBottom:4},children:[(0,r.jsx)(It.Z,{style:p.optionTitle,children:e}),(0,r.jsx)(It.Z,{style:p.optionCaption,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.groupCaption",defaultMessage:"Group"})})]})]})})})}const o={key:"no-results",action:()=>{},render:e=>(0,r.jsx)(It.Z,{isSecondaryColor:!0,style:p.noResultsMessage,...e,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.noResultsMessage",defaultMessage:"No results found."})})},f=[...e,...i],y={key:"userOptions",items:f.length>0?f.slice(0,h):[o],render:e=>(0,r.jsx)(he.Z,{...e,title:null,loading:!1})};return(0,r.jsxs)("div",{style:p.container,children:[(0,r.jsx)(ua.Z,{focus:!0,value:x,style:p.input,placeholder:$.default.formatMessage(d?ma.usersAndGroupsPlaceholder:ma.usersPlaceholder),onChange:B,onRemoveLastToken:()=>{const e=n.slice(0,-1);a(e)},tokens:[...R,...L]}),(0,r.jsxs)(me.Z,{menuType:ye.og.Popup,header:null,maxHeight:250,width:300,children:[(0,r.jsx)(pe.Z,{type:pe.i.Vertical,store:m,initialFocus:0,sections:[y]}),(0,r.jsx)(la.Z,{onChange:Z})]}),(0,r.jsxs)(he.Z,{topBorder:!0,style:p.footer,children:[(0,r.jsx)(Ze.Z,{onClick:P,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.clearButton",defaultMessage:"Clear"})}),(0,r.jsx)(ce.Z,{onClick:T,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.users.doneButton",defaultMessage:"Done"})})]})]})},onDismiss:T,keepFocus:!0,origin:E,preventScaleTransition:!0})})}function ga(e){let{spaceStore:t,createdByFilterIds:s,setCreatedByFilter:n,runNewSearch:a,includeGuests:o}=e;window.__c={n:"CreatedByFilter"};const l=na({spaceStore:t}),d=(0,i.useMemo)((()=>l.loading?[]:o?[...l.members,...l.guests]:l.members),[l,o]),c=(0,i.useMemo)((()=>l.loading?new Set:new Set(l.guests.map((e=>e.id)))),[l]);const u=(0,i.useMemo)((()=>s.map((e=>({id:e,type:"user"})))),[s]);return(0,r.jsx)(pa,{userStores:d,title:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdBy.title",defaultMessage:"Created by"}),selectedItems:u,setSelectedItems:function(e){const t=e.map((e=>{let{id:t}=e;return t}));n(t)},onMenuClose:a,guestUserIdSet:c})}var ha=s(40506),fa=s(42853),ya=s(45959);function va(e){let{lastEditedTime:t,createdTime:s,setLastEditedTime:n,setCreatedOnTime:a}=e;window.__c={n:"DateFilter"};const o=(0,g.useIntl)(),[l,d]=(0,i.useState)("createdTime"),c=(0,i.useMemo)((()=>{switch(l){case"createdTime":return s;case"lastEditedTime":return t;default:(0,_.t1)(l)}}),[t,s,l]),u=(0,i.useMemo)((()=>{switch(l){case"createdTime":return a;case"lastEditedTime":return n;default:(0,_.t1)(l)}}),[n,a,l]);const m=(0,N.VK)((()=>{if((0,X.mK)(c))switch(l){case"createdTime":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdOn.title",defaultMessage:"Created on"});case"lastEditedTime":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.lastEditedOn.title",defaultMessage:"Last edited on"});default:(0,_.t1)(l)}const e=(0,X.Hq)(c),t=Ce._Q(e,o,ha.sF);switch(l){case"createdTime":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdOn.titleWithDateRange",defaultMessage:"Created on: {dateRangeString}",values:{dateRangeString:t}});case"lastEditedTime":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.lastEditedOn.titleWithDateRange",defaultMessage:"Last edited on: {dateRangeString}",values:{dateRangeString:t}});default:(0,_.t1)(l)}}),[c,l,o]);return(0,r.jsx)(Je,{header:(0,r.jsx)(xa,{selectedItem:l,setSelectedItem:function(e){d(e)}}),mode:Ye.z.Pill,focused:!1,hideTime:!0,pillTitle:m,title:m,icon:je.C,value:c,showButtons:"footer",onChange:e=>{u(e)}})}function xa(e){let{selectedItem:t,setSelectedItem:s}=e;window.__c={n:"DateTimeFilterSelector"};const i=(0,lt.yK)((e=>({button:{margin:"14px 12px 4px",padding:"2px 8px",width:"fit-content",borderRadius:3},text:{display:"flex",alignItems:"center",color:e.mediumTextColor,fill:e.lightIconColor,fontWeight:500,fontSize:13},icon:{height:10,width:10,marginLeft:4}})),[]),n={width:190,items:["createdTime","lastEditedTime"],selectedItem:t,getKey:e=>e,onSelect:e=>s(e),renderItem:e=>(0,r.jsx)(ue.Z,{title:Sa(e.value),...e}),renderOrigin:e=>(0,r.jsx)(Jt.Z,{...e,style:i.button,children:(0,r.jsxs)("div",{style:i.text,children:[Sa(t),(0,fa.i)(i.icon)]})})};return(0,r.jsx)(ya.Z,{...n,mobileActionSheet:!0})}function Sa(e){return{lastEditedTime:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.lastEditedOn.option",defaultMessage:"Last edited on"}),createdTime:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.createdOn.option",defaultMessage:"Created on"})}[e]}var ba=s(49019);let Ma=function(e){return e.OnChange="on-change",e.Button="button",e}({});const wa=(0,g.defineMessages)({placeholder:{id:"adminContentSearchTab.pagesTable.filters.query.placeholder",defaultMessage:"Search by page ID, title or content"}});function ja(e){let{mode:t,query:s,setQueryFilter:n,placeholderText:a}=e;window.__c={n:"QuerySearchInput"};const[o,l]=(0,i.useState)(s??""),c=(0,lt.yK)((e=>({searchIcon:{color:e.lightIconColor,width:14},input:{padding:"4px 4px 4px 10px",margin:"0 auto 8px",width:"100%",background:e.modalBackground}})),[]),u=(0,i.useMemo)((()=>(0,d.Ds)(n,500)),[n]),m=(0,i.useCallback)((e=>{l(e.target.value),t===Ma.OnChange&&u(e.target.value)}),[u,t]);return(0,r.jsx)(Ue.Z,{value:o,style:c.input,left:(0,ba.e)(c.searchIcon),placeholder:a||$.default.formatMessage(wa.placeholder),onChange:m,onSubmit:()=>n(o),right:t===Ma.Button?(0,r.jsx)(ce.Z,{onClick:()=>n(o),children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.query.searchButton",defaultMessage:"Search"})}):null})}function Ca(e){let{spaceStore:t,sharedWithFilterItems:s,setSharedWithFilter:n,runNewSearch:a,includeGroups:o,includeGuests:l}=e;window.__c={n:"SharedWithFilter"};const d=na({spaceStore:t}),c=(0,i.useMemo)((()=>d.loading?[]:l?[...d.members,...d.guests]:d.members),[d,l]),u=(0,i.useMemo)((()=>d.loading?new Set:new Set(d.guests.map((e=>e.id)))),[d]);return(0,r.jsx)(pa,{isMultiSelect:!0,includePermissionGroups:o,userStores:c,title:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.sharedWith.title",defaultMessage:"Shared with"}),selectedItems:s??[],setSelectedItems:function(e){const t=e.map((e=>{let{id:t,type:s}=e;return{type:s,id:t}}));n(t.length>0?t:void 0)},onMenuClose:a,guestUserIdSet:u})}const ka=(0,g.defineMessages)({placeholder:{id:"adminContentSearchTab.pagesTable.filters.teams.placeholder",defaultMessage:"Search for teamspaces..."}});function _a(e){let{selectedTeamIds:t,setSelectedTeamIds:s,onMenuClose:n,teamStores:a}=e;window.__c={n:"TeamsFilter"};const o=(0,N.qz)(void 0,Ft.Z),l=(0,lt.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center"},optionAvatar:{marginRight:4},pillContainer:{margin:"0px 6px 6px 0px",background:e.legacyDefaultSelectColor,height:20},pillContents:{display:"inline-flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:4},pillText:{marginLeft:4},container:{padding:"6px 0 6px"},input:{margin:"4px auto",width:"95%"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:4,fill:"currentColor"},teamIcon:{marginRight:8},optionTitle:{display:"block"},noResultsMessage:{width:"100%",margin:"8px 12px"},optionCaption:{display:"block",color:e.mediumTextColor,fontSize:12,lineHeight:"15px"}})),[]),[d,c]=(0,i.useState)(!1),[u,m]=(0,i.useState)(""),p=(0,N.VK)((()=>[...a].sort(T.KP)),[a]),h=(0,N.VK)((()=>t.map((e=>a.find((t=>t.id===e)))).filter(_.$K)),[a,t]);function f(){c(!1),m(""),n()}function y(){m(""),s([])}function v(e){const i=t.includes(e)?[]:[e];s(i),m("")}const x=(0,i.useCallback)((e=>{m(e.target.value)}),[]),S=(0,N.VK)((()=>h.map((e=>{const i=e.getName();return(0,r.jsx)(ca.Z,{isSingle:!0,format:aa.l.Inline,showRemoveButton:!0,onClickRemove:()=>{const i=t.filter((t=>t!==e.id));s(i)},style:l.pillContainer,value:(0,r.jsxs)("div",{style:l.pillContents,children:[(0,r.jsx)(Bn.p,{disabled:!0,store:e,size:16}),(0,r.jsx)(It.Z,{style:l.pillText,children:i})]})},e.id)}))),[h,t,s,l]);const b=(0,r.jsx)(Ie.Z,{on:t.length>0,icon:(0,Ji.O)(l.icon),title:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.title",defaultMessage:"Teamspace"}),onClick:()=>c(!0)});return(0,r.jsx)($e.Z,{children:(0,r.jsx)(ge.ZP,{popupType:ge.ZP.PopupType.Popup,placementToOrigin:ge.ZP.Placement.Bottom,alignmentToOrigin:ge.ZP.Alignment.Start,open:d,render:function(){const e=[];for(const n of p){const s=n.getName(),i=n.getTeamAccessLevel(),a=n.isDefault();s&&s.toLocaleLowerCase().includes(u)&&e.push({key:n.id,action:()=>v(n.id),render:e=>(0,r.jsx)(ue.Z,{...e,icon:(0,r.jsx)(da.Z,{isSelected:t.includes(n.id)}),focused:!1,title:(0,r.jsxs)("div",{style:l.optionContainer,children:[(0,r.jsx)(Bn.p,{disabled:!0,store:n,size:24,style:l.teamIcon}),(0,r.jsxs)("div",{style:{paddingTop:4,paddingBottom:4},children:[(0,r.jsx)(It.Z,{style:l.optionTitle,children:s}),(0,r.jsx)(It.Z,{style:l.optionCaption,children:Ta(i,a)})]})]})})})}const s={key:"no-results",action:()=>{},render:e=>(0,r.jsx)(It.Z,{isSecondaryColor:!0,style:l.noResultsMessage,...e,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.noResultsMessage",defaultMessage:"No results found."})})},i={key:"teamOptions",items:e.length>0?e:[s],render:e=>(0,r.jsx)(he.Z,{...e,title:null,loading:!1})};return(0,r.jsxs)("div",{style:l.container,children:[(0,r.jsx)(ua.Z,{focus:!0,value:u,style:l.input,placeholder:$.default.formatMessage(ka.placeholder),onChange:x,onRemoveLastToken:y,tokens:S}),(0,r.jsx)(me.Z,{menuType:ye.og.Popup,header:null,maxHeight:250,width:300,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,store:o,initialFocus:0,sections:[i]})}),(0,r.jsxs)(he.Z,{topBorder:!0,style:l.footer,children:[(0,r.jsx)(Ze.Z,{onClick:y,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.clearButton",defaultMessage:"Clear"})}),(0,r.jsx)(ce.Z,{onClick:f,children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.doneButton",defaultMessage:"Done"})})]})]})},onDismiss:f,keepFocus:!0,origin:b,preventScaleTransition:!0})})}function Ta(e,t){if(t)return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.default",defaultMessage:"Default"});switch(e){case"private":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.private",defaultMessage:"Private"});case"closed":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.closed",defaultMessage:"Closed"});case"open":return(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.filters.teams.caption.open",defaultMessage:"Open"});default:(0,_.t1)(e)}}function Ia(e){let{spaceStore:t,filters:s,runNewSearch:n,setFilters:a}=e;window.__c={n:"FiltersSection"};const o=function(){const[e,t]=(0,i.useState)([]),s=(0,L.O7)(),n=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),a=(0,N.VK)((()=>{var e;return null===(e=I.default.state.currentUserStore)||void 0===e?void 0:e.id}),[]);return(0,i.useEffect)((()=>{!async function(){const e=await(0,T.sj)({spaceStore:n,currentUserId:a,includeArchived:!1,minRoleOnTeamStores:"editor",environment:s});t(e)}()}),[n,a,s]),e}(),l=(0,lt.yK)((e=>({container:{margin:"0 auto 14px"},filterPillsContainer:{width:"100%",display:"flex",flexWrap:"wrap",rowGap:4,flexDirectionRow:"row",alignItemsCenter:"center"}})),[]);return(0,r.jsxs)("div",{style:l.container,children:[(0,r.jsx)(ja,{mode:Ma.Button,query:s.query,setQueryFilter:function(e){a({query:e},{runSearchAfter:!0})}}),(0,r.jsxs)("div",{style:l.filterPillsContainer,children:[(0,r.jsx)(va,{lastEditedTime:s.lastEditedTime,createdTime:s.createdTime,setLastEditedTime:function(e){a({lastEditedTime:e,createdTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})},setCreatedOnTime:function(e){a({createdTime:e,lastEditedTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})}}),(0,r.jsx)(_a,{selectedTeamIds:s.teamIds,setSelectedTeamIds:function(e){a({teamIds:e})},onMenuClose:n,teamStores:o}),(0,r.jsx)(Ca,{spaceStore:t,sharedWithFilterItems:s.sharedWith,setSharedWithFilter:function(e){a({sharedWith:e})},runNewSearch:n,includeGroups:!0,includeGuests:!0}),(0,r.jsx)(en,{selectedAudience:s.audience,setSelectedAudience:function(e){a({audience:e})},onMenuClose:n}),(0,r.jsx)(ga,{spaceStore:t,createdByFilterIds:s.createdBy,setCreatedByFilter:function(e){a({createdBy:e})},runNewSearch:n,includeGuests:!0})]})]})}var Pa=s(26263),Za=s(7406),Fa=s(59753),Aa=s(45953),Da=s(66504);const Ba={query:"",createdBy:[],sharedWith:void 0,audience:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},teamIds:[]},Ra={...Ba,audience:["shared_externally","shared_internally","shared_to_web"]},La={filters:Ba,pageStores:[],numPagesLoaded:0,hasNextPage:!0,paginationToken:void 0,loading:!1,error:void 0,shouldReRunSearch:!1,showSuggestions:!0},Na={...La,filters:Ra};function Ea(e){let{spaceStore:t,userStore:s}=e;const n=(0,N.VK)((()=>Zt.default.checkGate("enabled_bev_default_audience_filter")),[])?Na:La,a=(0,L.O7)(),[o,r]=(0,i.useState)(n),l=(0,i.useRef)(n.filters),c=(0,i.useCallback)((async e=>{let{restartSearch:i,ignoreFilterComparison:n}=e;if(!n&&d.Xy(o.filters,l.current))return;l.current=o.filters;let c=o.loading,u=o.error,m=o.hasNextPage,p=o.numPagesLoaded,g=o.paginationToken;if(i&&(r((e=>({...La,showSuggestions:e.showSuggestions,filters:e.filters}))),c=La.loading,u=La.error,m=La.hasNextPage,p=La.numPagesLoaded,g=La.paginationToken),m&&!c&&!u){r((e=>({...e,showSuggestions:!1,loading:!0})));try{const e=await w.adminContentSearch(a,{spaceId:t.id,sort:{field:"relevance",direction:"desc"},limit:20,paginationToken:g,query:o.filters.query,audience:o.filters.audience,lastEditedTime:(0,X.Hq)(o.filters.lastEditedTime),createdTime:(0,X.Hq)(o.filters.createdTime),createdBy:o.filters.createdBy,sharedWith:o.filters.sharedWith,teamspaceIds:o.filters.teamIds});if("failed"===e.type)throw e.error;y.jdc(a,{filters:o.filters,pageNumber:p});const i=e.data.paginationToken,n=e.data.recordIds,l=function(e){const{recordMapWithRoleJson:t}=e,s=Aa.PF.create(t),i=Aa.PF.create();for(const{pointer:n,model:a}of s)if(a){const e=Fa.kk.fromValue(n.table,d.Xh(a.__IM_SORRY__getValue()));i.setModelAndRole(n,e,"editor")}return i}({recordMapWithRoleJson:e.data.recordMap}),c=new Pa.Z({name:"adminContentSearchSettings.useContentSearch",data:new Da.o({[s.id]:l})});c.addCacheFallback(a.defaultRecordCache.inMemoryRecordCache),r((e=>{const t=[],s=new Set(e.pageStores.map((e=>e.id)));for(const i of n)if(!s.has(i)){const e=new nt.G(a,{table:ds.iU,id:i},{inMemoryRecordCache:c});t.push(e)}const o=[...e.pageStores,...t];return{...e,pageStores:o,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:i,hasNextPage:Boolean(i)}}))}catch(h){const e=(0,Za.tg)(h);r((t=>({...t,loading:!1,error:e})))}}}),[a,t,s,o.filters,o.loading,o.error,o.hasNextPage,o.numPagesLoaded,o.paginationToken]);(0,i.useEffect)((()=>{o.shouldReRunSearch&&(r((e=>({...e,shouldReRunSearch:!1}))),c({restartSearch:!0,ignoreFilterComparison:!1}))}),[o.shouldReRunSearch,c]);const u=(0,i.useCallback)((async()=>{o.shouldReRunSearch||await c({restartSearch:!1,ignoreFilterComparison:!0})}),[o.shouldReRunSearch,c]),m=(0,i.useCallback)((async e=>{await c({restartSearch:!0,ignoreFilterComparison:e||!1})}),[c]),p=(0,i.useCallback)(((e,t)=>{y.gL0(a,{newFilters:e}),r((s=>({...s,filters:{...s.filters,...e},...null!=t&&t.runSearchAfter?{shouldReRunSearch:null==t?void 0:t.runSearchAfter}:void 0})))}),[a]);return{showSuggestions:o.showSuggestions,filters:o.filters,pageStores:o.pageStores,loading:o.loading,error:o.error,hasNextPage:o.hasNextPage,loadNextPage:u,runNewSearch:m,setFilters:p}}const Oa=function(e){let{spaceStore:t,userStore:s}=e;window.__c={n:"AdminContentSearchTab"};const i=(0,L.O7)(),n=(0,N.VK)((()=>Vi.Z.state.online),[]),{showSuggestions:a,loadNextPage:o,pageStores:l,loading:d,error:c,runNewSearch:u,filters:m,setFilters:p}=Ea({spaceStore:t,userStore:s});return n?(0,r.jsxs)(Ui.Z,{children:[(0,r.jsx)(zt.Z,{large:!i.device.isMobile||void 0,divider:i.device.isMobile?void 0:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.title",defaultMessage:"Content Search"})}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:24},children:[(0,r.jsx)(It.Z,{isMultiline:!0,style:{marginBottom:20},children:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.description",defaultMessage:"Search and filter for any page in the workspace, including private pages. Only workspace owners can use content search."})}),(0,r.jsx)(Wi,{spaceId:t.id,disabled:0===l.length,filters:m})]}),(0,r.jsx)(Ia,{spaceStore:t,runNewSearch:u,setFilters:p,filters:m}),(0,r.jsx)(sa,{loading:d,error:c,pageStores:l,loadNextPage:o,filters:m,setFilters:p,showSuggestions:a,runNewSearch:u})]}):(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to access content search.",id:"adminContentSearchTab.offline.message"})})})};var Va=s(98692),Ua=s(76463),Wa=s(61202),za=s(38755),Ka=s(72087),Ha=s(80920),Ga=s(74181),qa=s(90965),Ya=s(94826),Qa=s(9953),$a=s(1865),Xa=s(72371),Ja=s(74021),eo=s(17549),to=s(30874),so=s(20454),io=s(35057),no=s(47453),ao=s(77657),oo=s(9844),ro=s(77137),lo=s(78948);function co(e){window.__c={n:"AdminIntegrationSettingsSearchResults"};const{query:t}=e,s=(0,L.O7)(),n=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),a=(0,N.VK)((()=>null==n?void 0:n.getBotSettingsStore().getValue()),[n]),o="approved_or_built_by_notion"===(null==a?void 0:a.integration_restrictions),l=(0,N.VK)((()=>null!=a&&a.integration_approval_statuses?Object.keys(a.integration_approval_statuses):[]),[a]),d=(0,N.VK)((()=>Object.keys(ao.u2).map((e=>{const t=null==n?void 0:n.getRecordModel({id:e,table:oo.K2});if("published"===(null==t?void 0:t.status))return e})).filter(_.$K)),[n]),u=(0,i.useMemo)((()=>d.some((e=>e===ao.f3))),[d]),m=(0,N.VK)((()=>d.filter((e=>!l.includes(e))).slice(0,5)),[l,d]);return(0,r.jsx)(me.Z,{menuType:ye.og.Popup,width:255,header:po(t,m,o),children:(0,r.jsx)(ro.Z,{request:t,performRequest:e=>async function(e){const{query:t,integrationType:s,environment:i,spaceId:n,approvedIntegrationIds:a,popularIntegrationIds:o,autoApproveBuiltByNotion:r}=e;if(!Vi.Z.state.online||!n)return[];if((0,c.e)(t)||(0,c.qn)(t))return[t];if(""===t&&!r)return o;const l=await w.searchIntegrations(i,{query:t,type:s,spaceId:n});if("success"===l.type){const e=l.data.integrationIds.filter((e=>!a.includes(e))),t="production";if(!r){return e.sort(((e,s)=>(0,ao.BP)({integrationId:e,env:t})===(0,ao.BP)({integrationId:s,env:t})?0:(0,ao.BP)({integrationId:e,env:t})?-1:1)).slice(0,5)}return e.filter((e=>!(0,ao.BP)({integrationId:e,env:t}))).slice(0,5)}if("failed"===l.type)throw l.error;return(0,_.t1)(l)}({query:e,environment:s,spaceId:null==n?void 0:n.id,approvedIntegrationIds:l,popularIntegrationIds:m,autoApproveBuiltByNotion:o}),debounce:Y.vp,render:(i,o,d)=>{if(!o||!d)return(0,r.jsx)(he.Z,{children:(0,r.jsx)(lo.Z,{})});const c=Ga.ns.filter((e=>t&&e.name.toLowerCase().includes(t.toLowerCase())&&!l.includes(e.id)&&(e.id!==Ga._o||!u))),m=[];if(0===o.length&&0===c.length)m.push({key:"no_results",render:()=>(0,r.jsx)(It.Z,{isSmall:!0,style:{marginLeft:8},children:(0,r.jsx)(g.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})}),action:()=>{}});else{const t=o.map((t=>{var i;const o={table:oo.K2,id:t};if(!n)return;const l=nt.y2.createChildStore(n,o),d=null===(i=l.getInfo())||void 0===i?void 0:i.icon;return{key:`${t}`,render:e=>{var t;return(0,r.jsx)(ue.Z,{...e,title:(0,r.jsx)(It.Z,{style:{fontWeight:p.Z.fontWeight.semibold},children:l.getName()}),icon:d&&(0,r.jsx)(Zn.Z,{disabled:!0,icon:{pointer:o,icon:d},isEmptyPage:!1,size:20}),style:d?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:(0,r.jsx)(go,{tagline:null===(t=l.getInfo())||void 0===t?void 0:t.tagline,isNotionIntegration:(0,ao.BP)({integrationId:l.id,env:"production"})}),className:"notranslate"})},action:()=>{e.closeDropdown(),mo({environment:s,currentSpaceStore:n,botSettings:a,integrationId:t})}}})).filter(_.$K),i=c.map((t=>({key:`${t.id}`,render:e=>(0,r.jsx)(ue.Z,{...e,title:(0,r.jsx)(It.Z,{style:{fontWeight:p.Z.fontWeight.semibold},children:t.name}),icon:(0,r.jsx)("img",{src:t.info.icon,style:{height:20}}),caption:t.info.tagline,style:{paddingBottom:12},shouldWrapCaption:!0,className:"notranslate"}),action:()=>{e.closeDropdown(),mo({environment:s,currentSpaceStore:n,botSettings:a,integrationId:t.id})}}))).filter(_.$K);m.push(...t,...i)}return(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,r.jsx)(he.Z,{...e}),items:m}]})}})})}function uo(e){window.__c={n:"AdminComplianceIntegrationSettingsSearchResults"};const{query:t}=e,s=(0,L.O7)(),i=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]);return i?(0,r.jsx)(me.Z,{menuType:ye.og.Popup,width:255,header:po(t,[],!1),children:(0,r.jsx)(ro.Z,{request:t,performRequest:e=>async function(e){const{query:t,environment:s,spaceId:i}=e;if(!Vi.Z.state.online||!i)return[];if((0,c.e)(t)||(0,c.qn)(t))return[t];const n=await w.searchIntegrations(s,{query:t,type:"compliance",spaceId:i});if("success"===n.type)return n.data.integrationIds;if("failed"===n.type)throw n.error;return(0,_.t1)(n)}({query:e,environment:s,spaceId:null==i?void 0:i.id}),debounce:Y.vp,render:(t,s,n)=>{if(!s||!n)return(0,r.jsx)(he.Z,{children:(0,r.jsx)(lo.Z,{})});const a=[];if(0===s.length)a.push({key:"no_results",render:()=>(0,r.jsx)(It.Z,{isSmall:!0,style:{marginLeft:8},children:(0,r.jsx)(g.FormattedMessage,{id:"adminIntegrationSettings.search.label.noResults",defaultMessage:"No results"})}),action:()=>{}});else{const t=Xa.Z.state.loaded&&to.Z.state.loaded?Xa.Z.state.webhookSubscriptions.map((e=>{var t;return null===(t=to.Z.getBotsAsRecordMap().getValue({table:G.cZ,id:e.bot_id}))||void 0===t?void 0:t.integration_id})):[],n=s.map((s=>{const n=nt.y2.createChildStore(i,{id:s,table:oo.K2});if(t.includes(s))return;const a={table:oo.K2,id:s},o=nt.y2.createChildStore(i,a),l=(0,Ya.I$)(o.id);return{key:`${s}`,render:e=>(0,r.jsx)(ue.Z,{...e,title:(0,r.jsx)(It.Z,{style:{fontWeight:p.Z.fontWeight.semibold},children:o.getName()}),icon:(null==l?void 0:l.icon)&&(0,r.jsx)(Zn.Z,{disabled:!0,icon:{pointer:a,icon:l.icon},isEmptyPage:!1,size:20}),style:null!=l&&l.icon?{paddingBottom:12}:{paddingLeft:30,paddingBottom:12},shouldWrapCaption:!0,caption:(0,r.jsx)(go,{tagline:null!=l&&l.tagline?$.default.formatMessage(null==l?void 0:l.tagline):"A SIEM or DLP partner",isNotionIntegration:!1})}),action:()=>{var t;e.closeDropdown();n.getModel()&&(null!=l&&null!==(t=l.oauth)&&void 0!==t&&t.accountInfoPropertyNames||"dlp"===(null==l?void 0:l.type))?eo.Z.setState({open:!0,integrationId:o.id}):Ja.Z.setState({open:!0,integrationId:o.id})}}})).filter(_.$K);a.push(...n)}return(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,r.jsx)(he.Z,{...e}),items:a}]})}})}):null}function mo(e){const{environment:t,currentSpaceStore:s,botSettings:i,integrationId:n}=e;if(s&&!(0,Ya.z6)(n)){const e={...null==i?void 0:i.integration_approval_statuses,[n]:{type:"integration",status:"approved"}};B.createAndCommit({userAction:"AdminIntegrationSettingsSearchResults.handleIntegrationSelection",environment:t,perform:t=>{Qa.sW({store:s,data:{bot_settings:{...i,integration_approval_statuses:e}},transaction:t})}})}}const po=(e,t,s)=>!e&&!s&&t.length>0&&(0,r.jsx)(_n.Z,{title:(0,r.jsx)(It.Z,{isSmall:!0,style:{marginTop:4,fontWeight:p.Z.fontWeight.medium},children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Popular integrations",id:"adminIntegrationSettings.search.title.popularIntegrations"})})}),go=e=>{window.__c={n:"IntegrationCaption"};const{tagline:t,isNotionIntegration:s}=e,i=(0,lt.Fg)(),n=s?{}:{maxHeight:52,overflow:"auto"};return t?(0,r.jsxs)("div",{style:n,children:[t,s&&(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:8},children:[(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Developed by Notion",id:"adminIntegrationSettings.search.subtitle.notionBuilt"}),(0,Ha.X)({marginLeft:3,width:12,height:12,fill:i.invoiceGreen})]})]}):null},ho=(0,g.defineMessages)({searchInputPlaceholder:{id:"adminConnectionsSettings.search.input.placeholder",defaultMessage:"Add by name or integration ID"},complianceIntegrationSearchInputPlaceholder:{id:"adminConnectionsSettings.search.input.complianceIntegrationPlaceholder",defaultMessage:"Add by name"}});function fo(){window.__c={n:"AdminConnectionsSettingsAddMenu"};const e=(0,L.O7)(),t=(0,lt.Fg)(),[s,n]=(0,i.useState)(!0),[a,o]=(0,i.useState)(!1),[l,d]=(0,i.useState)(""),c=i.createRef();return s?(0,r.jsx)(Jt.Z,{style:{display:"flex",alignItems:"center",height:28,fontWeight:p.Z.fontWeight.medium,fontSize:p.Z.fontSize.UIRegular.desktop,color:mt.ZP.blue,padding:"0px 6px"},onClick:()=>{n(!1)},children:(0,r.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.search.button.label",defaultMessage:"{plusIcon} Add approved connection",values:{plusIcon:(0,no.R)({fill:mt.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})}):(0,r.jsx)(ge.ZP,{alignmentToOrigin:ge.ZP.Alignment.Start,keepFocus:e.device.isPhone,onDismiss:()=>{var e;null===(e=c.current)||void 0===e||e.handleBlur(),n(!0),o(!1)},origin:(0,r.jsx)(Ue.Z,{type:"text",style:{width:255},left:(0,no.R)({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),ref:c,value:l,onFocus:()=>{o(!0)},placeholder:$.default.formatMessage(ho.searchInputPlaceholder),onChange:e=>d(e.target.value)}),open:a,popupType:ge.ZP.PopupType.Popup,style:{width:255},render:()=>(0,r.jsx)(co,{query:l,closeDropdown:()=>o(!1)})})}function yo(){window.__c={n:"AdminConnectionsSettingsAddComplianceMenu"};const e=(0,L.O7)(),t=(0,lt.Fg)(),[s,n]=(0,i.useState)(!0),[a,o]=(0,i.useState)(!1),[l,d]=(0,i.useState)(""),c=i.createRef();return s?(0,r.jsx)(Ze.Z,{isBlue:!0,style:{display:"flex",alignItems:"center",height:28,fontWeight:p.Z.fontWeight.medium,fontSize:p.Z.fontSize.UIRegular.desktop,color:mt.ZP.blue,padding:"0px 6px"},onClick:()=>{var e;n(!1),null===(e=c.current)||void 0===e||e.focusInput()},children:(0,r.jsx)(g.FormattedMessage,{id:"adminConnectionsSettingsAddComplianceMenu.search.button.label",defaultMessage:"{plusIcon} Add connection",values:{plusIcon:(0,no.R)({fill:mt.ZP.blue,width:14,height:14,flexGrow:0,flexShrink:0})}})}):(0,r.jsx)(ge.ZP,{alignmentToOrigin:ge.ZP.Alignment.Start,keepFocus:e.device.isPhone,onDismiss:()=>{var e;null===(e=c.current)||void 0===e||e.handleBlur(),n(!0),o(!1)},origin:(0,r.jsx)(Ue.Z,{type:"text",style:{width:255},left:(0,no.R)({fill:t.lightIconColor,width:14,height:14,marginRight:8,flexGrow:0,flexShrink:0}),focus:!0,ref:c,value:l,onFocus:()=>{o(!0)},placeholder:$.default.formatMessage(ho.complianceIntegrationSearchInputPlaceholder),onChange:e=>d(e.target.value)}),open:a,popupType:ge.ZP.PopupType.Popup,style:{width:255},render:()=>(0,r.jsx)(uo,{query:l,closeDropdown:()=>{n(!0),o(!1)}})})}var vo=s(35878),xo=s(94512),So=s(70578),bo=s(61519),Mo=s(74420),wo=s(42402),jo=s(55422),Co=s(66957);const ko=["member_connections","workspace_connections"];function _o(e){window.__c={n:"AdminConnectionsSettings"};const t=(0,L.O7)(),{isMobile:s}=t.device,{guestBotIds:n}=e,a=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),o=(0,N.VK)((()=>Xa.Z.webhookSubscriptions.state.reduce(((e,t)=>{const s=t.getBotId();return s&&(e[s]=t.id),e}),{})),[]),l=(0,N.VK)((()=>Zt.default.checkGate("webhooks_beta")),[]),c=(0,N.VK)((()=>Zt.default.checkGate("webhook_discovery_tile")),[]),u=(0,N.VK)((()=>a?(0,d.jj)([...n,...to.Z.bots.state.map((e=>e.id))]).map((e=>{const t=nt.Qx.createChildStore(a,{table:G.cZ,id:e,spaceId:a.id});return t.getAlive()?t:void 0})).filter(_.$K):[]),[a,n]),m=(0,N.VK)((()=>function(e){return e.reduce(((e,t)=>{const s=t.getIntegrationId();if(!s)return e;return(0,Ya.EY)(s)?(s in e.compliance||(e.compliance[s]=[]),e.compliance[s].push(t.id)):(s in e.nonCompliance||(e.nonCompliance[s]=[]),e.nonCompliance[s].push(t.id)),e}),{compliance:{},nonCompliance:{}})}(u)),[u]),h=(0,N.VK)((()=>function(e){return e.filter((e=>!e.getIntegrationId())).map((e=>e.id))}(u)),[u]),f=(0,N.VK)((()=>function(e,t){if(!t)return{};return e.reduce(((e,s)=>{const i=so.U.createChildStore(t,{table:q.KJ,id:s.getCreatedById()}),n=s.getIntegrationId();return n?e[n]=n in e?[...e[n],i]:[i]:e[s.id]=[i],e}),{})}(u,a)),[u,a]),y=(0,N.VK)((()=>null==a?void 0:a.getBotSettingsStore().getValue()),[a]),v=(0,N.VK)((()=>Object.keys(m.nonCompliance).length+h.length),[m.nonCompliance,h]),x=(0,N.VK)((()=>Object.values(m.compliance).flat().length),[m.compliance]),S=(0,N.VK)((()=>null!=y&&y.integration_approval_statuses?Object.keys(y.integration_approval_statuses).length+h.length:h.length),[y,h]),b={member_connections:(0,r.jsx)(g.FormattedMessage,{id:"admin.connections.tabs.member_connections",defaultMessage:"Member{numberOfIntegrations}",values:{numberOfIntegrations:0!==v&&(0,r.jsx)(It.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:v+Ga.T2.length})}}),workspace_connections:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.FormattedMessage,{id:"admin.connections.tabs.workspace_connections",defaultMessage:"Workspace{numberOfIntegrations}",values:{numberOfIntegrations:0!==x&&(0,r.jsx)(It.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:x})}}),(0,r.jsx)(Mo.Z,{})]})},M=ko.map((e=>b[e])),w=(0,N.VK)((()=>"integrations"===Ai.Z.state.currentTab?Ai.Z.state.defaultSubtab:void 0),[]),j=(0,N.VK)((()=>Xa.Z.integrations.state),[]),[C,k]=(0,i.useState)(w||"member_connections"),T=(0,N.VK)((()=>(0,io.wP)()),[]),P=(0,lt.yK)((e=>({connectedSection:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:19,marginTop:20,position:"relative"},addMenu:{position:"absolute",right:0,top:0},discoverSectionUpsell:{backgroundColor:e.accentColors.interactiveBlue[100],padding:16,borderRadius:4},discoverSectionHeader:{display:"flex",justifyContent:"space-between"},discoverSectionTitle:{fontSize:16,fontWeight:510},discoverSectionSubtitle:{fontSize:14,marginRight:8,color:e.lightTextColor,fontWeight:400},learnMoreButton:{padding:"0px 8px",borderRadius:4,display:"flex",alignItems:"center",color:e.blueColor},upgradeButton:{marginLeft:12,padding:"0px 14px"},alias:{marginLeft:6,width:"0.9em",height:"0.9em",padding:1,border:"1px solid",borderRadius:2}})),[]),Z={member_connections:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(To,{}),(null==y?void 0:y.integration_restrictions)&&(0,r.jsx)("div",{style:{marginTop:"19px"},children:(0,r.jsx)(Io,{})}),(0,r.jsx)(bo.Z,{size:s?32:18,isHidden:!s}),Boolean(null==y?void 0:y.integration_restrictions)?(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:19},children:[(0,r.jsx)(It.Z,{style:{fontWeight:p.Z.fontWeight.medium,display:"flex",alignItems:"center",height:28},children:(0,r.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.table.allowIntegrations.title",defaultMessage:"Approved connections{numberOfIntegrations}",values:{numberOfIntegrations:0!==S&&(0,r.jsx)(It.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:S})}})}),(0,r.jsx)(fo,{})]}):(0,r.jsx)(It.Z,{style:{fontWeight:p.Z.fontWeight.medium,display:"flex",height:28,alignItems:"center",marginBottom:"19px"},children:(0,r.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.table.default.title",defaultMessage:"All connections{numberOfIntegrations}",values:{numberOfIntegrations:0!==v&&(0,r.jsx)(It.Z,{isSecondaryColor:!0,style:{marginLeft:6},children:v+Ga.T2.length})}})}),(0,r.jsx)(vo.ZP,{integrationIdToBotIds:m.nonCompliance,internalIntegrationIds:h,integrationIdToUsers:f}),(0,r.jsx)("div",{style:{marginTop:16,marginBottom:32,display:"grid",gridTemplateColumns:"1fr",gap:4},children:(0,r.jsx)(So.Z,{})})]}),workspace_connections:()=>{const e=Object.keys(m.compliance),s=!c||e.length>0,i=function(e){const{allIntegrations:t,connectedIntegrationIds:s}=e,i=[];for(const n of t)if(!s.includes(n.id)){const e=(0,Ya.I$)(n.id);if(!e)continue;i.push({id:n.id,appName:n.name,account:void 0,caption:n.getInfo().tagline,logo:n.getInfo().icon,shouldHideInDiscover:!1,shouldShowNewBadge:!1,shouldHideConnectAccount:!0,integrationTypes:[e.type],capabilities:(0,r.jsx)(r.Fragment,{}),canSelectPageAccess:!1,onConnect:()=>{var t;null!=e&&null!==(t=e.oauth)&&void 0!==t&&t.accountInfoPropertyNames||"dlp"===(null==e?void 0:e.type)?eo.Z.setState({open:!0,integrationId:n.id}):Ja.Z.setState({open:!0,integrationId:n.id})},onDisconnect:()=>{}})}return i}({allIntegrations:j,connectedIntegrationIds:e});return(0,r.jsx)(r.Fragment,{children:l?(0,r.jsxs)(r.Fragment,{children:[s&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{style:P.connectedSection,children:[(0,r.jsx)("div",{style:P.addMenu,children:(0,r.jsx)(yo,{})}),(0,r.jsx)(vo.cP,{botIdToWebhookSubscriptionId:o,complianceIntegrationsIdToBotIds:m.compliance})]})}),c&&(0,r.jsx)("div",{style:{...T?{}:P.discoverSectionUpsell,marginTop:s?32:void 0},children:(0,r.jsx)(xo.Z,{apps:i,numberOfConnectedApps:e.length,title:(0,r.jsxs)("div",{style:P.discoverSectionHeader,children:[(0,r.jsx)("div",{style:P.discoverSectionTitle,children:T?(0,r.jsx)(g.FormattedMessage,{id:"connectionsSettings.discoverNewConnectionsSection.title",defaultMessage:"Discover new connections"}):(0,r.jsx)(g.FormattedMessage,{id:"connectionsSettings.discoverNewConnectionsSection.titleUpsell",defaultMessage:"Upgrade to Enterprise to use these connections"})}),!T&&(0,r.jsx)(ce.Z,{style:P.upgradeButton,isLarge:!0,onClick:()=>{$a.y(t,{from:"workspace_connections",for:"enterprise"})},children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Upgrade",id:"connectionsSettings.discoverNewConnectionsSection.upgrade"})})]}),subtitle:(0,r.jsx)("span",{style:P.discoverSectionSubtitle,children:(0,r.jsx)(g.FormattedMessage,{id:"admin.connections.tab.workspace_connections.header",defaultMessage:"These integrations connect your workspace to external apps, or improve security and compliance. Only workspace owners can install them."})})})})]}):null})}},F=e=>Z[e];return l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Co.Z,{tabs:M,selectedIndex:ko.findIndex((e=>e===C)),onChange:e=>(e=>{k(ko[e])})(e),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),F(C)()]}):F("member_connections")()}const To=()=>{window.__c={n:"RequireApprovalDropdown"};const e=(0,L.O7)(),t=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),{isMobile:s}=e.device,i=(0,N.VK)((()=>(0,io.wP)()),[]),n=(0,N.VK)((()=>null==t?void 0:t.getBotSettingsStore().getValue()),[t]);return(0,r.jsx)(jo.Z,{isMobile:s,title:(0,r.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.title",defaultMessage:"Restrict members from adding connections"}),caption:(0,qa.CJ)(n)?(0,r.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.allowList.workspaceOwner.caption",defaultMessage:"Workspace members can only install connections pre-approved by workspace owners."}):(0,r.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.requireApprovalSetting.off.caption",defaultMessage:"Workspace members can install any new connection."}),upsellOptions:{shouldUpsell:!i,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"dropdown",currentOption:(0,qa.CJ)(n)?"allow_list":"any_integrations",options:[{key:"any_integrations",label:(0,r.jsx)(g.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.off.title",defaultMessage:"No restrictions"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.off.caption",defaultMessage:"Workspace members can install any connection."})},{key:"allow_list",label:(0,r.jsx)(g.FormattedMessage,{id:"adminIntegrationSettings.integrationRestrictions.allowList.title",defaultMessage:"Only from approved list"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.allowList.caption",defaultMessage:"Workspace members can only install connections pre-approved by a workspace owner."})}],onSelectOption:s=>{!function(e){const{environment:t,currentSpaceStore:s,botSettings:i,setting:n}=e;if(s){if("allow_list"===n&&(0,qa.CJ)(i))return;const e="allow_list"===n?"approved_only":void 0;B.createAndCommit({userAction:"AdminIntegrationSettings.handleIntegrationRestrictionSelect",environment:t,perform:t=>{Qa.sW({store:s,data:{bot_settings:{...i,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:t,botSettings:n,setting:s})},info:[{key:"learn_more",label:(0,r.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.connectionRestrictions.info.title",defaultMessage:"Workspace owners can always install and approve new connections."})}]})};const Io=()=>{window.__c={n:"AutoApproveBuiltByNotionToggle"};const e=(0,L.O7)(),t=(0,lt.Fg)(),s=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),{isMobile:i}=e.device,n=(0,N.VK)((()=>(0,io.wP)()),[]),a=(0,N.VK)((()=>null==s?void 0:s.getBotSettingsStore().getValue()),[s]);return(0,r.jsx)(jo.Z,{isMobile:i,title:(0,r.jsx)(g.FormattedMessage,{id:"adminConnectionsSettings.autoApproveBuiltByNotion.title",defaultMessage:"Auto-approve <builtbynotion>Built by Notion</builtbynotion> connections",values:{builtbynotion:e=>(0,r.jsxs)("span",{style:{color:t.invoiceGreen,marginRight:4,marginLeft:4},children:[(0,Ha.X)({width:14,display:"inline",verticalAlign:"bottom",marginRight:2}),e]})}}),caption:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Toggle this on to approve all workspace members to install connections <helpcenterlink>built by Notion</helpcenterlink>.",id:"adminConnectionsSettings.autoApproveBuiltByNotion.caption",values:{helpcenterlink:e=>(0,r.jsx)(wo.Z,{href:(0,yi.UY)("guides.enterpriseIntegrationSettings"),children:e})}}),upsellOptions:{shouldUpsell:!n,subscriptionTier:"enterprise",analyticsName:"integration_settings"},type:"toggle",isOn:"approved_or_built_by_notion"===(null==a?void 0:a.integration_restrictions),onToggle:()=>function(e){const{environment:t,currentSpaceStore:s,botSettings:i}=e;if(s){const e="approved_or_built_by_notion"===(null==i?void 0:i.integration_restrictions)?"approved_only":"approved_or_built_by_notion";B.createAndCommit({userAction:"AdminIntegrationSettings.handleAutoApproveBuiltByNotionToggle",environment:t,perform:t=>{Qa.sW({store:s,data:{bot_settings:{...i,integration_restrictions:e}},transaction:t})}})}}({environment:e,currentSpaceStore:s,botSettings:a})})};var Po=s(25777);class Zo extends n.Z{constructor(){super(...arguments),this.storeTypes={requestStore:Ka.Z},this.renderResult=(e,t,s)=>{const{currentSpaceStore:i}=I.default.state;if(i)return(0,r.jsxs)(Po.Z,{loaded:s,spinnerSize:16,showSpinnerTimeout:600,children:[e&&(0,r.jsx)("div",{children:(0,r.jsx)(g.FormattedMessage,{id:"spaceIntegrationSettings.error",defaultMessage:"Something went wrong…"})}),t&&(0,r.jsx)(_o,{...t})]})},this.fetchBotsInSpace=async e=>{let{spaceId:t}=e;return{guestBotIds:(await Promise.all([Ua.Yw({environment:this.environment,table:us.bx,id:t,type:"guest"}),Ua.Yw({environment:this.environment,table:us.bx,id:t,type:"external"}),Wa.pJ({environment:this.environment})]))[0].botIds}}}renderComponent(){const{device:e}=this.environment;if((0,za.Fn)(this.environment))return(0,r.jsxs)(Ui.Z,{children:[(0,r.jsx)(zt.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full",style:{paddingBottom:12},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceConnectionsSettings.title",defaultMessage:"Connections"})}),this.renderRequest()]});x.r$({currentTab:"members"})}renderRequest(){const{spaceStore:e,userStore:t}=this.props;return(0,r.jsx)(ro.Z,{requestStore:this.stores.requestStore,request:{spaceId:e.id,userId:t.id},performRequest:this.fetchBotsInSpace,render:this.renderResult})}}Zo.displayName="IntegrationSettings";const Fo=(0,g.injectIntl)(Zo);var Ao=s(36488),Do=s(56940),Bo=s(50506),Ro=s(79603),Lo=s(53770);const No=[50,100,200,500,1e3];function Eo(e){let{spaceStore:t,samlConfigStore:s,memberCountFilter:n,isPrimarySpace:a}=e;const o=(0,L.O7)(),r=(0,N.VK)((()=>s.state.emailDomains),[s]),[l,d]=(0,i.useState)({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),c=(0,N.VK)((()=>(0,io.wP)()),[]),u=(0,i.useCallback)((async e=>{if(c&&0!==r.length&&a&&l.nextEarliestCreatedAt&&!l.loading&&!(e&&l.numPagesLoaded>0||l.error)){d((e=>({...e,loading:!0})));try{const{spaces:e,earliestCreatedAt:s,hasMoreSpaces:i}=await(0,Lo.XD)({fn:async()=>await async function(e,t,s,i,n){const a=await w.getSpacesCreatedByUserWithDomains(e,{spaceId:t,emailDomains:s,spacesLimit:10,memberCountFilter:n,spaceCreatedTimeUpperBound:i});if("failed"===a.type)throw a.error;return{spaces:a.data.results.map((e=>({id:e.id,name:e.spaceName,icon:e.spaceIcon,createdAt:e.spaceCreatedTime,memberCount:e.memberCount,subscriptionTier:e.subscriptionTier,creatorEmailDomain:e.spaceCreatedByDomain,creator:e.spaceCreator,admins:e.admins,spaceRequest:e.spaceRequest,isDelinquent:e.isDelinquent,isPendingBilling:e.isPendingBilling,isActorInSpace:e.isActorInSpace}))),earliestCreatedAt:a.data.hasMoreSpaces?a.data.earliestCreatedAt:void 0,hasMoreSpaces:a.data.hasMoreSpaces}}(o,t.id,r,l.nextEarliestCreatedAt?l.nextEarliestCreatedAt-1:Date.now(),n),handleError:(e,t)=>t?{status:"throw",error:e}:{status:"retry"},retryAttemptsMS:No,retryAttemptRandomOffsetMS:50,initialInput:void 0});d((t=>{const n=[...t.spaces],a=new Set(t.spaces.map((e=>e.id)));for(const s of e)a.has(s.id)||n.push(s);return{spaces:n,nextEarliestCreatedAt:s,numPagesLoaded:t.numPagesLoaded+1,hasNextPage:i,loading:!1,error:void 0}}))}catch(s){const e=(0,Za.tg)(s);d((t=>({...t,loading:!1,error:e})))}}}),[o,c,n,a,t,r,l.nextEarliestCreatedAt,l.numPagesLoaded,l.loading,l.error]);const m=(0,i.useCallback)((async()=>{await u(!1)}),[u]),p=(0,i.useCallback)((async()=>{await u(!0)}),[u]),g=(0,i.useCallback)((async()=>{d({spaces:[],nextEarliestCreatedAt:Date.now(),numPagesLoaded:0,hasNextPage:!1,loading:!1,error:void 0}),await u(!0)}),[u]);return{claimableSpaces:l.spaces,loading:l.loading,error:l.error,hasNextPage:l.hasNextPage,loadFirstPage:p,loadNextPage:m,resetFirstPage:g,setSpaceRequest:function(e,t){d((s=>{const i=s.spaces.map((s=>s.id===e?{...s,spaceRequest:t}:s));return{...s,spaces:i}}))},removeClaimableSpace:function(e){d((t=>{const s=t.spaces.filter((t=>t.id!==e));return{...t,spaces:s}}))}}}var Oo=s(59054);async function Vo(e){const{environment:t,spaceId:s,store:i}=e;if(!(0,io.Rs)())return i.reset(),{};const n=await w.getSamlConfigForSpace(t,{spaceId:s});if("failed"===n.type)v.showError(n);else if(n.data&&n.data.samlConfig){const e={...n.data.samlConfig,useMetadataUrl:!Boolean(n.data.samlConfig.idpMetadata)};return i.setState(e),n.data}return i.reset(),{}}const Uo="settings-page",Wo="workspaces-page",zo="managed-users-page";let Ko=function(e){return e[e.Single=0]="Single",e[e.Multi=1]="Multi",e}({});const Ho=(0,i.createContext)(null),Go=e=>{let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n,children:a}=e;window.__c={n:"PageProvider"};const o=(0,L.O7)(),[l,d]=(0,i.useState)(Uo),[c,u]=(0,i.useState)(Ko.Single),m=(0,N.VK)((()=>s.state.emailDomains),[s]),p=(0,N.VK)((()=>Boolean(s.state.id)&&s.state.id===t.id),[s,t]),{loading:g,error:h,loaded:f}=function(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i}=e;const n=(0,L.O7)(),[{status:a,error:o}]=(0,Oo.r5)((async()=>{var e;const a=await Vo({environment:n,spaceId:t.id,store:s});if((0,O.Zw)(a))return a;const o=null===(e=a.samlConfig)||void 0===e?void 0:e.id;return o?{samlResponse:a,domainResponse:await i.updateValueForSpace({environment:n,spaceId:o,store:i})}:{samlResponse:a,domainResponse:void 0}}),[n,s,t,i]);return{loading:"pending"===a,loaded:"resolved"===a,error:o}}({spaceStore:t,samlConfigStore:s,domainSettingsStore:n}),{loading:v,error:x,claimableSpaces:S,setSpaceRequest:b,removeClaimableSpace:M,hasNextPage:j,loadNextPage:C,loadFirstPage:k,resetFirstPage:_}=Eo({spaceStore:t,samlConfigStore:s,isPrimarySpace:p,memberCountFilter:"single"}),{loading:T,error:I,claimableSpaces:P,setSpaceRequest:Z,removeClaimableSpace:F,hasNextPage:A,loadNextPage:D,loadFirstPage:B,resetFirstPage:R}=Eo({spaceStore:t,samlConfigStore:s,isPrimarySpace:p,memberCountFilter:"multi"}),E=S.length+P.length>0,[V,U,W,z,K,H,G,q]=c===Ko.Single?[v,x,S,b,M,j,C,k,_]:[T,I,P,Z,F,A,D,B,R],{loading:Y,error:Q,domainVerifications:$}=function(e){let{spaceStore:t}=e;const s=(0,L.O7)(),[n,a]=(0,i.useState)([]),[{status:o,error:r}]=(0,Oo.r5)((async()=>{const e=await w.getDomainVerificationCodesForSpace(s,{spaceId:t.id,verifiedOnly:!0});"success"===e.type?a(e.data.domainVerifications):a([])}),[s,t]);return{loading:"pending"===o,domainVerifications:"resolved"===o?n:[],error:r}}({spaceStore:t,emailDomains:m});(0,i.useEffect)((()=>{k(),B()}),[W,k,B]);const X={page:l,navigateTo:function(e){d(e),0===S.length&&P.length>0&&u(Ko.Multi),"workspaces-page"===e&&y.Cez(o,{verifiedDomains:m,tab:c===Ko.Single?"single":"multi"})},loadingSaml:g,loadingSpaces:V,loadingVerifications:Y,errorSaml:h,errorClaimableSpaces:U,errorVerifications:Q,loadedSaml:f,domainVerifications:$,hasBrowsableSpaces:E,claimableSpaces:W,setSpaceRequest:z,removeClaimableSpace:K,resetInitialClaimableSpaces:q,hasMoreClaimableSpaces:H,loadMoreClaimableSpaces:G,tab:c,setSelectedTab:function(e){u(e),"workspaces-page"===l&&y.Cez(o,{verifiedDomains:m,tab:e===Ko.Single?"single":"multi"})},verifiedDomains:m};return(0,r.jsx)(Ho.Provider,{value:X,children:a})};var qo=s(84169),Yo=s(19981),Qo=s(66466),$o=s(25651),Xo=s(29851),Jo=s(2356),er=s(37612);let tr=function(e){return e.User="user",e.Domains="domains",e}({});var sr=s(64964);const ir={managedUsers:[],filters:{query:"",multiFactorStatus:void 0,workspaceId:void 0},numPagesLoaded:0,hasNextPage:!0,paginationToken:void 0,loading:!1,error:void 0};function nr(e){let{spaceStore:t,samlConfigStore:s,userStatus:n}=e;const a=(0,L.O7)(),[o,r]=(0,i.useState)(ir),l=(0,i.useRef)(o.filters),c=(0,N.VK)((()=>Boolean(s.state.id)&&s.state.id===t.id),[s,t]),u=(0,N.VK)((()=>s.state.emailDomains),[s]),m=(0,i.useCallback)((async e=>{if(0===u.length)return;if(!c)return;let s=o.loading,i=o.error,d=o.hasNextPage,m=o.paginationToken;if(e.restartSearch&&(r((e=>({...ir,filters:e.filters}))),s=ir.loading,i=ir.error,d=ir.hasNextPage,m=ir.paginationToken),d&&!s&&!i){r((e=>({...e,loading:!0}))),l.current=o.filters;try{var p;const e=await w.getManagedUsers(a,{spaceId:t.id,emailDomains:u,query:o.filters.query,multiFactorStatus:o.filters.multiFactorStatus,workspaceId:o.filters.workspaceId,paginationToken:m,userStatus:n});if(y.HH5(a,{filters:{multiFactorStatus:o.filters.multiFactorStatus,workspaceId:o.filters.workspaceId},query_length:(null===(p=o.filters.query)||void 0===p?void 0:p.length)??0,current_page:m,user_status:n}),"failed"===e.type)throw e.error;const s=e.data.nextPaginationToken,i=e.data.results;r((e=>{const t=[...e.managedUsers],n=new Set(e.managedUsers.map((e=>e.userId)));for(const s of i)n.has(s.userId)||t.push(s);return{...e,managedUsers:t,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:s,hasNextPage:Boolean(s)}}))}catch(g){const e=(0,Za.tg)(g);r((t=>({...t,loading:!1,error:e})))}}}),[a,t,u,c,o.loading,o.error,o.hasNextPage,o.paginationToken,o.filters,n]);(0,i.useEffect)((()=>{d.Xy(l.current,o.filters)||m({restartSearch:!0})}),[o.filters,m]);const p=(0,i.useCallback)((()=>m({restartSearch:!1})),[m]),g=(0,i.useCallback)((e=>{r((t=>({...t,filters:{...t.filters,...e}})))}),[]),h=(0,i.useCallback)(((e,t)=>{r((s=>({...s,managedUsers:s.managedUsers.map((s=>s.userId===e?{...s,workspaces:s.workspaces.filter((e=>e.id!==t))}:s))})))}),[]),f=(0,i.useCallback)((e=>{r((t=>({...t,managedUsers:[...t.managedUsers,e]})))}),[]),v=(0,i.useCallback)((e=>{r((t=>({...t,managedUsers:t.managedUsers.filter((t=>t.userId!==e))})))}),[]);return{managedUsers:o.managedUsers,filters:o.filters,loading:o.loading,error:o.error,removeWorkspaceFromUser:h,addUserToManagedUsers:f,removeUserFromManagedUsers:v,setFilters:g,hasNextPage:o.hasNextPage,loadNextPage:p}}let ar=function(e){return e[e.NotSuspended=0]="NotSuspended",e[e.Suspended=1]="Suspended",e}({});function or(e){switch(e){case ar.Suspended:return"suspended";case ar.NotSuspended:return"notSuspended";default:(0,_.t1)(e)}}function rr(e){let{lastActiveAt:t}=e;window.__c={n:"LastActiveDate"};const s=(0,lt.yK)((e=>({container:{opacity:.5}})),[]);return(0,r.jsx)("div",{style:s.container,children:t?(0,r.jsx)(Hi.T,{dateTs:t}):(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive.unknown",defaultMessage:"No activity"})})})}const lr={defaultMessage:"External workspace",id:"managedUsers.externalWorkspaceName",description:"A generic name to replace the real name of an external workspace."};function dr(e){return e.formatMessage(lr)}function cr(e){if(!e)return;const t=Object.entries(cs.nb).find((t=>{let[s,i]=t;return i===e}));if(t){return t[0]}}function ur(e){let{workspace:t}=e;window.__c={n:"WorkspaceSummaryName"};const s=(0,g.useIntl)(),i=(0,lt.yK)((e=>({container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"}})),[]);return(0,r.jsxs)("div",{style:i.container,children:[t.name??dr(s),t.isExternal?(0,r.jsx)(mr,{}):null]})}function mr(){window.__c={n:"ExternalWorkspaceInfoIcon"};const e=(0,lt.yK)((e=>({icon:{marginLeft:4,height:14,width:14,opacity:.5}})),[]);return(0,r.jsx)(fe.Z,{render:t=>(0,r.jsx)("div",{...t,children:(0,qi.D)(e.icon)}),renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.userAccess.externalSpaceNameTooltipText",defaultMessage:"This is an external workspace that does not belong to this user."})})}function pr(e){let{workspaceSummaries:t}=e;window.__c={n:"UserAccess"};const s=(0,g.useIntl)(),i=(0,lt.yK)((e=>({title:{marginRight:8},noWorkspaces:{paddingInline:8,opacity:.5},workspaceName:{maxWidth:"80%"},plusMore:{opacity:.5,marginLeft:4},titleContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"100%",marginLeft:4}})),[]);if(t.length<=0)return(0,r.jsx)(It.Z,{style:i.noWorkspaces,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.userAccess.noWorkspaces",defaultMessage:"No workspaces"})});const n=t.find((e=>e.name)),a=n?n.name:dr(s),o=t.length-1;return(0,r.jsxs)("div",{style:i.titleContainer,children:[(0,r.jsx)(It.Z,{isInline:!0,style:i.workspaceName,children:a}),!n||n.isExternal?(0,r.jsx)(mr,{}):null,o>0?(0,r.jsxs)(It.Z,{isInline:!0,style:i.plusMore,children:[(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.userAccess.additionalCount",defaultMessage:"+{numRemainingWorkspaces}",values:{numRemainingWorkspaces:o}}),""]}):null]})}var gr=s(93405),hr=s(83182);const fr=(0,g.defineMessages)({menuAriaLabel:{defaultMessage:"Open action menu for this user.",id:"identityAndProvisioning.managedUsers.table.menu.ariaLabel"}});function yr(e){let{managedUser:t,managedUserActionSections:s}=e;window.__c={n:"UserActionsMenu"};const i=(0,N.qz)(void 0,vn.Z),n=(0,g.useIntl)(),a=(0,lt.yK)((()=>({container:{minWidth:265}})),[]);return(0,r.jsx)(Mn.ZP,{popupType:ge.kQ.Popup,style:a.container,buttonPopupStore:i,renderOrigin:e=>(0,r.jsx)(wn.Z,{ariaLabel:n.formatMessage(fr.menuAriaLabel),icon:pn.o,...e}),render:()=>(0,r.jsx)(vr,{managedUser:t,popupStore:i,managedUserActionSections:s})})}function vr(e){let{managedUser:t,popupStore:s,managedUserActionSections:i}=e;window.__c={n:"ActionsMenu"};const n=[],a=(0,lt.yK)((()=>({destructiveIcon:{fill:mt.ZP.red,color:mt.ZP.red}})),[]);for(const[o,l]of i.entries()){const e=l.map(((e,s)=>({key:s,render:s=>{var i,n;return(0,r.jsx)(gr.Z,{...s,shouldWrapCaption:!0,svg:t=>e.icon(e.isDestructive?{...t,...a.destructiveIcon}:t),title:e.title,style:{paddingTop:8,paddingBottom:8,...e.isDestructive?a.destructiveIcon:{}},disabled:null===(i=e.getDisabledState)||void 0===i?void 0:i.call(e,t),disabledFeedback:null===(n=e.getDisabledState)||void 0===n?void 0:n.call(e,t)})},action:()=>e.onClick(t)}))),s={key:`section-${o}`,render:e=>(0,r.jsx)(he.Z,{topBorder:o>0,...e}),items:e};n.push(s)}return(0,r.jsxs)(me.Z,{menuType:ye.og.Popup,children:[(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:n,onAccept:()=>{s.setState({open:!1})}}),(0,r.jsx)(he.Z,{topBorder:!0,children:(0,r.jsx)(hr.Z,{title:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Learn about user suspension",id:"managedUsersDashboard.userActionsMenu.helpButton"}),href:(0,yi.UY)("guides.managedUsers"),analyticsFrom:"managed_users_dashboard_user_actions_menu"})})]})}function xr(e){let{userId:t}=e;window.__c={n:"UserSummary"};const s=(0,g.useIntl)(),i=(0,N.VK)((()=>{const e=I.default.state.currentSpaceStore;if(!e)return;const i=nt.U6.createChildStore(e,{table:q.KJ,id:t});return{userStore:i,userName:i.getDisplayName(s),userEmail:i.getEmail()}}),[t,s]),n=(0,lt.yK)((e=>({iconStyle:{border:`1px solid ${e.tableDividerColor}`,color:e.lightTextColor,fontWeight:500}})),[]);return i?(0,r.jsx)(on.i,{useThinTitle:!0,title:i.userName,byline:i.userEmail,icon:(0,r.jsx)(Un.Z,{size:28,userStore:i.userStore,iconStyle:n.iconStyle})}):null}var Sr=function(e){return e.ManagedUser="managed-user",e.Loading="loading",e}(Sr||{});const br={borderRadius:"100%",height:28,width:28,marginLeft:-4},Mr={marginLeft:4,height:14,width:14,opacity:.5},wr=[{id:"user",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.user",defaultMessage:"Users"}),renderCell:e=>e.type===Sr.ManagedUser?(0,r.jsx)(xr,{userId:e.managedUser.userId}):(0,r.jsx)(on.H,{includeByline:!0,includeIcon:!0,iconStyles:br}),widthData:{width:70},sortable:!1},{id:"access",headerTitle:(0,r.jsx)("span",{style:{paddingInline:8},children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.access",defaultMessage:"Workspaces"})}),renderCell:e=>e.type===Sr.ManagedUser?(0,r.jsx)(pr,{workspaceSummaries:e.managedUser.workspaces}):(0,r.jsx)(Cn.z,{}),widthData:{width:60},sortable:!1},{id:"lastActive",headerTitle:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},children:[(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive",defaultMessage:"Last active"}),(0,r.jsx)(fe.Z,{render:e=>(0,r.jsx)("div",{...e,children:(0,qi.D)(Mr)}),renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.lastActive.tooltip",defaultMessage:"This may be delayed by several hours."})})]}),renderCell:e=>e.type===Sr.ManagedUser?(0,r.jsx)(rr,{lastActiveAt:e.managedUser.lastActiveAt}):(0,r.jsx)(Hi.I,{}),widthData:{width:60},sortable:!1},{id:"menu",headerTitle:null,renderCell:e=>e.type===Sr.ManagedUser?(0,r.jsx)(yr,{managedUser:e.managedUser,managedUserActionSections:e.managedUserActionSections}):null,widthData:{width:15},sortable:!1,hasClickableContents:!0}],jr=[{id:"1",isClickable:!1,type:Sr.Loading},{id:"2",isClickable:!1,type:Sr.Loading},{id:"3",isClickable:!1,type:Sr.Loading}];function Cr(e){let{managedUsers:t,loadMoreManagedUsers:s,onEditDetails:i,loading:n,managedUserActionSections:a}=e;window.__c={n:"ManagedUsersTable"};const o=t.map((e=>({id:e.userId,type:Sr.ManagedUser,managedUser:e,isClickable:!0,managedUserActionSections:a}))),l=(0,lt.yK)((e=>(0,Xt.b)({columnRenderInfo:wr,theme:e,containerMarginTop:0})),[]);const d=n?[...o,...jr]:o;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(Xt.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:wr,rows:d,onRowClick:function(e){e.type===Sr.ManagedUser&&i(e.managedUser)},renderNoRowsComponent:()=>(0,r.jsx)(kr,{loading:n}),styles:l,onScrollBottom:s})})}function kr(e){window.__c={n:"EmptyState"};const t=(0,lt.yK)((()=>({text:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]);return(0,r.jsx)(It.Z,{isSmall:!0,style:t.text,children:!e.loading&&(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.empty",defaultMessage:"No users found."})})}var _r=s(33679),Tr=s(93667);function Ir(e){let{selectedMfaMethod:t,setSelectedMfaMethod:s}=e;return(0,r.jsx)(Tr.u,{pillTitle:(0,r.jsx)(g.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.title",defaultMessage:"2-step verification method"}),pillIcon:_r.j,selectedItem:t,setSelectedItem:s,items:Pr})}const Pr=[{key:"totp",value:"totp",title:(0,r.jsx)(g.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.totp",defaultMessage:"Authenticator"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.totp.caption",defaultMessage:"Users who have enabled 2-step verification through an authenticator app"}),wrapCaption:!0},{key:"sms",value:"sms",title:(0,r.jsx)(g.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.sms",defaultMessage:"Phone number"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.sms.caption",defaultMessage:"Users who have enabled 2-step verification through their phone number"}),wrapCaption:!0},{key:"backup_code",value:"backup_code",title:(0,r.jsx)(g.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.backupCode",defaultMessage:"Backup code"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"managedUsersTab.table.filters.mfaMethod.backup_code.caption",defaultMessage:"Users who have enabled 2-step verification with active backup codes."}),wrapCaption:!0}];var Zr=s(24211),Fr=s(16402),Ar=s(23063),Dr=s(65252),Br=s(13490),Rr=s(24006);function Lr(e){let{title:t,byline:s,settingItem:i}=e;window.__c={n:"GenericSetting"};const n=(0,lt.yK)((e=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},settingLeft:{width:"60%"},settingTitle:{fontWeight:p.Z.fontWeight.regular},settingByline:{marginBottom:4}})),[]);return(0,r.jsxs)("div",{style:n.settingContainer,children:[(0,r.jsxs)("div",{style:n.settingLeft,children:[(0,r.jsx)(zt.Z,{smallMarginBottom:!0,style:n.settingTitle,children:t}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:n.settingByline,children:s})]}),i]})}function Nr(e){let{title:t,byline:s,isOn:i,onToggle:n,disabled:a,tooltipForDisabled:o}=e;function l(){a||n()}return(0,r.jsx)(fe.Z,{placement:fe.Z.Placement.Top,alignment:fe.Z.Alignment.End,disableTooltip:!o||!a,renderTooltip:()=>o,render:e=>(0,r.jsx)("div",{...e,children:(0,r.jsx)(Lr,{title:t,byline:s,settingItem:(0,r.jsx)(Rr.Z,{on:i,disabled:a,onClick:l})})})})}var Er=s(53471);const Or=(0,g.defineMessages)({uploadFailed:{defaultMessage:"Upload failed.",id:"identityAndProvisioning.managedUsers.modal.failedUpload"}});var Vr=s(50501);const Ur=(0,g.defineMessages)({getSupportAccessFailed:{defaultMessage:"Failed to load user's support access status.",id:"identityAndProvisioning.managedUsers.table.userAccess.getSupportAccessFailed"},setSupportAccessFailed:{defaultMessage:"Failed to update user's support access status.",id:"identityAndProvisioning.managedUsers.table.userAccess.setSupportAccessFailed"},toastDisabled:{id:"managedUsers.toastMessage.supportAccessDisabled",defaultMessage:"Successfully disabled user's support access status"},toastEnabled:{id:"managedUsers.toastMessage.supportAccessEnabled",defaultMessage:"Successfully enabled user's support access status"}});function Wr(e){const{spaceId:t,userId:s}=e,n=(0,g.useIntl)(),a=(0,L.O7)(),[o,r]=(0,i.useState)({loading:!1,error:void 0}),[l,d]=(0,i.useState)(void 0);(0,i.useEffect)((()=>{!async function(){const e=await async function(){r({loading:!0,error:void 0});const e=await w.getDataAccessConsentForManagedUser(a,{spaceId:t,userId:s});return"failed"===e.type?(r({loading:!1,error:e.error}),void v.deprecatedShowErrorMessage(n.formatMessage(Ur.getSupportAccessFailed))):(r({loading:!1,error:void 0}),e.data.expiryTime)}();d(e)}()}),[a,n,t,s]);const c=(0,i.useMemo)((()=>Boolean(l&&Number(l)>Date.now())),[l]),u=(0,i.useCallback)((async()=>{r({loading:!0,error:void 0});const e=c?void 0:Date.now()+Vr.g,i=await w.setDataAccessConsentForManagedUser(a,{spaceId:t,userId:s,expiryTime:e});if(y.EfR(a,{new_value:Boolean(e)}),"failed"===i.type)return r({loading:!1,error:i.error}),void v.deprecatedShowErrorMessage(n.formatMessage(Ur.setSupportAccessFailed));d(e),e?sr.oV({label:n.formatMessage(Ur.toastEnabled)}):sr.oV({label:n.formatMessage(Ur.toastDisabled)}),r({loading:!1,error:void 0})}),[a,n,t,s,c]);return{isAccessGranted:c,toggleDataAccessConsent:u,loading:o.loading,error:o.error}}function zr(e){window.__c={n:"WorkspacesOverview"};const{userId:t,workspaces:s,spaceStore:n,removeWorkspaceFromUser:a}=e,o=(0,lt.yK)((()=>({container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",gap:8,marginTop:12}})),[]);return(0,r.jsx)("div",{style:o.container,children:s.map(((e,o)=>(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(Kr,{userId:t,spaceStore:n,workspace:e,removeWorkspaceFromUser:a}),o<s.length-1?(0,r.jsx)(bo.Z,{size:8}):null]},e.id)))})}function Kr(e){window.__c={n:"WorkspaceOverview"};const{userId:t,spaceStore:s,workspace:i,removeWorkspaceFromUser:n}=e,a=(0,g.useIntl)(),o=(0,L.O7)(),l=(0,lt.yK)((()=>({container:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%",gap:12,overflow:"hidden"},workspaceContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",width:"100%",gap:12,overflow:"hidden"},iconContainer:{alignSelf:"center"},textContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%"},name:{fontSize:14,fontWeight:500},nameUntitled:{fontSize:14,fontWeight:500,opacity:.25},byline:{lineHeight:1.3,fontSize:12,opacity:.5}})),[]);const d=i.icon?{pointer:{table:us.bx,id:i.id,spaceId:i.id},icon:i.icon}:void 0;return(0,r.jsx)("div",{style:l.container,children:(0,r.jsxs)("div",{style:l.workspaceContainer,children:[(0,r.jsx)("div",{style:l.iconContainer,children:(0,r.jsx)(Zn.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:28,title:i.name,isLarge:!0,emojiSize:24,isRaw:!1})}),(0,r.jsxs)("div",{style:l.textContainer,children:[(0,r.jsx)(It.Z,{style:l.name,isMultiline:!0,children:(0,r.jsx)(ur,{workspace:i})}),(0,r.jsx)(It.Z,{style:l.byline,children:Array.isArray(i.membersCount)?1===i.membersCount.length?(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{plan} · {lowerEnd}+ members",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembersLowerEndRange",values:{plan:(0,Oi.t1)(i.plan,a),lowerEnd:i.membersCount[0]}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{plan} · {lowerEnd} - {higherEnd} members",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembersRange",values:{plan:(0,Oi.t1)(i.plan,a),lowerEnd:i.membersCount[0],higherEnd:i.membersCount[1]}}):(0,r.jsx)(g.FormattedMessage,{defaultMessage:"{plan} · {numMembers} {numMembers, plural, one {member} other {members}}",id:"identityAndProvisioning.managedUsers.table.userAccess.numMembers",values:{plan:(0,Oi.t1)(i.plan,a),numMembers:i.membersCount}})})]}),(0,r.jsx)("div",{children:(0,r.jsx)(Ze.Z,{isRed:!0,onClick:async function(){y.wVl(o,{external_space_id:i.id});const e="number"==typeof i.membersCount?i.membersCount:i.membersCount[0],{accept:a}=await v.confirmUserActionV2({message:(0,r.jsx)(It.Z,{style:v.dialogStyles.title,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.message",defaultMessage:"Remove user from workspace?"})}),description:(0,r.jsx)(It.Z,{isMultiline:!0,isSecondaryColor:!0,children:e>1?(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.description",defaultMessage:"This user will no longer have access to the workspace you are removing them from. This action is not reversible."}):(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.descriptionWithDeletion",defaultMessage:"This user will no longer have access to the workspace you are removing them from. <b>The workspace will be deleted</b> since this user is the only member. This action is not reversible.",values:{b:e=>(0,r.jsx)("b",{children:e})}})}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.acceptLabel",defaultMessage:"Remove"}),cancelLabel:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.removeFromWorkspace.confirmation.cancelLabel",defaultMessage:"Go back"})});if(!a)return;const l=await w.removeManagedUserFromSpace(o,{userId:t,targetSpaceId:i.id,requestingSpaceId:s.id});y.dwr(o,{external_space_id:i.id}),"success"===l.type?(n(t,i.id),sr.oV({label:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Successfully removed user from {workspaceName}",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspaceConfirmation",values:{workspaceName:i.name}})})):sr.oV({label:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Failed to remove user from {workspaceName}",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspaceFailure",values:{workspaceName:i.name}})})},children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Remove",id:"identityAndProvisioning.managedUsers.table.userAccess.removeFromWorkspace"})})})]})})}const Hr=(0,g.defineMessages)({namePlaceholder:{defaultMessage:"Display name",id:"identityAndProvisioning.managedUsers.table.userAccess.namePlaceholder"},emailPlaceholder:{defaultMessage:"Email",id:"identityAndProvisioning.managedUsers.table.userAccess.emailPlaceholder"},supportAccessFailed:{defaultMessage:"Failed to load user's support access status.",id:"identityAndProvisioning.managedUsers.table.userAccess.supportAccessFailed"}});function Gr(e){let{spaceStore:t,managedUser:s,onClose:i,removeWorkspaceFromUser:n}=e;const a=Boolean(s);return(0,r.jsx)(Bo.Z,{open:a,onDismiss:i,preventHideChildrenWhileOpening:!0,render:()=>s?(0,r.jsx)(qr,{spaceStore:t,managedUser:s,removeWorkspaceFromUser:n}):null})}function qr(e){let{spaceStore:t,managedUser:s,removeWorkspaceFromUser:n}=e;window.__c={n:"ManagedUserDetailsScene"};const a=(0,g.useIntl)(),o=(0,L.O7)(),l=(0,N.VK)((()=>new nt.U6(o,{id:s.userId,table:q.KJ})),[s,o]),d=(0,N.VK)((()=>t.id),[t]),{hasStagedChanges:c,resetState:u,saveChanges:m,loading:p,profilePhoto:h,name:f,email:x}=function(e){const{userStore:t}=e,s=(0,g.useIntl)(),n=(0,L.O7)(),{userProfilePhoto:a,userName:o,userEmail:l,isSuspended:d}=(0,N.VK)((()=>({userProfilePhoto:t.getProfilePhoto(),userName:t.getFullName(s),userEmail:t.getEmail(),isSuspended:t.getIsSuspended()})),[t,s]),[c,u]=(0,i.useState)({loading:!1,error:void 0}),[m,p]=(0,i.useState)({value:a,loading:!1}),[h,f]=(0,i.useState)(o),[x,S]=(0,i.useState)(l);return{hasStagedChanges:m.value!==a||h!==o||x!==l,saveChanges:async function(){var e;const i=null===(e=I.default.state.currentSpaceStore)||void 0===e?void 0:e.id;if(!i)return;const c=[];m.value!==a&&c.push("profile_photo"),h!==o&&c.push("name"),x!==l&&c.push("email"),y.amv(n,{user_status:d?"suspended":"notSuspended",edited_fields:c});const{accept:p}=await v.confirmUserActionV2({message:(0,r.jsx)(It.Z,{style:v.dialogStyles.title,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.message",defaultMessage:"Confirm changes"})}),description:(0,r.jsxs)(It.Z,{isMultiline:!0,isSecondaryColor:!0,children:[(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.description",defaultMessage:"Changes made to this user's account will be reflected across all workspaces they have access to."}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.descriptionForScim",defaultMessage:"If this user is being provisioned through SCIM, your changes be later overwritten by the next SCIM sync."})]}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.acceptLabel",defaultMessage:"Save changes"}),cancelLabel:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.saveProfileChanges.confirmation.cancelLabel",defaultMessage:"Go back"})});if(!p)return;u({loading:!0,error:void 0});const f=await w.updateUserProfile(n,{userId:t.id,spaceId:i,name:h,email:x,profilePhoto:m.value});if(y.$B1(n,{user_status:d?"suspended":"notSuspended",edited_fields:c}),"failed"===f.type)return v.showErrorMessage((0,Q.wf)(s,f)),void u({loading:!1,error:f.error});sr.oV({label:(0,r.jsx)(g.FormattedMessage,{id:"managedUsers.toastMessage.updateProfileData.success",defaultMessage:"Successfully updated user's profile"})}),setTimeout((()=>{u({loading:!1,error:void 0})}),500)},resetState:function(){p({value:a,loading:!1}),f(o),S(l)},loading:c.loading,error:c.error,profilePhoto:{value:m.value,loading:m.loading,set:function(){Er.cR({environment:n,onStart:()=>{p((e=>({...e,loading:!0})))},bucket:"public",onError:()=>{p((e=>({...e,loading:!1}))),v.showErrorMessage(s.formatMessage(Or.uploadFailed))},onComplete:e=>{const t=e[0];p({value:t,loading:!1})},accept:"image/*"})},remove:function(){p({value:"",loading:!1})}},name:{value:h,set:f},email:{value:x,set:S}}}({userStore:l}),{isAccessGranted:S,toggleDataAccessConsent:b,loading:j}=Wr({userId:s.userId,spaceId:d}),C=(0,N.VK)((()=>l.getIsSuspended()?{type:"suspended"}:(0,Dr.os)({profilePhoto:h.value,name:f.value,email:x.value})),[l,h.value,f.value,x.value]),k=function(e){const{loadingSupportAccess:t}=e;return(0,lt.yK)((e=>({container:{position:"relative",display:"flex",flexDirection:"column",background:e.popoverBackground,width:420,maxHeight:520,overflow:"hidden",borderRadius:8},innerContainer:{position:"relative",display:"flex",flexDirection:"column",width:"100%",height:"100%",overflowY:"auto",padding:"36px 24px",gap:16},label:{color:e.mediumTextColor},horizontalLabel:{color:e.mediumTextColor,display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",gap:4},value:{color:e.regularTextColor},input:{padding:"4px 4px 4px 10px",margin:"0 auto 8px",width:"100%",background:e.modalBackground},avatarContainer:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},iconStyle:{border:`1px solid ${e.tableDividerColor}`,color:e.lightTextColor,fontWeight:500},inputContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%",gap:8},inputRow:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center",width:"100%"},icon:{color:e.lightIconColor,fill:"currentColor",width:14,height:14},supportAccessRow:{position:"relative",width:"100%",opacity:t?.5:1},infoContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%"},infoRow:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"},footer:{position:"absolute",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",paddingInline:4,boxShadow:e.borderBoxShadow,background:e.popoverBackground,left:0,right:0,bottom:0,height:48},button:{height:30,marginInline:4}})),[t])}({loadingSupportAccess:j}),_=(0,Zr.E2)(a),T=(0,N.VK)((()=>!Vi.Z.state.online),[]),P=s.mfaMethods.filter((e=>"backup_code"!==e)),Z=a.formatList(P.map((e=>(0,M.cR)(e))),{type:"conjunction"});return(0,r.jsxs)("div",{style:k.container,children:[(0,r.jsxs)("div",{style:k.innerContainer,children:[(0,r.jsx)("div",{style:k.avatarContainer,children:(0,r.jsx)(Dr.ZP,{size:56,avatarType:C,isOffline:T,loading:h.loading,onUploadProfilePhoto:h.set,onRemoveProfilePhoto:h.remove})}),(0,r.jsxs)("div",{style:k.inputContainer,children:[(0,r.jsxs)("div",{style:k.inputRow,children:[(0,r.jsx)(Br.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.nameLabel",defaultMessage:"Name"})}),(0,r.jsx)(Ue.Z,{style:k.input,disabled:p,value:f.value,placeholder:a.formatMessage(Hr.namePlaceholder),onChange:e=>{f.set(e.target.value)}})]}),(0,r.jsxs)("div",{style:k.inputRow,children:[(0,r.jsx)(Br.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emailLabel",defaultMessage:"Email"})}),(0,r.jsx)(Ue.Z,{style:k.input,disabled:p,value:x.value,placeholder:a.formatMessage(Hr.emailPlaceholder),onChange:e=>{x.set(e.target.value)}})]})]}),(0,r.jsxs)("div",{style:k.infoContainer,children:[(0,r.jsxs)("div",{style:k.infoRow,children:[(0,r.jsx)(It.Z,{style:k.label,isSmall:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.accountCreatedLabel",defaultMessage:"Account created"})}),s.accountCreatedAt?(0,r.jsx)(It.Z,{isSmall:!0,style:k.value,children:(0,pt.Yx)(s.accountCreatedAt,"medium",_)}):(0,r.jsx)(It.Z,{isSecondaryColor:!0,isSmall:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyAccountCreated",defaultMessage:"Incomplete"})})]}),(0,r.jsx)(bo.Z,{size:16}),(0,r.jsxs)("div",{style:k.infoRow,children:[(0,r.jsx)(It.Z,{style:k.label,isSmall:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.lastActiveLabel",defaultMessage:"Last active"})}),s.lastActiveAt?(0,r.jsx)(It.Z,{isSmall:!0,style:k.value,children:(0,Fr.gs)(s.lastActiveAt)}):(0,r.jsx)(It.Z,{isSecondaryColor:!0,isSmall:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyLastActive",defaultMessage:"No activity"})})]}),(0,r.jsx)(bo.Z,{size:16}),(0,r.jsxs)("div",{style:k.infoRow,children:[(0,r.jsx)(It.Z,{style:k.label,isSmall:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.mfaLabel",defaultMessage:"2-step verification method"})}),P.length>0?(0,r.jsx)(It.Z,{isSmall:!0,style:k.value,children:Z}):(0,r.jsx)(It.Z,{isSecondaryColor:!0,isSmall:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.emptyMfa",defaultMessage:"Not configured"})})]}),(0,r.jsx)(bo.Z,{size:16}),(0,r.jsx)("div",{style:k.supportAccessRow,children:(0,r.jsx)(Nr,{title:(0,r.jsxs)(It.Z,{style:k.horizontalLabel,isSmall:!0,children:[(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.supportAccessToggleMessage",defaultMessage:"Support access"}),(0,r.jsx)(fe.Z,{placement:fe.Z.Placement.Bottom,render:e=>(0,r.jsx)("div",{...e,children:(0,qo.m)(k.icon)}),renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.supportAccessToggleMessage.tooltip",defaultMessage:"Grant Notion support temporary access to this account so we can troubleshoot problems or recover content on its behalf"})})]}),byline:null,isOn:S,onToggle:b,disabled:j})})]}),(0,r.jsx)("div",{children:s.workspaces.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Br.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.workspacesLabel",defaultMessage:"Workspaces"})}),(0,r.jsx)(zr,{userId:s.userId,workspaces:s.workspaces,spaceStore:t,removeWorkspaceFromUser:n})]}):null})]}),(0,r.jsx)(Ar.Z,{isVisible:c||p,enterAnimationStyle:{translateY:48,opacity:0},animationStyle:{opacity:1,translateY:0},exitAnimationStyle:{translateY:48,opacity:0},render:()=>(0,r.jsxs)("div",{style:k.footer,children:[(0,r.jsx)(Wt.Z,{isRed:!0,disabled:p,style:k.button,onClick:u,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.cancelButton",defaultMessage:"Cancel"})}),(0,r.jsx)(ce.Z,{disabled:p,style:k.button,onClick:m,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.details.saveButton",defaultMessage:"Save changes"})})]})})]})}var Yr=s(73039);function Qr(e){let{selectedSpaceId:t,setSelectedSpaceId:s,spaceData:i}=e;window.__c={n:"WorkspacesFilter"};const n=(0,g.useIntl)(),a=(0,lt.yK)((e=>({optionContainer:{display:"flex",flexDirection:"row",alignItems:"center",gap:8},optionTitle:{display:"block"},optionCaption:{display:"block",color:e.mediumTextColor,fontSize:12,lineHeight:"15px"},container:{padding:"6px 0 6px"},footer:{padding:"8px 8px 2px 8px",justifyContent:"space-between",display:"flex"},icon:{width:16,marginRight:6,fill:"currentColor"}})),[]),o=(0,N.VK)((()=>i.map((e=>{const t=e.name,s=e.icon?{pointer:{table:us.bx,id:e.id,spaceId:e.id},icon:e.icon}:void 0;return{key:e.id,value:e.id,title:(0,r.jsxs)("div",{style:a.optionContainer,children:[(0,r.jsx)(Zn.Z,{disabled:!0,icon:s,isEmptyPage:!1,size:24,title:t,isLarge:!0,emojiSize:24,isRaw:!1}),(0,r.jsxs)("div",{style:{paddingTop:4,paddingBottom:4},children:[(0,r.jsx)(It.Z,{style:a.optionTitle,children:t}),(0,r.jsx)(It.Z,{style:a.optionCaption,children:(0,Oi.t1)(e.subscriptionTier,n)})]})]})}}))),[i,n,a]);return(0,r.jsx)(Tr.u,{pillTitle:(0,r.jsx)(g.FormattedMessage,{id:"managedUsersTab.table.filters.workspaces.title",defaultMessage:"Workspace"}),pillIcon:Yr.K,selectedItem:t,setSelectedItem:s,items:o})}const $r=(0,g.defineMessages)({placeholder:{id:"identityProvisioningSettings.managedUsers.searchInput.placeholder",defaultMessage:"Search name, email, or user ID"}});function Xr(e){let{spaceStore:t,samlConfigStore:s}=e;window.__c={n:"ManagedUsersPage"};const{navigateTo:n}=(0,i.useContext)(Ho),a=(0,L.O7)(),o=(0,g.useIntl)(),l=(0,lt.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:p.Z.fontWeight.semibold,fontSize:17,display:"flex",justifyContent:"flex-start",alignItems:"center"},byline:{fontSize:14,fontWeight:p.Z.fontWeight.regular,color:e.mediumTextColor,paddingBottom:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"},filters:{display:"flex",justifyContent:"flex-start",alignItems:"center",width:"100%",margin:"0 auto 12px"}})),[]),d=(0,N.VK)((()=>s.state.spaces),[s]),{managedUsers:c,filters:u,loadNextPage:m,setFilters:h,removeWorkspaceFromUser:f,loading:x,selectedTab:b,setSelectedTab:M,onOpenDetailsModal:j,onCloseDetailsModal:C,selectedUser:k,managedUserActionSections:T}=function(e){let{spaceStore:t,samlConfigStore:s}=e;const n=(0,L.O7)(),a=(0,g.useIntl)(),[o,l]=(0,i.useState)(),[d,c]=(0,i.useState)(ar.NotSuspended),u=(0,N.VK)((()=>n.currentUser.id),[n]),m=(0,i.useCallback)(((e,t)=>{y.JX1(n,{user_status:or(d),from:t}),l(e.userId)}),[n,d]),p=nr({userStatus:"notSuspended",spaceStore:t,samlConfigStore:s}),h=nr({userStatus:"suspended",spaceStore:t,samlConfigStore:s});let f;f=d===ar.NotSuspended?p:h;const x=(0,i.useCallback)((async e=>{y.rZG(n);const{accept:s}=await v.confirmUserActionV2({message:(0,r.jsx)(It.Z,{style:v.dialogStyles.title,children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Suspend this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.title"})}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Yes",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.acceptLabel"}),description:(0,r.jsx)(It.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"This user will not be able to log into Notion and their Notion integrations will stop working. They can be unsuspended at any time from the Managed Users dashboard.",id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser.dialog.description"})})});if(!s)return;const i=await w.updateUserSuspension(n,{userId:e.userId,spaceId:t.id,suspend:!0});y.rvR(n),"failed"===i.type&&v.showErrorMessage((0,Q.wf)($.default.getIntl(),i)),h.addUserToManagedUsers(e),p.removeUserFromManagedUsers(e.userId)}),[n,t.id,h,p]),S=(0,i.useCallback)((async e=>{y.NFM(n);const{accept:s}=await v.confirmUserActionV2({message:(0,r.jsx)(It.Z,{style:v.dialogStyles.title,children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Log out this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.title"})}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Log out user",id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.acceptLabel"}),description:(0,r.jsx)(It.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.logoutUser.dialog.description",defaultMessage:"You are about to log out this user from their current session. They will need to re-authenticate to log back into Notion."})})});if(!s)return;const i=await w.logoutManagedUsers(n,{spaceId:t.id,target:{type:tr.User,userId:e.userId}});if(y._mq(n),"failed"===i.type)return v.showErrorMessage((0,Q.wf)($.default.getIntl(),i)),void sr.oV({label:(0,r.jsx)(g.FormattedMessage,{id:"managedUsers.toastMessage.logout.failed",defaultMessage:"Failed to logged out user"})});sr.oV({label:(0,r.jsx)(g.FormattedMessage,{id:"managedUsers.toastMessage.logout.success",defaultMessage:"Successfully logged out user"})})}),[n,t.id]),b=(0,i.useCallback)((async e=>{y.Zm$(n);const{accept:s}=await v.confirmUserActionV2({message:(0,r.jsx)(It.Z,{style:v.dialogStyles.title,children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Reset password for this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.title"})}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.acceptLabel",defaultMessage:"Reset passwords for user"}),description:(0,r.jsx)(It.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.forcePasswordReset.dialog.description",defaultMessage:"You are about to reset the password for this user. This will also remove any 2-step verification settings they might have and they will be logged out of of their current session.{br}{br}This user will need to re-authenticate via their email the next time they attempt to log back into Notion, and they will be prompted to set a new password upon logging in.",values:{br:(0,r.jsx)("br",{})}})})});if(!s)return;const i=await w.resetPasswordsForManagedUsers(n,{spaceId:t.id,target:{type:tr.User,userId:e.userId}});if(y.vCG(n),"failed"===i.type)return v.showErrorMessage((0,Q.wf)(a,i)),void sr.oV({label:(0,r.jsx)(g.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.fail",defaultMessage:"Failed to reset password for user"})});sr.oV({label:(0,r.jsx)(g.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.success",defaultMessage:"Successfully reset password for user"})})}),[n,a,t.id]),M=(0,i.useCallback)((async e=>{const s=await w.updateUserSuspension(n,{userId:e.userId,spaceId:t.id,suspend:!1});y.Cis(n),"failed"===s.type&&v.deprecatedShowErrorMessage(s.error.message),h.removeUserFromManagedUsers(e.userId),p.addUserToManagedUsers(e)}),[n,t.id,h,p]),j=(0,i.useCallback)((async e=>{y.P1A(n,{user_status:or(d)});const{accept:s}=await v.confirmUserActionV2({message:(0,r.jsx)(It.Z,{style:v.dialogStyles.title,children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Delete this user?",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.title"})}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Yes",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.acceptLabel"}),description:(0,r.jsx)(It.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"This will delete the user's data. They can still be restored within 30 days by contacting Notion support.",id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser.dialog.description"})})});if(!s)return;const i=await w.deleteManagedUser(n,{userId:e.userId,spaceId:t.id});y.j72(n,{user_status:or(d)}),"failed"===i.type&&v.deprecatedShowErrorMessage(i.error.message),h.removeUserFromManagedUsers(e.userId),p.removeUserFromManagedUsers(e.userId)}),[n,d,t.id,h,p]),C=(0,i.useMemo)((()=>f.managedUsers.find((e=>{let{userId:t}=e;return t===o}))),[o,f.managedUsers]),k=(0,i.useMemo)((()=>{let e;const t={onClick:e=>m(e,"dropdown_menu"),icon:$o.R,title:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.userDetails",defaultMessage:"Edit details"})},s={onClick:e=>j(e),icon:er.y,title:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.deleteUser",defaultMessage:"Delete user"}),isDestructive:!0};switch(d){case ar.NotSuspended:e=[[t,{onClick:S,icon:Qo.S,title:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.logout",defaultMessage:"Log out"})},{onClick:b,icon:Xo.z,title:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.passwordReset",defaultMessage:"Reset password"})}],[{onClick:x,icon:Yo.V,title:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.suspendUser",defaultMessage:"Suspend user"}),getDisabledState:e=>e.userId===u},s]];break;case ar.Suspended:e=[[t],[{onClick:e=>M(e),icon:Jo.u,title:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.table.menu.action.unSuspendUser",defaultMessage:"Reactivate user"})},s]];break;default:(0,_.t1)(d)}return e.filter((e=>e.length>0))}),[m,u,d,j,x,M,S,b]);return{...f,selectedTab:d,setSelectedTab:c,selectedUser:C,managedUserActionSections:k,onOpenDetailsModal:m,onCloseDetailsModal:function(){l(void 0)}}}({spaceStore:t,samlConfigStore:s}),I=(0,i.useCallback)((e=>j(e,"row_click")),[j]);return(0,r.jsxs)(Ui.Z,{children:[(0,r.jsx)(wo.Z,{style:l.link,onClick:()=>n(Uo),children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.breadcrumb",defaultMessage:"← Identity & Provisioning"})}),(0,r.jsxs)(zt.Z,{large:!0,style:l.title,children:[(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.title",defaultMessage:"User management"}),(0,r.jsx)(wn.Z,{icon:qo.m,ariaLabel:o.formatMessage({defaultMessage:"Managed users settings help button",id:"identityProvisioningSettings.managedUsers.helpButton.label"}),onClick:()=>S.navigateToExternalURL({environment:a,url:(0,yi.UY)("guides.managedUsers")})})]}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:l.byline,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.byline",defaultMessage:"Manage and view users that are using your verified domains"})}),(0,r.jsx)(Co.Z,{tabs:[(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.table.notSuspendedTab.title",defaultMessage:"Active"},"notSuspended.title"),(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.table.suspendedTab.title",defaultMessage:"Suspended"},"suspended")],selectedIndex:b,onChange:e=>M(e),style:l.tabBarMenu}),(0,r.jsx)(ja,{mode:Ma.Button,query:u.query,setQueryFilter:e=>{h({query:e})},placeholderText:$.default.formatMessage($r.placeholder)}),(0,r.jsxs)("div",{style:l.filters,children:[(0,r.jsx)(Qr,{selectedSpaceId:u.workspaceId,setSelectedSpaceId:e=>{h({workspaceId:e})},spaceData:d}),(0,r.jsx)(Ir,{selectedMfaMethod:u.multiFactorStatus,setSelectedMfaMethod:e=>{h({multiFactorStatus:e})}})]}),(0,r.jsx)(Cr,{managedUsers:c,loading:x,loadMoreManagedUsers:m,onEditDetails:I,managedUserActionSections:T},b),(0,r.jsx)(Gr,{spaceStore:t,managedUser:k,onClose:C,removeWorkspaceFromUser:f})]})}function Jr(e){let{environment:t,samlConfigStore:s}=e;const i=s.state.emailDomains.length>0,n=(0,io.zt)();return i||("business"===n||"enterprise"===n)}var el=s(81236);async function tl(e){let{onRequest:t,onSuccess:s}=e;const i=await t();switch(i.type){case"success":s&&await s(i);break;case"failed":v.showErrorMessage((0,Q.wf)($.default.getIntl(),i));break;default:(0,_.t1)(i)}}function sl(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n}=e;const a=(0,L.O7)(),o=(0,N.VK)((()=>s.state.emailDomains),[s]),r=(0,N.VK)((()=>"disabled"!==s.state.status&&"unconfigured"!==s.state.status),[s]),l=(0,N.VK)((()=>Jr({environment:a,samlConfigStore:s})),[s,a]),d=(0,N.VK)((()=>l&&(!s.state.id||s.state.id===t.id)),[l,s,t]),c=(0,N.VK)((()=>n.state.emailDomains.length>0&&(0,io.wP)()),[n]),u=(0,N.VK)((()=>o.length>0),[o]),m=(0,i.useCallback)((async()=>{if(s.state.emailDomains.length>0)return tl({onRequest:()=>w.updateWorkspaceCreationForEmailDomains(a,{emailDomains:s.state.emailDomains,workspaceCreationEnum:n.state.spaceCreation,spaceId:t.id}),onSuccess:()=>{n.setState({...n.state,emailDomains:s.state.emailDomains})}})}),[a,t,n,s]),p=(0,i.useCallback)((async()=>{if(s.state.emailDomains.length>0)return tl({onRequest:()=>w.updateEmailDomainSettings(a,{emailDomains:s.state.emailDomains,spaceId:t.id,preventProfileEdits:n.state.settings.prevent_profile_edits,preventMembersJoiningExternalWorkspace:n.state.settings.prevent_members_joining_external_workspace,customSessionDuration:cr(n.state.settings.custom_session_duration),preventGrantingSupportAccess:n.state.settings.prevent_granting_support_access}),onSuccess:()=>{n.setState({...n.state,emailDomains:s.state.emailDomains})}})}),[a,t,n,s]),g=(0,N.VK)((()=>l&&(0,io.wP)()),[l]);return{verifiedDomains:o,isSamlStatusEnabled:r,isSamlAvailable:l,isSamlEditable:d,isDomainSettingsAvailable:c,isClaimSpacesAvailable:g,canSaveWorkspaceCreationSetting:u,saveWorkspaceCreationSetting:m,saveEmailDomainSettings:p}}var il=s(91718);function nl(e){let{title:t,byline:s,targetTier:n}=e;window.__c={n:"Upsell"};const a=(0,L.O7)(),o=(0,i.useCallback)((()=>$a.y(a,{from:"space_saml",for:n})),[a,n]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(zt.Z,{smallMarginBottom:!0,style:{fontWeight:p.Z.fontWeight.regular,display:"flex",alignItems:"center"},children:[(0,r.jsx)("span",{style:{marginRight:8},children:t}),(0,r.jsx)(il.Z,{subscriptionTier:n,analyticsName:"space_saml",onClick:o})]}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,children:s})]})}const al={browseWorkspaces:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Browse workspaces",id:"identityAndProvisioning.claimWorkspaces.button"}),noWorkspaces:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"No workspaces",id:"identityAndProvisioning.claimWorkspaces.buttonEmpty"}),loadingError:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Error loading workspaces.",id:"identityAndProvisioning.claimWorkspaces.errorByline"})};function ol(e){let{promptUpgrade:t}=e;window.__c={n:"ClaimSpaces"};const{navigateTo:s,loadingSpaces:n,hasBrowsableSpaces:a,errorClaimableSpaces:o}=(0,i.useContext)(Ho),l=Boolean(o),d=!a||n,c=!a&&!n,u=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.title",defaultMessage:"Claim workspaces"}),m=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.message",defaultMessage:"Claim workspaces created by users with a verified domain or require owners to use an external domain."}),p=(0,lt.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:d?.5:1,minWidth:160},settingErrorByline:{color:e.errorText,marginTop:8,fontSize:13}})),[d]);if(t)return(0,r.jsx)(nl,{title:u,byline:m,targetTier:"enterprise"});let h;return h=n?(0,r.jsx)(Ki.Z,{}):a?al.browseWorkspaces:al.noWorkspaces,(0,r.jsx)("div",{style:p.settingContainer,children:(0,r.jsx)(Lr,{title:u,byline:m,settingItem:(0,r.jsxs)("div",{style:p.buttonAndErrorContainer,children:[(0,r.jsx)(fe.Z,{placement:fe.Z.Placement.Top,alignment:fe.Z.Alignment.End,render:e=>(0,r.jsx)(Wt.Z,{disabled:d,isLarge:!0,style:p.button,onClick:()=>s(Wo),...e,children:h}),disableTooltip:!c,renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.tooltip",defaultMessage:"There are no available workspaces to claim"})}),l?(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:p.settingErrorByline,children:al.loadingError}):null]})})})}var rl=s(52507),ll=s(86249);function dl(e){let{spaceStore:t,samlConfigStore:s,promptUpgrade:n,disabled:a,saveWorkspaceCreationSetting:o}=e;window.__c={n:"EmailDomains"};const l=(0,L.O7)(),d=(0,N.qz)(void 0,rl.ZP),c=(0,lt.yK)((()=>({flex:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",margin:"18px 0px"},button:{position:"relative",marginLeft:"auto",marginRight:0,opacity:a?.5:1},plusIcon:{width:14,height:14,fill:"inherit",marginRight:"6px"}})),[a]),u=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.title",defaultMessage:"Verified domains"}),m=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.emailDomainsSection.byline",defaultMessage:"Verify ownership of an email domain to access advanced security features including single-sign on."}),h=[...(0,N.VK)((()=>s.state.emailDomains.map(ll.f4)),[s]),...(0,N.VK)((()=>s.state.domainVerifications.filter((e=>!s.state.emailDomains.includes(e.domain))).sort(((e,t)=>e.createdAt-t.createdAt)).map(ll.UV)),[s])],f=(0,i.useCallback)((async()=>{await Vo({environment:l,spaceId:t.id,store:s})}),[l,t,s]),{resetInitialClaimableSpaces:y}=(0,i.useContext)(Ho),v=(0,i.useCallback)((async e=>{switch(e.type){case"verified":return tl({onRequest:()=>w.setSamlConfig(l,{spaceId:t.id,removedEmailDomains:[e.domain]}),onSuccess:async()=>{await f(),y()}});case"unverified":case"invalid":return tl({onRequest:()=>w.deleteDomainVerificationCode(l,{id:e.id}),onSuccess:()=>f()})}}),[l,t,f,y]),x=(0,i.useCallback)((()=>tl({onRequest:()=>w.setSamlConfig(l,{spaceId:t.id}),onSuccess:()=>f()})),[l,f,t]),S=(0,i.useCallback)((async()=>{await f(),await o()}),[o,f]);return n?(0,r.jsx)(nl,{title:u,byline:m,targetTier:"business"}):(0,r.jsx)(ll.ZP,{disabled:a,domains:h,onRemoveDomain:v,domainVerificationStore:d,verificationType:"saml_config",verificationTargetId:t.id,refreshDomains:S,onClickAddDomain:x,renderOverrideAddDomainButton:e=>(0,r.jsxs)("div",{style:c.flex,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(zt.Z,{smallMarginBottom:!0,style:{fontWeight:p.Z.fontWeight.medium},children:u}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginBottom:4},children:m})]}),(0,r.jsx)("div",{children:(0,r.jsx)(Ze.Z,{isBlue:!0,style:c.button,icon:e=>(0,no.R)({...e,...c.plusIcon}),disabled:a,onClick:e,children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Add domain",id:"securitySAMLSettings.emailDomainsSection.addDomain"})})})]})})}function cl(e){let{domainSettingsStore:t,samlConfigStore:s,disabled:n,promptUpgrade:a,verifiedDomains:o,tooltip:l,saveWorkspaceCreationSetting:d}=e;window.__c={n:"WorkspaceCreation"};const c=(0,L.O7)(),u=(0,lt.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),m=(0,N.VK)((()=>{const e=s.state.id;if(!e)return;return new nt.H2(c,{table:us.bx,id:e}).getName()}),[c,s]),p=(0,i.useCallback)((async e=>{t.setState({...t.state,spaceCreation:e}),await d(),y.tir(c,{workspace_creation:e})}),[t,d,c]),h=(0,N.VK)((()=>o.length>0?t.state.spaceCreation:"admins_only"),[t,o]),f=(0,r.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.title",defaultMessage:"Workspace creation"}),v=(0,r.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.byline",defaultMessage:"Customize who can create new workspaces."}),x=(0,r.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.titleWithSpaceName",defaultMessage:"{primaryWorkspaceName} workspace owners",values:{primaryWorkspaceName:m}}),S=(0,r.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.title",defaultMessage:"Only workspace owners"});return a?(0,r.jsx)("div",{style:u.settingContainer,children:(0,r.jsx)(nl,{title:f,byline:v,targetTier:"enterprise"})}):(0,r.jsx)(fe.Z,{placement:fe.Z.Placement.Top,alignment:fe.Z.Alignment.End,render:e=>(0,r.jsx)("div",{...e,style:u.settingContainer,children:(0,r.jsx)(jo.Z,{isMobile:c.device.isMobile,disabled:n,title:f,caption:v,type:"dropdown",currentOption:h,options:[{key:"unrestricted",label:(0,r.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.title",defaultMessage:"Anyone"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.unrestricted.caption",defaultMessage:"Any user can create new workspaces."})},{key:"admins_only",label:m?x:S,caption:(0,r.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.workspaceOwnersOnly.captionWithSpaceName",defaultMessage:"Only workspace owners of this workspace can create new workspaces."})}],onSelectOption:p})}),disableTooltip:!l,renderTooltip:()=>l})}function ul(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i,isCurrentSpaceEnterprise:n}=e;window.__c={n:"DomainSection"};const{verifiedDomains:a,isSamlAvailable:o,saveWorkspaceCreationSetting:l,isSamlEditable:d,isDomainSettingsAvailable:c,canSaveWorkspaceCreationSetting:u,isClaimSpacesAvailable:m}=sl({spaceStore:t,samlConfigStore:s,domainSettingsStore:i}),p=c&&d;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(dl,{disabled:!d,promptUpgrade:!o,spaceStore:t,samlConfigStore:s,saveWorkspaceCreationSetting:l}),(0,r.jsx)(cl,{disabled:!p||!u,promptUpgrade:!n,verifiedDomains:a,samlConfigStore:s,domainSettingsStore:i,tooltip:0===a.length?(0,r.jsx)(g.FormattedMessage,{id:"domainSettings.workspaceCreation.disabledTooltip",defaultMessage:"There must be at least one verified domain to configure the workspace creation setting."}):void 0,saveWorkspaceCreationSetting:l}),(0,r.jsx)(ol,{promptUpgrade:!m})]})}var ml=s(74523);function pl(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:n,disabled:a}=e;window.__c={n:"CustomSessionDurationSetting"};const o=(0,L.O7)(),l=(0,lt.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),d=(0,i.useMemo)((()=>Object.entries(cs.nb).map((e=>{let[t,s]=e;return{key:t,label:(0,r.jsx)(It.Z,{children:(0,Fr.hH)(0,s)})}}))),[]),c=(0,N.VK)((()=>cr(t.state.settings.custom_session_duration)??cs.gl),[t]),u=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.customSessionDuration.title",defaultMessage:"Session duration"}),m=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.customSessionDuration.message",defaultMessage:"Control how long your managed users can be logged in for before they must re-authenticate."});return n?(0,r.jsx)("div",{style:l.settingContainer,children:(0,r.jsx)(nl,{title:u,byline:m,targetTier:"enterprise"})}):(0,r.jsx)("div",{style:l.settingContainer,children:(0,r.jsx)(jo.Z,{isMobile:o.device.isMobile,disabled:a,title:u,caption:m,type:"dropdown",currentOption:c,options:d,onSelectOption:async function(e){const i=t.state.settings.custom_session_duration??cs.nb[cs.gl],n=cs.nb[e];if(void 0===n)return;y.LOF(o,{custom_session_duration_ms:i});const{accept:a}=await v.confirmUserActionV2({message:(0,r.jsx)(It.Z,{style:v.dialogStyles.title,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.message",defaultMessage:"Confirm change"})}),description:(0,r.jsxs)(It.Z,{isMultiline:!0,isSecondaryColor:!0,children:[(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.description",defaultMessage:"You are about to change the session duration for all of your managed users from <b>{oldDuration}</b> to <b>{newDuration}.</b>",values:{oldDuration:(0,Fr.hH)(0,i),newDuration:(0,Fr.hH)(0,n),b:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.jsx)("b",{children:t})}}}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.secondDescription",defaultMessage:"This may log some users out of their current session, including you. The affected users will need to re-authenticate to log back into Notion."})]}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.acceptLabel",defaultMessage:"Confirm change"}),cancelLabel:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.customSessionDuration.confirmation.cancelLabel",defaultMessage:"Cancel"})});a&&(t.setState({...t.state,settings:{...t.state.settings,custom_session_duration:n}}),y.l0P(o,{new_session_duration_ms:n}),await s())}})})}function gl(e){let{spaceId:t,domainSettingsStore:s,promptUpgrade:i,verifiedDomains:n,disabled:a}=e;window.__c={n:"ForcePasswordResetSetting"};const o=n.length>0,l=(0,L.O7)(),d=(0,lt.yK)((()=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!a&&o?1:.5}})),[a,o]),c=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.forcePasswordReset.title",defaultMessage:"Reset passwords for all users"}),u=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.forcePasswordReset.message",defaultMessage:"Force reset the passwords for all managed users and require them to a new one the next time they log in."});async function m(){y.JoV(l,{email_domains:n});const{accept:e}=await v.confirmUserActionV2({message:(0,r.jsx)(It.Z,{style:v.dialogStyles.title,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.message",defaultMessage:"Reset passwords for your managed users?"})}),description:(0,r.jsx)(It.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.description",defaultMessage:"You are about to reset the passwords for of your managed users, including you. This will also remove any 2-step verification settings they might have and they will be logged out of of their current session.{br}{br}The affected users will need to re-authenticate via their email the next time they attempt to log back into Notion, and they will be prompted to set a new password upon logging in.",values:{br:(0,r.jsx)("br",{})}})}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.acceptLabel",defaultMessage:"Reset passwords for all managed users"}),cancelLabel:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.confirmation.cancelLabel",defaultMessage:"Cancel"})});if(!e)return;const i=s.state.emailDomains;await w.resetPasswordsForManagedUsers(l,{spaceId:t,target:{type:tr.Domains,emailDomains:i}}),sr.oV({label:(0,r.jsx)(g.FormattedMessage,{id:"managedUsers.toastMessage.forcePasswordReset.all.success",defaultMessage:"Successfully reset passwords for all managed users"})}),y.aT6(l,{email_domains:i})}return i?(0,r.jsx)("div",{style:d.settingContainer,children:(0,r.jsx)(nl,{title:c,byline:u,targetTier:"enterprise"})}):(0,r.jsx)("div",{style:d.settingContainer,children:(0,r.jsx)(Lr,{title:c,byline:u,settingItem:(0,r.jsx)("div",{style:d.buttonAndErrorContainer,children:(0,r.jsx)(fe.Z,{placement:fe.Z.Placement.Top,alignment:fe.Z.Alignment.End,render:e=>(0,r.jsx)(Ze.Z,{isRed:!0,disabled:a||!o,style:d.button,onClick:m,...e,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.forcePasswordReset.logoutButton",defaultMessage:"Reset passwords for all users"})}),disableTooltip:o,renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}function hl(e){let{spaceId:t,domainSettingsStore:s,promptUpgrade:i,verifiedDomains:n,disabled:a}=e;window.__c={n:"LogoutUsersSetting"};const o=n.length>0,l=(0,L.O7)(),d=(0,lt.yK)((()=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!a&&o?1:.5}})),[a,o]),c=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.logoutAllUsers.title",defaultMessage:"Log out all users"}),u=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.logoutAllUsers.message",defaultMessage:"Force log out all managed users and require them to re-authenticate."});async function m(){y.KFD(l,{email_domains:n});const{accept:e}=await v.confirmUserActionV2({message:(0,r.jsx)(It.Z,{style:v.dialogStyles.title,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.message",defaultMessage:"Log out all of your managed users?"})}),description:(0,r.jsx)(It.Z,{isMultiline:!0,isSecondaryColor:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.description",defaultMessage:"You are about to log all of your managed users out of their current session, including you. The affected users will need to re-authenticate to log back into Notion."})}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.acceptLabel",defaultMessage:"Log out all managed users"}),cancelLabel:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.confirmation.cancelLabel",defaultMessage:"Cancel"})});if(!e)return;const i=s.state.emailDomains;await w.logoutManagedUsers(l,{spaceId:t,target:{type:tr.Domains,emailDomains:i}}),sr.oV({label:(0,r.jsx)(g.FormattedMessage,{id:"managedUsers.toastMessage.logout.all.success",defaultMessage:"Successfully logged out all managed users"})}),y._6M(l,{email_domains:i})}return i?(0,r.jsx)("div",{style:d.settingContainer,children:(0,r.jsx)(nl,{title:c,byline:u,targetTier:"enterprise"})}):(0,r.jsx)("div",{style:d.settingContainer,children:(0,r.jsx)(Lr,{title:c,byline:u,settingItem:(0,r.jsx)("div",{style:d.buttonAndErrorContainer,children:(0,r.jsx)(fe.Z,{placement:fe.Z.Placement.Top,alignment:fe.Z.Alignment.End,render:e=>(0,r.jsx)(Ze.Z,{isRed:!0,disabled:a||!o,style:d.button,onClick:m,...e,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.managedUsers.logoutAllUsers.logoutButton",defaultMessage:"Log out all users"})}),disableTooltip:o,renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}function fl(e){let{promptUpgrade:t,hasVerifiedDomains:s,disabled:n}=e;window.__c={n:"ManageUsersButton"};const{navigateTo:a}=(0,i.useContext)(Ho),o=(0,L.O7)(),l=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.title",defaultMessage:"Managed users dashboard"}),d=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.message",defaultMessage:"Manage and view users that are using your verified domains"}),c=(0,lt.yK)((e=>({settingContainer:{margin:"18px 0"},buttonAndErrorContainer:{display:"flex",flexDirection:"column",maxWidth:280},button:{opacity:!n&&s?1:.5}})),[s,n]);return t?(0,r.jsx)("div",{style:c.settingContainer,children:(0,r.jsx)(nl,{title:l,byline:d,targetTier:"enterprise"})}):(0,r.jsx)("div",{style:c.settingContainer,children:(0,r.jsx)(Lr,{title:l,byline:d,settingItem:(0,r.jsx)("div",{style:c.buttonAndErrorContainer,children:(0,r.jsx)(fe.Z,{placement:fe.Z.Placement.Top,alignment:fe.Z.Alignment.End,render:e=>(0,r.jsx)(Wt.Z,{disabled:n||!s,isLarge:!0,style:c.button,onClick:()=>{y.pCf(o),a(zo)},...e,children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"View dashboard",id:"identityAndProvisioning.managedUsers.button"})}),disableTooltip:s,renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.tooltip",defaultMessage:"You must verify a domain to manage its users"})})})})})}function yl(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:i,verifiedDomains:n,disabled:a}=e;window.__c={n:"PreventGrantingSupportAccessSetting"};const o=(0,L.O7)(),l=(0,lt.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),d=n.length>0,c=(0,N.VK)((()=>Boolean(t.state.settings.prevent_granting_support_access)),[t]),u=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.title",defaultMessage:"Prevent managed users from granting support access"}),m=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventGrantingSupportAccess.message",defaultMessage:"Control if managed users can enable support access on their accounts."});return i?(0,r.jsx)("div",{style:l.settingContainer,children:(0,r.jsx)(nl,{title:u,byline:m,targetTier:"enterprise"})}):(0,r.jsx)("div",{style:l.settingContainer,children:(0,r.jsx)(Nr,{title:(0,r.jsx)("div",{style:l.settingsTitle,children:u}),byline:m,isOn:c,onToggle:async function(){const e=Boolean(!t.state.settings.prevent_granting_support_access);t.setState({...t.state,settings:{...t.state.settings,prevent_granting_support_access:e}}),y.DnI(o,{new_value:e}),await s()},disabled:a||!d})})}function vl(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:i,disabled:n}=e;window.__c={n:"PreventMembersJoiningExternalSpaces"};const a=(0,L.O7)(),o=(0,lt.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),l=(0,N.VK)((()=>Boolean(t.state.settings.prevent_members_joining_external_workspace)),[t]),d=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.title",defaultMessage:"External workspace access"}),c=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventMembersJoiningExternalSpaces.message",defaultMessage:"Control if managed users are able to join workspaces that not owned by your organization."});if(i)return(0,r.jsx)("div",{style:o.settingContainer,children:(0,r.jsx)(nl,{title:d,byline:c,targetTier:"enterprise"})});const u=l?"on":"off";return(0,r.jsx)("div",{style:o.settingContainer,children:(0,r.jsx)(jo.Z,{isMobile:a.device.isMobile,disabled:n,title:d,caption:c,type:"dropdown",currentOption:u,options:[{key:"on",label:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.titleGeneric",defaultMessage:"Only workspace owners"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.enabled.caption",defaultMessage:"Only workspace owners of your connected workspaces can join external workspaces."})},{key:"off",label:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.titleWithSpaceName",defaultMessage:"Anyone"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.externalSpacePrevention.disabled.caption",defaultMessage:"All users can join any workspace."})}],onSelectOption:async function(){const e=Boolean(!t.state.settings.prevent_members_joining_external_workspace);t.setState({...t.state,settings:{...t.state.settings,prevent_members_joining_external_workspace:e}}),y.T4J(a,{new_value:e}),await s()}})})}function xl(e){let{domainSettingsStore:t,saveEmailDomainSettings:s,promptUpgrade:i,hasVerifiedDomains:n,disabled:a}=e;window.__c={n:"PreventProfileEditsSetting"};const o=(0,L.O7)(),l=(0,lt.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),d=(0,N.VK)((()=>Boolean(t.state.settings.prevent_profile_edits)),[t]),c=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.title",defaultMessage:"Allow managed users to change profile information"}),u=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.preventProfileEdits.message",defaultMessage:"Control if managed users can change their preferred name, email address, and profile photo."});return i?(0,r.jsx)("div",{style:l.settingContainer,children:(0,r.jsx)(nl,{title:c,byline:u,targetTier:"enterprise"})}):(0,r.jsx)("div",{style:l.settingContainer,children:(0,r.jsx)(Nr,{title:(0,r.jsx)("div",{style:l.settingsTitle,children:c}),byline:u,isOn:!d,onToggle:async function(){const e=Boolean(!t.state.settings.prevent_profile_edits);t.setState({...t.state,settings:{...t.state.settings,prevent_profile_edits:e}}),y.DnI(o,{new_value:e}),await s()},disabled:a||!n})})}function Sl(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i}=e;window.__c={n:"ManagedUsersSection"};const{verifiedDomains:n,isDomainSettingsAvailable:a,isSamlEditable:o,saveEmailDomainSettings:l}=sl({spaceStore:t,samlConfigStore:s,domainSettingsStore:i}),d=(0,lt.yK)((e=>({byline:{fontSize:14,fontWeight:p.Z.fontWeight.regular,color:e.mediumTextColor},helpButton:{marginTop:18,marginBottom:16}})),[]),c=a&&o,u=(0,N.VK)((()=>t.id),[t]),m=(0,N.VK)((()=>(0,io.wP)()),[]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:d.byline,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.byline",defaultMessage:"These settings apply to all users with a verified domain, even if they are not a member of this workspace."})})}),(0,r.jsx)(ml.Z,{title:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.managedUsers.helpButton",defaultMessage:"Learn about managed users"}),href:(0,yi.UY)("guides.managedUsers"),style:d.helpButton,analyticsFrom:"managed_users_section"}),(0,r.jsx)(fl,{promptUpgrade:!m,hasVerifiedDomains:n.length>0,disabled:!c}),(0,r.jsx)(xl,{promptUpgrade:!m,hasVerifiedDomains:n.length>0,domainSettingsStore:i,saveEmailDomainSettings:l,disabled:!c}),(0,r.jsx)(vl,{promptUpgrade:!m,domainSettingsStore:i,saveEmailDomainSettings:l,disabled:!c}),(0,r.jsx)(yl,{promptUpgrade:!m,verifiedDomains:n,domainSettingsStore:i,saveEmailDomainSettings:l,disabled:!c}),(0,r.jsx)(pl,{promptUpgrade:!m,domainSettingsStore:i,saveEmailDomainSettings:l,disabled:!c}),(0,r.jsx)(hl,{spaceId:u,promptUpgrade:!m,domainSettingsStore:i,verifiedDomains:n,disabled:!c}),(0,r.jsx)(gl,{spaceId:u,promptUpgrade:!m,domainSettingsStore:i,verifiedDomains:n,disabled:!c})]})}function bl(e){let{spaceStore:t,samlConfigStore:s}=e;const n=(0,L.O7)();return{updateSamlIdpUrl:(0,i.useCallback)((async e=>{let i=!1;return await tl({onRequest:()=>w.setSamlConfig(n,{spaceId:t.id,idpMetadataUrl:e}),onSuccess:()=>{i=!0,s.setState({...s.state,useMetadataUrl:!0,idpMetadataUrl:e,idpMetadata:void 0})}}),i}),[s,t,n]),updateSamlIdpXml:(0,i.useCallback)((async e=>{let i=!1;return await tl({onRequest:()=>w.setSamlConfig(n,{spaceId:t.id,idpMetadata:e}),onSuccess:()=>{i=!0,s.setState({...s.state,useMetadataUrl:!1,idpMetadataUrl:void 0,idpMetadata:e})}}),i}),[s,t,n]),updateStatus:(0,i.useCallback)((e=>tl({onRequest:()=>w.setSamlConfig(n,{spaceId:t.id,status:e}),onSuccess:()=>{s.setState({...s.state,status:e})}})),[s,t,n]),updateCreateAccount:(0,i.useCallback)((e=>tl({onRequest:()=>w.setSamlConfig(n,{spaceId:t.id,createAccount:e}),onSuccess:()=>{s.setState({...s.state,createAccount:e})}})),[s,t,n])}}function Ml(e){let{spaceStore:t,samlConfigStore:s,disabled:i}=e;window.__c={n:"CreateAccountSetting"};const{updateCreateAccount:n}=bl({samlConfigStore:s,spaceStore:t}),a=(0,L.O7)(),o=(0,lt.yK)((()=>({settingContainer:{margin:"18px 0"},settingsTitle:{display:"inline-flex",alignItems:"center"}})),[]),l=(0,N.VK)((()=>s.state.createAccount),[s]);return(0,r.jsx)("div",{style:o.settingContainer,children:(0,r.jsx)(Nr,{title:(0,r.jsxs)("div",{style:o.settingsTitle,children:[(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.createAccount.title",defaultMessage:"Automatic account creation"}),(0,r.jsx)(wn.Z,{icon:qo.m,onClick:()=>S.navigateToExternalURL({environment:a,url:(0,yi.UY)("guides.samlJIT")})})]}),byline:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.createAccount.byline",defaultMessage:"Automatically create Notion accounts for new users who log in via SAML SSO."}),isOn:l,onToggle:async function(){await n(!s.state.createAccount)},disabled:i})})}function wl(e){let{spaceStore:t,samlConfigStore:s,promptUpgrade:i,disabled:n}=e;window.__c={n:"SamlEnforceSetting"};const a=(0,L.O7)(),{updateStatus:o}=bl({samlConfigStore:s,spaceStore:t}),l=(0,lt.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),d=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.accountAuth.title",defaultMessage:"Login method"}),c=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.accountAuth.byline",defaultMessage:"Customize how users access SAML SSO-enabled workspaces."}),u=(0,N.VK)((()=>"enforced"===s.state.status?"enforced":"not_enforced"),[s]);return i?(0,r.jsx)("div",{style:l.settingContainer,children:(0,r.jsx)(nl,{title:d,byline:c,targetTier:"business"})}):(0,r.jsx)("div",{style:l.settingContainer,children:(0,r.jsx)(jo.Z,{isMobile:a.device.isMobile,disabled:n,title:d,caption:c,type:"dropdown",currentOption:u,options:[{key:"enforced",label:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.enforced",defaultMessage:"Only SAML SSO"})},{key:"not_enforced",label:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.accountAuth.option.notEnforced",defaultMessage:"Any method"})}],onSelectOption:async function(){"enforced"===s.state.status?await o("configured"):await o("enforced")}})})}var jl=s(54497),Cl=s(5228);function kl(e){let{isOpen:t,...s}=e;window.__c={n:"SamlConfigModal"};const i=(0,N.VK)((()=>({active:s.samlConfigStore.state.useMetadataUrl?"url":"xml",url:s.samlConfigStore.state.idpMetadataUrl||"",xml:s.samlConfigStore.state.idpMetadata||""})),[s.samlConfigStore]);return(0,r.jsx)(Bo.Z,{open:t,onDismiss:s.onClose,render:()=>(0,r.jsx)(_l,{...s,initialConfiguration:i})})}function _l(e){let{onSaveChanges:t,initialConfiguration:s,samlConfigStore:n,spaceStore:a,onClose:o}=e;window.__c={n:"SamlConfigSettings"};const[l,d]=(0,i.useState)(s),c=(0,L.O7)(),u=(0,lt.yK)((e=>({container:{background:e.popoverBackground,width:450,padding:24,borderRadius:3,transition:"all 500ms ease"},title:{fontFamily:p.Z.getCompositeFontFamily(is.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:p.Z.getCompositeFontFamily(is.SP).sans,fontSize:14,fontWeight:500,lineHeight:"19px",margin:"20px 0 0"},copyButton:{borderRadius:3,padding:"4px 8px",display:"flex",alignItems:"center",justifyContent:"center",color:e.lightTextColor,fontFamily:p.Z.getCompositeFontFamily(is.SP).sans,fontSize:12,fontWeight:500,lineHeight:"14px"},copyIcon:{width:16,height:16,marginRight:4,fill:e.mediumIconColor},url:{width:"100%",color:e.mediumTextColor,fontFamily:p.Z.getCompositeFontFamily(is.SP).sans,fontSize:14,fontWeight:400,lineHeight:"18px"},readonlyInput:{display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`,height:32,paddingLeft:12,paddingRight:12,borderRadius:3},divider:{margin:"20px auto 20px"},radioContainer:{display:"flex",justifyContent:"space-evenly",flexDirection:"column",height:60},radioOption:{display:"flex",alignItems:"center"},caption:{margin:"4px 0 8px"},centeredCaption:{margin:"4px 24px 8px",textAlign:"center"},buttonContainer:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginTop:24},buttonSpacing:{marginRight:8},feedback:{color:"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[400],display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px",height:20}})),[]),m=(0,i.useMemo)((()=>Il(l)),[l]),h=(0,N.VK)((()=>"unconfigured"===n.state.status),[n]),f=(0,N.VK)((()=>(0,Cl.v9)(a.id,Kt.default.domainBaseUrl)),[a]),y=(0,i.useCallback)((()=>{$t.RD({environment:c,stringValue:f,copiedMessage:$t.tq.copiedLinkToClipboard})}),[c,f]),v=(0,i.useCallback)((()=>{d((e=>({...e,active:"url"})))}),[]),x=(0,i.useCallback)((()=>{d((e=>({...e,active:"xml"})))}),[]),S=(0,lt.yK)((e=>({input:{transition:"all 200ms ease-in-out",boxShadow:"none",margin:"12px 0",width:"100%",background:e.popoverBackground,border:`1px solid ${e.outlineButtonBorder}`}})),[]),b=(0,i.useMemo)((()=>"url"===l.active?{placeholder:"https://...",value:l.url,onChange:e=>{const t=e.target.value;d((e=>({...e,url:t})))},style:{height:32,...S.input}}:{placeholder:'<md:EntityDescriptor entityID="...',value:l.xml,onChange:e=>{const t=e.target.value;d((e=>({...e,xml:t})))},textarea:!0,style:{height:118,...S.input},inputStyle:{width:"100%",height:"100%"}}),[l,S]),M=(0,i.useCallback)((()=>{t(l)}),[t,l]);return(0,r.jsxs)("div",{style:u.container,children:[(0,r.jsx)(It.Z,{style:u.title,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.title",defaultMessage:"SAML SSO Configuration"})}),(0,r.jsx)(It.Z,{isSmall:!0,style:u.centeredCaption,isMultiline:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.byline",defaultMessage:"Configure SAML SSO for your Notion workspace with your Identity Provider (IDP). <guidelink>Learn more</guidelink>.",values:{guidelink:e=>(0,r.jsx)(wo.Z,{href:(0,yi.UY)("guides.samlSettings"),external:!0,children:e})}})}),(0,r.jsx)(It.Z,{style:u.subtitle,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsTitle",defaultMessage:"Assertion Consumer Service (ACS) URL"})}),(0,r.jsx)(It.Z,{isSmall:!0,style:u.caption,isMultiline:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.acsByline",defaultMessage:"Enter this in your IDP's SAML configuration."})}),(0,r.jsxs)("div",{style:u.readonlyInput,children:[(0,r.jsx)(It.Z,{style:u.url,children:f}),(0,r.jsxs)(Jt.Z,{onClick:y,style:u.copyButton,children:[(0,Qt.U)(u.copyIcon),(0,r.jsx)(g.FormattedMessage,{id:"verifyDomainModal.editSamlConfig.copy",defaultMessage:"Copy"})]})]}),(0,r.jsx)(It.Z,{style:u.subtitle,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpTitle",defaultMessage:"Identity Provider Details"})}),(0,r.jsx)(It.Z,{isSmall:!0,style:u.caption,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrlByline",defaultMessage:"Enter the value provided by your IDP."})}),(0,r.jsxs)("div",{style:u.radioContainer,children:[(0,r.jsxs)(Ze.Z,{style:u.radioOption,onClick:v,children:[(0,r.jsx)(da.Z,{isSelected:"url"===l.active}),(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpUrl",defaultMessage:"Identity Provider URL"})})]}),(0,r.jsxs)(Ze.Z,{style:u.radioOption,onClick:x,children:[(0,r.jsx)(da.Z,{isSelected:"xml"===l.active}),(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.idpXml",defaultMessage:"Identity Provider Metadata XML"})})]})]}),(0,r.jsx)(Ue.Z,{...b}),(0,r.jsx)("div",{style:u.feedback,children:(0,r.jsx)(Tl,{validation:m})}),(0,r.jsxs)("div",{style:u.buttonContainer,children:[(0,r.jsx)(Wt.Z,{isLarge:!0,style:u.buttonSpacing,onClick:o,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.cancel",defaultMessage:"Cancel"})}),(0,r.jsx)(ce.Z,{isLarge:!0,disabled:"invalid"===m.type,onClick:M,children:h?(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.enableSaml",defaultMessage:"Enable SAML"}):(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.saveChanges",defaultMessage:"Save changes"})})]})]})}function Tl(e){let t,{validation:s}=e;if("valid"===s.type)return null;switch(s.reason){case"empty":t=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.empty",defaultMessage:"You cannot leave this field blank"});break;case"signed_request":t=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.editSamlConfig.feedback.signed_request",defaultMessage:"Requests cannot be signed"})}return(0,r.jsxs)(r.Fragment,{children:[(0,jl.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,r.jsx)("span",{children:t})]})}function Il(e){return"url"===e.active?(0,Cl.jY)(e.url):"xml"===e.active?(0,Cl.a7)(e.xml):void(0,_.t1)(e.active)}function Pl(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:n,isSamlStatusEnabled:a,promptUpgrade:o,disabled:l}=e;window.__c={n:"SamlToggle"};const[d,c]=(0,i.useState)({isOpened:!1,enableSamlOnSave:!1}),{updateStatus:u,updateSamlIdpUrl:m,updateSamlIdpXml:h}=bl({samlConfigStore:s,spaceStore:t}),{verifiedDomains:f}=sl({spaceStore:t,samlConfigStore:s,domainSettingsStore:n}),y=(0,lt.yK)((()=>({settingContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",cursor:l?"default":"pointer"},settingTitle:{fontWeight:p.Z.fontWeight.medium},settingByline:{marginBottom:4},configButton:{marginTop:14}})),[l]),v=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.samlToggle.title",defaultMessage:"Enable SAML SSO"}),x=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.samlToggle.byline",defaultMessage:"Anyone using email addresses with a verified domain can log in via SAML SSO."});return o?(0,r.jsx)(nl,{title:v,byline:x,targetTier:"business"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Nr,{title:v,byline:x,isOn:a,disabled:l,tooltipForDisabled:0===f.length?(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.samlToggle.disabledTooltipNoVerifiedDomains",defaultMessage:"Verify a domain to enable SAML."}):void 0,onToggle:function(){if(l)return;const{useMetadataUrl:e,idpMetadata:t,idpMetadataUrl:i}=s.state,n=e&&i||!e&&t;switch(s.state.status){case"disabled":n?u("configured"):c({isOpened:!0,enableSamlOnSave:!0});break;case"unconfigured":c({isOpened:!0,enableSamlOnSave:!0});break;case"configured":case"enforced":u("disabled")}}}),(0,r.jsx)(Wt.Z,{disabled:l,disabledFeedback:l,isLarge:!0,style:y.configButton,onClick:function(){l||c({isOpened:!0,enableSamlOnSave:!1})},children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.samlToggle.configure",defaultMessage:"Edit SAML SSO configuration"})}),(0,r.jsx)(kl,{isOpen:d.isOpened,onClose:()=>c({isOpened:!1,enableSamlOnSave:!1}),onSaveChanges:async function(e){if("invalid"===Il(e).type)return;let t=!1;switch(e.active){case"url":t=await m(e.url);break;case"xml":t=await h(e.xml)}t&&(d.enableSamlOnSave&&await u("configured"),c({isOpened:!1,enableSamlOnSave:!1}))},spaceStore:t,samlConfigStore:s})]})}var Zl=s(39634);const Fl={id:"name",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name",defaultMessage:"Name"}),renderCell:e=>(0,r.jsx)(Nl,{space:e.space,isCurrentSpace:e.isCurrentSpace}),widthData:{width:50},sortable:!0},Al={id:"memberCount",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.memberCount",defaultMessage:"Members"}),renderCell:e=>(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.members",defaultMessage:"{count} members",values:{count:e.space.memberCount}})}),widthData:{width:20},sortable:!0},Dl={id:"createdAt",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.plan",defaultMessage:"Created at"}),renderCell:e=>{const t=e.space.createdTime;return(0,r.jsx)(It.Z,{children:t&&(0,pt.Yx)(t,"medium",is.SP)})},widthData:{width:20},sortable:!0},Bl=[Fl,Al,Dl];function Rl(e){let{spaceStore:t,spaces:s}=e;window.__c={n:"WorkspacesTable"};const[n,a]=(0,i.useState)({column:Fl,sortAscending:!1}),o=(0,N.VK)((()=>s.map((e=>({id:e.id,isClickable:!1,isCurrentSpace:t.id===e.id,space:e})))),[s,t]),l=(0,lt.yK)((e=>(0,Xt.b)({columnRenderInfo:Bl,theme:e,containerMarginTop:12})),[]);return(0,r.jsx)(Xt.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Bl,rows:Ll(o,n),sortState:n,onSortStateChanged:a,renderNoRowsComponent:()=>(0,r.jsx)(It.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.empty",defaultMessage:"No linked workspaces."})}),styles:l})}function Ll(e,t){let{column:s,sortAscending:i}=t,n=[];switch(s.id){case"name":n=d.MR(e,(e=>e.space.name));break;case"createdAt":n=d.MR(e,(e=>e.space.createdTime));break;case"memberCount":n=d.MR(e,(e=>e.space.memberCount))}return i?n:n.reverse()}function Nl(e){window.__c={n:"WorkspaceNameCell"};const t=(0,lt.yK)((()=>({container:{display:"flex",justifyContent:"center",alignItems:"center",gap:4}})),[]);return(0,r.jsxs)(It.Z,{style:t.container,children:[e.space.name,e.isCurrentSpace?(0,r.jsx)(st.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.table.name.currentBadge",defaultMessage:"Current"})}):null]})}function El(e){let{spaceStore:t,spaces:s}=e;window.__c={n:"SecondaryWorkspaces"};const n=(0,L.O7)(),a=(0,lt.yK)((()=>({settingContainer:{margin:"18px 0"}})),[]),o=(0,i.useCallback)((()=>{Zl.j({environment:n,from:"saml_settings",prepopulatedContent:`Request to add or remove a workspace for SAML Single Sign-on on workspace ${t.id}.`})}),[t,n]);return(0,r.jsxs)("div",{style:a.settingContainer,children:[(0,r.jsx)(Lr,{title:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.title",defaultMessage:"Linked workspaces"}),byline:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.secondaryWorkspaces.message",defaultMessage:"This SAML SSO configuration applies to the following other workspaces. <contactlink>Contact support</contactlink> to add or remove a workspace.",values:{contactlink:e=>(0,r.jsx)(wo.Z,{onClick:o,children:e})}}),settingItem:null}),(0,r.jsx)(Rl,{spaceStore:t,spaces:s})]})}function Ol(e){let{spaceStore:t,samlConfigStore:s,domainSettingsStore:i}=e;window.__c={n:"SamlSection"};const{verifiedDomains:n,isSamlAvailable:a,isSamlEditable:o,isSamlStatusEnabled:l}=sl({spaceStore:t,samlConfigStore:s,domainSettingsStore:i}),d=!o||!a||!l,c=(0,N.VK)((()=>s.state.spaces),[s]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ml.Z,{title:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.samlToggle.learnMore",defaultMessage:"Learn about SAML SSO"}),href:(0,yi.UY)("guides.samlSettings"),style:{marginTop:18,marginBottom:16},analyticsFrom:"saml_settings"}),(0,r.jsx)(Pl,{disabled:!o||0===n.length,promptUpgrade:!a,isSamlStatusEnabled:l,spaceStore:t,samlConfigStore:s,domainSettingsStore:i}),(0,r.jsx)(wl,{disabled:d,promptUpgrade:!a,spaceStore:t,samlConfigStore:s}),(0,r.jsx)(Ml,{disabled:d,spaceStore:t,samlConfigStore:s}),(0,r.jsx)(El,{spaceStore:t,spaces:c})]})}const Vl=(0,g.defineMessages)({failedCreatingNewScimToken:{id:"scimTokenSettings.error.failedCreatingNewScimToken",defaultMessage:"Failed to create a new SCIM token, please try again later."}});function Ul(e){window.__c={n:"NewScimTokenButton"};const[t,s]=(0,i.useState)(!1),n=(0,L.O7)();const a=!t&&"Able"===e.tokenCreationAbility,o=t||"Able"!==e.tokenCreationAbility,l=(0,r.jsx)(Ze.Z,{isBlue:a,isLightGray:o,disabled:o,style:{position:"relative",marginLeft:"auto",marginRight:0},icon:e=>(0,no.R)({...e,width:14,height:14,fill:"inherit",marginRight:"6px"}),onClick:async function(){s(!0);try{const t=await async function(e){let{environment:t,spaceStore:s,userStore:i}=e;const{botStore:n,transactionPromise:a}=Ua.lz({environment:t,spaceStore:s,name:"SCIM",userId:i.id,spaceRole:"editor",type:"scim"});return await a,n.id}({...e,environment:n});e.onNewScimToken(t)}catch(t){v.showErrorMessage($.default.formatMessage(Vl.failedCreatingNewScimToken))}s(!1)},children:(0,r.jsx)(g.FormattedMessage,{id:"scimTokenSettings.NewSCIMTokenButton.title",defaultMessage:"Add token"})});let d;switch(e.tokenCreationAbility){case"Able":return l;case"Undefined":d=(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Not able to create a new SCIM token right now. Please try again later.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.undefined"});break;case"SpaceHasExistingToken":d=(0,r.jsx)(g.FormattedMessage,{defaultMessage:"To create a new SCIM token, please revoke the existing token.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.spaceHasLegacyToken"});break;case"UserHasExistingToken":d=(0,r.jsx)(g.FormattedMessage,{defaultMessage:"You already have a registered SCIM token. To create a new one, please revoke the token created by you.",id:"scimTokenSettings.NewSCIMTokenButton.unableToCreateTokenMessage.userHasExistingToken"});break;default:(0,_.t1)(e.tokenCreationAbility)}return(0,r.jsx)(fe.Z,{textWrap:!1,renderTooltip:()=>d,placement:fe.Z.Placement.Right,render:e=>(0,r.jsx)("div",{...e,style:{paddingLeft:"4px"},children:l})})}var Wl=s(15070);function zl(e){let{userId:t,currentSpaceStore:s}=e;return nt.U6.createChildStore(s,{table:q.KJ,id:t})}var Kl=s(62385);const Hl={container:{display:"flex",alignItems:"center",fontSize:p.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},userName:{flexShrink:1,...p.Z.textOverflowStyle}};function Gl(e,t){const s=Fa.kk.fromValue(G.cZ,e);return s.getCreatedByTable()===q.KJ&&s.getCreatedById()===t}const ql={buttonStyle:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:3,height:20,width:20,marginRight:1},menuItemButton:{minWidth:200}};function Yl(e){let{onRevokeToken:t}=e;window.__c={n:"RevokeTokenButton"};const s=(0,lt.Fg)();return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(fe.Z,{textWrap:!1,renderTooltip:()=>(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Revoke this token.",id:"revokeTokenButton.tooltip"})}),placement:fe.Z.Placement.Right,render:e=>(0,r.jsx)(Mn.ZP,{popupType:Mn.Z4.Popup,placementToOrigin:Mn.pO.Right,renderOrigin:t=>(0,r.jsx)(Jt.Z,{className:gi.TAd,style:ql.buttonStyle,mobileFeedback:!1,...e,...t,children:(0,er.y)({fill:s.mediumIconColor,width:12,height:12})}),onClick:()=>{v.confirmUserAction({message:(0,r.jsx)(g.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.message",defaultMessage:"Are you sure you want to revoke this token?"}),description:(0,r.jsx)(g.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.description",defaultMessage:"Existing SCIM configurations that use this token will no longer work once the token is revoked, and you'll have to provide them with a new token."}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.acceptButton.label",defaultMessage:"Revoke token"}),cancelLabel:(0,r.jsx)(g.FormattedMessage,{id:"manageSCIMTokenTable.ConfirmDeletingTokenModal.cancelButton.label",defaultMessage:"Cancel"})}).then((e=>e&&t()))},render:e=>(e.close(),(0,r.jsx)(r.Fragment,{}))})})})}const Ql=()=>{window.__c={n:"OutdatedWarningIcon"};const e=(0,lt.Fg)();return(0,r.jsx)(fe.Z,{textWrap:!1,renderTooltip:()=>(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Outdated token. Revoke this token and generate a new one to view its contents.",id:"manageScimTokenTable.OutdatedWarningIcon.tooltip"})}),placement:fe.Z.Placement.Right,render:t=>(0,r.jsx)("div",{...t,style:{paddingLeft:"4px"},children:(0,jl.t)({fill:(0,mt.fi)("orange",e).fill,width:12,height:12})})})};function $l(e){let{clipboardTextFn:t}=e;window.__c={n:"RenderCopyToClipboardButton"};const s=(0,L.O7)();const i=(0,lt.Fg)(),n={height:25,background:i.whiteButtonBackground,color:i.regularTextColor,fontWeight:p.Z.fontWeight.regular,padding:"4px 6px",fontSize:11.5};return(0,r.jsxs)(Kl.Z,{onClick:async function(){const e=await t();void 0!==e&&$t.RD({environment:s,stringValue:e,copiedMessage:$t.tq.copiedTokenToClipboard,showCopyModal:!!s.device.isSafari||void 0})},style:n,children:[(0,Qt.U)({height:16,width:16,paddingRight:4}),(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"})]})}const Xl="•••••••••••";function Jl(){return(0,r.jsx)(fe.Z,{textWrap:!1,renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{defaultMessage:"This token can only be viewed by its creator.",id:"manageScimTokenTable.renderTokenThatCannotBeViewed.tooltip"}),placement:fe.Z.Placement.Right,render:e=>(0,r.jsx)("div",{...e,children:Xl})})}function ed(e){let{row:t}=e;window.__c={n:"BotTokenCell"};const s=(0,L.O7)();return t.legacy?(0,r.jsxs)(r.Fragment,{children:[Xl,(0,r.jsx)(Ql,{})]}):t.ownedByCurrentUser?(0,r.jsxs)(r.Fragment,{children:[Xl,(0,r.jsx)($l,{clipboardTextFn:()=>Ua.VG({environment:s,botId:t.id})})]}):(0,r.jsx)(Jl,{})}const td={id:"token",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"manageScimTokenTable.columnTitle.token",defaultMessage:"Token"}),renderCell:e=>(0,r.jsx)(ed,{row:e}),widthData:{width:40},sortable:!1,hasClickableContents:!0},sd=()=>{const e=Hl;return(0,r.jsx)(fe.Z,{textWrap:!1,renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{defaultMessage:"This token was created by a user who is no longer an admin in the workspace.",id:"scimTableLegacyUserCell.tooltip"}),placement:fe.Z.Placement.Right,render:t=>(0,r.jsx)("div",{...t,children:(0,r.jsxs)("div",{style:e.container,children:[(0,r.jsx)(Un.Z,{style:e.userAvatar,avatarShouldShowShadow:!0,size:20}),(0,r.jsx)("div",{style:e.userName,children:(0,r.jsx)("i",{children:"Deactivated user"})})]})})})},id={id:"addedBy",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"manageScimTokenTable.columnTitle.addedBy",defaultMessage:"Added by"}),renderCell:e=>{if(e.legacy)return(0,r.jsx)(sd,{});{const t=e.ownedByCurrentUser?(0,r.jsx)(It.Z,{isSecondaryColor:!0,style:{marginLeft:4,textAlign:"center"},children:(0,r.jsx)(g.FormattedMessage,{id:"manageSCIMTokenTable.colums.addedBy.selfIndicator",defaultMessage:"(you)"})}):(0,r.jsx)(r.Fragment,{});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Gn.G,{isClickable:!1,userStores:[e.ownerUserStore]}),t]})}},widthData:{width:40},sortable:!1,hasClickableContents:!1},nd={id:"created",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"manageScimTokenTable.columnTitle.created",defaultMessage:"Created"}),renderCell:e=>(0,r.jsx)(Hi.T,{includeTime:!0,dateTs:e.createdAt}),widthData:{width:40},sortable:!0,hasClickableContents:!1},ad=[td,id,nd,{id:"revokeToken",headerTitle:void 0,renderCell:e=>(0,r.jsx)(Yl,{onRevokeToken:()=>{e.onRevokeToken()}}),widthData:{width:10},sortable:!1,hasClickableContents:!0}];function od(e,t){let{column:s,sortAscending:i}=t;const n=null==s?void 0:s.id;let a=e=>e.id;switch(n){case"name":a=e=>e.name;break;case"created":a=e=>e.createdAt;break;case"token":case"addedBy":case"revokeToken":case void 0:break;default:(0,_.t1)(n)}const o=d.MR(e,a);return i||o.reverse(),o}function rd(e){let{botStores:t,onRevokeToken:s}=e;window.__c={n:"ManageScimTokenTable"};const n=(0,N.VK)((()=>I.default.state.currentUserStore),[]),a=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),o=(0,g.useIntl)(),l=(0,N.VK)((()=>{if(!a)return[];const e=null==n?void 0:n.id;return d.oA(t.map((t=>{const i=t.getModel();if(!i||!(0,Wl.xe)(i))return;const n={id:i.id,isClickable:!1,createdAt:i.getCreatedAt(),userLocale:o.locale,name:i.getName(),onRevokeToken:()=>{s(i.id)}},r=function(e){const t=Fa.kk.fromValue(G.cZ,e);return"notion_user"===t.getCreatedByTable()&&t.getCreatedById()===q.s$.id}(i);return r?{...n,legacy:r}:{...n,legacy:r,ownedByCurrentUser:Gl(i,e),ownerUserStore:"notion_user"===i.getCreatedByTable()?zl({userId:i.getCreatedById(),currentSpaceStore:a}):void 0}})))}),[t,a,n,o.locale,s]),[c,u]=(0,i.useState)({column:nd,sortAscending:!1}),m=(0,lt.yK)((e=>(0,Xt.b)({columnRenderInfo:ad,theme:e,containerMarginTop:0})),[]);return(0,r.jsx)(Xt.D,{columnRenderInfo:ad,rows:od(l,c),sortState:c,onSortStateChanged:u,onRowClick:()=>(0,r.jsx)(r.Fragment,{}),renderNoRowsComponent:()=>(0,r.jsx)(It.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:(0,r.jsx)(g.FormattedMessage,{id:"manageSCIMTokenTable.noTokensFound.message",defaultMessage:"No active SCIM tokens."})}),styles:m})}async function ld(e){let{environment:t,spaceId:s}=e;return(await Ua.Yw({environment:t,table:us.bx,id:s,type:"scim"})).botIds}const dd=function(e){let{botIds:t,setBotIds:s,spaceStore:n}=e;window.__c={n:"ScimTokenSettings"};const a=(0,L.O7)(),o=n.id;if((0,i.useEffect)((()=>{void 0===t&&ld({environment:a,spaceId:o}).then(s)}),[t,a,s,o]),t){const e=t.map((e=>nt.t1.createChildStore(n,{table:G.cZ,id:e,spaceId:o})));return(0,r.jsx)(rd,{botStores:e,onRevokeToken:e=>{Ua.P0({environment:a,botId:e,onSuccess:()=>{ld({environment:a,spaceId:o}).then(s)}})}})}return(0,r.jsx)(Ki.Z,{})};function cd(e){let{userStore:t,spaceStore:s,promptUpgrade:n}=e;window.__c={n:"ScimTokens"};const[a,o]=(0,i.useState)(void 0),l=(0,L.O7)(),d=(0,N.VK)((()=>function(e){let{botIds:t,spaceStore:s,environment:i}=e;if(void 0===t)return"Undefined";const n=t.map((e=>nt.t1.createChildStore(s,{table:G.cZ,id:e,spaceId:s.id}))).filter((e=>e.isDefined()));if(n.some((e=>e.getCreatedByTable()===q.KJ&&e.getCreatedById()===q.s$.id)))return"SpaceHasExistingToken";if(n.some((e=>e.getCreatedByTable()===q.KJ&&e.getCreatedById()===i.currentUser.id)))return"UserHasExistingToken";return"Able"}({botIds:a,spaceStore:s,environment:l})),[a,l,s]),c=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.scim.title",defaultMessage:"SCIM tokens"}),u=(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.scim.byline",defaultMessage:"Generate a token to configure SCIM."});return n?(0,r.jsx)(nl,{title:c,byline:u,targetTier:"enterprise"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Lr,{title:c,byline:u,settingItem:(0,r.jsx)(Ul,{onNewScimToken:e=>o((t=>[...t??[],e])),spaceStore:s,userStore:t,tokenCreationAbility:d})}),(0,r.jsx)(ml.Z,{title:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.SCIMSection.helpButton.label",defaultMessage:"Learn about SCIM"}),style:{marginTop:18,marginBottom:24},href:(0,yi.UY)("guides.scim"),analyticsFrom:"scim_settings"}),(0,r.jsx)(dd,{spaceStore:s,userStore:t,botIds:a,setBotIds:o})]})}function ud(e){let{userStore:t,spaceStore:s}=e;window.__c={n:"ScimSection"};const i=(0,N.VK)((()=>(0,io.wP)()),[]);return(0,r.jsx)(cd,{promptUpgrade:!i,userStore:t,spaceStore:s})}function md(e){let{primarySpaceName:t}=e;window.__c={n:"SecondaryWorkspaceNotice"};const s=(0,lt.yK)((e=>({container:{background:e.accentColors.blue[100],padding:"18px 24px",borderRadius:4,margin:"0 0 24px"}})),[]);return(0,r.jsxs)("div",{style:s.container,children:[(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableTitle",defaultMessage:"The primary workspace is <bold>{primaryWorkspaceName}</bold>.",values:{primaryWorkspaceName:t,bold:e=>(0,r.jsx)("span",{style:{fontWeight:p.Z.fontWeight.semibold},children:e})}})}),(0,r.jsx)("br",{}),(0,r.jsx)(It.Z,{isMultiline:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.secondaryWorkspace.uneditableMessage",defaultMessage:"The domain management settings and SAML SSO configuration are being managed by the workspace <bold>{primaryWorkspaceName}</bold>. Please navigate there or contact an admin of that workspace to edit the verified domains or SSO configuration.",values:{primaryWorkspaceName:t,bold:e=>(0,r.jsx)("span",{style:{fontWeight:p.Z.fontWeight.semibold},children:e})}})})]})}var pd=s(89101),gd=s(23124);function hd(e){let{spaceStore:t,isEnterprise:s}=e;window.__c={n:"SetupInformation"};const i=(0,g.useIntl)(),n=(0,N.VK)((()=>t.id),[t]);return(0,r.jsxs)(gd.rj,{gap:8,children:[(0,r.jsx)(gd.r8,{row:1,col:1,children:(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.workspaceId",defaultMessage:"Workspace ID"})})}),(0,r.jsx)(gd.r8,{row:1,col:2,children:(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,children:(0,r.jsx)(fd,{text:n,tooltip:i.formatMessage({id:"securitySAMLSettings.SetupInformationSection.workspaceId.copyTooltip",defaultMessage:"Click to copy ID"})})})}),s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(gd.r8,{row:2,col:1,children:(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityIDLink",defaultMessage:"SAML SSO/SAML Entity ID"})})}),(0,r.jsx)(gd.r8,{row:2,col:2,children:(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,children:(0,r.jsx)(fd,{text:(0,Cl.AE)(Kt.default.domainBaseUrl),tooltip:i.formatMessage({id:"securitySAMLSettings.SetupInformationSection.samlSSOEntityID.copyTooltip",defaultMessage:"Click to copy link"})})})}),(0,r.jsx)(gd.r8,{row:3,col:1,children:(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl",defaultMessage:"SCIM base URL"})})}),(0,r.jsx)(gd.r8,{row:3,col:2,children:(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,children:(0,r.jsx)(fd,{text:Kt.default.domainBaseUrl+pd._j.scimApiBasePath,tooltip:i.formatMessage({id:"securitySAMLSettings.SetupInformationSection.scimBaseUrl.copyTooltip",defaultMessage:"Click to copy link"})})})})]}):null]})}function fd(e){let{tooltip:t,text:s}=e;window.__c={n:"CopyableText"};const i=(0,L.O7)();return(0,r.jsx)(fe.Z,{delayThreshold:0,renderTooltip:()=>t,render:e=>(0,r.jsx)(wo.Z,{onClick:()=>{$t.RD({environment:i,stringValue:s,copiedMessage:$t.tq.copiedPropertyToClipboard})},...e,children:s})})}function yd(e){let{userStore:t,spaceStore:s,samlConfigStore:n,domainSettingsStore:a}=e;window.__c={n:"SettingsPage"};const o=(0,L.O7)(),l=(0,N.VK)((()=>Vi.Z.state.online),[]),{loadingSaml:d,loadedSaml:c,errorSaml:u}=(0,i.useContext)(Ho),m=(0,N.VK)((()=>function(e){let{environment:t,samlConfigStore:s,spaceStore:i}=e;const n=Jr({environment:t,samlConfigStore:s}),a=!s.state.id||s.state.id===i.id;return n&&a}({environment:o,samlConfigStore:n,spaceStore:s})),[o,n,s]),p=(0,N.VK)((()=>n.state.id?el.Z.getPublicSpaceData(o,n.state.id):void 0),[o,n]),h=(0,lt.yK)((()=>({header:{marginTop:48}})),[]),f=(0,N.VK)((()=>(0,io.wP)()),[]);return l?d?(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(Ki.Z,{style:{margin:"0 auto"}})}):u?(v.deprecatedShowErrorMessage(u.message),null):c?(0,r.jsxs)(Ui.Z,{children:[!m&&p?(0,r.jsx)(md,{primarySpaceName:p.name}):null,(0,r.jsx)(zt.Z,{large:!0,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.domain.title",defaultMessage:"Domain management"})}),(0,r.jsx)(ul,{spaceStore:s,samlConfigStore:n,domainSettingsStore:a,isCurrentSpaceEnterprise:f}),(0,r.jsx)(zt.Z,{large:!0,divider:"full",style:h.header,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.userManagement.title",defaultMessage:"User management"})}),(0,r.jsx)(Sl,{spaceStore:s,samlConfigStore:n,domainSettingsStore:a}),(0,r.jsx)(zt.Z,{large:!0,divider:"full",style:h.header,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.saml.title",defaultMessage:"SAML Single sign-on (SSO)"})}),(0,r.jsx)(Ol,{spaceStore:s,samlConfigStore:n,domainSettingsStore:a}),(0,r.jsx)(zt.Z,{large:!0,divider:"full",style:h.header,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.scim.title",defaultMessage:"SCIM provisioning"})}),(0,r.jsx)(ud,{userStore:t,spaceStore:s}),(0,r.jsx)(zt.Z,{large:!0,divider:"full",style:h.header,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.setupInfo.title",defaultMessage:"Setup information"})}),(0,r.jsx)(hd,{spaceStore:s,isEnterprise:f})]}):null:(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to manage identity and provisioning settings.",id:"identityProvisioningSettings.offline.message"})})})}function vd(e,t){return(void 0===e||!(0,qa.XR)(e))&&(!(void 0===e||!(0,qa.TZ)(e)||0!==t)||1===t)}var xd=s(92595),Sd=s(92165);const bd=(0,o.I)("arrowUpCircled",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M7.993 15.126c.966 0 1.875-.185 2.728-.554a7.218 7.218 0 003.787-3.78 6.788 6.788 0 00.553-2.728c0-.966-.184-1.875-.553-2.727a7.136 7.136 0 00-1.531-2.25 7.219 7.219 0 00-2.256-1.53 6.805 6.805 0 00-2.735-.554c-.966 0-1.875.185-2.727.554a7.241 7.241 0 00-3.774 3.78 6.788 6.788 0 00-.553 2.727c0 .967.184 1.876.553 2.728.37.852.878 1.604 1.525 2.256a7.124 7.124 0 002.256 1.524 6.77 6.77 0 002.727.554zm0-1.395a5.598 5.598 0 01-4.013-1.654 5.735 5.735 0 01-1.21-1.804 5.567 5.567 0 01-.437-2.209c0-.783.146-1.517.438-2.2a5.715 5.715 0 011.21-1.812 5.6 5.6 0 011.797-1.217 5.599 5.599 0 012.208-.438c.789 0 1.525.146 2.208.438a5.66 5.66 0 013.029 3.028 5.55 5.55 0 01.437 2.201c0 .789-.146 1.525-.437 2.209a5.68 5.68 0 01-1.217 1.804 5.68 5.68 0 01-1.805 1.217 5.567 5.567 0 01-2.208.437zM8 11.51a.597.597 0 00.43-.164.584.584 0 00.172-.431V7.688L8.547 6.28l.622.78.759.793a.53.53 0 00.417.177c.16 0 .291-.052.396-.157a.518.518 0 00.164-.39.595.595 0 00-.164-.417L8.485 4.783A.664.664 0 008 4.558c-.173 0-.333.075-.479.225L5.26 7.066a.593.593 0 00-.157.417.538.538 0 00.554.547.557.557 0 00.416-.177l.766-.8.615-.766-.055 1.401v3.227c0 .173.057.317.171.43.114.11.258.165.431.165z"})});var Md=s(63143),wd=s(27242),jd=s(73420);function Cd(){return(0,r.jsx)(fe.Z,{renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceClaim.Explanation",defaultMessage:"Workspace claim request is being processed."}),render:e=>(0,r.jsx)(It.Z,{...e,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingClaim",defaultMessage:"Pending"})})})}function kd(e){let{admin:t}=e;window.__c={n:"PendingSpaceTransferMessage"};const s=(0,g.useIntl)();return(0,r.jsx)(fe.Z,{renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingWorkspaceTransferExplanation",defaultMessage:"Waiting for {name} to transfer the workspace to an external account.",values:{name:(0,Vn.Nz)(s,t)}}),render:e=>(0,r.jsx)(It.Z,{...e,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingTransfer",defaultMessage:"Pending"})})})}let _d=function(e){return e.Single="single",e.Multi="multi",e}({});function Td(e){window.__c={n:"SpaceActionsMenu"};const{space:t,mode:s}=e,i=(0,N.qz)(void 0,vn.Z),n=(0,lt.yK)((()=>({container:{minWidth:325}})),[]);return s===_d.Single?(0,r.jsx)(Pd,{action:e.action,space:t}):(0,r.jsx)(Mn.ZP,{popupType:ge.kQ.Popup,style:n.container,buttonPopupStore:i,renderOrigin:e=>(0,r.jsx)(wn.Z,{icon:pn.o,...e}),render:()=>(0,r.jsx)(Id,{space:t,actions:e.actions,popupStore:i})})}function Id(e){let{space:t,actions:s,popupStore:i}=e;const n={key:"workspace-actions",render:e=>(0,r.jsx)(he.Z,{...e}),items:s.map((e=>{const s=!!e.getDisabledState&&e.getDisabledState(t),i=e.getTooltip?e.getTooltip(t):null;return{key:e.id,render:t=>(0,r.jsx)(fe.Z,{render:i=>(0,r.jsx)(gr.Z,{...t,...i,shouldWrapCaption:!0,svg:t=>e.getIcon(t),title:e.name,caption:e.caption,style:{paddingTop:8,paddingBottom:8,opacity:s?.5:1},disabled:s}),renderTooltip:()=>i,disableTooltip:!Boolean(i),placement:fe.Z.Placement.Left}),action:()=>e.onAction(t)}}))};return(0,r.jsx)(me.Z,{menuType:ye.og.Popup,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:[n],onAccept:()=>{i.setState({open:!1})}})})}function Pd(e){window.__c={n:"SingleSpaceActionButton"};const{action:t,space:s}=e,n=(0,lt.yK)((e=>({button:{paddingLeft:5,paddingRight:5}})),[]),a=i.useCallback((()=>{t.onAction(s)}),[t,s]);return(0,r.jsx)(Ze.Z,{isSmall:!0,style:n.button,onClick:a,children:t.name})}var Zd=s(33941);function Fd(e){let{id:t,name:s,icon:i,subscriptionTier:n,memberCount:a,highlightIconContainer:o}=e;window.__c={n:"SpaceSummary"};const l=(0,g.useIntl)(),d=i?{pointer:{table:us.bx,id:t,spaceId:t},icon:i}:void 0,c=(0,lt.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",padding:"8px 0",width:"100%"},summaryContainer:{width:"calc(100% - 38px)"},iconContainer:{height:38,width:38,flexGrow:0,flexShrink:0,flexBasis:38,marginRight:12,display:"flex",justifyContent:"center",alignItems:"center",background:o?e.selectLightGray[50]:void 0,borderRadius:6},name:{fontSize:14,fontWeight:500},byline:{fontSize:12,opacity:.5}})),[o]);return(0,r.jsxs)("div",{style:c.container,children:[(0,r.jsx)("div",{style:c.iconContainer,children:(0,r.jsx)(Zn.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:32,title:s,isLarge:!0,emojiSize:28,isRaw:!1})}),(0,r.jsxs)("div",{style:c.summaryContainer,children:[(0,r.jsx)(It.Z,{style:c.name,showTooltipWhenTruncated:!0,children:s}),(0,r.jsx)(It.Z,{style:c.byline,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.summaryByline",defaultMessage:"{subscriptionTier} · {memberCount, plural, one {{memberCount} member} other {{memberCount} members}}",values:{subscriptionTier:Ad(n,l),memberCount:a}})})]})]})}function Ad(e,t){switch(e){case"personal_free":case"team_free":case"free":return t.formatMessage(Zd.a.free);case"personal":return t.formatMessage(Zd.a.personal);case"plus":return t.formatMessage(Zd.a.plusPlan);case"business":return t.formatMessage(Zd.a.business);default:(0,_.t1)(e)}}var Dd=s(3556);function Bd(e){let{users:t,deletedUserEmailDomain:s}=e;window.__c={n:"SpaceUsers"};const i=(0,N.qz)(void 0,vn.Z),n=(0,lt.yK)((()=>({container:{minWidth:275}})),[]);return(0,r.jsx)(Mn.ZP,{popupType:ge.kQ.Popup,style:n.container,buttonPopupStore:i,renderOrigin:e=>(0,r.jsx)(Nd,{users:t,deletedUserEmailDomain:s,...e}),render:()=>(0,r.jsx)(Rd,{users:t,popupStore:i})})}function Rd(e){let{users:t,popupStore:s}=e;window.__c={n:"WorkspaceUsersMenu"};const i=(0,L.O7)(),n={key:"workspace-users-menu",render:e=>(0,r.jsx)(he.Z,{...e}),items:t.map((e=>({key:e.id,render:t=>(0,r.jsx)(Ld,{user:e,...t}),action:()=>S.navigateToExternalURL({environment:i,url:`mailto:${e.email}`})})))};return(0,r.jsx)(me.Z,{menuType:ye.og.Popup,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:0,sections:[n],onAccept:()=>{s.setState({open:!1})}})})}function Ld(e){let{user:t,...s}=e;window.__c={n:"EmailableUserSummary"};const i=(0,g.useIntl)(),n=(0,lt.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",height:"auto",paddingTop:8,paddingBottom:8,margin:"0 6px"},avatarContainer:{display:"flex",justifyContent:"center",alignItems:"center"},copyContainer:{display:"flex",justifyContent:"center",alignItems:"center",marginLeft:"auto",opacity:.5},nameContainer:{marginLeft:8,marginRight:8},name:{fontSize:14,lineHeight:1.2,maxWidth:300},email:{fontSize:12,lineHeight:1.2,opacity:.5,maxWidth:300}})),[]);return(0,r.jsxs)(Ze.Z,{style:n.container,...s,children:[(0,r.jsx)("div",{style:n.avatarContainer,children:(0,r.jsx)(Un.Z,{userValue:t,size:24})}),(0,r.jsxs)("div",{style:n.nameContainer,children:[(0,r.jsx)(It.Z,{style:n.name,children:(0,Vn.Nz)(i,t)}),(0,r.jsx)(It.Z,{style:n.email,children:t.email})]}),(0,r.jsx)("div",{style:n.copyContainer,children:(0,Dd.Z)({height:18,width:18})})]})}function Nd(e){let{users:t,deletedUserEmailDomain:s,...i}=e;window.__c={n:"MultiUsersDisplay"};const n=(0,g.useIntl)(),a=(0,lt.yK)((e=>({container:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",marginLeft:"-8px",maxWidth:"100%"},empty:{fontSize:14,maxWidth:150,opacity:.5},name:{fontSize:14,maxWidth:150},plusMore:{opacity:.5,display:"inline"}})),[]);return 0===t.length?(0,r.jsx)(fe.Z,{render:e=>(0,r.jsx)(Ze.Z,{style:a.container,disabled:!0,...i,...e,children:(0,r.jsx)(It.Z,{style:a.empty,children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.empty",defaultMessage:"Deleted user"})})}),disableTooltip:!s,renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.emptyTooltip",defaultMessage:"Deleted user from {domain}",values:{domain:`@${s}`}})}):(0,r.jsx)(Ze.Z,{style:a.container,...i,children:(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.users.name",defaultMessage:"{remainingCount, plural, =0 {{firstUser}} one {{firstUser} <gray>+{remainingCount}</gray>} other {{firstUser} <gray>+{remainingCount}</gray>}}",values:{firstUser:(0,Vn.Nz)(n,t[0]),remainingCount:t.length-1,gray:e=>(0,r.jsx)(It.Z,{style:a.plusMore,children:e})}})})})}const Ed=[{id:"spaces",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.name",defaultMessage:"Workspaces"}),renderCell:e=>(0,r.jsx)(Fd,{id:e.space.id,name:e.space.name,icon:e.space.icon,subscriptionTier:e.space.subscriptionTier,memberCount:e.space.memberCount}),widthData:{width:60},sortable:!1},{id:"admins",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.admins",defaultMessage:"Workspace owners"}),renderCell:e=>(0,r.jsx)(Bd,{users:e.space.admins}),widthData:{width:40},sortable:!1},{id:"createdBy",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdBy",defaultMessage:"Created by"}),renderCell:e=>e.space.creator?(0,r.jsx)(Bd,{users:[e.space.creator]}):(0,r.jsx)(Bd,{users:[],deletedUserEmailDomain:e.space.creatorEmailDomain}),widthData:{width:40},sortable:!1},{id:"createdAt",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.createdAt",defaultMessage:"Created date"}),renderCell:e=>(0,r.jsx)(It.Z,{style:{opacity:.5},children:(0,Fr.gs)(e.space.createdAt)}),widthData:{width:30},sortable:!1},{id:"action",headerTitle:null,renderCell:e=>{if((0,qa.DI)(e.space.spaceRequest))return(0,r.jsx)(kd,{admin:e.space.admins[0]});if((0,qa.XR)(e.space.spaceRequest))return(0,r.jsx)(Cd,{});if((0,qa.TZ)(e.space.spaceRequest)){const t=e.actions.find((e=>"recover-space"===e.id));return t&&(0,r.jsx)(Td,{space:e.space,action:t,mode:_d.Single})}return e.actions.length>0?(0,r.jsx)(Td,{space:e.space,actions:e.actions.filter((e=>"recover-space"!==e.id)),mode:_d.Multi}):null},widthData:{width:15},sortable:!1}];function Od(e){let{claimableSpaces:t,spaceActions:s,loadMoreClaimableSpaces:i,loading:n}=e;window.__c={n:"ClaimableSpacesTable"};const a=t.map((e=>({id:e.id,isClickable:!1,space:e,actions:s}))),o=(0,lt.yK)((e=>(0,Xt.b)({columnRenderInfo:Ed,theme:e,containerMarginTop:0})),[]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Xt.D,{hideHeaderRowPadding:!0,showRowBorders:!0,columnRenderInfo:Ed,rows:a,renderNoRowsComponent:()=>(0,r.jsx)(It.Z,{isSmall:!0,style:{marginTop:15,marginBottom:40,textAlign:"center"},children:!n&&(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.empty",defaultMessage:"No claimable workspaces."})}),styles:o,getStyleForRow:function(e){if((0,qa.DI)(e.space.spaceRequest)||(0,qa.XR)(e.space.spaceRequest)||(0,qa.TZ)(e.space.spaceRequest))return{opacity:.5}},onScrollBottom:i}),n&&(0,r.jsx)(Ki.Z,{style:{margin:"24px auto 24px"}})]})}var Vd=s(33728),Ud=s(64275),Wd=s(36329),zd=s(98519),Kd=s(16354);const Hd=(0,g.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.placeholder",defaultMessage:"it@example.com"}}),Gd=e=>{let{onDismiss:t,spaceQueuedForTransfer:s,currentSpaceId:n}=e;window.__c={n:"PersonalTransferSpaceConfirmationModal"};const[a,o]=(0,i.useState)(),[l,d]=(0,i.useState)(!1),{setSpaceRequest:c}=(0,i.useContext)(Ho),u=(0,L.O7)(),m=(0,lt.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:p.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:p.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},dividerContainer:{marginTop:20},dividerInner:{borderBottomColor:e.regularDividerColor},contactEmailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},contactEmailTitle:{fontWeight:p.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},primaryButton:{width:"100%",marginTop:32},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:p.Z.fontWeight.medium,color:e.lightTextColor},buttonCaptionError:{color:e.errorText,marginTop:8,fontSize:13}})),[]),h=Boolean(s);return(0,r.jsx)(Bo.Z,{open:h,innerStyle:m.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:m.closeIconContainer,children:(0,r.jsx)(Ze.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,Ud.D)(m.closeIcon)})}),(0,r.jsx)("div",{children:(0,Wd._)(m.modalIcon)}),(0,r.jsxs)(It.Z,{style:m.title,children:[(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.selfServe.title",defaultMessage:"Require account change"}),(0,r.jsx)(Kd.Z,{href:(0,yi.UY)("guides.domainManagement"),children:(0,r.jsx)(wn.Z,{icon:qo.m})})]}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:m.description,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.byline",defaultMessage:"You’re about to require the Workspace Owner of 1 workspace to use an external Notion accounts. They will be unable to use the workspace until the change is made."})}),(0,r.jsxs)("div",{style:m.workspaceContainer,children:[s?(0,r.jsx)(Fd,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):null,(0,r.jsx)("div",{style:m.checkContainer,children:(0,zd.k)(m.check)})]}),(0,r.jsx)(bo.Z,{size:"100%",innerStyle:m.dividerInner,style:m.dividerContainer}),(0,r.jsxs)("div",{style:m.contactEmailContainer,children:[(0,r.jsxs)(It.Z,{style:m.contactEmailTitle,children:[(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.title",defaultMessage:"Send request from"}),(0,r.jsx)(fe.Z,{renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.table.pendingExplanation",defaultMessage:"The Workspace Owner can contact this email for inquiries"}),render:e=>(0,r.jsx)("span",{...e,children:(0,qo.m)(m.helpIcon)})})]}),(0,r.jsx)(Ue.Z,{value:a,placeholder:$.default.formatMessage(Hd.emailPlaceholder),onChange:e=>{d(!1),o(e.target.value)}}),l&&(0,r.jsx)(It.Z,{isSmall:!0,style:m.buttonCaptionError,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.contactEmail.error",defaultMessage:"Invalid email address"})})]}),(0,r.jsx)(ce.Z,{isLarge:!0,style:m.primaryButton,onClick:async()=>{const e=(0,Vd.H3)(a);var i;if((0,Vd.oH)(e)){if(s&&e){const a=await w.initiateWorkspaceTransfer(u,{requestingSpaceId:n,targetSpaceId:s.id,contactEmail:e});if("failed"===a.type)v.showErrorMessage((0,Q.wf)($.default.getIntl(),a));else{const n=a.data.workspaceTransfer;c(s.id,n),y.azK(u,{contactEmail:e,currentOwners:s.admins.map((e=>e.id)),targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain,subscriptionTier:s.subscriptionTier}),t(),i=s.name,sr.oV({label:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.toast",defaultMessage:"Account change successfully requested for “{spaceName}“",values:{spaceName:i}})})}}}else d(!0)},children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.confirm",defaultMessage:"Confirm change"})}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:m.buttonCaption,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.buttonCaption",defaultMessage:"This cannot be undone"})}),(0,r.jsx)(Ze.Z,{style:m.secondaryButton,onClick:t,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.transferWorkspaces.transferModal.cancel",defaultMessage:"Cancel"})})]})})};const qd=e=>{let{onDismiss:t,spaceQueuedForClaiming:s,requestingSpaceId:n}=e;window.__c={n:"SalesAssistedClaimSpaceConfirmationModal"};const a=(0,L.O7)(),{setSpaceRequest:o}=(0,i.useContext)(Ho),l=(0,lt.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},title:{fontWeight:p.Z.fontWeight.medium,fontSize:16,marginBottom:8,display:"inline-flex",alignItems:"center",justifyContent:"center"},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:p.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:p.Z.fontWeight.medium,color:e.lightTextColor},buttonCaption:{color:e.mediumTextColor,marginTop:8,textAlign:"center",fontSize:12}})),[]),d=Boolean(s),c=async()=>{if(!s)return;const e=await w.requestClaimAndUpgrade(a,{requestingSpaceId:n,targetSpaceId:s.id});var i;"failed"===e.type?v.showError(e):(y.eO1(a,{currentOwners:s.admins.map((e=>e.id)),targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain,memberCount:s.memberCount}),o(s.id,e.data.spaceRequest),i=s.name,sr.oV({label:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.toast",defaultMessage:"Workspace claim successfully requested for “{spaceName}“",values:{spaceName:i}})})),t()};return(0,r.jsx)(Bo.Z,{open:d,innerStyle:l.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:l.closeIconContainer,children:(0,r.jsx)(Ze.Z,{isSmall:!0,onClick:t,children:(0,Ud.D)(l.closeIcon)})}),(0,r.jsxs)(It.Z,{style:l.title,children:[(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.title",defaultMessage:"Request workspace claim"}),(0,r.jsx)(Kd.Z,{href:(0,yi.UY)("guides.domainManagement"),children:(0,r.jsx)(wn.Z,{icon:qo.m})})]}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:l.description,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",values:{currentWorkspaceName:s?s.name:"the workspace below"}})}),(0,r.jsxs)("div",{style:l.workspaceContainer,children:[s?(0,r.jsx)(Fd,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):null,(0,r.jsx)("div",{style:l.checkContainer,children:(0,zd.k)(l.check)})]}),(0,r.jsx)(ce.Z,{isLarge:!0,style:l.primaryButton,onClick:c,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.sendRequest",defaultMessage:"Send request"})}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:l.buttonCaption,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.buttonCaption",defaultMessage:"This request may take a few days to process. For more information, contact your <accountmanageremail>Account Management team</accountmanageremail>.",values:{accountmanageremail:e=>(0,r.jsx)(wo.Z,{href:"mailto:am@makenotion.com",children:e})}})}),(0,r.jsx)(Ze.Z,{style:l.secondaryButton,onClick:t,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.salesAssisted.cancel",defaultMessage:"Cancel"})})]})})};const Yd=e=>{let{onDismiss:t,spaceQueuedForClaiming:s}=e;window.__c={n:"SelfServeClaimSpaceConfirmationModal"};const i=(0,lt.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:e.mediumIconColor,height:24,width:24},title:{fontWeight:p.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16},description:{fontWeight:p.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:p.Z.fontWeight.medium,color:e.lightTextColor}})),[]),n=Boolean(s);return(0,r.jsx)(Bo.Z,{open:n,innerStyle:i.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:i.closeIconContainer,children:(0,r.jsx)(Ze.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,Ud.D)(i.closeIcon)})}),(0,r.jsx)("div",{children:bd(i.modalIcon)}),(0,r.jsxs)(It.Z,{style:i.title,children:[(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.title",defaultMessage:"Claim workspace"}),(0,r.jsx)(Kd.Z,{href:(0,yi.UY)("guides.domainManagement"),children:(0,r.jsx)(wn.Z,{icon:qo.m})})]}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:i.description,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.byline",defaultMessage:"You’re about to take ownership of {currentWorkspaceName} and upgrade it to an Enterprise plan. You’ll become the Workspace owner and the existing owners will be downgraded to members.",values:{currentWorkspaceName:s?s.name:"the workspace below"}})}),(0,r.jsxs)("div",{style:i.workspaceContainer,children:[s?(0,r.jsx)(Fd,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):null,(0,r.jsx)("div",{style:i.checkContainer,children:(0,zd.k)(i.check)})]}),(0,r.jsx)(ce.Z,{isLarge:!0,style:i.primaryButton,onClick:()=>{s&&Li.Xb(s)},children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.reviewAndPay",defaultMessage:"Review and pay"})}),(0,r.jsx)(Ze.Z,{style:i.secondaryButton,onClick:t,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimModal.selfServe.cancel",defaultMessage:"Cancel"})})]})})};var Qd=s(84939);const $d=(0,g.defineMessages)({emailPlaceholder:{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.placeholder",defaultMessage:"it@example.com"}}),Xd=e=>{let{onDismiss:t,spaceQueuedForDeletion:s,currentSpaceId:n}=e;window.__c={n:"SpaceDeletionConfirmationModal"};const[a,o]=(0,i.useState)({email:void 0,didError:!1}),[l,d]=(0,i.useState)(!1),[c,u]=(0,i.useState)(!1),{setSpaceRequest:m}=(0,i.useContext)(Ho),h=(0,lt.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{fill:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],height:24,width:24},title:{fontWeight:p.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:p.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},checkboxContainer:{display:"inline-flex",marginTop:8,alignItems:"center"},checkbox:{color:"dark"===e.mode?e.accentColors.gray[400]:e.accentColors.gray[200],marginRight:8},primaryButton:{width:"100%",marginTop:32,background:"dark"===e.mode?e.accentColors.red[700]:e.accentColors.red[500],justifyContent:"center",fontWeight:p.Z.fontWeight.medium,color:mt.ZP.white},primaryButtonHovered:{background:"dark"===e.mode?(0,Qd._j)(e.accentColors.red[700],.3):(0,Qd._j)(e.accentColors.red[500],.3)},secondaryButton:{margin:"8px auto 0",justifyContent:"center",fontWeight:p.Z.fontWeight.medium,color:e.lightTextColor},checkboxCaption:{color:e.mediumTextColor,textAlign:"center",fontSize:12},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),f=(0,L.O7)(),x=(0,i.useCallback)((()=>{o({email:void 0,didError:!1}),d(!1),u(!1),t()}),[t]),S=(0,i.useCallback)((e=>{o({didError:!1,email:e.target.value})}),[]),b=(0,i.useCallback)((()=>d((e=>!e))),[]),M=(0,i.useCallback)((async()=>{const e=(0,Vd.H3)(a.email);if(!(0,Vd.oH)(e))return void o({...a,didError:!0});if(!s)return;u(!0);const t=await w.deleteSpaceForDomain(f,{requestingSpaceId:n,targetSpaceId:s.id,contactEmail:e});if("failed"===t.type)u(!1),v.showErrorMessage((0,Q.wf)($.default.getIntl(),t));else{const n=t.data.spaceDeletion;m(s.id,n),y.QFO(f,{contactEmail:e,currentOwners:s.admins.map((e=>e.id)),targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain,targetSubscriptionTier:s.subscriptionTier}),x(),i=s.name,sr.oV({label:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.toast",defaultMessage:"Successfully deleted “{spaceName}“",values:{spaceName:i}})})}var i}),[x,a,n,f,m,s]),j=Boolean(s);return(0,r.jsx)(Bo.Z,{open:j,innerStyle:h.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:x,render:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:h.closeIconContainer,children:(0,r.jsx)(Ze.Z,{isSmall:!0,onClick:x,ignoreLocalHoverState:!0,children:(0,Ud.D)(h.closeIcon)})}),(0,r.jsx)("div",{children:(0,er.y)(h.modalIcon)}),(0,r.jsxs)(It.Z,{style:h.title,children:[(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.title",defaultMessage:"Delete workspace"}),(0,r.jsx)(Kd.Z,{href:(0,yi.UY)("guides.domainManagement"),children:(0,r.jsx)(wn.Z,{icon:qo.m})})]}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:h.description,children:s?(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.byline",defaultMessage:"You’re about to permanently delete {currentWorkspaceName} and all of its contents. The workspace owner will be notified.",values:{currentWorkspaceName:s.name}}):void 0}),(0,r.jsxs)("div",{style:h.workspaceContainer,children:[s?(0,r.jsx)(Fd,{id:s.id,name:s.name,icon:s.icon,subscriptionTier:s.subscriptionTier,memberCount:s.memberCount}):void 0,(0,r.jsx)("div",{style:h.checkContainer,children:(0,zd.k)(h.check)})]}),(0,r.jsx)(bo.Z,{size:0,style:h.dividerContainer,innerStyle:h.divider}),(0,r.jsx)(Jd,{value:a.email,placeholder:$.default.formatMessage($d.emailPlaceholder),onChange:S,labelMessage:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.title",defaultMessage:"Contact email"}),helpMessage:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.deleteWorkspaces.deletionModal.tooltipExplanation",defaultMessage:"The Workspace Owner of the deleted workspace can contact this email for inquiries"}),errorMessage:a.didError?(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.contactEmail.error",defaultMessage:"Invalid email address"}):void 0}),(0,r.jsx)(Ze.Z,{disabled:!l||!a.email||c,disabledFeedback:!0,isLarge:!0,style:h.primaryButton,hoveredStyle:h.primaryButtonHovered,onClick:M,children:c?(0,r.jsx)(Ki.Z,{}):(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.deleteButton",defaultMessage:"Delete workspace"})}),(0,r.jsxs)("div",{style:h.checkboxContainer,children:[(0,r.jsx)(Tt.Z,{style:h.checkbox,size:14,checked:l,onClick:b}),(0,r.jsx)(It.Z,{isSmall:!0,style:h.checkboxCaption,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.checkboxLabel",defaultMessage:"I'm sure I want to delete this workspace"})})]}),(0,r.jsx)(Ze.Z,{style:h.secondaryButton,onClick:x,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.deleteWorkspaces.deletionModal.cancel",defaultMessage:"Cancel"})})]})})};function Jd(e){window.__c={n:"EmailInput"};const t=(0,lt.yK)((e=>({emailInputTitle:{fontWeight:p.Z.fontWeight.medium,fontSize:14,marginBottom:8,letterSpacing:-.15,display:"inline-flex",alignItems:"center"},emailContainer:{position:"relative",width:"100%",minHeight:56,marginTop:13},inputCaptionError:{color:e.errorText,marginTop:8,fontSize:13},helpIcon:{fill:e.lightIconColor,marginLeft:4,height:16,width:16}})),[]);return(0,r.jsxs)("div",{style:t.emailContainer,children:[(0,r.jsxs)(It.Z,{style:t.emailInputTitle,children:[e.labelMessage,e.helpMessage&&(0,r.jsx)(fe.Z,{renderTooltip:()=>e.helpMessage,render:e=>(0,r.jsx)("span",{...e,children:(0,qo.m)(t.helpIcon)})})]}),(0,r.jsx)(Ue.Z,{value:e.value,placeholder:e.placeholder,onChange:e.onChange}),e.errorMessage&&(0,r.jsx)(It.Z,{isSmall:!0,style:t.inputCaptionError,children:e.errorMessage})]})}const ec=e=>{let{onDismiss:t,onAccept:s,spaceQueued:i,descriptionMessage:n,divider:a,modalIcon:o,title:l,acceptMessage:d,isLoading:c}=e;window.__c={n:"ClaimableSpaceConfirmationModal"};const u=(0,lt.yK)((e=>({modalInnerStyle:{width:406,padding:"24px 20px 16px 20px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},closeIconContainer:{position:"absolute",top:10,right:10,backgroundColor:e.accentColors.gray[75],borderRadius:"50%",height:22,width:22,display:"flex",justifyContent:"center",alignItems:"center"},closeIcon:{width:14,height:14,fill:e.mediumTextColor},modalIcon:{height:24,width:24,fill:e.mediumIconColor},title:{fontWeight:p.Z.fontWeight.medium,fontSize:16,display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:9},description:{fontWeight:p.Z.fontWeight.regular,textAlign:"center",fontSize:13,lineHeight:"16px",letterSpacing:"-0.08px",marginTop:9},workspaceContainer:{position:"relative",borderRadius:6,border:`1px solid ${e.regularDividerColor}`,padding:"0 12px",boxSizing:"border-box",marginTop:30,width:"100%",height:60,justifyContent:"center",display:"flex",alignItems:"center"},checkContainer:{position:"absolute",right:12,display:"flex",alignItems:"center",justifyContent:"center",width:20,height:20},check:{fill:e.mediumIconColor,height:16,width:16},primaryButton:{width:"100%",marginTop:32,justifyContent:"center",fontWeight:p.Z.fontWeight.medium},secondaryButton:{margin:"8px auto 0",width:"100%",justifyContent:"center",fontWeight:p.Z.fontWeight.medium,color:e.lightTextColor},dividerContainer:{marginTop:18},divider:{borderBottomColor:e.regularDividerColor}})),[]),m=Boolean(i);return(0,r.jsx)(Bo.Z,{open:m,innerStyle:u.modalInnerStyle,preventHideChildrenWhileOpening:!0,onDismiss:t,render:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:u.closeIconContainer,children:(0,r.jsx)(Ze.Z,{isSmall:!0,onClick:t,ignoreLocalHoverState:!0,children:(0,Ud.D)(u.closeIcon)})}),o&&(0,r.jsx)("div",{children:o(u.modalIcon)}),(0,r.jsxs)(It.Z,{style:u.title,children:[l,(0,r.jsx)(Kd.Z,{href:(0,yi.UY)("guides.domainManagement"),children:(0,r.jsx)(wn.Z,{icon:qo.m})})]}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:u.description,children:n}),(0,r.jsxs)("div",{style:u.workspaceContainer,children:[i?(0,r.jsx)(Fd,{id:i.id,name:i.name,icon:i.icon,subscriptionTier:i.subscriptionTier,memberCount:i.memberCount}):void 0,(0,r.jsx)("div",{style:u.checkContainer,children:(0,zd.k)(u.check)})]}),a&&(0,r.jsx)(bo.Z,{size:0,style:u.dividerContainer,innerStyle:u.divider}),(0,r.jsx)(ce.Z,{isLarge:!0,style:u.primaryButton,onClick:s,disabled:c,children:c?(0,r.jsx)(Ki.Z,{}):d}),(0,r.jsx)(Ze.Z,{style:u.secondaryButton,onClick:t,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.claimableSpaceConfirmationModal.cancel",defaultMessage:"Cancel"})})]})})};const tc=e=>{let{onDismiss:t,spaceQueuedForRecovery:s,currentSpaceId:n}=e;window.__c={n:"SpaceRecoveryConfirmationModal"};const{setSpaceRequest:a}=(0,i.useContext)(Ho),o=(0,L.O7)(),[l,d]=(0,i.useState)(!1),c=(0,i.useCallback)((()=>{d(!1),t()}),[t]),u=(0,i.useCallback)((async()=>{if(!n||!s)return;d(!0);const e=await w.cancelSpaceDeletionForDomain(o,{requestingSpaceId:n,targetSpaceId:s.id});if("failed"===e.type)return d(!1),void v.showErrorMessage((0,Q.wf)($.default.getIntl(),e));var t;a(s.id,void 0),y.JvT(o,{targetSpaceId:s.id,verifiedDomain:s.creatorEmailDomain}),c(),t=s.name,sr.oV({label:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.table.recoverSpace.toast",defaultMessage:"Successfully recovered “{spaceName}“",values:{spaceName:t}})})}),[a,n,o,s,c]);return(0,r.jsx)(ec,{onDismiss:c,onAccept:u,spaceQueued:s,modalIcon:Jo.u,title:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.title",defaultMessage:"Recover workspace"}),descriptionMessage:s?(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.byline",defaultMessage:"Restore workspace content and the workspace owner's access.",values:{currentWorkspaceName:s.name}}):void 0,acceptMessage:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.recoverWorkspaces.confirmationModal.deleteButton",defaultMessage:"Recover"}),isLoading:l,divider:!1})};let sc=!1;function ic(e){let{spaceStore:t}=e;window.__c={n:"WorkspacesPage"};const{claimableSpaces:s,domainVerifications:n,loadingSpaces:a,errorClaimableSpaces:o,errorVerifications:l,navigateTo:d,removeClaimableSpace:c,loadMoreClaimableSpaces:u,tab:h,setSelectedTab:f,verifiedDomains:y}=(0,i.useContext)(Ho),x=(0,L.O7)(),S=(0,N.VK)((()=>!wd.Z.state.open&&Boolean(wd.Z.state.succeeded)),[]),[b,M]=(0,i.useState)(),[w,j]=(0,i.useState)(),[C,k]=(0,i.useState)(),[_,T]=(0,i.useState)(),I=(0,N.VK)((()=>Oi.Q6(Di.default.state.data)),[]);function P(){M(void 0),j(void 0),k(void 0),T(void 0)}(0,i.useEffect)((()=>{S&&b&&(c(b.id),M(void 0),wd.Z.reset())}),[S,b,c,M]);const Z=(0,lt.yK)((e=>({link:{fontSize:14,fontWeight:400,color:e.mediumTextColor,textDecoration:"none"},title:{marginTop:21,fontWeight:p.Z.fontWeight.semibold,fontSize:17},byline:{fontSize:14,fontWeight:p.Z.fontWeight.regular,color:e.mediumTextColor,marginRight:"auto",paddingRight:20},count:{marginLeft:4,opacity:.5,fontWeight:400},tabBarMenu:{margin:"12px 0 0",boxShadow:"none"}})),[]);if(o)return v.deprecatedShowErrorMessage(o.message),null;if(l)return v.deprecatedShowErrorMessage(l.message),null;const F=s.filter((e=>vd(e.spaceRequest,e.memberCount))),A=s.filter((e=>!vd(e.spaceRequest,e.memberCount))),D=[{id:"external-transfer",getIcon:e=>(0,Sd.Z)({...e,height:14,width:14}),name:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransfer",defaultMessage:"Require account change"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.externalTransferCaption",defaultMessage:"Owner will be prompted to change workspace ownership to a personal account."}),onAction:e=>j(e)},{id:"space-deletion",getIcon:e=>(0,er.y)({...e,height:14,width:14}),name:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace",defaultMessage:"Delete workspace"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpaceCaption",defaultMessage:"Owner will lose access to the workspace immediately."}),onAction:e=>k(e),getDisabledState:e=>{const{isEligible:t}=nc(n,e.creatorEmailDomain);return!t||e.isDelinquent||e.isPendingBilling||!(0,m.QM)(e.subscriptionTier)},getTooltip:e=>{const t=nc(n,e.creatorEmailDomain);return t.isEligible?!(0,m.QM)(e.subscriptionTier)||e.isDelinquent||e.isPendingBilling?(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for deletion."}):void 0:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.deleteSpace.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:(0,r.jsx)("br",{})}})}},{id:"recover-space",getIcon:()=>{},name:(0,r.jsx)(g.FormattedMessage,{id:"identityAndProvisioning.claimWorkspaces.actions.recoverSpace",defaultMessage:"Recover"}),caption:void 0,onAction:e=>T(e)}],B=[{id:"claim-and-upgrade",getIcon:e=>bd({...e,height:14,width:14}),name:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgrade",defaultMessage:"Claim and upgrade"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimAndUpgradeCaption",defaultMessage:"Take ownership of the workspace and upgrade it to an Enterprise plan"}),onAction:e=>M(e),getDisabledState:e=>{const{isEligible:t}=nc(n,e.creatorEmailDomain);return!t||e.isDelinquent||e.isPendingBilling},getTooltip:e=>{const t=nc(n,e.creatorEmailDomain);return e.isDelinquent||e.isPendingBilling?(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.claimSpace.ineligibleTooltip",defaultMessage:"The workspace is ineligible for claiming."}):t.isEligible?void 0:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.actions.disabledTooltip",defaultMessage:"You're in the 14-day notification period after verifying a domain.{br} This feature will be enabled in {numDays, plural, one {{numDays} day} other {{numDays} days}}.",values:{numDays:t.daysUntilEligible,br:(0,r.jsx)("br",{})}})}}];return(0,r.jsxs)(Ui.Z,{children:[(0,r.jsx)(wo.Z,{style:Z.link,onClick:()=>d(Uo),children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.breadcrumb",defaultMessage:"← Identity & Provisioning"})}),(0,r.jsx)(zt.Z,{large:!0,style:Z.title,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.title",defaultMessage:"Manage workspaces"})}),(0,r.jsxs)(jd.X2,{children:[(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:Z.byline,children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.byline",defaultMessage:"Claim verified-domain workspaces to your Enterprise plan or require Owners to use an external domain."})}),(0,r.jsx)(Wt.Z,{isLarge:!0,onClick:()=>{de.g({environment:x,data:{spaceId:t.id,emailDomains:y}})},children:(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.exportClaimableWorkspaces.button",defaultMessage:"Export to CSV"})})]}),(0,r.jsx)(Co.Z,{tabs:[(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.singleSpaces",defaultMessage:"Single-member"},"single"),(0,r.jsx)(g.FormattedMessage,{id:"identityProvisioningSettings.claimWorkspaces.multiSpaces",defaultMessage:"Multi-member"},"multi")],selectedIndex:h,onChange:e=>f(e),style:Z.tabBarMenu}),(0,r.jsx)(Gd,{onDismiss:P,spaceQueuedForTransfer:w,currentSpaceId:t.id}),h===Ko.Single?(0,r.jsx)(Od,{claimableSpaces:F,spaceActions:D,loadMoreClaimableSpaces:u,loading:a},"single"):(0,r.jsx)(Od,{claimableSpaces:A,spaceActions:B,loadMoreClaimableSpaces:u,loading:a},"multi"),I?(0,r.jsx)(qd,{onDismiss:P,spaceQueuedForClaiming:b,requestingSpaceId:t.id}):(0,r.jsx)(Yd,{onDismiss:P,spaceQueuedForClaiming:b}),(0,r.jsx)(Xd,{onDismiss:P,spaceQueuedForDeletion:C,currentSpaceId:t.id}),(0,r.jsx)(tc,{onDismiss:P,spaceQueuedForRecovery:_,currentSpaceId:t.id})]})}function nc(e,t){if(sc)return{isEligible:!0};const s=e.find((e=>{let{domain:s}=e;return t===s}));if(!s||!s.verified_at)return{isEligible:!0};const i=(Date.now()-s.verified_at)/Md.A0;return i>=14?{isEligible:!0}:{isEligible:!1,daysUntilEligible:Math.ceil(14-i)}}function ac(e){let{userStore:t,spaceStore:s,samlConfigStore:n,domainSettingsStore:a}=e;window.__c={n:"PageRouter"};const{page:o}=(0,i.useContext)(Ho);switch(o){case Uo:return(0,r.jsx)(yd,{userStore:t,spaceStore:s,samlConfigStore:n,domainSettingsStore:a});case Wo:return(0,r.jsx)(ic,{spaceStore:s});case zo:return(0,r.jsx)(Xr,{spaceStore:s,samlConfigStore:n})}}["local","development","staging"].includes("production")&&(0,xd.exposeDebugValue)("bypassDomainVerificationWaitingPeriod",(function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];sc=e}));const oc=function(e){let{userStore:t,spaceStore:s,samlConfigStore:i,domainSettingsStore:n}=e;return(0,r.jsx)(Go,{spaceStore:s,samlConfigStore:i,domainSettingsStore:n,children:(0,r.jsx)(ac,{userStore:t,spaceStore:s,samlConfigStore:i,domainSettingsStore:n})})};var rc=s(22756),lc=s(1800),dc=(s(40902),s(99036),s(41432),s(42613),s(45433),s(20302),s(89789),s(74446));s(6287),s(18844),s(70279),s(91644);s(58129),s(70921),s(30842),s(39050),s(54368),s(88179),s(80926),s(98963),s(7470),s(60014),s(13493),s(75908),s(6359),s(7678),s(73409),s(60897),s(33709),s(44312),s(4986),s(52719),s(58912),s(73387),s(36077),s(97715),s(32161),s(82447),s(9713),s(57398),s(49953),s(14710),s(9508),s(62643),s(57883),s(66726),s(30754),s(6946),s(25753),s(84683),s(38429),s(89488),s(65311),s(16427),s(61220),s(96683),s(70017),s(89470),s(49126),s(4137),s(80396),s(24836),s(86135),s(78929),s(84323),s(83200),s(67627),s(65963),s(14130),s(34406),s(42314),s(16663),s(19221),s(93646),s(63787),s(38952),s(40837),s(96740),s(63921),s(75990),s(57829),s(63188),s(56877),s(76413),s(47238),s(77858),s(37202),s(26195),s(60113),s(14718),s(14327),s(53412),s(65836),s(5505),s(66295),s(10354),s(19716),s(98897),s(46769),s(66079),s(58161),s(28182),s(35794),s(11045);s(38297),s(606);const cc=Aa.Ak.create();Aa.PF.create();Date.now();dc.mF.fromRecordMap(cc),dc.zF.fromRecordMap(cc);const uc=Fa.om.fromRecordMap(cc);Fa.s8.fromRecordMap(cc);var mc=s(41311),pc=s(30397),gc=s(33907),hc=s(91315),fc=s(91),yc=s(29551),vc=s(40235);const xc=function(){window.__c={n:"AsanaImportStepConfirmTab"};const e=(0,N.VK)((()=>rc.Z.state),[]);return e.result?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(It.Z,{isMultiline:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.confirm.subtitle",defaultMessage:"The following data has been successfully imported."})}),(0,r.jsx)("div",{style:{marginTop:32},children:e.result.map((e=>(0,r.jsx)(Sc,{importStatus:e},e.asanaTeamId)))})]}):(0,r.jsx)(r.Fragment,{})};function Sc(e){let{importStatus:t}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const s=(0,lt.Fg)(),[n,o]=(0,i.useState)(!1),l=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),d=(0,N.VK)((()=>rc.Z.state.teamsAndProjects),[]),c=(0,N.VK)((()=>I.default.state.currentSpaceViewStore),[]),u=(0,N.VK)((()=>{if(!c)return;const e=c.getTeamsStores().map((e=>({id:e.id,name:e.getName(),icon:(0,r.jsx)(Bn.p,{disabled:!0,store:e})})));return l?(e||[]).concat({id:c.id,name:"Private",icon:(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:18,height:18,borderRadius:"0.25em",backgroundColor:mt.FN.light.gray[75]},children:(0,a.Q)({color:s.mediumIconColor,width:12.5,height:12.5})})}):e}),[c,l,s]),{notionTeamspaceName:m,notionTeamspaceIcon:p}=(0,i.useMemo)((()=>{const e=null==u?void 0:u.find((e=>e.id===t.notionTeamSpaceId));return e?{notionTeamspaceName:e.name,notionTeamspaceIcon:e.icon}:{notionTeamspaceName:void 0,notionTeamspaceIcon:void 0}}),[u,t]),h=(0,i.useMemo)((()=>{const e=d.find((e=>e.gid===t.asanaTeamId));return null==e?void 0:e.name}),[d,t]);return(0,r.jsxs)(yc.gq,{style:{marginTop:16},children:[(0,r.jsx)(wn.Z,{ariaLabel:"collapse toggle",icon:fc.L,onClick:()=>o((e=>!e)),style:{transform:n?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:4},iconStyle:{width:8,height:8}}),(0,r.jsx)(vc.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,r.jsx)(yc.gq,{alignItems:"center",gap:2,children:(0,r.jsx)(It.Z,{isSmall:!0,style:{width:280,textOverflow:"ellipsis"},children:h})}),style:{width:300}},{key:"importedInto",header:(0,r.jsxs)(yc.gq,{gap:4,children:[(0,r.jsxs)(yc.gq,{style:{alignItems:"center",gap:4},children:[(0,r.jsx)(It.Z,{isSmall:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.importedInto",defaultMessage:"Imported into"})}),(0,gc.n)({width:12})]}),(0,r.jsxs)(yc.gq,{style:{alignItems:"center",gap:4},children:[p,m]})]}),style:{width:300}}],rows:function(e){let{collapsed:s}=e;return s?[]:t.numberOfTasksPerProject.map((e=>({key:e.projectId,columns:[(0,r.jsxs)(yc.gq,{gap:8,alignItems:"center",children:[(0,hc.r)({width:12,color:mt.FN.dark.green[600]}),(0,r.jsx)(It.Z,{isMultiline:!0,style:{wordWrap:"break-word",width:300},children:e.name})]},e.projectId),(0,r.jsxs)(It.Z,{isSmall:!0,children:[e.numberOfTasks,(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"})]},`${e.projectId}-tasks-count`)]})))}({collapsed:n})})]})}var bc=s(41892),Mc=s(53465),wc=s(64878);const jc=function(){var e;window.__c={n:"AsanaImportStepImportingDataFailedTab"};const t=(0,N.VK)((()=>rc.Z.state),[]),s=(0,lt.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},closeIconStyle:{width:16,height:16,fill:e.redBadgeBackground},lightText:{color:e.lightTextColor}})),[]);return(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,r.jsxs)(yc.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:[(0,r.jsx)("img",{style:{width:32,height:32,marginRight:8},src:bc.Z.images.import.asanaPng}),(0,wc.h)(s.iconStyle),(0,wc.h)(s.iconStyle),(0,wc.h)(s.iconStyle),(0,Mc.X)(s.closeIconStyle),(0,wc.h)(s.iconStyle),(0,wc.h)(s.iconStyle),(0,wc.h)(s.iconStyle),(0,r.jsx)("img",{style:{width:32,height:32,marginLeft:8},src:bc.Z.images.notionLogoPng})]}),(0,r.jsx)(It.Z,{style:s.lightText,children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importingData.failed.problemsOccured",defaultMessage:"Some problems occurred while importing data from your Asana workspace."})}),(0,r.jsx)(It.Z,{style:s.lightText,children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importingData.failed.viewLoggerPage",defaultMessage:"Please try again or read the {link} to troubleshoot.",values:{link:(0,r.jsx)("a",{style:{color:mt.ZP.black,cursor:"pointer"},href:`/${null===(e=t.loggerPageId)||void 0===e?void 0:e.replaceAll("-","")}`,children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importingData.failed.linkText",defaultMessage:"import logs"})})}})})]})};const Cc=function(e){window.__c={n:"LoaderWithDots"};const{dotCount:t=6,speed:s=800}=e,[n,a]=(0,i.useState)(1),o=(0,lt.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor,opacity:.5},iconStyleBold:{width:6,height:6,fill:e.lightIconColor}})),[]);return(0,i.useEffect)((()=>{const e=setInterval((()=>a((e=>e<t?e+1:1))),s);return()=>clearInterval(e)}),[t,s]),(0,r.jsx)(yc.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:Array.from({length:t},((e,t)=>t+1)).map((e=>(0,r.jsx)("div",{children:(0,wc.h)(n===e?o.iconStyleBold:o.iconStyle)},e)))})};const kc=function(){window.__c={n:"AsanaImportStepImportingDataTab"};const e=(0,lt.yK)((e=>({iconStyle:{width:6,height:6,fill:e.lightIconColor},iconStyleBold:{width:8,height:8,fill:e.mediumIconColor},lightText:{color:e.lightTextColor}})),[]);return(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,r.jsxs)(yc.gq,{style:{gap:8,marginTop:32,marginBottom:32,alignItems:"center"},children:[(0,r.jsx)("img",{style:{width:32,height:32,marginRight:8},src:bc.Z.images.import.asanaPng}),(0,r.jsx)(Cc,{}),(0,r.jsx)("img",{style:{width:32,height:32,marginLeft:8},src:bc.Z.images.notionLogoPng})]}),(0,r.jsx)(yc.gq,{children:(0,r.jsx)(It.Z,{style:e.lightText,children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importingData.feelFreeToLeave",defaultMessage:"Data is being imported. Feel free to leave this window."})})}),(0,r.jsx)(yc.gq,{children:(0,r.jsx)(It.Z,{style:e.lightText,children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importingData.sendEmail",defaultMessage:"We will send you an email when the import is complete or if any problems occur."})})})]})};var _c=s(36591),Tc=s(75071),Ic=s(35817),Pc=s(11066),Zc=s(93963);const Fc=function(){window.__c={n:"AsanaImportStepSelectDataTab"};const e=(0,L.O7)(),t=(0,g.useIntl)(),s=(0,N.VK)((()=>rc.Z.getState()),[]),{workspaces:n,selectedWorkspace:a,teamsAndProjects:o}=s;return(0,i.useEffect)((()=>{a&&mc.y2({selectedWorkspace:a,environment:e}).catch((()=>{}))}),[a,e]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(It.Z,{isSmall:!0,style:{paddingTop:4,paddingBottom:4},children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.workspaceChoiceHelperText",defaultMessage:"Only one workspace can be imported at a time."})}),(0,r.jsx)(Dc,{onSelectOption:e=>{rc.Z.setState({...s,selectedProjectsAndTeamspaces:{},selectedWorkspace:e})},options:n.map((e=>({key:e.gid,label:e.name}))),currentOption:s.selectedWorkspace,placeHolder:t.formatMessage({id:"asanaImporter.selectData.selectWorkspacePlaceholder",defaultMessage:"Select a workspace"})}),s.selectedWorkspace?(0,r.jsx)(It.Z,{style:{fontWeight:p.Z.fontWeight.semibold,marginTop:18},children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.selectProjects",defaultMessage:"Select projects"})}):(0,r.jsx)(r.Fragment,{}),s.isLoadingProjects?(0,r.jsxs)(yc.gq,{style:{gap:8,marginTop:32,alignItems:"center"},children:[(0,r.jsx)(Ki.Z,{style:{fontSize:12}}),(0,r.jsx)(It.Z,{isSmall:!0,style:{color:mt.FN.light.gray[400]},children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingProjectsHelperText",defaultMessage:"Loading projects in the workspace..."})})]}):o.filter((e=>0!==e.projects.length)).map((e=>(0,r.jsx)(Ac,{team:e,selectedWorkspace:a},`${e.gid}-table`)))]})};function Ac(e){var t;let{team:s,selectedWorkspace:n}=e;window.__c={n:"CollapsibleAsanaProjectsTable"};const o=(0,L.O7)(),l=(0,g.useIntl)(),d=(0,lt.Fg)(),[c,u]=(0,i.useState)(!1),[m,h]=(0,i.useState)(!1),[f,y]=(0,i.useState)(),v=(0,N.VK)((()=>rc.Z.getState()),[]),x=(0,N.VK)((()=>I.default.state.currentSpaceViewStore),[]),S=(0,N.VK)((()=>{const e=null==x?void 0:x.getTeamsStores();return null==e?void 0:e.map((e=>({id:e.id,name:e.getName(),icon:(0,r.jsx)(Bn.p,{disabled:!0,store:e})})))}),[x]);(0,i.useEffect)((()=>{if(!S||!x)return;if(!v.selectedProjectsAndTeamspaces[s.gid]){y("private"),mc.B3({teamId:s.gid,spaceId:null==x?void 0:x.id});for(const i of S){var e,t;if((null===(e=i.name)||void 0===e?void 0:e.toLowerCase())===(null===(t=s.name)||void 0===t?void 0:t.toLowerCase())){y(i.id),mc.B3({teamId:s.gid,spaceId:i.id});break}}}}),[S,s,x,v.selectedProjectsAndTeamspaces]);const b=(0,i.useCallback)((e=>{mc.B3({teamId:s.gid,spaceId:e}),y(e)}),[s.gid]),M=(0,i.useCallback)((e=>{if("create"===e)return void Ic.lo("asana_importer",{onClose:b});let t;if("private"===e){if(null==x||!x.id)return;t=x.id}else t=e;mc.B3({teamId:s.gid,spaceId:t}),y(e)}),[null==x?void 0:x.id,s.gid,b]),{importCompletedTasks:j}=v,C=[{key:"private",searchTerm:"private",label:(0,r.jsxs)(yc.gq,{alignItems:"center",style:{gap:8},children:[(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:16,height:16,borderRadius:"0.25em",backgroundColor:mt.FN.light.gray[75]},children:(0,a.Q)({color:d.mediumIconColor,width:12.5,height:12.5})}),(0,r.jsx)(It.Z,{style:{fontWeight:p.Z.fontWeight.regular},children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.privateSpaceTitle",defaultMessage:"Private"})})]})}];return S&&C.push(...S.map((e=>({key:e.id,searchTerm:e.name,label:(0,r.jsxs)(yc.gq,{alignItems:"center",style:{gap:8},children:[e.icon,e.name]})})))),C.push({key:"create",searchTerm:"New teamspace",label:(0,r.jsxs)(yc.gq,{alignItems:"center",style:{gap:4},children:[(0,Tc.f)({color:d.mediumIconColor,width:16,height:16}),(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.newTeamspace",defaultMessage:"New teamspace"})})]})}),(0,r.jsxs)(yc.gq,{style:{marginLeft:-18},children:[(0,r.jsx)(wn.Z,{ariaLabel:"collapse toggle",icon:fc.L,onClick:()=>u((e=>!e)),style:{transform:c?"rotate(90deg)":"rotate(180deg)",marginRight:8,marginTop:24,width:10,height:10},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},iconStyle:{width:10,height:10}}),(0,r.jsx)(vc.Z,{tableStyle:{borderTop:0},cellStyle:{verticalAlign:"middle"},columns:[{key:"team",header:(0,r.jsxs)(yc.gq,{alignItems:"center",gap:2,children:[(0,r.jsx)(Bc,{onSelectOption:e=>{var t;rc.Z.setState({...v,selectedProjectsAndTeamspaces:{...v.selectedProjectsAndTeamspaces,[s.gid]:{notionTeamspaceId:null===(t=v.selectedProjectsAndTeamspaces[s.gid])||void 0===t?void 0:t.notionTeamspaceId,projects:e}}})},options:[{key:"in_complete",label:"Exclude completed projects"},{key:"all",label:"Select all projects"}],currentOption:(e=>{const t=null===(e=v.selectedProjectsAndTeamspaces[s.gid])||void 0===e?void 0:e.projects;return"string"==typeof t?t:null!=t&&t.length?"specific":void 0})()}),(0,r.jsx)(It.Z,{style:{width:280,textOverflow:"ellipsis"},children:s.name})]}),style:{width:300}},{key:"importInto",header:(0,r.jsxs)(yc.gq,{style:{alignItems:"center"},children:[(0,r.jsx)("div",{children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.importInto",defaultMessage:"Import into"})}),(0,r.jsx)("div",{style:{marginRight:16,marginLeft:8},children:(0,gc.n)({width:12})}),(0,r.jsxs)(yc.gq,{style:{alignItems:"center",gap:8},children:[(0,r.jsx)("img",{src:bc.Z.emails.notionLogoBlackSmallPng,height:18}),(0,r.jsx)(Dc,{options:C,onSelectOption:M,currentOption:null===(t=C.find((e=>e.key===f)))||void 0===t?void 0:t.key,narrow:!0,allowSearch:!0,placeHolder:l.formatMessage({id:"asanaImport.importsTab.selectData.selectATeamspace",defaultMessage:"Select a teamspace"})})]})]}),style:{width:"50%"}}],rows:function(e){let{collapsed:t}=e;if(t)return[];const i=s.projects.map((e=>({key:e.gid,columns:[(0,r.jsxs)(yc.gq,{alignItems:"center",gap:6,style:{marginLeft:20},children:[(0,r.jsx)(Tt.Z,{style:{marginRight:2},onClick:()=>{const t={...v.selectedProjectsAndTeamspaces[s.gid]||{projects:[],notionTeamspaceId:void 0}},{notionTeamspaceId:i,projects:n}=t;let a;a="all"===n||"in_complete"===n?[]:n.includes(e.gid)?n.filter((t=>t!==e.gid)):n.concat(e.gid),rc.Z.setState({...v,selectedProjectsAndTeamspaces:{...v.selectedProjectsAndTeamspaces,[s.gid]:{notionTeamspaceId:i,projects:a}}})},checked:(()=>{const t={...v.selectedProjectsAndTeamspaces[s.gid]||{projects:[],notionTeamspaceId:void 0}};return"all"===t.projects||"in_complete"===t.projects&&!1===e.completed||t.projects.includes(e.gid)})(),size:14,checkSize:8}),(0,r.jsx)(Zc.z,{color:e.color,size:6}),(0,r.jsx)("div",{style:{width:240,wordWrap:"break-word"},children:e.completed?(0,r.jsxs)(It.Z,{isMultiline:!0,style:{color:d.lightTextColor},children:[e.name,(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.completedHelperText",defaultMessage:" (Completed)"})]}):(0,r.jsx)(It.Z,{isMultiline:!0,children:e.name})})]},`${e.gid}-container`),(0,r.jsxs)(It.Z,{isSmall:!0,children:[j?e.task_counts.num_tasks:e.task_counts.num_incomplete_tasks,(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.tasksHelperText",defaultMessage:" tasks"})]},`${s.gid}-tasks-count`)]})));return s.nextPage&&i.push({key:"loadMore",columns:[(0,r.jsx)(Pc.Z,{disabled:m,style:{marginLeft:20,color:mt.FN.light.gray[400]},hoveredStyle:{background:"transparent"},pressedStyle:{background:"transparent"},onClick:async()=>{if(!n)return;h(!0);const e=await w.getTeamsAndProjectsInAsanaWorkspace(o,{workspaceId:n,teamId:s.gid,size:5,nextPage:s.nextPage}),{teamsAndProjects:t}={...v},i=t.find((e=>e.gid===s.gid));if(i){if("success"===e.type){const n=e.data.find((e=>e.gid===s.gid));if(!n)return;i.projects.push(...n.projects),i.nextPage=n.nextPage,rc.Z.setState({...v,teamsAndProjects:t,loadMoreClicks:v.loadMoreClicks+1})}h(!1)}},children:m?(0,r.jsxs)(yc.gq,{alignItems:"center",gap:8,children:[(0,r.jsx)(Ki.Z,{style:{fontSize:12}}),(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadingMoreProjects",defaultMessage:"Loading more projects..."})]}):(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.loadMoreProjects",defaultMessage:"Load more projects..."})},`${s.gid}-loadmore`)]}),i}({collapsed:c})})]})}function Dc(e){var t;window.__c={n:"Dropdown"};const{onSelectOption:s,options:n,currentOption:a,placeHolder:o,narrow:l,allowSearch:d}=e,c=(0,g.useIntl)(),[u,m]=(0,i.useState)(""),h=null===(t=n.find((e=>{let{key:t}=e;return t===a})))||void 0===t?void 0:t.label,f=(0,lt.yK)((e=>({icon:{width:12,height:12,marginLeft:4,fill:e.lightIconColor}})),[]);return(0,r.jsx)(Mn.ZP,{popupType:Mn.Z4.Popup,placementToOrigin:Mn.pO.Bottom,renderOrigin:e=>(0,r.jsxs)(Ze.Z,{...e,style:{paddingTop:l?2:8,paddingBottom:l?2:8,paddingLeft:8,paddingRight:8,opacity:1,width:250,border:`1px solid ${mt.FN.light.gray[100]}`,justifyContent:"space-between",marginTop:8,marginBottom:8,background:a?void 0:mt.FN.light.gray[50],color:a?void 0:mt.FN.light.gray[300]},disabled:!1,children:[(0,r.jsx)(It.Z,{style:{textOverflow:"ellipsis"},children:h||o}),(0,fa.i)(f.icon)]}),render:e=>{const t={menuType:ye.og.Popup,width:250,left:50},i=[{key:"asanaImport.dropdown.menuList",render:e=>(0,r.jsx)(he.Z,{...e}),items:(u.trim()?n.filter((e=>{var t;return null===(t=e.searchTerm)||void 0===t?void 0:t.toLowerCase().includes(u.toLowerCase())})):n).map((t=>{let{key:i,label:n}=t;return{key:i,action:()=>{s(i),e.close()},render:e=>(0,r.jsx)(ue.Z,{...e,title:n,shouldWrapCaption:!0,right:h===n?(0,r.jsx)("div",{style:{width:14},children:(0,_c.e)()}):void 0})}}))}];return(0,r.jsxs)(r.Fragment,{children:[d?(0,r.jsx)("input",{style:{width:"100%",borderRadius:0,backgroundColor:mt.FN.light.gray[200],paddingTop:2,paddingBottom:2,paddingLeft:8,paddingRight:8,opacity:1,border:`1px solid ${mt.FN.light.gray[100]}`,justifyContent:"space-between",background:mt.FN.light.gray[50],fontSize:p.Z.fontSize.UIRegular.desktop,textOverflow:"ellipses"},placeholder:c.formatMessage({id:"asanaImport.importsTab.selectData.searchTeamspacePlaceholder",defaultMessage:"Search for a teamspace"}),onChange:e=>m(e.target.value),value:u}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)(me.Z,{...t,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,sections:i,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})]})}})}function Bc(e){var t;window.__c={n:"CheckboxDropdown"};const{onSelectOption:s,options:n,currentOption:a}=e,o=null===(t=n.find((e=>{let{key:t}=e;return t===a})))||void 0===t?void 0:t.label,l=(0,i.useMemo)((()=>void 0!==a&&"specific"!==a&&("all"===a||"partial")),[a]);return(0,r.jsx)(Mn.ZP,{popupType:Mn.Z4.Popup,placementToOrigin:Mn.pO.Bottom,alignmentToOrigin:Mn.vR.Start,renderOrigin:e=>(0,r.jsx)(Ze.Z,{...e,style:{padding:0,margin:0,marginRight:4,height:14},hoveredStyle:{},children:(0,r.jsx)(Tt.Z,{checked:l,disabled:!0,size:14,checkSize:8})}),render:e=>{const t={menuType:ye.og.Popup,width:250,left:50},i=[{key:"asanaImport.checkboxDropdown.menuList",render:e=>(0,r.jsx)(he.Z,{...e}),items:n.map((t=>{let{key:i,label:n}=t;return{key:i,action:()=>{s(i),e.close()},render:e=>(0,r.jsx)(ue.Z,{...e,title:n,shouldWrapCaption:!0,right:o===n?(0,r.jsx)("div",{style:{width:14},children:(0,_c.e)()}):void 0})}}))}];return(0,r.jsx)(me.Z,{...t,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,sections:i,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}function Rc(e){switch(e){case"selectData":return(0,r.jsx)(It.Z,{style:{fontWeight:p.Z.fontWeight.semibold},children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.importsTab.selectData.tabTitle",defaultMessage:"Select Asana workspace"})});default:return(0,r.jsx)(r.Fragment,{})}}const Lc=function(e){let{tab:t,fetchActiveImportTasks:s}=e;window.__c={n:"AsanaImportStepTab"};const n=(0,L.O7)(),a=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),o=(0,N.VK)((()=>I.default.state.currentSpaceViewStore),[]),l=(0,N.VK)((()=>pc.Z.state.teams),[]),d=(0,N.VK)((()=>rc.Z.state),[]),u=(0,N.VK)((()=>vi.Z.state),[]).flowId||(0,c.ZP)(),{workspaces:m}=d,h=(0,i.useCallback)((()=>Object.values(d.selectedProjectsAndTeamspaces).some((e=>0!==e.projects.length))),[d.selectedProjectsAndTeamspaces]),f=(0,lt.yK)((e=>({closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return(0,r.jsxs)(Ui.Z,{controlRow:(e=>"selectData"===e?(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,r.jsx)(Wt.Z,{style:{border:0},disabled:!m.length,onClick:()=>{s(),rc.Z.resetImport()},children:(0,r.jsx)(g.FormattedMessage,{id:"asanaImport.selectData.backButtonText",defaultMessage:"Back"})}),(0,r.jsxs)(yc.gq,{alignItems:"center",gap:8,children:[d.selectedWorkspace?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Rr.Z,{on:d.importCompletedTasks,onClick:()=>rc.Z.setState({...d,importCompletedTasks:!d.importCompletedTasks})}),(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"importsTab.selectData.importCompletedTasks",defaultMessage:"Import completed tasks"})})]}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)(ce.Z,{style:{marginLeft:16},disabled:!h()||d.templateCreationInProgress,onClick:()=>{a&&o&&mc.T_({environment:n,currentSpaceViewStore:o,spaceStore:a,teamsStores:l,flowId:u}).catch((()=>{}))},children:d.templateCreationInProgress?(0,r.jsxs)(yc.gq,{alignItems:"center",gap:2,children:[(0,r.jsx)(Ki.Z,{isWhite:!0}),(0,r.jsx)(g.FormattedMessage,{id:"importsTab.selectData.creatingTemplates",defaultMessage:"Creating templates"})]}):(0,r.jsx)(g.FormattedMessage,{id:"importsTab.selectData.nextButtonText",defaultMessage:"Next"})})]})]}):"importingData"===e?(0,r.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,r.jsx)(Wt.Z,{disabled:!m.length,onClick:()=>{s(),rc.Z.resetImport()},children:(0,r.jsx)(g.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):"confirm"===e?(0,r.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,r.jsx)(ce.Z,{onClick:()=>{d.loggerPageId&&S.navigate({url:(0,lc.Z)({pageId:d.loggerPageId,pageModel:uc({table:ds.iU,id:d.loggerPageId}),baseUrl:Kt.default.domainBaseUrl,pageVisitSource:mn.tY.Import}),environment:n}),rc.Z.resetImport(),Ai.Z.reset()},children:(0,r.jsx)(g.FormattedMessage,{id:"importsTab.confirm.doneText",defaultMessage:"Done"})})}):"failure"===e?(0,r.jsx)("div",{style:{display:"flex",justifyContent:"right"},children:(0,r.jsx)(Wt.Z,{disabled:!m.length,onClick:()=>{s(),rc.Z.resetImport()},children:(0,r.jsx)(g.FormattedMessage,{id:"importsTab.importingData.closeButtonText",defaultMessage:"Close"})})}):void 0)(t),controlRowPaddingTopBottom:20,children:[(0,r.jsx)("div",{style:{position:"absolute",top:12,right:12},children:(0,r.jsx)(Pc.Z,{onClick:()=>{s(),rc.Z.resetImport()},style:f.closeButton,hoveredStyle:f.closeButtonHover,children:(0,Ud.D)(f.closeButtonIcon)})}),(0,r.jsx)(It.Z,{style:{paddingBottom:8,fontSize:18,fontWeight:p.Z.fontWeight.medium,width:"100%"},children:Rc(t)}),(e=>"selectData"===e?(0,r.jsx)(Fc,{}):"importingData"===e?(0,r.jsx)(kc,{}):"confirm"===e?(0,r.jsx)(xc,{}):"failure"===e?(0,r.jsx)(jc,{}):void 0)(t)]})};const Nc=function(e){let{fetchActiveImportTasks:t}=e;window.__c={n:"AsanaImportModal"};const s=(0,N.VK)((()=>rc.Z.state),[]);return(0,r.jsx)(Bo.Z,{open:s.isModalOpen,innerStyle:{width:800,height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:675},render:()=>(0,r.jsx)(Ao.Z,{capture:!0,allowEsc:!0,render:()=>(0,r.jsx)(Do.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>(()=>{const{currentTab:e}=s;return(0,r.jsx)(Lc,{fetchActiveImportTasks:t,tab:e})})()})}),onDismiss:()=>{rc.Z.resetImport()}})};var Ec=s(69507);const Oc=function(e){window.__c={n:"ImportsTab"};const t=(0,N.VK)((()=>I.default.state),[]),s=(0,N.VK)((()=>rc.Z.state),[]),{currentSpaceStore:n,mainEditorCurrentBlockStore:a,currentSpaceViewStore:o,currentUserSettingsStore:l}=t,c=(0,L.O7)(),{device:u}=(0,L.O7)(),[m,p]=(0,i.useState)([]),h=(0,i.useCallback)((async()=>{if(null==n||!n.id)return;const e=await w.getActiveImportTasks(c,{spaceId:n.id});"success"===e.type&&p(e.data)}),[n,c]);return(0,i.useEffect)((()=>{h().catch((()=>{}));const e=setInterval(h,6e4);return()=>clearInterval(e)}),[n,c,h]),(0,i.useEffect)((()=>{let e;const t=async s=>{const n=await w.getAsanaWorkspacesNames(c,{});if(s+=1,"success"===n.type)if(null!=n&&n.data.account)rc.Z.setState({...rc.Z.state,account:n.data.account,workspaces:n.data.workspaces,isLoadingAsanaWorkspaces:!1,isAccountLinkingInProgress:!1,currentTab:"selectData",isModalOpen:!0});else{if(s>i)return;e=setTimeout((()=>t(s)),2e3)}},i=180;if(s.isAccountLinkingInProgress){t(0).catch((()=>{}))}return()=>{clearTimeout(e)}}),[s.isAccountLinkingInProgress,c]),n&&o&&o&&l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(zt.Z,{large:!u.isMobile||void 0,divider:u.isMobile?void 0:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"importsTab.title",defaultMessage:"Import data"})}),(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"importsTab.subtitle",defaultMessage:"Import data from other apps and files into Notion"})}),(0,r.jsx)(It.Z,{isSmall:!0,children:e.genericImporterEnabled?(0,r.jsx)(g.FormattedMessage,{id:"importsTab.unsupportedImportsHelperTextForUniversalImport",defaultMessage:"If the app you’re using isn’t listed below, try the <boldtext>Universal import</boldtext> ",values:{boldtext:e=>(0,r.jsx)("span",{style:{fontWeight:600},children:e})}}):(0,r.jsx)(g.FormattedMessage,{id:"importsTab.unsupportedImportsHelperText",defaultMessage:"If your data is located somewhere we don't support yet, you can try importing it via CSV file."})}),(0,r.jsxs)("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gridAutoRows:"1fr",gap:"4px 16px",width:"100%"},children:[(0,r.jsx)(Ec.Z,{pageStore:a,spaceStore:n,spaceViewStore:o,userSettingsStore:l,analyticsFrom:"modal",onComplete:e=>{S.navigateToBlock({environment:c,store:e,pageVisitSource:mn.tY.Import}),Ai.Z.reset()},readOnlyCreditButton:!1,isLoadingNewConnections:s.isFetchingAsanaAccount}),(0,r.jsx)(Nc,{fetchActiveImportTasks:h})]}),(0,r.jsxs)("div",{style:{marginTop:32},children:[(0,r.jsx)(It.Z,{isMultiline:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"importsTab.activeImports.title",defaultMessage:"Active Imports"})}),(0,r.jsx)(vc.Z,{tableStyle:{borderTop:0},columns:[{key:"importTime",header:(0,r.jsx)(g.FormattedMessage,{id:"importsTab.activeImports.importTime",defaultMessage:"Import time"})},{key:"importFrom",header:(0,r.jsx)(g.FormattedMessage,{id:"importsTab.activeImports.importFrom",defaultMessage:"Import from"})},{key:"importStatus",header:(0,r.jsx)(g.FormattedMessage,{id:"importsTab.activeImports.importStatus",defaultMessage:"Status"})}],rows:m.map((e=>({key:`table-${e.taskId}`,columns:[e.startedAt?`${(0,pt.Yx)(e.startedAt,"long",$.default.getIntl().locale)} ${(0,pt.Yx)(e.startedAt,"time",$.default.getIntl().locale)}`:"",(0,d.fl)(e.source),(0,r.jsx)(ca.Z,{isRound:!0,showRemoveButton:!1,value:(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"activeImports.status.inProgress",defaultMessage:"In progress"})}),backgroundColor:mt.FN.light.blue[200],showColoredDot:"blue",format:aa.l.Small,isSingle:!0},`progress-${e.taskId}`)]})))}),m.length?(0,r.jsx)(r.Fragment,{}):(0,r.jsx)(It.Z,{isSmall:!0,style:{marginTop:16},children:(0,r.jsx)(g.FormattedMessage,{id:"importsTab.activeImportsTable.noActiveImports",defaultMessage:"There are no ongoing imports associated with your account."})})]})]}):(0,r.jsx)(r.Fragment,{})};var Vc=s(79092),Uc=s(54153),Wc=s(84908),zc=s(11646),Kc=s(57222),Hc=s(65680),Gc=s(31194);class qc extends n.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:vn.Z},this.handleSelectChange=e=>{const{label:t}=this.getItemLabelAndCaption(e);if(this.props.confirm){const s=()=>{this.props.onChange(e)};v.showDialog({showCancel:!0,keepFocus:!1,message:(0,r.jsx)(g.FormattedMessage,{id:"languagePicker.changeLanguage.confirmationMessage",defaultMessage:"Are you sure you want to update the language to {language}?",values:{language:t}}),items:[{label:(0,r.jsx)(g.FormattedMessage,{id:"languagePicker.changeLanguage.updateButton.label",defaultMessage:"Update"}),color:"red",onAccept:s}]})}else this.props.onChange(e)}}renderComponent(){const{device:e}=this.environment;if(e.isMobile)return;const t="ja-JP"===this.props.currentLocale&&Zt.default.checkGate("japan_full_launch");return(0,r.jsx)(Mn.ZP,{popupType:Mn.Z4.Popup,buttonPopupStore:this.stores.buttonPopupStore,renderOrigin:e=>(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(Ze.Z,{style:{marginLeft:-8,paddingLeft:8,paddingRight:8},...e,children:[this.props.pickerLabel?this.props.pickerLabel:this.getItemLabelAndCaption(this.props.currentLocale).label,(0,Hc.ay)(this.props.currentLocale)&&!t&&(0,r.jsx)(st.Z,{desktopStyle:{marginLeft:4},children:(0,r.jsx)(g.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"})}),(0,fa.i)({width:10,marginLeft:4,fill:this.theme.lightIconColor})]})}),placementToOrigin:Gc.Iw.Bottom,alignmentToOrigin:Gc.lU.Start,render:e=>{let t;t=Zt.default.checkGate("polyglot")?[...Hc.tp,...Hc.is]:[...Hc.tp];const s=[{key:"languages",render:e=>(0,r.jsx)(he.Z,{...e,topBorder:0!==e.index}),items:t.map((t=>({key:t,render:e=>this.getItem(t,e.focused,e),action:()=>{this.handleSelect(t),e.close()}})))}],i={menuType:ye.og.Popup,width:240};return(0,r.jsx)(me.Z,{className:gi.hKO,...i,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:s})})}})}renderItem(e){const t="ja-JP"===e.locale&&Zt.default.checkGate("japan_full_launch");return(0,r.jsx)(ue.Z,{...e.props,title:(0,r.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,r.jsx)("div",{style:{...e.style,marginRight:0},children:e.label})}),caption:e.caption&&(0,r.jsx)("span",{style:{color:this.theme.mediumTextColor},children:e.caption}),shouldWrapCaption:!0,right:(0,Hc.ay)(e.locale)&&!t&&(0,r.jsx)(st.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"languagePicker.betaBadge",defaultMessage:"Beta"})})})}handleSelect(e){this.props.currentLocale!==e&&this.handleSelectChange(e)}getItemLabelAndCaption(e){return(0,Kc.t)(this.props.intl)[e]}getItem(e,t,s){return this.renderItem({...this.getItemLabelAndCaption(e),focused:t,props:s,locale:e})}}qc.displayName="LanguagePicker";const Yc=(0,g.injectIntl)(qc);class Qc extends n.Z{renderComponent(){return(0,r.jsx)("div",{style:this.getSettingsOptionStyle(),children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"},children:[(0,r.jsxs)("div",{style:{flex:1},children:[(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"languageRegionSettings.language.label",defaultMessage:"Language"})}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"},children:(0,r.jsx)(g.FormattedMessage,{id:"languageSettings.languageSwitcher.subtitle",defaultMessage:"Change the language used in the user interface."})})]}),(0,r.jsx)(Yc,{confirm:!0,onChange:async e=>{y.A01(this.environment,{locale:e});const t=await w.setLocale(this.environment,{locale:e});"success"===t.type?(Uc.Z.set("preferredLocale",e),await zc.transactionQueue.drain(),this.environment.device.isElectron?Wc.refreshAll({includeFocusedWindow:!0}):window.location.reload(!0)):v.showError(t)},currentLocale:this.props.locale})]})})}getSettingsOptionStyle(){const{device:e,WindowSizeStore:t}=this.environment;return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto",paddingLeft:e.isMobile?t.state.paddingLeftCSS:0,paddingRight:e.isMobile?t.state.paddingRightCSS:0}}}Qc.displayName="LanguageSettings";const $c=Qc;var Xc=s(32056);function Jc(e){var t;return(null==e||null===(t=e.getSettingsStore())||void 0===t||null===(t=t.getKeyStore("regional_format_settings"))||void 0===t?void 0:t.getKeyStore("region").getValue())||"US"}function eu(e,t){var s;const i=null==e||null===(s=e.getKeyStore("settings"))||void 0===s||null===(s=s.getKeyStore("regional_format_settings"))||void 0===s?void 0:s.getValue();return"full_date"===t?null!=i&&i.use_default_region_settings?tu(Jc(e)):(null==i?void 0:i.full_date)||tu(Jc(e)):"short_date"===t?null!=i&&i.use_default_region_settings?{type:"short"}:(null==i?void 0:i.short_date)||{type:"short"}:"number"===t?null!=i&&i.use_default_region_settings?"number":(null==i?void 0:i.number)||"number":"week_start_on"===t?null!=i&&i.use_default_region_settings?"sunday":(null==i?void 0:i.week_start_on)||"sunday":(0,_.t1)(t)}function tu(e){return"JP"===e?{type:"short"}:{type:"long"}}const su={full_date:(0,g.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,g.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,g.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,g.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})},iu=(0,g.defineMessages)({full_date:{defaultMessage:"Full date",id:"regionalFormatSettings.defaultSetting.fullDate"},short_date:{defaultMessage:"Short date",id:"regionalFormatSettings.defaultSetting.shortDate"},number:{defaultMessage:"Numbers",id:"regionalFormatSettings.defaultSetting.numbers"},week_start_on:{defaultMessage:"Week starts",id:"regionalFormatSettings.defaultSetting.weekStart"}});function nu(e,t){if("full_date"===t){return su[t][eu(e,t).type]}if("short_date"===t){return su[t][eu(e,t).type]}if("number"===t){return su[t][eu(e,t)]}if("week_start_on"===t){return su[t][eu(e,t)]}return(0,_.t1)(t)}function au(e,t){return(0,Xc.uf)(1234567,e,t)}const ou=(0,g.defineMessages)({sunday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.sunday",defaultMessage:"Sunday"},monday:{id:"regionalFormatSettings.defaultRegionalSettings.startDayOfWeek.monday",defaultMessage:"Monday"}});function ru(e,t){const s=e.type;return"short"===s||"long"===s||"medium"===s?(0,pt.Yx)(Date.now(),s,(0,Zr.E2)(t)):"iso"===s?(0,pt.$6)(Date.now()):(0,pt.Yx)(Date.now(),"long",(0,Zr.E2)(t))}function lu(e,t){const s=e.type;return"iso"===s?(0,pt.$6)(Date.now()):"short"===s?(0,pt.Yx)(Date.now(),s,(0,Zr.E2)(t)):(0,pt.Yx)(Date.now(),"short",(0,Zr.E2)(t))}var du=s(68894),cu=s(42782);const uu={full_date:(0,g.defineMessages)({full:{defaultMessage:"Full date",id:"regionalFormatSettings.customSettingOption.fullDate.full"},long:{defaultMessage:"Long",id:"regionalFormatSettings.customSettingOption.fullDate.long"},medium:{defaultMessage:"Medium",id:"regionalFormatSettings.customSettingOption.fullDate.medium"},short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.fullDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.fullDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.fullDate.custom"}}),short_date:(0,g.defineMessages)({short:{defaultMessage:"Short",id:"regionalFormatSettings.customSettingOption.shortDate.short"},iso:{defaultMessage:"ISO",id:"regionalFormatSettings.customSettingOption.shortDate.iso"},custom:{defaultMessage:"Custom",id:"regionalFormatSettings.customSettingOption.shortDate.custom"}}),number:(0,g.defineMessages)({number:{defaultMessage:"Number",id:"regionalFormatSettings.customSettingOption.number.number"},number_with_commas:{defaultMessage:"Number with commas",id:"regionalFormatSettings.customSettingOption.number.withCommas"},percent:{defaultMessage:"Percent",id:"regionalFormatSettings.customSettingOption.number.percent"}}),week_start_on:(0,g.defineMessages)({sunday:{defaultMessage:"Sunday",id:"regionalFormatSettings.customSettingOption.weekStartOn.sunday"},monday:{defaultMessage:"Monday",id:"regionalFormatSettings.customSettingOption.weekStartOn.monday"}})};function mu(e){window.__c={n:"CustomRegionalFormatSettingPicker"};const[,,t]=(0,N.AF)(void 0,vn.Z),s=(0,lt.Fg)(),[i,n]=(0,N.VK)((()=>[e.userSettingsStore.isDefined(),nu(e.userSettingsStore,e.option)]),[e.option,e.userSettingsStore]);return i?(0,r.jsx)(Mn.ZP,{popupType:Mn.Z4.Popup,buttonPopupStore:t,renderOrigin:e=>(0,r.jsxs)(Ze.Z,{...e,children:[$.default.formatMessage(n),(0,fa.i)({width:10,marginLeft:4,fill:s.lightIconColor})]}),placementToOrigin:Gc.Iw.Bottom,alignmentToOrigin:Gc.lU.Start,render:t=>"week_start_on"===e.option||"number"===e.option?(0,r.jsx)(pu,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):"full_date"===e.option||"short_date"===e.option?(0,r.jsx)(gu,{userSettingsStore:e.userSettingsStore,option:e.option,onAccept:()=>{t.close()}}):(0,_.t1)(e.option)}):(0,r.jsx)(Ki.Z,{})}function pu(e){window.__c={n:"SimpleFormatPicker"};const t=(0,L.O7)(),s=(0,g.useIntl)();return(0,r.jsx)(me.Z,{menuType:ye.og.Popup,width:216,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>(0,r.jsx)(he.Z,{...e,topBorder:0!==e.index}),items:(0,_.Yd)(uu[e.option]).map((i=>({key:i,render:t=>{const n="number"===e.option?au(i,s):void 0;return(0,r.jsx)(ue.Z,{...t,title:$.default.formatMessage(uu[e.option][i]),caption:n})},action:()=>{B.createAndCommit({userAction:"CustomRegionalFormatSettings.SimpleFormatPicker",environment:t,perform:t=>{R.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:Jc(e.userSettingsStore),[e.option]:i}},transaction:t})}}),e.onAccept()}})))}]})})}function gu(e){window.__c={n:"CustomizableFormatPicker"};const t=(0,L.O7)(),[s,n]=(0,i.useState)((()=>{})),a=(0,g.useIntl)(),o=(0,_.Yd)(uu[e.option]),l=i=>{const n="custom"===i?{type:i,format:s}:{type:i};B.createAndCommit({userAction:"CustomRegionalFormatSettings.onAction",environment:t,perform:t=>{R.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{...e.userSettingsStore.getRegionalFormatSettings(),use_default_region_settings:!1,region:Jc(e.userSettingsStore),[e.option]:n}},transaction:t})}}),e.onAccept()};return(0,r.jsx)(me.Z,{menuType:ye.og.Popup,width:216,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:[{key:"options",render:e=>(0,r.jsx)(he.Z,{...e,topBorder:0!==e.index}),items:o.map((t=>({key:t,render:i=>{if("custom"===t)return(0,r.jsx)(cu.Z,{...i,renderOrigin:s=>(0,r.jsx)(ue.Z,{...s,title:$.default.formatMessage(uu[e.option][t])}),onFocus:()=>{},renderExtension:()=>(0,r.jsx)(hu,{customFormat:s,onChange:e=>{n(e)},onAccept:()=>{l(t)}}),title:$.default.formatMessage(uu[e.option][t])});{const s="full_date"===e.option?ru({type:t},a):lu({type:t},a);return(0,r.jsx)(ue.Z,{...i,title:$.default.formatMessage(uu[e.option][t]),caption:s})}},action:()=>{l(t)}})))}]})})}function hu(e){window.__c={n:"CustomDateFormatExtension"};const t=(0,lt.yK)((e=>({container:{},label:{color:e.mediumTextColor,fontWeight:p.Z.fontWeight.semibold,paddingTop:6,paddingBottom:6,paddingLeft:14,paddingRight:14},actionButton:{marginTop:6}})),[]);return(0,r.jsxs)("div",{style:t.container,children:[(0,r.jsx)("div",{children:(0,r.jsx)(It.Z,{isSmall:!0,style:t.label,children:(0,r.jsx)(g.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.title",defaultMessage:"Custom format"})})}),(0,r.jsx)(du.ZP,{focus:!0,value:e.customFormat||"",onChange:t=>{e.onChange(t.target.value)}}),(0,r.jsx)(ue.Z,{style:t.actionButton,focused:!1,onClick:e.onAccept,title:(0,r.jsx)(g.FormattedMessage,{id:"regionalFormatSettings.customDateFormat.applyChanges",defaultMessage:"Apply changes"})})]})}function fu(e){window.__c={n:"RegionalFormatSettings"};const t=(0,lt.yK)((()=>({container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]),s=(0,N.VK)((()=>e.userSettingsStore.isReady()),[e.userSettingsStore]),i=(0,N.VK)((()=>e.userSettingsStore.shouldUseDefaultRegionalFormatting()),[e.userSettingsStore]),n=(0,L.O7)();return s?(0,r.jsxs)("div",{style:t.container,children:[(0,r.jsxs)("div",{style:t.controlRow,children:[(0,r.jsxs)("div",{style:t.label,children:[(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"regionalFormatSettings.label.title",defaultMessage:"Use regional defaults"})}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle,children:(0,r.jsx)(g.FormattedMessage,{id:"regionalFormatSettings.label.subtitle",defaultMessage:"Automatically apply standard formats of your region"})})]}),(0,r.jsx)(Rr.Z,{on:i,onClick:()=>{B.createAndCommit({userAction:"RegionalFormatSettings.RegionalFormatSettings",environment:n,perform:t=>{const s=i?{use_default_region_settings:!1,full_date:void 0,short_date:void 0,time:void 0,number:void 0,week_start_on:void 0}:{use_default_region_settings:!0};R.d2({userSettingsStore:e.userSettingsStore,data:{regional_format_settings:{region:Jc(e.userSettingsStore),...s}},transaction:t})}})}})]}),(0,r.jsx)("div",{children:i?(0,r.jsx)(yu,{userSettingsStore:e.userSettingsStore}):(0,r.jsx)(bu,{userSettingsStore:e.userSettingsStore})})]}):(0,r.jsx)(Ki.Z,{})}function yu(e){window.__c={n:"DefaultRegionalFormatSettings"};const t=(0,lt.yK)((()=>({container:{marginTop:12}})),[]);return(0,r.jsx)("div",{style:t.container,children:Su.map((t=>(0,r.jsx)(vu,{userSettingsStore:e.userSettingsStore,option:t},t)))})}function vu(e){window.__c={n:"DefaultRegionalFormatSetting"};const t=(0,lt.yK)((e=>({container:{display:"flex"},option:{color:e.lightTextColor,fontSize:p.Z.fontSize.UIRegular.desktop,width:100},example:{color:e.mediumTextColor,fontSize:p.Z.fontSize.UIRegular.desktop}})),[]),s=(0,g.useIntl)(),[i,n]=(0,N.VK)((()=>[e.userSettingsStore.isDefined(),xu(e.userSettingsStore,s,e.option)]),[s,e.option,e.userSettingsStore]);return i?(0,r.jsxs)("div",{style:t.container,children:[(0,r.jsx)("div",{style:t.option,children:$.default.formatMessage(iu[e.option])}),(0,r.jsx)("div",{style:t.example,children:n})]}):(0,r.jsx)(Ki.Z,{})}function xu(e,t,s){if("full_date"===s){return ru(eu(e,s),t)}if("short_date"===s){return lu(eu(e,s),t)}if("number"===s){return au(eu(e,s),t)}if("week_start_on"===s){return function(e){return"sunday"===e?$.default.formatMessage(ou.sunday):"monday"===e?$.default.formatMessage(ou.monday):(0,_.t1)(e)}(eu(e,s))}return(0,_.t1)(s)}const Su=["full_date","short_date","number","week_start_on"];function bu(e){return(0,r.jsx)("div",{children:Su.map((t=>(0,r.jsx)(Mu,{userSettingsStore:e.userSettingsStore,option:t},t)))})}function Mu(e){window.__c={n:"CustomRegionalFormatSetting"};const t=(0,g.useIntl)(),[s,i,n]=(0,N.VK)((()=>[e.userSettingsStore.isDefined(),Jc(e.userSettingsStore),xu(e.userSettingsStore,t,e.option)]),[t,e.option,e.userSettingsStore]),a=(0,lt.yK)(wu,[]);return s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(bo.Z,{size:24}),(0,r.jsx)("div",{style:a.container,children:(0,r.jsxs)("div",{style:a.controlRow,children:[(0,r.jsxs)("div",{style:a.label,children:[(0,r.jsx)(It.Z,{children:$.default.formatMessage(iu[e.option])}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:a.subtitle,children:n})]}),(0,r.jsx)(mu,{userSettingsStore:e.userSettingsStore,region:i,option:e.option})]})})]}):(0,r.jsx)(Ki.Z,{})}function wu(){return{container:{flex:1,display:"flex",flexDirection:"column"},controlRow:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}}}var ju=s(80994);function Cu(e){window.__c={n:"RegionSettings"};const t=(0,lt.yK)((()=>({container:{flex:1,display:"flex"},label:{flex:1},subtitle:{width:"80%"}})),[]);return(0,r.jsxs)("div",{style:t.container,children:[(0,r.jsxs)("div",{style:t.label,children:[(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"regionSettings.region.label",defaultMessage:"Region"})}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:t.subtitle,children:(0,r.jsx)(g.FormattedMessage,{id:"regionSettings.region.subtitle",defaultMessage:"Affects the default formats for dates, numbers, and currencies"})})]}),(0,r.jsx)(ku,{userSettingsStore:e.userSettingsStore,onChange:e.onChange,pickerLabel:e.pickerLabel})]})}function ku(e){window.__c={n:"RegionPicker"};const t=(0,lt.Fg)(),[,,s]=(0,N.AF)(void 0,vn.Z),n=(0,N.VK)((()=>Jc(e.userSettingsStore)),[e.userSettingsStore]),[a,o]=i.useState("");return(0,r.jsx)(Mn.ZP,{popupType:Mn.Z4.Popup,buttonPopupStore:s,renderOrigin:s=>(0,r.jsxs)(Ze.Z,{...s,children:[e.userSettingsStore?n:e.pickerLabel,(0,fa.i)({width:10,marginLeft:4,fill:t.lightIconColor})]}),placementToOrigin:Gc.Iw.Bottom,alignmentToOrigin:Gc.lU.Start,render:t=>(0,r.jsx)(me.Z,{menuType:ye.og.Popup,width:216,header:(0,r.jsx)(Tu,{value:a,onChange:e=>o(e)}),children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:[{key:"regions",render:e=>(0,r.jsx)(he.Z,{...e,topBorder:0!==e.index}),items:(0,kt.ZP)(a,ju.hW,(e=>e.name)).map((s=>({key:s.countryCode,render:e=>(0,r.jsx)(ue.Z,{...e,title:s.name}),action:()=>{e.onChange(s.countryCode),t.close(),o("")}})))}]})})})}const _u=(0,g.defineMessages)({regionSearchPlaceholder:{defaultMessage:"Search for a region...",id:"settings.regionSettings.regionSearch"}});function Tu(e){return(0,r.jsx)(he.Z,{isInput:!0,children:(0,r.jsx)(du.ZP,{value:e.value,onChange:t=>{e.onChange(t.target.value)},focus:!0,placeholder:$.default.formatMessage(_u.regionSearchPlaceholder),focusAfterAnimation:!0})})}var Iu=s(758),Pu=s(77058),Zu=s(91155);const Fu=function(e){window.__c={n:"SpellcheckerLanguagesPicker"};const[t,s]=i.useState([]),[n,a]=i.useState([]),o=(0,L.O7)(),l=(0,N.qz)(void 0,vn.Z),d=(0,lt.yK)((e=>({span:{color:e.mediumTextColor},plainButton:{paddingLeft:8,paddingRight:8,marginLeft:-8},icon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]);function c(e){return n.some((t=>t.code===e.code))}(0,i.useEffect)((()=>{const e=o.SpellCheckStore;e&&!(0,Iu.x)(e)&&(e.getAvailableLanguages().then(s).catch((e=>{rs.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getAvailableLanguages",error:(0,Zu.Ui)(e)})})),e.getLanguages().then(a).catch((e=>{rs.log({level:"error",from:"SpellcheckerLanguagesPicker",type:"getLanguages",error:(0,Zu.Ui)(e)})})))}),[o]),(0,i.useEffect)((()=>{const e=o.SpellCheckStore;if(!e||(0,Iu.x)(e))return;const t=n.map((e=>{let{code:t}=e;return t}));e.setLanguages(t)}),[n,o.SpellCheckStore]);const u=n.length>0?n.slice(0,3).map((e=>{let{name:t}=e;return t})).join(", ")+(n.length>3?"…":""):(0,r.jsx)(g.FormattedMessage,{id:"languageRegionSettings.spellchecker.picker.label",defaultMessage:"Select languages"});return(0,r.jsx)(Mn.ZP,{popupType:Mn.Z4.Popup,buttonPopupStore:l,renderOrigin:e=>(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(Ze.Z,{style:d.plainButton,...e,children:[u,(0,fa.i)(d.icon)]})}),placementToOrigin:Gc.Iw.Bottom,alignmentToOrigin:Gc.lU.Start,render:e=>{const s=[{key:"spellcheckerlanguages",render:e=>(0,r.jsx)(he.Z,{...e,topBorder:0!==e.index}),items:t.map((e=>({key:e.code,render:t=>function(e){const t=e.language.name||e.language.code;return(0,r.jsx)(ue.Z,{...e.props,title:(0,r.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,r.jsx)("div",{style:{marginRight:0},children:t})}),shouldWrapCaption:!0,right:c(e.language)?(0,Pu.$)({width:12,height:12}):void 0})}({language:e,props:t}),action:()=>{c(e)?a(n.filter((t=>t.code!==e.code))):a([...n,e])}})))}],i={menuType:ye.og.Popup,width:240};return(0,r.jsx)(me.Z,{className:gi.hKO,...i,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:s})})}})};const Au=function(e){window.__c={n:"SpellcheckerSettings"};const t=(0,L.O7)();return t.device.isElectron&&t.device.isWindows&&!Iu.x(t.SpellCheckStore)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(bo.Z,{size:24,isHidden:!0}),(0,r.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto"},children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",width:"100%"},children:[(0,r.jsxs)("div",{style:{flex:1},children:[(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"languageRegionSettings.spellchecker.label",defaultMessage:"Spellchecker languages"})}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%"},children:(0,r.jsx)(g.FormattedMessage,{id:"languageSettings.spellcheckerSwitcher.subtitle",defaultMessage:"Change the languages used by the spellchecker."})})]}),(0,r.jsx)(Fu,{})]})})]}):null};class Du extends n.Z{renderComponent(){return Vi.Z.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(It.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to manage your language and region.",id:"languageSettings.offline.message"})})})}renderSettings(){var e;const{currentUserSettingsStore:t}=I.default.state;if(!t)return;const s=(null===(e=t.getSettings())||void 0===e?void 0:e.preferred_locale)||Zr.al,i="on"===Zt.default.getGroup("aloha");return(0,r.jsxs)(Ui.Z,{children:[(0,r.jsx)(zt.Z,{large:!0,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"languageSettings.languageSection.title",defaultMessage:"Language & region"})}),(0,r.jsx)($c,{locale:s,userSettingsStore:t}),(0,r.jsx)(Au,{}),(0,r.jsx)(bo.Z,{size:24}),i?(0,r.jsxs)("div",{style:{marginTop:12},children:[(0,r.jsx)(Cu,{locale:s,userSettingsStore:t,onChange:e=>{}}),(0,r.jsx)(bo.Z,{size:24}),(0,r.jsx)(zt.Z,{large:!0,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"languageSettings.formatsSection.title",defaultMessage:"Formats"})}),(0,r.jsx)(fu,{locale:s,userSettingsStore:t}),(0,r.jsx)(bo.Z,{size:24})]}):(0,r.jsx)(Vc.Z,{})]})}}Du.displayName="LanguageRegionSettings";const Bu=Du;var Ru=s(15311),Lu=s(28187),Nu=s(21291),Eu=s(51124),Ou=s(97876);function Vu(){window.__c={n:"NotificationSettings"};const{isElectron:e,isMobile:t}=(0,L.Fy)(),s=(0,L.O7)(),i=(0,N.VK)((()=>Vi.Z.state.online),[]),n=(0,N.VK)((()=>{const s=(0,Lu.kC)();return function(e){const{isMobile:t,isElectron:s,showSlackNotificationSetting:i}=e;return[{key:"notify_mobile",renderSettingsItem:()=>(0,r.jsx)(Nu.A,{target:"notify_mobile"})},!t&&s?{key:"notify_desktop",renderSettingsItem:()=>(0,r.jsx)(Nu.A,{target:"notify_desktop"})}:void 0,i?{key:"notify_slack",renderSettingsItem:()=>(0,r.jsx)(Ou.O,{target:"notify_slack"})}:void 0].filter(_.$K)}({isMobile:t,isElectron:e,showSlackNotificationSetting:s})}),[t,e]),a=(0,N.VK)((()=>{var e;return function(e){const{showNotifyEmailAlwaysSetting:t}=e;return[{key:"notify_email",renderSettingsItem:()=>(0,r.jsx)(Nu.A,{target:"notify_email"})},t?{key:"notify_email_always",renderSettingsItem:()=>(0,r.jsx)(Nu.A,{target:"notify_email_always"})}:void 0,{key:"notify_email_digest",renderSettingsItem:()=>(0,r.jsx)(Nu.A,{target:"notify_email_digest"})},{key:"marketing_emails",renderSettingsItem:()=>(0,r.jsx)(Nu.A,{target:"marketing_emails"})}].filter(_.$K)}({showNotifyEmailAlwaysSetting:(null===(e=I.default.state.currentSpaceViewStore)||void 0===e?void 0:e.getNotifyEmail())||!1})}),[]),o=(0,N.VK)((()=>s.WindowSizeStore.state.paddingBottomCSS),[s.WindowSizeStore]);return i?(0,r.jsxs)(Ui.Z,{disableScroller:t,children:[(0,r.jsx)(zt.Z,{large:!t,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"notificationSettings.notificationsSection.title",defaultMessage:"My notifications"})}),(0,r.jsx)(Eu.O,{items:n}),(0,r.jsx)(bo.Z,{size:48,isHidden:!0}),(0,r.jsx)(zt.Z,{large:!t,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"notificationSettings.emailNotificationsSection.title",defaultMessage:"Email notifications"})}),(0,r.jsx)(Eu.O,{items:a}),(0,r.jsx)(bo.Z,{size:48,isHidden:!0}),(0,r.jsx)("div",{style:{marginTop:4,marginBottom:t?o:void 0},children:(0,r.jsx)(ml.Z,{title:(0,r.jsx)(g.FormattedMessage,{id:"myNotificationSettings.helpButton.caption",defaultMessage:"Learn about notifications"}),href:(0,yi.UY)("guides.notificationSettings"),analyticsFrom:"notifications_settings"})})]}):(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(It.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to manage your notification settings.",id:"myNotificationsSettings.goOnline.prompt"})})})}var Uu=s(11470);function Wu(e){let{spaceStore:t}=e;const s=(0,L.O7)(),[{status:i,value:n}]=(0,Oo.r5)((async()=>await async function(e,t){const{spaceId:s}=t,i=await w.getPublishedPagesForUser(e,{spaceId:s});if("failed"===i.type)throw v.showError(i),new Error("Failed to fetch published pages.");return i.data}(s,{spaceId:t.id})),[s,t]);return{loading:"pending"===i,publishedPages:"resolved"===i?Aa.PF.create(null==n?void 0:n.recordMap):void 0}}const zu={key:"pages",header:(0,r.jsx)(g.FormattedMessage,{id:"publishing.publicPages.pageColumn.header",defaultMessage:"Pages"}),style:{width:"50%"}},Ku={key:"domain",header:(0,r.jsx)(g.FormattedMessage,{id:"publishing.publicPages.domainColumn.header",defaultMessage:"Domain"}),style:{width:"50%"}};function Hu(e){window.__c={n:"PublishingSettingsTab"};const{spaceStore:t}=e,s=(0,N.VK)((()=>t),[t]),i=(0,N.VK)((()=>`${s.getPublicContentDomain()}.${Kt.default.publicDomainName}`),[s]),{publishedPages:n,loading:a}=Wu({spaceStore:s}),o=(n?(()=>{const e=[];for(const{model:t}of n)t&&t.table===ds.iU&&e.push(t);return e})():[]).map((e=>{const t=nt.G.createChildStore(s,{table:ds.iU,id:e.id});return{key:e.id,columns:[(0,r.jsx)(Uu.Z,{focused:!1,store:t,hidePath:!0,caption:void 0},e.id),i]}}));return(0,r.jsxs)(Ui.Z,{children:[(0,r.jsx)(zt.Z,{large:!0,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"publishing.publicPages.title",defaultMessage:"Published pages"})}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%",marginBottom:6},children:(0,r.jsx)(g.FormattedMessage,{id:"publishing.publicPages.caption",defaultMessage:"See all pages visible to you that are published to the web."})}),(0,r.jsx)(bo.Z,{size:16,isHidden:!0}),a?(0,r.jsx)(Ki.Z,{}):(0,r.jsx)(vc.Z,{columns:[zu,Ku],rows:o})]})}var Gu=s(5851),qu=s(98481),Yu=s(64404),Qu=function(e){return e[e.Keep=0]="Keep",e[e.Remove=1]="Remove",e}(Qu||{});function $u(e){return(0,r.jsx)(Bo.Z,{open:e.isOpen,onDismiss:e.onDismiss,render:()=>(0,r.jsx)(Xu,{...e})})}function Xu(e){window.__c={n:"DisableGuestsConfig"};const{onDismiss:t,onSave:s}=e,[n,a]=(0,i.useState)(Qu.Keep),o=(0,lt.yK)((e=>({container:{width:350,padding:30,borderRadius:5,height:400,alignItems:"center"},title:{fontFamily:p.Z.getCompositeFontFamily(is.SP).sans,fontSize:17,fontWeight:500,lineHeight:"24px",textAlign:"center"},subtitle:{fontFamily:p.Z.getCompositeFontFamily(is.SP).sans,fontSize:14,fontWeight:300,lineHeight:"19px",margin:10,textAlign:"center"},radioContainer:{display:"flex",flexDirection:"column"},button:{justifyContent:"space-between",marginTop:10,height:70,borderRadius:5},buttonText:{display:"flex",flexDirection:"column"},optionSubtitle:{whiteSpace:"break-spaces"},actionButtonsContainer:{display:"flex",flexDirection:"column",marginTop:20},cancelButton:{justifyContent:"center"}})),[]),l=(0,i.useCallback)((()=>{const e=n===Qu.Keep;s(e)}),[s,n]);return(0,r.jsxs)("div",{style:o.container,children:[(0,r.jsx)(It.Z,{style:o.title,children:(0,r.jsx)(g.FormattedMessage,{id:"disableGuestsConfig.title",defaultMessage:"Disable guests?"})}),(0,r.jsx)(It.Z,{isSmall:!0,style:o.subtitle,isMultiline:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"disableGuestsConfig.description",defaultMessage:"You are turning off guests in this workspace. You can choose to:"})}),(0,r.jsxs)("div",{style:o.radioContainer,children:[(0,r.jsxs)(Wt.Z,{isLarge:!0,onClick:()=>a(Qu.Keep),style:o.button,children:[(0,r.jsx)(da.Z,{isSelected:n===Qu.Keep}),(0,r.jsxs)("div",{style:o.buttonText,children:[(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"disableGuestsConfig.keepExistingGuests.title",defaultMessage:"Keep existing guests"})}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:o.optionSubtitle,children:(0,r.jsx)(g.FormattedMessage,{id:"disableGuestsConfig.keepExistingGuests.description",defaultMessage:"Guests will still be able to access the pages they've been invited to"})})]})]}),(0,r.jsxs)(Wt.Z,{isLarge:!0,onClick:()=>a(Qu.Remove),style:o.button,children:[(0,r.jsx)(da.Z,{isSelected:n===Qu.Remove}),(0,r.jsxs)("div",{style:o.buttonText,children:[(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"disableGuestsConfig.removeExistingGuests.title",defaultMessage:"Remove existing guests"})}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:o.optionSubtitle,children:(0,r.jsx)(g.FormattedMessage,{id:"disableGuestsConfig.removeExistingGuests.description",defaultMessage:"All guests will be removed from your workspace"})})]})]})]}),(0,r.jsxs)("div",{style:o.actionButtonsContainer,children:[(0,r.jsx)(ce.Z,{isLarge:!0,onClick:l,children:(0,r.jsx)(g.FormattedMessage,{id:"disableGuestsModal.saveChanges",defaultMessage:"Disable guests"})}),(0,r.jsx)(Ze.Z,{onClick:t,style:o.cancelButton,children:(0,r.jsx)(g.FormattedMessage,{id:"disableGuestsModal.cancel",defaultMessage:"Cancel"})})]})]})}var Ju=s(69435);const em=.5;class tm extends n.Z{constructor(){super(...arguments),this.storeTypes={tokenOptionsButtonPopupStore:vn.Z,domainVerificationStore:rl.ZP},this.handleDisablePublicAccessSwitcherClick=async()=>{const{securitySettingsStore:e}=this.props,t=e.state.disablePublicAccess;if(!t){if(!(await v.confirmUserAction({message:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.message",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this workspace."}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.preventPublicSharing.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return}this.handleSave({disablePublicAccess:!t})},this.handleAllowDisableGuestsSwitcherClick=async()=>{const{securitySettingsStore:e}=this.props,t=e.state.disableGuests;if(t)this.handleSave({disableGuests:!t,enableGuestInviteRequests:!1});else{if(Zt.default.checkGate("show_keep_existing_guests_modal"))return void e.setState({...e.state,disableGuestsModalOpen:!0});if(!(await v.confirmUserAction({message:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.message",defaultMessage:"Are you sure? All guests in this workspace will be removed."}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.disableGuests.confirmationModal.confirmButton.label",defaultMessage:"Yes"})})))return;this.handleSave({disableGuests:!t})}},this.handleToggleClick=(e,t)=>{if(!t)return this.handleUpgradeClick();const{securitySettingsStore:s}=this.props;this.handleSave({[e]:!s.state[e]})},this.handleUpgradeClick=()=>{$a.y(this.environment,{from:"space_saml",for:"enterprise"})}}renderComponent(){return Vi.Z.state.online?(0,r.jsx)(Ui.Z,{children:this.renderSecuritySettings()}):this.renderOfflineMessage()}renderUpsell(){if(!(0,qu.J)({environment:this.environment}))return(0,r.jsxs)("div",{style:{border:`1px solid ${this.theme.regularDividerColor}`,borderRadius:3,padding:16,marginTop:void 0,marginBottom:24},children:[!(0,io.Rs)()&&(0,r.jsx)(Ju.Z,{for:"business",from:"space_saml",upgradeMessage:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.upsell.button.business",defaultMessage:"Upgrade to Business"}),title:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.upsell.title.business",defaultMessage:"Upgrade for SAML SSO & more admin tools"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.business",defaultMessage:"The Business Plan includes single sign-on to manage employee access at scale, private teamspaces to collaborate on sensitive docs, and more."}),learnMoreRoute:"guides.securitySettings",style:{marginBottom:"20px"}}),(0,r.jsx)(Ju.Z,{for:"enterprise",from:"space_saml",upgradeMessage:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.upsell.button.enterprise",defaultMessage:"Upgrade to Enterprise"}),title:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.upsell.title.enterprise",defaultMessage:"Upgrade for SCIM, advanced security & more"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.upsell.caption.enterprise",defaultMessage:"The Enterprise Plan allows you to automatically provision users and groups, and gain more visibility and controls across the workspace."}),learnMoreRoute:"guides.securitySettings"})]})}renderSecuritySettings(){const{securitySettingsStore:e}=this.props,t=Zt.default.checkGate("guest_invite_requests"),s=this.renderUpsellButton(),n=t=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:t?this.handleDisablePublicAccessSwitcherClick:this.handleUpgradeClick,children:[(0,r.jsxs)("div",{style:this.getTitleStyle(),children:[(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.label",defaultMessage:"Disable public page sharing"}),!t&&s,(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.preventPublicSharing.caption",defaultMessage:"Disable the Share to web option in the Share menu on every page in this workspace."})})]}),(0,r.jsx)("div",{style:{marginTop:5,opacity:t?void 0:em},children:(0,r.jsx)(Rr.Z,{on:e.state.disablePublicAccess,disabled:!t})})]}),(0,r.jsx)(bo.Z,{size:24,style:{opacity:0}})]}),a=t=>{if(!(0,T.bq)())return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>this.handleToggleClick("disableSpacePageEdits",t),children:[(0,r.jsxs)("div",{style:this.getTitleStyle(),children:[(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.label",defaultMessage:"Prevent members from editing the Workspace section"}),!t&&s,(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"85%"},children:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableSpacePageEdits.caption",defaultMessage:"Disable the ability for members to create, move, reorder, and delete top-level Workspace pages."})})]}),(0,r.jsx)("div",{style:{marginTop:5,opacity:t?void 0:em},children:(0,r.jsx)(Rr.Z,{on:e.state.disableSpacePageEdits,disabled:!t})})]}),(0,r.jsx)(bo.Z,{size:24,style:{opacity:0}})]})},o=t=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:t?this.handleAllowDisableGuestsSwitcherClick:this.handleUpgradeClick,children:[(0,r.jsxs)("div",{style:this.getTitleStyle(),children:[(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.label",defaultMessage:"Disable guests"}),!t&&s,(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableGuests.caption",defaultMessage:"Prevent anyone from inviting people outside the workspace to pages."})})]}),(0,r.jsx)("div",{style:{marginTop:5,opacity:t?void 0:em},children:(0,r.jsx)(Rr.Z,{on:e.state.disableGuests,disabled:!t})})]}),(0,r.jsx)(bo.Z,{size:24,style:{opacity:0}}),(0,r.jsx)($u,{isOpen:Boolean(e.state.disableGuestsModalOpen),onDismiss:()=>{e.setState({...e.state,disableGuestsModalOpen:!1})},onSave:t=>{this.handleSave({disableGuests:!0,keepExistingGuests:t}),e.setState({...e.state,disableGuestsModalOpen:!1})}})]}),l=t=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>this.handleToggleClick("disableMoveToSpace",t),children:[(0,r.jsxs)("div",{style:this.getTitleStyle(),children:[(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.label",defaultMessage:"Disable duplicating pages to other workspaces"}),!t&&s,(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableMovingPages.caption",defaultMessage:"Prevent anyone from duplicating pages to other workspaces via the Move To or Duplicate To actions."})})]}),(0,r.jsx)("div",{style:{marginTop:5,opacity:t?void 0:em},children:(0,r.jsx)(Rr.Z,{on:e.state.disableMoveToSpace,disabled:!t})})]}),(0,r.jsx)(bo.Z,{size:24,style:{opacity:0}})]}),{state:d}=e,c=t=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>this.handleToggleClick("disableExport",t),children:[(0,r.jsxs)("div",{style:this.getTitleStyle(),children:[(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.label",defaultMessage:"Disable export"}),!t&&s,(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.disableExport.caption",defaultMessage:"Prevent anyone from exporting as Markdown, CSV, or PDF."})})]}),(0,r.jsx)("div",{style:{marginTop:5,opacity:t?void 0:em},children:(0,r.jsx)(Rr.Z,{on:e.state.disableExport,disabled:!t})})]}),(0,r.jsx)(bo.Z,{size:24,style:{opacity:0}})]});return(0,qu.J)({environment:this.environment})?(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(zt.Z,{large:!0,divider:"full",children:t?(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.generalSection.title",defaultMessage:"General"}):(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"})}),void 0,n(!0),a(!0),!t&&o(!0),l(!0),c(!0),t&&this.renderGuestsSettings(!0,(0,io.wP)()),(0,r.jsx)("div",{style:{height:36}})]}):(0,r.jsxs)(i.Fragment,{children:[this.renderUpsell(),(0,r.jsx)("div",{style:this.getHeaderStyle(),children:(0,r.jsx)("span",{style:{marginRight:8},children:t?(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.generalSection.title",defaultMessage:"General"}):(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.securitySection.title",defaultMessage:"Security"})})}),void 0,n(d.disablePublicAccess),a(d.disableSpacePageEdits),!t&&o(d.disableGuests),l(d.disableMoveToSpace),c(d.disableExport),t&&this.renderGuestsSettings(d.disableGuests,d.enableGuestInviteRequests),(0,r.jsx)("div",{style:{height:32}})]})}renderOfflineMessage(){return(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to manage security settings.",id:"securitySAMLSettings.offline.message"})})})}renderUpsellButton(){return(0,r.jsx)(il.Z,{subscriptionTier:"enterprise",analyticsName:"space_saml",onClick:this.handleUpgradeClick,desktopStyle:{display:"inline-block",marginLeft:8,marginTop:-3}})}renderGuestsSettings(e,t){const{data:s}=Di.default.state;if(!s)return this.renderLoadingSpinner();const i=Oi.CM(s).filter(ia.du).filter((e=>!e.isTeamGuest&&e.isPageGuest)).length;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(zt.Z,{large:!0,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.guestsSection.title",defaultMessage:"Guests"})}),this.renderDisableGuestsV2(e,i),this.renderEnableGuestInviteRequests(t)]})}renderDisableGuestsV2(e,t){return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,r.jsxs)("div",{style:this.getTitleStyle(),children:[(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.guestsSection.disableGuests.label",defaultMessage:"Disable members inviting guests to pages"}),!e&&this.renderUpsellButton(),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.guestsSection.disableGuests.caption",defaultMessage:"Your workspace currently has <gueststablink> {guestCount, plural, one {1 guest} other {{guestCount} guests}}</gueststablink>.",values:{gueststablink:e=>(0,r.jsx)(wo.Z,{onClick:()=>{Ai.Z.setState({...Ai.Z.state,currentTab:"members",defaultSubtab:Yu.Q.Guests})},children:e}),guestCount:t}})})]}),(0,r.jsx)("div",{onClick:e?this.handleAllowDisableGuestsSwitcherClick:this.handleUpgradeClick,style:{marginTop:5,opacity:e?void 0:em},children:(0,r.jsx)(Rr.Z,{on:this.props.securitySettingsStore.state.disableGuests,disabled:!e})})]}),(0,r.jsx)(bo.Z,{size:24,style:{opacity:0}}),(0,r.jsx)($u,{isOpen:Boolean(this.props.securitySettingsStore.state.disableGuestsModalOpen),onDismiss:()=>{this.props.securitySettingsStore.setState({...this.props.securitySettingsStore.state,disableGuestsModalOpen:!1})},onSave:e=>{this.handleSave({disableGuests:!0,keepExistingGuests:e}),this.props.securitySettingsStore.setState({...this.props.securitySettingsStore.state,disableGuestsModalOpen:!1})}})]})}renderEnableGuestInviteRequests(e){let t;e&&this.props.securitySettingsStore.state.disableGuests?t=()=>this.handleToggleClick("enableGuestInviteRequests",e):e||(t=this.handleUpgradeClick);const s=!e||!this.props.securitySettingsStore.state.disableGuests;return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[(0,r.jsxs)("div",{style:this.getTitleStyle(),children:[(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.label",defaultMessage:"Members can request adding guests"}),!e&&this.renderUpsellButton(),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,r.jsx)(g.FormattedMessage,{id:"securitySAMLSettings.guestsSection.enableGuestInviteRequests.caption",defaultMessage:"Requests must be approved by a workspace owner. You can view all requests <requeststablink>here</requeststablink>.",values:{requeststablink:e=>(0,r.jsx)(wo.Z,{onClick:()=>{Ai.Z.setState({...Ai.Z.state,currentTab:"members",defaultSubtab:Yu.Q.Requests})},children:e})}})})]}),(0,r.jsx)("div",{onClick:t,style:{marginTop:5,opacity:e&&this.props.securitySettingsStore.state.disableGuests?void 0:em},children:(0,r.jsx)(Rr.Z,{on:this.props.securitySettingsStore.state.enableGuestInviteRequests,disabled:s})})]}),(0,r.jsx)(bo.Z,{size:24,style:{opacity:0}})]})}renderLoadingSpinner(){return(0,r.jsx)(Ki.Z,{})}handleSave(e){const{securitySettingsStore:t,spaceStore:s}=this.props;Gu.y(this.environment,{spaceStore:s,securitySettingsStore:t,fields:e})}getHeaderStyle(){return{fontWeight:p.Z.fontWeight.medium,fontSize:18,borderBottom:`1px solid ${this.theme.regularDividerColor}`,paddingBottom:6,marginBottom:12,display:"flex",alignItems:"center"}}getTitleStyle(){return{fontSize:14,marginRight:8,flexGrow:1}}}tm.displayName="SecuritySettings";const sm=(0,g.injectIntl)(tm);var im=s(58047);function nm(e){window.__c={n:"SettingsPrompt"};const t=(0,L.O7)(),{onView:s}=e;return(0,i.useEffect)((()=>{s(t)}),[t,s]),(0,r.jsxs)("div",{children:[(0,r.jsx)(bo.Z,{size:0}),(0,r.jsx)(im.N,{icon:e.icon,title:e.title,description:e.descriptionMessage,onDismiss:e.onDismiss,primaryAction:{text:e.buttonText,onClick:t=>(e.onDismiss(),e.onClick(t))},secondaryAction:{icon:e=>(0,qo.m)(e),text:(0,r.jsx)(g.FormattedMessage,{id:"settingsPrompt.learnMore.button",defaultMessage:"Learn more"}),onClick:e.onClickLearnMore}})]})}class am extends n.Z{renderComponent(){return(0,r.jsxs)("div",{style:this.getStyle(),onMouseDown:this.props.onMouseDown,onClick:this.props.onClick,onDoubleClick:this.props.onDoubleClick,onContextMenu:this.props.onContextMenu,children:[(0,r.jsx)("div",{style:this.getSidebarStyle(),children:this.props.sidebar}),(0,r.jsx)("div",{style:this.getChildrenStyle(),children:this.props.children})]})}getStyle(){return{display:"flex",height:"100%",flexDirection:this.props.isReversed?"row-reverse":"row"}}getSidebarStyle(){return{height:"100%",background:this.theme.cardSidebarBackground,flexGrow:0,flexShrink:0,width:240,overflowY:"auto"}}getChildrenStyle(){return{flexGrow:1,position:"relative",zIndex:1,height:"100%"}}}am.displayName="SidebarBox";const om=am,rm="last_90_days",lm={field:"last_active",direction:"desc"};async function dm(e){var t,s;const{environment:i,filter:n,spaceId:a,spaceAnalyticsStore:o}=e,r=null===(t=o.usersTabData)||void 0===t?void 0:t.dailyUsersData;if(!r||n!==(null===(s=o.usersTabData)||void 0===s?void 0:s.graphFilter)||o.currentSpaceId!==a){const e=await w.getDailyUsersAnalytics(i,{spaceId:a,activeWindow:"all_time"===n?"last_90_days":n});return"failed"===e.type?e.body:e.data}return r}async function cm(e){var t,s,i;const{environment:n,filter:a,sort:o,spaceStore:r,spaceAnalyticsStore:l}=e,d=null===(t=l.usersTabData)||void 0===t?void 0:t.tableFilter,c=null===(s=l.usersTabData)||void 0===s?void 0:s.userTableSort;if(null===(i=l.usersTabData)||void 0===i||!i.usersAndStats||d!==a||!c||c.direction!==o.direction||c.field!==o.field||l.currentSpaceId!==r.id){const e=await w.loadWorkspaceAnalyticsUsers(n,{spaceId:r.id,filters:{timeRange:a},sort:o});return"failed"===e.type?e.body:e.data.users.map((e=>({stats:e,userStore:nt.U6.createChildStore(r,{table:q.KJ,id:e.userId})}))).filter((e=>{let{userStore:t}=e;return t.isDefined()}))}return l.usersTabData.usersAndStats}function um(e,t){if((0,O.qC)(e)){const s=(0,Q.nX)(t,e);if(s)return s}return t.formatMessage({defaultMessage:"Failed to retrieve analytics. Try refreshing and reopening the settings.",id:"workspaceAnalytics.usersTab.refershUserAnalytics.defaultFailed"})}const mm={pageViews:0,uniquePageViews:0,pagesCreated:0,pageEdits:0,topPages:[]};const pm={activeMembersCount:0,previousActiveMembersCount:0,activeGuestsCount:0,previousActiveGuestsCount:0,topTeamspaces:[],topViewers:[],topEditors:[]};function gm(e){return(0,r.jsx)(Mn.ZP,{popupType:ge.kQ.Popup,alignmentToOrigin:ns.v.End,render:t=>{let{close:s}=t;return(0,r.jsx)(hm,{closePopup:s,analyticsType:e.analyticsType})},renderOrigin:t=>{let{onClick:s}=t;return(0,r.jsx)(Wt.Z,{style:e.style,onClick:s,children:(0,r.jsx)(g.FormattedMessage,{id:"spaceAnalytics.usersTab.export",defaultMessage:"Export as CSV"})})}})}function hm(e){window.__c={n:"ExportAnalyticsMenu"};const{analyticsType:t,closePopup:s}=e,n=(0,L.O7)(),a=(0,N.VK)((()=>{var e;return null===(e=I.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),o=(0,i.useCallback)((async e=>{if(a){switch(t){case ji.Users:y.LbR(n,{daysFilter:e}),await de.Tp(n,{spaceId:a,daysFilter:e});break;case ji.Content:y.ZaS(n,{daysFilter:e}),await de.hN(n,{spaceId:a,daysFilter:e});break;default:(0,_.t1)(t)}s()}}),[n,a,t,s]),l=ps.Hz.map((e=>(0,r.jsx)(ue.Z,{focused:!1,onClick:()=>o(e),title:$.default.formatMessage(ps.Rh[e])},e)));return(0,r.jsx)(me.Z,{menuType:ye.og.Popup,children:(0,r.jsx)(he.Z,{children:l})})}var fm=s(83176);const ym=(0,g.defineMessages)({emptyAnalyticsHeading:{id:"workspaceAnalyticsTabs.empty.heading",defaultMessage:"No workspace analytics yet"},emptyAnalyticsDescription:{id:"workspaceAnalyticsTabs.empty.description",defaultMessage:"It may take some time for workspace analytics information to appear."},disabledAnalyticsHeading:{id:"workspaceAnalyticsTabs.disabled.heading",defaultMessage:"Analytics are disabled"},disabledAnalyticsDescription:{id:"workspaceAnalyticsTabs.disabled.description",defaultMessage:"A workspace owner has turned off page view recording for {name}.{br}This information will not be available in your workspace settings or on individual pages."},disabledAnalyticsDescriptionNoSpaceName:{id:"workspaceAnalyticsTabs.disabled.description.unnamed",defaultMessage:"A workspace owner has turned off page view recording for this space.{br}This information will not be available in your workspace settings or on individual pages."}});function vm(e){window.__c={n:"SpaceAnalyticsEmptyState"};const t=(0,lt.yK)((e=>({outerDiv:{display:"flex",flexDirection:"column",justifyContent:"center",height:"80%",gap:24},innerDiv:{display:"flex",flexDirection:"column",textAlign:"center",alignItems:"center",gap:4},header:{fontSize:16,fontWeight:500},analyticsIcon:{fill:e.mediumTextColor,padding:20,height:150,width:150},learnMoreIcon:{width:14,height:14},learnMore:{gap:4}})),[]),s=(0,L.O7)(),{type:i,spaceName:n}=e,a=function(e,t){switch(e){case"empty":return{heading:$.default.formatMessage(ym.emptyAnalyticsHeading),description:$.default.formatMessage(ym.emptyAnalyticsDescription)};case"disabled":const e=t?(0,r.jsx)(g.FormattedMessage,{...ym.disabledAnalyticsDescription,values:{name:t,br:(0,r.jsx)("br",{})}}):(0,r.jsx)(g.FormattedMessage,{...ym.disabledAnalyticsDescriptionNoSpaceName,values:{br:(0,r.jsx)("br",{})}});return{heading:$.default.formatMessage(ym.disabledAnalyticsHeading),description:e}}}(i,n);return(0,r.jsx)("div",{style:t.outerDiv,children:(0,r.jsxs)("div",{style:t.innerDiv,children:[(0,fm.z)(t.analyticsIcon),(0,r.jsx)(It.Z,{isSecondaryColor:!0,style:t.header,children:a.heading}),(0,r.jsx)(It.Z,{isSecondaryColor:!0,children:a.description}),(0,r.jsxs)(Ze.Z,{onClick:()=>S.navigateToExternalURL({environment:s,url:(0,yi.UY)("guides.workspaceAnalytics")}),style:t.learnMore,children:[(0,qo.m)(t.learnMoreIcon),(0,r.jsx)(It.Z,{isSmall:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalyticsTabs.disabled.learnMore",defaultMessage:"Learn more"})})]})]})})}var xm=s(55964),Sm=s(90028),bm=s(35314);function Mm(e){let{num:t,abbreviateNumber:s}=e;window.__c={n:"NumberDisplay"};const i=(0,g.useIntl)(),n=(0,Zr.E2)(i),a=t.toLocaleString(n),o=Intl.NumberFormat(n,{notation:"compact",maximumFractionDigits:1}).format(t);return s?(0,r.jsx)(fe.Z,{placement:fe.Z.Placement.Bottom,render:e=>(0,r.jsx)("span",{...e,children:o}),renderTooltip:()=>a}):(0,r.jsx)("span",{children:a})}function wm(e){let{icon:t,iconStyles:s,textStyles:i,style:n,title:a,byline:o,loading:l,error:d}=e;window.__c={n:"AnalyticsCardOverview"};const c=function(e,t,s){return(0,lt.yK)((i=>({title:{fontWeight:p.Z.fontWeight.medium,fontSize:16},byline:{fontSize:p.Z.fontSize.UISmall.desktop,marginTop:4},textContainer:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",...t},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:8},icon:{height:28,width:28,color:i.lightTextColor,fill:"currentcolor",...e},container:{height:"100%",flex:1,display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",border:`1px solid ${i.outlineButtonBorder}`,borderRadius:4,padding:12,gap:8,...s},loadingTitle:{display:"block",width:"40%"},loadingByline:{display:"block",width:"60%",marginTop:8,marginBottom:8},errorTitle:{textAlign:"center",color:mt.ZP.red}})),[e,t,s])}(s,i,n);return l?(0,r.jsx)("div",{style:c.container,children:(0,r.jsxs)("div",{style:c.textContainer,children:[(0,r.jsx)("div",{style:c.loadingTitle,children:(0,r.jsx)(qt.Z,{paragraphs:[{lineHeight:18,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:0}]})}),o?(0,r.jsx)("div",{style:c.loadingByline,children:(0,r.jsx)(qt.Z,{paragraphs:[{lineHeight:14,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:0}]})}):null]})}):d?(0,r.jsx)("div",{style:c.container,children:(0,r.jsx)("div",{style:c.titleContainer,children:(0,r.jsx)(It.Z,{style:c.errorTitle,children:(0,O.Jx)(d)?d.message:(0,r.jsx)(g.FormattedMessage,{id:"spaceAnalytics.basicErrorMessage",defaultMessage:"Something went wrong.{br}Try refreshing the page.",values:{br:(0,r.jsx)("br",{})}})})})}):(0,r.jsxs)("div",{style:c.container,children:[t?t(c.icon):null,(0,r.jsxs)("div",{style:c.textContainer,children:[(0,r.jsx)(It.Z,{style:c.title,children:a}),o?(0,r.jsx)(It.Z,{style:c.byline,children:o}):null]})]})}var jm=s(67579);const Cm=640;function km(e){let{data:t,loading:s,error:n,daysFilter:a,setDaysFilter:o}=e;window.__c={n:"ContentAnalyticsSummaries"};const[l,d]=(0,bm.e)(),c=(0,lt.yK)((e=>({title:{fontWeight:p.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center",justifyContent:"center"},infoIcon:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},cardContainer:{justifyContent:"flex-start",gap:18},cardTextContainer:{alignItems:"flex-start"}})),[]),{pageViews:u,uniquePageViews:m,pagesCreated:h,pageEdits:f}=t,v=(0,L.O7)(),x=(0,i.useCallback)((e=>{y.kyK(v,{daysFilter:e}),o(e)}),[v,o]);return(0,r.jsxs)("div",{style:c.container,ref:l,children:[(0,r.jsxs)("div",{style:c.titleContainer,children:[(0,r.jsxs)(It.Z,{style:c.title,children:[(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.title",defaultMessage:"Content engagement"}),(0,r.jsx)(fe.Z,{placement:ns.u.Bottom,render:e=>(0,r.jsx)(ml.Z,{...e,href:(0,yi.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:c.infoIcon}),renderTooltip:()=>"all_time"!==a?(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.contentEngagement.tooltip.lastDays",defaultMessage:"Activity on all workspace pages (includes private and shared) over the {dateRange}",values:{dateRange:$.default.formatMessage(ps.xX[a])}}):(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.contentEngagement.tooltip.allTime",defaultMessage:"All time activity on all pages in the workspace (includes private and shared)"})})]}),(0,r.jsx)(jm.f,{currentFilter:a,onChangeFilter:x})]}),(0,r.jsxs)(gd.rj,{gap:16,children:[(0,r.jsx)(gd.r8,{row:1,col:1,children:(0,r.jsx)(wm,{style:c.cardContainer,textStyles:c.cardTextContainer,loading:s,error:n,icon:xm.N,iconStyles:{height:48,width:48},title:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.totalViews",defaultMessage:"{pageViews} total views",values:{pageViews:(0,r.jsx)(Mm,{abbreviateNumber:d<Cm,num:u})}}),byline:(0,r.jsx)(It.Z,{isSecondaryColor:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.uniqueViews",defaultMessage:"{uniquePageViews} unique page views",values:{uniquePageViews:(0,r.jsx)(Mm,{abbreviateNumber:d<Cm,num:m})}})})})}),(0,r.jsx)(gd.r8,{row:1,col:2,children:(0,r.jsx)(wm,{style:c.cardContainer,textStyles:c.cardTextContainer,loading:s,error:n,icon:Sm.j,iconStyles:{height:36,width:36},title:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.pagesCreated",defaultMessage:"{pagesCreated} pages created",values:{pagesCreated:(0,r.jsx)(Mm,{abbreviateNumber:d<Cm,num:h})}}),byline:(0,r.jsx)(It.Z,{isSecondaryColor:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.content.contentEngagement.pageEdits.byline",defaultMessage:"{pageEdits} edits",values:{pageEdits:(0,r.jsx)(Mm,{abbreviateNumber:d<Cm,num:f})}})})})})]})]})}function _m(e){const{tooltipMessageDescriptor:t,columnHeader:s}=e;return(0,r.jsx)(fe.Z,{placement:fe.Z.Placement.Top,renderTooltip:e=>(0,r.jsx)("div",{...e,children:(0,r.jsx)(g.FormattedMessage,{...t})}),render:e=>(0,r.jsx)("div",{...e,children:$.default.formatMessage(s)})})}function Tm(e){let{blockStore:t}=e;window.__c={n:"PageCellActions"};const s=(0,L.O7)(),i=(0,N.qz)(void 0,vn.Z),n=(0,lt.yK)((e=>({changePermissionsIcon:{height:18,width:18,color:e.regularIconColor,fill:"currentColor"},copyLinkIcon:{height:15,width:15,color:e.regularIconColor,fill:"currentColor"},openLinkIcon:{height:15,width:15,color:e.regularIconColor,fill:"currentColor",transform:"rotate(-45deg)"}})),[]);const a={key:"actions",render:e=>(0,r.jsx)(he.Z,{...e}),items:[{key:"copy-link",render:e=>(0,r.jsx)(ue.Z,{...e,icon:(0,gn.N)(n.copyLinkIcon),title:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.copyLink",defaultMessage:"Copy link to page"})}),action:async function(){const e=(0,fn.ZP)({store:t,pageVisitSource:mn.tY.CopyLink});await $t.RD({environment:s,stringValue:e,copiedMessage:$t.tq.copiedLinkToClipboard}),i.setState({open:!1})}},{key:"open-page-in-new-tab",render:e=>(0,r.jsx)(ue.Z,{...e,icon:(0,gc.n)(n.openLinkIcon),title:(0,r.jsx)(g.FormattedMessage,{id:"adminContentSearchTab.pagesTable.page.actions.openLink",defaultMessage:"Open in new tab"})}),action:function(){const e=(0,fn.ZP)({store:t,pageVisitSource:mn.tY.LinkInPage});S.navigateToExternalURL({environment:s,url:e}),i.setState({open:!1})}}]};return(0,r.jsx)(Mn.ZP,{popupType:ge.kQ.Popup,alignmentToOrigin:ge.ZP.Alignment.Center,placementToOrigin:ge.ZP.Placement.Right,style:{width:248},render:()=>(0,r.jsx)(me.Z,{menuType:ye.og.Popup,width:248,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:void 0,sections:[a]})}),buttonPopupStore:i,renderOrigin:e=>(0,r.jsx)(wn.Z,{icon:pn.o,...e})})}const Im=(0,g.defineMessages)({views:{id:"workspaceAnalytics.contentTab.contentTable.viewsColumn.tooltip",defaultMessage:"Number of times users have viewed the page"},uniqueViews:{id:"workspaceAnalytics.contentTab.contentTable.uniqueViewsColumn.tooltip",defaultMessage:"Total number of users that have viewed page in the selected period"}}),Pm={id:"page",headerTitle:(0,r.jsx)(Em,{message:ps.y3.page}),renderCell:e=>(0,r.jsx)(Gi.o,{blockStore:e.navigableBlockStore,rightIcon:(0,r.jsx)(Tm,{blockStore:e.navigableBlockStore})}),widthData:{width:320,maxWidth:320},sortable:!1},Zm={id:"location",headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.allPages.table.location.name",defaultMessage:"Location"}),renderCell:e=>(0,r.jsx)(un,{blockStore:e.navigableBlockStore,teamStore:e.teamStore}),widthData:{width:140},sortable:!1},Fm={id:"audience",headerTitle:(0,r.jsx)(Em,{message:ps.y3.audience}),renderCell:e=>(0,r.jsx)(It.Z,{children:ln(e.audience)}),widthData:{width:140},sortable:!1},Am={id:"views",headerTitle:(0,r.jsx)(_m,{tooltipMessageDescriptor:Im.views,columnHeader:ps.y3.allViews}),renderCell:e=>(0,r.jsx)(It.Z,{children:e.views.toLocaleString()}),widthData:{width:100},sortable:!0},Dm={id:"uniqueViews",headerTitle:(0,r.jsx)(_m,{tooltipMessageDescriptor:Im.uniqueViews,columnHeader:ps.y3.uniqueViews}),renderCell:e=>(0,r.jsx)(It.Z,{children:e.uniqueViews.toLocaleString()}),widthData:{width:100},sortable:!0},Bm={id:"createdBy",headerTitle:(0,r.jsx)(Em,{message:ps.y3.createdBy}),renderCell:e=>e.createdById?(0,r.jsx)(qn,{blockStore:e.navigableBlockStore,userIds:[e.createdById]}):null,widthData:{width:140},sortable:!1},Rm={id:"createdTime",headerTitle:(0,r.jsx)(Em,{message:ps.y3.createdAt}),renderCell:e=>(0,r.jsx)(Hi.T,{dateTs:e.createdTime}),widthData:{width:100},sortable:!1},Lm=[Pm,Am,Dm,Zm,Fm,{id:"lastEditedBy",headerTitle:(0,r.jsx)(Em,{message:ps.y3.lastEditedBy}),renderCell:e=>e.lastEditedById?(0,r.jsx)(qn,{blockStore:e.navigableBlockStore,userIds:[e.lastEditedById]}):null,widthData:{width:140},sortable:!1},{id:"lastEditedTime",headerTitle:(0,r.jsx)(Em,{message:ps.y3.lastEditedAt}),renderCell:e=>(0,r.jsx)(Hi.T,{dateTs:e.lastEditedTime}),widthData:{width:100},sortable:!1},Bm,Rm];function Nm(e){let{navigableBlockStores:t,analyticsByPageId:s,runNewSearch:n,sort:a,setSort:o,loadNextPage:l,loading:d,error:c}=e;window.__c={n:"ContentAnalyticsTable"};const u=(0,N.VK)((()=>t.map((e=>{var t,i,n;return{id:e.id,isClickable:!1,navigableBlockStore:e,teamStore:(0,zi.VP)(e),views:(null===(t=s.get(e.id))||void 0===t?void 0:t.pageViews)||0,uniqueViews:(null===(i=s.get(e.id))||void 0===i?void 0:i.uniquePageViews)||0,createdTime:e.getCreatedTime(),lastEditedTime:e.getLastEditedTime(),createdById:e.getCreatedById(),lastEditedById:e.getLastEditedById(),audience:(null===(n=s.get(e.id))||void 0===n?void 0:n.audience)||"private"}}))),[t,s]),m=(0,i.useMemo)((()=>function(e){const t=Lm.find((t=>"pageViews"===e.field&&"views"===t.id||"uniquePageViews"===e.field&&"uniqueViews"===t.id));return t?{column:t,sortAscending:"asc"===e.direction}:void 0}(a)),[a]),p=(0,lt.yK)((e=>(0,Xt.b)({columnRenderInfo:Lm,theme:e,containerMarginTop:0})),[]),h=(0,lt.yK)((e=>({emptyQuery:{marginTop:15,marginBottom:40,textAlign:"center"},loadingSpinner:{margin:"24px auto 24px"}})),[]);return c?(0,r.jsx)($i,{error:c,runNewSearch:n}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Xt.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:Lm,rows:u,sortState:m,onSortStateChanged:e=>{o(function(e){const t="views"===e.column.id?"pageViews":"uniquePageViews",s=e.sortAscending?"asc":"desc";return{field:t,direction:s}}(e))},onScrollBottom:l,renderNoRowsComponent:()=>(0,r.jsx)(It.Z,{isSmall:!0,style:h.emptyQuery,children:!d&&0===t.length&&(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.allPages.table.empty",defaultMessage:"No pages found with your query."})}),styles:p}),d?(0,r.jsx)(Ki.Z,{style:h.loadingSpinner}):null]})}function Em(e){let{message:t}=e;window.__c={n:"FormatDefinedMessage"};const s=(0,g.useIntl)();return(0,r.jsx)(r.Fragment,{children:s.formatMessage(t)})}const Om={query:"",createdBy:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},teamIds:[]},Vm={field:"pageViews",direction:"desc"},Um=rm,Wm={filters:Om,sort:Vm,timeRange:Um,navigableBlockStores:[],analyticsByPageId:new Map,numPagesLoaded:0,paginationToken:void 0,hasNextPage:!0,loading:!1,error:void 0,shouldReRunSearch:!1};const zm=(0,g.defineMessages)({placeholder:{id:"settings.workspaceAnalytics.contentTab.placeholder",defaultMessage:"Search by title"}});function Km(e){let{spaceStore:t,timeRange:s,filters:i,runNewSearch:n,setFilters:a,setTimeRange:o}=e;window.__c={n:"SearchInputsSection"};const l=(0,N.VK)((()=>pc.Z.state.teams),[]),d=(0,lt.yK)((e=>({container:{width:"100%",margin:"0 auto 14px"},filterPillsContainer:{width:"100%",display:"flex",flexWrap:"wrap",rowGap:4,flexDirectionRow:"row",alignItems:"center"},timeRangeContainer:{display:"flex",flexDirectionRow:"row",alignItems:"center",justifyContent:"center",gap:4,borderRight:`1px solid ${e.tableDividerColor}`,marginRight:12,paddingRight:6}})),[]);return(0,r.jsxs)("div",{style:d.container,children:[(0,r.jsx)(ja,{mode:Ma.OnChange,query:i.query,setQueryFilter:function(e){a({query:e},{runSearchAfter:!0})},placeholderText:$.default.formatMessage(zm.placeholder)}),(0,r.jsxs)("div",{style:d.filterPillsContainer,children:[(0,r.jsxs)("div",{style:d.timeRangeContainer,children:[(0,r.jsx)(It.Z,{isSecondaryColor:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.timeRange",defaultMessage:"Views from"})}),(0,r.jsx)(jm.f,{currentFilter:s,onChangeFilter:o})]}),(0,r.jsx)(_a,{selectedTeamIds:i.teamIds,setSelectedTeamIds:function(e){a({teamIds:e})},onMenuClose:n,teamStores:l}),(0,r.jsx)(ga,{spaceStore:t,createdByFilterIds:i.createdBy,setCreatedByFilter:function(e){a({createdBy:e})},runNewSearch:n,includeGuests:!1}),(0,r.jsx)(va,{lastEditedTime:i.lastEditedTime,createdTime:i.createdTime,setLastEditedTime:function(e){a({lastEditedTime:e,createdTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})},setCreatedOnTime:function(e){a({createdTime:e,lastEditedTime:{starting:void 0,ending:void 0}},{runSearchAfter:!0})}})]})]})}function Hm(e){var t;let{spaceStore:s,contentEngagement:n}=e;window.__c={n:"SpaceAnalyticsContentTab"};const a=(0,i.useRef)(!1),{loadNextPage:o,navigableBlockStores:l,analyticsByPageId:c,runNewSearch:u,setFilters:m,setTimeRange:p,timeRange:g,filters:h,sort:f,setSort:v,loading:x,error:S}=function(e){let{spaceStore:t}=e;const s=(0,L.O7)(),[n,a]=(0,i.useState)(Wm),o=(0,i.useRef)(Om),r=(0,i.useRef)(Vm),l=(0,i.useRef)(Um),c=(0,i.useCallback)((async e=>{let{fetchFromFirstPage:i,ignoreSearchInputComparison:c}=e;const u=!d.Xy(n.filters,o.current)||!d.Xy(n.sort,r.current)||!d.Xy(n.timeRange,l.current);if(!c&&!u)return;o.current=n.filters,r.current=n.sort,l.current=n.timeRange;let m=n.loading,p=n.error,g=n.hasNextPage,h=n.paginationToken;if(i&&(a((e=>({...Wm,filters:e.filters,timeRange:e.timeRange,sort:e.sort}))),m=Wm.loading,p=Wm.error,g=Wm.hasNextPage,h=Wm.paginationToken),!g||m)return;if(p)return;a((e=>({...e,loading:!0})));const f=await w.loadContentAnalytics(s,{spaceId:t.id,sort:n.sort,titleQuery:n.filters.query,filters:{inTeams:n.filters.teamIds,lastEditedTime:(0,X.Hq)(n.filters.lastEditedTime),createdTime:(0,X.Hq)(n.filters.createdTime),createdBy:n.filters.createdBy},timeRange:n.timeRange,startCursor:h});if("failed"===f.type)return void a((e=>({...e,loading:!1,error:f.error})));const y=f.data.results;a((e=>{const t=[],i=new Map(e.analyticsByPageId),n=new Set(e.navigableBlockStores.map((e=>e.id)));for(const o of y){const e=o.id,a=o.analytics;if(!n.has(e)){const n=new nt.G(s,{table:ds.iU,id:e});t.push(n),i.set(e,a)}}const a=[...e.navigableBlockStores,...t];return{...e,navigableBlockStores:a,analyticsByPageId:i,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:f.data.nextCursor,hasNextPage:Boolean(f.data.nextCursor)}}))}),[s,t,n.filters,n.sort,n.timeRange,n.loading,n.error,n.hasNextPage,n.paginationToken]);(0,i.useEffect)((()=>{n.shouldReRunSearch&&(a((e=>({...e,shouldReRunSearch:!1}))),c({fetchFromFirstPage:!0,ignoreSearchInputComparison:!1}))}),[n.shouldReRunSearch,c]);const u=(0,i.useCallback)((async()=>{n.shouldReRunSearch||await c({fetchFromFirstPage:!1,ignoreSearchInputComparison:!0})}),[n.shouldReRunSearch,c]),m=(0,i.useCallback)((async e=>{await c({fetchFromFirstPage:!0,ignoreSearchInputComparison:e||!1})}),[c]),p=(0,i.useCallback)(((e,t)=>{a((s=>({...s,filters:{...s.filters,...e},...null!=t&&t.runSearchAfter?{shouldReRunSearch:null==t?void 0:t.runSearchAfter}:void 0})));for(const i of(0,_.Yd)(e))d.Xy(e[i],Om[i])||y.uSc(s,{filter:i,value:"createdBy"===i||"teamIds"===i?e[i]:void 0})}),[s]),g=(0,i.useCallback)((e=>{a((t=>({...t,timeRange:e,shouldReRunSearch:!0}))),y.e2(s,{daysFilter:e})}),[s]),h=(0,i.useCallback)((e=>{a((t=>({...t,sort:e,shouldReRunSearch:!0}))),y.jMN(s,{column:e.field,isAscending:"asc"===e.direction})}),[s]);return{...n,loadNextPage:u,runNewSearch:m,setFilters:p,setTimeRange:g,setSort:h}}({spaceStore:s}),b=(0,lt.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:16}})),[]),M=(0,N.VK)((()=>Boolean(s.canAdmin())),[s]);(0,i.useEffect)((()=>{a.current||(u(!0),a.current=!0)}),[u]);const j=(0,N.VK)((()=>s.getName()),[s]);return"NotFoundError"===(null==n||null===(t=n.error)||void 0===t?void 0:t.name)?(0,r.jsx)(vm,{type:"empty",spaceName:j}):(0,r.jsxs)("div",{style:b.container,children:[(0,r.jsx)(km,{data:n.data,loading:n.loading,error:n.error,daysFilter:n.daysFilter,setDaysFilter:n.setDaysFilter}),(0,r.jsx)(Gm,{canAdmin:M,daysFilter:g}),(0,r.jsx)(Km,{spaceStore:s,runNewSearch:u,setFilters:m,filters:h,timeRange:g,setTimeRange:p}),(0,r.jsx)(Nm,{navigableBlockStores:l,analyticsByPageId:c,runNewSearch:u,sort:f,setSort:v,loadNextPage:o,loading:x,error:S})]})}function Gm(e){window.__c={n:"ContentTableHeader"};const t=(0,lt.yK)((()=>({sectionTitle:{fontWeight:p.Z.fontWeight.semibold,fontSize:16},sectionTitleSection:{display:"flex",flexFlow:"row",alignItems:"center"},helpInfo:{marginLeft:4},wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:12},exportButton:{marginLeft:5}})),[]),{canAdmin:s,daysFilter:i}=e,n=(0,r.jsxs)("div",{style:t.sectionTitleSection,children:[(0,r.jsx)(It.Z,{style:t.sectionTitle,children:(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.allPages.title",defaultMessage:"Pages"})}),(0,r.jsx)(fe.Z,{placement:fe.Z.Placement.Bottom,render:e=>(0,r.jsx)(ml.Z,{...e,href:(0,yi.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:t.helpInfo}),renderTooltip:()=>"all_time"!==i?(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.pages.tooltip.lastDays",defaultMessage:"Activity from the {dateRange} on pages you have access to",values:{dateRange:$.default.formatMessage(ps.xX[i])}}):(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.contentTab.pages.tooltip.allTime",defaultMessage:"All time activity on pages you have access to in the workspace"})})]});return(0,r.jsxs)("div",{style:t.wrapper,children:[n,s&&(0,r.jsx)(gm,{style:t.exportButton,analyticsType:ji.Content})]})}var qm=s(50780);const Ym=(0,o.I)("personCircle",{viewBox:"0 0 18 17",svg:(0,r.jsx)("path",{d:"M8.99219 16.6797C10.0964 16.6797 11.1354 16.4688 12.1094 16.0469C13.0833 15.6302 13.9427 15.0495 14.6875 14.3047C15.4323 13.5599 16.0156 12.7005 16.4375 11.7266C16.8594 10.7526 17.0703 9.71354 17.0703 8.60938C17.0703 7.50521 16.8594 6.46615 16.4375 5.49219C16.0156 4.51823 15.4323 3.66146 14.6875 2.92188C13.9427 2.17708 13.0833 1.59375 12.1094 1.17188C11.1354 0.75 10.0938 0.539062 8.98438 0.539062C7.88021 0.539062 6.84115 0.75 5.86719 1.17188C4.89844 1.59375 4.04167 2.17708 3.29688 2.92188C2.55729 3.66146 1.97656 4.51823 1.55469 5.49219C1.13281 6.46615 0.921875 7.50521 0.921875 8.60938C0.921875 9.71354 1.13281 10.7526 1.55469 11.7266C1.97656 12.7005 2.55729 13.5599 3.29688 14.3047C4.04167 15.0495 4.90104 15.6302 5.875 16.0469C6.84896 16.4688 7.88802 16.6797 8.99219 16.6797ZM8.99219 15.0859C8.09635 15.0859 7.25521 14.9193 6.46875 14.5859C5.6875 14.2526 5 13.7891 4.40625 13.1953C3.81771 12.6016 3.35677 11.9141 3.02344 11.1328C2.6901 10.3516 2.52344 9.51042 2.52344 8.60938C2.52344 7.71354 2.6901 6.875 3.02344 6.09375C3.35677 5.30729 3.81771 4.61719 4.40625 4.02344C4.99479 3.42969 5.67969 2.96615 6.46094 2.63281C7.2474 2.29948 8.08854 2.13281 8.98438 2.13281C9.88542 2.13281 10.7266 2.29948 11.5078 2.63281C12.2943 2.96615 12.9844 3.42969 13.5781 4.02344C14.1719 4.61719 14.6354 5.30729 14.9688 6.09375C15.3021 6.875 15.4688 7.71354 15.4688 8.60938C15.4688 9.51042 15.3021 10.3516 14.9688 11.1328C14.6354 11.9141 14.1719 12.6016 13.5781 13.1953C12.9844 13.7891 12.2969 14.2526 11.5156 14.5859C10.7344 14.9193 9.89323 15.0859 8.99219 15.0859ZM14.2031 13.7656L14.1719 13.6328C14.0052 13.2474 13.6849 12.8776 13.2109 12.5234C12.7422 12.1641 12.1484 11.8724 11.4297 11.6484C10.7161 11.4193 9.90365 11.3047 8.99219 11.3047C8.09115 11.3047 7.28125 11.4193 6.5625 11.6484C5.84375 11.8724 5.2474 12.1641 4.77344 12.5234C4.30469 12.8776 3.98698 13.2448 3.82031 13.625L3.78906 13.7656C4.27865 14.2188 4.83333 14.599 5.45312 14.9062C6.07292 15.2188 6.69271 15.4557 7.3125 15.6172C7.9375 15.7786 8.4974 15.8594 8.99219 15.8594C9.49219 15.8594 10.0521 15.7786 10.6719 15.6172C11.2917 15.4557 11.9115 15.2188 12.5312 14.9062C13.151 14.599 13.7083 14.2188 14.2031 13.7656ZM8.99219 10.0156C9.4974 10.0208 9.95312 9.89583 10.3594 9.64062C10.7656 9.38021 11.0885 9.02604 11.3281 8.57812C11.5677 8.125 11.6875 7.61979 11.6875 7.0625C11.6875 6.54167 11.5651 6.0625 11.3203 5.625C11.0807 5.18229 10.7578 4.82812 10.3516 4.5625C9.95052 4.29688 9.4974 4.16406 8.99219 4.16406C8.49219 4.16406 8.03646 4.29688 7.625 4.5625C7.21875 4.82812 6.89583 5.18229 6.65625 5.625C6.41667 6.0625 6.29948 6.54167 6.30469 7.0625C6.3099 7.61979 6.42969 8.1224 6.66406 8.57031C6.90365 9.01302 7.22656 9.36458 7.63281 9.625C8.03906 9.88021 8.49219 10.0104 8.99219 10.0156Z"})});var Qm=s(76798);function $m(e){let{title:t,items:s,loading:i,error:n}=e;window.__c={n:"AnalyticsCardList"};const a=(0,lt.yK)((e=>({title:{fontWeight:p.Z.fontWeight.semibold,marginBottom:8},container:{flex:1,display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start",height:"100%",border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,padding:12}})),[]);return(0,r.jsxs)("div",{style:a.container,children:[(0,r.jsx)(It.Z,{style:a.title,children:t}),i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Jm,{}),(0,r.jsx)(Jm,{}),(0,r.jsx)(Jm,{}),(0,r.jsx)(Jm,{}),(0,r.jsx)(Jm,{})]}):n?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(ep,{})}):s.map(((e,t)=>(0,r.jsx)(Xm,{item:e},t)))]})}function Xm(e){let{item:t}=e;window.__c={n:"CardListItem"};const{store:s,caption:i}=t,n=(0,g.useIntl)(),a=tp(),o=(0,N.VK)((()=>{switch(s.table){case"block":return(0,r.jsxs)("div",{style:a.nameAndIconContainer,children:[(0,r.jsx)(Zn.Z,{icon:s.getIcon(),size:18,isEmptyPage:!1,disabled:!0}),(0,r.jsx)(Qm.Z,{store:s})]});case"notion_user":return(0,r.jsxs)("div",{style:a.nameAndIconContainer,children:[(0,r.jsx)(Un.Z,{userStore:s,size:18}),(0,r.jsx)(It.Z,{children:s.getDisplayName(n)})]});case"team":const e=s.getName();return(0,r.jsxs)("div",{style:a.nameAndIconContainer,children:[(0,r.jsx)(Bn.p,{disabled:!0,store:s,size:20}),(0,r.jsx)(It.Z,{children:e})]});default:(0,_.t1)(s)}}),[s,a.nameAndIconContainer,n]);return(0,r.jsxs)("div",{style:a.container,children:[(0,r.jsx)(It.Z,{style:a.label,children:o}),(0,r.jsx)("div",{style:a.caption,children:(0,r.jsx)(It.Z,{isSecondaryColor:!0,isSmall:!0,children:i})})]})}function Jm(){window.__c={n:"LoadingCardListItem"};const e=tp();return(0,r.jsxs)("div",{style:e.container,children:[(0,r.jsx)(It.Z,{style:e.label,children:(0,r.jsx)(qt.Z,{paragraphs:[{lineHeight:14,lineMargin:3,sectionWidths:[80],repeat:0,sectionMargin:2}]})}),(0,r.jsx)("div",{style:e.loadingCaption,children:(0,r.jsx)(qt.Z,{paragraphs:[{lineHeight:14,lineMargin:3,sectionWidths:[80],repeat:0,sectionMargin:2}]})})]})}function ep(){window.__c={n:"ErrorCardListItem"};const e=tp();return(0,r.jsx)("div",{style:e.container,children:(0,r.jsx)(It.Z,{style:e.errorLabel,children:(0,r.jsx)(g.FormattedMessage,{id:"spaceAnalytics.basicErrorMessage",defaultMessage:"Something went wrong.{br}Try refreshing the page.",values:{br:(0,r.jsx)("br",{})}})})})}function tp(){return(0,lt.yK)((e=>({container:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingBlock:4,gap:4},nameAndIconContainer:{display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:8,alignItems:"center",width:"100%"},label:{width:"100%"},caption:{display:"flex",justifyContent:"center",alignItems:"center"},loadingCaption:{display:"block",width:"50%"},errorLabel:{width:"100%",textAlign:"center",color:mt.ZP.red}})),[])}function sp(e){let{data:t,loading:s,error:n,daysFilter:a,setDaysFilter:o}=e;window.__c={n:"ContentEngagement"};const l=(0,L.O7)(),d=(0,lt.yK)((e=>({title:{fontWeight:p.Z.fontWeight.medium,fontSize:16,marginBlock:"9px 4px",display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},overviewCard:{width:"fit-content"}})),[]),[c,u]=(0,bm.e)(),{pageViews:m,uniquePageViews:h,pageEdits:f,topPages:v}=t,x=(0,N.VK)((()=>v.map((e=>{let{pageId:t,pageViews:s}=e;return{store:new nt.G(l,{id:t,table:ds.iU}),caption:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.caption.pageView",defaultMessage:"{pageViews} views",values:{pageViews:(0,r.jsx)(Mm,{abbreviateNumber:!1,num:s})}})}}))),[l,v]),S=(0,i.useCallback)((e=>{o(e),y.m0A(l,{filter:"content_engagement",daysFilter:e})}),[l,o]);return(0,r.jsxs)("div",{style:d.container,ref:c,children:[(0,r.jsxs)("div",{style:d.titleContainer,children:[(0,r.jsxs)(It.Z,{style:d.title,children:[(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.title",defaultMessage:"Content engagement"}),(0,r.jsx)(fe.Z,{placement:ns.u.Bottom,render:e=>(0,r.jsx)(ml.Z,{...e,href:(0,yi.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:d.helpInfo}),renderTooltip:()=>"all_time"!==a?(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.lastDays",defaultMessage:"Activity on all pages in the workspace over the {dateRange}",values:{dateRange:$.default.formatMessage(ps.xX[a])}}):(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.overviewTab.contentEngagement.tooltip.allTime",defaultMessage:"All time activity on all pages in the workspace"})})]}),(0,r.jsx)(jm.f,{currentFilter:a,onChangeFilter:S})]}),(0,r.jsxs)(gd.rj,{gap:16,children:[(0,r.jsx)(gd.r8,{row:1,col:1,colEnd:3,children:(0,r.jsx)(wm,{loading:s,error:n,icon:xm.N,textStyles:d.overviewCard,title:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.views",defaultMessage:"{pageViews} total views",values:{pageViews:(0,r.jsx)(Mm,{abbreviateNumber:u<640,num:m})}})})}),(0,r.jsx)(gd.r8,{row:2,col:1,colEnd:3,children:(0,r.jsx)(wm,{loading:s,error:n,icon:Ym,textStyles:d.overviewCard,iconStyles:{height:18,width:18},title:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.uniqueViews",defaultMessage:"{uniquePageViews} unique page views",values:{uniquePageViews:(0,r.jsx)(Mm,{abbreviateNumber:u<640,num:h})}})})}),(0,r.jsx)(gd.r8,{row:3,col:1,colEnd:3,children:(0,r.jsx)(wm,{loading:s,error:n,icon:qm.E,textStyles:d.overviewCard,iconStyles:{height:18,width:18},title:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.pageEdits",defaultMessage:"{pageEdits} edits",values:{pageEdits:(0,r.jsx)(Mm,{abbreviateNumber:u<640,num:f})}})})}),(0,r.jsx)(gd.r8,{row:1,rowEnd:4,col:3,colEnd:5,children:(0,r.jsx)($m,{loading:s,error:n,title:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.contentEngagement.popularPages",defaultMessage:"Most popular pages"}),items:x})})]})]})}var ip=s(9999);function np(e){let{data:t,loading:s,error:n,daysFilter:a,setDaysFilter:o}=e;window.__c={n:"UserEngagement"};const l=(0,L.O7)(),{activeMembersCount:d,previousActiveMembersCount:c,activeGuestsCount:u,previousActiveGuestsCount:m,topTeamspaces:h,topViewers:f,topEditors:v}=t,x=(0,lt.yK)((e=>({title:{fontWeight:p.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},container:{display:"flex",flexDirection:"column",gap:16},summaryCard:{height:70},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16}})),[]),[S,b]=(0,bm.e)(),M=(0,i.useCallback)((e=>{y.m0A(l,{filter:"user_engagement",daysFilter:e}),o(e)}),[l,o]),w=(0,N.VK)((()=>h.map((e=>{let{teamspaceId:t,pageViews:s}=e;return{store:new nt.zX(l,{id:t,table:ms.e0}),caption:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageViews",defaultMessage:"{pageViews} views",values:{pageViews:(0,r.jsx)(Mm,{abbreviateNumber:!0,num:s})}})}})).filter((e=>e.store.canRead())).slice(0,5)),[l,h]),j=(0,N.VK)((()=>f.map((e=>{let{userId:t,pageViews:s}=e;return{store:new nt.U6(l,{id:t,table:q.KJ}),caption:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageView",defaultMessage:"{pageViews} views",values:{pageViews:(0,r.jsx)(Mm,{abbreviateNumber:!0,num:s})}})}})).slice(0,5)),[l,f]),C=(0,N.VK)((()=>v.map((e=>{let{userId:t,pageEdits:s}=e;return{store:new nt.U6(l,{id:t,table:q.KJ}),caption:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.caption.pageEdits",defaultMessage:"{pageEdits} edits",values:{pageEdits:(0,r.jsx)(Mm,{abbreviateNumber:!0,num:s})}})}})).slice(0,5)),[l,v]);return(0,r.jsxs)("div",{style:x.container,ref:S,children:[(0,r.jsxs)("div",{style:x.titleContainer,children:[(0,r.jsxs)(It.Z,{style:x.title,children:[(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.title",defaultMessage:"User engagement"}),(0,r.jsx)(fe.Z,{placement:ns.u.Bottom,render:e=>(0,r.jsx)(ml.Z,{...e,href:(0,yi.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:x.helpInfo}),renderTooltip:()=>"all_time"!==a?(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.overviewTab.userEngagement.tooltip.lastDays",defaultMessage:"Active members and guests have viewed at least one page within the {dateRange}",values:{dateRange:$.default.formatMessage(ps.xX[a])}}):(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.overviewTab.userEngagement.tooltip.allTime",defaultMessage:"Active members and guests have viewed at least one page in the workspace"})})]}),(0,r.jsx)(jm.f,{currentFilter:a,onChangeFilter:M})]}),(0,r.jsxs)(gd.rj,{gap:16,children:[(0,r.jsx)(gd.r8,{row:1,col:1,children:(0,r.jsx)(wm,{style:x.summaryCard,loading:s,error:n,title:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeMembersCount",defaultMessage:"{activeMembersCount} active members",values:{activeMembersCount:(0,r.jsx)(Mm,{abbreviateNumber:b<640,num:d})}}),byline:void 0!==c?(0,r.jsx)(ap,{userType:"members",daysFilter:a,count:d,previousCount:c}):null})}),(0,r.jsx)(gd.r8,{row:1,col:2,children:(0,r.jsx)(wm,{style:x.summaryCard,loading:s,error:n,title:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeGuestsCount",defaultMessage:"{activeGuestsCount} active guests",values:{activeGuestsCount:(0,r.jsx)(Mm,{abbreviateNumber:b<640,num:u})}}),byline:void 0!==m?(0,r.jsx)(ap,{userType:"guests",daysFilter:a,count:u,previousCount:m}):null})})]}),(0,r.jsxs)(gd.rj,{gap:16,children:[(0,r.jsx)(gd.r8,{row:1,col:1,children:(0,r.jsx)($m,{loading:s,error:n,title:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeTeamspaces",defaultMessage:"Most active teamspaces"}),items:w})}),(0,r.jsx)(gd.r8,{row:1,col:2,children:(0,r.jsx)($m,{loading:s,error:n,title:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeViewers",defaultMessage:"Most active viewers"}),items:j})}),(0,r.jsx)(gd.r8,{row:1,col:3,children:(0,r.jsx)($m,{loading:s,error:n,title:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeEditors",defaultMessage:"Most active editors"}),items:C})})]})]})}function ap(e){let{userType:t,daysFilter:s,count:i,previousCount:n}=e;window.__c={n:"MetricsChangeMessage"};const a=0===i&&0===n?0:Math.round((i-n)/n*100);let o;o=a===1/0?function(e,t,s){if("all_time"===s)return(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.none",defaultMessage:"No changes yet"});return"guests"===e?(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.changeFromZero.summaryByline.guests.positive",defaultMessage:"{changeValue} more guests than previous {numberOfDays} days",values:{changeValue:t.toLocaleString(),numberOfDays:ps.ez[s].toLocaleString()}}):(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.changeFromZero.summaryByline.members.positive",defaultMessage:"{changeValue} more members than previous {numberOfDays} days",values:{changeValue:t.toLocaleString(),numberOfDays:ps.ez[s].toLocaleString()}})}(t,i,s):function(e,t){switch(t){case"all_time":return 0===e?(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.none",defaultMessage:"No changes yet"}):e>0?(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.positive",defaultMessage:"{changeInPercentage}% more since the start",values:{changeInPercentage:Math.abs(e)}}):(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.allTime.negative",defaultMessage:"{changeInPercentage}% less since the start",values:{changeInPercentage:Math.abs(e)}});case"last_90_days":return 0===e?(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.none",defaultMessage:"No changes in previous 90 days"}):e>0?(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.positive",defaultMessage:"{changeInPercentage}% more than previous 90 days",values:{changeInPercentage:Math.abs(e)}}):(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_90_days.negative",defaultMessage:"{changeInPercentage}% less than previous 90 days",values:{changeInPercentage:Math.abs(e)}});case"last_28_days":return 0===e?(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.none",defaultMessage:"No changes in previous 28 days"}):e>0?(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.positive",defaultMessage:"{changeInPercentage}% more than previous 28 days",values:{changeInPercentage:Math.abs(e)}}):(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_28_days.negative",defaultMessage:"{changeInPercentage}% less than previous 28 days",values:{changeInPercentage:Math.abs(e)}});case"last_7_days":return 0===e?(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.none",defaultMessage:"No changes in previous 7 days"}):e>0?(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.positive",defaultMessage:"{changeInPercentage}% more than previous 7 days",values:{changeInPercentage:Math.abs(e)}}):(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.summaryByline.last_7_days.negative",defaultMessage:"{changeInPercentage}% less than previous 7 days",values:{changeInPercentage:Math.abs(e)}});default:(0,_.t1)(t)}}(a,s);const l=a>0?(0,ip.J)({height:12,width:12,fill:"currentColor"}):a<0?(0,ip.J)({height:12,width:12,transform:"rotate(90deg)",fill:"currentColor"}):void 0,d=(0,lt.yK)((e=>({text:{color:a>0?e.accentColors.green[500]:a<0?e.accentColors.red[500]:e.lightTextColor,display:"flex",alignItems:"center",gap:4}})),[a]);return(0,r.jsxs)("span",{style:d.text,children:[l,o]})}function op(e){var t,s;let{onUserTabFilterChange:i,spaceStore:n,contentEngagement:a,userEngagement:o}=e;window.__c={n:"SpaceAnalyticsOverviewTab"};const l=(0,lt.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:24}})),[]),d=(0,N.VK)((()=>n.getName()),[n]);if("NotFoundError"===(null===(t=a.error)||void 0===t?void 0:t.name)||"NotFoundError"===(null===(s=o.error)||void 0===s?void 0:s.name))return(0,r.jsx)(vm,{type:"empty",spaceName:d});return(0,r.jsxs)("div",{style:l.container,children:[(0,r.jsx)(np,{data:o.data,loading:o.loading,error:o.error,daysFilter:o.daysFilter,setDaysFilter:function(e){i({graphFilter:"all_time"===e?"last_90_days":e}),o.setDaysFilter(e)}}),(0,r.jsx)(sp,{data:a.data,loading:a.loading,error:a.error,daysFilter:a.daysFilter,setDaysFilter:a.setDaysFilter})]})}const rp={field:"num_searches",direction:"desc"},lp=rm,dp={sort:rp,timeRange:lp,searchAnalyticsDataList:[],numPagesLoaded:0,paginationToken:void 0,hasNextPage:!0,loading:!1,error:void 0,shouldReRunSearch:!1};const cp=(0,g.defineMessages)({numSearches:{id:"workspaceAnalytics.searchTab.searchTable.searches.tooltip",defaultMessage:"Number of times users in the workspace have searched the query"},numUniqueUsers:{id:"workspaceAnalytics.searchTab.searchTable.uniqueSearches.tooltip",defaultMessage:"Total number of users that have searched the query"},ctr:{id:"workspaceAnalytics.searchTab.searchTable.ctr.tooltip",defaultMessage:"Percentage of times users have opened page from results of this query"}}),up=(0,g.defineMessages)({queryText:{id:"spaceAnalyticsSearchTable.column.query",defaultMessage:"Query"},numSearches:{id:"spaceAnalyticsSearchTable.column.searches",defaultMessage:"Searches"},numUniqueUsers:{id:"spaceAnalyticsSearchTable.column.uniqueSearches",defaultMessage:"Unique searches"},ctr:{id:"spaceAnalyticsSearchTable.column.ctr",defaultMessage:"Click-through rate"}}),mp={queryText:{id:"queryText",headerTitle:$.default.formatMessage(up.queryText),renderCell:e=>(0,r.jsx)(It.Z,{children:e.queryText}),widthData:{width:200,maxWidth:300},sortable:!1},numSearches:{id:"numSearches",headerTitle:(0,r.jsx)(_m,{tooltipMessageDescriptor:cp.numSearches,columnHeader:up.numSearches}),renderCell:e=>(0,r.jsx)(hp,{value:e.numSearches}),widthData:{width:120,maxWidth:120},sortable:!0},numUniqueUsers:{id:"numUniqueUsers",headerTitle:(0,r.jsx)(_m,{tooltipMessageDescriptor:cp.numUniqueUsers,columnHeader:up.numUniqueUsers}),renderCell:e=>(0,r.jsx)(hp,{value:e.numUniqueUsers}),widthData:{width:120,maxWidth:120},sortable:!0},ctr:{id:"ctr",headerTitle:(0,r.jsx)(_m,{tooltipMessageDescriptor:cp.ctr,columnHeader:up.ctr}),renderCell:e=>(0,r.jsx)(hp,{value:Math.round(1e3*e.ctr)/1e3,isPercentage:!0}),widthData:{width:120,maxWidth:120},sortable:!0}},pp=(0,_.Yd)(mp).map((e=>mp[e]));function gp(e){let{searchAnalyticsDataList:t,runNewSearch:s,sort:n,setSort:a,loadNextPage:o,loading:l,error:d}=e;window.__c={n:"SpaceAnalyticsTable"};const c=(0,N.VK)((()=>t.map((e=>({id:e.queryText,isClickable:!1,...e})))),[t]),u=(0,i.useMemo)((()=>function(e){const t=ps.Fi[e.field];if(!t)return;return{column:mp[t],sortAscending:"asc"===e.direction}}(n)),[n]),m=(0,lt.yK)((e=>(0,Xt.b)({columnRenderInfo:pp,theme:e,containerMarginTop:0})),[]),p=(0,lt.yK)((e=>({emptyQuery:{marginTop:15,marginBottom:40,textAlign:"center"},loadingSpinner:{margin:"24px auto 24px"}})),[]);return d?(0,r.jsx)($i,{error:d,runNewSearch:s}):(0,r.jsxs)("div",{children:[(0,r.jsx)(Xt.D,{hideHeaderRowPadding:!0,allowHorizontalScroll:!0,setStickyHeaderRow:!0,maxHeight:500,columnRenderInfo:pp,rows:c,sortState:u,onSortStateChanged:e=>{a(function(e){const t=ps.hx[e.column.id],s=e.sortAscending?"asc":"desc";if(!t)return{field:"num_searches",direction:s};return{field:t,direction:s}}(e))},onScrollBottom:o,renderNoRowsComponent:()=>(0,r.jsx)(It.Z,{isSmall:!0,style:p.emptyQuery,children:!l&&0===t.length&&(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.searchTable.table.empty",defaultMessage:"No search query analytics to display."})}),styles:m}),l?(0,r.jsx)(Ki.Z,{style:p.loadingSpinner}):null]})}function hp(e){let{value:t,isPercentage:s}=e;window.__c={n:"CenteredNumericCell"};const i=(0,lt.yK)((e=>({centered:{width:"100%",textAlign:"center"}})),[]),n=s?`${t}%`:t;return(0,r.jsx)(It.Z,{style:i.centered,children:n})}function fp(e){window.__c={n:"SpaceAnalyticsSearchTab"};const{spaceStore:t}=e,s=(0,lt.yK)((()=>({header:{display:"flex",width:"100%",justifyContent:"space-between",alignItems:"center",marginBottom:16},sectionTitle:{fontWeight:p.Z.fontWeight.semibold,fontSize:16,display:"flex",alignItems:"center"},helpInfo:{marginLeft:4}})),[]),n=(0,i.useRef)(!1),{searchAnalyticsDataList:a,timeRange:o,sort:l,loading:c,error:u,loadNextPage:m,runNewSearch:h,setTimeRange:f,setSort:v}=function(e){let{spaceStore:t}=e;const s=(0,L.O7)(),[n,a]=(0,i.useState)(dp),o=(0,i.useRef)(rp),r=(0,i.useRef)(lp),l=(0,g.useIntl)(),c=(0,i.useCallback)((async e=>{let{fetchFromFirstPage:i,ignoreSearchInputComparison:l}=e;const c=!d.Xy(n.sort,o.current)||!d.Xy(n.timeRange,r.current);if(!l&&!c)return;o.current=n.sort,r.current=n.timeRange;let u=n.loading,m=n.error,p=n.hasNextPage,g=n.paginationToken;if(i&&(a((e=>({...dp,timeRange:e.timeRange,sort:e.sort}))),u=dp.loading,m=dp.error,p=dp.hasNextPage,g=dp.paginationToken),!p||u)return;if(m)return;a((e=>({...e,loading:!0})));const h=await w.loadSearchAnalytics(s,{spaceId:t.id,sort:n.sort,timeRange:n.timeRange,startCursor:g});if("failed"===h.type)return void a((e=>({...e,loading:!1,error:h})));const f=h.data.results;a((e=>{const t=[],s=new Set(e.searchAnalyticsDataList.map((e=>e.queryText)));for(const n of f){const e=n.queryText;s.has(e)||(t.push(n),s.add(e))}const i=[...e.searchAnalyticsDataList,...t];return{...e,searchAnalyticsDataList:i,loading:!1,error:void 0,numPagesLoaded:e.numPagesLoaded+1,paginationToken:h.data.nextCursor,hasNextPage:Boolean(h.data.nextCursor)}}))}),[s,t,n.sort,n.timeRange,n.loading,n.error,n.hasNextPage,n.paginationToken]);(0,i.useEffect)((()=>{n.shouldReRunSearch&&(a((e=>({...e,shouldReRunSearch:!1}))),c({fetchFromFirstPage:!0,ignoreSearchInputComparison:!1}))}),[n.shouldReRunSearch,c]);const u=(0,i.useCallback)((async()=>{n.shouldReRunSearch||await c({fetchFromFirstPage:!1,ignoreSearchInputComparison:!0})}),[n.shouldReRunSearch,c]),m=(0,i.useCallback)((async e=>{await c({fetchFromFirstPage:!0,ignoreSearchInputComparison:e||!1})}),[c]),p=(0,i.useCallback)((e=>{"all_time"!==e&&(a((t=>({...t,timeRange:e,shouldReRunSearch:!0}))),y.yef(s,{daysFilter:e}))}),[s]),h=(0,i.useCallback)((e=>{a((t=>({...t,sort:e,shouldReRunSearch:!0}))),y.$fF(s,{column:e.field,isAscending:"asc"===e.direction})}),[s]),f=(0,i.useMemo)((()=>{if(n.error)return new Error((0,Q.wf)(l,n.error))}),[n.error,l]);return{...n,error:f,loadNextPage:u,runNewSearch:m,setTimeRange:p,setSort:h}}({spaceStore:t});(0,i.useEffect)((()=>{n.current||(h(!0),n.current=!0)}),[h]);const x=(0,N.VK)((()=>t.getName()),[t]);return"NotFoundError"===(null==u?void 0:u.name)?(0,r.jsx)(vm,{type:"empty",spaceName:x}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:s.header,children:[(0,r.jsxs)(It.Z,{style:s.sectionTitle,children:[(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.searchTab.searchQueries.title",defaultMessage:"Search queries"}),(0,r.jsx)(fe.Z,{placement:fe.Z.Placement.Bottom,render:e=>(0,r.jsx)(ml.Z,{...e,href:(0,yi.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:s.helpInfo}),renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.searchTab.searchQueries.tooltip",defaultMessage:"Displays popular search queries in the workspace from the {dateRange}",values:{dateRange:$.default.formatMessage(ps.xX[o])}})})]}),(0,r.jsx)(jm.f,{currentFilter:o,onChangeFilter:f,hideAllTime:!0})]}),(0,r.jsx)(gp,{searchAnalyticsDataList:a,runNewSearch:h,sort:l,setSort:v,loadNextPage:m,loading:c,error:u})]})}var yp=s(30251);function vp(e){let{data:t,loading:s,error:i,daysFilter:n,setDaysFilter:a}=e;window.__c={n:"UsersAnalyticsSummaries"};const[o,l]=(0,bm.e)(),d=(0,lt.yK)((e=>({title:{fontWeight:p.Z.fontWeight.medium,fontSize:16,marginBlock:"8px 4px",display:"flex",alignItems:"center"},container:{display:"flex",flexDirection:"column",gap:16},helpInfo:{marginLeft:4},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},summaryCard:{height:70},cardContainer:{justifyContent:"flex-start",gap:18},cardTextContainer:{alignItems:"flex-start"}})),[]),{activeMembersCount:c,previousActiveMembersCount:u,activeGuestsCount:m,previousActiveGuestsCount:h}=t;return(0,r.jsxs)("div",{style:d.container,ref:o,children:[(0,r.jsxs)("div",{style:d.titleContainer,children:[(0,r.jsxs)(It.Z,{style:d.title,children:[(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userEngagement.title",defaultMessage:"User engagement"}),(0,r.jsx)(fe.Z,{placement:ns.u.Bottom,render:e=>(0,r.jsx)(ml.Z,{...e,href:(0,yi.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:d.helpInfo}),renderTooltip:()=>"all_time"!==n?(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userEngagement.tooltip.lastDays",defaultMessage:"Active members and guests have viewed at least one page within the {dateRange}",values:{dateRange:$.default.formatMessage(ps.xX[n])}}):(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userEngagement.tooltip.allTime",defaultMessage:"Active members and guests have viewed at least one page in the workspace"})})]}),(0,r.jsx)(jm.f,{currentFilter:n,onChangeFilter:a})]}),(0,r.jsxs)(gd.rj,{gap:16,children:[(0,r.jsx)(gd.r8,{row:1,col:1,children:(0,r.jsx)(wm,{style:d.summaryCard,loading:s,error:i,title:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeMembersCount",defaultMessage:"{activeMembersCount} active members",values:{activeMembersCount:(0,r.jsx)(Mm,{abbreviateNumber:l<640,num:c})}}),byline:void 0!==u?(0,r.jsx)(ap,{userType:"members",daysFilter:n,count:c,previousCount:u}):null})}),(0,r.jsx)(gd.r8,{row:1,col:2,children:(0,r.jsx)(wm,{style:d.summaryCard,loading:s,error:i,title:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.overview.userEngagement.activeGuestsCount",defaultMessage:"{activeGuestsCount} active guests",values:{activeGuestsCount:(0,r.jsx)(Mm,{abbreviateNumber:l<640,num:m})}}),byline:void 0!==h?(0,r.jsx)(ap,{userType:"guests",daysFilter:n,count:m,previousCount:h}):null})})]})]})}var xp=s(44643),Sp=s(88775);const bp=(0,g.defineMessages)({page_views:{id:"workspaceAnalytics.usersTab.usersTable.pageViews.tooltip",defaultMessage:"Total number of page views for the user across all pages in the workspace"},page_edits:{id:"workspaceAnalytics.usersTab.usersTable.pageEdits.tooltip",defaultMessage:"Total number of page edits for the user across all pages in the workspace"}}),Mp=(0,g.defineMessages)({user:{id:"spaceAnalyticsUsersTab.column.user",defaultMessage:"User"},page_views:{id:"spaceAnalyticsUsersTab.column.pageViews",defaultMessage:"Page views"},page_edits:{id:"spaceAnalyticsUsersTab.column.pageEdits",defaultMessage:"Page edits"},last_active:{id:"spaceAnalyticsUsersTab.column.lastActive",defaultMessage:"Last active"},teams:{id:"spaceAnalyticsUsersTab.column.teams",defaultMessage:"Teamspaces"}}),wp={user:{id:"user",renderCell:function(e){window.__c={n:"UserCell"};const t=(0,lt.yK)((e=>({container:{height:52}})),[]);return(0,r.jsx)(es.Z,{containerStyle:t.container,actorStore:e.userStore,spaceRole:e.role&&(0,es.K)(e.role)})},headerTitle:$.default.formatMessage(Mp.user),widthData:{width:100},sortable:!1},page_views:{id:"page_views",renderCell:function(e){window.__c={n:"PageViewsCell"};const{page_views:t}=e,s=(0,lt.yK)((e=>({eyeHideIcon:{width:20,height:20,color:e.lightIconColor},cell:{marginLeft:10}})),[]);if(void 0===t)return(0,r.jsx)(fe.Z,{placement:fe.Z.Placement.Bottom,render:e=>(0,r.jsx)("div",{...e,children:(0,xp.L)(s.eyeHideIcon)}),renderTooltip:e=>(0,r.jsx)(g.FormattedMessage,{id:"spaceAnalyticsUsersTab.optedOutUser.icon.tooltip",defaultMessage:"User has disabled page view tracking"})});return(0,r.jsx)(It.Z,{children:t})},headerTitle:(0,r.jsx)(_m,{tooltipMessageDescriptor:bp.page_views,columnHeader:Mp.page_views}),widthData:{width:80},sortable:!0},page_edits:{id:"page_edits",renderCell:function(e){const{page_edits:t}=e;return(0,r.jsx)(It.Z,{children:t})},headerTitle:(0,r.jsx)(_m,{tooltipMessageDescriptor:bp.page_edits,columnHeader:Mp.page_edits}),widthData:{width:80},sortable:!0},last_active:{id:"last_active",renderCell:function(e){const t=e.last_active;let s;s=t?(0,r.jsx)(Hi.T,{dateTs:t}):(0,r.jsx)(It.Z,{isSecondaryColor:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.userTable.lastActiveTimestamp.noLastActive",defaultMessage:"No activity"})});return(0,r.jsx)("div",{children:s})},headerTitle:$.default.formatMessage(Mp.last_active),widthData:{width:50},sortable:!0},teams:{id:"teams",renderCell:function(e){const{userStore:t,role:s}=e;if(!s)return(0,r.jsx)(It.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.teamsColumn.guest",defaultMessage:"None"})});return(0,r.jsx)(Sp.Z,{member:{userId:t.id,role:s}})},headerTitle:$.default.formatMessage(Mp.teams),widthData:{width:50},sortable:!1}};const jp=(0,_.Yd)(wp).map((e=>wp[e]));function Cp(e){window.__c={n:"UsersTable"};const t=(0,L.O7)(),[s,n]=(0,i.useState)(25),{usersAndStats:a,filter:o,onUserTabFilterChange:l,usersAndStatsError:d}=e,c=(0,N.VK)((()=>{const{currentSpaceStore:e}=I.default.state,t=(null==e?void 0:e.getPermissionItems().filter(an.jg))||[],s={};for(const i of t)s[i.user_id]=i.role;return s}),[]),[u,m]=(0,i.useState)({column:wp.last_active,sortAscending:!1}),p=(0,i.useCallback)((e=>{y.gEE(t,{column:e.column.id,isAscending:e.sortAscending}),m(e)}),[m,t]),h=a.map((e=>{let{userStore:t,stats:s}=e;return{id:s.userId,userStore:t,isClickable:!1,last_active:s.lastActive,page_views:s.numPageViews,page_edits:s.numPageEdits,role:c[s.userId]}})).sort(function(e){switch(e.column.id){case"last_active":return(t,s)=>(0,ps.Zj)(t.last_active,s.last_active,e.sortAscending);case"page_views":return(t,s)=>(0,ps.yM)(t.page_views,s.page_views,e.sortAscending);case"page_edits":return(t,s)=>e.sortAscending?t.page_edits-s.page_edits:s.page_edits-t.page_edits;default:return(e,t)=>0}}(u)),f=(0,i.useMemo)((()=>h.slice(0,s)),[h,s]),v=(0,lt.yK)((e=>({error:{color:mt.ZP.red},dateFilterPill:{display:"flex",marginTop:10,marginBottom:15,flexFlow:"row",alignItems:"center"},timeFilterDescription:{marginRight:5}})),[]);const x=(0,i.useCallback)((e=>{y.IwD(t,{daysFilter:e}),l({tableFilter:e})}),[t,l]),S=(0,lt.yK)((e=>(0,Xt.b)({columnRenderInfo:jp,theme:e,containerMarginTop:0})),[]);return(0,r.jsxs)(r.Fragment,{children:[d&&(0,r.jsx)(It.Z,{isMultiline:!1,style:v.error,children:d}),(0,r.jsxs)("div",{style:v.dateFilterPill,children:[(0,r.jsx)(It.Z,{isSecondaryColor:!0,style:v.timeFilterDescription,children:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.timeFilter.description",defaultMessage:"Views and edits from"})}),(0,r.jsx)(jm.f,{currentFilter:o,onChangeFilter:x})]}),(0,r.jsx)(Xt.D,{allowHorizontalScroll:!0,hideHeaderRowPadding:!0,setStickyHeaderRow:!0,maxHeight:500,sortState:u,onSortStateChanged:p,columnRenderInfo:jp,rows:f,renderNoRowsComponent:()=>(0,r.jsx)("div",{children:"N/A"}),styles:S,onScrollBottom:function(){s<a.length&&n(s+25)}})]})}function kp(e){var t,s;let{spaceStore:n,usersTabData:a,onUserTabFilterChange:o,userEngagement:l}=e;window.__c={n:"SpaceAnalyticsUsersTab"};const[d,c]=(0,bm.e)(),u=(0,lt.yK)((e=>({container:{display:"flex",flexDirection:"column",gap:16},titleContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:16},sectionTitle:{fontWeight:p.Z.fontWeight.medium,fontSize:16},sectionTitleLeft:{marginBlock:"8px 4px",marginBottom:5,display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-around"},numUsersCaption:{display:"flex"},overviewText:{textAlign:"center"},error:{color:mt.ZP.red},tableHeader:{marginTop:20,flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"end"},tooltip:{marginLeft:3},infoIcon:{height:14,width:14,color:e.mediumTextColor}})),[]),m=(0,L.O7)(),h=(0,g.useIntl)(),f=(0,i.useCallback)((e=>{y.KCu(m,{daysFilter:e});o({graphFilter:"all_time"===e?"last_90_days":e}),l.setDaysFilter(e)}),[o,l,m]),v=(0,N.VK)((()=>n.getName()),[n]);if("NotFoundError"===(null==a||null===(t=a.usersAndStatsError)||void 0===t?void 0:t.name)||"NotFoundError"===(null===(s=l.error)||void 0===s?void 0:s.name))return(0,r.jsx)(vm,{type:"empty",spaceName:v});const x=Math.floor(c-8);return(0,r.jsxs)("div",{style:u.container,children:[(0,r.jsx)(vp,{data:l.data,loading:l.loading,error:l.error,daysFilter:l.daysFilter,setDaysFilter:f}),(0,r.jsx)(_p,{children:(0,r.jsx)("div",{ref:d,children:a?(0,r.jsx)(Tp,{width:x,dailyUsersData:a.dailyUsersData,userEngagementDaysFilter:l.daysFilter,daysFilter:a.graphFilter,dailyUsersError:a.dailyUsersError&&um(a.dailyUsersError,h)}):(0,r.jsx)(Ip,{})})}),(0,r.jsxs)("div",{style:u.tableHeader,children:[(0,r.jsxs)("div",{style:u.sectionTitleLeft,children:[(0,r.jsx)(It.Z,{style:u.sectionTitle,children:(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.usersTab.allUsers.title",defaultMessage:"All members in Notion"})}),(0,r.jsx)(fe.Z,{placement:ns.u.Bottom,render:e=>(0,r.jsx)(ml.Z,{...e,href:(0,yi.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:u.helpInfo}),renderTooltip:()=>a&&"all_time"!==a.tableFilter?(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.allMembers.tooltip.lastDays",defaultMessage:"Per member workspace activity over the {dateRange}",values:{dateRange:$.default.formatMessage(ps.xX[a.tableFilter])}}):(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.allMembers.tooltip.allTime",defaultMessage:"All time per member workspace activity"})})]}),(0,r.jsx)(gm,{analyticsType:ji.Users})]}),a?(0,r.jsx)(Cp,{filter:a.tableFilter,usersAndStats:a.usersAndStats,onUserTabFilterChange:o,usersAndStatsError:a.usersAndStatsError&&um(a.usersAndStatsError,h)}):null]})}function _p(e){window.__c={n:"DisplayBox"};const t=(0,lt.yK)((e=>({border:{borderRadius:3,overflow:"hidden",border:`1px solid ${e.regularDividerColor}`,backgroundColor:e.contentBackground,color:e.regularTextColor,padding:20}})),[]);return(0,r.jsx)("div",{style:t.border,children:e.children})}function Tp(e){window.__c={n:"UsersOverTimeGraph"};const{width:t,dailyUsersData:s,userEngagementDaysFilter:i,daysFilter:n,dailyUsersError:a}=e,o=(0,lt.yK)((e=>({graphHeader:{marginBottom:10,display:"flex",justifyContent:"space-between"},graphTitle:{fontSize:p.Z.fontSize.UIRegular.desktop,fontWeight:"bolder",display:"flex",alignItems:"center",height:24},graphCaption:{fontSize:p.Z.fontSize.UISmall.desktop},graphTooltip:{marginLeft:5,width:14,height:14},helpInfo:{marginLeft:4},emptyGraphBody:{textAlign:"center",paddingTop:50,paddingBottom:50},error:{color:mt.ZP.red},graphSubLabel:{paddingTop:4,color:"grey"}})),[]),{blueLayer:l}=(0,yp.useTimeSeriesPalette)(),d=(0,N.VK)((()=>{if(0===s.length)return;return{startDate:s[0].ds,endDate:s[s.length-1].ds}}),[s]),c=(0,N.VK)((()=>s.map((e=>({ds:e.ds,values:{active_members:e.active_members||0}})))),[s]);let u;return u=!d||s.length<3?(0,r.jsx)("div",{style:o.emptyGraphBody,children:(0,r.jsx)(It.Z,{isSecondaryColor:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.emptyGraph",defaultMessage:"Not enough data to display graph"})})}):(0,r.jsx)(yn.LazyTimeSeries,{startDate:d.startDate,endDate:d.endDate,width:t,data:c,height:300,layers:[{key:"active_members",...l,renderLabel:e=>(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.activeMembers",defaultMessage:"{activeMembers, plural, one {1 active member} other {{activeMembers} active members}}",values:{activeMembers:e}})}],renderTooltipSubLabel:()=>(0,r.jsx)("div",{style:o.graphSubLabel,children:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.usersOverTime.activeMembers.sublabel",defaultMessage:"Viewed a page in the {dateRange}",values:{dateRange:$.default.formatMessage(ps.xX[n])}})})}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:o.graphHeader,children:(0,r.jsxs)(It.Z,{style:o.graphTitle,children:[(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.membersOverTime.title",defaultMessage:"Active members over time"}),"all_time"===i&&(0,r.jsx)(fe.Z,{placement:ns.u.Bottom,render:e=>(0,r.jsx)(ml.Z,{...e,href:(0,yi.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:o.helpInfo}),renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.membersOverTime.allTimeTooltip",defaultMessage:"All Time selection shows members who have viewed a page in the last 90 days."})})]})}),a&&(0,r.jsx)(It.Z,{isMultiline:!1,style:o.error,children:a}),u]})}function Ip(){return(0,r.jsxs)("div",{children:[(0,r.jsx)(qt.Z,{paragraphs:[{lineHeight:18,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:0}]}),(0,r.jsx)(qt.Z,{paragraphs:[{lineHeight:300,lineMargin:0,sectionWidths:[100],repeat:0,sectionMargin:12}]})]})}const Pp={[ji.Overview]:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalyticsTabs.overview.title",defaultMessage:"Overview"}),[ji.Users]:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalyticsTabs.members.title",defaultMessage:"Members"}),[ji.Content]:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalyticsTabs.content.title",defaultMessage:"Content"}),[ji.Search]:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalyticsTabs.search.title",defaultMessage:"Search"})};function Zp(e){const{currentTab:t,spaceAnalyticsStore:s,onUserTabFilterChange:i,spaceStore:n}=e;switch(t){case ji.Content:return(0,r.jsx)(Hm,{spaceStore:n,contentEngagement:e.contentEngagementData});case ji.Users:return(0,r.jsx)(kp,{spaceStore:n,usersTabData:s.usersTabData,onUserTabFilterChange:i,userEngagement:e.userEngagementData});case ji.Overview:return(0,r.jsx)(op,{contentEngagement:e.contentEngagementData,userEngagement:e.userEngagementData,spaceStore:n,onUserTabFilterChange:i});case ji.Search:return(0,r.jsx)(fp,{spaceStore:n});default:(0,_.t1)(t)}}const Fp=function(e){let{spaceStore:t}=e;window.__c={n:"SpaceAnalytics"};const s=(0,lt.yK)((e=>({headingStyle:{marginBottom:0,paddingBottom:0,fontSize:16,fontWeight:p.Z.fontWeight.medium,display:"flex",justifyContent:"space-between"},title:{display:"flex",alignItems:"center"},helpInfo:{marginLeft:4},tabsStyle:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14}})),[]),n=(0,L.O7)(),a=(0,N.VK)((()=>{var e;return null===(e=I.default.state.currentUserStore)||void 0===e?void 0:e.id}),[]),o=function(e){let{spaceId:t}=e;const s=(0,L.O7)(),[n,a]=(0,i.useState)("last_90_days"),[{status:o,value:r,error:l}]=(0,Oo.r5)((async()=>{const e=await w.getContentEngagementAnalytics(s,{spaceId:t,daysFilter:n});switch(e.type){case"success":return{pageViews:e.data.pageViews,uniquePageViews:e.data.uniquePageViews,pagesCreated:e.data.pagesCreated,pageEdits:e.data.pageEdits,topPages:e.data.topPages};case"failed":throw e.body;default:(0,_.t1)(e)}}),[s,t,n]);return{data:(0,i.useMemo)((()=>r||mm),[r]),loading:"pending"===o||"idle"===o,error:l,daysFilter:n,setDaysFilter:a}}({spaceId:t.id}),l=function(e){let{spaceStore:t,userId:s}=e;const n=(0,L.O7)(),[a,o]=(0,i.useState)("last_90_days"),[{status:r,value:l,error:d}]=(0,Oo.r5)((async()=>{if(!s||!(0,qa.wv)({permissions:t.getPermissionItems()},s))return pm;const e=await w.getUserEngagementAnalytics(n,{spaceId:t.id,daysFilter:a});switch(e.type){case"success":return{activeMembersCount:e.data.activeMembersCount,previousActiveMembersCount:e.data.previousActiveMembersCount,activeGuestsCount:e.data.activeGuestsCount,previousActiveGuestsCount:e.data.previousActiveGuestsCount,topTeamspaces:e.data.topTeamspaces,topViewers:e.data.topViewers,topEditors:e.data.topEditors};case"failed":throw e.body;default:(0,_.t1)(e)}}),[n,t,s,a]);return{data:(0,i.useMemo)((()=>l||pm),[l]),loading:"pending"===r||"idle"===r,error:d,daysFilter:a,setDaysFilter:o}}({spaceStore:t,userId:a}),[d,c]=(0,N.AF)(ki),u=(0,N.VK)((()=>Boolean(null==t?void 0:t.getSettings().disable_page_analytics)),[t]),m=(0,N.VK)((()=>null==t?void 0:t.getName()),[t]),h=(0,i.useCallback)((async e=>{await async function(e){var t,s,i;const{environment:n,spaceStore:a,spaceAnalyticsStore:o,setState:r,graphFilter:l,tableFilter:d}=e,c=l||(null===(t=o.usersTabData)||void 0===t?void 0:t.graphFilter)||rm,u=d||(null===(s=o.usersTabData)||void 0===s?void 0:s.tableFilter)||rm,m=(null===(i=o.usersTabData)||void 0===i?void 0:i.userTableSort)||lm,[p,g]=await Promise.all([dm({environment:n,filter:c,spaceId:a.id,spaceAnalyticsStore:o}),cm({environment:n,filter:u,sort:m,spaceStore:a,spaceAnalyticsStore:o})]),h=(0,O.Rp)(p)||!p?[]:p,f=(0,O.Rp)(g)||!g?[]:g;r({currentSpaceId:a.id,currentTab:o.currentTab,usersTabData:{graphFilter:c,tableFilter:u,userTableSort:m,dailyUsersError:(0,O.Rp)(p)?p:void 0,dailyUsersData:h,usersAndStatsError:(0,O.Rp)(g)?g:void 0,usersAndStats:f}})}({environment:n,spaceStore:t,spaceAnalyticsStore:d,setState:c,graphFilter:e.graphFilter,tableFilter:e.tableFilter})}),[n,t,d,c]),f=(0,i.useCallback)((e=>{y.nKJ(n,{tab:e}),c({...d,currentTab:e})}),[c,d,n]),v=(0,N.VK)((()=>{const e=[];return function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(ji.Overview),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(ji.Users),e.push(ji.Content),function(e){return Boolean(null==e?void 0:e.canAdmin())}(t)&&e.push(ji.Search),e}),[t]),x=(0,N.VK)((()=>v.length>1),[v]),b=d.currentTab||v[0];(0,i.useEffect)((()=>{!async function(){const e=t.id;e&&ki.shouldRefreshState(e)&&(b===ji.Users?await h({graphFilter:"last_90_days",tableFilter:"last_90_days"}):b===ji.Content||b===ji.Overview||b===ji.Search||(0,_.t1)(b))}()}));const M=(0,i.useCallback)((()=>{S.navigateToExternalURL({environment:n,url:(0,yi.UY)("guides.workspaceAnalytics")})}),[n]),j=(0,N.VK)((()=>t.getCreatedTime()<16593264e5),[t]),C=v.map((e=>Pp[e])),k=u?(0,r.jsx)(vm,{type:"disabled",spaceName:m}):(0,r.jsxs)(r.Fragment,{children:[x&&(0,r.jsx)(Co.Z,{tabs:C,selectedIndex:v.indexOf(b),onChange:e=>{f(v[e])},style:s.tabsStyle}),Zp({currentTab:b,spaceAnalyticsStore:d,onUserTabFilterChange:h,spaceStore:t,contentEngagementData:o,userEngagementData:l})]});return(0,r.jsxs)(Ui.Z,{children:[(0,r.jsxs)(zt.Z,{large:!0,style:s.headingStyle,children:[(0,r.jsxs)("div",{style:s.title,children:[(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.title",defaultMessage:"Workspace analytics"}),j&&(0,r.jsx)(fe.Z,{placement:ns.u.Right,render:e=>(0,r.jsx)(ml.Z,{...e,href:(0,yi.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq",style:s.helpInfo}),renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"settings.workspaceAnalytics.dataDisclaimerTooltip",defaultMessage:"Data available from August 1, 2022 onwards"})})]}),(0,r.jsx)(Wt.Z,{isSmall:!0,onClick:M,icon:qo.m,children:(0,r.jsx)(g.FormattedMessage,{id:"workspaceAnalytics.title.helpButton",defaultMessage:"Learn more"})})]}),Ui.Z.renderDivider(),k]})};var Ap=s(11751),Dp=s(86080);var Bp=s(24215),Rp=s(64251),Lp=s(33293),Np=s(8286),Ep=s(13630);const Op=function(e){let{handleExportClick:t}=e;window.__c={n:"ExportSpaceTab"};const s=(0,N.VK)((()=>I.default.state),[]),{currentSpaceStore:n}=s,a=(0,N.VK)((()=>Ep.Z.state),[]),o=(0,L.O7)();return(0,i.useEffect)((()=>{de.zh({environment:o,spaceId:null==n?void 0:n.id})}),[null==n?void 0:n.id,o]),(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(zt.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.title",defaultMessage:"Export content"})}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,r.jsx)(Wt.Z,{disabled:!!a.count,isLarge:!0,onClick:t,children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportButton.label",defaultMessage:"Export all workspace content"})}),a.count?(0,r.jsxs)(yc.gq,{gap:4,children:[(0,r.jsx)(Ki.Z,{}),(0,r.jsx)(It.Z,{isSmall:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.exportInProgress",defaultMessage:"Export in progress"})})]}):(0,r.jsx)(r.Fragment,{})]}),(0,r.jsx)("div",{style:{height:12}}),(0,r.jsx)(ml.Z,{title:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportContentSection.helpButton.caption",defaultMessage:"Learn about exporting workspaces."}),href:(0,yi.UY)("guides.exportWorkspace"),analyticsFrom:"space_settings"}),Ui.Z.renderDivider()]})};var Vp=s(44071),Up=s(33411);const Wp=(0,g.defineMessages)({workspaceDomainInputPlaceholder:{id:"spaceBasicSettingsDomain.domainSection.workspaceDomainInput.placeholder",defaultMessage:"Your domain"},copyDomainTooltip:{id:"spaceBasicSettingsDomain.workspaceDomain.tooltip",defaultMessage:"Click to copy link"}}),zp=(e,t)=>{const s=t=>(0,r.jsx)(fe.Z,{delayThreshold:0,renderTooltip:()=>$.default.formatMessage(Wp.copyDomainTooltip),render:s=>(0,r.jsx)(wo.Z,{onClick:()=>{$t.RD({environment:e,stringValue:t,copiedMessage:$t.tq.copiedLinkToClipboard})},...s,children:t})});return(0,r.jsxs)("div",{style:{paddingTop:8},children:[(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.viewPublicPage.caption",defaultMessage:"Pages shared to web will be under {linkText}.",values:{linkText:s(`${t}.${Kt.default.publicDomainName}`)}}),(0,r.jsx)("div",{style:{paddingTop:6}}),(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.domainSection.workspaceDomainInput.joinWorkspace.caption",defaultMessage:"Anyone with an allowed email domain can join this workspace via {linkText}.",values:{linkText:s(`${window.location.host}/${t}`)}})]})},Kp=()=>{window.__c={n:"AvailableField"};const e=(0,lt.Fg)();return(0,r.jsxs)("div",{style:{color:e.invoiceGreen,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,hc.r)({height:16,width:16,margin:"0 4px 0 8px",color:e.invoiceGreen}),(0,r.jsx)("span",{children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Available",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.available"})})]})},Hp=()=>(0,r.jsxs)("div",{style:{color:mt.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,jl.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,r.jsx)("span",{children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Used",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.used"})})]}),Gp=()=>(0,r.jsxs)("div",{style:{color:mt.ZP.red,display:"flex",flexDirection:"row",alignItems:"center",fontSize:"14px"},children:[(0,jl.t)({height:16,width:16,margin:"0 4px 0 8px"}),(0,r.jsx)("span",{children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Not allowed",id:"spaceBasicSettings.domainSection.workspaceDomainInput.validationMessage.notAllowed"})})]}),qp=()=>(0,r.jsx)(Up.Z,{show:!0,showDelay:500,showHold:300,render:()=>(0,r.jsx)(Ki.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})}),Yp=e=>{window.__c={n:"SpaceBasicSettingsDomain"};const[t,s]=(0,N.AF)(e.spaceBasicSettingsStore),{domain:n,domainState:a}=t,o=(0,L.O7)(),l=(0,lt.Fg)(),[d,c]=(0,i.useState)(!0),u=i.createRef();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(zt.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.domainSection.title",defaultMessage:"Domain"})}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,r.jsx)("div",{style:{background:l.inputBackground,borderRadius:3,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex"},children:(0,r.jsx)(Ue.Z,{type:"text",style:{background:"none",boxShadow:"none",padding:"4px 6px",width:255},ref:u,value:n,placeholder:$.default.formatMessage(Wp.workspaceDomainInputPlaceholder),readOnly:!e.canAdminSpaceStore,onChange:e.handleSpaceUrlChange,onFocus:e=>{c(!1),e.target.select()}})}),d&&e.domainIsAutogenerated&&(0,r.jsx)("div",{style:{color:mt.ZP.blue,fontSize:p.Z.fontSize.UIRegular.desktop,fontWeight:500,textAlign:"right",padding:"4px 6px",whiteSpace:"nowrap"},onClick:()=>{var e;null===(e=u.current)||void 0===e||e.focusInput(),c(!1),s({...t,domain:""})},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.changeDomain.cta.text",defaultMessage:"Set your own"})}),n&&"available"===a&&(0,r.jsx)(Kp,{}),"inuse"===a&&(0,r.jsx)(Hp,{}),"disallowed"===a&&(0,r.jsx)(Gp,{}),"loading"===a&&qp()]}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:zp(o,n)})]})};var Qp=s(35840);const $p=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageInputMenu"};const t=(0,g.useIntl)(),s=(0,lt.Fg)(),i=(0,L.O7)(),n=(0,N.VK)((()=>(0,Oi.M9)(i)),[i]),a=!Boolean(n),[o,l]=(0,N.AF)(wi);return(0,r.jsx)("div",{onClick:()=>{n&&$a.y(i,{from:"public_domain_home_page",for:n})},children:(0,r.jsx)(Ue.Z,{type:"text",ref:e.textInputRef,style:{background:s.inputBackground,borderRadius:3,boxShadow:"rgb(15 15 15 / 10%) 0px 0px 0px 1px inset",display:"flex",padding:"4px 6px"},value:o.query,onChange:e=>{l({...o,query:e.target.value})},onFocus:()=>{a&&l({...o,openDropdown:!0})},disabled:!a,left:(0,Qp.R)({fill:s.mediumIconColor,width:16,height:16,marginRight:8,marginLeft:8,flexGrow:0,flexShrink:0}),placeholder:t.formatMessage({defaultMessage:"Select a page shared to web",id:"spaceBasicSettings.PublicHomePageSection.input.placeholder"})})})};var Xp=s(29026);const Jp=()=>(0,r.jsx)(Up.Z,{show:!0,showDelay:500,showHold:300,render:()=>(0,r.jsx)(Ki.Z,{style:{textAlign:"center",visibility:"visible",display:"inline",marginLeft:8}})}),eg=async(e,t)=>{if(!Vi.Z.state.online)return[];const s=await Y.UJ({environment:t,query:e,source:"public_home_page_menu",limit:Xp.Xv});return""===e?s.splice(0,5):s},tg=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageSearchResults"};const t=(0,L.O7)(),[s,i]=(0,N.AF)(e.spaceBasicSettingsStore,Ti),[n,a]=(0,N.AF)(wi),{query:o}=n,[{value:l,status:d}]=(0,Oo.r5)((()=>eg(o,t)),[o,t]),c=(0,N.VK)((()=>(0,mi.RM)()),[]);if(!(o||l&&0!==l.length))return null;return(0,r.jsx)("div",{style:{marginTop:2,marginBottom:2},children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,sections:[{key:"recent public pages section",render:e=>(0,r.jsx)(he.Z,{...e}),items:"idle"===d||"pending"===d?[{key:"loading spinner",render:Jp,action:()=>{}}]:c&&l&&0!==l.length?[...l.map((e=>{const t=nt.G.createChildStore(c,{table:ds.iU,id:e.id});return{key:`${e.id} page`,render:e=>(0,r.jsx)(Uu.Z,{store:t,...e}),action:()=>{i({...s,publicHomePage:e.id}),a({...n,openDropdown:!1,displaySummary:!0})}}}))]:[{key:"no results",render:()=>(0,r.jsx)(It.Z,{isSmall:!0,style:{marginLeft:8},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel.noResults",defaultMessage:"No results"})}),action:()=>{}}]}],initialFocus:void 0})})},sg=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePageSummary"};const[t,s]=(0,N.AF)(e.spaceBasicSettingsStore,Ti),[i,n]=(0,N.AF)(wi),[a,o]=(0,N.VK)((()=>{const e=(0,mi.RM)();if(!e||!t.publicHomePage)return[];const s=nt.G.createChildStore(e,{table:ds.iU,id:t.publicHomePage});return[s,s.getIcon()]}),[t]);return a?(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,r.jsxs)("div",{style:{display:"flex",paddingRight:8,alignItems:"center"},children:[o&&(0,r.jsx)(Zn.Z,{icon:o,isEmptyPage:!1,size:18,disabled:!0,style:{display:"inline-flex",marginRight:2,verticalAlign:"text-top"}}),(0,r.jsx)(Qm.Z,{store:a,style:{display:"inline",whiteSpace:"normal",marginRight:Boolean(o)?3:0,wordBreak:"break-word"}})]}),(0,r.jsx)(Wt.Z,{onClick:()=>{n({...i,displaySummary:!1}),s({...t,publicHomePage:void 0})},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.dropdownLabel",defaultMessage:"Clear"})})]}):null},ig=e=>{window.__c={n:"SpaceBasicSettingsPublicHomePage"};const t=(0,L.O7)(),s=i.createRef(),[n,a]=(0,N.AF)(wi),[o]=(0,N.AF)(e.spaceBasicSettingsStore),{openDropdown:l,displaySummary:d}=n,{publicHomePage:c,domain:u}=o,m=`${u}.${Kt.default.publicDomainName}`,p=(0,N.VK)((()=>(0,Oi.M9)(t)),[t]),h=!Boolean(p);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(zt.Z,{style:{display:"flex",alignItems:"center"},children:[(0,r.jsx)("span",{style:{marginRight:8},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.title",defaultMessage:"Public home page"})}),p&&(0,r.jsx)(il.Z,{subscriptionTier:p,analyticsName:"public_domain_home_page",desktopStyle:{marginTop:-1}})]}),h&&c&&d?(0,r.jsx)(sg,{spaceBasicSettingsStore:e.spaceBasicSettingsStore}):(0,r.jsx)(ge.ZP,{alignmentToOrigin:ge.ZP.Alignment.Start,keepFocus:t.device.isPhone,onDismiss:()=>{var e;null===(e=s.current)||void 0===e||e.handleBlur(),a({...n,openDropdown:!1,displaySummary:!0})},origin:(0,r.jsx)($p,{textInputRef:s}),open:l,popupType:ge.ZP.PopupType.Popup,style:{width:250},render:()=>(0,r.jsx)(me.Z,{menuType:ye.og.Popup,width:250,children:(0,r.jsx)(tg,{spaceBasicSettingsStore:e.spaceBasicSettingsStore})})}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption",defaultMessage:"Access your public home page via {linkText}.",values:{linkText:(0,r.jsx)(fe.Z,{delayThreshold:0,renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.PublicHomePageSection.caption.tooltip",defaultMessage:"Click to copy link"}),render:e=>(0,r.jsx)(wo.Z,{onClick:()=>{$t.RD({environment:t,stringValue:m,copiedMessage:$t.tq.copiedLinkToClipboard})},...e,children:m})})}})})]})};function ng(){return(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.nameInput.caption",defaultMessage:"You can use your organization or company name. Keep it simple."})}const ag=(0,g.defineMessages)({nameInputPlaceholder:{id:"spaceBasicSettings.nameInput.placeholder",defaultMessage:"e.g. company name"},workspaceDomainInputPlaceholder:{id:"spaceBasicSettings.domainSection.workspaceDomainInput.placeholder",defaultMessage:"URL"},allowedEmailDomainsInputPlaceholder:{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.placeholder",defaultMessage:"Type an email domain…"},copyDomainTooltip:{id:"spaceBasicSettings.workspaceDomain.tooltip",defaultMessage:"Click to copy link"}});class og extends n.Z{constructor(){super(...arguments),this.storeTypes={spaceBasicSettingsStore:Ti,securitySettingsStore:bi.Z,store:Rp.Z,tokenQuery:Z.default.createClass("")},this.handleEnableAiFeatureClick=e=>{const{securitySettingsStore:t}=this.props;t&&!e&&t.setState({...t.state,enableAiFeature:!t.state.enableAiFeature})},this.handleSpaceNameChange=e=>{this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,name:e.target.value})},this.handleCheckDomainAvailability=e=>{const{spaceBasicSettingsStore:t}=this.stores,{spaceStore:s}=this.props;b._u({environment:this.environment,spaceStore:s,domain:e}).then((e=>{if("success"!==e.type)this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domainState:"loading"});else{const s=e.data.domain===t.state.domain;this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domainState:s?e.data.domainState:t.state.domainState})}}))},this.checkSpaceDomainAvailabilityDebounced=d.Ds(this.handleCheckDomainAvailability,250),this.handleSpaceUrlChange=e=>{const t=b.$U(e.target.value);this.checkSpaceDomainAvailabilityDebounced(t),this.stores.spaceBasicSettingsStore.setState({...this.stores.spaceBasicSettingsStore.state,domain:t}),this.forceUpdate()},this.handleConfirm=async()=>{const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t,securitySettingsStore:s}=this.stores;await b.Y5({environment:this.environment,spaceId:e.id,spaceBasicSettingsStore:t})&&(await b.OF({environment:this.environment,spaceStore:e,spaceBasicSettingsStore:t,securitySettingsStore:s}),wi.setState(wi.getInitialState()),Ai.Z.setState({...Ai.Z.state,open:!1}))},this.handleCancelClick=()=>{Ai.Z.setState({...Ai.Z.state,open:!1}),wi.setState(wi.getInitialState())},this.handleExportClick=()=>{const{currentSpaceStore:e}=I.default.state;e&&de.q$({environment:this.environment,root:{table:"space",id:e.id,spaceId:e.id},isCollectionViewExportTypeSupported:!0})},this.handleExportMembersClick=()=>{const{currentSpaceStore:e}=I.default.state,{data:t}=Di.default.state;e&&t&&"subscribed_admin"===t.type&&de.$G(this.environment,{spaceStore:e,subscriptionData:t,intl:this.props.intl})},this.handleLeaveClick=()=>{const{spaceStore:e}=this.props,{currentUserSettingsStore:t}=I.default.state;t&&v.showDialog({message:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.prompt",defaultMessage:"Are you sure you want to leave this workspace?"}),showCancel:!0,keepFocus:!0,items:[{label:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.leaveWorkspaceConfirmationDialog.leaveButton.label",defaultMessage:"Leave"}),color:"red",onAccept:async()=>{await b.bf({environment:this.environment,spaceId:e.id,userSettingsStore:t})&&(y.z01(this.environment),Ai.Z.setState({...Ai.Z.state,open:!1}))}}]})},this.renderChurnSurveyModal=()=>{const{data:e}=Di.default.state,t=this.stores.store.state,s=Oi.XX(e);if(s&&t.churnSurveyModalOpen)return(0,r.jsx)(Np.Z,{churnType:t.churnType,currentPlan:t.churnType,isWorkspaceDeletion:!0,periodEnd:s.periodEnd,hasAI:u.de(s.addOns),hasPendingChanges:Boolean(s.schedule||s.willCancelAt),customerId:s.customerId,onAccept:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onAccept()},onClose:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onClose(),e.reset()}})},this.handleDeleteClick=async()=>{const e=(0,io.zt)();if(!e)return;const{data:t}=Di.default.state,s=Oi.XX(t);if(y.YO0(this.environment),s){if(!(await new Promise((t=>{const{store:s}=this.stores;s.setState({...s.state,churnType:e,churnSurveyModalOpen:!0,onAccept:async()=>{t(!0),await this.showWorkspaceDeletionConfirmation()},onClose:()=>t(!1)})}))))return}await this.showWorkspaceDeletionConfirmation()},this.showWorkspaceDeletionConfirmation=async()=>{const{currentUserSettingsStore:e}=I.default.state;if(!e)return;const{spaceStore:t,intl:s}=this.props,i=(0,za.rn)(this.environment,t)||s.formatMessage({defaultMessage:"Untitled workspace",id:"spaceBasicSettings.deleteWorkspace.untitledWorkspace.placeholder"}),n=(0,Hc.Bd)(is.SP)?(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.prompt",defaultMessage:"This action cannot be undone. This will permanently delete the workspace, including all pages and files. Please type the name of the workspace to confirm."}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(Vp.Z,{style:{marginTop:16},translations:{es:"Esta acción no se puede deshacer. Esto eliminará permanentemente el espacio de trabajo, incluidas todas las páginas y archivos. Por favor escriba el nombre del espacio de trabajo para confirmar.",ru:"Это действие не может быть отменено. Это навсегда удалит рабочее пространство, включая все страницы и файлы. Пожалуйста, введите название рабочей области для подтверждения.",zh:"此操作无法撤消。 这将永久删除工作区，包括所有页面和文件。 请输入要确认的工作空间的名称。",de:"Diese Aktion kann nicht rückgängig gemacht werden. Dadurch wird der Arbeitsbereich einschließlich aller Seiten und Dateien dauerhaft gelöscht. Bitte geben Sie den Namen des Arbeitsbereichs zur Bestätigung ein.",fr:"Cette action ne peut pas être annulée. Cela supprimera définitivement l'espace de travail, y compris toutes les pages et tous les fichiers. Veuillez saisir le nom de l'espace de travail pour confirmer.",ja:"この操作を元に戻すことはできません。 これにより、すべてのページとファイルを含むワークスペースが完全に削除されます。 確認するワークスペースの名前を入力してください。",it:"Questa azione non può essere annullata. Questo eliminerà definitivamente l'area di lavoro, incluse tutte le pagine e i file. Digita il nome dell'area di lavoro per confermare.",pt:"Essa ação não pode ser desfeita. Isso excluirá permanentemente o espaço de trabalho, incluindo todas as páginas e arquivos. Por favor, digite o nome do espaço de trabalho para confirmar.",nl:"Deze actie kan niet ongedaan gemaakt worden. Hiermee wordt de werkruimte permanent verwijderd, inclusief alle pagina's en bestanden. Typ de naam van de werkruimte om te bevestigen.",pl:"Tego działania nie można cofnąć. Spowoduje to trwałe usunięcie obszaru roboczego, w tym wszystkich stron i plików. Wpisz nazwę obszaru roboczego, aby potwierdzić.",sv:"Den här åtgärden kan inte ångras. Detta tar bort arbetsytan permanent, inklusive alla sidor och filer. Vänligen skriv in arbetsplatsens namn för att bekräfta.",uk:"Цю дію не можна скасувати. Це дозволить остаточно видалити робочу область, включаючи всі сторінки та файли. Введіть назву робочої області для підтвердження.",no:"Denne handlingen kan ikke fortrykkes. Dette vil permanent slette arbeidsområdet, inkludert alle sider og filer. Vennligst skriv navnet på arbeidsområdet for å bekrefte.",tr:"Bu işlem geri alınamaz. Bu, tüm sayfaları ve dosyaları içeren çalışma alanını kalıcı olarak siler. Lütfen onaylamak için çalışma alanının adını yazın.",cs:"Tuto akci nelze vrátit zpět. Tím se trvale odstraní pracovní prostor včetně všech stránek a souborů. Zadejte prosím název pracovního prostoru, který chcete potvrdit.",vi:"Hành động này không thể được hoàn tác. Điều này sẽ xóa vĩnh viễn không gian làm việc, bao gồm tất cả các trang và tệp. Vui lòng nhập tên của không gian làm việc để xác nhận.",da:"Denne handling kan ikke fortrydes. Dette vil permanent slette arbejdsområdet, inklusive alle sider og filer. Indtast navnet på arbejdsområdet for at bekræfte.",hu:"Ez a művelet nem visszavonható. Ez véglegesen törli a munkaterületet, beleértve az összes oldalt és fájlt. Kérjük, írja be a munkaterület nevét a megerősítéshez.",ar:"لا يمكن التراجع عن هذا الإجراء. سيؤدي ذلك إلى حذف مساحة العمل كليا ، بما يشمل جميع الصفحات والملفات. يرجى كتابة اسم مساحة العمل للتأكيد.",th:"การกระทำนี้ไม่สามารถยกเลิกได้ นี่จะเป็นการลบพื้นที่ทำงานอย่างถาวรรวมถึงหน้าและไฟล์ทั้งหมด โปรดพิมพ์ชื่อของพื้นที่ทำงานเพื่อยืนยัน",he:"לא ניתן לבטל פעולה זו. פעולה זו תמחק לצמיתות את סביבת העבודה, כולל כל הדפים והקבצים. הקלד את שם מרחב העבודה כדי לאשר.",fi:"Tätä toimintoa ei voi peruuttaa. Tämä poistaa työtilan pysyvästi, mukaan lukien kaikki sivut ja tiedostot. Vahvista kirjoittamalla työtilan nimi.",id:"Tindakan ini tidak bisa dibatalkan. Ini akan secara permanen menghapus ruang kerja, termasuk semua halaman dan file. Silakan ketik nama ruang kerja untuk mengonfirmasi."}})});await Dp.b({message:(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:n})}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.deleteWorkspaceConfirmationDialog.deleteWorkspaceButton.label",defaultMessage:"Permanently delete workspace"}),requiredInputValue:i})&&(b.Ns({environment:this.environment,spaceId:t.id,userSettingsStore:e}),y.BPl(this.environment),Ai.Z.setState({...Ai.Z.state,open:!1}))},this.handleRecordIconChange=e=>{const{spaceStore:t}=this.props;B.createAndCommit({userAction:"SpaceBasicSettings.handleRecordIconChange",environment:this.environment,perform:s=>{Qa.sO({store:t.getIconStore(),value:e,transaction:s})}})}}willMount(e){super.willMount(e);const{spaceStore:t}=this.props,{spaceBasicSettingsStore:s}=this.stores,i=s.getValueForSpace(t);i&&s.setState(i)}renderComponent(){return Vi.Z.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(It.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.offlineMessage",defaultMessage:"Please go online to manage settings."})})})}validateDomain(){const{spaceBasicSettingsStore:e}=this.stores,{domain:t,domainState:s}=e.state;return!!t&&("available"===s||"current-space"===s)}renderSettings(){const{spaceStore:e}=this.props,{spaceBasicSettingsStore:t}=this.stores,{name:s}=t.state,{data:n}=Di.default.state,{device:a}=this.environment;if(!n)return;const o=e.canAdmin(),l=(0,za.Cx)(e),d=(0,za.jv)(e),c=Oi.qF(this.environment),u=o&&!e.getDisableExport(),m=o,p=(0,io.zt)(),h="subscribed_admin"===n.type&&("enterprise"===p||"business"===p),f=e.getSettings().disable_page_analytics,y=el.Z.getPublicSpaceData(this.environment,e.id);return(0,r.jsxs)(Ui.Z,{controlRow:o&&this.renderControlRow(),children:[this.renderSpaceBasicHeader(),l&&(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{textAlign:"center"},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.guestLimitedAccessMessage",defaultMessage:"You are currently a guest in this workspace. Ask an admin to add you as a member in order to see other pages and workspace settings."})}),l&&Ui.Z.renderDivider(),o&&(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(zt.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.workspaceNameSection.title",defaultMessage:"Name"})}),(0,r.jsx)(Ue.Z,{value:s,placeholder:$.default.formatMessage(ag.nameInputPlaceholder),readOnly:!o,onChange:this.handleSpaceNameChange}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:(0,r.jsx)(ng,{})}),Ui.Z.renderDivider()]}),o&&(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(zt.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.title",defaultMessage:"Icon"})}),(0,r.jsx)("div",{style:{width:72,height:72,border:`1px solid ${this.theme.regularDividerColor}`,borderRadius:6,display:"flex",justifyContent:"center",alignItems:"center"},children:o?(0,r.jsx)(Zn.Z,{bucket:"public",disabled:!1,icon:(0,za.Wd)(this.environment,e),isEmptyPage:!1,title:s,size:64,iconLoggingData:{recordTable:e.table,source:"workspace_settings"},onChange:this.handleRecordIconChange}):(0,r.jsx)(Zn.Z,{disabled:!0,icon:(0,za.Wd)(this.environment,e),isEmptyPage:!1,title:s,size:64})}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:8},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.workspaceIconSection.caption",defaultMessage:"Upload an image or pick an emoji. It will show up in your sidebar and notifications."})}),Ui.Z.renderDivider()]}),(v=this.environment,!(null===(x=I.default.state.currentSpaceStore)||void 0===x||!x.canAdmin())&&(0,Oi.qb)(v,"enterprise")&&(0,r.jsxs)(r.Fragment,{children:[this.renderSpaceBasicFeatureSubheader(),this.renderAiFeature(),Ui.Z.renderDivider()]})),this.renderSpaceBasicPublicSubHeader(),o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Yp,{canAdminSpaceStore:o,domainIsAutogenerated:null==y?void 0:y.domainIsAutogenerated,spaceStore:e,spaceBasicSettingsStore:t,handleSpaceUrlChange:this.handleSpaceUrlChange}),Ui.Z.renderDivider()]}),o&&c&&(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(zt.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.title",defaultMessage:"Allowed email domains"})}),this.renderAllowedEmailDomains(),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainInput.caption",defaultMessage:"Anyone with email addresses at these domains can automatically join your workspace."})}),Ui.Z.renderDivider()]}),o&&(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(ig,{spaceBasicSettingsStore:t}),Ui.Z.renderDivider()]}),u&&(0,r.jsx)(Op,{handleExportClick:this.handleExportClick}),m&&(0,r.jsxs)(i.Fragment,{children:[(0,r.jsxs)(zt.Z,{style:{display:"flex",alignItems:"center"},children:[(0,r.jsx)("span",{style:{marginRight:8},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.title",defaultMessage:"Export members"})}),!h&&(0,r.jsx)(il.Z,{subscriptionTier:"business",analyticsName:"space_export_members",desktopStyle:{marginTop:-1}})]}),(0,r.jsx)("div",{style:{display:"flex"},children:(0,r.jsx)(Wt.Z,{isLarge:!0,disabled:!h,onClick:this.handleExportMembersClick,disabledFeedback:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.exportAsCSVButton.label",defaultMessage:"Export members as CSV"})})}),(0,r.jsx)("div",{style:{height:12}}),(0,r.jsx)(ml.Z,{title:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.exportMembersSection.helpButton.caption",defaultMessage:"Learn about exporting members."}),href:(0,yi.UY)("guides.exportMembers"),analyticsFrom:"space_settings"}),Ui.Z.renderDivider()]}),o&&(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(zt.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.analytics.title",defaultMessage:"Analytics"})}),(0,r.jsxs)("div",{style:{display:"flex",gap:12,flexDirection:"column"},children:[(0,r.jsx)(jo.Z,{isMobile:a.isMobile,title:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.title",defaultMessage:"Save and display page view analytics"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.analytics.settings.description",defaultMessage:"People with edit or full access will be able to see how many views a page has. If this is turned off, page views will not be stored for all pages in {workspaceName}.",values:{workspaceName:s}}),type:"toggle",isOn:!f,onToggle:()=>{const t=!f;B.createAndCommit({userAction:"SpaceBasicSettings.analyticsSettings.onSelectOption",environment:this.environment,perform:s=>{Qa.sW({store:e,data:{settings:{...e.getSettings(),disable_page_analytics:t}},transaction:s})}}),Bp.j(this.environment,t?"page_analytics_workspace_opt_out":"page_analytics_workspace_opt_in")}}),(0,r.jsx)(ml.Z,{title:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Learn about workspace analytics.",id:"spaceBasicSettings.workspaceAnalytics.helpButton.caption"}),href:(0,yi.UY)("guides.workspaceAnalytics"),analyticsFrom:"workspace_analytics_faq"})]}),Ui.Z.renderDivider()]}),(0,r.jsx)(zt.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.title",defaultMessage:"Danger zone"})}),(0,r.jsxs)("div",{style:{display:"flex"},children:[(d.length>1||l)&&(0,r.jsx)(Wt.Z,{isLarge:!0,onClick:this.handleLeaveClick,style:{marginRight:o?12:void 0},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.leaveWorkspaceButton.label",defaultMessage:"Leave workspace"})}),o&&(0,r.jsxs)(r.Fragment,{children:[this.renderModal(),(0,r.jsx)(Wt.Z,{isLarge:!0,isRed:!0,onClick:this.handleDeleteClick,children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceButton.label",defaultMessage:"Delete entire workspace"})})]})]}),o&&(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)("div",{style:{height:12}}),(0,r.jsx)(ml.Z,{title:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.dangerousSettingsSection.deleteWorkspaceHelpButton.caption",defaultMessage:"Learn about deleting workspaces."}),href:(0,yi.UY)("guides.deleteWorkspace"),analyticsFrom:"space_settings"})]})]});var v,x}renderAiFeature(){const{securitySettingsStore:e,spaceStore:t}=this.props,s=(0,za.CV)(t),i=!s&&Boolean(null==e?void 0:e.state.enableAiFeature);return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(fe.Z,{placement:fe.Z.Placement.Bottom,alignment:fe.Z.Alignment.Start,textWrap:!0,style:{maxWidth:240},disableTooltip:!s,renderTooltip:()=>s?(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.aiFeature.hipaaTooltip",defaultMessage:"Notion AI is not currently available for HIPAA compliant workspaces."}):void 0,render:e=>(0,r.jsx)("div",{children:(0,r.jsxs)("div",{...e,style:{display:"flex",alignItems:"center",cursor:s?"not-allowed":"pointer"},onClick:()=>this.handleEnableAiFeatureClick(s),children:[(0,r.jsxs)("div",{style:this.getTitleStyle(),children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,Ap.t)({width:16,height:16,marginRight:6}),(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.aiFeature.label",defaultMessage:"Notion AI"})]}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.aiFeature.ga.caption",defaultMessage:"Enable to provide AI-powered functionality for all members of your workspace.{br}By enabling Notion AI, you are agreeing to the <inlinelink>Notion AI Supplementary Terms</inlinelink>",values:{br:(0,r.jsx)("br",{}),inlinelink:e=>(0,r.jsx)(wo.Z,{href:"https://notion.notion.site/fa9034c8b5a04818a6baf3eac2adddbb",external:!0,onClick:e=>e.stopPropagation(),children:e})}})})]}),(0,r.jsx)("div",{style:{marginTop:5},children:(0,r.jsx)(Rr.Z,{on:i,disabled:s})})]})})})})}renderSpaceBasicPublicSubHeader(){return(0,r.jsx)(zt.Z,{large:!0,divider:"full",style:{paddingTop:12},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.public.subtitle",defaultMessage:"Public settings"})})}renderSpaceBasicFeatureSubheader(){return(0,r.jsx)(zt.Z,{large:!0,divider:"full",style:{paddingTop:12},children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.feature.subtitle",defaultMessage:"Feature settings"})})}renderSpaceBasicHeader(){return(0,r.jsx)(zt.Z,{large:!0,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.title",defaultMessage:"Workspace settings"})})}renderControlRow(){return(0,r.jsxs)("div",{style:{display:"flex"},children:[(0,r.jsx)(ce.Z,{isLarge:!0,onClick:this.handleConfirm,disabled:!this.validateDomain(),children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.updateButton.label",defaultMessage:"Update"})}),(0,r.jsx)(Wt.Z,{isLarge:!0,style:{marginLeft:12},onClick:this.handleCancelClick,children:(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.cancelButton.label",defaultMessage:"Cancel"})})]})}renderAllowedEmailDomains(){const{device:e}=this.environment,{spaceStore:t}=this.props,{spaceBasicSettingsStore:s}=this.stores,{emailDomains:i}=s.state,n=t.canAdmin();return(0,r.jsx)(ge.ZP,{popupType:e.isMobile?ge.ZP.PopupType.SlideUp:ge.ZP.PopupType.Popup,sameWidthAsOrigin:!0,open:this.stores.tokenQuery.state.length>0,origin:(0,r.jsx)(ua.Z,{placeholder:$.default.formatMessage(ag.allowedEmailDomainsInputPlaceholder),value:this.stores.tokenQuery.state,onChange:e=>this.stores.tokenQuery.setState(e.target.value),readOnly:!n,onRemoveLastToken:()=>{const e=i.slice(0,i.length-1);s.setState({...s.state,emailDomains:e})},tokens:i.map((e=>(0,r.jsx)(ca.Z,{showRemoveButton:!0,isSingle:!1,format:aa.l.Medium,onClickRemove:()=>{const t=i.filter((t=>t!==e));s.setState({...s.state,emailDomains:t})},value:e},e)))}),render:()=>{const t=this.stores.tokenQuery.state.trim(),{data:n}=Di.default.state,{spaceStore:a}=this.props,o=(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholder",defaultMessage:"Type an email domain…"}),l=(0,r.jsx)(g.FormattedMessage,{id:"spaceBasicSettings.allowedEmailDomainsSection.emailDomainsDropdown.placeholderNoResults",defaultMessage:"Type an email domain of a member of this workspace…"}),d=n?Oi.hn(n).map((e=>{if(("unsubscribed_admin"===n.type||"unsubscribed_member"===n.type||"subscribed_admin"===n.type)&&n.joinedMemberIds.includes(e.userId)){const t=nt.U6.createChildStore(a,{table:q.KJ,id:e.userId}).getEmail();return t&&(0,Vd.Gd)(t)}})).filter(((e,t,s)=>Boolean(e&&t===s.indexOf(e)&&!i.includes(e)))):[],c=(0,kt.ZP)(t,d,(e=>e)).map(((e,t)=>({key:t,render:t=>(0,r.jsx)(ue.Z,{...t,title:e}),action:()=>{const t=[...i,e];s.setState({...s.state,emailDomains:t}),this.stores.tokenQuery.setState("")}})));let u;return u=e.isMobile?{menuType:ye.og.ActionSheet}:{menuType:ye.og.Popup,width:"100%"},(0,r.jsx)(me.Z,{...u,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:c.length>0?0:void 0,sections:[{key:0,render:e=>(0,r.jsx)(he.Z,{...e,disableDesktopPadding:!0,title:c.length>0?o:l}),items:c}]})})},onDismiss:()=>{this.stores.tokenQuery.setState("")}})}renderModal(){const{churnSurveyModalOpen:e}=this.stores.store.state;return(0,r.jsx)(Lp.q,{isOpen:e,dismissUsing:"onlyEscape",onDismiss:()=>{const{store:e}=this.stores;e.state.churnSurveyModalOpen&&e.state.onClose(),e.reset()},children:this.renderChurnSurveyModal()})}getTitleStyle(){return{fontSize:14,marginRight:8,flexGrow:1}}}og.displayName="SpaceBasicSettings";const rg=(0,g.injectIntl)(og);var lg=s(44335),dg=s(97832),cg=s(90403),ug=s(78873);let mg=function(e){return e.Password="Password",e.CurrentEmail="TemporaryPasscode",e}({});class pg extends Z.default{getInitialState(){return{open:!1,authorized:!1,authorizationType:void 0}}}const gg=pg;var hg=s(83785);const fg=(0,g.defineMessages)({dialogLabel:{id:"profileSettings.accountSecuritySection.emailSetting.dialogLabel",defaultMessage:"Change email"}});class yg extends n.Z{constructor(){super(...arguments),this.storeTypes={store:gg},this.renderModalContent=()=>{const{store:e}=this.stores,{state:t}=e;return(0,r.jsx)("div",{style:{...this.styles.modal,...this.getColors().modal},children:(0,r.jsx)(hg.Z,{fetch:this.getAuthorizationType,loading:e=>e&&(0,r.jsx)("div",{style:this.styles.loadingSpinner,children:(0,r.jsx)(Ki.Z,{})}),render:()=>(0,r.jsxs)(i.Fragment,{children:[t.authorizationType===mg.Password?this.renderVerifyPassword(t):t.authorizationType===mg.CurrentEmail?this.renderVerifyCurrentEmail(t):void 0,t.authorized&&this.renderSetNewEmail(t)]})})})},this.renderSetNewEmail=e=>{const{store:t}=this.stores,{userValue:s}=this.props;if(t.state.authorized)return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)("p",{style:this.styles.paragraph,children:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.newEmailInstructions",defaultMessage:"Please enter a new email and we will send you a verification code."})}),(0,r.jsx)("div",{children:this.renderNewEmailInput()}),t.state.newEmailContainsVerifiedDomain&&(0,Vd.Gd)(t.state.newEmail)!==(0,Vd.Gd)((null==s?void 0:s.email)||"")&&this.renderClaimedEmailDomainWarning(e),t.state.newEmailPasscodeSent?this.renderNewEmailPasscodeInput(e):this.renderSendNewEmailPasscodeButton(e),this.renderEducationPlanDowngradeWarning()]})},this.handleSendCurrentEmailVerification=async()=>{const{userValue:e}=this.props,{store:t}=this.stores;if(!e)return;t.setState({...t.state,loading:!0});const s=await w.sendEmailVerification(this.environment,{email:e.email});"success"===s.type?t.setState({...t.state,currentEmailPasscodeSent:!0,currentEmailPasscode:"",error:void 0,loading:!1}):t.setState({...t.state,currentEmailPasscodeSent:!0,loading:!1,error:(0,Q.wf)(this.props.intl,s)})},this.handleChangeCurrentEmailPasscode=e=>{const{store:t}=this.stores;t.setState({...t.state,currentEmailPasscode:e.currentTarget.value,error:void 0})},this.handleChangePassword=e=>{const{store:t}=this.stores;t.setState({open:!0,authorized:!1,authorizationType:mg.Password,password:e.currentTarget.value,error:void 0})},this.handleClearPassword=()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:mg.Password,password:""})},this.handleSubmitAuthorization=async()=>{const{store:e}=this.stores;if(!e.state.authorized)if(e.state.authorizationType===mg.Password){if(!this.getUserCurrentEmail())return;e.setState({...e.state,loading:!0});const t=await w.authVerifyPassword(this.environment,{password:e.state.password});if("failed"===t.type)return void e.setState({...e.state,loading:!1,error:(0,Q.wf)(this.props.intl,t)});e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})}else e.state.authorizationType===mg.CurrentEmail&&e.setState({...e.state,authorized:!0,newEmail:"",newEmailPasscode:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0,loading:!1})},this.handleChangeNewEmail=e=>{const{store:t}=this.stores;t.setState({...t.state,newEmail:e.currentTarget.value,error:void 0})},this.handleClearNewEmail=()=>{const{store:e}=this.stores;e.setState({...e.state,newEmail:"",newEmailPasscodeSent:!1,newEmailContainsVerifiedDomain:!1,error:void 0})},this.handleSendNewEmailVerification=async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=(0,Vd.Gd)(e.state.newEmail);e.setState({...e.state,loading:!0});const[s,i]=await Promise.all([await w.sendEmailVerification(this.environment,{email:e.state.newEmail}),t?await w.getVerifiedEmailDomain(this.environment,{emailDomain:t}):void 0]);if("success"===s.type){const t=(0,_.$K)(i)&&"failed"===i.type?(0,Q.wf)(this.props.intl,i):void 0;e.setState({...e.state,newEmailPasscodeSent:!0,newEmailPasscode:"",error:t,loading:!1,newEmailContainsVerifiedDomain:(0,_.$K)(i)&&"success"===i.type&&void 0!==i.data.id})}else e.setState({...e.state,loading:!1,error:(0,Q.wf)(this.props.intl,s)})},this.handleChangeNewEmailPasscode=e=>{const{store:t}=this.stores;t.setState({...t.state,newEmailPasscode:e.currentTarget.value,error:void 0})},this.handleSubmit=async()=>{const{store:e}=this.stores;if(!e.state.authorized)return;const t=e.state.authorizationType===mg.Password?{type:"Password",password:e.state.password,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode}:{type:"CurrentEmail",currentEmailPasscode:e.state.currentEmailPasscode,newEmail:e.state.newEmail,newEmailPasscode:e.state.newEmailPasscode};e.setState({...e.state,loading:!0});const s=await w.changeEmail(this.environment,t);if("success"===s.type)y.txh(this.environment,{new_email:e.state.newEmail,error:void 0}),e.setState({...e.state,loading:!1}),await this.closeModal();else{var i;const t=(0,Q.wf)(this.props.intl,s);if(y.txh(this.environment,{new_email:e.state.newEmail,error:t}),"IntercomError"===(null===(i=s.body)||void 0===i?void 0:i.name))return e.setState({...e.state,loading:!1}),void(await this.closeModal());e.setState({...e.state,loading:!1,error:t})}},this.handleSendUsMessageClick=()=>{Zl.j({environment:this.environment,from:"change_email_student"})},this.openModal=()=>{const{store:e}=this.stores;e.setState({open:!0,authorized:!1,authorizationType:void 0})},this.closeModal=async()=>{const{store:e}=this.stores,{hasEducationPlan:t}=this.props;e.reset(),t&&await Li.bi(this.environment)},this.getAuthorizationType=async()=>{const{store:e}=this.stores,{intl:t}=this.props,s=this.getUserCurrentEmail();if(!s)return;const i=await ug.c({environment:this.environment,userEmail:s});i.error?e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:t.formatMessage({id:"profileSettings.changeEmailModal.errorFetchingAccountData",defaultMessage:"Could not fetch account information for {currentEmail}."},{currentEmail:s})}):i.value.isSamlEnforced||!i.value.hasPassword?e.setState({open:!0,authorized:!1,authorizationType:mg.CurrentEmail,currentEmailPasscodeSent:!1,currentEmailPasscode:""}):e.setState({open:!0,authorized:!1,authorizationType:mg.Password,password:""})},this.styles={modal:{width:460,padding:32,borderRadius:3,fontSize:14},loadingSpinner:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},paragraph:{marginTop:12,marginBottom:14},error:{color:mt.ZP.red,fontSize:12,marginTop:4,marginLeft:8},bold:{fontWeight:p.Z.fontWeight.bold},input:{padding:"4px 8px"},button:{marginTop:14,width:"100%"},educationPlanWarning:{display:"flex",marginTop:14,paddingTop:14},claimedEmailDomainWarning:{marginTop:14,marginBottom:14}}}renderComponent(){const{userValue:e}=this.props,{store:t}=this.stores;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(jo.Z,{type:"custom",isMobile:!1,title:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.label",defaultMessage:"Email"}),caption:e&&e.email,customButton:this.renderChangeEmailButton()}),(0,r.jsx)(Bo.Z,{ariaLabel:$.default.formatMessage(fg.dialogLabel),open:t.state.open,onDismiss:this.closeModal,render:this.renderModalContent})]})}renderChangeEmailButton(){const{userValue:e,areProfileEditsDisabled:t}=this.props,s=(0,r.jsx)(Wt.Z,{isLarge:!0,onClick:t?()=>{}:this.openModal,disabled:t,disabledFeedback:t,children:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.emailSetting.changeEmailButton.label",defaultMessage:"Change email"})});return t?(0,r.jsx)(fe.Z,{renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:e?(0,Vd.Gd)(e.email):""}}),placement:fe.Z.Placement.Bottom,alignment:fe.Z.Alignment.Center,render:e=>(0,r.jsx)("div",{...e,children:s})}):s}renderVerifyPassword(e){const{userValue:t}=this.props;if(t)return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)("p",{style:{margin:0},children:this.renderCurrentEmail()}),(0,r.jsx)("p",{style:this.styles.paragraph,children:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.enterPasswordInstructions",defaultMessage:"Please enter your password."})}),(0,r.jsx)(Ue.Z,{style:{display:"none"},type:"text",value:t.email,autoComplete:"username",disabled:!0}),(0,r.jsx)(Ue.Z,{type:"password",disabled:e.authorized,value:e.password,onChange:this.handleChangePassword,showClearButton:!0,onClearButtonClick:this.handleClearPassword,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.passwordInput.label",defaultMessage:"Password"}),style:this.styles.input,focusInitial:!0,autoComplete:"current-password"}),!e.authorized&&e.error&&(0,r.jsx)("div",{style:this.styles.error,children:e.error}),!e.authorized&&(0,r.jsx)(ce.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmitAuthorization,disabled:e.loading,children:e.loading?(0,r.jsx)(Ki.Z,{}):(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue"})})]})}renderVerifyCurrentEmail(e){return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsxs)("p",{style:{...this.styles.paragraph,marginTop:0},children:[this.renderCurrentEmail()," ",e.currentEmailPasscodeSent?(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.sentVerificationCodeToCurrentEmail",defaultMessage:"We've sent a temporary verification code to this email."}):(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeToCurrentEmail",defaultMessage:"We'll send a temporary verification code to this email."})]}),e.currentEmailPasscodeSent?this.renderCurrentEmailPasscodeInput(e):this.renderSendCurrentEmailPasscodeButton()]})}renderSendCurrentEmailPasscodeButton(){return(0,r.jsx)(ce.Z,{isLarge:!0,onClick:this.handleSendCurrentEmailVerification,disabled:this.stores.store.state.loading,children:this.stores.store.state.loading?(0,r.jsx)(Ki.Z,{}):(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.sendCurrentEmailVerificationCode.label",defaultMessage:"Send verification code"})})}renderCurrentEmailPasscodeInput(e){return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(Ue.Z,{value:e.currentEmailPasscode,onChange:this.handleChangeCurrentEmailPasscode,onSubmit:this.handleSubmitAuthorization,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterCurrentEmailVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:this.styles.input}),!e.authorized&&(0,r.jsx)(ce.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSubmitAuthorization,disabled:e.loading,children:e.loading?(0,r.jsx)(Ki.Z,{}):(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.continueButton.label",defaultMessage:"Continue"})})]})}renderNewEmailInput(){const{store:e}=this.stores;if(e.state.authorized)return(0,r.jsx)(Ue.Z,{value:e.state.newEmail,onChange:this.handleChangeNewEmail,onSubmit:this.handleSendNewEmailVerification,showClearButton:!0,onClearButtonClick:this.handleClearNewEmail,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.newEmailInput.placeholder",defaultMessage:"Enter new email"}),style:this.styles.input,focusInitial:!0})}renderSendNewEmailPasscodeButton(e){return(0,r.jsxs)(i.Fragment,{children:[e.error&&(0,r.jsx)("div",{style:this.styles.error,children:e.error}),(0,r.jsx)(ce.Z,{isLarge:!0,style:this.styles.button,onClick:this.handleSendNewEmailVerification,disabled:e.loading,children:e.loading?(0,r.jsx)(Ki.Z,{}):(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.sendVerificationCodeButton.label",defaultMessage:"Send verification code"})})]})}renderNewEmailPasscodeInput(e){const t=this.getSubmitHandler();return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)("p",{style:this.styles.paragraph,children:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.verificationCodeSentMessage",defaultMessage:"We just sent you a temporary verification code to {newEmail}.",values:{newEmail:(0,r.jsx)("span",{style:this.styles.bold,children:e.newEmail})}})}),(0,r.jsx)(Ue.Z,{value:e.newEmailPasscode,onChange:this.handleChangeNewEmailPasscode,onSubmit:t,placeholder:this.props.intl.formatMessage({id:"profileSettings.changeEmailModal.enterVerificationCodeInput.placeholder",defaultMessage:"Enter verification code"}),focusInitial:!0,style:this.styles.input}),e.error&&(0,r.jsx)("div",{style:this.styles.error,children:e.error}),(0,r.jsx)(ce.Z,{isLarge:!0,style:this.styles.button,onClick:t,disabled:e.loading,children:e.loading?(0,r.jsx)(Ki.Z,{}):(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.changeEmailButton.label",defaultMessage:"Change email"})})]})}renderEducationPlanDowngradeWarning(){const{hasEducationPlan:e}=this.props;if(e)return(0,r.jsxs)("div",{style:{...this.styles.educationPlanWarning,...this.getColors().educationPlanWarning},children:[(0,qo.m)({width:14,marginTop:4,marginRight:6,fill:this.theme.lightIconColor})," ",(0,r.jsx)("div",{children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Changing your email may downgrade your workspace on a Free Education Plan to the basic Free Plan. You won't lose any data, but you'll need to upgrade to re-access paid features. Have questions about this? <sendmessagelink>Message support</sendmessagelink>.",id:"emailChangeSettings.downgradeEducationPlan.warning.message",values:{sendmessagelink:e=>(0,r.jsx)(wo.Z,{onClick:this.handleSendUsMessageClick,children:e})}})})]})}renderCurrentEmail(){const{userValue:e}=this.props;if(e)return(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.currentEmail",defaultMessage:"Your current email is {currentEmail}.",values:{currentEmail:(0,r.jsx)("span",{style:this.styles.bold,children:e&&e.email})}})}renderClaimedEmailDomainWarning(e){return(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:this.styles.claimedEmailDomainWarning,children:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.claimedEmailDomainWarning",defaultMessage:"The email domain {newEmailDomain} has been claimed by an organization. If you continue with changing this email address, any workspaces created by this account can be managed by the organization. See <domainclaimlink>this page</domainclaimlink> for more info.",values:{newEmailDomain:(0,Vd.Gd)(e.newEmail)??e.newEmail,domainclaimlink:e=>(0,r.jsx)(wo.Z,{href:(0,yi.UY)("guides.domainManagement"),external:!0,children:e})}})})}showConfirmationModal(e){return v.confirmUserAction({message:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.title",defaultMessage:"Are you sure you want to change your email?"}),description:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.description",defaultMessage:"If you continue changing this email address to this domain, any workspaces created by this account can be managed by the organization.",values:{verifiedDomain:(0,Vd.Gd)(e)}}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.acceptButton.label",defaultMessage:"Change email"}),cancelLabel:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.changeEmailModal.confirmationModal.cancelButton.label",defaultMessage:"Go back"})})}getUserCurrentEmail(){const{store:e}=this.stores,{userValue:t,intl:s}=this.props;if(t)return t.email;e.setState({open:e.state.open,authorized:!1,authorizationType:void 0,error:s.formatMessage({id:"profileSettings.changeEmailModal.errorNoUserValue",defaultMessage:"User value is undefined."})})}getSubmitHandler(){const{store:e}=this.stores,{userValue:t}=this.props;if(!e.state.authorized)return()=>{};if(e.state.newEmailContainsVerifiedDomain&&(0,Vd.Gd)(e.state.newEmail)!==(0,Vd.Gd)((null==t?void 0:t.email)||"")){const t=e.state.newEmail;return async()=>{await this.showConfirmationModal(t)&&await this.handleSubmit()}}return this.handleSubmit}getColors(){return{modal:{background:this.theme.contentBackground},educationPlanWarning:{color:this.theme.lightTextColor,borderTop:`1px solid ${this.theme.regularDividerColor}`}}}}yg.displayName="EmailChangeSettings";const vg=(0,g.injectIntl)(yg);var xg=s(10020);class Sg extends Z.default{getInitialState(){return{open:!1}}}const bg=new Sg;class Mg extends n.Z{constructor(){super(...arguments),this.handleLogOutFromActiveSessions=async()=>{y.AQD(this.environment),await w.logoutActiveSessions(this.environment,{}),this.openConfirmationModal()}}renderComponent(){const e=(0,r.jsx)(g.FormattedMessage,{id:"manageActiveSessions.title",defaultMessage:"Log out of all devices"}),t=(0,r.jsx)(g.FormattedMessage,{id:"manageActiveSessions.logOutActiveSessions.label",defaultMessage:"Log out of all other active sessions on other devices besides this one."});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(jo.Z,{type:"custom",isMobile:!1,title:e,caption:t,customButton:(0,r.jsx)(Jt.Z,{style:{borderRadius:"0.25em"},onClick:this.handleLogOutFromActiveSessions,children:(0,xg.C)(this.getIconStyle())})}),this.renderManageActiveSessionsModal()]})}renderManageActiveSessionsModal(){const{open:e}=bg.state,t=this.getUserEmailAddress();return(0,r.jsx)(Bo.Z,{open:e,onDismiss:this.closeConfirmationModal,innerStyle:{width:350,padding:24,display:"flex",flexDirection:"column"},render:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{marginBottom:24},children:t?(0,r.jsx)(g.FormattedMessage,{id:"manageActiveSessions.confirmationModal.withEmail",defaultMessage:"You have been logged out from other active sessions for {email}.",values:{email:t}}):(0,r.jsx)(g.FormattedMessage,{id:"manageActiveSessions.confirmationModal.withoutEmail",defaultMessage:"You have been logged out from other active sessions for your account."})}),(0,r.jsx)(ce.Z,{onClick:this.closeConfirmationModal,children:(0,r.jsx)(g.FormattedMessage,{id:"manageActiveSessions.confirmationModal.close",defaultMessage:"Close"})})]})})}openConfirmationModal(){bg.setState({...bg.state,open:!0})}closeConfirmationModal(){bg.setState({...bg.state,open:!1})}getUserEmailAddress(){let e;const{currentUserStore:t}=I.default.state;return t&&(e=t.getEmail()),e}getSettingTextStyle(){return{display:"flex",flexDirection:"column",alignItems:"flex-start",width:"100%",height:"auto"}}getSettingStyle(){return{display:"flex",flexDirection:"row",alignItems:"center"}}getIconStyle(){return{width:20,height:20,fill:this.theme.lightIconColor}}}Mg.displayName="ManageActiveSessions";const wg=Mg;var jg=s(1799),Cg=s(16010);class kg extends Z.default{getInitialState(){return{step:"backupCodesUninitialized"}}}class _g extends Cg.o{constructor(e,t){super(e,"backupCodes"),this.service=void 0,this.service=t}backupCodesInitialSetup(e){if(!this.checkStep("backupCodesUninitialized"))return;const{onLoadingComplete:t,onComplete:s}=e;this.store.setState({step:"backupCodesLoading"}),this.doCreateBackupCodes({forceRecreate:!1,onComplete:s,onLoadingComplete:t}).catch(this.handleUnexpectedError)}backupCodesShowCreate(){this.checkStep("backupCodesUninitialized")&&this.store.setState({step:"backupCodesRegenerateCodes"})}backupCodesRegenerateCodes(){this.checkStep("backupCodesRegenerateCodes")&&(this.store.setState({step:"backupCodesRegenerateCodes",isLoading:!0}),this.doCreateBackupCodes({forceRecreate:!0,onComplete:()=>{},onLoadingComplete:()=>{}}).catch(this.handleUnexpectedError))}exit(){this.store.setState({step:"backupCodesUninitialized"})}async doCreateBackupCodes(e){const{forceRecreate:t,onComplete:s,onLoadingComplete:i}=e,n=await this.withStep(["backupCodesLoading","backupCodesRegenerateCodes"],(()=>this.service.createBackupCodes(t)));if(!n)return;const{result:a}=n;if("already-exists"===a.status)s();else{const e=function(e){const t=$.default.getIntl(),s=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.title",defaultMessage:"Notion Backup Codes"}),i=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.createdAt",defaultMessage:"Created at {createdAt}"},{createdAt:`${new Date}`}),n=t.formatMessage({id:"mfa.backupCodes.downloadableTextFile.warningMessage",defaultMessage:"Please store these in a secure location and mark off codes as they are used."}),a=`${s}\n${i}\n\n${e.map(jg.K).join("\n")}\n\n${n}\n`;return encodeURIComponent(a)}(a.backupCodes);this.store.setState({step:"backupCodesShowCodes",backupCodes:a.backupCodes,mfaSettingId:a.mfaSettingId,backupCodesFile:e}),i()}}}var Tg=s(75752),Ig=s(88175);function Pg(e){let{errorMessage:t,isLoading:s,onDisplayBackupCodes:i,onCancel:n,onDismiss:a}=e;const o=(0,r.jsx)(g.FormattedMessage,{id:"mfa.regenerateBackupCodes.title",defaultMessage:"Regenerate backup codes"}),l=(0,r.jsx)(g.FormattedMessage,{id:"mfa.regenerateBackupCodes.message",defaultMessage:"Backup codes are used to log in if you lose access to your password and second factors. <boldtext>Your existing codes won't work after regenerating new ones.</boldtext>",values:{boldtext:e=>(0,r.jsx)("span",{style:{fontWeight:p.Z.fontWeight.semibold},children:e})}}),d={text:s?(0,r.jsx)(Ki.Z,{}):(0,r.jsx)(g.FormattedMessage,{id:"mfa.regenerateBackupCodes.regenerateBackupCodes.button.message",defaultMessage:"Generate new backup codes"}),onClick:i,view:"outline",disabled:s,isRed:!0},c=[{text:(0,r.jsx)(g.FormattedMessage,{id:"mfa.regenerateBackupCodes.cancel.button.message",defaultMessage:"Cancel"}),onClick:n,view:"outline",type:"button"}];return(0,r.jsx)(Ig.Z,{title:o,header:l,errorMessage:t,primaryAction:d,secondaryActions:c,onDismiss:a})}var Zg=s(457);function Fg(e){let{backupCodes:t,backupCodeDownload:s,backupCodeFileName:i,errorMessage:n,onNoted:a,onDownload:o}=e;const l=(0,r.jsx)(g.FormattedMessage,{id:"mfa.showBackupCodes.title",defaultMessage:"Save your backup codes"}),d=(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(g.FormattedMessage,{id:"mfa.showBackupCodes.message",defaultMessage:"<boldtext>You can only see this once</boldtext>, so be sure to keep them to avoid getting locked out of your account.",values:{boldtext:e=>(0,r.jsx)("span",{style:{fontWeight:p.Z.fontWeight.semibold},children:e})}})}),c={text:(0,r.jsx)(g.FormattedMessage,{id:"mfa.showBackupCodes.codesNotedDown.button.message",defaultMessage:"I've saved them"}),onClick:a},u=[{text:(0,r.jsx)(g.FormattedMessage,{id:"mfa.showBackupCodes.downloadAsTextFile.button.message",defaultMessage:"Download as text file"}),href:`data:text/plain;charset=UTF-8,${s}`,saveAs:i,view:"outline",type:"link",onClick:o}];return(0,r.jsx)(Ig.Z,{title:l,header:d,errorMessage:n,primaryAction:c,secondaryActions:u,children:(0,r.jsx)(Zg.Z,{type:"unencryptedCodes",backupCodes:t})})}function Ag(e){const{backupCodesStateMachine:t,onGoToSettings:s,onDismiss:i}=e,n=t.useCurrentStep(),a=()=>t.backupCodesRegenerateCodes();switch(n.step){case"backupCodesUninitialized":case"backupCodesLoading":return null;case"backupCodesRegenerateCodes":return(0,r.jsx)(Pg,{isLoading:n.isLoading,errorMessage:n.error,onDisplayBackupCodes:a,onDismiss:i,onCancel:s});case"backupCodesShowCodes":return(0,r.jsx)(Fg,{errorMessage:n.error,backupCodes:n.backupCodes,backupCodeDownload:n.backupCodesFile,backupCodeFileName:"Notion Backup Codes.txt",onNoted:s});default:return(0,_.t1)(n)}}var Dg=s(64898),Bg=s(3338);function Rg(e){let{type:t,errorMessage:s,onDismiss:i,onAddMethod:n}=e;window.__c={n:"MFAPromptSetupComplete"};const a=(0,lt.yK)(Lg,[]),o=(0,r.jsx)(g.FormattedMessage,{id:"mfa.setupComplete.confirmation.header",defaultMessage:"Every time you enter your password, Notion will ask you for a verification code to confirm your identity."}),l=[{text:(0,r.jsx)(g.FormattedMessage,{id:"mfa.setupComplete.confirmation.viewTwoStepMethods.button.message",defaultMessage:"View 2-step methods"}),onClick:n,type:"button",view:"outline"}];return(0,r.jsx)(Ig.Z,{title:"totp"===t?(0,r.jsx)(g.FormattedMessage,{id:"mfa.totp.setupComplete.confirmation.title",defaultMessage:"2-step verification with authenticator is turned on"}):"sms"===t?(0,r.jsx)(g.FormattedMessage,{id:"mfa.sms.setupComplete.confirmation.title",defaultMessage:"2-step verification with phone number is turned on"}):(0,_.t1)(t),header:o,errorMessage:s,icon:(0,Bg.p)(a.confirmationIcon),secondaryActions:l,onDismiss:i})}function Lg(e){return(0,lt.EM)({confirmationIcon:{width:30,fill:"green"}})}s(30541);var Ng=s(4387),Eg=s(49682);const Og={name:"United States",countryCode:"1",regionCode:"US"},Vg=[{name:"China",countryCode:"86",regionCode:"CN"}];function Ug(e){let{isLoading:t,phoneNumber:s,country:n,errorMessage:a,onDismiss:o,onBack:l,onContinue:c}=e;window.__c={n:"MFAPromptSMSAddPhone"};const u=(0,lt.yK)(Wg,[]),m=(0,g.useIntl)(),[p,h]=(0,i.useState)(s??""),[f,y]=(0,i.useState)([]),[v,x]=(0,i.useState)(""),[S,b]=(0,i.useState)(n??Og),w=(0,N.qz)(void 0,vn.Z),[j,C]=(0,i.useState)(void 0),k=(0,i.useMemo)((()=>(0,Ng.PG)(S.regionCode)),[S.regionCode]),_=(0,i.useCallback)((e=>{const t=e.target.value.replace(/\D/g,"");h(k.reset(t))}),[k]);(0,i.useEffect)((()=>{h(n!==S?k.reset(p??""):k.reset(s??""));const e=new Intl.DisplayNames(["en"],{type:"region"}),t=(0,Ng.wJ)();let i=-1;const a=t.map(((t,s)=>{const n=(0,Ng.t7)(t).toString(),a=e.of(t);return t===S.regionCode&&(i=s),{name:a??t,countryCode:n,regionCode:t}}));-1!==i&&a.unshift(a.splice(i,1)[0]),y(a),Vg.some((e=>d.Xy(e,S)))?C(Eg.Qj.smsUnsupportedPhoneNumber(S.name)):C(void 0)}),[S]);const T=(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneTitle",defaultMessage:"Add a phone number"}),I=(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneHeader",defaultMessage:"Enter your phone number to receive a 2-step verification code."}),P={text:t?(0,r.jsx)(Ki.Z,{}):(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.sms.continueButton",defaultMessage:"Continue"}),onClick:()=>c(S,p.trim()),disabled:t||""===p||void 0!==j},Z=[{text:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.sms.addPhoneNeedHelp",defaultMessage:"Need help?"}),href:(0,yi.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}],F=m.formatMessage({id:"profileSettings.mfa.sms.phoneNumberInput.placeholder",defaultMessage:"Enter phone number"}),A=m.formatMessage({defaultMessage:"Search country code",id:"profileSettings.mfa.sms.countryCodeSelect.placeholder"}),D=e=>(0,r.jsxs)("div",{style:u.countryCodeSelectTitle,children:[e.name,(0,r.jsx)(It.Z,{isSmall:!0,children:`+${e.countryCode}`})]}),B=(0,r.jsx)(Mn.ZP,{popupType:Mn.Z4.Popup,placementToOrigin:Gc.Iw.Bottom,alignmentToOrigin:Gc.lU.Start,buttonPopupStore:w,renderOrigin:e=>(0,r.jsx)(Wt.Z,{...e,children:`+${S.countryCode}`}),render:e=>(0,r.jsx)(me.Z,{menuType:ye.og.Popup,minWidth:280,maxHeight:"30vh",header:(0,r.jsx)(he.Z,{isInput:!0,children:(0,r.jsx)(du.ZP,{value:v,onChange:e=>x(e.target.value),focus:!0,focusAfterAnimation:!0,placeholder:A})}),children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:0,sections:[{key:"countries",render:e=>(0,r.jsx)(he.Z,{...e}),items:(0,kt.ZP)(v,f,(e=>/\d/.test(v)?`${e.countryCode}`:e.name)).map((t=>({key:t.regionCode,render:e=>(0,r.jsx)(ue.Z,{...e,title:D(t),right:t.name===S.name?(0,zd.k)(u.selectedCountryCodeIcon):void 0}),action:()=>{x(""),b(t),e.close()}})))}]})})});return(0,r.jsx)(Ig.Z,{onDismiss:o,onBack:l,title:T,header:I,errorMessage:j||a,primaryAction:P,secondaryActions:Z,children:(0,r.jsxs)("div",{style:u.container,children:[(0,r.jsx)("div",{style:u.countryCodeDropdownMenu,children:B}),(0,r.jsx)(Ue.Z,{autoFocus:!0,value:p,placeholder:F,spellCheck:!1,style:u.phoneNumberInput,onChange:_,disabled:t||void 0!==j,customElementAttributes:M.pf})]})})}function Wg(e){return(0,lt.EM)({container:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:16,marginBottom:4},countryCodeDropdownMenu:{marginRight:5},selectedCountryCodeIcon:{width:15,height:15},countryCodeSelectTitle:{paddingTop:8,paddingBottom:8},phoneNumberInput:{background:"light"===e.mode?mt.ZP.transparent:e.inputBackground}})}var zg=s(56839);function Kg(e){const{smsStateMachine:t,onGoToSettings:s,onDismiss:i,onStartBackupCodes:n}=e,a=t.useCurrentStep();switch(a.step){case"smsUninitialized":return null;case"smsSendingSMS":case"smsSetPhoneNumber":return(0,r.jsx)(Ug,{phoneNumber:a.phoneNumber,country:a.country,isLoading:"smsSendingSMS"===a.step,errorMessage:a.error,onDismiss:i,onBack:s,onContinue:(e,s)=>t.smsCreateSMS(e,s)});case"smsVerifyCode":case"smsResendSMS":case"smsBackupCodesLoading":case"smsVerifying":return(0,r.jsx)(zg.ZP,{isLoading:"smsVerifying"===a.step||"smsBackupCodesLoading"===a.step,errorMessage:a.error,phoneNumber:`+${a.country.countryCode} ${a.phoneNumber}`,onDismiss:i,onBack:()=>t.smsRestart(),onVerifyCode:e=>t.smsVerifyCode({code:e,onVerified:n}),resentStatus:"smsResendSMS"===a.step?"resending":"resentAt"in a&&void 0!==a.resentAt?"resent":"not-resent",resentAt:"resentAt"in a&&a.resentAt?a.resentAt:0,onResendLink:()=>t.smsResendSMS()});case"smsVerified":return null;case"smsComplete":return(0,r.jsx)(Rg,{type:"sms",errorMessage:a.error,onAddMethod:s,onDismiss:i});default:return(0,_.t1)(a)}}function Hg(e){window.__c={n:"MFAAuthenticatorNameInput"};const{placeholder:t,value:s,maxlength:i,style:n,onChange:a}=e,o=(0,lt.yK)((e=>(0,lt.EM)({input:{background:mt.ZP.transparent,color:e.darkTextColor,...n}})),[n]);return(0,r.jsx)(Ue.Z,{value:s,placeholder:t,maxlength:i,style:o.input,inputStyle:p.Z.textOverflowStyle,autoFocus:!0,spellCheck:!1,onChange:a,autoComplete:"off",customElementAttributes:M.pf})}function Gg(e){let{isLoading:t,qrCode:s,friendlyName:n,errorMessage:a,onDismiss:o,onBack:l,onCantScanCode:d,onContinue:c}=e;window.__c={n:"MFAPromptTOTPScanQRCode"};const u=(0,lt.yK)(qg,[]),m=(0,g.useIntl)(),[p,h]=(0,i.useState)(n??""),f=(0,i.useCallback)((e=>{h(e.target.value)}),[h]),y=(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeTitle",defaultMessage:"Scan code in authenticator app"}),v=(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeHeader",defaultMessage:"Generate a verification code with an authenticator app, then enter a name to remember it by."}),x={text:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue"}),onClick:()=>c(p),disabled:!s||t||0===p.length},S=[{text:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.cantScanCodeButton",defaultMessage:"Can't scan code?"}),onClick:d,type:"button",view:"plain",disabled:t}],b=m.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput.placeholder",defaultMessage:"Enter authenticator name"});return(0,r.jsx)(Ig.Z,{onDismiss:o,onBack:l,title:y,header:v,errorMessage:a,primaryAction:x,secondaryActions:S,children:(0,r.jsxs)("div",{style:u.body,children:[(0,r.jsx)("div",{style:u.qrCodeContainer,children:s?(0,r.jsx)("img",{style:u.qrCode,src:s}):(0,r.jsx)(Ki.Z,{})}),(0,r.jsx)(Hg,{placeholder:b,value:p,maxlength:30,onChange:f})]})})}function qg(e){return(0,lt.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},qrCodeContainer:{display:"flex",justifyContent:"center",alignItems:"center",width:116,height:116,marginBottom:15},qrCode:{width:"100%"}})}function Yg(e){let{textCode:t,friendlyName:s,errorMessage:n,isLoading:a,onDismiss:o,onBack:l,onUseQrCode:d,onContinue:c}=e;window.__c={n:"MFAPromptTOTPTypeTextCode"};const u=(0,lt.yK)(Qg,[]),[m,p]=(0,i.useState)(s??""),h=(0,g.useIntl)(),f=(0,i.useCallback)((e=>{p(e.target.value)}),[p]),y=(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.typeTextCodeTitle",defaultMessage:"Type code from authenticator app"}),v=(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.typeText.message",defaultMessage:"Input this setup key in your authenticator app, then enter a name to remember it by.",values:{authenticatorlink:e=>(0,r.jsx)(wo.Z,{external:!0,href:(0,yi.UY)("guides.mfa"),children:e})}}),x={text:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.continueButton",defaultMessage:"Continue"}),onClick:()=>c(m),disabled:a||0===m.length},S=[{text:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.mfa.totp.scanQRCodeButton",defaultMessage:"Scan QR code"}),onClick:d,type:"button",view:"plain",disabled:a}],b=h.formatMessage({id:"profileSettings.mfa.totp.authenticatorNameInput",defaultMessage:"Enter authenticator name"});return(0,r.jsx)(Ig.Z,{onDismiss:o,onBack:l,title:y,header:v,errorMessage:n,primaryAction:x,secondaryActions:S,children:(0,r.jsxs)("div",{style:u.body,children:[(0,r.jsx)("div",{style:u.content,children:(0,r.jsx)("div",{style:u.textCode,children:t})}),(0,r.jsx)(Hg,{placeholder:b,value:m,maxlength:30,onChange:f})]})})}function Qg(e){return(0,lt.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center"},textCode:{fontWeight:p.Z.fontWeight.medium,fontSize:p.Z.fontSize.UIRegular.desktop,color:e.darkTextColor,textAlign:"center",verticalAlign:"middle"},content:{display:"flex",flexDirection:"column",justifyContent:"center",height:50,marginBottom:15}})}var $g=s(18469);function Xg(e){const{totpStateMachine:t,onGoToSettings:s,onStartBackupCodes:i,onDismiss:n}=e,a=t.useCurrentStep();switch(a.step){case"totpUninitialized":return null;case"totpLoadingQRCode":case"totpDisplayQRCode":const e="totpLoadingQRCode"===a.step?{isLoading:!0,qrCode:void 0}:{isLoading:a.isLoading,qrCode:a.qrCode};return(0,r.jsx)(Gg,{...e,friendlyName:"totpDisplayQRCode"===a.step?a.friendlyName:void 0,errorMessage:a.error,onDismiss:n,onBack:s,onCantScanCode:()=>t.totpDisplayTextCode(),onContinue:e=>t.totpDisplayVerification(e)});case"totpDisplayTextCode":return(0,r.jsx)(Yg,{textCode:a.rawString,friendlyName:a.friendlyName,errorMessage:a.error,isLoading:a.isLoading,onDismiss:n,onBack:s,onUseQrCode:()=>t.totpDisplayQRCode(),onContinue:e=>t.totpDisplayVerification(e)});case"totpVerifyCode":case"totpBackupCodesLoading":case"totpVerifying":return(0,r.jsx)($g.ZP,{isLoading:"totpVerifying"===a.step||"totpBackupCodesLoading"===a.step,errorMessage:a.error,onDismiss:n,onBack:()=>t.totpDisplayQRCode(),onVerifyCode:e=>t.totpVerifyCode({code:e,onVerified:i})});case"totpVerified":return null;case"totpComplete":return(0,r.jsx)(Rg,{type:"totp",errorMessage:a.error,onDismiss:n,onAddMethod:s});default:return(0,_.t1)(a)}}function Jg(e){window.__c={n:"RootRouter"};const{rootStateMachine:t,settingsStateMachine:s,totpStateMachine:n,smsStateMachine:a,backupCodesStateMachine:o,onReloadSettings:l}=e,d=t.useCurrentStep(),[{showSettings:c,onRootExit:u}]=(0,i.useState)((()=>({onRootExit:()=>t.exit((()=>{s.exit(),n.exit(),a.exit(),o.exit(),l&&l()})),showSettings:()=>t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{s.settingsConfirmIdentityForSettings()}})}))),m=()=>t.rootCloseSettings((()=>{s.exit(),l&&l()})),p=()=>t.rootStartTOTP((()=>n.totpStart())),g=()=>t.rootStartSMS((()=>a.smsStart())),h=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{n.exit(),s.settingsShow({refresh:!0})}})},f=()=>{t.rootShowSettings({refresh:!0,startConfirmIdentity:()=>{a.exit(),s.settingsShow({refresh:!0})}})},y=()=>{o.exit(),t.rootEndBackupCodes({completeTotp:()=>{n.totpComplete()},completeSMS:()=>{a.smsComplete()},showSettings:c})},v=()=>{o.backupCodesInitialSetup({onLoadingComplete:()=>{n.totpBackupCodesComplete(),t.rootShowBackupCodesFromTOTP()},onComplete:()=>{n.totpBackupCodesComplete(),n.totpComplete(),y()}})},x=()=>{o.backupCodesInitialSetup({onLoadingComplete:()=>{a.smsBackupCodesComplete(),t.rootShowBackupCodesFromSMS()},onComplete:()=>{a.smsBackupCodesComplete(),a.smsComplete(),y()}})},S=()=>{t.rootStartBackupCodesFromSettings((()=>o.backupCodesShowCreate()))},b=s.useCurrentStep(),M=n.useCurrentStep(),w=a.useCurrentStep(),j=o.useCurrentStep();let C;switch(d.step){case"rootUninitialized":break;case"rootSettings":C={open:"settingsUninitialized"!==b.step,onDismiss:u,render:()=>(0,r.jsx)(Dg.Z,{settingsStateMachine:s,onDismiss:m,onStartTOTP:p,onStartSMS:g,onStartBackupCodes:S})};break;case"rootTOTP":C={open:"totpUninitialized"!==M.step,onDismiss:u,render:()=>(0,r.jsx)(Xg,{totpStateMachine:n,onGoToSettings:h,onStartBackupCodes:v,onDismiss:u})};break;case"rootSMS":C={open:"smsUninitialized"!==w.step,onDismiss:u,render:()=>(0,r.jsx)(Kg,{smsStateMachine:a,onGoToSettings:f,onStartBackupCodes:x,onDismiss:u})};break;case"rootBackupCodes":C={open:"backupCodesUninitialized"!==j.step,onDismiss:"backupCodesRegenerateCodes"===j.step?u:void 0,render:()=>(0,r.jsx)(Ag,{backupCodesStateMachine:o,onGoToSettings:y,onDismiss:u})};break;default:throw(0,_.t1)(d)}return C?(0,r.jsx)(Bo.Z,{...C,preventHideChildrenWhileOpening:!0}):null}class eh extends Z.default{getInitialState(){return{step:"rootUninitialized"}}}class th extends Cg.o{constructor(e){super(e,"root")}rootShowSettings(e){const{refresh:t,startConfirmIdentity:s}=e;if(this.checkStep("rootSettings")){if(!t)return}else this.store.setState({step:"rootSettings"});s()}rootStartBackupCodesFromSettings(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootBackupCodes",source:"settings"}),e())}rootStartTOTP(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootTOTP"}),e())}rootShowBackupCodesFromTOTP(){this.checkStep("rootTOTP")&&this.store.setState({step:"rootBackupCodes",source:"totp"})}rootStartSMS(e){this.checkStep("rootSettings")&&(this.store.setState({step:"rootSMS"}),e())}rootShowBackupCodesFromSMS(){this.checkStep("rootSMS")&&this.store.setState({step:"rootBackupCodes",source:"sms"})}rootEndBackupCodes(e){const t=this.checkStep("rootBackupCodes");if(t)switch(t.source){case"settings":return this.store.setState({step:"rootSettings"}),e.showSettings();case"sms":return this.store.setState({step:"rootSMS"}),e.completeSMS();case"totp":return this.store.setState({step:"rootTOTP"}),e.completeTotp();default:(0,_.t1)(t.source)}}rootCloseSettings(e){e(),this.store.setState({step:"rootUninitialized"})}exit(e){this.store.setState({step:"rootUninitialized"}),e()}}var sh=s(24173);class ih extends Z.default{getInitialState(){return{step:"smsUninitialized"}}}class nh extends Cg.o{constructor(e,t){super(e,"sms"),this.service=void 0,this.service=t}smsStart(){this.checkStep("smsUninitialized")&&this.store.setState({step:"smsSetPhoneNumber"})}smsRestart(){const e=this.checkStep(["smsResendSMS","smsVerifyCode","smsVerifying"]);e&&this.store.setState({step:"smsSetPhoneNumber",country:e.country,phoneNumber:e.phoneNumber,error:void 0})}smsCreateSMS(e,t){this.checkStep("smsSetPhoneNumber")&&(this.store.setState({country:e,phoneNumber:t,step:"smsSendingSMS"}),this.doCreateSMS().catch(this.handleUnexpectedError))}smsResendSMS(){const e=this.checkStep(["smsVerifyCode","smsVerifying"]);e&&(this.store.setState({...e,step:"smsResendSMS",error:void 0}),this.doResendSMS().catch(this.handleUnexpectedError))}smsVerifyCode(e){const{code:t,onVerified:s}=e,i=this.checkStep("smsVerifyCode");i&&(this.store.setState({...i,step:"smsVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:s}).catch(this.handleUnexpectedError))}smsBackupCodesComplete(){this.checkStep("smsBackupCodesLoading")&&this.store.setState({step:"smsVerified"})}smsComplete(){this.checkStep("smsVerified")&&this.store.setState({step:"smsComplete"})}exit(){this.store.setState({step:"smsUninitialized"})}async doCreateSMS(){const e=await this.withStep("smsSendingSMS",(e=>this.service.createSMS(e.country.countryCode,e.phoneNumber)));if(!e)return;const{result:t,state:s}=e;switch(t.status){case"created":this.store.setState({...s,step:"smsVerifyCode",mfaSettingId:t.mfaSettingId,error:void 0});break;case"already_verified_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:Eg.Qj.smsAlreadyVerifiedPhoneNumber});break;case"invalid_country_code":this.store.setState({step:"smsSetPhoneNumber",error:Eg.Qj.smsInvalidCountryCode});break;case"invalid_phone_number":this.store.setState({step:"smsSetPhoneNumber",error:Eg.Qj.smsInvalidPhoneCode});break;default:return(0,_.t1)(t)}}async doVerifyCode(e){const{code:t,onVerified:s}=e,i=await this.withStep("smsVerifying",(e=>this.service.verifySMS({mfaSettingId:e.mfaSettingId,code:t})));if(!i)return;const{result:n,state:a}=i;switch(n.status){case"match":this.store.setState({step:"smsBackupCodesLoading",country:a.country,phoneNumber:a.phoneNumber}),s();break;case"error":this.store.setState({...a,step:"smsVerifyCode",error:Eg.Qj.unexpectedError});break;case"incorrect":this.store.setState({...a,step:"smsVerifyCode",error:Eg.Qj.smsIncorrectCode});break;default:return(0,_.t1)(n.status)}}async doResendSMS(){const e=await this.withStep("smsResendSMS",(e=>this.service.sendSMS({mfaSettingId:e.mfaSettingId})));if(!e)return;const{result:t,state:s}=e;switch(t.status){case"ok":this.store.setState({...s,step:"smsVerifyCode",mfaSettingId:s.mfaSettingId,error:void 0,resentAt:Date.now()});break;case"error":this.store.setState({...s,step:"smsVerifyCode",mfaSettingId:s.mfaSettingId,error:Eg.Qj.unexpectedError});break;default:return(0,_.t1)(t.status)}}}class ah extends Z.default{getInitialState(){return{step:"totpUninitialized"}}}class oh extends Cg.o{constructor(e,t){super(e,"totp"),this.service=void 0,this.service=t}totpStart(){this.checkStep("totpUninitialized")&&(this.store.setState({step:"totpLoadingQRCode"}),this.doCreateTOTP().catch(this.handleUnexpectedError))}totpDisplayTextCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayQRCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayTextCode",error:void 0,isLoading:!1})}}totpDisplayQRCode(){const e=this.getCurrentStep();switch(e.step){case"totpDisplayTextCode":case"totpVerifyCode":this.store.setState({...e,step:"totpDisplayQRCode",error:void 0,isLoading:!1})}}totpDisplayVerification(e){this.checkStep(["totpDisplayQRCode","totpDisplayTextCode"])&&this.doRenameTOTP(e).catch(this.handleUnexpectedError)}totpVerifyCode(e){const{code:t,onVerified:s}=e,i=this.checkStep("totpVerifyCode");i&&(this.store.setState({...i,step:"totpVerifying",error:void 0}),this.doVerifyCode({code:t,onVerified:s}).catch(this.handleUnexpectedError))}totpBackupCodesComplete(){this.checkStep("totpBackupCodesLoading")&&this.store.setState({step:"totpVerified"})}totpComplete(){this.checkStep("totpVerified")&&this.store.setState({step:"totpComplete"})}exit(){this.store.setState({step:"totpUninitialized"})}async doCreateTOTP(){const e=await this.withStep("totpLoadingQRCode",(()=>this.service.createTOTP()));if(!e)return;const{result:t}=e;this.store.setState({step:"totpDisplayQRCode",qrCode:t.qrCode,rawString:t.secret,mfaSettingId:t.mfaSettingId,isLoading:!1})}async doRenameTOTP(e){const t=await this.withStep(["totpDisplayQRCode","totpDisplayTextCode"],(t=>this.service.renameSettings({mfaSettingId:t.mfaSettingId,friendlyName:e})));if(!t)return;const{result:s,state:i}=t;switch(s.status){case"saved":this.store.setState({...i,step:"totpVerifyCode",friendlyName:e,error:void 0});break;case"duplicate":this.store.setState({...i,isLoading:!1,error:Eg.Qj.totpDuplicateFriendlyName});break;case"empty":this.store.setState({...i,isLoading:!1,error:Eg.Qj.totpEmptyFriendlyName});break;case"bad_friendly_name":this.store.setState({...i,isLoading:!1,error:Eg.Qj.totpBadFriendlyName});break;default:return(0,_.t1)(s)}}async doVerifyCode(e){const{code:t,onVerified:s}=e,i=await this.withStep("totpVerifying",(e=>this.service.verifyTOTP({mfaSettingId:e.mfaSettingId,code:t})));if(!i)return;const{result:n,state:a}=i;switch(n.status){case"match":this.store.setState({step:"totpBackupCodesLoading"}),s();break;case"error":this.store.setState({...a,step:"totpVerifyCode",error:Eg.Qj.unexpectedError});break;case"incorrect":this.store.setState({...a,step:"totpVerifyCode",error:Eg.Qj.totpIncorrectCode});break;default:return(0,_.t1)(n.status)}}}function rh(e){let{status:t,numMfaSettings:s,onReloadSettings:n,regenerateBackupCodes:a}=e;window.__c={n:"MFASettings"};const o=(0,L.O7)(),[{rootStateMachine:l,settingsStateMachine:d,totpStateMachine:c,smsStateMachine:u,backupCodesStateMachine:m}]=(0,i.useState)((()=>{const e=new Tg.r(o),t={totpStore:new ah,settingsStore:new sh.c,smsStore:new ih,backupCodesStore:new kg,rootStore:new eh};return{mfaService:e,rootStateMachine:new th(t.rootStore),settingsStateMachine:new sh.W(t.settingsStore,e),totpStateMachine:new oh(t.totpStore,e),smsStateMachine:new nh(t.smsStore,e),backupCodesStateMachine:new _g(t.backupCodesStore,e)}})),h=o.device.isMobile,f=(0,lt.yK)((e=>({configureButton:{marginTop:h?12:0,marginBottom:h?4:0},regenerateBackupCodesBadge:{fontWeight:p.Z.fontWeight.medium,letterSpacing:0,fontSize:11,color:e.blueColor,background:"light"===e.mode?mt.ZP.diffBackground:"rgba(35, 131, 226, 0.2)",whiteSpace:"nowrap",width:"fit-content"}})),[h]),y=(0,N.VK)((()=>Ai.Z.state.highlightedSetting===Ai.R.TwoStepVerification),[]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(jo.Z,{type:"toggleToButton",isMobile:!1,title:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.label",defaultMessage:"2-step verification"}),caption:"on"===t?(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.settingConfigured.message",defaultMessage:"You have {numMfaSettings} verification methods turned on.",values:{numMfaSettings:s}}):(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.message",defaultMessage:"Add an additional layer of security to your account during login."}),isOn:"on"===t,buttonStyle:f.configureButton,buttonLabel:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.label",defaultMessage:"Change verification methods"}),onClick:()=>{!function(e){let{rootStateMachine:t,settingsStateMachine:s}=e;t.rootShowSettings({refresh:!1,startConfirmIdentity:()=>s.settingsConfirmIdentityForSettings()})}({rootStateMachine:l,settingsStateMachine:d})},tooltipLabel:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSettingButton.tooltip",defaultMessage:"A password is required to enable 2-step verification"}),disableTooltip:"disabled"!==t,disabled:"disabled"===t,badge:a&&(0,r.jsx)(cg.Z,{style:f.regenerateBackupCodesBadge,content:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecuritySection.twoStepVerificationSetting.regenerateBackupCodes.badge",defaultMessage:"Regenerate backup codes"})}),shouldHighlight:y}),(0,r.jsx)(Jg,{onReloadSettings:n,rootStateMachine:l,settingsStateMachine:d,totpStateMachine:c,smsStateMachine:u,backupCodesStateMachine:m})]})}var lh=s(1548),dh=s(30045);class ch extends n.Z{constructor(){super(...arguments),this.storeTypes={isEducationStore:Z.default.createClass(!1)},this.handleUploadProfilePhoto=()=>{y.Her(this.environment),Er.cR({environment:this.environment,onStart:this.handleUploadStart,bucket:"public",onError:this.handleUploadError,onComplete:this.handleUploadComplete,accept:"image/*"})},this.handleRemoveProfilePhoto=()=>{this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,profilePhoto:void 0}),B.createAndCommit({userAction:"SpaceProfileSettings.handleRemoveProfilePhoto",environment:this.environment,perform:e=>{const{currentUserStore:t}=I.default.state;t&&f.A({userStore:t,data:{profilePhoto:null},transaction:e})}})},this.handleNameChange=e=>{const t=e.target.value;y.O$H(this.environment,{from:this.props.spaceProfileSettingsStore.state.name,to:t}),this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,name:t}),B.createAndCommit({userAction:"SpaceProfileSettings.handleNameChange",environment:this.environment,perform:e=>{const{currentUserStore:s}=I.default.state;s&&f.A({userStore:s,data:{name:t},transaction:e})}})},this.handleUploadStart=()=>{this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,uploadingProfilePhoto:!0})},this.handleUploadError=()=>{this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,uploadingProfilePhoto:!1}),v.showErrorMessage((0,r.jsx)(g.FormattedMessage,{id:"profileSettings.profilePhotoSection.uploadProfilePhotoError.message",defaultMessage:"Upload failed."}))},this.handleUploadComplete=e=>{const t=e[0];this.props.spaceProfileSettingsStore.setState({...this.props.spaceProfileSettingsStore.state,profilePhoto:t,uploadingProfilePhoto:!1}),B.createAndCommit({userAction:"SpaceProfileSettings.handleUploadComplete",environment:this.environment,perform:e=>{const{currentUserStore:s}=I.default.state;s&&f.A({userStore:s,data:{profilePhoto:t},transaction:e})}})}}async willMount(e){super.willMount(e);const{isEducationStore:t}=this.stores,{spaceProfileSettingsStore:s}=this.props,{currentUserStore:i,currentUserSettingsStore:n,currentUserRootStore:a}=I.default.state;if(i&&n){const t=s.getValueForUser(i,n,e.intl);t&&s.setState({...s.state,...t})}if(a){const e=((0,Oi.xR)({environment:this.environment,userRootStore:a})||[]).some((e=>e===Kt.default.pricing.student.productId));t.setState(e)}await j(this.environment,s)}willUnmount(){Ai.Z.state.highlightedSetting&&Ai.Z.setState({...Ai.Z.state,highlightedSetting:void 0}),super.willUnmount()}renderComponent(){return Vi.Z.state.online?this.renderSettings():this.renderOfflineMessage()}renderOfflineMessage(){return(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(It.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to manage your profile.",id:"profileSettings.offline.message"})})})}renderSettings(){const{currentUserStore:e}=I.default.state;if(!e)return;const t=e.getValue();if(!t)return;const{name:s}=this.props.spaceProfileSettingsStore.state;return(0,r.jsx)(Ui.Z,{children:this.renderPersonalSettings({currentUserStore:e,currentUserValue:t,userName:s})})}renderPersonalSettings(e){var t;const{userName:s,currentUserStore:i,currentUserValue:n}=e,a=$.default.getIntl(),o=(0,Dr.N5)(i,a),l=(0,Vd.Gd)(n.email),d=Boolean(null===(t=this.props.spaceProfileSettingsStore.state.emailDomainSettings)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.prevent_profile_edits);return(0,r.jsxs)(r.Fragment,{children:[this.renderMyProfileHeader({emailDomainForUser:l}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,r.jsx)(Dr.ZP,{size:60,avatarType:o,isOffline:!Vi.Z.state.online,onUploadProfilePhoto:this.handleUploadProfilePhoto,onRemoveProfilePhoto:this.handleRemoveProfilePhoto,disabled:d,disabledTooltipMessage:(0,r.jsx)(g.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:l}})}),(0,r.jsxs)("div",{style:{marginLeft:20,width:250},children:[(0,r.jsx)(Br.Z,{children:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.personalInfoSection.nameInput.label",defaultMessage:"Preferred name"})}),this.renderUserNameDisplay({userName:s,emailDomainForUser:l,areProfileEditsDisabled:d})]})]}),"photo"!==o.type&&!d&&(0,r.jsx)("div",{style:{color:this.theme.mediumIconColor,fontSize:14,marginTop:8},children:(0,r.jsx)(g.FormattedMessage,{id:"editableUserAvatar.profilePhoto.addPhoto",defaultMessage:"Add photo"})})]}),(0,r.jsx)(bo.Z,{size:48,isHidden:!0}),this.renderAccountSecuritySection({currentUserValue:n}),(0,r.jsx)(bo.Z,{size:48,isHidden:!0}),this.renderAccountSupportSection()]})}renderUserNameDisplay(e){const{userName:t,emailDomainForUser:s,areProfileEditsDisabled:i}=e;return i?(0,r.jsx)(fe.Z,{renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"editableUserAvatar.profilePhoto.disabledByOrganization",defaultMessage:"Profile editing has been disabled by your organization, {emailDomain}",values:{emailDomain:s}}),placement:fe.Z.Placement.Bottom,alignment:fe.Z.Alignment.Center,render:e=>(0,r.jsx)("div",{...e,style:{opacity:.4},children:(0,r.jsx)(Ue.Z,{disabled:!0,value:t})})}):(0,r.jsx)(Ue.Z,{value:t,onChange:this.handleNameChange})}renderMyProfileHeader(e){var t;const{emailDomainForUser:s}=e,i=Boolean(null===(t=this.props.spaceProfileSettingsStore.state.emailDomainSettings)||void 0===t?void 0:t.isDomainVerified);return(0,r.jsxs)(zt.Z,{large:!0,divider:"full",children:[i?(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",margin:"0 0 8px"},children:[(0,r.jsx)(cg.Z,{style:{fontWeight:p.Z.fontWeight.medium,letterSpacing:0,whiteSpace:"nowrap",width:"fit-content",margin:0},content:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.myProfile.managedByline",defaultMessage:"Your account is managed by {domain}",values:{domain:s}})}),(0,r.jsx)(fe.Z,{render:e=>(0,r.jsx)("div",{...e,children:(0,qi.D)({marginLeft:4,height:14,width:14,opacity:.5})}),renderTooltip:()=>(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.myProfile.managedByTooltip",defaultMessage:"Contact your organization's administrator to change your profile information."})})]}):null,(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.myProfile.title",defaultMessage:"My profile"})]})}renderAccountSecuritySection(e){var t;const{currentUserValue:s}=e,i=this.props.spaceProfileSettingsStore.state.accountSettings,n=Boolean(null===(t=this.props.spaceProfileSettingsStore.state.emailDomainSettings)||void 0===t||null===(t=t.settings)||void 0===t?void 0:t.prevent_profile_edits),a=()=>{j(this.environment,this.props.spaceProfileSettingsStore)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(zt.Z,{large:!0,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.accountSecurity.title",defaultMessage:"Account security"})}),(0,r.jsx)(vg,{userValue:s,hasEducationPlan:this.stores.isEducationStore.state,areProfileEditsDisabled:n}),(0,r.jsx)(bo.Z,{size:18,isHidden:!0}),(0,r.jsx)(lh.Z,{hasPassword:i.hasPassword,hasPasswordActions:i.canConfigurePassword,isEducationPlan:this.props.isEducationPlan,samlEnforced:i.isSamlEnforced,email:s.email,isError:Boolean(i.error),onReloadSettings:a,mfaStatus:i.mfaStatus}),(0,r.jsx)(bo.Z,{size:18,isHidden:!0}),(0,r.jsx)(rh,{status:i.mfaStatus,numMfaSettings:i.numMfaSettings,onReloadSettings:a,regenerateBackupCodes:i.regenerateBackupCodes})]})}renderAccountSupportSection(){var e;const t=(null===(e=this.props.spaceProfileSettingsStore.state.emailDomainSettings)||void 0===e?void 0:e.settings)??{};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(zt.Z,{large:!0,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"profileSettings.support.title",defaultMessage:"Support"})}),(0,r.jsx)(dh.Z,{emailDomainSettings:t}),(0,r.jsx)(bo.Z,{size:18,isHidden:!0}),(0,r.jsx)(wg,{}),(0,r.jsx)(bo.Z,{size:18,isHidden:!0}),(0,r.jsx)(dg.Z,{userEmailDomainSettings:this.props.spaceProfileSettingsStore.state.emailDomainSettings})]})}}ch.displayName="SpaceProfileSettings";const uh=(0,g.injectIntl)(ch);var mh=s(7189);function ph(e){const{up:t}=e,s={width:10,height:10,marginLeft:4};return t?(0,mh.K)({...s,transform:"rotate(180deg)"}):(0,mh.K)(s)}function gh(e){let{users:t,store:s,extraColumns:n,initialSort:a}=e;window.__c={n:"UserTableBox"};const[o,l]=(0,i.useState)(a),c=(0,g.useIntl)();function u(e,t){return(0,r.jsxs)(Jt.Z,{disabled:!t.sortable,ignoreLocalHoverState:!0,onClick:()=>{!function(e){l({column:e,asc:(null==o?void 0:o.column)===e&&!(null!=o&&o.asc)})}(e)},style:{display:"flex",alignItems:"center"},children:[t.title,t.sortable&&o&&o.column===e&&ph({up:o.asc})]},e)}const m=(0,i.useMemo)((()=>({title:(0,r.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.userTable.userColumn.header",defaultMessage:"User"}),style:{width:"60%"},sortable:!0,renderer:e=>(0,r.jsx)(es.Z,{actorStore:e}),getValue:e=>e.getDisplayName(c)})),[c]),p=(0,i.useMemo)((()=>({name:m,...n})),[n,m]),h=d.XP(p).map((e=>({key:e,header:u(e,p[e]),style:p[e].style}))),f=(0,N.VK)((()=>{const e=t.map((e=>nt.U6.createChildStore(s,{table:q.KJ,id:e.userId}))).filter((e=>e.isDefined()));return o?e.sort(((e,t)=>{const s=p[o.column].getValue(e),i=p[o.column].getValue(t);var n=s<i?-1:s>i?1:0;return o.asc?n:-1*n})):e}),[t,s,p,o]);return(0,r.jsx)(vc.Z,{columns:h,rows:f.map((e=>{const t=Object.values(p).map(((t,s)=>t.renderer?t.renderer(e):(0,r.jsx)(i.Fragment,{children:t.getValue(e)},s)));return{key:e.id,columns:t}}))})}var hh=function(e){return e[e.UserUserSimilarity=0]="UserUserSimilarity",e}(hh||{});const fh={[hh.UserUserSimilarity]:(0,r.jsx)(g.FormattedMessage,{id:"spaceSettingsDebugZone.userUserSimilarity.title",defaultMessage:"User Similarity"})};function yh(){const e=(0,Ro.mS)();return["on"===Zt.default.getGroup("user_similarity_debugging")||e?hh.UserUserSimilarity:void 0].filter(_.$K)}function vh(e){let{store:t}=e;window.__c={n:"DebugZoneUserUserSimilarityTab"};const{isOnline:s,subscriptionDataStoreData:i,userSimilarityData:n,visibleUsersLoaded:a,visibleUsers:o}=(0,N.VK)((()=>{var e,s;const i=null===(e=Di.default.state)||void 0===e?void 0:e.data,n=i?Oi.CM(i):[],a=d.yW(n.map((e=>nt.U6.createChildStore(t,{table:q.KJ,id:e.userId}).isReady())));return{isOnline:Vi.Z.state.online,subscriptionDataStoreData:i,userSimilarityData:(null===(s=Di.default.state.data)||void 0===s?void 0:s.userSimilarity)||{},visibleUsersLoaded:a,visibleUsers:n}}),[t]);if(!s)return(0,r.jsx)(It.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,r.jsx)(g.FormattedMessage,{id:"spacePermissionsSettings.offlineMessage",defaultMessage:"Please go online to manage members."})});if(!i)return(0,r.jsx)(Ki.Z,{style:{margin:"calc(50% - 1em) auto"}});if(!a)return(0,r.jsx)(Ki.Z,{style:{margin:"calc(50% - 1em) auto"}});const l={style:{},title:(0,r.jsx)(r.Fragment,{children:"Similarity Score"}),sortable:!0,renderer:e=>{var t;return(0,r.jsx)(r.Fragment,{children:(null===(t=n[e.id])||void 0===t?void 0:t.toFixed(3))||0})},getValue:e=>n[e.id]||0};return(0,r.jsx)(gh,{users:o,store:t,extraColumns:{similarityColumn:l},initialSort:{column:"similarityColumn",asc:!1}})}function xh(e){let{store:t}=e;window.__c={n:"SpaceSettingsDebugZone"};const{tabs:s}=(0,N.VK)((()=>({tabs:yh()})),[]),[n,a]=(0,i.useState)(s[0]);return(0,r.jsxs)(Ui.Z,{children:[(0,r.jsx)(Co.Z,{tabs:s.map((e=>fh[e])),selectedIndex:s.indexOf(n),onChange:e=>a(s[e]),style:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},tabTitleStyle:{fontSize:16}}),n===hh.UserUserSimilarity&&(0,r.jsx)(vh,{store:t})]})}var Sh=s(93108),bh=s(82356),Mh=s(47409),wh=s(18442),jh=s(15967),Ch=s(1436),kh=s(36312),_h=s(87393);const Th=(0,o.I)("settingsLanguage",{viewBox:"0 0 20 20",svg:(0,r.jsx)("path",{d:"M10 18.3281C14.3594 18.3281 17.9688 14.7109 17.9688 10.3594C17.9688 6 14.3516 2.39062 9.99219 2.39062C5.64062 2.39062 2.03125 6 2.03125 10.3594C2.03125 14.7109 5.64844 18.3281 10 18.3281ZM5.32812 5.29688C6.10938 4.57031 7.0625 4.02344 8.10938 3.71875C7.57031 4.26562 7.10938 5.03906 6.76562 5.99219C6.21094 5.8125 5.72656 5.57812 5.32812 5.29688ZM11.8984 3.72656C12.9375 4.03125 13.8828 4.57812 14.6719 5.30469C14.2734 5.58594 13.7891 5.8125 13.2344 5.99219C12.8906 5.04688 12.4297 4.27344 11.8984 3.72656ZM7.77344 6.25C8.21094 5.05469 8.82031 4.19531 9.49219 3.89844V6.42969C8.875 6.40625 8.30469 6.34375 7.77344 6.25ZM10.5156 3.89844C11.1797 4.19531 11.7891 5.05469 12.2266 6.25C11.6953 6.34375 11.125 6.40625 10.5156 6.42969V3.89844ZM3.10938 9.84375C3.21875 8.42188 3.77344 7.10156 4.63281 6.03906C5.11719 6.40625 5.74219 6.71094 6.46875 6.94531C6.24219 7.82031 6.10156 8.79688 6.0625 9.84375H3.10938ZM13.9375 9.84375C13.8984 8.79688 13.7578 7.82031 13.5312 6.94531C14.2578 6.71094 14.8828 6.40625 15.3594 6.04688C16.2266 7.10156 16.7812 8.42188 16.8906 9.84375H13.9375ZM10.5156 9.84375V7.45312C11.2188 7.42969 11.8906 7.34375 12.5234 7.21094C12.7266 8.01562 12.8516 8.90625 12.8906 9.84375H10.5156ZM7.10938 9.84375C7.14844 8.90625 7.28125 8.01562 7.47656 7.21094C8.10938 7.34375 8.78125 7.42969 9.49219 7.45312V9.84375H7.10938ZM3.10938 10.8672H6.0625C6.10156 11.9375 6.24219 12.9219 6.46875 13.8047C5.75 14.0391 5.13281 14.3438 4.65625 14.7031C3.78125 13.6328 3.21875 12.3047 3.10938 10.8672ZM7.10938 10.8672H9.49219V13.3047C8.78906 13.3281 8.11719 13.4141 7.49219 13.5391C7.28125 12.7266 7.14062 11.8203 7.10938 10.8672ZM10.5156 13.3047V10.8672H12.8906C12.8594 11.8203 12.7188 12.7266 12.5078 13.5391C11.8906 13.4141 11.2109 13.3281 10.5156 13.3047ZM13.5312 13.8047C13.7578 12.9219 13.8984 11.9375 13.9375 10.8672H16.8906C16.7812 12.3047 16.2188 13.6328 15.3438 14.7031C14.8672 14.3438 14.25 14.0391 13.5312 13.8047ZM10.5156 14.3281C11.1172 14.3516 11.6875 14.4062 12.2109 14.5078C11.7734 15.6719 11.1719 16.5312 10.5156 16.8281V14.3281ZM7.78906 14.5078C8.3125 14.4062 8.88281 14.3516 9.49219 14.3281V16.8281C8.82812 16.5312 8.22656 15.6719 7.78906 14.5078ZM13.2266 14.7578C13.7734 14.9375 14.25 15.1641 14.6484 15.4375C13.8672 16.1484 12.9375 16.6875 11.9062 16.9922C12.4297 16.4531 12.8828 15.6875 13.2266 14.7578ZM5.35156 15.4375C5.75 15.1641 6.22656 14.9375 6.77344 14.7578C7.11719 15.6875 7.57031 16.4531 8.10156 16.9922C7.07031 16.6875 6.13281 16.1484 5.35156 15.4375Z"})});var Ih=s(5108);const Ph=(0,o.I)("settingsNotifications",{viewBox:"3 1 17 17",svg:(0,r.jsx)("path",{d:"M5.36914 13.7627C5.36914 13.0381 6.03906 12.416 6.6543 11.8145C7.13965 11.3428 7.24902 10.3994 7.33789 9.46289C7.42676 6.87207 8.17871 5.14258 9.96289 4.49316C10.2227 3.59082 10.9814 2.90039 12 2.90039C13.0186 2.90039 13.7773 3.59082 14.0371 4.49316C15.8213 5.14258 16.5732 6.87207 16.6621 9.46289C16.751 10.3994 16.8672 11.3428 17.3457 11.8145C17.9678 12.416 18.6309 13.0381 18.6309 13.7627C18.6309 14.3369 18.2002 14.7266 17.4893 14.7266H14.6797C14.6182 16.0391 13.5518 17.2285 12 17.2285C10.4482 17.2285 9.38184 16.0322 9.32031 14.7266H6.51074C5.80664 14.7266 5.36914 14.3369 5.36914 13.7627ZM7.00293 13.4756H16.9834V13.3936C16.8125 13.1953 16.4297 12.833 16.0879 12.4434C15.623 11.9033 15.3975 10.9258 15.3291 9.62695C15.2539 6.85156 14.3994 5.92871 13.2988 5.62793C13.1279 5.58691 13.0322 5.50488 13.0186 5.32031C12.9912 4.62305 12.6016 4.1582 12 4.1582C11.3984 4.1582 11.0156 4.62305 10.9814 5.32031C10.9678 5.50488 10.8721 5.58691 10.708 5.62793C9.60059 5.92871 8.75293 6.85156 8.6709 9.62695C8.60254 10.9258 8.38379 11.9033 7.91211 12.4434C7.57715 12.833 7.18066 13.1953 7.00293 13.3936V13.4756ZM10.6123 14.7266C10.667 15.5811 11.2275 16.1348 12 16.1348C12.7793 16.1348 13.3398 15.5811 13.3877 14.7266H10.6123Z"})});var Zh=s(64530),Fh=s(5517);const Ah=(0,o.I)("settingsSubscription",{viewBox:"0 0 20 20",svg:(0,r.jsx)("path",{d:"M9 18.6191C13.9043 18.6191 17.9648 14.5498 17.9648 9.6543C17.9648 4.75 13.8955 0.689453 8.99121 0.689453C4.0957 0.689453 0.0351562 4.75 0.0351562 9.6543C0.0351562 14.5498 4.10449 18.6191 9 18.6191ZM9 17.125C4.85156 17.125 1.53809 13.8027 1.53809 9.6543C1.53809 5.50586 4.84277 2.18359 8.99121 2.18359C13.1396 2.18359 16.4619 5.50586 16.4707 9.6543C16.4795 13.8027 13.1484 17.125 9 17.125ZM5.07129 10.0586C5.07129 12.2559 6.82031 14.0225 8.99121 14.0225C11.1621 14.0225 12.9111 12.2559 12.9111 10.085C12.9111 9.75977 12.6299 9.49609 12.3047 9.49609C11.9795 9.49609 11.6982 9.75977 11.6982 10.085C11.6982 11.5967 10.4941 12.8096 8.99121 12.8096C7.48828 12.8096 6.28418 11.5967 6.28418 10.085C6.28418 8.58203 7.48828 7.38672 8.99121 7.38672C9.10547 7.38672 9.22852 7.38672 9.31641 7.4043L8.45508 8.24805C8.34961 8.35352 8.28809 8.49414 8.28809 8.65234C8.28809 8.95996 8.53418 9.20605 8.8418 9.20605C8.99121 9.20605 9.13184 9.13574 9.22852 9.03906L10.9336 7.33398C11.1533 7.13184 11.1357 6.73633 10.9336 6.52539L9.24609 4.80273C9.14941 4.69727 9 4.62695 8.8418 4.62695C8.52539 4.62695 8.28809 4.88184 8.28809 5.18945C8.28809 5.34766 8.34961 5.48828 8.44629 5.59375L9.07031 6.22656C9 6.21777 8.90332 6.20898 8.82422 6.20898C6.84668 6.20898 5.07129 7.90527 5.07129 10.0586Z"})});var Dh=s(72263),Bh=s(46783),Rh=s(69196);const Lh=(0,g.defineMessages)({accountTab:{id:"spaceSettingsSidebar.accountTab.title",defaultMessage:"My account"},settingsTab:{id:"spaceSettingsSidebar.settingsTab.title",defaultMessage:"Settings"},teamsTab:{id:"spaceSettingsSidebar.teamsTab.title",defaultMessage:"Teamspaces"},peopleTab:{id:"spaceSettingsSidebar.peopleTab.title",defaultMessage:"People"},membersTab:{id:"spaceSettingsSidebar.membersTab.title",defaultMessage:"Members"},plansTab:{id:"spaceSettingsSidebar.plansTab.title",defaultMessage:"Plans"},upgradeTab:{id:"spaceSettingsSidebar.upgradeTab.title",defaultMessage:"Upgrade"},billingTab:{id:"spaceSettingsSidebar.billingTab.title",defaultMessage:"Billing"},subscriptionTab:{id:"spaceSettingsSidebar.subscriptionTab.title",defaultMessage:"Subscription"},connectedAppsTab:{id:"spaceSettingsSidebar.connectedAppsTab.title",defaultMessage:"My connected apps"},userConnectionsTab:{id:"spaceSettingsSidebar.userConnectionsTab.title",defaultMessage:"My connections"},securitySAMLTab:{id:"spaceSettingsSidebar.securityAndSAMLTab.title",defaultMessage:"Security & identity"},securityTab:{id:"spaceSettingsSidebar.securityTab.title",defaultMessage:"Security"},identityProvisioningTab:{id:"spaceSettingsSidebar.identity&ProvisioningTab.title",defaultMessage:"Identity & provisioning"},publishingTab:{id:"spaceSettingsSidebar.publishingTab.title",defaultMessage:"Published pages"},adminContentSearchTab:{id:"spaceSettingsSidebar.adminContentSearch.title",defaultMessage:"Content search"},languageAndRegionTab:{id:"spaceSettingsSidebar.languageAndRegionTab.title",defaultMessage:"Language & region"},integrationsTab:{id:"spaceSettingsSidebar.integrationsTab.title",defaultMessage:"Integrations"},spaceConnectionsTab:{id:"spaceSettingsSidebar.spaceConnectionsTab.title",defaultMessage:"Connections"},experimentsTab:{id:"spaceSettingsSidebar.experimentsTab.title",defaultMessage:"Experiments"},auditLogTab:{id:"spaceSettingsSidebar.auditLogTab.title",defaultMessage:"Audit log"},notificationsAndSettings:{id:"spaceSettingsSidebar.notificationsAndSettings.title",defaultMessage:"My notifications & settings"},mySettings:{id:"spaceSettingsSidebar.mySettings.title",defaultMessage:"My settings"},myNotifications:{id:"spaceSettingsSidebar.myNotifications.title",defaultMessage:"My notifications"},debugZoneTab:{id:"spaceSettingsSidebar.debugZoneTab.title",defaultMessage:"Debug Zone"},analyticsTab:{id:"spaceSettingsSidebar.analyticsTab.title",defaultMessage:"Analytics"},importTab:{id:"spaceSettingsSidebar.importsTab.title",defaultMessage:"Import"}}),Nh={width:20,height:20},Eh={profile:e=>(0,Rh.H)(Nh),notifications_and_settings:()=>(0,Zh.y)(Nh),user_settings:()=>(0,Zh.y)(Nh),notifications:()=>Ph(Nh),connected_apps:()=>(0,Ch.g)(Nh),language_and_region:()=>Th(Nh),settings:()=>(0,wh.H)(Nh),teams:()=>(0,Yr.K)(Nh),members:()=>(0,Ih.n)(Nh),plans:()=>{const{data:e}=Di.default.state;return e&&Oi.YK(e)?(0,Fh.q)(Nh):(0,Dh._)(Nh)},billing:()=>(0,jh.J)(Nh),subscription:()=>Ah(Nh),security:()=>(0,hn.I)(Nh),identity_provisioning:()=>(0,kh.o)(Nh),admin_content_search:()=>(0,Sh.p)(Nh),integrations:()=>(0,_h.L)(Nh),experiments:()=>(0,Ap.t)(Nh),audit_log:()=>(0,Mh.N)(Nh),debug_zone:()=>(0,Bh.w)(Nh),analytics:()=>l(Nh),imports:()=>(0,bh.l)(Nh),publishing:()=>(0,$o.R)(Nh)},Oh={profile:()=>`${$.default.formatMessage(Lh.accountTab)}`,notifications_and_settings:()=>$.default.formatMessage(Lh.notificationsAndSettings),user_settings:()=>$.default.formatMessage(Lh.mySettings),notifications:()=>$.default.formatMessage(Lh.myNotifications),connected_apps:()=>$.default.formatMessage(Lh.userConnectionsTab),language_and_region:()=>$.default.formatMessage(Lh.languageAndRegionTab),settings:()=>$.default.formatMessage(Lh.settingsTab),teams:()=>$.default.formatMessage(Lh.teamsTab),members:()=>(0,Pt.F$)()?$.default.formatMessage(Lh.peopleTab):$.default.formatMessage(Lh.membersTab),plans:()=>{const{data:e}=Di.default.state;return e&&Oi.YK(e)?$.default.formatMessage(Lh.plansTab):$.default.formatMessage(Lh.upgradeTab)},billing:()=>$.default.formatMessage(Lh.billingTab),subscription:()=>$.default.formatMessage(Lh.subscriptionTab),security:()=>$.default.formatMessage(Lh.securityTab),identity_provisioning:()=>$.default.formatMessage(Lh.identityProvisioningTab),admin_content_search:()=>$.default.formatMessage(Lh.adminContentSearchTab),integrations:()=>$.default.formatMessage(Lh.spaceConnectionsTab),experiments:()=>$.default.formatMessage(Lh.experimentsTab),audit_log:()=>$.default.formatMessage(Lh.auditLogTab),debug_zone:()=>$.default.formatMessage(Lh.debugZoneTab),analytics:()=>$.default.formatMessage(Lh.analyticsTab),imports:()=>$.default.formatMessage(Lh.importTab),publishing:()=>$.default.formatMessage(Lh.publishingTab)},Vh={profile:()=>null,notifications_and_settings:()=>null,user_settings:()=>null,notifications:()=>null,connected_apps:()=>null,language_and_region:()=>null,settings:()=>null,teams:()=>null,members:()=>null,plans:()=>null,billing:()=>null,subscription:()=>null,security:()=>null,identity_provisioning:()=>null,publishing:()=>null,admin_content_search:()=>null,integrations:()=>Zt.default.checkGate("webhooks_beta")?(0,r.jsx)(Mo.Z,{}):null,experiments:()=>null,audit_log:()=>null,debug_zone:()=>null,analytics:()=>null,imports:()=>null};var Uh=s(34859),Wh=s(93349),zh=s(31796),Kh=s(27533);const Hh={workspaceBalance:(0,r.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.workspaceSubscriptionBalance.title",defaultMessage:"Workspace balance"}),applyCoupon:(0,r.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.applyCoupon.title",defaultMessage:"Apply coupon"}),discount:(0,r.jsx)(g.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.discount.title",defaultMessage:"Discount"})};var Gh=s(53336);const qh=(0,g.defineMessages)({apply_credit:{id:"spaceSubscriptionBilling.applyCreditButton.label",defaultMessage:"Apply credit"},update:{id:"spaceSubscriptionBilling.updateButton.label",defaultMessage:"Update"},add:{id:"spaceSubscriptionBilling.addButton.label",defaultMessage:"Add"},apply:{id:"spaceSubscriptionBilling.apply.label",defaultMessage:"Apply"}});class Yh extends n.Z{renderComponent(){const{title:e,caption:t,buttonArgs:s}=this.props,i=(0,r.jsx)(g.FormattedMessage,{...qh[s.buttonPurpose]});return(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:14},children:[(0,r.jsx)("div",{style:{marginRight:"auto"},children:e}),(0,r.jsx)("div",{style:{color:this.theme.mediumTextColor},children:t}),(0,r.jsx)("div",{style:{minWidth:110,display:"flex",justifyContent:"flex-end"},children:s.showButton&&(0,r.jsx)(Ze.Z,{isBlue:!0,onClick:s.onClick,style:Yh.buttonStyle,children:i})})]})}}Yh.displayName="SubscriptionBillingSettingOption",Yh.buttonStyle={marginLeft:18,marginRight:-4,fontWeight:p.Z.fontWeight.medium};const Qh=(0,g.injectIntl)(Yh);class $h extends n.Z{constructor(){super(...arguments),this.storeTypes={store:Wh.Z}}willMount(){Li.bi(this.environment),Li.zb(this.environment,this.stores.store)}renderComponent(){const{data:e}=this.props;return Vi.Z.state.online?(0,r.jsx)("div",{style:$h.wrapStyle,children:(0,r.jsxs)(Gh.Z,{style:$h.scrollerStyle,type:Uh.Z.Y,children:[(0,r.jsx)(zt.Z,{large:!0,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{...Lh.billingTab})}),this.renderCredit(e),this.renderSeparator(),(0,r.jsx)(zh.V,{spaceStore:this.props.spaceStore,events:this.stores.store.state.billingEvents,upcomingInvoiceData:void 0})]})}):$h.renderOfflineMessage()}static renderOfflineMessage(){return(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(It.Z,{isSmall:!0,style:{textAlign:"center"},children:Ei.s.offline})})}renderCredit(e){var t;const s=null===(t=e.customerData)||void 0===t?void 0:t.stripe.currencyCode;if(!s)return null;const i=-Math.min(0,e.accountBalance);return(0,r.jsx)(Qh,{title:Hh.workspaceBalance,caption:(0,r.jsx)("div",{children:(0,r.jsx)(Kh.W,{cost:{amount:i,currencyCode:s},trailingZeroDisplay:"stripIfInteger"})}),buttonArgs:{showButton:!1,buttonPurpose:"apply_credit",onClick:d.ZT}})}renderSeparator(){return(0,r.jsx)("div",{style:{flex:"none",marginTop:30}})}}$h.displayName="SpaceSubscriptionBillingUnsubscribed",$h.wrapStyle={display:"flex",flexDirection:"column",height:"100%"},$h.scrollerStyle={height:"100%",padding:"36px 60px"};const Xh=$h;var Jh=s(30120),ef=s(2585),tf=s(12139);class sf extends Z.default{getInitialState(){return{termType:"yearly"}}}const nf=new sf;var af=s(22616),of=s(64891),rf=s(38461),lf=s(65965);class df extends n.Z{renderComponent(){const e="yearly"===nf.state.termType?"monthly":"yearly";return(0,r.jsxs)("div",{style:df.getTermToggleStyle(this.theme),onClick:()=>{y.iw$(this.environment,{from:"pricing_grid_top",toggle_to:e}),nf.setState({...nf.state,termType:e})},children:[(0,r.jsx)("div",{style:{marginRight:8},children:(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.pricingTermToggle.payAnnually.label",defaultMessage:"Pay annually"})}),(0,r.jsx)(Rr.Z,{on:"monthly"===nf.state.termType}),(0,r.jsx)("div",{style:{marginLeft:8},children:(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.pricingTermToggle.payMonthly.label",defaultMessage:"Monthly"})})]})}static getTermToggleStyle(e){return{cursor:"pointer",fontSize:14,color:e.mediumTextColor,display:"flex",alignItems:"center",marginBottom:8}}}df.displayName="PricingTermToggle";const cf=df;const uf=function(e){return!!e.device.isMobile||e.WindowSizeStore.state.width<960};var mf=s(73796),pf=s(33493),gf=s(173);const hf=["free","plus","business","enterprise"];class ff extends n.Z{willMount(e){const t=Oi.XX(e.data);t&&e.data&&nf.setState({termType:"year"===t.interval?"yearly":"monthly"})}renderComponent(){const e=(0,lf.Sl)();return(0,r.jsx)("div",{children:(0,r.jsxs)("table",{style:ff.getTableStyle(),children:[this.renderHeader(),(0,r.jsx)("tbody",{children:e.map(((e,t)=>this.renderSection(e,t)))})]})})}renderCheck(){return(0,zd.k)({display:"inline",height:12,width:12,color:this.theme.regularTextColor})}upgradeLink(e,t){const{planState:s}=this.props;if(s)return(0,r.jsx)(wo.Z,{onClick:s.plans[e].onClick,style:{fontSize:12,fontWeight:500,textDecoration:"none",color:this.theme.mediumTextColor,lineHeight:1.2},children:t||(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.planAttribute.button.upgrade",defaultMessage:"Upgrade"})})}renderPlanContent(e){const{label:t,upgradeCta:s,upgradeCTALabel:n}=e;return t&&s?(0,r.jsxs)(i.Fragment,{children:[t,(0,r.jsx)("br",{}),this.upgradeLink(s,n)]}):t||(s?(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.planAttribute.notInTrial",defaultMessage:"Not in trial"}),(0,r.jsx)("br",{}),this.upgradeLink(s,n)]}):this.renderCheck())}renderPlan(e,t,s){return(0,r.jsx)("td",{style:{...ff.getRowStyle(this.theme),...ff.getValueStyle(),...ff.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)},children:s.hasFeature&&(0,r.jsx)(fe.Z,{delayThreshold:0,placement:fe.Z.Placement.Right,renderTooltip:()=>(0,lf.O_)(t),textWrap:!0,render:e=>(0,r.jsx)("div",{style:{cursor:"help",lineHeight:1.3,padding:"6px 0"},...e,children:this.renderPlanContent(s)})})})}renderItem(e,t){const s="auto",i=this.props.planState&&this.props.planState.isTeamTrial;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{style:{...ff.getRowStyle(this.theme),...ff.getRowLabelStyle(this.theme),width:s,maxWidth:s,minWidth:s},children:(0,r.jsx)(fe.Z,{delayThreshold:0,placement:fe.Z.Placement.Right,renderTooltip:()=>(0,lf.O_)(e.tooltip),textWrap:!0,render:t=>(0,r.jsxs)("span",{...t,style:ff.getTooltipInnerStyle(),children:[e.label,e.isComingSoon&&this.renderBadge("comingSoon"),e.isBeta&&this.renderBadge("beta")]})})}),hf.map((t=>{const s="plus"===t&&i?"teamTrial":t;return this.renderPlan(t,e.tooltip,e.plans[s])}))]},`table-row-${t}`)}renderEmptyTableCell(e,t){return(0,r.jsx)("td",{style:{...ff.getSectionStyle(this.theme,t),...ff.getValueStyle(),...ff.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e),color:mt.ZP.lightTextColor,fontWeight:400}})}renderEmptyTableCells(e){return(0,r.jsx)(i.Fragment,{children:hf.map((t=>this.renderEmptyTableCell(t,e)))})}renderSection(e,t){const s="auto";return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{style:{...ff.getSectionStyle(this.theme,t),width:s,maxWidth:s,minWidth:s},children:e.label}),this.renderEmptyTableCells(t)]}),e.items.map(((e,t)=>this.renderItem(e,t)))]},`table-section-${t}`)}renderButton(e,t){const s=this.getProductCost(e),i=t.plans[e],n=`notion-pricing-grid-upgrade-${e}`;let a;switch(i.buttonType){case"current":a=(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.currentPlanButton.label",defaultMessage:"Current"});break;case"upgrade":a=(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.upgradePlanButton.label",defaultMessage:"Upgrade"});break;case"downgrade":a=(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.downgradePlanButton.label",defaultMessage:"Downgrade"});break;case"will-downgrade":a=(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.willDowngradePlanButton.label",defaultMessage:"Future plan"});break;case"resubscribe":a=(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.resubscribePlanButton.label",defaultMessage:"Resubscribe"});break;default:_.t1(i.buttonType)}if("current"===i.buttonType)return this.renderDisabledButtonWithTooltip({tooltip:(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.currentPlan.tooltip",defaultMessage:"This is your current active plan"}),label:(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.currentPlan.largeScreenLabel",defaultMessage:"Current plan"}),buttonClassName:n,wrapTooltip:!1});if(!t.canSwitchPlans){let e;return e=t.isInAppPurchase?(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.switchPlanFromInAppPurchase.tooltip",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."}):(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.switchPlanAsMember.tooltip",defaultMessage:"You need to be an administrator of this workspace to switch plans."}),this.renderDisabledButtonWithTooltip({tooltip:e,label:a,buttonClassName:n,wrapTooltip:!0})}return"will-downgrade"===i.buttonType?this.renderDisabledButtonWithTooltip({tooltip:(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.willDowngradePlan.tooltip",defaultMessage:"This is the plan after your current plan expires"}),label:(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.willDowngradePlan.largeScreenLabel",defaultMessage:"Future plan"}),buttonClassName:n,wrapTooltip:!1}):"downgrade"===i.buttonType?(0,r.jsx)(Wt.Z,{isLarge:!0,style:{width:"100%"},onClick:()=>{y.rOZ(this.environment,{plan:e,currency_code:pf.Z.selectedCurrencyCode,from:"pricing_grid_top",button_text:i.buttonType}),i.onClick()},className:n,children:a}):(0,r.jsx)(ce.Z,{isLarge:!0,style:{width:"100%"},disabled:!s,onClick:()=>{y.rOZ(this.environment,{plan:e,currency_code:pf.Z.selectedCurrencyCode,from:"pricing_grid_top",button_text:i.buttonType}),i.onClick()},className:n,children:a})}renderDisabledButtonWithTooltip(e){const{tooltip:t,label:s,buttonClassName:i,wrapTooltip:n}=e;return(0,r.jsx)(fe.Z,{style:{width:n?320:"auto"},textWrap:n,renderTooltip:()=>t,render:e=>(0,r.jsx)(Wt.Z,{style:{width:"100%",opacity:.5},isLarge:!0,disabled:!0,...e,className:i,children:s})})}renderSalesContactLink(e){const t=`setup_${e}_trial`;return(0,r.jsx)(wo.Z,{onClick:()=>{const{currentUserStore:e}=I.default.state,s=null!=e&&e.isDefined()?e.getModel():void 0;y.EUb(this.environment),mf.Z.setState({open:!0,email:s&&s.getEmail(),name:null==s?void 0:s.getDisplayName(this.props.intl),question:t})},children:(0,r.jsx)("div",{style:ff.getUpgradeButtonBelowLinkStyle(),children:(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.requestATrial",defaultMessage:"or Request a Trial"})})})}getPlanName(e){const{intl:t}=this.props;switch(e){case"free":return t.formatMessage(Zd.a.free);case"plus":return t.formatMessage(Zd.a.plus);case"business":return t.formatMessage(Zd.a.business);case"enterprise":return t.formatMessage(Zd.a.enterprise);default:_.t1(e)}}getTerms(e){switch(e){case"free":return;case"plus":case"business":case"enterprise":return"per_member_per_month";default:_.t1(e)}}getProductCost(e){var t;if("free"===e)return{amount:0,currencyCode:pf.Z.selectedCurrencyCode};const s="monthly"===nf.state.termType?"month":"year",i=pf.Z.getPrice(this.environment,(t=>t.billingInterval===s&&t.product===e));return i.isLoaded?null===(t=i.result)||void 0===t?void 0:t.getMonthlyUnitCost().toMoneyValue():void 0}renderHeaderTitle(e){const t=this.getPlanName(e),s=this.getProductCost(e),i=this.getTerms(e);return(0,r.jsxs)("td",{style:{...ff.getHeaderStyle(),...ff.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)},children:[(0,r.jsx)("div",{style:this.getHeaderTitleStyle(),children:t}),s?(0,r.jsxs)("div",{style:{display:uf(this.environment)?"block":"flex"},children:[(0,r.jsx)("div",{style:ff.getHeaderPriceStyle(),children:(0,r.jsx)(Kh.W,{cost:s,trailingZeroDisplay:"stripIfInteger"})}),i?(0,r.jsx)("div",{style:this.getHeaderTermsStyle(this.theme),children:(0,lf.X6)(this.props.intl,i)}):null]}):(0,r.jsx)(gf.u,{})]})}renderHeaderTitles(){return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{}),hf.map((e=>(0,r.jsx)(i.Fragment,{children:this.renderHeaderTitle(e)},e)))]})}renderHeaderAction(e){const{planState:t}=this.props;if(t)return(0,r.jsxs)("td",{style:{...ff.getHeaderStyle(),...ff.getActiveStyle(this.theme,this.isPlanActive(e)),...this.getBorderStyle(e)},children:[this.renderButton(e,t),this.renderHeaderSubAction(e)]})}renderHeaderSubAction(e){if((0,m.Rs)(e))return(0,r.jsx)("div",{style:{marginTop:7},children:this.renderSalesContactLink(e)})}renderHeaderActions(){if(this.props.planState)return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{style:{width:"28%",verticalAlign:"top",paddingTop:16},children:(0,r.jsx)(cf,{})}),hf.map((e=>this.renderHeaderAction(e)))]})}renderHeader(){return(0,r.jsxs)("thead",{children:[this.renderHeaderTitles(),this.renderHeaderActions()]})}renderBadge(e){return(0,r.jsxs)("div",{style:{background:this.theme.buttonHoveredBackground,fontSize:10,fontWeight:500,letterSpacing:"0.015em",color:this.theme.mediumTextColor,display:"inline",textTransform:"uppercase",padding:"2px 4px",marginLeft:6,borderRadius:3,whiteSpace:"nowrap",position:"relative",top:-1},children:["comingSoon"===e&&(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.comingSoonBadge",defaultMessage:"Coming soon"}),"beta"===e&&(0,r.jsx)(g.FormattedMessage,{id:"pricingGrid.betaBadge",defaultMessage:"Beta"})]})}isPlanActive(e){return Boolean(this.props.planState&&this.props.planState.plans[e].isActive)}static getTableStyle(){return{fontSize:14,width:"100%",tableLayout:"fixed",borderCollapse:"initial"}}static getSectionStyle(e,t){const s={borderBottom:`1px solid ${e.regularDividerColor}`,paddingBottom:7,paddingRight:15,fontWeight:500,verticalAlign:"bottom"};return 0===t?{...s,paddingTop:0}:{...s,paddingTop:20}}static getUpgradeButtonBelowLinkStyle(){return{fontSize:12}}static getRowStyle(e){return{borderBottom:`1px solid ${e.regularDividerColor}`}}static getRowLabelStyle(e){return{color:e.mediumTextColor,paddingRight:10,paddingTop:5,paddingBottom:6,verticalAlign:"top"}}static getValueStyle(){return{paddingLeft:10,paddingRight:10,textAlign:"left",overflow:"hidden",verticalAlign:"top"}}static getActiveStyle(e,t){const s=e.cardSidebarBackground;return{background:t?s:mt.ZP.transparent}}getBorderStyle(e){return{borderLeft:`1px solid ${this.theme.lightDividerColor}`,borderRight:["enterprise"].includes(e)?`1px solid ${this.theme.lightDividerColor}`:void 0}}static getHeaderStyle(){return{paddingLeft:10,paddingRight:10,verticalAlign:"top",width:"18%",paddingTop:10}}getHeaderTitleStyle(){return{fontSize:16,fontWeight:uf(this.environment)?500:700,lineHeight:1.3,marginBottom:2,paddingTop:40}}static getHeaderPriceStyle(){return{fontSize:20,marginRight:7}}static getTooltipInnerStyle(){return{cursor:"help",width:"100%",display:"inline-block"}}getHeaderTermsStyle(e){return{fontSize:10,lineHeight:1,color:e.mediumTextColor,width:70,paddingTop:uf(this.environment)?0:3}}}ff.displayName="PricingGrid";const yf=(0,g.injectIntl)(ff);var vf=s(70060),xf=s(40001),Sf=s(91754),bf=s(32617),Mf=s(10644);function wf(e){window.__c={n:"StudentUpgrade"};const{handleEducationPlanClick:t}=e,s=(0,lt.yK)((e=>({subsection:{fontSize:14,marginTop:40},subsectionTitle:{fontSize:20,fontWeight:p.Z.fontWeight.bold,marginBottom:12},content:{color:e.mediumTextColor,marginBottom:15},paragraph:{marginBottom:4},link:{textDecoration:"underline"}})),[]);return(0,r.jsxs)("div",{style:s.subsection,children:[(0,r.jsx)("div",{style:s.subsectionTitle,children:(0,r.jsx)(g.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.title",defaultMessage:"Students & educators"})}),(0,r.jsx)("div",{style:s.content,children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.FormattedMessage,{id:"spaceSubscriptionPlans.studentsAndEducatorsSection.description",defaultMessage:"<p>Students and educators can get access to the Plus Plan features (with a 1-member limit) for free! Just sign up with your school email address, or change your existing email in the 'My account' tab.</p>",values:{p:e=>(0,r.jsx)("div",{style:s.paragraph,children:e})}}),(0,r.jsx)("div",{children:(0,r.jsx)(wo.Z,{onClick:t,style:s.link,children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Get the Education Plan",id:"sidebarStudentPlanPrompt.eligible.getFreePromptPlus"})})}),(0,r.jsx)("div",{children:(0,r.jsx)(wo.Z,{external:!0,href:(0,yi.UY)("guides.students"),children:(0,r.jsx)(g.FormattedMessage,{id:"spaceSubscriptionPlans.studentSection.link",defaultMessage:"For more info, go to notion.com/students."})})})]})})]})}function jf(e){window.__c={n:"TrialBanner"};const{subscriptionData:t}=e,s=(0,lt.yK)((e=>({text:{color:e.accentColors[500]}})),[]),i=Oi.XX(t);return i&&i.trialEnd?i.trialEnd<Jh.ou.now().toSeconds()?null:(0,r.jsx)(Sf.Z,{styleKey:Sf.v.Beige,isMobile:!1,children:(0,r.jsx)("div",{style:s.text,children:(0,r.jsx)(g.FormattedMessage,{id:"SpaceSubscriptionPlans.trials.bannerText",defaultMessage:"Your workspace is on a free trial until {trialEndDate}",values:{trialEndDate:(0,pt.Yx)(1e3*i.trialEnd,"long",is.SP)}})})}):null}class Cf extends n.Z{constructor(){super(...arguments),this.storeTypes={store:Rp.Z,downgradeModalStore:xf.ZP,securitySettingsStore:bi.Z},this.renderChurnSurveyModal=()=>{const e=this.stores.store.state,{data:t}=this.props,s=Oi.XX(t),i=io.zt();if(e.churnSurveyModalOpen&&i&&s)return(0,r.jsx)(Np.Z,{churnType:e.churnType,currentPlan:i,isWorkspaceDeletion:!1,periodEnd:s.periodEnd,hasAI:(0,u.de)(s.addOns),hasPendingChanges:Boolean(s.schedule||s.willCancelAt),customerId:s.customerId,onAccept:this.handleChurnSurveyModalAccept,onClose:this.handleChurnSurveyModalClose})},this.handlePlansBackButtonClick=()=>{const{store:e}=this.stores;e.setState({...e.state,page:"default"})},this.handleFreeClick=async()=>{const{data:e}=this.props;let t="no_confirmation_required";e&&"subscribed_admin"===e.type&&(t=await new Promise((e=>{const{store:t}=this.stores;t.setState({...t.state,churnType:"free",churnSurveyModalOpen:!0,onAccept:t=>e(t?"churn_immediately":"churn_by_end_of_billing_period"),onClose:()=>e("no_churn")})})),"no_churn"===t)||await Li.EO({environment:this.environment,spaceStore:this.props.spaceStore,planType:"personal",from:"space_settings-plans_tab",cancelImmediately:"churn_immediately"===t})},this.handleEducationPlanClick=()=>{const{spaceStore:e}=this.props;Li.r7({environment:this.environment,spaceStore:e})},this.handlePlanChangeClick=async e=>{const{spaceStore:t,data:s}=this.props,i=Oi.XX(s);if(!i||!Oi.MM(s))return void Li.I0(this.environment,{subscriptionTier:e,from:"pricing_grid"});const n=io.zt();if(n&&m.rC[e]<m.rC[n]){if(!(await new Promise((t=>{const{store:s}=this.stores;s.setState({...s.state,churnType:e,churnSurveyModalOpen:!0,onAccept:()=>t(!0),onClose:()=>t(!1)})}))))return;try{const s=await async function(e){const{billingInterval:t,environment:s,product:i}=e;await pf.Z.waitUntilReady();const n=pf.Z.getPrice(s,(e=>e.product===i&&e.billingInterval===t));if(!n.result)throw new Error("Could not find price model");return n.result}({environment:this.environment,billingInterval:i.interval,product:e});await Li.Mg({environment:this.environment,spaceStore:t,plan:s.externalId,from:"space_settings-plans_tab"})}catch(a){tf.IE(a),v.deprecatedShowErrorMessage("Sorry, something went wrong. Please try again.")}}else{const t="yearly"===nf.state.termType?"year":"month";of.af({environment:this.environment,from:"plans_page",view:"plans",temporarySubscriptionTier:e,billingInterval:t,pageSection:"all_plans_grid"})}},this.handleChurnSurveyModalAccept=e=>{const{store:t}=this.stores;t.state.churnSurveyModalOpen&&t.state.onAccept(e),t.reset()},this.handleChurnSurveyModalClose=()=>{const{store:e}=this.stores;if(e.state.churnSurveyModalOpen&&e.state.onClose(),"grid"===e.state.page)return e.reset(),void e.setState({...e.state,page:"grid"});e.reset()}}willMount(){Li.bi(this.environment),Li.px(this.environment)}renderComponent(){if(Vi.Z.state.online){const e=vf.$r(),{churnSurveyModalOpen:t,page:s}=this.stores.store.state,i="grid"===s,n=!e||i;return(0,r.jsxs)(r.Fragment,{children:[this.renderBanner(Oi.wY(this.props.data),this.props.intl),(0,r.jsx)(jf,{subscriptionData:this.props.data}),i?(0,r.jsx)(kf,{handlePlansBackButtonClick:this.handlePlansBackButtonClick}):null,(0,r.jsxs)(Gh.Z,{style:{height:"100%",padding:i?"0px 30px 100px 60px":"100px 0px 100px 60px"},type:Uh.Z.Y,children:[(0,r.jsx)(bf.ZP,{data:this.props.data,spaceStore:this.props.spaceStore,spaceSubscriptionPlansStore:this.stores.store}),n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(bo.Z,{size:0}),this.renderPricingGrid(),this.allowEducationUpgrade()?(0,r.jsx)(wf,{handleEducationPlanClick:this.handleEducationPlanClick}):null,this.renderFAQ(),(0,r.jsx)(Bo.Z,{innerStyle:{width:300,height:"auto",overflow:"scroll"},open:t,render:this.renderChurnSurveyModal,onDismiss:this.handleChurnSurveyModalClose})]}):null]})]})}return(0,r.jsx)(Mf.Z,{})}renderPricingGrid(){const e=this.getPlanState();return(0,r.jsx)(yf,{planState:e,data:this.props.data})}renderFAQ(){return(0,r.jsxs)("div",{style:Cf.subsectionStyle,children:[(0,r.jsx)("div",{style:Cf.subsectionTitleStyle,children:(0,r.jsx)(g.FormattedMessage,{id:"spaceSubscriptionPlans.faqSection.title",defaultMessage:"FAQ"})}),(0,r.jsx)(wo.Z,{external:!0,href:(0,yi.UY)("guides.billingAndPaymentRevised"),children:(0,r.jsx)(g.FormattedMessage,{id:"spaceSubscriptionPlans.faqSection.link",defaultMessage:"Plans, Billing & Payment"})})]})}renderBanner(e,t){const s=(0,io.zt)();if(!s)return null;if((0,bf.lu)(e,s)){const i=(0,bf.QH)(e,s);return(0,r.jsx)(Sf.Z,{styleKey:Sf.v.Beige,isMobile:!1,children:(0,r.jsx)("div",{style:{color:this.theme.accentColors[500]},children:i&&t.formatMessage(i)})})}return null}getMemberCount(){return Oi.su(this.props.data)}canSwitchPlans(){const e=Oi.wY(this.props.data);return this.props.spaceStore.canAdmin()&&!e}calculateButtonState(e){const{data:t}=this.props,s=Oi.DH(t);return(0,m.QM)(e)?{free:"current",plus:"upgrade",business:"upgrade",enterprise:"upgrade"}:(0,m.Aw)(e)?{free:s?"current":"downgrade",plus:"upgrade",business:"upgrade",enterprise:"upgrade"}:(0,m.eR)(e)?{free:"downgrade",plus:s?"resubscribe":"current",business:"upgrade",enterprise:"upgrade"}:"business"===e?{free:"downgrade",plus:"downgrade",business:s?"resubscribe":"current",enterprise:"upgrade"}:"enterprise"===e?{free:"downgrade",plus:"downgrade",business:"downgrade",enterprise:s?"resubscribe":"current"}:void(0,_.t1)(e)}isButtonStateActive(e){return["current","resubscribe"].includes(e)}getPlanState(){const e=io.zt();if(!e)return;const t=Oi.wY(this.props.data),s=this.calculateButtonState(e);return{plans:{free:{buttonType:s.free,isActive:this.isButtonStateActive(s.free),onClick:this.handleFreeClick},plus:{buttonType:s.plus,isActive:this.isButtonStateActive(s.plus),onClick:()=>this.handlePlanChangeClick("plus")},business:{buttonType:s.business,isActive:this.isButtonStateActive(s.business),onClick:()=>this.handlePlanChangeClick("business")},enterprise:{buttonType:s.enterprise,isActive:this.isButtonStateActive(s.enterprise),onClick:()=>this.handlePlanChangeClick("enterprise")}},isTeamTrial:!1,isInAppPurchase:t,canSwitchPlans:this.canSwitchPlans(),memberCount:this.getMemberCount()}}allowEducationUpgrade(){const{data:e}=this.props,t=this.getPlanState(),s=io.zt();return t&&t.canSwitchPlans&&!Oi.wl(e)&&1===t.memberCount&&("free"===s||"personal"===s)}}function kf(e){window.__c={n:"AllPlansButton"};const{handlePlansBackButtonClick:t}=e,s=(0,lt.yK)((()=>({backButton:{display:"inline-flex",padding:10},icon:{height:16,marginTop:4,width:16},settingHeader:{alignItems:"center",display:"flex",flexGrow:1,fontSize:16,fontWeight:p.Z.fontWeight.medium,justifyContent:"space-between",marginBottom:0,padding:"10px 0 10px 5px"},wrapper:{display:"flex",padding:"30px 30px 0px 60px"}})),[]),{availableCurrencyCodes:i,selectedCurrencyCode:n}=(0,N.VK)((()=>({availableCurrencyCodes:pf.Z.availableCurrencyCodes,selectedCurrencyCode:pf.Z.selectedCurrencyCode})),[]);return(0,r.jsxs)("div",{style:s.wrapper,children:[(0,r.jsx)(Pc.Z,{style:s.backButton,onClick:t,children:(0,ef.f)(s.icon)}),(0,r.jsxs)(zt.Z,{large:!0,style:s.settingHeader,children:[(0,r.jsx)(g.FormattedMessage,{id:"spaceSubscriptionPlans.allPlans.title",defaultMessage:"All plans"}),(0,r.jsx)(rf.V,{availableCurrencyCodes:i,from:"pricing_grid",onSelectCurrency:af.y,selectedCurrencyCode:n})]})]})}Cf.displayName="SpaceSubscriptionPlans",Cf.subsectionStyle={fontSize:14,marginTop:40},Cf.subsectionTitleStyle={fontSize:20,fontWeight:p.Z.fontWeight.bold,marginBottom:12};const _f=(0,g.injectIntl)(Cf);var Tf=s(42982);const If="teamColumn",Pf="ownersColumn",Zf="membersColumn",Ff="AccessLevelColumn",Af="lastUpdatedColumn",Df="contextMenuColumn",Bf=[If,Zf,Ff,Af],Rf="filterAccessAny",Lf="filterAccessOnlyOpen",Nf="filterAccessOnlyClosed",Ef="filterAccessOnlyPrivate",Of="filterOwnerAny",Vf="filterOwnerShowOrphaned",Uf="filterOwnerById";class Wf extends Z.default{getInitialState(){return{searchQuery:"",sortColumn:Af,sortAscending:!1,showOnlyArchivedTeams:!1,filterByOwner:{type:Of},filterAccess:Rf,showTeamsWithSecurityOverrides:!1}}}const zf=new Wf;function Kf(e){let{environment:t,teamIds:s}=e;const{currentSpaceStore:i,currentUserStore:n}=I.default.state;return i&&n?s.map((e=>{const s=nt.zX.createChildStore(i,{table:ms.e0,id:e,spaceId:i.id});if(s.canRead())return s;const n=i&&Ic.Dv({environment:t,teamId:s.id,spaceStore:i,from:"manage_teams_table"});return null!=n&&n.canRead()?n:void 0})).filter(_.$K):[]}var Hf=s(51923);class Gf extends Z.default{getInitialState(){return{tokenQuery:"",showAutoCompletePopup:!1,defaultTeams:{}}}addedAndCurrentTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"current-default"===t||"add-default"===t}))}addedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"add-default"===t}))}removedTeams(){return Object.values(this.state.defaultTeams).filter((e=>{let{state:t}=e;return"remove-default"===t}))}}const qf=new Gf;function Yf(e){var t;let{team:s}=e;return null===(t=qf.state.defaultTeams[s.id])||void 0===t?void 0:t.state}function Qf(e){let{team:t,persistedDefaultTeams:s}=e;if(s.includes(t))$f({store:t,state:"current-default"});else{const e={...qf.state.defaultTeams};delete e[t.id],qf.setState({...qf.state,defaultTeams:e})}}function $f(e){const t=qf.state;qf.setState({...t,defaultTeams:{...t.defaultTeams,[e.store.id]:e}})}var Xf=s(75024),Jf=s(30676),ey=s(47082);function ty(e){let{}=e;window.__c={n:"DefaultTeamsInput"};const t=(0,L.Fy)(),s=(0,g.useIntl)(),n=(0,L.O7)(),{allTeams:a,loaded:o}=(0,N.VK)((()=>{const e=A.state;return"loaded"!==e.loadingState?{allTeams:[],loaded:!1}:{allTeams:Kf({environment:n,teamIds:e.unarchivedTeamIds}),loaded:!0}}),[n]),[l,c]=(0,i.useState)(!1),u=(0,N.qz)(qf),m=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),{defaultTeams:p,tokenQuery:h}=(0,N.VK)((()=>{const{defaultTeams:e,tokenQuery:t}=u.state;return{defaultTeams:e,tokenQuery:t}}),[u]),f=!h,{addedTeams:y,removedTeams:v,addedAndCurrentTeams:x}=(0,N.VK)((()=>({addedAndCurrentTeams:u.addedAndCurrentTeams(),addedTeams:u.addedTeams(),removedTeams:u.removedTeams()})),[u]),S=(0,N.VK)((()=>a.reduce(((e,t)=>(e[t.id]=t.getName(),e)),{})),[a]),b=(0,N.VK)((()=>a.filter((e=>e.isDefault()))),[a]);(0,i.useEffect)((()=>function(e){let{persistedDefaultTeams:t}=e;const s=t.reduce(((e,t)=>(e[t.id]={state:"current-default",store:t},e)),{}),i=qf.state;qf.setState({...i,defaultTeams:s})}({persistedDefaultTeams:b})),[b]);const M=y.length>0||v.length>0,w=e=>function(e){let{team:t,persistedDefaultTeams:s}=e;"add-default"===Yf({team:t})?Qf({team:t,persistedDefaultTeams:s}):$f({store:t,state:"remove-default"})}({team:e,persistedDefaultTeams:b}),j=e=>{!function(e){let{team:t,persistedDefaultTeams:s}=e;"remove-default"===Yf({team:t})?Qf({team:t,persistedDefaultTeams:s}):$f({store:t,state:"add-default"})}({team:e,persistedDefaultTeams:b}),u.update((e=>({...e,showAutoCompletePopup:!1,tokenQuery:""})))},C=new Set(v.map((e=>e.store.id))),k=n.currentUser.id,_=(0,N.VK)((()=>k?a.filter((e=>{const t=e.getMembers(),s=e.getSettingsStore().getValue();return!!s&&((0,En.pd)({membership:t},k)&&"open"===(0,En.B5)(s))})):[]),[a,k]),T=function(e){let{query:t,addedAndCurrentTeams:s,eligibleDefaultTeams:i,teamIdsToNames:n}=e;const a=new Set;for(const o of s)a.add(o.store.id);return(0,kt.ZP)(t,i,(e=>n[e.id]??""))}({query:h,addedAndCurrentTeams:x,teamIdsToNames:S,eligibleDefaultTeams:_}),P=[];T.length>0&&!f&&P.push({key:"default-teams-list",render:e=>(0,r.jsx)(he.Z,{...e,title:(0,r.jsx)(g.FormattedMessage,{id:"defaultTeamsInput.defaultTeamList.title",defaultMessage:"Teamspaces"}),loading:!1}),items:T.map((e=>({key:e.id,render:t=>(0,r.jsx)(Jf.F,{...t,teamStore:e}),action:()=>j(e)})))});const Z=(0,N.VK)((()=>u.state.showAutoCompletePopup&&P.length>0),[u,P.length]),F=(0,lt.yK)((e=>({defaultTeamsHeader:{fontSize:14,marginBottom:2},inputAndButtonContainer:{paddingTop:12,display:"flex"},inputContainer:{flexGrow:1},tokenInputMenu:{borderRadius:Z?ny:iy,margin:0},menuList:{maxHeight:300,border:`1px solid ${e.regularDividerColor}`,borderTop:0,borderRadius:ay},updateButton:{marginLeft:10,height:35}})),[Z]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:F.defaultTeamsHeader,children:(0,r.jsx)(g.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.title",defaultMessage:"Default teamspaces"})}),(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,children:(0,r.jsx)(g.FormattedMessage,{id:"teamsWorkspaceSettings.defaultTeams.caption",defaultMessage:"Choose teamspaces that all new and current workspace members will automatically join"})}),(0,r.jsxs)("div",{style:F.inputAndButtonContainer,children:[(0,r.jsx)("div",{style:F.inputContainer,children:(0,r.jsx)(ge.ZP,{popupType:ge.ZP.PopupType.Popup,placementToOrigin:ge.ZP.Placement.Bottom,sameWidthAsOrigin:!0,open:Z,borderRadius:ay,onDismiss:()=>u.update((e=>({...e,showAutoCompletePopup:!1}))),origin:(0,r.jsx)(ey.Z,{disabled:!o||l,style:F.tokenInputMenu,focusInitial:t.isMobile,focusAfterAnimation:!0,format:ey.Z.Format.Share,inputDivStyle:{alignItems:"center"},value:h,onChange:e=>u.update((t=>({...t,tokenQuery:e.target.value,showAutoCompletePopup:!0}))),type:"default-teams",tokens:Object.values(p).filter((e=>!C.has(e.store.id))).map((e=>(0,r.jsx)(sy,{teamStore:e.store,onClickRemove:w},e.store.id))),placeholder:s.formatMessage({id:"teamsWorkspaceSettings.defaultTeams.inputPlaceholder",defaultMessage:"Select a default teamspace..."}),onRemoveLastToken:()=>{const e=x,t=d.Z$(e);t&&w(t.store)},onEmptySubmit:d.yR,showBorder:!0}),render:()=>(0,r.jsx)(me.Z,{menuType:ye.og.Popup,tokenInputHeader:!0,disableHeaderBorder:!0,children:(0,r.jsx)("div",{style:F.menuList,children:(0,r.jsx)(pe.Z,{type:pe.i.Vertical,initialFocus:0,sections:P})})})})}),(0,r.jsx)(ce.Z,{style:F.updateButton,disabled:!M||l,isLarge:!0,onClick:async()=>{if(m){c(!0);try{await async function(e){let{addedTeams:t,removedTeams:s,environment:i,spaceStore:n}=e;if(!n.isDefined())return!1;const a=n.getPermissionItems();return await Ic.lH({addedStores:t.map((e=>{let{store:t}=e;return t})),removedStores:s.map((e=>{let{store:t}=e;return t})),environment:i,spaceValue:{permissions:a},createNewTeamFlowId:void 0,from:"workspace_settings"})}({environment:n,addedTeams:y,removedTeams:v,spaceStore:m})}finally{c(!1)}}},children:(0,r.jsx)(g.FormattedMessage,{id:"teamsWorkspaceSettings.updateButton.label",defaultMessage:"Update"})})]})]})}function sy(e){window.__c={n:"DefaultTeamsToken"};const t=(0,L.Fy)(),{teamStore:s,onClickRemove:i}=e,{name:n}=(0,N.VK)((()=>({name:s.getName()})),[s]);return(0,r.jsx)(ca.Z,{showRemoveButton:!0,isSingle:!1,format:t.isMobile?aa.l.Large:aa.l.Medium,style:{marginLeft:6},onClickRemove:()=>i(s),value:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,r.jsx)(Bn.p,{disabled:!0,store:s,size:14,style:{marginRight:4}}),n]})})}const iy=3,ny=(0,Xf.wK)({topLeft:iy,topRight:iy,bottomLeft:0,bottomRight:0}),ay=(0,Xf.wK)({topLeft:0,topRight:0,bottomLeft:iy,bottomRight:iy}),oy=(0,o.I)("key",{viewBox:"0 0 30 30",svg:(0,r.jsx)("path",{d:"M14.757 4A5.724 5.724 0 009 9.748c0 2.364 1.389 4.456 3.586 5.335V23.6c0 .255.079.483.272.676l1.53 1.477a.578.578 0 00.808-.009l2.769-2.768a.598.598 0 000-.87l-1.591-1.574 2.232-2.232a.602.602 0 00-.017-.861l-2.171-2.18c2.628-1.116 4.087-3.13 4.087-5.511A5.733 5.733 0 0014.757 4zm0 5.344a1.55 1.55 0 01-1.547-1.547c0-.861.685-1.547 1.547-1.547a1.55 1.55 0 011.547 1.547 1.55 1.55 0 01-1.547 1.547z"})});var ry=s(17224);function ly(e){let{selectItems:t,currentSelectedItem:s,onChange:i,icon:n}=e;return(0,r.jsx)(ya.Z,{items:t,getKey:e=>e.key,selectedItem:s,onSelect:i,renderItem:e=>(0,r.jsx)(ue.Z,{title:e.value.name,...e,checkState:s.key===e.value.key}),renderOrigin:e=>(0,r.jsx)(Ie.Z,{...e,title:s.originName??s.name,on:!s.showFilterAsOffWhenSelected,icon:n})})}const dy={[Rf]:{key:Rf,name:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterAllTeams",defaultMessage:"Any"}),originName:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsAccessFilter.accessSelectPlaceolder",defaultMessage:"Access"}),showFilterAsOffWhenSelected:!0},[Lf]:{key:Lf,name:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterOpenTeams",defaultMessage:"Open"})},[Nf]:{key:Nf,name:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterClosedTeams",defaultMessage:"Closed"})},[Ef]:{key:Ef,name:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsAccessFilter.accessFilter.filterPrivateTeams",defaultMessage:"Private"})}},cy=d.oA([dy.filterAccessAny,dy.filterAccessOnlyOpen,dy.filterAccessOnlyClosed,dy.filterAccessOnlyPrivate]);function uy(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsAccessFilter"};const s=(0,L.O7)(),n=(0,N.VK)((()=>t.state.filterAccess),[t]),a=(0,lt.yK)((e=>({keyIcon:{width:18,height:18,...n!==Rf?{fill:mt.ZP.blue}:{fill:e.mediumIconColor}}})),[n]),o=(0,i.useCallback)((e=>{t.update((t=>({...t,filterAccess:e.key}))),ry.GZ(s,{filter:"access",value:e.key})}),[t,s]),l=dy[n];return(0,r.jsx)(ly,{selectItems:cy,currentSelectedItem:l,onChange:o,icon:oy(a.keyIcon)})}const my=(0,o.I)("archiveFilled",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.16211 5.06934H13.5029C14.2754 5.06934 14.665 4.61133 14.665 3.8457V3.22363C14.665 2.45801 14.2754 2 13.5029 2H2.16211C1.43066 2 1 2.45801 1 3.22363V3.8457C1 4.61133 1.38965 5.06934 2.16211 5.06934ZM4.08301 14.585H11.582C12.9287 14.585 13.6465 13.8877 13.6465 12.5479V6.00586H2.01855V12.5479C2.01855 13.8945 2.73633 14.585 4.08301 14.585ZM5.58008 8.47363C5.29297 8.47363 5.09473 8.27539 5.09473 7.97461V7.7627C5.09473 7.46191 5.29297 7.27051 5.58008 7.27051H10.0918C10.3789 7.27051 10.584 7.46191 10.584 7.7627V7.97461C10.584 8.27539 10.3789 8.47363 10.0918 8.47363H5.58008Z"})}),py="showArchived",gy="hideArchived",hy={[gy]:{key:gy,name:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.hideArchivedTeams",defaultMessage:"Active"}),originName:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedSelectPlaceolder",defaultMessage:"Archived"}),showFilterAsOffWhenSelected:!0},[py]:{key:py,name:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsArchivedFilter.archivedFilter.showArchivedTeams",defaultMessage:"Archived"})}};function fy(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsArchivedFilter"};const s=(0,L.O7)(),n=(0,N.VK)((()=>t.state.showOnlyArchivedTeams),[t]),a=(0,lt.yK)((e=>({archiveIcon:{width:16,height:16,marginRight:5,...n?{fill:mt.ZP.blue}:{fill:e.mediumIconColor}}})),[n]),o=[hy.hideArchived,hy.showArchived],l=(0,i.useCallback)((e=>{t.update((t=>({...t,showOnlyArchivedTeams:e.key===py}))),ry.GZ(s,{filter:"archived",value:e.key})}),[t,s]),d=hy[n?py:gy];return(0,r.jsx)(ly,{selectItems:o,currentSelectedItem:d,onChange:l,icon:my(a.archiveIcon)})}const yy="ShowTeamsWithNoOwnersId";function vy(e){let{teamStores:t,manageTeamsStore:s}=e;window.__c={n:"ManageTeamsOwnerFilter"};const n=(0,L.O7)(),a=(0,N.VK)((()=>s.state.filterByOwner),[s]),o=function(e){switch(e.type){case Of:return;case Uf:return e.id;case Vf:return yy;default:(0,_.t1)(e)}}(a),l=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),c=(0,g.useIntl)(),u=(0,N.VK)((()=>{const e=t.flatMap((e=>(0,En.XO)({membership:e.getMembers()})));return d.jj(e)}),[t]),m=(0,lt.yK)((e=>({icon:{marginRight:2,fill:e.mediumIconColor},blueFill:{fill:mt.ZP.blue}})),[]),p=(0,i.useCallback)((e=>{if(l)return zl({userId:e,currentSpaceStore:l}).getValue()}),[l]),h=(0,i.useCallback)((e=>{const t=e[e.length-1];let i;i=t===o||void 0===t?{type:Of}:t===yy?{type:Vf}:{type:Uf,id:t},s.update((e=>({...e,filterByOwner:i}))),ry.GZ(n,{filter:"owner",value:i.type})}),[o,s,n]),f=(0,i.useCallback)((async e=>{let{query:t}=e;if(!l)return[];const s=(await Y.pz({query:t,currentSpaceStore:l,userIds:u})).map((e=>e.id));return""===t?[yy,...s]:s}),[l,u]),y=(0,i.useCallback)(((e,t)=>{if(!l)return null;if(e===yy)return(0,r.jsx)(ue.Z,{...t,title:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsOwnerFilter.noOwnersFilterOption",defaultMessage:"No owners"}),checkState:a.type===Vf,className:"notranslate"});const s=p(e);return s?(0,i.createElement)(it.Z,{...t,key:e,actor:(0,et.m3)(s),checkState:o===e}):null}),[l,p,o,a.type]),v=(0,N.VK)((()=>{if(a.type!==Uf)return;const e=p(a.id);return e?(0,Vn.Nz)(c,e):void 0}),[a,p,c]);let x;return x=a.type===Vf?(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.onlyOrphanedTeams",defaultMessage:"Owner: None"}):v?(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.withSpecifiedOwner",defaultMessage:"Owner: {teamOwnerName}",values:{teamOwnerName:v}}):(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsOwnerFilter.filterTitle.unset",defaultMessage:"Owner"}),(0,r.jsx)(Ye.Z,{mode:Ye.z.Pill,title:x,disabled:0===t.length,icon:tt.f,iconStyles:{...m.icon,...a.type!==Of&&m.blueFill},items:d.oA([o]),hasItemsSelected:(0,_.$K)(o),onChange:h,labelText:{title:x,tokenInputPlaceholder:c.formatMessage({defaultMessage:"Search teamspace owner...",id:"manageTeamsOwnerFilter.searchOwner.placeholder"}),resultSectionTitle:c.formatMessage({defaultMessage:"Select users",id:"manageTeamsOwnerFilter.searchOwner.resultsTitle"}),componentDebugName:"ManageTeamsSearchOwnerFilter"},performRequest:f,renderResultMenuItem:y,renderToken:()=>null,renderFilter:()=>null,renderItemForSummary:()=>null,addItemLabel:null,focused:!1})}const xy="showAll",Sy="showTeamsWithSecurityOverrides",by={[xy]:{key:xy,name:(0,r.jsx)(g.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllOption",defaultMessage:"Show all"}),originName:(0,r.jsx)(g.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showAllPlaceholder",defaultMessage:"Security"}),showFilterAsOffWhenSelected:!0},[Sy]:{key:Sy,name:(0,r.jsx)(g.FormattedMessage,{id:"ManageTeamsSecurityOverridesFilter.showTeamsWithSecurityOverrides",defaultMessage:"Has overrides"})}};function My(e){let{manageTeamsStore:t}=e;window.__c={n:"ManageTeamsSecurityOverridesFilter"};const s=(0,L.O7)(),n=(0,N.VK)((()=>t.state.showTeamsWithSecurityOverrides),[t]),a=(0,lt.yK)((e=>({securityIcon:{width:14,height:14,marginRight:5,fill:e.mediumIconColor},blueFill:{fill:mt.ZP.blue}})),[]),o=[by.showAll,by[Sy]],l=(0,i.useCallback)((e=>{t.setState({...t.state,showTeamsWithSecurityOverrides:e.key===Sy}),ry.GZ(s,{filter:"securityOverrides",value:e.key})}),[t,s]),d=by[n?Sy:xy];return(0,r.jsx)(ly,{selectItems:o,currentSelectedItem:d,onChange:l,icon:(0,Ha.X)({...a.securityIcon,...n&&a.blueFill})})}function wy(e){let{manageTeamsStore:t,teamStores:s}=e;window.__c={n:"ManageTeamsFilterRow"};const n=(0,lt.yK)((()=>({container:{display:"flex",alignItems:"center",marginTop:20},searchContainer:{maxWidth:250,marginRight:"auto"},archivedTeamsSwitch:{display:"flex",alignItems:"center",marginLeft:15,marginRight:15},archivedTeamsLabel:{marginLeft:10},dropdownContainer:{display:"flex",alignContent:"stretch",marginLeft:5}})),[]),a=(0,N.VK)((()=>t.state.searchQuery),[t]),o=(0,i.useCallback)((e=>{t.update((t=>({...t,searchQuery:e})))}),[t]);return(0,r.jsxs)("div",{style:n.container,children:[(0,r.jsx)(jy,{style:n.searchContainer,onChange:o,value:a}),(0,r.jsxs)("div",{style:n.dropdownContainer,children:[(0,r.jsx)(fy,{manageTeamsStore:t}),(0,r.jsx)(vy,{teamStores:s,manageTeamsStore:t}),(0,r.jsx)(uy,{manageTeamsStore:t}),(0,r.jsx)(My,{manageTeamsStore:t})]})]})}function jy(e){let{style:t,value:s,onChange:n}=e;window.__c={n:"Search"};const a=(0,g.useIntl)(),o=(0,lt.yK)((e=>({input:{boxShadow:e.inputBoxShadow,borderRadius:100,fontSize:12},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor}})),[]),l=(0,i.useCallback)((e=>n(e.target.value)),[n]);return(0,r.jsx)(Ue.Z,{placeholder:a.formatMessage({defaultMessage:"Search teamspaces...",id:"manageTeamsFilterRow.searchFilter.placeholder"}),style:{...o.input,...t},value:s,onChange:l,left:(0,Qp.R)(o.searchIcon),format:Ue.Z.Format.Small,showClearButton:!0})}var Cy=s(12534),ky=s(55838),_y=s(71064),Ty=s(18488),Iy=s(98742),Py=s(45660);var Zy=s(63060),Fy=s(85387);function Ay(e){let{teamStore:t,accessLevel:s,isTeamOwner:i,onChangeAccessLevel:n,width:a}=e;window.__c={n:"ManageTeamsAccessCell"};const o=(0,L.O7)(),l=function(e){return(0,N.VK)((()=>e.isDefault()),[e])}(t),d=(0,Zy.U)({teamStore:t,onChange:n,isDefault:l}),c=l?"default":s,u=d.find((e=>e.key===c)),m=!i||Boolean(null==u?void 0:u.disableAllOptionsTooltip),h=(null==u?void 0:u.disableAllOptionsTooltip)||m&&!i&&(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsAccessCell.onlyTeamOwnersCanChangeAccessLevel",defaultMessage:"Only teamspace owners can change teamspace access levels"}),f=(0,Py.e)(),y=(0,lt.yK)((e=>{const t=e.lightTextColor;return{selectButton:{paddingLeft:8,marginLeft:-8,maxWidth:a},label:{...m&&{color:t},fontSize:p.Z.fontSize.UIRegular.desktop,fontWeight:p.Z.fontWeight.regular},chevron:{width:10,marginLeft:4,fill:e.mediumIconColor,...m&&{fill:t}},tooltip:{width:200}}}),[m,a]);if(!u)throw new Error(`Selected access level is not an option found in team access level option: ${c}`);return(0,r.jsx)(ya.Z,{items:d,getKey:e=>e.key,selectedItem:u,onSelect:e=>"private"===e.key&&f?$a.y(o,{from:"team_security_settings",for:"business"}):e.onSelect(),renderItem:e=>(0,r.jsx)(fe.Z,{textWrap:!0,style:y.tooltip,placement:ns.u.Bottom,disableTooltip:!e.value.tooltip,renderTooltip:()=>e.value.tooltip,render:t=>(0,r.jsx)(ue.Z,{title:e.value.title,...(0,Iy.Z)(e,t)})}),disabled:m,renderOrigin:e=>(0,r.jsx)(fe.Z,{textWrap:!0,style:y.tooltip,disableTooltip:!h,renderTooltip:()=>h,alignment:ns.v.Center,placement:ns.u.Left,render:t=>(0,r.jsxs)(Ze.Z,{style:y.selectButton,disabled:m,...(0,Iy.Z)(e,t),children:[(0,r.jsx)(Fy.s,{style:y.label,children:u.level}),(0,fa.i)(y.chevron)]})})})}function Dy(e){let{teamOwners:t,manageTeamsStore:s}=e;window.__c={n:"ManageTeamsOwnersCell"};const i=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),n=(0,g.useIntl)(),a=(0,N.VK)((()=>{if(!i)return;const{filterByOwner:e}=s.state;let n=t[0];if(e.type===Uf){const s=e.id;t.includes(s)&&(n=s)}return n?zl({userId:n,currentSpaceStore:i}):void 0}),[i,s,t]),o=(0,N.VK)((()=>{if(null!=a&&a.isDefined())return(0,Vn.Nz)(n,a.getModel())}),[a,n]),l=(0,lt.yK)((e=>({container:{display:"flex",alignItems:"center",fontSize:p.Z.fontSize.UIRegular.desktop,overflow:"hidden"},userAvatar:{paddingRight:6},nMoreOwnersText:{paddingLeft:3,color:e.mediumTextColor},noOwners:{marginRight:8,color:e.lightTextColor},userName:{flexShrink:1}})),[]);return t.length<1?(0,r.jsx)("div",{style:l.noOwners,children:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsOwnersCell.noOwners",defaultMessage:"No owners"})}):(0,r.jsxs)("div",{style:l.container,children:[(0,r.jsx)(Un.Z,{style:l.userAvatar,avatarShouldShowShadow:!0,userStore:a,size:20}),(0,r.jsx)(Fy.s,{style:l.userName,children:o}),t.length>1&&(0,r.jsx)("div",{style:l.nMoreOwnersText,children:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsOwnersCell.nMoreOwnersLabel",defaultMessage:"+{numAdditionalOwners}",values:{numAdditionalOwners:t.length-1}})})]})}const By=[If,Pf,Ff,Af,Df],Ry={[Ff]:{headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsTable.columnTitle.access",defaultMessage:"Access"}),renderCell:e=>{let{data:t,environment:s}=e;return(0,r.jsx)(Ay,{teamStore:t.store,accessLevel:t.accessLevel,isTeamOwner:t.isCurrentUserOwnerOfTeam,onChangeAccessLevel:(e,i)=>Ic.Ju({environment:s,store:t.store,accessLevel:e,isDefault:i,teamName:t.name,from:"manage_teams_table"}),width:90})},colWidth:{width:90},hasClickableContents:!0},[If]:{headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamspacesTable.columnTitle.teamspace",defaultMessage:"Teamspace"}),renderCell:e=>{let{data:t}=e;return(0,r.jsx)(Ly,{teamStore:t.store,isArchivedTeam:t.isArchivedTeam,name:t.name})},colWidth:{minWidth:30,widthPercent:35}},[Pf]:{headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsTable.columnTitle.owners",defaultMessage:"Owners"}),renderCell:e=>{let{data:t,manageTeamsStore:s}=e;return(0,r.jsx)(Dy,{teamOwners:t.owners,manageTeamsStore:s})},colWidth:{minWidth:60,widthPercent:25}},[Zf]:{headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsTable.columnTitle.members",defaultMessage:"Members"}),renderCell:e=>{let{data:t}=e;return(0,r.jsx)(Fy.s,{children:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsTable.numMembersCell",defaultMessage:"{numTeamMembers, plural, one {# member} other {# members}}",values:{numTeamMembers:t.members.length}})})},colWidth:{minWidth:40,widthPercent:15}},[Af]:{headerTitle:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsTable.columnTitle.updated",defaultMessage:"Updated"}),renderCell:e=>{let{data:t}=e;return t.lastUpdated&&(0,r.jsx)(Ny,{lastUpdatedMillis:t.lastUpdated})},colWidth:{minWidth:50,widthPercent:15}},[Df]:{headerTitle:void 0,renderCell:e=>{let{data:t}=e;return(0,r.jsx)(Ty.OutlinerTeamOverflow,{teamStore:t.store,from:"manage_teams_table"})},colWidth:{width:30},hasClickableContents:!0}};function Ly(e){let{teamStore:t,name:s,isArchivedTeam:i}=e;window.__c={n:"TeamCell"};const n=(0,L.O7)(),a=(0,g.useIntl)(),o=(0,_y.e)(t),l=(0,lt.yK)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden"},teamIcon:{marginRight:12},nameAndMembersContainer:{display:"flex",flexDirection:"column",minWidth:0},nameAndArchivedPillContainer:{display:"flex"},nameText:{lineHeight:"18px",fontWeight:p.Z.fontWeight.regular},smallText:{fontSize:(0,Xf.yv)(n,"UISmall"),color:e.mediumTextColor,fontWeight:p.Z.fontWeight.regular},archivedTag:{marginLeft:5}})),[n]),c=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),u=(0,N.VK)((()=>{if(!c)return;const e=(0,T.tO)({teamStore:t,spaceStore:c}).length;return(0,Xc.uf)(e,"compact",a)}),[c,a,t]),m=(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsTableColumnData.numMembersLabel",defaultMessage:"{numMembers, plural, one {1 member} other {{numMembers} members}}",values:{numMembers:u}}),h=o?(0,r.jsxs)(r.Fragment,{children:[" • ",(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsTableColumnData.joinedLabel",defaultMessage:"Joined"})]}):void 0,f=d.oA([m,h]);return(0,r.jsxs)("div",{style:l.container,children:[(0,r.jsx)(Bn.p,{style:l.teamIcon,size:28,store:t,disabled:!0}),(0,r.jsxs)("div",{style:l.nameAndMembersContainer,children:[(0,r.jsxs)("div",{style:l.nameAndArchivedPillContainer,children:[(0,r.jsx)(Fy.s,{style:l.nameText,children:s}),i&&(0,r.jsx)(st.Z,{desktopStyle:l.archivedTag,mobileStyle:l.archivedTag,children:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsTable.archivedTag",defaultMessage:"Archived"})})]}),(0,r.jsx)(Fy.s,{style:l.smallText,children:f})]})]})}function Ny(e){let{lastUpdatedMillis:t}=e;return(0,r.jsx)(Fy.s,{children:(0,pt.Yx)(t,"very_short",is.SP)})}function Ey(e){let{teamStores:t,manageTeamsStore:s}=e;window.__c={n:"ManageTeamsTable"};const n=(0,L.O7)(),a=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),o=(0,N.VK)((()=>I.default.state.currentUserStore),[]),{sortAscending:l,sortColumn:c}=(0,N.VK)((()=>{const{sortAscending:e,sortColumn:t}=s.state;return{sortAscending:e,sortColumn:t}}),[s]),u=(0,N.VK)((()=>{const e=null==o?void 0:o.id;return e?d.oA(t.map((t=>{if(!t.canRead()||!t.isReady())return;const s=t.getMembers(),i=(0,En.XO)({membership:s});return{store:t,name:t.getName()??"",owners:i,isCurrentUserOwnerOfTeam:i.includes(e),members:(0,T.tO)({teamStore:t,spaceStore:a}),hasSecurityOverrides:t.hasSecurityOverrides(),accessLevel:t.getTeamAccessLevel(),isArchivedTeam:(0,En.m4)({archived_by:t.getArchivedBy()}),lastUpdated:t.getLastEditedTime()}}))):[]}),[a,null==o?void 0:o.id,t]),m=(0,N.VK)((()=>{const{showOnlyArchivedTeams:e,filterByOwner:t,showTeamsWithSecurityOverrides:i,filterAccess:n}=s.state;return u.filter((t=>e?t.isArchivedTeam:!t.isArchivedTeam)).filter((e=>!i||e.hasSecurityOverrides)).filter((e=>{if(n===Lf&&"open"!==e.accessLevel)return!1;if(n===Nf&&"closed"!==e.accessLevel)return!1;if(n===Ef&&"private"!==e.accessLevel)return!1;switch(t.type){case Vf:return 0===e.owners.length;case Uf:return e.owners.includes(t.id);case Of:return!0;default:(0,_.t1)(t)}}))}),[s,u]),p=(0,N.VK)((()=>{const{sortAscending:e,sortColumn:t}=s.state;return function(e){let{data:t,sortColumn:s,sortAscending:i}=e;const n=[i?"asc":"desc"],a=[i?"desc":"asc"];switch(s){case If:return d.Xo(t,(e=>e.name),a);case Zf:return d.Xo(t,(e=>e.members.length),n);case Ff:return d.Xo(t,(e=>ms.bx.indexOf(e.accessLevel)),n);case Af:return d.Xo(t,(e=>e.lastUpdated),n);default:(0,_.t1)(s)}}({data:m,sortAscending:e,sortColumn:t})}),[s,m]),g=(0,N.VK)((()=>(0,kt.ZP)(s.state.searchQuery,p,(e=>e.name))),[s,p]),h=(0,i.useCallback)((e=>Ic.RF({environment:n,teamId:e,tab:ky.a.Members,from:"manage_teams_table"})),[n]),f=(0,lt.yK)((e=>({container:{marginTop:17,tableLayout:"fixed",borderCollapse:"collapse",width:"100%",minWidth:By.reduce(((e,t)=>e+Gy(Ry[t].colWidth)+Ky),0)},tableHeaderRow:{borderTop:`1px solid ${e.tableDividerColor}`,borderBottom:`1px solid ${e.tableDividerColor}`},noTeamsLabel:{marginTop:15,marginBottom:40,textAlign:"center"}})),[]),y=(0,i.useCallback)((e=>{const{sortColumn:t,sortAscending:i}=s.state,a=e===t&&!i;s.setState({...s.state,sortAscending:a,sortColumn:e}),ry.dw(n,{sortBy:e,sortOrder:i?"ascending":"descending"})}),[s,n]),v=(0,i.useCallback)((()=>{s.reset()}),[s]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("table",{style:f.container,children:[(0,r.jsx)("tr",{style:f.tableHeaderRow,children:By.map((e=>(0,r.jsx)(Vy,{column:e,onSortableColumnClick:y,sortAscending:l,sortColumn:c},`header_${e}`)))}),(0,r.jsx)("tr",{children:By.map((e=>(0,r.jsx)("td",{},`padding_row_${e}`)))}),g.map((e=>(0,r.jsx)(Oy,{onShowTeamSettings:h,teamData:e,manageTeamsStore:s},`${e.store.id}_row`)))]}),(0,r.jsx)(Wy,{style:f.noTeamsLabel,numItemsAfterFilter:g.length,numItemsBeforeFilter:t.length,onResetFilters:v})]})}function Oy(e){let{teamData:t,manageTeamsStore:s,onShowTeamSettings:n}=e;window.__c={n:"TeamRow"};const[a,o]=(0,i.useState)(!1),l=(0,i.useCallback)((()=>o(!0)),[]),d=(0,i.useCallback)((()=>o(!1)),[]),c=(0,i.useCallback)((e=>{zy(e,(()=>n(t.store.id)))}),[n,t.store.id]),u=(0,lt.yK)((e=>({teamRow:{cursor:"pointer",borderBottom:`1px solid ${e.tableDividerColor}`}})),[]);return(0,r.jsx)("tr",{onMouseLeave:d,onMouseEnter:l,style:u.teamRow,onClick:c,children:By.map((e=>(0,r.jsx)(Uy,{isRowHovered:a,teamData:t,columnData:Ry[e],manageTeamsStore:s},`${t.store.id}_${e}`)))})}function Vy(e){let{column:t,onSortableColumnClick:s,sortColumn:i,sortAscending:n}=e;window.__c={n:"HeaderCell"};const a=Ry[t],o=(0,lt.yK)((e=>({th:qy(a),innerDiv:{display:"flex",alignItems:"center",minWidth:Gy(a.colWidth),height:32},text:{fontSize:p.Z.fontSize.UISmall.desktop,fontWeight:p.Z.fontWeight.regular,color:e.mediumTextColor},sortButton:{padding:5,margin:-5,overflow:"hidden",maxWidth:"100%"},sortIcon:{fill:e.mediumTextColor,width:12,height:12,marginLeft:4}})),[a]),l=(0,r.jsx)(Fy.s,{style:o.text,children:a.headerTitle}),d=(c=t,Bf.includes(c)?(0,r.jsxs)(Ze.Z,{style:o.sortButton,onClick:()=>s(t),children:[l,(()=>{if(t===i)return(0,mh.K)({...o.sortIcon,...n&&{transform:"rotate(180deg)"}})})()]}):l);var c;return(0,r.jsx)("th",{style:o.th,children:(0,r.jsx)("div",{style:o.innerDiv,children:d})})}function Uy(e){let{teamData:t,columnData:s,isRowHovered:i,manageTeamsStore:n}=e;window.__c={n:"Cell"};const a=(0,L.O7)(),o=(0,lt.yK)((e=>({td:{...qy(s),...i&&{background:e.buttonHoveredBackground}},innerDiv:{minWidth:Gy(s.colWidth),fontSize:p.Z.fontSize.UIRegular.desktop,color:e.regularTextColor,height:56,display:"flex",alignItems:"center"}})),[s,i]),l=zy,d=Boolean(s.hasClickableContents);return(0,r.jsx)("td",{style:o.td,children:(0,r.jsx)("div",{style:o.innerDiv,onClick:d?l:void 0,children:s.renderCell({environment:a,data:t,manageTeamsStore:n})})})}function Wy(e){let{style:t,numItemsBeforeFilter:s,numItemsAfterFilter:i,onResetFilters:n}=e;if(0!==i)return null;let a;return a=0!==s?(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.teamsFilteredOut",defaultMessage:"Could not find any teamspaces. <linkbutton>Reset your filters</linkbutton>",values:{linkbutton:e=>(0,r.jsx)(wo.Z,{onClick:n,children:e})}}):(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsTable.emptyManageTeamTableDisclaimer.noTeamsExist",defaultMessage:"Could not find any teamspaces."}),(0,r.jsx)(It.Z,{isSmall:!0,style:t,children:a})}function zy(e,t){(0,Cy.ZP)({event:e,context:Cy.Af.ManageTeamsRowClick,callback:t})}const Ky=10,Hy={paddingLeft:Ky/2,paddingRight:Ky/2};function Gy(e){return"minWidth"in e?e.minWidth:e.width}function qy(e){let t={};return t="width"in e.colWidth?{width:e.colWidth.width}:{width:`${e.colWidth.widthPercent}%`,minWidth:e.colWidth.minWidth},{...Hy,...t}}function Yy(e){let{}=e;window.__c={n:"ManageTeamsBrowser"};const{isMobile:t=!1}=(0,L.Fy)(),s=(0,L.O7)(),n=(0,N.qz)(zf),a=(0,lt.yK)((()=>({container:{marginTop:8},header:{display:"flex",justifyContent:"space-between",alignItems:"center"},subheader:{display:"flex",flexDirection:"column"}})),[]),{unarchivedTeamIds:o,archivedTeamIds:l,isLoading:d}=(0,N.VK)((()=>{const e=A.state;return"loaded"!==e.loadingState?{unarchivedTeamIds:[],archivedTeamIds:[],isLoading:!0}:{unarchivedTeamIds:e.unarchivedTeamIds,archivedTeamIds:e.archivedTeamIds,isLoading:!1}}),[]),c=(0,N.VK)((()=>d?[]:Kf({environment:s,teamIds:[...o,...l]})),[l,s,d,o]),u=(0,i.useCallback)((()=>Ic.lo("workspace_settings")),[]);return(0,r.jsxs)("div",{style:a.container,children:[(0,r.jsxs)(zt.Z,{large:!t,style:a.header,small:!0,children:[(0,r.jsxs)("div",{style:a.subheader,children:[(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsBrowser.title",defaultMessage:"Manage teamspaces"}),(0,r.jsx)(It.Z,{isSmall:!0,style:{marginTop:3},children:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsBrowser.subtitle",defaultMessage:"Manage all teamspaces you have access here"})})]}),(0,r.jsx)(ce.Z,{onClick:u,isLarge:!0,className:gi.myM,children:(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsBrowser.newTeamButton.text",defaultMessage:"New teamspace"})})]}),d?(0,r.jsx)(Ki.Z,{}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(wy,{teamStores:c,manageTeamsStore:n}),(0,r.jsx)(Ey,{teamStores:c,manageTeamsStore:n})]})]})}var Qy=s(44615),$y=s(2688);function Xy(){window.__c={n:"ManageTeamsListener"};const e=(0,L.O7)(),{currentSpaceStore:t,currentUserStore:s}=(0,N.VK)((()=>{const{currentSpaceStore:e,currentUserStore:t}=I.default.state;return{currentSpaceStore:e,currentUserStore:t}}),[]);return(0,i.useEffect)((()=>{if("loading"===A.state.loadingState||!t||!s)return;const i=$y.Z.addListener((0,Qy.pD)({userId:s.id,spaceId:t.id}),((t,s)=>{D({environment:e,messageStoreEmitValue:s})}),void 0,e);return function(){i&&$y.Z.removeListener(i,e)}}),[t,s,e]),null}const Jy=i.memo(Xy);function ev(e){let{title:t,description:s,disabled:i=!1,selected:n,onChange:a=(()=>{})}=e;return(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},onClick:()=>!i&&a(!n),children:[(0,r.jsxs)("div",{style:{fontSize:14,marginRight:8,flexGrow:1},children:[t,s&&(0,r.jsx)(It.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:2,width:"80%"},children:s})]}),(0,r.jsx)("div",{style:{marginTop:5},children:(0,r.jsx)(Rr.Z,{on:n,disabled:i})})]})}function tv(){window.__c={n:"Header"};const e=(0,L.Fy)();return(0,r.jsx)(zt.Z,{large:!e.isMobile||void 0,divider:e.isMobile?void 0:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"teamsWorkspaceSettings.title",defaultMessage:"Teamspace settings"})})}function sv(){window.__c={n:"TeamSecuritySettings"};const e=(0,L.O7)(),t=(0,N.VK)((()=>I.default.state.currentSpaceStore),[]),s=(0,N.qz)(void 0,bi.Z),n=(0,N.VK)((()=>t&&s.getValueForSpace(t)),[t,s]),a=(0,N.VK)((()=>(0,Pt.F$)()),[]),o=(null==n?void 0:n.disableTeamCreation)??!1,l=(null==n?void 0:n.disableTeamGuests)??!1,d=void 0===n,c=(0,i.useCallback)((()=>{t&&n&&async function(e){let{newSettingValue:t,environment:s,workspaceSecuritySettings:i,spaceStore:n}=e;const a="allowTeamCreation"===t?(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.allowTeamCreation",defaultMessage:"Are you sure you want to allow all members of this workspace to create teamspaces?"}):(0,r.jsx)(g.FormattedMessage,{id:"manageTeamsHelpers.confirmChangeSecuritySetting.workspaceOwners.disableTeamCreation",defaultMessage:"Are you sure you want to limit teamspace creation to only workspace owners?"});!!(await v.confirmUserAction({message:a}))&&Gu.n(s,{securitySettingsState:{...i,disableTeamCreation:"disableTeamCreation"===t},spaceStore:n})}({newSettingValue:o?"allowTeamCreation":"disableTeamCreation",environment:e,spaceStore:t,workspaceSecuritySettings:n})}),[t,o,e,n]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(bo.Z,{size:34}),(0,r.jsx)(ev,{disabled:d,onChange:c,title:(0,r.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.title",defaultMessage:"Limit teamspace creation to only workspace owners"}),description:(0,r.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamCreation.workspaceOwners.caption",defaultMessage:"Only allow workspace owners to create teamspaces"}),selected:o}),(0,r.jsx)(bo.Z,{size:34}),a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ev,{disabled:d,onChange:async function(){if(t&&n){if(!Boolean(n.disableTeamGuests)){if(!(await v.confirmUserAction({message:(0,r.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.message",defaultMessage:"Are you sure you want to disable teamspace guests?"}),description:(0,r.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.description",defaultMessage:"This action will remove all teamspace guests from the workspace."}),acceptLabel:(0,r.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.confirmDisable.acceptButton",defaultMessage:"Disable and remove teamspace guests"})})))return}Gu.n(e,{securitySettingsState:{...n,disableTeamGuests:!n.disableTeamGuests},spaceStore:t})}},title:(0,r.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.title",defaultMessage:"Allow teamspace owners to add teamspace guests"}),description:(0,r.jsx)(g.FormattedMessage,{id:"teamWorkspacesSettings.disableTeamGuests.workspaceOwners.caption",defaultMessage:"This will allow teamspace owners with membership admin permissions to add teamspace guests. Disabling will remove all teamspace guests."}),selected:!l}),(0,r.jsx)(bo.Z,{size:34})]})]})}function iv(e){let{}=e;window.__c={n:"TeamsWorkspaceSettings"};const t=(0,lt.yK)((()=>({learnMoreLinkContainer:{paddingTop:6,paddingBottom:20}})),[]);return(0,r.jsxs)(Ui.Z,{children:[(0,r.jsx)(tv,{}),(0,r.jsx)(Hf.Z,{helpCenterLocation:"settingsAndPermissions",analyticsFrom:"teams_learn_more_workspace_settings",containerStyle:t.learnMoreLinkContainer}),(0,r.jsx)(ty,{}),(0,r.jsx)(sv,{}),(0,r.jsx)(Yy,{}),(0,r.jsx)(Jy,{})]})}var nv=s(38493),av=s(3924),ov=s(39675),rv=s(67729),lv=s(75493),dv=s(2832),cv=s(73966);function uv(e){let{isMobile:t}=e;window.__c={n:"ManualUpdateTimezoneSetting"};const s=(0,L.O7)(),i=$.default.getIntl(),n=(0,N.VK)((()=>I.default.state.currentUserSettingsStore),[]),{currentTimeZone:a,auto_update_disabled:o}=(0,N.VK)((()=>{const e=null==n?void 0:n.getSettings();return{currentTimeZone:null==e?void 0:e.time_zone,auto_update_disabled:null==e?void 0:e.disable_auto_set_timezone}}),[n]),l=(0,N.VK)((()=>dv.S.map((e=>({key:e,label:(0,lv.Z)(i,e)})))),[i]);return(n&&(0,r.jsx)(jo.Z,{isMobile:t,disabled:!o,title:(0,r.jsx)(g.FormattedMessage,{id:"dateAndTimeSettings.timeZone.title",defaultMessage:"Time Zone"}),caption:(0,r.jsx)(g.FormattedMessage,{id:"dateAndTimeSettings.timeZone.caption",defaultMessage:"Current time zone setting."}),type:"dropdown",currentOption:a??"error_fetch_timezone",options:l,onSelectOption:e=>{cv.l6({environment:s,userSettingsStore:n,timeZone:e})}}))??null}function mv(e){let{isMobile:t}=e;window.__c={n:"AutoUpdateTimezoneSetting"};const s=(0,L.O7)(),n=(0,N.VK)((()=>I.default.state.currentUserSettingsStore),[]),a=(0,N.VK)((()=>{var e;return null==n||null===(e=n.getSettings())||void 0===e?void 0:e.disable_auto_set_timezone}),[n])??!1,o=(0,i.useCallback)((e=>{const t=!a;cv.k2({environment:s,userSettingsStore:e,disableAutoSetTimezone:t}),t||cv.wk({environment:s,userSettingsStore:e})}),[s,a]),l=(0,r.jsx)(g.FormattedMessage,{id:"dateAndTimeSettings.autoTimeZone.title",defaultMessage:"Set timezone automatically using your location"}),d=(0,r.jsx)(g.FormattedMessage,{id:"dateAndTimeSettings.autoTimeZone.caption",defaultMessage:"Reminders, notifications and emails are delivered based on your time zone."});return(n&&(0,r.jsx)(jo.Z,{isMobile:t,title:l,caption:d,type:"toggle",isOn:!a,onToggle:()=>o(n)}))??null}var pv=s(16347);const gv=(0,av.M)((function(e){let{passwordRequestStore:t,userEmailDomainSettings:s}=e;window.__c={n:"UserSettings"};const{isPhone:i,isIOS:n,isMobile:a}=(0,L.Fy)(),o=(0,L.O7)(),l=(0,N.VK)((()=>Vi.Z.state.online),[]),d=(0,N.VK)((()=>a&&t?(0,ov.E)({isPhone:i,isIOS:n,passwordRequestStore:t,userEmailDomainSettings:s}):(0,ov.Z)({environment:o})),[o,a,i,n,t,s]),c=(0,N.VK)((()=>Zt.default.checkGate("update_user_setting_timezone_enabled")),[]),u=[c?{key:"timezone-auto",renderSettingsItem:()=>(0,r.jsx)(mv,{isMobile:a})}:void 0,c?{key:"timezone-manual",renderSettingsItem:()=>(0,r.jsx)(uv,{isMobile:a})}:void 0].filter(_.$K),m=[(0,N.VK)((()=>(0,rv.h)(o)),[o])?{key:"cookies",renderSettingsItem:()=>(0,r.jsx)(rv.Z,{isMobile:a})}:void 0,{key:"view-history",renderSettingsItem:()=>(0,r.jsx)(pv.H,{isMobile:a})}].filter(_.$K);return l?(0,r.jsxs)(Ui.Z,{disableScroller:a,children:[(0,r.jsx)(zt.Z,{large:!a,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"mySettings.settingsSection.title",defaultMessage:"My settings"})}),(0,r.jsx)(Eu.O,{items:d}),c&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(bo.Z,{size:48,isHidden:!0}),(0,r.jsx)(zt.Z,{large:!a,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"notificationAndPersonalSettings.dateAndTimeSection.title",defaultMessage:"Date & time"})}),(0,r.jsx)(Eu.O,{items:u})]}),(0,r.jsx)(bo.Z,{size:48,isHidden:!0}),(0,r.jsx)(zt.Z,{large:!a,divider:"full",children:(0,r.jsx)(g.FormattedMessage,{id:"mySettings.privacySection.title",defaultMessage:"Privacy"})}),(0,r.jsx)(Eu.O,{items:m})]}):(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(It.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,r.jsx)(g.FormattedMessage,{defaultMessage:"Please go online to manage settings.",id:"mySettings.goOnline.prompt"})})})})),hv={user_settings:{},profile:{},notifications:{},notifications_and_settings:{},connected_apps:{},language_and_region:{},debug_zone:{},settings:{},teams:{adminOnly:!0,membersOnly:!0},members:{membersOnly:!0},analytics:{membersOnly:!0,enterpriseOnly:!0},plans:{membersOnly:!0},billing:{},subscription:{},security:{adminOnly:!0},identity_provisioning:{adminOnly:!0},admin_content_search:{adminOnly:!0,enterpriseOnly:!0},integrations:{adminOnly:!0},imports:{},audit_log:{adminOnly:!0,enterpriseOnly:!0},experiments:{},publishing:{adminOnly:!0}},fv=(0,g.defineMessages)({dialogLabel:{id:"spaceSettings.dialogLabel",defaultMessage:"Settings & members"}});class yv extends n.Z{constructor(){super(...arguments),this.lastSpaceSettingsStoreState=void 0,this.lastSpaceSettingsModalStoreOpen=!1,this.storeTypes={spaceBasicSettingsStore:Ti,spaceProfileSettingsStore:Fi,securitySettingsStore:bi.Z,samlSettingsStore:Si,spaceDomainSettingsStore:Pi},this.renderContent=()=>{const e=Ai.Z.state.currentTab,t=this.getTabRenderer(e);return(0,r.jsx)(Ao.Z,{capture:!0,allowEsc:!0,render:e=>(0,r.jsx)(Do.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!0,focusOffscreenInput:!1,render:()=>(0,r.jsx)(om,{sidebar:this.renderSidebar(),...e,children:t()})})})},this.renderTabDot=e=>{const{currentSpaceStore:t}=I.default.state;return"members"===e&&this.environment.device.isDesktop&&null!=t&&t.canEditMembership()&&(0,Pt.p1)()&&Bi.Z.state.count>0?(0,r.jsx)(Zc.z,{color:this.theme.redBadgeBackground}):null},this.renderProfile=()=>(0,r.jsx)(uh,{isEducationPlan:Oi.wl(Di.default.state.data),spaceProfileSettingsStore:this.stores.spaceProfileSettingsStore}),this.renderNotificationsAndSettings=()=>(0,r.jsx)(Ru.Z,{isMobile:!1}),this.renderLanguageAndRegion=()=>(0,r.jsx)(Bu,{}),this.renderSettings=()=>(0,r.jsx)(rg,{spaceStore:this.props.spaceStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore,securitySettingsStore:this.stores.securitySettingsStore}),this.renderMySettings=()=>(0,r.jsx)(gv,{}),this.renderMyNotifications=()=>(0,r.jsx)(Vu,{}),this.renderTeamsSettings=()=>(0,r.jsx)(iv,{}),this.renderMembers=()=>(0,r.jsx)(lg.Z,{store:this.props.spaceStore,unreadAccessRequests:Bi.Z.state.count}),this.renderAnalytics=()=>{const{spaceStore:e}=this.props;return(0,r.jsx)(Fp,{spaceStore:e})},this.renderPlans=()=>{const{data:e}=Di.default.state,{data:t}=Ri.Z.state;if(e)return(0,r.jsx)(_f,{spaceStore:this.props.spaceStore,upcomingInvoiceData:t,securitySettingsStore:this.stores.securitySettingsStore,data:e})},this.renderBilling=()=>{const{data:e}=Di.default.state,{data:t}=Ri.Z.state;if(!e)return null;const s="unsubscribed_admin"===e.type&&e.customerData&&(0,u.E3)(e.customerData.stripe.addOns);if("subscribed_admin"===e.type||s){var i;const s=null===(i=e.customerData)||void 0===i?void 0:i.stripe;return s?(0,r.jsx)(Ei.Z,{spaceStore:this.props.spaceStore,subscriptionData:e,upcomingInvoiceData:t,customerData:s}):null}return e&&"unsubscribed_admin"===e.type?(0,r.jsx)(Xh,{spaceStore:this.props.spaceStore,data:e}):void 0},this.renderExperiments=()=>(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(Ro.Ub,{})}),this.shouldRenderAnalyticsPrompt=()=>{var e,t;const{currentSpaceViewStore:s,currentSpaceStore:i,currentUserStore:n}=I.default.state;if(!i||!vv("analytics",i))return!1;if(null==n||!n.id)return!1;if(null==i||!i.isDefined())return!1;const a=null==s?void 0:s.getSettings();return"dismissed"!==(null==a||null===(e=a.space_analytics_settings_prompt)||void 0===e?void 0:e.status)&&"hidden"!==(null==a||null===(t=a.space_analytics_settings_prompt)||void 0===t?void 0:t.status)&&(C.lo(this.environment),!0)},this.shouldRenderMfaPrompt=()=>{var e,t;const{currentSpaceViewStore:s,currentSpaceStore:i,currentUserStore:n}=I.default.state;if(null==n||!n.id)return!1;if(null==i||!i.isDefined())return!1;const a=null==s?void 0:s.getSettings();return"dismissed"!==(null==a||null===(e=a.mfa_settings_prompt)||void 0===e?void 0:e.status)&&"hidden"!==(null==a||null===(t=a.mfa_settings_prompt)||void 0===t?void 0:t.status)&&("off"===this.stores.spaceProfileSettingsStore.state.accountSettings.mfaStatus&&(C.GZ(this.environment),!0))},this.renderAuditLog=()=>(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(ui,{spaceStore:this.props.spaceStore})})}),this.renderSubscription=()=>(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(Tf.Z,{})}),this.renderImports=()=>(0,r.jsx)(Ui.Z,{children:(0,r.jsx)(Oc,{genericImporterEnabled:(0,hi.t)()})}),this.renderConnectedApps=()=>(0,r.jsx)(nv.Z,{location:"settings-page"}),this.renderDebugZone=()=>(0,r.jsx)(xh,{store:this.props.spaceStore}),this.renderSecurity=()=>(0,r.jsx)(sm,{spaceStore:this.props.spaceStore,securitySettingsStore:this.stores.securitySettingsStore,userStore:this.props.userStore}),this.renderIdentityProvisioning=()=>(0,r.jsx)(oc,{spaceStore:this.props.spaceStore,samlConfigStore:this.stores.samlSettingsStore,domainSettingsStore:this.stores.spaceDomainSettingsStore,userStore:this.props.userStore}),this.renderAdminContentSearch=()=>(0,r.jsx)(Oa,{spaceStore:this.props.spaceStore,userStore:this.props.userStore}),this.renderIntegrations=()=>(0,r.jsx)(Fo,{spaceStore:this.props.spaceStore,userStore:this.props.userStore}),this.renderPublishing=()=>(0,r.jsx)(Hu,{spaceStore:this.props.spaceStore,userStore:this.props.userStore,spaceBasicSettingsStore:this.stores.spaceBasicSettingsStore}),this.renderNewFeaturePrompt=()=>{if(this.shouldRenderAnalyticsPrompt()){const{currentSpaceStore:e}=I.default.state,t=null!=e&&e.canAdmin()?(0,r.jsx)(g.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.workspaceOwner",defaultMessage:"Explore how members & guests are engaging with this workspace, common searches that are made, and content engagement metrics with workspace analytics."}):(0,r.jsx)(g.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.caption.member",defaultMessage:"See how your content is performing by reviewing metrics like number of views or unique visitors using workspace analytics."});return(0,r.jsx)(nm,{onDismiss:()=>C.TY(this.environment),onClick:()=>{this.attemptCloseCurrentTab((()=>{Ai.Z.setState({...Ai.Z.state,currentTab:"analytics",defaultSubtab:void 0}),this.stores.spaceDomainSettingsStore.reset(),y.XI1(this.environment,{tab:"analytics"}),C.pE(this.environment)}))},onView:t=>{"enterprise"===(null==e?void 0:e.getSubscriptionTier())&&C.pE(t)},onClickLearnMore:()=>{const e=(0,yi.UY)("guides.workspaceAnalytics");S.navigateToExternalURL({environment:this.environment,url:e})},descriptionMessage:t,title:(0,r.jsx)(g.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.title",defaultMessage:"New workspace analytics"}),buttonText:(0,r.jsx)(g.FormattedMessage,{id:"enterpriseSpaceAnalyticsSettingsPrompt.cta",defaultMessage:"View metrics"}),icon:l(this.getSettingsPromptIconStyle())})}if(this.shouldRenderMfaPrompt())return(0,r.jsx)(nm,{onClick:()=>{this.attemptCloseCurrentTab((()=>{Ai.Z.setState({...Ai.Z.state,open:!0,currentTab:"profile",defaultSubtab:void 0,highlightedSetting:Ai.R.TwoStepVerification}),y.XI1(this.environment,{tab:"profile"})}))},onView:C.E6,onDismiss:()=>C.ZJ(this.environment),onClickLearnMore:()=>{const e=(0,yi.UY)("guides.mfa");S.navigateToExternalURL({environment:this.environment,url:e})},descriptionMessage:(0,r.jsx)(g.FormattedMessage,{id:"mfaSettingsPrompt.description",defaultMessage:"2-step verification, also known as 2FA or MFA, is now available. Add a secondary method of verification used during login."}),title:(0,r.jsx)(g.FormattedMessage,{id:"mfaSettingsPrompt.title",defaultMessage:"Add an extra layer of security to your account."}),buttonText:(0,r.jsx)(g.FormattedMessage,{id:"mfaSettingsPrompt.button.label",defaultMessage:"Enable 2-step verification"}),icon:(0,a.Q)(this.getSettingsPromptIconStyle())})},this.handleModalOpen=()=>{Li.bi(this.environment),this.resetAuditLogSetting(),h.kj({environment:this.environment,spaceId:this.props.spaceStore.id,canAdmin:this.props.spaceStore.canAdmin()})},this.handleModalDismiss=()=>this.attemptCloseCurrentTab((()=>{Ai.Z.setState({...Ai.Z.state,open:!1}),wi.reset(),this.stores.spaceDomainSettingsStore.reset(),this.resetAuditLogSetting(),Bi.Z.reset()}))}async willMount(e){super.willMount(e);const{spaceStore:t}=this.props,{securitySettingsStore:s}=this.stores,i=s.getValueForSpace(t);i&&s.setState(i),await j(this.environment,this.stores.spaceProfileSettingsStore)}willMountOrUpdate(e){super.willMountOrUpdate(e);const{open:t}=Ai.Z.state,s=Ai.Z.state;this.lastSpaceSettingsModalStoreOpen===t&&d.Xy(this.lastSpaceSettingsStoreState,s)||t&&y.SUq(this.environment,{tab:s.currentTab,from:s.openedFrom}),this.lastSpaceSettingsModalStoreOpen=t,this.lastSpaceSettingsStoreState=d.d9(s)}renderComponent(){const{open:e}=Ai.Z.state;return(0,r.jsx)(Bo.Z,{ariaLabel:$.default.formatMessage(fv.dialogLabel),open:e,innerStyle:{width:1150,maxWidth:"calc(100vw - 100px)",height:"calc(100vh - 100px)",overflow:"hidden",borderRadius:5,maxHeight:715},onOpen:this.handleModalOpen,onDismiss:this.handleModalDismiss,render:this.renderContent,className:gi.zYS})}getTabRenderer(e){const t={profile:this.renderProfile,notifications_and_settings:this.renderNotificationsAndSettings,user_settings:this.renderMySettings,notifications:this.renderMyNotifications,language_and_region:this.renderLanguageAndRegion,connected_apps:this.renderConnectedApps,debug_zone:this.renderDebugZone,settings:this.renderSettings,teams:this.renderTeamsSettings,members:this.renderMembers,analytics:this.renderAnalytics,plans:this.renderPlans,billing:this.renderBilling,subscription:this.renderSubscription,security:this.renderSecurity,identity_provisioning:this.renderIdentityProvisioning,admin_content_search:this.renderAdminContentSearch,integrations:this.renderIntegrations,experiments:this.renderExperiments,audit_log:this.renderAuditLog,imports:this.renderImports,publishing:this.renderPublishing},{spaceStore:s}=this.props;if(vv(e,s))return t[e];{const e=x.CT(s);return x.r$({currentTab:e}),t[e]}}renderSidebar(){const{spaceStore:e}=this.props,{data:t}=Di.default.state,s=Oi.wY(t),i=(0,Ro.mS)(),n=yh().length>0;return(0,r.jsxs)("div",{style:yv.sidebarStyle,children:[(0,r.jsx)("div",{style:yv.sidebarTabsStyle,children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{style:this.getSidebarHeader(),children:(0,r.jsx)(g.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.title",defaultMessage:"Account"})}),this.renderUserDetails(),this.renderTabButton("profile",e),(0,fi.r)()?(0,r.jsxs)(r.Fragment,{children:[this.renderTabButton("user_settings",e),this.renderTabButton("notifications",e)]}):(0,r.jsx)(r.Fragment,{children:this.renderTabButton("notifications_and_settings",e)}),this.renderTabButton("connected_apps",e),this.renderTabButton("language_and_region",e),n&&this.renderTabButton("debug_zone",e),(0,r.jsx)(bo.Z,{size:18,isHidden:!0}),(0,r.jsx)("div",{style:this.getSidebarHeader(),children:(0,r.jsx)(g.FormattedMessage,{id:"spaceSettings.sidebar.workspaceSettingsSection.title",defaultMessage:"Workspace"})}),this.renderTabButton("settings",e),(0,T.bq)()&&this.renderTabButton("teams",e),this.renderTabButton("publishing",e),this.renderTabButton("members",e),!this.environment.device.isMobile&&this.renderTabButton("analytics",e),this.renderTabButton("plans",e),this.shouldRenderBillingTab(s)&&this.renderTabButton("billing",e),s&&this.renderTabButton("subscription",e),this.renderTabButton("security",e),this.renderTabButton("identity_provisioning",e),!this.environment.device.isMobile&&this.renderTabButton("admin_content_search",e),this.renderTabButton("integrations",e),(0,pi.c)()&&!this.environment.device.isMobile&&(0,r.jsx)("span",{onClick:()=>{const e=(0,c.ZP)();vi.Z.setState({flowId:e}),y.Syn(this.environment,{from:"settings",flowId:e})},children:this.renderTabButton("imports",e)}),!this.environment.device.isMobile&&this.renderTabButton("audit_log",e),i&&this.renderTabButton("experiments",e),e.canRead()&&(0,r.jsx)(Va.Z,{source:"settings"}),e.canRead()&&!(0,u.E3)(null==t?void 0:t.addOns)&&(0,r.jsx)(Ni.Z,{source:"settings"})]})}),this.renderNewFeaturePrompt()]})}renderUserDetails(){const e=(0,mi.B7)(this.environment),t={size:20,hasTooltip:!0,avatarShouldShowShadow:!0,userStore:e};return(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",height:44,paddingLeft:12,paddingRight:12},children:[(0,r.jsx)("div",{style:this.getIconWrapStyle(),children:(0,r.jsx)(Un.Z,{...t})}),e?(0,r.jsxs)("div",{children:[this.renderUserName(e),e.getEmail()&&(0,r.jsx)(It.Z,{isSmall:!0,children:e.getEmail()})]}):(0,r.jsx)(g.FormattedMessage,{id:"spaceSettings.sidebar.personalSettingsSection.userDetails.title",defaultMessage:"Me"})]})}renderUserName(e){const t=$.default.getIntl(),s=e.getFullName(t);return s&&(0,r.jsx)(It.Z,{style:{fontWeight:p.Z.fontWeight.medium},children:s})}renderTabButton(e,t){if(!vv(e,t))return null;const s=Ai.Z.state.currentTab===e,i=Eh[e](this.environment),n=Oh[e](),a=Vh[e]();return(0,r.jsxs)(Jt.Z,{hovered:s,style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:12,paddingRight:12,borderRadius:3,marginTop:1,marginBottom:1,minHeight:27},onClick:t=>{s||this.attemptCloseCurrentTab((()=>{Ai.Z.setState({...Ai.Z.state,currentTab:e,defaultSubtab:void 0}),this.stores.spaceDomainSettingsStore.reset(),y.XI1(this.environment,{tab:e})}))},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",...s&&{fontWeight:p.Z.fontWeight.semibold}},children:[(0,r.jsx)("div",{style:this.getIconWrapStyle(),children:i}),(0,r.jsx)(It.Z,{isMultiline:!0,children:n}),a]}),this.renderTabDot(e)]})}shouldRenderBillingTab(e){var t;const{spaceStore:s}=this.props,{data:i}=Di.default.state;return!(!i||e||!s.canAdmin())&&("subscribed_admin"===i.type||(!("unsubscribed_admin"!==i.type||!(0,u.E3)(null===(t=i.customerData)||void 0===t?void 0:t.stripe.addOns))||!!(0,Oi.MM)(i)))}async attemptCloseCurrentTab(e){const{spaceStore:t}=this.props,{spaceProfileSettingsStore:s}=this.stores,{currentUserStore:i,currentUserSettingsStore:n}=I.default.state;if(!i||!n)throw new Error("No user or settings store.");const a=(0,r.jsx)(g.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Save changes?"}),o=(0,r.jsx)(g.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.confirmationButton.label",defaultMessage:"Yes"}),l=(0,r.jsx)(g.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.cancelationButton.label",defaultMessage:"No"}),{currentTab:c}=Ai.Z.state;if("profile"===c){if(!d.Xy(s.state,s.getValueForUser(i,n,$.default.getIntl()))){const{profilePhoto:t,name:i,startDayOfWeek:o}=s.state;return i?v.showDialog({message:a,showCancel:!0,keepFocus:!0,items:[{label:(0,r.jsx)(g.FormattedMessage,{id:"spaceSettings.closeSettingsDialog.updateSettingsButton.label",defaultMessage:"Update"}),color:"blue",onAccept:()=>{B.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:this.environment,perform:e=>{const{currentUserStore:s}=I.default.state;if(s&&f.A({userStore:s,data:{name:i,profilePhoto:t},transaction:e}),n){const t=n.getSettings();(null==t?void 0:t.start_day_of_week)!==o&&R.d2({userSettingsStore:n,data:{start_day_of_week:o},transaction:e})}}}),e()}}],handleCancel:()=>{e()}}):v.showErrorMessage((0,r.jsx)(g.FormattedMessage,{id:"profileSettings.personalInfoSection.nameMissing.message",defaultMessage:"Please fill in name."})),!0}e()}else if("settings"===c&&t.canEdit()){const{spaceBasicSettingsStore:s}=this.stores,{securitySettingsStore:i}=this.stores,n=!d.Xy(i.state,i.getValueForSpace(t)),r=!d.Xy(s.state,s.getValueForSpace(t));if(n||r){if(await v.confirmUserAction({message:a,acceptLabel:o,cancelLabel:l})){if(!(await b.Y5({environment:this.environment,spaceId:t.id,spaceBasicSettingsStore:s})))return!1;r&&b.OF({environment:this.environment,spaceStore:this.props.spaceStore,spaceBasicSettingsStore:s}),n&&this.updateSecuritySettingsStore(i),e()}else e();return!0}e()}else if("audit_log"===c)this.resetAuditLogSetting(),e();else if("analytics"===c)ki.reset(),e();else if("plans"===c&&t.canAdmin()){const{securitySettingsStore:s}=this.stores,i=s.getValueForSpace(t);!d.Xy(s.state,s.getValueForSpace(t))&&i&&(s.setState(i),this.updateSecuritySettingsStore(s)),e()}else"teams"===c?(P.Z.reset(),A.reset(),e()):e();return!1}resetAuditLogSetting(){ee.reset(),ae.reset()}updateSecuritySettingsStore(e){const{disablePublicAccess:t,disableGuests:s,disableMoveToSpace:i,disableExport:n,disableSpacePageEdits:a,disablePublicAccessRequests:o,disableTeamCreation:r,disableMembershipRequests:l,disableExternalMembershipRequests:d,disableGuestMembershipRequests:c,enableAiFeature:u,disableTeamGuests:m,enableGuestInviteRequests:p}=e.state;B.createAndCommit({userAction:"SpaceSettings.attemptCloseCurrentTab",environment:this.environment,perform:e=>{b.Xr({environment:this.environment,disablePublicAccess:t,disableGuests:s,disableMoveToSpace:i,disableExport:n,disableSpacePageEdits:a,disablePublicAccessRequests:o,transaction:e,spaceStore:this.props.spaceStore,disableTeamCreation:r,disableMembershipRequests:l,disableExternalMembershipRequests:d,disableGuestMembershipRequests:c,enableAiFeature:Boolean(u),disableTeamGuests:m,enableGuestInviteRequests:p})}})}getSidebarHeader(){return{fontSize:12,lineHeight:1,marginBottom:1,color:this.theme.mediumTextColor,fontWeight:p.Z.fontWeight.semibold,alignItems:"center",display:"flex",height:24,paddingLeft:12,paddingRight:11,textOverflow:"ellipsis",overflow:"hidden"}}getIconWrapStyle(){return{width:20,height:20,marginRight:8,color:this.theme.regularIconColor,fill:this.theme.regularIconColor}}getSettingsPromptIconStyle(){return{width:14,height:14,color:this.theme.regularIconColor}}}function vv(e,t){if("publishing"===e)return(0,Pt.yq)();const s=hv[e];return!(s.adminOnly&&!t.canAdmin())&&(!(s.membersOnly&&!t.canRead())&&!(s.enterpriseOnly&&!(0,m.wP)(t.getSubscriptionTier())))}yv.displayName="SpaceSettings",yv.theme=void 0,yv.sidebarStyle={display:"flex",flexDirection:"column",height:"100%",justifyContent:"space-between",paddingTop:10,paddingLeft:4,paddingRight:4},yv.sidebarTabsStyle={overflow:"auto",paddingBottom:12};const xv=yv},10644:(e,t,s)=>{s.d(t,{Z:()=>d});s(67294);var i=s(83355),n=s(5366),a=s(64369),o=s(27386),r=s(85893);class l extends i.Z{renderComponent(){return(0,r.jsx)(o.Z,{children:(0,r.jsx)(a.Z,{isSmall:!0,style:{textAlign:"center"},children:(0,r.jsx)(n.FormattedMessage,{id:"spaceSubscriptionPlans.offlineMessage",defaultMessage:"Please go online to manage your plan."})})})}}l.displayName="SpaceSubscriptionPlansOfflineMessage";const d=l},56633:(e,t,s)=>{s.d(t,{G:()=>y});var i=s(67294),n=s(480),a=s(86628),o=s(45433),r=s(87916),l=s(42875),d=s(59054),c=s(5366),u=s(23014),m=s(54642),p=s(66890),g=s(56596),h=s(85893);const f=(0,c.defineMessages)({cannotSetSprintToCurrentTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToCurrentTooltip",defaultMessage:"Current sprint already exists"},cannotSetSprintToNextTooltip:{id:"SprintStatusPropertyMenu.cannotSetSprintToNextTooltip",defaultMessage:"Next sprint already exists"}});function y(e){window.__c={n:"SprintStatusPropertyMenu"};const{blockPropertyValueOverlayStore:t}=e,s=(0,n.O7)(),y=(0,p.Y$)(),v=(0,a.VK)((()=>y.normalizedSchemaStore.state),[y.normalizedSchemaStore]),x=function(e){let{sprintCollectionStore:t,environment:s,normalizedBlockSchema:i}=e;const[{value:n,status:a}]=(0,d.r5)((async()=>{var e;if(!t)return;const n=u.qB[r.p$].current.reducer.get(i),a=u.qB[r.p$].next.reducer.get(i);if(!n)return;if(!a)return;const d={type:"reducer",userId:s.currentUser.id,userTimeZone:(0,l.r)(),searchQuery:void 0,reducers:{[o.SF]:n,[o.YE]:a}},c=null===(e=t.getParentBlockStore())||void 0===e?void 0:e.getCollectionViewStores()[0],p=t.getSpaceId();if(!c)return;const g=await m.queryCollection(s,{source:{type:"collection",id:t.id,spaceId:p},collectionView:{id:c.id,spaceId:p},loader:d},void 0,{src:"sprint_status_overlay_check"});if("success"!==g.type)return;const h=g.data.result.reducerResults[o.SF],f=g.data.result.reducerResults[o.YE];return"results"===h.type&&"results"===f.type?{hasCurrentSprint:h.blockIds.length>0,hasNextSprint:f.blockIds.length>0}:void 0}),[s,i,t]);if("resolved"!==a||!n)return;return n}({sprintCollectionStore:(0,a.VK)((()=>{const e=t.state;if(e.isOpen)return e.store.getAssociatedCollectionStore()}),[t]),environment:s,normalizedBlockSchema:v}),S=(0,c.useIntl)(),b=(0,i.useCallback)((e=>void 0===x&&[o.YE,o.SF].includes(e)?{disabled:!0}:e===o.YE&&null!=x&&x.hasNextSprint?{disabled:!0,disableReasonMessage:S.formatMessage(f.cannotSetSprintToNextTooltip)}:e===o.SF&&null!=x&&x.hasCurrentSprint?{disabled:!0,disableReasonMessage:S.formatMessage(f.cannotSetSprintToCurrentTooltip)}:{disabled:!1}),[x,S]);return(0,h.jsx)(g.x,{...e,shouldDisableOption:b})}},56596:(e,t,s)=>{s.d(t,{x:()=>T});var i=s(43261),n=s.n(i),a=s(67294),o=s(480),r=s(86628),l=s(80951),d=s(84619),c=s(4635),u=s(72126),m=s(5366),p=s(97880),g=s(5149),h=s(76427),f=s(87279),y=s(4023),v=s(50959),x=s(52275),S=s(78140),b=s(32163),M=s(40721),w=s(72495),j=s(26388),C=s(22084),k=s(47082),_=s(85893);function T(e){window.__c={n:"StatusPropertyMenu"};const{device:t}=(0,o.O7)(),[s,i]=a.useState(e.initialValue??""),[T,I]=a.useState(""),P=(0,m.useIntl)(),Z=(0,r.VK)((()=>{const t=e.blockPropertyValueOverlayStore.state;if(t.isOpen)return t.collectionContextStore}),[e.blockPropertyValueOverlayStore]),F=(0,r.VK)((()=>(null==Z?void 0:Z.permissionScopes.state.canConfigureCollection)&&"collectionPage"!==(null==Z?void 0:Z.contextType)),[Z]),A=e.propertySchema.options??[],D=(0,l.i7)(A,s),B=e.propertySchema.groups??[],R=D&&B.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(D.id)})),L=D&&(0,_.jsx)(C.F,{value:D.value,color:D.color,descriptionTooltip:D.description,tooltipPlacement:y.u.Left,groupColor:null==R?void 0:R.color,isSingle:!1,format:t.isMobile?d.l.Large:d.l.Medium,onClickRemove:()=>{i(""),e.onChange("")},showRemoveButton:!0,shouldShrink:!0,showEllipsis:!0}),N=(0,_.jsx)(k.Z,{focus:!t.isMobile||void 0,focusAfterAnimation:!0,format:k.Z.Format.Select,tokens:[L],placeholder:P.formatMessage({id:"database.selectPropertyEditMenu.searchStatusPlaceholder",defaultMessage:"Search for an option"}),onRemoveLastToken:()=>{},value:T,disabled:e.disabled,hideInput:e.disabled,onChange:e=>{I(e.target.value)},dontShowBorderBottom:t.isAndroid});let E;if(E=t.isMobile?{menuType:f.og.Modal,title:e.propertySchema.name,right:(0,_.jsx)(M.DoneMenuText,{}),onClickRight:e.onDismiss,header:N}:{menuType:f.og.Popup,header:N,tokenInputHeader:!0},e.disabled)return(0,_.jsx)(S.Z,{...E});const{propertySchema:O}=e,V=O.options??[];let U=V;if(""!==T){const e=n().filter(T,V.map((e=>e.value))).map((e=>e.original));U=V.filter((t=>e.includes(t.value)))}const W=(O.groups??[]).map((e=>{const t=U.filter((t=>{var s;return null===(s=e.optionIds)||void 0===s?void 0:s.includes(t.id)}));if(0!==t.length)return{group:e,groupOptions:t}})).filter(p.$K),z=W.length>1,K=W.map(((s,i)=>{let{group:n,groupOptions:a}=s;return{items:a.map((s=>{const i=e.shouldDisableOption?e.shouldDisableOption(s.id):{disabled:!1};return{key:s.value,render:e=>(0,_.jsx)(x.Z,{...e,disabled:i.disabled,disabledFeedback:!0,focused:e.focused,title:(0,_.jsx)(j.Z,{disableTooltip:!i.disabled||!i.disableReasonMessage,renderTooltip:()=>i.disabled&&i.disableReasonMessage,render:e=>(0,_.jsx)(C.F,{...e,value:s.value,color:s.color,descriptionTooltip:s.description,tooltipPlacement:y.u.Left,groupColor:n.color,showRemoveButton:!1,isSingle:!0,format:t.isMobile?d.l.Large:d.l.Medium})}),isTokenTitle:!0}),action:()=>{e.onChange(s.value)}}})),key:`group-${i}`,render:e=>(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(w.Z,{...e,topBorder:e.index>0,title:z&&(0,_.jsx)(v.r_,{group:n,showColor:!1,style:{fontSize:12}})})})}})),H=Z&&F?{items:[{key:"edit property",render:e=>(0,_.jsx)(x.Z,{...e,title:(0,_.jsx)(m.FormattedMessage,{defaultMessage:"Edit property",id:"database.tableHeaderCell.editProperty"}),icon:(0,c.W)({width:14})}),action:()=>{const t=Z.settingsStore;Z.collectionStore()&&(e.onDismiss(),h.n1({collectionContextStore:Z}),g.r$({collectionContextStore:Z,collectionSettingsStore:t}),g.H4({collectionSettingsStore:t,item:{type:"property",formatKey:Z.getPropertyFormatKey(),property:e.property}}))}}],key:"edit-property",render:e=>(0,_.jsx)(w.Z,{...e,topBorder:e.index>0})}:void 0;return(0,_.jsx)(S.Z,{...E,children:(0,_.jsx)(b.Z,{type:b.i.Vertical,initialFocus:T.length>0?0:void 0,sections:u.oA([...K,H]),onAccept:(t,s,i)=>{e.onAccept(i)}})})}},5478:(e,t,s)=>{s.d(t,{YF:()=>l,ZP:()=>c});s(67294);var i=s(24405),n=s(4023),a=s(26388),o=s(85567),r=s(85893);const l={Success:"success",Pending:"pending",Failure:"failure"};const d={display:"flex",justifyContent:"center",alignItems:"baseline"},c=function(e){let{status:t,value:s,renderTooltip:c,...u}=e;window.__c={n:"StatusToken"};const m=(0,i.Fg)(),p={[l.Success]:m.statusTokenBackground.green,[l.Pending]:m.statusTokenBackground.yellow,[l.Failure]:m.statusTokenBackground.red},g={[l.Success]:m.statusTokenIndicator.green,[l.Pending]:m.statusTokenIndicator.yellow,[l.Failure]:m.statusTokenIndicator.red},h={[l.Success]:m.statusTokenText.green,[l.Pending]:m.statusTokenText.yellow,[l.Failure]:m.statusTokenText.red};return c?(0,r.jsx)(o.Z,{...u,backgroundColor:p[t],color:h[t],value:(0,r.jsx)(a.Z,{placement:n.u.Bottom,alignment:n.v.Start,renderTooltip:c,render:e=>(0,r.jsxs)("div",{style:d,...e,children:[(0,r.jsx)("div",{style:{background:g[t],width:8,height:8,borderRadius:"100%",marginRight:4}}),s]})})}):(0,r.jsx)(o.Z,{...u,backgroundColor:p[t],color:h[t],value:(0,r.jsxs)("div",{style:d,children:[(0,r.jsx)("div",{style:{background:g[t],width:8,height:8,borderRadius:"100%",marginRight:4}}),s]})})}},13787:(e,t,s)=>{s.r(t),s.d(t,{default:()=>M});var i=s(67294),n=s(83355),a=s(49085),o=s(8848),r=s(84169),l=s(89101),d=s(82990),c=s(5366),u=s(54642),m=s(28020),p=s(33846),g=s(92083),h=s(9209),f=s(42922),y=s(74194),v=s(50506),x=s(42402),S=s(85893);class b extends n.Z{constructor(){super(...arguments),this.storeTypes={promoCodeStore:p.Z,promoError:a.default.createClass(void 0)},this.handleModalDismiss=()=>{h.Z.setState({open:!1})},this.handleChangeEmail=()=>{this.handleModalDismiss(),g.Z.setState({open:!0,openedFrom:"upsell",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0})},this.handleInputChange=e=>{this.stores.promoCodeStore.setState({...this.stores.promoCodeStore.state,inputValue:e.target.value.toUpperCase()}),this.stores.promoError.setState(void 0)},this.handleSubmitPromoCode=async()=>{const e=this.stores.promoCodeStore.state.inputValue;if(e){const t=await u.getPromoCode(this.environment,{code:e});"failed"!==t.type&&t.data.promo?h.Z.state.open&&(await h.Z.state.handlePromoCode(this.stores.promoCodeStore.state.inputValue),this.handleModalDismiss()):this.stores.promoError.setState(this.props.intl.formatMessage({defaultMessage:"Promo code {code} does not exist",id:"studentNotEligibleModal.numberedList.item2.promocode.errorMessage"},{code:e}))}}}renderComponent(){const{open:e}=h.Z.state;return(0,S.jsx)(v.Z,{open:e,innerStyle:b.wrapStyle,preventHideChildrenWhileOpening:!0,render:()=>this.renderModalContents(),onDismiss:this.handleModalDismiss})}renderModalContents(){return(0,S.jsxs)("div",{style:{fontSize:14},children:[(0,S.jsx)("div",{children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"<p>Unfortunately you are not eligible for a free Education plan if you use this email address.</p><p>K-12 students, K-12 educators, and personal email addresses such as Gmail and Outlook are not eligible to receive the <pricinglink>Education Plan</pricinglink> for free, but anyone is welcome to use the <pricinglink>Free Plan</pricinglink> for free with unlimited storage.</p>",id:"studentNotEligibleModal.header",values:{br:(0,S.jsx)("br",{}),p:e=>(0,S.jsx)("p",{style:{marginTop:0,marginBottom:8},children:1===e.length?e[0]:i.Children.toArray(e)}),pricinglink:e=>(0,S.jsx)(x.Z,{external:!0,href:l.AR.pricing,children:e})}})}),this.renderSchoolEmailCodePrompt(),this.renderPromoCode(),this.renderContactUs()]})}renderSchoolEmailCodePrompt(){const e=(0,m.B7)(this.environment);return(0,S.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,S.jsx)("div",{style:{width:18,flexShrink:0,color:this.theme.mediumTextColor},children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"1.",id:"studentNotEligibleModal.numberedList.firstItem"})}),(0,S.jsxs)("div",{style:{flexGrow:1},children:[(0,S.jsx)("div",{style:{color:this.theme.mediumTextColor},children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"Your current email is:",id:"studentNotEligibleModal.numberedList.changeEmailItem.message"})}),(0,S.jsx)("div",{style:{fontWeight:d.Z.fontWeight.medium,marginTop:0},children:e&&e.getEmail()}),(0,S.jsx)("div",{style:{color:this.theme.mediumTextColor,marginTop:4},children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"Thousands of university, college, and post-secondary school domains are already eligible, not just .edu emails!",id:"studentNotEligibleModal.numberedList.changeEmailItem.message2"})}),(0,S.jsx)(f.Z,{style:{marginTop:12},onClick:this.handleChangeEmail,isLarge:!0,children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"Change email",id:"studentNotEligibleModal.numberedList.changeEmailItem.button.label"})})]})]})}renderPromoCode(){const e=this.stores.promoError.state,t=this.props.intl.formatMessage({defaultMessage:"Enter code…",id:"studentNotEligibleModal.numberedList.item2.promocodePlaceholder"});return(0,S.jsxs)("div",{style:{display:"flex",marginTop:16},children:[(0,S.jsx)("div",{style:{width:18,flexShrink:0,color:this.theme.mediumTextColor},children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"2.",id:"studentNotEligibleModal.numberedList.secondItem"})}),(0,S.jsxs)("div",{style:{flexGrow:1},children:[(0,S.jsx)("div",{style:{color:this.theme.mediumTextColor},children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"Have a student promo code?",id:"studentNotEligibleModal.numberedList.promoCodeItem.message"})}),(0,S.jsxs)("div",{style:{display:"flex",marginTop:12},children:[(0,S.jsx)(y.Z,{style:{marginRight:8,height:32},value:this.stores.promoCodeStore.state.inputValue,onChange:this.handleInputChange,onSubmit:this.handleSubmitPromoCode,placeholder:t}),(0,S.jsx)(f.Z,{onClick:this.handleSubmitPromoCode,disabled:!this.stores.promoCodeStore.state.inputValue,isLarge:!0,children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"Submit",id:"studentNotEligibleModal.numberedList.promoCodeItem.submitButton"})})]}),(0,S.jsx)("div",{style:{color:o.ZP.red,fontSize:12,marginTop:4,marginLeft:8,height:20},children:e})]})]})}renderContactUs(){return(0,S.jsxs)("div",{style:{display:"flex",alignItems:"center",color:this.theme.lightTextColor,borderTop:`1px solid ${this.theme.regularDividerColor}`,paddingTop:14},children:[(0,r.m)({width:14,marginTop:1,marginRight:6,fill:this.theme.lightIconColor})," ",(0,S.jsx)("div",{children:(0,S.jsx)(c.FormattedMessage,{defaultMessage:"Have questions about this? <inlinelink>More info & FAQs</inlinelink>.",id:"studentNotEligibleModal.contactUsSection.message",values:{inlinelink:e=>(0,S.jsx)(x.Z,{href:"https://www.notion.so/Notion-for-students-teachers-adc631df15ee4ab9a7a33dd50f4c16fe",external:!0,children:e})}})})]})}}b.displayName="StudentNotEligibleModal",b.wrapStyle={padding:"24px 36px 24px",minWidth:300,maxWidth:400};const M=(0,c.injectIntl)(b)},6202:(e,t,s)=>{s.d(t,{Z:()=>u});s(67294);var i=s(83355),n=s(8848),a=s(87279),o=s(42922),r=s(64921),l=s(28992),d=s(85893);class c extends i.Z{renderComponent(){return(0,d.jsx)(l.Z,{title:this.renderButton()})}renderButton(){const{isMobile:e}=this.environment.device;return e?(0,d.jsx)(r.Z,{onClick:this.props.onClick,mobileFeedback:!0,disabled:this.props.disabled,style:c.buttonMobileStyle,children:this.props.title}):(0,d.jsx)(o.Z,{onClick:this.props.onClick,disabled:this.props.disabled,style:{width:"100%",maxWidth:300,display:"flex",margin:"auto"},children:this.props.title})}}c.displayName="SubmitButtonMenuItem",c.contextTypes={...a.mw,...i.w},c.buttonMobileStyle={width:"100%",color:n.ZP.blue};const u=c},30676:(e,t,s)=>{s.d(t,{F:()=>r});s(67294);var i=s(86628),n=s(52275),a=s(93686),o=s(85893);function r(e){window.__c={n:"TeamMenuItem"};const{teamStore:t}=e,{name:s}=(0,i.VK)((()=>({name:t.getName()})),[t]);return(0,o.jsx)(n.Z,{...e,icon:(0,o.jsx)(a.p,{size:14,store:t,disabled:!0}),title:s})}},719:(e,t,s)=>{s.d(t,{Z:()=>l});s(67294);var i=s(83355),n=s(98742),a=s(74194),o=s(85893);class r extends i.Z{constructor(){super(...arguments),this.handleKeyDown=e=>{"Backspace"===e.key&&0===this.props.value.length&&this.props.onRemoveLastToken()}}renderComponent(){const{device:e}=this.environment;return(0,o.jsxs)("div",{className:this.props.readOnly?void 0:"notion-focusable-within",onClick:this.props.onClick,style:e.isMobile?this.getMobileWrapStyle():this.getDesktopWrapStyle(),children:[this.props.tokens,this.renderInput()]})}renderInput(){const{device:e}=this.environment,t=0===this.props.tokens.length;return(0,o.jsx)(a.Z,{format:a.Z.Format.Transparent,...(0,n.Z)({onKeyDown:this.handleKeyDown},{onChange:this.props.onChange}),value:this.props.value,onSubmit:this.props.onSubmit,onBlur:this.props.onBlur,focus:this.props.focus,style:{...r.inputStyle,margin:e.isMobile?"0 8px 8px 0":"0 6px 6px 0"},readOnly:this.props.readOnly,inputStyle:{height:18},size:1,type:this.props.type,placeholder:t?this.props.placeholder:"",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1})}getDesktopWrapStyle(){return{display:"flex",flexWrap:"wrap",alignItems:"flex-start",minHeight:32,boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,borderRadius:3,fontSize:14,cursor:"text",overflow:"hidden",padding:"7px 9px 0px",...this.props.style}}getMobileWrapStyle(){return{...this.getDesktopWrapStyle(),fontSize:14,padding:"7px 10px 0"}}}r.displayName="TokenInput",r.inputStyle={flexGrow:1,flexShrink:1,flexBasis:60,minWidth:60,width:"auto",lineHeight:"20px"};const l=r},25405:(e,t,s)=>{s.r(t),s.d(t,{TopbarMoreMenu:()=>As});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(5366),l=s(13991),d=s(15145),c=s(41432),u=s(90792),m=s(77366),p=s(88437),g=s(50066),h=s(82356),f=s(27714),y=s(90199),v=s(60651),x=s(2356),S=s(37888),b=s(76994),M=s(23867),w=s(82990),j=s(50906),C=s(14871),k=s(79257),_=s(54532),T=s(61652),I=s(96802),P=s(94419),Z=s(72711),F=s(19785),A=s(34602),D=s(37834),B=s(39699),R=s(93405),L=s(72495),N=s(8848),E=s(98742),O=s(64921),V=s(26388),U=s(64369),W=s(85893);function z(e,t){let{id:s,caption:i,focused:a,isActive:r,onClick:l,onMouseDown:d,onMouseEnter:c,onMouseLeave:u,role:m,style:p,tooltip:g,ignoreLocalHoverState:h,disallowTabbing:f}=e;window.__c={n:"FontMenuItem"};const y=(0,n.Fy)(),v=(0,o.yK)((()=>({optionItem:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:34,justifyContent:"flex-end"},button:{width:"100%",...y.isMobile?{padding:16,paddingTop:20,transition:"color 300ms, border 300ms",lineHeight:1}:{padding:6,paddingTop:10,borderRadius:3,transition:"color 300ms, border 300ms",lineHeight:1},justifyContent:"center",color:r?N.ZP.blue:"inherit"}})),[r,y]);return(0,W.jsx)(V.Z,{renderTooltip:()=>g,placement:V.Z.Placement.Bottom,delayThreshold:80,render:e=>{const n=(0,E.Z)(e,{onMouseEnter:c,onMouseLeave:u}),{onMouseDown:o,...r}=n;return(0,W.jsx)(O.Z,{...r,id:s,role:m,ref:t,mobileFeedback:y.isMobile,onClick:l,onMouseDown:n.onMouseDown||d,hovered:a,style:v.button,ignoreLocalHoverState:h,disallowTabbing:f,className:"notranslate",children:(0,W.jsxs)("div",{style:v.optionItem,children:[(0,W.jsx)("div",{style:{...p,height:25},children:"Ag"}),(0,W.jsx)(U.Z,{isSmall:!0,style:{marginTop:4},children:i})]})})}})}const K=i.forwardRef(z);var H=s(83355),G=s(87279);class q extends H.Z{constructor(){super(...arguments),this.desktopStyle={display:"flex",justifyContent:"space-between",marginLeft:14,marginRight:14}}renderComponent(){return(0,W.jsx)(L.Z,{...this.props,children:(0,W.jsx)("div",{style:this.environment.device.isMobile?this.getMobileStyle():this.desktopStyle,children:this.props.children})})}getMobileStyle(){return{display:"flex",justifyContent:"space-around",boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`,background:this.theme.popoverBackground}}}q.displayName="FontSectionMenuItem",q.contextTypes={...G.mw,...H.w};const Y=q;s(57658);var Q=s(27006),$=s(77420),X=s(97880);const J=(0,s(45238).I)("disconnect",{viewBox:"0 0 16 16",svg:(0,W.jsx)("path",{d:"M6.45508 4.50977L7.28906 5.34375L8.7041 3.4707L7.67871 5.7334L9.45605 7.51074H11.083L10.3857 8.43359L11.2539 9.30859L12.7852 7.36035C12.9082 7.20996 12.9697 7.06641 12.9697 6.90234C12.9697 6.61523 12.751 6.41016 12.4502 6.41016H8.54688L10.5703 1.05078C10.8506 0.298828 10.0645 -0.0976562 9.58594 0.517578L6.45508 4.50977ZM12.874 13.6631C13.0859 13.875 13.4346 13.875 13.6396 13.6631C13.8516 13.458 13.8584 13.1025 13.6396 12.8906L3.10547 2.35645C2.90039 2.15137 2.53809 2.14453 2.33301 2.35645C2.12793 2.56152 2.12793 2.92383 2.33301 3.12891L12.874 13.6631ZM3.0166 9.12402C3.0166 9.4043 3.23535 9.61621 3.53613 9.61621H7.44629L5.41602 14.9688C5.13574 15.7207 5.92188 16.1172 6.40039 15.5088L9.52441 11.5166L8.69043 10.6895L7.28223 12.5488L8.30078 10.293L6.5166 8.51562H4.89648L5.60059 7.59277L4.72559 6.71777L3.20801 8.65918C3.08496 8.81641 3.0166 8.95996 3.0166 9.12402Z"})});var ee=s(18442),te=s(39248),se=s(74181),ie=s(21202),ne=s(15070),ae=s(80444),oe=s(52275),re=s(70301);class le extends H.Z{renderComponent(){const{bot:e}=this.props,{currentUserRootStore:t}=ae.default.state;if(e&&t)return(0,W.jsx)(oe.Z,{...this.props,icon:(0,W.jsx)(re.Z,{botValue:e}),title:(0,ne.Mh)(e)})}}le.displayName="BotMenuItem",le.contextTypes={...G.mw,...H.w};const de=le;var ce=s(68894),ue=s(68785),me=s(28992),pe=s(43765),ge=s(31278),he=s(76798),fe=s(84015),ye=s(41892),ve=s(24600),xe=s(84210),Se=s(28187),be=s(42402),Me=s(60442);function we(e){return(0,a.VK)((()=>{var t;return{isDefined:e.isDefined(),channel:null===(t=e.getKeyStore("channel").getValue())||void 0===t?void 0:t.replace(/^#/,"")}}),[e])}function je(){return(0,W.jsx)(Me.Z,{imageURL:ye.Z.images.tooltips.pageUpdates.slackPng,imageHeight:100,caption:(0,W.jsx)(r.FormattedMessage,{defaultMessage:"Connect a Slack channel to get updates about this page and pages within it.",id:"topbar.updatesButton.slackIntegrationButton.tooltip"})})}const Ce=()=>(0,W.jsx)(Me.Z,{imageURL:ye.Z.images.tooltips.pageUpdates.slackPng,imageHeight:100,caption:(0,W.jsx)(r.FormattedMessage,{defaultMessage:"Disconnect a Slack channel to stop getting updates about this page and pages within it.",id:"topbar.updatesButton.slackIntegrationButton.disconnectTooltip"})}),ke=(0,i.forwardRef)((function(e,t){window.__c={n:"SlackInheritedMenuItem"};const{blockStore:s,...i}=e,{blockStore:n,slackIntegrationStore:o}=(0,Se.Jk)(s),{isDefined:l,channel:c}=we(o),u=(0,a.VK)((()=>(0,xe.ZP)({store:n,pageVisitSource:d.tY.LinkInPage})),[n]);return l?(0,W.jsx)(V.Z,{placement:V.Z.Placement.Left,render:e=>(0,W.jsx)(R.Z,{...(0,E.Z)(e,i),svg:ve.P,title:c,caption:(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(r.FormattedMessage,{defaultMessage:"Based on",id:"topbar.updatesButton.slackIntegrationButton.activeTitle"})," ",(0,W.jsx)(be.Z,{href:u,children:(0,W.jsx)(he.Z,{store:n,style:{display:"inline"}})})]}),ref:t}),renderTooltip:Ce}):null})),_e=(0,i.forwardRef)((function(e,t){window.__c={n:"SlackConnectedMenuItem"};const{blockStore:s,...i}=e,{slackIntegrationStore:n}=(0,a.VK)((()=>(0,Se.Jk)(s)),[s]),{isDefined:o,channel:l}=we(n);return o?(0,W.jsx)(V.Z,{placement:V.Z.Placement.Left,render:e=>(0,W.jsx)(R.Z,{svg:ve.P,title:l,caption:(0,W.jsx)(r.FormattedMessage,{defaultMessage:"Connected to Slack channel",id:"topbar.updatesButton.slackIntegrationButton.connectedCaption"}),...(0,E.Z)(e,i)}),renderTooltip:Ce,ref:t}):null}));var Te=s(26825),Ie=s(48019),Pe=s(78140),Ze=s(40721),Fe=s(42782);const Ae=(0,i.forwardRef)((function(e,t){const{context:s,parent:o,isSharedDirectly:r,botStore:l,botPermissionSourcePage:d,originConnectionLabel:c,...u}=e,m=(0,n.O7)(),p=(0,a.VK)((()=>ae.default.state.currentSpaceStore),[]),g=s.blocks[0],h=(0,a.VK)((()=>g.canAdmin()&&(null==p?void 0:p.canRead())),[g,p]),{botCapabilities:f,botName:y}=(0,a.VK)((()=>({botCapabilities:l.getCapabilities(),botName:l.getName()})),[l]);return(0,i.createElement)(Fe.Z,{...u,key:l.id,renderOrigin:e=>(0,W.jsx)(oe.Z,{...e,title:c,icon:(0,W.jsx)(re.Z,{botStore:l,showActiveDot:!0,style:{position:"relative"}})}),renderExtension:(e,t)=>{let i;return i=m.device.isPhone?{menuType:G.og.Modal,right:(0,W.jsx)(Ze.DoneMenuText,{}),onClickRight:t.close,...e}:{menuType:G.og.Popup,width:220,...e},(0,W.jsx)(Pe.Z,{...i,children:(0,W.jsx)(Ie.Z,{context:s,initialFocus:0,onAccept:o.onAccept,sections:[De({isSharedDirectly:r,botCapabilities:f,botPermissionSourcePage:d}),...h?[Be({isSharedDirectly:r,botId:l.id,botName:y})]:[]]})})},onFocus:o.onFocus,focused:u.focused,openOnFocus:!1,ref:t})}));function De(e){const{botCapabilities:t,isSharedDirectly:s,botPermissionSourcePage:i}=e,n=(0,Te.uH)(t);return{key:"active connection capabilities section",render:e=>(0,W.jsx)(L.Z,{...e,topBorder:!1}),actions:[...s?[]:[xt(i)],St(n)]}}function Be(e){const{isSharedDirectly:t,botId:s,botName:i}=e;return{key:"active connection disconnect section",render:e=>(0,W.jsx)(L.Z,{...e}),actions:t?[bt(s,i)]:[Mt(s)]}}var Re=s(47453),Le=s(59753),Ne=s(9844),Ee=s(2985),Oe=s(41623),Ve=s(38755),Ue=s(90106);const We=(0,i.forwardRef)((function(e,t){const{context:s,parent:o,alreadyConnectedIntegrationIds:r,alreadyConnectedBotIds:l,originButtonLabel:d,...c}=e,u=s.blocks[0],m=(0,n.O7)(),p=(0,a.VK)((()=>ae.default.state.currentSpaceStore),[]),g=(0,a.VK)((()=>null==p?void 0:p.getBotSettingsStore().getValue()),[p]),h=(0,a.VK)((()=>null!=g&&g.integration_restrictions&&null!=g&&g.integration_approval_statuses?Object.keys(g.integration_approval_statuses):[]),[g]),[f,y]=(0,i.useState)(""),[v,x]=(0,i.useState)({status:"loading"});(0,i.useEffect)((()=>{Promise.all([async function(e){return await Ee.RF({environment:m,query:e})}(f),async function(e){return await Ee.sC({query:e,environment:m,spaceId:null==p?void 0:p.id,botSettings:g})}(f)]).then((e=>{let[t,s]=e;const i=new Set,n=function(e){const{alreadyConnectedBotIds:t,alreadyConnectedIntegrationIds:s,botValues:i,environment:n}=e,a=[];for(const o of i){const e=o.id,i=t.has(e)||o.integration_id&&s.has(o.integration_id),r=Le.kk.fromValue($.cZ,o),l=(0,Oe.Nq)(n,r)||(0,Ve.Fn)(n)&&(0,Oe.f_)(r);!i&&l&&a.push(o)}return a}({alreadyConnectedBotIds:l,alreadyConnectedIntegrationIds:r,botValues:t,environment:m}).map((e=>(e.integration_id&&i.add(e.integration_id),{table:$.cZ,value:e})));let a=s.map((e=>{if(p){const t=Ue.t1.createChildStore(p,{id:e,table:Ne.K2}),s=t.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:s}=e;return s(t)}));if(s&&!(0,se.VM)(s)){return{table:Ne.K2,value:s}}}})).filter(X.$K).filter((e=>!(i.has(e.value.id)||r.has(e.value.id))));if(se.Cb.name.toLowerCase().includes(f.toLowerCase())){const e={table:"legacy_integration",value:se.Cb};a=[...a,e]}const o=[...n,...a].sort(((e,t)=>{var s,i;const n=null===(s=e.value.name)||void 0===s?void 0:s.toLowerCase(),a=null===(i=t.value.name)||void 0===i?void 0:i.toLowerCase();return n&&a?n<a?-1:n>a?1:0:0}));x({results:o,status:"ready"})})).catch((e=>x({status:"error"})))}),[f,p,l,g,h,m,r,u]);return(0,W.jsx)(Fe.Z,{...c,renderOrigin:(e,t)=>(0,W.jsx)(R.Z,{...e,ref:t,title:d,svg:Re.R}),renderExtension:(e,t)=>{const i=m.device.isMobile?{menuType:G.og.Modal,right:(0,W.jsx)(Ze.DoneMenuText,{}),onClickRight:t.close,...e}:{menuType:G.og.Popup,width:220,...e},n=m.device.isMobile?{menuType:G.og.Modal,topbarStyle:{height:0}}:{menuType:G.og.Popup,width:220,maxHeight:"16vh",...e},a=Boolean(u.canAdmin()&&(null==p?void 0:p.canRead()));return(0,W.jsx)(Pe.Z,{...i,onClick:e=>{e.stopPropagation()},children:(0,W.jsx)(Ie.Z,{initialFocus:0,context:s,onAccept:()=>{j.sSR(m)},sections:[...a?[ze(f,y),""===f?Ke({searchResults:v,resultsMenuProps:n}):Ge({searchResults:v,resultsMenuProps:n})]:[],qe(a,se.Cb)]})})},onFocus:o.onFocus,focused:c.focused,openOnFocus:!0,ref:t})}));function ze(e,t){return{key:"search connections section",render:e=>(0,W.jsx)(L.Z,{...e,isInput:!0}),actions:[mt(e,t)]}}function Ke(e){const{searchResults:t,resultsMenuProps:s}=e,i=new Set;return{key:"search initial connections section",render:e=>(0,W.jsx)(He,{...e,resultsMenuProps:s}),actions:[..."ready"===t.status?t.results.map((e=>"bot"===e.table?(e.value.integration_id&&i.add(e.value.integration_id),gt(e.value)):Ct(e)?(0,Se.F6)()&&!(0,Se.SG)()?void 0:ft(e.value):ht(e.value))).filter(X.$K):"loading"===t.status?[ut()]:[pt()]]}}function He(e){window.__c={n:"IntegrationSearchResultsSection"};const{resultsMenuProps:t,...s}=e,n=(0,i.useRef)(null),a=(0,i.useCallback)((()=>{var e;const t=null===(e=n.current)||void 0===e||null===(e=e.querySelector('[role="menuitem"]'))||void 0===e?void 0:e.clientHeight,s=window.innerHeight<600?3:7;n.current&&t&&(n.current.style.maxHeight=s*t+.5*t+"px")}),[]);return(0,i.useEffect)((()=>(a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)})),[a]),(0,W.jsx)(Pe.Z,{...t,innerRef:n,children:(0,W.jsx)(L.Z,{...s,isInput:!0,topBorder:!1,style:{margin:0,paddingTop:0,paddingBottom:0}})})}function Ge(e){const{searchResults:t,resultsMenuProps:s}=e;let i=[];return i="error"===t.status?[pt()]:"loading"===t.status?[ut()]:"ready"===t.status&&t.results.length>0?t.results.map((e=>e.table===$.cZ?gt(e.value):Ct(e)?(0,Se.F6)()&&!(0,Se.SG)()?void 0:ft(e.value):ht(e.value))).filter(X.$K):[{key:"connections search error",displayName:Qe.default.formatMessage(dt.connectionNoSearchResultsLabel),analyticsName:dt.connectionNoSearchResultsLabel.defaultMessage,searchName:dt.connectionNoSearchResultsLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ct],render:e=>(0,W.jsx)(pe.Z,{title:Qe.default.formatMessage(dt.connectionNoSearchResultsLabel)}),action:()=>{}}],{key:"connections search results",render:e=>(0,W.jsx)(He,{...e,resultsMenuProps:s}),actions:i}}function qe(e,t){const s=e,i=!(0,Se.F6)()||(0,Se.SG)();return{key:"manage connections section",render:t=>(0,W.jsx)(L.Z,{...t,style:{marginTop:e?6:0}}),actions:[...!s&&i?[ft(t)]:[],{key:"manage connections",displayName:Qe.default.formatMessage(dt.manageConnectionsLabel),analyticsName:dt.manageConnectionsLabel.defaultMessage,searchName:dt.manageConnectionsLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,Ye.ff(Ye.tq)],render:e=>(0,W.jsx)(R.Z,{...e,title:Qe.default.formatMessage(dt.manageConnectionsLabel),svg:ee.H}),action:()=>{Je.r$({currentTab:"connected_apps",openedFrom:"topbar"})}}]}}var Ye=s(19037),Qe=s(33929),$e=s(76463),Xe=s(47307),Je=s(91376),et=s(76464),tt=s(515),st=s(95477),it=s(91924),nt=s(84908),at=s(15356),ot=s(9953);const rt=(0,r.defineMessages)({somethingWentWrong:{defaultMessage:"Something went wrong.",id:"slackActions.dialogError.loginWithSlack.errorMessage"},titleMessage:{defaultMessage:"Slack login",id:"slackActions.loginPopupModal.title"},removeIntegrationMessage:{id:"slackIntegrationButton.removeIntegrationConfirmationDialog.prompt",defaultMessage:"Are you sure you want to remove Slack integration?"},removeIntegrationConfirmationLabel:{id:"slackIntegrationButton.removeIntegrationConfirmationDialog.removeButton.label",defaultMessage:"Remove"}});const lt=async e=>{let{environment:t,blockId:s,intl:i}=e;j.McA(t),await async function(e){const{environment:t,blockId:s,intl:i}=e,n=(0,it.eC)(t);let a=(0,tt.GD)(st.default.domainBaseUrl,{blockId:s,authType:n,userId:t.currentUser.id});if(a=n.redirectToAuth?a:await(0,it.HU)(t,a),t.device.isElectron)return void nt.openExternalUrl(a);const o=await at.M(t,{width:530,height:530,url:a,titleMessage:rt.titleMessage});if(!o)return void Xe.showErrorMessage(i.formatMessage(rt.somethingWentWrong));const r=(0,tt.Wj)({url:o,isMobile:t.device.isMobile,baseUrl:st.default.domainBaseUrl,publicDomainName:st.default.publicDomainName,protocol:st.default.protocol,currentUrl:window.location.href});"slackAuthCallback"===r.name&&A.handleSlackAuthCallback({route:r,environment:t})}({environment:t,blockId:s,intl:i})},dt=(0,r.defineMessages)({connectionLoadingLabel:{id:"topbar.connectionsSection.connectionLoading.label",defaultMessage:"Connections loading…"},connectionSearchPlaceholderLabel:{id:"topbar.connectionsSection.topbarMoreConnectionsSubMenu.label",defaultMessage:"Search for connections..."},connectionSearchErrorLabel:{id:"topbar.connectionsSection.connectionSearchError.label",defaultMessage:"Something went wrong"},connectionNoSearchResultsLabel:{id:"topbar.connectionsSection.noSearchResults.label",defaultMessage:"No results"},connectionSearchResultLabel:{id:"topbar.connectionsSection.connectionSearchResult.label",defaultMessage:"{name}"},slackEmptyLabel:{id:"topbar.connectionSection.slackEmpty.label",defaultMessage:"Slack"},slackConnectedLabel:{id:"topbar.connectionSection.slackConnected.label",defaultMessage:"Connected to Slack channel"},manageConnectionsLabel:{id:"topbar.connectionsSection.manageConnections.label",defaultMessage:"Manage connections"},addConnectionsLabel:{id:"topbar.connectionsSection.addConnections.label",defaultMessage:"Add connections"},fromParentPageLabel:{id:"topbar.connectionsSection.fromParenPage.label",defaultMessage:"From"},capabilitiesLabel:{id:"topbar.connectionsSection.capabilities.label",defaultMessage:"Capabilities"},disconnectLabel:{id:"topbar.connectionSection.disconnectIntegration.label",defaultMessage:"Disconnect"},disconnectConfirmationLabel:{id:"topbar.connectionSection.disconnectIntegrationConfirmation.label",defaultMessage:"{botName} will be removed from this page and all child pages. Continue?"},restrictionLabel:{id:"topbar.connectionSection.restrictIntegration.label",defaultMessage:"Restrict"},restrictionConfirmationLabel:{id:"topbar.connectionSection.restrictIntegrationConfirmation.label",defaultMessage:"Are you sure you want to remove this permission and restrict access? This page will no longer share settings from the parent page."},restrictionAcceptLabel:{id:"topbar.connectionSection.restrictAccept.label",defaultMessage:"Restrict access"},connectionLabel:{id:"topbar.connectionSection.connectionIntegration.label",defaultMessage:"{connectionName}"},connectionBotConfirmlabel:{id:"topbar.connectionSection.connectBotConfirmation.label",defaultMessage:"{botName} will have access to this and all child pages. Continue?"},connectionIntegrationConfirmlabel:{id:"topbar.connectionSection.connectIntegrationConfirmation.label",defaultMessage:"{integrationName} is developed by a third party partner and you will be redirected outside of Notion to authorize this connection. Continue?"}}),ct=Ye.ff(Ye.xD([Ye.tq,Ye.ff(Ye.xD([Ye.zz,Ye.J5]))]));function ut(){return{key:"connections loading",displayName:Qe.default.formatMessage(dt.connectionLoadingLabel),analyticsName:dt.connectionLoadingLabel.defaultMessage,searchName:dt.connectionLoadingLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ct],render:e=>(0,W.jsx)(me.Z,{...e,icon:(0,W.jsx)(ue.Z,{}),title:Qe.default.formatMessage(dt.connectionLoadingLabel)}),action:()=>{}}}function mt(e,t){return{key:"search connections input",analyticsName:dt.connectionSearchPlaceholderLabel.defaultMessage,displayName:Qe.default.formatMessage(dt.connectionSearchPlaceholderLabel),searchName:dt.connectionSearchPlaceholderLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ct],render:()=>(0,W.jsx)(ce.ZP,{value:e,onChange:e=>t(e.target.value),placeholder:Qe.default.formatMessage(dt.connectionSearchPlaceholderLabel),focus:!0}),action:()=>{}}}function pt(){return{key:"connections search error",displayName:Qe.default.formatMessage(dt.connectionSearchErrorLabel),analyticsName:dt.connectionSearchErrorLabel.defaultMessage,searchName:dt.connectionSearchErrorLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ct],render:e=>(0,W.jsx)(pe.Z,{title:Qe.default.formatMessage(dt.connectionSearchErrorLabel)}),action:()=>{}}}function gt(e){const{id:t,name:s}=e,i=Qe.default.formatMessage(dt.connectionSearchResultLabel,{name:s});return{key:`${t}`,displayName:i,analyticsName:i,searchName:s,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ct],render:(t,s)=>(0,W.jsx)(de,{...t,bot:e,focused:t.focused,onClick:async()=>{await wt(s.blocks[0],s.environment,e)},ref:t.ref}),action:async t=>{await wt(t.blocks[0],t.environment,e)}}}function ht(e){const{id:t,name:s,info:i}=e,n=Qe.default.formatMessage(dt.connectionLabel,{connectionName:s});return{key:`${t}`,displayName:n,analyticsName:n,searchName:s,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ct,Ye.ff(Ye.tq)],render:e=>(0,W.jsx)(oe.Z,{...e,title:n,icon:(0,W.jsx)("img",{src:i.icon,style:{width:18,height:"auto"},ref:e.ref})}),action:async t=>{let{environment:s}=t;e.id!==se.T0&&await async function(e,t){const{id:s,name:i}=e,n=await Xe.confirmUserAction({message:Qe.default.formatMessage(dt.connectionIntegrationConfirmlabel,{integrationName:i})}),a=(0,te.E)(s,i);n&&A.navigateToExternalURL({environment:t,url:a,targetSelf:!1})}(e,s)}}}function ft(e){const t=Qe.default.formatMessage(dt.slackEmptyLabel);return{key:"slack empty",displayName:t,analyticsName:dt.slackEmptyLabel.defaultMessage,searchName:t,closeParentMenu:!0,validators:[Ye.Gg,Ye.J5,Ye.YP,Ye.tJ,Ye.OF,Ye.ff(Ye.Fx)],render:s=>(0,W.jsx)(V.Z,{placement:V.Z.Placement.Left,render:i=>(0,W.jsx)(oe.Z,{...(0,E.Z)(i,s),title:t,icon:(0,W.jsx)("img",{src:e.info.icon,style:{height:18}})}),renderTooltip:je}),action:e=>{var t;lt({environment:e.environment,blockId:null===(t=e.blocks)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.id,intl:Qe.default.getIntl()})}}}function yt(){const e=Qe.default.formatMessage(dt.slackConnectedLabel);return{key:"slack connected inherited",displayName:e,analyticsName:dt.slackConnectedLabel.defaultMessage,searchName:e,closeParentMenu:!0,validators:[Ye.Gg,Ye.J5,Ye.ur,Ye.ff(Ye.Fx)],render:(e,t,s)=>(0,W.jsx)(ke,{blockStore:t.blocks[0],...e}),action:e=>{}}}function vt(){const e=Qe.default.formatMessage(dt.slackConnectedLabel);return{key:"slack connected on block",displayName:e,analyticsName:dt.slackConnectedLabel.defaultMessage,searchName:e,closeParentMenu:!0,validators:[Ye.Gg,Ye.J5,Ye.Rd,Ye.ff(Ye.Fx)],render:(e,t,s)=>(0,W.jsx)(_e,{blockStore:t.blocks[0],...e}),action:e=>{const{slackIntegrationStore:t}=(0,Se.Jk)(e.blocks[0]);((e,t,s)=>{Xe.showDialog({message:s.formatMessage(rt.removeIntegrationMessage),showCancel:!0,keepFocus:!0,items:[{label:s.formatMessage(rt.removeIntegrationConfirmationLabel),color:"red",onAccept:()=>{j.Uut(e),B.createAndCommit({userAction:"slackActions.handleRemoveSlackIntegration",environment:e,perform:e=>{ot.sW({store:t,data:{enabled:!1},transaction:e})}})}}]})})(e.environment,t,Qe.default.getIntl())}}}function xt(e){const t=Qe.default.formatMessage(dt.fromParentPageLabel);return{key:"from parent page",displayName:t,analyticsName:t,searchName:t,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5],action:()=>{},render:(t,s)=>{let{blocks:i}=s;const n=i[0],a=Ue.G.createChildStore(n,{table:ie.iU,id:e.blockId});return(0,W.jsx)(jt,{parentBlockStore:a})}}}function St(e){const t=Qe.default.formatMessage(dt.capabilitiesLabel);return{key:"capabilities",displayName:t,analyticsName:t,searchName:t,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5],action:()=>{},render:()=>(0,W.jsx)(fe._,{role:e})}}function bt(e,t){const s=Qe.default.formatMessage(dt.disconnectLabel);return{key:"disconnect integration",displayName:s,analyticsName:s,searchName:dt.disconnectLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5],action:async s=>{let{blocks:i,environment:n}=s;const a=i[0];await async function(e,t,s,i){await Xe.confirmUserAction({message:Qe.default.formatMessage(dt.disconnectConfirmationLabel,{botName:i})})&&$e.RN({botId:s,store:e,environment:t})}(a,n,e,t)},render:e=>(0,W.jsx)(R.Z,{...e,svg:J,title:s,focused:!0})}}function Mt(e){const t=Qe.default.formatMessage(dt.disconnectLabel),s=Qe.default.formatMessage(dt.restrictionLabel);return{key:"restrict page from permission model",displayName:s,analyticsName:s,searchName:dt.restrictionLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5],action:async t=>{let{blocks:s,environment:i}=t;const n=s[0];await async function(e,t,s){if(await Xe.confirmUserAction({message:Qe.default.formatMessage(dt.restrictionConfirmationLabel),acceptLabel:Qe.default.formatMessage(dt.restrictionAcceptLabel)})){const i={type:"bot_permission",role:"none",bot_id:e};B.createAndCommit({userAction:"TopbarMoreConnections.restrictPagePermissions",environment:s,perform:e=>{et.Pk({environment:s,store:t,permissionItem:i,shouldInherit:!0,transaction:e})}})}}(e,n,i)},render:e=>(0,W.jsx)(R.Z,{...e,svg:J,title:t,focused:!0})}}async function wt(e,t,s){await Xe.confirmUserAction({message:Qe.default.formatMessage(dt.connectionBotConfirmlabel,{botName:s.name})})&&$e.v2({botValue:s,store:e,environment:t})}function jt(e){window.__c={n:"FromParentPageMenuItem"};const{parentBlockStore:t}=e,s=(0,a.VK)((()=>t.getIcon()),[t]),l=(0,a.VK)((()=>t.isEmptyPage()),[t]),c=(0,n.O7)(),u=(0,o.Fg)(),[m,p]=(0,i.useState)("transparent"),g=c.device.isMobile?{fontSize:14,paddingLeft:4}:{fontSize:12,paddingLeft:4};return(0,W.jsx)(pe.Z,{...e,title:(0,W.jsxs)("span",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start"},children:[(0,W.jsx)(r.FormattedMessage,{id:"topbar.connectionSection.parentPage.label",defaultMessage:"From"}),(0,W.jsxs)("span",{style:{display:"flex",alignItems:"center",padding:2,borderRadius:2,marginLeft:2,cursor:"pointer",backgroundColor:m,color:u.regularTextColor,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},onClick:()=>{A.navigateToBlock({environment:c,store:t,pageVisitSource:d.tY.LinkInPage})},onMouseEnter:()=>{p(u.selectLightGray[100])},onMouseLeave:()=>{p("transparent")},onMouseDown:()=>{p(u.selectLightGray[200])},onMouseUp:()=>{p(u.selectLightGray[100])},children:[(0,W.jsx)(ge.Z,{disabled:!0,icon:s,isEmptyPage:l,size:12,style:{margin:"0px 2px"}}),(0,W.jsx)(he.Z,{store:t})]})]}),textWrapperStyle:g})}function Ct(e){return"legacy_integration"===e.table&&e.value.id===se.Cb.id}var kt=s(67669);function _t(e,t,s){const i=function(e){var t;const s=e.blocks[0],i=(0,kt.YO)(s).filter((0,X.AO)((e=>(0,Q.FB)(e.permissionItem)?{true:{...e,permissionItem:e.permissionItem}}:{false:e})));if(0===i.length)return{status:"no bots"};const n=new Map,a=null===(t=ae.default.state.currentSpaceStore)||void 0===t?void 0:t.id,o=i.map((e=>{let{from:t,permissionItem:i}=e;const o=Ue.t1.createChildStore(s,{table:$.cZ,id:i.bot_id,spaceId:a});if("block"===t.table)return n.set(i.bot_id,t),o})).filter(X.$K);if(o.every((e=>e.isReady()))){const t=o.filter((t=>t.isDefined()&&Boolean((0,Oe.Nq)(e.environment,t.getModel()))));if((0,Ve.Fn)(e.environment)){const e=t.map((e=>e.getIntegrationId())),s=new Set(e),i=o.filter((e=>!(!e.isDefined()||s.has(e.getIntegrationId())||!Boolean((0,Oe.f_)(e.getModel()))||(s.add(e.getIntegrationId()),0))));t.push(...i)}return{status:"ready",botStores:t,botIdToSharedPageIds:n}}return{status:"loading"}}(e),{status:n}=i;if("no bots"===n||"loading"===n)return i;{const{botStores:e,botIdToSharedPageIds:n}=i;return{status:"ready",botActions:e.map((e=>{if(e.isDefined()){const i=e.getIntegrationId();i&&t.add(i);const a=n.get(e.id);if(a)return s.add(e.id),function(e){const{botStore:t,botPermissionSourcePage:s}=e,{id:i}=t,n=t.getName(),a=Qe.default.formatMessage(dt.connectionLabel,{connectionName:n});return{key:`${i}`,displayName:a,analyticsName:a,searchName:a,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5],action:()=>{},render:(e,i,n)=>{const o=i.blocks[0].id===s.blockId;return(0,W.jsx)(Ae,{...e,context:i,parent:n,isSharedDirectly:o,botStore:t,botPermissionSourcePage:s,originConnectionLabel:a})}}}({botStore:e,botPermissionSourcePage:a})}})).filter(X.$K)}}}function Tt(e){const t=new Set,s=new Set,i=_t(e,t,s),n=function(e,t){const s=Qe.default.formatMessage(dt.addConnectionsLabel);return{key:"add connections action",displayName:s,analyticsName:dt.addConnectionsLabel.defaultMessage,searchName:dt.addConnectionsLabel.defaultMessage,closeParentMenu:!1,validators:[Ye.Gg,Ye.J5,ct],action:()=>{},render:(i,n,a)=>(0,W.jsx)(We,{...i,context:n,parent:a,alreadyConnectedIntegrationIds:e,alreadyConnectedBotIds:t,originButtonLabel:s})}}(t,s);if("no bots"===i.status)return{loadingAction:[],connectedActions:[],searchSubMenu:n};if("loading"===i.status)return{loadingAction:[ut()],connectedActions:[],searchSubMenu:n};{const{botActions:e}=i;return{loadingAction:[],connectedActions:e,searchSubMenu:n}}}function It(e){const{loadingAction:t,connectedActions:s,searchSubMenu:i}=Tt(e);return{key:"topbar connections",render:e=>(0,W.jsx)(L.Z,{...e,topBorder:!0,title:(0,W.jsx)(r.FormattedMessage,{id:"topbar.connectionSection.label",defaultMessage:"Connections"})}),actions:[...t,...[yt(),vt()],...s,i]}}var Pt=s(64536),Zt=s(42115),Ft=s(28020),At=s(68821),Dt=s(78316),Bt=s(21969),Rt=s(41984),Lt=s(24764),Nt=s(36896),Et=s(44604),Ot=s(77080),Vt=s(47593),Ut=s(30496),Wt=s(92083),zt=s(34583),Kt=s(49386),Ht=s(29768),Gt=s(62967),qt=s(42784),Yt=s(2295),Qt=s(34658),$t=s(63923),Xt=s(68714),Jt=s(5337),es=s(63029);const ts=(0,r.defineMessages)({customizePageLabel:{id:"action.customizePage.label",defaultMessage:"Customize page"},fontDefaultName:{id:"action.setPageFont.default.fuzzySearchKeywords",defaultMessage:"Font Default"},fontDefaultCaption:{id:"action.setPageFont.default.caption",defaultMessage:"Default"},fontDefaultTooltip:{id:"action.setPageFont.default.tooltip",defaultMessage:"The default sans-serif workhorse"},fontSerifName:{id:"action.setPageFont.serif.fuzzySearchKeywords",defaultMessage:"Font Serif"},fontSerifCaption:{id:"action.setPageFont.serif.caption",defaultMessage:"Serif"},fontSerifTooltip:{id:"action.setPageFont.serif.tooltip",defaultMessage:"Good for publishing"},fontMonoName:{id:"action.setPageFont.mono.fuzzySearchKeywords",defaultMessage:"Font Mono"},fontMonoCaption:{id:"action.setPageFont.mono.caption",defaultMessage:"Mono"},fontMonoTooltip:{id:"action.setPageFont.mono.tooltip",defaultMessage:"Good for drafting and notes"},fontSmallTextKeywords:{id:"action.fontSmallText.fuzzySearchKeywords",defaultMessage:"Font Small Text"},fontSmallTextLabel:{id:"action.fontSmallText.label",defaultMessage:"Small text"},fontStyleSection:{id:"action.section.fontStyle",defaultMessage:"Style"},fullWidthLabel:{id:"action.fullWidth.label",defaultMessage:"Full width"},lockPageName:{id:"action.lockPage.name",defaultMessage:"Lock page"},unlockPageName:{id:"action.unlockPageName.name",defaultMessage:"Unlock page"},openAIAssistant:{id:"action.openMobileAIAssistant.name",defaultMessage:"Open AI Assistant"},openinMacAppName:{id:"action.openinMacApp.name",defaultMessage:"Open in Mac app"},openinWindowsAppName:{id:"action.openinWindowsApp.name",defaultMessage:"Open in Windows app"},openiniOSAppName:{id:"action.openiniOSApp.name",defaultMessage:"Open in iOS app"},openinAndroidAppName:{id:"action.openinAndroidApp.name",defaultMessage:"Open in Android app"},pageUpdates:{id:"action.pageUpdates.title",defaultMessage:"Page updates"},pageHistoryName:{id:"action.pageHistory.name",defaultMessage:"Page history"},showDeletedPagesName:{id:"action.showDeletedPages.name",defaultMessage:"Show deleted pages"},importName:{id:"action.import.name",defaultMessage:"Import"},exportName:{id:"action.export.name",defaultMessage:"Export"},exportCaption:{id:"action.export.caption",defaultMessage:"PDF, HTML, Markdown"}});function ss(e){return(0,Gt.cN)({key:`font ${e.font||"default"}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:[Ye.or([Ye.ff(Ye.YG),Ye.f7]),Ye.J5],render:(t,s,i)=>{const n=s.blocks[0].getFormat().page_font,a=e.font===n||!e.font&&!n;return(0,W.jsx)(K,{...t,isActive:a,font:e.font,tooltip:e.tooltip,style:e.style,caption:e.caption})},closeParentMenu:!1,action:(t,s)=>{let{blocks:i,environment:n}=t;B.createAndCommit({userAction:"actionRegistry.createFontAction",environment:n,perform:t=>{I.FH({stores:i,update:{page_font:e.font},transaction:t}),j.G14(n,{type:e.font||"default"})}})}})}const is=ss({displayName:ts.fontDefaultName,caption:(0,W.jsx)(r.FormattedMessage,{...ts.fontDefaultCaption}),font:void 0,tooltip:(0,W.jsx)(r.FormattedMessage,{...ts.fontDefaultTooltip}),style:{fontSize:24,fontFamily:w.Z.getCompositeFontFamily(l.SP).sans,position:"relative",top:-2}}),ns=ss({displayName:ts.fontSerifName,caption:(0,W.jsx)(r.FormattedMessage,{...ts.fontSerifCaption}),font:"serif",tooltip:(0,W.jsx)(r.FormattedMessage,{...ts.fontSerifTooltip}),style:{fontSize:25,fontFamily:w.Z.getCompositeFontFamily(l.SP).serif}}),as=ss({displayName:ts.fontMonoName,caption:(0,W.jsx)(r.FormattedMessage,{...ts.fontMonoCaption}),font:"mono",tooltip:(0,W.jsx)(r.FormattedMessage,{...ts.fontMonoTooltip}),style:{fontSize:26,fontFamily:w.Z.getCompositeFontFamily(l.SP).mono,position:"relative",top:-3,letterSpacing:-1}}),os=(0,Gt.$J)({key:"font section",title:ts.fontStyleSection,render:e=>(0,W.jsx)(Y,{...e}),actions:[is,ns,as]}),rs=(0,Gt.wL)({key:"small text",displayName:ts.fontSmallTextKeywords,label:Qe.default.formatMessage(ts.fontSmallTextLabel),property:"page_small_text",validators:[Ye.ff(Ye.tq),Ye.or([Ye.ff(Ye.YG),Ye.f7]),Ye.J5],afterAction:(e,t)=>j.DRv(t,{type:e?"small":"large"})}),ls=(0,Gt.wL)({key:"full width",displayName:ts.fullWidthLabel,label:Qe.default.formatMessage(ts.fullWidthLabel),property:"page_full_width",validators:[Ye.ff(Ye.Mn),Ye.ff(Ye.YG),Ye.J5],afterAction:(e,t)=>j.LDb(t,{type:e?"full_width":"default_width"})}),ds=(0,Gt.$J)({key:"page style",render:e=>(0,W.jsx)(L.Z,{...e}),actions:[rs,ls]}),cs=(0,Gt.cN)({key:"customize page",displayName:ts.customizePageLabel,analyticsName:ts.customizePageLabel.defaultMessage,svg:m.F,validators:[Ye.U_,Ye.ff(Ye.YG)],closeParentMenu:!0,render:e=>(0,W.jsx)(R.Z,{...e,title:(0,W.jsx)(r.FormattedMessage,{...ts.customizePageLabel}),svg:m.F}),action:e=>{k.bA({originRect:e.originRect})}}),us=(0,Gt.cN)({key:"page lock",displayName:ts.lockPageName,analyticsName:ts.lockPageName.defaultMessage,svg:y.b,validators:[Ye.ff(Ye.YG),Ye.J5,Ye.ff(Ye.p1)],closeParentMenu:!1,action:(e,t)=>{let{blocks:s,environment:i}=e;const n=s[0];Z.bo({environment:i,store:n,lock:!0})}}),ms=(0,Gt.cN)({key:"page unlock",displayName:ts.unlockPageName,analyticsName:ts.unlockPageName.defaultMessage,svg:S.U,validators:[Ye.ff(Ye.YG),Ye.J5,Ye.p1],closeParentMenu:!1,action:(e,t)=>{let{blocks:s,environment:i}=e;const n=s[0];Z.bo({environment:i,store:n,lock:!1})}}),ps=(0,Gt.cs)({key:"copy link to block non-desktop",displayName:Gt.RE.copyLinkNavigableTypeName,analyticsName:Gt.RE.copyLinkNavigableTypeName.defaultMessage,svg:f.N,shortcuts:["copyCurrentPageLinkifiedBlockTitle"],validators:[Ye.jl,Ye.U7,Ye.ff(Ye.d)],closeParentMenu:!0,action:(e,t)=>{C.Hs({...e,event:t})}}),gs=(0,Gt.cs)({key:"duplicate",displayName:Gt.RE.duplicateName,analyticsName:Gt.RE.duplicateName.defaultMessage,svg:p.a,validators:[Ye.DF,Ye.J5,Ye.KE,Ye.xk,Ye.ff(Ye.P9(c.Ti.externalObjectInstancePage))],shortcuts:["duplicate"],closeParentMenu:!0,action:e=>{let{environment:t}=e;const s=Ft.np();if(!s)return;const i=s.getParentCollectionStore();i&&zt.M_(t)&&B.createAndCommit({userAction:"actionRegistry.duplicateToCollection",environment:t,perform:e=>{const[n,a]=_.Qi({environment:t,stores:[s],addCopyName:(0,Rt.Z)(s),transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!s.isInsideTemplate(),targetSpaceId:(0,M.C)(i.pointer.spaceId),baseUrl:st.default.domainBaseUrl,publicDomainName:st.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:!1}),o=n[0];F.zw({childStore:o,parentStore:i,transaction:e}),s.isTemplate()&&P.R3({parent:i.getTemplatePagesStore(),append:o,transaction:e}),A.navigateToBlock({environment:t,store:o,pageVisitSource:d.tY.Duplicate})}})}}),hs=(0,Gt.cN)({key:"open in mac app",displayName:ts.openinMacAppName,analyticsName:ts.openinMacAppName.defaultMessage,svg:v.h,validators:[Ye.U7,Ye.ff(Ye.tY),Ye.ff(Ye.tq),Ye.V5],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:i}=e;const n=(0,xe.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});A.openInNativeApp({url:(0,Bt.W)(n),environment:i})}}),fs=(0,Gt.cN)({key:"open in windows app",displayName:ts.openinWindowsAppName,analyticsName:ts.openinWindowsAppName.defaultMessage,svg:v.h,validators:[Ye.U7,Ye.ff(Ye.tY),Ye.ff(Ye.tq),Ye.ED],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:i}=e;const n=(0,xe.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});A.openInNativeApp({url:(0,Bt.W)(n),environment:i})}}),ys=(0,Gt.cN)({key:"open in ios app",displayName:ts.openiniOSAppName,analyticsName:ts.openiniOSAppName.defaultMessage,svg:v.h,validators:[Ye.U7,Ye.ff(Ye.tY),Ye.gn],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:i}=e;const n=(0,xe.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});A.openInNativeApp({url:n,environment:i})}}),vs=(0,Gt.cN)({key:"open in android app",displayName:ts.openinAndroidAppName,analyticsName:ts.openinAndroidAppName.defaultMessage,svg:v.h,validators:[Ye.U7,Ye.ff(Ye.tY),Ye.Dt],closeParentMenu:!0,action:(e,t)=>{let{blocks:s,environment:i}=e;const n=(0,xe.ZP)({store:s[0],fullyQualified:!1,pageVisitSource:d.tY.AppRedirect});A.openInNativeApp({url:n,environment:i})}}),xs=(0,Gt.cN)({key:"open page updates",analyticsName:"Open page updates",displayName:ts.pageUpdates,svg:u.t,validators:[Ye.RF,Ye.tq],closeParentMenu:!0,action:()=>{Ut.Z.setState({open:!0})}}),Ss=(0,Gt.cN)({key:"action page history",displayName:ts.pageHistoryName,analyticsName:ts.pageHistoryName.defaultMessage,svg:b.w,validators:[Ye.or([Ye._T,Ye.k5]),Ye.Gg,Ye.DF,Ye.jl],closeParentMenu:!0,action:e=>{let{environment:t,blocks:s}=e;return D.jN({environment:t,blockStore:s[0],from:"topbar"})},render:(e,t)=>{let{onClick:s,key:i,...n}=e,{environment:a}=t;return(0,W.jsx)(Zt.Z,{requireUpgradeToTier:!1,analyticsName:"history_modal",onClick:s,alwaysAllowClick:!0,render:(e,t)=>(0,W.jsx)(R.Z,{...(0,E.Z)(n,e),title:Qe.default.formatMessage(ts.pageHistoryName),svg:b.w,dontShrinkRight:!0,right:t}),renderUpgradeTooltip:()=>{}},i)}}),bs=(0,Gt.cN)({key:"open page trash",displayName:ts.showDeletedPagesName,analyticsName:ts.showDeletedPagesName.defaultMessage,svg:x.u,validators:[Ye.DF,Ye.J5,Ye.oY,Ye.jl,Ye.ff(Ye.nJ)],closeParentMenu:!0,action:()=>{Nt.Z.setState({open:!0}),Et.Z.setState({...Et.Z.state,currentTab:"in_current_page"})}}),Ms=(0,Gt.$J)({key:"pageHistory",render:e=>(0,W.jsx)(L.Z,{...e}),actions:[xs,es.Yw,Ss,Pt.pageAnalyticsMenu,bs,$t.Op]}),ws=(0,Gt.cN)({key:"open import modal",displayName:ts.importName,analyticsName:ts.importName.defaultMessage,svg:h.l,validators:[Ye.Gg,Ye.YZ,Ye.J5,Ye.ff(Ye.YG),Ye.ff(Ye.P9(c.Ti.externalObjectInstancePage))],closeParentMenu:!0,action:e=>{let{blocks:t}=e;(0,At.c)()?Wt.Z.setState({...Wt.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0}):Vt.Z.setState({open:!0,pageStore:t[0]})}}),js=(0,Gt.cN)({key:"export block",displayName:ts.exportName,analyticsName:ts.exportName.defaultMessage,validators:[Ye.Gg,Ye.jl,Ye.Kb],closeParentMenu:!0,render:e=>(0,W.jsx)(R.Z,{...e,svg:g.R,title:(0,W.jsx)(r.FormattedMessage,{...ts.exportName}),caption:(0,W.jsx)(r.FormattedMessage,{...ts.exportCaption})}),action:e=>{let{blocks:t,environment:s}=e;const i=t[0];if(!i.isDefined())return;let n=!0;const a=(0,Dt.fm)(t[0]);if(a){const e=null==a?void 0:a.collectionStore();null!=e&&e.isPageTreeCollection()&&(n=!1)}T.q$({environment:s,root:{id:i.id,table:"block",spaceId:i.getSpaceId()},isCollectionViewExportTypeSupported:n})}});var Cs=s(18514),ks=s(13713),_s=s(83182),Ts=s(939),Is=s.n(Ts),Ps=s(49427);class Zs extends H.Z{constructor(){super(...arguments),this.wordCount=0}willMount(){this.wordCount=this.getWordCount()}renderComponent(){return(0,W.jsx)(i.Fragment,{children:this.wordCount})}getWordCount(){const e=Ps.Z.find((e=>e.props.store===this.props.store));if(e){const t=e.getContentWrapEl();if(t)return Is()(t.innerText)}return 0}}Zs.displayName="PageWordCount";const Fs=Zs;function As(e){window.__c={n:"TopbarMoreMenu"};const{blockStore:t,onClickOriginRect:s,handleAccept:i,handleDismiss:l}=e,d=(0,n.O7)(),c=(0,n.Fy)(),m=(0,a.VK)((()=>({environment:d,blocks:[t],originRect:s,publicEditMode:void 0})),[d,t,s]),p=(0,a.VK)((()=>function(e){const{environment:t,context:s}=e,i=s.blocks[0],n=i.getFollowSettingsKey(),a=Ot.default.checkGate("property_updates_notifications"),o=(0,r.defineMessages)({getNotifiedFor:{defaultMessage:"Get notified",id:"topbar.moreButton.getNotified"}}),l=a?Lt.CA({followSettingsKey:n,environment:t,blockStore:i,from:"more_menu"}):Lt.Zk({followSettingsKey:n,environment:t,blockStore:i,from:"more_menu"});return[os,ds,qt.ww,(0,Gt.$J)({key:"topbar move or turn into actions",render:e=>(0,W.jsx)(L.Z,{...e}),actions:[Jt.bV,Yt.A]}),(0,Gt.$J)({key:"topbar database edit lock",render:e=>(0,W.jsx)(L.Z,{...e}),actions:[Kt.cO,Kt.YZ,Kt.Bj,Kt.BC,Kt.fK,Kt.MR,Jt.R$]}),(0,Gt.$J)({key:"topbar page edit lock",render:e=>(0,W.jsx)(L.Z,{...e}),actions:[cs,us,ms]}),(0,Gt.$J)({key:"topbar primary actions",render:e=>(0,W.jsx)(L.Z,{...e}),actions:[Kt.q6,$t.hS,(0,Gt.MV)({key:"get notified for",displayName:o.getNotifiedFor,analyticsName:o.getNotifiedFor.defaultMessage,svg:u.t,width:300,initialFocus:l.findIndex((e=>e.isSelectedOption))??0,validators:[],subActions:()=>[(0,Gt.$J)({key:"get notified for",render:e=>(0,W.jsx)(L.Z,{...e}),actions:l.map((e=>{let{action:t}=e;return t}))})]}),es.aU,ps,gs,Ht.gl,...(0,Ht.jW)()?[Ht.nh]:[],$t.DN,Qt.Jw,hs,fs,ys,vs,Xt.l,Kt.GZ]}),Ms,(0,Gt.$J)({key:"topbar import actions",render:e=>(0,W.jsx)(L.Z,{...e}),actions:[ws,js,Kt.mS]}),It(s)]}({environment:d,context:m})),[d,m]),g=(0,a.VK)((()=>!t.isCollectionView()&&t.canEdit()&&t.hasContent()),[t]),h=(0,a.VK)((()=>t.canEdit()),[t]),f=(0,a.VK)((()=>t.canEdit()&&t.isCollectionView()),[t]),y=(0,o.yK)((e=>({caption:{color:e.lightTextColor}})),[]),v=c.isMobile?{menuType:G.og.Modal,title:(0,W.jsx)(r.FormattedMessage,{defaultMessage:"Actions",id:"topbarMoreButton.mobileActionsMenu.title"}),right:(0,W.jsx)(Ze.DoneMenuText,{}),onClickRight:l}:{menuType:G.og.Popup,maxHeight:"80vh"};return(0,W.jsxs)(Pe.Z,{...v,children:[(0,W.jsx)(Ie.Z,{sections:p,onAccept:i,context:m}),(g||h)&&(0,W.jsxs)(L.Z,{topBorder:!0,children:[g&&(0,W.jsx)(me.Z,{caption:(0,W.jsx)("span",{style:y.caption,children:(0,W.jsx)(r.FormattedMessage,{id:"pageMoreButton.wordCount.caption",defaultMessage:"Word count: {count}",values:{count:(0,W.jsx)(Fs,{store:t})}})})}),h&&(0,W.jsx)(ks.Z,{store:t,isPageMoreButton:!0})]}),f&&(0,W.jsx)(Ds,{})]})}function Ds(){return(0,W.jsx)(L.Z,{topBorder:!0,children:(0,W.jsx)(_s.Z,{title:(0,W.jsx)(r.FormattedMessage,{defaultMessage:"Learn about databases",id:"topbar.moreButton.collectionHelpButton"}),href:(0,Cs.UY)("guides.database"),analyticsFrom:"topbar_more_button"})})}},64536:(e,t,s)=>{s.r(t),s.d(t,{PageAnalyticsPageOptOut:()=>T,TopbarPageAnalyticsOptOutMenu:()=>_,TopbarPageAnalyticsOptOutMenuStore:()=>k,pageAnalyticsMenu:()=>C});s(67294);var i=s(480),n=s(86628),a=s(49085),o=s(83176),r=s(18442),l=s(5366),d=s(62967),c=s(97627),u=s(19037),m=s(18514),p=s(74948),g=s(36391),h=s(80444),f=s(73420),y=s(53437),v=s(72495),x=s(42402),S=s(55422),b=s(60526),M=s(85893);const w=(0,l.defineMessages)({pageAnalyticsName:{id:"action.pageAnalytics.name",defaultMessage:"Page analytics"},viewAnalyticsName:{id:"action.viewAnalytics.name",defaultMessage:"View analytics"},privacySettingsName:{id:"action.privacySettings.name",defaultMessage:"Privacy settings"}}),j=e=>{const t=e.blocks[0];if(!t)return!1;return(0,b.W2)({canEditPage:t.canEdit(),device:e.environment.device})},C=(0,d.MV)({key:"page analytics menu",displayName:w.pageAnalyticsName,analyticsName:w.pageAnalyticsName.defaultMessage,validators:[u.DF],svg:o.z,subActions:e=>[{key:"view analytics",render:e=>(0,M.jsx)(v.Z,{...e}),actions:[(0,d.cN)({key:"view analytics",displayName:w.viewAnalyticsName,analyticsName:w.viewAnalyticsName.defaultMessage,svg:o.z,validators:[j],closeParentMenu:!0,action:()=>{p.handleSidebarButtonClick(e.environment,e.blocks[0],g.gY.Updates,"more_menu"),g.ZP.setState({...g.ZP.state,currentSubTab:g.uF.Analytics})}}),(0,d.cN)({key:"privacy settings",displayName:w.privacySettingsName,analyticsName:w.privacySettingsName.defaultMessage,svg:r.H,validators:[],closeParentMenu:!0,action:e=>{k.setState({isOpen:!0,rect:e.originRect})}})]}]}),k=a.default.createValue({isOpen:!1,rect:void 0}),_=()=>{window.__c={n:"TopbarPageAnalyticsOptOutMenu"};const e=(0,i.O7)(),t=(0,n.VK)((()=>k.state.isOpen),[]),s=(0,n.VK)((()=>k.state.rect),[]),a=(0,n.VK)((()=>h.default.state.mainEditorCurrentBlockStore),[]);return a?(0,M.jsx)(y.ZP,{popupType:e.device.isMobile?y.ZP.PopupType.SlideUp:y.ZP.PopupType.Popup,alignmentToOrigin:y.ZP.Alignment.Center,open:t,render:()=>(0,M.jsx)("div",{style:{minWidth:360,padding:16},children:(0,M.jsxs)(f.sg,{gap:16,children:[(0,M.jsx)("div",{style:{fontSize:16,fontWeight:500},children:(0,M.jsx)(l.FormattedMessage,{id:"TopbarPageAnalyticsOptOutMenu.heading",defaultMessage:"Privacy settings"})}),(0,M.jsx)(T,{store:a})]})}),originRect:s,onDismiss:()=>k.setState({isOpen:!1,rect:void 0})}):null};function T(e){window.__c={n:"PageAnalyticsPageOptOut"};const t=(0,i.O7)(),s=(0,n.VK)((()=>{const e=h.default.state.currentSpaceViewStore;return null==e?void 0:e.getSettings()}),[]),a=(0,n.VK)((()=>{const t=null==s?void 0:s.page_analytics_opt_out_list;return null==t?void 0:t.includes(e.store.id)}),[s,e.store.id]);return(0,M.jsx)(S.Z,{type:"dropdown",currentOption:a?"do_not_record":"record",options:[{key:"record",label:(0,M.jsx)(l.FormattedMessage,{id:"page_analytics.opt_out.record",defaultMessage:"Record"})},{key:"do_not_record",label:(0,M.jsx)(l.FormattedMessage,{id:"page_analytics.opt_out.do_not_record",defaultMessage:"Don't record"})}],onSelectOption:s=>{"do_not_record"===s?c.kY(t,e.store.id):c.pu(t,e.store.id)},isMobile:t.device.isMobile,title:(0,M.jsx)(l.FormattedMessage,{id:"page_analytics.opt_out.title",defaultMessage:"My view history"}),caption:(0,M.jsx)(l.FormattedMessage,{id:"page_analytics.opt_out.caption",defaultMessage:"Page editors can see my view history for this page. <inlinelink>Learn more</inlinelink>.",values:{inlinelink:e=>(0,M.jsx)(x.Z,{external:!0,href:(0,m.UY)("guides.pageAnalytics"),children:e})}}),captionStyle:{maxWidth:270}})}},70268:(e,t,s)=>{s.d(t,{B:()=>o});s(67294);var i=s(24405),n=s(36596),a=s(85893);function o(e){window.__c={n:"UpdateSidebarLoadingSkeleton"};let t=Math.floor(e.areaHeight/124);0===t&&(t=1);const s=(0,i.yK)((e=>({skeletonRect:{height:8,borderRadius:3,margin:10,backgroundColor:e.lightDividerColor},skeletonCircle:{display:"flex",width:28,height:28,marginRight:8,backgroundColor:e.lightDividerColor,borderRadius:20},skeletonSection:{display:"flex",width:"100%",margin:20,flexDirection:"row"}})),[8,10,20]),o=[...Array(t)].map(((e,t)=>(0,a.jsxs)("div",{style:s.skeletonSection,children:[(0,a.jsx)(n.Z,{style:s.skeletonCircle}),(0,a.jsxs)("div",{style:{width:"80%"},children:[(0,a.jsx)(n.Z,{style:{width:"80%",...s.skeletonRect,marginTop:0}}),(0,a.jsx)(n.Z,{style:{width:"50%",...s.skeletonRect}}),(0,a.jsx)(n.Z,{style:{width:"60%",...s.skeletonRect}}),(0,a.jsx)(n.Z,{style:{width:"50%",...s.skeletonRect}})]})]},t)));return(0,a.jsx)("div",{children:o})}},457:(e,t,s)=>{s.d(t,{Z:()=>c});s(67294);var i=s(13991),n=s(24405),a=s(8848),o=s(1799),r=s(97880),l=s(82990),d=s(85893);function c(e){window.__c={n:"MFABackupCodes"};const{type:t}=e,s=(0,n.yK)((e=>({pane:{display:"flex",whiteSpace:"pre-line",flexDirection:"column",alignItems:"center",justifyContent:"center",borderRadius:4,backgroundColor:a.FN.light.yellow[50],paddingTop:8,paddingBottom:8,marginBottom:10},textCode:{fontFamily:l.Z.getHeaderFontFamily({pageFont:"mono",locale:i.SP}),fontWeight:l.Z.fontWeight.regular,fontSize:l.Z.fontSize.UIRegular.desktop,font:l.Z.baseFontFamily.emailMono,color:a.FN.light.brown[500],textAlign:"center"},redactedBackupCode:{textDecoration:"line-through",opacity:.2}})),[]);return(0,d.jsx)("div",{style:s.pane,children:(0,d.jsx)("div",{style:s.textCode,children:"status"===t?e.status.map(((e,t)=>(0,d.jsx)("div",{style:e.hasBeenUsed?s.redactedBackupCode:{},children:o.A},t))):"unencryptedCodes"===t?e.backupCodes.map(o.K).join("\n"):(0,r.t1)(t)})})}},56839:(e,t,s)=>{s.d(t,{R$:()=>g,ZP:()=>h});var i=s(67294),n=s(24405),a=s(72126),o=s(82990),r=s(5366),l=s(18514),d=s(68785),c=s(88175),u=s(73602),m=s(11898),p=s(85893);const g=6;function h(e){let{isLoading:t,phoneNumber:s,errorMessage:o,resentStatus:h,resentAt:y,onDismiss:v,onBack:x,onVerifyCode:S,onResendLink:b}=e;window.__c={n:"MFAPromptSMSVerification"};const M=(0,n.yK)(f,[]),[w,j]=(0,i.useState)([]),C=(0,p.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeTitle",defaultMessage:"Verify phone number"}),k=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeHeader.default",defaultMessage:"Enter the code sent to {phoneNumber} to complete setup.",values:{phoneNumber:s}})," ",(0,p.jsx)(u.y,{resentAt:y,resentStatus:h,onResendLink:b})]}),_={text:t?(0,p.jsx)(d.Z,{}):(0,p.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeButton",defaultMessage:"Verify code"}),onClick:()=>S(w.join("")),disabled:t||"resending"===h||(0,a.oA)(w).length!==g},T=[{text:(0,p.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.sms.verifyCodeNeedHelp",defaultMessage:"Need help?"}),href:(0,l.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}];return(0,p.jsx)(c.Z,{title:C,header:k,errorMessage:o,primaryAction:_,secondaryActions:T,onDismiss:v,onBack:x,disableBackButton:t,children:(0,p.jsx)("div",{style:M.body,children:(0,p.jsx)(m.ZP,{numInputs:g,format:"settings",disabled:!1,value:w,onChange:j,autoFocus:!0,isValidKey:m.rN})})})}function f(e){return(0,n.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",marginTop:16,marginBottom:4},textCode:{fontWeight:o.Z.fontWeight.medium,fontSize:o.Z.fontSize.UIRegular.desktop,lineHeight:1.2,color:e.darkTextColor,marginTop:32,marginBottom:32,textAlign:"center"}})}},18469:(e,t,s)=>{s.d(t,{R$:()=>p,ZP:()=>g});var i=s(67294),n=s(24405),a=s(72126),o=s(82990),r=s(5366),l=s(18514),d=s(68785),c=s(88175),u=s(11898),m=s(85893);const p=6;function g(e){let{isLoading:t,errorMessage:s,onDismiss:o,onBack:g,onVerifyCode:f}=e;window.__c={n:"MFAPromptTOTPVerification"};const y=(0,n.yK)(h,[]),[v,x]=(0,i.useState)([]),S=(0,m.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeTitle",defaultMessage:"Verify code"}),b=(0,m.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeHeader",defaultMessage:"Enter the one-time code from authenticator to complete setup."}),M={text:t?(0,m.jsx)(d.Z,{}):(0,m.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.totp.verifyCodeButton",defaultMessage:"Verify code"}),onClick:()=>f(v.join("")),disabled:t||(0,a.oA)(v).length!==p},w=[{text:(0,m.jsx)(r.FormattedMessage,{id:"profileSettings.mfa.totp.needHelp",defaultMessage:"Need help?"}),href:(0,l.UY)("guides.mfa"),isExternal:!0,type:"link",view:"plain"}];return(0,m.jsx)(c.Z,{title:S,header:b,errorMessage:s,primaryAction:M,secondaryActions:w,onDismiss:o,onBack:g,disableBackButton:t,children:(0,m.jsx)("div",{style:y.body,children:(0,m.jsx)(u.ZP,{numInputs:p,format:"settings",disabled:t,value:v,onChange:e=>{x(e)},autoFocus:!0,isValidKey:u.rN})})})}function h(e){return(0,n.EM)({body:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",marginTop:16,marginBottom:4},textCode:{fontWeight:o.Z.fontWeight.medium,fontSize:o.Z.fontSize.UIRegular.desktop,lineHeight:1.2,color:e.darkTextColor,marginTop:32,marginBottom:32,textAlign:"center"}})}},32357:(e,t,s)=>{s.d(t,{Z:()=>I});s(67294);var i=s(83355),n=s(49085),a=s(79362),o=s(89036),r=s(40462),l=s(54855),d=s(5366),c=s(97880),u=s(50906),m=s(43250),p=s(79817),g=s(38755),h=s(95697),f=s(24646),y=s(85834),v=s(35057),x=s(73466),S=s(42922),b=s(64921),M=s(60458),w=s(63296),j=s(31278),C=s(64369),k=s(22193),_=s(85893);class T extends i.Z{constructor(){super(...arguments),this.storeTypes={contextualInviteStore:y.ZP,isSpaceCardSelected:n.default.createClass(!1)},this.containerStyle={padding:12,display:"flex",flexDirection:"column",gap:16},this.iconStyle={width:20,height:20,fill:this.theme.lightIconColor}}didMount(){u.$24(this.environment,p.Oh(this.environment,this.stores.contextualInviteStore)),(0,h.$)(this.environment)&&this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:y.uq.page_guest})}renderComponent(){var e;const{contextualInviteStore:t}=this.stores,s=(null===(e=t.state)||void 0===e?void 0:e.shareModalGuestMemberConfirmationExpGroup)||"control",i=t.getGuestEmails();if(!i.length)return null;const n=(0,h.$)(this.environment);return(0,_.jsx)(_.Fragment,{children:(0,_.jsx)("div",{className:m.B8p,style:{...this.containerStyle,paddingTop:16,paddingBottom:16,paddingLeft:18,paddingRight:18},children:(0,_.jsxs)("div",{children:[(0,_.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:(0,_.jsxs)("div",{children:[t.state.inviteStage===y.TG.share_workspace?this.renderShareWorkspace({useZeroTeamsExperience:n,shareModalGuestMemberConfirmationExpGroup:s,guestEmails:i}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(C.Z,{style:{fontWeight:600,marginBottom:4},children:(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.requestToWorkspace.title",defaultMessage:"Request to add to workspace"})}),(0,_.jsx)(C.Z,{isMultiline:!0,isSmall:!0,children:(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.requestToWorkspace.subtitle",defaultMessage:"Do you want to send a request to your workspace admin to add {emailCount, plural, one {this person} other {these people}} to the workspace?",values:{emailCount:i.length}})})]}),(0,_.jsx)("div",{style:{display:"flex",flexWrap:"wrap",marginTop:16,marginBottom:16},children:this.renderEmailTokensSubtitle(i,s)})]})}),"control"===s?this.renderSpaceCard({showSpaceCardToggle:n}):this.renderGuestMemberCards({shareModalGuestMemberConfirmationExpGroup:s}),(0,_.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:18},children:[(0,_.jsx)(w.Z,{isLarge:!0,style:{marginRight:10},onClick:async()=>{var e,i;"control"===s?this.selectPageGuestOption():(t.setState({...t.state,selection:y.uq.closed}),null===(e=(i=t.state).resetShareMenuFn)||void 0===e||e.call(i));await this.handleInviteClick()},children:"control"===s?(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.skip.button",defaultMessage:"Skip for now"}):(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.cancel.button",defaultMessage:"Cancel"})}),(0,_.jsx)(S.Z,{isLarge:!0,disabled:n&&!this.stores.isSpaceCardSelected.state||!n&&this.stores.contextualInviteStore.state.selection===y.uq.closed,onClick:async()=>{"control"===s&&(t.state.inviteStage===y.TG.share_workspace&&this.selectWorkspaceMemberOption(),t.state.inviteStage===y.TG.request_workspace&&this.selectRequestWorkspaceMemberOption()),await this.handleInviteClick()},children:t.state.inviteStage===y.TG.share_workspace?"control"===s?(0,_.jsx)(d.FormattedMessage,{id:"ContextualInvite.addToWorkspace.button",defaultMessage:"Add to workspace"}):(0,_.jsx)(d.FormattedMessage,{id:"ContextualInvite.addToWorkspace.button.variant",defaultMessage:"Invite"}):(0,_.jsx)(d.FormattedMessage,{id:"ContextualInvite.sendRequest.button",defaultMessage:"Send request"})})]})]})})})}renderGuestMemberCards(e){let{shareModalGuestMemberConfirmationExpGroup:t}=e;return"v1"!==t&&"v2"!==t?null:(0,_.jsxs)("div",{style:{display:"flex",gap:8,flexDirection:"column"},children:[(0,_.jsx)("div",{children:this.renderGuestMemberSelectionCard({title:"v1"===t?(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.guest.title.v1",defaultMessage:"Guest"}):(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.guest.title.v2",defaultMessage:"Invite to Page"}),subtitle:(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.guest.subtitle",defaultMessage:"Can access only this page"}),icon:(0,l.a)({fill:a.Lr[this.theme.mode].yellow,width:22,height:24}),selected:this.stores.contextualInviteStore.state.selection===y.uq.page_guest,onClick:()=>{this.selectPageGuestOption()}})}),(0,_.jsx)("div",{children:this.renderGuestMemberSelectionCard({title:"v1"===t?(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.member.title.v1",defaultMessage:"Member"}):(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.member.title.v2",defaultMessage:"Invite to Workspace"}),subtitle:(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.member.subtitle",defaultMessage:"Can access all pages in {spaceName}. This person will be billed as a member.",values:{spaceName:this.getSpaceName()}}),icon:(0,r.o)({fill:a.Lr[this.theme.mode].green,width:22,height:24}),selected:this.stores.contextualInviteStore.state.selection===y.uq.workspace_member,onClick:()=>{this.selectWorkspaceMemberOption()}})})]})}renderGuestMemberSelectionCard(e){let{title:t,subtitle:s,icon:i,selected:n,onClick:a}=e;return(0,_.jsxs)(b.Z,{style:{display:"flex",borderWidth:1,borderStyle:"solid",borderColor:this.theme.regularDividerColor,borderRadius:8,padding:12,justifyContent:"space-between",alignItems:"center"},onClick:a,children:[(0,_.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,_.jsx)("div",{style:{paddingRight:12},children:i}),(0,_.jsxs)("div",{children:[(0,_.jsx)(C.Z,{children:t}),(0,_.jsx)(C.Z,{isSmall:!0,style:{width:350,whiteSpace:"pre-wrap"},children:s})]})]}),(0,_.jsx)(M.Z,{round:!0,checked:n,fill:this.theme.contentBackground,size:20,onClick:a})]})}renderShareWorkspace(e){let{useZeroTeamsExperience:t,shareModalGuestMemberConfirmationExpGroup:s,guestEmails:i}=e;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(C.Z,{style:{fontWeight:600,marginBottom:4},children:["control"===s?(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.title",defaultMessage:"Add to workspace"}):void 0,"v1"===s?(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.title.v1",defaultMessage:"Invite as guest or member?"}):void 0,"v2"===s?(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.title.v2",defaultMessage:"Invite to page or workspace?"}):void 0]}),"control"===s?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(C.Z,{isMultiline:!0,isSmall:!0,style:{marginBottom:6},children:(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.subtitle",defaultMessage:"Do you want to add {emailCount, plural,\n\t\t\t\t\t\t\t\t\tone {this person}\n\t\t\t\t\t\t\t\t\tother {these people}\n\t\t\t\t\t\t\t\t} to the workspace in addition to the page? {isPaid, select,\n\t\t\t\t\t\t\t\t\ttrue {This is a billable event.}\n\t\t\t\t\t\t\t\t\tother {}\n\t\t\t\t\t\t\t\t}",values:{emailCount:i.length,isPaid:!(0,v.QM)()}})}),(0,_.jsx)(C.Z,{isMultiline:!0,isSmall:!0,children:t?(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle.blockLimit",defaultMessage:"Adding them as a member will auto-create a teamspace{isFreeTier, select,\n\t\t\t\t\t\t\t\t\tfree { and apply the 1,000 block limit to your workspace.}\n\t\t\t\t\t\t\t\t\tother {}\n\t\t\t\t\t\t\t\t}",values:{isFreeTier:(0,v.QM)()?"free":"paid"}}):(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.addToWorkspace.zeroTeams.subtitle",defaultMessage:"{isFreeTier, select,\n\t\t\t\t\t\t\t\t\tfree {This action will apply the 1,000 block limit to your workspace.}\n\t\t\t\t\t\t\t\t\tother {}\n\t\t\t\t\t\t\t\t}",values:{emailCount:i.length,isFreeTier:(0,v.QM)()?"free":"paid"}})})]}):void 0]})}renderEmailTokensSubtitle(e,t){const{spaceStore:s}=this.props;return e.map((e=>(0,_.jsx)(k.Z,{store:s,tokenType:"control"!==t?"member":"guest",showRemoveButton:!1,target:{source:"email",type:"newUser",value:{email:e},spaceRole:"not_in_space"}},e)))}renderSpaceCard(e){let{showSpaceCardToggle:t}=e;const{spaceStore:s}=this.props,i=(0,g.Wd)(this.environment,s),n=this.getSpaceName(),a=s.getPublicSpaceData();let r;a&&"none"!==a.role&&(r=(0,_.jsx)(d.FormattedMessage,{id:"contextualInvite.spaceCard.subtitle",defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}} · {planType}",values:{numberOfWorkspaceMembers:this.props.intl.formatNumber(a.memberCount),planType:this.props.intl.formatMessage((0,f.em)(a.subscriptionTier))}}));const l=i||n?(0,_.jsx)(j.Z,{disabled:!0,icon:i,isEmptyPage:!1,title:n,size:30,style:{color:this.theme.regularTextColor,marginRight:12}}):(0,o.v)(this.iconStyle);return(0,_.jsxs)(b.Z,{style:{display:"flex",borderWidth:1,borderStyle:"solid",borderColor:this.theme.regularDividerColor,borderRadius:5,padding:12,justifyContent:"space-between",alignItems:"center"},disabled:!t,onClick:()=>this.stores.isSpaceCardSelected.setState(!this.stores.isSpaceCardSelected.state),children:[(0,_.jsxs)("div",{style:{display:"flex"},children:[l,(0,_.jsxs)("div",{children:[(0,_.jsx)(C.Z,{children:n}),(0,_.jsx)(C.Z,{isSmall:!0,children:r})]})]}),t&&(0,_.jsx)(M.Z,{round:!0,checked:this.stores.isSpaceCardSelected.state,fill:this.theme.contentBackground,size:20,onClick:()=>this.stores.isSpaceCardSelected.setState(!this.stores.isSpaceCardSelected.state)})]})}getSpaceName(){const{spaceStore:e}=this.props;return(0,g.rn)(this.environment,e)}selectWorkspaceMemberOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:y.uq.workspace_member})}selectRequestWorkspaceMemberOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:y.uq.request_workspace_member})}selectPageGuestOption(){this.stores.contextualInviteStore.setState({...this.stores.contextualInviteStore.state,selection:y.uq.page_guest})}async handleInviteClick(){const{contextualInviteStore:e}=this.stores,{spaceStore:t,blockStore:s,intl:i}=this.props,{shareModalGuestMemberConfirmationExpGroup:n,callbackAsyncFn:a}=e.state;if(e.state.inviteStage===y.TG.closed||e.state.inviteStage===y.TG.share_page)return;const{selection:o}=e.state;switch(o){case y.uq.request_workspace_member:u.cir(this.environment,{...p.Oh(this.environment,e),from:"share_menu"}),await p.fC({environment:this.environment,spaceStore:t,originId:s.id,originType:"share_menu",reasonMessage:void 0,contextualInviteStore:e,intl:i});break;case y.uq.workspace_member:if(u.E0y(this.environment,p.Oh(this.environment,e)),(0,h.$)(this.environment)){e.setState({...e.state,inviteStage:y.TG.closed});if(!(await x.HD({environment:this.environment,flowId:e.state.flowId??"",trackCreateTeamComplete:!1})))return}"control"!==n&&await(null==a?void 0:a()),await p.j_({environment:this.environment,spaceStore:t,contextualInviteStore:e,from:"page_contextual_invite",intl:i});break;case y.uq.page_guest:"control"!==n&&await(null==a?void 0:a()),e.reset();break;case y.uq.closed:e.reset();break;default:(0,c.t1)(o)}}}T.displayName="ContextualInvite";const I=(0,d.injectIntl)(T)},22193:(e,t,s)=>{s.d(t,{Z:()=>P});s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(8848),r=s(84619),l=s(33728),d=s(3338),c=s(40462),u=s(84169),m=s(26774),p=s(97880),g=s(82990),h=s(7928),f=s(5366),y=s(45101),v=s(16639),x=s(53353),S=s(26781),b=s(4023),M=s(80444),w=s(55899),j=s(78291),C=s(13627),k=s(26388),_=s(45653),T=s(85567),I=s(85893);const P=function(e){window.__c={n:"InviteTargetToken"};const{store:t,target:s}=e,P=(0,i.Fy)(),Z=(0,f.useIntl)(),F=(0,a.yK)((()=>({verifiedDomain:{margin:2,backgroundColor:"rgba(83, 168, 63, 0.1)"},disabled:{margin:2,backgroundColor:"rgba(211, 79, 67, 0.1)",border:"dashed #D9655B 1px",paddingLeft:5},normal:{margin:2},guest:{margin:2,backgroundColor:"rgba(218, 163, 64, 0.2)"},tokenContent:{display:"flex",alignItems:"center",maxWidth:"100%"},tokenSpan:{maxWidth:"100%",marginRight:4},tokenText:{marginLeft:4,...g.Z.textOverflowStyle}})),[]),A=(0,n.VK)((()=>{const{data:e}=j.default.state,t=e?C.CM(e):[],s={};return t.forEach((e=>{s[e.userId]=e})),s}),[]),D=(0,n.VK)((()=>{const e=M.default.state.currentSpaceStore;return new Set(null==e?void 0:e.getEmailDomains())}),[]),B=(0,x.Z)(t),R=(0,S.i)(t),L=(0,n.VK)((()=>{if(e.tokenType)return e.tokenType;if("group"===s.type)return"group";if("existingUser"===s.type&&!Boolean(s.spaceRole)){const e=A[s.value.id];s.spaceRole=e?e.role:"not_in_space"}if(!(0,y.OA)(s))return"member";const t=(0,l.Gd)(s.value.email);return t&&D.has(t)?"verifiedDomain":B.isStoreInTeam&&!B.teamAllowsGuests?"teamGuestDisabled":!B.isStoreInTeam&&!B.spaceAllowsGuests||B.isStoreInTeam&&!B.teamAllowsGuests&&!B.spaceAllowsGuests?"spaceGuestDisabled":"guest"}),[e.tokenType,s,A,D,B]),N=(0,n.VK)((()=>{switch(L){case"member":case"group":return F.normal;case"guest":return F.guest;case"verifiedDomain":return F.verifiedDomain;case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return F.disabled;default:(0,p.t1)(L)}}),[L,F]);function E(){const e=(0,u.m)({height:16,width:16,color:"#D34F43"});switch(L){case"member":return(0,w.fZ)(s)?(0,I.jsx)(_.Z,{userValue:s.value,size:16}):(0,w.KU)(s)?(0,I.jsx)(_.Z,{size:16,avatar:s.value}):(0,I.jsx)(_.Z,{size:16});case"guest":return(0,c.o)({height:16,width:16,color:"#DAA340"});case"verifiedDomain":return(0,d.p)({height:16,width:16,color:"#53A83F"});case"group":return(0,I.jsx)("div",{style:{height:16,width:16,backgroundColor:o.ZP.whiteWithAlpha(.8),borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,m.O)({height:12,width:12,color:o.ZP.mediumTextColor})});case"spaceGuestDisabled":case"teamGuestDisabled":case"teamGroupOwner":return e;default:(0,p.t1)(L)}}function O(t){const i=E();let n=function(){switch(s.type){case"newUser":return s.value.email.trim();case"existingUser":return(0,h.Nz)(Z,s.value);case"group":return(0,v.kF)({intl:Z,group:s.value});default:(0,p.t1)(s)}}(),a=F.tokenText;return e.onlyShowTokenType&&(["guest","teamGuestDisabled","spaceGuestDisabled"].includes(t)?(n="Guest",a={...a,color:"#DAA340"}):(n="Member",a={...a,color:"#53A83F"})),(0,I.jsxs)("div",{style:F.tokenContent,children:[i,(0,I.jsx)("div",{style:a,children:n})]})}function V(t){var s;t.stopPropagation(),null===(s=e.onClickRemove)||void 0===s||s.call(e)}const U="newUser"===s.type?s.value.email:s.value.id,W="group"!==s.type?s.value.email:void 0;return(0,I.jsx)(k.Z,{placement:b.u.Top,renderTooltip:()=>function(e){const{tokenType:t,target:s,email:i}=e;return"guest"===t?(0,I.jsx)(f.FormattedMessage,{defaultMessage:"{email} will be invited as a guest",id:"inviteTargetToken.guest.tooltip",values:{email:i}}):"spaceGuestDisabled"===t||"teamGuestDisabled"===t?R:"teamGroupOwner"===t&&"group"===s.type?(0,I.jsx)(f.FormattedMessage,{defaultMessage:"Groups cannot be added as team owners.",id:"inviteTargetToken.groupTeamOwner.tooltip"}):"verifiedDomain"===t&&"group"!==s.type?(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(f.FormattedMessage,{defaultMessage:"{email}{br}will automatically be added to the workspace{br}since @{domain} is a verified domain.",id:"inviteTargetToken.verifiedDomain.tooltip",values:{email:s.value.email,br:(0,I.jsx)("br",{}),domain:(0,l.Gd)(s.value.email)}})}):"group"===s.type?s.value.name:i}({tokenType:L,email:W,target:s}),render:t=>(0,I.jsx)("div",{style:F.tokenSpan,...t,children:(0,I.jsx)(T.Z,{isSingle:!1,format:P.isMobile?r.l.Large:r.l.Medium,showRemoveButton:e.showRemoveButton,onClickRemove:V,disabledFeedback:!0,value:O(L),style:N,shouldWrap:!1})})},U)}},76472:(e,t,s)=>{s.d(t,{Z:()=>R});s(67294);var i=s(83355),n=s(15145),a=s(8848),o=s(72126),r=s(27006),l=s(21202),d=s(29369),c=s(97880),u=s(82990),m=s(5366),p=s(47307),g=s(84210),h=s(95697),f=s(31075),y=s(55838),v=s(61766),x=s(90106),S=s(78291),b=s(13627),M=s(35817),w=s(64921),j=s(84076),C=s(31278),k=s(76798),_=s(26388),T=s(64369),I=s(7567),P=s(86628),Z=s(24405),F=s(85893);function A(e){window.__c={n:"NameAndIconWrap"};const{store:t}=e,s=(0,P.VK)((()=>t.getIcon()),[t]),i=(0,Z.yK)((()=>({container:{whiteSpace:"nowrap",fontWeight:u.Z.fontWeight.bold},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]);return(0,F.jsxs)("span",{style:i.container,children:[s&&(0,F.jsx)(C.Z,{disabled:!0,icon:s,isEmptyPage:!1,size:12,style:i.recordIcon}),(0,F.jsx)(k.Z,{store:t,style:i.recordTitle})]})}const D=function(e){const{store:t}=e;return(0,F.jsx)(m.FormattedMessage,{defaultMessage:"This access is based on {inlineIconAndName}. Changing this access will restrict permissions of this page.",id:"blockPermissionsSettings.restrictedPermissions.tooltip",values:{inlineIconAndName:(0,F.jsx)(A,{store:t})}})};class B extends i.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:v.Z},this.permissionItemStore=void 0,this.handleRoleSelect=async e=>{if(this.isDisplayOnlyPermissionItem(this.props.permissionItem))return;const t=this.props.permissionItem,s=o.d9(t);s.role=e;const i=this.props.currentBlockStore.isTopLevel();if(i&&r.ix(s)){const{data:e}=S.default.state,n=e?b.su(e):1;if(!(0,h.bq)()&&r.YX(t.role)&&!r.YX(s.role)&&n>1){if(!(await p.confirmUserAction({message:(0,F.jsx)("span",{children:(0,F.jsx)(m.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <semibold>Only you will be able to access it.</semibold>",values:{semibold:e=>(0,F.jsx)("span",{style:{fontWeight:u.Z.fontWeight.semibold},children:e})},id:"blockPermissionsSettings.confirmationDialog.private.message"})}),acceptLabel:(0,F.jsx)(m.FormattedMessage,{defaultMessage:"Move to Private",id:"blockPermissionsSettings.confirmationDialog.privateButton.label"})})))return}else if(!(0,h.bq)()&&i&&!r.YX(t.role)&&r.YX(s.role)){if(!(await p.confirmUserAction({message:(0,F.jsx)("span",{children:(0,F.jsx)(m.FormattedMessage,{defaultMessage:"Are you sure you want to share this page with the workspace? <semibold>It will be accessible by all {memberCount} members.</semibold>",id:"blockPermissionsSettings.confirmationDialog.workspace.message",values:{semibold:e=>(0,F.jsx)("span",{style:{fontWeight:u.Z.fontWeight.semibold},children:e}),memberCount:n}})}),acceptLabel:(0,F.jsx)(m.FormattedMessage,{defaultMessage:"Move to workspace",id:"blockPermissionsSettings.confirmationDialog.workspaceButton.label"})})))return}}await(0,f.i)({oldPermissionItem:t,newPermissionItem:s,wasInherited:this.isInherited(),environment:this.environment,store:this.props.currentBlockStore,sudoModeStore:this.props.sudoModeStore,location:this.props.location,fromPermissionWrapper:this.props.fromPermissionWrapper})},this.handleUserItemClick=()=>{this.stores.buttonPopupStore.setState({...this.stores.buttonPopupStore.state,open:!0})},this.getPermissionItemStore=()=>{const{from:e,currentBlockStore:t}=this.props,s=e.table;return s===l.iU?x.G.createChildStore(t,{table:l.iU,id:e.blockId}):s===d.e0?x.zX.createChildStore(t,{table:d.e0,id:e.teamId}):void(0,c.t1)(s)}}willMountOrUpdate(){this.permissionItemStore=this.getPermissionItemStore()}renderComponent(){const{device:e}=this.environment,t=this.props.onClick?this.props.onClick:this.handleUserItemClick,s=this.isDisabled(),i=this.renderTooltip();return(0,F.jsx)(_.Z,{delayThreshold:0,renderTooltip:()=>i,textWrap:!0,disableTooltip:!Boolean(i),style:{maxWidth:240},render:i=>(0,F.jsx)(w.Z,{disabled:s,mobileFeedback:e.isMobile,ignoreLocalHoverState:this.props.ignoreLocalHoverState,style:{...s?{cursor:"not-allowed"}:{}},onClick:t,...i,children:this.renderMenuItem()}),placement:_.Z.Placement.Left})}renderMenuItem(){const{device:e}=this.environment,{showInherited:t,permissionItem:s}=this.props,i=this.isUserItem(),n=this.isInherited();return(0,F.jsxs)("div",{className:"notranslate",style:this.getMenuItemStyle(),children:[(0,F.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:32,marginRight:e.isMobile?12:10,...this.props.iconStyle},children:this.props.icon}),(0,F.jsxs)("div",{style:{marginRight:"auto",minWidth:0},children:[(0,F.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,F.jsx)(T.Z,{style:{...!i&&{fontWeight:400}},children:this.props.title}),this.props.tag&&(0,F.jsx)("div",{style:{marginLeft:4},children:this.props.tag})]}),this.props.subtitle&&(0,F.jsx)(T.Z,{isSmall:!0,children:this.props.subtitle}),t&&n&&this.renderInheritedRecordTitle()]}),(0,F.jsx)("div",{style:{display:"flex",alignItems:"center",flexShrink:0,marginLeft:8},children:this.props.permissionRoleSelect?this.props.permissionRoleSelect:!this.isDisplayOnlyPermissionItem(s)&&(0,F.jsx)(I.ZP,{role:this.role,table:l.iU,blockType:this.props.currentBlockStore.getType(),type:s.type,disabled:this.isDisabled(),isUserPermission:this.permissionItemIsUserItem(s),onChange:this.handleRoleSelect,onUpgradeButtonClick:this.props.onUpgradeButtonClick,upgradeButtonName:this.props.upgradeButtonName,buttonPopupStore:this.stores.buttonPopupStore,buttonStyle:{marginRight:-8,color:this.theme.mediumTextColor,fontSize:e.isMobile?14:12},showPermissionOverrideWarning:n,isRemovableOverride:this.props.isRemovableOverride})})]})}renderTooltip(){return this.isInherited()?!this.isTeamOuterItem()&&this.permissionItemStore?(0,F.jsx)(D,{store:this.permissionItemStore}):null:this.props.nonInheritedTooltip}renderInheritedRecordTitle(){const e=this.permissionItemStore||this.getPermissionItemStore(),t=e.table===l.iU?(0,g.ZP)({store:e,fullyQualified:!1,pageVisitSource:n.tY.LinkInPage}):void 0,s=e.table===d.e0?()=>{e.table===d.e0&&M.RF({environment:this.environment,teamId:e.id,tab:y.a.Members,from:"permission_item"})}:void 0,{device:i}=this.environment,o=e.getIcon(),r="team"!==e.table&&e.isEmptyPage();return(0,F.jsx)(T.Z,{isSmall:!0,style:{lineHeight:1.4},children:i.isMobile?(0,F.jsx)(m.FormattedMessage,{defaultMessage:"Based on {linkBoxWithPageTitle}",id:"pagePermissionItem.inheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:(0,F.jsx)(j.Z,{disabled:i.isMobile,underline:!i.isMobile,inline:!0,href:t,onClick:s,children:(0,F.jsx)(k.Z,{store:e,style:{display:"inline"}})})}}):(0,F.jsx)(m.FormattedMessage,{defaultMessage:"From {linkBoxWithPageTitle}",id:"pagePermissionItem.fromInheritedRecordPermissions.setting",values:{linkBoxWithPageTitle:(0,F.jsxs)(j.Z,{disabled:i.isMobile,underline:!1,inline:!0,href:t,onClick:s,innerStyle:{display:"inline-flex",alignItems:"center",borderBottom:`0.5px solid ${a.ZP.mediumTextColor}`},children:[(0,F.jsx)(C.Z,{disabled:!0,style:{marginRight:4},icon:o,size:14,isEmptyPage:r}),(0,F.jsx)(k.Z,{store:e,style:{display:"inline",fontWeight:u.Z.fontWeight.semibold}})]})}})})}permissionItemIsUserItem(e){const t=this.environment.currentUser.id;return"user_permission"===e.type&&e.user_id===t}isUserItem(){return"user_permission"===this.props.permissionItem.type}isTeamOuterItem(){return"team_overview_permission"===this.props.permissionItem.type}get role(){const{permissionItem:e,currentBlockStore:t}=this.props;if(this.isDisplayOnlyPermissionItem(e))return"none";if("content_only_editor"===e.role&&this.isInherited()){var s,i;const n=t.getParentCollectionStore(),a=null==n?void 0:n.getParentBlockStore();return a&&a.table===(null===(s=this.permissionItemStore)||void 0===s?void 0:s.table)&&a.id===(null===(i=this.permissionItemStore)||void 0===i?void 0:i.id)?e.role:"read_and_write"}return e.role}isDisabled(){return"hidden_permission"===this.props.permissionItem.type||!this.isTeamOuterItem()&&!this.props.currentBlockStore.canAdmin()}isInherited(){var e;return(null===(e=this.permissionItemStore)||void 0===e?void 0:e.id)!==this.props.currentBlockStore.id}isDisplayOnlyPermissionItem(e){return"team_overview_permission"===e.type||"hidden_permission"===e.type}getMenuItemStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",minHeight:this.props.isCompact?44:52,paddingTop:8,paddingBottom:8,paddingLeft:e.getSafePaddingLeftCSS(14),paddingRight:e.getSafePaddingRightCSS(14)}}}B.displayName="PermissionItem",B.iconSize=32;const R=B},30355:(e,t,s)=>{s.r(t),s.d(t,{OfflineMessage:()=>Pn,default:()=>Zn});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(5366),l=s(43250),d=s(87279),c=s(18514),u=s(72126),m=s(26825),p=s(27006),g=s(21202),h=s(75246),f=s(29369),y=s(98165),v=s(67669),x=s(80444),S=s(90106);function b(e){const{store:t}=e;if(t.getParentTable()===h.bx)return!1;const s=(0,y.Om)(t),i=s?(0,m.Wo)((0,y.fJ)(s)):[],n=t.getPermissionItems(),a={};for(const o of i)a[(0,m.OC)(o)]=o;for(const o of n){const e=o.role,t=a[(0,m.OC)(o)];if(t){if((0,p.iC)(e)&&(0,p.iC)(t.role)&&(0,m.xO)(e,t.role))return!0;if(p.KF(t)&&!p.KF(o))return!0}else if((0,p.ix)(o)||(0,p.ZQ)(o)||(0,p.RI)(o))return!0}return!1}function M(e){const{store:t}=e,s=(0,y.uJ)(t)[1];return{parentStore:s,canAccessParent:s&&s.canRead()}}function w(e){const{mostPermissivePermissions:t,store:s,ancestorTeamId:i,type:n}=e;if(!i)return;const a=t.find((e=>{let{permissionItem:t}=e;return t.type===n&&t.team_id===i}));if(a)return a;const o=t.find((e=>{let{permissionItem:t}=e;return p.Le(t)}));return"explicit_team_guest_permission"!==n||o?{permissionItem:{type:n,role:"none",team_id:i},from:(null==o?void 0:o.from)??{table:g.iU,blockId:s.id}}:void 0}function j(e){const{spaceStore:t,store:s}=e,i=(0,v.YO)(s);let n=[];t&&(n=t.getPermissionGroups());const a=y.VP(s),o=function(e){let{mostPermissivePermissions:t,store:s}=e;return t.find((e=>{let{permissionItem:t}=e;return p.$D(t)}))||{permissionItem:{type:"public_permission",role:"none"},from:{table:g.iU,blockId:s.id}}}({mostPermissivePermissions:i,store:s}),r=function(e){let{mostPermissivePermissions:t,store:s,teamStore:i}=e;const n=t.find((e=>{let{permissionItem:t}=e;return p.ix(t)}));if(n)return n;const a=t.find((e=>p.Le(e.permissionItem)));return{permissionItem:{type:"space_permission",role:"none"},from:null!=a&&a.from||!i||"none"!==i.getSpacePermissionRole()?(null==a?void 0:a.from)??{table:g.iU,blockId:s.id}:{table:f.e0,teamId:i.id}}}({mostPermissivePermissions:i,store:s,teamStore:a}),l=w({mostPermissivePermissions:i,store:s,ancestorTeamId:null==a?void 0:a.id,type:"explicit_team_guest_permission"}),d=w({mostPermissivePermissions:i,store:s,ancestorTeamId:null==a?void 0:a.id,type:"explicit_team_permission"}),c=w({mostPermissivePermissions:i,store:s,ancestorTeamId:null==a?void 0:a.id,type:"explicit_team_owner_permission"});let m=i.filter((e=>{let{permissionItem:t}=e;return p.hV(t)}));m=u.MR(m,(e=>{if(t){return t.getPermissionGroups().findIndex((t=>t.id===e.permissionItem.group_id))}return e.permissionItem.group_id}));let h=i.filter((e=>{let{permissionItem:t}=e;return(p.zU(t)||p.LW(t))&&t.team_id!==(null==a?void 0:a.id)}));const x=new Map;h.forEach(((e,t)=>{let{permissionItem:s}=e;x.has(s.team_id)||x.set(s.team_id,t)})),h=u.MR(h,[e=>{let{permissionItem:t}=e;return x.get(t.team_id)||0},e=>{let{permissionItem:t}=e;return"explicit_team_owner_permission"===t.type?0:1}]);const S=i.filter((e=>{let{permissionItem:t}=e;return p.jg(t)})),b=Boolean(null==a?void 0:a.isDefined()),M="none"!==r.permissionItem.role,j=M||b||S.length>1||S.length&&!p.zz(S[0].permissionItem.role)||m.length||p.YX(r.permissionItem.role);return{showRestrictedPermissionBanner:i.some((e=>p.Le(e.permissionItem)&&e.from.table===g.iU&&e.from.blockId===s.id)),showTeamPermission:b,showSpacePermission:M,mostPermissivePublicItem:o,mostPermissiveAncestorTeamOwnerItem:c,mostPermissiveAncestorTeamMemberItem:d,mostPermissiveAncestorTeamGuestItem:l,mostPermissiveSpaceItem:r,pagePermissionUIModel:{showUserPermissions:j,mostPermissiveGroupPermissions:m,mostPermissiveTeamPermissions:h,mostPermissiveUserPermissions:S,spacePermissionGroups:n},permissionItemsCount:(j?S.length:0)+h.length+m.length+(M?1:0)+(b?1:0)}}var C=s(88632),k=s(85834),_=s(97238),T=s(52878),I=s(1743),P=s(56940),Z=s(78140),F=s(40721),A=s(64369),D=s(46247),B=s(32357),R=s(97880),L=s(55899),N=s(41892),E=s(8848),O=s(80721),V=s(91315),U=s(64275),W=s(45238),z=s(85893);const K=(0,W.I)("globe3",{viewBox:"0 0 15 15",svg:(0,z.jsx)("path",{d:"M8.052 12.458c.196 0 .44-.114.731-.342a6.52 6.52 0 00.916-.882c.315-.364.609-.752.882-1.162a8.03 8.03 0 00.67-1.19c.173-.377.26-.694.26-.95 0-.19-.082-.405-.246-.642a3.52 3.52 0 00-.63-.69 3.984 3.984 0 00-.792-.547c-.27-.146-.513-.219-.732-.219a.93.93 0 00-.43.123c-.155.078-.308.157-.458.24a.842.842 0 01-.383.115c-.078 0-.182-.038-.315-.116a3.409 3.409 0 01-.758-.608c-.096-.11-.144-.194-.144-.253 0-.041.03-.084.089-.13a.296.296 0 01.178-.075c.059 0 .166.055.32.164.16.105.33.21.507.314.178.1.332.15.465.15.291 0 .526-.088.704-.266.177-.178.266-.42.266-.724 0-.187-.082-.4-.246-.636.192-.1.408-.219.65-.356.246-.14.492-.298.738-.471.246-.178.47-.372.67-.581.205-.21.36-.429.465-.657l-.663-.341c-.087.21-.235.412-.445.608a5 5 0 01-.717.54c-.265.169-.53.321-.793.458a61.02 61.02 0 00-.69.362.332.332 0 00-.172.199c-.027.082-.004.173.069.273.14.196.241.344.3.444a.47.47 0 01.096.246c0 .05-.016.092-.048.123a.182.182 0 01-.123.042c-.073 0-.191-.05-.355-.15a9.923 9.923 0 00-.527-.315c-.182-.11-.34-.164-.471-.164a.889.889 0 00-.472.143 1.38 1.38 0 00-.383.362.747.747 0 00-.15.438c0 .155.068.33.205.526.141.196.317.385.526.568.21.182.424.332.643.45.223.115.417.172.58.172.128 0 .279-.039.452-.116.173-.082.337-.164.492-.247.155-.082.265-.123.328-.123.11 0 .256.055.438.164.187.105.374.237.56.397.187.155.345.308.472.458.132.146.198.262.198.349 0 .155-.075.385-.225.69-.15.3-.342.627-.575.978-.232.35-.476.688-.731 1.011-.255.324-.492.59-.71.8-.22.205-.386.308-.5.308a.393.393 0 01-.226-.082c-.072-.06-.109-.117-.109-.171a.54.54 0 01.014-.116 5.696 5.696 0 00.192-.623c.04-.145.058-.303.054-.471-.005-.228-.103-.438-.294-.63a7.264 7.264 0 00-.882-.71 4.55 4.55 0 00-.219-.15l-.218-.164c-.196-.15-.294-.301-.294-.452 0-.082.03-.21.089-.382.068-.242.102-.415.102-.52a.703.703 0 00-.123-.41 1.948 1.948 0 00-.376-.397.747.747 0 01-.061-.054.188.188 0 00-.055-.048l-1.087-.97c-.442-.397-.743-.748-.902-1.054-.16-.31-.215-.603-.164-.881.054-.278.175-.57.362-.875l-.718-.144c-.205.324-.33.668-.376 1.032-.046.365.03.752.226 1.162.196.41.556.848 1.08 1.313l1.08.957c.123.105.214.184.273.24.064.054.098.104.103.15a1.235 1.235 0 01-.103.341c-.059.15-.089.33-.089.54 0 .401.196.748.588 1.04.392.296.709.533.95.71.247.174.37.297.37.37a1.26 1.26 0 01-.13.587c-.087.187-.13.4-.13.636 0 .16.055.312.164.458.11.146.248.267.417.363.169.095.337.143.506.143zm-.267 1.668c.966 0 1.875-.185 2.728-.554a7.22 7.22 0 003.787-3.78 6.788 6.788 0 00.553-2.728c0-.966-.184-1.875-.553-2.727a7.137 7.137 0 00-1.531-2.25 7.219 7.219 0 00-2.256-1.53A6.805 6.805 0 007.778.003a6.77 6.77 0 00-2.727.554 7.241 7.241 0 00-3.774 3.78 6.788 6.788 0 00-.553 2.727c0 .967.184 1.876.553 2.728.37.852.878 1.604 1.525 2.256a7.124 7.124 0 002.256 1.524 6.77 6.77 0 002.727.554zm0-1.094a5.692 5.692 0 01-2.304-.472 6.034 6.034 0 01-1.9-1.285 6.217 6.217 0 01-1.292-1.907 5.765 5.765 0 01-.465-2.304c0-.815.155-1.583.465-2.303a6.133 6.133 0 011.292-1.9 6.036 6.036 0 011.9-1.286 5.676 5.676 0 012.297-.471 5.7 5.7 0 012.304.471c.72.31 1.356.738 1.907 1.285.552.547.982 1.18 1.292 1.9.315.72.472 1.489.472 2.304 0 .816-.157 1.584-.472 2.304a6.06 6.06 0 01-3.192 3.192 5.693 5.693 0 01-2.304.472z"})});var H=s(43876),G=s(82990),q=s(24215);var Y=s(51077),Q=s(73063),$=s(66957),X=s(22421);function J(e){let{inviteTargetsStore:t,mostPermissivePublicItem:s}=e;window.__c={n:"ShareMenuHeader"};const{display:i,source:n}=(0,a.VK)((()=>{const{display:e}=_.ZP.state;if(e===_.wV.Invite){const{source:t}=_.ZP.state;return{display:e,source:t}}return{display:e,source:void 0}}),[]);switch(i){case _.wV.MainShareMenu:case _.wV.Publish:return(0,z.jsx)(te,{mostPermissivePublicItem:s});case _.wV.Invite:if("notion"===n)return(0,z.jsx)(ie,{inviteTargetsStore:t});if("slack"===n)return(0,z.jsx)(ne,{});throw(0,R.t1)(n);default:(0,R.t1)(i)}}const ee=[_.XF.Share,_.XF.Publish];function te(e){let{mostPermissivePublicItem:t}=e;window.__c={n:"ShareMenuTabs"};const s=(0,n.O7)(),l=i.useRef(null),{isMobile:d}=s.device,c=(0,a.VK)((()=>_.ZP.state.tab),[]),u=(0,o.yK)((e=>({tabStyle:{color:e.lightTextColor,...d&&{width:"50%",textAlign:"center"}},selectedTabStyle:{fontWeight:G.Z.fontWeight.medium},tabTitleStyle:{color:"inherit"},style:d?{marginBottom:8,justifyContent:"space-between"}:{marginBottom:14}})),[d]),m=(0,o.yK)((()=>({publishTabContainer:{display:"flex",alignItems:"center"}})),[]),p=(0,i.useCallback)((e=>{const t=ee[e];t!==c&&(!function(e,t){q.j(e,"share_menu_tab_click",t)}(s,{tab:t}),t===_.XF.Share&&_.ZP.setState({..._.ZP.state,display:_.wV.MainShareMenu,tab:_.XF.Share}),t===_.XF.Publish&&_.ZP.setState({..._.ZP.state,display:_.wV.Publish,tab:_.XF.Publish}))}),[c,s]),g="none"!==t.permissionItem.role,h=[(0,z.jsx)(i.Fragment,{children:d?(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Permissions",id:"shareMenu.permissionsTab.title"},"permissions"):(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Share",id:"shareMenu.shareTab.title"},"share")},"title"),(0,z.jsxs)("div",{ref:l,style:m.publishTabContainer,children:[(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Publish",id:"shareMenu.publishTab.title"},"publish"),g&&se.publishedCheckIcon({opacity:c===_.XF.Publish?1:.5}),(0,z.jsx)(X.jG,{originRef:l})]},"publishTab")];return(0,z.jsx)($.Z,{...u,tabs:h,selectedIndex:ee.indexOf(c),onChange:p})}const se={[_.XF.Share]:(0,H.s)({height:17,width:17,marginRight:4}),[_.XF.Publish]:K({height:15,width:15,marginRight:4}),publishedCheckIcon:e=>{let{opacity:t}=e;return(0,V.r)({color:E.ZP.blue,width:14,height:14,marginLeft:4.5,opacity:t})}};function ie(e){let{inviteTargetsStore:t}=e;window.__c={n:"InviteFromNotionHeader"};const s=(0,o.yK)((()=>({container:{display:"flex",margin:"0 12px 6px",height:48}})),[]),n=(0,i.useCallback)((()=>{t.reset(),_.ZP.setState({..._.ZP.state,display:_.wV.MainShareMenu,tab:_.XF.Share})}),[t]);return(0,z.jsx)("div",{style:s.container,children:(0,z.jsx)(ae,{onClick:n})})}function ne(){window.__c={n:"InviteFromSlackHeader"};const e=(0,r.useIntl)(),t=(0,o.yK)((()=>({container:{display:"flex",justifyContent:"space-between",margin:"0 12px",height:48,alignItems:"center"},titleLabel:{display:"flex",fontSize:12,alignItems:"center",fontWeight:G.Z.fontWeight.semibold}})),[]),s=(0,i.useCallback)((()=>{_.ZP.setState({..._.ZP.state,tab:_.XF.Share,display:_.wV.Invite,source:_.T5.Notion,focus:_.Sw.Search,emailMessage:""})}),[]),n=(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Y.Z,{type:"image_url",imageURL:N.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:{marginLeft:4,marginRight:4}}),(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Slack",id:"shareMenu.slackIntegrationName.label"})]});return(0,z.jsxs)("div",{style:t.container,children:[(0,z.jsx)(A.Z,{style:t.titleLabel,children:(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.addFromSlack.label",defaultMessage:"Add people from {integrationNameWithLogo}",values:{integrationNameWithLogo:n}})}),(0,z.jsx)(Q.Z,{ariaLabel:e.formatMessage({id:"shareMenuHeader.goBackToInviteFromNotionMenu.iconButton",defaultMessage:"Close slack integration and go back to the main invite flow."}),icon:U.D,style:{borderRadius:"100%"},onClick:s})]})}function ae(e){window.__c={n:"BackButton"};const{onClick:t}=e,s=(0,r.useIntl)(),i=(0,o.yK)((()=>({topContainer:{display:"flex",alignItems:"center",width:"max-content"},backButtonPressedStyle:{backgroundColor:"transparent"},iconButton:{marginRight:6,height:24,width:24},arrowIcon:{height:16,width:16,strokeWidth:G.Z.fontWeight.semibold},sendInviteLabel:{fontWeight:G.Z.fontWeight.medium}})),[]);return(0,z.jsxs)("div",{style:i.topContainer,children:[(0,z.jsx)(Q.Z,{icon:O.W,iconStyle:i.arrowIcon,style:i.iconButton,onClick:t,ariaLabel:s.formatMessage({id:"shareMenu.backButton.iconButton",defaultMessage:"Go back to main share menu."})}),(0,z.jsx)(A.Z,{style:i.sendInviteLabel,children:(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.sendInvite.label",defaultMessage:"Send invite"})})]})}function oe(e){const{store:t}=e;return(0,a.VK)((()=>{const e=x.default.state.currentSpaceStore,s=(0,y.VP)(t);return s?{isPublicAccessDisabled:Boolean(s.getDisablePublicAccess()),disabledBy:"team"}:{isPublicAccessDisabled:Boolean(null==e?void 0:e.getDisablePublicAccess()),disabledBy:"space"}}),[t])}var re=s(31075),le=s(42922),de=s(42402);function ce(e){window.__c={n:"PublishToWeb"};const{store:t,mostPermissivePublicItem:s,permissionItemArgs:l}=e,{permissionItem:d,from:c}=s,{sudoModeStore:u,location:m}=l,p=(0,n.O7)(),h=(0,a.VK)((()=>t.canAdmin()),[t]),{isPublicAccessDisabled:f}=oe({store:t}),y=!h||f,v=(0,o.yK)((e=>({container:{display:"flex",flex:1,justifyContent:"center",alignItems:"center",flexDirection:"column",padding:32,textAlign:"center",cursor:y?"not-allowed":""},icon:{height:30,width:30,marginBottom:10,fill:e.mediumIconColor},title:{fontWeight:G.Z.fontWeight.semibold,fontSize:14,marginBottom:6},caption:{marginLeft:26,marginRight:26,marginBottom:20},button:{display:"flex",width:"100%",padding:16,cursor:y?"not-allowed":"pointer"}})),[y]),S=(0,a.VK)((()=>{var e;return null===(e=x.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace()}),[]),b=c.table===g.iU?c.blockId:c.teamId,M=(0,i.useCallback)((()=>{const e=!S&&d.allow_duplicate;(0,re.i)({oldPermissionItem:d,newPermissionItem:{...d,role:"reader",allow_duplicate:e},wasInherited:b!==t.id,environment:p,store:t,sudoModeStore:u,location:m})}),[p,b,m,S,d,t,u]);return(0,z.jsxs)("div",{style:v.container,children:[K(v.icon),(0,z.jsx)("div",{style:v.title,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Publish to web",id:"publishTab.publishToWeb.title"})}),(0,z.jsx)(A.Z,{isMultiline:!0,isSecondaryColor:!0,style:v.caption,children:(0,z.jsx)(ue,{store:t})}),(0,z.jsx)(le.Z,{style:v.button,disabled:y,onClick:M,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Publish to web",id:"publishTab.publishToWeb.button"})})]})}function ue(e){let{store:t}=e;window.__c={n:"PublishToWebMessage"};const{isPublicAccessDisabled:s,disabledBy:i}=oe({store:t}),n=(0,a.VK)((()=>t.canAdmin()),[t]);return s?"team"===i?(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Publishing to web is disabled for this page via teamspace settings.",id:"publishTab.publishToWeb.disabledByTeamspace.caption"}):(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Publishing to web is disabled for this page via workspace settings.",id:"publishTab.publishToWeb.disabledByWorkspace.caption"}):n?(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Publish a static website of this page. You can allow others to view, duplicate, and remix. <inlinelink>Learn more</inlinelink>. ",id:"publishTab.publishToWeb.hasFullAccess.caption",values:{inlinelink:e=>(0,z.jsx)(de.Z,{external:!0,href:(0,c.UY)("guides.autogeneratedDomains"),children:e})}}):(0,z.jsx)(r.FormattedMessage,{defaultMessage:"You must have full access to this page to publish to web.",id:"publishTab.publishToWeb.noFullAccess.caption"})}var me=s(15145);const pe=(0,W.I)("blueCircleDot",{viewBox:"0 0 16 16",svg:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("circle",{cx:"8",cy:"8",r:"8",fill:"none",stroke:"#2383E2",children:[(0,z.jsx)("animate",{attributeName:"r",from:"3",to:"8",dur:"1s",begin:"0s",repeatCount:"indefinite"}),(0,z.jsx)("animate",{attributeName:"opacity",from:"1",to:"0",dur:"1s",begin:"0s",repeatCount:"indefinite"})]}),(0,z.jsx)("circle",{cx:"8",cy:"8",r:"3",fill:"#2383E2"})]})});var ge=s(34602),he=s(84210),fe=s(81236),ye=s(63296),ve=s(26388),xe=s(91376);function Se(e){window.__c={n:"LearnAboutAutogeneratedDomainsCTA"};const t=(0,n.O7)(),{WindowSizeStore:s}=t,{safePaddingLeftCSS:i,safePaddingRightCSS:l}=(0,a.VK)((()=>({safePaddingLeftCSS:s.getSafePaddingLeftCSS(8),safePaddingRightCSS:s.getSafePaddingRightCSS(8)})),[s]),{isMobile:d}=(0,n.Fy)(),{spaceStore:c,canChangeSettings:u,publicSpaceData:m}=(0,a.VK)((()=>{const e=x.default.state.currentSpaceStore;return e?{spaceStore:e,canChangeSettings:e.canAdmin(),publicSpaceData:fe.Z.getPublicSpaceData(t,e.id)}:{}}),[t]),p=(0,o.yK)((t=>({container:{boxShadow:`0 -1px 0 ${t.regularDividerColor}`,width:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",padding:"8px 8px",paddingLeft:i,paddingRight:l,color:t.mediumTextColor,backgroundColor:t.inputBackground,...e.style}})),[e.style,i,l]);if(!c)return null;if(d)return null;if(!m)return null;return m.domainIsAutogenerated&&u?(0,z.jsx)("span",{style:p.container,children:(0,z.jsxs)("div",{style:{display:"flex"},children:[(0,z.jsx)(A.Z,{isSmall:!0,isMobile:!1,isSecondaryColor:!0,style:{paddingRight:"4px"},...e.labelStyle,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Set a domain for your public links in",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.setDomainForPublicLinks"})}),(0,z.jsx)("span",{style:{cursor:"pointer",userSelect:"none",WebkitUserSelect:"none",color:E.ZP.inherit},onClick:()=>{xe.r$({currentTab:"settings"})},children:(0,z.jsx)(A.Z,{isSmall:!0,isMobile:!1,isSecondaryColor:!1,style:{textDecoration:"underline"},...e.labelStyle,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Settings",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.openSettingsCTA"})})})]})}):null}var be=s(42853),Me=s(23867),we=s(50906),je=s(14871),Ce=s(33929),ke=s(5162),_e=s(77080),Te=s(13627),Ie=s(64921),Pe=s(74194),Ze=s(89728),Fe=s(24006),Ae=s(60442),De=s(42115),Be=s(76472),Re=s(13991),Le=s(7057),Ne=s(63143),Ee=s(28020),Oe=s(61766),Ve=s(31194),Ue=s(52275),We=s(31945),ze=s(32163),Ke=s(72495),He=s(93289),Ge=s(42782);function qe(e){window.__c={n:"PublicPermissionItemLinkExpirationMenu"};const t=(0,n.Fy)(),[,,s]=(0,a.AF)(void 0,Oe.Z),i=(0,o.Fg)(),c=(0,n.O7)(),u=(0,a.VK)((()=>(0,Te.y$)(c)),[c]),{buttonMenuItemStyle:m}=(0,o.yK)((()=>({buttonMenuItemStyle:{opacity:e.disabled?.6:1,cursor:e.disabled?"not-allowed":""}})),[e.disabled]);return(0,z.jsx)(We.ZP,{...e.upsellEvents,disablePopup:!u,disabled:e.disabled,popupType:t.isMobile?We.Z4.SlideUp:We.Z4.Popup,buttonPopupStore:s,renderOrigin:t=>(0,z.jsx)(Ue.Z,{...t,focused:!1,disabled:e.disabled,style:m,title:(0,z.jsxs)(A.Z,{children:[(0,z.jsx)(r.FormattedMessage,{id:"publicPermissionItem.expirationTime.label",defaultMessage:"Link expires"})," ",e.upgradeLabel]}),right:(0,z.jsxs)(Ze.Z,{...t,disabled:e.disabled,ignoreLocalHoverState:!0,style:{paddingLeft:0,paddingRight:0},children:[(0,z.jsx)(Ye,{permissionItem:e.permissionItem}),(0,be.i)({width:10,marginLeft:4,fill:i.lightIconColor})]})}),alignmentToOrigin:Ve.lU.End,placementToOrigin:Ve.Iw.Bottom,render:s=>{const i=[{key:"options",render:e=>(0,z.jsx)(Ke.Z,{...e}),items:$e().map((t=>({key:t.type,action:()=>{Qe(e,c,t.time),s.close()},render:e=>(0,z.jsx)(Ue.Z,{...e,focused:e.focused,disabled:!1,title:t.title,caption:t.caption})})))},{key:"custom",render:e=>(0,z.jsx)(Ke.Z,{...e,topBorder:!0}),items:[{key:"custom",action:()=>{s.close()},render:(t,i)=>(0,z.jsx)(Ge.Z,{...t,renderOrigin:e=>(0,z.jsx)(Ue.Z,{...e,disabled:!1,title:(0,z.jsx)(r.FormattedMessage,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"})}),onFocus:i.onFocus,disableDefaultClick:!0,renderExtension:(t,i)=>(0,z.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,z.jsx)(He.Z,{...t,firstDayOfWeek:Ee.AK.state,value:e.permissionItem.expiration_timestamp||(new Date).getTime(),onChange:t=>{Qe(e,c,t),i.close(),s.close()},disabledDays:{before:new Date}})})})}]}];let n;return n=t.isMobile?{menuType:d.og.Modal,title:(0,z.jsx)(r.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.title",defaultMessage:"Expiration time"}),right:(0,z.jsx)(r.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.label",defaultMessage:"Done"}),onClickRight:s.close}:{menuType:d.og.Popup,width:264},(0,z.jsx)(Z.Z,{className:l.IpQ,...n,children:(0,z.jsx)(ze.Z,{type:ze.i.Vertical,initialFocus:void 0,sections:i})})}})}function Ye(e){const{permissionItem:t}=e;return!t.expiration_timestamp||(0,p.o7)(t)?(0,z.jsx)(r.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"}):(0,z.jsx)(A.Z,{children:e.permissionItem.expiration_timestamp&&(0,Le.tv)(e.permissionItem.expiration_timestamp,Re.SP)})}function Qe(e,t,s){const{permissionItem:i,onChange:n}=e;if("public_permission"!==i.type)return;if(void 0!==s&&s<=(new Date).getTime())return;const a=i,o=u.d9(a),r=s;o.expiration_timestamp=r,n(o),we.n4j(t,{expiration_time:r})}function $e(){const e=(new Date).getTime()+Ne.U6,t=(new Date).getTime()+Ne.A0,s=(new Date).getTime()+7*Ne.A0;return[{type:"never",time:void 0,title:(0,z.jsx)(r.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"})},{type:"hour",time:e,title:(0,z.jsx)(r.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.hour",defaultMessage:"In an hour"}),caption:new Intl.DateTimeFormat(Re.SP,{hour:"numeric",minute:"numeric"}).format(e)},{type:"day",time:t,title:(0,z.jsx)(r.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.day",defaultMessage:"In a day"}),caption:new Intl.DateTimeFormat(Re.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(t)},{type:"week",time:s,title:(0,z.jsx)(r.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.week",defaultMessage:"In a week"}),caption:new Intl.DateTimeFormat(Re.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(s)}]}function Xe(e){window.__c={n:"PageLinkOptions"};const{permissionItem:t,onUpgradeButtonClick:s,onChange:l,currentBlockStore:d}=e,c=(0,n.O7)(),u=(0,a.VK)((()=>!d.canAdmin()),[d]),m=(0,a.VK)((()=>{var e;return Boolean(null===(e=x.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace())}),[]),g=p.RF(t.role),h=!1!==t.allow_duplicate,f=p.J5(t.role),y=Boolean(t.allow_search_engine_indexing),v=(0,i.useCallback)((()=>{l({role:f?"comment_only":"read_and_write"})}),[f,l]),S=(0,i.useCallback)((()=>{l({role:g?"reader":"comment_only"})}),[g,l]),b=(0,i.useCallback)((()=>{const e=!y;l({allow_search_engine_indexing:e}),we.g0v(c,{allow_search_engine_indexing:e})}),[c,l,y]),M=(0,i.useCallback)((()=>{const e=!h;l({allow_duplicate:e}),we.l7z(c,{allow_duplicate:e})}),[h,c,l]),w=(0,a.VK)((()=>_e.default.checkGate("expiring_public_links")),[]),j=(0,a.VK)((()=>!(0,Te.y$)(c)&&(0,Te.M9)(c)),[c]),C=(0,a.VK)((()=>!(0,Te.f3)(c)&&(0,Te.M9)(c)),[c]),k=(0,a.VK)((()=>ot(c)),[c]),_=(0,a.VK)((()=>u||m&&!h),[u,h,m]),T=(0,o.yK)((()=>({optionLabel:{marginRight:"auto",opacity:u?.6:1},optionButton:u?{...k,cursor:"not-allowed"}:k})),[u,k]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(z.Fragment,{children:[w&&(0,z.jsx)(De.Z,{alwaysAllowClick:Boolean(t.expiration_timestamp),onClick:()=>{},analyticsName:"public_permission_item_expiration",requireUpgradeToTier:j,tooltipPlacement:ve.Z.Placement.Left,renderTooltip:st,renderUpgradeTooltip:it,onUpgradeClick:s,render:(e,s)=>(0,z.jsx)(qe,{upsellEvents:e,upgradeLabel:s,permissionItem:t,onChange:l,disabled:u})}),(0,z.jsx)(ve.Z,{placement:ve.Z.Placement.Left,renderTooltip:et,render:e=>(0,z.jsxs)(Ie.Z,{onClick:v,style:T.optionButton,disabled:u,...e,children:[(0,z.jsx)(A.Z,{style:T.optionLabel,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Allow editing",id:"pagePermissionItem.allowEdits.setting"})}),(0,z.jsx)(Fe.Z,{on:f,onClick:v,disabled:u})]})}),(0,z.jsx)(ve.Z,{placement:ve.Z.Placement.Left,renderTooltip:tt,render:e=>(0,z.jsxs)(Ie.Z,{onClick:S,style:T.optionButton,disabled:u,...e,children:[(0,z.jsx)(A.Z,{style:T.optionLabel,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Allow comments",id:"pagePermissionItem.allowComments.setting"})}),(0,z.jsx)(Fe.Z,{on:g,onClick:S,disabled:u})]})})]}),(0,z.jsx)(ve.Z,{placement:ve.Z.Placement.Left,renderTooltip:m&&!h?at:nt,render:e=>(0,z.jsxs)(Ie.Z,{onClick:M,disabled:_,style:T.optionButton,...e,children:[(0,z.jsx)(A.Z,{style:T.optionLabel,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Allow duplicate as template",id:"pagePermissionItem.allowDuplicateTemplate.setting"})}),(0,z.jsx)(Fe.Z,{on:h,onClick:M,disabled:_})]})}),(0,z.jsx)(De.Z,{requireUpgradeToTier:C,alwaysAllowClick:t.allow_search_engine_indexing,analyticsName:"allow_search_engine_indexing",onClick:b,onUpgradeClick:s,tooltipPlacement:ve.Z.Placement.Left,renderTooltip:st,renderUpgradeTooltip:it,render:(e,t)=>(0,z.jsxs)(Ie.Z,{style:T.optionButton,disabled:u,...e,children:[(0,z.jsxs)(A.Z,{style:T.optionLabel,children:[(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Search engine indexing",id:"pagePermissionItem.allowSearchEngines.setting"})," ",t]}),(0,z.jsx)(Fe.Z,{on:y,onClick:b,disabled:u||Boolean(t)})]})})]})}function Je(e){window.__c={n:"PageLinkButton"};const[t,s]=i.useState(!1),[l,d]=i.useState(void 0),{currentBlockStore:c}=e,u=(0,n.O7)(),m=(0,a.VK)((()=>ot(u)),[u]),p=(0,o.yK)((()=>({container:{...m,height:"auto"},flex:{flex:1},wrapper:{display:"flex",padding:"1px 0"},input:{flex:1,borderTopRightRadius:0,borderBottomRightRadius:0,paddingRight:0},button:{height:28,borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeft:"none"}})),[m]),g=(0,a.VK)((()=>(0,he.ZP)({store:c,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=fe.Z.getPublicSpaceData(u,(0,Me.C)(c.getSpaceId())))||void 0===e?void 0:e.domain},pageVisitSource:me.tY.CopyLink})),[c,u]),h=(0,i.useCallback)((()=>{u.mobileNative&&(0,ke.Y)("supportsNativeCopy")?u.mobileNative.copyText(g,Ce.default.formatMessage(je.tq.copiedLinkToClipboard)):je.RD({environment:u,stringValue:g,copiedMessage:je.tq.copiedLinkToClipboard}),clearTimeout(l),s(!0),d(window.setTimeout((()=>{s(!1)}),1e3)),we.c7L(u)}),[u,g,l]);return(0,z.jsx)("div",{style:p.container,children:(0,z.jsx)("div",{style:p.flex,children:(0,z.jsxs)("div",{style:p.wrapper,children:[(0,z.jsx)(Pe.Z,{value:g,disabled:!0,style:p.input}),(0,z.jsx)(ye.Z,{onClick:h,style:p.button,children:t?(0,z.jsx)(r.FormattedMessage,{id:"pageShareMenu.copiedLinkButton.label",defaultMessage:"✓ Copied"}):(0,z.jsx)(r.FormattedMessage,{id:"pageShareMenu.copyMaybePublicLinkButton.label.web",defaultMessage:"Copy web link"})})]})})})}function et(){return(0,z.jsx)(Ae.Z,{caption:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Any logged in Notion user can edit this page. Share the secret link with people you trust.",id:"pagePermissionItem.allowEdits.tooltip"}),imageHeight:120,imageWidth:240,imageURL:N.Z.images.tooltips.share.allowEditingPng})}function tt(){return(0,z.jsx)(Ae.Z,{caption:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Any logged in Notion user can comment on this page.",id:"pagePermissionItem.allowComments.tooltip"}),imageHeight:120,imageWidth:240,imageURL:N.Z.images.tooltips.share.allowCommentsPng})}function st(){return(0,z.jsx)(Ae.Z,{caption:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"If allowed, your public page may appear in search engines such as Google, but only if you or someone else links to it elsewhere on the web.",id:"pagePermissionItem.allowSearchEngine.tooltip"}),imageHeight:120,imageWidth:240,imageURL:N.Z.images.tooltips.share.allowSearchEnginesPng})}function it(){return(0,z.jsx)(Ae.Z,{imageURL:N.Z.images.tooltips.upsells.searchEngineIndexingPng,imageWidth:240,imageHeight:100,title:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Upgrade for search engine indexing",id:"pagePermissionItem.searchEngineUpgradeTooltip.title"}),caption:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Have your page appear in search engine results.",id:"pagePermissionItem.searchEngineUpgradeTooltip.caption"})})}function nt(){return(0,z.jsx)(Ae.Z,{caption:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"If allowed, this will allow other people to duplicate your public page to their workspace.",id:"pagePermissionItem.allowDuplicateTemplate.tooltip"}),imageHeight:120,imageWidth:240,imageURL:N.Z.images.tooltips.share.allowDuplicatePng})}function at(){return(0,z.jsx)(Ae.Z,{caption:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"This workspace does not allow page duplication to other workspaces.",id:"pagePermissionItem.duplicateTemplateDisabled.tooltip"}),imageWidth:240})}function ot(e){const t=e.WindowSizeStore;return{display:"flex",alignItems:"center",width:"100%",height:e.device.isMobile?36:30,paddingTop:5,paddingBottom:5,paddingLeft:t.getSafePaddingLeftCSS(14),paddingRight:t.getSafePaddingRightCSS(14)}}function rt(e){window.__c={n:"PublishToWebSettings"};const{store:t,mostPermissivePublicItem:s,permissionItemArgs:l}=e,{permissionItem:d,from:u}=s,{sudoModeStore:m,location:p,onUpgradeButtonClick:h}=l,f=(0,n.O7)(),{isMobile:y}=f.device,v=(0,o.yK)((e=>({title:{color:e.blueColor,fontWeight:G.Z.fontWeight.medium,fontSize:14,display:"flex",alignItems:"center",margin:"0px 16px 10px",paddingTop:y?4:0},icon:{height:16,width:16,marginRight:6},linkSharingOptions:{margin:"10px 2px"},learnAboutDomainsCTA:{fontSize:14,margin:"8px 8px",padding:0,backgroundColor:void 0,boxShadow:void 0,textAlign:"left",alignItems:"flex-start"},buttonGroup:{margin:"10px 14px 16px",display:"flex",gap:10},button:{flexGrow:1,height:34},disabledButton:{opacity:.7,cursor:"not-allowed"}})),[y]),x=(0,a.VK)((()=>!t.canAdmin()),[t]),S=u.table===g.iU?u.blockId:u.teamId,b=(0,i.useCallback)((e=>{(0,re.i)({oldPermissionItem:d,newPermissionItem:{...d,...e},wasInherited:S!==t.id,environment:f,store:t,sudoModeStore:m,location:p})}),[d,S,t,f,m,p]),M=(0,i.useCallback)((()=>{b({role:"none"})}),[b]),w=(0,a.VK)((()=>(0,he.ZP)({store:t,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=fe.Z.getPublicSpaceData(f,t.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:me.tY.LinkInPage})),[t,f]),j=(0,i.useCallback)((()=>{!function(e){q.j(e,"view_public_site_click")}(f),ge.navigate({url:w,environment:f,openInNew:"tab"})}),[f,w]);return(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{style:v.title,children:[pe(v.icon),(0,z.jsx)("span",{children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"This page is live on the web. <inlinelink>Learn more</inlinelink>.",id:"publishTab.settings.liveOnWeb.title",values:{inlinelink:e=>(0,z.jsx)(de.Z,{external:!0,href:(0,c.UY)("guides.autogeneratedDomains"),children:e})}})})]}),(0,z.jsx)(Je,{currentBlockStore:t}),(0,z.jsx)(Se,{style:v.learnAboutDomainsCTA,labelStyle:{isSmall:!1}}),(0,z.jsx)("div",{style:v.linkSharingOptions,children:(0,z.jsx)(Xe,{currentBlockStore:t,permissionItem:d,onChange:b,onUpgradeButtonClick:h})}),(0,z.jsxs)("div",{style:v.buttonGroup,children:[(0,z.jsx)(ve.Z,{disableTooltip:!x,renderTooltip:()=>(0,z.jsx)(r.FormattedMessage,{defaultMessage:"You must have full access to this page to unpublish it",id:"publishTab.settings.liveOnWeb.unpublishTooltip"}),render:e=>(0,z.jsx)(ye.Z,{onClick:M,disabled:x,style:x?{...v.button,...v.disabledButton}:v.button,...e,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Unpublish",id:"publishTab.settings.liveOnWeb.unpublish"})})}),(0,z.jsx)(le.Z,{onClick:j,style:v.button,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"View site",id:"publishTab.settings.liveOnWeb.viewSite"})})]})]})}function lt(e){const{store:t,mostPermissivePublicItem:s,permissionItemArgs:i}=e,{permissionItem:n}=s;return"none"!==n.role?(0,z.jsx)(rt,{store:t,mostPermissivePublicItem:s,permissionItemArgs:i}):(0,z.jsx)(ce,{store:t,mostPermissivePublicItem:s,permissionItemArgs:i})}var dt=s(77657),ct=s(94044),ut=s(54642),mt=s(95209),pt=s(48429),gt=s(4708),ht=s(79817),ft=s(53353),yt=s(26781),vt=s(34859),xt=s(30874),St=s(29798),bt=s(78291),Mt=s(3386),wt=s(53336),jt=s(7567),Ct=s(44385),kt=s(5257),_t=s(29477),Tt=s(149),It=s(42631),Pt=s(68785);function Zt(e){window.__c={n:"ImportContactsButton"};const{onClickAuthenticated:t}=e,s=(0,n.O7)(),[l,d]=i.useState(!1),c=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>{const e=null==c?void 0:c.getBotSettingsStore().getValue();return"approved_only"!==(null==e?void 0:e.integration_restrictions)||Boolean((null==e?void 0:e.integration_approval_statuses)&&e.integration_approval_statuses[dt.nO])}),[c]),m=(0,a.VK)((()=>xt.Z.integrations.state.find((e=>e.id===dt.nO))),[]),p=(0,a.VK)((()=>xt.Z.completeSlackAuthentications.state),[]),g=(0,o.yK)((e=>({circleCheck:{height:14,width:14,marginLeft:6,color:E.ZP.blue},chevron:{height:12,width:12,marginLeft:6},title:{display:"flex",alignItems:"center",color:E.ZP.uiLightBlack,size:14},integrationName:{display:"flex"},integrationIcon:{marginLeft:4,marginRight:4},container:{height:36,bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:"all",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",padding:3},button:{width:"100%",paddingTop:15,paddingBottom:15,paddingLeft:9},loadingSpinner:{width:14,height:14,marginLeft:6}})),[]);if(!c)return(0,z.jsx)(z.Fragment,{});if(!u)return(0,z.jsx)(z.Fragment,{});const h=(0,z.jsxs)("div",{style:g.integrationName,children:[(0,z.jsx)(Y.Z,{type:"image_url",imageURL:N.Z.images.externalIntegrations.slackIconPng,size:18,imageStyle:g.integrationIcon}),(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Slack",id:"importContactsButton.integrationName"})]}),f=l?(0,z.jsx)(Pt.Z,{style:g.loadingSpinner}):(0,z.jsxs)(z.Fragment,{children:[p.length>0&&(0,V.r)(g.circleCheck),(0,kt.o)(g.chevron)]});return(0,z.jsx)("div",{style:g.container,children:(0,z.jsx)(Ze.Z,{style:g.button,onClick:async()=>{0===p.length?await async function(){const e=s.currentUser.id;if(!m||!c||!e)return;try{var i;d(!0);const e=await It.hM({environment:s,integration:m,spaceId:c.id,from:"share_menu"});if(Tt.x.isFail(e))return;const n=null===(i=e.value.externalAuthentication)||void 0===i?void 0:i.parent_id;if(!n)return;const a=_e.default.getEligibleGroup({experimentId:"import_slack_contacts",defaultGroup:2e3,parameter:"load_contacts_timeout"}),o=Number(a);await Promise.race([ut.loadContacts(s,{botId:n,spaceId:c.id,integrationId:m.id}),(0,_t.Vs)(Number.isNaN(o)?2e3:o)]),null==t||t()}finally{d(!1)}}():p.length>0&&(null==t||t())},children:(0,z.jsxs)("div",{style:g.title,children:[(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Add contacts from {integrationNameWithLogo}",id:"importContactsButton.integrationButton.label",values:{integrationNameWithLogo:h}}),f]})})})}var Ft=s(33728),At=s(26907),Dt=s(35057);const Bt=u.Ds((e=>{let{environment:t,flowId:s,subscriptionTier:i,origin:n}=e;we.UWw(t,{invite_flow_id:s,subscription_tier:i,invite_origin:n})}),1e3);var Rt=s(47082),Lt=s(22193);const Nt=function(e){window.__c={n:"InviteTargetsInput"};const{flowId:t,store:s,disabled:i,placeholder:r,right:l,focus:d,onFocus:c,onSubmit:u,hideIconColorAndTooltips:m}=e,p=(0,n.O7)(),g=(0,n.Fy)(),h=(0,a.qz)(e.inviteTargetsStore,L.ZP),f=(0,a.VK)((()=>h.state.inviteTargets),[h]),y=(0,a.VK)((()=>h.state.tokenQuery),[h]),v=f.map((e=>{const t="newUser"===e.type?e.value.email:e.value.id;return(0,z.jsx)(Lt.Z,{store:s,target:e,showRemoveButton:!0,tokenType:m?"member":void 0,onClickRemove:()=>function(e){const{targetToRemove:t,inviteTargetsStore:s}=e;if(0===s.state.inviteTargets.length)return;const i=s.state.inviteTargets.filter((e=>e!==t));0===i.length?s.setState({...s.state,inviteTargets:[]}):s.setState({...s.state,inviteTargets:i})}({inviteTargetsStore:h,targetToRemove:e})},t)})),x=(0,o.yK)((e=>({tokenSpan:{maxWidth:"100%"},tokenInputMenuItem:{paddingTop:0===f.length?0:6,paddingLeft:4,paddingRight:4,paddingBottom:4,borderRadius:3,minHeight:"unset",...d&&{background:"none"},...i&&{background:e.inputBackground,color:e.mediumTextColor,fill:E.ZP.white,opacity:.4}},inputAndTokenWrapRight:{gap:6},tokenInputMenuItemInput:{paddingTop:0===f.length?6:0}})),[f,d,i]);return(0,z.jsx)(Rt.Z,{focus:d,focusAfterAnimation:!0,onClick:()=>{g.isMobile||null==c||c()},format:Rt.Z.Format.Share,value:y,onChange:e=>async function(e){const{environment:t,event:s,flowId:i,inviteTargetsStore:n,inviteOrigin:a}=e;n.setState({...n.state,tokenQuery:s.target.value}),Bt({environment:t,flowId:i,subscriptionTier:(0,Dt.zt)(),origin:a});const o=s.target.value,{extractedEmails:r,newInputValue:l}=(0,Ft.zI)(o),d=(await mt.M5(t,r)).filter((e=>!At.H({inviteTargetsStore:n,target:e}))),c=[...n.state.inviteTargets,...d];n.setState({...n.state,inviteTargets:c,tokenQuery:l})}({environment:p,event:e,inviteTargetsStore:h,inviteOrigin:"page_contextual_invite",flowId:t}),type:"email",tokens:v,disabled:i,autoComplete:"off",placeholder:r,onRemoveLastToken:()=>{h.setState({...h.state,inviteTargets:h.state.inviteTargets.slice(0,-1)})},right:l,showBorder:!0,inputStyle:x.tokenInputMenuItemInput,inputAndTokenWrapRightStyle:x.inputAndTokenWrapRight,style:x.tokenInputMenuItem,onSubmit:u,inputFullWidth:!0})};var Et=s(45101),Ot=s(77907),Vt=s(96455);const Ut=function(e){window.__c={n:"PermissionsInviteEntry"};const{store:t}=e,{isMobile:s}=(0,n.Fy)(),i=(0,a.VK)((()=>t.canEditMembership()),[t]),l=(0,o.yK)((()=>({buttonContainer:{display:"flex",alignItems:"center",gap:ct.p_},inputButton:{flex:1,justifyContent:"flex-start",height:30,overflow:"hidden"},blueButton:{minWidth:ct.UF}})),[]);return(0,z.jsx)(ve.Z,{renderTooltip:()=>(0,z.jsx)(r.FormattedMessage,{id:"inviteUserButton.tooltip.fullAccessOnlyMessage",defaultMessage:"Only those with full access can add people."}),disableTooltip:i,render:t=>(0,z.jsxs)("div",{style:l.buttonContainer,...t,children:[(0,z.jsx)(Vt.Z,{onClick:e.onClick,disabled:!i&&!0,style:l.inputButton,children:(0,z.jsx)("div",{style:G.Z.textOverflowStyle,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Add emails or people",id:"ContexualInvites.inviteUserModal.searchInput.placeholderWithoutBots"})})}),!s&&(0,z.jsx)(le.Z,{isLarge:!0,onClick:e.onClick,disabled:!i&&!0,style:l.blueButton,children:(0,z.jsx)(r.FormattedMessage,{id:"inviteUserButton.invitePersonLabel",defaultMessage:"Invite"})})]})})};function Wt(e){window.__c={n:"MobileInviteSection"};const{store:t,permissionItemArgs:s}=e,{onUpgradeButtonClick:i,sudoModeStore:r}=s,l=(0,a.qz)(void 0,T.Z),{permissionsInviteStore:d}=(0,a.VK)((()=>l.state),[l]),c=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),u=(0,a.VK)((()=>l.stage),[l]),m=(0,a.VK)((()=>d.state.modalOpen),[d]),p=(0,n.O7)(),g=(0,a.VK)((()=>t.canAdmin()),[t]),h=(0,a.VK)((()=>{const{data:e}=bt.default.state;return Boolean(e&&Te.YK(e))}),[]),f=(0,a.VK)((()=>function(e){const{store:t}=e,s=(0,y.VP)(t),i=x.default.state.currentSpaceStore;return Boolean((null==i?void 0:i.getDisableGuests())||(null==s?void 0:s.getDisableGuests()))}({store:t})),[t]),v=(0,o.yK)((e=>({button:{display:"flex",alignItems:"center",minHeight:52},buttonInner:{width:"100%"},modalButton:{height:36}})),[]);return c?u!==k.TG.closed?(0,z.jsx)(Ot.LazyUniversalMemberInvite,{universalInviteStore:l,mode:"milestone_2",spaceStore:c,sudoModeStore:r,store:t,disabled:!g,membersOnly:f,isSubscribed:h,onUpgradeButtonClick:i,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:{height:36}}):(0,z.jsx)(Ie.Z,{mobileFeedback:!0,disabled:!0,style:v.button,children:(0,z.jsxs)("div",{style:v.buttonInner,children:[m&&(0,z.jsx)(Ot.LazyPermissionsInviteWithModal,{store:t,disabled:!g,membersOnly:f,isSubscribed:h,onUpgradeButtonClick:i,upgradeButtonName:"invite_permission_block",shouldGrow:!0,buttonStyle:v.modalButton,permissionsInviteStore:d}),(0,z.jsx)(Ut,{store:t,onClick:()=>(0,Et.z5)({environment:p,permissionsInviteStore:d,store:t,isSubscribed:h,renderInShareModal:!1})})]})}):null}var zt=s(19889),Kt=s(7928),Ht=s(91536),Gt=s(64684);function qt(){const{data:e}=bt.default.state,t=e?Te.CM(e):[],s=new Map;return t.forEach((e=>{s.set(e.userId,e)})),s}function Yt(e){const{spaceVisibleUserMap:t,blockStore:s,userId:i}=e,n=t.get(i);if(!n||"none"!==n.role)return;if(!n.isTeamGuest)return"guest";const a=y.VP(s);if(!a)return"guest";return(0,Gt.s8)({team:{membership:a.getRawMembership()},userId:i})?"team_level_guest":"guest"}var Qt=s(65598),$t=s(16639),Xt=s(12793),Jt=s(31278),es=s(25735);function ts(e){window.__c={n:"GroupPermissionTooltip"};const{group:t}=e,s=(0,r.useIntl)(),i=(0,$t.kF)({intl:s,group:t});return(0,z.jsx)(es.Y,{group:t,limit:15,noMembersMessage:(0,z.jsx)(Ae.Z,{imageURL:N.Z.images.tooltips.share.sharedPng,imageWidth:240,imageHeight:120,caption:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"For all members of the {groupName} group, this page will show up in the <boldtext>Shared</boldtext> section in their sidebar.",values:{boldtext:e=>(0,z.jsx)("span",{style:{fontWeight:G.Z.fontWeight.bold},children:e}),groupName:i},id:"blockPermissionsSettings.groupPermission.tooltip"})})})}const ss=function(e){window.__c={n:"BlockGroupPermissionItem"};const{store:t,groupPermission:s,spaceId:i,fromPermissionWrapper:n}=e,o=(0,r.useIntl)(),d=(0,a.VK)((()=>{const{currentSpaceStore:e}=x.default.state;if(!e)return!1;return e.getPermissionGroups().find((e=>e.id===s.permissionItem.group_id))}),[s.permissionItem.group_id]);if(!d)return null;const c=d.user_ids||[],u=(0,$t.kF)({intl:o,group:d}),m=d.icon&&(0,z.jsx)(Jt.Z,{disabled:!0,title:u,icon:d.icon?{pointer:{table:"space",id:i},icon:d.icon}:void 0,isEmptyPage:!1,size:18});return(0,z.jsx)("div",{style:{fontWeight:400},className:l.gGc,children:(0,z.jsx)(Be.Z,{currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,icon:(0,z.jsx)(Xt.Z,{size:Be.Z.iconSize}),title:u,tag:m,ignoreLocalHoverState:e.ignoreLocalHoverState,showInherited:e.showInherited,nonInheritedTooltip:(0,z.jsx)(ts,{group:d}),subtitle:(0,z.jsxs)("div",{children:[(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,z.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:c.length}})]}),upgradeButtonName:"group_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:n,...e.permissionItemArgs})},d.id)};var is=s(88198),ns=s(45653);function as(e){window.__c={n:"Icon"};const{userValue:t,shouldShowPendingInvitation:s}=e,i=(0,o.yK)((()=>({iconPlaceholder:{height:Be.Z.iconSize,width:Be.Z.iconSize,borderRadius:20}})),[]);return t?(0,z.jsx)(ns.Z,{userValue:t,size:Be.Z.iconSize,initialOverrideStyle:s?{borderStyle:"dashed"}:void 0}):(0,z.jsx)(ls,{style:i.iconPlaceholder})}function os(e){window.__c={n:"Title"};const{userValue:t,guestLabel:s,shouldShowPendingInvitation:i}=e,n=(0,r.useIntl)(),a=(0,o.yK)((()=>({titlePlaceholder:{height:8,width:81,borderRadius:3},pendingInvitation:{color:E.ZP.PendingInvitationTextColor}})),[]);if(!t)return(0,z.jsx)(ls,{style:a.titlePlaceholder});const l=(0,Kt.Nz)(n,t);return(0,z.jsx)(z.Fragment,{children:l?(0,z.jsxs)("div",{style:{display:"flex",gap:4},children:[(0,z.jsx)(A.Z,{className:"notranslate",style:i?a.pendingInvitation:void 0,children:l}),s&&(0,z.jsx)(is.b,{labelType:s})]}):(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Invitation sent",id:"blockPermissionsSettings.sentInvitation.message"})})}function rs(e){window.__c={n:"Subtitle"};const{userValue:t,shouldShowPendingInvitation:s}=e,i=(0,o.yK)((()=>({uiLabel:{display:"flex"},subtitlePlaceholder:{height:8,width:139,borderRadius:3,marginTop:10},dotSeparator:{marginLeft:2,marginRight:2},pendingInvitation:{color:E.ZP.PendingInvitationTextColor}})),[]);return null!=t&&t.email?s?(0,z.jsx)(A.Z,{isSmall:!0,style:i.pendingInvitation,children:(0,z.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.invitationSent",defaultMessage:"Pending Invitation"})}):(0,z.jsx)(A.Z,{isSmall:!0,children:t.email}):(0,z.jsx)(ls,{style:i.subtitlePlaceholder})}function ls(e){window.__c={n:"Placeholder"};const t=(0,o.yK)((t=>({placeholder:{...e.style,background:t.lightDividerColor}})),[e.style]);return(0,z.jsx)("div",{style:t.placeholder})}const ds=function(e){window.__c={n:"BlockUserPermissionItem"};const{store:t,userPermission:s,spaceVisibleUserMap:i,fromPermissionWrapper:n}=e,o=(0,a.VK)((()=>S.U6.createChildStore(t,{table:zt.KJ,id:s.permissionItem.user_id}).getValue()),[t,s.permissionItem.user_id]),r=(0,a.VK)((()=>{if(null!=o&&o.id)return Yt({spaceVisibleUserMap:i,userId:o.id,blockStore:t})}),[t,i,o]),l=(0,a.VK)((()=>!0!==(null==o?void 0:o.onboarding_completed)&&(0,gt.fJ)()),[o]);return(0,z.jsx)("div",{children:(0,z.jsx)(Be.Z,{currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,ignoreLocalHoverState:e.ignoreLocalHoverState,icon:(0,z.jsx)(as,{userValue:o,shouldShowPendingInvitation:l}),title:(0,z.jsx)(os,{userValue:o,guestLabel:r,shouldShowPendingInvitation:l}),subtitle:(0,z.jsx)(rs,{userValue:o,shouldShowPendingInvitation:l}),showInherited:e.showInherited,upgradeButtonName:"user_permission_item",isRemovableOverride:e.isRemovableOverride,fromPermissionWrapper:n,...e.permissionItemArgs})},s.permissionItem.user_id)};var cs=s(56666);function us(e){let{permissions:t}=e;window.__c={n:"ExpandablePermissionsList"};const[s,n]=(0,i.useState)(!1),a=(0,o.yK)((e=>({button:{display:s?"none":"inline-flex",padding:10,width:"100%"},icon:{width:14,transform:"rotate(90deg)",marginLeft:14,marginRight:18,fill:e.lightIconColor},list:{display:s?"block":"none"}})),[s]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(Ie.Z,{onClick:()=>n(!0),style:a.button,children:[(0,z.jsx)("div",{children:(0,cs.o)(a.icon)}),(0,z.jsx)(A.Z,{isSmall:!0,isSecondaryColor:!0,children:(0,z.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.expandButton",defaultMessage:"{count} more people",values:{count:t.length}})})]}),(0,z.jsx)("div",{style:a.list,children:t})]})}const ms=(0,W.I)("personBadgeQuestionMark",{viewBox:"0 0 15 14",svg:(0,z.jsx)("path",{d:"M12.4551 5.41699C12.8037 5.41699 13.0088 5.19824 13.0088 4.93164V4.84961C13.0088 4.45996 13.2344 4.2207 13.7061 3.90625C14.3691 3.46875 14.8408 3.07227 14.8408 2.25195C14.8408 1.11719 13.8291 0.501953 12.667 0.501953C11.498 0.501953 10.7256 1.0625 10.5342 1.69141C10.5 1.80078 10.4795 1.91016 10.4795 2.02637C10.4795 2.33398 10.7188 2.49805 10.9443 2.49805C11.1836 2.49805 11.3271 2.38867 11.4502 2.22461L11.5732 2.06055C11.8125 1.66406 12.1748 1.43164 12.626 1.43164C13.248 1.43164 13.6514 1.78711 13.6514 2.30664C13.6514 2.77148 13.3643 2.99707 12.7695 3.41406C12.2773 3.75586 11.915 4.11816 11.915 4.78809V4.87695C11.915 5.23242 12.1064 5.41699 12.4551 5.41699ZM5.79004 6.99609C7.25293 6.99609 8.52441 5.68359 8.52441 3.97461C8.52441 2.28613 7.25293 1.03516 5.79004 1.03516C4.32715 1.03516 3.05566 2.31348 3.05566 3.98828C3.05566 5.68359 4.32031 6.99609 5.79004 6.99609ZM12.4414 7.4541C12.8379 7.4541 13.1797 7.13965 13.1797 6.74316C13.1797 6.34668 12.8447 6.03223 12.4414 6.03223C12.0381 6.03223 11.7031 6.35352 11.7031 6.74316C11.7031 7.13281 12.0449 7.4541 12.4414 7.4541ZM1.20312 13.3262H10.3701C11.1016 13.3262 11.5391 12.9844 11.5391 12.417C11.5391 10.6533 9.33105 8.21973 5.7832 8.21973C2.24219 8.21973 0.0341797 10.6533 0.0341797 12.417C0.0341797 12.9844 0.47168 13.3262 1.20312 13.3262Z"})});const ps=function(e){window.__c={n:"MorePeoplePermissionItem"};const{store:t}=e,s=(0,o.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]),i={table:g.iU,blockId:t.id};return(0,z.jsx)(Be.Z,{icon:ms(s.icon),iconStyle:s.iconContainer,title:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"More people may have access",id:"blockPermissionsSettings.permissionItem.hiddenAccess"}),nonInheritedTooltip:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"This page may be shared with additional people through a parent page or teamspace that you don't have access to",id:"blockPermissionsSettings.hiddenAccess.tooltip"}),permissionRoleSelect:(0,z.jsx)(z.Fragment,{}),currentBlockStore:t,permissionItem:{type:"hidden_permission"},from:i,upgradeButtonName:"team_permission_item"})};var gs=s(76781),hs=s(38755),fs=s(84076),ys=s(93686),vs=s(61061),xs=s(44495),Ss=s(47307),bs=s(76464),Ms=s(39699),ws=s(18878);var js=s(55838),Cs=s(4023),ks=s(35817),_s=s(76798),Ts=s(62385);function Is(e){window.__c={n:"PermissionsRestoreBanner"};const{showRestoreButton:t,store:s,type:i,sudoModeStore:r}=e,{isMobile:l}=(0,n.Fy)(),d=(0,a.VK)((()=>y.uJ(s)[1]),[s]),c=(0,n.O7)(),u=(0,a.VK)((()=>({paddingLeft:c.WindowSizeStore.getSafePaddingLeftCSS(14),paddingRight:c.WindowSizeStore.getSafePaddingLeftCSS(14)})),[c]),m=(0,o.yK)((e=>({container:{display:"flex",minHeight:20,flexDirection:"row",alignItems:"center",paddingTop:8,paddingBottom:6,paddingLeft:u.paddingLeft,paddingRight:u.paddingRight},banner:{display:"flex",flexDirection:"row",width:"100%",fontSize:12},icon:{width:16,fill:e.mediumIconColor},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginRight:5},messageContainer:{display:"flex",flexDirection:"column"},label:{display:"inline",marginLeft:l?14:0,color:l?"#CF8807":e.mediumTextColor,fontWeight:l?G.Z.fontWeight.regular:G.Z.fontWeight.medium,marginRight:6,lineHeight:"20px"},buttonContainer:{marginLeft:-5},divider:{opacity:"75%"},mobileContainer:{borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:9,display:"flex",alignItems:"center",justifyContent:"space-between",backgroundColor:"rgba(246, 192, 80, 0.26)"}})),[l,u]);return l?(0,z.jsxs)("div",{style:m.mobileContainer,children:[(0,z.jsx)(A.Z,{isMultiline:!0,isSmall:!0,style:m.label,children:(0,z.jsx)(Fs,{type:i,navigableParentStore:d,showRestoreButton:t})}),t&&(0,z.jsx)(Ps,{store:s,type:i})]}):(0,z.jsx)("div",{style:m.container,children:(0,z.jsxs)("div",{style:m.banner,children:[(0,z.jsx)("div",{style:m.iconContainer,children:As[i](m.icon)}),(0,z.jsxs)("div",{children:[(0,z.jsx)(A.Z,{isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:m.label,children:(0,z.jsx)(Fs,{type:i,navigableParentStore:d,showRestoreButton:t})}),t&&(0,z.jsx)("span",{style:m.buttonContainer,children:(0,z.jsx)(Ps,{store:s,type:i,sudoModeStore:r})})]})]})})}function Ps(e){window.__c={n:"PermissionsRestoreButton"};const{type:t,store:s,sudoModeStore:i}=e,{isMobile:l}=(0,n.Fy)(),d=(0,a.VK)((()=>!!i&&i.shouldSaveTransactionWithSudoMode(s)),[s,i]),c=(0,o.yK)((e=>({button:{color:l?"#CF8807":e.regularTextColor,fontWeight:G.Z.fontWeight.medium},tooltip:{width:210,whiteSpace:"initial"}})),[l]),u=(0,n.O7)();if("restore-team"===t){const e=async()=>{await async function(e){const{environment:t,useSudoMode:s,store:i}=e,n={type:"restoreTeamPermissions",permissionChanges:[]};await Ss.confirmUserAction({message:(0,ws.mX)(n),acceptLabel:(0,ws.nH)(n),cancelLabel:(0,z.jsx)(r.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"})})&&Ms.createAndCommit({userAction:"PermissionsRestoreBanner.restoreTeamPermissions",environment:t,useSudoMode:s,perform:e=>{bs.Kh({environment:t,store:i,transaction:e})}})}({environment:u,useSudoMode:d,store:s})};return(0,z.jsx)(ve.Z,{style:c.tooltip,placement:Cs.u.Bottom,renderTooltip:()=>(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Reset page permissions to match default teamspace permissions",id:"permissionsRestoreBanner.tooltip.teamPermissions"}),render:t=>(0,z.jsx)("span",{...t,children:(0,z.jsx)(Ts.Z,{style:c.button,onClick:e,children:(0,z.jsx)(r.FormattedMessage,{id:"permissionsRestoreBanner.button.teamPermissions",defaultMessage:"Reset"})})})})}if("unrestrict"===t){const e=async()=>{const e=s.getPermissionItems(),t=y.Om(s),i=t?(0,m.Wo)(y.fJ(t)):[],n=(0,m.Xr)(e,i);await async function(e){const{environment:t,useSudoMode:s,store:i,permissionChanges:n}=e,a={type:"restore",permissionChanges:n};await Ss.confirmUserAction({message:(0,ws.mX)(a),acceptLabel:(0,ws.nH)(a),cancelLabel:(0,z.jsx)(r.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,z.jsx)(ws.mo,{openState:a})})&&(i.getPermissionItemsStore().canAdmin()?Ms.createAndCommit({userAction:"PermissionsRestoreBanner.restoreRestrictedPermissions",environment:t,useSudoMode:s,perform:e=>{bs.MX({environment:t,store:i,transaction:e})}}):bs.hs({environment:t,store:i}))}({environment:u,useSudoMode:d,store:s,permissionChanges:n})};return(0,z.jsx)(Ts.Z,{style:c.button,onClick:e,children:(0,z.jsx)(r.FormattedMessage,{id:"permissionsRestoreBanner.button.restrictedPermissions",defaultMessage:"Restore"})})}(0,R.t1)(t)}function Zs(e){window.__c={n:"ClickableAttribution"};const{navigableParentStore:t,maxLength:s,showUnderline:i}=e,{isMobile:r}=(0,n.Fy)(),l=(0,n.O7)(),d=(0,o.yK)((e=>({linkBox:{color:e.mediumTextColor},title:{display:"inline"}})),[]),c=(0,a.VK)((()=>{if(t instanceof S.G)return(0,he.ZP)({store:t,fullyQualified:!1,pageVisitSource:me.tY.LinkInPage})}),[t]);if(!t)return null;const u=r&&t.table===f.e0;return(0,z.jsx)(fs.Z,{disabled:u,style:u?void 0:d.linkBox,underline:i&&!u,inline:!0,onClick:t.table===f.e0?()=>{t.table===f.e0&&ks.RF({environment:l,teamId:t.id,tab:js.a.Members,from:"permission_item"})}:void 0,href:c,children:(0,z.jsx)(_s.Z,{shouldWrap:!0,maxLength:s,store:t,style:d.title})})}function Fs(e){window.__c={n:"PermissionsRestoreBannerLabel"};const{type:t,navigableParentStore:s,showRestoreButton:i}=e,{isMobile:a}=(0,n.Fy)(),o=(0,z.jsx)(Zs,{navigableParentStore:s,maxLength:a||!i?void 0:30,showUnderline:!0});switch(t){case"restore-team":return(0,z.jsx)(r.FormattedMessage,{id:"pageShareMenu.restoreTeamPermissionsBanner.label",defaultMessage:"Page access is different from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:o}});case"unrestrict":return a?(0,z.jsx)(r.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.mobileLabel",defaultMessage:"Page access is restricted to people below.",values:{linkBoxWithPageTitle:o}}):(0,z.jsx)(r.FormattedMessage,{id:"pageShareMenu.restrictedAccessBanner.label",defaultMessage:"Access restricted. May not be shared with everyone from {linkBoxWithPageTitle}.",values:{linkBoxWithPageTitle:o}});default:(0,R.t1)(t)}}const As={unrestrict:vs.B,"restore-team":xs.D},Ds=(0,r.defineMessages)({fullAccess:{id:"permissionsLevelBanner.fullAccess.label",defaultMessage:"You have full access to this page {hasAttribution, select, true {via {attribution}} other {}}"},editor:{id:"permissionsLevelBanner.editor.label",defaultMessage:"You have edit access to this page {hasAttribution, select, true {via {attribution}} other {}}"},contentEditor:{id:"permissionsLevelBanner.contentEditor.label",defaultMessage:"You have edit access to content on this page {hasAttribution, select, true {via {attribution}} other {}}"},commenter:{id:"permissionsLevelBanner.commenter.label",defaultMessage:"You have comment access to this page {hasAttribution, select, true {via {attribution}} other {}}"},reader:{id:"permissionsLevelBanner.reader.label",defaultMessage:"You have view access to this page {hasAttribution, select, true {via {attribution}} other {}}"}});function Bs(e){let{store:t}=e;window.__c={n:"PermissionLevelBanner"};const s=(0,n.O7)(),l=(0,a.VK)((()=>(0,Ee.B7)(s)),[s]),d=(0,a.VK)((()=>t.canEditContentOnly()),[t]),c=(0,o.yK)((e=>({container:{backgroundColor:e.accentColors.gray[50],borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:14,display:"flex",alignItems:"center"},banner:{fontSize:12,display:"inline-flex"},icon:{marginLeft:14,marginRight:8},attribution:{display:"inline-flex",alignItems:"center",fill:e.regularIconColor,marginLeft:5}})),[]),{role:u,attribution:m}=(0,a.VK)((()=>{if(!l)return{role:"none",attribution:null};const e=(0,v.Dt)({userId:l.id,store:t}),i=function(e){let{environment:t,calculatedPermission:s,store:i}=e;const n=(0,y.Pj)(i)||x.default.state.currentSpaceStore;if(!n)return null;if((0,p.hV)(s)){const e=(0,hs.TC)({spaceStore:n,groupId:s.group_id}),t=null==e?void 0:e.name;return t?(0,z.jsxs)(z.Fragment,{children:[(0,gs.x)({width:18,marginRight:5}),t]}):null}if((0,p.fG)(s)){var a;const e=s.team_id||(null===(a=(0,y.VP)(i))||void 0===a?void 0:a.id);if(!e)return null;const t=S.zX.createChildStore(n,{table:f.e0,id:e,spaceId:n.id});return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ys.p,{disabled:!0,store:t,size:18,style:{marginRight:5}}),(0,z.jsx)(Zs,{navigableParentStore:t,showUnderline:!0})]})}if((0,p.ix)(s))return(0,p.KF)(s)?(0,z.jsx)(r.FormattedMessage,{defaultMessage:"the link",id:"permissionsLevelBanner.spacePermission.attribution"}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ys.p,{disabled:!0,store:n,size:18,style:{marginRight:5}}),(0,hs.rn)(t,n)]});if((0,p.$D)(s))return(0,z.jsx)(fs.Z,{underline:!0,inline:!0,onClick:()=>{_.ZP.setState({..._.ZP.state,display:_.wV.Publish,tab:_.XF.Publish})},children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"the published site",id:"permissionsLevelBanner.publicPermission.attribution"})});return null}({environment:s,calculatedPermission:e,store:t});return{role:e.role,attribution:i}}),[l,t,s]);if((0,i.useEffect)((()=>{u&&we.hYM(s,{share_menu_session_id:_.ZP.state.sessionId,role:u})}),[]),!(0,p.iC)(u))return null;const g=function(e){switch(e){case"editor":return Ds.fullAccess;case"read_and_write":return Ds.editor;case"content_only_editor":return Ds.contentEditor;case"comment_only":return Ds.commenter;case"reader":return Ds.reader;case"none":case"membership_admin":return null;default:(0,R.t1)(e)}}(u);return g?(0,z.jsx)(ve.Z,{delayThreshold:0,renderTooltip:()=>(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Content editors can edit pages, but cannot change view and database settings.",id:"database.viewSettings.mainTab.contentOnlyEditorPill.subtitle"}),disableTooltip:!d,textWrap:!0,style:{maxWidth:180},render:e=>(0,z.jsxs)("div",{style:c.container,...e,children:[(0,z.jsx)(ns.Z,{userStore:l,size:20,style:c.icon}),(0,z.jsx)(A.Z,{style:c.banner,children:(0,z.jsx)(r.FormattedMessage,{...g,values:{hasAttribution:Boolean(m),attribution:(0,z.jsx)("span",{style:c.attribution,children:m})}})})]}),placement:ve.Z.Placement.Left}):null}function Rs(){return(0,z.jsx)(Ls,{children:(0,z.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.moreAttribution",defaultMessage:"More people with access"})})}function Ls(e){window.__c={n:"AttributionWrapper"};const{children:t}=e,{WindowSizeStore:s}=(0,n.O7)(),{paddingLeft:i,paddingRight:r}=(0,a.VK)((()=>({paddingLeft:s.getSafePaddingLeftCSS(14),paddingRight:s.getSafePaddingRightCSS(14)})),[s]),l=(0,o.yK)((e=>({label:{color:e.mediumTextColor,fontWeight:G.Z.fontWeight.medium,paddingLeft:i,paddingRight:r,paddingTop:8,paddingBottom:6}})),[i,r]);return(0,z.jsx)(A.Z,{isSmall:!0,style:l.label,children:t})}const Ns=function(e){window.__c={n:"PermissionsAttributionHeader"};const{store:t}=e,{parentStore:s,canAccessParent:i}=(0,a.VK)((()=>M({store:t})),[t]);return i?(0,z.jsx)(Ls,{children:(0,z.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.attribution",defaultMessage:"From {attribution}",values:{attribution:(0,z.jsx)(Zs,{navigableParentStore:s})}})}):(0,z.jsx)(Ls,{children:(0,z.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionsList.genericHeader",defaultMessage:"People with access"})})};var Es=s(19037);function Os(e){window.__c={n:"RestrictedBanner"};const{store:t}=e,s=(0,n.O7)(),i=(0,a.VK)((()=>function(e){const{store:t,environment:s}=e;return Es.or([Es.zz,Es.xD([Es.c2,Es.ff(Es.zz)])])({environment:s,blocks:[t],publicEditMode:void 0})}({store:t,environment:s})),[t,s]);return(0,z.jsx)(Is,{type:"unrestrict",showRestoreButton:i,store:t,sudoModeStore:e.sudoModeStore})}function Vs(e){window.__c={n:"ElevatedBanner"};const{store:t}=e;return(0,a.VK)((()=>b({store:t})),[t])?(0,z.jsx)(Is,{type:"restore-team",showRestoreButton:!1,store:t,sudoModeStore:e.sudoModeStore}):null}const Us=function(e){window.__c={n:"PermissionsWarningBanner"};const{store:t,showRestrictedPermissionBanner:s}=e,{canAccessParent:i}=(0,a.VK)((()=>M({store:t})),[t]);return i?s?(0,z.jsx)(Os,{store:t,sudoModeStore:e.sudoModeStore}):(0,z.jsx)(Vs,{store:t,sudoModeStore:e.sudoModeStore}):null};var Ws=s(16880),zs=s(27714),Ks=s(16184);const Hs=(0,W.I)("openPage",{viewBox:"0 0 17 16",svg:(0,z.jsx)("path",{d:"M0.454102 14.1143V2.02832C0.454102 1.26953 0.891602 0.78418 1.58887 0.78418H9.7373C10.4346 0.78418 10.8721 1.26953 10.8721 2.02832V14.1143C10.8721 14.873 10.4346 15.3584 9.7373 15.3584H1.58887C0.891602 15.3584 0.454102 14.873 0.454102 14.1143ZM3.07227 4.45508C3.07227 4.63281 3.18164 4.74902 3.35254 4.74902H4.71973C4.89062 4.74902 5.01367 4.63281 5.01367 4.45508V3.12891C5.01367 2.95801 4.89062 2.83496 4.71973 2.83496H3.35254C3.18164 2.83496 3.07227 2.95801 3.07227 3.12891V4.45508ZM6.37402 4.45508C6.37402 4.63281 6.4834 4.74902 6.66113 4.74902H8.02148C8.19238 4.74902 8.31543 4.63281 8.31543 4.45508V3.12891C8.31543 2.95801 8.19238 2.83496 8.02148 2.83496H6.66113C6.4834 2.83496 6.37402 2.95801 6.37402 3.12891V4.45508ZM11.4736 15.3584C11.6992 14.9893 11.8086 14.5723 11.8086 14.1143V4.14746H15.418C16.1084 4.14746 16.5459 4.63281 16.5459 5.3916V14.1143C16.5459 14.873 16.1084 15.3584 15.418 15.3584H11.4736ZM3.07227 7.24414C3.07227 7.42188 3.18164 7.53809 3.35254 7.53809H4.71973C4.89062 7.53809 5.01367 7.42188 5.01367 7.24414V5.91797C5.01367 5.74707 4.89062 5.62402 4.71973 5.62402H3.35254C3.18164 5.62402 3.07227 5.74707 3.07227 5.91797V7.24414ZM6.37402 7.24414C6.37402 7.42188 6.4834 7.53809 6.66113 7.53809H8.02148C8.19238 7.53809 8.31543 7.42188 8.31543 7.24414V5.91797C8.31543 5.74707 8.19238 5.62402 8.02148 5.62402H6.66113C6.4834 5.62402 6.37402 5.74707 6.37402 5.91797V7.24414ZM13.3604 7.60645C13.3604 7.75 13.4492 7.85254 13.5996 7.85254H14.7344C14.8779 7.85254 14.9736 7.75 14.9736 7.60645V6.5127C14.9736 6.36914 14.8779 6.27344 14.7344 6.27344H13.5996C13.4492 6.27344 13.3604 6.36914 13.3604 6.5127V7.60645ZM3.07227 10.0332C3.07227 10.2041 3.18164 10.3271 3.35254 10.3271H4.71973C4.89062 10.3271 5.01367 10.2041 5.01367 10.0332V8.70703C5.01367 8.5293 4.89062 8.41309 4.71973 8.41309H3.35254C3.18164 8.41309 3.07227 8.5293 3.07227 8.70703V10.0332ZM6.37402 10.0332C6.37402 10.2041 6.4834 10.3271 6.66113 10.3271H8.02148C8.19238 10.3271 8.31543 10.2041 8.31543 10.0332V8.70703C8.31543 8.5293 8.19238 8.41309 8.02148 8.41309H6.66113C6.4834 8.41309 6.37402 8.5293 6.37402 8.70703V10.0332ZM13.3604 10.2998C13.3604 10.4434 13.4492 10.5391 13.5996 10.5391H14.7344C14.8779 10.5391 14.9736 10.4434 14.9736 10.2998V9.20605C14.9736 9.0625 14.8779 8.9668 14.7344 8.9668H13.5996C13.4492 8.9668 13.3604 9.0625 13.3604 9.20605V10.2998ZM3.29785 14.2578H8.08984V12.0361C8.08984 11.7217 7.88477 11.5166 7.57031 11.5166H3.81738C3.50293 11.5166 3.29785 11.7217 3.29785 12.0361V14.2578ZM13.3604 12.9932C13.3604 13.1367 13.4492 13.2324 13.5996 13.2324H14.7344C14.8779 13.2324 14.9736 13.1367 14.9736 12.9932V11.8994C14.9736 11.7559 14.8779 11.6533 14.7344 11.6533H13.5996C13.4492 11.6533 13.3604 11.7559 13.3604 11.8994V12.9932Z"})});var Gs=s(98519);function qs(){const e=(0,n.O7)(),{currentSpaceStore:t}=(0,a.Kw)(x.default);return(0,a.VK)((()=>t?(0,hs.rn)(e,t):""),[e,t])}var Ys=s(23063);const Qs=[{key:"private",title:()=>(0,z.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.inviteOnly",defaultMessage:"Invite only"}),caption:(0,z.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.inviteOnly",defaultMessage:"Only you and people invited can access"}),icon:Ks.Q},{key:"unlisted",title:e=>(0,z.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.anyoneWithLink",defaultMessage:"Anyone with link at {spaceName}",values:{spaceName:e}}),caption:(0,z.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.anyoneWithLink",defaultMessage:"People invited and workspace members with link can access"}),icon:zs.N},{key:"open",title:e=>(0,z.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityTitle.everyoneInWorkspace",defaultMessage:"Everyone at {spaceName}",values:{spaceName:e}}),caption:(0,z.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityCaption.everyoneInWorkspace",defaultMessage:"All workspace members can search and access"}),icon:Hs}];function $s(e){window.__c={n:"MobileLinkSharingPill"};const{store:t,spacePermission:s}=e,n=Js(s.permissionItem),l=(0,a.VK)((()=>t.canAdmin()),[t]),d=qs(),c=(0,a.VK)((()=>{const e=x.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),[u,m]=(0,i.useState)(!1),p=(0,o.yK)((e=>({chevron:{width:12,fill:e.mediumIconColor,marginLeft:"auto"},button:{height:42,color:e.mediumTextColor,marginBottom:8,padding:"0 6px",marginLeft:-6,marginRight:-6,width:"100%"},icon:{fill:e.regularIconColor,width:32,height:32,backgroundColor:e.lightDividerColor,padding:6,borderRadius:4,marginRight:12},animation:{maxHeight:220},enterAnimation:{maxHeight:0},exitAnimation:{maxHeight:0},container:{overflow:"hidden"}})),[]),g=Qs.find((e=>e.key===n));return g&&c?(0,z.jsxs)("div",{style:p.container,children:[(0,z.jsxs)(Ze.Z,{style:p.button,icon:g.icon,iconStyle:p.icon,disabled:!l,disabledFeedback:!0,onClick:()=>m(!u),children:[(0,z.jsxs)("div",{children:[(0,z.jsx)(A.Z,{isSmall:!0,children:(0,z.jsx)(r.FormattedMessage,{id:"linkSharingPill.visibilityMobileTitle",defaultMessage:"Page visibility"})}),(0,z.jsx)(A.Z,{children:g.title(d)})]}),l&&(u?(0,be.i)(p.chevron):(0,Ws.R)(p.chevron))]}),(0,z.jsx)(Ys.Z,{isVisible:u,animationStyle:p.animation,enterAnimationStyle:p.enterAnimation,exitAnimationStyle:p.exitAnimation,springConfig:{maxHeight:{stiffness:60,damping:12,precision:.1}},render:()=>(0,z.jsx)(Xs,{...e,parentCloseCallback:()=>m(!1)})})]}):null}function Xs(e){window.__c={n:"PrivacyMenu"};const{store:t,spacePermission:s,sudoModeStore:r,location:l,isRestricted:c,parentCloseCallback:u}=e,f=(0,n.O7)(),v=f.device.isMobile,S=Js(s.permissionItem),b=(0,a.VK)((()=>(0,gt.C$)()),[]),M=s.from,w=M.table===g.iU?M.blockId:M.teamId,j=!(M.table===t.table&&w===t.id),C=(0,a.VK)((()=>{const{currentSpaceStore:e}=x.default.state;return!!e&&t.isTopLevelWorkspacePage(e.id)}),[t]),k=qs(),_=(0,a.VK)((()=>{const e=function(e){const{store:t}=e;if(t.getParentTable()===h.bx)return;const s=(0,y.Om)(t);if(!s)return;const i=(0,m.Wo)((0,y.fJ)(s));for(const n of i)if((0,p.ix)(n))return n}({store:t});return e?Js(e):"private"}),[t]),T=(0,i.useRef)(null),I=(0,o.yK)((e=>{const t={width:14,fill:v?e.regularIconColor:e.mediumTextColor};return{icon:{fill:v?e.regularIconColor:e.mediumTextColor,width:16},iconContainer:{alignSelf:"center",marginLeft:v?13:9},hiddencheckmark:{...t,visibility:"hidden"},selectedCheckmark:{...t,visibility:"visible"},checkmarkContainer:{marginLeft:12},selectedTitle:{fontWeight:G.Z.fontWeight.semibold},mobileScroller:{border:`1px solid ${e.regularDividerColor}`,borderRadius:8,marginBottom:24},mobileButton:{paddingTop:8,paddingBottom:8},mobileButtonDivider:{borderBottom:`1px solid ${e.regularDividerColor}`},caption:{whiteSpace:"normal"}}}),[v]);return(0,z.jsx)(Z.Z,{menuType:d.og.Popup,disableScroller:!0,scrollerStyle:v?I.mobileScroller:{},children:(0,z.jsx)(ze.Z,{type:ze.i.Vertical,initialFocus:void 0,sections:[{key:"visibilityOptions",render:e=>(0,z.jsx)(Ke.Z,{...e,disableDesktopPadding:v}),items:Qs.map(((e,i)=>{const n=e.key,a=S===n,o=a?I.selectedCheckmark:I.hiddencheckmark,d=i!==Qs.length-1,m={...v?I.mobileButton:{},...v&&d?I.mobileButtonDivider:{}};return{key:n,render:t=>(0,z.jsxs)("div",{children:["unlisted"===n&&(0,z.jsx)("div",{ref:T,children:(0,z.jsx)(X.C8,{originRef:T})}),(0,z.jsx)(Ue.Z,{title:e.title(k),caption:(0,z.jsx)(A.Z,{isSmall:!0,isMultiline:!0,style:I.caption,children:e.caption}),icon:e.icon(I.icon),desktopIconStyle:I.iconContainer,titleStyle:a&&!v?I.selectedTitle:void 0,right:(0,Gs.k)(o),rightStyle:I.checkmarkContainer,style:m,...t})]}),action:()=>{if(a)return;const e=s.permissionItem,i={type:"space_permission",role:ei(e,S,n,b)};"unlisted"===n&&(i.unlisted_timestamp=Date.now());const o=function(e,t){if(e===t)return!1;switch(t){case"open":return!1;case"unlisted":return"open"===e;case"private":return!0;default:(0,R.t1)(t)}}(_,n)&&!c&&!C;(0,re.i)({oldPermissionItem:e,newPermissionItem:i,wasInherited:j,environment:f,store:t,sudoModeStore:r,location:l,restrictingVisibility:o}),u()}}}))}]})})}function Js(e){return"none"===e.role?"private":e.unlisted_timestamp?"unlisted":"open"}function ei(e,t,s,i){return"private"===s?"none":"private"===t?i?"editor":"reader":e.role}const ti=function(e){window.__c={n:"LinkSharingPill"};const{store:t,spacePermission:s}=e,n=Js(s.permissionItem),l=(0,a.VK)((()=>t.canAdmin()),[t]),d=qs(),c=(0,a.VK)((()=>{const e=x.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),u=(0,a.qz)(void 0,Oe.Z),m=(0,i.useRef)(null),p=(0,o.yK)((e=>({chevron:{width:12,marginLeft:4,fill:e.mediumIconColor},popup:{overflow:"visible",width:"100%",minWidth:430},button:{justifyContent:"center",borderRadius:32,height:32,color:e.mediumTextColor,paddingLeft:12,maxWidth:380},title:{...G.Z.textOverflowStyle},icon:{fill:e.mediumTextColor,width:16}})),[]);return c?(0,z.jsx)(We.ZP,{buttonPopupStore:u,popupType:We.Z4.Popup,popupWrapStyle:p.popup,renderOrigin:e=>{const t=Qs.find((e=>e.key===n));return t?(0,z.jsx)(ve.Z,{placement:ve.Z.Placement.Bottom,alignment:ve.Z.Alignment.Start,disableTooltip:l,renderTooltip:()=>(0,z.jsx)(r.FormattedMessage,{defaultMessage:"You must have full access to change the privacy setting",id:"linkSharingPill.disabledTooltip.message"}),render:s=>(0,z.jsxs)(ye.Z,{...e,ref:m,style:p.button,icon:t.icon,iconStyle:p.icon,disabled:!l,disabledFeedback:!0,...s,children:[(0,z.jsx)("div",{style:p.title,children:t.title(d)}),l&&(0,be.i)(p.chevron),(0,z.jsx)(X.iq,{originRef:m,handlePrimaryButtonClick:()=>{u.setState({...u.state,open:!0})}})]})}):null},placementToOrigin:Ve.Iw.Bottom,alignmentToOrigin:Ve.lU.Start,sameWidthAsOrigin:!0,render:t=>(0,z.jsx)(Xs,{...e,parentCloseCallback:()=>t.close()})}):null};var si=s(32739),ii=s(95477);function ni(e){window.__c={n:"MobilePageLinkButtonInner"};const{store:t,buttonPopupStore:s,events:i}=e,a=(0,n.O7)(),{device:l,mobileNative:d}=a,c=(0,o.yK)((e=>({button:{flex:1,height:36,minHeight:36}})),[]);return(0,z.jsx)(le.Z,{onClick:()=>{l.isMobileNative?function(e){const{store:t,mobileNative:s}=e,i=(0,si.u5)({schemeUrl:(0,he.ZP)({store:t,pageVisitSource:me.tY.CopyLink}),baseUrl:ii.default.domainBaseUrl});s&&s.share(i)}({store:t,mobileNative:d}):ri({store:t,buttonPopupStore:s,environment:a}),we.V5j(a)},style:c.button,...i,children:l.isMobileNative?(0,z.jsx)(r.FormattedMessage,{id:"pageShareMenu.shareLinkButton.label",defaultMessage:"Share link"}):(0,z.jsx)(r.FormattedMessage,{id:"pageShareMenu.copyLinkButton.label",defaultMessage:"Copy link"})})}function ai(e){window.__c={n:"PageLinkButtonInner"};const{store:t,buttonPopupStore:s,events:i}=e,a=(0,n.O7)(),l=(0,o.yK)((e=>({button:{height:24,paddingLeft:8,paddingRight:8,color:e.regularTextColor,marginLeft:"auto"},icon:{width:14,height:14,fill:e.regularIconColor,marginLeft:0,marginRight:6},label:{color:e.regularTextColor}})),[]);return(0,z.jsxs)(Ze.Z,{isSmall:!0,onClick:()=>{ri({store:t,buttonPopupStore:s,environment:a}),we.V5j(a)},style:l.button,...i,children:[(0,zs.N)(l.icon),(0,z.jsx)(A.Z,{isSmall:!0,style:l.label,children:(0,z.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.copyLinkButton.label",defaultMessage:"Copy link"})})]})}function oi(e){const{calculatedPermissions:t}=e,s=t.mostPermissivePublicItem.permissionItem;if((0,p.YX)(s.role))return(0,z.jsx)(r.FormattedMessage,{defaultMessage:"This page has public link access, so anyone with the link will be able to view the page.",id:"blockPermissionsSettings.publicLinkInfo.tooltip"});const i=t.mostPermissiveSpaceItem.permissionItem;return(0,p.YX)(i.role)?(0,z.jsx)(r.FormattedMessage,{defaultMessage:"This page has workspace access, so anyone in the workspace will be able to view the link.",id:"blockPermissionsSettings.workspacePermissions.tooltip"}):t.permissionItemsCount>1?(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Only you and other invited members and guests will be able to view the link.",id:"blockPermissionsSettings.userPermissions.tooltip"}):(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Only you can access this page, so the link will only work for you.",id:"blockPermissionsSettings.privatePermissions.tooltip"})}async function ri(e){const{store:t,buttonPopupStore:s,environment:i}=e,n=(0,he.ZP)({store:t,pageVisitSource:me.tY.CopyLink});await je.RD({environment:i,stringValue:n,copiedMessage:je.tq.copiedLinkToClipboard}),s&&s.setState({open:!1})}const li=function(e){window.__c={n:"PageLinkButton"};const{store:t,buttonPopupStore:s,calculatedPermissions:i}=e,{device:a}=(0,n.O7)(),r=(0,o.yK)((()=>({tooltip:{width:280}})),[]);return(0,z.jsx)(ve.Z,{delayThreshold:0,placement:ve.Z.Placement.Bottom,renderTooltip:()=>(0,z.jsx)(oi,{calculatedPermissions:i}),textWrap:!0,style:r.tooltip,render:e=>a.isMobile?(0,z.jsx)(ni,{store:t,buttonPopupStore:s,events:e}):(0,z.jsx)(ai,{store:t,buttonPopupStore:s,events:e})})};const di=function(e){window.__c={n:"ShareMenuFooter"};const{isMobile:t}=(0,n.Fy)(),s=(0,o.yK)((e=>({container:{display:"flex",alignItems:t?"normal":"center",boxShadow:`0 -1px 0 ${e.regularDividerColor}`,flexDirection:t?"column":"row",justifyContent:"space-between",padding:"8px 14px"}})),[t]),{mostPermissiveSpaceItem:i,showRestrictedPermissionBanner:a}=e.calculatedPermissions;return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)("div",{style:s.container,children:[t?(0,z.jsx)($s,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:i,isRestricted:a}):(0,z.jsx)(ti,{store:e.store,sudoModeStore:e.permissionItemArgs.sudoModeStore,location:e.permissionItemArgs.location,spacePermission:i,isRestricted:a}),(0,z.jsx)(li,{store:e.store,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:e.calculatedPermissions})]})})};var ci=s(90965);function ui(e){window.__c={n:"UnlistedPermissionItem"};const{store:t,spacePermission:s,fromPermissionWrapper:i}=e,n=(0,o.yK)((e=>({icon:{width:17,height:17,fill:e.mediumIconColor},iconContainer:{backgroundColor:e.lightDividerColor,borderRadius:32}})),[]);return(0,z.jsx)(Be.Z,{icon:(0,zs.N)(n.icon),iconStyle:n.iconContainer,title:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Members with the link",id:"blockPermissionsSettings.permissionItem.linkAccess"}),currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,upgradeButtonName:"space_permission_item",fromPermissionWrapper:i,...e.permissionItemArgs})}function mi(e){window.__c={n:"Title"};const{spaceStore:t}=e,s=(0,n.O7)(),i=(0,a.VK)((()=>(0,hs.rn)(s,t)),[s,t]);return(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at {workspaceName}",id:"blockPermissionsSettings.permissionItem.workspaceAccessNew",values:{workspaceName:i}})}function pi(e){window.__c={n:"Subtitle"};const{spaceStore:t}=e,s=(0,a.VK)((()=>(0,ci.t5)((0,hs.jv)(t))),[t]);return(0,z.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} person} other {{numberOfWorkspaceMembers} people}}",id:"blockPermissionsSettings.spacePermission.none",values:{numberOfWorkspaceMembers:s}})}function gi(){return(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all members in your workspace.",id:"blockPermissionsSettings.spacePermission.tooltip"})}const hi=function(e){window.__c={n:"SpacePermissionItem"};const{store:t,spacePermission:s,fromPermissionWrapper:i}=e,n=(0,a.VK)((()=>{const e=x.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e:null}),[]),r=(0,o.yK)((()=>({container:{width:"100%"}})),[]);return n?s.permissionItem.unlisted_timestamp?(0,z.jsx)(ui,{...e}):(0,z.jsx)("div",{style:r.container,className:l.afv,children:(0,z.jsx)(Be.Z,{currentBlockStore:t,permissionItem:s.permissionItem,from:s.from,icon:(0,z.jsx)(ys.p,{disabled:!0,store:n,size:Be.Z.iconSize}),title:(0,z.jsx)(mi,{spaceStore:n}),nonInheritedTooltip:(0,z.jsx)(gi,{}),subtitle:(0,z.jsx)(pi,{spaceStore:n}),upgradeButtonName:"space_permission_item",fromPermissionWrapper:i,...e.permissionItemArgs})}):null};var fi=s(79362),yi=s(91192),vi=s(95697);function xi(e){const{teamName:t,isCompact:s}=e;return s?(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests",id:"blockPermissionsSettings.permissionItem.teamGuestAccess.compact"}):t?(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace guests of {teamName}",id:"blockPermissionsSettings.permissionItem.teamGuestAccess",values:{teamName:t}}):(0,z.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.teamspaceGuestsTeamName.hidden",defaultMessage:"Teamspace guests of a private teamspace"})}function Si(e){const{membersCount:t,isCompact:s}=e;return s?null:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}function bi(e){window.__c={n:"TeamGuestPermissionTooltip"};const{teamName:t}=e,s=(0,o.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,z.jsx)("div",{style:s.tooltip,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all teamspace guests of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamGuestPermission.tooltip"})}):null}const Mi=function(e){var t;window.__c={n:"TeamGuestPermissionItem"};const{store:s,blockTeamGuestPermission:i,isExternalTeam:n,fromPermissionWrapper:r}=e,{permissionItem:d}=i,c=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),u=p.bm(d)?d.team_id:null===(t=y.VP(s))||void 0===t?void 0:t.id,{teamStore:m,teamIsDefined:g,teamName:h,teamIcon:v,membersCount:b}=(0,a.VK)((()=>{if(!c||!u)return{};const e=S.zX.createChildStore(c,{table:f.e0,id:u,spaceId:c.id});return null!=e&&e.isDefined()?{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:e.getName(),teamIcon:e.getIcon(),membersCount:(0,vi.xf)({teamStore:e,spaceStore:c}).length}:{}}),[c,u]),M=!n,w=(0,o.yK)((()=>({container:{width:"100%"}})),[]);if(!m)return null;const j=v&&fi.V2(v.icon)?fi.mk(v.icon):"gray",C=v?{...v,icon:`/icons/user-circle_${j}.svg`}:void 0;return(0,z.jsx)("div",{style:w.container,className:l.YHn,children:(0,z.jsx)(Be.Z,{isCompact:M,currentBlockStore:s,permissionItem:d,icon:g?(0,z.jsx)(ys.p,{disabled:!0,store:m,size:Be.Z.iconSize,icon:C}):(0,yi.x)(),title:(0,z.jsx)(xi,{teamName:h,isCompact:M}),nonInheritedTooltip:(0,z.jsx)(bi,{teamName:h}),from:i.from,subtitle:g&&(0,z.jsx)(Si,{membersCount:b,isCompact:M}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:r,...e.permissionItemArgs})})};function wi(e){const{teamName:t,isCompact:s}=e;return s&&t?(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace members",id:"blockPermissionsSettings.permissionItem.teamAccessV2"}):t?(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Members of {teamName}",id:"blockPermissionsSettings.permissionItem.teamAccess",values:{teamName:t}}):(0,z.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.membersTeamName.hidden",defaultMessage:"Members of a private teamspace"})}function ji(e){const{membersCount:t,isCompact:s}=e;return s?null:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}function Ci(e){window.__c={n:"TeamMemberPermissionTooltip"};const{teamName:t}=e,s=(0,o.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,z.jsx)("div",{style:s.tooltip,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all owners and members of {teamName}.",values:{teamName:t},id:"blockPermissionsSettings.teamPermission.tooltip"})}):null}const ki=function(e){var t;window.__c={n:"TeamMemberPermissionItem"};const{store:s,blockTeamPermission:i,isExternalTeam:n,fromPermissionWrapper:r}=e,{permissionItem:d}=i,c=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),u=p.zU(d)?d.team_id:null===(t=y.VP(s))||void 0===t?void 0:t.id,{teamStore:m,teamIsDefined:g,teamName:h,membersCount:v}=(0,a.VK)((()=>{if(!c||!u)return{};const e=S.zX.createChildStore(c,{table:f.e0,id:u,spaceId:c.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName(),membersCount:(0,vi.xf)({teamStore:e,spaceStore:c}).length}}),[c,u]),b=!n,M=(0,o.yK)((()=>({container:{width:"100%"}})),[]);return m?(0,z.jsx)("div",{style:M.container,className:l.YHn,children:(0,z.jsx)(Be.Z,{isCompact:b,currentBlockStore:s,permissionItem:i.permissionItem,from:i.from,icon:g?(0,z.jsx)(ys.p,{disabled:!0,store:m,size:Be.Z.iconSize}):(0,yi.x)(),title:(0,z.jsx)(wi,{teamName:h,isCompact:b}),nonInheritedTooltip:(0,z.jsx)(Ci,{teamName:h}),subtitle:g&&(0,z.jsx)(ji,{membersCount:v,isCompact:b}),upgradeButtonName:"team_permission_item",fromPermissionWrapper:r,...e.permissionItemArgs})}):null};var _i=s(62512);function Ti(e){const{store:t,teamOwners:s,teamStore:i,teamName:n}=e;if(n){const e=s.map((e=>S.U6.createChildStore(t,{table:zt.KJ,id:e})));return(0,z.jsx)(_i.n,{teamStore:i,ownerStores:e})}return(0,yi.x)()}function Ii(e){const{teamName:t,isCompact:s}=e;return s&&t?(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Teamspace owners",id:"blockPermissionsSettings.permissionItem.teamOwnerAccessV2",values:{teamName:t}}):t?(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Owners of {teamName}",id:"blockPermissionsSettings.permissionItem.teamOwnerAccess",values:{teamName:t}}):(0,z.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.permissionItem.teamName.hidden",defaultMessage:"Owners of a private teamspace"})}function Pi(e){const{teamOwnersCount:t,isCompact:s}=e;return s||0===t?null:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"{teamOwnersCount, plural, one {{teamOwnersCount} person} other {{teamOwnersCount} people}}",id:"blockPermissionsSettings.teamOwnerPermission.subtitle",values:{teamOwnersCount:t}})}function Zi(e){window.__c={n:"TeamOwnerPermissionTooltip"};const{teamName:t}=e,s=(0,o.yK)((()=>({tooltip:{whiteSpace:"normal",maxWidth:240}})),[]);return t?(0,z.jsx)("div",{style:s.tooltip,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Applies to all owners of {teamName}",values:{teamName:t},id:"blockPermissionsSettings.teamOwnerPermission.tooltip"})}):null}const Fi=function(e){var t;window.__c={n:"TeamOwnerPermissionItem"};const{store:s,blockTeamOwnerPermission:i,isExternalTeam:n,fromPermissionWrapper:r}=e,{permissionItem:d}=i,c=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),u=p.LW(d)?d.team_id:null===(t=y.VP(s))||void 0===t?void 0:t.id,{teamStore:m,teamName:g,teamOwners:h}=(0,a.VK)((()=>{if(!c||!u)return{undefined:void 0};const e=S.zX.createChildStore(c,{table:f.e0,id:u,spaceId:c.id});return{teamStore:e,teamName:e.getName(),teamOwners:(0,Gt.XO)({membership:e.getMembers()})}}),[c,u]),v=!n,b=(0,o.yK)((()=>({container:{width:"100%"}})),[]);return m?(0,z.jsx)("div",{style:b.container,className:l.ZmO,children:(0,z.jsx)(Be.Z,{isCompact:v,currentBlockStore:s,permissionItem:i.permissionItem,from:i.from,icon:(0,z.jsx)(Ti,{store:s,teamName:g,teamStore:m,teamOwners:h}),title:(0,z.jsx)(Ii,{teamName:g,isCompact:v}),nonInheritedTooltip:(0,z.jsx)(Zi,{teamName:g}),subtitle:(0,z.jsx)(Pi,{teamOwnersCount:h.length,isCompact:v}),upgradeButtonName:"team_owner_permission_item",fromPermissionWrapper:r,...e.permissionItemArgs})}):null},Ai=(0,W.I)("expandThin",{viewBox:"0 0 16 16",svg:(0,z.jsx)("path",{d:"M7.992.61c.156 0 .3.033.43.1.13.069.27.16.422.274l5.265 4.25a.948.948 0 01.368.774 1 1 0 01-.149.547c-.099.156-.229.28-.39.375a1.013 1.013 0 01-.508.133 1.07 1.07 0 01-.399-.079 1.6 1.6 0 01-.375-.226L7.992 3.016 3.336 6.758a1.74 1.74 0 01-.383.226 1.056 1.056 0 01-.906-.055 1.145 1.145 0 01-.383-.374 1 1 0 01-.148-.547c0-.318.122-.576.367-.774L7.148.984C7.3.87 7.44.78 7.57.711a.9.9 0 01.422-.102zm0 14.85a.901.901 0 01-.422-.1 2.288 2.288 0 01-.422-.274l-5.265-4.25a.962.962 0 01-.367-.774 1.055 1.055 0 01.531-.914 1.01 1.01 0 01.906-.062c.125.052.253.128.383.226l4.656 3.743 4.664-3.742a1.6 1.6 0 01.375-.227c.13-.052.263-.078.399-.078a.97.97 0 01.508.14 1.036 1.036 0 01.539.915c0 .312-.123.57-.368.773l-5.265 4.258a2.512 2.512 0 01-.422.265.917.917 0 01-.43.102z"})});var Di=s(43914),Bi=s(33241);function Ri(e){const{teamName:t}=e;return t?(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at {teamName}",id:"blockPermissionsSettings.permissionItem.teamspaceAccess",values:{teamName:t??""}}):(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Everyone at a private teamspace",id:"blockPermissionsSettings.permissionItem.teamspace.hidden"})}function Li(e){const{membersCount:t}=e;return(0,z.jsx)(r.FormattedMessage,{defaultMessage:"{membersCount, plural, one {{membersCount} person} other {{membersCount} people}}",id:"blockPermissionsSettings.teamPermission.subtitle",values:{membersCount:t}})}const Ni=function(e){var t;window.__c={n:"TeamPermissionItem"};const{store:s,blockTeamMemberPermission:r,blockTeamOwnerPermission:l,blockTeamGuestPermission:d}=e,c=(0,n.O7)(),u=(0,n.Fy)(),[m,h]=(0,i.useState)(!1),{permissionItem:v}=r,b=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),M=p.zU(v)?v.team_id:null===(t=y.VP(s))||void 0===t?void 0:t.id,w=l.permissionItem.role,j=v.role,C={type:"team_overview_permission",role:w===j?j:"none"===j||"none"===w?"limited":"access"},{teamStore:k,teamIsDefined:T,teamName:I}=(0,a.VK)((()=>{if(!b||!M)return{undefined:void 0};const e=S.zX.createChildStore(b,{table:f.e0,id:M,spaceId:b.id});return{teamStore:e,teamIsDefined:null==e?void 0:e.isDefined(),teamName:null==e?void 0:e.getName()}}),[b,M]),P=(0,Di.K)(k),Z=(0,a.VK)((()=>{if(!b)return!1;return!b.getDisableTeamGuests()&&((null==k||!k.isDefault())&&(0,gt.F$)())}),[b,k]),F=(0,i.useCallback)((()=>{const e=!1===m;if(h(!m),e){if(!k)return;we.dSV(c,{share_menu_session_id:_.ZP.state.sessionId,type:"team",team_id:k.id})}}),[c,m,h,k]),A=(0,o.yK)((e=>({icon:{width:10,marginLeft:4,fill:e.lightIconColor},teamPermissionsContainer:{paddingLeft:16,display:m?"block":"none"},roleButton:{marginRight:-8,color:e.mediumTextColor,fontSize:u.isMobile?14:12}})),[m,u.isMobile]),D=(0,Ws.R)(A.icon);return k?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Be.Z,{currentBlockStore:s,permissionItem:C,from:r.from,icon:T?(0,z.jsx)(ys.p,{disabled:!0,store:k,size:Be.Z.iconSize}):(0,yi.x)(),title:(0,z.jsx)(Ri,{teamName:I}),subtitle:T&&(0,z.jsx)(Li,{membersCount:P}),upgradeButtonName:"team_permission_item",onClick:F,permissionRoleSelect:m?D:(0,z.jsx)(Bi.d,{role:C.role,icon:Ai,disabled:!0,buttonStyle:A.roleButton,table:g.iU,isRemovable:!1,isCurrentUser:!1}),...e.permissionItemArgs}),(0,z.jsxs)("div",{style:A.teamPermissionsContainer,children:[l&&(0,z.jsx)(Fi,{store:s,permissionItemArgs:e.permissionItemArgs,blockTeamOwnerPermission:l,fromPermissionWrapper:"expandable_permission"}),r&&(0,z.jsx)(ki,{store:s,permissionItemArgs:e.permissionItemArgs,blockTeamPermission:r,fromPermissionWrapper:"expandable_permission"}),Z&&d&&(0,z.jsx)(Mi,{store:s,permissionItemArgs:e.permissionItemArgs,blockTeamGuestPermission:d,fromPermissionWrapper:"expandable_permission"})]})]}):null};function Ei(e){const{store:t,permissionItemArgs:s}=e,{showTeamPermission:i,showSpacePermission:n,mostPermissiveAncestorTeamOwnerItem:a,mostPermissiveAncestorTeamMemberItem:o,mostPermissiveAncestorTeamGuestItem:r,mostPermissiveSpaceItem:l,pagePermissionUIModel:d}=e.calculatedPermissions,c=Number(i)+Number(n);return(0,z.jsxs)(z.Fragment,{children:[i&&a&&o&&(0,z.jsx)(Ni,{store:t,blockTeamOwnerPermission:a,blockTeamMemberPermission:o,blockTeamGuestPermission:r,permissionItemArgs:s}),n&&(0,z.jsx)(hi,{store:t,spacePermission:l,permissionItemArgs:s,fromPermissionWrapper:"permission_list"}),(0,z.jsx)(Oi,{store:t,pagePermissions:d,numberPermissionsAlreadyRendered:c,permissionItemArgs:s})]})}function Oi(e){window.__c={n:"PagePermissionsList"};const t=(0,r.useIntl)(),s=(0,a.VK)((()=>{const e=x.default.state.currentSpaceStore;return null!=e&&e.isDefined()?e.id:""}),[]),{store:i,pagePermissions:n,numberPermissionsAlreadyRendered:o,permissionItemArgs:l,showHeader:d}=e,{showUserPermissions:c,mostPermissiveGroupPermissions:m,mostPermissiveTeamPermissions:g,mostPermissiveUserPermissions:h,spacePermissionGroups:f}=n,y=(0,a.VK)((()=>qt()),[]),v=(0,a.VK)((()=>{const e=c?function(e){const{mostPermissiveUserPermissions:t,spaceVisibleUserMap:s}=e,i={};return t.forEach((t=>{i[t.permissionItem.user_id]=(0,z.jsx)(ds,{store:e.store,userPermission:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,spaceVisibleUserMap:s,fromPermissionWrapper:"permission_list"},t.permissionItem.user_id)})),i}({store:i,mostPermissiveUserPermissions:h,permissionItemArgs:l,spaceVisibleUserMap:y}):[];return u.oA(Object.keys(e).map((s=>{const n=S.U6.createChildStore(i,{table:zt.KJ,id:s}),a=n.getModel();if(!n.isReady()||a)return{title:(0,Kt.Nz)(t,a),permissionItem:e[s]}})))}),[c,h,l,i,t,y]),b=s?function(e){const{spaceId:t,spacePermissionGroups:s,mostPermissiveGroupPermissions:i}=e,n={};return i.forEach((i=>{const a=i.permissionItem.group_id;s.find((e=>e.id===a))&&(n[a]=(0,z.jsx)(ss,{store:e.store,groupPermission:i,spaceId:t,showInherited:!1,permissionItemArgs:e.permissionItemArgs,fromPermissionWrapper:"permission_list"}))})),n}({store:i,spaceId:s,spacePermissionGroups:f,mostPermissiveGroupPermissions:m,permissionItemArgs:l}):[],M=function(e){const{store:t,mostPermissiveTeamPermissions:s,permissionItemArgs:i}=e;return s.map((e=>p.LW(e.permissionItem)?(0,z.jsx)(Fi,{store:t,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:i,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.owner`):p.bm(e.permissionItem)?(0,z.jsx)(Mi,{store:t,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:i,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.teamGuest`):(0,z.jsx)(ki,{store:t,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:i,fromPermissionWrapper:"permission_list"},`${e.permissionItem.team_id}.member`)))}({store:i,mostPermissiveTeamPermissions:g,permissionItemArgs:l}),w=[...v,...Object.keys(b).map((e=>{const s=f.find((t=>t.id===e));return{title:s?(0,$t.kF)({intl:t,group:s}):"",permissionItem:b[e]}}))];w.sort(((e,t)=>e.title.localeCompare(t.title)));const j=M.concat(w.map((e=>e.permissionItem))),C=j.length;if(0===C)return null;if(C>5-o){const e=Math.max(2-o,0);return(0,z.jsxs)(z.Fragment,{children:[d&&(0,z.jsx)(Rs,{}),j.slice(0,e),(0,z.jsx)(us,{permissions:j.slice(e,-1)}),j[C-1]]})}return(0,z.jsxs)(z.Fragment,{children:[d&&(0,z.jsx)(Rs,{}),j]})}function Vi(e,t){return e.from.table===g.iU&&e.from.blockId===t.id}const Ui=function(e){window.__c={n:"PermissionsList"};const t=(0,n.O7)(),{device:s}=t,{store:r,permissionItemArgs:l,calculatedPermissions:d}=e,{sudoModeStore:c}=l,{permissionItemsCount:m,pagePermissionUIModel:p,showRestrictedPermissionBanner:g}=d,f=(0,a.VK)((()=>{const e=x.default.state.currentSpaceStore;if(!e)return!0;if(r.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;const s=(0,y.uJ)(r);for(const i of s)if((0,Qt.OY)(i)&&i.isTopLevelPrivatePage({spaceStore:e,environment:t}))return!0;return!1}),[r,t]);let v=null;const w=(0,a.VK)((()=>function(e){const{store:t,showRestrictedPermissionBanner:s}=e,{canAccessParent:i}=M({store:t});return i&&(s||b({store:t}))}({store:r,showRestrictedPermissionBanner:g})),[r,g]),{canAccessParent:j}=(0,a.VK)((()=>M({store:r})),[r]),C={...d};if(!w&&j){const[e,t]=function(e,t){const{mostPermissiveGroupPermissions:s,mostPermissiveTeamPermissions:i,mostPermissiveUserPermissions:n}=t,[a,o]=u.uK(s,(t=>Vi(t,e))),[r,l]=u.uK(i,(t=>Vi(t,e))),[d,c]=u.uK(n,(t=>Vi(t,e))),m={...t,mostPermissiveGroupPermissions:o,mostPermissiveTeamPermissions:l,mostPermissiveUserPermissions:c},p={...t,mostPermissiveGroupPermissions:a,mostPermissiveTeamPermissions:r,mostPermissiveUserPermissions:d};return[m,p]}(r,p);C.pagePermissionUIModel=e,v=(0,z.jsx)(Oi,{store:r,pagePermissions:t,numberPermissionsAlreadyRendered:0,permissionItemArgs:l,showHeader:!0})}const k=(0,a.VK)((()=>!function(e){const{store:t}=e,s=(0,y.uJ)(t),i=s.find((e=>e instanceof S.G&&e.isRestricted())),n=s[s.length-1];return i||n.getParentTable()===h.bx&&n.canRead()}({store:r})),[r]),_=s.isMobile?vt.Z.None:vt.Z.Y,T=(0,o.yK)((e=>({scroller:{paddingBottom:10,minHeight:s.isMobile||0===m?void 0:1===m?60:90}})),[s,m]);return(0,i.useEffect)((()=>{Ht.oE({environment:t,calculatedPermissions:d})}),[]),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(wt.Z,{style:T.scroller,type:_,children:[!f&&(0,z.jsx)(Bs,{store:r}),(0,z.jsx)(Us,{store:r,showRestrictedPermissionBanner:g,sudoModeStore:c}),!w&&m>0&&(0,z.jsx)(Ns,{store:r}),(0,z.jsx)(Ei,{store:r,calculatedPermissions:C,permissionItemArgs:l}),v,k&&(0,z.jsx)(ps,{store:r})]}),!s.isMobile&&(0,z.jsx)(di,{store:r,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:C,permissionItemArgs:l})]})};s(57658);var Wi=s(58573),zi=s(59054),Ki=s(85397);const Hi=(0,W.I)("addPersonCircle",{viewBox:"0 0 50 43",svg:(0,z.jsx)("path",{d:"M28.5 42c11.214 0 20.535-9.322 20.535-20.535C49.035 10.23 39.694.93 28.48.93 17.99.93 9.233 9.003 8.106 19.21c.987-.181 2.416-.262 3.483-.141 1.107-8.355 8.194-14.717 16.89-14.717 9.483 0 17.133 7.61 17.133 17.113 0 4.429-1.65 8.455-4.409 11.455-1.973-2.356-6.643-4.61-12.723-4.61a22.58 22.58 0 00-5.295.624 12.85 12.85 0 01-2.718 11.375 19.941 19.941 0 008.033 1.69zm-.02-17.113c3.865.04 6.905-3.261 6.905-7.59 0-4.067-3.06-7.429-6.905-7.429-3.866 0-6.946 3.362-6.905 7.43.02 4.308 3.04 7.549 6.905 7.589zM10.562 42.221c5.537 0 10.227-4.63 10.227-10.227 0-5.617-4.61-10.227-10.227-10.227-5.597 0-10.227 4.63-10.227 10.227 0 5.637 4.63 10.227 10.227 10.227zm0-3.825c-.745 0-1.228-.483-1.228-1.228v-3.946H5.388c-.725 0-1.228-.483-1.228-1.228s.503-1.228 1.228-1.228h3.946V26.82c0-.725.483-1.228 1.228-1.228s1.228.503 1.228 1.228v3.946h3.946c.725 0 1.228.483 1.228 1.228s-.503 1.228-1.228 1.228H11.79v3.946c0 .745-.483 1.228-1.228 1.228z"})}),Gi=(0,W.I)("arrowUpLeft",{viewBox:"0 0 16 16",svg:(0,z.jsx)("path",{d:"M0.845703 8.58691L0.852539 1.72363C0.852539 1.48665 0.923177 1.29525 1.06445 1.14941C1.21029 0.999023 1.40625 0.923828 1.65234 0.923828H8.51562C8.74349 0.923828 8.93034 0.999023 9.07617 1.14941C9.22201 1.2998 9.29492 1.47526 9.29492 1.67578C9.29492 1.8763 9.21973 2.04948 9.06934 2.19531C8.91895 2.33659 8.74121 2.40723 8.53613 2.40723H6.10254L3.16309 2.30469L4.40723 3.39844L10.915 9.91992C11.0745 10.084 11.1543 10.264 11.1543 10.46C11.1543 10.5921 11.1178 10.7174 11.0449 10.8359C10.972 10.9544 10.8763 11.0479 10.7578 11.1162C10.6439 11.1891 10.5186 11.2256 10.3818 11.2256C10.1813 11.2256 10.0013 11.1481 9.8418 10.9932L3.32715 4.47852L2.21973 3.23438L2.33594 6.05078V8.60742C2.33594 8.8125 2.26302 8.99251 2.11719 9.14746C1.97591 9.29785 1.80273 9.37305 1.59766 9.37305C1.39714 9.37305 1.22168 9.29785 1.07129 9.14746C0.920898 8.99707 0.845703 8.81022 0.845703 8.58691Z"})});var qi=s(36591),Yi=s(36329),Qi=s(98742),$i=s(21752),Xi=s(43765),Ji=s(12276),en=s(70268);function tn(e){window.__c={n:"PublicPermissionLevelBanner"};const{publicPermission:t}=e,s=(0,o.yK)((e=>({banner:{backgroundColor:e.accentColors.gray[50],borderRadius:4,height:34,marginLeft:14,marginRight:14,marginTop:5,marginBottom:5,paddingRight:14,display:"flex",alignItems:"center"},label:{fontSize:12,display:"inline-flex",marginRight:10},icon:{height:20,width:20,marginLeft:14,marginRight:8,color:e.mediumIconColor},manageButton:{color:e.regularTextColor,fontWeight:G.Z.fontWeight.medium}})),[]),i=t.permissionItem.role;return p.YX(i)?(0,z.jsxs)("div",{style:s.banner,children:[(0,z.jsxs)(A.Z,{style:s.label,children:[K(s.icon),(0,z.jsx)(sn,{role:i})]}),(0,z.jsx)(Ts.Z,{style:s.manageButton,onClick:()=>_.ZP.setState({..._.ZP.state,display:_.wV.Publish,tab:_.XF.Publish}),children:(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.managePublishSettingsButton.label",defaultMessage:"Manage"})})]}):null}function sn(e){const{role:t}=e;switch(t){case"read_and_write":return(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canEdit",defaultMessage:"This page allows edits from anyone on the web"});case"comment_only":return(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canComment",defaultMessage:"This page allows comments from anyone on the web"});case"reader":return(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.publicPermissionBanner.canRead",defaultMessage:"This page can be viewed by anyone on the web"});case"editor":case"membership_admin":case"content_only_editor":case"none":return null;default:(0,R.t1)(t)}}function nn(e){window.__c={n:"ShareMenuSearchRequestImpl"};const{store:t,shouldShowSlackOnly:s,calculatedPermissions:i,permissionItemArgs:l,tokenQuery:d,showShimmer:c,error:u,ready:m,result:h}=e,f=i.pagePermissionUIModel,b=(0,n.O7)(),M=(0,a.qz)(e.inviteTargetsStore,L.ZP),w=(0,a.qz)(e.menuListStore,St.Z),j=(0,a.VK)((()=>qt()),[]),C=(0,a.VK)((()=>gt.Rv()),[]),k=(0,o.yK)((e=>({sectionMenuItem:{paddingTop:0,display:"flex",flexDirection:"column",gap:2},zeroState:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",color:e.mediumTextColor,fontSize:14,position:"relative",pointerEvents:"auto",paddingTop:10,marginTop:110},zeroStateText:{width:"70%",alignSelf:"center"},zeroStateIcon:{height:54,width:54,marginBottom:12,fill:e.mediumIconColor},arrowUpLeftIcon:{width:12,height:12,marginRight:3,marginTop:3,color:"#C7C6C4"}})),[]),{inPageTargets:_,notInPageTargets:T,filteredImportedContacts:I}=(0,a.VK)((()=>{const{inviteUsers:e,inviteGroups:s,importedContacts:n=[]}=h??{inviteUsers:[],inviteGroups:[],importedContacts:[]},a=[...e,...s],o=[],r=[],l=new Set;a.forEach((e=>{"group"!==e.type&&l.add(e.value.email.toLowerCase());const s=Boolean(Et.Zp({store:t,target:e})),n=function(e){const{inviteTarget:t,blockStore:s,spacePermission:i,teamMemberPermission:n,groupPermission:a}=e,o=t.type;if("newUser"===o)return{role:"none",type:"user_permission",user_id:t.value.email};if("existingUser"===o)return v.uY({userId:t.value.id,store:s});if("group"===o){const e={role:"none",type:"group_permission",group_id:t.value.id},o=(0,y.VP)(s),r=null==o?void 0:o.getMembers().find((e=>(0,Gt.lF)({groupId:t.value.id,teamMember:e})));return[i,...o&&n&&r?[n]:[],a||{permissionItem:e,from:{table:g.iU,blockId:s.id}}].sort(((e,t)=>p.xm[t.permissionItem.role]-p.xm[e.permissionItem.role]))}(0,R.t1)(o)}({inviteTarget:e,blockStore:t,spacePermission:i.mostPermissiveSpaceItem,teamMemberPermission:i.mostPermissiveAncestorTeamMemberItem,groupPermission:"group"===e.type?f.mostPermissiveGroupPermissions.find((t=>t.permissionItem.group_id===e.value.id)):void 0}),a=Array.isArray(n)?n[0].permissionItem:n;if("existingUser"===e.type&&!Boolean(e.spaceRole)){const t=j.get(e.value.id);e.spaceRole=t?t.role:"not_in_space"}(s||p.YX(a.role??"none"))&&"newUser"!==e.type?o.push({inviteTarget:e,permissionItem:a,mostPermissivePermissions:Array.isArray(n)?n:void 0}):"newUser"!==e.type&&r.push(e)}));const d=n.filter((e=>!l.has(e.value.email.toLowerCase())));return{inPageTargets:o,notInPageTargets:r,filteredImportedContacts:d}}),[t,h,i.mostPermissiveSpaceItem,i.mostPermissiveAncestorTeamMemberItem,f.mostPermissiveGroupPermissions,j]),{isValidEmail:P,isEmailInTargets:Z}=(0,a.VK)((()=>{const e=(0,Ft.H3)(d);return{isValidEmail:(0,Ft.oH)(e),isEmailInTargets:[..._.map((e=>{let{inviteTarget:t}=e;return t})),...T].some((t=>"group"!==t.type&&t.value.email===e))}}),[d,_,T]),F=P&&!Z,A=!s&&T.length>0&&0===d.length,D=!s&&d.length>0&&_.length>0,B=!s&&T.length>0&&d.length>0,N=C&&I.length>0,E={key:"imported contacts",render:e=>(0,z.jsx)(Ke.Z,{...e,style:k.sectionMenuItem,title:(0,z.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.importedContactsSection.title",defaultMessage:"From Slack"}),loading:!m}),items:I.map((e=>({key:e.value.email,render:s=>(0,z.jsx)(gn,{...s,invited:!1,inviteTarget:e,isInInviteTargets:At.H({target:e,inviteTargetsStore:M}),blockStore:t,spaceVisibleUserMap:j}),action:()=>{At.H({target:e,inviteTargetsStore:M})?M.setState({...M.state,inviteTargets:M.state.inviteTargets.filter((t=>"newUser"!==t.type||e.value.email!==t.value.email))}):(M.setState({inviteTargets:[...M.state.inviteTargets,e],tokenQuery:""}),w.unsetFocus())}})))},{shouldShowAutoFillEmail:O,showGuestVsMemberTag:V}=(0,a.VK)((()=>{if(F){return{shouldShowAutoFillEmail:"control"!==gt.uD(),showGuestVsMemberTag:!1}}if(A||D||B||N||s)return{shouldShowAutoFillEmail:!1,showGuestVsMemberTag:!1};if(s&&0===E.items.length)return{shouldShowAutoFillEmail:!1,showGuestVsMemberTag:!1};if(0===d.length)return{shouldShowAutoFillEmail:!1,showGuestVsMemberTag:!1};return{shouldShowAutoFillEmail:"control"!==gt.uD(),showGuestVsMemberTag:!1}}),[F,A,D,B,N,s,E.items.length,d]),U=(0,a.VK)((()=>{const{data:e}=bt.default.state,{currentSpaceStore:t}=x.default.state;return t&&e?Te.hn(e).map((s=>{if(("unsubscribed_admin"===e.type||"unsubscribed_member"===e.type||"subscribed_admin"===e.type)&&e.joinedMemberIds.includes(s.userId)){const e=S.U6.createChildStore(t,{table:zt.KJ,id:s.userId}).getEmail();return e&&(0,Ft.Gd)(e)}})).reduce(((e,t)=>(t&&!e.includes(t)&&e.push(t),e)),[]):[]}),[]);if(u)return(0,z.jsx)(Ji.l,{loading:!m,children:(0,z.jsx)(Xi.Z,{title:(0,z.jsx)(r.FormattedMessage,{id:"inviteUserModal.searchInput.errorMessage",defaultMessage:"Something went wrong"})})});if(!m&&c)return(0,z.jsx)(en.B,{areaHeight:window.innerHeight});const W={key:"user results",render:e=>(0,z.jsx)(Ke.Z,{...e,style:k.sectionMenuItem,loading:!m,title:(0,z.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.suggestedEmail.title",defaultMessage:"Keep typing an email to invite"})}),items:yn({tokenQuery:d,possibleDomains:U,showGuestVsMemberTag:V,shouldShowAutoFillEmail:O,environment:b,inviteTargetsStore:M,menuListStore:w,store:t,styles:k})},K={key:"suggested",render:e=>(0,z.jsx)(Ke.Z,{...e,style:k.sectionMenuItem,title:(0,z.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.suggestedSection.title",defaultMessage:"Suggested"}),loading:!m}),items:T.map(((e,s)=>({key:"newUser"===e.type?e.value.email:e.value.id,render:s=>{const i=At.H({target:e,inviteTargetsStore:M});return(0,z.jsx)(gn,{...s,invited:!1,inviteTarget:e,isInInviteTargets:i,blockStore:t,spaceVisibleUserMap:j})},action:()=>an({inviteTarget:e,inviteTargetsStore:M,menuListStore:w})})))},H={key:"in page",render:e=>(0,z.jsx)(Ke.Z,{...e,style:k.sectionMenuItem,title:(0,z.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inPageSection.title",defaultMessage:"In page"}),loading:!m}),items:_.map((e=>{const{inviteTarget:s,permissionItem:i,mostPermissivePermissions:n}=e,{type:a}=s;if("existingUser"===a){if(!!n&&n.length>1)return{key:s.value.id,render:e=>(0,z.jsx)(ln,{...e,blockStore:t,inviteTarget:s,permissionItem:i,mostPermissivePermissions:n,spaceVisibleUserMap:j,permissionItemArgs:l}),action:()=>{}};{const e=f.mostPermissiveUserPermissions.find((e=>e.permissionItem.user_id===s.value.id));return e?{key:s.value.id,render:s=>(0,z.jsx)(Ue.Z,{...s,itemMarginLeft:0,itemMarginRight:0,title:(0,z.jsx)(ds,{store:t,userPermission:e,showInherited:!0,ignoreLocalHoverState:!0,spaceVisibleUserMap:j,permissionItemArgs:l})}),action:()=>{}}:{key:s.value.id,render:e=>(0,z.jsx)(ln,{...e,blockStore:t,inviteTarget:s,permissionItem:i,spaceVisibleUserMap:j,permissionItemArgs:l}),action:()=>an({inviteTarget:s,inviteTargetsStore:M,menuListStore:w})}}}if("group"===a){if(!!n&&n.length>1)return{key:s.value.id,render:n=>(0,z.jsx)(ln,{...n,blockStore:t,inviteTarget:s,permissionItem:i,mostPermissivePermissions:e.mostPermissivePermissions,spaceVisibleUserMap:j,permissionItemArgs:l}),action:()=>{}};{const e=f.mostPermissiveGroupPermissions.find((e=>e.permissionItem.group_id===s.value.id));return e?{key:s.value.id,render:s=>(0,z.jsx)(Ue.Z,{...s,itemMarginLeft:0,itemMarginRight:0,title:(0,z.jsx)(ss,{store:t,groupPermission:e,spaceId:t.getSpaceId(),showInherited:!0,permissionItemArgs:l})}),action:()=>{}}:{key:s.value.id,render:e=>(0,z.jsx)(ln,{...e,blockStore:t,inviteTarget:s,permissionItem:i,spaceVisibleUserMap:j,permissionItemArgs:l}),action:()=>an({inviteTarget:s,inviteTargetsStore:M,menuListStore:w})}}}(0,R.t1)(a)}))},G={key:"not in page",render:e=>(0,z.jsx)(Ke.Z,{...e,style:k.sectionMenuItem,title:d.length>0&&(0,z.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.notInPageSection.title",defaultMessage:"Not in page"}),loading:!m}),items:T.map((e=>({key:"newUser"===e.type?e.value.email:e.value.id,render:s=>(0,z.jsx)(gn,{...s,invited:!1,inviteTarget:e,isInInviteTargets:At.H({target:e,inviteTargetsStore:M}),blockStore:t,spaceVisibleUserMap:j}),action:()=>an({inviteTarget:e,inviteTargetsStore:M,menuListStore:w})})))};let q=[];return F&&q.push(W),A&&q.push(K),D&&q.push(H),B&&q.push(G),N&&q.push(E),s&&(q=[E],0===E.items.length)?(0,z.jsx)(hn,{styles:k}):0===q.length&&(q=[W],0===d.length)?(0,z.jsx)(fn,{styles:k,shouldShowSlackMessage:C}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(tn,{publicPermission:i.mostPermissivePublicItem}),(0,z.jsx)(ze.Z,{type:ze.i.Vertical,initialFocus:d.length>0?0:void 0,sections:q,store:w})]})}function an(e){const{inviteTarget:t,inviteTargetsStore:s,menuListStore:i}=e;if(At.H({target:t,inviteTargetsStore:s})){const e=s.state.inviteTargets.filter((e=>"group"===t.type&&"group"===e.type||"existingUser"===t.type&&"existingUser"===e.type?t.value.id!==e.value.id:"newUser"!==t.type||"newUser"!==e.type||t.value.email!==e.value.email));return s.setState({...s.state,inviteTargets:e}),void i.unsetFocus()}s.setState({inviteTargets:[...s.state.inviteTargets,t],tokenQuery:""}),i.unsetFocus()}const on=i.forwardRef(((e,t)=>{window.__c={n:"InPageGroupResultItem"};const{blockStore:s,inviteTarget:l,permissionItem:d,mostPermissivePermissions:c,permissionItemArgs:u}=e,m=(0,n.O7)(),p=(0,r.useIntl)(),[h,f]=(0,i.useState)(!1),y=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),v=(0,a.VK)((()=>s.getSpaceId()),[s]),S=(0,a.VK)((()=>c&&c.length>0),[c]),b=(0,a.VK)((()=>{if("group"===l.type)return(0,$t.kF)({group:l.value,intl:p})}),[l,p]),M=(0,a.VK)((()=>{if(y&&"group"===l.type&&l.value.icon)return{pointer:{table:y.table,id:y.id},icon:l.value.icon}}),[y,l]),w=(0,a.VK)((()=>y?"group"!==l.type?0:(0,$t.rm)({group:l.value,spaceStore:y,limit:void 0}).totalNumberMembers:0),[y,l]),j=(0,i.useCallback)((()=>{if(S){const e=!1===h;f(!h),e&&we.dSV(m,{share_menu_session_id:_.ZP.state.sessionId,type:"group",group_id:l.value.id})}}),[m,S,h,f,l]),C=(0,o.yK)((e=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10},permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:G.Z.fontWeight.bold},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:16},roundedPermissionItem:{borderRadius:3,overflow:"hidden",marginRight:4}})),[]);return(0,z.jsx)(ve.Z,{delayThreshold:0,placement:ve.Z.Placement.Left,textWrap:!0,style:C.tooltip,renderTooltip:()=>(0,z.jsx)(dn,{blockStore:s,blockPermissionItem:d}),render:i=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{...i,children:(0,z.jsx)(Ue.Z,{...e,...(0,Qi.Z)(e,{onClick:j}),ref:t,title:(0,z.jsxs)("div",{style:C.titleContainer,children:[(0,z.jsx)(Xt.Z,{size:32}),(0,z.jsxs)("div",{style:C.groupInfoContainer,children:[(0,z.jsxs)("div",{style:C.nameAndIconContainer,children:[(0,z.jsx)(A.Z,{style:C.groupNameLabel,children:b}),Boolean(null==M?void 0:M.icon)&&(0,z.jsx)(Jt.Z,{disabled:!0,bucket:"public",title:b,icon:M,size:18,isEmptyPage:!1})]}),(0,z.jsx)(A.Z,{isSmall:!0,style:C.groupMembersLabel,children:S&&h?(0,z.jsx)(cn,{}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,z.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:w}})]})})]})]}),right:(0,z.jsx)(Bi.d,{table:g.iU,disabled:!0,icon:S?h?Ws.R:Ai:void 0,role:d.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:C.permissionRoleButton})})}),S&&h&&(0,z.jsx)("div",{style:C.expandablePermissionList,children:null==c?void 0:c.map(((e,t)=>{const i=e.permissionItem.type;let n=null;switch(i){case"space_permission":n=(0,z.jsx)(hi,{store:s,spacePermission:e,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":n=(0,z.jsx)(ki,{store:s,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":n=(0,z.jsx)(ss,{spaceId:v,store:s,groupPermission:e,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":break;case"explicit_team_owner_permission":case"explicit_team_guest_permission":break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":break;case"team_owner_permission":case"team_permission":break;default:(0,R.t1)(i)}return(0,z.jsx)("div",{style:C.roundedPermissionItem,children:n},t)}))})]})})})),rn=i.forwardRef(((e,t)=>{window.__c={n:"InPageUserResultItem"};const{blockStore:s,inviteTarget:r,permissionItem:l,mostPermissivePermissions:d,spaceVisibleUserMap:c,permissionItemArgs:u}=e,m=(0,n.O7)(),[p,h]=(0,i.useState)(!1),f="existingUser"===r.type?S.U6.createChildStore(s,{table:zt.KJ,id:r.value.id}):void 0,y=(0,a.VK)((()=>"none"===r.spaceRole?Yt({spaceVisibleUserMap:c,userId:r.value.id,blockStore:s}):(0,$i.K)(r.spaceRole)),[r,c,s]),v=(0,a.VK)((()=>s.getSpaceId()),[s]),x=(0,a.VK)((()=>d&&d.length>0),[d]),b=(0,i.useCallback)((()=>{const e=!1===p;h(!p),e&&we.dSV(m,{share_menu_session_id:_.ZP.state.sessionId,type:"user",userId:r.value.id})}),[m,p,h,r]),M=(0,o.yK)((e=>({permissionRoleButton:{marginRight:-6,color:e.mediumTextColor,fontSize:12},container:{whiteSpace:"nowrap",fontWeight:G.Z.fontWeight.bold},cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"},tooltip:{maxWidth:180},expandablePermissionList:{paddingLeft:24},roundedPermissionItem:{borderRadius:3,overflow:"hidden",marginRight:4}})),[]);return(0,z.jsx)(ve.Z,{delayThreshold:0,placement:ve.Z.Placement.Left,textWrap:!0,style:M.tooltip,renderTooltip:()=>(0,z.jsx)(dn,{blockStore:s,blockPermissionItem:l}),render:i=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{...i,children:(0,z.jsx)(Ue.Z,{...e,...(0,Qi.Z)(e,{onClick:b}),ref:t,title:(0,z.jsx)($i.Z,{isLarge:!0,actorStore:f,containerStyle:M.cellMemberAvatarContainer,spaceRole:y,caption:x&&p?(0,z.jsx)(cn,{}):void 0}),right:(0,z.jsx)(Bi.d,{table:g.iU,disabled:!0,icon:x?p?Ws.R:Ai:void 0,role:l.role??"none",isRemovable:!1,isCurrentUser:!1,buttonStyle:M.permissionRoleButton})})}),x&&p&&(0,z.jsx)("div",{style:M.expandablePermissionList,children:null==d?void 0:d.map(((e,t)=>{const i=e.permissionItem.type;let n=null;switch(i){case"space_permission":n=(0,z.jsx)(hi,{store:s,spacePermission:e,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_owner_permission":n=(0,z.jsx)(Fi,{store:s,blockTeamOwnerPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_permission":n=(0,z.jsx)(ki,{store:s,blockTeamPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"explicit_team_guest_permission":n=(0,z.jsx)(Mi,{store:s,blockTeamGuestPermission:e,isExternalTeam:!0,permissionItemArgs:u,fromPermissionWrapper:"expandable_permission"});break;case"group_permission":n=(0,z.jsx)(ss,{store:s,spaceId:v,groupPermission:e,permissionItemArgs:u,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"user_permission":n=(0,z.jsx)(ds,{store:s,userPermission:e,permissionItemArgs:u,spaceVisibleUserMap:c,showInherited:!0,isRemovableOverride:!1,fromPermissionWrapper:"expandable_permission"});break;case"public_permission":case"bot_permission":case"deleted_permission":case"restricted_permission":case"exclusive_user_permission":break;case"team_owner_permission":case"team_permission":break;default:(0,R.t1)(i)}return(0,z.jsx)("div",{style:M.roundedPermissionItem,children:n},t)}))})]})})})),ln=i.forwardRef(((e,t)=>{const{inviteTarget:s}=e,i=s.type;switch(i){case"group":return(0,z.jsx)(on,{...e,ref:t,inviteTarget:s});case"existingUser":return(0,z.jsx)(rn,{...e,ref:t,inviteTarget:s});default:(0,R.t1)(i)}}));function dn(e){window.__c={n:"InPageItemTooltip"};const{blockStore:t,blockPermissionItem:s}=e,i=(0,n.O7)(),l=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),d=(0,a.VK)((()=>{if(l)return(0,hs.Wd)(i,l)}),[i,l]),c=(0,a.VK)((()=>{const e=s.type;if("explicit_team_permission"===e||"explicit_team_owner_permission"===e||"explicit_team_guest_permission"===e){return S.zX.createChildStore(t,{table:f.e0,id:s.team_id})}}),[t,s]),u=(0,a.VK)((()=>null==c?void 0:c.getIcon()),[c]),m=(0,o.yK)((()=>({container:{fontWeight:G.Z.fontWeight.bold,...G.Z.textOverflowStyle},recordIcon:{marginRight:4,display:"inline-block",verticalAlign:"middle"},recordTitle:{display:"inline"}})),[]),g=s.type;return"space_permission"===g?(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.spacePermission.tooltip",defaultMessage:"Everyone at {spaceIconAndName} has access.",values:{spaceIconAndName:(0,z.jsxs)("span",{style:m.container,children:[d&&(0,z.jsx)(Jt.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:12,style:m.recordIcon}),l&&(0,z.jsx)(_s.Z,{store:l,style:m.recordTitle})]})}}):"explicit_team_owner_permission"===g?(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamPermission.tooltip",defaultMessage:"Teamspace owners of {teamIconAndName} have access.",values:{teamIconAndName:(0,z.jsxs)("span",{style:m.container,children:[u&&(0,z.jsx)(Jt.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,z.jsx)(_s.Z,{store:c,style:m.recordTitle})]})}}):"explicit_team_permission"===g?(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamMemberPermission.tooltip",defaultMessage:"Teamspace members of {teamIconAndName} have access.",values:{teamIconAndName:(0,z.jsxs)("span",{style:m.container,children:[u&&(0,z.jsx)(Jt.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,z.jsx)(_s.Z,{store:c,style:m.recordTitle})]})}}):"explicit_team_guest_permission"===g?(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.teamGuestPermission.tooltip",defaultMessage:"Teamspace guests of {teamIconAndName} have access.",values:{teamIconAndName:(0,z.jsxs)("span",{style:m.container,children:[u&&(0,z.jsx)(Jt.Z,{disabled:!0,icon:u,isEmptyPage:!1,size:12,style:m.recordIcon}),c&&(0,z.jsx)(_s.Z,{store:c,style:m.recordTitle})]})}}):"group_permission"===g?(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.groupPermission.tooltip",defaultMessage:"This group has access."}):"user_permission"===g||"exclusive_user_permission"===g||"public_permission"===g||"restricted_permission"===g||"deleted_permission"===g||"team_permission"===g||"team_owner_permission"===g||"bot_permission"===g?(0,z.jsx)(z.Fragment,{children:p.YX(s.role??"none")&&(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.searchResult.userPermission.tooltip",defaultMessage:"This user has access"})}):void(0,R.t1)(g)}function cn(){return(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.inPageSearchResult.caption",defaultMessage:"Permission from"})}function un(e){window.__c={n:"CircleCheckmark"};const{checked:t}=e,s=(0,o.yK)((e=>({circleCheckmark:{display:"flex",justifyContent:"center",alignItems:"center",width:22,height:22,borderRadius:"50%",borderStyle:"solid",borderWidth:1.75,borderColor:t?E.ZP.blue:e.buttonPressedBackground,backgroundColor:t?E.ZP.blue:"transparent",marginRight:6},checkIcon:{height:12,width:12,color:"white"}})),[t]);return(0,z.jsx)("div",{style:s.circleCheckmark,children:t&&(0,qi.e)(s.checkIcon)})}const mn=i.forwardRef(((e,t)=>{window.__c={n:"NotInPageGroupResultItem"};const{inviteTarget:s,isInInviteTargets:i,disabled:n}=e,l=(0,r.useIntl)(),d=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),c=(0,a.VK)((()=>(0,$t.kF)({group:s.value,intl:l})),[s,l]),u=(0,a.VK)((()=>{if(d&&s.value.icon)return{pointer:{table:d.table,id:d.id},icon:s.value.icon}}),[d,s]),m=(0,a.VK)((()=>{if(!d)return 0;return(0,$t.rm)({group:s.value,spaceStore:d,limit:void 0}).totalNumberMembers}),[d,s]),p=(0,o.yK)((()=>({titleContainer:{display:"flex",alignItems:"center",paddingTop:8,paddingBottom:8,marginLeft:2,minHeight:36},groupInfoContainer:{display:"flex",flexDirection:"column"},nameAndIconContainer:{display:"flex",alignItems:"center"},groupNameLabel:{marginLeft:10,marginRight:4},groupMembersLabel:{marginLeft:10}})),[]),g=(0,z.jsxs)("div",{style:p.titleContainer,children:[(0,z.jsx)(Xt.Z,{size:32}),(0,z.jsxs)("div",{style:p.groupInfoContainer,children:[(0,z.jsxs)("div",{style:p.nameAndIconContainer,children:[(0,z.jsx)(A.Z,{style:p.groupNameLabel,children:c}),Boolean(null==u?void 0:u.icon)&&(0,z.jsx)(Jt.Z,{disabled:!0,bucket:"public",title:c,icon:u,size:18,isEmptyPage:!1})]}),(0,z.jsxs)(A.Z,{isSmall:!0,style:p.groupMembersLabel,children:[(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Group",id:"blockPermissionsSettings.groupPermission.label"})," · ",(0,z.jsx)(r.FormattedMessage,{defaultMessage:"{numberOfGroupMembers, plural, one {{numberOfGroupMembers} person} other {{numberOfGroupMembers} people}}",id:"blockPermissionsSettings.groupPermission.none",values:{numberOfGroupMembers:m}})]})]})]});return(0,z.jsx)(Ue.Z,{...e,ref:t,title:g,right:(0,z.jsx)(un,{checked:i}),disabled:n})})),pn=i.forwardRef(((e,t)=>{window.__c={n:"NotInPageUserResultItem"};const{inviteTarget:s,blockStore:n,isInInviteTargets:r,disabled:l,spaceVisibleUserMap:d,...c}=e,u=(0,o.yK)((()=>({cellMemberAvatarContainer:{paddingTop:8,paddingBottom:8},iconBox:{position:"absolute",bottom:-3,right:-3},iconBoxImage:{background:"white",padding:2,borderRadius:"100%"}})),[]),m=(0,a.VK)((()=>"existingUser"===s.type?Yt({spaceVisibleUserMap:d,userId:s.value.id,blockStore:n}):void 0),[s,d,n]),p=(0,i.useMemo)((()=>"existingUser"===s.type?{actorStore:S.U6.createChildStore(n,{table:zt.KJ,id:s.value.id}),avatar:void 0}:"newUser"===s.type?{actorStore:void 0,avatar:{email:s.value.email,name:"slack"===s.source?s.value.name:void 0,avatarUrl:"slack"===s.source?s.value.avatar_url:void 0}}:void(0,R.t1)(s)),[s,n]);return(0,z.jsx)(Ue.Z,{...c,ref:t,title:(0,z.jsx)($i.Z,{isLarge:!0,...p,containerStyle:u.cellMemberAvatarContainer,avatarBadge:"newUser"===s.type&&"slack"===s.source?(0,z.jsx)(Y.Z,{type:"image_url",imageURL:N.Z.images.externalIntegrations.slackIconPng,size:18,style:u.iconBox,imageStyle:u.iconBoxImage}):void 0,spaceRole:m}),disabled:l,right:!l&&(0,z.jsx)(un,{checked:r})})})),gn=i.forwardRef(((e,t)=>{const{inviteTarget:s,blockStore:i,spaceVisibleUserMap:n}=e,a=s.type;switch(a){case"group":return(0,z.jsx)(mn,{...e,ref:t,inviteTarget:s});case"newUser":case"existingUser":return(0,z.jsx)(pn,{...e,ref:t,inviteTarget:s,blockStore:i,spaceVisibleUserMap:n});default:(0,R.t1)(a)}}));function hn(e){const{styles:t}=e;return(0,z.jsxs)("div",{style:t.zeroState,children:[(0,Yi._)(t.zeroStateIcon),(0,z.jsxs)("div",{style:t.zeroStateText,children:[(0,z.jsx)("div",{style:{fontWeight:G.Z.fontWeight.semibold,marginBottom:4},children:(0,z.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.title",defaultMessage:"No contacts found"})}),(0,z.jsx)("div",{children:(0,z.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noImportedContacts.text",defaultMessage:"Try connecting a different Slack workspace or typing an email address"})})]})]})}function fn(e){const{styles:t,shouldShowSlackMessage:s}=e;return(0,z.jsxs)("div",{style:t.zeroState,children:[Hi(t.zeroStateIcon),(0,z.jsxs)("div",{style:t.zeroStateText,children:[(0,z.jsx)("div",{style:{fontWeight:G.Z.fontWeight.semibold,marginBottom:4},children:(0,z.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.title",defaultMessage:"Search or add people"})}),(0,z.jsx)("div",{children:s?(0,z.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.text",defaultMessage:"Try connecting a Slack workspace or typing an email address"}):(0,z.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.noSuggestions.defaultText",defaultMessage:"Try typing an email address"})})]})]})}function yn(e){let{tokenQuery:t,possibleDomains:s,showGuestVsMemberTag:i,shouldShowAutoFillEmail:n,environment:a,inviteTargetsStore:o,menuListStore:l,store:d,styles:c}=e;return(0,Wi.ZP)(t,function(e,t,s){return s?Array.from(new Set([...t,"gmail.com","yahoo.com","outlook.com","hotmail.com"])).map(((t,s)=>({tokenQuery:`${e.split("@")[0]}@${t}`,weight:s}))).slice(0,3):[{tokenQuery:e,weight:0}]}(t,s,n),(e=>e.tokenQuery)).map(((e,s)=>({key:e.tokenQuery,render:t=>(0,z.jsx)(Ue.Z,{icon:(0,Ki.a)({width:24,height:24}),title:n?(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem.v1",defaultMessage:"”{tokenQuery}”",values:{tokenQuery:e.tokenQuery}})}):(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(r.FormattedMessage,{id:"shareMenuSearchRequest.inviteNewUser.buttonItem",defaultMessage:"Invite {tokenQuery}",values:{tokenQuery:e.tokenQuery}})}),right:(0,z.jsxs)(z.Fragment,{children:[n?Gi(c.arrowUpLeftIcon):null,i?(0,z.jsx)(Lt.Z,{store:d,onlyShowTokenType:!0,showRemoveButton:!1,target:{source:"email",type:"newUser",value:{email:e.tokenQuery},spaceRole:"not_in_space"}},e.tokenQuery):null]}),rightStyle:{marginRight:4},...t}),action:async()=>{const i=(0,Ft.H3)(e.tokenQuery);if(!(0,Ft.oH)(i))return;const n=await mt.M5(a,[i]);if(!n.length)return;const r=n[0];At.H({target:r,inviteTargetsStore:o})||(we.hEo(a,{invite_token_query:t,selected_user_token:r,selected_user_token_rank:s,from:"share_modal_invite",subscription_tier:(0,Dt.zt)()}),o.setState({inviteTargets:[...o.state.inviteTargets,r],tokenQuery:""}),l.unsetFocus())}})))}const vn=function(e){window.__c={n:"ShareMenuSearchRequest"};const t=(0,n.O7)(),s=(0,r.useIntl)(),[o,l]=(0,i.useState)(!0),d=(0,a.VK)((()=>e.inviteTargetsStore.state.tokenQuery),[e.inviteTargetsStore]),c=(0,a.VK)((()=>{if(e.shouldShowSlackOnly)return{userLimit:0,botLimit:0,groupLimit:0,importContactLimit:e.sectionRenderLimit};const t=xt.Z.completeSlackAuthentications.state.length>0&&gt.Rv();return{userLimit:e.sectionRenderLimit,botLimit:0,groupLimit:e.shouldShowGroups?e.sectionRenderLimit:0,importContactLimit:t?e.sectionRenderLimit:0}}),[e.sectionRenderLimit,e.shouldShowGroups,e.shouldShowSlackOnly]),[{value:u,status:m}]=(0,zi.r5)((async()=>mt.jL({query:d,sectionLimit:c,membersOnly:e.membersOnly,environment:t,intl:s}).finally((()=>l(!1)))),[t,s,e.membersOnly,d,c],{debounce:40});return(0,z.jsx)(nn,{...e,tokenQuery:d,showShimmer:o,ready:"pending"!==m,error:"rejected"===m,result:u})};function xn(e){window.__c={n:"InviteContent"};const t=(0,n.O7)(),s=(0,a.qz)(e.inviteTargetsStore,L.ZP),r=(0,a.VK)((()=>s.state.inviteTargets),[s]),{display:l,source:d,focus:c,emailMessage:u}=(0,a.VK)((()=>{const{display:e}=_.ZP.state;return e===_.wV.Invite?_.ZP.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),m=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),p=(0,a.VK)((()=>d===_.T5.Notion&&0===r.length&&(0,gt.Rv)()),[r.length,d]),g=(0,a.VK)((()=>xt.Z.completeSlackAuthentications.state),[]),h=(0,i.useCallback)((()=>{s.reset()}),[s]),[f,y]=(0,i.useState)(!1);(0,i.useEffect)((()=>{if(m&&!f&&p){for(const e of g)ut.loadContacts(t,{botId:e.id,spaceId:m.id,integrationId:dt.nO}).catch((e=>{}));y(!0)}}),[p]);const v=l===_.wV.Invite&&r.length>0,S=(0,o.yK)((()=>({scroller:{flexGrow:1}})),[]);return l!==_.wV.Invite?null:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(wt.Z,{type:vt.Z.Y,style:S.scroller,children:(0,z.jsx)(vn,{inviteTargetsStore:s,store:e.store,menuListStore:e.menuListStore,shouldShowGroups:!0,shouldShowSlackOnly:d===_.T5.Slack,membersOnly:!1,sectionRenderLimit:10,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs})}),p&&(0,z.jsx)(Zt,{onClickAuthenticated:()=>{_.ZP.setState({..._.ZP.state,tab:_.XF.Share,display:_.wV.Invite,focus:_.Sw.Search,source:_.T5.Slack,emailMessage:u}),s.setState({...s.state,tokenQuery:""})}}),(0,z.jsx)(wn,{open:v&&!p,focus:c===_.Sw.Message,value:u,onFocus:()=>{d&&l===_.wV.Invite&&_.ZP.setState({..._.ZP.state,focus:_.Sw.Message,tab:_.XF.Share,display:l,source:d,emailMessage:u})},onChange:e=>{_.ZP.setState({..._.ZP.state,focus:c,tab:_.XF.Share,display:l,source:d,emailMessage:e.target.value})},onCancel:async()=>{await pt.zd({environment:t,inviteTargetsStore:s})&&(pt.a6(t),h())},maxLength:1e3})]})}function Sn(e){window.__c={n:"InviteSection"};const{store:t,menuListStore:s,sudoModeStore:l,contextualInviteStore:d}=e,c=(0,n.O7)(),u=(0,r.useIntl)(),m=(0,a.qz)(e.inviteTargetsStore,L.ZP),{display:p,source:g,focus:h,emailMessage:f}=(0,a.VK)((()=>{const{display:e}=_.ZP.state;return e===_.wV.Invite?_.ZP.state:{display:e,source:void 0,focus:void 0,emailMessage:""}}),[]),y=()=>{m.reset(),_.ZP.setState({..._.ZP.state,tab:_.XF.Share,display:_.wV.MainShareMenu})},[S,b]=(0,i.useState)("editor"),M=(0,a.VK)((()=>t.getType()),[t]),w=(0,a.VK)((()=>d.state.flowId),[d]),j=(0,a.VK)((()=>m.state.inviteTargets),[m]),C=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),T=(0,a.VK)((()=>new Set(null==C?void 0:C.getEmailDomains())),[C]),I=(0,a.VK)((()=>{const{data:e}=bt.default.state,t=e?Te.CM(e):[],s={};return t.forEach((e=>{s[e.userId]=e})),s}),[]),P=e=>!ht.$s({contextualInviteUser:e,allowedDomains:T}),Z=(0,a.VK)((()=>t.canEditMembership()),[t]),F=(0,a.VK)((()=>{const e=j.filter((e=>{let{type:t}=e;return"newUser"===t})).map((e=>{let{value:t}=e;return t.email})),t=j.filter((e=>{let{type:t}=e;return"existingUser"===t})).map((e=>{let{value:t}=e;return t.id}));return v.dA(c,[...e,...t])}),[c,j]),A=(0,ft.Z)(t),D=(0,a.VK)((()=>{const e=A.isStoreInTeam&&!A.teamAllowsGuests,t=!A.isStoreInTeam&&!A.spaceAllowsGuests||A.isStoreInTeam&&!A.teamAllowsGuests&&!A.spaceAllowsGuests,s=j.some((e=>"newUser"===e.type||("existingUser"===e.type?"none"===e.spaceRole||"not_in_space"===e.spaceRole:void 0)));return(e||t)&&s}),[j,A]),B=(0,a.VK)((()=>{const{currentSpaceStore:e}=x.default.state;return(0,gt.gp)({currentSpaceStore:e})}),[]),N=(0,i.useCallback)((e=>{const t=e.type;if("existingUser"===t){const t=I[e.value.id];if(!t)return!0;return"none"===t.role&&!t.isTeamGuest&&t.isPageGuest}return"newUser"===t||"group"!==t&&void 0}),[I]),O=(0,a.VK)((()=>{if(!C)return"control";if(!(0,ht.ch)({environment:c,spaceStore:C,contextualInviteStore:d}))return"control";return j.filter(N).length>0?(0,gt.kG)(c):"control"}),[j,c,N,C,d]),V=(0,yt.i)(t),U=f.length>1e3,W=j.length>0,K=(0,o.yK)((()=>({permissionsRoleSelectButton:{display:"flex",whiteSpace:"nowrap",height:20,margin:0,borderRadius:3,color:E.ZP.uiGray}})),[]);async function H(){const e=j.filter(N),s=j.filter((e=>!N(e)));"control"===O?await pt.qg({environment:c,intl:u,inviteOrigin:"page_share_modal",role:S,emailMessage:f,inviteTargetsStore:m,blockStore:t,sudoModeStore:l,flowId:d.state.flowId,onInviteClick:()=>{y(),(e=>{d.setState({...d.state,invitedUsers:e.filter(N).map(ht.Si).filter(R.$K).filter(P)}),C&&ht.fr({environment:c,spaceStore:C,contextualInviteStore:d})})(j)},onInviteComplete:e=>pt.Cv({success:e,inviteTargets:j})}):(s.length>0&&(m.setState({...m.state,inviteTargets:s}),await pt.qg({environment:c,intl:u,inviteOrigin:"page_share_modal",role:S,emailMessage:f,inviteTargetsStore:m,blockStore:t,sudoModeStore:l,flowId:d.state.flowId,onInviteClick:()=>{m.reset()},onInviteComplete:e=>pt.Cv({success:e,inviteTargets:s})})),((e,t,s,i)=>{d.setState({...d.state,invitedUsers:e.filter(N).map(ht.Si).filter(R.$K).filter(P),inviteTargets:e,shareModalGuestMemberConfirmationExpGroup:t,callbackAsyncFn:s,resetShareMenuFn:i}),C&&(ht.fr({environment:c,spaceStore:C,contextualInviteStore:d}),d.setState({...d.state,selection:k.uq.closed}))})(j,O,(async()=>(m.setState({...m.state,inviteTargets:e}),await pt.qg({environment:c,intl:u,inviteOrigin:"page_share_modal",role:S,emailMessage:f,inviteTargetsStore:m,blockStore:t,sudoModeStore:l,flowId:d.state.flowId,onInviteClick:()=>{y()},onInviteComplete:t=>pt.Cv({success:t,inviteTargets:e})}))),(()=>{y()})))}async function G(){void 0===s.state.focus.indexGlobal&&void 0===s.state.focus.indexLocal&&void 0===s.state.focus.section&&await H()}let q;return q=D?V:U?(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.emailOverMaxLength.tooltip",defaultMessage:"Message exceeds the limit of 1000 characters."}):void 0,(0,z.jsx)(ve.Z,{disableTooltip:Z,renderTooltip:()=>{if(!Z)return(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.fullAccessOnlyMessage.tooltip",defaultMessage:"Only those with full access can add people."})},render:e=>(0,z.jsxs)("div",{style:{display:"flex"},...e,children:[(0,z.jsx)(Nt,{store:t,inviteTargetsStore:m,flowId:w,disabled:!Z,origin:"share_menu_v2",focus:h===_.Sw.Search,hideIconColorAndTooltips:"control"!==O,onFocus:()=>{_.ZP.setState({..._.ZP.state,tab:_.XF.Share,display:_.wV.Invite,focus:_.Sw.Search,source:g||_.T5.Notion,emailMessage:f||""}),we.yEH(c,{source:g||_.T5.Notion})},onSubmit:G,placeholder:B?u.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder.exp",defaultMessage:"Email or group, separated by commas"}):u.formatMessage({id:"shareMenu.inviteTargetsInput.placeholder",defaultMessage:"Add people, groups, or emails..."}),right:W&&(0,z.jsx)(jt.ZP,{disabled:!Z,role:S,table:"block",type:"user_permission",blockType:M,isInvite:!0,upgradeButtonName:"invite_permission_block",buttonStyle:K.permissionsRoleSelectButton,isMenuItem:!1,onChange:e=>b(e)})}),F?(0,z.jsx)(bn,{onClick:()=>mt.Vu({environment:c,upgradeButtonName:"user_permission_item"})}):(0,z.jsx)(Mn,{tooltip:q,disabled:!Z||D||U,onClick:async()=>{p!==_.wV.MainShareMenu?await H():_.ZP.setState({..._.ZP.state,tab:_.XF.Share,display:_.wV.Invite,focus:_.Sw.Search,source:_.T5.Notion,emailMessage:""})}})]})})}function bn(e){const{onClick:t}=e;return(0,z.jsx)(ve.Z,{disableTooltip:!1,renderTooltip:()=>(0,z.jsx)(Ct.e,{}),render:e=>(0,z.jsx)(le.Z,{isLarge:!0,style:{marginLeft:8},onClick:t,...e,children:(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.upgrade",defaultMessage:"Upgrade"})})})}function Mn(e){const{tooltip:t,disabled:s,onClick:i}=e;return(0,z.jsx)(ve.Z,{disableTooltip:!Boolean(t),renderTooltip:()=>t,render:e=>(0,z.jsx)(le.Z,{isLarge:!0,style:{marginLeft:8},disabled:s,onClick:i,...e,children:(0,z.jsx)(r.FormattedMessage,{id:"shareMenu.inviteButton.invite",defaultMessage:"Invite"})})})}function wn(e){window.__c={n:"EmailMessageInput"};const{open:t,focus:s,value:i,maxLength:n,onFocus:a,onChange:l,onCancel:d}=e,c=(0,r.useIntl)(),u=i.length/n>=.8,m=(0,ct.TQ)(i),p=u||m,g=(0,o.yK)((e=>({container:{maxHeight:t?100:0,position:"absolute",bottom:0,width:"100%",backgroundColor:e.modalBackground,pointerEvents:t?"all":"none",transitionProperty:"max-height",transitionDuration:"0.3s",boxShadow:"0px -4px 4px rgba(0, 0, 0, 0.03)",overflow:"hidden",zIndex:1},input:{maxHeight:t?100:0,borderTop:1,borderTopStyle:"solid",borderTopColor:e.regularDividerColor,padding:18,fontSize:14,transitionProperty:"max-height",transitionDuration:"0.3s"}})),[t]),h=c.formatMessage({id:"shareMenu.emailMessageInput.placeholder",defaultMessage:"Add a message to your invite..."});return(0,z.jsxs)("div",{style:g.container,children:[p&&(0,z.jsx)(jn,{value:i,maxLength:n,shouldShowLengthWarning:u,shouldShowLinkWarning:m}),(0,z.jsx)(Pe.Z,{textarea:!0,focusInitial:!1,format:Pe.B.Transparent,placeholder:h,maxlength:n,focus:s,value:i,onFocus:a,onChange:l,inputStyle:g.input,onCancel:d})]})}function jn(e){window.__c={n:"EmailMessageWarning"};const{shouldShowLengthWarning:t,shouldShowLinkWarning:s,value:i,maxLength:n}=e,a=(0,o.yK)((e=>({container:{position:"absolute",top:0,display:"flex",justifyContent:"center",fontSize:12,color:e.lightTextColor,width:"100%"},warning:{display:"flex",justifyContent:"center",width:"calc(100% - 36px)",backgroundColor:e.modalBackground,marginTop:1}})),[]);return(0,z.jsx)("div",{style:a.container,children:(0,z.jsxs)("div",{style:a.warning,children:[t&&(0,z.jsx)(r.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:i.length,maxCharacters:n}}),t&&s&&" · ",s&&(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})})}const Cn=function(e){window.__c={n:"ShareMenuInviteTab"};const{store:t,permissionItemArgs:s,inviteTargetsStore:i}=e,r=(0,n.Fy)(),l=(0,a.qz)(void 0,St.Z),{display:d}=(0,a.VK)((()=>_.ZP.state),[]),c=(0,o.yK)((()=>({container:{position:"relative",height:d!==_.wV.MainShareMenu?540:"unset",transition:"all",transitionDuration:"0.3s",display:"flex",flexDirection:"column",maxHeight:540},searchBar:{paddingLeft:14,paddingRight:14,paddingBottom:8}})),[d]);return(0,z.jsx)(Mt.Z,{capture:!0,onTab:function(e){e.preventDefault(),r.isMobile||d!==_.wV.MainShareMenu||_.ZP.setState({..._.ZP.state,tab:_.XF.Share,display:_.wV.Invite,focus:_.Sw.Search,source:_.T5.Notion,emailMessage:""})},children:(0,z.jsxs)("div",{style:c.container,children:[(0,z.jsx)("div",{style:c.searchBar,children:r.isMobile?(0,z.jsx)(Wt,{store:t,permissionItemArgs:s}):(0,z.jsx)(Sn,{store:t,inviteTargetsStore:i,menuListStore:l,sudoModeStore:s.sudoModeStore,contextualInviteStore:e.contextualInviteStore})}),d===_.wV.MainShareMenu&&(0,z.jsx)(Ui,{store:t,calculatedPermissions:e.calculatedPermissions,buttonPopupStore:e.buttonPopupStore,permissionItemArgs:s}),d===_.wV.Invite&&!r.isMobile&&(0,z.jsx)(xn,{store:t,inviteTargetsStore:i,menuListStore:l,calculatedPermissions:e.calculatedPermissions,permissionItemArgs:e.permissionItemArgs})]})})};var kn=s(62397);const _n=function(e){window.__c={n:"WorkspaceOwnerPermissionOverride"};const{store:t,sudoModeStore:s}=e,i=(0,a.VK)((()=>s.state.changePermissionsEnabled),[s]),n=(0,a.VK)((()=>s&&s.shouldUserHaveAccessToPrivatePageBlock()&&!s.doesUserAlreadyHaveEditorAccessOnBlock(t.id)&&s.state.privatePageStore),[s,t]),l=(0,o.yK)((e=>({container:{background:e.cardBackground,padding:"12px 18px",boxShadow:e.borderBoxShadow,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"baseline"},button:{fontWeight:G.Z.fontWeight.medium,justifyContent:"center",marginTop:8,opacity:i?.5:1},icon:{width:16,height:16,marginRight:6,transition:"all 200ms ease",transform:i?"rotate(-90deg)":void 0}})),[i]);return n?(0,z.jsxs)("div",{style:l.container,children:[(0,z.jsx)(A.Z,{isMultiline:!0,children:(0,z.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessage",defaultMessage:"As a <b>workspace owner</b>, you can change the permissions of this page to add yourself or others. Any changes will appear in the audit log.",values:{b:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,z.jsx)("b",{children:t})}}})}),(0,z.jsxs)(ye.Z,{disabled:i,style:l.button,onClick:()=>{s.setState({...s.state,changePermissionsEnabled:!0})},children:[(0,kn.I)(l.icon),i?(0,z.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.isChangingPermissionsMessageButton",defaultMessage:"Changing permissions"}):(0,z.jsx)(r.FormattedMessage,{id:"blockPermissionsSettings.workspaceOwner.canChangePermissionsMessageButton",defaultMessage:"Change permissions"})]})]}):null};function Tn(e){window.__c={n:"ShareMenuContent"};const t=(0,a.VK)((()=>_.ZP.state.tab),[]);switch(t){case _.XF.Share:return(0,z.jsx)(Cn,{...e});case _.XF.Publish:return(0,z.jsx)(lt,{store:e.store,permissionItemArgs:e.permissionItemArgs,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem});default:(0,R.t1)(t)}}const In=function(e){window.__c={n:"ShareMenu"};const{store:t,permissionItemArgs:s}=e,i=(0,n.Fy)(),r=(0,a.qz)(e.inviteTargetsStore,L.ZP),l=(0,o.yK)((()=>({container:{display:"flex",flexDirection:"column",height:"100%"}})),[]);return(0,z.jsxs)("div",{style:l.container,children:[s.sudoModeStore&&(0,z.jsx)(_n,{store:t,sudoModeStore:s.sudoModeStore}),!i.isMobile&&(0,z.jsx)(J,{inviteTargetsStore:r,mostPermissivePublicItem:e.calculatedPermissions.mostPermissivePublicItem}),(0,z.jsx)(Tn,{inviteTargetsStore:r,...e})]})};function Pn(){window.__c={n:"OfflineMessage"};const e=(0,n.Fy)(),t=(0,o.yK)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"center",height:160}})),[]);return(0,z.jsx)("div",{style:t.container,children:(0,z.jsx)(A.Z,{isMobile:e.isMobile,isSecondaryColor:!0,isMultiline:!0,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Please go online to publish & share.",id:"blockPermissionsSettings.offline.prompt"})})})}const Zn=function(e){window.__c={n:"ShareMenuContainer"};const{store:t,sudoModeStore:s,onUpgradeButtonClick:u,location:m}=e,p=(0,n.Fy)(),g=(0,a.qz)(void 0,T.Z),{contextualInviteStore:h}=(0,a.VK)((()=>g.state),[g]),f=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),y=(0,a.VK)((()=>j({spaceStore:f,store:t})),[f,t]),v=(0,a.VK)((()=>h.state.inviteStage),[h]),S=(0,a.VK)((()=>_.ZP.state.tab),[]),b=(0,o.yK)((()=>({title:{fontSize:18},topbarStyle:{paddingTop:15,paddingBottom:15,height:"auto"}})),[]),M=(0,i.useMemo)((()=>({onUpgradeButtonClick:u,sudoModeStore:s,location:m})),[u,s,m]);if(!f)return null;if(!p.isMobile&&(v===k.TG.share_workspace||v===k.TG.request_workspace))return(0,z.jsx)(B.Z,{blockStore:t,spaceStore:f,contextualInviteStore:h});const w=p.isMobile?{menuType:d.og.Modal,disableHeaderShadow:!0,title:(0,z.jsx)(A.Z,{isMobile:p.isMobile,style:b.title,children:(0,z.jsx)(r.FormattedMessage,{defaultMessage:"Share",id:"blockPermissionsSettings.mobileShareMenu.title"})}),additionalTopbarContent:(0,z.jsx)(te,{mostPermissivePublicItem:y.mostPermissivePublicItem}),left:(0,z.jsx)(D.Z,{href:(0,c.UY)("guides.sharing"),analyticsFrom:"sharing"}),footer:S===_.XF.Share&&(0,z.jsx)(di,{store:t,buttonPopupStore:e.buttonPopupStore,calculatedPermissions:y,permissionItemArgs:M}),topbarStyle:b.topbarStyle,right:(0,z.jsx)(F.DoneMenuText,{}),onClickRight:e.onClose,whiteBackground:!0}:{menuType:d.og.Popup,maxHeight:"90vh"};return(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(Z.Z,{...w,className:l.B8p,children:(0,z.jsx)(I.Z,{capture:!0,allowEsc:!0,children:(0,z.jsx)(P.Z,{capture:!0,ignoreBlockSelection:!0,restoreSelection:!1,focusOffscreenInput:!1,render:()=>C.Z.state.online?(0,z.jsx)(In,{store:t,permissionItemArgs:M,calculatedPermissions:y,buttonPopupStore:e.buttonPopupStore,inviteTargetsStore:e.inviteTargetsStore,contextualInviteStore:h}):(0,z.jsx)(Pn,{})})})})})}},20239:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});s(67294);var i=s(83355),n=s(42875),a=s(72126),o=s(94044),r=s(5366),l=s(4708),d=s(79817),c=s(87279),u=s(45101),m=s(65598),p=s(38755),g=s(95697),h=s(4023),f=s(80444),y=s(85834),v=s(52878),x=s(74194),S=s(78140),b=s(89728),M=s(53437),w=s(57806),j=s(32357),C=s(480),k=s(86628),_=s(24405),T=s(84169),I=s(50906),P=s(18514),Z=s(16354),F=s(64369),A=s(85893);function D(e){window.__c={n:"LearnAboutSharingLink"};const t=(0,C.O7)(),{device:s,WindowSizeStore:i}=t,n=(0,k.VK)((()=>({left:i.getSafePaddingLeftCSS(8),right:i.getSafePaddingRightCSS(12)})),[i]),a=(0,k.VK)((()=>(0,g.bq)()),[]),o=(0,_.yK)((e=>({button:{display:"flex",alignItems:"center",width:s.isMobile?"100%":void 0,height:s.isMobile?44:24,paddingTop:s.isMobile?12:4,paddingBottom:s.isMobile?12:4,paddingLeft:n.left,paddingRight:n.right},helpIcon:{width:s.isMobile?16:14,height:s.isMobile?16:14,fill:s.isMobile?e.mediumIconColor:e.lightIconColor}})),[s.isMobile,n]);return(0,A.jsx)(Z.Z,{href:(0,P.UY)("guides.sharing"),onClick:()=>I.Fsx(t,{from:"sharing"}),style:{width:s.isMobile?"100%":void 0},external:!0,children:(0,A.jsxs)(b.Z,{mobileFeedback:s.isMobile,isSmall:!0,style:{...o.button,...e.style},disabled:Boolean(e.disableHover),children:[(0,A.jsx)("div",{style:{marginLeft:s.isMobile?2:0,marginRight:s.isMobile?8:6},children:(0,T.m)(o.helpIcon)}),(0,A.jsx)(F.Z,{isSmall:!0,isMobile:s.isMobile,isSecondaryColor:!s.isMobile,children:a?(0,A.jsx)(r.FormattedMessage,{defaultMessage:"Learn more",id:"blockPermissionsSettings.learnMore.prompt"}):(0,A.jsx)(r.FormattedMessage,{defaultMessage:"Learn about sharing",id:"blockPermissionsSettings.learnAboutSharing.prompt"})})]})})}D.displayName="LearnAboutSharingLink";const B=D;class R extends i.Z{constructor(){super(...arguments),this.storeTypes={universalInviteStore:v.Z},this.renderEmailInput=this.createComputedStore((()=>"milestone_2"===this.props.mode))}renderComponent(){const{universalInviteStore:e}=this.stores,{permissionsInviteStore:t,contextualInviteStore:s}=e.state,i=e.stage,{spaceStore:n}=this.props;if(this.environment.device.isMobile||i===y.TG.closed)return null;if(!(0,m.Mm)(this.props.store)&&(i===y.TG.share_workspace||i===y.TG.request_workspace))return(0,A.jsx)(j.Z,{blockStore:this.props.store,spaceStore:n,contextualInviteStore:s});if(i===y.TG.share_page){const i={...this.props,renderInShareMenu:!0,spaceStore:n,permissionsInviteStore:t,contextualInviteStore:s,onInviteClick:()=>{(0,g.$)(this.environment)?s.setState({...s.state,inviteStage:y.TG.closed}):d.fr({environment:this.environment,spaceStore:n,contextualInviteStore:s})},onInviteComplete:e=>{d.x5({success:e,intl:this.props.intl,contextualInviteStore:s})},onCancel:async()=>{await(0,u.Aw)({environment:this.environment,permissionsInviteStoreState:t.state,from:"share_menu"})||e.reset()}};return this.renderEmailInput.state?(0,A.jsx)(L,{...i}):(0,A.jsx)(w.default,{...i})}}}R.displayName="UniversalMemberInvite";class L extends w.PermissionsInviteBase{constructor(){super(...arguments),this.inviteTargetLength=this.createComputedStore((()=>this.stores.permissionsInviteStore.state.inviteTargets.length)),this.blockTitle=this.createComputedStore((()=>{if((0,m.Mm)(this.props.store))return"";const e=this.props.store;if(!e.isDefined())return"";const t=e.getModel().getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:(0,n.r)(),intl:this.props.intl});return t||e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,n.r)(),intl:this.props.intl})})),this.handleInviteInputSubmit=async()=>{const{permissionsInviteStore:e}=this.stores;"invitee"===e.state.inputFocus?e.setState({...e.state,inputFocus:"email-content"}):await super.handleInviteInputSubmit()},this.resetFocusOnClickEmpty=e=>{const{permissionsInviteStore:t}=this.stores;e.currentTarget===e.target&&t.setState({...t.state,inputFocus:"none"})}}renderComponent(){return this.renderInShareMenu.state?this.renderUniversalInviteInner():super.renderComponent()}renderUniversalInviteInner(){const{permissionsInviteStore:e}=this.stores;return(0,A.jsxs)("div",{style:this.getContainerStyle(),onClick:this.resetFocusOnClickEmpty,children:[(0,A.jsx)(M.ZP,{popupType:M.kQ.Popup,alignmentToOrigin:h.v.Start,placementToOrigin:h.u.Bottom,open:"invitee"===e.state.inputFocus,originGap:10,disableMouseCapture:!0,forceRemeasureStore:this.inviteTargetLength,origin:super.renderHeader(),onDismiss:()=>{e.setState({...e.state,inputFocus:"email-content"})},render:()=>{const e=super.renderSearchRequest(),t={menuType:c.og.Popup,disableScroller:!1};return(0,A.jsx)("div",{children:(0,A.jsx)(S.Z,{...t,children:e})})},style:{width:360}}),this.renderEmailMessageInput(),this.renderSinglePlayerOptions(),this.renderActions()]})}renderEmailMessageInput(){const{permissionsInviteStore:e}=this.stores,t=this.getEmailMessage(),{inputFocus:s,emailMessage:i}=e.state,n=i.length/o.vr>=.8,a=(0,o.TQ)(i),r=n||a,d=(0,l._6)(this.environment),c="email-content"===s;return(0,A.jsx)(x.Z,{textarea:!0,value:i,focus:c,focusInitial:!1,maxlength:o.vr,onFocus:()=>{e.setState({...e.state,inputFocus:"email-content"})},style:{background:c?"none":this.theme.inputBackground,alignItems:"flex-start",paddingLeft:12,paddingRight:12,paddingTop:8,paddingBottom:r?34:12},inputStyle:{minHeight:d?80:100},placeholder:t,onChange:t=>{e.setState({...e.state,emailMessage:t.target.value})},right:r&&this.renderMessageWarning({shouldShowLengthWarning:n,shouldShowLinkWarning:a}),isRightLastElementOfInput:!0,onSubmit:async()=>{await super.handleInviteClick()}})}renderSinglePlayerOptions(){if((0,m.Mm)(this.props.store))return null;const{contextualInviteStore:e,permissionsInviteStore:t}=this.stores,{currentSpaceStore:s}=f.default.state;if(!s)return null;if(!(0,g.$)(this.environment))return null;const{inviteTargets:i}=t.state;return!t.state.isInviteTargetsEmpty&&i.some((e=>u.OA(e)))?(0,A.jsx)(j.Z,{blockStore:this.props.store,spaceStore:s,contextualInviteStore:e}):null}renderActions(){return(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",alignItems:"center",width:"100%"},onClick:this.resetFocusOnClickEmpty,children:[(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"flex-end",gap:8},children:[this.renderDesktopInputRightInnerButton({isLarge:!1}),(0,A.jsx)(b.Z,{style:{minWidth:o.UF,justifyContent:"center"},isLarge:!1,isLightGray:!0,onClick:()=>{var e,t;null===(e=(t=this.props).onCancel)||void 0===e||e.call(t)},children:(0,A.jsx)(r.FormattedMessage,{defaultMessage:"Cancel",id:"ContextualInvite.permissions_invites.button.cancel"})})]}),(0,A.jsx)(B,{style:{paddingLeft:0,paddingRight:0},disableHover:!0})]})}renderMessageWarning(e){const{permissionsInviteStore:t}=this.stores,{shouldShowLengthWarning:s,shouldShowLinkWarning:i}=e;return(0,A.jsxs)("span",{style:{fontSize:12,color:this.theme.lightTextColor,position:"absolute",bottom:8,left:12},children:[s&&(0,A.jsx)(r.FormattedMessage,{defaultMessage:"{characters} / {maxCharacters} characters",id:"ContextualInvite.permissions_invites.messageLengthWarning",values:{characters:t.state.emailMessage.length,maxCharacters:o.vr}}),s&&i&&" · ",i&&(0,A.jsx)(r.FormattedMessage,{defaultMessage:"Links will be omitted from your message",id:"ContextualInvite.permissions_invites.removeLinkWarning"})]})}getEmailMessage(){const{currentUserStore:e,currentSpaceStore:t}=f.default.state,{permissionsInviteStore:s}=this.stores,{intl:i}=this.props,{inviteTargets:n}=s.state,r=!s.state.isInviteTargetsEmpty&&a.yW(n,u.OA);if(!t)return i.formatMessage(o.VX.default);const l=null==e?void 0:e.getDisplayName(i),d=(0,p.rn)(this.environment,t);if(!l||!d)return i.formatMessage(o.VX.default);return(0,o.jm)({includeOptional:!1,isGuest:r,emailProps:{userName:l,pageName:this.blockTitle.state,spaceName:d},intl:this.props.intl})}getContainerStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",minHeight:52,paddingTop:10,paddingBottom:10,paddingLeft:e.getSafePaddingLeftCSS(14),paddingRight:e.getSafePaddingRightCSS(14),flexDirection:"column",gap:10}}}const N=(0,r.injectIntl)(R)},67579:(e,t,s)=>{s.d(t,{f:()=>y});var i=s(67294),n=s(24405),a=s(69651),o=s(73123),r=s(33929),l=s(87279),d=s(33338),c=s(52275),u=s(78140),m=s(32163),p=s(53437),g=s(72495),h=s(91642),f=s(85893);function y(e){window.__c={n:"DateFilter"};const t=(0,n.yK)((e=>({popup:{width:125,marginLeft:5},pillStyle:{display:"flex",alignItems:"center"}})),[]),{currentFilter:s,hideAllTime:y}=e,[v,x]=(0,i.useState)(!1),S=o.Hz.filter((e=>!y||"all_time"!==e)).map((t=>{const s=()=>{e.onChangeFilter(t),x(!1)};return{key:t,action:()=>{},render:()=>(0,f.jsx)(c.Z,{focused:!1,onClick:s,title:r.default.formatMessage(o.Rh[t])})}})),b=(0,f.jsx)(d.Z,{on:Boolean(s),wrapStyle:t.pillStyle,icon:(0,a.C)({width:16,marginRight:6,fill:"currentColor"}),title:r.default.formatMessage(o.Rh[s]),onClick:()=>{x(!0)}}),M=[{key:"filters",items:S,render:e=>(0,f.jsx)(g.Z,{...e,title:null,loading:!1})}],w=(0,f.jsx)(u.Z,{menuType:l.og.Popup,header:null,children:(0,f.jsx)(m.Z,{type:m.i.Vertical,initialFocus:0,sections:M})});return(0,f.jsx)(h.Z,{marginAfter:!1,children:(0,f.jsx)(p.ZP,{popupType:p.ZP.PopupType.Popup,placementToOrigin:p.ZP.Placement.Bottom,alignmentToOrigin:p.ZP.Alignment.Start,open:v,render:()=>w,onDismiss:()=>x(!1),keepFocus:!0,origin:b,preventScaleTransition:!0,style:t.popup})})}},62889:(e,t,s)=>{s.r(t),s.d(t,{CreateTeamFromPageConfirmModal:()=>f});s(67294);var i=s(480),n=s(24405),a=s(62208),o=s(5366),r=s(82990),l=s(72684),d=s(73466),c=s(42922),u=s(63296),m=s(92660),p=s(29551),g=s(51923),h=s(85893);function f(){window.__c={n:"CreateTeamFromPageConfirmModal"};const e=(0,i.O7)(),t=(0,o.useIntl)(),s=(0,n.yK)((e=>({modal:{maxWidth:350,padding:24},loopIcon:{height:28,width:28,fill:e.darkTextColor},infoIcon:{height:16,width:16,fill:e.lightIconColor,marginRight:4},title:{marginTop:16,marginBottom:12,color:e.regularTextColor,fontWeight:r.Z.fontWeight.semibold,fontSize:18},description:{color:e.darkTextColor,textAlign:"center",fontSize:14,marginBottom:18},confirmButton:{width:"100%",marginBottom:8},cancelButton:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:14}})),[]);return(0,h.jsx)(m.Z,{onDismiss:()=>{l.Z.setState({open:!1})},render:()=>(0,h.jsx)("div",{style:s.modal,children:(0,h.jsxs)(p.gq,{flexDirection:"column",justifyContent:"center",alignItems:"center",children:[(0,a.z)(s.loopIcon),(0,h.jsx)("div",{style:s.title,children:(0,h.jsx)(o.FormattedMessage,{id:"createTeamFromPage.confirmModal.title",defaultMessage:"Turn into teamspace?"})}),(0,h.jsx)("div",{style:s.description,children:(0,h.jsx)(o.FormattedMessage,{id:"createTeamFromPage.confirmModal.description",defaultMessage:"This will move this page into a newly created teamspace along with people who already have access to this page."})}),(0,h.jsx)(c.Z,{isLarge:!0,style:s.confirmButton,onClick:()=>{if(l.Z.state.open){const{pageStore:s,flowId:i}=l.Z.state;d.Sq({environment:e,intl:t,page:s,flowId:i}),l.Z.setState({open:!1})}},children:(0,h.jsx)(o.FormattedMessage,{id:"createTeamFromPage.confirmModal.confirmButton",defaultMessage:"Create teamspace"})}),(0,h.jsx)(u.Z,{isLarge:!0,style:s.cancelButton,onClick:()=>l.Z.setState({open:!1}),children:(0,h.jsx)(o.FormattedMessage,{id:"createTeamFromPage.confirmModal.cancelButton",defaultMessage:"Cancel"})}),(0,h.jsx)(g.Z,{message:(0,h.jsx)(o.FormattedMessage,{id:"createTeamFromPage.confirmModal.learnMore",defaultMessage:"Learn more about teamspaces"}),analyticsFrom:"teams_learn_more_turn_page_into_team",helpCenterLocation:"bestPractices"})]})}),requireOnline:!0,modalStore:l.Z})}},95146:(e,t,s)=>{s.r(t),s.d(t,{SidebarCreateTeamModal:()=>te});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(41892),l=s(64275),d=s(49364),c=s(72126),u=s(97880),m=s(82990),p=s(5366),g=s(50906),h=s(33929),f=s(38755),y=s(95697),v=s(68418),x=s(80444),S=s(90106),b=s(33052),M=s(35817),w=s(64921),j=s(74194),C=s(3386),k=s(68785),_=s(50506),T=s(64369),I=s(45653),P=s(13490),Z=s(78122),F=s(35057),A=s(73466),D=s(42922),B=s(51923),R=s(85893);function L(){window.__c={n:"SidebarCreateTeamModalFooter"};const e=(0,n.O7)(),{currentSpaceStore:t,spaceViewStore:s}=(0,a.VK)((()=>({currentSpaceStore:x.default.state.currentSpaceStore,spaceViewStore:x.default.state.currentSpaceViewStore})),[]),r=(0,a.VK)((()=>v.Z.state),[]),l=(0,y.OX)(),d=function(){const e=(0,a.VK)((()=>F.Mk()&&!v.Z.state.isDefault),[]),t=v.F.Team,s=v.F.Members;return e?[t,s]:[t]}(),{screen:m,pageNumber:g,teamId:h}=r,f=""===r.name,b=(0,o.yK)((e=>({box:{justifyContent:"space-between",alignItems:"center",display:"flex",width:"100%",paddingTop:22},button:{marginLeft:8},previous:{fontSize:14,color:e.mediumTextColor,cursor:"pointer"},learnMoreLink:{overflow:"hidden"}})),[]),w=(0,i.useCallback)(((s,i)=>{t&&function(e){let{pageOrder:t,pageNumber:s,teamId:i,currentSpaceStore:n,environment:a,from:o}=e;const r=s+1;if(r<=t.length)v.Z.update((e=>({...e,loading:!1,screen:t[r-1],pageNumber:r})));else if(i){const e=S.zX.createChildStore(n,{table:"team",id:i,spaceId:n.id});M.hI({environment:a,teamStore:e,shouldScroll:!0}),M.ED({environment:a,from:o,teamStore:e})}}({pageOrder:d,pageNumber:g,teamId:i||h,currentSpaceStore:t,environment:e,from:s})}),[t,e,g,d,h]),j=c.Ds((async()=>{if(!t||!s)return;let i=h;switch(m){case v.F.Team:i=await async function(e){var t;let{spaceStore:s,environment:i,shouldShowZeroTeamsExperience:n,sidebarCreateTeamModalStoreState:a}=e;const{name:o,description:r,icon:l,flowId:d,accessLevel:c,isDefault:u}=a;if(!(await(0,Z.Xg)({environment:i,spaceStore:s,teamName:o})))return;let m;v.Z.update((e=>({...e,loading:!0}))),m=n?await A.HD({environment:i,name:o,description:r,icon:l,flowId:d,trackCreateTeamComplete:!0}):await A.Cm({environment:i,name:o,description:r,icon:l,accessLevel:c,isDefault:u,flowId:d,createTeamHome:!0});if(!m)return;const p=null===(t=m)||void 0===t?void 0:t.id;return v.Z.update((e=>({...e,teamId:p}))),p}({spaceStore:t,environment:e,shouldShowZeroTeamsExperience:l,sidebarCreateTeamModalStoreState:r});break;case v.F.Members:break;default:(0,u.t1)(m)}i?w("success",i):v.Z.update((e=>({...e,loading:!1})))}),1e3,{leading:!0,trailing:!1}),C=(0,i.useCallback)(j,[j]);return(0,R.jsxs)("div",{style:b.box,children:[(0,R.jsx)(B.Z,{containerStyle:b.learnMoreLink,helpCenterLocation:"bestPractices",analyticsFrom:"teams_learn_more_sidebar_create_team_modal"}),(0,R.jsx)("div",{style:{display:"inline-flex"},children:(0,R.jsx)(D.Z,{isLarge:!0,onClick:C,disabled:f,style:b.button,children:(0,R.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.footer.createTeam",defaultMessage:"Create teamspace"})})})]})}var N=s(65426),E=s(30688),O=s(93686);const V={userSelect:"none",WebkitUserSelect:"none",position:"relative",padding:"22px 26px"},U={createTeamContainer:{...V,width:480},addMembersContainer:{...V,width:500},full:{width:"100%"}},W=(0,p.defineMessages)({teamNamePlaceholder:{id:"sidebarCreateTeamModal.teamScreen.namePlaceholder",defaultMessage:"Acme Labs"},teamDescriptionPlaceholder:{id:"sidebarCreateTeamModal.teamScreen.descriptionPlaceholder",defaultMessage:"Details about your teamspace"}});function z(){window.__c={n:"TeamDescriptionRow"};const[e,t]=(0,a.AF)(v.Z);return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(P.Z,{hasMarginTop:!0,children:(0,R.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamDescriptionLabel",defaultMessage:"Description"})}),(0,R.jsx)(j.Z,{value:e.description,placeholder:h.default.formatMessage(W.teamDescriptionPlaceholder),textarea:!0,onChange:s=>{t({...e,description:s.target.value})}})]})}function K(e){return(0,R.jsx)("div",{id:e.titleAriaId,style:{fontSize:18,fontWeight:m.Z.fontWeight.semibold},children:(()=>{switch(e.screen){case v.F.Team:return(0,R.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamTitle.label",defaultMessage:"Create a new teamspace"});case v.F.Members:return(0,R.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.membersTitle.label",defaultMessage:"Add people"});default:(0,u.t1)(e.screen)}})()})}function H(e){window.__c={n:"ModalContent"};const t=(0,n.O7)(),[s]=(0,a.AF)(v.Z),o=(0,i.useCallback)(((e,s)=>{M.ED({environment:t,from:s,teamStore:e})}),[t]),{screen:r}=s;switch(r){case v.F.Team:return(0,R.jsx)(Y,{titleAriaId:e.titleAriaId,descriptionAriaId:e.descriptionAriaId});case v.F.Members:const t=s.teamId;return t?(0,R.jsx)(X,{teamId:t,onCompleted:e=>{o(e,"success")},onCanceled:e=>{o(e,"dismiss_button")}}):null;default:(0,u.t1)(r)}}function G(){window.__c={n:"TeamIconAndNameRow"};const[e,t]=(0,a.AF)(v.Z),s=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]),i=(0,o.yK)((e=>({container:{display:"inline-flex",width:"100%",verticalAlign:"middle"},icon:{marginRight:8,marginTop:1}})),[]);if(!s)return null;const n=e.icon?{icon:e.icon,pointer:{table:"space",id:s.id}}:void 0;return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(P.Z,{hasMarginTop:!0,children:(0,R.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.teamNameLabel",defaultMessage:"Icon & name"})}),(0,R.jsxs)("div",{style:i.container,children:[(0,R.jsx)(O.p,{icon:n,size:26,style:i.icon,onChange:s=>{t({...e,icon:s})},iconLoggingData:{recordTable:"team",source:"team_creation"}}),(0,R.jsx)(j.Z,{value:e.name,placeholder:h.default.formatMessage(W.teamNamePlaceholder),onChange:s=>{t({...e,name:s.target.value})},preventSafariAutofill:!0})]})]})}function q(e){window.__c={n:"Description"};const t=(0,o.yK)((()=>({})),[]);return(0,R.jsx)(T.Z,{id:e.descriptionAriaId,isMultiline:!0,isSmall:!0,isSecondaryColor:!0,style:t.description,children:(()=>{switch(e.screen){case v.F.Team:return(0,R.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamDescription.label",defaultMessage:"Teamspaces are where your team organizes pages, permissions, and members"});case v.F.Members:return null;default:(0,u.t1)(e.screen)}})()})}function Y(e){window.__c={n:"TeamScreen"};const[t]=(0,a.AF)(v.Z),s=(0,n.O7)();return(0,i.useEffect)((()=>{if(t.open){const{from:e,flowId:i}=t;g.krX(s,{from:e,flowId:i})}}),[]),(0,R.jsxs)("div",{style:U.createTeamContainer,children:[(0,R.jsx)(K,{titleAriaId:e.titleAriaId,screen:v.F.Team}),(0,R.jsx)(q,{descriptionAriaId:e.descriptionAriaId,screen:v.F.Team}),(0,R.jsxs)("div",{style:U.full,children:[(0,R.jsx)(G,{}),(0,R.jsx)(z,{}),(0,R.jsx)($,{})]}),(0,R.jsx)(L,{})]})}function Q(){window.__c={n:"ScreenLoadingSpinner"};const e=(0,a.VK)((()=>v.Z.state.loading),[]),t=(0,o.yK)((e=>({spinner:{width:"100%",height:"100%",backgroundColor:e.modalUnderlayBackground,position:"absolute",top:0,left:0}})),[]);return(0,R.jsx)(R.Fragment,{children:e&&(0,R.jsx)("div",{style:t.spinner,children:(0,R.jsx)(k.Z,{style:{position:"absolute",top:"50%",left:"50%"}})})})}function $(){window.__c={n:"AccessLevelSection"};const e=(0,o.yK)((e=>({openAccessMessage:{fontSize:13,color:e.mediumTextColor,marginTop:20,lineHeight:1.4,display:"flex"},iconContainer:{marginRight:8},openTeamIcon:{width:24,fill:e.mediumIconColor},teamAccessPopupContainer:{marginTop:20}})),[]),[t,s]=(0,a.AF)(v.Z),i=(0,y.OX)(),r=(0,n.O7)(),l=(0,a.VK)((()=>{const e=x.default.state.currentSpaceStore;return e?(0,f.rn)(r,e):"this workspace"}),[r]);return i?(0,R.jsxs)("div",{style:e.openAccessMessage,children:[(0,R.jsx)("div",{style:e.iconContainer,children:(0,d.R)(e.openTeamIcon)}),(0,R.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.openAccessLabel",defaultMessage:"Everyone at {spaceName} and new members will have access to this teamspace",values:{spaceName:l}})]}):(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(P.Z,{hasMarginTop:!0,children:(0,R.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.permissionsLabel",defaultMessage:"Permissions"})}),(0,R.jsx)(N._,{currentAccessLevel:t.accessLevel,currentIsDefault:t.isDefault,onChange:(e,i)=>{s(i?{...t,accessLevel:"open",isDefault:i}:{...t,accessLevel:e,isDefault:i})}})]})}function X(e){window.__c={n:"MemberScreen"};const t=(0,n.O7)(),[,,s]=(0,a.AF)(v.Z),[,,i]=(0,a.AF)(void 0,b.Z);(0,a.VK)((()=>{const{defaultInviteTargets:e,flowId:t}=s.state;i.setState({...i.state,flowId:t}),e&&i.setState({...i.state,isInviteTargetsEmpty:!1,inviteTargets:e})}),[s,i]);const o=(0,a.VK)((()=>x.default.state.currentSpaceStore),[]);if(!o)return null;const r=S.zX.createChildStore(o,{table:"team",id:e.teamId,spaceId:o.id});return(0,R.jsx)("div",{style:U.full,children:(0,R.jsx)("div",{style:U.addMembersContainer,children:(0,R.jsx)(E.Z,{store:r,permissionsInviteStore:i,isNewlyCreatedTeam:!0,onSubmitSuccessful:()=>{e.onCompleted(r),M.hI({environment:t,teamStore:r,shouldScroll:!0})},onDismiss:()=>{e.onCanceled(r)}})})})}const J=[r.Z.images.avatars.avatar1Png,r.Z.images.avatars.avatar2Png,r.Z.images.avatars.avatar3Png];function ee(e){let{handleModalClose:t}=e;window.__c={n:"FirstTeamHeader"};const s=(0,o.yK)((e=>({container:{borderTopLeftRadius:5,borderTopRightRadius:5,background:e.inputBackground,boxShadow:e.inputBoxShadow},header:{display:"flex",padding:14,fontWeight:m.Z.fontWeight.medium},avatarGroup:{display:"flex",width:"100",marginLeft:4,alignSelf:"center"},avatar:{marginLeft:-4},message:{paddingLeft:14,paddingRight:14},closeButton:{zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:16,fill:e.mediumTextColor}})),[]);return(0,R.jsx)("div",{style:s.container,children:(0,R.jsxs)("div",{style:s.header,children:[(0,R.jsx)("div",{style:s.avatarGroup,children:J.map(((e,t)=>(0,R.jsx)(I.Z,{avatarShouldShowShadow:!0,style:s.avatar,size:28,avatar:{avatarUrl:e}},t)))}),(0,R.jsx)(T.Z,{style:s.message,isMultiline:!0,isSmall:!0,children:(0,R.jsx)(p.FormattedMessage,{id:"sidebarCreateTeamModal.teamScreen.firstTeamHeader",defaultMessage:"Create your first teamspace to start using Notion with your teammates"})}),(0,R.jsx)(w.Z,{onClick:t,style:s.closeButton,hoveredStyle:s.closeButtonHover,children:(0,l.D)(s.closeButtonIcon)})]})})}function te(){window.__c={n:"SidebarCreateTeamModal"};const e=(0,n.O7)(),[t,,]=(0,a.AF)(v.Z),s=(0,i.useId)(),r=(0,i.useId)(),d=(0,o.yK)((e=>({modal:{maxWidth:500,borderRadius:5},closeButton:{position:"absolute",top:14,right:14,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:e.buttonHoveredBackground,width:20,height:20},closeButtonHover:{background:e.buttonPressedBackground},closeButtonIcon:{width:14,fill:e.mediumTextColor},wrapper:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none"}})),[]),u=(0,i.useCallback)((t=>{M.ED({environment:e,from:t})}),[e]),{open:m,loading:p,screen:g}=t,h=(0,y.OX)(),f=(0,i.useRef)(h);return(0,i.useEffect)((()=>{p||(f.current=h&&g===v.F.Team)}),[p,g,h]),m?(0,R.jsx)(_.Z,{ariaLabelledBy:s,ariaDescribedBy:r,open:m,innerStyle:d.modal,onDismiss:()=>{u("modal")},render:()=>{const{device:t}=e;return(0,R.jsxs)("div",{style:{height:"100%"},children:[!t.isMobile&&(f.current?(0,R.jsx)(ee,{handleModalClose:()=>{u("close_button")}}):(0,R.jsx)(w.Z,{onClick:()=>{u("close_button")},style:d.closeButton,hoveredStyle:d.closeButtonHover,children:(0,l.D)(d.closeButtonIcon)})),(0,R.jsx)("div",{style:d.wrapper,children:(0,R.jsx)(C.Z,{capture:!0,onBackspace:c.yR,onLeft:c.yR,onRight:c.yR,onSelectAll:c.yR,onRedo:c.yR,onUndo:c.yR,onCut:c.yR,onCopy:c.yR,onPaste:c.yR,onKeypress:c.yR,onDelete:c.yR,onTab:c.yR,children:(0,R.jsx)(H,{titleAriaId:s,descriptionAriaId:r})})}),(0,R.jsx)(Q,{})]})}}):null}},65426:(e,t,s)=>{s.d(t,{_:()=>M});s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(36591),r=s(42853),l=s(5257),d=s(87279),c=s(98742),u=s(46874),m=s(63060),p=s(4023),g=s(31194),h=s(52275),f=s(31945),y=s(78140),v=s(32163),x=s(72495),S=s(26388),b=s(85893);function M(e){let{currentAccessLevel:t,currentIsDefault:s=!1,onChange:M,teamStore:w,disabledWithRightChevron:j=!1,style:C}=e;window.__c={n:"TeamAccessLevelButtonPopup"};const{device:k}=(0,i.O7)(),_=(0,u.q)(w),T=(0,a.yK)((e=>({chevron:{width:12,marginLeft:3,marginRight:3,fill:e.lightIconColor},selectedButton:{width:"100%",margin:0,paddingTop:4,paddingBottom:4,border:`1px solid ${e.outlineButtonBorder}`,...C},selectedCheckmark:{width:k.isMobile?16:14},icon:{alignSelf:"center",marginTop:0}})),[k.isMobile,C]),I=(0,n.VK)((()=>(null==w?void 0:w.isDefault())??s),[w,s]),P=I?"default":t,Z=(0,m.U)({teamStore:w,onChange:M,isDefault:I});return(0,b.jsx)(f.ZP,{popupType:k.isMobile?f.Z4.SlideUp:f.Z4.Popup,renderOrigin:e=>{const t=Z.find((e=>e.key===P));if(!t)return null;const s=t.disableAllOptionsTooltip,i=j||Boolean(s)||Boolean(w)&&!_;return(0,b.jsx)(S.Z,{placement:p.u.Bottom,alignment:p.v.Start,disableTooltip:!s||!_,renderTooltip:()=>s,style:{width:350},textWrap:!0,render:s=>(0,b.jsx)(h.Z,{...(0,c.Z)(e,s),title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:T.icon,disabled:i,right:j?(0,l.o)(T.chevron):i?void 0:(0,r.i)(T.chevron),focused:!1,shouldWrapCaption:!0,buttonStyle:T.selectedButton})})},placementToOrigin:g.Iw.Bottom,alignmentToOrigin:g.lU.Start,sameWidthAsOrigin:!0,render:e=>{const t=[{key:"access levels",render:e=>(0,b.jsx)(x.Z,{...e,topBorder:0!==e.index}),items:Z.map((t=>{const s=t.key===P;return{key:t.key,render:e=>(0,b.jsx)(S.Z,{placement:p.u.Top,disableTooltip:!t.tooltip,renderTooltip:()=>t.tooltip,render:i=>(0,b.jsx)(h.Z,{...(0,c.Z)(e,i),title:t.title,caption:t.caption,icon:t.icon({fill:t.iconColor}),desktopIconStyle:T.icon,right:s?(0,b.jsx)("div",{style:T.selectedCheckmark,children:(0,o.e)()}):void 0,disabled:t.disabled,shouldWrapCaption:!0})}),action:()=>{t.onSelect(),e.close()}}}))}];return(0,b.jsx)(y.Z,{menuType:d.og.Popup,children:(0,b.jsx)(v.Z,{type:v.i.Vertical,initialFocus:void 0,sections:t})})}})}},58260:(e,t,s)=>{s.d(t,{Z:()=>r});s(67294);var i=s(16184),n=s(5366),a=s(26388),o=s(85893);function r(e){let{iconStyle:t}=e;return(0,o.jsx)(a.Z,{textWrap:!0,style:{width:210},placement:a.Z.Placement.Bottom,renderTooltip:()=>(0,o.jsx)(n.FormattedMessage,{id:"teamLockIcon.tooltip",defaultMessage:"Private teamspaces can only be accessed or joined by invitation"}),render:e=>(0,o.jsx)("div",{...e,children:(0,i.Q)(t)})})}},77176:(e,t,s)=>{s.r(t),s.d(t,{default:()=>B});s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(33728),r=s(59054),l=s(5366),d=s(4708),c=s(87279),u=s(45101),m=s(95697),p=s(80444),g=s(33052),h=s(34583),f=s(78140),y=s(43579),v=s(91487),x=s(47082),S=s(42853),b=s(72126),M=s(46874),w=s(31194),j=s(52275),C=s(31945),k=s(32163),_=s(89728),T=s(72495),I=s(26388),P=s(85893);function Z(e){window.__c={n:"TeamRoleSelect"};const{disabled:t,selectedRole:s,allRoles:o,onChange:r,store:d,labelStyle:u}=e,{device:g}=(0,i.O7)(),h=(0,a.Fg)(),y=(0,M.q)(d),v=(0,n.VK)((()=>{const{currentSpaceStore:e}=p.default.state;return null==e?void 0:e.canEditMembership()}),[]),x=(0,n.VK)((()=>d.isDefault()),[d]);return(0,P.jsx)(C.ZP,{popupType:g.isMobile?C.Z4.SlideUp:C.Z4.Popup,renderOrigin:e=>(0,P.jsxs)(_.Z,{style:u,disabled:t,disabledFeedback:!0,...e,children:[(0,P.jsx)(l.FormattedMessage,{...m.q9[s].label}),(0,S.i)({width:10,marginLeft:4,fill:h.lightIconColor})]}),placementToOrigin:w.Iw.Bottom,render:e=>{const t=[{key:"roles",render:e=>(0,P.jsx)(T.Z,{...e,topBorder:0!==e.index}),items:o.map((t=>{const i=!y&&"owner"===t,n=x&&"team_level_guest"===t,a=!v&&"team_level_guest"===t,o=!y&&"team_level_guest"===t,d=i||n||a||o;return{key:t,render:e=>(0,P.jsx)(I.Z,{disableTooltip:!d,placement:I.Z.Placement.Right,textWrap:!0,renderTooltip:()=>i?(0,P.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingOwnerForMembers",defaultMessage:"Teamspace members can't add owners"}):n?(0,P.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestsInDefaultTeam",defaultMessage:"Default teams can't contain teamspace guests"}):a||o?(0,P.jsx)(l.FormattedMessage,{id:"TeamRoleSelect.memberType.disableAddingGuestForNonSpaceAdminsOrNonTeamOwners",defaultMessage:"You must be a workspace owner and a teamspace owner to add teamspace guests"}):void 0,render:i=>(0,P.jsx)("span",{...i,children:(0,P.jsx)(j.Z,{...e,focused:!1,checkState:b.Xy(t,s),disabled:d,disabledFeedback:d,title:(0,P.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,P.jsx)(l.FormattedMessage,{...m.q9[t].label})}),caption:(0,P.jsx)("span",{style:{color:h.mediumTextColor},children:(0,P.jsx)(l.FormattedMessage,{...m.q9[t].caption})}),shouldWrapCaption:!0})})}),action:()=>{r(t),e.close()}}}))}];let i;return i=g.isMobile?{menuType:c.og.Modal,title:(0,P.jsx)(l.FormattedMessage,{id:"teamPermissionsMenu.mobile.title",defaultMessage:"Select teamspace role"}),right:(0,P.jsx)(l.FormattedMessage,{id:"teamPermissionsMenu.mobile.doneButton.label",defaultMessage:"Done"}),onClickRight:e.close}:{menuType:c.og.Popup,width:264},(0,P.jsx)(f.Z,{...i,children:(0,P.jsx)(k.Z,{type:k.i.Vertical,initialFocus:void 0,sections:t})})}})}const F="member";function A(e){window.__c={n:"TeamPermissionsInviteInput"};const{store:t,permissionsInviteStore:s,onEmptySubmit:i}=e,r=(0,l.useIntl)(),d=(0,n.VK)((()=>Boolean(s.state.isFocused)),[s]),c=(0,n.VK)((()=>s.state.tokenQuery),[s]),m=(0,n.VK)((()=>s.state.inviteRole),[s]),p=(0,n.VK)((()=>s.state.inviteTargets),[s]),g=(0,a.yK)((e=>({inputTokenVerticalMargin:{marginTop:3,marginBottom:3},tokenMenuItem:{alignItems:"unset",borderRadius:3,paddingTop:5,paddingBottom:5,paddingLeft:8,paddingRight:5,boxShadow:d?e.outlineBlueInputBoxShadow:e.inputBoxShadow,maxHeight:"40vh"},inputDiv:{marginBottom:0}})),[d]);function h(e){if(s.state.isInviteTargetsEmpty)return;const t=s.state.inviteTargets.filter((t=>t!==e));0===p.length?s.setState({...s.state,inviteTargets:[],inviteRole:F,isInviteTargetsEmpty:!0}):s.setState({...s.state,inviteTargets:t})}function f(e){s.setState({...s.state,isFocused:e})}const y=p.map((e=>{const t="newUser"===e.type?e.value.email:`${e.type}-${e.value.id}`;return(0,P.jsx)(v.Z,{target:e,onClickRemove:h,role:m,shouldWrap:!0,style:g.inputTokenVerticalMargin,backgroundColor:(0,u.gQ)(e)},t)}));return(0,P.jsx)(x.Z,{focus:d,onClick:()=>f(!0),format:x.Z.Format.Share,value:c,onChange:function(e){const t=e.target.value,{extractedEmails:i,newInputValue:n}=(0,o.zI)(t),a=i.map((e=>({type:"newUser",value:{email:e},source:"email"}))).filter((e=>!(0,u.Nd)({target:e,permissionsInviteStore:s}))),r=[...s.state.inviteTargets,...a];r.length>0?(s.setState({...s.state,inviteTargets:r,isInviteTargetsEmpty:!1,tokenQuery:n}),f(!(a.length>0))):s.setState({...s.state,inviteTargets:[],isInviteTargetsEmpty:!0,tokenQuery:n})},onEmptySubmit:i,type:"email",placeholder:r.formatMessage({id:"teamPermissionsInvite.searchInput.placeholder",defaultMessage:"Search people or groups"}),tokens:y,onRemoveLastToken:function(){const e={...s.state};e.inviteTargets=e.inviteTargets.slice(0,-1),0===e.inviteTargets.length&&(e.isInviteTargetsEmpty=!0,e.inviteRole=F),s.setState(e)},focusAfterAnimation:!0,right:(0,P.jsx)(D,{store:t,permissionsInviteStore:s}),style:g.tokenMenuItem,inputStyle:g.inputTokenVerticalMargin,inputDivStyle:g.inputDiv,inputFullWidth:!0})}function D(e){window.__c={n:"TeamPermissionsInviteRoleSelect"};const{store:t,permissionsInviteStore:s}=e,i=(0,n.VK)((()=>{const e=p.default.state.currentSpaceStore;return!(null!=e&&e.getDisableTeamGuests())&&(0,d.F$)()}),[]),o=(0,n.VK)((()=>s.state.inviteRole),[s]),r=(0,a.yK)((()=>({teamRoleLabel:{marginTop:3,marginBottom:3,marginLeft:5}})),[]);function l(e){s.setState({...s.state,inviteRole:e})}return i?(0,P.jsx)(Z,{store:t,selectedRole:o,allRoles:m.ZN,onChange:l,labelStyle:r.teamRoleLabel}):(0,P.jsx)(Z,{store:t,selectedRole:o,allRoles:m.$r,onChange:l,labelStyle:r.teamRoleLabel})}const B=function(e){window.__c={n:"TeamPermissionsInvite"};const{store:t,onEmptySubmit:s}=e,o=(0,i.O7)();(0,r.r5)((async()=>{await h.bi(o)}),[]);const l=(0,n.qz)(e.permissionsInviteStore,g.Z),d=(0,n.VK)((()=>Boolean(l.state.isFocused)),[l]),u=(0,n.VK)((()=>l.state.tokenQuery),[l]),m=(0,n.VK)((()=>d&&u.length>0),[d,u]),p=(0,a.yK)((e=>({permissionsInviteSearchRequest:{position:"absolute",width:"100%",borderRadius:3,backgroundColor:e.contentBackground,boxShadow:e.largeBoxShadow,marginTop:4},scroller:{zIndex:1}})),[]);function v(e){l.setState({...l.state,isFocused:e})}return(0,P.jsx)("div",{onFocus:()=>v(!0),onBlur:()=>v(!1),children:(0,P.jsx)(f.Z,{menuType:c.og.Popup,header:(0,P.jsx)(A,{store:t,permissionsInviteStore:l,onEmptySubmit:s}),scrollerStyle:p.scroller,width:"100%",tokenInputHeader:!1,disableScroller:!0,children:m&&(0,P.jsx)("div",{style:p.permissionsInviteSearchRequest,children:(0,P.jsx)(y.Z,{permissionsInviteStore:l,store:t,defaultRoleForSpaceBot:"editor",shouldShowBots:!1,shouldShowGroups:!0,sectionRenderLimit:10,membersOnly:!1,hideUserTypeToken:!0,disableInvitedUsers:!0})})})})}},30688:(e,t,s)=>{s.d(t,{Z:()=>L,u:()=>R});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(33728),l=s(27714),d=s(82990),c=s(5366),u=s(50906),m=s(14871),p=s(95209),g=s(64964),h=s(43250),f=s(4708),y=s(15010),v=s(45101),x=s(95697),S=s(77907),b=s(80444),M=s(35057),w=s(35817),j=s(42922),C=s(68785),k=s(63296),_=s(89728),T=s(26388),I=s(64369),P=s(93686),Z=s(85387),F=s(85893);const A={button:{height:32},buttonContainer:{width:"100%",paddingTop:22,display:"flex",justifyContent:"end"},multiButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"space-between"},singleButtonContainer:{width:"100%",paddingTop:12,display:"flex",justifyContent:"right"},container:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},containerLeftAligned:{display:"flex",alignItems:"left",justifyContent:"left",flexDirection:"column",userSelect:"none",WebkitUserSelect:"none",width:"100%"},titleAndIcon:{paddingBottom:18,alignItems:"center",display:"flex"},addMembersTo:{minWidth:"25%"},icon:{paddingRight:3,paddingLeft:3},teamName:{paddingRight:10,fontWeight:d.Z.fontWeight.medium,...d.Z.textOverflowStyle,maxWidth:250},full:{width:"100%"},submitTooltip:{minWidth:250},subtitle:{paddingTop:16}};function D(e){var t;let{isLoading:s,isNewlyCreatedTeam:i,onDismiss:n,onSubmit:o,inviteTargets:r,includesGroups:l,inviteRole:d,canEditSpaceMembership:u,membershipRequestsDisabled:m,spaceAllowedDomains:p,hasTeamGuestsMatchAllowedDomain:g}=e;window.__c={n:"InviteSubmitButton"};const h=r.length>0,y=l&&"owner"===d,x=r.filter((e=>(0,v.OA)(e))).length>0&&m&&!u,S=(0,a.VK)((()=>(0,f.F$)()&&"team_level_guest"===d&&r.some((e=>"group"===e.type||"existingUser"===e.type&&"none"!==e.spaceRole&&"not_in_space"!==e.spaceRole))),[d,r]),b=y||S||x||g;if(s)return(0,F.jsx)(j.Z,{style:{...A.button,minWidth:80},disabled:!0,children:(0,F.jsx)(C.Z,{isWhite:!0})});if(i&&!h)return(0,F.jsx)(k.Z,{style:A.button,onClick:n,disabled:s,children:(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.skipForNow",defaultMessage:"Skip for now"})});const M=y?(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.groupsAsOwnersTooltip",defaultMessage:"Cannot add groups as teamspace owners. Remove any groups to continue."}):S?(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.memberOrGroupInvitedAsTeamGuestTooltip",defaultMessage:"Cannot add space members or groups as teamspace guests. Remove them to continue."}):g?(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.inviteModal.addNMembers.hasTeamGuestsMatchAllowedDomain",defaultMessage:"Cannot add users with {emailDomains} as teamspace guests. Remove them to continue.",values:{emailDomains:null==p||null===(t=p.map((e=>`@${e}`)))||void 0===t?void 0:t.join(", ")}}):null;return(0,F.jsx)(T.Z,{textWrap:!0,style:A.submitTooltip,disableTooltip:!M,renderTooltip:()=>M,render:e=>(0,F.jsx)(j.Z,{style:A.button,onClick:o,disabled:!h||s||b,...e,children:(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlayV2.inviteButton.label",defaultMessage:"Invite"})})})}function B(e){let{inviteTargets:t,workspaceName:s,canEditSpaceMembership:i,membershipRequestsDisabled:n,isFreeTier:a,inviteRole:o,hasTeamGuestsMatchAllowedDomain:r}=e;if(void 0===i)return null;if(!t||0===t.length)return null;const l=t.map((e=>{if("group"!==e.type&&(0,v.OA)(e))return e.value.email})).filter((e=>e));if(!l||0===l.length)return null;const d=e=>(0,F.jsx)("b",{children:e}),u=s??"this workspace";return i?a?(0,F.jsx)(I.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingularOwner.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a workspace owner.",values:{guestEmail:l[0],workspaceName:u,b:d}}):(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPluralOwners.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as workspace owners.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:d}})}):"team_level_guest"===o?r?null:(0,F.jsx)(I.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.teamGuest.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed teamspace guest.",values:{guestEmail:l[0],workspaceName:u,b:d}}):(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.teamGuest.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed teamspace guests.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:d}})}):(0,F.jsx)(I.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipSingular.subtitle",defaultMessage:"<b>{guestEmail}</b> will be added to {workspaceName} as a billed workspace member.",values:{guestEmail:l[0],workspaceName:u,b:d}}):(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.addSpaceMembershipPlural.subtitle",defaultMessage:"<b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> will be added to {workspaceName} as billed workspace members.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:d}})}):n?(0,F.jsx)(I.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipDisabled.subtitle",defaultMessage:"You can't add workspace guests to a teamspace. Ask your admin to add them as workspace members first."})}):(0,F.jsx)(I.Z,{isSecondaryColor:!0,isMultiline:!0,isSmall:!0,children:1===l.length?(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipSingular.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{guestEmail}</b> as a member to {workspaceName}.",values:{guestEmail:l[0],workspaceName:u,b:d}}):(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.requestSpaceMembershipPlural.subtitle",defaultMessage:"Request will be sent to your admin to add <b>{numberOfOtherEmails, plural, one {{firstGuest} and {secondGuest}} other {{firstGuest} and {numberOfOtherEmails} more}}</b> as members to {workspaceName}.",values:{firstGuest:l[0],secondGuest:l[1],numberOfOtherEmails:l.length-1,workspaceName:u,b:d}})})}function R(e){window.__c={n:"InviteLink"};const{store:t,isSmall:s}=e,i=(0,n.O7)(),a=(0,o.yK)((e=>({button:{marginRight:5,marginLeft:5,height:32,fontSize:s?12:14},icon:{width:s?12:14,height:s?12:14}})),[s]);return(0,F.jsx)(_.Z,{onClick:()=>{m.RD({environment:i,stringValue:x.W8(t.id),copiedMessage:m.tq.copiedLinkToClipboard}),u.XTk(i,{store:t})},icon:l.N,style:a.button,iconStyle:a.icon,isBlue:!0,children:s?(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.copyLinkCondensedButton.label",defaultMessage:"Copy link"}):(0,F.jsx)(c.FormattedMessage,{id:"teamPermissionsInviteOverlay.copyLinkButton.label",defaultMessage:"Copy invite link"})})}const L=function(e){let{store:t,permissionsInviteStore:s,isNewlyCreatedTeam:o,onSubmitSuccessful:l,onDismiss:d}=e;window.__c={n:"TeamPermissionsInviteOverlay"};const m=(0,n.O7)(),{teamName:j,workspaceName:C,canEditSpaceMembership:k,membershipRequestsDisabled:_,teamAccessLevel:T,spaceAllowedDomains:I}=(0,a.VK)((()=>{const{currentSpaceStore:e}=b.default.state;return{teamName:t.getName(),workspaceName:null==e?void 0:e.getName(),canEditSpaceMembership:null==e?void 0:e.canEditMembership(),membershipRequestsDisabled:null==e?void 0:e.getDisableMembershipRequests(),teamAccessLevel:t.getTeamAccessLevel(),spaceAllowedDomains:null==e?void 0:e.getEmailDomains()}}),[t]);(0,i.useEffect)((()=>()=>{o&&w.hI({environment:m,teamStore:t,shouldScroll:!0})}),[o,t,m]);const[L,N]=(0,i.useState)(!1),E=(0,a.VK)((()=>s.state.inviteTargets),[s]),O=(0,a.VK)((()=>s.state.inviteTargets.length),[s]),V=(0,a.VK)((()=>s.state.inviteRole),[s]),U=(0,a.VK)((()=>{if(s.state.isInviteTargetsEmpty)return!1;return Boolean(s.state.inviteTargets.find((e=>"group"===e.type)))}),[s]),W=(0,a.VK)((()=>M.QM()),[]),z=(0,a.VK)((()=>!(null==I||!I.length||"team_level_guest"!==V||!(0,f.F$)())&&E.some((e=>"group"!==e.type&&(0,r.dy)(I,e.value.email)))),[I,V,E]),K=(0,a.VK)((()=>(0,f.s$)()?!W&&!x.U2(t):"open"===T&&(0,f.u3)()),[t,T,W]),H=async()=>{if(N(!0),O>0){const e=s.state.inviteTargets,i=await p.zK({environment:m,store:t,permissionsInviteStore:s,inviteOrigin:"team_invite_overlay"});if(void 0!==k)if(i){u.JkE(m,{is_space:!0,invite_origin:"team_invite_overlay",domainType:(0,y.JF)(),new_workspace_member_count:O});const s=(0,v.t0)({inviteTargets:e,recordStore:t,canEditSpaceMembership:k});if(!s)return;setTimeout((()=>{g.oV({label:s})}))}else setTimeout((()=>{g.oV({label:(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlay.inviteMembersFailure.message",defaultMessage:"Failed to send invites"})})}))}p.Mr({permissionsInviteStore:s}),N(!1),null==l||l()};return(0,F.jsx)("div",{className:h.D$4,style:{...A.full},children:(0,F.jsxs)("div",{style:A.containerLeftAligned,children:[(0,F.jsxs)("div",{style:A.titleAndIcon,children:[(0,F.jsx)("div",{style:A.addMembersTo,children:(0,F.jsx)(c.FormattedMessage,{id:"TeamPermissionsInviteOverlayV2.membersTitle.label",defaultMessage:"Invite people to"})}),(0,F.jsx)("div",{style:A.icon,children:(0,F.jsx)(P.p,{disabled:!0,store:t,size:20})}),(0,F.jsx)(Z.s,{style:A.teamName,children:j})]}),(0,F.jsxs)("div",{style:A.full,children:[(0,F.jsx)(S.LazyTeamPermissionsInvite,{store:t,permissionsInviteStore:s,onEmptySubmit:H}),(0,F.jsx)("div",{style:A.subtitle,children:(0,F.jsx)(B,{inviteTargets:E,workspaceName:C,canEditSpaceMembership:k,membershipRequestsDisabled:_,isFreeTier:W,inviteRole:V,hasTeamGuestsMatchAllowedDomain:z})})]}),(0,F.jsx)("div",{style:K?A.multiButtonContainer:A.singleButtonContainer,children:(0,F.jsxs)("div",{style:K?A.multiButtonContainer:{},children:[K&&(0,F.jsx)(R,{store:t}),(0,F.jsx)(D,{isLoading:L,onSubmit:H,onDismiss:()=>{p.Mr({permissionsInviteStore:s}),null==d||d()},isNewlyCreatedTeam:o,inviteTargets:E,includesGroups:U,inviteRole:V,canEditSpaceMembership:k,membershipRequestsDisabled:_,spaceAllowedDomains:I,hasTeamGuestsMatchAllowedDomain:z})]})})]})})}},86100:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});s(67294);var i=s(86628),n=s(9019),a=s(30688),o=s(85893);const r=function(e){window.__c={n:"TeamPermissionsInviteWithModal"};const[t,,s]=(0,i.AF)(e.permissionsInviteStore),r=()=>{s.reset()};return(0,o.jsx)(n.Z,{modalStyle:{alignSelf:"center",overflow:"visible",top:0,width:500},open:t.modalOpen,onDismiss:r,renderContent:()=>(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"end",padding:22},children:(0,o.jsx)(a.Z,{store:e.store,permissionsInviteStore:s,isNewlyCreatedTeam:!1,onSubmitSuccessful:r,onDismiss:r})}),origin:e.origin})}},51923:(e,t,s)=>{s.d(t,{Z:()=>m});s(67294);var i=s(24405),n=s(5366),a=s(97880),o=s(18514),r=s(74523),l=s(85387),d=s(85893);function c(e){switch(e){case"bestPractices":return(0,o.UY)("guides.teamspacesLearnMore");case"workspaceOwnerGuide":return(0,o.UY)("guides.teamspacesWorkspaceOwner");case"settingsAndPermissions":return(0,o.UY)("guides.teamspacesSettingsAndPermissions");default:return(0,a.t1)(e)}}function u(e){return e||(0,d.jsx)(l.s,{children:(0,d.jsx)(n.FormattedMessage,{defaultMessage:"Learn about teamspaces",id:"teamsLearnMoreLink"})})}function m(e){let{onClick:t,message:s,helpCenterLocation:n,analyticsFrom:a,containerStyle:o}=e;window.__c={n:"TeamsLearnMoreLink"};const l=(0,i.yK)((()=>({button:{maxWidth:"100%"}})),[]);return(0,d.jsx)("div",{style:o,children:(0,d.jsx)(r.Z,{buttonStyle:l.button,title:u(s),analyticsFrom:a,href:c(n),onClick:t})})}},62512:(e,t,s)=>{s.d(t,{n:()=>g});s(67294);var i=s(86628),n=s(24405),a=s(7928),o=s(5366),r=s(31278),l=s(45653),d=s(76472),c=s(37708),u=s(85893);const m=d.Z.iconSize,p=c.Kt;function g(e){let{ownerStores:t,teamStore:s,isSmall:a=!1}=e;window.__c={n:"TeamOwnerIcons"};const o=a?p:m,l=a?10:16,d=(0,n.yK)((e=>({container:{position:"relative",width:o,height:o},teamBadge:{position:"absolute",bottom:-5,right:-3,background:e.modalBackground,padding:.75,borderRadius:"0.25em"}})),[o]),{teamName:c,teamIcon:g}=(0,i.VK)((()=>({teamName:s.getName(),teamIcon:s.getIcon()})),[s]),f=e=>(0,u.jsx)(r.Z,{disabled:!0,title:c,icon:g,isEmptyPage:!1,size:e});return 0===t.length?f(o):(0,u.jsxs)("div",{style:d.container,children:[(0,u.jsx)(h,{isSmall:a,store:t[0]}),(0,u.jsx)("div",{style:d.teamBadge,children:f(l)})]})}function h(e){let{store:t,isSmall:s=!1,style:d={}}=e;window.__c={n:"OwnerIcon"};const c=(0,o.useIntl)(),g=s?p:m,h=(0,n.yK)((e=>({icon:{width:g,height:g,borderRadius:g,boxShadow:e.avatarBoxShadow,...d}})),[g,d]),f=(0,i.VK)((()=>null!=t&&t.isDefined()?(0,a.Nz)(c,null==t?void 0:t.getModel()):void 0),[c,t]),y=f?(0,u.jsx)(l.Z,{avatarShouldShowShadow:!0,userStore:t,size:g}):(0,u.jsx)(r.Z,{bucket:"public",disabled:!0,isEmptyPage:!1,title:f,size:g,icon:void 0});return(0,u.jsx)("div",{style:h.icon,children:y})}},49469:(e,t,s)=>{s.d(t,{z:()=>o});s(67294);var i=s(24405),n=s(82990),a=s(85893);function o(e){let{title:t,subtitle:s,style:o}=e;window.__c={n:"TeamSettingsHeader"};const r=(0,i.yK)((e=>({base:{width:"100%"},title:{fontWeight:n.Z.fontWeight.medium,color:e.regularTextColor,fontSize:14},subtitle:{fontWeight:n.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:12}})),[]);return(0,a.jsxs)("div",{style:{...r.base,...o},children:[(0,a.jsx)("div",{style:r.title,children:t}),s&&(0,a.jsx)("div",{style:r.subtitle,children:s})]})}},37708:(e,t,s)=>{s.d(t,{Kt:()=>u,MQ:()=>c,Ph:()=>m,oM:()=>d});var i=s(67294),n=s(24405),a=s(61519),o=s(89728),r=s(49469),l=s(85893);const d=15,c=8,u=20;function m(e){window.__c={n:"TeamSettingsList"};const t=(0,n.yK)((()=>({button:{height:"auto",paddingLeft:0,paddingRight:0,display:"flex"},title:{marginBottom:10}})),[]);return Boolean(e.onClick)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.z,{title:e.title,style:t.title}),(0,l.jsx)(o.Z,{onClick:e.onClick,style:t.button,children:(0,l.jsx)(p,{...e})})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.z,{title:e.title,style:t.title}),(0,l.jsx)(p,{...e})]})}function p(e){let{title:t,rows:s,hideDividers:o=!1,itemStyle:r,onClick:u}=e;window.__c={n:"TeamSettingsListContainer"};const m=(0,n.yK)((e=>({container:{border:`1px solid ${e.regularDividerColor}`,borderRadius:4,width:"100%"},list:{listStyle:"none",padding:0,margin:0},listItem:{marginLeft:d,marginRight:d,paddingTop:c,paddingBottom:c,...r},divider:{marginLeft:d,marginRight:d,borderColor:`${e.regularDividerColor}`}})),[r]);return(0,l.jsx)("div",{style:{...m.container},children:(0,l.jsx)("ul",{style:m.list,children:s.map(((e,t)=>(0,l.jsxs)(i.Fragment,{children:[!o&&t>0&&(0,l.jsx)(a.Z,{size:1,innerStyle:m.divider}),(0,l.jsx)("li",{style:m.listItem,children:e},t)]},t)))})})}},68750:(e,t,s)=>{s.d(t,{O:()=>L});var i=s(67294),n=s(480),a=s(24405),o=s(53877),r=s(42875),l=s(19889),d=s(4308),c=s(50906),u=s(87279),m=s(78140),p=s(40721),g=s(13148),h=s(5366),f=s(52275),y=s(72495),v=s(85893);function x(e){const{onClick:t}=e;return(0,v.jsx)(y.Z,{topBorder:!0,children:(0,v.jsx)(f.Z,{focused:!1,icon:(0,g.U)({width:14,marginLeft:0}),title:(0,v.jsx)(h.FormattedMessage,{defaultMessage:"Remove verification",id:"VerificationPropertyOverlayMenu.removeVerificationButton"}),onClick:t,style:{fontSize:14}})})}var S=s(30120),b=s(86628),M=s(28020),w=s(33929),j=s(66653),C=s(93289);const k=(0,h.defineMessages)({placeholder:{id:"VerificationExpiryMenu.pickSpecificDate.placeholder",defaultMessage:"Pick a date"}});function _(e){window.__c={n:"VerificationCustomDatePicker"};const{onChange:t,clearCustomDatePicker:s}=e,n=(0,i.useRef)(e.today),a=(0,i.useRef)(e.today.plus({days:1})),[r,l]=(0,i.useState)(!1),d=(0,b.VK)((()=>M.AK.state),[]);return(0,v.jsxs)(y.Z,{mobileStyle:{paddingBottom:10},style:{padding:"12px 0"},children:[(0,v.jsx)(j.Z,{placeholder:w.default.formatMessage(k.placeholder),focused:r,value:"verified"!==e.verificationState.type||e.verificationState.isIndefinite?void 0:o.ME(e.verificationState.dateTimeRange.end),onUpdate:e=>{if(e.error)return;const i=e.value&&o.XI(e.value);i?t({start:n.current,end:i.start}):s()},onFocus:()=>l(!0),onBlur:()=>l(!1),onClearButtonClick:s,hideClearButton:!0}),(0,v.jsx)(C.Z,{firstDayOfWeek:d,value:a.current.toMillis(),selectValue:!1,onChange:e=>{t({start:n.current,end:S.ou.fromMillis(e)})},disabledDays:{before:new Date(a.current.toMillis())}})]})}var T=s(36700),I=s(69651);const P=(0,s(45238).I)("infinity",{viewBox:"0 0 40 19",svg:(0,v.jsx)("path",{d:"M0.297852 9.42383C0.297852 11.2695 0.65918 12.876 1.38184 14.2432C2.11426 15.6104 3.13477 16.6748 4.44336 17.4365C5.75195 18.1885 7.26562 18.5645 8.98438 18.5645C10.3613 18.5645 11.6504 18.2715 12.8516 17.6855C14.0625 17.0898 15.2881 16.1963 16.5283 15.0049L20 11.6504L23.4717 15.0049C24.7119 16.1963 25.9375 17.0898 27.1484 17.6855C28.3594 18.2715 29.6484 18.5645 31.0156 18.5645C32.7344 18.5645 34.248 18.1885 35.5566 17.4365C36.8652 16.6748 37.8809 15.6104 38.6035 14.2432C39.3359 12.876 39.7021 11.2695 39.7021 9.42383C39.7021 7.57812 39.3359 5.97168 38.6035 4.60449C37.8809 3.2373 36.8652 2.17773 35.5566 1.42578C34.248 0.664062 32.7344 0.283203 31.0156 0.283203C29.6484 0.283203 28.3594 0.581055 27.1484 1.17676C25.9375 1.7627 24.7119 2.65137 23.4717 3.84277L20 7.19727L16.5283 3.84277C15.2881 2.65137 14.0625 1.7627 12.8516 1.17676C11.6504 0.581055 10.3613 0.283203 8.98438 0.283203C7.26562 0.283203 5.75195 0.664062 4.44336 1.42578C3.13477 2.17773 2.11426 3.2373 1.38184 4.60449C0.65918 5.97168 0.297852 7.57812 0.297852 9.42383ZM3.5791 9.42383C3.5791 8.23242 3.80371 7.19727 4.25293 6.31836C4.71191 5.43945 5.34668 4.76074 6.15723 4.28223C6.96777 3.80371 7.91016 3.56445 8.98438 3.56445C9.88281 3.56445 10.752 3.78418 11.5918 4.22363C12.4316 4.66309 13.3154 5.3125 14.2432 6.17188L17.7002 9.42383L14.2285 12.6758C13.3105 13.5352 12.4316 14.1846 11.5918 14.624C10.752 15.0635 9.88281 15.2832 8.98438 15.2832C7.91016 15.2832 6.96777 15.0439 6.15723 14.5654C5.34668 14.0869 4.71191 13.4082 4.25293 12.5293C3.80371 11.6406 3.5791 10.6055 3.5791 9.42383ZM22.2998 9.42383L25.7568 6.17188C26.6846 5.3125 27.5684 4.66309 28.4082 4.22363C29.248 3.78418 30.1172 3.56445 31.0156 3.56445C32.0898 3.56445 33.0322 3.80371 33.8428 4.28223C34.6533 4.76074 35.2832 5.43945 35.7324 6.31836C36.1914 7.19727 36.4209 8.23242 36.4209 9.42383C36.4209 10.6055 36.1914 11.6406 35.7324 12.5293C35.2832 13.4082 34.6533 14.0869 33.8428 14.5654C33.0322 15.0439 32.0898 15.2832 31.0156 15.2832C30.1172 15.2832 29.248 15.0635 28.4082 14.624C27.5684 14.1846 26.6895 13.5352 25.7715 12.6758L22.2998 9.42383Z"})});var Z=s(70693);function F(e){window.__c={n:"VerificationExpiryPickerMenu"};const{verificationState:t,onChange:s,onCustomDateClick:n}=e,o=(0,h.useIntl)(),r=(0,i.useRef)(e.today),l=(0,a.yK)((e=>({title:{fontSize:14,color:e.regularTextColor},optionsContainer:{width:"100%"},clockIconStyle:{width:14,marginLeft:0,marginTop:2}})),[]),c="expired"===t.type||"none"===t.type?(0,v.jsx)(h.FormattedMessage,{defaultMessage:"Verify page",id:"VerificationExpiryPicker.verify.header"}):(0,v.jsx)(h.FormattedMessage,{defaultMessage:"Reverify page",id:"VerificationExpiryPicker.reverify.header"}),u="verified"===t.type&&t.isIndefinite,m="verified"===t.type&&!t.isIndefinite&&t.dateTimeRange.end;return(0,v.jsxs)(y.Z,{title:c,children:[d.Xs.map((e=>{const t=m&&d.fm({start:r.current,end:m})===e;return(0,v.jsx)(f.Z,{focused:!1,icon:(0,T.m)(l.clockIconStyle),inline:!1,title:(0,v.jsx)("span",{style:l.title,children:(0,v.jsx)(h.FormattedMessage,{defaultMessage:"For {numDays} days",id:"VerificationExpiryMenu.preset.title",values:{numDays:e}})}),caption:o.formatMessage({defaultMessage:"Until {date}",id:"VerificationExpiryMenu.preset.subtitle"},{date:Z.mb({dateTime:d.z5(e,r.current).end,intl:o,shortenDateAndRange:!0})}),checkState:!!t,onClick:()=>{return t=e,void s({start:r.current,end:r.current.plus({days:t})});var t}},e)})),(0,v.jsx)(f.Z,{focused:!1,icon:P({width:14,marginLeft:0,marginTop:1}),inline:!1,title:(0,v.jsx)("span",{style:l.title,children:(0,v.jsx)(h.FormattedMessage,{defaultMessage:"Indefinitely",id:"VerificationExpiryPicker.option.indefinitely"})}),onClick:()=>s(),checkState:u},"indefinite"),(0,v.jsx)(f.Z,{focused:!1,icon:(0,I.C)({width:14,marginLeft:0}),title:(0,v.jsx)("span",{style:l.title,children:(0,v.jsx)(h.FormattedMessage,{defaultMessage:"Pick a date",id:"VerificationExpiryPicker.option.customDate"})}),onClick:n},"custom")]})}var A=s(66897),D=s(64369);function B(e){window.__c={n:"VerificationMetadata"};const{getRecordModel:t,actorPointer:s,lastVerifiedDate:i}=e,a=(0,n.Fy)(),o=(0,h.useIntl)(),r=(0,b.VK)((()=>(0,A.$4)(o,(0,A.Hl)({pointer:s,getRecordModel:t}))),[t,o,s]);return(0,v.jsxs)("div",{style:{padding:"8px 14px"},children:[(0,v.jsx)(D.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:a.isMobile,isMultiline:!0,style:{marginBottom:4},children:(0,v.jsx)(h.FormattedMessage,{defaultMessage:"Last verified by {user}",id:"VerificationMetadata.lastVerified",values:{user:r}})}),(0,v.jsx)(D.Z,{isSmall:!0,isSecondaryColor:!0,isMobile:a.isMobile,children:(0,Z.mb)({dateTime:i,intl:o})})]})}var R=s(19870);function L(e){window.__c={n:"VerificationPropertyOverlayMenu"};const{verificationValue:t,getRecordModel:s,onChange:g,blockId:h,propertyName:f,onClose:y}=e,S=(0,n.O7)(),b=(0,n.Fy)(),M=(0,a.Fg)(),[w,j]=(0,i.useState)(!1),C=(0,i.useMemo)((()=>d.WN(t)),[t]),k="verified"===C.type,T=(0,i.useRef)(o.Uu((0,r.r)())),I=(0,i.useRef)(o.Uu((0,r.r)()).plus({days:1})),P=e=>{var t;const s=null===(t=S.currentUser)||void 0===t?void 0:t.id;if(!s)return;if(null!=e&&e.end&&e.end.toMillis()<I.current.toMillis())return;const i={table:l.KJ,id:s},n=e?o.OQ.toPersistedDateTimeRange(e):o.OQ.toPersistedDateTime(T.current.toMillis()),a="none"===C.type?"add":"update";c.s$$(S,{action:a,verification_page_id:h,verification_expiry:e?e.end.toMillis():void 0}),g({value:[i,n]})};let Z={menuType:u.og.Popup,footer:"none"!==C.type&&(0,v.jsx)("div",{style:{borderTop:`1px solid ${M.regularDividerColor}`},children:(0,v.jsx)(B,{lastVerifiedDate:k&&C.isIndefinite?C.startDateTime:C.dateTimeRange.start,getRecordModel:s,actorPointer:C.actorPointer})})};return b.isMobile&&(Z={...Z,title:f,menuType:u.og.Modal,right:(0,v.jsx)(p.DoneMenuText,{}),onClickRight:y}),(0,v.jsx)(m.Z,{...Z,header:!w&&"none"!==C.type&&(0,v.jsx)(v.Fragment,{children:(0,v.jsx)("div",{style:{padding:b.isMobile?10:7,paddingLeft:b.isMobile?20:7,background:b.isMobile?M.popoverBackground:M.tokenInputMenuItemBackground,display:"flex",alignItems:"center",borderBottom:`1px solid ${M.regularDividerColor}`},children:(0,v.jsx)(R.z,{verificationValue:t})})}),children:w?(0,v.jsx)(_,{today:T.current,verificationState:C,onChange:e=>P(e),clearCustomDatePicker:()=>j(!1)}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(F,{today:T.current,verificationState:C,onChange:e=>P(e),onCustomDateClick:()=>j(!0)}),(k||"expired"===C.type)&&(0,v.jsx)(x,{onClick:()=>{c.s$$(S,{action:"remove",verification_page_id:h}),g({value:void 0})}})]})})}},72340:(e,t,s)=>{s.d(t,{$6:()=>o,CN:()=>n,Tc:()=>a});var i=s(77080);const n=5;function a(e){return"on"===i.default.getEligibleGroup({experimentId:"parallel_confluence_importer_via_api",defaultGroup:"control"})}function o(e){return i.default.getEligibleGroup({experimentId:"special_case_confluence_file_size",defaultGroup:n.toString()})}},8989:(e,t,s)=>{s.d(t,{b:()=>o,t:()=>a});var i=s(77080),n=s(72340);function a(){return"on"===i.default.getEligibleGroup({experimentId:"generic_importer",defaultGroup:"control"})}function o(e){const t=i.default.getEligibleGroup({experimentId:"special_case_generic_file_size",defaultGroup:n.CN.toString()});return Number(t)}},45567:(e,t,s)=>{s.d(t,{G7:()=>o,Gh:()=>l,LR:()=>a,gU:()=>r,jo:()=>n});var i=s(97880);const n="fileTypeAnyFiles",a="fileTypeImages",o="fileTypeVideos",r="fileTypeNone";function l(e){let{fileMimeType:t,allowedType:s}=e;switch(s){case n:return!0;case a:return function(e){return e.startsWith("image")&&!e.includes("photoshop")}(t);case o:return function(e){return e.startsWith("video")}(t);case r:return!1;default:(0,i.t1)(s)}}},98481:(e,t,s)=>{s.d(t,{J:()=>l});var i=s(40506),n=s(97880);var a=s(78291),o=s(13627),r=s(35057);function l(e){let{environment:t}=e;const s=(0,r.zt)(),{data:l}=a.default.state,d=(0,o.XX)(l);return function(e){let{subscriptionTier:t,subscriptionCreatedAtTime:s}=e;return"enterprise"===t||"plus"===t&&(0,n.$K)(s)&&s<i.Xn}({subscriptionTier:s,subscriptionCreatedAtTime:null==d?void 0:d.created})}},94660:(e,t,s)=>{s.d(t,{IJ:()=>o,PL:()=>a,W4:()=>r,p8:()=>l});var i=s(62992),n=s(64002);function a(e,t){return e.filter((e=>{const s=e.getCopiedFromPointer();return Boolean(s&&(0,i.J)(s)&&Boolean(t&&t(s.id)))}))}const o=5;function r(e){const t=window.location.href;return n.SK(t,{tg:e.templateGalleryItem})}function l(){const e=window.location.href;let t;return t=n.iO(e,"tg"),t=n.iO(t,"np"),t=n.iO(t,"pjm"),t}},45660:(e,t,s)=>{s.d(t,{D:()=>d,e:()=>l});var i=s(480),n=s(86628),a=s(98481),o=s(80444),r=s(35057);function l(){const{currentSpaceStore:e}=(0,n.Kw)(o.default);return(0,n.VK)((()=>{const t=null==e?void 0:e.getSubscriptionTier(),s=(0,r.zt)();return!("enterprise"===t||"business"===t||"enterprise"===s||"business"===s)}),[e])}function d(){const e=(0,i.O7)(),t=l();return(0,n.VK)((()=>t&&!(0,a.J)({environment:e})),[t,e])}},55220:(e,t,s)=>{s.d(t,{E:()=>o});var i=s(480),n=s(86628),a=s(28020);function o(){var e;const t=(0,i.O7)();return(null===(e=(0,n.Kw)((0,a.k_)(t)))||void 0===e?void 0:e.userJoinedTeamsStores)??[]}},43914:(e,t,s)=>{s.d(t,{K:()=>r});var i=s(86628),n=s(27006),a=s(95697),o=s(80444);function r(e){return(0,i.VK)((()=>{if(!e)return 0;const t=o.default.state.currentSpaceStore,s=o.default.state.currentUserStore;if(!n.YX((null==t?void 0:t.getRole())??"none")){return(0,a.tu)({currentUserStore:s,currentSpaceStore:t,teamStore:e,members:e.getMembers()}).length}return(0,a.tO)({teamStore:e,spaceStore:t}).length}),[e])}},63060:(e,t,s)=>{s.d(t,{U:()=>w});s(30541),s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(8848),r=s(45238),l=s(85893);const d=(0,r.I)("closedTeam",{viewBox:"0 0 28 28",svg:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("path",{d:"M18.0459 13.8125C20.1377 13.8125 21.8428 11.9492 21.8428 9.68164C21.8428 7.43164 20.1465 5.66504 18.0459 5.66504C15.9541 5.66504 14.2402 7.4668 14.249 9.69922C14.2578 11.958 15.9541 13.8125 18.0459 13.8125ZM7.9209 13.8828C9.73145 13.8828 11.2168 12.2568 11.2168 10.2617C11.2168 8.31055 9.74902 6.7373 7.9209 6.7373C6.11035 6.7373 4.61621 8.33691 4.625 10.2793C4.625 12.2656 6.11035 13.8828 7.9209 13.8828ZM18.0459 12.4854C16.7627 12.4854 15.6641 11.2549 15.6641 9.69922C15.6553 8.16992 16.7363 6.99219 18.0459 6.99219C19.3555 6.99219 20.4277 8.15234 20.4277 9.68164C20.4277 11.2373 19.3379 12.4854 18.0459 12.4854ZM7.9209 12.5732C6.83984 12.5732 5.93457 11.5449 5.93457 10.2793C5.93457 9.04004 6.83105 8.04688 7.9209 8.04688C9.02832 8.04688 9.91602 9.02246 9.91602 10.2617C9.91602 11.5449 9.00195 12.5732 7.9209 12.5732ZM3.02539 21.9424H9.9248C9.50293 21.7051 9.18652 21.1777 9.24805 20.6416H2.81445C2.62988 20.6416 2.55078 20.5713 2.55078 20.4043C2.55078 18.2246 5.03809 16.1855 7.91211 16.1855C9.01074 16.1855 10.0127 16.4492 10.8652 16.9502C11.1377 16.5986 11.4629 16.291 11.8584 16.0186C10.7246 15.2715 9.3623 14.8848 7.91211 14.8848C4.22949 14.8848 1.24121 17.5566 1.24121 20.4834C1.24121 21.459 1.83887 21.9424 3.02539 21.9424ZM12.5176 21.9424H23.5566C25.0244 21.9424 25.7188 21.5029 25.7188 20.5361C25.7188 18.2334 22.8096 14.9023 18.0371 14.9023C13.2734 14.9023 10.3643 18.2334 10.3643 20.5361C10.3643 21.5029 11.0586 21.9424 12.5176 21.9424ZM12.0957 20.6152C11.8672 20.6152 11.7793 20.5537 11.7793 20.3691C11.7793 18.9277 14.0117 16.2295 18.0371 16.2295C22.0713 16.2295 24.3037 18.9277 24.3037 20.3691C24.3037 20.5537 24.207 20.6152 23.9785 20.6152H12.0957Z"})})});var c=s(40462),u=s(90199),m=s(49364),p=s(5366),g=s(64684),h=s(1865),f=s(74136);const y=function(e){let{tier:t}=e;const s=()=>"business"===t?(0,l.jsx)(p.FormattedMessage,{id:"upgradeToBusinessBadge",defaultMessage:"Business"}):(0,l.jsx)(p.FormattedMessage,{id:"upgradeToEnterpriseBadge",defaultMessage:"Enterprise"});return(0,l.jsx)(f.Z,{children:(0,l.jsx)(s,{})})};var v=s(38755),x=s(80444),S=s(12205),b=s(45660),M=s(35901);function w(e){let{teamStore:t,isDefault:s,onChange:r=(()=>{})}=e;const f=(0,i.O7)(),w=(0,S.J)(),C=(0,M.y)(null==t?void 0:t.id),k=(0,b.e)(),_="business",T=(0,n.VK)((()=>x.default.state.currentSpaceStore),[]),I=(0,n.VK)((()=>{if(T)return(0,v.rn)(f,T)}),[f,T]),P=(0,n.VK)((()=>{const e=null==t?void 0:t.getSettingsStore().getValue();return!!e&&("private"===(0,g.B5)(e)??!1)}),[t]),Z=(0,a.yK)((()=>({openIcon:{width:20,height:20},lockIcon:{width:18,height:18},closedIcon:{width:20,height:20},iconContainer:{width:20,height:20,display:"flex",justifyContent:"center",alignItems:"center",marginLeft:5,marginRight:5}})),[]),F=(0,l.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamspaceUpsellBusiness.tooltip",defaultMessage:"Upgrade to Business Plan to enable Private teamspaces"}),A=(0,l.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.defaultTeamSpace.title",defaultMessage:"Default"}),D=(0,l.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.openTeamspace.title",defaultMessage:"Open"}),B=(0,l.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.closedTeamSpace.title",defaultMessage:"Closed"}),R=(0,l.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.privateTeamSpace.title",defaultMessage:"Private"}),L="dark"===(0,a.Fg)().mode?o.ZP.uiLightGray:o.ZP.black,N=[{key:"open",icon:e=>(0,l.jsx)("div",{style:Z.iconContainer,children:(0,m.R)({...e,...Z.openIcon})}),iconColor:L,level:D,title:D,caption:(0,l.jsx)(p.FormattedMessage,{id:"CreateTeamspaceMenu.openTeamspace.caption",defaultMessage:"Anyone can see and join this teamspace"}),disabled:!1,onSelect:()=>r("open",!1)},{key:"closed",icon:e=>(0,l.jsx)("div",{style:Z.iconContainer,children:d({...e,...Z.closedIcon})}),iconColor:L,level:B,title:B,caption:(0,l.jsx)(p.FormattedMessage,{id:"CreateTeamspaceMenu.closedTeamspace.caption",defaultMessage:"Anyone can see this teamspace but not join"}),disabled:!1,onSelect:()=>r("closed",!1)},{key:"private",icon:e=>(0,l.jsx)("div",{style:Z.iconContainer,children:(0,u.b)({...e,...Z.lockIcon})}),iconColor:L,level:R,title:k?(0,l.jsx)(j,{title:R,badge:(0,l.jsx)(y,{tier:_})}):R,caption:(0,l.jsx)(p.FormattedMessage,{id:"CreateTeamspaceMenu.privateTeamspace.caption",defaultMessage:"Only members can see that this teamspace exists"}),disabled:k&&!w,tooltip:k?F:void 0,onSelect:()=>{if(k&&!P)return h.y(f,{from:"team_security_settings",for:_,dontOpenPlansOnCancel:!0});r("private",!1)}}];if(s||w){const e=s&&(!w||C),t={key:"default",icon:e=>(0,l.jsx)("div",{style:Z.iconContainer,children:(0,c.o)({...e,...Z.lockIcon})}),iconColor:L,level:A,title:A,caption:(0,l.jsx)(p.FormattedMessage,{id:"CreateTeamspaceMenu.defaultTeamspace.caption",defaultMessage:"Everyone at {spaceName} must be a member",values:{spaceName:I}}),disabled:!1,disableAllOptionsTooltip:e?w?(0,l.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.closeOrPrivateTeamspace.disabledTooltipOnlyDefaultTeam",defaultMessage:"Add another default teamspace to change teamspace permissions."}):(0,l.jsx)(p.FormattedMessage,{id:"TeamAccessLevelSwitcher.defaultTeamspace.disabledTooltipNonAdmin",defaultMessage:"You can't change this setting because you are not a workspace admin"}):void 0,onSelect:()=>r("open",!0)};N.unshift(t)}return N}function j(e){let{title:t,badge:s}=e;window.__c={n:"TitleWithBadge"};const i=(0,a.yK)((()=>({container:{display:"flex",flexWrap:"wrap",alignItems:"center"},badge:{marginLeft:5}})),[]);return(0,l.jsxs)("div",{style:i.container,children:[t,(0,l.jsx)("div",{style:i.badge,children:s})]})}},35314:(e,t,s)=>{s.d(t,{e:()=>o});var i=s(67294),n=s(86628),a=s(77794);function o(){const[e,t]=(0,i.useState)(0),[s]=(0,i.useState)((()=>new a.E)),o=(0,i.createRef)();return(0,i.useEffect)((()=>{o.current&&s.observe(o.current)}),[o,s]),(0,n.VK)((()=>{e!==s.rect.state.width&&t(s.rect.state.width)}),[e,s.rect]),[o,e]}},36214:(e,t,s)=>{s.d(t,{FI:()=>k,sM:()=>C,vY:()=>_});s(21703);var i=s(13991),n=s(72126),a=(s(4615),s(45953)),o=(s(21202),s(75246),s(11002)),r=s(27095),l=s(73314),d=s(5366),c=s(50906),u=s(54642),m=s(9284),p=s(54532),g=s(86282),h=s(9953),f=s(4408),y=s(28014),v=s(39699),x=(s(95477),s(33929)),S=s(27249),b=s(80444),M=s(88632),w=s(77080);const j=(0,d.defineMessages)({invalidSpaceStore:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.createTemplatesInSpace.invalidStorage.message"},invalidSpaceStoreOnCreateTemplate:{defaultMessage:"Invalid space view data.",id:"spaceActions.dialogError.createTemplatesInWorkspace.invalidStorage.message"},invalidUserSettings:{defaultMessage:"Invalid user settings data.",id:"spaceActions.dialogError.createTemplatesInWorkspace.invalidUserSettings.message"}});async function C(e){const{environment:t,spaceViewStore:s,isPrivate:a,userSettingsStore:o,redirectData:r,userRootStore:d,planType:u,spaceJoinOrCreate:p,teamStore:f,templates:M,templateType:C,personaTeamStore:_,isNewUserOnboarding:T}=e,I=s.getSpaceStore();if(!I)throw new Error(x.default.formatMessage(j.invalidSpaceStore));let P,F=[];if(o&&I&&M&&(F=await async function(e){const{spaceStore:t,spaceViewStore:s,userSettingsStore:i,teamStore:a}=e;if(await Promise.all(n.oA([t.load(),s.load(),i.load(),null==a?void 0:a.load()])),t.canEdit()){if(!s.isDefined())throw new Error(x.default.formatMessage(j.invalidSpaceStoreOnCreateTemplate));if(!i.isDefined())throw new Error(x.default.formatMessage(j.invalidUserSettings));if(!s.getCreatedOnboardingTemplates()){return await async function(e){var t;const{environment:s,spaceStore:i,spaceViewStore:a,isPrivate:o,teamStore:r,personaTeamStore:d,templateType:c,userSettingsStore:u,isOnboardingCreatorNoJoinableSpaces:p}=e;let f=[];if("page_template"===c&&e.templates){const t=e.templates.map((e=>r?g.rC({environment:s,item:e,isPrivate:!1,spaceStore:i,spaceViewStore:a,useMinimalTemplates:!0,teamStore:r,type:"inTeam",from:"onboarding",isOnboarding:!0}):g.rC({environment:s,item:e,isPrivate:o,spaceStore:i,spaceViewStore:a,useMinimalTemplates:!0,type:"inSpace",isOnboarding:!0})));f=n.oA(await Promise.all(t))}else if("app_template"===c&&e.templates&&r){f="on"===w.default.getEligibleGroup({defaultGroup:"control",experimentId:"app_template_removal"})?n.oA(await Promise.all((0,l.H)(Z,x.default.getIntl()).map((e=>g.rC({environment:s,item:e,isPrivate:!1,spaceStore:i,spaceViewStore:a,useMinimalTemplates:!0,teamStore:r,type:"inTeam",from:"onboarding",isOnboarding:!0}))))):await m.installAppsInTeam({environment:s,presets:e.templates,spaceStore:i,spaceViewStore:a,teamStore:r})}const y=null===(t=u.getSettings())||void 0===t?void 0:t.persona;if(d&&y){let e=[];if(["product","marketing","sales","eng"].includes(y)){e="on"===w.default.getEligibleGroup({defaultGroup:"control",experimentId:"persona_template_truncation"})?(0,S.OJ)(y,w.default,x.default.getIntl()):(0,S.CN)(y,w.default,x.default.getIntl())}else p&&(e=(0,S.xX)({userFunction:y,experimentStore:w.default,intl:x.default.getIntl()}));const t=e.map((e=>g.rC({environment:s,item:e,isPrivate:!1,spaceStore:i,spaceViewStore:a,useMinimalTemplates:!0,teamStore:d,type:"inTeam",from:"onboarding",isOnboarding:!0})));f=[...f,...n.oA(await Promise.all(t))]}e.templates&&e.templates.length>0&&v.createAndCommit({userAction:"spaceActions.createOnboardingTemplatesInSpace",environment:s,perform:e=>{const t={created_onboarding_templates:!0};h.sW({store:a,data:t,transaction:e})}});return f}({...e})}}return[]}({...e,spaceStore:I,userSettingsStore:o,teamStore:f,personaTeamStore:_})),o)P=await async function(e){const{environment:t,spaceStore:s,spaceViewStore:n,userSettingsStore:a,planType:o,spaceJoinOrCreate:r,isNewUserOnboarding:l}=e;if(await Promise.all([s.load(),n.load(),a.load()]),s.canEdit()){if(!n.isDefined())throw new Error(x.default.formatMessage(j.invalidSpaceStoreOnCreateTemplate));if(!a.isDefined())throw new Error(x.default.formatMessage(j.invalidUserSettings));const e=function(e,t){if(e.device.isMobile)return null;if("en-US"!==i.SP)return null;if(!t)return null;switch(w.default.getEligibleGroup({defaultGroup:"control",experimentId:"learn_notion_three_steps"})){case"on":return"learnNotionThreeSteps";case"control":return null}}(t,l);let d;if(d=e||(t.device.isMobile?"mobile":"personal"===o?"desktopPersonal":"create"===r?"desktopTeamCreate":"desktopTeamJoin"),!n.getCreatedGettingStarted())return k({environment:t,spaceStore:s,spaceViewStore:n,type:d,userSettingsStore:a});c.VUL(t,{getting_started_page_type:d,spaceId:s.id,errorType:"createdGettingStartedPageAlreadyExists"})}}({isNewUserOnboarding:T,environment:t,spaceStore:I,spaceViewStore:s,userSettingsStore:o,planType:u,spaceJoinOrCreate:p});else{const{currentUserSettingsStore:e}=b.default.state;c.VUL(t,{errorType:"userSettingsStoreNotDefined",spaceId:I.id,errorMessage:e?"currentUserSettingsStore is defined but not userSettingsStore from onboarding data":"currentUserSettingsStore is not defined as well"})}if("fork_page"===r.type){return await y.ux({environment:t,userRootStore:d,isPrivate:a,forkedPageId:r.pageId,spaceStore:I,spaceViewStore:s})}return"app_template"===C&&F.length>0?F[0]:P}async function k(e){const{environment:t,type:s,spaceStore:i,spaceViewStore:n,userSettingsStore:o}=e;if(!M.Z.state.online)return;const d=function(e,t){return(0,l.G)(r.S$[e],t)}(s,x.default.getIntl()).rootId,m=await u.loadBlockSubtree(t,{block:{id:d,spaceId:i.id},shallow:!1});let g;if("failed"===m.type)return void c.VUL(t,{getting_started_page_type:s,errorType:"loadBlockSubtreeFailed",spaceId:i.id,errorMessage:m.error.message,copyPageId:d});g=a.PF.create(m.data.subtreeRecordMap);const S="spaceActions.createGettingStartedPageInSpace",{performResult:b}=v.createAndCommit({userAction:S,environment:t,perform:e=>{const a=y.KE({environment:t,spaceStore:i,spaceViewStore:n,isPrivate:!0,prepend:!0,transaction:e});f.fL({environment:t,inMemoryRecordCache:a.inMemoryRecordCache,recordMap:g,debugSource:S});const r=p.K8(t,{blockId:d,inMemoryRecordCache:a.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!0});if(!r)throw c.VUL(t,{getting_started_page_type:s,errorType:"createAndDuplicatePageFailed",spaceId:i.id}),new Error(x.default.formatMessage(y.sY.createAndDuplicatePageError));p.E9({environment:t,sourceBlockId:d,targetBlockPointer:a.pointer,sourceBlockSubtree:r,targetInMemoryRecordCache:a.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:a.useCrdt()});const l={},u={};return"evernote"===s?u.created_evernote_getting_started=!0:l.created_getting_started=!0,Object.keys(l).length>0&&h.sW({store:n,data:l,transaction:e}),Object.keys(u).length>0&&h.sW({store:o.getSettingsStore(),data:u,transaction:e}),a}});return c.yvO(t,{getting_started_page_type:s,getting_started_page_id:d,duplicated_from_page_id:d,duplicated_to_page_id:b.id}),b}function _(e,t){return"school"===e?(0,l.H)(I,t):"personal"===e?(0,l.H)(T,t):(0,l.H)(P,t)}const T=[o.Y.quickNoteV2,o.Y.personalHomeV2,o.Y.taskList,o.Y.journalV2,o.Y.readingListV2],I=[o.Y.classNotesV2,o.Y.cornellNotesSystemV2,o.Y.clubHomepageV2,o.Y.gradeCalculatorV2],P=[o.Y.teamMeetingNotes,o.Y.teamDocs,o.Y.teamHome,o.Y.teamTasks,o.Y.taskList],Z=[o.Y.teamDocs,o.Y.teamMeetingNotes,o.Y.teamTasks]},12646:(e,t,s)=>{s.r(t),s.d(t,{GlobalSearchStaticContext:()=>Dt,GlobalSearchStoresContext:()=>Bt,default:()=>Lt});var i=s(67294),n=s(83355),a=s(13991),o=s(49085),r=s(15145),l=s(49271),d=s(1800),c=s(72126),u=s(84908),m=s(43250),p=s(24042),g=s(2342),h=s(86628),f=s(24405),y=s(36488),v=s(56940),x=s(78140),S=s(87279),b=s(35630),M=s(88632),w=s(35840),j=s(70203),C=s(82990),k=s(5366),_=s(74194),T=s(68785),I=s(31278),P=s(33411),Z=s(34700),F=s(65496),A=s(38755),D=s(80444),B=s(92338),R=s(29026);class L extends o.default{constructor(){super(...arguments),this.resetQuery=()=>{this.setState({...this.state,query:{...this.state.query,text:"",filters:(0,B.u4)()},limit:R.Xv})},this.updateQueryText=e=>{this.setState({...this.state,query:{...this.state.query,text:e},limit:R.Xv})}}getInitialState(){return{isOpen:!1,query:{text:"",filters:(0,B.u4)(),sort:{field:"relevance"}},limit:20}}}const N=new L;var E=s(85893);class O extends n.Z{constructor(){super(...arguments),this.typingTimer=void 0,this.combined=this.createComputedStore((()=>{var e,t;return F.oO({localResults:null===(e=this.props.searchResultStore.state.localResults)||void 0===e?void 0:e.results,serverResults:null===(t=this.props.searchResultStore.state.serverResults)||void 0===t?void 0:t.results})})),this.jumpToStore=this.createComputedStore((()=>{const e=this.combined.state,t=this.props.focusedIndexStore.state;if(!e||e.length<0||void 0===t)return;const s=e[t];return{focusedResultTitle:j.Jcv(null==s?void 0:s.store.getTitleValue()),focusedResultIcon:null==s?void 0:s.store.getIcon()}})),this.renderLeft=e=>{var t;const{showSpinner:s}=this.props,i=this.styles,n={...this.getThemeColors().searchIcon,...i.searchIcon()},a=Boolean(N.state.query.text.trim()),o=null===(t=this.jumpToStore)||void 0===t||null===(t=t.state)||void 0===t?void 0:t.focusedResultIcon,r=a?(0,E.jsx)(I.Z,{disabled:!0,icon:o,isEmptyPage:Boolean(o),size:20,style:n}):(0,w.R)(n);return(0,E.jsx)(P.Z,{show:s,showDelay:500,showHold:200,render:e=>e?(0,E.jsx)(T.Z,{style:n}):r})},this.handleQueryChange=e=>{this.handleTyping();const t=String(e.target.value);this.props.onQueryChange(t)},this.handleClearButtonClick=()=>{N.resetQuery()},this.styles={inputDesktop:{fontSize:18,height:O.DESKTOP_INPUT_HEIGHT,paddingLeft:16,paddingRight:16,flexGrow:0,flexShrink:0,zIndex:1,...(0,Z.X)(!0,!0)},searchIcon:()=>{const{device:e}=this.environment;return{width:e.isMobile?16:18,height:e.isMobile?16:18,marginRight:e.isMobile?12:10,flexGrow:0,flexShrink:0}},input:{minWidth:0,...C.Z.textOverflowStyle,...(0,Z.X)(!0,!1)},clearButton:{...(0,Z.X)(!0,!1)}}}willUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=void 0)}renderComponent(){var e;const{device:t}=this.environment,{isOpen:s,searchResultStore:i}=this.props,n=this.styles,a=this.getThemeColors(),o=null===(e=this.jumpToStore.state)||void 0===e?void 0:e.focusedResultTitle,r=N.state.query.text,l=(null==o?void 0:o.slice(0,r.length).toLocaleLowerCase())===r.toLocaleLowerCase()&&r&&r.length<20&&!t.isMobile?r+(null==o?void 0:o.substring(r.length)):"",d=_.Z.Format.Transparent,c={...n.inputDesktop,...a.inputDesktop};return(0,E.jsx)(_.Z,{format:d,placeholder:this.getPlaceholderText(),left:this.renderLeft(i),value:r,suggestedText:l,focus:s,focusInitial:!0,focusAfterAnimation:!0,showClearButton:!0,clearButtonStyle:n.clearButton,selectAll:!0,onChange:this.handleQueryChange,onClearButtonClick:this.handleClearButtonClick,style:c,inputStyle:n.input,window:this.props.window})}handleTyping(){const{onTypingChange:e}=this.props;this.typingTimer&&window.clearTimeout(this.typingTimer),e(!0),this.typingTimer=window.setTimeout((()=>e(!1)),O.TYPING_DEBOUNCE_MS)}getPlaceholderText(){const{currentSpaceStore:e}=D.default.state,t=e&&(0,A.rn)(this.environment,e);if(t)return this.props.intl.formatMessage({id:"searchInputMenuItem.placeholder.namedSpace",defaultMessage:"Search {spaceName}…"},{spaceName:t})}getThemeColors(){return{inputDesktop:{boxShadow:`0 1px 0 ${this.theme.regularDividerColor}`},inputMobile:{background:this.theme.inputBackground},searchIcon:{fill:this.theme.mediumIconColor}}}}O.displayName="SearchInputMenuItem",O.TYPING_DEBOUNCE_MS=300,O.DESKTOP_INPUT_HEIGHT=48,O.MAX_PLACEHOLDER_TITLE_LENGTH=100;const V=(0,k.injectIntl)(O);s(57658);var U=s(97880),W=s(32163),z=s(43145),K=s(72495),H=s(28020),G=s(15447),q=s(69327),Y=s(480),Q=s(28992),$=s(75024);const X=e=>({fontSize:12,color:e.lightTextColor,marginLeft:6,paddingRight:4,paddingLeft:4,height:24}),J=function(e){window.__c={n:"GlobalSearchFooterContainer"};const t=(0,Y.O7)(),{device:s}=t,i=(0,f.yK)((e=>({footer:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:s.isMobile?C.Z.fontSize.UIRegular.mobile:C.Z.fontSize.UIRegular.desktop},footerWrapper:{flexShrink:0,...(0,Z.X)(!0,!0)},footerText:{color:e.lightTextColor,fontSize:$.yv(t,"UISmall"),...C.Z.textOverflowStyle},footerDebugButton:{...X(e),marginRight:6}})),[s.isMobile,t]);return(0,E.jsx)("footer",{style:i.footerWrapper,children:(0,E.jsx)(K.Z,{topBorder:!0,style:i.footer,disableDesktopPadding:!0,children:(0,E.jsx)(Q.Z,{...e,style:i.footerText})})})};var ee=s(75e3);function te(){window.__c={n:"GlobalSearchFooterNavigationHints"};const e=(0,Y.O7)(),t=(0,k.useIntl)(),s=(0,f.yK)((t=>({upDownIcon:{marginRight:4,marginBottom:-2,display:"inline",width:12,height:12,fill:t.mediumIconColor},enterIcon:{marginRight:4,marginBottom:-2,display:"inline",width:11,height:11,fill:t.mediumIconColor},commandGlyph:{fontSize:.75*$.yv(e,"UIRegular"),paddingRight:1,color:t.lightTextColor},footerText:{fontSize:$.yv(e,"UISmall"),color:t.lightTextColor,...C.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16}})),[e]),i={...$.mK,...s.footerText};return(0,E.jsx)("ul",{style:i,children:(0,E.jsxs)("li",{style:s.inlineHint,children:[(0,ee.U)(s.enterIcon),t.formatMessage({id:"searchFooter.helpText.openNewTab",defaultMessage:"Open in a new tab"})]})})}var se=s(94184),ie=s.n(se),ne=s(8848),ae=s(79362),oe=s(21202),re=s(32739),le=s(45168),de=s(24039),ce=s(90403),ue=s(52275),me=s(64133),pe=s(12981),ge=s(86176),he=s(76798),fe=s(26388),ye=s(95477),ve=s(69988),xe=s(98742),Se=s(98165),be=s(16402),Me=s(90106),we=s(35057),je=s(3043),Ce=s(64921),ke=s(31945),_e=s(96525),Te=s(40721),Ie=s(89728),Pe=s(11470),Ze=s(95697);class Fe extends n.Z{constructor(){super(...arguments),this.getBreadcrumbCommonProps=e=>({maxWidth:this.props.ancestorMaxWidth,iconSize:this.props.iconSize,titleStyle:this.getTitleStyle(),iconStyle:Fe.iconStyle,highlighter:this.props.highlighter})}renderComponent(){const{store:e}=this.props,t=e.getTitleStore();if(t&&t.isReady())return(0,E.jsx)("div",{style:this.getStyle(),className:"notranslate",children:this.renderAncestors()})}renderAncestors(){const{store:e,maxAncestorCount:t}=this.props,s=Se.uJ(e),i=e.isNavigableBlock()?s.slice(1):[...s];if(i.reverse(),s.reverse(),i.length>t){const[e,n,a]=[i[0],i.slice(1,i.length-t+1),i.slice(i.length-t+1)];if((0,Ze.bq)()){const t=a.length;return[this.renderButtonForStore({store:e,showDivider:!this.props.isMobile}),this.renderBlocksAsPopup(this.props.isMobile?s:n),...a.map(((e,s)=>{const i=!this.props.hideCurrentPage||s!==t-1;return e instanceof Me.zX?(0,E.jsx)(je.Yo,{store:e,showDivider:i,...this.getBreadcrumbCommonProps(e)},e.id):(0,E.jsx)(je.Qe,{store:e,showDivider:i,...this.getBreadcrumbCommonProps(e)},e.id)}))]}{const e=i.filter((e=>e instanceof Me.G)),s=i.filter((e=>e instanceof Me.G)),n=e.length;return[(0,E.jsx)(je.Qe,{store:e[0],showDivider:!this.props.isMobile,...this.getBreadcrumbCommonProps(e[0])},e[0].id),this.renderBlocksAsPopup(this.props.isMobile?s:e.slice(1,e.length-t+1)),...e.slice(e.length-t+1).map(((e,t)=>(0,E.jsx)(je.Qe,{store:e,showDivider:!this.props.hideCurrentPage||t!==n-1,...this.getBreadcrumbCommonProps(e)},e.id)))]}}{const e=i.length;return i.map(((t,s)=>this.renderButtonForStore({store:t,showDivider:!this.props.hideCurrentPage||s!==e-1})))}}renderButtonForStore(e){const{store:t,showDivider:s}=e;return t instanceof Me.zX?(0,E.jsx)(je.Yo,{store:t,showDivider:s,...this.getBreadcrumbCommonProps(t)}):(0,E.jsx)(je.Qe,{store:t,showDivider:s,...this.getBreadcrumbCommonProps(t)})}getMenuListSections(e){const t=this.props.isMobile?ke.Z4.SlideUp:ke.Z4.Popup;return[{key:"results",render:e=>(0,E.jsx)(K.Z,{...e}),items:e.map(((e,s)=>({key:e.id,render:i=>(0,E.jsx)(_e.Z,{...i,stopClickPropagation:!0,popupType:t,renderOrigin:t=>(0,E.jsx)(Pe.Z,{...t,isSubpage:0!==s,store:e,hidePath:!0,focused:!1}),render:e=>null}),action:()=>{}})))}]}renderBlocksAsPopup(e){return(0,E.jsx)(ke.ZP,{popupType:this.props.isMobile?ke.Z4.SlideUp:ke.Z4.Popup,renderOrigin:e=>{var t;return this.props.isMobile?(0,E.jsxs)(Ce.Z,{style:{...Fe.dividerWrapStyle},mobileFeedback:!0,...e,children:[(0,E.jsx)(je.fY,{}),(0,E.jsx)("div",{style:Ae,children:"..."}),(0,E.jsx)(je.fY,{})]}):(0,E.jsxs)("div",{style:Fe.dividerWrapStyle,children:[(0,E.jsx)(Ie.Z,{isSmall:!0,...e,style:{paddingLeft:2,paddingRight:2,fontSize:null===(t=this.props.style)||void 0===t?void 0:t.fontSize},children:"..."}),(0,E.jsx)(je.fY,{})]})},render:t=>{let s;return s=this.props.isMobile?{menuType:S.og.Modal,title:(0,E.jsx)(k.FormattedMessage,{defaultMessage:"Breadcrumb",id:"globalSearch.breadcrumb.mobileBreadcrumbMenu.title"}),right:(0,E.jsx)(Te.DoneMenuText,{}),onClickRight:t.close}:{menuType:S.og.Popup,width:240},(0,E.jsx)(x.Z,{...s,children:(0,E.jsx)(W.Z,{type:W.i.Vertical,initialFocus:void 0,sections:this.getMenuListSections(e)})})}},"pages-popup")}getStyle(){return{display:"flex",alignItems:"center",lineHeight:1.2,fontSize:this.props.isMobile?C.Z.fontSize.UIRegular.mobile:C.Z.fontSize.UIRegular.desktop,color:this.theme.lightTextColor,filter:"grayscale(70%)",...this.props.style}}getTitleStyle(){return{lineHeight:1.2,fontSize:this.props.isMobile?C.Z.fontSize.UISmall.mobile:C.Z.fontSize.UISmall.desktop,color:this.theme.lightTextColor}}}Fe.displayName="SearchPathBreadcrumb",Fe.iconStyle={marginRight:3},Fe.dividerWrapStyle={display:"flex",alignItems:"center",flexShrink:0};const Ae={marginLeft:3,marginRight:3};class De extends n.Z{constructor(){super(...arguments),this.storeTypes={explanationModalOpen:o.default.createClass(!1)},this.styles={title:{fontWeight:C.Z.fontWeight.medium,lineHeight:"20px"},jumpToTitle:{fontWeight:C.Z.fontWeight.medium,fontSize:15,lineHeight:"20px"},menuItem:{minHeight:36,paddingTop:this.environment.device.isMobile?12:8,paddingBottom:this.environment.device.isMobile?12:8},textWrapper:{marginLeft:10,alignItems:void 0,flex:void 0,width:"100%"},inlineTextWrapper:{alignItems:"baseline"},highlight:{fontWeight:C.Z.fontWeight.medium},vectorHighlight:{fontWeight:C.Z.fontWeight.medium,whiteSpace:"pre-wrap"},enterIcon:{height:14,width:14},uniqueIDBadgeWrapper:{display:"flex",gap:8,marginRight:8,alignItems:"center"},caption:{marginTop:1},debugArea:{fontFamily:"monospace"},timestamp:{fontSize:C.Z.fontSize.UISmall.desktop,fontWeight:C.Z.fontWeight.regular},toolTip:{maxWidth:300},toolTipTitle:{fontWeight:C.Z.fontWeight.medium,fontSize:C.Z.fontSize.UISmall.desktop},toolTipText:{fontWeight:C.Z.fontWeight.medium,fontSize:C.Z.fontSize.UISmall.desktop,marginLeft:0,paddingRight:20},toolTipValue:{fontSize:C.Z.fontSize.UISmall.desktop,fontWeight:C.Z.fontWeight.regular},toolTipMenuItem:{minHeight:20}},this.debugHitCustomRenderer=e=>{let{data:t,keyPath:s}=e;if(2===s.length&&"_explanation"===s[0])return{element:(0,E.jsx)(E.Fragment,{children:(0,E.jsx)("button",{onClick:e=>{this.stores.explanationModalOpen.setState(!0),e.stopPropagation()},children:"show simplified explanation"})}),expanded:!1};const i=t._ltrlog;if(i)return function(e){const t=Object.keys(e[0])[0],s=e[0][t].map(((e,t)=>{const s=t%2==0?Le:Re;return(0,E.jsxs)("tr",{children:[(0,E.jsx)("td",{style:s,children:`${t}`}),(0,E.jsx)("td",{style:s,children:`${e.name}`}),(0,E.jsx)("td",{style:s,children:`${e.value}`})]},e.name)}));return{element:(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("div",{children:(0,E.jsx)("b",{children:`Featureset: ${t}`})}),(0,E.jsx)("div",{style:{maxHeight:200,overflowY:"scroll"},children:(0,E.jsx)("table",{style:{border:"1px solid black"},children:s})})]}),expanded:!1}}(i);if(!["_score","matched_queries"].every((e=>t[e])))return null;const{_score:n,matched_queries:a}=t;return{element:(0,E.jsx)(E.Fragment,{children:`score ${n}, ${(a??[]).length} matched query clauses`}),expanded:!1}}}renderComponent(){const{focused:e,isLastInSection:t,isBeforeFocused:s,inline:i,className:n}=this.props,a=this.styles,o=this.getThemeColors(),r={...a.menuItem,...!i&&!t&&!s&&!e&&o.menuItemBorder},l={...a.caption,...o.caption},d={...a.timestamp,...o.timestamp},c={...a.textWrapper,...this.props.inline&&a.inlineTextWrapper},u={title:this.renderTitle(),icon:this.renderIcon(),caption:this.renderCaption(),body:this.renderPreview(),right:this.renderRight(e),rightStyle:e?void 0:d,dontShrinkRight:!0,captionStyle:l,style:r,spacerStyle:this.hasPath()?void 0:Ee,textWrapperStyle:c,className:ie()("notranslate",n),buttonStyle:{paddingLeft:2},hoveredStyle:{background:this.theme.buttonHoveredBackground}};return(0,we.Mk)()?(0,E.jsx)(fe.Z,{delayThreshold:50,disableTooltip:!0,placement:fe.Z.Placement.Right,originGap:18,renderTooltip:()=>this.renderTooltip(),style:a.toolTip,render:e=>(0,E.jsx)(ue.Z,{...this.props,...u,disableTransition:!0,ignoreLocalHoverState:!0,...(0,xe.Z)(e,this.props)})}):(0,E.jsx)(ue.Z,{...this.props,...u,disableTransition:!0,ignoreLocalHoverState:!0})}renderTooltip(){return(0,E.jsx)(de.Z,{store:this.props.store})}renderTitle(){var e;const{store:t,result:s,placeholder:i,index:n}=this.props,a=this.styles,o=this.getThemeColors(),r=void 0===s,l={...(null==s?void 0:s.sources.includes(B.vp.Local))&&0===n?a.jumpToTitle:a.title,...!r&&o.nonHighlightedTextColor},d=[];if(s&&s.highlight)if(d.push(...(0,ve.fe)(s.highlight.pathText)),this.usesFullPageIndexingHighlight())d.push(...(0,ve.fe)(s.highlight.title));else{Me.G.createChildStore(this.props.store,{table:oe.iU,id:s.id,spaceId:s.spaceId}).isNavigableBlock()&&d.push(...(0,ve.fe)(s.highlight.text))}const c=this.getWordHighlighter({words:d}),u=null===(e=(0,Se.VP)(t))||void 0===e?void 0:e.isArchived(),m=(0,le.e)(s);return(0,E.jsx)("div",{style:{display:"flex",justifyContent:"space-between",...l},children:(0,E.jsxs)("div",{style:{display:"flex"},children:[m&&this.renderUniqueIdHighlight(s),(0,E.jsx)(he.Z,{style:l,store:t,placeholder:i,highlighter:c}),!1,u&&(0,E.jsx)(ce.Z,{content:(0,E.jsx)(k.FormattedMessage,{id:"globalSearch.result.archived.badge.text",defaultMessage:"Archived"}),style:Ne})]})})}renderUniqueIdHighlight(e){var t;const{focused:s}=this.props,i=null==e||null===(t=e.highlight)||void 0===t?void 0:t.uniqueId;if(!i)return;const n="dark"===this.environment.ThemeStore.state.mode,a=this.styles,o=this.getWordHighlighter({words:[i]}),r=s?n?ne.FN.dark.translucentGray[300]:ne.se.light.darkgray.alpha(.09):n?ne.FN.dark.translucentGray[200]:ne.se.light.darkgray.alpha(.06);return(0,E.jsxs)("div",{style:a.uniqueIDBadgeWrapper,children:[(0,E.jsx)("div",{children:(0,E.jsx)(me.Z,{text:i,highlighter:o})}),(0,E.jsx)("div",{style:{borderRight:`1.5px solid ${r}`,height:14,borderRadius:1}})]})}renderRight(e){const{result:t}=this.props,s=Boolean(t);return(0,E.jsx)("div",{style:{display:"flex",width:s?this.styles.enterIcon.width:void 0},children:e?this.renderEnterIcon():this.renderTimestamp()})}renderTimestamp(){const{result:e,lastViewed:t}=this.props;if(!e&&t)return(0,be.IS)(t,{useCompactFormat:!0})}renderIcon(){const{store:e}=this.props,t=e.getIcon();if(t&&ae.V2(t.icon)){const e=(0,re.NV)({httpUrl:ye.default.domainBaseUrl,protocol:ye.default.protocol,includePort:!0}),s={width:20,height:20,objectFit:"cover",borderRadius:3,transition:"opacity 100ms ease-out"};return(0,E.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:20,width:20,borderRadius:"0.25em",flexShrink:0},className:`${m.S94} notranslate`,children:(0,E.jsx)("div",{children:(0,E.jsx)(pe.Z,{src:`${e}${t.icon}?mode=${this.theme.mode}`,style:{...s,background:void 0},onContextMenu:e=>e.preventDefault()})})})}return(0,E.jsx)(E.Fragment,{children:(0,E.jsx)(I.Z,{disabled:!0,icon:e.getIcon(),isEmptyPage:e.isEmptyPage(),size:20,largeIcon:!0})})}renderCaption(){const{store:e,inline:t,result:s}=this.props,i=this.getWordHighlighter({words:(0,ve.fe)(s&&s.highlight&&s.highlight.pathText),removeDuplicate:!0}),{device:n}=this.environment,a=t||n.isMobile?0:2;return(0,E.jsx)(E.Fragment,{children:(0,E.jsx)(ge.Z,{store:e,extraLength:a,showFullPathInTooltip:!0,highlighter:i})})}renderPreview(){var e,t;const{result:s}=this.props;if(!s)return;if(!s.highlight)return;if(Me.G.createChildStore(this.props.store,{table:oe.iU,id:s.id,spaceId:s.spaceId}).isNavigableBlock()&&!this.usesFullPageIndexingHighlight())return;if(!s.highlight.text)return;const i=s.highlight.text,n=(0,ve.ZP)(i);if(this.usesFullPageIndexingHighlight()){const e=e=>e.filter(ve.il).map((e=>e[0].toLowerCase())),t=t=>void 0===t?[]:e((0,ve.ZP)(t)),i=[...new Set([...t(s.highlight.title),...t(s.highlight.pathText)])],a=e=>i.some((t=>t.includes(e)));if(e(n).every((e=>a(e))))return}const a=this.styles,o=null!==(e=s.sources)&&void 0!==e&&e.includes(B.vp.VectorDBBlock)||null!==(t=s.sources)&&void 0!==t&&t.includes(B.vp.VectorDBCollection)?a.vectorHighlight:a.highlight,r=this.getThemeColors();return(0,E.jsx)(E.Fragment,{children:(0,E.jsx)(me.Z,{text:i,highlighter:{tokenize:e=>(0,ve.Vu)(n),style:{...o,...r.highlight}}})})}usesFullPageIndexingHighlight(){const{result:e}=this.props;return e&&!e.sources.includes(B.vp.Local)}getWordHighlighter(e){const{words:t,removeDuplicate:s}=e;if(0===t.length)return;const i={...this.styles.highlight,...this.getThemeColors().highlight},n=s?new Set:void 0;return{tokenize:e=>(0,ve.XT)({text:e,patterns:t,uniqueTokenHighlighterContext:n}),style:i}}renderEnterIcon(){const{device:e}=this.environment,{focused:t}=this.props,s=this.styles,i=this.getThemeColors();if(e.isMobile)return;const n={...s.enterIcon,...i.enterIcon,opacity:t?1:0};return(0,ee.U)(n)}hasPath(){const{hidePath:e,store:t}=this.props;return!e&&(0,ge.L)(t)}getThemeColors(){return{nonHighlightedTextColor:{color:this.theme.mediumTextColor},menuItemBorder:{boxShadow:`0 1px 0 ${this.theme.lightDividerColor}`},highlight:{color:this.theme.regularTextColor},enterIcon:{fill:this.theme.mediumIconColor},caption:{color:this.theme.mediumTextColor},timestamp:{color:this.theme.lightTextColor},toolTipTitle:{color:this.theme.mediumTextColor},toolTipText:{color:this.theme.regularTextColor},toolTipValue:{color:this.theme.lightTextColor}}}}De.displayName="SearchResultMenuItem",De.contextTypes={...S.mw,...n.w};const Be=De,Re={paddingLeft:5,paddingRight:20,paddingTop:2,paddingBottom:2,border:"1px solid black",color:ne.FN.dark.green[900]},Le={...Re,color:ne.FN.dark.gray[30]};const Ne={fontWeight:C.Z.fontWeight.regular},Ee={visibility:"hidden"};class Oe extends n.Z{constructor(){super(...arguments),this.storeTypes={isLoadingRecents:o.default.createClass(!1),endOfRecentsReached:o.default.createClass(!1)},this.renderComponent=()=>{if(!G.X4.state)return;const{device:e}=this.environment,t=this.defaultViewStyles,{currentSpaceStore:s}=D.default.state;if(!s)return;const i=(0,H.np)(),n=G.X4.state.filter((e=>e.pageId!==(null==i?void 0:i.id))),a={};n.forEach((e=>{let{pageId:t,visitedAt:s}=e;return a[t]=s}));const o=new Map;n.map(((t,s)=>{const i=G._5(t.visitedAt),n="Today"!==i&&"Yesterday"!==i,r={key:`${t.store.id}:${s}`,action:e=>this.props.onSelect({store:t.store,action:e}),render:s=>(0,E.jsx)(Be,{...s,inline:!e.isMobile,store:t.store,hidePath:!1,lastViewed:n?a[t.store.id]:void 0,buttonStyle:{paddingLeft:1}})};var l;o.has(i)?null===(l=o.get(i))||void 0===l||l.push(r):o.set(i,[r])}));const r=[];for(const[d,c]of o.entries()){const e=this.getMessageFromBucket(d),s={key:d,items:c,render:s=>(0,E.jsx)(K.Z,{title:e,desktopTitleStyle:t.sectionHeader,disableDesktopPadding:!0,style:t.section,children:s.children})};r.push(s)}const l=!e.isMobile&&n.length>0;return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)("div",{style:t.wrapper,children:[(0,E.jsx)(W.Z,{type:W.i.Vertical,initialFocus:0,disableKeyboardArrowWrap:!0,sections:r,unfocusOnScroll:!0}),(0,E.jsx)(z.Z,{onChange:this.handleScrollOffsetChange})]}),l&&(0,E.jsx)(J,{title:(0,E.jsx)(te,{})})]})},this.handleScrollOffsetChange=e=>{this.getLastPageTimestamp()&&e<=200&&!this.stores.isLoadingRecents.state&&!this.stores.endOfRecentsReached.state&&this.loadMoreRecents()},this.loadMoreRecents=c.P2((async()=>{const e=this.getLastPageTimestamp(),{currentSpaceStore:t}=D.default.state,s=this.environment.currentUser.id,i=null==t?void 0:t.id;if(!s||!i||!e)return;this.stores.isLoadingRecents.setState(!0);const n=await G.Od(e,{environment:this.environment,userId:s,spaceId:i});this.stores.isLoadingRecents.setState(!1),n||this.stores.endOfRecentsReached.setState(!0)}),300),this.defaultViewStyles={wrapper:{width:"100%",height:"100%",overflowX:"hidden",overflowY:"auto"},sectionHeader:{fontWeight:C.Z.fontWeight.semibold,marginBottom:7,marginLeft:2},section:{marginBottom:18}}}getLastPageTimestamp(){const{currentSpaceStore:e}=D.default.state;if(!e)return;const t=q.Z.getWithoutSubscribing(e.id),s=t[t.length-1];return null==s?void 0:s.visitedAt}getMessageFromBucket(e){switch(e){case"Today":return(0,E.jsx)(k.FormattedMessage,{id:"globalSearch.recentPagesTimeBuckets.today.text",defaultMessage:"Today"});case"Yesterday":return(0,E.jsx)(k.FormattedMessage,{id:"globalSearch.recentPagesTimeBuckets.yesterday.text",defaultMessage:"Yesterday"});case"Past Week":return(0,E.jsx)(k.FormattedMessage,{id:"globalSearch.recentPagesTimeBuckets.pastWeek.text",defaultMessage:"Past Week"});case"Past 30 Days":return(0,E.jsx)(k.FormattedMessage,{id:"globalSearch.recentPagesTimeBuckets.past30Days.text",defaultMessage:"Past 30 Days"});case"Older":return(0,E.jsx)(k.FormattedMessage,{id:"globalSearch.recentPagesTimeBuckets.older.text",defaultMessage:"Older"})}(0,U.t1)(e)}}Oe.displayName="SearchDefaultBody";const Ve=Oe;var Ue=s(11751),We=s(87531),ze=s(12921),Ke=s(29798),He=s(50506),Ge=s(63296),qe=s(77907),Ye=s(32470);class Qe extends n.Z{constructor(){super(...arguments),this.storeTypes={requestModalOpen:o.default.createClass(!1),responseModalOpen:o.default.createClass(!1)},this.styles={footer:()=>{const{device:e}=this.environment;return{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",fontSize:e.isMobile?C.Z.fontSize.UIRegular.mobile:C.Z.fontSize.UIRegular.desktop}},footerText:{fontSize:$.yv(this.environment,"UISmall"),...C.Z.textOverflowStyle},inlineHint:{display:"inline",marginRight:16},resultCountWrapper:{display:"flex",alignItems:"center",...C.Z.textOverflowStyle},resultCount:{fontWeight:C.Z.fontWeight.medium},resultText:{verticalAlign:"middle",marginRight:6},spinner:{display:"inline",width:12,height:12,verticalAlign:"middle"},keyboardShortcut:{marginRight:4,marginBottom:1,fontVariant:"all-small-caps",fontSize:1.1*$.yv(this.environment,"UISmall")},commandGlyph:{fontSize:.75*$.yv(this.environment,"UIRegular")},footerDebugButton:X(this.theme),debugModalStyle:{maxHeight:"90vh",maxWidth:"90vw",height:"90vh",width:"90vw",overflow:"scroll",padding:10},navigationHints:{marginLeft:15}}}renderComponent(){const{shouldShow:e}=this.props;if(!e)return;const t=this.styles,s=this.getThemeColors(),i={...t.resultCount,...s.resultCount},{count:n,isLowerBound:a}=this.props.searchResultStore.getResultCount(),o=(0,E.jsx)("span",{style:t.resultText,children:a?this.props.intl.formatMessage({id:"SearchResultsFooter.helpText.resultCountApproximate",defaultMessage:"{resultCount, plural, other {<resultwrapper>{resultCount}+</resultwrapper> results}}"},{resultCount:n,resultwrapper:e=>(0,E.jsx)("span",{style:i,children:e})}):this.props.intl.formatMessage({id:"SearchResultsFooter.helpText.resultCount",defaultMessage:"{resultCount, plural, one {<resultwrapper>{resultCount}</resultwrapper> result} other {<resultwrapper>{resultCount}</resultwrapper> results}}"},{resultCount:n,resultwrapper:e=>(0,E.jsx)("span",{style:i,children:e})})}),r=(0,E.jsxs)("div",{style:t.resultCountWrapper,children:[o,this.renderSpinner(this.props.showSpinner),(0,E.jsx)("div",{style:t.navigationHints,children:(0,E.jsx)(te,{})})]});return(0,E.jsx)(J,{title:r,right:(0,E.jsx)(E.Fragment,{children:this.renderSearchDebugButtons()})})}renderSpinner(e){const t=this.styles;return(0,E.jsx)(P.Z,{show:e,showDelay:500,showHold:200,render:e=>e&&(0,E.jsx)(T.Z,{style:t.spinner})})}renderSearchDebugButtons(){var e;if(!Ye.ZP.state.debug&&!Ye.ZP.state.showDebugInfo)return;const{rawRequests:t,rawResponses:s}=(null===(e=this.props.searchResultStore.state.serverResults)||void 0===e||null===(e=e.debugInfo)||void 0===e?void 0:e.response)||{};return(0,E.jsxs)(E.Fragment,{children:[t&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(He.Z,{open:this.stores.requestModalOpen.state,innerStyle:this.styles.debugModalStyle,onDismiss:()=>{this.stores.requestModalOpen.setState(!1)},render:()=>(0,E.jsx)(qe.LazyAdminReactJson,{showCopyButton:"large",defaultCollapsed:!1,data:t})}),(0,E.jsx)(Ge.Z,{style:this.styles.footerDebugButton,onClick:()=>this.stores.requestModalOpen.setState(!0),children:"Open Request"})]}),s&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(He.Z,{open:this.stores.responseModalOpen.state,innerStyle:this.styles.debugModalStyle,onDismiss:()=>{this.stores.responseModalOpen.setState(!1)},render:()=>(0,E.jsx)(qe.LazyAdminReactJson,{showCopyButton:"large",data:{rawResponses:s},defaultCollapsed:!1})}),(0,E.jsx)(Ge.Z,{style:this.styles.footerDebugButton,onClick:()=>this.stores.responseModalOpen.setState(!0),children:"Open Response"})]})]})}getThemeColors(){return{footerText:{color:this.theme.lightTextColor},resultCount:{color:this.theme.mediumTextColor},keyboardShortcut:{color:this.theme.mediumTextColor}}}}Qe.displayName="SearchResultsFooter";const $e=(0,k.injectIntl)(Qe);var Xe=s(43765),Je=s(64369);function et(e){window.__c={n:"GlobalSearchActionMenuItem"};const{inline:t,title:s,focused:i,isBeforeFocused:n,className:a}=e,{icon:o,...r}=e,l=(0,f.yK)((e=>({hoveredStyle:{background:e.buttonHoveredBackground}})),[]),d=(0,f.yK)((e=>({style:{minHeight:36,paddingTop:8,paddingBottom:8,...!t&&!n&&!i&&{boxShadow:`0 1px 0 ${e.lightDividerColor}`}},textWrapper:{marginLeft:10,alignItems:void 0,flex:void 0,width:"100%",display:"block",textOverflow:"ellipsis",...t&&{alignItems:"baseline"}},icon:{display:"block",flexShrink:0,height:18,width:18,color:e.mediumTextColor},enterIcon:{height:14,width:14,fill:e.mediumIconColor},iconContainer:{marginTop:1}})),[i,t,n]),c={title:s,icon:tt(o,d.icon,d.iconContainer),style:d.style,textWrapperStyle:d.textWrapper,right:st(i,d.enterIcon),className:ie()("notranslate",a),buttonStyle:{paddingLeft:2},hoveredStyle:l.hoveredStyle};return(0,E.jsx)(ue.Z,{...r,...c,disableTransition:!0,ignoreLocalHoverState:!0})}function tt(e,t,s){return(0,E.jsx)(Je.Z,{style:s,children:e(t)})}function st(e,t){const s={...t,opacity:e?1:0};return(0,E.jsx)("div",{style:{display:"flex"},children:(0,ee.U)(s)})}var it=s(39634),nt=s(16354),at=s(36507);class ot extends n.Z{constructor(){super(...arguments),this.handleSendMessageClick=()=>{it.j({environment:this.environment,from:"quick_find"})},this.styles={menuItem:{marginTop:"auto",marginBottom:"auto"},caption:{marginTop:"auto"},reportProblemButton:{display:"inline"},searchDeletedButton:{display:"inline",lineHeight:"25px"}}}renderComponent(){return(0,E.jsx)(at.Z,{...this.getErrorMessage(),style:this.styles.menuItem,captionStyle:this.styles.caption,shouldWrapCaption:!0})}renderNoResults(){return{title:ot.noResultsTitle,caption:this.renderNoResultsMessage()}}renderNoResultsMessage(){const e=N.state.query.filters,t=F.FN(e);if(!F.VD.isDeletedOnly(e.isDeletedOnly)){const e=this.styles,t=this.getThemeColors(),s={...e.searchDeletedButton,...t.searchDeletedButton};return(0,E.jsx)(k.FormattedMessage,{id:"globalSearchErrorMenuItem.errorPrompt.searchDeleted",defaultMessage:"Some results may be in your deleted pages.{br}<searchdeleted>Search deleted pages</searchdeleted>",values:{searchdeleted:e=>(0,E.jsx)(nt.Z,{onClick:this.props.handleSearchDeletedOnly,style:s,children:e}),br:(0,E.jsx)("br",{})}})}return t?(0,E.jsx)(k.FormattedMessage,{defaultMessage:"Try different search terms or filters",id:"globalSearchErrorMenuItem.errorPrompt.searchTermsAndFilters"}):(0,E.jsx)(k.FormattedMessage,{defaultMessage:"Try different search terms",id:"globalSearchErrorMenuItem.errorPrompt.searchTerms"})}renderOffline(){return{title:ot.noResultsTitle,caption:(0,E.jsx)(k.FormattedMessage,{defaultMessage:"Go online for more results.",id:"globalSearchErrorMenuItem.errorPrompt.goOnline"})}}renderRequestFailed(){const e=this.styles,t=this.getThemeColors(),s={...e.reportProblemButton,...t.reportProblemButton};return{title:(0,E.jsx)(k.FormattedMessage,{id:"globalSearchErrorMenuItem.error.genericErrorMessage",defaultMessage:"Something went wrong"}),caption:(0,E.jsx)(k.FormattedMessage,{id:"globalSearchErrorMenuItem.errorPrompt.refreshOrReport",defaultMessage:"Try refreshing or <reportlink>report a problem</reportlink>.",values:{reportlink:e=>(0,E.jsx)(nt.Z,{onClick:this.handleSendMessageClick,style:s,children:e})}})}}getErrorMessage(){const{error:e}=this.props;switch(e.type){case B.Ix.NoResults.type:return this.renderNoResults();case B.Ix.Offline.type:return this.renderOffline();case B.Ix.RequestFailed.type:return this.renderRequestFailed();default:(0,U.t1)(e)}}getThemeColors(){return{reportProblemButton:{color:this.theme.blueColor},searchDeletedButton:{color:this.theme.blueColor}}}}ot.displayName="SearchErrorMenuItem",ot.contextTypes={...S.mw,...n.w},ot.noResultsTitle=(0,E.jsx)(k.FormattedMessage,{defaultMessage:"No results",id:"globalSearchErrorMenuItem.error.noResults"});const rt=ot;function lt(e){if(e){switch(e){case"local":return(0,E.jsx)(k.FormattedMessage,{id:"globalSearch.searchResultBuckets.recent.text",defaultMessage:"Jump back in"});case"server":return(0,E.jsx)(k.FormattedMessage,{id:"globalSearch.searchResultBuckets.server.text",defaultMessage:"More results"});case"actions":return(0,E.jsx)(k.FormattedMessage,{id:"globalSearch.searchActions.actions.text",defaultMessage:"Actions"});case"unique_id":return(0,E.jsx)(k.FormattedMessage,{id:"globalSearch.searchResultBuckets.uniqueID.text",defaultMessage:"ID matches"});case"main":return(0,E.jsx)(k.FormattedMessage,{id:"globalSearch.searchResultBuckets.bestMatches.text",defaultMessage:"Best Matches"})}(0,U.t1)(e)}}function dt(e,t){if(!e.isLoading)return e.showMajorError?(0,E.jsx)(rt,{error:e.serverError,handleSearchDeletedOnly:()=>{}}):e.serverError&&e.serverError!==B.Ix.NoResults?function(e,t){return(0,E.jsx)(K.Z,{disableMobilePadding:!0,disableMobileBorders:!0,children:(0,E.jsx)(Xe.Z,{title:e,style:t})})}(e.serverError.message,t):void 0}function ct(e,t,s,i){const{store:n}=e,a=n.isNavigableBlock()?n:n.getNavigableBlockStore();if(a)return{key:`${n.id}:${t}`,action:t=>{i.handleSelectResult({store:n,action:t,selectedResult:e,allSearchResults:s})},render:s=>(0,E.jsx)(Be,{...s,index:t,originalPosition:e.originalPosition,isFirstInSection:0===t,store:a,hidePath:!1,result:e,className:m.ulv,inline:!1})}}const ut=(0,k.injectIntl)((function(e){var t;window.__c={n:"GlobalSearchResultsMenuList"};const[s,n]=(0,i.useState)(!1),a=(0,Y.Fy)().isMobile,o=(0,f.yK)((e=>({results:{flex:1,display:"flex",flexDirection:"column",overflow:"auto",height:"100%"},messageMenuItem:{...a&&{background:void 0,boxShadow:void 0}},actionMenuItemTitle:{fontWeight:C.Z.fontWeight.medium,lineHeight:"20px",fontSize:15,color:e.mediumTextColor,textOverflow:"ellipsis",overflow:"hidden",display:"block"},menuListContainer:{display:"flex",flexDirection:"column",gap:12,marginTop:a?13:void 0}})),[a]),{results:r,resultListStore:l,intl:d,showActions:u}=e,m=e.errorState,p=(0,h.VK)((()=>N.state.query.text),[]),g=u.length>0?{key:"actions",render:e=>(0,E.jsx)(K.Z,{...e,shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:lt("actions")}),items:c.oA(u.map((e=>function(e){const{type:t,title:s,icon:i,action:n}=e;return{key:`actionMenuItem.${t}`,action:n,render:e=>(0,E.jsx)(et,{...e,title:s,icon:i})}}({...e,title:e.renderTitle(p,d,o.actionMenuItemTitle)}))))}:void 0,y=(0,h.VK)((()=>r?r.filter((e=>e.sources.includes(B.vp.ElasticsearchUniqueID))):[]),[r]),v=(0,i.useMemo)((()=>new Set(y.map((e=>e.id)))),[y]),x=(0,h.VK)((()=>y.length>0?{key:"uniqueIdSearchResultSection",render:e=>(0,E.jsx)(K.Z,{...e,shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:lt("unique_id")}),items:c.oA(y.map(((t,s)=>ct(t,s,y,e))))}:void 0),[y,e]),S=(0,h.VK)((()=>(r||[]).filter((e=>!v.has(e.id)))),[r,v]),b=(0,h.VK)((()=>[]),[]),M=(0,h.VK)((()=>{const t=(()=>{if(0!==v.size)return v.size>0?"main":void 0})();return S.length>0?{key:"mainSearchResultSection",render:e=>(0,E.jsx)(K.Z,{...e,shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:lt(t)}),items:c.oA(S.map(((t,s)=>ct(t,s,S,e))))}:void 0}),[S,v.size,e]),w=(0,h.VK)((()=>b.length>0?{key:"serverOnlySearchResultSection",render:e=>(0,E.jsx)(K.Z,{...e,shouldShowBottomDivider:!1,disableDesktopPadding:!0,disableMobilePadding:!0,disableMobileBorders:!0,title:lt("server")}),items:c.oA(b.map(((t,s)=>ct(t,s,b,e))))}:void 0),[b,e]),j=[g,x,M,w].filter(U.$K),k=(0,i.useCallback)(((t,i)=>{const{onMaybeLoadMoreResults:a}=e,o=t<=200;o&&!s&&a(),n(o)}),[s,e]),_=M||w?(null==g||null===(t=g.items)||void 0===t?void 0:t.length)??0:0;return(0,E.jsxs)("section",{style:o.results,children:[j&&(0,E.jsx)("div",{className:"search-results-list",children:(0,E.jsx)(W.Z,{type:W.i.Vertical,initialFocus:_,store:l,disableKeyboardArrowWrap:!0,sections:j,style:o.menuListContainer})}),dt(m,o.messageMenuItem)||(0,E.jsx)(z.Z,{onChange:k})]})}));const mt=function(e){window.__c={n:"GlobalSearchResultsBody"};const{searchResultStore:t}=e,s=(0,Y.O7)(),n=(0,Y.Fy)(),a=(0,f.yK)((e=>({container:{display:"flex",flexDirection:"column",width:"100%",flex:1,overflow:"hidden"},askAiLabel:{color:e.aiPurpleColor,fontWeight:C.Z.fontWeight.semibold},askAiQuery:{fontWeight:C.Z.fontWeight.regular},askAiIcon:{fill:e.aiPurpleColor}})),[]),o=(0,h.qz)(void 0,Ke.Z),r=(0,h.VK)((()=>o.state.focus.indexGlobal),[o]),{handleSelectResult:l,globalFocusedIndex:d}=(0,i.useContext)(Dt),{localResults:c,serverResults:u,clusterInfo:m,debugInfo:p,serverResultsLoading:g,hasPublicAccessPermission:y,errorState:v,serverResultsAllLoaded:x}=(0,h.VK)((()=>{var e,i;const{hasPublicAccessPermission:n}=F.bC(s);return{localResults:t.state.localResults,serverResults:t.state.serverResults,serverResultsLoading:t.state.serverResultsLoading,clusterInfo:null===(e=t.state.serverResults)||void 0===e?void 0:e.clusterInfo,debugInfo:null===(i=t.state.serverResults)||void 0===i?void 0:i.debugInfo,hasPublicAccessPermission:n,errorState:t.state.errorState,serverResultsAllLoaded:t.state.serverResultsAllLoaded}}),[t,s]),S=!1===v.isLoading&&v.showMajorError,b=Boolean(c||u),M=(0,i.useCallback)((()=>{!g&&!x&&void 0!==u&&N.update((e=>({...e,limit:e.limit+20})))}),[g,x,u]),w=(0,h.VK)((()=>F.oO({localResults:null==c?void 0:c.results,serverResults:null==u?void 0:u.results})),[c,u]),j=(0,h.VK)((()=>[{type:"assistant",renderTitle:(e,t,s)=>function(e,t){return(0,E.jsx)("div",{className:"notranslate",style:t,children:e})}((0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("span",{children:(0,E.jsx)(k.FormattedMessage,{id:"globalSearchResultsBody.askAiMenuItem.title",defaultMessage:"Ask AI"})}),(0,E.jsx)("span",{style:a.askAiQuery,children:` ${e}`})]}),{...s,...a.askAiLabel}),icon:e=>(0,Ue.t)({...e,...a.askAiIcon}),action:()=>{We.em({environment:s})},shouldShow:()=>ze.fG.isAssistantEnabled()&&N.state.query.text.split(" ").length-1>=2&&N.state.query.text.length>6}].filter((e=>e.shouldShow(s)))),[s,a],{useDeepEqual:!0}),_=(0,i.useCallback)((()=>o.update((e=>e.focus.isInitialized&&0===e.focus.section&&0===e.focus.indexLocal&&0===e.focus.indexGlobal?e:{...e,focus:j.length>0?{section:1,indexLocal:0,indexGlobal:j.length}:{section:0,indexLocal:0,indexGlobal:0}}))),[o,j]);return(0,i.useEffect)((()=>{_()}),[w,_]),(0,i.useEffect)((()=>{d.setState(r)}),[d,r]),(0,E.jsxs)("div",{style:a.container,children:[(0,E.jsx)(ut,{errorState:v,handleSelectResult:l,onMaybeLoadMoreResults:M,resultListStore:o,results:w,debugInfo:p,clusterInfo:m,publicAccessPermission:y,showActions:j}),(0,E.jsx)($e,{searchResultStore:t,combinedResults:w,showSpinner:g,shouldShow:!S&&b&&!n.isMobile})]})};function pt(){window.__c={n:"GlobalSearchNavigationalView"};const{handleRecentPageSelect:e,searchResultStore:t}=(0,i.useContext)(Dt),{hasQuery:s}=(0,h.VK)((()=>({hasQuery:Boolean(N.state.query.text.trim())||F.VA(N.state.query.filters)})),[]),n={searchResultStore:t};return(0,E.jsx)(E.Fragment,{children:s?(0,E.jsx)(mt,{...n}):(0,E.jsx)(Ve,{onSelect:e})})}var gt=s(59054),ht=s(63143),ft=s(68120),yt=s(18245);function vt(e){let{dependencies:t,debugColumnStore:s,localDebounce:n=25,serverDebounce:a=275,searchResultStore:o,localSearchCache:r,permanentFilterOverride:l,enabled:d}=e;const u=(0,Y.O7)(),m=(0,h.VK)((()=>function(e){const{debugColumnStore:t}=e;return{shouldSearchLocal:!0,forcedClusterPattern:t.state.forcedClusterPattern,searchExperimentOverrides:t.state.searchExperimentOverrides,forcedBlockIds:t.state.forcedBlockIds}}({isOnline:t.isOnline,debugColumnStore:s})),[t.isOnline,s]),p=(0,i.useMemo)((()=>c.Ds(xt,a)),[a]);(0,gt.r5)((()=>d?async function(e){const{query:t,openAsPage:s,store:i,fetchServerResultsFn:n}=e;if(s&&c.Xy(t,i.state.selectedQueryResultQuery))return;i.update((e=>({...e,localResults:e.localResults}))),function(e){const{shouldSearchLocal:t,parentStore:s,environment:i,query:n,limit:a,hasPublicAccessPermission:o,isOnline:r,localSearchCache:l,store:d,permanentFilterOverride:c}=e;let u;const m={...n,filters:{...n.filters,...c}};t&&(u=F.b9(function(e){const{parentStore:t,requestInput:s,isOnline:i,environment:n,hasPublicAccessPermission:a,localSearchCache:o}=e,{query:r}=s;if(!o)return;if(!r.text.trim())return;if(a)return;const l=yt.default.mark("rum.local_quick_search_query"),d=void 0,c=F.Y_({query:s,localCachedPages:o,parentStore:t,environment:n,isOnline:i,shouldLimitLocalResultsWhenOnline:!0,applyScoreThresholdWhenOnline:!0,maxLocalResultsOverride:d});return yt.default.measure(l,{environment:n}),c}({parentStore:s,environment:i,requestInput:{query:m,limit:a},hasPublicAccessPermission:o,isOnline:r,localSearchCache:l})),d.update((e=>({...e,localResults:u}))))}(e),await n(e)}({...t,...m,store:o,fetchServerResultsFn:p,environment:u,localSearchCache:r,permanentFilterOverride:l}):Promise.resolve()),[t,m,o,p,u,r,l,d],{debounce:n})}async function xt(e){let{parentStore:t,environment:s,query:i,isOnline:n,publicAccessPermissionAncestorBlockId:a,currentSpaceStore:o,searchSessionId:r,searchExperimentOverrides:l,forcedClusterPattern:d,recentPagesForBoosting:u,store:m,forcedBlockIds:p,limit:g,permanentFilterOverride:h}=e;const f={query:{...i,filters:{...i.filters,...h}},limit:g};m.update((e=>({...e,serverResultsLoading:!0})));const y=m.state.serverResults,v=await async function(e){const{parentStore:t,requestInput:s,isOnline:i,environment:n,publicAccessPermissionAncestorBlockId:a,searchSessionId:o,source:r,spaceId:l,searchExperimentOverrides:d,forcedClusterPattern:c,recentPagesForBoosting:u,forcedBlockIds:m}=e,{query:p}=s;if(!p.text.trim()&&!F.FN(p.filters))return;if(!i)return{error:B.Ix.Offline};const g=yt.default.mark("rum.server_quick_search_query"),h=await F.MS({environment:n,input:s,spaceId:l,publicAccessPermissionAncestorBlockId:a,searchSessionId:o,source:r,searchExperimentOverrides:d,forcedClusterPattern:c,recentPagesForBoosting:"on"===(null==d?void 0:d["search-debug-only-no-recent-boosting"])?[]:u,forcedBlockIds:m});if(!h)return;if("failed"===h.type)return h.offline?{error:B.Ix.Offline}:{error:B.Ix.RequestFailed};const f=h.data.trackEventProperties,y=(0,ft.Qr)(f)?{}:(0,ht.m8)((0,U.Yd)(f).map((e=>[`server-${e}`,f[e]]))),v=h.data.results.map(((e,s)=>({...e,serverEventProperties:y,originalPosition:s,store:Me.G.createChildStore(t,{table:oe.iU,id:e.id})})));return yt.default.measure(g,{environment:n}),{value:{results:v,total:h.data.total,debugInfo:h.data.debug,serverEventProperties:y,clusterInfo:h.data.clusterInfo}}}({parentStore:t,environment:s,requestInput:f,spaceId:null==o?void 0:o.id,searchSessionId:r,publicAccessPermissionAncestorBlockId:a,isOnline:n,source:void 0,searchExperimentOverrides:l,forcedClusterPattern:d,recentPagesForBoosting:u,forcedBlockIds:p}),x={query:{...N.state.query,filters:{...N.state.query.filters,...h}},limit:N.state.limit};if(!c.Xy(f,x))return;const S=F.b9(v),b=y?F.Nu({existingResults:y,newPageResults:S}):S;if(v&&!v.error){const e=v.value.results;m.update((t=>({...t,serverError:null==v?void 0:v.error,serverResultsLoading:!1,serverResults:b,serverResultsAllLoaded:e.length<g,serverEventProperties:v.value.serverEventProperties})))}else m.update((e=>({...e,serverError:null==v?void 0:v.error,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0})))}function St(){const e=(0,Y.O7)(),{searchResultStore:t,secondarySearchResultStore:s}=(0,i.useContext)(Dt),{parentStore:n}=(0,i.useContext)(Bt),a=function(e){const t=(0,Y.O7)();return(0,h.VK)((()=>{const{hasPublicAccessPermission:s,publicAccessPermissionAncestorBlockId:i}=F.bC(t);return{isOnline:Boolean(M.Z.state.online),limit:N.state.limit,parentStore:e,hasPublicAccessPermission:s,publicAccessPermissionAncestorBlockId:i,currentSpaceStore:D.default.state.currentSpaceStore,debug:void 0,openAsPage:!1,recentPagesForBoosting:[],searchSessionId:void 0,searchMode:"default",currentSpaceViewStore:D.default.state.currentSpaceViewStore,query:N.state.query}}),[t,e])}(n),[{value:o}]=(0,gt.r5)((()=>a.hasPublicAccessPermission?Promise.resolve(void 0):a.currentSpaceStore?F.hb({environment:e,currentSpaceStore:a.currentSpaceStore,currentSpaceViewStore:a.currentSpaceViewStore,excludeCurrentPage:!0}):Promise.resolve(void 0)),[e,a.currentSpaceStore,a.currentSpaceViewStore,a.hasPublicAccessPermission]);vt({dependencies:a,searchResultStore:t,localSearchCache:o,debugColumnStore:Ye.v_,enabled:!0}),vt({dependencies:a,searchResultStore:s,localSearchCache:o,debugColumnStore:Ye.BJ,enabled:!1})}function bt(e){return window.__c={n:"GlobalSearchContentPane"},St(),(0,E.jsx)(v.Z,{capture:!0,ignoreBlockSelection:!0,focusOffscreenInput:!1,restoreSelection:!0,render:()=>(0,E.jsx)(y.Z,{capture:!0,allowMenuList:!0,render:t=>(0,E.jsx)(Mt,{...e,ignoreAreaEvents:t})})})}function Mt(e){window.__c={n:"GlobalSearchContentPaneInner"};const{ignoreAreaEvents:t}=e,{handleQueryChange:s,searchResultStore:n,globalFocusedIndex:a}=(0,i.useContext)(Dt),o=(0,f.yK)((e=>({body:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},topbar:{height:void 0,marginTop:10,marginLeft:16,marginBottom:10,marginRight:16},topbarButton:{fontWeight:void 0,padding:0,color:e.mediumTextColor},scroller:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",maxHeight:"100vh"},clearButton:{color:e.lightTextColor}})),[]),[r,l]=(0,i.useState)(!1),{shouldShowSpinner:d}=(0,h.VK)((()=>({shouldShowSpinner:Boolean(M.Z.state.online)&&Boolean(N.state.query.text)&&n.state.serverResultsLoading&&!r,hasQuery:Boolean(N.state.query.text.trim())})),[r,n]),c=(0,b.zY)(),u=(0,i.useMemo)((()=>(0,E.jsx)(V,{isOpen:!0,onTypingChange:l,showSpinner:d,onQueryChange:s,searchResultStore:n,focusedIndexStore:a,window:c})),[d,c,s,n,a]),p=(0,i.useMemo)((()=>({menuType:S.og.Popup,maxHeight:"100%",maxWidth:"100%",minHeight:50,disableScroller:!0,scrollerStyle:o.scroller,...t})),[o,t]);return(0,E.jsx)(x.Z,{...p,className:m.Oau,children:(0,E.jsxs)("div",{style:o.body,children:[u,(0,E.jsx)(pt,{})]})})}var wt=s(62134),jt=s(45023),Ct=s(22294);function kt(e){window.__c={n:"GlobalSearchKeyboardShortcutStackListener"};const t=(0,b.zY)(),s=(0,Y.O7)(),n=(0,i.useCallback)((e=>{wt.Zm(s,e)}),[s]),a=(0,i.useCallback)((e=>{const{shortcutMap:t}=s.KeyboardShortcutStackStore,i=c.w_(t,((t,i)=>(0,jt.Z)(s,e,t)));if(i&&!{cut:!0,copy:!0,paste:!0}[i]){if("esc"===i)return void u.closeGlobalSearchModal();wt.dJ(s,e,i)}}),[s]),o=(0,i.useCallback)((()=>{Ct.Z.setKeyboardMode(!1)}),[]);return(0,i.useEffect)((()=>t?(t.addEventListener("mousemove",o),t.addEventListener("keydown",a),t.addEventListener("cut",n),t.addEventListener("copy",n),t.addEventListener("paste",n),t.addEventListener("keypress",n),()=>{t.addEventListener("mousemove",o),t.removeEventListener("keydown",a),t.removeEventListener("cut",n),t.removeEventListener("copy",n),t.removeEventListener("paste",n),t.removeEventListener("keypress",n)}):()=>{}),[o,a,n,t]),null}var _t=s(23078),Tt=s.n(_t),It=s(58710),Pt=s(27186);const Zt={};function Ft(e){window.__c={n:"ChildWindow"};const t=e.name.startsWith("Notion")?e.name:`Notion - ${e.name}`,[s,n]=(0,i.useState)(!0),[a,o]=(0,i.useState)({id:It.sI.length++});function r(){const e=It.r1.get(a);It.Ni(e)}(0,i.useEffect)((()=>(It.sI.push(a),()=>{It.sI.splice(It.sI.indexOf(a),1)})),[a]);const l=e.features||Zt,d=!1===e.draggableTop?null:(0,E.jsx)("div",{style:{width:"100vw",height:"20px",appRegion:"drag"}});return(0,E.jsxs)(Tt(),{onOpen:function(t){It.r1.set(a,t),e.onOpen&&e.onOpen(t),t.addEventListener("focus",r),t.addEventListener("mousemove",Pt.Js),t.addEventListener("mousedown",Pt.HY)},onUnload:function(){e.onUnload&&e.onUnload(),n(!1);const t=It.r1.get(a);null==t||t.removeEventListener("focus",r),null==t||t.removeEventListener("mousemove",Pt.Js),null==t||t.removeEventListener("mousedown",Pt.HY),It.Jj()===t&&It.Ni(void 0),It.r1.delete(a)},features:l,copyStyles:e.copyStyles,name:t,title:t,children:[d,(0,E.jsx)("div",{style:d?{marginTop:20}:void 0,children:s&&e.children})]})}function At(e){window.__c={n:"GlobalSearchWindow"};const[t,s]=(0,i.useState)(void 0);return(0,E.jsx)(Ft,{name:"Notion Global Search Modal",onOpen:e=>{s(e)},draggableTop:!1,features:{show:!1,type:"panel",frame:!1,alwaysOnTop:!0},children:(0,E.jsx)(b.oB.Provider,{value:t,children:e.children})})}const Dt=i.createContext(null),Bt=i.createContext(null);class Rt extends n.Z{constructor(){super(...arguments),this.searchResultStore=new g.ZP,this.secondarySearchResultStore=new g.ZP,this.globalFocusedIndex=o.default.createValue(0),this.getStaticContext=c.HP((()=>({handleSelectResult:this.handleQueryResultSelect,handleRecentPageSelect:this.handleRecentPageSelect,handleQueryChange:this.handleQueryChange,searchResultStore:this.searchResultStore,secondarySearchResultStore:this.secondarySearchResultStore,globalFocusedIndex:this.globalFocusedIndex}))),this.getStoresContext=c.HP((e=>({parentStore:e}))),this.handleRecentPageSelect=e=>{this.handleSelectResult({...e,context:"recent_pages"})},this.handleQueryResultSelect=e=>{this.handleSelectResult({...e,context:"query_results"})},this.handleSelectResult=e=>{let{context:t,selectedResult:s,store:i}=e;"query_results"===t&&this.searchResultStore.update((e=>({...e,selectedQueryResultQuery:N.state.query})));const n=(0,d.Z)({pageModel:i.getModel(),pageId:i.id,pageVisitSource:r.tY.SearchQuery});u.openPageFromGlobalSearch(n),u.closeGlobalSearchModal()},this.handleQueryChange=e=>{""!==e?N.updateQueryText(e):N.resetQuery()}}renderComponent(){const e=Boolean(p.Z.state.isGlobalSearchHost),t="light"===this.theme.mode?m.MsS:m.Xj_;return e?(0,E.jsxs)(At,{children:[(0,E.jsx)(kt,{}),(0,E.jsx)(Dt.Provider,{value:this.getStaticContext(),children:(0,E.jsx)(Bt.Provider,{value:this.getStoresContext(this.props.parentStore),children:(0,E.jsx)("div",{style:this.getStyle(),className:["notion-app-inner",t].join(" "),children:(0,E.jsx)(bt,{onClose:()=>{}})})})})]}):null}getStyle(){return{...(0,l.ZP)(a.SP),color:this.theme.regularTextColor,WebkitFontSmoothing:"auto",backgroundColor:this.theme.contentBackground}}}Rt.displayName="Search";const Lt=Rt},14568:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(35431);class n extends i.Z{}const a=new n},31075:(e,t,s)=>{s.d(t,{i:()=>p});s(21703),s(67294);var i=s(26825),n=s(5366),a=s(50906),o=s(47307),r=s(76464),l=s(39699),d=s(64369),c=s(18878),u=s(18245),m=s(85893);async function p(e){const{oldPermissionItem:t,newPermissionItem:s,wasInherited:p,environment:g,store:h,sudoModeStore:f,restrictingVisibility:y,fromPermissionWrapper:v}=e;if(!(0,i.Kf)(t,s))throw new Error("Permission type mismatch.");const x=!!f&&f.shouldSaveTransactionWithSudoMode(h),S=(0,i.nl)(t.role,s.role);if(p&&S!==s.role||y)return void(await async function(e){const{environment:t,useSudoMode:s,store:i,permissionItem:a,fromPermissionWrapper:u}=e,p="none"===a.role?{type:"remove",permissionItem:a}:{type:"restrict"},g="user_permission"===a.type&&a.user_id===t.currentUser.id;(g||await o.confirmUserAction({message:(0,c.mX)(p),acceptLabel:(0,c.nH)(p),cancelLabel:(0,m.jsx)(n.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,m.jsx)(d.Z,{isSmall:!0,isMultiline:!0,children:(0,m.jsx)(n.FormattedMessage,{id:"restrictedPermissionConfirmationModal.footer.whisperText",defaultMessage:"Admins will still be able to restore permissions from restricted pages."})})}))&&l.createAndCommit({userAction:"PermissionItem.onAccept",environment:t,useSudoMode:s,perform:e=>{r.Pk({environment:t,store:i,permissionItem:a,shouldInherit:!0,transaction:e,fromPermissionWrapper:u})}})}({environment:g,useSudoMode:x,store:h,permissionItem:s,fromPermissionWrapper:v}));!h.isTopLevel()&&t.role!==s.role&&S!==t.role&&a.SMF(g),l.createAndCommit({userAction:"PermissionItem.handlePermissionItemChange",environment:g,useSudoMode:x,perform:t=>{const i=u.default.mark("share_menu.update_page_permission_lag");r.ep({environment:g,store:h,permissionItems:[s],transaction:t,pagePermissionChangeLocation:e.location,metric:i,fromPermissionWrapper:v})}})}},75546:(e,t,s)=>{s.d(t,{o:()=>c});s(67294);var i=s(480),n=s(86628),a=s(24405),o=s(82990),r=s(58260),l=s(95697),d=s(85893);function c(e){let{teamStore:t,withSelectedStyle:s}=e;window.__c={n:"TeamHeaderLabel"};const c=(0,i.Fy)(),u=(0,n.VK)((()=>{var e;return{teamName:t.getName()??"",shouldShowLock:(0,l.C2)(null==t||null===(e=t.getSettingsStore())||void 0===e?void 0:e.getValue())}}),[t]),m=(0,a.yK)((e=>({container:{display:"flex",alignItems:"center",overflow:"hidden"},lockIcon:{width:15,marginLeft:6,marginBottom:1,fill:e.mediumIconColor},labelText:{...o.Z.textOverflowStyle,...s?{color:e.regularTextColor,fontWeight:o.Z.fontWeight.semibold}:{color:e.darkTextColor,fontWeight:o.Z.fontWeight.medium},fontSize:c.isMobile?o.Z.fontSize.UIRegular.mobile:o.Z.fontSize.UIRegular.desktop}})),[c.isMobile,s]);return u?(0,d.jsxs)("div",{style:m.container,children:[(0,d.jsx)("div",{style:m.labelText,children:u.teamName}),u.shouldShowLock&&(0,d.jsx)(r.Z,{iconStyle:m.lockIcon})]}):null}},22756:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{isModalOpen:!1,currentTab:"selectData",account:void 0,isAccountLinkingInProgress:!1,isAccountDelinkingInProgress:!1,workspaces:[],teamsAndProjects:[],selectedWorkspace:void 0,selectedProjectsAndTeamspaces:{},importCompletedTasks:!0,teams:void 0,loadMoreClicks:0,isLoadingProjects:!1,isLoadingAsanaWorkspaces:!1,result:void 0,isComplete:!1,loggerPageId:void 0,templateCreationInProgress:!1,isFetchingAsanaAccount:!1}}resetImport(){const{account:e,workspaces:t}=this.getState();this.setState({...this.getInitialState(),account:e,workspaces:t})}}const a=new n},17549:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{open:!1}}}const a=new n},85680:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{isOpen:!1}}}const a=new n},52507:(e,t,s)=>{s.d(t,{AS:()=>l,Hs:()=>d,ZP:()=>c});var i=s(49085),n=s(59753),a=s(44312),o=s(97880);class r extends i.default{getInitialState(){return{modalOpen:!1,loading:!1,domainVerification:void 0}}}const l=(0,o.AO)((e=>"invalid"===e.type||"unverified"===e.type?{true:e}:{false:e}));function d(e){const t=n.kk.fromValue(a.Jd,e);return{type:t.verified_at?"verified":"unverified",id:t.id,domain:t.domain,verificationCode:t.verification_code,createdAt:t.created_at,expiresAt:t.expires_at,invalidatedAt:t.getInfo().invalidated_at}}const c=r},45214:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{open:!1}}}const a=new n},5188:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{open:!1}}}const a=new n},78900:(e,t,s)=>{s.d(t,{Z:()=>i});const i=new(s(61766).Z)},49900:(e,t,s)=>{s.d(t,{d:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{open:!1}}}const a=new n},25399:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{open:!1}}}const a=new n},2342:(e,t,s)=>{s.d(t,{ZP:()=>d});var i=s(49085),n=s(92338),a=s(62965),o=s(29026);class r extends i.default{getInitialState(){return{insertedActionResultsCount:0,localResults:void 0,serverResultsLoading:!1,serverResults:void 0,serverEventProperties:void 0,serverResultsAllLoaded:!1,errorState:l,selectedQueryResultQuery:void 0}}setState(e){const t={...this.instanceState};if(!(0,a.Z)(this.instanceState,t))return;const s=function(e){const{newState:t,priorState:s}=e,{localResults:i,serverError:a,serverResultsLoading:o,serverResults:r}=t,l=Boolean(i),d=o?void 0:a;if(!l&&o)return!s.errorState.isLoading&&s.errorState.showMajorError?s.errorState:{isLoading:o};if(l)return{hasLocalResults:l,serverError:d,isLoading:!1,showMajorError:!1};if(d)return{hasLocalResults:l,serverError:d,isLoading:!1,showMajorError:!0};if(0===(null==r?void 0:r.results.length))return{hasLocalResults:l,serverError:n.Ix.NoResults,isLoading:!1,showMajorError:!0};return{hasLocalResults:l,serverError:d,isLoading:!1,showMajorError:!1}}({newState:e,priorState:t});super.setState({...e,errorState:s})}getResultCount(){const{serverResults:e,localResults:t}=this.state,s=(null==e?void 0:e.total)??(null==t?void 0:t.total)??0,i=Boolean(e&&s>=100);return{count:s,isLowerBound:Boolean(e&&t&&s<o.Xv)||i}}}const l={showMajorError:!1,isLoading:!1,hasLocalResults:!1,serverError:void 0};const d=r},54983:(e,t,s)=>{s.d(t,{Z:()=>a});var i=s(49085);class n extends i.default{getInitialState(){return{}}}const a=n},67742:(e,t,s)=>{s.d(t,{Z:()=>P});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(53877),l=s(64275),d=s(11751),c=s(5366),u=s(39699),m=s(1865),p=s(37181),g=s(64921),h=s(61519),f=s(76844),y=s(38755),v=s(70467),x=s(80444),S=s(81886),b=s(13627),M=s(35057),w=s(85893);function j(e){return e?(0,w.jsx)(h.Z,{size:27,style:{paddingLeft:14,paddingRight:14}}):(0,w.jsx)(h.Z,{size:0})}function C(e,t,s){if(s){if("warning"===t){if("settings"===e)return{disableWarningNotificationInSettings:!0,disableWarningNotificationInSidebar:s.disableWarningNotificationInSidebar,disableLimitNotificationInSettings:s.disableLimitNotificationInSettings,disableLimitNotificationInSidebar:s.disableLimitNotificationInSidebar,expirationDate:s.expirationDate};if("sidebar"===e)return{disableWarningNotificationInSettings:s.disableWarningNotificationInSettings,disableWarningNotificationInSidebar:!0,disableLimitNotificationInSettings:s.disableLimitNotificationInSettings,disableLimitNotificationInSidebar:s.disableLimitNotificationInSidebar,expirationDate:s.expirationDate}}if("limit_reached"===t){if("settings"===e)return{disableWarningNotificationInSettings:s.disableWarningNotificationInSettings,disableWarningNotificationInSidebar:s.disableWarningNotificationInSidebar,disableLimitNotificationInSettings:!0,disableLimitNotificationInSidebar:s.disableLimitNotificationInSidebar,expirationDate:s.expirationDate};if("sidebar"===e)return{disableWarningNotificationInSettings:s.disableWarningNotificationInSettings,disableWarningNotificationInSidebar:s.disableWarningNotificationInSidebar,disableLimitNotificationInSettings:s.disableLimitNotificationInSettings,disableLimitNotificationInSidebar:!0,expirationDate:s.expirationDate}}}return{disableWarningNotificationInSettings:"warning"===t&&"settings"===e,disableWarningNotificationInSidebar:"warning"===t&&"sidebar"===e,disableLimitNotificationInSettings:"limit_reached"===t&&"settings"===e,disableLimitNotificationInSidebar:"limit_reached"===t&&"sidebar"===e,expirationDate:(0,r.Xz)({date:Date.now(),daysToAdd:7})}}const k={padding:"4px 14px 8px 14px",fontSize:12,lineHeight:1.4},_={fontWeight:500,lineHeight:2,display:"flex"},T={fontWeight:400},I={textDecoration:"underline"};const P=function(e){window.__c={n:"AddOnLimitUsage"};const t=(0,S.MQ)(e.source),s=(0,v.l)(),h=(0,n.O7)(),P=(0,o.yK)((e=>({empty:{},cancelButton:{background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},dismissButton:{display:"flex",flexDirection:"row-reverse",position:"relative",top:10,right:-6},hovered:{background:e.buttonPressedBackground},closeIcon:{width:14,fill:e.mediumTextColor}})),[]),{membersCount:Z,spaceName:F,settings:A,currentUserSettingsStore:D}=(0,a.VK)((()=>{var e;return{membersCount:(0,b.qX)(),spaceName:x.default.state.currentSpaceStore&&(0,y.rn)(h,x.default.state.currentSpaceStore),settings:null===(e=x.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.addOnLimitNotifications,currentUserSettingsStore:x.default.state.currentUserSettingsStore}}),[h]),B=(0,a.VK)((()=>s?+s.spaceUsage/s.spaceLimit:0),[s]),{notificationType:R,usageLabelStyles:L}=(0,a.VK)((()=>({notificationType:B>=S.Tq?"limit_reached":"warning",usageLabelStyles:P.empty})),[B,P.empty]);if(!D)return null;if(!t)return null;let N;"settings"===e.source&&Z>=3&&(null!=A&&A.expirationDate?Date.now()<A.expirationDate&&(N=!0):(!function(e,t){u.createAndCommit({userAction:"addOnLimitNotifications.ai.initializeSettings",environment:e,perform:e=>{p.d2({transaction:e,userSettingsStore:t,data:{addOnLimitNotifications:{disableWarningNotificationInSettings:!1,disableWarningNotificationInSidebar:!1,disableLimitNotificationInSettings:!1,disableLimitNotificationInSidebar:!1,expirationDate:(0,r.Xz)({date:Date.now(),daysToAdd:7})}}})}})}(h,D),N=!0));const E="limit_reached"===R?(0,w.jsx)(c.FormattedMessage,{id:"addOnLimitUsage.description.usedAllFreeResponses.admins",defaultMessage:"{spaceName} has used all their free AI responses.",values:{spaceName:F}}):(0,w.jsx)(c.FormattedMessage,{id:"addOnLimitUsage.description.approachingLimit.admins",defaultMessage:"{spaceName} has used {spaceUsage} of the {usageLimit} free responses provided to this workspace.",values:{spaceName:F,spaceUsage:(null==s?void 0:s.spaceUsage)??0,usageLimit:(null==s?void 0:s.spaceLimit)??0}});return(0,w.jsxs)(i.Fragment,{children:[j("settings"===e.source),(0,w.jsxs)(g.Z,{style:k,onClick:()=>function(e,t){m.y(e,{from:"sidebar"===t?"ai_limit_sidebar":"ai_limit_settings",for:(0,M.zt)(),addOnFeature:"ai"})}(h,e.source),children:[!N&&(0,w.jsx)("div",{style:P.dismissButton,children:(0,w.jsx)(g.Z,{onClick:()=>function(e,t,s){var i;const{currentUserSettingsStore:n}=x.default.state;if(!n)return;const a={addOnLimitNotifications:C(t,s,null===(i=n.getSettings())||void 0===i?void 0:i.addOnLimitNotifications)};u.createAndCommit({userAction:"addOnLimitNotifications.ai.markNotificationAsDismissed",environment:e,perform:e=>{p.d2({transaction:e,userSettingsStore:n,data:a})}})}(h,e.source,R),style:P.cancelButton,hoveredStyle:P.hovered,children:(0,l.D)(P.closeIcon)})}),(0,w.jsxs)("div",{style:_,children:[(0,d.t)({height:14,width:14,marginTop:4}),(0,w.jsx)(c.FormattedMessage,{id:"spaceSettings.sidebar.addOnUpgradeLink",defaultMessage:"Notion AI"})]}),(0,w.jsxs)("div",{style:T,children:[(0,w.jsx)("div",{style:L,children:E}),(0,w.jsx)(f.Z,{style:{marginTop:12,marginBottom:12},percent:B}),(0,w.jsx)("div",{style:I,children:(0,w.jsx)(c.FormattedMessage,{id:"spaceSettings.sidebar.addOnPurchase.buttonLabel",defaultMessage:"Purchase"})})]})]})]})}},28833:(e,t,s)=>{s.r(t),s.d(t,{default:()=>le,isCancellationStage:()=>oe,isConfirmPurchaseStage:()=>ae,isLimitReachedStage:()=>ne});var i=s(67294),n=s(13991),a=s(480),o=s(86628),r=s(24405),l=s(41892),d=s(8848),c=s(7057),u=s(64275),m=s(44495),p=s(5366),g=s(3791),h=s(896),f=s(47425),y=s(97880),v=s(82990),x=s(47307),S=s(64964),b=s(65544),M=s(1865),w=s(42922),j=s(11066),C=s(68785),k=s(92660),_=s(42402),T=s(52533),I=s(18514),P=s(38755),Z=s(80444),F=s(78291),A=s(80671),D=s(34583),B=s(81886),R=s(40670),L=s(43163),N=s(13627),E=s(35057),O=s(63423),V=s(33493),U=s(27533),W=s(85893);function z(e){window.__c={n:"LimitReachedStage"};const{addOnFeature:t,canPurchaseAddOn:s,isSubscribed:i}=e,n=ie(),o=(0,a.O7)();return s&&i?(0,W.jsx)(K,{addOnFeature:t,canPurchaseAddOn:s}):(0,W.jsxs)(W.Fragment,{children:[(0,m.D)(n.icon),(0,W.jsx)(G,{addOnFeature:t,canPurchaseAddOn:s}),(0,W.jsx)(q,{addOnFeature:t,canPurchaseAddOn:s}),(0,W.jsx)(w.Z,{isLarge:!0,style:n.button,onClick:async()=>s?i?A.Cl(void 0):async function(e,t){await M.y(e,{from:"plans_page",for:t,addOnFeature:"ai"}),A.v5()}(o,"free"):A.v5(),children:s?(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.purchase.button.label",defaultMessage:"Purchase"}):(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function K(e){var t,s;window.__c={n:"ConfirmPurchase"};const{addOnFeature:i,canPurchaseAddOn:n}=e,r=(0,a.O7)(),d=ie(),c=(0,o.VK)((()=>(0,E.zt)()),[]),u=(0,o.VK)((()=>F.default.state.data),[]),m=(0,o.VK)((()=>O.Z.state.open?O.Z.state.coupon:null),[]),g=(0,o.VK)((()=>Z.default.state.currentSpaceStore),[]);if(!g)return null;const h=(0,T.S$)({environment:r})&&(0,f.QR)(c);if(r.device.isMobileNative&&!h)return null;let v;if(!u||"unsubscribed_admin"!==u.type&&"subscribed_admin"!==u.type||(v=u),v&&"revenueCat"===(null===(t=v.customerData)||void 0===t?void 0:t.activeSubscriptionPlatform)){const e=(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.switchPlanFromInAppPurchase",defaultMessage:"You're currently subscribed through an in-app purchase with Apple. To switch plans, cancel your subscription with Apple first."});return x.showErrorMessage(e),null}const S=(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.errorMessage.notAdmin",defaultMessage:"You don't have permissions to upgrade this workspace to an add-on. If you think this is a mistake please contact your administrator."});if(!(0,N.GJ)(u))return x.showErrorMessage(S),null;const b=null===(s=v)||void 0===s||null===(s=s.customerData)||void 0===s?void 0:s.stripe;if(!b)return null;const M=b.isSubscribed?b.interval:"month",w=m?function(e){switch(e){case"ai_fifty_percent":return(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.coupon.fiftyPercent.label",defaultMessage:"50% off discount"});default:(0,y.t1)(e)}}(m):"year"===M?(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.coupon.twentyPercent.label",defaultMessage:"20% off discount"}):null;return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("img",{src:l.Z.images.pricing.aiLogoPng,style:d.aiLogo}),(0,W.jsx)(G,{addOnFeature:i,canPurchaseAddOn:n}),(0,W.jsx)(Y,{addOnFeature:i}),w?H(w):null,(0,W.jsx)(Q,{addOnFeature:i,interval:M,stripeData:b,spaceStore:g})]})}function H(e){window.__c={n:"DiscountBadge"};const t=ie();return(0,W.jsx)(j.Z,{style:{...t.sharedStyleForDiscountBadge},disabled:!0,children:(0,W.jsx)("div",{style:{...t.innerStyleForDiscountBadge},children:e})})}function G(e){window.__c={n:"Title"};const{addOnFeature:t,canPurchaseAddOn:s}=e,i=ie();let n;switch(t){case"ai":n=s?(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.title.admin",defaultMessage:"Get more Notion AI"}):(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"Your workspace has run out of its Notion AI promotion"});break;default:(0,y.t1)(t)}return(0,W.jsx)("h3",{style:i.title,children:n})}function q(e){window.__c={n:"Description"};const{addOnFeature:t,canPurchaseAddOn:s}=e;let i;const n=ie();switch(t){case"ai":i=s?(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.description.admins",defaultMessage:"Your one-time promotion has ran out. To continue using AI features, purchase more AI uses for your workspace"}):(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.description.nonAdmins",defaultMessage:"Your workspace’s one-time Notion AI promotion is over. Contact a workspace admin to purchase unlimited AI for your team to use."});break;default:(0,y.t1)(t)}return(0,W.jsx)("p",{style:n.paragraph,children:(0,W.jsx)("div",{style:n.text,children:i})})}function Y(e){window.__c={n:"ConfirmationDescription"};const{addOnFeature:t}=e;let s;const i=(0,a.O7)(),n=ie(),r=(0,o.VK)((()=>Z.default.state.currentSpaceStore),[]);if(!r)return null;const l=(0,o.VK)((()=>(0,P.rn)(i,r)),[i,r]);switch(t){case"ai":s=(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.confirmation.description.admins",defaultMessage:"Go unlimited with Notion AI for all members in {spaceName}.",values:{spaceName:l}});break;default:(0,y.t1)(t)}return(0,W.jsx)("p",{style:n.paragraph,children:(0,W.jsx)("div",{style:n.text,children:s})})}function Q(e){window.__c={n:"ConfirmationBillingSummary"};const{addOnFeature:t,interval:s,stripeData:n,spaceStore:r}=e,l=ie(),d=(0,a.O7)(),c=(0,o.VK)((()=>(0,N.qX)()),[]),u=n.currencyCode??"USD",{tax:m,coupon:h}=(0,o.VK)((()=>({tax:O.Z.state.open?O.Z.state.tax:0,coupon:O.Z.state.open?O.Z.state.coupon:void 0})),[]),f=(0,o.VK)((()=>V.Z.getPrice(d,(e=>e.product===t&&e.billingInterval===s&&e.currencyCode===u))),[t,d,s,u]),y=(0,o.VK)((()=>V.Z.getPrice(d,(e=>e.product===t&&"month"===e.billingInterval&&e.currencyCode===u))),[t,u,d]);if((0,i.useEffect)((()=>{!async function(){if(f.result&&n&&n.address){const e=f.result.getCostPerBillingInterval({quantity:c,coupon:h}).amount;await b.nf({environment:d,priceForTaxCalculation:e,address:n.address,customerId:n.customerId,vatId:n.vatId})}}()}),[d,n,f,c,h]),!f.isLoaded||!y.isLoaded)return(0,W.jsx)(C.Z,{});if(!f.result||!y.result)return null;const v=f.result,x=v.getCostPerBillingInterval({quantity:c,coupon:h}).withAddedAmount(m),M=y.result,j=M.getMonthlyUnitCost();let k=M.getMonthlyCost({quantity:c});"year"===s&&(k=k.withMultipliedAmount(12));const{addOnCostItem:T,addOnCostItemWithMembers:P}=(0,B.OL)(t,c,s,(0,W.jsx)(U.W,{cost:j.toMoneyValue(),trailingZeroDisplay:"stripIfInteger"}));return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("p",{style:l.monthlyCostText,children:[(0,W.jsx)("h3",{style:l.title,children:(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.confirmation.monthlyCost.title",defaultMessage:"Add on"})}),(0,W.jsxs)("div",{style:l.costSectionTitle,children:[(0,W.jsx)("div",{children:T}),(0,W.jsx)("div",{style:l.rightAlign,children:(0,W.jsx)(U.W,{cost:k.toMoneyValue(),trailingZeroDisplay:"auto"})})]}),(0,W.jsx)("div",{style:l.costSection,children:P}),(0,W.jsx)($,{cost:v.getCostPerBillingInterval({quantity:c}),fullCost:k}),(0,W.jsx)(X,{price:v,coupon:h,quantity:c}),(0,W.jsxs)("div",{style:l.costSection,children:[(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.taxes",defaultMessage:"Taxes:"}),(0,W.jsx)("div",{style:l.rightAlign,children:(0,W.jsx)(U.W,{cost:{amount:m,currencyCode:u},trailingZeroDisplay:"auto"})})]}),(0,W.jsxs)("div",{style:l.totalCostSection,children:[(0,W.jsx)("h3",{style:l.title,children:(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.total",defaultMessage:"Total"})}),(0,W.jsx)("div",{style:l.rightAlign,children:(0,W.jsx)("h3",{style:l.title,children:(0,W.jsx)(U.W,{cost:x.toMoneyValue(),trailingZeroDisplay:"auto"})})})]}),(0,W.jsx)("div",{style:l.perMonth,children:(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.interval.label",defaultMessage:"{interval, select, month {per month} other {per year}}",values:{interval:s}})})]}),(0,W.jsx)(w.Z,{isLarge:!0,style:l.button,onClick:async()=>{const e=(0,g.aG)({addOnFeature:t,addOnTier:"base",addOnBillingInterval:s,addOnPricingModel:"standard",addOnPricingVariant:"retail",currencyCode:v.currencyCode,isCancellation:!1});await D.Mg({environment:d,spaceStore:r,from:"add_on_upgrade_modal",addOns:e,inAppOffer:h}),A.v5();const i=R.mV({type:"purchaseAddOn",addOnFeature:t});i&&S.oV(i)},children:(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.confirmPurchase.button.label",defaultMessage:"Confirm purchase"})}),(0,W.jsx)("p",{style:l.termsOfService,children:(0,W.jsx)("div",{style:l.text,children:(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.confirmation.prorated.description",defaultMessage:"Performance subject to <fairUsePolicies>fair use policies</fairUsePolicies>.{br}By clicking Confirm Purchase you agree to the <terms>Notion AI Supplementary Terms</terms>.",values:{br:(0,W.jsx)("br",{}),fairUsePolicies:e=>(0,W.jsx)(_.Z,{href:(0,I.UY)("ai.fairUsePolicies"),children:e}),terms:e=>(0,W.jsx)(_.Z,{href:(0,I.UY)("ai.terms"),children:e})}})})})]})}function $(e){window.__c={n:"AnnualDiscount"};const t=ie(),{cost:s,fullCost:i}=e;if(s.amount===i.amount)return null;const n=i.minus(s),a=Math.floor(n.amount/i.amount*100);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{style:t.costSectionTitle,children:[(0,W.jsx)("div",{children:(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.annual.dynamicDiscountMessage",defaultMessage:"<bold>Annual discount ({discountPercent}%)</bold>",values:{bold:e=>(0,W.jsx)("b",{children:e}),discountPercent:a}})}),(0,W.jsx)("div",{style:t.greenRightAlign,children:(0,W.jsx)(U.W,{cost:n.withMultipliedAmount(-1).toMoneyValue(),trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,W.jsx)("div",{style:t.costSection,children:(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.annualPlanMessage",defaultMessage:"for being on the annual plan"})})]})}function X(e){window.__c={n:"CouponDiscount"};const t=ie(),{price:s,coupon:i,quantity:n}=e;if(!(0,h.pp)(i))return null;const a=s.getDiscountPerBillingInterval({quantity:n,coupon:i}).withMultipliedAmount(-1);return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)("div",{style:t.costSectionTitle,children:[(0,W.jsx)("div",{children:(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount",defaultMessage:"<bold>Special discount ({percentage})</bold>",values:{bold:e=>(0,W.jsx)("b",{children:e}),percentage:(0,L.o)(i)}})}),(0,W.jsx)("div",{style:t.greenRightAlign,children:(0,W.jsx)(U.W,{cost:a,trailingZeroDisplay:"auto",currencySign:"standard"})})]}),(0,W.jsx)("div",{style:t.costSection,children:(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscount.threeMonthsMessage",defaultMessage:"for the next 3 months"})})]})}function J(e){window.__c={n:"CancellationStageCTA"};const{data:t,addOnFeature:s}=e,i=ie(),n=(0,a.O7)(),o=function(e,t){var s;return null===(s=e.addOns.find((e=>e.feature===t)))||void 0===s?void 0:s.billingInterval}(t,s);return o?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("div",{style:i.buttonWithTopPadding,children:(0,W.jsx)(j.Z,{style:i.redButton,hoveredStyle:{background:d.ZP.redWithAlpha(.8)},onClick:async()=>{const e=Z.default.state.currentSpaceStore,{data:t}=F.default.state;let i;var a;"unsubscribed_admin"!==(null==t?void 0:t.type)&&"subscribed_admin"!==(null==t?void 0:t.type)||(i=null===(a=t.customerData)||void 0===a?void 0:a.stripe.currencyCode);if(!e||!i)return x.showErrorMessage((0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.cancellationStage.errorMessage",defaultMessage:"Unable to cancel add-on subscription. Please try again later."}));const r=(0,g.aG)({addOnFeature:s,addOnTier:"base",addOnBillingInterval:o,addOnPricingModel:"standard",addOnPricingVariant:"retail",currencyCode:i,isCancellation:!0});await D.Mg({environment:n,spaceStore:e,from:"add_on_upgrade_modal",addOns:r}),A.v5()},children:(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.midterm.yesButton.label",defaultMessage:"Schedule removal"})})}),(0,W.jsx)("div",{style:i.buttonWithTopPadding,children:(0,W.jsx)(j.Z,{style:i.noButton,onClick:()=>A.v5(),children:(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.noButton.label",defaultMessage:"Cancel"})})})]}):null}function ee(e){window.__c={n:"CancellationStageDescription"};const{data:t}=e,s=ie();let i,a=!1;if("subscribed_admin"===t.type||"unsubscribed_admin"===t.type){var o;const e=null===(o=t.customerData)||void 0===o?void 0:o.stripe;i=null==e?void 0:e.periodEnd,a=Boolean((null==e?void 0:e.schedule)||(null==e?void 0:e.willCancelAt))}return i?(0,W.jsx)("p",{style:s.paragraph,children:(0,W.jsx)("div",{style:s.text,children:a?(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellationWithPendingChanges.description",defaultMessage:"You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. This change will cancel your previous pending changes. You can resubscribe anytime.",values:{periodEnd:(0,c.Yx)(i,"long",n.SP),bold:e=>(0,W.jsx)("b",{children:e})}}):(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellation.description",defaultMessage:"Thank you for your input! You can continue to enjoy Notion AI until the end of your billing period on <bold>{periodEnd}</bold>. You can resubscribe anytime.",values:{periodEnd:(0,c.Yx)(i,"long",n.SP),bold:e=>(0,W.jsx)("b",{children:e})}})})}):null}function te(e){window.__c={n:"CancellationStage"};const{addOnFeature:t,canPurchaseAddOn:s,data:i}=e,n=ie();if(!s)return null;let a;switch(t){case"ai":a=(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.midterm.cancellation.title",defaultMessage:"Remove AI at the end of your billing period?"});break;default:(0,y.t1)(t)}return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)("h3",{style:n.cancellationTitle,children:a}),(0,W.jsx)(ee,{data:i}),(0,W.jsx)(J,{data:i,addOnFeature:t})]})}function se(){window.__c={n:"MobileMessage"};const e=ie(),t=(0,a.O7)();let s=(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.button.label",defaultMessage:"Use the web or desktop app to add Notion AI to your plan and go unlimited."});return(t.device.isIOS||t.device.isIpad)&&(s=(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.mobileMessage.ios.button.label",defaultMessage:"You are out of free AI."})),(0,W.jsxs)(W.Fragment,{children:[(0,m.D)(e.icon),(0,W.jsx)("h3",{style:e.title,children:(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgrade.title.nonAdmin",defaultMessage:"Your workspace has run out of its Notion AI promotion"})}),(0,W.jsx)("p",{style:e.paragraph,children:(0,W.jsx)("div",{style:e.text,children:s})}),(0,W.jsx)(w.Z,{isLarge:!0,style:e.button,onClick:()=>A.v5(),children:(0,W.jsx)(p.FormattedMessage,{id:"addOnUpgradeModal.gotIt.button.label",defaultMessage:"Got it"})})]})}function ie(){return(0,r.yK)((e=>({modal:{maxWidth:350,padding:24,fontSize:14,textAlign:"center"},largeModal:{maxWidth:420,padding:24,fontSize:14,textAlign:"center"},mobileModal:{padding:24,fontSize:14,textAlign:"center"},cancellationModal:{maxWidth:350,padding:"24px 16px 12px",fontSize:14,textAlign:"center"},innerModalPadding:{padding:"0px 8px"},cancellationInnerModalPadding:{padding:0},innerStyle:{borderRadius:10},title:{margin:0,marginBottom:0},cancellationTitle:{margin:0,marginBottom:0,marginTop:14},monthlyCostText:{textAlign:"left",paddingBottom:16},costSection:{margin:0,marginBottom:8,display:"flex",color:e.mediumTextColor},costSectionTitle:{display:"flex",color:e.mediumTextColor},totalCostSection:{display:"flex"},paymentMethodSection:{marginBottom:8,marginTop:8,display:"flex"},rightAlign:{position:"absolute",right:24},greenRightAlign:{position:"absolute",right:24,color:e.invoiceGreen},paragraph:{lineHeight:1.4,marginTop:4,marginBottom:12},termsOfService:{fontSize:"small",marginTop:8},text:{margin:0,color:e.mediumTextColor,marginBottom:8},icon:{display:"inline",height:24,fill:e.lightIconColor,marginTop:8,marginBottom:8},aiLogo:{height:60},button:{width:"100%"},buttonWithTopPadding:{paddingTop:12},noButton:{width:"100%",height:24,display:"inline-flex",alignItems:"center",justifyContent:"center"},cancelButton:{position:"absolute",top:"10px",right:"10px",background:e.buttonHoveredBackground,borderRadius:"100%",width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",zIndex:10},redButton:{width:"100%",color:d.ZP.white,background:e.redBadgeBackground,display:"inline-flex",alignItems:"center",justifyContent:"center",height:32,borderRadius:3,lineHeight:1.2,paddingLeft:12,paddingRight:12,fontWeight:v.Z.fontWeight.medium},closeIcon:{width:14,fill:e.mediumTextColor},hovered:{background:e.buttonPressedBackground},perMonth:{position:"absolute",right:24,display:"flex",color:e.mediumTextColor,marginTop:-4},sharedStyleForDiscountBadge:{display:"inline-flex",alignItems:"center",borderRadius:3},innerStyleForDiscountBadge:{padding:"2px 6px",borderRadius:3,color:e.regularTextColor,background:e.accentColors.gray[50],fontWeight:400,fontSize:14,lineHeight:"16px",letterSpacing:"0.04em",whiteSpace:"nowrap"}})),[])}function ne(){return re("limit_reached")}function ae(){return re("confirm_purchase")}function oe(){return re("cancel_plan")}function re(e){const t=O.Z.state;if(t.open)return t.stage===e}const le=function(e){window.__c={n:"AddOnUpgradeModal"};const{data:t}=e,s="ai",i=(0,N.GJ)(t),n=ie(),o=N.YK(t);return(0,a.O7)().device.isMobile?(0,W.jsx)(k.Z,{innerStyle:n.innerStyle,requireOnline:!0,modalStore:O.Z,onDismiss:()=>A.v5(),render:()=>(0,W.jsx)("div",{style:n.mobileModal,children:(0,W.jsx)("div",{style:n.innerModalPadding,children:(0,W.jsx)(se,{})})})}):(0,W.jsx)(k.Z,{innerStyle:n.innerStyle,requireOnline:!0,modalStore:O.Z,onDismiss:()=>A.v5(),render:()=>(0,W.jsx)("div",{style:ae()||ne()&&o&&i?n.largeModal:oe()?n.cancellationModal:n.modal,children:(0,W.jsxs)("div",{style:oe()?n.cancellationInnerModalPadding:n.innerModalPadding,children:[(0,W.jsx)(j.Z,{onClick:()=>{A.v5()},style:n.cancelButton,hoveredStyle:n.hovered,children:(0,u.D)(n.closeIcon)}),ne()&&(0,W.jsx)(z,{addOnFeature:s,canPurchaseAddOn:i,isSubscribed:o}),ae()&&(0,W.jsx)(K,{addOnFeature:s,canPurchaseAddOn:i}),oe()&&(0,W.jsx)(te,{addOnFeature:s,canPurchaseAddOn:i,data:t})]})})})}},81886:(e,t,s)=>{s.d(t,{MQ:()=>y,OL:()=>f,Tq:()=>g});var i=s(67294),n=s(480),a=s(86628),o=s(5366),r=s(97880),l=s(54642),d=s(38755),c=s(80444),u=s(78291),m=s(13627),p=s(85893);const g=1;async function h(e,t,s){var i;const n=u.default.state.data;if(!n)return!1;const a=m.XZ(e,n),o=c.default.state.currentSpaceStore;if(!(o&&(0,d.rn)(e,o))||!(0,m.GJ)(n))return!1;const r=null===(i=c.default.state.currentSpaceStore)||void 0===i?void 0:i.id;if(!r)return!1;const p=await l.getAIUsageEligibility(e,{spaceId:r});if("failed"===p.type)return!1;const h=p.data,f=h?+h.spaceUsage/h.spaceLimit:0;return(!1!==(null==h?void 0:h.isEligible)||!h.isSalesAssisted)&&(!a&&function(e,t,s){const i=e>=g?"limit_reached":"warning";if("warning"===i){if("settings"===t&&null!=s&&s.disableWarningNotificationInSettings||"sidebar"===t&&null!=s&&s.disableWarningNotificationInSidebar)return!1}else if("limit_reached"===i&&("settings"===t&&null!=s&&s.disableLimitNotificationInSettings||"sidebar"===t&&null!=s&&s.disableLimitNotificationInSidebar))return!1;return e>=.7}(f,t,s))}function f(e,t,s,i){switch(e){case"ai":return{addOnCostItem:(0,p.jsx)("div",{children:(0,p.jsx)(o.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.unlimitedAI",defaultMessage:"<bold>Notion AI</bold>",values:{bold:e=>(0,p.jsx)("b",{children:e})}})}),addOnCostItemWithMembers:(0,p.jsx)("span",{style:{whiteSpace:"pre-wrap"},children:(0,p.jsx)(o.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.unlimitedAI.memberInfo",defaultMessage:"({memberCount, plural, one {{memberCount} member} other {{memberCount} members}} x {price} per month{interval, select, month {} other { x 12 months}})",values:{memberCount:t,interval:s,price:i}})})};default:(0,r.t1)(e)}}function y(e){const t=(0,n.O7)(),s=(0,a.VK)((()=>{var e;return null===(e=c.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.addOnLimitNotifications}),[]),[o,r]=(0,i.useState)();return(0,i.useEffect)((()=>{!async function(){const i=await h(t,e,s);r(i)}()}),[t,e,s]),o}},43163:(e,t,s)=>{s.d(t,{o:()=>o});s(67294);var i=s(5366),n=s(97880),a=s(85893);function o(e){switch(e){case"ai_fifty_percent":return(0,a.jsx)(i.FormattedMessage,{id:"addOnUpgrade.confirmation.costSection.specialDiscounts.fiftyPercent",defaultMessage:"50%"});default:(0,n.t1)(e)}}},43273:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Ke});var i=s(67294),n=s(480),a=s(86628),o=s(24405),r=s(15145),l=s(45433),d=s(5366),c=s(11002),u=s(50906),m=s(54642),p=s(9284),g=s(81924),h=s(86282),f=s(34602),y=s(39699),v=s(50506),x=s(28020),S=s(58449),b=s(93959),M=s(54258),w=s(4708),j=s(98165),C=s(94660),k=s(46740),_=s(80444),T=s(59307);var I=s(65435),P=s(84465),Z=s(94952),F=s(73314),A=s(97880),D=s(33929),B=s(77080);function R(e){const{subscriptionTier:t,userPersona:s,selectedTopCategory:i,isNewInAppGalleryEnabled:n}=e;if(n){const e=function(e){var t;const s=e??(null===(t=T.Z.state.data)||void 0===t?void 0:t.defaultCategoryId);if(!s)return;const i=(0,I.oO)(s);if(!i)return;return{selectedTopCategory:s,allTemplates:N(i)}}(i);if(e)return e}return function(e){return{selectedTopCategory:void 0,allTemplates:L(e)}}({subscriptionTier:t,userPersona:s})}function L(e){let{userPersona:t,subscriptionTier:s}=e;const i=D.default.getIntl();return Object.fromEntries((0,I.Io)({userPersona:t,subscriptionTier:s}).map((e=>[e,[...P.gh[e].map((e=>(0,b.F0)((0,S.appConfigs)(),e))),...P.J9[e].filter((e=>(0,Z.G)(e,B.default))).map((e=>(0,F.G)(e,i)))]])))}function N(e){return e.subcategories.reduce(((e,t)=>{let{id:s,templates:i}=t;return s&&null!=i&&i.length?{...e,[s]:i.map((e=>"preset"===e.type?(0,b.F0)((0,S.appConfigs)(),e.uri):"pageTemplate"===e.type?e.template:void(0,A.t1)(e)))}:e}),{})}var E=s(29949),O=s(41892),V=s(75071),U=s(21202),W=s(42922),z=s(31945),K=s(62896),H=s(73063),G=s(16354),q=s(64369),Y=s(45926),Q=(s(57658),s(16184)),$=s(87279),X=s(55220),J=s(75546),ee=s(52275),te=s(78140),se=s(32163),ie=s(72495),ne=s(45653),ae=s(93686),oe=s(85893);function re(e){window.__c={n:"TeamPickerButton"};const{renderOrigin:t,onTeamAccept:s,sectionTitle:i,showMemberCount:o,right:r,showPrivate:l,onPrivateAccept:c,captionItem:u}=e,m=(0,n.Fy)().isMobile,p=de(),g=(0,X.E)(),h=(0,a.VK)((()=>g.filter((e=>e.canAddOrRemoveTopLevelPages()))),[g]),f=(0,a.VK)((()=>_.default.state.currentUserStore),[]),y=[];if(u){const e={key:"caption",render:e=>(0,oe.jsx)(ie.Z,{...e,topBorder:!0}),items:[u]};y.push(e)}const v=h.map((e=>({key:e.id,action:()=>{s(e)},render:t=>(0,oe.jsx)(le,{...t,team:e,onAccept:s,showMemberCount:o,right:r})}))),x={key:"teams",render:e=>(0,oe.jsx)(ie.Z,{...e,title:i}),items:v};if(y.push(x),l){const e={key:"private",render:e=>(0,oe.jsx)(ie.Z,{...e,topBorder:v.length>0}),items:[{key:"private",action:()=>{},render:e=>(0,oe.jsx)(ee.Z,{...e,icon:(0,oe.jsxs)("div",{style:{position:"relative"},children:[(0,oe.jsx)(ne.Z,{hasTooltip:!1,userStore:f}),(0,Q.Q)(p.privateItemLockIcon)]}),title:(0,oe.jsx)(d.FormattedMessage,{id:"teamPickerButton.addToPrivate",defaultMessage:"Add to Private"}),onClick:()=>{null==c||c()}})}]};y.push(e)}return(0,oe.jsx)(z.ZP,{...e,popupType:m?z.Z4.SlideUp:z.Z4.Popup,renderOrigin:t,render:e=>{let t;return t=m?{menuType:$.og.ActionSheet}:{menuType:$.og.Popup,width:"100%"},(0,oe.jsx)(te.Z,{...t,children:(0,oe.jsx)(se.Z,{style:{width:m?void 0:256},type:se.i.Vertical,initialFocus:void 0,sections:y})})}})}function le(e){window.__c={n:"TeamItem"};const{team:t,onAccept:s,showMemberCount:i,right:n,...o}=e,r=de(),l=(0,a.VK)((()=>t.getUserIdsInTeam().length),[t]);return(0,oe.jsx)(ee.Z,{...o,onClick:e=>s(t),icon:(0,oe.jsx)(ae.p,{store:t,size:20,disabled:!0}),title:(0,oe.jsx)(J.o,{teamStore:t}),right:o.focused?n:null,caption:i?(0,oe.jsx)("div",{style:r.caption,children:(0,oe.jsx)(d.FormattedMessage,{defaultMessage:"{numberOfMembers, plural, one {{numberOfMembers} member} other {{numberOfMembers} members}}",id:"teamPickerButton.teamItem.teamMemberCount",values:{numberOfMembers:l}})}):null})}function de(){return(0,o.yK)((e=>({privateItemLockIcon:{position:"absolute",bottom:-2,right:-2,zIndex:1,width:10,height:10,fill:e.accentColors.red[500]},caption:{color:e.lightTextColor}})),[])}var ce=s(95477);var ue=s(82136),me=s(90106);function pe(e){window.__c={n:"TemplateDetail"};const t=(0,n.O7)(),s=function(e){const[t,s]=i.useState(!1);return i.useEffect((()=>{const t=window.matchMedia(e);function i(e){s(e.matches)}return t.addEventListener("change",i),()=>{t.removeEventListener("change",i)}}),[e]),t}("(max-width: 960px)"),r=(0,o.yK)((e=>({container:{width:"100%",height:"100%",overflow:"auto",flex:1,display:"flex",flexDirection:"column",alignItems:"stretch",background:e.contentBackground,color:e.regularTextColor},contentContainer:{margin:16,padding:"20px 24px",border:"1px solid rgba(0, 0, 0, 0.07)",borderRadius:8,background:e.sidebarBackground,display:"flex",flexDirection:"row",justifyContent:"space-between",columnGap:50,flexWrap:s?"wrap":"nowrap"},getTemplateColumn:{width:s?"100%":void 0,display:"flex",flexDirection:s?"column-reverse":"column"},madeByLabelV1:{marginTop:16,marginBottom:16},heroImg:{height:"100%",width:"100%"},getTemplateButton:{width:s?"100%":220,height:38,fontSize:16},addBadgeTeamTemplateButton:{textTransform:"none",color:e.blueColor},madeByV2Container:{marginBottom:16,display:"flex",flexDirection:"row",alignItems:"center",gap:6,width:"content-fit"},madeByV2Label:{fontSize:14,fontWeight:500},madeByV2AvatarContainer:{width:30,height:30,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",borderRadius:"50%",border:`1px solid ${e.outlineButtonBorder}`,overflow:"hidden",backgroundColor:"rgb(245, 245, 245)"},madeByV2Avatar:{width:30,height:30},madeByV2NotionAvatar:{width:16,height:16}})),[s]),{status:l,selectedTemplate:c,cloneTo:m,selectedTeam:p}=(0,a.VK)((()=>E.Z.state),[]),g=(0,a.VK)((()=>(0,w.s2)()),[]),h=(0,a.VK)((()=>{if("open"===l&&"preset"===(null==c?void 0:c.type)){const e=c.uri,t=(0,b.iX)((0,S.appConfigs)(),e),s=null==t?void 0:t.presets.find((t=>t.uri===e));if(t&&s)return{currentApp:t,currentPreset:s}}}),[l,c]),f=(0,a.VK)((()=>{if(c){if("preset"===c.type){var e;if(!h)return;const{currentPreset:s}=h,i=null===(e=s.previews)||void 0===e?void 0:e.find((e=>"previewRootId"in e)),n=i&&new me.G(t,{table:U.iU,id:i.previewRootId,spaceId:i.spaceId}),a=n?(0,oe.jsx)("div",{style:{overflow:"hidden",paddingTop:64,paddingLeft:64,paddingRight:64},children:(0,oe.jsx)(Y.Z,{store:n,loadingContainerStore:void 0,context:ue.S.InAppTemplatePreview,paddingLeft:0,paddingRight:0,paddingBottom:0,pageCoverHeight:0,titleStyle:{fontSize:32},disabled:!0},n.id)}):(0,oe.jsx)("img",{style:r.heroImg,src:O.Z.images.appPackages.projectPreview1Png});return[s.name,s.description,(0,oe.jsx)("img",{src:s.icon,style:{width:30,height:30}},s.uri),a]}if("pageTemplate"===c.type){const{template:e}=c,s=new me.G(t,{table:U.iU,id:e.previewRootId,spaceId:e.spaceId}),i=s.isCollectionView()?64:0,n=(0,oe.jsx)("div",{style:{overflow:"hidden",paddingTop:i,paddingLeft:i,paddingRight:i},children:(0,oe.jsx)(Y.Z,{store:s,loadingContainerStore:void 0,context:ue.S.InAppTemplatePreview,paddingLeft:0,paddingRight:0,paddingBottom:0,pageCoverHeight:Y.Z.defaultPageCoverHeight(t),disabled:!0,style:{...s.isFullWidth()?{width:"calc(100% - 64px)",margin:"0 32px"}:{}}})});return[e.name,e.description,(0,oe.jsx)("span",{style:{fontSize:20,height:30},children:e.emoji?(0,oe.jsx)(K.Z,{children:e.emoji}):(0,oe.jsx)("img",{src:e.icon,style:{width:30,height:30}},e.icon)},e.rootId),n]}(0,A.t1)(c)}}),[h,t,c,r.heroImg]),y=(0,X.E)(),v=(0,a.VK)((()=>y.filter((e=>e.canAddOrRemoveTopLevelPages()))),[y]),{creatorName:x,creatorAvatar:M,creatorUrl:j}=(0,a.VK)((()=>{if(!g||!c||"preset"===c.type)return{creatorName:"Notion",creatorAvatar:O.Z.images.notionLogoPng,creatorUrl:`${ce.default.domainBaseUrl}/@notion`,duplicates:void 0};const{template:e}=c,{creatorName:t,creatorAvatar:s,creatorHandle:i,duplicates:n}=e;return{creatorName:t,creatorAvatar:t?s:void 0,creatorUrl:t&&i?`${ce.default.domainBaseUrl}/@${i}`:void 0,duplicates:t?n:void 0}}),[g,c]);if("open"!==l||void 0===c||!f)return null;const[C,k,_,T]=f,I=v.length>0&&"destination_picker"===m&&!p,P=(0,oe.jsx)(d.FormattedMessage,{id:"templateDetail.getTemplateButton.label",defaultMessage:"Get template"}),Z=(0,oe.jsx)(W.Z,{style:r.getTemplateButton,onClick:()=>{e.onAcceptTemplate(c,p),u.ye(t,{template_name:C,from:E.Z.state.analyticsFrom,target_team:null==p?void 0:p.id})},children:P}),F=(0,oe.jsx)(re,{showMemberCount:!0,showPrivate:!0,placementToOrigin:z.pO.Top,originGap:4,sectionTitle:(0,oe.jsx)(d.FormattedMessage,{id:"templateDetail.addToTeamspace",defaultMessage:"Add to a teamspace"}),renderOrigin:e=>(0,oe.jsx)(W.Z,{...e,style:r.getTemplateButton,children:P}),onTeamAccept:s=>{e.onAcceptTemplate(c,s),u.ye(t,{template_name:C,from:E.Z.state.analyticsFrom,target_team:s.id})},onPrivateAccept:()=>{e.onAcceptTemplate(c),u.ye(t,{template_name:C,from:E.Z.state.analyticsFrom,target_team:"private"})},right:(0,oe.jsx)(H.Z,{isBlue:!0,style:{borderRadius:"100px",pointerEvents:"none"},icon:V.f,hovered:!0,caption:(0,oe.jsx)(d.FormattedMessage,{defaultMessage:"Add",id:"TemplateDetail.TeamItem.addButton"}),captionStyle:r.addBadgeTeamTemplateButton})}),D=(0,oe.jsxs)("div",{style:r.madeByLabelV1,children:[(0,oe.jsx)(q.Z,{isSmall:!0,children:(0,oe.jsx)(d.FormattedMessage,{id:"templateDetail.madeBy.label",defaultMessage:"Made by"})}),(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginTop:4},children:[(0,oe.jsx)("img",{src:O.Z.images.notionLogoPng,style:{width:15,height:16}}),(0,oe.jsx)("span",{style:{fontSize:14,fontWeight:500,marginLeft:5,marginRight:5},children:"Notion"})]})]}),B=x?(0,oe.jsxs)(G.Z,{style:{...r.madeByV2Container,...!j&&{cursor:"default"}},href:j,disabled:!j,external:!0,children:[M&&(0,oe.jsx)("div",{style:r.madeByV2AvatarContainer,children:(0,oe.jsx)("img",{src:M,style:M===O.Z.images.notionLogoPng?r.madeByV2NotionAvatar:r.madeByV2Avatar})}),(0,oe.jsx)(q.Z,{style:r.madeByV2Label,children:(0,oe.jsx)(d.FormattedMessage,{id:"templateDetail.madeBy.label.v2",defaultMessage:"By {author}",values:{author:x}})})]}):null;return(0,oe.jsx)(oe.Fragment,{children:(0,oe.jsxs)("div",{style:r.container,children:[(0,oe.jsx)("div",{style:{height:"100%",overflowX:"hidden",overflowY:"auto",maskImage:"linear-gradient(black 80%, transparent 100%)",WebkitMaskImage:"linear-gradient(black 80%, transparent 100%)"},children:(0,oe.jsxs)("div",{style:{position:"relative"},children:[(0,oe.jsx)("div",{style:{marginTop:-20,opacity:1,zIndex:999,pointerEvents:"none"},children:T}),(0,oe.jsx)("div",{style:{backgroundColor:"transparent",position:"absolute",left:0,top:0,right:0,bottom:0,zIndex:1e3}})]})}),(0,oe.jsxs)("div",{style:r.contentContainer,children:[(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,oe.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-start",marginBottom:g?0:20},children:[!g&&_,(0,oe.jsx)("div",{style:{display:"flex",flexDirection:"column",marginLeft:g?0:10},children:(0,oe.jsx)("span",{style:{fontSize:20,fontWeight:700,lineHeight:1.2,marginTop:3,marginBottom:12},children:C})})]}),(0,oe.jsx)("div",{children:g&&B}),(0,oe.jsx)("div",{style:{fontSize:14},children:k})]}),(0,oe.jsxs)("div",{style:r.getTemplateColumn,children:[I?F:Z,!g&&D]})]})]})})}var ge=s(58573),he=s(22686),fe=s(35840),ye=s(50226),ve=s(72126),xe=s(73657),Se=s(61519),be=s(74194),Me=s(3386),we=s(11219),je=s(18514),Ce=s(31194),ke=s(14694);function _e(e){let{topCategoryId:t,categoryId:s}=e;window.__c={n:"TemplateGallerySidebarCategoryName"};const i=(0,d.useIntl)(),n=(0,o.yK)((e=>({sidebarTitle:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"4px 4px 0 6px"}})),[]),r=(0,a.VK)((()=>{const e=function(){var e;if(!t)return;const i=I.oO(t);return i?null===(e=i.subcategories)||void 0===e?void 0:e.find((e=>e.id===s)):void 0}();if(e)return e.name;const n=P._5[s];return n?i.formatMessage(n):""}),[t,s,i]);return(0,oe.jsx)(ke.Z,{style:n.sidebarTitle,children:r})}var Te=s(83065),Ie=s(92607);function Pe(){window.__c={n:"TemplateGallerySidebarMoreFromCommunity"};const e=(0,n.O7)(),t=(0,a.VK)((()=>(0,w.s2)()),[]),s=(0,o.yK)((e=>({button:{height:28,padding:"0 4px",borderRadius:5,transition:"background 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start",fontWeight:500,marginLeft:6,marginRight:6,width:"calc(100% - 12px)"},icon:{width:14,height:14,marginLeft:6,transform:"rotate(45deg)"},linkContentV2Container:{display:"flex",flexDirection:"column",gap:4},linkContentV2Title:{display:"flex",flexDirection:"row",alignItems:"center",fontWeight:600,fontSize:14},linkContentV2Subtitle:{maxWidth:250,whiteSpace:"inherit",overflow:"inherit",fontWeight:400,fontSize:13}})),[]),r=(0,i.useMemo)((()=>(0,oe.jsxs)(oe.Fragment,{children:[(0,Ie.v)(s.icon),(0,oe.jsx)(d.FormattedMessage,{defaultMessage:"More from the Community",id:"templateGallerySidebar.goToMarketingTemplateGalleryButton.label"})]})),[s.icon]),l=(0,i.useMemo)((()=>(0,oe.jsxs)("div",{style:s.linkContentV2Container,children:[(0,oe.jsxs)(q.Z,{isInline:!1,style:s.linkContentV2Title,children:[(0,oe.jsx)(d.FormattedMessage,{defaultMessage:"More templates",id:"templateGallerySidebar.goToCommunityTemplateGalleryButton.labe2"}),(0,Te._)(s.icon)]}),(0,oe.jsx)(q.Z,{isInline:!1,isSecondaryColor:!0,style:s.linkContentV2Subtitle,children:(0,oe.jsx)(d.FormattedMessage,{defaultMessage:"Discover thousands of templates made by Notion users like you",id:"templateGallerySidebar.goToCommunityTemplateGalleryButton.reason2"})})]})),[s.icon,s.linkContentV2Container,s.linkContentV2Subtitle,s.linkContentV2Title]);return(0,oe.jsx)(G.Z,{href:(0,je.UY)("templateGallery"),onClick:()=>u.T2x(e),style:{display:"flex",flexDirection:"row",alignItems:"center"},external:!0,children:t?l:r})}var Ze=s(8848),Fe=s(42853),Ae=s(98519),De=s(82990),Be=s(51077),Re=s(89728),Le=s(98742);function Ne(e){let{}=e;window.__c={n:"TemplateGalleryTopCategoryFilter"};const t=(0,o.yK)((e=>({newInAppGalleryTopCategoryFilterBarContainer:{border:`1px solid ${e.outlineButtonBorder}`,borderRadius:4,marginBottom:8},newInAppGalleryTopCategoryFilterButton:{display:"flex",alignItems:"center",justifyContent:"space-between",color:e.mediumTextColor,padding:"8px 12px",borderRadius:4,marginRight:0,fontSize:De.Z.fontSize.UIRegular.desktop,background:e.inputBackground},newInAppGalleryTopCategoryFilterChevronIcon:{width:15,height:15,fill:e.mediumIconColor}})),[]),{selectedTopCategory:s}=(0,a.VK)((()=>E.Z.state),[]),i=(0,a.VK)((()=>T.Z.getTopTemplateCategories()),[]),n=(0,a.VK)((()=>s?I.oO(s):void 0),[s]),r=(0,a.VK)((()=>(0,w.s2)()&&(null==i?void 0:i.length)>0),[i]);return r?(0,oe.jsx)("div",{style:t.newInAppGalleryTopCategoryFilterBarContainer,children:(0,oe.jsx)(z.ZP,{popupType:z.Z4.Popup,alignmentToOrigin:z.vR.End,placementToOrigin:z.pO.Bottom,sameWidthAsOrigin:!0,render:e=>(0,oe.jsx)(te.Z,{menuType:$.og.Popup,children:(0,oe.jsx)(se.Z,{type:se.i.Vertical,initialFocus:void 0,sections:[{key:"top-category",items:i.map((e=>({key:e.id,action:()=>{if(!r)return;const t=N(e);E.Z.setState({...E.Z.state,selectedTopCategory:e.id,allTemplates:t,limitResults:I.JL(t)})},render:t=>(0,oe.jsx)(ee.Z,{...t,title:(0,oe.jsx)(Ee,{category:e,showSelected:e.id===s})})}))),render:e=>(0,oe.jsx)(ie.Z,{...e})}],onAccept:()=>e.close()})}),renderOrigin:e=>(0,oe.jsxs)(Re.Z,{...(0,Le.Z)(e,{onClick:()=>{}}),style:t.newInAppGalleryTopCategoryFilterButton,children:[(0,oe.jsx)(Ee,{category:n}),(0,Fe.i)(t.newInAppGalleryTopCategoryFilterChevronIcon)]})})}):null}function Ee(e){let{category:t,showSelected:s=!1}=e;window.__c={n:"TemplateGalleryTopCategoryWithIcon"};const i=(0,o.yK)((e=>({selectedIconStyle:{width:14,height:14,fill:Ze.ZP.defaultText},categorySelection:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,lineHeight:"20px"},categoryButtonContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}})),[]);return t?(0,oe.jsxs)("span",{style:i.categoryButtonContainer,children:[(0,oe.jsxs)("span",{style:i.categorySelection,children:[(0,oe.jsx)(Be.Z,{type:"notion_icon",size:20,icon:t.icon.name,isLoading:!1,progressPercent:void 0,largeIcon:!0}),(0,oe.jsx)("span",{children:t.name})]}),s&&(0,oe.jsx)("span",{children:(0,Ae.k)(i.selectedIconStyle)})]}):null}const Oe=(0,d.defineMessages)({allPersona:{id:"templateGallery.sidebar.persona.allTemplates",defaultMessage:"All templates"},noResults:{id:"templateGallery.sidebar.results",defaultMessage:"No results"}});function Ve(){window.__c={n:"TemplateGallerySidebar"};const[e,t]=(0,i.useState)(""),s=(0,d.useIntl)(),r=(0,o.Fg)(),l=(0,n.O7)(),c=(0,a.VK)((()=>(0,w.s2)()),[]),{selectedCategory:m,status:p}=(0,a.VK)((()=>E.Z.state),[]),[g,h]=(0,i.useState)(!1);(0,i.useEffect)((()=>{if(!g){const t=E.Z.state.selectedTemplate;var e;if(t)null===(e=document)||void 0===e||null===(e=e.getElementById(`tg-${"uri"in t?S.presetUriToHumanReadableName[t.uri]:t.template.name}`))||void 0===e||e.scrollIntoView({block:"center"}),h(!0)}}),[g]),(0,i.useEffect)((()=>{"closed"===p&&h(!1)}),[h,p]);const f=(0,o.yK)((e=>({sidebar:{height:"100%",width:275,background:e.sidebarBackground,alignContent:"center",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"stretch",boxShadow:e.sidebarBoxShadow},sidebarMoreFromCommunityContainer:{padding:12,borderTop:`1px solid ${e.accentColors.translucentGray[200]}`},header:{padding:"12px 12px 0 12px"},searchIcon:{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:e.mediumIconColor},searchBar:{height:32,borderRadius:5,fontSize:14,marginTop:0,marginBottom:8,padding:"16px 10px"},filterBar:{display:"flex",flexDirection:"row",width:273,flexWrap:"wrap",gap:6},newInAppGalleryBrandContainer:{display:"flex",alignItems:"center",width:"100%",gap:6,marginBottom:10},newInAppGalleryBrandName:{fontSize:15,fontWeight:600,color:e.regularTextColor},newInAppGalleryBrandIcon:{width:18,height:15,fill:e.regularTextColor},newInAppGallerySearchBarContainer:{padding:"0px 12px"}})),[]),y=(0,i.useMemo)((()=>(0,oe.jsx)(Me.Z,{capture:!0,onBackspace:ve.yR,onLeft:ve.yR,onRight:ve.yR,onSelectAll:ve.yR,onRedo:ve.yR,onUndo:ve.yR,onCut:ve.yR,onCopy:ve.yR,onPaste:ve.yR,onKeypress:ve.yR,onDelete:ve.yR,onTab:ve.yR,children:(0,oe.jsx)(be.Z,{placeholder:s.formatMessage({id:"templateGallery.sidebar.searchbar.placeholder",defaultMessage:"Search templates"}),left:(0,fe.R)(f.searchIcon),showClearButton:!0,format:be.Z.Format.Small,value:e,style:f.searchBar,onChange:e=>t(e.target.value)})})),[e,s,f.searchBar,f.searchIcon]),v=(0,i.useCallback)((e=>{var t,s;const i=[{key:"personas",render:e=>(0,oe.jsx)(ie.Z,{...e,topBorder:0!==e.index}),items:[void 0,...(0,I.Io)({userPersona:null===(t=_.default.state.currentUserSettingsStore)||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.persona,subscriptionTier:null===(s=_.default.state.currentSpaceStore)||void 0===s?void 0:s.getSubscriptionTier()}).filter((e=>"suggested"!==e))].map((t=>({key:t??"all",render:e=>(0,oe.jsx)(ee.Z,{...e,focused:!1,checkState:ve.Xy(t,m),title:(0,oe.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,oe.jsx)(d.FormattedMessage,{...t?P._5[t]:Oe.allPersona})}),shouldWrapCaption:!0}),action:()=>{E.Z.setState({...E.Z.state,selectedCategory:t}),e.close(),u.NgT(l,{persona:t??"all"})}})))}],n={menuType:$.og.Popup,width:260};return(0,oe.jsx)(te.Z,{...n,children:(0,oe.jsx)(se.Z,{type:se.i.Vertical,initialFocus:void 0,sections:i})})}),[l,m]),x=(0,i.useMemo)((()=>(0,oe.jsx)("div",{style:f.filterBar,children:(0,oe.jsx)(z.ZP,{popupType:z.Z4.Popup,renderOrigin:e=>(0,oe.jsx)(we.Z,{on:!0,icon:(0,he.f)({width:14,marginRight:6,fill:r.blueColor}),title:(0,oe.jsx)("span",{children:(0,oe.jsx)(d.FormattedMessage,{...m?P._5[m]:Oe.allPersona})}),...e}),placementToOrigin:Ce.Iw.Bottom,render:e=>v(e)})})),[v,m,f.filterBar,r.blueColor]);return(0,oe.jsxs)("div",{style:f.sidebar,children:[!c&&(0,oe.jsxs)("div",{style:f.header,children:[y,x]}),c&&(0,oe.jsxs)(oe.Fragment,{children:[(0,oe.jsxs)("div",{style:f.header,children:[(0,oe.jsxs)(G.Z,{href:(0,je.UY)("templateGallery"),onClick:()=>u.Ib5(l),style:f.newInAppGalleryBrandContainer,external:!0,children:[(0,ye.I)(f.newInAppGalleryBrandIcon),(0,oe.jsx)("span",{style:f.newInAppGalleryBrandName,children:(0,oe.jsx)(d.FormattedMessage,{id:"templateGallery.brand.title",defaultMessage:"Templates"})})]}),(0,oe.jsx)(Ne,{})]}),(0,oe.jsx)("div",{style:f.newInAppGallerySearchBarContainer,children:y})]}),(0,oe.jsx)(Ue,{currentQuery:e,selectedCategory:m}),c&&(0,oe.jsxs)("div",{children:[(0,oe.jsx)(Se.Z,{size:"0"}),(0,oe.jsx)("div",{style:f.sidebarMoreFromCommunityContainer,children:(0,oe.jsx)(Pe,{})})]})]})}function Ue(e){window.__c={n:"TemplateGallerySidebarItemList"};const{currentQuery:t,selectedCategory:s}=e,n=""!==t||void 0!==s,{allTemplates:r,selectedTopCategory:l,status:c,limitResults:u}=(0,a.VK)((()=>E.Z.state),[]),m=(0,a.VK)((()=>(0,w.s2)()),[]),p=(0,o.yK)((e=>({button:{height:44,padding:"8px 0",borderRadius:4,marginBottom:4,transition:"all 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start"},categoryDiv:{marginBottom:n?0:14},unSelectedItem:{color:e.mediumTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.buttonHoveredBackground,fontWeight:500,color:e.regularTextColor},hoveredItem:{borderRadius:4,background:e.buttonHoveredBackground},presetTitle:{fontSize:14,color:e.regularTextColor},presetDescription:{fontSize:12},sidebarTitle:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"4px 4px 0 6px"},sidebarShowMore:{fontSize:12,color:e.lightTextColor,fontWeight:600,margin:"2px 2px 0 6px"}})),[n]),g=(0,a.VK)((()=>{if("open"!==c||void 0===r)return[];const e=new Set;return Object.fromEntries(Object.entries(r).filter((e=>{let[t]=e;return void 0===s||t===s})).map((s=>{let[i,n]=s;return[i,(0,ge.ZP)(t.replaceAll("-",""),n,(e=>`${e.name}`.replaceAll("-",""))).filter((t=>{const s=e.has(t.name);return e.add(t.name),!s}))]})))}),[c,r,s,t]),h=(0,i.useCallback)((e=>{"open"===c&&void 0!==u&&E.Z.setState({...E.Z.state,limitResults:{...u,[e]:!1}})}),[u,c]);return"open"!==c?null:(0,oe.jsx)("div",{style:{flexGrow:1,width:"100%",overflowX:"hidden",overflowY:"auto"},children:(0,oe.jsxs)(ie.Z,{desktopTitleStyle:{paddingLeft:8},children:[Object.entries(g).map((e=>{let[t,s]=e;if(0===s.length)return;const i=(null==u?void 0:u[t])&&!n&&s.length>C.IJ+1,a=i?s.length-C.IJ:0,o=i?s.slice(0,C.IJ):s;return(0,oe.jsxs)("div",{style:p.categoryDiv,children:[!n&&(0,oe.jsx)(_e,{topCategoryId:l,categoryId:t}),o.map((e=>"uri"in e?(0,oe.jsx)(We,{icon:e.icon,name:e.name,template:{type:"preset",uri:e.uri}},e.uri):(0,oe.jsx)(We,{icon:e.icon,emoji:e.emoji,name:e.name,template:{type:"pageTemplate",template:e}},e.id))),i&&a>0?(0,oe.jsx)(ee.Z,{style:p.sidebarShowMore,focused:!1,onClick:()=>h(t),title:(0,oe.jsx)(d.FormattedMessage,{defaultMessage:"{numNotShown} more...",id:"templateGallerySidebar.category.showMore",values:{numNotShown:a}})}):void 0]},t)})),0===Object.values(g).flatMap((e=>e)).length&&(0,oe.jsx)(xe.Z,{caption:D.default.formatMessage(Oe.noResults),style:{lineHeight:"14px",padding:6,margin:0}}),!m&&(0,oe.jsx)(ee.Z,{desktopIconStyle:{alignSelf:"unset"},focused:!1,buttonStyle:{...p.button},title:(0,oe.jsx)(Pe,{})})]})})}function We(e){var t;window.__c={n:"TemplateGallerySidebarItem"};const s=(0,n.O7)(),r=(0,o.yK)((e=>({button:{height:28,padding:"0 4px",borderRadius:5,transition:"background 0.2s ease",color:e.mediumTextColor,alignItems:"flex-start",fontWeight:500,marginLeft:6,marginRight:6,width:"calc(100% - 12px)"},itemText:{marginLeft:5},unSelectedItemText:{color:e.mediumTextColor},selectedItemText:{color:e.regularTextColor},selectedItem:{background:"dark"===e.mode?e.popoverHoveredBackground:e.sidebarItemSelectedBackground,fontWeight:500},hoveredItem:{background:e.buttonHoveredBackground},presetIcon:{width:16,height:16,fontSize:16,color:e.regularEmojiColor},presetTitle:{fontSize:14},presetDescription:{fontSize:12}})),[]),{status:l,selectedTemplate:d,analyticsFrom:c}=(0,a.VK)((()=>E.Z.state),[]),m=(0,a.VK)((()=>"open"===l&&ve.Xy(d,e.template)),[l,e.template,d]),p=(0,i.useCallback)((()=>{const t="uri"in e.template?S.presetUriToHumanReadableName[e.template.uri]:e.template.template.previewRootId,i=(0,C.W4)({templateGalleryItem:t});f.navigate({environment:s,url:i}),u.n1D(s,{template_name:"preset"===e.template.type?e.template.uri:e.template.template.name,page_prepopulated_template_id:t,from:c})}),[c,s,e.template]);if("open"!==l)return null;const g=null!==(t=e.icon)&&void 0!==t&&t.startsWith("/")?(0,oe.jsx)("img",{src:e.icon,style:r.presetIcon}):(0,oe.jsx)("div",{style:r.presetIcon,children:(0,oe.jsx)(K.Z,{children:e.emoji??e.icon??""})}),h=`tg-${"uri"in e.template?S.presetUriToHumanReadableName[e.template.uri]:e.template.template.name}`;return(0,oe.jsx)(ee.Z,{id:h,desktopIconStyle:{alignSelf:"unset"},buttonStyle:{...r.button,...m?r.selectedItem:void 0},textWrapperStyle:{...m?r.selectedItemText:r.unSelectedItemText,...r.itemText},focused:!1,icon:g,title:(0,oe.jsx)("span",{style:r.presetTitle,children:e.name}),shouldWrapCaption:!0,hoveredStyle:r.hoveredItem,onClick:p})}const ze=["companyHome","defaultWiki","engineeringWiki","salesWiki","teamWiki"];function Ke(){window.__c={n:"TemplateGalleryModal"};const e=(0,n.Fy)(),t=(0,n.O7)(),s=(0,d.useIntl)(),c=(0,i.useRef)(void 0),P=(0,o.yK)((t=>({modal:{width:e.isMobile?"auto":"90vw",height:e.isMobile?"auto":"90vh",borderRadius:8}})),[e.isMobile]),Z=(0,a.VK)((()=>_.default.state.currentSpaceStore),[]),{templateGalleryItem:F}=(0,a.VK)((()=>t.RouterStore.state.route),[t.RouterStore]),A=(0,a.VK)((()=>(0,w.s2)()),[]),{status:D,allTemplates:B,selectedTemplate:L,cloneTo:N,limitResults:O}=(0,a.VK)((()=>E.Z.state),[]);(0,i.useEffect)((()=>{if(F)return c.current=window.setTimeout((()=>{E.Z.setState({...E.Z.state,status:"closed"})}),1e4),()=>{void 0!==c.current&&window.clearTimeout(c.current)}}),[]);const V=(0,i.useRef)(void 0);(0,i.useEffect)((()=>{V.current&&(V.current=void 0)}),[null==Z?void 0:Z.id]),(0,i.useEffect)((()=>{var e;V.current||"closed"!==D&&(V.current=A?async function(e){const{environment:t,spaceId:s}=e,i=await m.getInAppCategoriesAndTemplates(t,{spaceId:s});return"success"===i.type&&(T.Z.setState({data:i.data}),"current"===i.data.version)}({environment:t,spaceId:null==Z?void 0:Z.id}):Promise.resolve(),null===(e=V.current)||void 0===e||e.then((()=>{var e,t;const s=F&&I.vY(F),{selectedTopCategory:i,allTemplates:n}=R({isNewInAppGalleryEnabled:A,userPersona:null===(e=_.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.persona,subscriptionTier:null===(t=_.default.state.currentSpaceStore)||void 0===t?void 0:t.getSubscriptionTier(),selectedTopCategory:s});E.Z.setState({...E.Z.state,selectedTopCategory:i,allTemplates:n,limitResults:I.JL(n)})})).finally((()=>{void 0!==c.current&&window.clearTimeout(c.current)})))}),[t,A,null==Z?void 0:Z.id,V,D,F]),(0,i.useEffect)((()=>{if(void 0!==B&&"opening"===D){const e=void 0!==L&&(void 0===F||"gallery"===F)?L:He({templateGalleryItem:F,allTemplates:B});return E.Z.setState({...E.Z.state,status:"open",allTemplates:B,selectedTemplate:e,limitResults:O??I.JL(B),cloneTo:E.Z.state.cloneTo,analyticsFrom:E.Z.state.analyticsFrom}),void u.jWY(t,{template_name:"preset"===e.type?e.uri:e.template.name,from:E.Z.state.analyticsFrom})}}),[F,t,B,D,L,N,O]),(0,i.useEffect)((()=>{"open"===D&&void 0!==B&&void 0!==F&&"gallery"!==F&&E.Z.setState({...E.Z.state,selectedTemplate:He({templateGalleryItem:F,allTemplates:B})})}),[B,D,F]);const U=(0,a.VK)((()=>{const e=(0,x.np)();if("open"===D&&"current_page"===N&&e&&e.isEmptyPage())return e}),[N,D]),W=(0,i.useCallback)((async(e,s)=>{var i,n,a;E.Z.setState({...E.Z.state,status:"closed",selectedTemplate:void 0});const{currentSpaceStore:o,currentSpaceViewStore:d}=_.default.state,c=null==U||!U.getParentStore()||"block"!==(null===(i=U.getParentStore())||void 0===i?void 0:i.table)&&"space"!==(null===(n=U.getParentStore())||void 0===n?void 0:n.table)&&"team"!==(null===(a=U.getParentStore())||void 0===a?void 0:a.table)?s||o:U.getParentStore(),v=Date.now();let x;if("preset"===e.type&&(0,l.SA)(e.uri)){var w;const i=e.uri,n=null===(w=(0,b.iX)((0,S.appConfigs)(),i))||void 0===w?void 0:w.uri;if(!(n&&o&&d&&c))return;const a=s||j.VP(c);if(a){if(!(await async function(e){let{environment:t,spaceId:s,presetUri:i,teamStore:n}=e;return await(0,k.l)({environment:t,spaceId:s,presetUri:i,parentStore:n,teamId:n.id,from:"template_gallery"})}({environment:t,spaceId:o.id,presetUri:i,teamStore:a})))return}const r=U||(s?s.getTeamPagesStores().find((e=>e.getFormat().app_config_uri&&e.getFormat().app_config_uri===n)):void 0);y.createAndCommit({environment:t,userAction:"templateGallery.getTemplate",perform:e=>{const s=(0,S.appConfigs)().find((e=>e.uri===n)),a=null==s?void 0:s.presets.find((e=>e.uri===i));if(d&&a){const s=p.initializeApp({environment:t,spaceViewStore:d,appUri:n,presetUri:a.uri,appParentStore:c,temporaryContainerBlockStore:r,transaction:e,from:"template_gallery"});g.createSprintPage({environment:t,spaceViewStore:d,appParentStore:c,transaction:e,blockStores:s,creationEntryPoint:{type:"preset",presetUri:a.uri}})}}}),m.finalizeAppTemplate(t,{})}else{const i="preset"===e.type?(0,M.CQ)(e.uri):e.template;if(!i)return;if(!o||!d)return;const n={environment:t,item:i,spaceStore:o,spaceViewStore:d,useMinimalTemplates:!1,from:"template_gallery"},a=U?await h.rC({...n,isPrivate:!1,initializeStore:U,type:"inExistingStore"}):s?await h.rC({...n,isPrivate:!1,teamStore:s,type:"inTeam",appendOrPrepend:"append"}):await h.rC({...n,isPrivate:!0,type:"inSpace"});x=a,a&&f.navigateToBlock({environment:t,store:a,pageVisitSource:r.tY.Create})}const C="preset"===e.type?e.uri:e.template.name,T=Date.now()-v,I=U?!j.VP(U):!Boolean(s),P=I||null==s?void 0:s.id;u.enX(t,{template_name:C,destination:I?"private":"team",template_block_id:"pageTemplate"===e.type?e.template.rootId:void 0,template_duplication_duration_ms:T,team_id:P,created_page_id:x?x.id:null==U?void 0:U.id}),u.W2j(t,{type:"page",from:"template_gallery",new_page_id:x?x.id:null==U?void 0:U.id}),"preset"===e.type&&(0,l.SA)(e.uri)&&x&&u.bRT(t,{preset_uri:e.uri,created_block_stores:[x],from:"template_gallery",destination_team_id:P}),"pageTemplate"===e.type&&qe(e.template.id)&&x&&u.Jw_(t,{from:"template_gallery",wiki_block_id:x.id,destination_team_id:P,wiki_template_id:e.template.id})}),[t,U]),z=(0,i.useCallback)((()=>{const{mainEditorCurrentBlockStore:e}=_.default.state,{RouterStore:s}=t,i=s.state.route;if(e&&"page"===i.name){const e=(0,C.p8)();f.navigate({environment:t,url:e})}}),[t]);return(0,oe.jsx)(v.Z,{ariaLabel:s.formatMessage({id:"templateGallery.dialogLabel",defaultMessage:"Templates"}),open:"open"===D,innerStyle:P.modal,onDismiss:z,render:()=>"open"!==D?null:(0,oe.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"row",borderRadius:8,overflow:"hidden"},children:[(0,oe.jsx)(Ve,{}),(0,oe.jsx)(pe,{onAcceptTemplate:W})]})})}function He(e){let{templateGalleryItem:t,allTemplates:s}=e;if(!t||"gallery"===t){var i;return"team"===(null===(i=_.default.state.currentSpaceStore)||void 0===i?void 0:i.getPlanType())?{type:"preset",uri:l.Yb}:Ge(s)}const n=Object.values(s).flatMap((e=>e)).find((e=>"uri"in e?S.presetUriToHumanReadableName[e.uri]===t:e.previewRootId===t));return n?"uri"in n?{type:"preset",uri:n.uri}:{type:"pageTemplate",template:n}:Ge(s)}function Ge(e){const t=e[Object.keys(e)[0]][0];return"uri"in t?{type:"preset",uri:t.uri}:{type:"pageTemplate",template:t}}function qe(e){return ze.some((t=>c.Y[t].nameMessage.id===e))}},47054:(e,t,s)=>{s.d(t,{AD:()=>l});s(57658);var i=s(30120),n=s(59730),a=s(63143);function o(e){if(void 0===e)return i.ou.utc();const t={zone:"utc"};return"number"==typeof e?i.ou.fromMillis(e,t):i.ou.fromISO(e,t)}function r(e,t){const s=t?o(t):i.ou.utc(),a=o(e??function(e){const{days:t,endDate:s,startDate:a}=e;if(t<=0)throw new n.p8("Days must be greater than 0");const r=s?o(s):i.ou.utc();if(!r.isValid)throw new n.p8(`endDate ${s} is in an invalid format`);const l=a?o(a).toMillis():0,d=r.minus({days:t-1}).toMillis();return Math.max(d,l)}({days:7,endDate:t}));if(!a.isValid)throw new n.p8(`startDate ${e} is in an invalid format`);if(!s.isValid)throw new n.p8(`endDate ${t} is in an invalid format`);if(a>s)throw new n.p8(`startDate ${e} => ${a.toISO()} is after endDate ${t} => ${s.toISO()}`);return{startTimestamp:a.toMillis(),endTimestamp:s.toMillis()}}function l(e,t){const{startTimestamp:s,endTimestamp:i}=r(e,t),n=[];for(var l=s;l<=i;)n.push(o(l).toISODate()),l+=a.A0;return n}},83176:(e,t,s)=>{s.d(t,{z:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("analyticsSearch",{viewBox:"0 0 51 52",svg:(0,n.jsx)("path",{d:"M.414 21.297c0 2.86.533 5.543 1.6 8.049a21.156 21.156 0 004.468 6.576 20.797 20.797 0 006.577 4.443c2.505 1.067 5.18 1.6 8.023 1.6 2.116 0 4.13-.305 6.043-.914a21.55 21.55 0 005.332-2.565l11.654 11.655a3.44 3.44 0 001.245.812c.473.186.964.28 1.472.28.728 0 1.371-.17 1.93-.508a3.48 3.48 0 001.32-1.346 3.887 3.887 0 00.482-1.93 3.8 3.8 0 00-.279-1.447 3.126 3.126 0 00-.787-1.193l-11.578-11.63a20.414 20.414 0 002.818-5.51c.694-2.013 1.041-4.138 1.041-6.372 0-2.844-.541-5.51-1.625-7.998a20.718 20.718 0 00-4.443-6.602 20.515 20.515 0 00-6.602-4.468c-2.488-1.067-5.162-1.6-8.023-1.6-2.844 0-5.518.533-8.023 1.6a20.592 20.592 0 00-6.577 4.468A21.072 21.072 0 002.014 13.3c-1.067 2.488-1.6 5.154-1.6 7.998zm5.408 0c0-2.1.39-4.071 1.168-5.916a15.517 15.517 0 013.301-4.875 15.168 15.168 0 014.875-3.276c1.845-.795 3.817-1.193 5.916-1.193 2.116 0 4.096.398 5.941 1.193a14.877 14.877 0 014.85 3.276 15.515 15.515 0 013.3 4.875c.796 1.845 1.194 3.817 1.194 5.916 0 2.116-.398 4.096-1.193 5.941a15.517 15.517 0 01-3.301 4.875 15.426 15.426 0 01-4.85 3.276c-1.845.795-3.825 1.193-5.941 1.193-2.099 0-4.07-.398-5.916-1.193a15.737 15.737 0 01-4.875-3.276 15.52 15.52 0 01-3.3-4.875c-.78-1.845-1.169-3.825-1.169-5.941zm15.31 10.36c.458 0 .746-.263.864-.788.237-1.32.474-2.437.711-3.351.254-.931.559-1.693.914-2.286a4.554 4.554 0 011.397-1.498c.575-.389 1.311-.694 2.209-.914.914-.237 2.056-.448 3.427-.634.542-.085.813-.381.813-.89 0-.507-.271-.812-.813-.913-1.354-.17-2.496-.373-3.427-.61-.915-.253-1.668-.567-2.26-.939a4.814 4.814 0 01-1.422-1.498c-.373-.61-.677-1.363-.914-2.26a42.337 42.337 0 01-.635-3.326c-.084-.542-.372-.813-.863-.813s-.796.263-.914.788a53.724 53.724 0 01-.737 3.377c-.22.914-.507 1.675-.863 2.285a4.64 4.64 0 01-1.396 1.472c-.576.373-1.32.677-2.235.914-.914.22-2.048.424-3.402.61-.559.101-.838.406-.838.914 0 .49.28.787.838.889 1.693.186 3.055.44 4.088.761 1.032.305 1.828.762 2.387 1.371.575.61 1.015 1.44 1.32 2.489.305 1.05.584 2.395.838 4.037a1 1 0 00.279.584c.17.152.38.228.635.228z"})})},88145:(e,t,s)=>{s.d(t,{E:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("appDownload",{viewBox:"0 0 23 16",svg:(0,n.jsx)("path",{clipRule:"evenodd",d:"m23 11.4338c0 2.5317-2.1591 4.5662-4.922 4.5662h-12.59789c-3.12888 0-5.48011-2.2739-5.48011-4.9804 0-2.2463 1.28998-4.10591 3.3576-4.43732.04574-2.57768 2.49761-4.2992 4.74821-3.63637 1.09785-1.61104 2.86359-2.94591 5.34289-2.94591 3.7418 0 6.6786 2.96433 6.6603 7.0702 1.784.75489 2.891 2.43038 2.891 4.3636zm-17.51989 3.084h12.59789c1.9487 0 3.449-1.3717 3.449-3.084 0-1.66625-1.0704-2.89065-2.7354-3.25889-.1098-.02761-.1556-.09206-.1464-.21173.0366-.43269.064-.92981.0366-1.35328-.1555-2.73418-2.2323-5.12774-5.2331-5.12774-2.3695 0-3.73271 1.30725-4.62014 2.89989-.05489.10126-.11893.12888-.22872.09206-1.8755-.6168-3.90652.22094-3.90652 3.05638 0 .11968-.04575.18412-.17383.18412-1.93954 0-3.04654 1.46376-3.04654 3.30499 0 1.878 1.70167 3.4982 4.00716 3.4982zm7.19089-9.49502c0-.39047-.3145-.70701-.7026-.70701-.388 0-.7026.31654-.7026.70701v4.89196l-1.61105-1.62112c-.27439-.27611-.71927-.27611-.99366 0-.2744.27611-.2744.72377 0 .99987l2.81051 2.82811c.2744.2761.7193.2761.9936 0l2.8106-2.82811c.2743-.2761.2743-.72376 0-.99987-.2744-.27611-.7193-.27611-.9937 0l-1.6111 1.62112z",fillRule:"evenodd"})})},92165:(e,t,s)=>{s.d(t,{Z:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("arrowsDiverging",{viewBox:"0 0 12 12",svg:(0,n.jsx)("path",{d:"M6 11.2891C6.42188 11.2891 6.63281 11.0469 6.63281 10.5625V7.3457C6.63281 7.00586 6.71875 6.64062 6.89062 6.25C7.06641 5.85938 7.29492 5.47266 7.57617 5.08984C7.86133 4.70703 8.16992 4.35547 8.50195 4.03516C8.83789 3.71484 9.16406 3.45312 9.48047 3.25L9.95508 2.94531C10.1621 2.81641 10.2656 2.63281 10.2656 2.39453C10.2656 2.21875 10.2109 2.07227 10.1016 1.95508C9.99219 1.83789 9.8418 1.7793 9.65039 1.7793C9.4668 1.7793 9.29102 1.83398 9.12305 1.94336L8.81836 2.14844C8.51367 2.34766 8.20898 2.58984 7.9043 2.875C7.59961 3.15625 7.31641 3.45508 7.05469 3.77148C6.79297 4.08398 6.56836 4.39258 6.38086 4.69727C6.19727 4.99805 6.07227 5.26953 6.00586 5.51172H5.98828C5.91797 5.26953 5.79102 4.99805 5.60742 4.69727C5.42383 4.39258 5.19922 4.08398 4.93359 3.77148C4.67188 3.45508 4.38867 3.15625 4.08398 2.875C3.7832 2.58984 3.48047 2.34766 3.17578 2.14844L2.87109 1.94336C2.69922 1.83398 2.52344 1.7793 2.34375 1.7793C2.14844 1.7793 1.99609 1.83984 1.88672 1.96094C1.78125 2.08203 1.72852 2.22461 1.72852 2.38867C1.72852 2.62695 1.83203 2.8125 2.03906 2.94531L2.51367 3.25C2.83008 3.45312 3.1543 3.71484 3.48633 4.03516C3.81836 4.35547 4.12695 4.70703 4.41211 5.08984C4.69727 5.47266 4.92773 5.85938 5.10352 6.25C5.2793 6.64062 5.36719 7.00586 5.36719 7.3457V10.5625C5.36719 11.0469 5.57812 11.2891 6 11.2891ZM1.81641 3.9707L3.71484 1.52734C3.85547 1.33984 3.88281 1.17578 3.79688 1.03516C3.71484 0.890625 3.55469 0.814453 3.31641 0.806641L0.808594 0.712891C0.613281 0.705078 0.466797 0.763672 0.369141 0.888672C0.271484 1.00977 0.251953 1.16406 0.310547 1.35156L1.02539 3.75391C1.0918 3.98438 1.20312 4.125 1.35938 4.17578C1.51953 4.22656 1.67188 4.1582 1.81641 3.9707ZM10.0898 3.95898C10.2266 4.1543 10.375 4.23047 10.5352 4.1875C10.6992 4.14062 10.8164 4.00391 10.8867 3.77734L11.6777 1.39258C11.7402 1.20508 11.7246 1.04883 11.6309 0.923828C11.541 0.798828 11.3984 0.736328 11.2031 0.736328L8.68945 0.753906C8.45117 0.753906 8.28711 0.824219 8.19727 0.964844C8.10742 1.10156 8.13086 1.26562 8.26758 1.45703L10.0898 3.95898Z"})})},82114:(e,t,s)=>{s.d(t,{Q:()=>n,p:()=>a});s(67294);var i=s(45238);const n=(0,s(85893).jsx)("path",{d:"M.911 8.034c0 4.505 3.049 7.24 7.246 7.24 1.135 0 2.215-.158 2.885-.376.472-.15.622-.397.622-.65a.44.44 0 00-.451-.444 1.3 1.3 0 00-.321.048c-.834.205-1.552.341-2.516.341-3.74 0-6.29-2.255-6.29-6.118 0-3.698 2.407-6.275 6.03-6.275 3.206 0 5.886 1.975 5.886 5.523 0 2.072-.697 3.466-1.825 3.466-.752 0-1.176-.437-1.176-1.183V4.972c0-.37-.205-.595-.554-.595-.341 0-.553.226-.553.595v.779h-.062c-.349-.84-1.203-1.374-2.222-1.374-1.77 0-3.014 1.51-3.014 3.678 0 2.187 1.237 3.712 3.042 3.712 1.06 0 1.88-.575 2.276-1.545h.062c.13.963.943 1.551 2.023 1.551 1.907 0 3.09-1.873 3.09-4.498 0-3.971-2.92-6.548-6.96-6.548C3.886.727.912 3.632.912 8.034zm6.911 2.652c-1.223 0-2.003-1.018-2.003-2.638 0-1.593.786-2.611 2.01-2.611 1.258 0 2.05.998 2.05 2.584 0 1.62-.813 2.665-2.057 2.665z"}),a=(0,i.I)("at",{viewBox:"0 0 16 16",svg:n})},90792:(e,t,s)=>{s.d(t,{t:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("bell",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M1.36914 11.7627C1.36914 12.3369 1.80664 12.7266 2.51074 12.7266H5.32031C5.38184 14.0322 6.44824 15.2285 8 15.2285C9.55176 15.2285 10.6182 14.0391 10.6797 12.7266H13.4893C14.2002 12.7266 14.6309 12.3369 14.6309 11.7627C14.6309 11.0381 13.9678 10.416 13.3457 9.81445C12.8672 9.34277 12.751 8.39941 12.6621 7.46289C12.5732 4.87207 11.8213 3.14258 10.0371 2.49316C9.77734 1.59082 9.01855 0.900391 8 0.900391C6.98145 0.900391 6.22266 1.59082 5.96289 2.49316C4.17871 3.14258 3.42676 4.87207 3.33789 7.46289C3.24902 8.39941 3.13965 9.34277 2.6543 9.81445C2.03906 10.416 1.36914 11.0381 1.36914 11.7627ZM3.00293 11.4756V11.3936C3.18066 11.1953 3.57715 10.833 3.91211 10.4434C4.38379 9.90332 4.60254 8.92578 4.6709 7.62695C4.75293 4.85156 5.60059 3.92871 6.70801 3.62793C6.87207 3.58691 6.96777 3.50488 6.98145 3.32031C7.01562 2.62305 7.39844 2.1582 8 2.1582C8.60156 2.1582 8.99121 2.62305 9.01855 3.32031C9.03223 3.50488 9.12793 3.58691 9.29883 3.62793C10.3994 3.92871 11.2539 4.85156 11.3291 7.62695C11.3975 8.92578 11.623 9.90332 12.0879 10.4434C12.4297 10.833 12.8125 11.1953 12.9834 11.3936V11.4756H3.00293ZM6.6123 12.7266H9.3877C9.33984 13.5811 8.7793 14.1348 8 14.1348C7.22754 14.1348 6.66699 13.5811 6.6123 12.7266Z"})})},67220:(e,t,s)=>{s.d(t,{S:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("bot",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M7.996 16C12.381 16 16 12.38 16 8s-3.627-8-8.012-8C3.611 0 0 3.62 0 8s3.62 8 7.996 8zm0-1.594A6.375 6.375 0 011.61 8a6.366 6.366 0 016.38-6.398A6.393 6.393 0 0114.398 8a6.383 6.383 0 01-6.403 6.406zM4.648 8.518c0 .21.17.364.386.364h2.53l-1.346 3.605c-.202.527.355.813.703.395l4.168-5.176a.515.515 0 00.132-.325c0-.209-.17-.356-.379-.356H8.305l1.346-3.613c.201-.518-.356-.812-.704-.395l-4.16 5.184a.484.484 0 00-.14.317z"})})},93108:(e,t,s)=>{s.d(t,{p:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("contentSearch",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M0.25293 5.82031C0.25293 8.88965 2.74805 11.3848 5.81738 11.3848C6.95898 11.3848 8.00488 11.0361 8.87988 10.4414L12.0244 13.5859C12.2158 13.7842 12.4824 13.873 12.749 13.873C13.3301 13.873 13.7471 13.4355 13.7471 12.8682C13.7471 12.5947 13.6514 12.3418 13.4668 12.1504L10.3428 9.01953C10.9922 8.12402 11.3818 7.0166 11.3818 5.82031C11.3818 2.75098 8.88672 0.255859 5.81738 0.255859C2.74805 0.255859 0.25293 2.75098 0.25293 5.82031ZM1.70215 5.82031C1.70215 3.55078 3.54102 1.70508 5.81738 1.70508C8.08691 1.70508 9.93262 3.55078 9.93262 5.82031C9.93262 8.08984 8.08691 9.93555 5.81738 9.93555C3.54102 9.93555 1.70215 8.08984 1.70215 5.82031Z"})})},77366:(e,t,s)=>{s.d(t,{F:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("customizePage",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M10.5361 5.54883C11.2744 5.54883 11.9033 5.09082 12.1631 4.44141H14.4258C14.7607 4.44141 15.0479 4.14746 15.0479 3.79199C15.0479 3.43652 14.7676 3.14258 14.4258 3.14258H12.1699C11.9102 2.49316 11.2744 2.03516 10.5361 2.03516C9.79785 2.03516 9.16211 2.49316 8.90234 3.14258H1.59473C1.23242 3.14258 0.952148 3.43652 0.952148 3.79199C0.952148 4.14746 1.23926 4.44141 1.59473 4.44141H8.90234C9.16211 5.09082 9.79785 5.54883 10.5361 5.54883ZM10.5361 4.62598C10.0713 4.62598 9.69531 4.25684 9.69531 3.79199C9.69531 3.31348 10.0713 2.95117 10.5361 2.95117C11.0078 2.95117 11.3701 3.31348 11.3701 3.79199C11.3701 4.25684 11.0078 4.62598 10.5361 4.62598ZM1.56738 7.40137C1.23242 7.40137 0.952148 7.68848 0.952148 8.05078C0.952148 8.39941 1.23926 8.69336 1.56738 8.69336H3.91211C4.16504 9.34277 4.80078 9.80762 5.5459 9.80762C6.27734 9.80762 6.91309 9.34277 7.17285 8.69336H14.4053C14.7607 8.69336 15.0479 8.40625 15.0479 8.05078C15.0479 7.68848 14.7676 7.40137 14.4053 7.40137H7.17285C6.91309 6.75195 6.27734 6.29395 5.5459 6.29395C4.80762 6.29395 4.17188 6.75195 3.91211 7.40137H1.56738ZM5.5459 8.88477C5.07422 8.88477 4.70508 8.51562 4.70508 8.05078C4.70508 7.57227 5.07422 7.20996 5.5459 7.20996C6.01758 7.20996 6.37988 7.57227 6.37988 8.05078C6.37988 8.51562 6.01758 8.88477 5.5459 8.88477ZM10.5361 14.0596C11.2744 14.0596 11.9102 13.6016 12.1699 12.9521H14.4258C14.7607 12.9521 15.0479 12.6582 15.0479 12.3027C15.0479 11.9404 14.7676 11.6533 14.4258 11.6533H12.1631C11.9102 11.0039 11.2744 10.5459 10.5361 10.5459C9.79785 10.5459 9.16211 11.0039 8.90234 11.6533H1.59473C1.23242 11.6533 0.952148 11.9473 0.952148 12.3027C0.952148 12.6582 1.23926 12.9521 1.59473 12.9521H8.90234C9.16211 13.6016 9.79785 14.0596 10.5361 14.0596ZM10.5361 13.1436C10.0713 13.1436 9.69531 12.7676 9.69531 12.3027C9.69531 11.8311 10.0713 11.4619 10.5361 11.4619C11.0078 11.4619 11.3701 11.8311 11.3701 12.3027C11.3701 12.7676 11.0078 13.1436 10.5361 13.1436Z"})})},50780:(e,t,s)=>{s.d(t,{E:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("editPropertyType",{viewBox:"0 0 16 16 ",svg:(0,n.jsx)("path",{d:"M11.5615 4.84473L12.2998 4.11328C12.6689 3.74414 12.6826 3.34082 12.3545 3.00586L12.0879 2.73926C11.7529 2.4043 11.3428 2.43848 10.9736 2.79395L10.2354 3.52539L11.5615 4.84473ZM3.22168 13.1641L10.9053 5.4873L9.59277 4.16797L1.90918 11.8516L1.23926 13.4512C1.16406 13.6562 1.37598 13.875 1.57422 13.7998L3.22168 13.1641ZM3.92578 13.8066H14.1045C14.4736 13.8066 14.7744 13.499 14.7744 13.1367C14.7744 12.7676 14.4736 12.4668 14.1045 12.4668H5.27246L3.92578 13.8066Z"})})},81570:(e,t,s)=>{s.d(t,{T:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("giftOutline",{viewBox:"0 0 32 34",svg:(0,n.jsx)("path",{d:"M7.781 33.219h16.422c2.938 0 4.563-1.547 4.563-4.5v-9.594h.109c1.375-.297 2.14-1.406 2.14-3v-4.11c0-1.906-1.062-3.109-2.968-3.109H24.89c.828-.828 1.312-1.953 1.312-3.25 0-3.031-2.39-5.187-5.422-5.187-2.187 0-4 1.203-4.797 3.297C15.187 1.672 13.39.469 11.187.469c-3.016 0-5.422 2.156-5.422 5.187 0 1.297.484 2.422 1.328 3.25H3.937C2.11 8.906.97 10.11.97 12.016v4.109c0 1.594.75 2.703 2.125 3h.11v9.594c0 2.953 1.624 4.5 4.577 4.5zm6.922-24.313h-2.437c-2.454 0-3.891-1.39-3.891-3.11 0-1.718 1.25-2.718 2.969-2.718 1.86 0 3.36 1.406 3.36 3.719v2.11zm2.563 0v-2.11c0-2.312 1.5-3.718 3.359-3.718 1.719 0 2.969 1 2.969 2.719 0 1.719-1.422 3.11-3.89 3.11h-2.438zm-2.672 7.969H4.578c-.781 0-1.094-.328-1.094-1.11V12.36c0-.78.313-1.093 1.094-1.093h10.016v5.609zm2.781 0v-5.61h10.047c.781 0 1.078.313 1.078 1.094v3.407c0 .78-.297 1.109-1.078 1.109H17.375zm-2.781 14H7.75c-1.297 0-2.031-.734-2.031-2.031v-9.61h8.875v11.641zm2.781 0v-11.64h8.875v9.609c0 1.297-.734 2.031-2.031 2.031h-6.844z"})})},66466:(e,t,s)=>{s.d(t,{S:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("logout",{viewBox:"0 0 30 30",svg:(0,n.jsx)("path",{d:"M17,24l9-9l-9-9l-1.406,1.406L22.188,14H8v2h14.188l-6.594,6.594L17,24z M6,4h16V2H4v26h18v-2H6V4z"})})},3556:(e,t,s)=>{s.d(t,{Z:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("mail",{viewBox:"0 0 30 30",svg:(0,n.jsx)("path",{d:"M0,4v22h30V4H0z M17.591,16.33C16.137,17.753,15.819,18,15,18s-1.137-0.247-2.555-1.635L2,6h26L17.591,16.33z M2,8.814 l7.17,7.119L2,21.8V8.814z M2.445,24l8.141-6.661L11,17.75c1.438,1.406,2.281,2.25,4,2.25s2.563-0.844,4-2.25l0.414-0.411L27.555,24 H2.445z M28,21.8l-7.17-5.867L28,8.814V21.8z"})})},22962:(e,t,s)=>{s.d(t,{O:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("mention",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M1 9.86523C1 15.2939 4.72705 18.6807 9.98975 18.6807C11.3511 18.6807 12.4634 18.5312 13.1606 18.2905C13.6919 18.1079 13.8828 17.8174 13.8828 17.4521C13.8828 17.0537 13.6089 16.7715 13.1523 16.7715C13.0195 16.7715 12.8784 16.7881 12.6958 16.8213C11.9238 16.9873 11.2266 17.1118 10.2637 17.1118C5.74805 17.1118 2.74316 14.4058 2.74316 9.91504C2.74316 5.56543 5.61523 2.56055 9.88184 2.56055C13.7417 2.56055 16.7383 4.97607 16.7383 9.11816C16.7383 11.3511 15.9995 12.8452 14.8125 12.8452C14.0239 12.8452 13.5757 12.3472 13.5757 11.4839V6.44531C13.5757 5.84766 13.252 5.49072 12.6709 5.49072C12.0981 5.49072 11.7578 5.84766 11.7578 6.44531V7.10107H11.6333C11.21 6.09668 10.2305 5.49072 9.01855 5.49072C6.90186 5.49072 5.43262 7.28369 5.43262 9.89844C5.43262 12.5547 6.91846 14.3892 9.11816 14.3892C10.3799 14.3892 11.3013 13.7417 11.7578 12.6045H11.8823C12.1147 13.7168 13.0942 14.3809 14.4307 14.3809C16.8877 14.3809 18.3984 12.1895 18.3984 8.96045C18.3984 4.1626 14.8706 1 9.89014 1C4.66064 1 1 4.56104 1 9.86523ZM9.5415 12.7207C8.26318 12.7207 7.46631 11.6499 7.46631 9.92334C7.46631 8.21338 8.27148 7.14258 9.5498 7.14258C10.8364 7.14258 11.6582 8.20508 11.6582 9.89844C11.6582 11.625 10.8281 12.7207 9.5415 12.7207Z"})})},80342:(e,t,s)=>{s.d(t,{$:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("minus",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M3.037 8.844h9.92a.705.705 0 00.368-.103.825.825 0 00.28-.28.73.73 0 000-.773.752.752 0 00-.28-.28.705.705 0 00-.369-.102H3.037a.705.705 0 00-.369.102.824.824 0 00-.28.28.73.73 0 000 .772.914.914 0 00.28.281.705.705 0 00.37.103z"})})},4635:(e,t,s)=>{s.d(t,{W:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("options",{viewBox:"0 0 17 15",svg:(0,n.jsx)("path",{d:"M11.2871 4.48438C12.1309 4.48438 12.8574 3.95312 13.1621 3.21875H15.7324C16.123 3.21875 16.4512 2.875 16.4512 2.46094C16.4512 2.04688 16.123 1.71094 15.7324 1.71094H13.1621C12.8652 0.96875 12.1387 0.4375 11.2871 0.4375C10.4355 0.4375 9.70898 0.96875 9.41211 1.71094H1.04492C0.630859 1.71094 0.302734 2.04688 0.302734 2.46094C0.302734 2.875 0.630859 3.21875 1.04492 3.21875H9.41211C9.7168 3.95312 10.4434 4.48438 11.2871 4.48438ZM11.2871 3.42188C10.748 3.42188 10.3262 2.99219 10.3262 2.46094C10.3262 1.91406 10.748 1.49219 11.2871 1.49219C11.834 1.49219 12.248 1.91406 12.248 2.46094C12.248 2.99219 11.834 3.42188 11.2871 3.42188ZM1.02148 6.58594C0.630859 6.58594 0.302734 6.92188 0.302734 7.33594C0.302734 7.74219 0.630859 8.08594 1.02148 8.08594H3.67773C3.98242 8.83594 4.70898 9.35938 5.56055 9.35938C6.4043 9.35938 7.13086 8.83594 7.43555 8.08594H15.709C16.123 8.08594 16.4512 7.75 16.4512 7.33594C16.4512 6.92188 16.123 6.58594 15.709 6.58594H7.43555C7.13086 5.84375 6.4043 5.32031 5.56055 5.32031C4.70898 5.32031 3.98242 5.84375 3.67773 6.58594H1.02148ZM5.56055 8.30469C5.02148 8.30469 4.5918 7.875 4.5918 7.33594C4.5918 6.78906 5.02148 6.375 5.56055 6.375C6.09961 6.375 6.52148 6.78906 6.52148 7.33594C6.52148 7.875 6.09961 8.30469 5.56055 8.30469ZM11.2871 14.2344C12.1387 14.2344 12.8652 13.7031 13.1621 12.9609H15.7324C16.123 12.9609 16.4512 12.625 16.4512 12.2109C16.4512 11.7891 16.123 11.4609 15.7324 11.4609H13.1621C12.8652 10.7188 12.1387 10.1875 11.2871 10.1875C10.4434 10.1875 9.70898 10.7188 9.41211 11.4609H1.04492C0.630859 11.4609 0.302734 11.7969 0.302734 12.2109C0.302734 12.6172 0.630859 12.9609 1.04492 12.9609H9.41211C9.70898 13.7031 10.4355 14.2344 11.2871 14.2344ZM11.2871 13.1719C10.748 13.1719 10.3262 12.7422 10.3262 12.2109C10.3262 11.6641 10.748 11.25 11.2871 11.25C11.834 11.25 12.248 11.6641 12.248 12.2109C12.248 12.7422 11.834 13.1719 11.2871 13.1719Z"})})},36329:(e,t,s)=>{s.d(t,{_:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("personBadgeExclamationMark",{viewBox:"0 0 24 22",svg:(0,n.jsx)("path",{d:"M14 20.91c1.36 0 2.64-.26 3.838-.781a10.166 10.166 0 003.183-2.158 10.198 10.198 0 002.159-3.174 9.59 9.59 0 00.78-3.848c0-1.36-.263-2.64-.79-3.838a10.165 10.165 0 00-2.158-3.183 10.165 10.165 0 00-3.184-2.158A9.52 9.52 0 0013.99.988c-1.27 0-2.47.228-3.603.684A10.24 10.24 0 007.34 3.566 10.179 10.179 0 005.152 6.39a9.75 9.75 0 00-1.045 3.466c.235-.045.508-.074.82-.087.32-.02.61-.013.87.02.137-1.01.44-1.948.908-2.813A8.088 8.088 0 018.512 4.7a8.261 8.261 0 012.5-1.504 8.095 8.095 0 012.978-.547c1.153 0 2.23.215 3.233.645a8.233 8.233 0 012.646 1.777 8.365 8.365 0 011.787 2.647 8.11 8.11 0 01.645 3.232 8.15 8.15 0 01-2.139 5.557c-.319-.378-.775-.736-1.367-1.074-.593-.345-1.296-.625-2.11-.84-.813-.215-1.712-.322-2.695-.322-.469 0-.918.029-1.347.087-.43.053-.837.124-1.221.215.117.469.176.96.176 1.475 0 .762-.134 1.488-.4 2.178a6.308 6.308 0 01-1.095 1.865c.6.26 1.228.462 1.885.605A9.426 9.426 0 0014 20.91zm-.01-8.3a3.02 3.02 0 001.69-.47 3.53 3.53 0 001.21-1.318c.3-.56.45-1.191.45-1.894 0-.658-.15-1.26-.45-1.807a3.55 3.55 0 00-1.21-1.309 3.035 3.035 0 00-1.69-.488c-.625 0-1.191.163-1.699.489a3.622 3.622 0 00-1.65 3.115c0 .696.15 1.321.449 1.875.3.553.7.993 1.201 1.318a3.194 3.194 0 001.7.488zM5.3 21.017c.67 0 1.305-.13 1.904-.391a5.082 5.082 0 001.582-1.074A5 5 0 009.87 17.97c.26-.6.39-1.237.39-1.914 0-.684-.13-1.325-.39-1.924a4.945 4.945 0 00-1.064-1.582 4.946 4.946 0 00-1.582-1.065 4.772 4.772 0 00-1.924-.39c-.677 0-1.315.13-1.914.39a4.87 4.87 0 00-1.582 1.074A5.082 5.082 0 00.73 14.142a4.707 4.707 0 00-.391 1.914c0 .683.13 1.325.39 1.924a5.07 5.07 0 001.075 1.581c.455.456.983.811 1.582 1.065.599.26 1.237.39 1.914.39zm-.01-1.797a.788.788 0 01-.576-.244.768.768 0 01-.244-.577c0-.227.081-.423.244-.585a.788.788 0 01.576-.245c.234 0 .43.085.586.254a.788.788 0 01.244.576.77.77 0 01-.244.577.8.8 0 01-.586.244zm.01-2.325a.601.601 0 01-.43-.156.613.613 0 01-.166-.41l-.078-2.793a.63.63 0 01.176-.488.673.673 0 01.498-.186.66.66 0 01.488.186.63.63 0 01.176.488l-.078 2.793a.592.592 0 01-.176.41.554.554 0 01-.41.157z"})})},79310:(e,t,s)=>{s.d(t,{A:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("pinStrikethrough",{viewBox:"0 0 15 19",svg:(0,n.jsx)("path",{d:"M3.094 1.328c0 .227.094.492.297.758.398.531 1.343 1.266 2.328 1.914l-.055.86 1.149 1.156.156-2.594c.008-.11-.008-.149-.086-.188-1.172-.601-2.078-1.312-2.14-1.468-.063-.102.007-.164.085-.164h6.68c.086 0 .148.062.086.164-.063.156-.961.867-2.14 1.468-.071.04-.087.079-.079.188l.234 3.875a7.12 7.12 0 00-1.437-.14h-.203l1.203 1.226c2.164.219 3.758 1.984 3.758 3.234 0 .04-.008.078-.008.117l.844.97c.257-.157.468-.477.468-.93 0-1.649-1.32-3.313-3.359-4.11L10.617 4c.992-.648 1.93-1.383 2.336-1.914.203-.266.297-.531.297-.758 0-.476-.367-.828-.914-.828H4.008c-.555 0-.914.352-.914.828zM.367 2.656l14.125 14.11a.603.603 0 00.852 0 .597.597 0 000-.852L1.227 1.804a.606.606 0 00-.86 0 .618.618 0 000 .852zm1.735 9.117c0 .665.445 1.102 1.148 1.102h4.234v3.648c0 1.196.493 2.188.688 2.188.195 0 .687-.992.687-2.188V12.97h.446L8.03 11.695H3.562c-.171 0-.257-.101-.226-.312.094-.875.828-1.805 1.984-2.399l-.82-.82c-1.477.867-2.398 2.234-2.398 3.61z"})})},91192:(e,t,s)=>{s.d(t,{x:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("privateTeam",{viewBox:"0 0 28 28",svg:(0,n.jsx)("path",{d:"M20.6455 21.2744C20.9092 21.5469 21.3311 21.5645 21.6035 21.2744C21.8936 20.9844 21.8672 20.5889 21.6035 20.3164L6.9082 5.62988C6.64453 5.36621 6.21387 5.36621 5.94141 5.62988C5.68652 5.88477 5.68652 6.33301 5.94141 6.58789L20.6455 21.2744ZM13.8076 6.13086C12.2783 6.13086 10.8896 6.39453 9.59766 6.8252L10.7578 7.97656C11.7246 7.68652 12.7178 7.51953 13.8076 7.51953C19.5908 7.51953 24.2754 12.6172 24.2754 13.6631C24.2754 14.375 22.7373 16.291 20.3027 17.7852L21.3838 18.8662C24.1611 17.0645 25.8135 14.7002 25.8135 13.6631C25.8135 11.8613 20.9092 6.13086 13.8076 6.13086ZM13.8076 21.1953C15.4424 21.1953 16.9365 20.9053 18.2988 20.4395L17.1475 19.2881C16.1016 19.6133 14.9941 19.8066 13.8076 19.8066C8.01562 19.8066 3.33105 14.9023 3.33105 13.6631C3.33105 13.0479 4.95703 11 7.5498 9.44434L6.45996 8.35449C3.5332 10.165 1.79297 12.5996 1.79297 13.6631C1.79297 15.4561 6.79395 21.1953 13.8076 21.1953ZM18.3164 15.5879C18.5889 14.999 18.7383 14.3398 18.7383 13.6631C18.7383 10.9121 16.541 8.74121 13.8076 8.74121C13.1133 8.74121 12.4629 8.89062 11.874 9.14551L18.3164 15.5879ZM13.8076 18.585C14.5811 18.585 15.3105 18.3916 15.9609 18.0752L9.36914 11.4834C9.04395 12.1338 8.85938 12.8721 8.85938 13.6631C8.86816 16.3438 11.0566 18.585 13.8076 18.585Z"})})},90028:(e,t,s)=>{s.d(t,{j:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("searchInPage",{viewBox:"0 0 12 14",svg:(0,n.jsx)("path",{d:"M2.877 13.365h6.24c.63 0 1.104-.164 1.424-.492.32-.324.48-.8.48-1.43V6.13c0-.274-.015-.504-.046-.691a1.531 1.531 0 00-.182-.522 2.185 2.185 0 00-.387-.498l-3.07-3.123a2.11 2.11 0 00-.48-.38 1.528 1.528 0 00-.51-.183A3.464 3.464 0 005.7.68H2.877c-.629 0-1.104.164-1.424.492-.32.324-.48.8-.48 1.43v8.841c0 .633.16 1.112.48 1.436.32.324.795.486 1.424.486zm.094-1.154c-.282 0-.492-.072-.633-.217-.14-.144-.211-.351-.211-.621V2.678c0-.27.07-.479.21-.627.142-.149.354-.223.64-.223h2.496V5.04c0 .418.101.73.304.938.207.207.52.31.938.31h3.158v5.086c0 .27-.07.477-.21.621-.142.145-.354.217-.64.217H2.971zm3.855-6.938c-.12 0-.209-.027-.263-.082-.051-.054-.077-.142-.077-.263V1.986l3.229 3.287H6.826z"})})},83065:(e,t,s)=>{s.d(t,{_:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("sendArrow",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M9.79883 18.5894C14.6216 18.5894 18.5894 14.6216 18.5894 9.79883C18.5894 4.96777 14.6216 1 9.79053 1C4.95947 1 1 4.96777 1 9.79883C1 14.6216 4.96777 18.5894 9.79883 18.5894ZM9.79883 14.3062C9.20947 14.3062 8.76953 13.9077 8.76953 13.3433V9.69922L8.86914 8.00586L8.25488 8.84424L7.3916 9.81543C7.23389 10.0063 6.98486 10.1143 6.72754 10.1143C6.21289 10.1143 5.84766 9.75732 5.84766 9.25928C5.84766 8.99365 5.92236 8.79443 6.12158 8.58691L8.96045 5.61523C9.19287 5.35791 9.4585 5.2417 9.79883 5.2417C10.1309 5.2417 10.4048 5.36621 10.6372 5.61523L13.4761 8.58691C13.667 8.79443 13.75 8.99365 13.75 9.25928C13.75 9.75732 13.3848 10.1143 12.8618 10.1143C12.6128 10.1143 12.3638 10.0063 12.2061 9.81543L11.3428 8.86914L10.7202 7.99756L10.8281 9.69922V13.3433C10.8281 13.9077 10.3799 14.3062 9.79883 14.3062Z"})})},87393:(e,t,s)=>{s.d(t,{L:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("settingsIntegration",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M4.633 9.42h3.154c1.093 0 1.632-.532 1.632-1.656V4.655C9.42 3.532 8.88 3 7.787 3H4.633C3.532 3 3 3.532 3 4.655v3.109c0 1.124.532 1.655 1.633 1.655zm7.58 0h3.162C16.468 9.42 17 8.887 17 7.763V4.655C17 3.532 16.468 3 15.374 3h-3.16c-1.094 0-1.633.532-1.633 1.655v3.109c0 1.124.539 1.655 1.633 1.655zm-7.58-1.251c-.262 0-.382-.135-.382-.405V4.648c0-.27.12-.405.382-.405h3.146c.262 0 .39.135.39.405v3.116c0 .27-.128.405-.39.405H4.633zm7.588 0c-.262 0-.39-.135-.39-.405V4.648c0-.27.128-.405.39-.405h3.146c.262 0 .39.135.39.405v3.116c0 .27-.128.405-.39.405h-3.146zM4.633 17h3.154c1.093 0 1.632-.532 1.632-1.655v-3.109c0-1.124-.539-1.655-1.632-1.655H4.633C3.532 10.58 3 11.112 3 12.236v3.109C3 16.468 3.532 17 4.633 17zm7.58 0h3.162C16.468 17 17 16.468 17 15.345v-3.109c0-1.124-.532-1.655-1.626-1.655h-3.16c-1.094 0-1.633.531-1.633 1.655v3.109c0 1.123.539 1.655 1.633 1.655zm-7.58-1.25c-.262 0-.382-.128-.382-.398v-3.116c0-.277.12-.405.382-.405h3.146c.262 0 .39.128.39.405v3.116c0 .27-.128.397-.39.397H4.633zm7.588 0c-.262 0-.39-.128-.39-.398v-3.116c0-.277.128-.405.39-.405h3.146c.262 0 .39.128.39.405v3.116c0 .27-.128.397-.39.397h-3.146z"})})},62397:(e,t,s)=>{s.d(t,{I:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("settingsSecurity",{viewBox:"0 0 11 20",svg:(0,n.jsx)("path",{d:"M4.92129 19.3231C5.26719 19.627 5.74092 19.6649 6.07178 19.3383L8.38779 16.9913C8.71865 16.6571 8.70361 16.1558 8.38027 15.8292L7.2749 14.7127L8.92168 13.0569C9.2375 12.7379 9.22998 12.229 8.90664 11.8948L7.41026 10.3757C9.44805 9.35026 10.5985 7.64127 10.5985 5.62847C10.5985 2.78016 8.32012 0.486328 5.49277 0.486328C2.66543 0.486328 0.394531 2.77257 0.394531 5.62847C0.394531 7.67166 1.54502 9.50217 3.37979 10.3301V17.4622C3.37979 17.7357 3.4625 18.0471 3.69561 18.2446L4.92129 19.3231ZM5.49277 17.9863L4.68066 17.166V9.34266C2.95869 8.9629 1.73301 7.4438 1.73301 5.62847C1.73301 3.53972 3.40986 1.84592 5.49277 1.84592C7.57569 1.84592 9.24502 3.53212 9.24502 5.62847C9.24502 7.42101 8.01181 8.96289 6.13194 9.38824V11.0289L7.57569 12.4872L6.03418 14.0214V15.3887L7.04931 16.3989L5.49277 17.9863ZM5.49277 5.67405C6.23721 5.67405 6.83877 5.06641 6.83877 4.32205C6.83877 3.5777 6.23721 2.97005 5.49277 2.97005C4.74834 2.97005 4.1543 3.5701 4.1543 4.32205C4.1543 5.06641 4.75586 5.67405 5.49277 5.67405Z"})})},73039:(e,t,s)=>{s.d(t,{K:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("settingsWorkspace",{viewBox:"0 0 20 20",svg:(0,n.jsx)("path",{d:"M2.3 15.359c0 .819.463 1.327 1.231 1.327H16.43c.768 0 1.231-.508 1.231-1.327V7.507c0-.825-.463-1.333-1.231-1.333h-3.656V4.327C12.774 3.5 12.31 3 11.536 3H3.53C2.763 3 2.3 3.501 2.3 4.327v11.032zm1.25-.248V4.574c0-.216.108-.324.33-.324h7.313c.216 0 .33.108.33.324v10.537c0 .216-.114.324-.33.324H9.81v-1.834c0-.54-.254-.807-.768-.807H6.032c-.514 0-.768.267-.768.807v1.834H3.881c-.223 0-.33-.108-.33-.324zm1.911-8.118h1.213c.146 0 .247-.102.247-.254V5.564c0-.152-.101-.253-.247-.253H5.46c-.152 0-.247.101-.247.253V6.74c0 .152.095.254.247.254zm2.94 0h1.205c.152 0 .254-.102.254-.254V5.564c0-.152-.101-.253-.254-.253H8.4c-.152 0-.247.101-.247.253V6.74c0 .152.095.254.247.254zm4.373 8.366V7.424h3.307c.222 0 .33.115.33.33v7.357c0 .216-.108.324-.33.324h-3.307v-.076zM5.46 9.417h1.213c.146 0 .247-.101.247-.253V7.989c0-.152-.101-.254-.247-.254H5.46c-.152 0-.247.102-.247.254v1.175c0 .152.095.253.247.253zm2.94 0h1.205c.152 0 .254-.101.254-.253V7.989c0-.152-.101-.254-.254-.254H8.4c-.152 0-.247.102-.247.254v1.175c0 .152.095.253.247.253zm5.687.4h1.003a.2.2 0 00.209-.21V8.63c0-.127-.083-.21-.21-.21h-1.002c-.127 0-.204.083-.204.21v.978c0 .12.077.21.204.21zM5.46 11.842h1.213c.146 0 .247-.101.247-.254v-1.174c0-.152-.101-.254-.247-.254H5.46c-.152 0-.247.102-.247.254v1.174c0 .153.095.254.247.254zm2.94 0h1.205c.152 0 .254-.101.254-.254v-1.174c0-.152-.101-.254-.254-.254H8.4c-.152 0-.247.102-.247.254v1.174c0 .153.095.254.247.254zm5.687.311h1.003a.2.2 0 00.209-.21v-.977c0-.127-.083-.21-.21-.21h-1.002c-.127 0-.204.083-.204.21v.978c0 .12.077.21.204.21zm0 2.336h1.003a.2.2 0 00.209-.21v-.977c0-.127-.083-.21-.21-.21h-1.002c-.127 0-.204.083-.204.21v.978c0 .12.077.21.204.21zm-7.846-.552c0-.133.063-.197.197-.197h2.196c.133 0 .197.064.197.197v1.498h-2.59v-1.498z"})})},2356:(e,t,s)=>{s.d(t,{u:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("showDeletedPages",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M1.89551 8.5498C1.89551 11.9404 4.61621 14.668 8 14.668C11.3838 14.668 14.1045 11.9404 14.1045 8.5498C14.1045 5.16602 11.4043 2.45898 8.02051 2.45898C7.66504 2.45898 7.31641 2.49316 7.01562 2.55469L8.66992 0.920898C8.78613 0.797852 8.85449 0.640625 8.85449 0.462891C8.85449 0.09375 8.56738 -0.207031 8.20508 -0.207031C8.01367 -0.207031 7.84961 -0.138672 7.7334 -0.00878906L4.93066 2.8418C4.79395 2.97852 4.71875 3.15625 4.71875 3.33398C4.71875 3.51855 4.78711 3.68262 4.93066 3.82617L7.7334 6.65625C7.84961 6.7793 8.00684 6.84082 8.20508 6.84082C8.56738 6.84082 8.85449 6.55371 8.85449 6.17773C8.85449 6 8.78613 5.85645 8.66309 5.72656L6.80371 3.88086C7.15234 3.80566 7.56934 3.77148 8.02051 3.77148C10.666 3.77148 12.7646 5.88379 12.7646 8.5498C12.7646 11.2021 10.6455 13.3281 8 13.3281C5.35449 13.3281 3.23535 11.2021 3.23535 8.5498C3.23535 8.14648 2.97559 7.85938 2.5791 7.85938C2.17578 7.85938 1.89551 8.14648 1.89551 8.5498Z"})})},50226:(e,t,s)=>{s.d(t,{I:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("sidebarTemplates",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.237 1l7.84 1.237-1.201 7.61L11.5 6.15 9.424 9.38 6 8.84 7.237 1zM5.545 5.31a4 4 0 1 0 2.29 4.832l-2.979-.47.689-4.363zM7 15l4.5-7 4.5 7H7z"})})},95094:(e,t,s)=>{s.d(t,{p:()=>a});s(67294);var i=s(45238),n=s(85893);const a=(0,i.I)("starFilled",{viewBox:"0 0 24 24",svg:(0,n.jsx)("path",{d:"M4.603 22.837c.375.277.826.2 1.4-.22l6.002-4.411 6.003 4.41c.561.42 1.024.498 1.387.221.375-.276.463-.73.232-1.403l-2.346-7.075 6.047-4.366c.572-.41.77-.83.627-1.271-.143-.432-.55-.653-1.255-.653l-7.424.045-2.269-7.108C12.787.32 12.457 0 12.005 0c-.463 0-.782.32-1.002 1.006l-2.27 7.108-7.423-.045c-.716 0-1.123.221-1.266.653-.144.442.066.862.638 1.27l6.036 4.367-2.335 7.075c-.231.674-.143 1.127.22 1.403z"})})},33676:(e,t,s)=>{s.d(t,{A:()=>o});s(67294);var i=s(45238),n=s(39986),a=s(85893);const o=(0,i.I)("thumbDown",{viewBox:"0 0 18 19",svg:(0,a.jsx)("g",{transform:"rotate(180 9 9.5)",children:n.f})})},97022:(e,t,s)=>{s.d(t,{E:()=>o});s(67294);var i=s(45238),n=s(10498),a=s(85893);const o=(0,i.I)("thumbDownFilled",{viewBox:"0 0 16 18",svg:(0,a.jsx)("g",{transform:"rotate(180 8 9)",children:n.O})})},39986:(e,t,s)=>{s.d(t,{P:()=>a,f:()=>n});s(67294);var i=s(45238);const n=(0,s(85893).jsx)("path",{d:"M0.539062 12.3125C0.539062 15.0547 2.29688 17.3125 4.54688 17.3125H7.11719C8.17188 17.8516 9.42188 18.1641 10.8047 18.1641H11.8906C12.9062 18.1641 13.7734 18.1016 14.3359 17.9609C15.4766 17.6797 16.1953 16.8672 16.1953 15.8516C16.1953 15.6641 16.1719 15.5 16.1172 15.3281C16.6562 14.9141 16.9609 14.2969 16.9609 13.6328C16.9609 13.3203 16.8984 13.0078 16.7891 12.7578C17.1484 12.375 17.3594 11.8203 17.3594 11.25C17.3594 10.875 17.2656 10.4922 17.1094 10.2031C17.3281 9.86719 17.4531 9.42188 17.4531 8.9375C17.4531 7.69531 16.5078 6.73438 15.2734 6.73438H12.3672C12.1953 6.73438 12.0859 6.65625 12.0938 6.50781C12.1328 5.69531 13.4062 3.75781 13.4062 2.17188C13.4062 1.01562 12.5859 0.171875 11.4688 0.171875C10.6484 0.171875 10.0859 0.59375 9.55469 1.61719C8.58594 3.48438 7.40625 5.125 5.65625 7.28125H4.25C2.14844 7.28125 0.539062 9.52344 0.539062 12.3125ZM5.375 12.25C5.375 10.5938 5.75 9.53125 6.80469 8.11719C7.99219 6.53125 9.625 4.63281 10.8125 2.27344C11.0625 1.77344 11.2344 1.64844 11.4844 1.64844C11.7891 1.64844 11.9844 1.86719 11.9844 2.25C11.9844 3.42188 10.6641 5.35156 10.6641 6.61719C10.6641 7.55469 11.4219 8.15625 12.4375 8.15625H15.2422C15.7031 8.15625 16.0391 8.5 16.0391 8.95312C16.0391 9.28125 15.9297 9.5 15.6562 9.76562C15.4609 9.96875 15.4375 10.25 15.6094 10.4453C15.8359 10.7734 15.9375 10.9844 15.9375 11.25C15.9375 11.5781 15.7812 11.8516 15.4609 12.0938C15.2031 12.2812 15.1094 12.5859 15.2656 12.8828C15.4297 13.2109 15.5156 13.3672 15.5156 13.6172C15.5156 14 15.2734 14.2891 14.7812 14.5469C14.5312 14.6875 14.4609 14.9531 14.5703 15.1875C14.7344 15.5938 14.7578 15.6641 14.7578 15.8438C14.7578 16.1797 14.5078 16.4531 13.9766 16.5859C13.5156 16.7031 12.7812 16.75 11.8203 16.7422L10.8125 16.7344C7.57031 16.7031 5.375 14.8828 5.375 12.25ZM1.9375 12.3125C1.9375 10.3281 2.96094 8.73438 4.14062 8.6875C4.34375 8.6875 4.55469 8.6875 4.75781 8.6875C4.20312 9.76562 3.95312 10.8984 3.95312 12.25C3.95312 13.6875 4.46094 14.9531 5.375 15.9453C5.07812 15.9453 4.76562 15.9375 4.46875 15.9375C3.10156 15.8906 1.9375 14.2812 1.9375 12.3125Z"}),a=(0,i.I)("thumbUp",{viewBox:"0 0 18 19",svg:n})},10498:(e,t,s)=>{s.d(t,{O:()=>n,w:()=>a});s(67294);var i=s(45238);const n=(0,s(85893).jsx)("path",{d:"M4 12.1875C3.99219 15.1641 6.34375 17.4297 10.0859 17.4375H11.1719C12.1953 17.4375 12.9766 17.3594 13.4297 17.2422C14.1016 17.0781 14.7031 16.6562 14.7031 15.8828C14.7031 15.5859 14.625 15.3594 14.5312 15.1875C14.4766 15.1016 14.4922 15.0234 14.5703 14.9922C15.0859 14.7578 15.4766 14.2812 15.4766 13.6562C15.4766 13.2969 15.375 12.9766 15.2031 12.75C15.125 12.6406 15.1406 12.5469 15.2656 12.4766C15.625 12.25 15.875 11.7891 15.875 11.2656C15.875 10.8828 15.7578 10.4844 15.5547 10.2812C15.4453 10.1797 15.4609 10.1094 15.5781 10.0156C15.8281 9.78906 15.9844 9.41406 15.9844 8.96094C15.9844 8.15625 15.3516 7.5 14.5234 7.5H11.7031C11.0234 7.5 10.5781 7.15625 10.5781 6.60156C10.5781 5.54688 11.9141 3.57812 11.9141 2.14844C11.9141 1.375 11.4219 0.90625 10.75 0.90625C10.1641 0.90625 9.85938 1.28906 9.53125 1.9375C8.33594 4.24219 6.75781 6.11719 5.54688 7.72656C4.49219 9.11719 4.00781 10.3125 4 12.1875ZM0.015625 12.25C0.015625 14.6719 1.52344 16.6719 3.53125 16.6719H4.89062C3.47656 15.5938 2.85156 13.9922 2.86719 12.1719C2.875 10.2031 3.57812 8.77344 4.32031 7.79688H3.23438C1.41406 7.79688 0.015625 9.75 0.015625 12.25Z"}),a=(0,i.I)("thumbUpFilled",{viewBox:"0 0 16 18",svg:n})},39248:(e,t,s)=>{s.d(t,{E:()=>r});var i=s(4615),n=s(89101),a=s(64002);function o(e,t){const s=t.trim().toLowerCase(),i=(0,a.Of)(s).replace(/\./g,"-");return i?`${i}-${e}`:e}function r(e,t){if(!(0,i.e)(e))return`${n._j.integrations}/${e}`;const s=o(e,void 0===t?"":t);return`${n._j.integrations}/${s}`}},57222:(e,t,s)=>{s.d(t,{t:()=>i});const i=e=>({"en-US":{label:"English",caption:e.formatMessage({defaultMessage:"English (US)",id:"languagePicker.captions.englishUS"})},"de-DE":{label:"Deutsch",caption:e.formatMessage({defaultMessage:"German",id:"languagePicker.captions.germanDE"})},"ko-KR":{label:"한국어",caption:e.formatMessage({defaultMessage:"Korean",id:"languagePicker.captions.koreanKo"})},"zh-CN":{label:"简体中文",caption:e.formatMessage({defaultMessage:"Simplified Chinese",id:"languagePicker.captions.chineseS"})},"zh-TW":{label:"繁體中文",caption:e.formatMessage({defaultMessage:"Traditional Chinese",id:"languagePicker.captions.chineseT"})},"ja-JP":{label:"日本語",caption:e.formatMessage({defaultMessage:"Japanese",id:"languagePicker.captions.japaneseJa"})},"es-ES":{label:"Español (España)",caption:e.formatMessage({defaultMessage:"Spanish (Spain)",id:"languagePicker.captions.spanishEs"})},"es-LA":{label:"Español (Latinoamérica)",caption:e.formatMessage({defaultMessage:"Spanish (Latin America)",id:"languagePicker.captions.spanishLatam"})},"pt-BR":{label:"Português (Brasil)",caption:e.formatMessage({defaultMessage:"Portuguese (Brazil)",id:"languagePicker.captions.portugueseBr"})},"fr-FR":{label:"Français (France)",caption:e.formatMessage({defaultMessage:"French",id:"languagePicker.captions.frenchFr"})},"da-DK":{label:"Dansk",caption:e.formatMessage({defaultMessage:"Danish",id:"languagePicker.captions.danishDk"})},"fi-FI":{label:"Suomi",caption:e.formatMessage({defaultMessage:"Finnish",id:"languagePicker.captions.finnishFi"})},"nb-NO":{label:"Norsk",caption:e.formatMessage({defaultMessage:"Norwegian",id:"languagePicker.captions.norwegianNo"})},"nl-NL":{label:"Nederlands",caption:e.formatMessage({defaultMessage:"Dutch",id:"languagePicker.captions.dutchNl"})},"sv-SE":{label:"Svenska",caption:e.formatMessage({defaultMessage:"Swedish",id:"languagePicker.captions.swedishSe"})},pseudo:{label:"🤡Pseudolocale🤡",caption:e.formatMessage({defaultMessage:"Pseudolocale",id:"languagePicker.captions.pseudolocale"})}})},45168:(e,t,s)=>{s.d(t,{e:()=>n});var i=s(92338);function n(e){if(e)return e.sources.includes(i.vp.ElasticsearchUniqueID)}},68120:(e,t,s)=>{s.d(t,{Qr:()=>m});s(21703);var i=s(97880),n=s(63143),a=s(74487);const o=Symbol("JSON Schema"),r=Symbol("JSON Schema Components"),l=Symbol("No JSON Schema"),d={isNull:()=>({type:"null",[r]:{}}),boolean:()=>({type:"boolean",[r]:{}}),number:()=>({type:"number",[r]:{}}),integer:()=>({type:"integer",[r]:{}}),string:()=>({type:"string",[r]:{}}),dateString:()=>({type:"string",format:"date",[r]:{}}),literal:e=>({enum:[e],[r]:{}}),literals:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return{enum:t,[r]:{}}},uuid:()=>({type:"string",format:"uuid",[r]:{}}),uuidWithoutDashes:()=>({type:"string",format:"uuid",[r]:{}}),any:()=>u,array:e=>({type:"array",items:e[o],[r]:e[o][r]}),tuple:e=>({type:"tuple",items:!1,prefixItems:e.map((e=>e[o])).filter((e=>e!==l)),[r]:Object.assign({},...e.map((e=>e[o][r])))}),record:(e,t)=>({type:"object",additionalProperties:t[o],[r]:t[o][r]}),object:e=>{let{required:t,optional:s,exact:i}=e;return{type:"object",properties:(0,n.m8)(Object.entries({...t,...s}).filter((e=>{let[t,s]=e;return s[o]!==l})).map((e=>{let[t,s]=e;return[t,s[o]]}))),...i&&{additionalProperties:!1},...Object.keys(t).length>0&&{required:Object.keys(t)},[r]:Object.assign({},...Object.values({...t,...s}).map((e=>e[o][r])))}},union:e=>({anyOf:e.map((e=>e[o])).filter((e=>e!==l)),[r]:Object.assign({},...e.map((e=>e[o][r])))}),gte:(e,t)=>{const s=e[o];return s!==l?{...s,minimum:t}:s},lte:(e,t)=>{const s=e[o];return s!==l?{...s,maximum:t}:s},maxLength:(e,t)=>{const s=e[o];if(s===l)return s;if("type"in s){if("string"===s.type)return{...s,maxLength:t};if("array"===s.type)return{...s,maxItems:t}}throw new Error("Unknown type for max length.")},minLength:(e,t)=>{const s=e[o];if(s===l)return s;if("type"in s){if("string"===s.type)return{...s,minLength:t};if("array"===s.type)return{...s,minItems:t}}throw new Error("Unknown type for min length.")},nonEmpty:e=>{const t=e[o];if(t===l)return t;if("type"in t){if("string"===t.type)return{...t,minLength:1};if("object"===t.type)return{...t,minProperties:1};if("array"===t.type)return{...t,minItems:1}}throw new Error("Unknown non-emptyable type.")},nullable:e=>{const t=e[o];if(t===l)return t;if("type"in t)if(Array.isArray(t.type)){if("null"===t.type[1])return t;(0,i.t1)(t.type[1])}else{if("string"===t.type)return{...t,type:[t.type,"null"]};if("object"===t.type)return{...t,type:[t.type,"null"]};if("array"===t.type)return{...t,type:[t.type,"null"]};if("tuple"===t.type)return{...t,type:[t.type,"null"]};if("boolean"===t.type)return{...t,type:[t.type,"null"]};if("integer"===t.type)return{...t,type:[t.type,"null"]};if("number"===t.type)return{...t,type:[t.type,"null"]};if("null"===t.type)return t;(0,i.t1)(t.type)}else{if("const"in t)return{...t,enum:[t.const,null]};if("enum"in t)return{...t,enum:[...t.enum,null]};if("anyOf"in t)return{...t,anyOf:t.anyOf.map((e=>d.nullable({[o]:e})))};if("$ref"in t)return{anyOf:[t,{type:"null"}],[r]:t[r]};if(m(t))return t;(0,i.t1)(t)}}},c=(0,n.m8)(Object.entries(d).map((e=>{let[t,s]=e;return[t,function(){for(var e=arguments.length,n=new Array(e),l=0;l<e;l++)n[l]=arguments[l];return 1===n.length&&(0,i.Kn)(n[0])&&("id"in n[0]||"description"in n[0])?function(){const{description:e,examples:i,id:l}=n[0];let d={description:e,...i&&{examples:i},...s(...arguments)};return l&&(d={$ref:`#/components/schemas/${l}`,[r]:{...d[r],[l]:d}}),{[o]:d,...a[t](...arguments)}}:{[o]:s(...n),...a[t](...n)}}]}))),u=(Symbol("Exact empty object ({})"),c.object({id:"emptyObject"})({required:{},optional:{},exact:!0}),{});function m(e){return(0,i.Kn)(e)&&0===Object.keys(e).length}}}]);