"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1216],{45800:(e,t,a)=>{a.d(t,{u:()=>o});a(67294);var s=a(24405),i=a(89024),n=a(68785),r=a(85893);function l(e){window.__c={n:"FullScreenLoader"};const{isVisible:t}=e,a=(0,s.yK)((()=>({hidden:{opacity:0,transition:"opacity 0.3s ease-in-out"},spinner:{width:24,height:24},visible:{opacity:1,transition:"opacity 0.3s ease-in-out"}})),[]);return(0,r.jsx)(i.j,{width:"fill",height:"fill",padding:48,align:"center",style:t?a.visible:a.hidden,children:(0,r.jsx)(n.Z,{style:a.spinner})})}function o(e){return(0,r.jsx)(l,{isVisible:e})}},16100:(e,t,a)=>{a.r(t),a.d(t,{getStripe:()=>v,injectStripe:()=>f,paymentIntentRequiresPaymentMethod:()=>C,translateStripeError:()=>M,useElementsOptions:()=>y});var s=a(86664),i=a(97894),n=a(67294),r=a(86628),l=a(24405),o=a(24211),d=a(97880),c=a(82990),u=a(50906),p=a(95477),g=a(80444),m=a(70060),h=a(85893);let b=null;function f(e){return t=>{const[a]=n.useState(v);return(0,h.jsx)(s.Elements,{stripe:a,children:(0,h.jsx)(s.ElementsConsumer,{children:a=>{let{stripe:s,elements:i}=a;const n={...t,stripe:s,elements:i};return(0,h.jsx)(e,{...n})}})})}}async function v(){return b||(i.loadStripe.setLoadParameters({advancedFraudSignals:!1}),b=(0,i.loadStripe)(p.default.stripe.key)),b}function x(e){switch(e){case"en-US":return"en";case"ko-KR":return"ko";case"ja-JP":return"ja";case"fr-FR":return"fr-FR";case"de-DE":return"de";case"es-ES":return"es-ES";case"es-LA":return"es-419";case"pt-BR":return"pt-BR";case"zh-CN":return"zh";case"zh-TW":return"zh-TW";case"da-DK":return"da";case"nl-NL":return"nl";case"fi-FI":return"fi";case"nb-NO":return"nb";case"sv-SE":return"sv";default:return"auto"}}function y(e){const t=(0,l.Fg)(),{type:a}=e,s="setup"===a||"subscription"===a?e.currency:void 0,i="subscription"===a?e.amount:void 0,[u,p]=(0,r.VK)((()=>{var e;const t=(null===(e=g.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)||o.al;return[m.rR(),t]}),[]);return(0,n.useMemo)((()=>{const e="dark"===t.mode,n={appearance:{labels:"floating",variables:{spacingGridRow:"8px",colorPrimary:t.blueColor,colorText:t.regularTextColor,colorTextPlaceholder:e?"#5A5A5A":"#ACABA9",fontFamily:c.Z.baseFontFamily.sans,borderRadius:"4px"},rules:{".Input":{display:"flex",alignItems:"center",width:"100%",fontSize:"14px",lineHeight:"20px",letterSpacing:"-0.154px",padding:"3px 6px",height:"40px",boxShadow:"none",backgroundColor:e?"#262626":"#F9F9F8",borderWidth:"1px",borderStyle:"solid",borderColor:e?"#1C1C1C":"rgba(227,226,224,0.5)",cursor:"text",color:e?"#E1E1E1":"#1D1B16"},".Label":{fontSize:"14px",color:e?"#5A5A5A":"#ACABA9"},".Label--resting":{fontSize:"14px",lineHeight:"140%",letterSpacing:"-0.154px",color:e?"#5A5A5A":"#ACABA9"},".Label--floating":{fontSize:"10px",fontWeight:"600",lineHeight:"13px",letterSpacing:"0.12px",marginTop:"4px",transition:"all 200ms ease"}}},locale:x(p)};switch(a){case"address":return n;case"setup":return u?{...n,currency:null==s?void 0:s.toLowerCase(),mode:"setup",paymentMethodCreation:"manual"}:{};case"subscription":return u?{...n,amount:i,currency:null==s?void 0:s.toLowerCase(),mode:"subscription",paymentMethodCreation:"manual",setupFutureUsage:"off_session"}:{};default:(0,d.t1)(a)}}),[t,a,i,s,p,u])}function M(e,t,a){if(!a.code)return a.message||"";switch(u._qN(e,{error:a.code,stripe_decline_code:a.decline_code}),a.code){case"invalid_expiry_year_past":return t.formatMessage({id:"stripeHelpers.invalidExpiryYear.error.message",defaultMessage:"Your card's expiration year is in the past."});case"invalid_cvc":return t.formatMessage({id:"stripeHelpers.invalidCVC.error.message",defaultMessage:"Your card's security code is invalid."});case"invalid_number":return t.formatMessage({id:"stripeHelpers.invalidNumber.error.message",defaultMessage:"Your card number is not a valid credit card number."});case"card_declined":return function(e,t){switch(t){case"expired_card":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.expiredCard",defaultMessage:"Your card was declined because it is an expired card."});case"incorrect_number":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.incorrectNumber",defaultMessage:"Your card was declined because you input an incorrect number."});case"insufficient_funds":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.declinedFunds",defaultMessage:"Your card was declined because of insufficient funds."});case"invalid_cvc":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidCvc",defaultMessage:"Your card was declined because you input an invalid CVC number"});case"invalid_amount":return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message.invalidAmount",defaultMessage:"Your card was declined because payment amount exceeds the amount that's allowed."});default:return e.formatMessage({id:"stripeHelpers.cardDeclined.error.message",defaultMessage:"Your card was declined."})}}(t,a.decline_code);default:return a.message||""}}function C(e){let{status:t}=e;return["requires_payment_method","requires_source"].includes(t)}},93349:(e,t,a)=>{a.d(t,{Z:()=>n});var s=a(49085);class i extends s.default{getInitialState(){return{billingEventsLimit:20,billingEvents:[]}}}const n=i},64251:(e,t,a)=>{a.d(t,{Z:()=>n});var s=a(49085);class i extends s.default{getInitialState(){return{churnSurveyModalOpen:!1,page:"default"}}}const n=i},9375:(e,t,a)=>{a.r(t),a.d(t,{BillingModalContent:()=>m,BillingSidebarButton:()=>_,showAddressModal:()=>R,showBilling:()=>V,showEmailModal:()=>H,showPaymentMethodModal:()=>Y,showVatIdModal:()=>q});var s=a(67294),i=a(480),n=a(78780),r=a(33218),l=a(86628),o=a(3791),d=a(80444),c=a(85703),u=a(38524);function p(){var e;const t=(0,l.VK)((()=>d.default.state.currentSpaceStore),[]),a=(0,l.VK)((()=>c.Z.state.data),[]),s=(0,u.f)();if(!s||!t)return;const i="unsubscribed_admin"===s.type&&s.customerData&&(0,o.E3)(s.customerData.stripe.addOns),n="subscribed_admin"===s.type||i,r=n?null===(e=s.customerData)||void 0===e?void 0:e.stripe:void 0;return r&&n?{spaceStore:t,upcomingInvoiceData:a,subscriptionData:s,customerData:r}:void 0}var g=a(85893);function m(){window.__c={n:"BillingModalContent"},(0,r.h)();const{isMobile:e}=(0,i.Fy)(),t=p();return t?(0,g.jsx)("div",{style:{padding:e?16:48},children:(0,g.jsx)(n.Z,{spaceStore:t.spaceStore,subscriptionData:t.subscriptionData,upcomingInvoiceData:t.upcomingInvoiceData,customerData:t.customerData})}):null}var h=a(24405),b=a(15967),f=a(5366),v=a(64921),x=a(14694),y=a(69098),M=a(7184),C=a(45800),S=a(13460),j=a(77907);const w=(0,j.lazyComponent)(j.deps.payments,(e=>e.BillingModalContent));function B(e){const{isOpen:t,onClosed:a,onDismiss:s}=e;return(0,g.jsx)(M.c,{isOpen:t,onClosed:a,onDismiss:s,areaConstraint:{height:{scroll:!0},width:{min:1e3}},children:(0,g.jsx)(S.a5,{title:(0,g.jsx)(f.FormattedMessage,{defaultMessage:"Billing",id:"subscription.billing.title"}),children:(0,g.jsx)(w,{renderLoading:C.u})})})}async function V(){return await y.o.showAsyncModalComponent(B)}function _(){window.__c={n:"BillingSidebarButton"};const e=(0,h.yK)((e=>({icon:{fill:e.mediumIconColor,width:16}})),[]),{isMobile:t}=(0,i.Fy)();return p()?(0,g.jsx)(v.Z,{mobileFeedback:t,onClick:V,children:(0,g.jsx)(x.Z,{left:(0,b.J)(e.icon),disableMobileBorder:!0,children:(0,g.jsx)(f.FormattedMessage,{id:"billingSidebarButton.title",defaultMessage:"Billing"})})}):null}var F=a(86664),D=a(19234),A=a(89024),L=a(44342),E=a(7124),T=a(16100);function I(e){window.__c={n:"AddressElementWrapper"};const{defaultValue:t,onChange:a}=e,i=(0,s.useCallback)((e=>{const{name:t,address:s}=e.value;a({name:t,businessName:"",addressLine1:s.line1??"",addressLine2:s.line2??"",city:s.city??"",state:s.state??"",zipCode:s.postal_code??"",country:s.country??""})}),[a]);return(0,g.jsx)(F.AddressElement,{options:{mode:"billing",defaultValues:{name:null==t?void 0:t.name,address:{line1:null==t?void 0:t.addressLine1,line2:null==t?void 0:t.addressLine2,city:null==t?void 0:t.city,state:null==t?void 0:t.state,postal_code:null==t?void 0:t.zipCode,country:null==t?void 0:t.country}}},onChange:i})}function k(e){window.__c={n:"AddressModalContent"};const{defaultValue:t,onAccept:a}=e,[i,n]=(0,s.useState)(!1),[r,l]=(0,s.useState)(t??{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""}),o=(0,T.useElementsOptions)({type:"address"}),d=(0,s.useCallback)((()=>{r&&(0,D.A)(r)?a(r):n(!0)}),[a,r]);return(0,g.jsx)(L.sR,{showDismissButton:!1,header:(0,g.jsx)(E.q,{styleName:"Heading-17px/Medium",children:(0,g.jsx)(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeYourAddressModal.title",defaultMessage:"Change your address"})}),footer:(0,g.jsx)(L.a6,{layout:"horizontal-right",primaryButton:{buttonType:"primary",label:(0,g.jsx)(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingAddressModal.updateButton.label",defaultMessage:"Update"}),onClick:d},secondaryButton:{buttonType:"dismiss"}}),children:(0,g.jsx)(F.Elements,{stripe:(0,T.getStripe)(),options:o,children:(0,g.jsxs)(A.j,{gap:20,children:[(0,g.jsx)(I,{defaultValue:r,onChange:l}),i?(0,g.jsx)(E.q,{styleName:"Body-12px/Regular",colorName:"red",children:(0,g.jsx)(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.address.invalidError",defaultMessage:"Your address is invalid. Please update your address so we can process your payment."})}):null]})})})}async function R(e){const{defaultValue:t}=e;return await y.o.showAsyncModal((e=>(0,g.jsx)(M.c,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,animateSizeTransition:!1,areaConstraint:{width:{min:500,max:500}},children:(0,g.jsx)(k,{defaultValue:t,onAccept:e.resolve})})))}var P=a(74194);function Z(e){window.__c={n:"EmailModalContent"};const{defaultValue:t,onAccept:a}=e,[i,n]=(0,s.useState)(t??""),r=(0,s.useCallback)((()=>a(i)),[a,i]);return(0,g.jsx)(L.sR,{showDismissButton:!1,header:(0,g.jsx)(E.q,{styleName:"Heading-17px/Medium",children:(0,g.jsx)(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingEmailModal.title",defaultMessage:"Change billing email"})}),footer:(0,g.jsx)(L.a6,{layout:"horizontal-right",primaryButton:{buttonType:"primary",label:(0,g.jsx)(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeBillingEmailModal.updateButton.label",defaultMessage:"Update"}),onClick:r},secondaryButton:{buttonType:"dismiss"}}),children:(0,g.jsx)(P.Z,{focus:!0,selectAll:!0,value:i,onChange:e=>n(e.target.value),onSubmit:r})})}async function H(e){const{defaultValue:t}=e;return await y.o.showAsyncModal((e=>(0,g.jsx)(M.c,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,areaConstraint:{width:{min:500,max:500}},children:(0,g.jsx)(Z,{defaultValue:t,onAccept:e.resolve})})))}var O=a(47307),N=a(23412),z=a(33493);function K(e){window.__c={n:"PaymentMethodModalContent"};const{onAccept:t}=e,a=(0,i.O7)(),s=(0,f.useIntl)(),n=(0,l.VK)((()=>z.Z.selectedCurrencyCode),[]),r=T.useElementsOptions({type:"setup",currency:n});return(0,g.jsx)(F.Elements,{stripe:T.getStripe(),options:r,children:(0,g.jsx)(F.ElementsConsumer,{children:e=>{let{elements:i,stripe:n}=e;return(0,g.jsx)(L.sR,{showDismissButton:!1,header:(0,g.jsx)(E.q,{styleName:"Heading-17px/Medium",children:(0,g.jsx)(f.FormattedMessage,{id:"paymentMethodModalContent.title",defaultMessage:"Change your payment method"})}),footer:(0,g.jsx)(L.a6,{layout:"horizontal-right",primaryButton:{buttonType:"primary",label:(0,g.jsx)(f.FormattedMessage,{id:"paymentMethodModalContent.update",defaultMessage:"Update"}),onClick:async()=>{if(!i||!n)return;const{error:e}=await i.submit();if(e)return;const{error:r,paymentMethod:l}=await n.createPaymentMethod({elements:i});r?O.deprecatedShowErrorMessage(T.translateStripeError(a,s,r)):l&&t(l)}},secondaryButton:{buttonType:"dismiss"}}),children:(0,g.jsx)(N.n,{})})}})})}async function Y(){return await y.o.showAsyncModal((e=>(0,g.jsx)(M.c,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,animateSizeTransition:!1,areaConstraint:{width:{min:500,max:500}},children:(0,g.jsx)(K,{onAccept:e.resolve})})))}function W(e){window.__c={n:"VatIdModalContent"};const{defaultValue:t,onAccept:a}=e,[i,n]=(0,s.useState)(t??""),r=(0,s.useCallback)((()=>a(i)),[a,i]);return(0,g.jsx)(L.sR,{showDismissButton:!1,header:(0,g.jsx)(E.q,{styleName:"Heading-17px/Medium",children:(0,g.jsx)(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeVATIDModal.title",defaultMessage:"Change VAT/GST number"})}),footer:(0,g.jsx)(L.a6,{layout:"horizontal-right",primaryButton:{buttonType:"primary",label:(0,g.jsx)(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeVATIDModal.updateButton.label",defaultMessage:"Update"}),onClick:r},secondaryButton:{buttonType:"dismiss"}}),children:(0,g.jsxs)(A.j,{width:"fill",gap:6,children:[(0,g.jsx)(P.Z,{focus:!0,selectAll:!0,value:i,onChange:e=>n(e.target.value),onSubmit:r}),(0,g.jsx)(E.q,{styleName:"Body-12px/Regular",colorName:"secondary",children:(0,g.jsx)(f.FormattedMessage,{id:"spaceSubscriptionBillingV2.changeVATIDModal.subtitle",defaultMessage:"Please include your country code"})})]})})}async function q(e){const{defaultValue:t}=e;return await y.o.showAsyncModal((e=>(0,g.jsx)(M.c,{isOpen:e.isOpen,onDismiss:e.onDismiss,onClosed:e.onClosed,areaConstraint:{width:{min:500,max:500}},children:(0,g.jsx)(W,{defaultValue:t,onAccept:e.resolve})})))}},23412:(e,t,a)=>{a.d(t,{n:()=>u});var s=a(86664),i=(a(67294),a(86628)),n=a(5366),r=a(89024),l=a(80444),o=a(27242),d=a(37014),c=a(85893);function u(){window.__c={n:"PaymentFields"};const e=(0,i.VK)((()=>{var e;return null===(e=l.default.state.currentUserStore)||void 0===e?void 0:e.getEmail()}),[]),t={};return e&&(t.defaultValues={email:e}),(0,c.jsxs)(r.j,{gap:24,children:[(0,c.jsx)(d.x,{label:(0,c.jsx)(n.FormattedMessage,{id:"checkoutPaymentField.billedTo.title",defaultMessage:"Billed to"}),children:(0,c.jsx)(s.LinkAuthenticationElement,{options:t})}),(0,c.jsx)(d.x,{label:(0,c.jsx)(n.FormattedMessage,{id:"checkoutPaymentField.paymentDetails.title",defaultMessage:"Payment details"}),children:(0,c.jsx)(s.PaymentElement,{onChange:()=>{o.Z.update((e=>{if(!e.open)return e;const{paymentData:t,...a}=e;return a}))}})})]})}},31796:(e,t,a)=>{a.d(t,{V:()=>u});a(67294);var s=a(13991),i=a(24405),n=a(7057),r=a(5366),l=a(23189),o=a(71552),d=a(27533),c=a(85893);function u(e){window.__c={n:"BillingHistory"};const{spaceStore:t,events:a,upcomingInvoiceData:u}=e,p=(0,i.yK)((e=>({emptyList:{color:e.mediumTextColor,fontSize:14},header:{marginBottom:4}})),[]),g=t.id,m=u?`/invoice/upcoming?spaceId=${g}`:void 0,h=0===a.length&&!m;return(0,c.jsxs)("div",{style:{marginTop:40},children:[(0,c.jsx)(l.Z,{large:!0,divider:"full",style:p.header,children:(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBillingV2.invoices",defaultMessage:"Invoices"})}),h?(0,c.jsx)("div",{style:p.emptyList,children:(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.noInvoicesMessage",defaultMessage:"This workspace has no payments yet."})}):null,m?(0,c.jsx)(o.J,{mainLabel:(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBillingV2.upcomingInvoice",defaultMessage:"Upcoming invoice"}),button:{label:(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBillingV2.viewInvoice",defaultMessage:"View invoice"}),onClick:()=>{window.open(m,"_blank")}}}):null,a.map((e=>{const t=(0,n.Yx)(e.timestamp,"long",s.SP);let a;a="paid"===e.status?e.total<0?(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.credited",defaultMessage:"Credited"}):(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.paid",defaultMessage:"Paid"}):e.attempted?(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.failed",defaultMessage:"Failed"}):(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBilling.invoicesSection.invoiceStatus.due",defaultMessage:"Due"});const i=(0,c.jsx)(d.W,{cost:{amount:e.total,currencyCode:e.currencyCode},trailingZeroDisplay:"stripIfInteger"});return(0,c.jsx)(o.J,{mainLabel:t,valueLabel:(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBillingV2.invoiceSummary",defaultMessage:"{invoiceStatus} · {formattedAmount}",values:{invoiceStatus:a,formattedAmount:i}}),button:{label:(0,c.jsx)(r.FormattedMessage,{id:"spaceSubscriptionBillingV2.viewInvoice",defaultMessage:"View invoice"}),onClick:()=>{const t=`/invoice/${e.id}`;window.open(t,"_blank")}}},e.id)}))]})}},71552:(e,t,a)=>{a.d(t,{J:()=>l});a(67294);var s=a(480),i=a(24405),n=a(63296),r=a(85893);function l(e){window.__c={n:"BillingRow"};const{mainLabel:t,valueLabel:a,metadataLabel:l,button:o}=e,{isMobile:d}=(0,s.Fy)(),c=(0,i.yK)((e=>({row:{display:"flex",alignItems:"center",gap:40,padding:"11px 0",borderBottom:`1px solid ${e.regularDividerColor}`},labelArea:{flex:1,display:"flex",flexDirection:"column",gap:6},mainLabel:{fontWeight:400,fontSize:14,lineHeight:"17px",letterSpacing:"-0.154px"},valueLabel:{fontWeight:400,fontSize:12,lineHeight:"14px",color:e.mediumTextColor},metadataLabel:{fontSize:12,lineHeight:"14px",textAlign:"right",color:e.mediumTextColor},buttonArea:{},button:{minWidth:144}})),[]);return(0,r.jsxs)("div",{style:c.row,children:[(0,r.jsxs)("div",{style:c.labelArea,children:[(0,r.jsx)("div",{style:c.mainLabel,children:t}),(0,r.jsx)("div",{style:c.valueLabel,children:d?l:a})]}),l&&!d?(0,r.jsx)("div",{style:c.metadataLabel,children:l}):null,o?(0,r.jsx)("div",{style:c.buttonArea,children:(0,r.jsx)(n.Z,{isLarge:!0,onClick:o.onClick,style:c.button,children:o.label})}):null]})}},78780:(e,t,a)=>{a.d(t,{Z:()=>G,s:()=>J});var s=a(67294),i=a(83355),n=a(13991),r=a(6906),l=a(7057),o=a(62965),d=a(3791),c=a(97880);var u=a(5366),p=a(47307),g=a(89024),m=a(64369),h=a(27386),b=a(23189),f=a(88632),v=a(72087),x=a(92083),y=a(93349),M=a(78291),C=a(80671),S=a(71487),j=a(34583),w=a(64891),B=a(9375),V=a(40670),_=a(13627),F=a(35057),D=a(31796),A=a(71552),L=a(480),E=a(86628),T=a(24405),I=a(36700),k=a(82990),R=a(63296),P=a(85893);function Z(){return(0,T.yK)((e=>({button:{width:"100%",height:40,marginTop:24},cancellationButton:{marginRight:12,border:void 0},section:{display:"flex",alignItems:"center",fontSize:14,paddingTop:16,paddingBottom:16,background:"var(--core-gray-50, #F7F7F5)",borderRadius:4,margin:"12px 0",borderWidth:.5,borderStyle:"solid",borderColor:"#E3E2E0"},textSection:{marginRight:"auto",paddingRight:32},allChanges:{color:e.mediumTextColor,fontSize:12,paddingLeft:8,paddingRight:8}})),[])}function H(){return(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBilling.scheduledChanges.cancel.label",defaultMessage:"<bold>Cancel changes</bold>",values:{bold:e=>(0,P.jsx)("b",{children:e})}})}function O(e){window.__c={n:"AllChangesText"};const t=Z(),a=(0,u.useIntl)().formatList(e.scheduledChanges.filter(Boolean),{type:"conjunction",style:"narrow"});return(0,P.jsx)("div",{style:t.allChanges,children:a})}function N(e){window.__c={n:"PendingChangesText"};const{periodEndDate:t,scheduledChanges:a}=e,s=(0,l.Yx)(t,"medium",n.SP),i=(0,T.yK)((e=>({leftSection:{display:"flex",paddingLeft:12},title:{fontWeight:k.Z.fontWeight.medium,paddingLeft:8,paddingRight:8},icon:{width:14,height:14,marginTop:4}})),[]);return(0,P.jsxs)("div",{style:i.leftSection,children:[(0,I.m)(i.icon),(0,P.jsxs)("div",{children:[(0,P.jsx)("div",{style:i.title,children:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBilling.scheduledChanges.pendingChanges.title",defaultMessage:"Pending changes scheduled for {date}",values:{date:s}})}),(0,P.jsx)(O,{scheduledChanges:a})]})]})}function z(e){window.__c={n:"CancelPendingCancellationChanges"};const{customerData:t}=e,a=Z(),s=(0,L.O7)();return(0,P.jsx)(R.Z,{isLarge:!0,onClick:()=>w.LZ({environment:s,customerData:t}),style:a.cancellationButton,children:(0,P.jsx)(H,{})})}function K(e){window.__c={n:"CancelPendingChanges"};const{customerData:t}=e,a=Z(),s=(0,L.O7)();return(0,P.jsx)(R.Z,{isLarge:!0,onClick:()=>w.y5({environment:s,customerData:t}),style:a.cancellationButton,children:(0,P.jsx)(H,{})})}function Y(e){window.__c={n:"ScheduledChangesBillingSection"};const{stripeCustomerData:t}=e,a=Z(),{scheduledChanges:s,periodEndDate:i}=(0,E.VK)((()=>(0,V.Tg)(t)),[t]),{cancelledChanges:n}=(0,E.VK)((()=>(0,V.n8)(t)),[t]);if(t.isSubscribed&&t.willCancelAt)return(0,P.jsxs)("div",{style:a.section,children:[(0,P.jsx)("div",{style:a.textSection,children:(0,P.jsx)(N,{scheduledChanges:n,periodEndDate:t.willCancelAt})}),(0,P.jsx)(z,{customerData:e.stripeCustomerData})]});const r=(0,V.dY)(t);return(0,V.dA)(t)||r&&(0,V.bM)(t)?(0,P.jsxs)("div",{style:a.section,children:[(0,P.jsx)("div",{style:a.textSection,children:(0,P.jsx)(N,{scheduledChanges:s,periodEndDate:i})}),(0,P.jsx)(K,{customerData:e.stripeCustomerData})]}):null}var W=a(27533),q=a(72983);const J={offline:(0,P.jsx)(u.FormattedMessage,{defaultMessage:"Please go online to manage billing.",id:"spaceSubscriptionBillingV2.offline.message"})};class U extends i.Z{constructor(){super(...arguments),this.storeTypes={store:y.Z,billingHistoryRequestStore:v.Z},this.renderPlanTypeName=e=>{switch(e){case"personal":return(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.personal",defaultMessage:"Personal"});case"plus":return(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.plus",defaultMessage:"Plus"});case"business":return(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.business",defaultMessage:"Business"});case"enterprise":return(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.planType.enterprise",defaultMessage:"Enterprise"});default:return null}},this.renderBilling=()=>{const{billingEvents:e}=this.stores.store.state,{isMobile:t}=this.environment.device;return(0,P.jsxs)(g.j,{height:t?void 0:"fill",padding:t?void 0:"36px 60px",style:{overflowY:t?void 0:"auto"},children:[t?null:(0,P.jsx)(b.Z,{large:!0,divider:"full",style:U.settingHeaderStyle,children:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.billing",defaultMessage:"Billing"})}),(0,P.jsx)(Y,{stripeCustomerData:this.props.customerData}),this.renderPlanRow(),this.renderAdditionalFeaturesRows(),this.renderBillingPeriodRow(),(0,P.jsx)("div",{style:{height:40,flexShrink:0}}),(0,P.jsx)(b.Z,{large:!0,divider:"full",style:U.settingHeaderStyle,children:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentDetails",defaultMessage:"Payment details"})}),this.renderPaymentMethodRow(),this.renderAddressRow(),this.renderBillingEmailRow(),this.renderVATRow(),(0,P.jsx)(D.V,{spaceStore:this.props.spaceStore,events:e,upcomingInvoiceData:this.props.upcomingInvoiceData})]})},this.handleChangePlanClick=()=>{x.Z.setState({open:!0,openedFrom:"upsell",currentTab:"plans",defaultSubtab:void 0,highlightedSetting:void 0})},this.handlePaymentMethodChangeClick=async()=>{const{spaceStore:e}=this.props,t=await(0,B.showPaymentMethodModal)();t&&await j.TV({environment:this.environment,spaceStore:e,paymentMethodId:t.id})},this.handleBillingIntervalChangeClick=()=>{const{customerData:e}=this.props,t="interval"in e?e.interval:"year",a="year"===t?"month":"year";w.af({environment:this.environment,from:"billing_page",view:"billing_interval",temporaryBillingInterval:a,billingInterval:t,onSuccess:()=>{j.zb(this.environment,this.stores.store)}})},this.handleAddressChangeClick=async()=>{const{spaceStore:e,customerData:t}=this.props,a=await(0,B.showAddressModal)({defaultValue:t.address});a&&((0,o.Z)(a,t.address)||await j.y3({environment:this.environment,spaceStore:e,address:a}))},this.handleVatIdChangeClick=async()=>{var e;const{spaceStore:t,customerData:a}=this.props,s=null===(e=a.address)||void 0===e?void 0:e.country;if(!s)return void p.showErrorMessage((0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.vatId.missingCountry",defaultMessage:"To update your VAT/GST number, please update your billing address."}));if(!{AE:"ae_trn",AT:"eu_vat",AU:"au_abn",BE:"eu_vat",BG:"eu_vat",CA:"ca_bn",CH:"ch_vat",CY:"eu_vat",CZ:"eu_vat",DE:"eu_vat",DK:"eu_vat",EE:"eu_vat",ES:"eu_vat",FI:"eu_vat",FR:"eu_vat",GB:"gb_vat",GR:"eu_vat",HR:"eu_vat",HU:"eu_vat",IE:"eu_vat",IN:"in_gst",IT:"eu_vat",KR:"kr_brn",LT:"eu_vat",LU:"eu_vat",LV:"eu_vat",MT:"eu_vat",NL:"eu_vat",NZ:"nz_gst",PL:"eu_vat",PT:"eu_vat",RO:"eu_vat",RU:"ru_inn",SE:"eu_vat",SG:"sg_gst",SI:"eu_vat",SK:"eu_vat"}[s])return void p.showErrorMessage((0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.vatId.vatNotRequired",defaultMessage:"A VAT/GST number is not required for your tax jurisdiction."}));const i=await(0,B.showVatIdModal)({defaultValue:a.vatId});i&&i!==a.vatId&&await j.Mg({environment:this.environment,from:"space_settings-billing_tab",spaceStore:t,vatId:i})},this.handleBillingEmailChangeClick=async()=>{const{spaceStore:e,customerData:t}=this.props,a=await(0,B.showEmailModal)({defaultValue:t.billingEmail});a&&a!==t.billingEmail&&await j.Mg({environment:this.environment,spaceStore:e,billingEmail:a,from:"space_settings-billing_tab"})}}willMount(){j.bi(this.environment),j.px(this.environment),j.zb(this.environment,this.stores.store)}renderComponent(){return f.Z.state.online?this.renderBilling():U.renderOfflineMessage()}static renderOfflineMessage(){return(0,P.jsx)(h.Z,{children:(0,P.jsx)(m.Z,{isSmall:!0,style:{textAlign:"center"},children:J.offline})})}renderPlanRow(){const{subscriptionData:e,customerData:t}=this.props;let a,s;const i=_.XX(e);i&&(a=(0,P.jsx)(W.W,{cost:{amount:i.planAmount*i.quantity,currencyCode:i.currencyCode},trailingZeroDisplay:"stripIfInteger"}),s=(0,l.Yx)(i.periodEnd,"medium",n.SP));const r=t.willCancelAt?(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.cancels",defaultMessage:"Cancels"}):(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.renews",defaultMessage:"Renews"});let o;if(i)switch(i.interval){case"month":o=(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.month",defaultMessage:"{planCharge} per month · {renewalOrCancellationMessage} {renewalDate}",values:{planCharge:a,renewalDate:s,renewalOrCancellationMessage:r}});break;case"year":o=(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.year",defaultMessage:"{planCharge} per year · {renewalOrCancellationMessage} {renewalDate}",values:{planCharge:a,renewalDate:s,renewalOrCancellationMessage:r}});break;default:(0,c.t1)(i.interval)}return(0,P.jsx)(A.J,{mainLabel:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.plan",defaultMessage:"Plan"}),metadataLabel:o,valueLabel:i?this.renderPlanTypeName(_.NW(i.productId)):"Free",button:{label:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.changePlan",defaultMessage:"Change plan"}),onClick:this.handleChangePlanClick}})}renderAdditionalFeaturesRowMetadataLabel(e,t){const{customerData:a}=this.props,s=a.isSubscribed?a.interval:"month",i=(0,P.jsx)(W.W,{cost:{amount:e.cost,currencyCode:a.currencyCode??"USD"},trailingZeroDisplay:"stripIfInteger"}),r=a.periodEnd;return t?(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.cancels",defaultMessage:"{planCharge} per {interval} · Cancels {date}",values:{planCharge:i,interval:s,date:(0,l.Yx)(t,"medium",n.SP)}}):r?(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.renews",defaultMessage:"{planCharge} per {interval} · Renews {date}",values:{planCharge:i,interval:s,date:(0,l.Yx)(r,"medium",n.SP)}}):(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.priceAndRenewalDate.priceOnly",defaultMessage:"{planCharge} per {interval}",values:{planCharge:i,interval:s}})}renderAdditionalFeaturesRow(e){const{customerData:t}=this.props,a=V.A0(t);let s;var i;a&&(s=(0,d.ls)(null===(i=M.default.state.data)||void 0===i?void 0:i.addOns)??t.periodEnd);const n={label:a?(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.resubscribe",defaultMessage:"Resubscribe"}):(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.removeFromPlan",defaultMessage:"Remove from plan"}),onClick:async()=>{if(s){if(t.willCancelAt){const e=t.customerId?await S.y(this.environment,{offerType:"add_on_upgrade_flow",customerId:t.customerId}):void 0;return C.k2(),void C.Cl(e)}await w.y5({environment:this.environment,customerData:t})}else C.Kj()}};return(0,P.jsx)(A.J,{mainLabel:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.additionalFeatures",defaultMessage:"Additional features"}),metadataLabel:this.renderAdditionalFeaturesRowMetadataLabel(e,s),valueLabel:"Notion AI",button:n})}renderAdditionalFeaturesRows(){const{customerData:e}=this.props;return e.addOns.map((e=>(0,P.jsx)(s.Fragment,{children:this.renderAdditionalFeaturesRow(e)},e.feature)))}renderBillingPeriodRow(){return(0,F.iJ)()||!this.props.customerData.isSubscribed&&(0,d.E3)(this.props.customerData.addOns)?null:(0,P.jsx)(A.J,{mainLabel:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.billingPeriod",defaultMessage:"Billing period"}),valueLabel:this.renderBillingInterval(),button:{label:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.editPeriod",defaultMessage:"Edit period"}),onClick:this.handleBillingIntervalChangeClick}})}renderBillingEmailRow(){const{customerData:e}=this.props;return(0,P.jsx)(A.J,{mainLabel:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.billingEmail",defaultMessage:"Billing email"}),valueLabel:e.billingEmail??"",button:{label:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.editEmail",defaultMessage:"Edit email"}),onClick:this.handleBillingEmailChangeClick}})}renderPaymentMethodRow(){return(0,P.jsx)(A.J,{mainLabel:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethod",defaultMessage:"Payment method"}),valueLabel:this.renderPaymentMethodType(),metadataLabel:this.renderPaymentMethodSummary(),button:{label:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.editMethod",defaultMessage:"Edit method"}),onClick:this.handlePaymentMethodChangeClick}})}renderAddressRow(){const{customerData:e}=this.props;return(0,P.jsx)(A.J,{mainLabel:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.billedTo",defaultMessage:"Billed to"}),valueLabel:(0,P.jsx)(q.l,{layout:"condensed",address:e.address}),button:{label:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.editInformation",defaultMessage:"Edit information"}),onClick:this.handleAddressChangeClick}})}renderVATRow(){const{customerData:e}=this.props;return(0,P.jsx)(A.J,{mainLabel:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.vatGst",defaultMessage:"VAT/GST number"}),valueLabel:(0,P.jsx)("div",{children:e.vatId||"-"}),button:{label:(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.editNumber",defaultMessage:"Edit number"}),onClick:this.handleVatIdChangeClick}})}renderPaymentMethodType(){const{customerData:e}=this.props,t=e.isSubscribed?e.billing:"charge_automatically";if("send_invoice"===t)return(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.achOrWireTransfer",defaultMessage:"ACH or Wire Transfer"});if("charge_automatically"!==t)return(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.none",defaultMessage:"None"});switch(e.paymentMethodType){case"card":return(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethodType.creditCard",defaultMessage:"Credit card"});case"link":return(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethodType.link",defaultMessage:"Stripe Link"});default:return(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethodType.other",defaultMessage:"Other"})}}renderPaymentMethodSummary(){const{customerData:e}=this.props,t=e.isSubscribed?e.billing:"charge_automatically";if("send_invoice"===t)return(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.achOrWireTransfer",defaultMessage:"ACH or Wire Transfer"});if("charge_automatically"!==t)return(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBilling.subscriptionSettingsSection.paymentMethod.value.none",defaultMessage:"None"});switch(e.paymentMethodType){case"card":return(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.paymentMethod.creditCard",defaultMessage:"{creditCardBrand} ending in {lastFourDigits}",values:{creditCardBrand:(0,r.Z)(e.brand),lastFourDigits:e.last4}});default:return}}renderBillingInterval(){const{customerData:e}=this.props;return e.isSubscribed?"month"===e.interval?(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.subscriptionSettingsSection.billingInterval.value.monthly",defaultMessage:"Monthly"}):(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.subscriptionSettingsSection.billingInterval.value.yearly",defaultMessage:"Yearly"}):(0,P.jsx)(u.FormattedMessage,{id:"spaceSubscriptionBillingV2.subscriptionSettingsSection.billingInterval.value.monthly",defaultMessage:"Monthly"})}}U.displayName="SpaceSubscriptionBillingV2",U.settingHeaderStyle={marginBottom:4};const G=(0,u.injectIntl)(U)},33218:(e,t,a)=>{a.d(t,{h:()=>o});var s=a(67294),i=a(480),n=a(86628),r=a(80444),l=a(22616);function o(){const e=(0,i.O7)(),t=(0,n.VK)((()=>r.default.state.currentSpaceStore.id),[]);(0,s.useEffect)((()=>{(0,l.Z)({environment:e,spaceId:t})}),[e,t])}},38524:(e,t,a)=>{a.d(t,{f:()=>n});var s=a(86628),i=a(78291);function n(){return(0,s.VK)((()=>i.default.state.data),[])}},15967:(e,t,a)=>{a.d(t,{J:()=>n});a(67294);var s=a(45238),i=a(85893);const n=(0,s.I)("settingsBilling",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M3.24219 17.5625H16.7578C18.3984 17.5625 19.2109 16.75 19.2109 15.1406V5.60156C19.2109 3.99219 18.3984 3.17969 16.7578 3.17969H3.24219C1.60938 3.17969 0.789062 3.98438 0.789062 5.60156V15.1406C0.789062 16.7578 1.60938 17.5625 3.24219 17.5625ZM2.04688 5.66406C2.04688 4.85156 2.47656 4.4375 3.25781 4.4375H16.7422C17.5156 4.4375 17.9531 4.85156 17.9531 5.66406V6.84375H2.04688V5.66406ZM3.25781 16.3047C2.47656 16.3047 2.04688 15.8906 2.04688 15.0781V8.61719H17.9531V15.0781C17.9531 15.8906 17.5156 16.3047 16.7422 16.3047H3.25781ZM4.5 14.625H6.41406C6.86719 14.625 7.17969 14.3125 7.17969 13.875V12.4297C7.17969 11.9844 6.86719 11.6797 6.41406 11.6797H4.5C4.03906 11.6797 3.72656 11.9844 3.72656 12.4297V13.875C3.72656 14.3125 4.03906 14.625 4.5 14.625Z"})})},5517:(e,t,a)=>{a.d(t,{q:()=>n});a(67294);var s=a(45238),i=a(85893);const n=(0,s.I)("settingsPlans",{viewBox:"0 0 20 20",svg:(0,i.jsx)("path",{d:"M2.75781 17.7656C2.95312 17.7656 3.15625 17.6953 3.40625 17.5547L7.38281 15.4141L11.7031 17.8359C11.9844 17.9922 12.2891 18.0703 12.5781 18.0703C12.8516 18.0703 13.125 18 13.3594 17.8672L17.4453 15.5469C17.9141 15.2891 18.125 14.9141 18.125 14.3906V3.86719C18.125 3.28906 17.8047 2.96875 17.2422 2.96875C17.0469 2.96875 16.8438 3.03125 16.5859 3.17188L12.4453 5.47656L8.20312 2.875C7.96094 2.73438 7.6875 2.65625 7.41406 2.65625C7.13281 2.65625 6.85156 2.73438 6.60938 2.875L2.54688 5.1875C2.08594 5.45312 1.875 5.82812 1.875 6.35156V16.8594C1.875 17.4375 2.19531 17.7656 2.75781 17.7656ZM6.875 14.1719L3.35156 16.1094C3.3125 16.125 3.27344 16.1484 3.23438 16.1484C3.17188 16.1484 3.13281 16.1016 3.13281 16.0234V6.65625C3.13281 6.46875 3.20312 6.33594 3.39062 6.22656L6.59375 4.35156C6.69531 4.29688 6.78125 4.25 6.875 4.19531V14.1719ZM8.13281 14.2969V4.35938C8.21094 4.40625 8.30469 4.45312 8.38281 4.5L11.8672 6.625V16.3906C11.7578 16.3281 11.6406 16.2734 11.5234 16.2109L8.13281 14.2969ZM13.125 16.5312V6.54688L16.6484 4.625C16.6875 4.60156 16.7266 4.58594 16.7578 4.58594C16.8281 4.58594 16.8672 4.63281 16.8672 4.71094V14.0781C16.8672 14.2734 16.7891 14.4062 16.6094 14.5156L13.4766 16.3359C13.3594 16.4062 13.2422 16.4766 13.125 16.5312Z"})})}}]);