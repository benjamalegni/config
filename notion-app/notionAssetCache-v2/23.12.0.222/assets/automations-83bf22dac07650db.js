"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1655],{6253:(e,t,o)=>{o.r(t),o.d(t,{AutomationButtonActionList:()=>tt});var n=o(67294),i=o(480),a=o(86628),r=o(24405),s=o(47453),l=o(5366),c=o(98963),d=o(39699),u=o(52275),p=o(31945),g=o(79131),m=o(61766),x=o(45452),h=o(2553),f=o(35294),b=o(63362),y=o(80700),S=o(4615),C=o(97880),v=o(78140),A=o(32163),j=o(72495),w=o(26388),k=o(60442),M=o(82343),B=o(98742),P=o(63474),Z=o(95193),T=o(85893);function V(e){window.__c={n:"AddActionMenu"};const{contextStore:t,onActionAdded:o,insertionPoint:r}=e,s=(0,l.useIntl)(),c=(0,i.O7)(),p=(0,P.D)(),g=(0,Z.F)({width:280}),m=function(e){const{contextStore:t}=e,[o,i]=(0,n.useState)([]),r=(0,a.VK)((()=>(0,M.uV)(t.context.automationStore,t.context.type)),[t.context.automationStore,t.context.type]),s=(0,n.useMemo)((()=>(0,y.P)("display")),[]);return(0,a.VK)((async()=>{if(r){const e=await Promise.all(s.map((async e=>await e.isAvailableForContext(r))));return i(function(e){const t=e=>e?1:-1;return e.slice().sort(((e,o)=>t(o.display.hasSideEffects)-t(e.display.hasSideEffects)))}(s.filter(((t,o)=>e[o]))))}o.length>0&&i([])}),[r,o.length,s]),o}({contextStore:t}).map((e=>{const{display:n}=e;return{key:e.type,render:e=>{const t=t=>(0,T.jsx)(u.Z,{...(0,B.Z)(t??{},e),icon:(0,T.jsx)(_,{display:n}),disabled:!1,title:s.formatMessage(n.name)}),o=n.description;return o?(0,T.jsx)(w.Z,{renderTooltip:()=>(0,T.jsx)(k.Z,{caption:s.formatMessage(o)}),placement:w.Z.Placement.Right,delayThreshold:0,render:t}):t()},action:()=>{const n=(0,S.ZP)(),i=t.context.automationStore;d.createAndCommit({userAction:"AutomationActionList.addAction",environment:c,perform:t=>{h.zY({actionId:n,actionType:e.type,automationStore:i,environment:c,intl:s,transaction:t,insertionPoint:r})}}),(0,b.eI)(p,{automation_id:i.id,automation_action_id:n,automation_action_type:e.type}),o(n)}}})).filter(C.$K);return(0,T.jsx)(v.Z,{...g,children:(0,T.jsx)(A.Z,{type:A.i.Vertical,sections:[{key:0,render:e=>(0,T.jsx)(j.Z,{enableActionSheetTitle:!0,...e}),items:m}],initialFocus:0})})}function _(e){window.__c={n:"AddActionIcon"};const{display:t}=e,o=(0,r.yK)((e=>({icon:{width:13,height:13,fill:t.hasSideEffects?e.blueColor:e.mediumIconColor},iconWrapper:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",background:t.hasSideEffects?"rgba(35, 131, 226, 0.14)":e.accentColors.gray[50],borderRadius:3,marginLeft:-2}})),[t.hasSideEffects]);return(0,T.jsx)("div",{style:o.iconWrapper,children:t.icon(o.icon)})}var I=o(82990),F=o(9953),O=o(41301),K=o(64737),L=o(40745),D=o(8597),R=o(56666),W=o(88437),E=o(1230);const H=(0,o(45238).I)("insertUp",{viewBox:"0 0 16 16",svg:(0,T.jsx)("path",{d:"M9.55566 3.61987H14.2095C14.5325 3.61987 14.7961 3.36279 14.7961 3.03979C14.7961 2.7168 14.5325 2.45972 14.2095 2.45972H9.55566C9.23267 2.45972 8.97559 2.7168 8.97559 3.03979C8.97559 3.36279 9.23267 3.61987 9.55566 3.61987ZM1.21045 6.9751C1.21045 7.55518 1.52686 7.91113 2.04102 7.91113C2.55518 7.91113 2.87817 7.54199 2.87817 6.99487V5.86768C2.87817 5.70947 2.96387 5.61719 3.12866 5.61719H4.7041V6.28955C4.7041 6.83667 5.2644 7.04761 5.68628 6.71143L7.56494 5.2019C7.84839 4.97778 7.84839 4.57568 7.56494 4.35815L5.68628 2.84204C5.25122 2.48608 4.7041 2.69702 4.7041 3.27051V3.94946H2.93091C1.8894 3.94946 1.21045 4.55591 1.21045 5.59741V6.9751ZM9.55566 7.07397H14.2095C14.5325 7.07397 14.7961 6.81689 14.7961 6.4939C14.7961 6.1709 14.5325 5.91382 14.2095 5.91382H9.55566C9.23267 5.91382 8.97559 6.1709 8.97559 6.4939C8.97559 6.81689 9.23267 7.07397 9.55566 7.07397ZM1.78394 10.5281H14.2095C14.5325 10.5281 14.7961 10.271 14.7961 9.948C14.7961 9.625 14.5325 9.36792 14.2095 9.36792H1.78394C1.46094 9.36792 1.20386 9.625 1.20386 9.948C1.20386 10.271 1.46094 10.5281 1.78394 10.5281ZM1.78394 13.9756H14.2095C14.5325 13.9756 14.7961 13.7251 14.7961 13.4021C14.7961 13.0725 14.5325 12.822 14.2095 12.822H1.78394C1.46094 12.822 1.20386 13.0725 1.20386 13.4021C1.20386 13.7251 1.46094 13.9756 1.78394 13.9756Z"})});var U=o(37612),Q=o(23063),N=o(50478),G=o(73063),z=o(91839),q=o(53437),Y=o(27186),$=o(28267);const X=(0,l.defineMessages)({moreActionsButtonAriaLabel:{defaultMessage:"More actions",id:"buttonBlock.button.moreActionsButtonAriaLabel"}});function J(e){window.__c={n:"AutomationActionHeader"};const{contextStore:t,actionStore:o,disabled:i,dragging:s,title:l,picker:c,onActionAdded:d}=e,u=(0,n.useRef)(null),p=(0,$.X)(u),g=(0,n.useMemo)((()=>Boolean(p&&p.width<320)),[p]),[m,x]=(0,n.useState)(!1),h=(0,n.useMemo)((()=>s||!i&&m),[i,s,m]),f=(0,r.yK)((e=>({iconHandle:{display:"flex",justifyContent:"center",left:0,position:"absolute",top:0,width:24},iconWrap:{position:"relative",width:24},nameRow:{display:"flex",alignItems:g?"flex-start":"center"},name:{flexGrow:1,fontWeight:I.Z.fontWeight.medium,display:"flex",overflow:"hidden",...g?{flexDirection:"row",flexWrap:"wrap",marginLeft:8,alignItems:"center"}:{alignItems:"center",marginLeft:8}},title:{whiteSpace:"nowrap"},picker:{position:"relative",left:-4,...g?{flexShrink:1,display:"inline-flex",minWidth:0}:{flexGrow:1,width:0}}})),[g]),b=(0,a.VK)((()=>o.getType()),[o]);if(!b)return null;const S=(0,y.z)(b),{display:C}=S;return(0,T.jsxs)("div",{onMouseLeave:()=>x(!1),onMouseEnter:()=>x(!0),style:f.nameRow,ref:u,children:[(0,T.jsxs)("div",{style:f.iconWrap,children:[(0,T.jsx)(Q.Z,{isVisible:!0,animationStyle:{opacity:h?0:1},enterAnimationStyle:{opacity:1},exitAnimationStyle:{opacity:1},render:()=>(0,T.jsx)(ee,{display:C})}),(0,T.jsx)(Q.Z,{isVisible:!i,animationStyle:{opacity:h?1:0},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},render:()=>(0,T.jsx)("div",{style:f.iconHandle,children:(0,T.jsx)(N.ZP,{hideClickMessage:!0})})})]}),(0,T.jsxs)("div",{style:f.name,children:[(0,T.jsx)("div",{style:f.title,children:l}),!g&&(0,T.jsx)(T.Fragment,{children:" "}),c&&(0,T.jsx)("div",{style:f.picker,children:c})]}),!i&&(0,T.jsx)(te,{contextStore:t,actionStore:o,onActionAdded:d})]})}function ee(e){window.__c={n:"ActionIcon"};const{display:t}=e,o=(0,r.yK)((e=>({iconWrap:{width:24,height:24,display:"flex",alignItems:"center",borderRadius:4,background:t.hasSideEffects?"rgba(35, 131, 226, 0.14)":e.accentColors.gray[50],flexShrink:0},icon:{width:14,height:14,fill:t.hasSideEffects?e.blueColor:e.accentColors.gray[500],margin:"0 auto"}})),[t.hasSideEffects]);return(0,T.jsx)("div",{style:o.iconWrap,children:t.icon(o.icon)})}function te(e){window.__c={n:"MoreActionsButton"};const{contextStore:t,actionStore:o,onActionAdded:i}=e,a=(0,l.useIntl)(),r=(0,f.d)(),[s,c]=(0,n.useState)("closed"),[d,u]=n.useState(void 0);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(p.ZP,{popupType:r,alignmentToOrigin:p.vR.Center,placementToOrigin:p.pO.Bottom,originGap:0,renderOrigin:e=>(0,T.jsx)(G.Z,{ariaLabel:a.formatMessage(X.moreActionsButtonAriaLabel),icon:R.o,...e}),render:t=>(0,T.jsx)(ne,{onClose:()=>t.close(),onAddStep:e=>{u(new DOMRect(Y.IL.x,Y.IL.y,1,1)),c(e?"above":"below"),t.close()},...e})}),(0,T.jsx)(q.ZP,{popupType:r,open:"closed"!==s,originRect:d,placementToOrigin:q.ZP.Placement.Bottom,alignmentToOrigin:q.ZP.Alignment.Center,render:()=>(0,T.jsx)(V,{contextStore:t,onActionAdded:e=>{i(e),c("closed")},insertionPoint:"above"===s?{beforeActionId:o.id}:{afterActionId:o.id}}),onDismiss:()=>c("closed")})]})}function oe(e,t,o){if(t<0||t>=e.length||o<0||o>=e.length)return e;const n=[...e];return n[t]=e[o],n[o]=e[t],n}function ne(e){window.__c={n:"MoreActionsMenu"};const{onClose:t,contextStore:o,actionStore:r,onAddStep:s}=e,p=(0,l.useIntl)(),g=(0,i.O7)(),m=(0,P.D)(),x=(0,a.VK)((()=>o.context.automationStore),[o]),f=(0,a.VK)((()=>x.getActionIds()),[x]),[y,S]=(0,n.useState)(!1),w=f.length<c.FT,k=f.indexOf(r.id),M=0===k,B=k===f.length-1,V=(0,Z.F)(),_={key:"duplicate",action:async()=>{S(!0);const e=d.createAndCommit({userAction:"AutomationAction.duplicateAction",environment:g,perform:e=>h.AN({actionStore:r,automationStore:x,environment:g,intl:p,transaction:e})});r.isDefined()&&(0,b.eI)(m,{automation_id:o.context.automationStore.id,automation_action_id:r.id,automation_action_type:r.getType(),from:"duplicate"});try{await e.performResult.onComplete}finally{S(!1)}t()},render:e=>{const t=y?(0,T.jsx)(z.Z,{}):(0,W.a)({height:16,width:16}),o=y?(0,T.jsx)(l.FormattedMessage,{id:"automations.duplicatingActionButton.label",defaultMessage:"Duplicating..."}):(0,T.jsx)(l.FormattedMessage,{id:"automations.duplicateBelowActionButton.label",defaultMessage:"Duplicate below"});return(0,T.jsx)(u.Z,{...e,disabled:y,icon:t,title:o})}},I={key:"delete",action:()=>{d.createAndCommit({userAction:"AutomationAction.removeAction",environment:g,perform:e=>{h.sl({clientContext:o.context,actionStore:r,transaction:e}),r.isDefined()&&(0,b.co)(m,{automation_id:o.context.automationStore.id,automation_action_id:r.id,automation_action_type:r.getType()})}}),t()},render:e=>(0,T.jsx)(u.Z,{...e,icon:(0,U.y)({height:16,width:16}),title:(0,T.jsx)(l.FormattedMessage,{id:"automations.deleteActionButton.label",defaultMessage:"Delete"})})},F=[!0,!1].map((e=>{if(!(e&&M||!e&&B))return{key:e?"moveUp":"moveDown",action:()=>{d.createAndCommit({userAction:"AutomationAction.moveAction",environment:g,perform:t=>{let n;n=oe(f,e?k-1:k+1,k),h.kM({clientContext:o.context,transaction:t,newActionIds:n})}}),t()},render:t=>(0,T.jsx)(u.Z,{...t,icon:(e?D.Z:L.M)({width:16,height:16}),title:e?(0,T.jsx)(l.FormattedMessage,{id:"automations.moveUpButton.label",defaultMessage:"Move up"}):(0,T.jsx)(l.FormattedMessage,{id:"automations.moveDownButton.label",defaultMessage:"Move down"})})}})).filter(C.$K),O=[!0,!1].map((e=>({key:e?"addStepAbove":"addStepBelow",action:()=>{s(e)},render:t=>(0,T.jsx)(u.Z,{...t,disabledFeedback:!0,icon:e?H({width:16,height:16}):(0,E.H)({width:16,height:16}),title:e?(0,T.jsx)(l.FormattedMessage,{id:"automations.addStepAboveButton.label",defaultMessage:"Add step above"}):(0,T.jsx)(l.FormattedMessage,{id:"automations.addStepBelowButton.label",defaultMessage:"Add step below"})})})));return(0,T.jsx)(v.Z,{...V,children:(0,T.jsx)(A.Z,{type:A.i.Vertical,sections:[...F.length>0?[{key:"movement",render:e=>(0,T.jsx)(j.Z,{enableActionSheetTitle:!0,...e}),items:F}]:[],...w?[{key:"addSteps",render:e=>(0,T.jsx)(j.Z,{enableActionSheetTitle:!0,topBorder:!0,...e}),items:O},{key:"duplicate",render:e=>(0,T.jsx)(j.Z,{enableActionSheetTitle:!0,topBorder:!0,...e}),items:[_]}]:[],{key:"delete",render:e=>(0,T.jsx)(j.Z,{enableActionSheetTitle:!0,topBorder:!0,...e}),items:[I]}],initialFocus:0})})}var ie=o(32984),ae=o(73239),re=o(29180);var se=o(72126),le=o(15201),ce=o(68709),de=o(55217),ue=o(79954),pe=o(43250),ge=o(12534),me=o(90106),xe=o(40190);const he=(0,l.defineMessages)({aboveButtonLabel:{id:"automations.DuplicateBlocksAction.aboveButtonLabel",defaultMessage:"Above button"},belowButtonLabel:{id:"automations.DuplicateBlocksAction.belowButtonLabel",defaultMessage:"Below button"}});function fe(e){window.__c={n:"DuplicateBlocksActionEditor"};const{actionStore:t,disabled:o,contentParentPointer:s,buttonPlacement:c}=e,u=(0,i.O7)(),p=(0,r.yK)((e=>({listWrap:{background:e.contentBackground,boxShadow:e.inputBoxShadow,padding:"3px 9px",borderRadius:5,minHeight:64,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},emptyPlaceholder:{caretColor:e.mediumTextColor,color:e.lightTextColor,fontSize:14,padding:"5px 0",display:"inline-block"}})),[]),g=(0,a.VK)((()=>me.G.createChildStore(t,s)),[t,s]),m=(0,a.VK)((()=>g.getContentStore()),[g]),x=(0,n.useCallback)((e=>{(0,ge.ZP)({event:e,context:ge.Af.EditorClick,callback:()=>{if(!m)return;(m.getValue()||[]).length>0||d.createAndCommit({userAction:"DuplicateBlocksAction.handleListClick",environment:u,perform:e=>{h.Nj({environment:u,parentStore:m,transaction:e})}})}})}),[u,m]);if(!m)return null;const f="inline"===(null==c?void 0:c.type);return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(ue.Z,{store:g,analyticsName:"duplicate_blocks_action",isListContainer:!0,children:(0,T.jsx)(ce.p,{allowSelectionWithin:!0,children:(0,T.jsx)("div",{style:p.listWrap,onClick:x,className:pe.Wh_,children:(0,T.jsx)(le.O,{displayName:"DuplicateBlocksActionContent",disabled:o,children:(0,T.jsx)(de.Z,{disabled:o,store:m,emptyPlaceholder:(0,T.jsx)("div",{style:p.emptyPlaceholder,children:f?(0,T.jsx)(l.FormattedMessage,{id:"automations.DuplicateBlocksAction.emptyPlaceholder",defaultMessage:"Click to edit or drop blocks here…"}):(0,T.jsx)(l.FormattedMessage,{id:"automations.DuplicateBlocksAction.emptyCannotDropPlaceholder",defaultMessage:"Click to edit blocks here…"})}),disableCommentMenu:!0,disableHoverMenu:!1,disableDrag:!1})})})})})})}const be={before:{icon:H({width:16}),key:"before",title:he.aboveButtonLabel},after:{icon:(0,E.H)({width:16}),key:"after",title:he.belowButtonLabel}};function ye(e){window.__c={n:"InsertBlockInDropdownButton"};const{actionStore:t,disabled:o}=e,n=(0,l.useIntl)(),i=(0,r.yK)((e=>({button:{fontWeight:"normal"}})),[]),s=(0,f.d)(),c=(0,a.VK)((()=>t.getInsertionPoint()),[t]),d=Object.values(be),u=d.find((e=>e.key===c));return u?(0,T.jsx)(p.ZP,{popupType:s,alignmentToOrigin:p.vR.End,disabled:o,placementToOrigin:p.pO.Bottom,originGap:0,renderOrigin:e=>(0,T.jsx)(xe.S,{disabled:o,style:i.button,variant:"gray",...e,children:n.formatMessage(u.title)}),render:e=>(0,T.jsx)(Se,{actionStore:t,currentOption:u,options:d,parent:e})}):null}function Se(e){window.__c={n:"InsertBlockInDropdownMenu"};const{actionStore:t,currentOption:o,options:a,parent:r}=e,s=(0,i.O7)(),c=(0,l.useIntl)(),p=(0,n.useCallback)((e=>{d.createAndCommit({userAction:"DuplicateBlocksAction.setInsertionPoint",environment:s,perform:o=>{F.sW({store:t.getConfigStore(),data:{insertion_point:e},transaction:o})}})}),[s,t]),g=(0,Z.F)({maxWidth:360}),m=a.map((e=>({key:e.key,render:t=>(0,T.jsx)(u.Z,{...t,checkState:o.key===e.key,icon:e.icon,title:c.formatMessage(e.title)}),action:()=>{p(e.key),r.close()}})));return(0,T.jsx)(v.Z,{...g,children:(0,T.jsx)(A.Z,{initialFocus:0,sections:[{key:0,render:e=>(0,T.jsx)(j.Z,{enableActionSheetTitle:!0,...e}),items:m}],type:A.i.Vertical})})}var Ce=o(72865),ve=o(19471);const Ae=(0,l.defineMessages)({confirmationInputPlaceholder:{defaultMessage:"Write a message to show users…",id:"automations.BaseModalAction.confirmationPlaceholder"},continueButtonHint:{defaultMessage:"Completes button action",id:"automations.BaseModalAction.continueButtonHint"},cancelButtonHint:{defaultMessage:"Stops button action",id:"automations.BaseModalAction.cancelButtonHint"}});function je(e){window.__c={n:"WithRightOverlay"};const{children:t,overlayContent:o}=e,n=(0,r.yK)((e=>({wrap:{position:"relative"},overlay:{position:"absolute",height:"100%",display:"flex",alignItems:"center",top:0,right:10,color:e.lightTextColor}})),[]);return(0,T.jsxs)("div",{style:n.wrap,children:[t,(0,T.jsx)("div",{style:n.overlay,children:o})]})}var we=o(23877);function ke(e){window.__c={n:"AutomationKeyValueRow"};const{keyComp:t,valueComp:o,style:n}=e,i=(0,r.yK)((()=>({container:{display:"flex",alignItems:"center",justifyContent:"space-between",...n}})),[n]);return(0,T.jsxs)("div",{style:i.container,children:[t,o]})}function Me(e){return(0,T.jsx)("div",{style:{marginRight:4,flexShrink:0},children:e.text})}var Be=o(84619),Pe=o(76798),Ze=o(21396),Te=o(8808);function Ve(e){window.__c={n:"AutomationPagePicker"};const{contextStore:t,actionStore:o,target:i,onChange:r,disabled:s,errorMessage:c}=e,d=(0,a.qz)(void 0,m.Z),u=(0,a.VK)((()=>{if(i&&"variable"===i.type)return t.getContextValueForActionById(o.id,i.id)}),[i,t,o.id]),g=(0,f.d)(),x=(0,xe.d)({errorMessage:c,hasValue:Boolean(i)}),h=(0,n.useCallback)((e=>{"page"!==e.type&&"variable"!==e.type||(r(e),d.reset())}),[r,d]),b=(0,n.useCallback)((()=>d.reset()),[d]);return(0,T.jsx)(p.ZP,{buttonPopupStore:d,popupType:g,alignmentToOrigin:p.vR.End,placementToOrigin:p.pO.Bottom,originGap:0,disabled:s,renderOrigin:e=>(0,T.jsx)(xe.S,{disabled:s,...x,...e,children:i&&"page"===i.type?(0,T.jsx)(Pe.Z,{store:me.G.createChildStore(t.context.parentRecordStore,i.page)}):u?(0,T.jsx)(Ze.F,{value:u,format:Be.l.Medium,isSingle:!0}):(0,T.jsx)(l.FormattedMessage,{id:"automations.AutomationPagePicker.pagesDropdown.label",defaultMessage:"Select page"})}),render:e=>(0,T.jsx)(Te.L,{actionId:o.id,automationContextStore:t,onChange:h,onClose:b,selectedTarget:i,skipCollections:!0})})}function _e(e){window.__c={n:"OpenPageInDropdownButton"};const{actionStore:t,disabled:o}=e,n=(0,r.Fg)(),i=(0,a.VK)((()=>t.getOpenPageIn()),[t]),s=(0,f.d)(),l=(0,we.v)({currentViewType:void 0,theme:n}).find((e=>e.key===i));return l?(0,T.jsx)(p.ZP,{popupType:s,alignmentToOrigin:p.vR.End,placementToOrigin:p.pO.Bottom,originGap:0,disabled:o,renderOrigin:e=>(0,T.jsx)(xe.S,{disabled:o,variant:"gray",...e,children:l.title}),render:t=>(0,T.jsx)(Ie,{currentOpenPageIn:i,parent:t,...e})}):null}function Ie(e){window.__c={n:"OpenPageInDropdownMenu"};const{currentOpenPageIn:t,actionStore:o,parent:a}=e,s=(0,i.O7)(),l=(0,r.Fg)(),c=(0,r.yK)((()=>({menuItem:{paddingTop:8,paddingBottom:8}})),[]),p=(0,n.useCallback)((e=>{d.createAndCommit({userAction:"OpenPageAction.setTarget",environment:s,perform:t=>{F.sW({store:o.getConfigStore(),data:{open_in:e},transaction:t})}})}),[s,o]),g=(0,Z.F)({width:280,maxWidth:360}),m=(0,we.v)({currentViewType:void 0,theme:l}),x=se.oA(m.map(((e,o)=>({key:o,render:o=>(0,T.jsx)(u.Z,{...o,disabled:!1,title:e.title,icon:e.icon,caption:e.caption,body:e.body,style:c.menuItem,checkState:t===e.key,...o}),action:()=>{p(e.key),a.close()}}))));return(0,T.jsx)(v.Z,{...g,children:(0,T.jsx)(A.Z,{type:A.i.Vertical,sections:[{key:0,render:e=>(0,T.jsx)(j.Z,{enableActionSheetTitle:!0,...e}),items:x}],initialFocus:0})})}o(57658);var Fe=o(22109),Oe=o(61053),Ke=o(12076),Le=o(87279),De=o(52105);const Re=(0,l.defineMessages)({addSortLimit:{id:"automations.QueryCollectionAction.addSortLimitButton.addSortLimit",defaultMessage:"Add sort, limit"},addLimit:{id:"automations.QueryCollectionAction.addSortLimitButton.addLimit",defaultMessage:"Add limit"},addSort:{id:"automations.QueryCollectionAction.addSortLimitButton.addSort",defaultMessage:"Add sort"},limitDescription:{id:"automations.QueryCollectionAction.limitPopup.limitDescription",defaultMessage:"{numberOfPages, plural, one {{numberOfPages} page} other {{numberOfPages} pages}}"},unlimitedDescription:{id:"automations.QueryCollectionAction.limitPopup.unlimitedDescription",defaultMessage:"Unlimited"}});function We(e){window.__c={n:"AddSortLimitButton"};const{actionStore:t,collectionStore:o,disabled:r,onSortAdded:s,onLimitAdded:c}=e,u=(0,i.Fy)(),g=(0,i.O7)(),[m,x]=(0,n.useState)(!1);let h;h=u.isMobile?{menuType:Le.og.ActionSheet}:{menuType:Le.og.Popup,width:250};const f=(0,n.useRef)(null),[b,y]=n.useState(void 0),S=(0,a.VK)((()=>o.getSchema()??{}),[o]),C=(0,a.VK)((()=>o.getFormat()??{}),[o]),A=(0,n.useCallback)((()=>Object.keys(o.getSchema())),[o]),j=(0,a.VK)((()=>t.hasSort()),[t]),w=(0,a.VK)((()=>t.hasLimit()),[t]),k=(0,n.useCallback)((e=>{e&&d.createAndCommit({userAction:"QueryCollectionAction.setInitialSort",environment:g,perform:o=>{F.sW({store:t.getConfigStore(),data:{sort:[{property:e,direction:"ascending"}]},transaction:o})}}),x(!1),s()}),[t,g,s]),M=(0,n.useCallback)((()=>{d.createAndCommit({userAction:"QueryCollectionAction.setInitialLimit",environment:g,perform:e=>{F.sW({store:t.getConfigStore(),data:{limit:1},transaction:e})}}),c()}),[t,g,c]);if(j&&w)return null;let B;return B=j?Re.addLimit:w?Re.addSort:Re.addSortLimit,(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(p.ZP,{popupType:u.isMobile?q.kQ.SlideUp:q.kQ.Popup,alignmentToOrigin:p.vR.Start,placementToOrigin:p.pO.Bottom,originGap:0,disabled:r,renderOrigin:e=>(0,T.jsx)(xe.S,{disabled:r,variant:"gray",ref:f,...e,children:(0,T.jsx)(l.FormattedMessage,{...B})}),render:e=>(0,T.jsx)(Ee,{showSortOption:!j,showLimitOption:!w,onSortSelected:()=>{var t;x(!0),y(null===(t=f.current)||void 0===t?void 0:t.getBoundingClientRect()),e.close()},onLimitSelected:()=>{M(),e.close()}})}),(0,T.jsx)(q.ZP,{popupType:u.isMobile?q.kQ.SlideUp:q.kQ.Popup,open:m,placementToOrigin:q.ZP.Placement.Bottom,alignmentToOrigin:q.ZP.Alignment.Start,originRect:b,render:()=>(0,T.jsx)(v.Z,{...h,children:(0,T.jsx)(Oe.Z,{schema:S,format:C,currentProperty:void 0,getProperties:A,onAccept:k})}),onDismiss:()=>x(!1)})]})}function Ee(e){window.__c={n:"AddSortLimitMenu"};const{showSortOption:t,showLimitOption:o,onSortSelected:n,onLimitSelected:a}=e;let r;r=(0,i.Fy)().isMobile?{menuType:Le.og.ActionSheet}:{menuType:Le.og.Popup,width:250};const s=[];return t&&s.push({key:"sort",action:n,render:e=>(0,T.jsx)(u.Z,{...e,title:"Sort",icon:(0,Fe.T)({width:16})})}),o&&s.push({key:"limit",action:a,render:e=>(0,T.jsx)(u.Z,{...e,title:"Limit",icon:(0,L.M)({width:16})})}),(0,T.jsx)(v.Z,{...r,children:(0,T.jsx)(A.Z,{type:A.i.Vertical,sections:[{key:0,render:e=>(0,T.jsx)(j.Z,{enableActionSheetTitle:!0,...e}),items:s}],initialFocus:0})})}function He(e){window.__c={n:"SortPopup"};const{contextStore:t,actionStore:o,collectionStore:n,disabled:r,buttonPopupStore:s}=e,c=(0,i.O7)(),{device:d}=c,u=(0,a.VK)((()=>{var e;return(null===(e=o.getConfig())||void 0===e||null===(e=e.sort)||void 0===e?void 0:e.length)??0}),[o]);return(0,T.jsx)(p.ZP,{popupType:d.isMobile?q.kQ.SlideUp:q.kQ.Popup,alignmentToOrigin:p.vR.End,placementToOrigin:p.pO.Bottom,originGap:0,disabled:r,buttonPopupStore:s,renderOrigin:e=>(0,T.jsx)(xe.S,{disabled:r,variant:"gray",...e,children:u>0?(0,T.jsx)(l.FormattedMessage,{defaultMessage:"{numberOfSorts, plural, one {{numberOfSorts} sort} other {{numberOfSorts} sorts}}",values:{numberOfSorts:u},id:"automations.QueryCollectionAction.oneOrMoreSorts.title"}):(0,T.jsx)(l.FormattedMessage,{defaultMessage:"None",id:"automations.QueryCollectionAction.noSorts.title"})}),render:e=>(0,T.jsx)(Ue,{contextStore:t,collectionStore:n,actionStore:o,disabled:r})})}function Ue(e){window.__c={n:"SortMenu"};const{contextStore:t,actionStore:o,collectionStore:r,disabled:s}=e,l=(0,i.O7)(),{device:c}=l;let u;u=c.isMobile?{menuType:Le.og.ActionSheet}:{menuType:Le.og.Popup,minWidth:300};const p=(0,n.useCallback)((e=>{d.createAndCommit({userAction:"QueryCollectionAction.setSort",environment:l,perform:t=>{F.sW({store:o.getConfigStore(),data:{sort:e},transaction:t})}})}),[l,o]),g=(0,a.VK)((()=>o.getConfigStore().getKeyStore("sort").getValue()??[]),[o]),m=(0,a.VK)((()=>r.getSchema()),[r]),x=(0,a.VK)((()=>r.getFormat()),[r]);return(0,T.jsx)(v.Z,{...u,children:(0,T.jsx)(Ke.Z,{schema:m,format:x,collectionViewStore:void 0,sorts:g,disabled:s,parentStore:t.context.parentRecordStore,onChange:p})})}function Qe(e){window.__c={n:"LimitPopup"};const{actionStore:t,disabled:o,buttonPopupStore:n}=e,r=(0,i.O7)(),{device:s}=r,c=(0,a.VK)((()=>t.getConfigStore().getKeyStore("limit").getValue()),[t]);return(0,T.jsx)(p.ZP,{popupType:s.isMobile?q.kQ.SlideUp:q.kQ.Popup,alignmentToOrigin:p.vR.End,placementToOrigin:p.pO.Bottom,originGap:0,disabled:o,buttonPopupStore:n,renderOrigin:e=>(0,T.jsx)(xe.S,{disabled:o,variant:"gray",...e,children:(0,C.$K)(c)&&(0,T.jsx)(l.FormattedMessage,{...Re.limitDescription,values:{numberOfPages:c}})}),render:e=>(0,T.jsx)(Ne,{onLimitChanged:o=>{(e=>{d.createAndCommit({userAction:"QueryCollectionAction.setLimit",environment:r,perform:o=>{F.sW({store:t.getConfigStore(),data:{limit:e},transaction:o})}})})(o),e.close()}})})}function Ne(e){window.__c={n:"LimitMenu"};const{onLimitChanged:t}=e;let o;o=(0,i.Fy)().isMobile?{menuType:Le.og.ActionSheet}:{menuType:Le.og.Popup,minWidth:250};const n=[];for(let i=1;i<=5;i++)n.push({key:`limit-${i}`,action:()=>{t(i)},render:e=>(0,T.jsx)(u.Z,{...e,title:(0,T.jsx)(l.FormattedMessage,{...Re.limitDescription,values:{numberOfPages:i}})})});return n.push({key:"unlimited",action:()=>{t(void 0)},render:e=>(0,T.jsx)(u.Z,{...e,title:(0,T.jsx)(l.FormattedMessage,{...Re.unlimitedDescription})})}),(0,T.jsx)(v.Z,{...o,children:(0,T.jsx)(A.Z,{type:A.i.Vertical,sections:[{key:0,render:e=>(0,T.jsx)(j.Z,{enableActionSheetTitle:!0,...e}),items:n}],initialFocus:0})})}o(21703);var Ge=o(43690),ze=o(78106),qe=o(149),Ye=o(11335),$e=o(37034);function Xe(e){window.__c={n:"TargetPicker"};const{contextStore:t,actionStore:o,disabled:r,errorMessage:s}=e,c=(0,i.O7)(),u=(0,a.VK)((()=>{const e=o.getVariableTargetStore();if(e)return e.getValue();const t=o.getCollectionTargetStore();if(t){const e=t.getKeyStore("collection").getValue();if(e)return{collection:e,type:"collection"}}}),[o]),g=(0,a.VK)((()=>{if(u&&"variable"===u.type)return t.getContextValueForActionById(o.id,u.id)}),[t,o,u]),x=(0,xe.d)({errorMessage:s,hasValue:Boolean(u||g)}),h=(0,a.qz)(void 0,m.Z),b=(0,f.d)(),y=(0,n.useCallback)((e=>{let t;if("collection"===e.type)t="UpdatePageAction.updateCollection";else if("variable"===e.type)t="UpdatePageAction.updateVariable";else{if("page"===e.type)throw new Error("Not implemented yet.");(0,C.t1)(e)}d.createAndCommit({userAction:t,environment:c,perform:t=>{F.sW({store:o.getConfigStore(),transaction:t,data:{target:e,properties:null,values:null}})}}),h.reset()}),[c,o,h]),S=(0,n.useCallback)((()=>h.reset()),[h]);return(0,T.jsx)(p.ZP,{buttonPopupStore:h,popupType:b,alignmentToOrigin:p.vR.End,placementToOrigin:p.pO.Bottom,originGap:0,disabled:r,renderOrigin:e=>(0,T.jsx)(xe.S,{disabled:r,...x,...e,children:u&&"collection"===u.type?(0,T.jsx)(Pe.Z,{store:me.NW.createChildStore(t.context.parentRecordStore,u.collection)}):g?(0,T.jsx)(Ze.F,{value:g,format:Be.l.Medium,isSingle:!0}):(0,T.jsx)(l.FormattedMessage,{id:"automations.UpdatePagesAction.pagesDropdown.label",defaultMessage:"Select database"})}),render:e=>(0,T.jsx)(Te.L,{actionId:o.id,automationContextStore:t,onChange:y,onClose:S,selectedTarget:u,skipPages:!0})})}const Je={create_page:function(e){window.__c={n:"CreatePageAction"};const{contextStore:t,actionStore:o,disabled:r,showErrorIfPresent:s}=e,c=(0,i.O7)(),u=(0,a.VK)((()=>o.getCollectionStore()),[o]),p=(0,a.VK)((()=>{const e=o.getCollectionStore();if(e)return{collection:e.getSpaceShardedPointer(),type:"collection"}}),[o]),g=(0,a.VK)((()=>{var e;return null===(e=o.getConfig())||void 0===e?void 0:e.template_page_id}),[o]),m=(0,a.VK)((()=>(0,K.q)(u).length>0),[u]),x=(0,n.useCallback)((e=>{"collection"===e.type&&d.createAndCommit({userAction:"CreatePageAction.setCollection",environment:c,perform:t=>{F.sW({store:o.getConfigStore(),data:{collection:e.collection,properties:["title"],values:null,template_page_id:null},transaction:t})}})}),[c,o]),h=(0,n.useCallback)((e=>{d.createAndCommit({userAction:"CreatePageAction.setTemplate",environment:c,perform:t=>{const n=o.getConfig();if(!n)return;const{properties:i,values:a}=n;let r=!1;if(e&&i&&1===i.length&&i.includes("title")){var s;const e=null==a?void 0:a.title;e&&null!==(s=e.value)&&void 0!==s&&s.value||(r=!0)}F.sW({store:o.getConfigStore(),data:{template_page_id:e??null,...r&&{properties:[]}},transaction:t})}})}),[c,o]),f=(0,O.TU)({contextStore:t,actionId:o.id,shouldShow:s,errorKey:"collection"}),b=(0,O.TU)({contextStore:t,actionId:o.id,shouldShow:s,errorKey:"template"});return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J,{...e,title:(0,T.jsx)(l.FormattedMessage,{id:"automations.CreatePageAction.header",defaultMessage:"Add page to"}),picker:(0,T.jsxs)("div",{style:{display:"flex",alignItems:"center",whiteSpace:"normal"},children:[(0,T.jsx)(ae.a,{actionStore:o,currentValue:p,contextStore:t,onChange:x,disabled:r,errorMessage:f,skipVariables:!0}),u&&m&&(0,T.jsx)(l.FormattedMessage,{id:"automations.CreatePageAction.asTemplate",defaultMessage:"as {templateName}",values:{templateName:(0,T.jsx)(re.f,{collectionStore:u,currentTemplateId:g,onChange:h,disabled:r,errorMessage:b})}})]})}),u&&(0,T.jsx)(ie.QF,{contextStore:t,collectionStore:u,actionStore:o,disabled:r,showSetPropertyActions:!1})]})},update_pages:function(e){window.__c={n:"UpdatePagesAction"};const{contextStore:t,actionStore:o,disabled:r,showErrorIfPresent:s}=e,c=(0,i.O7)(),u=(0,l.useIntl)(),p=(0,a.VK)((()=>o.getTargetStore()),[o]),g=(0,a.VK)((()=>"collection"===p.getKeyStore("type").getValue()),[p]),m=(0,a.VK)((()=>{var e;const t=o.getCollectionTargetStore();return null==t||null===(e=t.getKeyStore("filter"))||void 0===e?void 0:e.getValue()}),[o]),x=(0,n.useCallback)((e=>{d.createAndCommit({userAction:"QueryCollectionAction.setFilter",environment:c,perform:t=>{F.sW({store:p,transaction:t,data:{filter:e}})}})}),[c,p]),h=(0,a.VK)((()=>{const e=p.getValue();if(e){if("collection"===e.type)return me.NW.createChildStore(t.context.parentRecordStore,e.collection);if("variable"===e.type){const o=t.compilationResultStore.state;if(qe.x.isFail(o))return;const n=(0,ze.vx)(o.value.valueTypes,e.id);if(n)return(0,Ye.wB)(n,t.context.parentRecordStore)}else{if("page"===e.type)return;(0,C.t1)(e)}}}),[p,t.context.parentRecordStore,t.compilationResultStore]),f=(0,a.VK)((()=>h?(0,$e.vU)({environment:c,intl:u,store:h}):void 0),[h,u,c]),b=(0,a.VK)((()=>m?(0,Ge.Ih)(m,(null==h?void 0:h.getSchema())||{}):void 0),[m,h]),y=(0,O.TU)({contextStore:t,actionId:o.id,shouldShow:s}),S=(0,a.VK)((()=>{var e;const n=null===(e=o.getVariableTargetStore())||void 0===e?void 0:e.getValue();if(!n)return!1;const i=t.getContextValueForActionById(o.id,n.id);return!!i&&"block"===i.type.type}),[o,t]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J,{...e,title:S?(0,T.jsx)(l.FormattedMessage,{id:"automations.UpdatePagesAction.singularHeader",defaultMessage:"Edit"}):(0,T.jsx)(l.FormattedMessage,{id:"automations.UpdatePagesAction.header",defaultMessage:"Edit pages in"}),picker:(0,T.jsx)(Xe,{contextStore:t,actionStore:o,disabled:r,errorMessage:y})}),g&&h&&(0,T.jsx)("div",{style:{margin:"0 0 -4px 8px"},children:(0,T.jsx)(ke,{keyComp:(0,T.jsx)(Me,{text:(0,T.jsx)(l.FormattedMessage,{id:"automations.UpdatePagesAction.filter.label",defaultMessage:"Pages to edit"})}),valueComp:(0,T.jsx)(De.W,{contextStore:t,filter:b,collectionStore:h,onChange:x,disabled:r,noFiltersMessage:(0,C.$K)(f)?(0,T.jsx)(l.FormattedMessage,{defaultMessage:"All pages in {collectionName}",id:"automations.UpdatePagesAction.filterRuleCount.noFilters.label",values:{collectionName:f}}):(0,T.jsx)(l.FormattedMessage,{defaultMessage:"All pages in database",id:"automations.UpdatePagesAction.filterRuleCount.noFilters.fallbackLabel",values:{collectionName:f}})})})}),h&&(0,T.jsx)(ie.QF,{contextStore:t,collectionStore:h,actionStore:o,disabled:r,showSetPropertyActions:!0})]})},query_collection:function(e){window.__c={n:"QueryCollectionAction"};const{contextStore:t,actionStore:o,disabled:r}=e,s=(0,i.O7)(),c=(0,a.VK)((()=>o.getCollectionStore()),[o]),u=(0,a.VK)((()=>{const e=o.getCollectionStore();if(e)return{collection:e.getSpaceShardedPointer(),type:"collection"}}),[o]),p=(0,a.VK)((()=>o.getConfigStore().getKeyStore("filter").getValue()),[o]),g=(0,a.VK)((()=>o.hasSort()),[o]),x=(0,a.VK)((()=>o.hasLimit()),[o]),h=(0,a.qz)(void 0,m.Z),f=(0,a.qz)(void 0,m.Z),b=(0,n.useCallback)((e=>{"collection"===e.type&&d.createAndCommit({userAction:"QueryCollectionAction.setCollection",environment:s,perform:t=>{F.sW({store:o.getConfigStore(),data:{collection:e.collection,filter:void 0,sort:void 0},transaction:t})}})}),[s,o]),y=(0,n.useCallback)((e=>{d.createAndCommit({userAction:"QueryCollectionAction.setFilter",environment:s,perform:t=>{F.sW({store:o.getConfigStore(),data:{filter:e},transaction:t})}})}),[s,o]),S=(0,n.useCallback)((()=>{h.setState({open:!0})}),[h]),C=(0,n.useCallback)((()=>{f.setState({open:!0})}),[f]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J,{...e,title:(0,T.jsx)(l.FormattedMessage,{id:"automations.QueryCollectionAction.title",defaultMessage:"Get pages from"}),picker:(0,T.jsx)(ae.a,{currentValue:u,contextStore:t,onChange:b,disabled:r})}),c&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{style:{margin:"0 8px"},children:[(0,T.jsx)(ke,{keyComp:(0,T.jsx)(Me,{text:(0,T.jsx)(l.FormattedMessage,{id:"automations.QueryCollectionAction.filter.label",defaultMessage:"Filter"})}),valueComp:(0,T.jsx)(De.W,{contextStore:t,collectionStore:c,filter:p,onChange:y,disabled:r,noFiltersMessage:(0,T.jsx)(l.FormattedMessage,{defaultMessage:"Return all pages",id:"automations.QueryCollectionAction.filterRuleCount.noFilters.label"})})}),g&&(0,T.jsx)(ke,{keyComp:(0,T.jsx)(Me,{text:(0,T.jsx)(l.FormattedMessage,{id:"automations.QueryCollectionAction.sort.label",defaultMessage:"Sort"})}),valueComp:(0,T.jsx)(He,{contextStore:t,collectionStore:c,actionStore:o,disabled:r,buttonPopupStore:h})}),x&&(0,T.jsx)(ke,{keyComp:(0,T.jsx)(Me,{text:(0,T.jsx)(l.FormattedMessage,{id:"automations.QueryCollectionAction.limit.label",defaultMessage:"Limit"})}),valueComp:(0,T.jsx)(Qe,{actionStore:o,disabled:r,buttonPopupStore:f})})]}),(0,T.jsx)(We,{collectionStore:c,actionStore:o,disabled:r,onSortAdded:S,onLimitAdded:C})]})]})},open_page:function(e){window.__c={n:"OpenPageAction"};const{contextStore:t,actionStore:o,disabled:r,showErrorIfPresent:s}=e,c=(0,i.O7)(),u=(0,n.useCallback)((e=>{d.createAndCommit({userAction:"OpenPageAction.setTarget",environment:c,perform:t=>{F.sW({store:o.getConfigStore(),data:{target:e},transaction:t})}})}),[c,o]),p=(0,a.VK)((()=>{var e;return null===(e=o.getConfig())||void 0===e?void 0:e.target}),[o]),g=(0,O.TU)({contextStore:t,actionId:o.id,shouldShow:s});return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J,{...e,title:(0,T.jsx)(l.FormattedMessage,{id:"automations.OpenPageAction.header",defaultMessage:"Open"}),picker:(0,T.jsx)(Ve,{actionStore:o,target:p,onChange:u,contextStore:t,disabled:r,errorMessage:g})}),(0,T.jsx)("div",{style:{margin:"0 8px"},children:(0,T.jsx)(ke,{keyComp:(0,T.jsx)(Me,{text:(0,T.jsx)(l.FormattedMessage,{id:"automations.OpenPageAction.openPageIn.label",defaultMessage:"Open page in"})}),valueComp:(0,T.jsx)(_e,{...e})})})]})},duplicate_blocks:function(e){window.__c={n:"DuplicateBlocksAction"};const{actionStore:t,disabled:o}=e,n=(0,a.VK)((()=>se.Ps(t.getBlockPointers())),[t],{useDeepEqual:!0});return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J,{...e,title:(0,T.jsx)(l.FormattedMessage,{id:"automations.DuplicateBlocksAction.header",defaultMessage:"Insert blocks"}),picker:(0,T.jsx)(ye,{actionStore:t,disabled:o})}),n?(0,T.jsx)(fe,{...e,contentParentPointer:n}):null]})},modal_confirmation:function(e){window.__c={n:"ModalConfirmationAction"};const{actionStore:t,disabled:o}=e,s=(0,i.O7)(),u=(0,l.useIntl)(),p=(0,r.yK)((e=>({wrap:{display:"flex",flexDirection:"column",gap:10},plainTextInput:{backgroundColor:e.contentBackground,paddingTop:6,paddingBottom:6}})),[]),g=(0,a.VK)((()=>t.getType()),[t]),m=(0,a.VK)((()=>t.getConfigStore().getKeyStore("text")),[t]),x=(0,a.VK)((()=>m.getValue()),[m]),h=(0,n.useCallback)((e=>{d.createAndCommit({userAction:"BaseModalAction.handleTextChange",environment:s,perform:t=>{F.sO({store:m,value:e,transaction:t})}})}),[s,m]),f=t.getConfigStore().getKeyStore("continue_button").getKeyStore("text"),b=(0,a.VK)((()=>t.getConfigStore().getKeyStore("cancel_button").getKeyStore("text")),[t]);if(!g)return null;const S=(0,y.z)(g);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(J,{...e,title:(0,T.jsx)(l.FormattedMessage,{...S.display.name})}),(0,T.jsxs)("div",{style:p.wrap,children:[(0,T.jsx)(Ce.D,{disabled:o,value:x,onChange:h,multiline:!0,placeholder:u.formatMessage(Ae.confirmationInputPlaceholder),disableFormattingAndMentions:!0,disableMobileActionBar:!0}),(0,T.jsx)(je,{overlayContent:(0,T.jsx)(l.FormattedMessage,{...Ae.continueButtonHint}),children:(0,T.jsx)(ve.Y,{disabled:o,maxlength:c.OO,style:p.plainTextInput,store:f})}),(0,T.jsx)(je,{overlayContent:(0,T.jsx)(l.FormattedMessage,{...Ae.cancelButtonHint}),children:(0,T.jsx)(ve.Y,{disabled:o,maxlength:c.OO,style:p.plainTextInput,store:b})})]})]})},slack_notification:()=>null};function et(e){window.__c={n:"AutomationAction"};const{contextStore:t,buttonPlacement:o,actionStore:n,disabled:i,dragging:s,showErrorIfPresent:l,onActionAdded:c}=e,d=(0,r.yK)((e=>({container:{background:e.contentBackground,borderRadius:5,display:"flex",flexDirection:"column",gap:8,padding:8,marginLeft:12,marginRight:12,marginBottom:8,fontSize:14,boxShadow:s?e.mediumBoxShadow:e.lightBoxShadow,width:"calc(100% - 24px)"},nameRow:{display:"flex",alignItems:"center",marginBottom:4},name:{flexGrow:1,fontWeight:I.Z.fontWeight.medium,marginLeft:8},iconWrap:{width:24,height:24,display:"flex",alignItems:"center",borderRadius:4,background:"rgba(35, 131, 226, 0.14)"},icon:{width:14,height:14,fill:e.blueColor,margin:"0 auto"}})),[s]),[u,p]=(0,a.VK)((()=>n.hasConcern("display")?[n,n.getType()]:[void 0,void 0]),[n]);if(!n||!p)return null;const g=Je[p];return(0,T.jsx)("div",{style:d.container,children:(0,T.jsx)(g,{contextStore:t,actionStore:u,buttonPlacement:o,disabled:i,dragging:s,showErrorIfPresent:l,onActionAdded:c})})}function tt(e){window.__c={n:"AutomationButtonActionList"};const{contextStore:t,buttonPlacement:o,disabled:n,suppressErrors:s,onActionAdded:l}=e,u=(0,i.O7)(),p=(0,a.VK)((()=>t.context.automationStore.getActionStores()),[t.context.automationStore]),m=(0,a.VK)((()=>p.map((e=>e.id))),[p]),f=(0,a.qz)(void 0,x.Z),b=(0,a.VK)((()=>f.state.isDragging),[f]),y=(0,a.VK)((()=>f.state.isDragging&&f.state.draggingKey),[f]),S=!n&&p.length<c.FT,C=(0,r.yK)((e=>({actionsLineWrap:{cursor:b?"grabbing":void 0,position:"relative"},actionLine:{position:"absolute",top:0,bottom:8,left:28,width:4,background:e.accentColors.gray[100],zIndex:1},actionsWrap:{position:"relative",zIndex:2}})),[b]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{style:C.actionsLineWrap,children:[(0,T.jsx)("div",{style:C.actionLine}),(0,T.jsx)("div",{style:C.actionsWrap,children:(0,T.jsx)(g.ZP,{direction:"vertical",disabled:n,keys:m,onDrop:e=>{d.createAndCommit({userAction:"AutomationButtonAction.moveAction",environment:u,perform:o=>{h.kM({clientContext:t.context,transaction:o,newActionIds:e})}})},renderKey:e=>{const i=p.find((t=>t.id===e));return i?(0,T.jsx)(et,{actionStore:i,contextStore:t,buttonPlacement:o,disabled:n,dragging:y===e,onActionAdded:l,showErrorIfPresent:Array.isArray(s)?!s.includes(i.id):!s},i.id):null},store:f})})]}),S&&(0,T.jsx)(ot,{contextStore:t,disabled:n,onActionAdded:l})]})}function ot(e){window.__c={n:"AddActionButton"};const{contextStore:t,disabled:o,onActionAdded:c}=e,d=(0,i.O7)(),{device:g}=d,[x,h]=(0,n.useState)(!0),b=(0,r.yK)((e=>({buttonWrap:{boxShadow:"initial",background:"transparent"},button:{color:e.mediumTextColor,fill:e.mediumIconColor},buttonIcon:{width:24,height:g.isMobile?18:16,marginRight:-2}})),[g.isMobile]),y=(0,a.qz)(void 0,m.Z),S=(0,f.d)(),C=(0,a.VK)((()=>t.context.automationStore.hasAnyActions()),[t.context.automationStore]);return(0,n.useEffect)((()=>{!C&&x&&(y.setState({open:!0}),h(!1))}),[y,C,x]),(0,T.jsx)(p.ZP,{popupType:S,alignmentToOrigin:p.vR.Start,placementToOrigin:p.pO.Bottom,originGap:0,buttonPopupStore:y,disabled:o,renderOrigin:e=>(0,T.jsx)(u.Z,{focused:!1,style:b.buttonWrap,buttonStyle:b.button,icon:(0,s.R)(b.buttonIcon),title:C?(0,T.jsx)(l.FormattedMessage,{id:"automations.addActionButton.nonEmpty.label",defaultMessage:"Add another step"}):(0,T.jsx)(l.FormattedMessage,{id:"automations.addActionButton.empty.label",defaultMessage:"Add a step"}),...e}),render:e=>(0,T.jsx)(V,{contextStore:t,onActionAdded:t=>{c(t),e.close()}})})}},19471:(e,t,o)=>{o.d(t,{Y:()=>m,b:()=>g});var n=o(67294),i=o(480),a=o(86628),r=o(9953),s=o(98104),l=o(39699),c=o(21199),d=o(1743),u=o(74194),p=o(85893);function g(e){window.__c={n:"AutomationPlainTextInput"};const{value:t,onChange:o,wrapStyle:i,...a}=e,[r,l]=(0,n.useState)(!1);return(0,p.jsx)(d.Z,{capture:r,children:(0,p.jsx)(c.Z,{capture:!0,render:e=>(0,p.jsx)("div",{...e,style:i,children:(0,p.jsx)(u.Z,{value:t,onChange:e=>o(e.currentTarget.value),onBlur:()=>{l(!1)},onFocus:()=>{s.o9(),l(!0)},...a})})})})}function m(e){window.__c={n:"ConnectedAutomationPlainTextInput"};const{store:t,...o}=e,s=(0,i.O7)(),c=(0,a.VK)((()=>t.getValue()??""),[t]),d=(0,n.useCallback)((e=>{l.createAndCommit({userAction:"AutomationPlainTextInput.setValue",environment:s,perform:o=>{r.sO({store:t,transaction:o,value:e})}})}),[s,t]);return(0,p.jsx)(g,{value:c,onChange:d,...o})}},49446:(e,t,o)=>{o.r(t),o.d(t,{PlacedButtonBlockEditor:()=>Q,buttonBlockMessages:()=>U});var n=o(67294),i=o(480),a=o(86628),r=o(24405),s=o(63362),l=o(65955),c=o(5366),d=o(97880),u=o(27153),p=o(9953),g=o(24677),m=o(98104),x=o(39699),h=o(68709),f=o(42922),b=o(73063),y=o(53437),S=o(31278),C=o(53336),v=o(72495),A=o(26388),j=o(13148),w=o(95094),k=o(82990),M=o(42402),B=o(85893);const P="https://www.notion.so/help/template-buttons";function Z(e){window.__c={n:"FactoryButtonMigrationBanner"};const{handleDismissBanner:t}=e,o=(0,r.yK)((e=>({banner:{width:"100%",display:"flex",alignItems:"start",backgroundColor:e.accentColors.blue["light"===e.mode?50:300],borderRadius:4,padding:12,fontSize:12,lineHeight:1.5,gap:8},icon:{width:12,color:e.blueColor},bannerContent:{flex:"1 1 auto"},bannerTitle:{fontWeight:k.Z.fontWeight.medium},bannerCaption:{color:e.mediumTextColor},closeButton:{borderRadius:"50%"},starIcon:{flex:"0 0 auto",marginBlockStart:3},link:{color:e.text.interactive}})),[]);return(0,B.jsxs)("div",{style:o.banner,children:[(0,B.jsx)("div",{style:o.starIcon,children:(0,w.p)(o.icon)}),(0,B.jsxs)("div",{style:o.bannerContent,children:[(0,B.jsx)("div",{style:o.bannerTitle,children:(0,B.jsx)(c.FormattedMessage,{id:"factoryButton.deprecationBanner.title",defaultMessage:"Your buttons just got better"})}),(0,B.jsx)("div",{style:o.bannerCaption,children:(0,B.jsx)(c.FormattedMessage,{id:"factoryButton.deprecationBanner.caption",defaultMessage:"Now you can create, edit and open pages and <buttonsHelpCenterLink>more</buttonsHelpCenterLink>.",values:{buttonsHelpCenterLink:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,B.jsx)(M.Z,{href:P,disableUnderline:!0,style:o.link,children:t})}}})})]}),(0,B.jsx)(b.Z,{icon:j.U,ariaLabel:"closeButton",style:o.closeButton,onClick:()=>t()})]})}var T=o(59557),V=o(72187),_=o(12534),I=o(33929),F=o(98742),O=o(63474),K=o(34859),L=o(68910),D=o(90106),R=o(35294),W=o(82343);var E=o(6253),H=o(19471);const U=(0,c.defineMessages)({addIconButtonAriaLabel:{defaultMessage:"Add icon",id:"buttonBlock.button.addIconButtonAriaLabel"},editButtonAriaLabel:{defaultMessage:"Edit button",id:"buttonBlock.button.editButtonAriaLabel"},buttonPlaceholder:{defaultMessage:"New button",id:"buttonBlock.button.placeholder"},buttonInsufficientPermissions:{defaultMessage:"You don’t have permission to run this button",id:"buttonBlock.button.insufficientPermissions"},clickToEdit:{defaultMessage:"Click to edit button",id:"buttonBlock.button.clickToEdit"}});function Q(e){window.__c={n:"PlacedButtonBlockEditor"};const{buttonBlockStore:t}=e,o=(0,a.VK)((()=>t.state.editing?t.state:void 0),[t]),n=(0,r.yK)((e=>({popup:{width:400},editor:{background:e.sidebarBackground,..."inline"===(null==o?void 0:o.placement.type)?{marginTop:6,borderRadius:6,border:`1px solid ${e.regularDividerColor}`,maxWidth:600}:{}}})),[null==o?void 0:o.placement.type]),i=(0,R.d)({tabletBehavior:"slideUp"});return o?"popup"===o.placement.type?(0,B.jsx)(y.ZP,{open:!0,popupType:i,render:()=>(0,B.jsx)(N,{...e,style:n.editor}),originRect:o.placement.originRect,style:n.popup,originGap:4,onDismiss:()=>{t.stopEditing()}}):"inline"===o.placement.type?(0,B.jsx)(N,{...e,style:n.editor}):void(0,d.t1)(o.placement):null}function N(e){window.__c={n:"ButtonBlockEditor"};const{disabled:t,store:o,buttonBlockStore:d}=e,y=(0,i.O7)(),j=y.currentUser.id,w=(0,c.useIntl)(),k=(0,r.yK)((e=>({header:{display:"flex",alignItems:"center",padding:"12px 12px 8px 12px",gap:6},scroller:{maxHeight:"75vh"},nameInputWrap:{flexGrow:"1"},factoryButtonDeprecationBanner:{margin:"12px 12px 6px 12px"}})),[]),M=(0,O.D)(),P=(0,a.VK)((()=>o.getAutomationStore()),[o]),R=(0,a.VK)((()=>null==P?void 0:P.getNameStore()),[P]),Q=(0,a.VK)((()=>null==P?void 0:P.getIconStore()),[P]),N=(0,a.VK)((()=>(null==R?void 0:R.getValue())??""),[R]),G=function(e){const{store:t,automationStore:o}=e,n=(0,i.O7)().currentUser.id;return(0,a.VK)((()=>{const e=t.getRecordStoreUIRoot();if(o&&e instanceof D.G)return(0,W.Gb)({type:"button_block",persisted:!0,automationStore:o,blockStore:t,pageStore:e,intl:I.default.getIntl(),parentRecordStore:o,currentUserId:n})}),[o,t,n])}({store:o,automationStore:P}),z=(0,a.VK)((()=>{var e;return o.canEdit()&&"sufficient"===(null==G||null===(e=G.state)||void 0===e?void 0:e.executionPermissionStatus)}),[o,G]),{showFactoryButtonDeprecationBanner:q,handleDismissFactoryButtonMigrationBanner:Y}=(0,T.N)({blockStore:o}),$=(0,a.VK)((()=>null==Q?void 0:Q.getValue()),[Q]),X=(0,a.VK)((()=>{const e=o.getRecordStoreUIRoot();if(e instanceof D.G)return e}),[o]),J=(0,a.VK)((()=>d.state.editing?d.state.placement:void 0),[d]),ee=(0,n.useMemo)((()=>{if(P&&X)return new L.L({type:"button_block",persisted:!0,automationStore:P,blockStore:o,pageStore:X,intl:I.default.getIntl(),parentRecordStore:P,currentUserId:j})}),[P,X,o,j]),te=(0,n.useCallback)((e=>{(0,_.ZP)({event:e,context:_.Af.EditorClick,callback:()=>{m.ZH(y),g.ZH(y)}})}),[y]),oe=(0,n.useCallback)((()=>{d.stopEditing(),(0,s.lN)(M,{block_id:o.id,automation_id:null==P?void 0:P.id})}),[P,d,o,M]),ne=(0,n.useCallback)(((e,t)=>{P&&x.createAndCommit({userAction:"ButtonBlock.updateProperty",environment:y,perform:o=>{p.sW({store:P.getPropertiesStore(),transaction:o,data:{[e]:t??null}})}})}),[P,y]),ie=(0,n.useCallback)((e=>ne("icon",e)),[ne]),ae=(0,n.useCallback)((e=>ne("name",e)),[ne]),re=(0,n.useCallback)((e=>{u.$(y,{originRect:e.currentTarget.getBoundingClientRect(),originGap:4,popupWidth:V.FZ,popupHeight:V.kX,isSmallWidth:!1,title:w.formatMessage({defaultMessage:"Icon",id:"buttonBlock.button.iconHeading"}),currentTab:"icon",tabs:[{type:"icon",onChange:e=>{ie(e),u.Z()}},{type:"emoji",onChange:(e,t)=>{ie(e),u.Z()}}],onDelete:()=>{ie(void 0),u.Z()}})}),[y,ie,w]),se=(0,a.VK)((()=>d.state.suppressErrorsForActionIds),[d]),le=t||!z;if(!ee)return null;const ce=e=>(0,B.jsx)(b.Z,{ariaLabel:w.formatMessage(U.addIconButtonAriaLabel),style:{width:26,height:26},iconStyle:{width:16,height:16},hasBackground:!0,disabled:le,showShadow:!0,icon:e=>$?(0,B.jsx)(S.Z,{disabled:!0,isEmptyPage:!1,size:24,icon:{icon:$,pointer:o.pointer},style:e}):(0,l.o)(e),...(0,F.Z)(e??{},{onClick:re})}),de=$?ce():(0,B.jsx)(A.Z,{renderTooltip:()=>(0,B.jsx)(c.FormattedMessage,{defaultMessage:"Add an icon",id:"buttonBlock.button.addIcon"}),delayThreshold:300,render:ce});return(0,B.jsxs)("div",{style:e.style,onClick:te,children:[q&&(0,B.jsx)("div",{style:k.factoryButtonDeprecationBanner,children:(0,B.jsx)(Z,{handleDismissBanner:Y})}),(0,B.jsxs)(h.p,{allowSelectionWithin:!0,style:k.header,children:[de,(0,B.jsx)(H.b,{onChange:ae,value:N,disabled:le,placeholder:I.default.formatMessage(U.buttonPlaceholder),wrapStyle:k.nameInputWrap}),(0,B.jsx)(f.Z,{onClick:oe,children:(0,B.jsx)(c.FormattedMessage,{defaultMessage:"Done",id:"buttonBlock.button.done"})})]}),(0,B.jsx)(C.Z,{style:k.scroller,type:K.Z.Y,children:(0,B.jsxs)(v.Z,{mobileStyle:{boxShadow:"initial"},mobileTitleStyle:{textTransform:"none",marginTop:8},title:(0,B.jsx)(c.FormattedMessage,{id:"buttonBlock.actions",defaultMessage:"When button is clicked"}),children:[(0,B.jsx)(E.AutomationButtonActionList,{contextStore:ee,buttonPlacement:J,disabled:le,suppressErrors:se,onActionAdded:e=>{d.suppressErrorsForAction(e)}}),(0,B.jsx)("div",{})]})})]})}},69872:(e,t,o)=>{o.d(t,{L:()=>d,Z:()=>p});o(67294);var n=o(83355),i=o(39068),a=o(52821),r=o(87279),s=o(52275),l=o(28992),c=o(85893);let d=function(e){return e[e.Name=0]="Name",e[e.Type=1]="Type",e}({});class u extends n.Z{renderComponent(){const{name:e,type:t,icon:o}=this.props.propertySchema,n=this.props.format===d.Name?e:a.SO[t],{theme:r}=this;return this.props.locked?(0,c.jsx)(l.Z,{title:n,icon:(0,c.jsx)(i.ZP,{icon:o,type:t,size:this.environment.device.isMobile?18:16,theme:r,style:{fill:r.regularIconColor}}),...this.props}):(0,c.jsx)(s.Z,{title:n,icon:(0,c.jsx)(i.ZP,{icon:o,type:t,size:this.environment.device.isMobile?18:16,theme:r,style:{fill:r.regularIconColor,marginLeft:6,marginRight:2}}),...this.props})}}u.displayName="PropertyMenuItem",u.DisplayFormat=d,u.contextTypes={...r.mw,...n.w};const p=u},40745:(e,t,o)=>{o.d(t,{M:()=>a});o(67294);var n=o(45238),i=o(85893);const a=(0,n.I)("arrowDown",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 1.57715C7.5625 1.57715 7.25488 1.88477 7.25488 2.33594V10.8262L7.30957 12.3027L5.50488 10.2861L3.95312 8.75488C3.82324 8.625 3.63184 8.53613 3.42676 8.53613C3.0166 8.53613 2.70898 8.85059 2.70898 9.26758C2.70898 9.46582 2.78418 9.64355 2.94141 9.80762L7.44629 14.3193C7.59668 14.4697 7.79492 14.5586 8 14.5586C8.20508 14.5586 8.40332 14.4697 8.55371 14.3193L13.0586 9.80762C13.2158 9.64355 13.291 9.46582 13.291 9.26758C13.291 8.85059 12.9902 8.53613 12.5801 8.53613C12.3682 8.53613 12.1836 8.625 12.0469 8.75488L10.4951 10.2861L8.69043 12.2959L8.74512 10.8262V2.33594C8.74512 1.88477 8.44434 1.57715 8 1.57715Z"})})},8597:(e,t,o)=>{o.d(t,{Z:()=>a});o(67294);var n=o(45238),i=o(85893);const a=(0,n.I)("arrowUp",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 14.5586C8.44434 14.5586 8.74512 14.251 8.74512 13.7998V5.30957L8.69043 3.83984L10.4951 5.84961L12.0469 7.38086C12.1836 7.51074 12.3682 7.59961 12.5801 7.59961C12.9902 7.59961 13.291 7.28516 13.291 6.86816C13.291 6.66992 13.2158 6.49219 13.0586 6.32812L8.55371 1.81641C8.40332 1.66602 8.20508 1.57715 8 1.57715C7.79492 1.57715 7.59668 1.66602 7.44629 1.81641L2.94141 6.32812C2.78418 6.49219 2.70898 6.66992 2.70898 6.86816C2.70898 7.28516 3.0166 7.59961 3.42676 7.59961C3.63184 7.59961 3.82324 7.51074 3.95312 7.38086L5.50488 5.84961L7.30957 3.83301L7.25488 5.30957V13.7998C7.25488 14.251 7.5625 14.5586 8 14.5586Z"})})},1230:(e,t,o)=>{o.d(t,{H:()=>a});o(67294);var n=o(45238),i=o(85893);const a=(0,n.I)("insertDown",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M9.55548 13.0343H14.2085C14.5315 13.0343 14.7951 13.2913 14.7951 13.6142C14.7951 13.9372 14.5315 14.1942 14.2085 14.1942H9.55548C9.23254 14.1942 8.9755 13.9372 8.9755 13.6142C8.9755 13.2913 9.23254 13.0343 9.55548 13.0343ZM1.21167 9.67959C1.21167 9.09961 1.52802 8.74371 2.0421 8.74371C2.55617 8.74371 2.87911 9.11279 2.87911 9.65982V10.7868C2.87911 10.945 2.96479 11.0373 3.12956 11.0373H4.70473V10.365C4.70473 9.818 5.26494 9.60709 5.68675 9.94322L7.56509 11.4525C7.84849 11.6766 7.84849 12.0786 7.56509 12.2961L5.68675 13.812C5.25176 14.1679 4.70473 13.9569 4.70473 13.3836V12.7047H2.93184C1.89051 12.7047 1.21167 12.0984 1.21167 11.057V9.67959ZM9.55548 9.58073H14.2085C14.5315 9.58073 14.7951 9.83777 14.7951 10.1607C14.7951 10.4837 14.5315 10.7407 14.2085 10.7407H9.55548C9.23254 10.7407 8.9755 10.4837 8.9755 10.1607C8.9755 9.83777 9.23254 9.58073 9.55548 9.58073ZM1.78506 6.12721H14.2085C14.5315 6.12721 14.7951 6.38425 14.7951 6.70719C14.7951 7.03014 14.5315 7.28717 14.2085 7.28717H1.78506C1.46211 7.28717 1.20508 7.03014 1.20508 6.70719C1.20508 6.38425 1.46211 6.12721 1.78506 6.12721ZM1.78506 2.68028H14.2085C14.5315 2.68028 14.7951 2.93073 14.7951 3.25367C14.7951 3.5832 14.5315 3.83365 14.2085 3.83365H1.78506C1.46211 3.83365 1.20508 3.5832 1.20508 3.25367C1.20508 2.93073 1.46211 2.68028 1.78506 2.68028Z"})})},95094:(e,t,o)=>{o.d(t,{p:()=>a});o(67294);var n=o(45238),i=o(85893);const a=(0,n.I)("starFilled",{viewBox:"0 0 24 24",svg:(0,i.jsx)("path",{d:"M4.603 22.837c.375.277.826.2 1.4-.22l6.002-4.411 6.003 4.41c.561.42 1.024.498 1.387.221.375-.276.463-.73.232-1.403l-2.346-7.075 6.047-4.366c.572-.41.77-.83.627-1.271-.143-.432-.55-.653-1.255-.653l-7.424.045-2.269-7.108C12.787.32 12.457 0 12.005 0c-.463 0-.782.32-1.002 1.006l-2.27 7.108-7.423-.045c-.716 0-1.123.221-1.266.653-.144.442.066.862.638 1.27l6.036 4.367-2.335 7.075c-.231.674-.143 1.127.22 1.403z"})})}}]);