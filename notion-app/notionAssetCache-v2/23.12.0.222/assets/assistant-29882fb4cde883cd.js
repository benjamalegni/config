"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[8721],{29003:(e,t,n)=>{n.r(t),n.d(t,{AssistantChatStep:()=>Ve,AssistantLabelerBar:()=>Ye,AssistantMenuPopup:()=>hi,AssistantOriginElement:()=>gt,SearchAssistantPane:()=>ki,assistantActions:()=>i});var i=n(63737),a=n(67294),o=n(480),s=n(6740),r=n(86628),l=n(24405),c=n(15145),d=n(36591),u=n(77058),p=n(49019),m=n(33676),h=n(97022),g=n(39986),f=n(10498),x=n(72126),y=n(4615),v=n(23867),k=n(70203),S=n(97880),C=n(5366),w=n(50906),b=n(34602),j=n(64964),I=n(23063),M=n(52275),A=n(31945),T=n(73063),_=n(91839),B=n(78140),Z=n(32163),F=n(72495),P=n(26388),V=n(95477),R=n(60682),L=n(14976),K=n(35683),W=n(87279),E=n(49085);class O extends E.default{getInitialState(){return{}}}const D=new O;var z=n(82375),N=n(61766),U=n(90106);class H extends E.default{getInitialState(){return{open:!1,inferenceId:void 0}}}const q=new H;n(21703);var Q=n(18466),G=n(26263),$=n(88891),Y=n(21202),X=n(19889),J=n(14871),ee=n(39699),te=n(15201),ne=n(55217),ie=n(49065),ae=n(85893);function oe(e){window.__c={n:"AssistantChatMessageRenderer"};const{clientStep:t}=e,n=(0,o.O7)(),i=(0,a.useMemo)((()=>Q.Z.withListenerIgnored((()=>function(e){const{environment:t,clientStep:n}=e,i=new G.Z({name:"AssistantChatMessageRenderer"}),a=t.currentUser.id;if(!a)throw new Error("No current user.");const o={table:X.KJ,id:a},s=ee.createAndCommit({userAction:"AssistantChatMessageRenderer.temporaryListStore",environment:t,perform:e=>{for(const r of n.operations){const n=(0,$.ND)({assistantOperation:r,actorPointer:o,getRecordValue:i.makeGetRecordValueFn(a),spaceId:e.spaceId});for(const o of n){let n;n=o.pointer.table===Y.iU?new U.G(t,o.pointer,{inMemoryRecordCache:i}):new ie.ST({environment:t,pointer:o.pointer,path:o.path,inMemoryRecordCache:i}),ee.applyOperation({store:n,operation:o,transaction:e}),n instanceof U.G&&i.setModelAndRole({pointer:o.pointer,userId:a},n.getModel(),"reader")}}const s=n.blockIds.map((e=>new U.G(t,{table:Y.iU,id:e},{inMemoryRecordCache:i})));return J.Lh({environment:t,stores:s,inMemoryRecordCache:i,transaction:e})}}).performResult;return i.addCacheFallback(t.defaultRecordCache.inMemoryRecordCache),s}({environment:n,clientStep:t})))),[n,t]);return(0,ae.jsx)(te.O,{displayName:"AssistantChatStepContent",disabled:!0,children:(0,ae.jsx)(ne.Z,{store:i,disabled:!0,disableCommentMenu:!0,disableHoverMenu:!0,disableDrag:!0})})}var se=n(82990),re=n(24677),le=n(2456),ce=n(865),de=n(61519),ue=n(84076),pe=n(76798),me=n(90706),he=n(84210),ge=n(95802),fe=n(80444),xe=n(5737);function ye(e){window.__c={n:"AssistantTransactionRenderer"};const{clientStep:t}=e,n=(0,$.rn)(t.operations),i=(0,l.yK)((e=>({divider:{marginTop:6,marginBottom:6},subheader:{color:e.mediumTextColor}})),[]);return(0,ae.jsx)(ae.Fragment,{children:n.map(((e,t)=>(0,ae.jsxs)(a.Fragment,{children:[(0,ae.jsx)(ve,{group:e},t),n[t+1]&&(0,ae.jsx)(de.Z,{style:i.divider,size:1})]},t)))})}function ve(e){window.__c={n:"AssistantTransactionGroupRenderer"};const{group:t}=e,n=(0,l.yK)((e=>({header:{marginBottom:6,color:e.mediumTextColor},pageTitle:{display:"inline",color:e.regularTextColor,fontWeight:se.Z.fontWeight.semibold,whiteSpace:void 0,overflow:void 0,textOverflow:void 0,textDecoration:"underline"},divider:{marginBottom:6},subheader:{color:e.mediumTextColor}})),[]),i=(0,r.VK)((()=>{const{mainEditorCurrentBlockStore:e}=fe.default.state;if(!e)throw new Error("No main editor current block store");return e}),[]),a=(0,r.VK)((()=>i.getSpaceId()),[i]),o=U.G.createChildStore(i,{table:Y.iU,id:t.pageId,spaceId:a}),s=(0,r.VK)((()=>{if("updatedPage"!==t.type)return[];const e=o.getParentCollectionStore(),n=null==e?void 0:e.getSchema();return x.oA(Array.from(t.updatedPropertyNames).map((e=>{const t=Object.entries(n||{}).find((t=>{let[,n]=t;return(null==n?void 0:n.name)===e}));if(t)return t[0]})))}),[o,t]),d=(0,r.VK)((()=>t.pageId===i.id?(0,he.ZP)({store:i,pageVisitSource:c.tY.AIChat,fullyQualified:!1}):(0,he.ZP)({store:i,pageVisitSource:c.tY.AIChat,fullyQualified:!1,peekViewBlockId:t.pageId})),[i,t.pageId]);if("updatedPage"===t.type){const{insertedBlockIds:e,updatedBlockIds:i,removedBlockIds:a,updatedTitle:r,updatedPropertyNames:l}=t,c=e.size+i.size+a.size+(r?1:0)+l.size;return(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(ue.Z,{style:n.header,href:d,children:(0,ae.jsx)("span",{children:t.didCreatePage?(0,ae.jsx)(C.FormattedMessage,{defaultMessage:"Created {page}",id:"assistant.transactionRenderer.createdPage.title",values:{page:(0,ae.jsx)(pe.Z,{store:o,style:n.pageTitle})}}):(0,ae.jsx)(C.FormattedMessage,{defaultMessage:"{numEdits, plural, one {1 edit to {page}} other {{numEdits} edits to {page}}}",id:"assistant.transactionRenderer.editedPage.title",values:{numEdits:c,page:(0,ae.jsx)(pe.Z,{store:o,style:n.pageTitle})}})})}),r&&(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)("div",{style:n.subheader,children:"Updated title"}),(0,ae.jsx)(Se,{blockIds:[t.pageId]})]}),s.length>0&&(0,ae.jsx)(ae.Fragment,{children:s.map(((e,t)=>(0,ae.jsx)(ke,{pageStore:o,property:e},t)))}),e.size>0&&(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)("div",{style:n.subheader,children:`Inserted ${e.size} block${e.size>1?"s":""}`}),(0,ae.jsx)(Se,{blockIds:Array.from(e)})]}),i.size>0&&(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)("div",{style:n.subheader,children:`Updated ${i.size} block${i.size>1?"s":""}`}),(0,ae.jsx)(Se,{blockIds:Array.from(i)})]}),a.size>0&&(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)("div",{style:n.subheader,children:`Removed ${a.size} block${a.size>1?"s":""}`}),(0,ae.jsx)(Se,{blockIds:Array.from(a)})]})]})}if("removedPage"===t.type)return(0,ae.jsx)(ue.Z,{style:n.header,href:d,children:(0,ae.jsx)("span",{children:(0,ae.jsx)(C.FormattedMessage,{defaultMessage:"Deleted {page}",id:"assistant.transactionRenderer.removedPage.title",values:{page:(0,ae.jsx)("span",{style:{fontWeight:se.Z.fontWeight.bold},children:(0,ae.jsx)(pe.Z,{store:o,style:n.pageTitle})})}})})});(0,S.t1)(t)}function ke(e){window.__c={n:"BlockPropertyRenderer"};const{pageStore:t,property:n}=e,i=(0,r.VK)((()=>t.getParentCollectionStore()),[t]),a=(0,r.VK)((()=>{const e=null==i?void 0:i.getSchema(),t=Object.entries(e||{}).find((e=>{let[t]=e;return t===n}));return null==t?void 0:t[1]}),[i,n]),o=(0,r.VK)((()=>t.getPropertyValue(n)),[t,n]);return i&&a?(0,ae.jsx)(ae.Fragment,{children:(0,ae.jsx)(le.Hq,{labeled:!0,name:a.name,type:a.type,icon:a.icon,style:{marginBottom:6},children:(0,ae.jsx)(me.Z,{propertySchema:a,beforeValue:{value:[],spaceId:i.getSpaceId()},afterValue:{value:o||[],spaceId:i.getSpaceId()},rootStore:t})})}):null}function Se(e){window.__c={n:"BlockListRenderer"};const{blockIds:t}=e,n=(0,o.O7)(),i=(0,a.useMemo)((()=>Q.Z.withListenerIgnored((()=>{const e=ge.C.findSelectablesFromIds(t),i=t.map((t=>{if(!xe.N.state)throw new Error("No state");const i=e.find((e=>e.props.store.id===t));return(null==i?void 0:i.props.store)||new U.G(n,{table:Y.iU,id:t},{inMemoryRecordCache:xe.N.state.temporaryCache})}));return re.rs(i),i}))),[n,t]);return(0,ae.jsx)(te.O,{displayName:"AssistantBlockRenderer",disabled:!0,children:i.map(((e,t)=>(0,ae.jsx)(Ce,{store:e},t)))})}function Ce(e){window.__c={n:"BlockRenderer"};const{store:t}=e,n=(0,r.VK)((()=>(0,ce.h)(t)),[t]);return n?(0,ae.jsx)(n,{store:t,disabled:!0,isFirstItem:!1,isLastItem:!1}):null}var we=n(39040),be=n(54642),je=n(42922),Ie=n(60458),Me=n(36488),Ae=n(74194),Te=n(63296),_e=n(64369),Be=n(92660);const Ze=["Difficult to understand","Does not answer my question","Contains irrelevant details","Contains misleading or made-up information","Uses outdated information","I don't fully trust this answer"];function Fe(){window.__c={n:"ReportBadQnAForm"};const e=(0,l.yK)((e=>({reasonsArea:{width:"100%",background:e.popoverBackground,display:"block",marginBottom:16},title:{},checkboxArea:{display:"flex",alignItems:"center",gap:8},modalWrap:{width:"32rem",padding:24,fontSize:14},modalTitle:{fontSize:16,fontWeight:se.Z.fontWeight.medium},modalSubtitle:{fontSize:14},titleContainer:{marginBottom:16},buttonArea:{display:"flex",justifyContent:"flex-end",marginTop:18},outlineButton:{marginRight:12},selectAll:{fontWeight:500,marginBottom:4},checkboxContainer:{display:"flex",flexDirection:"column",gap:4},linkTruncated:{maxWidth:"16rem",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}})),[]),[t,n]=(0,a.useState)([]),i=(0,a.useCallback)((e=>()=>{t.includes(e)?n((t=>t.filter((t=>t!==e)))):n((t=>[...t,e]))}),[t]),s=e=>t.includes(e),[c,d]=(0,a.useState)(),[u,p]=(0,a.useState)([]),m=(0,r.VK)((()=>fe.default.state.currentSpaceStore),[]),h=(0,o.O7)(),g=(0,l.Fg)(),f=(0,a.useCallback)((()=>{const{inferenceId:e}=q.state,n=null==m?void 0:m.id;e&&n&&(be.saveAssistantFeedback(h,{type:"slackbot_followup_feedback",id:e,notes:c||"",reasons:t,correctAnswerPageIds:u}),q.reset())}),[null==m?void 0:m.id,h,c,t,u]),x=(0,a.useCallback)((e=>{u.includes(e)?p((t=>t.filter((t=>t!==e)))):p((t=>[...t,e]))}),[u]),y=(0,a.useCallback)((e=>u.includes(e)),[u]),v=(0,r.VK)((()=>{var e,t,n;const i=null===(e=z.XN.state)||void 0===e||null===(e=e.evaluator)||void 0===e||null===(e=e.codeEvaluator)||void 0===e?void 0:e.state,a=fe.default.state.currentSpaceStore,o=null===(t=z.XN.state)||void 0===t||null===(t=t.evaluator)||void 0===t?void 0:t.getTranscript().filter((e=>"observation"===e.type&&"search"===e.observationType)),s=null==o||null===(n=o[o.length-1])||void 0===n?void 0:n.value;if(!s||!a)return[];const r=(0,we.P)(s)[0];if("element"===(l=r).type&&"search-results"===l.tagName&&(null===(c=l.children)||void 0===c?void 0:c.every((e=>"element"===e.type&&"page-result"===e.tagName)))){return r.children.map((e=>{var t;return((null==e||null===(t=e.attributes)||void 0===t?void 0:t.id)&&(null==i?void 0:i.getIdMapper().mapCounterToKey(e.attributes.id).key))??void 0})).filter((e=>!!e)).map((e=>({pageId:e,component:(0,L.IY)({environment:h,parentStore:a,textValue:{value:[(0,k.YCD)(["p",e])],spaceId:a.id},disableHover:!1,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,disabled:!0,theme:g,emojiType:(0,R.e_)(h),katex:h.KatexStore.getKatex(),formulaValueTypes:[]})})))}var l,c;return[]}),[h,g]);return(0,ae.jsx)(Be.Z,{onDismiss:Pe,render:()=>(0,ae.jsx)(Me.Z,{capture:!0,allowUndo:!0,allowEsc:!0,allowTabUntab:!1,render:t=>(0,ae.jsxs)("div",{style:e.modalWrap,...t,children:[(0,ae.jsx)("div",{style:e.titleContainer,children:(0,ae.jsx)("div",{style:e.modalTitle,children:(0,ae.jsx)(C.FormattedMessage,{id:"BadQnAFeedbackForm.title",defaultMessage:"Report bad question & answer"})})}),(0,ae.jsxs)("div",{style:e.reasonsArea,children:[(0,ae.jsx)("div",{style:e.selectAll,children:"What should we know about this answer?"}),(0,ae.jsx)("div",{style:e.checkboxContainer,children:Ze.map((t=>(0,ae.jsxs)("div",{style:e.checkboxArea,children:[(0,ae.jsx)(Ie.Z,{checked:s(t),onClick:i(t),size:14,checkSize:10}),(0,ae.jsx)(_e.Z,{style:e.title,children:t})]},t)))})]}),(0,ae.jsxs)("div",{style:e.reasonsArea,children:[(0,ae.jsx)("div",{style:e.selectAll,children:"Do any of these pages have the correct answer?"}),(0,ae.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:4},children:v.map(((t,n)=>(0,ae.jsxs)("div",{style:e.checkboxArea,children:[(0,ae.jsx)(Ie.Z,{checked:y(t.pageId),onClick:()=>x(t.pageId),size:14,checkSize:10}),(0,ae.jsx)("div",{style:e.linkTruncated,onClick:e=>{e.preventDefault(),e.stopPropagation(),e.currentTarget.firstElementChild instanceof HTMLAnchorElement&&window.open(e.currentTarget.firstElementChild.href,"_blank")},children:t.component})]},t.pageId)))})]}),(0,ae.jsx)(Ae.Z,{textarea:!0,placeholder:"Additional comments...",value:c,onChange:e=>d(e.target.value),focusInitial:!0,inputStyle:{padding:8}}),(0,ae.jsxs)("div",{style:e.buttonArea,children:[(0,ae.jsx)(Te.Z,{isLarge:!0,onClick:Pe,style:e.outlineButton,children:(0,ae.jsx)(C.FormattedMessage,{id:"BadQnAFeedbackForm.cancelButton.label",defaultMessage:"Cancel"})}),(0,ae.jsx)(je.Z,{isLarge:!0,onClick:f,children:(0,ae.jsx)(C.FormattedMessage,{id:"BadQnAFeedbackForm.reportButton.label",defaultMessage:"Submit"})})]})]})}),requireOnline:!0,modalStore:q})}function Pe(){q.update((()=>({open:!1,inferenceId:void 0})))}function Ve(e){window.__c={n:"AssistantChatStep"};const{clientStep:t,parentStore:n,parentSpaceId:i,fakeSlackUser:c,configurationState:d}=e,u=(0,o.O7)(),m=(0,l.Fg)(),h=(0,l.yK)((e=>({wrap:{display:"flex",marginTop:6,marginBottom:6,gap:6},baseMessage:{maxWidth:"80%",borderRadius:16,border:`1px solid ${e.accentColors.gray[75]}`,padding:"8px 12px",fontSize:14,whiteSpace:"pre-wrap",overflowWrap:"break-word",position:"relative"},userLabel:{fontSize:12,color:e.mediumTextColor},humanMessage:{backgroundColor:e.accentColors.gray[30],color:e.accentColors.gray[500],border:"unset"},assistantThinkMessage:{backgroundColor:e.accentColors.gray[50],color:e.mediumTextColor},assistantMessage:{backgroundColor:e.contentBackground,color:e.darkTextColor,boxShadow:"0px 2px 4px 0px rgba(0, 0, 0, 0.04), 0px 0px 6px 0px rgba(0, 0, 0, 0.02)"}})),[]),g=(0,r.VK)((()=>{if("human"===t.type)return{shouldWrap:!0,value:(0,ae.jsx)(ae.Fragment,{children:(0,L.IY)({environment:u,textValue:{value:t.text,spaceId:(0,v.C)(i)},parentStore:n,disableHover:!1,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,disabled:!0,theme:m,emojiType:(0,R.e_)(u),katex:u.KatexStore.getKatex(),formulaValueTypes:[]})})};if("assistantLoading"===t.type)return{shouldWrap:!0,value:(0,ae.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,ae.jsx)(C.FormattedMessage,{id:"AssistantChatStep.thinking",defaultMessage:"Thinking"}),(0,ae.jsx)("div",{style:{marginLeft:6},children:(0,ae.jsx)(_.Z,{})})]})};if("assistantThink"===t.type)return{shouldWrap:!0,value:(0,ae.jsx)(ae.Fragment,{children:`💡 ${t.thought}`})};if("assistantChatText"===t.type)return{shouldWrap:!0,value:(0,ae.jsx)(ae.Fragment,{children:t.text})};if("assistantChat"===t.type)return{shouldWrap:!0,value:(0,ae.jsx)(oe,{clientStep:t})};if("assistantTransaction"===t.type)return{shouldWrap:!0,value:(0,ae.jsx)(ye,{clientStep:t})};if("assistantLoadPage"===t.type)return{shouldWrap:!0,value:(0,ae.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,ae.jsx)(C.FormattedMessage,{id:"AssistantChatStep.loadPage",defaultMessage:"Reading pages"}),(0,ae.jsx)("div",{style:{marginLeft:6},children:(0,ae.jsx)(_.Z,{})})]})};if("assistantFriendlyError"===t.type)return{shouldWrap:!0,value:(0,ae.jsx)(ae.Fragment,{children:(0,ae.jsx)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:"I'm sorry! I wasn't able to complete this query. Please try asking me a different question."})})};if("assistantSearch"===t.type)return{shouldWrap:!0,value:(0,ae.jsx)(ae.Fragment,{children:(0,ae.jsxs)("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap"},children:[(0,p.e)({width:14,marginRight:4}),(0,ae.jsx)("b",{children:"Search "}),t.question]})})};if("assistantSearchPeople"===t.type)return{shouldWrap:!0,value:(0,ae.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,ae.jsx)(C.FormattedMessage,{id:"AssistantChatStep.searchPeople",defaultMessage:"Looking up people"}),(0,ae.jsx)("div",{style:{marginLeft:6},children:(0,ae.jsx)(_.Z,{})})]})};if("queryDatabase"===t.type)return{shouldWrap:!0,value:(0,ae.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,ae.jsx)(C.FormattedMessage,{id:"AssistantChatStep.queryDatabase",defaultMessage:"Querying databases"}),(0,ae.jsx)("div",{style:{marginLeft:6},children:(0,ae.jsx)(_.Z,{})})]})};if("assistantShowSearchResults"===t.type){const{searchResults:e}=t,i=new Map;return e.forEach((e=>{i.set(e,(0,L.IY)({environment:u,parentStore:n,textValue:{value:[(0,k.YCD)(["p",e])],spaceId:n.id},disableHover:!0,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,disabled:!0,theme:m,emojiType:(0,R.e_)(u),katex:u.KatexStore.getKatex(),formulaValueTypes:[]}))})),{shouldWrap:!1,value:(0,ae.jsx)(We,{links:i,parentStore:n})}}(0,S.t1)(t)}),[t,u,i,n,m]),[f,y]=(0,a.useState)(!1),b=(0,a.useMemo)((()=>(0,x.Ds)(y,100)),[y]);return g.shouldWrap?(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(P.Z,{placement:P.Z.Placement.Left,textWrap:!0,style:{maxWidth:240},disableTooltip:!("thought"in t&&t.thought,0),renderTooltip:()=>"thought"in t?`💡 ${t.thought}`:void 0,delayThreshold:500,render:e=>(0,ae.jsxs)("div",{style:h.wrap,...e,onClick:e=>{e.target instanceof HTMLSpanElement&&null!=d&&d.isQnA&&w.lO(u,d,e.target.baseURI.split("/").slice(-1)[0])},onFocus:t=>{var n;null===(n=e.onFocus)||void 0===n||n.call(e,t),(0,s.E)(t.target)&&b(!0)},onMouseEnter:t=>{var n;null===(n=e.onMouseEnter)||void 0===n||n.call(e,t),b(!0)},onBlur:t=>{var n;null===(n=e.onBlur)||void 0===n||n.call(e,t),b(!1)},onMouseLeave:t=>{var n;null===(n=e.onMouseLeave)||void 0===n||n.call(e,t),b(!1)},children:["human"===t.type&&(0,ae.jsx)("div",{style:{flexGrow:1}}),(0,ae.jsx)("div",{style:{...h.baseMessage,..."human"===t.type?h.humanMessage:"assistantThink"===t.type?h.assistantThinkMessage:h.assistantMessage},children:g.value}),"assistantChat"===t.type?(0,ae.jsx)(Re,{configurationState:d,environment:u,isVisible:f}):null]})}),c&&"human"===t.type&&(0,ae.jsxs)("div",{style:{display:"flex"},children:[(0,ae.jsx)("div",{style:{flexGrow:1}}),(0,ae.jsx)("div",{style:h.userLabel,children:c.name})]})]}):g.value}function Re(e){let{configurationState:t,environment:n,isVisible:o}=e;window.__c={n:"AssistantFeedbackButtons"};const{current:s}=(0,a.useRef)((0,y.ZP)()),c=(0,r.VK)((()=>D.state[s]??void 0),[s]),d=(0,l.yK)((e=>({thumbsUpFeedbackButton:{width:16,height:16,fill:"thumbs_up"===c?e.blueButtonBackground:e.grayButtonHoveredBackground},thumbsDownFeedbackButton:{width:16,height:16,fill:"thumbs_down"===c?e.blueButtonBackground:e.grayButtonHoveredBackground}})),[c]),p=(0,a.useMemo)((()=>Boolean(t&&t.isQnA)),[t]),x=(0,a.useCallback)((async()=>{await i.saveFeedback({environment:n,inferenceId:s,type:"assistant_thumbs_up"}),D.update((e=>({...e,[s]:"thumbs_up"}))),j.oV({label:(0,ae.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,u.$)({width:16,height:16}),"Thanks for your feedback!"]})})}),[n,s]),v=(0,a.useCallback)((async()=>{await i.saveFeedback({environment:n,inferenceId:s,type:"assistant_thumbs_down"}),D.update((e=>({...e,[s]:"thumbs_down"}))),q.update((()=>({open:!0,inferenceId:s})))}),[n,s]);return(0,ae.jsx)(I.Z,{isVisible:!0,animationStyle:{opacity:o||Boolean(c)?1:0},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:1},render:()=>(0,ae.jsxs)("div",{style:{marginTop:"auto"},children:[(0,ae.jsx)(Le,{type:"up",iconHollow:g.P,iconFilled:f.w,onClick:x,style:d.thumbsUpFeedbackButton,feedbackReceived:c}),(0,ae.jsx)(Le,{type:"down",iconHollow:m.A,iconFilled:h.E,onClick:v,style:d.thumbsDownFeedbackButton,feedbackReceived:c}),p?(0,ae.jsx)(Fe,{}):null]})})}function Le(e){let{type:t,iconHollow:n,iconFilled:i,feedbackReceived:a,style:o,onClick:s}=e;const r=a===`thumbs_${t}`;return(0,ae.jsx)(T.Z,{icon:r?i:n,onClick:r?()=>{}:s,disableBackground:r,iconStyle:{cursor:r?"initial":"pointer",...o},ariaLabel:`Thumbs ${t} feedback on assistant message`})}function Ke(e){window.__c={n:"AssistantSearchResultsThinkingState"};const{links:t}=e,[n,i]=(0,a.useState)(0),o=(0,l.yK)((e=>({wrapper:{display:"flex",paddingBottom:6,paddingTop:6,alignItems:"center",maxWidth:"80%",borderRadius:12,backgroundColor:e.accentColors.purple[50],boxShadow:e.buttonBoxShadow},assistantMessage:{color:e.aiPurpleColor,marginLeft:12,fontSize:14,whiteSpace:"pre-wrap",overflowWrap:"break-word",position:"relative"}})),[]);(0,a.useEffect)((()=>{const e=setInterval((()=>{i((e=>e+1))}),1500);return()=>clearInterval(e)}),[]);const s=(0,a.useMemo)((()=>[...t.values()]),[t]),r=(0,a.useMemo)((()=>s.map(((e,t)=>({index:t,value:(0,ae.jsx)("div",{style:{marginRight:6,marginLeft:4,display:"flex",alignItems:"center"},children:(0,ae.jsx)(C.FormattedMessage,{id:"AssistantChatStep.searchingText",defaultMessage:"Reading {link}",values:{link:(0,ae.jsx)("div",{style:{marginLeft:4,marginTop:3,maxWidth:180,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e})}})})})))),[s]),{value:c,index:d}=n>=s.length?{index:n,value:(0,ae.jsx)("div",{style:{marginRight:6,marginLeft:4,fontWeight:"500"},children:(0,ae.jsx)(C.FormattedMessage,{id:"AssistantChatStep.summarize",defaultMessage:"Summarizing"})})}:r[n];return(0,ae.jsxs)("div",{style:o.wrapper,children:[(0,ae.jsx)(I.Z,{blockRenderQueueOnEnter:!0,isVisible:!0,render:()=>(0,ae.jsx)("div",{style:o.assistantMessage,children:c})},d),(0,ae.jsx)("div",{style:{display:"flex",alignItems:"center",marginLeft:2},children:(0,ae.jsx)(_.Z,{})})]})}function We(e){window.__c={n:"AssistantSearchResultsChatStep"};const t=(0,l.yK)((e=>({textStyles:{color:e.lightTextColor,fontSize:12},checkIconStyles:{width:12,height:17,marginRight:6,color:e.lightTextColor},tooltipRenderStyles:{fontWeight:"500",cursor:"pointer",display:"inline-block"},tooltipInnerStyles:{display:"flex",flexDirection:"column",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4},completedInlineStyle:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:6,marginTop:6},wrap:{display:"flex",marginTop:6,marginBottom:6},assistantMessage:{backgroundColor:e.contentBackground,color:e.darkTextColor,boxShadow:e.buttonBoxShadow},baseMessage:{maxWidth:"80%",borderRadius:12,padding:"6px 10px",fontSize:14,whiteSpace:"pre-wrap",overflowWrap:"break-word",position:"relative"}})),[]),{links:n,parentStore:i}=e,s=function(){const[e,t]=(0,a.useState)(!1),[n,i]=(0,a.useState)(!1),o=(0,r.VK)((()=>{const e=z.XN.state;return!!e&&Boolean(e.temporaryClientSteps.find((e=>"assistantChat"===e.type||"assistantTransaction"===e.type)))}),[]),s=(0,r.VK)((()=>!!z.XN.state&&!o&&z.XN.state.isCurrentlyCommittingHumanStep),[o]);return(0,a.useEffect)((()=>{!e||s||n||i(!0)}),[e,s,n]),(0,a.useEffect)((()=>{s&&!e&&t(!0)}),[e,s]),!(!s||n)}(),c=(0,o.O7)();return s?(0,ae.jsx)(Ke,{links:n}):(0,ae.jsxs)("div",{style:t.completedInlineStyle,children:[(0,d.e)(t.checkIconStyles),(0,ae.jsx)(Ee,{environment:c,links:n,parentStore:i})]})}function Ee(e){let{environment:t,links:n,parentStore:i}=e;window.__c={n:"PagesSearchResultDiscoveredInMenu"};const a=(0,r.qz)(void 0,N.Z),o=(0,l.yK)((e=>({notionAiTitle:{fontWeight:"500",display:"inline-block"},textStyles:{color:e.lightTextColor,fontSize:12},tooltipRenderStyles:{fontWeight:"500",cursor:"pointer",display:"inline-block"},tooltipInnerStyles:{display:"flex",flexDirection:"column",paddingLeft:4,paddingRight:4,paddingTop:4,paddingBottom:4}})),[]);return(0,ae.jsx)(A.ZP,{popupType:t.device.isMobile?A.Z4.SlideUp:A.Z4.Popup,buttonPopupStore:a,render:e=>{const a={key:"section",render:e=>(0,ae.jsx)(F.Z,{...e}),items:[...n.entries()].map((n=>{let[a,o]=n;return{key:`something-${(0,y.ZP)()}`,render:e=>(0,ae.jsx)(M.Z,{focused:!1,onClick:e.onClick,title:o}),action:()=>{e.close();const n=U.G.createChildStore(i,{table:"block",id:a});b.navigateToBlock({environment:t,store:n,visitType:K.vu.Link,pageVisitSource:c.tY.AISlackQna})}}}))};return(0,ae.jsx)(B.Z,{menuType:W.og.Popup,minWidth:260,maxWidth:"100vw",children:(0,ae.jsx)(Z.Z,{type:Z.i.Vertical,initialFocus:void 0,sections:[a]})})},renderOrigin:e=>{let{onClick:t}=e;const i=(0,ae.jsx)(C.FormattedMessage,{id:"AssistantChatStep.searchResults.message",defaultMessage:"<bold>Notion AI</bold> found the answer in <span>{pageCount} {numPage, plural, one {page} other {pages}}</span>",values:{bold:e=>(0,ae.jsx)("div",{style:o.notionAiTitle,children:e}),span:e=>(0,ae.jsx)("div",{style:o.tooltipRenderStyles,children:e}),numPage:n.size,pageCount:n.size>5?"5+":n.size}});return(0,ae.jsx)("div",{onClick:t,style:o.textStyles,children:i})}})}var Oe=n(94568),De=n(42875),ze=n(59054),Ne=n(98104),Ue=n(88359),He=n(1743),qe=n(68785),Qe=n(53437),Ge=n(45959),$e=n(24666);function Ye(){window.__c={n:"AssistantLabelerBar"};const e=(0,o.O7)(),t=(0,l.yK)((e=>({wrap:{padding:8,backgroundColor:e.contentBackground,width:400},samplingPicker:{display:"flex",alignItems:"center",marginBottom:8,gap:4},error:{fontSize:14,color:e.accentColors.red[600],maxHeight:150,overflow:"scroll"},observation:{fontSize:14,maxHeight:150,overflow:"scroll"},tooltip:{width:500,whiteSpace:"pre-wrap",fontFamily:se.Z.baseFontFamily.mono},input:{marginTop:5,marginBottom:5,fontFamily:se.Z.baseFontFamily.githubMono,fontSize:12},inputInner:{height:100}})),[]),n=(0,r.VK)((()=>z.Hl.state),[]),s=(0,r.VK)((()=>z.XN.state),[]),c=(0,r.VK)((()=>xe.N.state),[]),d=(0,r.VK)((()=>Boolean(s&&s.sampledSteps.length>0)),[s]),u=(0,r.VK)((()=>Boolean(c&&(c.sampling||c.evaluating))),[c]),p=(0,r.VK)((()=>null==s?void 0:s.previewingStepIndex),[s]),m=(0,r.VK)((()=>{const e=null==s?void 0:s.previewingStepIndex;var t;if("number"==typeof e)return null==s||null===(t=s.sampledSteps)||void 0===t?void 0:t[e]}),[s],{useDeepEqual:!0}),h=(0,r.VK)((()=>(null==s?void 0:s.previewingStepObservations)||[]),[s],{useDeepEqual:!0}),g=h.filter((e=>"error"===e.observationType)),f=h.filter((e=>"error"!==e.observationType)),x=(0,a.useCallback)((()=>{i.cancelPreviewStep()}),[]),y=(0,a.useCallback)((async t=>{if(!m||!s)return;const n={...m,value:t.target.value};(0,z.zZ)({store:z.XN,step:n}),await i.simulateOrCommitStep({environment:e,step:n,commit:!1,isStreaming:!1,preventSelection:!0})}),[e,m,s]),v=(0,a.useCallback)((async t=>{s&&await i.simulateOrCommitStep({environment:e,step:s.sampledSteps[t],commit:!1,isStreaming:!1})}),[e,s]),k=(0,a.useCallback)((async()=>{if(!s)return;const t=s.previewingStepObservations.length>0;await i.commitPreviewAssistantStep({environment:e}),t||await i.applyUncommittedOperations({environment:e})}),[e,s]),S=(0,a.useCallback)((async()=>{await i.retryNextAssistantSteps({environment:e})}),[e]),C=(0,r.VK)((()=>({top:20,left:0,right:0,bottom:0,width:e.WindowSizeStore.state.width,height:0})),[e],{useDeepEqual:!0}),[w,b]=(0,a.useState)(!1),j=(0,a.useCallback)((()=>{$e.default.hasSelection()&&Ne.ZH(e),b(!0)}),[e,b]),I=(0,a.useCallback)((()=>{b(!1)}),[b]),M=V.default.isLocalhost||!1;return(0,ae.jsx)(Qe.ZP,{popupType:Qe.kQ.Popup,open:!0,originRect:C,originGap:6,disableMouseCapture:!0,render:()=>(0,ae.jsx)(He.Z,{capture:w,children:(0,ae.jsxs)("div",{style:t.wrap,children:[(0,ae.jsx)(Xe,{}),d&&(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsxs)("div",{style:t.samplingPicker,children:[(0,ae.jsx)(Te.Z,{hovered:void 0===p||void 0,onClick:x,children:"Original"}),(0,ae.jsx)(Te.Z,{hovered:0===p||void 0,onClick:()=>v(0),children:"A"}),(0,ae.jsx)(Te.Z,{hovered:1===p||void 0,onClick:()=>v(1),children:"B"}),(0,ae.jsx)("div",{style:{flexGrow:1}}),u&&(0,ae.jsx)(qe.Z,{style:{marginRight:4}}),(0,ae.jsx)(Te.Z,{disabled:!M&&(void 0===p||u||!n),disabledFeedback:!0,onClick:S,children:"Retry"}),(0,ae.jsx)(Te.Z,{disabled:!M&&(void 0===p||u||!n),disabledFeedback:!0,onClick:k,isBlue:!0,children:"Accept"})]}),m&&(0,ae.jsx)(Ae.Z,{style:t.input,inputStyle:t.inputInner,value:m.value,onChange:y,onFocus:j,onBlur:I,textarea:!0,spellCheck:!1}),g.length>0&&!u&&(0,ae.jsx)("div",{style:t.error,children:g.map((e=>e.value)).join("\n")}),f.length>0&&!u&&(0,ae.jsxs)("div",{style:t.observation,children:["Results: ",f.map((e=>e.value)).join("\n")]})]})]})})})}function Xe(e){var t;window.__c={n:"TaskPicker"};const n=(0,o.O7)(),i=(0,r.VK)((()=>z.Hl.state),[]),[s]=(0,ze.r5)((async()=>{const e="results",t={type:"reducer",filter:{operator:"and",filters:[{property:"ouFf",filter:{operator:"status_is",value:{type:"is_group",value:"In progress"}}}]},sort:[],userId:n.currentUser.id,userTimeZone:(0,De.r)(),searchQuery:void 0,reducers:{[e]:{type:"results",limit:100}}},i=await be.queryCollection(n,{source:{type:"collection",id:"f704a995-6417-457a-8038-ca9e1cb2c65f",spaceId:Oe.vj},collectionView:{id:"1dee420b-aa96-4e48-8eba-c2a0613e179e",spaceId:Oe.vj},loader:t},void 0,{src:"queryCollectionAction"});if("failed"===i.type)return;const a=i.data.result.reducerResults.results;if(!a||"results"!==a.type)return;const{blockIds:o}=a;let s=x.oA(o.map((e=>new U.G(n,{table:Y.iU,id:e}).getValue()))).map((e=>{var t,n,i;return{id:e.id,name:(0,k.QaF)(null==e||null===(t=e.properties)||void 0===t?void 0:t.title),url:(0,k.QaF)(null==e||null===(n=e.properties)||void 0===n?void 0:n["}v_K"]),type:(0,k.QaF)(null==e||null===(i=e.properties)||void 0===i?void 0:i.pdfW)}}));return s=x.MR(s,(e=>e.name.toLowerCase())),s}),[n]),c=(0,a.useCallback)((e=>{var t;const n=null===(t=s.value)||void 0===t?void 0:t.find((t=>t.id===e));n&&z.Hl.setState(n)}),[s]),d={menuTitle:"",items:(null===(t=s.value)||void 0===t?void 0:t.map((e=>e.id)))??[],getKey:e=>e,selectedItem:null==i?void 0:i.id,onSelect:c,renderItem:e=>{var t;const n=null===(t=s.value)||void 0===t?void 0:t.find((t=>t.id===e.value));return(0,ae.jsx)(M.Z,{...e,title:null==n?void 0:n.name})},renderOrigin:e=>(0,ae.jsx)(Ue.Z,{focused:!1,title:"",right:(null==i?void 0:i.name)||(0,ae.jsx)("span",{style:{color:"red"},children:"Please select a task"}),...e}),width:300},u=(0,l.yK)((e=>({wrap:{marginBottom:8},inner:{display:"flex",alignItems:"center",marginBottom:4,gap:4},label:{fontSize:14,flexShrink:0},link:{fontSize:14,textDecoration:"underline"}})),[]);return(0,ae.jsxs)("div",{style:u.wrap,children:[(0,ae.jsxs)("div",{style:u.inner,children:[(0,ae.jsx)("div",{style:u.label,children:"Current task:"}),(0,ae.jsx)(Ge.Z,{...d})]}),i&&(0,ae.jsx)(ue.Z,{style:u.link,href:i.url,external:!0,children:"Instructions for task"})]})}var Je=n(41892),et=n(5257),tt=n(11751),nt=n(51454),it=n(41752),at=n(16091),ot=n(55031),st=n(64921),rt=n(91909),lt=n(28020),ct=n(12921),dt=n(24646),ut=n(4926),pt=n(33932),mt=n(44500),ht=n(56206);function gt(e){window.__c={n:"AssistantOriginElement"};const t=(0,o.O7)(),n=(0,l.Fg)(),s=(0,r.VK)((()=>ct.fG.isQnAOnlyEnabled()),[]),c=(0,l.yK)((e=>({faceImg:{width:s?18:42,fill:s?e.aiPurpleColor:e.mediumIconColor,pointerEvents:"none"}})),[s]),[d,u]=(0,a.useState)(!1),[p,m]=(0,a.useState)(!1),h=(0,r.VK)((()=>{var e;return Boolean(null===(e=z.XN.state)||void 0===e?void 0:e.isCurrentlyCommittingHumanStep)??!1}),[]),g=(0,r.VK)((()=>{var e;return(null===(e=ht.d.state)||void 0===e?void 0:e.open)??!1}),[]);(0,a.useEffect)((()=>{h||!d||g||m(!0),h&&!d&&u(!0)}),[d,g,h]);const f=(0,a.useCallback)((async()=>{const{currentUserSettingsStore:e}=fe.default.state;e&&(0,it.C)(t,{phase:"complete",transactionUserAction:"AiQnaIntroModal.debug.clickTooltipClose",userSettingsStore:e}),m(!1),u(!1),pt.O({view:"chat"}),s&&(xe.N.state||await i.resetAssistantStore({environment:t,primeTextInput:void 0,clientSkill:mt.lU}),w.IR(t,{configurationState:xe.N.state,hasQuery:!1,from:"button",searchSessionId:void 0}))}),[t,s]),x=(0,r.VK)((()=>(0,ot.y)(t,{theme:n,rightEdgeDistance:16,isInPeekRenderer:!1,width:37})),[t,n]),y=(0,a.useMemo)((()=>(0,tt.t)({...c.faceImg})),[c.faceImg]),v=(0,a.useRef)(null),k=(0,r.VK)((()=>{const{currentUserSettingsStore:e,currentSpaceStore:n,mainEditorCurrentBlockStore:i}=fe.default.state;if(!e||!e.isReady())return!1;if(!n||!i||!i.canRead())return!1;if(t.device.isMobile)return!1;const a=e.getSettings();return!!a&&"tooltip"===a.ai_qna_intro_onboarding_phase}),[t.device]);return h||p?(0,ae.jsx)(ft,{onClick:f,isAnswerReady:p}):(0,ae.jsxs)(ae.Fragment,{children:[k&&(0,ae.jsx)(at.gc,{origin:v}),(0,ae.jsx)(st.Z,{ariaLabel:"ai",className:"notion-ai-button",style:{...x,...k?{border:"3px solid #b6cce7"}:{}},onClick:f,ref:v,children:s?y:(0,ae.jsx)("img",{style:c.faceImg,src:Je.Z.images.aiFaceLookleftPng})})]})}function ft(e){let{onClick:t,isAnswerReady:n}=e;window.__c={n:"QnaBackgroundProcessingElement"};const i=(0,l.yK)((e=>({sparklesIcon:{height:15,width:17,fill:e.icon.purple},aiProcessingButtonTopLevelStyle:{display:"flex",alignItems:"center",flexDirection:"row",marginLeft:12.5,marginRight:14,height:52},sparklesIconWrapperStyle:{borderRadius:"100%",background:e.whiteButtonBackground,height:30,width:30,display:"flex",alignItems:"center",justifyContent:"center",border:`1px solid ${e.outlineButtonBorder}`},messagesWrapperStyle:{display:"flex",flexDirection:"column",justifyContent:"center",marginLeft:8},notionAiTitleStyle:{fontSize:12,fontWeight:"500",color:e.lightTextColor},answerReadyStyle:{fontSize:13,fontWeight:"500",color:e.aiPurpleColor,display:"flex",alignItems:"center"},preparingYourAnswerStyle:{fontSize:13,fontWeight:"500",color:e.aiPurpleColor},chevronRightStyle:{height:19,width:15,opacity:.2,marginLeft:"auto"}})),[]),a=(0,l.Fg)(),s=(0,o.O7)(),c=(0,r.VK)((()=>function(e){const{rightEdgeDistance:t,theme:n,environment:i,isInPeekRenderer:a,width:o,height:s}=e,r=(0,dt.ll)(i,a)-(0,dt.vJ)(i);return{position:"absolute",bottom:16+ut.Z.state,right:t+ut.Z.state,width:o,height:s,borderRadius:100,fontSize:20,boxShadow:n.lightBoxShadow,zIndex:nt.hT,background:n.aiPurpleTranslucentRadialGradientBackground,backgroundBlendMode:"overlay, normal",opacity:lt.tu.state?0:1,transform:`translateX(-${r}px) translateZ(0)`,transition:`\n\t\t\topacity ${rt.Z.transitionDuration}ms,\n\t\t\tcolor ${rt.Z.transitionDuration}ms,\n\t\t\ttransform 200ms\n\t\t`}}({rightEdgeDistance:16,isInPeekRenderer:!1,width:278,height:52,environment:s,theme:a})),[s,a]);return(0,ae.jsx)(st.Z,{ariaLabel:"ai processing",className:"notion-ai-button",onClick:t,style:c,children:(0,ae.jsxs)("div",{style:i.aiProcessingButtonTopLevelStyle,children:[(0,ae.jsx)("div",{style:i.sparklesIconWrapperStyle,children:(0,tt.t)(i.sparklesIcon)}),(0,ae.jsxs)("div",{style:i.messagesWrapperStyle,children:[(0,ae.jsx)("div",{style:i.notionAiTitleStyle,children:(0,ae.jsx)(C.FormattedMessage,{id:"AssistantOriginElement.notionAiTitle",defaultMessage:"Notion AI"})}),n?(0,ae.jsx)("div",{style:i.answerReadyStyle,children:(0,ae.jsx)(C.FormattedMessage,{id:"AssistantOriginElement.answerReady",defaultMessage:"Your answer is ready"})}):(0,ae.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,ae.jsx)("div",{style:i.preparingYourAnswerStyle,children:(0,ae.jsx)(C.FormattedMessage,{id:"AssistantOriginElement.notionAiLoadingText",defaultMessage:"Preparing your answer"})}),(0,ae.jsx)("div",{style:{marginLeft:6,fontWeight:"500"},children:(0,ae.jsx)(_.Z,{})})]})]}),(0,et.o)(i.chevronRightStyle)]})})}var xt=n(4023),yt=n(37652),vt=n(89968),kt=n(13148),St=n(56666),Ct=n(2985),wt=n(19471),bt=n(89728),jt=n(77907),It=n(69454),Mt=n(41432),At=n(71644),Tt=n(6287),_t=n(13493),Bt=n(91644),Zt=n(94419),Ft=n(9953),Pt=n(89912);function Vt(e){const{environment:t}=e,n=t.currentUser.id,i=Date.now();if(!n)throw new Error("No current user.");return{created_time:i,created_by_id:n,created_by_table:X.KJ,last_edited_time:i,last_edited_by_id:n,last_edited_by_table:X.KJ}}function Rt(e){const{environment:t,skillValue:n,transaction:i}=e,{inMemoryRecordCache:a}=t.defaultRecordCache,o=Ft.ae({environment:t,table:Bt.AT,value:{...n,...Vt({environment:t})},inMemoryRecordCache:a,transaction:i});return Pt.L.addLocallyCreatedSkillId(o.id),o}async function Lt(e){const{environment:t,clientSkill:n}=e,a=z.Pl.state,o=Boolean(a);n.inAppSkillTrigger&&((0,pt.O)({view:"chat"}),await(0,i.resetAssistantStore)({environment:t,isLabelerSlackMode:o,fakeSlackChannel:null==a?void 0:a.selectedFakeChannel,clientSkill:n}),n.inAppSkillTrigger.requiresInput||await(0,i.sampleNextAssistantSteps)({environment:t,inferenceId:(0,y.ZP)()}))}function Kt(e){const{store:t,update:n,transaction:i}=e;Ft.sW({store:t.getSettingsStore(),data:n,transaction:i})}var Wt=n(7057),Et=n(53877),Ot=n(47307),Dt=n(97444),zt=n(53336),Nt=n(17809),Ut=n(34859);function Ht(e){window.__c={n:"AssistantActionButton"};const{style:t,icon:n,disabled:i,iconStyle:a,title:o,onClick:s,focused:r}=e,c=(0,l.yK)((e=>({AssistantActionButton:{background:e.cardContentBackground,display:"flex",alignItems:"center",boxShadow:e.borderBoxShadow,padding:"6px 10px",color:e.regularTextColor,fontSize:14,borderRadius:24,width:"max-content"},icon:{width:14,height:14,fill:e.regularIconColor,marginRight:6}})),[]);return(0,ae.jsxs)(st.Z,{disabled:i,style:{...c.AssistantActionButton,...t},onClick:s,focused:r,children:[null==n?void 0:n({...c.icon,...a}),o]})}var qt=n(83176),Qt=n(79198),Gt=n(98519),$t=n(55863);function Yt(e){window.__c={n:"AssistantFeedbackBar"};const{type:t}=e,n=(0,o.O7)(),s=(0,l.yK)((e=>({wrap:{display:"flex",marginTop:8,marginBottom:6,gap:6}})),[]),[r,c]=(0,a.useState)((()=>(0,y.ZP)())),d=(0,a.useCallback)((async()=>{await i.saveFeedback({environment:n,inferenceId:r,type:"assistant_accept_edits"}),await i.commitPreviewAssistantStep({environment:n}),await i.applyUncommittedOperations({environment:n})}),[n,r]),u=(0,a.useCallback)((async()=>{await i.saveFeedback({environment:n,inferenceId:r,type:"assistant_fix_errors"}),await i.commitPreviewAssistantStep({environment:n})}),[n,r]),p=(0,a.useCallback)((async()=>{await i.saveFeedback({environment:n,inferenceId:r,type:"assistant_undo"}),await i.commitPreviewAssistantStep({environment:n}),i.resetUncommittedOperations({environment:n})}),[n,r]),m=(0,a.useCallback)((async()=>{await i.saveFeedback({environment:n,inferenceId:r,type:"assistant_retry"}),await i.retryNextAssistantSteps({environment:n})}),[n,r]);return(0,ae.jsxs)("div",{style:s.wrap,children:["accept_action"===t&&(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(Ht,{icon:Gt.k,onClick:d,title:(0,ae.jsx)(C.FormattedMessage,{defaultMessage:"Accept all",id:"assistant.acceptAllButton"})}),(0,ae.jsx)(Ht,{icon:$t.s,onClick:p,title:(0,ae.jsx)(C.FormattedMessage,{defaultMessage:"Undo all",id:"assistant.undoAllButton"})})]}),"error"===t&&(0,ae.jsx)(ae.Fragment,{children:(0,ae.jsx)(Ht,{icon:qt.z,onClick:u,title:(0,ae.jsx)(C.FormattedMessage,{defaultMessage:"Fix errors",id:"assistant.fixErrorsButton"})})}),(0,ae.jsx)(Ht,{icon:Qt.n,onClick:m,title:(0,ae.jsx)(C.FormattedMessage,{defaultMessage:"Try again",id:"assistant.retryButton"})})]})}var Xt=n(83065),Jt=n(80402),en=n(65187),tn=n(43250);function nn(e){window.__c={n:"AssistantRichTextInput"};const{store:t,placeholder:n,disabled:i,onSubmit:s}=e,c=(0,o.O7)(),d=(0,r.VK)((()=>""===(0,k.Jcv)(t.getValue()).trim()),[t]),u=(0,l.yK)((e=>({wrap:{display:"flex",alignItems:"center",flexGrow:1,flexShrink:1,boxShadow:e.inputBoxShadow,borderRadius:16,padding:"6px 12px",marginLeft:16,marginRight:16,overflow:"hidden",fontSize:14,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{}},text:{maxHeight:64},placeholder:{maxHeight:64,opacity:i?.5:1}})),[i]),p=(0,a.useCallback)((e=>{!d&&s&&(s(t.getValue()),ee.createAndCommit({userAction:"AssistantRichTextInput.valueChanged",environment:c,perform:e=>{Dt.sO({environment:c,store:t,value:void 0,transaction:e})}}))}),[c,s,t,d]),m=(0,a.useCallback)((e=>{s&&!d&&(s(t.getValue()),ee.createAndCommit({userAction:"AssistantRichTextInput.valueChanged",environment:c,perform:e=>{Dt.sO({environment:c,store:t,value:void 0,transaction:e})}}))}),[s,d,t,c]);return(0,ae.jsxs)("div",{style:u.wrap,className:tn.Wh_,children:[(0,ae.jsx)(en.Z,{placeholder:n,disabled:i??!1,store:t,style:u.text,placeholderStyle:u.placeholder,pasteBehavior:"inline",disableSlashCommands:!0,disableEmbedMenu:!0,disableEmojiCommands:!1,disableComment:!0,disableSelectAllBlocks:!0,disableSelectionDrag:!0,onEnter:m,disableMobileActionBar:!1,disableDateReminderMentions:!0,disableStyleAnnotations:!0,onFocus:()=>Jt.MO()}),(0,ae.jsx)(T.Z,{icon:Xt._,onClick:p,isBlue:!d,disabled:d,iconStyle:{height:20,width:20},style:{pointerEvents:"auto",height:16,width:16},ariaLabel:"submit-ai-message"})]})}function an(e){window.__c={n:"AssistantSkillName"};const{clientSkill:t}=e,n=(0,C.useIntl)(),i=(0,r.VK)((()=>{if("persisted"===t.type){const e=t.skillStore.getName();if(e)return e}return n.formatMessage(mt.jo[t.skillType])}),[t,n]);return(0,ae.jsx)(ae.Fragment,{children:i})}const on=(0,C.defineMessages)({qnaAssistantChatText:{id:"assistantChat.qnaWelcomeMessage.text",defaultMessage:"Hi! I'm Notion AI. I can search through your Notion workspace and answer questions based on what I find."}});function sn(e){window.__c={n:"AssistantChat"};const{store:t}=e,n=(0,o.O7)(),s=(0,a.useRef)(void 0),l=(0,C.useIntl)(),c=(0,r.VK)((()=>t.state),[t]),d=(0,r.VK)((()=>xe.N.state),[]),u=(0,r.VK)((()=>fe.default.state.mainEditorCurrentBlockStore),[]),p=(0,r.VK)((()=>fe.default.state.currentSpaceStore),[]),m=(0,r.VK)((()=>ct.fG.isQnAOnlyEnabled()),[]),h=null==c?void 0:c.selectedSkill,g="qna"===(null==h?void 0:h.skillType),f=(0,r.VK)((()=>{var e;const n=null===(e=t.state)||void 0===e?void 0:e.previewingStepObservations.filter((e=>"observation"===e.type&&"error"===e.observationType));return null==n?void 0:n.map((e=>e.value)).join("\n")}),[t]),y=(0,r.VK)((()=>(0,ct.Gw)()),[]),v=(0,r.VK)((()=>z.Pl.state),[]),w=Boolean(v),{store:b}=(0,Nt.Cl)({initialValue:void 0,onChange:x.yR}),j=(null==d?void 0:d.evaluating)||(null==d?void 0:d.sampling)||(null==d?void 0:d.committing),I=(0,a.useMemo)((()=>null!=d&&d.startTimestamp?(0,Wt.ZV)({value:(0,Et.CQ)(d.startTimestamp,(0,De.r)()),date_format:"relative",time_format:"h:mm A",allowRelativeDates:!0,intl:l}):void 0),[null==d?void 0:d.startTimestamp,l]),M=(0,a.useCallback)((async e=>{!w||null!=v&&v.selectedFakeUser?(c||await i.resetAssistantStore({environment:n,isLabelerSlackMode:w,fakeSlackChannel:null==v?void 0:v.selectedFakeChannel,clientSkill:m?mt.lU:h}),e&&i.commitHumanStep({environment:n,text:e,fakeUser:null==v?void 0:v.selectedFakeUser})):Ot.deprecatedShowErrorMessage("Please select a user to send the message as")}),[w,null==v?void 0:v.selectedFakeUser,null==v?void 0:v.selectedFakeChannel,c,n,m,h]),A=(0,a.useCallback)((e=>!g||("human"===e.type||"assistantChat"===e.type||"assistantChatText"===e.type||"assistantShowSearchResults"===e.type)),[g]);(0,a.useEffect)((()=>{re.ZH({device:n.device}),Ne.N_({store:b}),null!=c&&c.primeTextInput&&(ee.createAndCommit({userAction:"assistant.primeTextFromSearch",environment:n,perform:e=>{Dt.sO({environment:n,store:b,value:k.TPx(c.primeTextInput),transaction:e})}}),i.clearPrimedText())}),[n,b,null==c?void 0:c.primeTextInput]),(0,a.useEffect)((()=>{s.current&&s.current.scrollToBottom(),re.ZH({device:n.device}),Ne.N_({store:b})}),[null==c?void 0:c.clientSteps,b,n.device]),(0,a.useEffect)((()=>{null!=d&&d.sampling||!s.current||s.current.scrollToBottom()}),[null==d?void 0:d.sampling]);const T=rn(),_=(0,r.VK)((()=>{const e=z.XN.state,t=xe.N.state;if(!e||!t)return!1;if(!t.sampling&&!t.evaluating)return!1;if(e.temporaryClientSteps.find((e=>"assistantChat"===e.type||"assistantTransaction"===e.type)))return!1;const n=e.clientSteps[e.clientSteps.length-1];return!n||"assistantShowSearchResults"!==n.type}),[]);return p&&u?(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsxs)(zt.Z,{ref:s,type:Ut.Z.Y,style:T.scroller,children:[(0,ae.jsx)("div",{style:{marginTop:"auto"}}),I&&(0,S.$K)(c)&&c.clientSteps.length>0?(0,ae.jsx)("div",{style:T.dateContainer,children:(0,ae.jsx)("div",{style:T.date,children:I})}):null,(0,ae.jsx)(ln,{currentState:c}),null!=c&&c.clientSteps?c.clientSteps.filter(A).map(((e,t)=>(0,ae.jsx)(Ve,{clientStep:e,parentStore:p,parentSpaceId:p.id,fakeSlackUser:"human"===e.type?e.fakeUser:void 0,configurationState:d},t))):null,null!=c&&c.temporaryClientSteps?c.temporaryClientSteps.filter(A).map(((e,t)=>(0,ae.jsx)(Ve,{clientStep:e,parentStore:p,parentSpaceId:p.id,configurationState:d},t))):null,d&&f&&!d.sampling&&!d.evaluating&&(g?(0,ae.jsx)(Ve,{clientStep:{type:"assistantFriendlyError"},parentStore:p,parentSpaceId:p.id,configurationState:d}):(0,ae.jsx)("div",{style:T.error,children:f})),!y&&c&&d&&(c.temporaryClientSteps.length>0||f)&&!d.sampling&&!d.evaluating&&(0,ae.jsx)(Yt,{type:f?g?"retry_only":"error":Boolean(c.temporaryClientSteps.find((e=>"assistantTransaction"===e.type)))?"accept_action":"feedback"}),_&&(0,ae.jsx)(Ve,{clientStep:{type:"assistantLoading"},parentStore:p,parentSpaceId:p.id,configurationState:d})]}),(0,ae.jsx)("div",{style:T.inputWrap,children:(0,ae.jsx)(nn,{store:b,placeholder:g?"Ask a question…":"Ask for anything…",onSubmit:M,disabled:j})})]}):null}function rn(){return(0,l.yK)((e=>({wrap:{display:"flex",flexDirection:"column",background:e.contentBackground,width:400,height:"max(40vh, 600px)"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",pointerEvents:"auto",paddingTop:8,paddingLeft:12,paddingRight:12},labeledInput:{display:"flex",gap:8,alignItems:"center"},reset:{color:e.mediumIconColor},toggleSlackMode:{color:e.mediumIconColor},closeButton:{borderRadius:"100%",marginLeft:4},input:{width:void 0,marginLeft:8,marginRight:8},scroller:{flexGrow:1,display:"flex",flexDirection:"column",paddingTop:16,paddingBottom:16,paddingLeft:16,paddingRight:16,backgroundColor:e.contentBackground},samplesLabel:{fontSize:12,marginTop:8,marginBottom:8},inputLabel:{fontSize:14,color:e.mediumTextColor},previewLabel:{fontSize:12},editLink:{fontSize:14,color:e.mediumTextColor,textDecoration:"underline",paddingLeft:8,paddingRight:8},error:{fontSize:14,color:e.errorText},addCustomInstructionsIcon:{fill:e.aiPurpleColor},suggestionsLabel:{fontSize:12,color:e.mediumTextColor,marginTop:18,marginBottom:12},emptyStateIntro:{marginLeft:18,marginRight:18},faceImgWrap:{width:64,height:64,borderRadius:"100%",background:"white",boxShadow:e.largeLightBoxShadow,overflow:"hidden"},faceImg:{width:64,pointerEvents:"none"},emptyStateText:{marginTop:28,fontSize:16,color:e.regularTextColor,fontFamily:se.Z.baseFontFamily.serif},inputWrap:{paddingTop:8,paddingBottom:12},skillsCaption:{fontSize:12,color:e.mediumTextColor,marginBottom:8},skillIcon:{fill:e.aiPurpleColor},skillsWrap:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:8},date:{fontSize:12,color:e.mediumTextColor},dateContainer:{display:"flex",justifyContent:"center"}})),[])}function ln(e){var t;window.__c={n:"AssistantWelcomeHeader"};const{currentState:n}=e,i=(0,o.O7)(),s=(0,C.useIntl)(),l=(0,r.VK)((()=>xe.N.state),[]),c=(0,r.VK)((()=>fe.default.state.mainEditorCurrentBlockStore),[]),d=(0,r.VK)((()=>(0,mt.Qv)()),[]),u=(0,r.VK)((()=>{var e;const t=null==c||null===(e=c.getFormat())||void 0===e?void 0:e.app_config_uri;return ct.fG.canViewMoreSkills(t)}),[c]),p=(0,r.VK)((()=>fe.default.state.currentSpaceStore),[]),[m,h]=(0,r.VK)((()=>[ct.fG.isAssistantEnabled(),ct.fG.isQnAOnlyEnabled()]),[]),g="qna"===(null==n||null===(t=n.selectedSkill)||void 0===t?void 0:t.skillType)||h,f=(0,a.useCallback)((()=>{(0,pt.O)({view:"skillSwitcher"})}),[]),x=(0,a.useCallback)((async e=>{await Lt({environment:i,clientSkill:e})}),[i]),y=rn();return p&&c?(0,ae.jsxs)(ae.Fragment,{children:[!n&&m&&(0,ae.jsxs)("div",{style:y.emptyStateIntro,children:[(0,ae.jsx)("div",{style:y.faceImgWrap,children:(0,ae.jsx)("img",{style:y.faceImg,src:Je.Z.images.aiFaceLookleftPng})}),(0,ae.jsxs)("div",{style:y.emptyStateText,children:[(0,ae.jsx)("p",{children:(0,ae.jsx)(C.FormattedMessage,{id:"assistantChat.welcomeMessage.title",defaultMessage:"Hi! I'm Notion AI."})}),(0,ae.jsx)("p",{children:(0,ae.jsx)(C.FormattedMessage,{id:"assistantChat.welcomeMessage.caption",defaultMessage:"I can answer questions about this workspace, help you analyze and edit pages, and search and manipulate databases."})})]}),d.length>0&&(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)("div",{style:y.skillsCaption,children:"Things to try"}),(0,ae.jsxs)("div",{style:y.skillsWrap,children:[d.filter((e=>e.inAppSkillTrigger)).slice(0,6).map((e=>(0,ae.jsx)(Ht,{icon:mt.AN[e.skillType],iconStyle:y.skillIcon,onClick:async()=>{await x(e)},title:(0,ae.jsx)(an,{clientSkill:e})},e.key))),u&&(0,ae.jsx)(Ht,{onClick:f,title:"More"})]})]})]}),g&&(0,ae.jsx)(Ve,{clientStep:{type:"assistantChatText",text:s.formatMessage(on.qnaAssistantChatText)},parentStore:p,parentSpaceId:p.id,configurationState:l})]}):null}var cn=n(2553),dn=n(68709),un=n(3553),pn=n(12534);const mn=(0,C.defineMessages)({instructionSectionTitle:{id:"CustomSkillMenu.instructionSection.title",defaultMessage:"Instructions"}});function hn(e){window.__c={n:"CustomSkillMenu"};const{clientSkill:t}=e,{skillStore:n}=t,i=(0,o.O7)(),s=(0,C.useIntl)(),c=(0,l.yK)((e=>({listWrap:{background:e.contentBackground,boxShadow:e.inputBoxShadow,padding:"3px 9px",margin:"0 8px",borderRadius:5,minHeight:64,..."dark"===e.mode?{backgroundColor:e.inputBackground}:{},fontSize:14},emptyPlaceholder:{caretColor:e.mediumTextColor,color:e.lightTextColor,fontSize:14,padding:"5px 0",display:"inline-block"},sectionTitle:{color:e.lightTextColor,fontSize:12}})),[]),d=(0,r.VK)((()=>!n.canEdit()),[n]),u=(0,r.VK)((()=>{if(n.isType("custom"))return n.getInstructionParentStore()}),[n]),p=(0,r.VK)((()=>{if(u)return u.getContentStore()}),[u]),m=(0,a.useCallback)((e=>{(0,pn.ZP)({event:e,context:pn.Af.EditorClick,callback:()=>{if(!p)return;(p.getValue()||[]).length>0||ee.createAndCommit({userAction:"CustomSkillMenu.handleListClick",environment:i,perform:e=>{cn.Nj({environment:i,parentStore:p,transaction:e})}})}})}),[i,p]);return(0,ae.jsx)(ae.Fragment,{children:p&&u&&(0,ae.jsx)(F.Z,{title:s.formatMessage(mn.instructionSectionTitle),children:(0,ae.jsx)(un.Z,{store:u,isDefaultContainer:!0,droppable:!1,render:()=>(0,ae.jsx)(dn.p,{allowSelectionWithin:!0,children:(0,ae.jsx)("div",{style:c.listWrap,onClick:m,className:tn.Wh_,children:(0,ae.jsx)(te.O,{displayName:"CustomSkillMenuContent",disabled:d,children:(0,ae.jsx)(ne.Z,{disabled:d,store:p,emptyPlaceholder:(0,ae.jsx)("div",{style:c.emptyPlaceholder,children:(0,ae.jsx)(C.FormattedMessage,{id:"automations.CustomSkillMenu.emptyPlaceholder",defaultMessage:"Click to edit instructions…"})}),disableCommentMenu:!0,disableHoverMenu:!1,disableDrag:!1})})})})},u.id)})})}var gn=n(24600),fn=n(42876),xn=(n(57658),n(8848)),yn=n(80721),vn=n(37612),kn=n(95193),Sn=n(18441),Cn=n(30874),wn=n(77657),bn=n(149),jn=n(42631);function In(e){const{renderMenu:t,onClose:n,onConnect:i}=e,a=[{key:"connect-to-slack-menu",items:[],render:e=>(0,ae.jsx)(Mn,{...e,onClose:n,onConnect:i})}];return(0,ae.jsx)(ae.Fragment,{children:t(a)})}function Mn(e){window.__c={n:"ConnectSection"};const{onClose:t,onConnect:n}=e,i=_n();return(0,ae.jsx)(F.Z,{children:(0,ae.jsxs)("div",{style:i.container,children:[(0,ae.jsx)(An,{}),(0,ae.jsxs)("div",{style:i.connectToSlackBody,children:[(0,ae.jsx)("div",{style:i.connectToSlackTitleText,children:(0,ae.jsx)(C.FormattedMessage,{id:"slackConnectToSlackView.connectToSlackView.title",defaultMessage:"Connect to Slack"})}),(0,ae.jsx)("div",{style:i.connectToSlackDescriptionText,children:(0,ae.jsx)(C.FormattedMessage,{id:"slackConnectToSlackView.connectToSlackView.description",defaultMessage:"Enable your assistant to listen to Slack channels"})})]}),(0,ae.jsx)(Tn,{onClose:t,onConnect:n})]})})}function An(){window.__c={n:"SlackIcon"};const e=_n();return(0,ae.jsx)("div",{children:(0,ae.jsx)("img",{src:Je.Z.images.externalIntegrations.slackIconPng,style:e.slackIcon})})}function Tn(e){window.__c={n:"AuthActionButtons"};const{onClose:t,onConnect:n}=e,i=(0,o.O7)(),a=(0,r.VK)((()=>{var e;return null===(e=fe.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),s=(0,r.VK)((()=>Cn.Z.integrations.state.find((e=>e.id===wn.nO))),[]),l=_n();return s&&a?(0,ae.jsxs)("div",{style:l.buttonGroup,children:[(0,ae.jsx)(je.Z,{style:l.connectToSlackButton,isLarge:!0,onClick:async()=>{const e=await jn.hM({environment:i,integration:s,spaceId:a,from:"collection_view_settings"});bn.x.isFail(e)?n({type:"workspace"}):e.value.externalAuthentication?n({type:"channel",externalAuthentication:e.value.externalAuthentication}):n({type:"workspace"})},children:(0,ae.jsx)(C.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.connectButton.label",defaultMessage:"Connect"})}),(0,ae.jsx)(bt.Z,{style:l.cancelButton,isLarge:!0,onClick:()=>{t()},children:(0,ae.jsx)(C.FormattedMessage,{id:"notificationRuleSettingsSetupSlackView.connectToSlackView.cancelButton.label",defaultMessage:"Cancel"})})]}):null}function _n(){return(0,l.yK)((e=>({container:{display:"flex",flexDirection:"column",margin:"10px 15px",justifyContent:"center",textAlign:"center"},connectToSlackBody:{margin:"0px 25px"},connectToSlackTitleText:{marginBottom:2,fontWeight:se.Z.fontWeight.semibold},connectToSlackDescriptionText:{fontSize:13,color:e.mediumTextColor},slackIcon:{width:23,height:"auto"},buttonGroup:{margin:"10px 10px 0px 10px"},connectToSlackButton:{width:"100%"},cancelButton:{color:e.mediumTextColor,width:"100%",justifyContent:"center",fontWeight:se.Z.fontWeight.medium,fontSize:13,marginTop:8}})),[])}var Bn=n(93364);const Zn=(0,C.defineMessages)({backButtonAriaLabel:{id:"SlackSelectWorkspaceAndChannelMenu.backButton.ariaLabel",defaultMessage:"Back to previous step"},selectSlackWorkspace:{id:"SlackSelectWorkspaceAndChannelMenu.selectSlackWorkspace",defaultMessage:"Select Slack workspace"},selectSlackChannel:{id:"SlackSelectWorkspaceAndChannelMenu.selectSlackChannel",defaultMessage:"Select Slack channel"},remove:{id:"SlackSelectWorkspaceAndChannelMenu.remove",defaultMessage:"Remove"}});function Fn(e){window.__c={n:"SlackSelectWorkspaceAndChannelMenu"};const{onSelect:t,onClose:n,onRemove:i,channelFilter:o,workspaceFilter:s,onNewSlackAccountAdded:l}=e,c=(0,r.VK)((()=>(0,Sn.P9)(Cn.Z.completeSlackAuthentications.state,s)),[s]),[d,u]=a.useState(function(e){return 0===e.length?{type:"connect"}:1===e.length?{type:"channel",externalAuthentication:e[0]}:{type:"workspace"}}(c)),p=(0,kn.F)({maxHeight:"50vh",width:266});return"connect"===d.type?(0,ae.jsx)(In,{onClose:n,onConnect:e=>u(e),renderMenu:e=>(0,ae.jsx)(B.Z,{...p,children:(0,ae.jsx)(Z.Z,{type:Z.i.Vertical,sections:e,initialFocus:0})})}):"workspace"===d.type?(0,ae.jsx)(Bn.U,{onWorkspaceSelect:e=>{const t=(0,Sn.jc)(e);(!s||t&&s(t))&&u({type:"channel",externalAuthentication:e})},workspaceFilter:s,onNewSlackAccountAdded:l,renderMenu:e=>(0,ae.jsx)(B.Z,{...p,header:(0,ae.jsx)(Pn,{children:(0,ae.jsx)(C.FormattedMessage,{...Zn.selectSlackWorkspace})}),children:(0,ae.jsx)(Z.Z,{type:Z.i.Vertical,sections:e,initialFocus:0})})}):"channel"===d.type?(0,ae.jsx)(fn.ZP,{channelFilter:o,onClose:n,currentNotificationChannel:void 0,onNewSlackAccountAdded:()=>{u({type:"workspace"}),null==l||l()},currentExternalAuthentication:d.externalAuthentication,onNotificationChannelSelect:e=>t({notificationChannel:e,externalAuthentication:d.externalAuthentication}),renderMenu:e=>{const t=[...e];return i&&t.push({key:"remove",render:e=>(0,ae.jsx)(F.Z,{topBorder:!0,...e}),items:[{key:"remove",render:e=>(0,ae.jsx)(M.Z,{...e,icon:(0,vn.y)({width:16,height:16,marginRight:2}),title:(0,ae.jsx)(C.FormattedMessage,{...Zn.remove}),hoveredStyle:{color:xn.ZP.red,fill:xn.ZP.red}}),action:()=>{i(),n()}}]}),(0,ae.jsx)(B.Z,{...p,header:(0,ae.jsx)(Pn,{onBack:()=>u({type:"workspace"}),children:(0,ae.jsx)(C.FormattedMessage,{...Zn.selectSlackChannel})}),children:(0,ae.jsx)(Z.Z,{type:Z.i.Vertical,sections:t,initialFocus:0})})}}):(0,S.t1)(d)}function Pn(e){window.__c={n:"MenuHeader"};const{onBack:t,children:n}=e,i=(0,l.yK)((e=>({wrap:{display:"flex",alignItems:"center",margin:8,color:e.mediumTextColor,fontWeight:se.Z.fontWeight.medium,fontSize:se.Z.fontSize.UISmall.desktop,minHeight:22},iconButtonStyle:{marginRight:8,marginLeft:-2,height:22},iconButtonIconStyle:{width:16,height:16}})),[]),a=(0,C.useIntl)();return(0,ae.jsxs)("div",{style:i.wrap,children:[t&&(0,ae.jsx)(T.Z,{ariaLabel:a.formatMessage(Zn.backButtonAriaLabel),icon:yn.W,style:i.iconButtonStyle,iconStyle:i.iconButtonIconStyle,onClick:t}),n]})}const Vn=(0,C.defineMessages)({slackSectionTitle:{id:"editSkillMenu.optionalSlackSection.title",defaultMessage:"Slack (optional)"}});function Rn(e){window.__c={n:"SlackSkillMenu"};const{clientSkill:t}=e,n=(0,o.Fy)(),i=(0,o.O7)(),s=(0,C.useIntl)(),c=(0,r.VK)((()=>t.skillStore.getParentPointer()),[t.skillStore]),[{value:d}]=(0,ze.r5)((async()=>{const e=null==c?void 0:c.id,t=null==c?void 0:c.spaceId;if(e&&t)return await be.getPageAssistantPreferences(i,{pageId:e,spaceId:t})}),[i,c]),u="success"===(null==d?void 0:d.type)?d.data:void 0,p=(0,r.VK)((()=>t.skillStore.getSlackChannelTarget()),[t.skillStore]),m=(0,a.useCallback)((e=>Boolean(null==u?void 0:u.aiEnabledSlackWorkspaceIds.includes(e))),[u]),h=(0,r.VK)((()=>t.skillStore.isType("custom")||t.skillStore.isType("wiki_slack")||t.skillStore.isType("tasks_slack")),[t.skillStore]),g=a.useCallback((async e=>{const{externalAuthentication:n,notificationChannel:a}=e,o=t.skillStore.id,s=null==c?void 0:c.spaceId;if(!s)return;if("success"===(await be.setPageAssistantPreferences(i,{type:"skill",skillId:o,spaceId:s,operation:{type:"set_channel",botId:n.parent_id,channelId:a.id}})).type){const e=t.skillStore.getSettingsStore();ee.createAndCommit({environment:i,userAction:"slackSkillMenu.updateSkillChannel",perform:t=>{Ft.sW({transaction:t,store:e,data:{channel:a}})}})}}),[i,t.skillStore,c]),f=a.useCallback((async()=>{const e=t.skillStore.id,n=null==c?void 0:c.spaceId;p&&n&&await be.setPageAssistantPreferences(i,{type:"skill",skillId:e,spaceId:n,operation:{type:"clear_channel"}})}),[i,t.skillStore,c,p]),x=(0,l.yK)((e=>({button:{width:"max-content",boxShadow:e.borderBoxShadow},selectChannelPlaceholder:{color:e.lightTextColor},container:{fontSize:14},icon:{width:12,height:12}})),[]);return h?(0,ae.jsx)(F.Z,{title:s.formatMessage(Vn.slackSectionTitle),children:(0,ae.jsx)(A.ZP,{popupType:n.isMobile?Qe.kQ.SlideUp:Qe.kQ.Popup,render:e=>(0,ae.jsx)(Fn,{onClose:()=>e.close(),channelFilter:Ln,workspaceFilter:m,onSelect:async e=>{await g(e)},onRemove:async()=>{await f()}}),renderOrigin:e=>(0,ae.jsx)(M.Z,{...e,focused:!1,buttonStyle:x.button,icon:!p&&(0,gn.P)(x.icon),title:p?(0,ae.jsx)(Kn,{channel:p}):(0,ae.jsx)(C.FormattedMessage,{id:"slackSkillRows.connectStart.label",defaultMessage:"Connect to a Slack channel"})})})}):null}const Ln=e=>"public"===e.type;function Kn(e){window.__c={n:"ChannelValue"};const{channel:t}=e,n=(0,l.yK)((()=>({wrap:{display:"flex",alignItems:"center"},icon:{height:12,width:12}})),[]),i=(0,fn.N_)({channel:t,styles:n.icon});return(0,ae.jsxs)("div",{style:n.wrap,children:[i," ",t.name]})}function Wn(e){window.__c={n:"TasksSlackSkillMenu"};const{clientSkill:t}=e,n=(0,o.O7)(),i=t.skillStore,s=(0,r.VK)((()=>{var e;return(null===(e=i.getSettings())||void 0===e||null===(e=e.tasks_team_options)||void 0===e?void 0:e.team_block_id)??""}),[i]),l=(0,r.VK)((()=>{var e;return(null===(e=i.getSettings())||void 0===e||null===(e=e.tasks_team_options)||void 0===e?void 0:e.tag_ids)??[]}),[i]),[c,d]=a.useState(s),[u,p]=a.useState(l.join(",")),m=a.useCallback((e=>{let t=e;e.includes("-")||(t=`${e.slice(0,8)}-${e.slice(8,12)}-${e.slice(12,16)}-${e.slice(16,20)}-${e.slice(20,32)}`),d(t),ee.createAndCommit({userAction:"TasksSkillMenu.handleTeamBlockIdChange",environment:n,perform:e=>{Kt({store:i,update:{tasks_team_options:{team_block_id:t}},transaction:e})}})}),[i,n]),h=a.useCallback((e=>{const t=e.split(",").map((e=>e.trim())).map((e=>e.includes("-")?e:(0,y.Mt)(e)));p(t.join(",")),ee.createAndCommit({userAction:"TasksSkillMenu.handleTagIdsChange",environment:n,perform:e=>{Kt({store:i,update:{tasks_team_options:{tag_ids:t}},transaction:e})}})}),[i,n]);return(0,ae.jsx)(ae.Fragment,{children:(0,ae.jsxs)(F.Z,{children:[(0,ae.jsx)(_e.Z,{isSecondaryColor:!0,isSmall:!0,style:{marginLeft:"4px",marginBottom:"6px"},children:(0,ae.jsx)(C.FormattedMessage,{id:"taskSlackSkillMenu.notes",defaultMessage:"Config here will change a lot - if anything breaks, ping @sophia"})}),(0,ae.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6,margin:"0px 12px"},children:[(0,ae.jsx)(wt.b,{value:c,onChange:m,placeholder:"uuid for the team's page block"}),(0,ae.jsx)(wt.b,{value:u,onChange:h,placeholder:"uuids for tags to associate, comma separated"})]})]})})}var En=n(75246),On=n(40190);function Dn(e){window.__c={n:"AssistantSkillMenuProperty"};const{property:t,value:n}=e,i=(0,l.yK)((e=>({row:{display:"flex",alignItems:"center",marginLeft:8,marginRight:8,marginBottom:8,gap:8},property:{fontSize:14,flexGrow:1}})),[]);return(0,ae.jsxs)("div",{style:i.row,children:[(0,ae.jsx)("div",{style:i.property,children:t}),n]})}var zn=n(17215),Nn=n(35840),Un=n(92338),Hn=n(35294),qn=n(68894),Qn=n(31278),Gn=n(65496),$n=n(88632);const Yn=(0,C.defineMessages)({qnaSearchPlaceholderLabel:{id:"wikiQuestionAndAnswerDropdownButton.databaseSearch.inputPLaceholder",defaultMessage:"Search for databases…"},qnaFeatureOffLabel:{id:"wikiQuestionAndAnswerDropdownButton.qnaFeatureMenu.disabledLabel",defaultMessage:"Off"}});function Xn(e){window.__c={n:"WikiQuestionAndAnswerDropdownButton"};const{skillStore:t,disabled:n}=e,i=(0,o.O7)(),s=(0,C.useIntl)(),c=(0,Hn.d)(),[d,u]=a.useState(""),p=(0,r.VK)((()=>{var e;const n=null===(e=t.getSettings())||void 0===e?void 0:e.qna_collection_view_block_id;if(n)return U.G.createChildStore(t,{table:Y.iU,id:n,spaceId:t.getSpaceId()})}),[t]),m=(0,r.VK)((()=>null==p?void 0:p.getIcon()),[p]),[{value:h}]=(0,ze.r5)((async()=>{const{currentSpaceStore:e,currentSpaceViewStore:t}=fe.default.state;if(e)return await(0,Gn.hb)({environment:i,currentSpaceStore:e,currentSpaceViewStore:t})}),[i]),[{value:g}]=(0,ze.r5)((async()=>{if(h)return await async function(e){const{environment:t,localCache:n,searchQuery:i}=e,a={query:{text:i,filters:(0,Un.u4)({requireEditPermissions:!0,isDeletedOnly:!1,excludeTemplates:!0,navigableBlockContentOnly:!0,blockTypes:["collection_view","collection_view_page"]}),sort:{field:"relevance"}},limit:5},o=await async function(e){const{environment:t,localCache:n,query:i}=e,{currentUserRootStore:a}=fe.default.state;if(!a)return;return Promise.resolve((0,Gn.Y_)({query:i,localCachedPages:n,parentStore:a,isOnline:$n.Z.state.online,environment:t,shouldLimitLocalResultsWhenOnline:!1,applyScoreThresholdWhenOnline:!0}))}({environment:t,localCache:n,query:a});if(o&&bn.x.isSuccess(o)){const e=o.value.results;if(e.length>0)return e}return await async function(e){const{environment:t,query:{query:{text:n,filters:i,sort:a},limit:o}}=e,{currentSpaceStore:s}=fe.default.state;if(!s)return;const r=await be.search(t,{type:Un.n8.BlocksInSpace,query:n,spaceId:s.id,limit:o,filters:i,sort:a,source:"quick_find_public",recentPagesForBoosting:void 0});if("success"===(null==r?void 0:r.type))return r.data.results.map((e=>({id:e.id,store:U.G.createChildStore(s,{id:e.id,table:Y.iU,spaceId:e.spaceId})})))}({environment:t,query:a})??[]}({environment:i,localCache:h,searchQuery:d})}),[i,h,d]),f=(0,l.yK)((()=>({recordRow:{display:"flex",alignItems:"center"},recordIcon:{marginRight:6}})),[]);return(0,ae.jsx)(A.ZP,{popupType:c,alignmentToOrigin:A.vR.End,placementToOrigin:A.pO.Bottom,originGap:0,disabled:n,renderOrigin:e=>(0,ae.jsx)(On.S,{disabled:!1,variant:"gray",...e,children:p?(0,ae.jsxs)("div",{style:f.recordRow,children:[(0,ae.jsx)(Qn.Z,{style:f.recordIcon,disabled:!0,icon:m,isEmptyPage:!1,size:16}),(0,ae.jsx)(pe.Z,{store:p})]}):s.formatMessage(Yn.qnaFeatureOffLabel)}),render:e=>(0,ae.jsx)(Jn,{skillStore:t,buttonPopupParent:e,searchQuery:d,setSearchQuery:u,searchResults:g})})}function Jn(e){window.__c={n:"QuestionAndAnswerDropdownMenu"};const{skillStore:t,searchQuery:n,setSearchQuery:i,buttonPopupParent:s,searchResults:c}=e,d=(0,o.O7)(),u=(0,l.yK)((e=>({menuItem:{paddingTop:8,paddingBottom:8},noResults:{color:e.mediumTextColor}})),[]),p=(0,C.useIntl)(),m=a.useCallback((e=>{ee.createAndCommit({userAction:"QuestionAndAnswerDropdownMenu.onChange",environment:d,perform:n=>{Ft.sW({store:t.getSettingsStore(),data:{qna_collection_view_block_id:e},transaction:n})}})}),[d,t]),h={key:"input",action:()=>{},render:e=>(0,ae.jsx)(qn.ZP,{...e,inputLeft:(0,ae.jsx)(qn.f_,{icon:Nn.R}),showClearButton:!0,value:n,onChange:e=>{i(e.target.value)},placeholder:p.formatMessage(Yn.qnaSearchPlaceholderLabel),focus:!0,style:u.menuItem})},g=(0,r.VK)((()=>c&&0!==c.length?c.map((e=>{let{id:t,store:n}=e;const i=n.getModel(),a=(null==i?void 0:i.getRenderTitle({getRecordModel:n.getRecordModel,userTimeZone:Et.x7,intl:p}))??(0,zn.Q2)(p),o=n.getIcon();return{key:t,action:()=>{m(t),s.close()},render:e=>(0,ae.jsx)(M.Z,{...e,title:a,left:(0,ae.jsx)(Qn.Z,{icon:o,disabled:!0,isEmptyPage:!1,size:16})})}})):[{key:"no-results",action:()=>{},render:e=>(0,ae.jsx)(M.Z,{...e,style:{...u.menuItem,...u.noResults},title:(0,ae.jsx)(C.FormattedMessage,{id:"wikiQuestionAndAnswerDropdownButton.noResult.label",defaultMessage:"No results"})})}]),[p,c,m,s,u]),f={key:"remove",action:()=>{m(void 0),s.close()},render:e=>(0,ae.jsx)(M.Z,{...e,title:p.formatMessage(Yn.qnaFeatureOffLabel),style:u.menuItem})},x={menuType:W.og.Popup,width:280,maxWidth:360};return(0,ae.jsx)(B.Z,{...x,children:(0,ae.jsx)(Z.Z,{type:Z.i.Vertical,initialFocus:0,sections:[{key:"search-input",render:e=>(0,ae.jsx)(F.Z,{...e}),items:[h]},{key:"search-results",render:e=>(0,ae.jsx)(F.Z,{...e,topBorder:!0}),items:g},{key:"disable-qna",render:e=>(0,ae.jsx)(F.Z,{...e,topBorder:!0}),items:[f]}]})})}function ei(e){const{clientSkill:t}=e,n=t.skillStore;return(0,ae.jsx)(ae.Fragment,{children:(0,ae.jsxs)(F.Z,{children:[(0,ae.jsx)(Dn,{property:(0,ae.jsx)(C.FormattedMessage,{id:"WikiSlackSkillMenu.searchIn",defaultMessage:"Search in"}),value:(0,ae.jsx)(ti,{skillStore:n,disabled:!1})}),(0,ae.jsx)(Dn,{property:(0,ae.jsx)(C.FormattedMessage,{id:"WikiSlackSkillMenu.saveQuestionsAndAnswers",defaultMessage:"Save questions and answers"}),value:(0,ae.jsx)(Xn,{skillStore:n,disabled:!1})})]})})}function ti(e){window.__c={n:"SearchContextDropdownButton"};const{skillStore:t,disabled:n}=e,i=(0,o.Fy)(),a=(0,r.VK)((()=>{var e;return null===(e=t.getSettings())||void 0===e?void 0:e.search_context}),[t]);return a?(0,ae.jsx)(A.ZP,{popupType:i.isMobile?A.Z4.SlideUp:A.Z4.Popup,alignmentToOrigin:A.vR.End,placementToOrigin:A.pO.Bottom,originGap:0,disabled:n,renderOrigin:e=>(0,ae.jsx)(On.S,{disabled:n,variant:"gray",...e,children:(0,ae.jsx)(ii,{value:a,skillStore:t})}),render:t=>(0,ae.jsx)(ni,{value:a,parent:t,...e})}):null}function ni(e){window.__c={n:"SearchContextDropdownMenu"};const{value:t,skillStore:n,parent:i}=e,s=(0,o.O7)(),c=(0,l.yK)((()=>({menuItem:{paddingTop:8,paddingBottom:8}})),[]),d=(0,a.useCallback)((e=>{ee.createAndCommit({userAction:"SearchContextDropdownMenu.onChange",environment:s,perform:t=>{Ft.sW({store:n.getSettingsStore(),data:{search_context:e},transaction:t})}})}),[s,n]),u={menuType:W.og.Popup,width:280,maxWidth:360},p=(0,r.VK)((()=>n.getParentPointer()),[n]),m=(0,r.VK)((()=>n.getSpacePointer()),[n]);if(!p||!m)return null;const h=[p,m].map(((e,a)=>({key:a,render:i=>(0,ae.jsx)(M.Z,{...i,disabled:!1,title:(0,ae.jsx)(ii,{value:e,skillStore:n}),style:c.menuItem,checkState:t.id===e.id,...i}),action:()=>{d(e),i.close()}})));return(0,ae.jsx)(B.Z,{...u,children:(0,ae.jsx)(Z.Z,{type:Z.i.Vertical,sections:[{key:0,render:e=>(0,ae.jsx)(F.Z,{enableActionSheetTitle:!0,...e}),items:h}],initialFocus:0})})}function ii(e){const{value:t,skillStore:n}=e;return t.table===Y.iU?(0,ae.jsx)(pe.Z,{store:U.G.createChildStore(n,t)}):t.table===En.bx?(0,ae.jsx)(C.FormattedMessage,{id:"WikiSlackSkillMenu.workspace",defaultMessage:"Workspace"}):void(0,S.t1)(t)}function ai(e){window.__c={n:"EditSkillMenu"};const{clientSkill:t,onClose:n,onDelete:i}=e,{skillStore:s}=t,c=(0,o.O7)(),d=(0,r.VK)((()=>s.getType()),[s]),u=(0,r.VK)((()=>s.isRenameable()),[s]),p=(0,r.VK)((()=>s.getName()),[s]),[m,h]=a.useState(p),g=a.useCallback((e=>{h(e),ee.createAndCommit({userAction:"EditSkillMenu.handleNameChange",environment:c,perform:t=>{Kt({store:s,update:{name:e},transaction:t})}})}),[s,c]),f=(0,a.useCallback)((async()=>{if(!(await Ot.confirmUserAction({message:(0,ae.jsx)(C.FormattedMessage,{defaultMessage:"Are you sure you want to delete this skill?",id:"EditSkillMenu.delete.cancelConfirmation"}),acceptLabel:(0,ae.jsx)(C.FormattedMessage,{defaultMessage:"Delete",id:"EditSkillMenu.delete.cancelConfirmation.delete"})})))return;const e=s.getSlackChannelTarget(),t=s.getSpaceId();e&&t&&await be.setPageAssistantPreferences(c,{type:"skill",spaceId:t,skillId:s.id,operation:{type:"clear_channel"}}),ee.createAndCommit({userAction:"EditSkillMenu.handleDelete",environment:c,perform:e=>{!function(e){const{store:t,transaction:n}=e;Ft.sW({store:t,data:{alive:!1},transaction:n})}({store:s,transaction:e})}}),null==i||i(),n()}),[c,s,n,i]),x=(0,l.yK)((e=>({scroller:{maxHeight:"50vh"},skillIcon:{width:16,fill:e.aiPurpleColor,marginRight:4},fromRowWrap:{display:"flex",alignItems:"center",margin:"4px 8px",gap:4,fontSize:14},rowWrap:{display:"flex",alignItems:"center",margin:"0 8px",gap:8,fontSize:14},headerNameWrap:{flexGrow:1},sectionTitle:{color:e.lightTextColor,fontSize:12}})),[]);return(0,ae.jsxs)(zt.Z,{type:Ut.Z.Y,style:x.scroller,children:[(0,ae.jsx)(F.Z,{children:(0,ae.jsxs)("div",{style:x.rowWrap,children:[mt.AN[t.skillType](x.skillIcon),d&&u?(0,ae.jsx)(wt.b,{value:m,onChange:g,placeholder:"custom"===d?"Custom skill name":"Skill name"}):(0,ae.jsx)("div",{style:x.headerNameWrap,children:(0,ae.jsx)(an,{clientSkill:t})}),(0,ae.jsx)(bt.Z,{onClick:n,isBlue:!0,children:"Done"})]})}),"custom"===d&&(0,ae.jsx)(hn,{clientSkill:t}),"wiki_slack"===d&&(0,ae.jsx)(ei,{clientSkill:t}),"tasks_slack"===d&&(0,ae.jsx)(Wn,{clientSkill:t}),(0,ae.jsx)(Rn,{clientSkill:t}),(0,ae.jsx)(F.Z,{children:(0,ae.jsx)("div",{style:x.rowWrap,children:(0,ae.jsx)(bt.Z,{onClick:f,isRed:!0,children:"Delete"})})})]})}function oi(e){window.__c={n:"AssistantSkillPopup"};const{clientSkill:t,renderOrigin:n,buttonPopupStore:i,onDelete:a}=e,s=(0,o.O7)(),r=(0,l.yK)((e=>({headerWrap:{display:"flex",alignItems:"center",margin:"0 4px"},editPopupWrap:{borderRadius:12,boxShadow:e.largeLightBoxShadow,width:392}})),[]);return(0,ae.jsx)(A.ZP,{popupType:s.device.isMobile?A.Z4.SlideUp:A.Z4.Popup,preventScaleTransition:!0,preventOpacityTransition:!0,popupWrapStyle:r.editPopupWrap,renderOrigin:n,render:e=>t&&(0,ae.jsx)(ai,{clientSkill:t,onClose:e.close,onDelete:a}),buttonPopupStore:i})}var si=n(18442),ri=n(98165);function li(e){window.__c={n:"AssistantSkillSwitcher"};const t=(0,o.O7)(),n=(0,l.yK)((e=>({skillIcon:{width:16,fill:e.aiPurpleColor,marginRight:4},headerWrap:{display:"flex",alignItems:"center",margin:"0 4px"},editPopupWrap:{borderRadius:12,boxShadow:e.largeLightBoxShadow,width:392},skillMenuItemWrap:{display:"flex",alignItems:"center",margin:"8px 8px"},settingsButton:{marginLeft:8}})),[]),[i,s]=a.useState([]),c=a.useCallback((()=>{s((0,mt.Qv)())}),[]);a.useEffect((()=>{c()}),[c]);const[d,u]=a.useState(void 0),p=(0,r.qz)(void 0,N.Z),m=d?i.find((e=>"persisted"===e.type&&e.skillStore.id===d.id)):void 0,h=(0,a.useCallback)((()=>{const{performResult:e}=ee.createAndCommit({userAction:"AssistantSkillSwitcher.handleAddCustomSkillClick",environment:t,perform:e=>function(e){const{environment:t,transaction:n}=e,{inMemoryRecordCache:i}=t.defaultRecordCache,a=t.currentUser.id,{currentSpaceStore:o,mainEditorCurrentBlockStore:s}=fe.default.state;if(!a)throw new Error("No current user.");if(!o)throw new Error("No current space.");if(!s)throw new Error("No current block.");const r=e.parent??{id:s.id,table:Y.iU,spaceId:o.id},l=Ft.j4({environment:t,type:Mt.Ti.text,inMemoryRecordCache:i,transaction:n,spaceId:o.id,useCrdt:!1}),c=Rt({environment:t,transaction:n,skillValue:{type:"custom",parent_id:r.id,parent_table:r.table,space_id:r.spaceId,alive:!0}});return Zt.R3({transaction:n,parent:c.getKeyStore("blocks"),append:l}),c}({environment:t,transaction:e})});u(e),p.setState({...p.state,open:!0}),c()}),[t,p,c]),g=(0,a.useCallback)((()=>{const{performResult:e}=ee.createAndCommit({userAction:"AssistantSkillSwitcher.handleWikiAddToSlackClick",environment:t,perform:e=>function(e){const{environment:t,transaction:n}=e,{inMemoryRecordCache:i}=t.defaultRecordCache,a=t.currentUser.id,{currentSpaceStore:o,mainEditorCurrentBlockStore:s}=fe.default.state;if(!a)throw new Error("No current user.");if(!o)throw new Error("No current space.");if(!s)throw new Error("No current block.");const r=Ft.j4({environment:t,type:Mt.Ti.collectionViewPage,inMemoryRecordCache:i,transaction:n,spaceId:o.id,useCrdt:s.useCrdt()}),l=(0,y.ZP)(),c=(0,y.ZP)(),d=Ft.ae({environment:t,table:Tt.v,value:{name:(0,k.TPx)("Q&A"),schema:{title:{name:"Question",type:"title"},[(0,At.ZP)()]:{name:"Answer",type:"text"},[(0,At.ZP)()]:{name:"Last edited time",type:"last_edited_time"},[(0,At.ZP)()]:{name:"Status",type:"status",groups:[{id:(0,y.ZP)(),name:"To-do",color:"gray",optionIds:[l]},{id:(0,y.ZP)(),name:"In progress",color:"blue"},{id:(0,y.ZP)(),name:"Complete",color:"green",optionIds:[c]}],options:[{id:l,value:"Unverified"},{id:c,color:"green",value:"Verified"}],defaultOption:"Unverified"},[(0,At.ZP)()]:{name:"Created by",type:"created_by"},[(0,At.ZP)()]:{name:"Created time",type:"created_time"},[(0,At.ZP)()]:{name:"Last edited by",type:"last_edited_by"}},parent_table:Y.iU,parent_id:r.id,alive:!0,space_id:o.id},inMemoryRecordCache:i,transaction:n}),u=Ft.ae({environment:t,table:_t.n,value:{name:"View all",type:"table",parent_table:Y.iU,parent_id:r.id,alive:!0,space_id:o.id},inMemoryRecordCache:i,transaction:n});return Ft.sW({store:r.getFormatStore(),data:{collection_pointer:d.pointer},transaction:n}),Ft.sW({store:r,data:{view_ids:[u.id]},transaction:n}),Zt.R3({parent:s.getContentStore(),append:r,transaction:n}),Rt({environment:t,transaction:n,skillValue:{type:"wiki_slack",settings:{search_context:o.pointer,qna_collection_view_block_id:r.id},parent_id:s.id,parent_table:Y.iU,space_id:o.id,alive:!0}})}({environment:t,transaction:e})});u(e),p.setState({...p.state,open:!0})}),[t,p]),f=(0,a.useCallback)((()=>{const{performResult:e}=ee.createAndCommit({userAction:"AssistantSkillSwitcher.handleWikiAddToSlackClick",environment:t,perform:e=>function(e){const{environment:t,transaction:n}=e,i=t.currentUser.id,{currentSpaceStore:a,mainEditorCurrentBlockStore:o}=fe.default.state;if(!i)throw new Error("No current user.");if(!a)throw new Error("No current space.");if(!o)throw new Error("No current block.");return Rt({environment:t,transaction:n,skillValue:{type:"tasks_slack",settings:{tasks_collection_view_block_id:o.id},parent_id:o.id,parent_table:Y.iU,space_id:a.id,alive:!0}})}({environment:t,transaction:e})});u(e),p.setState({...p.state,open:!0})}),[t,p]),v=(0,r.VK)((()=>{var e;const{mainEditorCurrentBlockStore:t}=fe.default.state;return null==t||null===(e=t.getFormat())||void 0===e?void 0:e.app_config_uri}),[]),S=(0,r.VK)((()=>{const{mainEditorCurrentBlockStore:e}=fe.default.state;if(!e)return[];return(0,ri.uJ)(e).map((e=>e.id))}),[]),C=(0,r.VK)((()=>ct.fG.allowWikiSkillCreation(v)),[v]),w=(0,r.VK)((()=>ct.fG.allowTaskSkillCreation(v)),[v]),b=(0,r.VK)((()=>ct.fG.allowCustomSkillCreation()),[]),j=(0,r.VK)((()=>{const e=i.filter((e=>"persisted"===e.type&&Boolean(e.inAppSkillTrigger)&&S.includes(e.skillStore.getParentId()))),t=i.filter((e=>"persisted"===e.type&&!e.inAppSkillTrigger&&Boolean(e.slackSkillTriggers)&&S.includes(e.skillStore.getParentId()))),n=i.filter((n=>Boolean(n.inAppSkillTrigger)&&!e.includes(n)&&!t.includes(n)));return{slackSkills:t,pageSkills:e,workspaceSkills:n}}),[S,i]),I=j.pageSkills.map((e=>ci({environment:t,clientSkill:e,styles:n,onDelete:c}))),M=j.workspaceSkills.map((e=>ci({environment:t,clientSkill:e,styles:n,onDelete:c}))),A=x.oA([...j.slackSkills.map((e=>ci({environment:t,clientSkill:e,styles:n,onDelete:c}))),C&&{key:"wiki_slack",render:e=>(0,ae.jsx)("div",{style:n.skillMenuItemWrap,onMouseEnter:e.onMouseEnter,ref:e.ref,children:(0,ae.jsx)(Ht,{iconStyle:n.skillIcon,title:"Add to Slack",icon:mt.AN.wiki_slack,focused:e.focused,onClick:e.onClick})},e.key),action:g},w&&{key:"tasks",render:e=>(0,ae.jsx)("div",{style:n.skillMenuItemWrap,onMouseEnter:e.onMouseEnter,ref:e.ref,children:(0,ae.jsx)(Ht,{iconStyle:n.skillIcon,title:"Add to Slack",icon:mt.AN.tasks_slack,focused:e.focused,onClick:e.onClick})},e.key),action:f}]);return(0,ae.jsx)(ae.Fragment,{children:(0,ae.jsxs)(F.Z,{children:[(0,ae.jsxs)("div",{style:n.headerWrap,children:[(0,ae.jsx)("div",{style:{flexGrow:1}}),b&&(0,ae.jsx)(oi,{clientSkill:m,renderOrigin:()=>(0,ae.jsx)(bt.Z,{onClick:h,isBlue:!0,children:"New skill"}),buttonPopupStore:p,onDelete:c})]}),(0,ae.jsx)(Z.Z,{type:Z.i.Vertical,initialFocus:0,sections:x.oA([I.length>0&&{key:"page",render:e=>(0,ae.jsx)(F.Z,{topBorder:!1,disableMobileBorders:!0,title:"From this page",...e}),items:I},A.length>0&&{key:"slack",render:e=>(0,ae.jsx)(F.Z,{topBorder:!1,disableMobileBorders:!0,title:"From Slack",...e}),items:A},M.length>0&&{key:"workspace",render:e=>(0,ae.jsx)(F.Z,{topBorder:!1,disableMobileBorders:!0,title:"Other skills",...e}),items:M}])})]})})}function ci(e){const{environment:t,clientSkill:n,styles:i,onDelete:a}=e;return{key:n.key,render:e=>"persisted"===n.type?(0,ae.jsx)(oi,{clientSkill:n,onDelete:a,renderOrigin:t=>(0,ae.jsxs)("div",{style:i.skillMenuItemWrap,onMouseEnter:e.onMouseEnter,ref:e.ref,children:[(0,ae.jsx)(Ht,{iconStyle:i.skillIcon,title:(0,ae.jsx)(an,{clientSkill:n}),icon:mt.AN[n.skillType],onClick:e.onClick,focused:e.focused}),"persisted"===n.type&&e.focused&&(0,ae.jsx)(T.Z,{icon:si.H,ariaLabel:"edit",style:i.settingsButton,...t})]},e.key)}):(0,ae.jsx)("div",{style:i.skillMenuItemWrap,onMouseEnter:e.onMouseEnter,ref:e.ref,children:(0,ae.jsx)(Ht,{iconStyle:i.skillIcon,title:(0,ae.jsx)(an,{clientSkill:n}),icon:mt.AN[n.skillType],focused:e.focused,onClick:e.onClick})},e.key),action:async()=>{await Lt({environment:t,clientSkill:n})}}}var di=n(42853);function ui(e){window.__c={n:"AssistantSkillSwitcherButton"};const{store:t}=e,n=(0,r.VK)((()=>t.state),[t]),i=(0,l.yK)((e=>({skillIcon:{fill:e.aiPurpleColor},chevronDown:{fill:e.mediumIconColor,width:12,marginLeft:4}})),[]),o=(0,a.useCallback)((()=>{(0,pt.O)({view:"skillSwitcher"})}),[]);if(null==n||!n.selectedSkill)return null;const{selectedSkill:s}=n;return(0,ae.jsxs)(bt.Z,{onClick:o,icon:mt.AN[s.skillType],iconStyle:i.skillIcon,children:[(0,ae.jsx)(an,{clientSkill:s}),(0,di.i)(i.chevronDown)]})}function pi(e){var t,n,s,c;window.__c={n:"AssistantMenu"};const{store:d,configurationStore:u,onClose:p}=e,m=(0,o.O7)(),h=(0,r.VK)((()=>d.state),[d]),g=(0,r.VK)((()=>u.state),[u]),f=(0,r.VK)((()=>u.hasLockAction()),[u]),x="qna"===(null==h||null===(t=h.selectedSkill)||void 0===t?void 0:t.skillType),y=(0,a.useCallback)((()=>{var e;"qna"===(null==h||null===(e=h.selectedSkill)||void 0===e?void 0:e.skillType)&&w.Le6(m,g),i.clearAssistantStores()}),[g,null==h||null===(n=h.selectedSkill)||void 0===n?void 0:n.skillType,m]),v=(0,r.VK)((()=>{var e;return null===(e=fe.default.state.currentSpaceStore)||void 0===e?void 0:e.id}),[]),k=(0,r.VK)((()=>(0,ct.Gw)()),[]),S=(0,r.VK)((()=>ht.d.state.currentView),[]),b=(0,r.VK)((()=>z.Pl.state),[]),j=Boolean(b),I=(0,r.VK)((()=>ct.fG.isQnAOnlyEnabled()),[]),_=(0,r.VK)((()=>ct.fG.isAssistantEnabled()),[]),B=(0,r.VK)((()=>It.Z.estimatedNativeWebBottomOverlap()),[]);(0,ze.r5)((async()=>{v&&await async function(e){const{environment:t,spaceId:n}=e,i=await be.getSkillsInSpace(t,{spaceId:n});if("success"!==i.type)throw new Error("Failed to fetch skills in space.");const{skillIds:a}=i.data;Pt.L.setState({...Pt.L.state,serverSkillIds:new Set(a)})}({environment:m,spaceId:v})}),[m,v]);const[Z,F]=(0,a.useState)([]);(0,a.useEffect)((()=>{j&&Ct.Yu({environment:m,query:"",membersOnly:!1}).then((e=>F(e))).catch((e=>{throw new Error(e)}))}),[m,j]);const V=(0,a.useCallback)((()=>{(0,pt.O)({view:"chat"})}),[]),R=(0,a.useCallback)((()=>{var e;p(),"qna"===(null==h||null===(e=h.selectedSkill)||void 0===e?void 0:e.skillType)&&w.Ti_(m,g)}),[g,null==h||null===(s=h.selectedSkill)||void 0===s?void 0:s.skillType,m,p]),L=(0,a.useCallback)((()=>{i.clearAssistantStores(),j?z.Pl.setState(void 0):z.Pl.setState({enabled:!0,selectedFakeUser:void 0,selectedFakeChannel:"#"})}),[j]),K=function(e){const{hasLockAction:t,isMobileNative:n,mobileAppBottomOverlap:i}=e;return(0,l.yK)((e=>({wrap:{display:"flex",flexDirection:"column",background:e.contentBackground,width:400,transition:"height 200ms ease",minHeight:128,maxHeight:n?`calc(90vh - ${i}px)`:"max(40vh, 600px)"},header:{display:"flex",alignItems:"center",pointerEvents:"auto",paddingTop:12,paddingLeft:16,paddingRight:16,paddingBottom:12},labeledInput:{display:"flex",gap:8,alignItems:"center"},clearButton:{color:t?e.lightTextColor:e.mediumIconColor,opacity:t?.5:1},headerButton:{color:e.mediumIconColor},closeButton:{borderRadius:"100%",marginLeft:6},input:{width:void 0,marginLeft:8,marginRight:8},inputLabel:{fontSize:14,color:e.mediumTextColor},faceImgWrap:{width:64,height:64,borderRadius:"100%",background:"white",boxShadow:e.largeLightBoxShadow,overflow:"hidden"},faceImg:{width:64,pointerEvents:"none"},emptyStateText:{marginTop:28,fontSize:16,color:e.regularTextColor,fontFamily:se.Z.baseFontFamily.serif},inputWrap:{paddingTop:8,paddingBottom:8},skillsCaption:{fontSize:12,color:e.mediumTextColor,marginBottom:8},skillIcon:{fill:e.aiPurpleColor},skillsWrap:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:8},chatAndHelpButton:{display:"flex",alignItems:"center",gap:8},headerContentLeftOfClose:{display:"flex",marginRight:"8px",flexGrow:1,alignItems:"center"}})),[t,n,i])}({hasLockAction:f,isMobileNative:m.device.isMobileNative,mobileAppBottomOverlap:B});return(0,ae.jsxs)("div",{style:K.wrap,children:[(0,ae.jsxs)("div",{style:K.header,children:[(0,ae.jsxs)("div",{style:K.headerContentLeftOfClose,children:["chat"===S&&(0,ae.jsxs)(ae.Fragment,{children:[h&&_&&(0,ae.jsx)(ui,{store:d}),"persisted"===(null==h||null===(c=h.selectedSkill)||void 0===c?void 0:c.type)&&(0,ae.jsx)(oi,{clientSkill:h.selectedSkill,renderOrigin:e=>(0,ae.jsx)(bt.Z,{...e,style:K.headerButton,children:"Edit"})}),I&&(0,ae.jsx)(mi,{}),(0,ae.jsx)("div",{style:{flexGrow:1}}),k&&(0,ae.jsx)(bt.Z,{style:K.headerButton,onClick:L,children:j?"Disable Slack mode":"Enable Slack mode"})]}),"skillSwitcher"===S&&(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(T.Z,{icon:yt.V,onClick:V,ariaLabel:"back"}),(0,ae.jsx)("div",{style:{marginLeft:4,fontSize:14},children:"All skills"}),(0,ae.jsx)("div",{style:{flexGrow:1}})]}),(0,ae.jsxs)("div",{style:K.chatAndHelpButton,children:[(0,ae.jsx)(P.Z,{render:e=>(0,ae.jsx)(T.Z,{iconStyle:{width:24,height:24},icon:vt.Y,ariaLabel:"clear",onClick:y,...e}),renderTooltip:()=>(0,ae.jsx)(C.FormattedMessage,{id:"assistant.reset",defaultMessage:"Reset"})}),"chat"===S&&(!h||x)&&(0,ae.jsx)(A.ZP,{popupType:m.device.isMobile?A.Z4.SlideUp:A.Z4.Popup,renderOrigin:e=>(0,ae.jsx)(P.Z,{render:e=>(0,ae.jsx)(T.Z,{iconStyle:{width:16,height:16},icon:St.o,ariaLabel:"help",...e}),renderTooltip:()=>(0,ae.jsx)(C.FormattedMessage,{id:"assistant.help",defaultMessage:"Help"})}),render:()=>(0,ae.jsx)(jt.LazyHelpButtonContent,{shouldRenderAsStaticModal:!1})})]})]}),(0,ae.jsx)(T.Z,{style:K.closeButton,hovered:!0,icon:kt.U,onClick:R,ariaLabel:"close"})]}),j&&(0,ae.jsxs)("div",{style:{...K.header,flexDirection:"column",gap:6},children:[(0,ae.jsxs)("div",{style:K.labeledInput,children:[(0,ae.jsx)("div",{style:K.inputLabel,children:"Channel"}),(0,ae.jsx)(wt.b,{value:(null==b?void 0:b.selectedFakeChannel)||"",onChange:e=>{if(!b)throw new Error("slackModeState is undefined");z.Pl.setState({...b,selectedFakeChannel:e})},disabled:Boolean(h),placeholder:"Channel name",style:K.input})]}),(0,ae.jsxs)("div",{style:K.labeledInput,children:[(0,ae.jsx)("div",{style:K.inputLabel,children:"User"}),(0,ae.jsx)(Ge.Z,{items:Z,selectedItem:null==b?void 0:b.selectedFakeUser,getKey:e=>e.name||e.id,renderItem:e=>(0,ae.jsx)(M.Z,{...e,title:e.key}),onSelect:e=>{if(!b)throw new Error("slackModeState is undefined");z.Pl.setState({...b,selectedFakeUser:e})},renderOrigin:e=>(0,ae.jsx)(Ue.Z,{focused:!1,title:null!=b&&b.selectedFakeUser?null==b?void 0:b.selectedFakeUser.name:"Select a user",...e})})]})]}),"chat"===S&&(0,ae.jsx)(sn,{store:d}),"skillSwitcher"===S&&(0,ae.jsx)(li,{})]})}function mi(){window.__c={n:"QnaBadge"};const e=(0,l.yK)((e=>({headerSparkles:{width:16,height:16,marginRight:6,color:e.aiPurpleColor},headerLabel:{fontSize:14,color:"#2F2F2F",fontWeight:se.Z.fontWeight.medium,display:"flex",alignItems:"center"},betaBadge:{marginLeft:8,fontSize:12,fontWeight:500,padding:"2px 4px",backgroundColor:e.accentColors.purple[50],color:e.aiPurpleColor,borderRadius:4}})),[]);return(0,ae.jsxs)(ae.Fragment,{children:[(0,tt.t)(e.headerSparkles),(0,ae.jsx)("div",{style:e.headerLabel,children:(0,ae.jsx)(C.FormattedMessage,{id:"assistantMenu.header.askNotionAI.label",defaultMessage:"Ask Notion AI"})}),(0,ae.jsx)("div",{style:e.betaBadge,children:(0,ae.jsx)(C.FormattedMessage,{id:"assistantMenu.header.beta.label",defaultMessage:"Beta"})})]})}function hi(){window.__c={n:"AssistantMenuPopup"};const e=(0,r.VK)((()=>ht.d.state.open),[]),[t,n]=(0,a.useState)(),i=(0,o.O7)(),s=(0,r.VK)((()=>{const e=(0,dt.ll)(i,!1)-(0,dt.vJ)(i);return{bottom:15+ut.Z.state,right:15+ut.Z.state,xPosition:e}}),[i]);(0,a.useEffect)((()=>{const e=()=>{n(new DOMRect(window.innerWidth-s.right-s.xPosition,window.innerHeight-s.bottom,0,0))};return e(),addEventListener("resize",e),()=>removeEventListener("resize",e)}),[s.right,s.xPosition,s.bottom]);const c=(0,l.yK)((e=>({wrap:{borderRadius:12,boxShadow:e.largeLightBoxShadow}})),[]);return(0,ae.jsx)(Qe.ZP,{popupType:i.device.isMobile?A.Z4.SlideUp:A.Z4.Popup,alignmentToOrigin:xt.v.End,alignBoxStyle:{transition:"left 200ms, top 200ms"},originRect:t,disableMouseCapture:!0,preventScaleTransition:!1,popupWrapStyle:c.wrap,open:e,render:()=>(0,ae.jsx)(pi,{store:z.XN,configurationStore:xe.N,onClose:()=>pt.W()})})}var gi=n(56940),fi=n(50817),xi=n(82063),yi=n(29026);const vi="80vh";function ki(e){window.__c={n:"SearchAssistantPane"};const t=(0,o.Fy)();return(0,xi.Z)(),(0,ae.jsx)(gi.Z,{capture:!0,ignoreBlockSelection:!0,focusOffscreenInput:!1,restoreSelection:!t.isMobile,render:()=>(0,ae.jsx)(Me.Z,{capture:!0,allowMenuList:!0,render:t=>(0,ae.jsx)(Si,{...e,ignoreAreaEvents:t})})})}function Si(e){window.__c={n:"SearchAssistantPaneInner"};const{ignoreAreaEvents:t,renderAsPage:n,onClose:s}=e,{modalBodyMenuRef:c}=(0,a.useContext)(fi.SearchStaticContext),d=(0,r.VK)((()=>xe.N.hasLockAction()),[]),u=(0,r.VK)((()=>z.XN.state),[]),p=(0,r.VK)((()=>xe.N.state),[]),m=(0,a.useCallback)((()=>{yi.ZP.update((e=>({...e,mode:"search"})))}),[]),h=(0,l.yK)((e=>({header:{display:"flex",justifyContent:"space-between",alignItems:"center",pointerEvents:"auto",paddingTop:8,paddingLeft:12,paddingRight:12},body:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},scroller:{display:"flex",flexDirection:"column",maxHeight:n?"100vh":vi},clearButton:{color:d?e.lightTextColor:e.mediumIconColor,opacity:d?.5:1},headerButton:{color:e.mediumIconColor},closeButton:{borderRadius:"100%",marginLeft:6},backButton:{marginRight:6}})),[d,n]),g=(0,o.O7)(),f=(0,o.Fy)(),x=(0,a.useMemo)((()=>{if(f.isMobile){return{menuType:W.og.Modal,width:n?"100vw":void 0,disableHeaderShadow:!0,bodyScrollerClassName:tn.GZn,...t}}const e={menuType:W.og.Popup,maxHeight:n?"100vh":vi,minHeight:50,disableScroller:!0,scrollerStyle:h.scroller,...t};return n&&f.isDesktop&&(e.maxWidth="100%"),e}),[f,h,t,n]),y=(0,a.useCallback)((()=>{w.Le6(g,p),i.clearAssistantStores()}),[p,g]);return(0,ae.jsxs)(B.Z,{...x,className:tn.Oau,ref:c,children:[(0,ae.jsx)(F.Z,{children:(0,ae.jsxs)("div",{style:h.header,children:[(0,ae.jsx)(T.Z,{icon:yt.V,onClick:m,ariaLabel:"back",style:h.backButton}),(0,ae.jsx)(mi,{}),(0,ae.jsx)("div",{style:{flexGrow:1}}),u&&(0,ae.jsx)(bt.Z,{style:h.clearButton,onClick:y,disabled:d,children:(0,ae.jsx)(C.FormattedMessage,{id:"searchAssistantPane.header.clear.label",defaultMessage:"Clear"})}),(0,ae.jsx)(T.Z,{style:h.closeButton,hovered:!0,icon:kt.U,onClick:s,ariaLabel:"close"})]})}),(0,ae.jsx)(sn,{store:z.XN})]})}},40190:(e,t,n)=>{n.d(t,{S:()=>h,d:()=>g});var i=n(67294),a=n(480),o=n(24405),s=n(42853),r=n(54497),l=n(82990),c=n(24677),d=n(98104),u=n(89728),p=n(26388),m=n(85893);const h=i.forwardRef(((e,t)=>{window.__c={n:"AutomationDropdownButton"};const{variant:n,onClick:h,style:g,icon:f,children:x,disabled:y}=e,v=(0,a.O7)(),k=(0,o.yK)((e=>({button:{..."gray"===n&&{color:e.mediumTextColor},..."blue"===n&&{color:e.blueColor,fontWeight:500},..."error"===n&&{color:e.errorText},maxWidth:"calc(100% + 2px)",marginLeft:1,padding:"0 8px 0 5px",...g},warningIcon:{width:12,height:12,marginLeft:-6,marginLeft:6,fill:e.errorText,color:e.errorText},chevronIcon:{width:10,height:10,marginLeft:4,marginTop:2,fill:e.lightIconColor},spacer:{flexGrow:1}})),[n,g]),S=(0,i.useCallback)((e=>{d.ZH(v),c.ZH(v),null==h||h(e)}),[h,v]);return(0,m.jsx)(p.Z,{renderTooltip:()=>"error"===n?e.errorMessage:null,placement:p.Z.Placement.Bottom,disableTooltip:"error"!==n,delayThreshold:0,render:e=>(0,m.jsxs)(u.Z,{...e,style:k.button,icon:f,onClick:S,ref:t,shouldShrink:!0,disabled:y,disabledFeedback:y,children:[(0,m.jsx)("div",{style:{...l.Z.textOverflowStyle},children:x}),(0,m.jsx)("div",{style:k.spacer}),"error"===n&&(0,r.t)(k.warningIcon),(0,s.i)(k.chevronIcon)]})})}));function g(e){const{errorMessage:t,hasValue:n}=e;return(0,i.useMemo)((()=>t?{variant:"error",errorMessage:t}:n?{variant:"gray"}:{variant:"blue"}),[t,n])}},19471:(e,t,n)=>{n.d(t,{Y:()=>h,b:()=>m});var i=n(67294),a=n(480),o=n(86628),s=n(9953),r=n(98104),l=n(39699),c=n(21199),d=n(1743),u=n(74194),p=n(85893);function m(e){window.__c={n:"AutomationPlainTextInput"};const{value:t,onChange:n,wrapStyle:a,...o}=e,[s,l]=(0,i.useState)(!1);return(0,p.jsx)(d.Z,{capture:s,children:(0,p.jsx)(c.Z,{capture:!0,render:e=>(0,p.jsx)("div",{...e,style:a,children:(0,p.jsx)(u.Z,{value:t,onChange:e=>n(e.currentTarget.value),onBlur:()=>{l(!1)},onFocus:()=>{r.o9(),l(!0)},...o})})})})}function h(e){window.__c={n:"ConnectedAutomationPlainTextInput"};const{store:t,...n}=e,r=(0,a.O7)(),c=(0,o.VK)((()=>t.getValue()??""),[t]),d=(0,i.useCallback)((e=>{l.createAndCommit({userAction:"AutomationPlainTextInput.setValue",environment:r,perform:n=>{s.sO({store:t,transaction:n,value:e})}})}),[r,t]);return(0,p.jsx)(m,{value:c,onChange:d,...n})}},95193:(e,t,n)=>{n.d(t,{F:()=>r,U:()=>s});var i=n(480),a=n(86628),o=n(87279);function s(e){return e.device.isPhone||"actionSheet"===e.tabletBehavior&&e.device.isTablet?{menuType:o.og.ActionSheet}:{menuType:o.og.Popup,maxHeight:e.maxHeight,maxWidth:e.maxWidth,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,width:e.width,minWidth:e.minWidth}}function r(e){const t=(0,i.Fy)();return(0,a.VK)((()=>s({device:t,maxHeight:null==e?void 0:e.maxHeight,maxWidth:null==e?void 0:e.maxWidth,paddingTop:null==e?void 0:e.paddingTop,paddingBottom:null==e?void 0:e.paddingBottom,width:null==e?void 0:e.width,minWidth:null==e?void 0:e.minWidth,tabletBehavior:null==e?void 0:e.tabletBehavior})),[t,null==e?void 0:e.maxHeight,null==e?void 0:e.maxWidth,null==e?void 0:e.paddingTop,null==e?void 0:e.paddingBottom,null==e?void 0:e.width,null==e?void 0:e.minWidth,null==e?void 0:e.tabletBehavior])}},35294:(e,t,n)=>{n.d(t,{d:()=>s});var i=n(480),a=n(86628),o=n(53437);function s(e){const t=(0,i.Fy)();return(0,a.VK)((()=>t.isPhone||"slideUp"===(null==e?void 0:e.tabletBehavior)&&t.isTablet?o.kQ.SlideUp:o.kQ.Popup),[t,null==e?void 0:e.tabletBehavior])}},90706:(e,t,n)=>{n.d(t,{Z:()=>w});n(57658),n(67294);var i=n(86628),a=n(24405),o=n(80951),s=n(14215),r=(n(30541),n(21703),n(67266)),l=n.n(r),c=n(5242),d=n.n(c),u=n(15095),p=n(72126),m=n(70203),h=n(97880);let g=function(e){return e[e.removed=-1]="removed",e[e.added=1]="added",e[e.same=0]="same",e}({});function f(e){const{before:t,after:n}=e,i={count:0,encoding:{},decoding:{},annotationEncoding:{},annotationDecoding:{}},a=e=>{const t=i.encoding[e];if(t)return t;{const t=String.fromCharCode(i.count);return i.count++,i.encoding[e]=t,i.decoding[t]=e,t}},o=e=>{const t=l()(e),n=i.annotationEncoding[t];if(n)return n;{const n=String.fromCharCode(i.count);return i.count++,i.annotationEncoding[t]=n,i.annotationDecoding[n]=e,n}},s=e=>p.xH(m.lzi(e).map((e=>{const t=u.p4(e[0]).map(a);if(m.km_(e)){const n=m.hDy(e),i=m.I$B(n);i&&(t[0]=o({type:"mention",value:i}),n.forEach((e=>{m.ZAl(e)||m.kuv(e)||m.QVC(e)||(t.unshift(o({type:"start",value:e})),t.push(o({type:"end",value:e})))})))}else if(m.YrK(e)){const n=m.hDy(e),i=m.Ap(n);if(i){t[0]=o({type:"equation",value:i});for(const e of n)m.ZAl(e)||m.kuv(e)||m.QVC(e)||(t.unshift(o({type:"start",value:e})),t.push(o({type:"end",value:e})))}}else if(m.AJd(e)){m.hDy(e).forEach((e=>{t.unshift(o({type:"start",value:e})),t.push(o({type:"end",value:e}))}))}return t}))).join("");if(i.count>65535)throw new Error("This string has way too many different characters.");const r=function(e,t){const n=new(d())({timeout:2,editCost:6}),i=n.main(t,e);return n.cleanupSemantic(i),i}(s(n),s(t)),c=[];let f=[];return r.forEach((e=>{let[t,n]=e;n.split("").forEach((e=>{if(i.decoding[e]){const n=i.decoding[e];t===g.added?c.push([n,[...f,["+"]]]):t===g.removed?c.push([n,[...f,["-"]]]):t===g.same&&c.push([n,f])}else{const n=i.annotationDecoding[e];if(t===g.added)if("mention"===n.type)c.push([m.qyI,[...f,["+"],n.value]]);else if("start"===n.type)f=[...f,n.value];else if("end"===n.type)f=f.filter((e=>!p.Xy(e,n.value)));else if("equation"===n.type){const e=m.xey(n.value),t=m.qZ6(e,[...f,["+"]]);c.push(t)}else(0,h.t1)(n);else if(t===g.removed){if("mention"===n.type)c.push([m.qyI,[...f,["-"],n.value]]);else if("equation"===n.type){const e=m.xey(n.value),t=m.qZ6(e,[...f,["-"]]);c.push(t)}}else if(t===g.same)if("mention"===n.type)c.push([m.qyI,[...f,n.value]]);else if("start"===n.type)f=[...f,n.value];else if("end"===n.type)f=f.filter((e=>!p.Xy(e,n.value)));else if("equation"===n.type){const e=m.xey(n.value),t=m.qZ6(e,f);c.push(t)}else(0,h.t1)(n)}}))})),m.Zxt(c)}var x=n(45238),y=n(85893);const v=(0,x.I)("arrowRightSmaller",{viewBox:"0 0 16 16",svg:(0,y.jsx)("path",{d:"M15.383 8.352a.877.877 0 01-.274.64l-5.156 5.14a.864.864 0 01-.617.266.831.831 0 01-.602-.234.795.795 0 01-.234-.586c0-.12.02-.232.063-.336a.912.912 0 01.187-.273l1.75-1.766 2.914-2.656.274.5-2.711.156H1.484c-.26 0-.471-.078-.632-.234a.851.851 0 01-.235-.617c0-.256.078-.461.235-.618a.856.856 0 01.632-.242h9.493l2.71.164-.273.508L10.5 5.5 8.75 3.727a.946.946 0 01-.188-.266.917.917 0 01-.062-.344c0-.234.078-.43.234-.586a.831.831 0 01.602-.234.79.79 0 01.328.07c.104.047.203.117.297.211l5.148 5.133a.877.877 0 01.274.64z"})});var k=n(21202),S=n(90106),C=n(14200);function w(e){const t=e.propertySchema.type;switch(t){case"title":case"text":return(0,y.jsx)(b,{...e});case"relation":return(0,y.jsx)(j,{propertySchema:e.propertySchema,beforeValue:e.beforeValue,afterValue:e.afterValue,rootStore:e.rootStore});case"checkbox":case"number":case"person":case"file":case"url":case"email":case"phone_number":case"created_time":case"created_by":case"last_edited_time":case"last_edited_by":case"last_visited_time":case"formula":case"rollup":case"select":case"multi_select":case"date":case"button":case"status":case"auto_increment_id":case"location":case"verification":return(0,y.jsx)(I,{...e});default:(0,h.t1)(t)}}function b(e){const t={value:f({before:e.beforeValue.value,after:e.afterValue.value}),spaceId:e.beforeValue.spaceId};return(0,y.jsx)(C.Z,{value:t,propertySchema:e.propertySchema,rootStore:e.rootStore})}function j(e){window.__c={n:"RelationPropertyDiff"};const{beforeValue:t,afterValue:n,propertySchema:a,rootStore:r}=e,l=(0,i.VK)((()=>{const e=(0,o.rq)(t.value),i=(0,o.rq)(n.value),l=(0,s.N)(e,i,(e=>`${e.id}${e.table}`)),c=new Set(o.j$({relationValue:l.created,getRecordModel:r.getRecordModel,propertySchema:a})),d=new Set(o.j$({relationValue:l.deleted,getRecordModel:r.getRecordModel,propertySchema:a})),u=[...c,...d];return u.flatMap(((e,t)=>{const n=S.G.createChildStore(r,{table:k.iU,id:e.id}).getPropertyValue("title")||[],i=[],a=m.lzi(n);for(const o of a)if(m.QJH(o)){const t=c.has(e)?"+":"-",n=[o[0],[[t]]];i.push(n)}else i.push(o);return t<u.length-1&&i.push(m.V3y("\n")),i}))}),[t,n,a,r]);return(0,y.jsx)(C.Z,{value:{value:l,spaceId:t.spaceId},propertySchema:{type:"title",name:"Title"},rootStore:r})}function I(e){window.__c={n:"ArrowPropertyDiff"};const t=(0,a.yK)((()=>({arrowDiffWrap:{display:"inline-flex",alignItems:"center"}})),[]);return(0,y.jsxs)("div",{style:t.arrowDiffWrap,children:[(0,y.jsx)(C.Z,{value:e.beforeValue,propertySchema:e.propertySchema,rootStore:e.rootStore}),(0,y.jsx)(M,{}),(0,y.jsx)(C.Z,{value:e.afterValue,propertySchema:e.propertySchema,rootStore:e.rootStore})]})}function M(){window.__c={n:"Arrow"};const e=(0,a.yK)((e=>({container:{padding:"0px 8px"},icon:{width:15,height:15,fill:e.mediumIconColor}})),[]);return(0,y.jsx)("div",{style:e.container,children:v(e.icon)})}},83176:(e,t,n)=>{n.d(t,{z:()=>o});n(67294);var i=n(45238),a=n(85893);const o=(0,i.I)("analyticsSearch",{viewBox:"0 0 51 52",svg:(0,a.jsx)("path",{d:"M.414 21.297c0 2.86.533 5.543 1.6 8.049a21.156 21.156 0 004.468 6.576 20.797 20.797 0 006.577 4.443c2.505 1.067 5.18 1.6 8.023 1.6 2.116 0 4.13-.305 6.043-.914a21.55 21.55 0 005.332-2.565l11.654 11.655a3.44 3.44 0 001.245.812c.473.186.964.28 1.472.28.728 0 1.371-.17 1.93-.508a3.48 3.48 0 001.32-1.346 3.887 3.887 0 00.482-1.93 3.8 3.8 0 00-.279-1.447 3.126 3.126 0 00-.787-1.193l-11.578-11.63a20.414 20.414 0 002.818-5.51c.694-2.013 1.041-4.138 1.041-6.372 0-2.844-.541-5.51-1.625-7.998a20.718 20.718 0 00-4.443-6.602 20.515 20.515 0 00-6.602-4.468c-2.488-1.067-5.162-1.6-8.023-1.6-2.844 0-5.518.533-8.023 1.6a20.592 20.592 0 00-6.577 4.468A21.072 21.072 0 002.014 13.3c-1.067 2.488-1.6 5.154-1.6 7.998zm5.408 0c0-2.1.39-4.071 1.168-5.916a15.517 15.517 0 013.301-4.875 15.168 15.168 0 014.875-3.276c1.845-.795 3.817-1.193 5.916-1.193 2.116 0 4.096.398 5.941 1.193a14.877 14.877 0 014.85 3.276 15.515 15.515 0 013.3 4.875c.796 1.845 1.194 3.817 1.194 5.916 0 2.116-.398 4.096-1.193 5.941a15.517 15.517 0 01-3.301 4.875 15.426 15.426 0 01-4.85 3.276c-1.845.795-3.825 1.193-5.941 1.193-2.099 0-4.07-.398-5.916-1.193a15.737 15.737 0 01-4.875-3.276 15.52 15.52 0 01-3.3-4.875c-.78-1.845-1.169-3.825-1.169-5.941zm15.31 10.36c.458 0 .746-.263.864-.788.237-1.32.474-2.437.711-3.351.254-.931.559-1.693.914-2.286a4.554 4.554 0 011.397-1.498c.575-.389 1.311-.694 2.209-.914.914-.237 2.056-.448 3.427-.634.542-.085.813-.381.813-.89 0-.507-.271-.812-.813-.913-1.354-.17-2.496-.373-3.427-.61-.915-.253-1.668-.567-2.26-.939a4.814 4.814 0 01-1.422-1.498c-.373-.61-.677-1.363-.914-2.26a42.337 42.337 0 01-.635-3.326c-.084-.542-.372-.813-.863-.813s-.796.263-.914.788a53.724 53.724 0 01-.737 3.377c-.22.914-.507 1.675-.863 2.285a4.64 4.64 0 01-1.396 1.472c-.576.373-1.32.677-2.235.914-.914.22-2.048.424-3.402.61-.559.101-.838.406-.838.914 0 .49.28.787.838.889 1.693.186 3.055.44 4.088.761 1.032.305 1.828.762 2.387 1.371.575.61 1.015 1.44 1.32 2.489.305 1.05.584 2.395.838 4.037a1 1 0 00.279.584c.17.152.38.228.635.228z"})})},37652:(e,t,n)=>{n.d(t,{V:()=>o});n(67294);var i=n(45238),a=n(85893);const o=(0,i.I)("arrowLeft",{viewBox:"0 0 30 30",svg:(0,a.jsx)("polygon",{points:"29 14 4.813 14 13.406 5.406 12 4 1 15 12 26 13.406 24.594 4.813 16 29 16"})})},77058:(e,t,n)=>{n.d(t,{$:()=>o});n(67294);var i=n(45238),a=n(85893);const o=(0,i.I)("checkmark",{viewBox:"0 0 20 20",svg:(0,a.jsx)("path",{d:"M10.0693 18.166C14.7759 18.166 18.6606 14.2812 18.6606 9.58301C18.6606 4.88477 14.7676 1 10.061 1C5.36279 1 1.48633 4.88477 1.48633 9.58301C1.48633 14.2812 5.37109 18.166 10.0693 18.166ZM9.13965 13.6836C8.82422 13.6836 8.56689 13.5508 8.33447 13.2437L6.30078 10.7783C6.15137 10.5874 6.07666 10.3965 6.07666 10.189C6.07666 9.75732 6.41699 9.40869 6.84863 9.40869C7.10596 9.40869 7.30518 9.5 7.521 9.77393L9.11475 11.791L12.5347 6.3125C12.7173 6.02197 12.9497 5.88086 13.2153 5.88086C13.6387 5.88086 14.0205 6.17139 14.0205 6.61133C14.0205 6.80225 13.9209 7.00977 13.8047 7.19238L9.91162 13.2437C9.729 13.5342 9.45508 13.6836 9.13965 13.6836Z"})})},79198:(e,t,n)=>{n.d(t,{n:()=>o});n(67294);var i=n(45238),a=n(85893);const o=(0,i.I)("refresh",{viewBox:"0 0 24 20",svg:(0,a.jsx)("path",{d:"M0.19663 9.99023C-0.184229 10.5273-0.00844799 11.0059 0.694677 11.0059L2.04233 11.0059C2.56968 15.9766 6.85679 19.9219 11.9447 19.9219C14.9232 19.9219 17.6185 18.5645 19.4544 16.4551C19.8158 16.0352 19.7669 15.5078 19.3861 15.2344C19.0052 14.9609 18.5365 15.0586 18.224 15.4199C16.7103 17.168 14.4642 18.2617 11.9447 18.2617C7.68686 18.2617 4.22007 15.1074 3.72202 11.0059L5.1771 11.0059C5.87046 11.0059 6.04624 10.5273 5.67515 10L3.48765 6.88477C3.17515 6.43555 2.7064 6.42578 2.38413 6.88477ZM4.44468 3.4668C4.07358 3.88672 4.12241 4.4043 4.51304 4.67773C4.8939 4.95117 5.35288 4.86328 5.67515 4.50195C7.19858 2.76367 9.44468 1.66016 11.9447 1.66016C16.1927 1.66016 19.6595 4.81445 20.1673 8.92578L18.7123 8.92578C18.0189 8.92578 17.8431 9.39453 18.2142 9.93164L20.4017 13.0469C20.7142 13.4961 21.183 13.5059 21.5052 13.0469L23.683 9.94141C24.0736 9.39453 23.888 8.92578 23.1849 8.92578L21.847 8.92578C21.3099 3.95508 17.0326 0 11.9447 0C8.96616 0 6.28061 1.34766 4.44468 3.4668Z"})})},83065:(e,t,n)=>{n.d(t,{_:()=>o});n(67294);var i=n(45238),a=n(85893);const o=(0,i.I)("sendArrow",{viewBox:"0 0 20 20",svg:(0,a.jsx)("path",{d:"M9.79883 18.5894C14.6216 18.5894 18.5894 14.6216 18.5894 9.79883C18.5894 4.96777 14.6216 1 9.79053 1C4.95947 1 1 4.96777 1 9.79883C1 14.6216 4.96777 18.5894 9.79883 18.5894ZM9.79883 14.3062C9.20947 14.3062 8.76953 13.9077 8.76953 13.3433V9.69922L8.86914 8.00586L8.25488 8.84424L7.3916 9.81543C7.23389 10.0063 6.98486 10.1143 6.72754 10.1143C6.21289 10.1143 5.84766 9.75732 5.84766 9.25928C5.84766 8.99365 5.92236 8.79443 6.12158 8.58691L8.96045 5.61523C9.19287 5.35791 9.4585 5.2417 9.79883 5.2417C10.1309 5.2417 10.4048 5.36621 10.6372 5.61523L13.4761 8.58691C13.667 8.79443 13.75 8.99365 13.75 9.25928C13.75 9.75732 13.3848 10.1143 12.8618 10.1143C12.6128 10.1143 12.3638 10.0063 12.2061 9.81543L11.3428 8.86914L10.7202 7.99756L10.8281 9.69922V13.3433C10.8281 13.9077 10.3799 14.3062 9.79883 14.3062Z"})})},33676:(e,t,n)=>{n.d(t,{A:()=>s});n(67294);var i=n(45238),a=n(39986),o=n(85893);const s=(0,i.I)("thumbDown",{viewBox:"0 0 18 19",svg:(0,o.jsx)("g",{transform:"rotate(180 9 9.5)",children:a.f})})},97022:(e,t,n)=>{n.d(t,{E:()=>s});n(67294);var i=n(45238),a=n(10498),o=n(85893);const s=(0,i.I)("thumbDownFilled",{viewBox:"0 0 16 18",svg:(0,o.jsx)("g",{transform:"rotate(180 8 9)",children:a.O})})},39986:(e,t,n)=>{n.d(t,{P:()=>o,f:()=>a});n(67294);var i=n(45238);const a=(0,n(85893).jsx)("path",{d:"M0.539062 12.3125C0.539062 15.0547 2.29688 17.3125 4.54688 17.3125H7.11719C8.17188 17.8516 9.42188 18.1641 10.8047 18.1641H11.8906C12.9062 18.1641 13.7734 18.1016 14.3359 17.9609C15.4766 17.6797 16.1953 16.8672 16.1953 15.8516C16.1953 15.6641 16.1719 15.5 16.1172 15.3281C16.6562 14.9141 16.9609 14.2969 16.9609 13.6328C16.9609 13.3203 16.8984 13.0078 16.7891 12.7578C17.1484 12.375 17.3594 11.8203 17.3594 11.25C17.3594 10.875 17.2656 10.4922 17.1094 10.2031C17.3281 9.86719 17.4531 9.42188 17.4531 8.9375C17.4531 7.69531 16.5078 6.73438 15.2734 6.73438H12.3672C12.1953 6.73438 12.0859 6.65625 12.0938 6.50781C12.1328 5.69531 13.4062 3.75781 13.4062 2.17188C13.4062 1.01562 12.5859 0.171875 11.4688 0.171875C10.6484 0.171875 10.0859 0.59375 9.55469 1.61719C8.58594 3.48438 7.40625 5.125 5.65625 7.28125H4.25C2.14844 7.28125 0.539062 9.52344 0.539062 12.3125ZM5.375 12.25C5.375 10.5938 5.75 9.53125 6.80469 8.11719C7.99219 6.53125 9.625 4.63281 10.8125 2.27344C11.0625 1.77344 11.2344 1.64844 11.4844 1.64844C11.7891 1.64844 11.9844 1.86719 11.9844 2.25C11.9844 3.42188 10.6641 5.35156 10.6641 6.61719C10.6641 7.55469 11.4219 8.15625 12.4375 8.15625H15.2422C15.7031 8.15625 16.0391 8.5 16.0391 8.95312C16.0391 9.28125 15.9297 9.5 15.6562 9.76562C15.4609 9.96875 15.4375 10.25 15.6094 10.4453C15.8359 10.7734 15.9375 10.9844 15.9375 11.25C15.9375 11.5781 15.7812 11.8516 15.4609 12.0938C15.2031 12.2812 15.1094 12.5859 15.2656 12.8828C15.4297 13.2109 15.5156 13.3672 15.5156 13.6172C15.5156 14 15.2734 14.2891 14.7812 14.5469C14.5312 14.6875 14.4609 14.9531 14.5703 15.1875C14.7344 15.5938 14.7578 15.6641 14.7578 15.8438C14.7578 16.1797 14.5078 16.4531 13.9766 16.5859C13.5156 16.7031 12.7812 16.75 11.8203 16.7422L10.8125 16.7344C7.57031 16.7031 5.375 14.8828 5.375 12.25ZM1.9375 12.3125C1.9375 10.3281 2.96094 8.73438 4.14062 8.6875C4.34375 8.6875 4.55469 8.6875 4.75781 8.6875C4.20312 9.76562 3.95312 10.8984 3.95312 12.25C3.95312 13.6875 4.46094 14.9531 5.375 15.9453C5.07812 15.9453 4.76562 15.9375 4.46875 15.9375C3.10156 15.8906 1.9375 14.2812 1.9375 12.3125Z"}),o=(0,i.I)("thumbUp",{viewBox:"0 0 18 19",svg:a})},10498:(e,t,n)=>{n.d(t,{O:()=>a,w:()=>o});n(67294);var i=n(45238);const a=(0,n(85893).jsx)("path",{d:"M4 12.1875C3.99219 15.1641 6.34375 17.4297 10.0859 17.4375H11.1719C12.1953 17.4375 12.9766 17.3594 13.4297 17.2422C14.1016 17.0781 14.7031 16.6562 14.7031 15.8828C14.7031 15.5859 14.625 15.3594 14.5312 15.1875C14.4766 15.1016 14.4922 15.0234 14.5703 14.9922C15.0859 14.7578 15.4766 14.2812 15.4766 13.6562C15.4766 13.2969 15.375 12.9766 15.2031 12.75C15.125 12.6406 15.1406 12.5469 15.2656 12.4766C15.625 12.25 15.875 11.7891 15.875 11.2656C15.875 10.8828 15.7578 10.4844 15.5547 10.2812C15.4453 10.1797 15.4609 10.1094 15.5781 10.0156C15.8281 9.78906 15.9844 9.41406 15.9844 8.96094C15.9844 8.15625 15.3516 7.5 14.5234 7.5H11.7031C11.0234 7.5 10.5781 7.15625 10.5781 6.60156C10.5781 5.54688 11.9141 3.57812 11.9141 2.14844C11.9141 1.375 11.4219 0.90625 10.75 0.90625C10.1641 0.90625 9.85938 1.28906 9.53125 1.9375C8.33594 4.24219 6.75781 6.11719 5.54688 7.72656C4.49219 9.11719 4.00781 10.3125 4 12.1875ZM0.015625 12.25C0.015625 14.6719 1.52344 16.6719 3.53125 16.6719H4.89062C3.47656 15.5938 2.85156 13.9922 2.86719 12.1719C2.875 10.2031 3.57812 8.77344 4.32031 7.79688H3.23438C1.41406 7.79688 0.015625 9.75 0.015625 12.25Z"}),o=(0,i.I)("thumbUpFilled",{viewBox:"0 0 16 18",svg:a})}}]);